var colorsForPicker = ['#D24D57', '#F22613', '#D91E18', '#96281B', '#EF4836', '#D64541', '#C0392B', '#CF000F', '#E74C3C', '#DB0A5B', '#F64747', '#F1A9A0', '#D2527F', '#E08283', '#F62459', '#E26A6A', '#DCC6E0', '#663399', '#674172', '#AEA8D3', '#913D88', '#9A12B3', '#BF55EC', '#BE90D4', '#8E44AD', '#9B59B6', '#446CB3', '#E4F1FE', '#4183D7', '#59ABE3', '#81CFE0', '#52B3D9', '#C5EFF7', '#22A7F0', '#3498DB', '#2C3E50', '#19B5FE', '#336E7B', '#22313F', '#6BB9F0', '#1E8BC3', '#3A539B', '#34495E', '#67809F', '#2574A9', '#1F3A93', '#89C4F4', '#4B77BE', '#5C97BF', '#4ECDC4', '#A2DED0', '#87D37C', '#90C695', '#26A65B', '#03C9A9', '#68C3A3', '#65C6BB', '#1BBC9B', '#1BA39C', '#66CC99', '#36D7B7', '#C8F7C5', '#86E2D5', '#2ECC71', '#16a085', '#3FC380', '#019875', '#03A678', '#4DAF7C', '#2ABB9B', '#00B16A', '#1E824C', '#049372', '#26C281', '#FDE3A7', '#F89406', '#EB9532', '#E87E04', '#F4B350', '#F2784B', '#EB974E', '#F5AB35', '#D35400', '#F39C12', '#F9690E', '#F9BF3B', '#F27935', '#E67E22', '#ececec', '#6C7A89', '#D2D7D3', '#EEEEEE', '#BDC3C7', '#ECF0F1', '#95A5A6', '#DADFE1', '#ABB7B7', '#F2F1EF', '#BFBFBF', '#E6E2AF', '#A7A37E', '#EFECCA', '#046380', '#002F2F', '#468966', '#FFF0A5', '#FFB03B', '#B64926', '#8E2800', '#1E1E20'];
var edGradients = {
    1: {
        type: 'linear',
        x1: -80,
        y1: 0,
        x2: 80,
        y2: 0,
        colorStops: {
            0: '#ffe47b',
            1: 'rgb(111,154,211)'
        }
    },

    2:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#ff4040',
            1: '#e6399b'
        }
    },

    3: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: 'rgb(166,111,213)',
            0.5: 'rgba(106, 72, 215, 0.5)',
            1: '#200772'
        }
    },

    4: {
        type: 'radial',
        r1: 100,
        r2: 10,
        x1: 0,
        y1: 0,
        x2: 0,
        y2: 0,
        colorStops: {
            0: '#FF4F4F',
            1: 'rgb(255, 239, 64)'
        }
    },

    5: {
        type: 'radial',
        r1: 100,
        r2: 10,
        x1: 0,
        y1: 0,
        x2: 20,
        y2: 20,
        colorStops: {
            0: '#ffe47b',
            0.5: 'rgb(111,154,211)',
            1: 'rgb(166,111,213)'
        }
    },

    6: {
        type: 'radial',
        r1: 50,
        r2: 80,
        x1: 45,
        y1: 45,
        x2: 52,
        y2: 50,
        colorStops: {
            0: 'rgb(155, 237, 0)',
            1: 'rgba(0, 164, 128,0.4)'
        }
    },

    7: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: '#9ecb2d',
            0.5: '#72aa00',
            1: '#bfd255'
        }
    },

    8: {
        type: 'radial',
        r1: 100,
        r2: 50,
        x1: 30,
        y1: 0,
        x2: 0,
        y2: 0,
        colorStops: {
            0: '#aebcbf',
            1: '#0a0809'
        }
    },

    9: {
        type: 'linear',
        x1: -80,
        y1: 0,
        x2: 80,
        y2: 0,
        colorStops: {
            0: '#ffffff',
            1: '#f6f6f6'
        }
    },
    10:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#fefcea',
            1: '#f1da36'
        }
    },
    11: {
        type: 'linear',
        x1: -90,
        y1: -90,
        x2: 90,
        y2: 90,
        colorStops: {
            0: 'rgb(166,111,213)',
            0.5: 'rgba(106, 72, 215, 0.5)',
            1: '#ff1a00'
        }
    },
    12:  {
        type: 'linear',
        x1: 0,
        y1: -120,
        x2: 0,
        y2: 120,
        colorStops: {
            0: '#b7deed',
            1: '#21b4e2'
        }
    },
    13: {
        type: 'linear',
        x1: -80,
        y1: 100,
        x2: 80,
        y2: -100,
        colorStops: {
            0: '#ffe47b',
            1: 'rgb(111,154,211)'
        }
    },
};
/*! jQuery v2.1.3 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.3",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:g.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function(){return a.apply(b||this,e.concat(d.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=hb(),z=hb(),A=hb(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},eb=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fb){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function gb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+rb(o[l]);w=ab.test(a)&&pb(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function hb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ib(a){return a[u]=!0,a}function jb(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function kb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function lb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function nb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function ob(a){return ib(function(b){return b=+b,ib(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pb(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=gb.support={},f=gb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=gb.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",eb,!1):e.attachEvent&&e.attachEvent("onunload",eb)),p=!f(g),c.attributes=jb(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=jb(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=jb(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(jb(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),jb(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&jb(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return lb(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?lb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},gb.matches=function(a,b){return gb(a,null,null,b)},gb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return gb(b,n,null,[a]).length>0},gb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},gb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},gb.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},gb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=gb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=gb.selectors={cacheLength:50,createPseudo:ib,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||gb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&gb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=gb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||gb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ib(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ib(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ib(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ib(function(a){return function(b){return gb(a,b).length>0}}),contains:ib(function(a){return a=a.replace(cb,db),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ib(function(a){return W.test(a||"")||gb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:ob(function(){return[0]}),last:ob(function(a,b){return[b-1]}),eq:ob(function(a,b,c){return[0>c?c+b:c]}),even:ob(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:ob(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:ob(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:ob(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=mb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=nb(b);function qb(){}qb.prototype=d.filters=d.pseudos,d.setFilters=new qb,g=gb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?gb.error(a):z(a,i).slice(0)};function rb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function tb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ub(a,b,c){for(var d=0,e=b.length;e>d;d++)gb(a,b[d],c);return c}function vb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wb(a,b,c,d,e,f){return d&&!d[u]&&(d=wb(d)),e&&!e[u]&&(e=wb(e,f)),ib(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ub(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:vb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=vb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=vb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sb(function(a){return a===b},h,!0),l=sb(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sb(tb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wb(i>1&&tb(m),i>1&&rb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xb(a.slice(i,e)),f>e&&xb(a=a.slice(e)),f>e&&rb(a))}m.push(c)}return tb(m)}function yb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=vb(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&gb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ib(f):f}return h=gb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,yb(e,d)),f.selector=a}return f},i=gb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&pb(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&rb(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&pb(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=jb(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),jb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||kb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&jb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||kb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),jb(function(a){return null==a.getAttribute("disabled")})||kb(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),gb}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return g.call(b,a)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){while((a=a[b])&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++)if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable())},k={add:function(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=h.length:b&&(e=c,j(b))}return this},remove:function(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1)h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],f=0,this},disable:function(){return h=i=b=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,b||k.disable(),this},locked:function(){return!i},fireWith:function(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!c}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))))}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready()}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b)},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function K(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+K.uid++}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,n.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--)delete g[d[c]]}},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var L=new K,M=new K,N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}M.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return M.hasData(a)||L.hasData(a)},data:function(a,b,c){return M.access(a,b,c)
},removeData:function(a,b){M.remove(a,b)},_data:function(a,b,c){return L.access(a,b,c)},_removeData:function(a,b){L.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));L.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){M.set(this,a)}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){M.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0}function $(){return!1}function _(){try{return l.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return typeof n!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(E)||[""],j=b.length;while(j--)h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode)p.push(g),h=g;h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a)}f=0;while((g=p[f++])&&!b.isPropagationStopped())b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==_()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===_()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function(a){return n().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bb=/<([\w:]+)/,cb=/<|&#?\w+;/,db=/<(?:script|style|link)/i,eb=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/^$|\/(?:java|ecma)script/i,gb=/^true\/(.*)/,hb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ib={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ib.optgroup=ib.option,ib.tbody=ib.tfoot=ib.colgroup=ib.caption=ib.thead,ib.th=ib.td;function jb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function kb(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function lb(a){var b=gb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function mb(a,b){for(var c=0,d=a.length;d>c;c++)L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"))}function nb(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i))}}function ob(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function pb(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}n.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=ob(h),f=ob(a),d=0,e=f.length;e>d;d++)pb(f[d],g[d]);if(b)if(c)for(f=f||ob(a),g=g||ob(h),d=0,e=f.length;e>d;d++)nb(f[d],g[d]);else nb(a,h);return g=ob(h,"script"),g.length>0&&mb(g,!i&&ob(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++)if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(cb.test(e)){f=f||k.appendChild(b.createElement("div")),g=(bb.exec(e)||["",""])[1].toLowerCase(),h=ib[g]||ib._default,f.innerHTML=h[1]+e.replace(ab,"<$1></$2>")+h[2],j=h[0];while(j--)f=f.lastChild;n.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));k.textContent="",m=0;while(e=l[m++])if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=ob(k.appendChild(e),"script"),i&&mb(f),c)){j=0;while(e=f[j++])fb.test(e.type||"")&&c.push(e)}return k},cleanData:function(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events)f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);L.cache[e]&&delete L.cache[e]}delete M.cache[c[M.expando]]}}}),n.fn.extend({text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=jb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(ob(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&mb(ob(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(ob(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!db.test(a)&&!ib[(bb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(ab,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(ob(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(ob(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&eb.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(ob(c,"script"),kb),g=f.length;l>j;j++)h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,ob(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,n.map(f,lb),j=0;g>j;j++)h=f[j],fb.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(hb,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++)c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());return this.pushStack(d)}});var qb,rb={};function sb(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f}function tb(a){var b=l,c=rb[a];return c||(c=sb(a,b),"none"!==c&&c||(qb=(qb||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qb[0].contentDocument,b.write(),b.close(),c=sb(a,b),qb.detach()),rb[a]=c),c}var ub=/^margin/,vb=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wb=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};function xb(a,b,c){var d,e,f,g,h=a.style;return c=c||wb(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),vb.test(g)&&ub.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function yb(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e)}a.getComputedStyle&&n.extend(k,{pixelPosition:function(){return g(),b},boxSizingReliable:function(){return null==c&&g(),c},reliableMarginRight:function(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),f.removeChild(c),b}})}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var zb=/^(none|table(?!-c[ea]).+)/,Ab=new RegExp("^("+Q+")(.*)$","i"),Bb=new RegExp("^([+-])=("+Q+")","i"),Cb={position:"absolute",visibility:"hidden",display:"block"},Db={letterSpacing:"0",fontWeight:"400"},Eb=["Webkit","O","Moz","ms"];function Fb(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Eb.length;while(e--)if(b=Eb[e]+c,b in a)return b;return d}function Gb(a,b,c){var d=Ab.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Hb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));return g}function Ib(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wb(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xb(a,b,f),(0>e||null==e)&&(e=a.style[b]),vb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Hb(a,b,c||(g?"border":"content"),d,f)+"px"}function Jb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",tb(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=xb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Bb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xb(a,b,d)),"normal"===e&&b in Db&&(e=Db[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?zb.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Cb,function(){return Ib(a,b,d)}):Ib(a,b,d):void 0},set:function(a,c,d){var e=d&&wb(a);return Gb(a,c,d?Hb(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),n.cssHooks.marginRight=yb(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+R[d]+b]=f[d]||f[d-2]||f[0];return e}},ub.test(a)||(n.cssHooks[a+b].set=Gb)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Jb(this,!0)},hide:function(){return Jb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}});function Kb(a,b,c,d,e){return new Kb.prototype.init(a,b,c,d,e)}n.Tween=Kb,Kb.prototype={constructor:Kb,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Kb.propHooks[this.prop];return a&&a.get?a.get(this):Kb.propHooks._default.get(this)},run:function(a){var b,c=Kb.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Kb.propHooks._default.set(this),this}},Kb.prototype.init.prototype=Kb.prototype,Kb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Kb.propHooks.scrollTop=Kb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=Kb.prototype.init,n.fx.step={};var Lb,Mb,Nb=/^(?:toggle|show|hide)$/,Ob=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pb=/queueHooks$/,Qb=[Vb],Rb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Ob.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Ob.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function Sb(){return setTimeout(function(){Lb=void 0}),Lb=n.now()}function Tb(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=R[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ub(a,b,c){for(var d,e=(Rb[b]||[]).concat(Rb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Vb(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||tb(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Nb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?tb(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ub(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Wb(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Xb(a,b,c){var d,e,f=0,g=Qb.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Lb||Sb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Lb||Sb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Wb(k,j.opts.specialEasing);g>f;f++)if(d=Qb[f].call(j,a,k,j.opts))return d;return n.map(k,Ub,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(Xb,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Rb[c]=Rb[c]||[],Rb[c].unshift(b)},prefilter:function(a,b){b?Qb.unshift(a):Qb.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Xb(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Pb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Tb(b,!0),a,d,e)}}),n.each({slideDown:Tb("show"),slideUp:Tb("hide"),slideToggle:Tb("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Lb=n.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Lb=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Mb||(Mb=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(Mb),Mb=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value}();var Yb,Zb,$b=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Zb:Yb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))
},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),Zb={set:function(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$b[b]||n.find.attr;$b[b]=function(a,b,d){var e,f;return d||(f=$b[b],$b[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$b[b]=f),e}});var _b=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||_b.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),k.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var ac=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ac," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ac," ").indexOf(b)>=0)return!0;return!1}});var bc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bc,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cc=n.now(),dc=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b};var ec=/#.*$/,fc=/([?&])_=[^&]*/,gc=/^(.*?):[ \t]*([^\r\n]*)$/gm,hc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ic=/^(?:GET|HEAD)$/,jc=/^\/\//,kc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lc={},mc={},nc="*/".concat("*"),oc=a.location.href,pc=kc.exec(oc.toLowerCase())||[];function qc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function rc(a,b,c,d){var e={},f=a===mc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function sc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function tc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function uc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:oc,type:"GET",isLocal:hc.test(pc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?sc(sc(a,n.ajaxSettings),b):sc(n.ajaxSettings,a)},ajaxPrefilter:qc(lc),ajaxTransport:qc(mc),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!f){f={};while(b=gc.exec(e))f[b[1].toLowerCase()]=b[2]}b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?e:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return c&&c.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||oc)+"").replace(ec,"").replace(jc,pc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=kc.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===pc[1]&&h[2]===pc[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(pc[3]||("http:"===pc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),rc(lc,k,b,v),2===t)return v;i=n.event&&k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!ic.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(dc.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=fc.test(d)?d.replace(fc,"$1_="+cc++):d+(dc.test(d)?"&":"?")+"_="+cc++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+nc+"; q=0.01":""):k.accepts["*"]);for(j in k.headers)v.setRequestHeader(j,k.headers[j]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1})v[j](k[j]);if(c=rc(mc,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,c.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=tc(k,v,f)),u=uc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var vc=/%20/g,wc=/\[\]$/,xc=/\r?\n/g,yc=/^(?:submit|button|image|reset|file)$/i,zc=/^(?:input|select|textarea|keygen)/i;function Ac(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||wc.test(a)?d(a,e):Ac(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Ac(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Ac(c,a[c],b,e);return d.join("&").replace(vc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&zc.test(this.nodeName)&&!yc.test(a)&&(this.checked||!T.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(xc,"\r\n")}}):{name:b.name,value:c.replace(xc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Bc=0,Cc={},Dc={0:200,1223:204},Ec=n.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Cc)Cc[a]()}),k.cors=!!Ec&&"withCredentials"in Ec,k.ajax=Ec=!!Ec,n.ajaxTransport(function(a){var b;return k.cors||Ec&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Bc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Cc[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Dc[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Cc[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),l.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Fc=[],Gc=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Fc.pop()||n.expando+"_"+cc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Gc.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gc.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Gc,"$1"+e):b.jsonp!==!1&&(b.url+=(dc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Fc.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var Hc=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Hc)return Hc.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var Ic=a.document.documentElement;function Jc(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(typeof d.getBoundingClientRect!==U&&(e=d.getBoundingClientRect()),c=Jc(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||Ic;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||Ic})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Jc(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=yb(k.pixelPosition,function(a,c){return c?(c=xb(a,b),vb.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Kc=a.jQuery,Lc=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Lc),b&&a.jQuery===n&&(a.jQuery=Kc),n},typeof b===U&&(a.jQuery=a.$=n),n});

/*! jQuery UI - v1.11.4 - 2015-03-19
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, draggable.js, sortable.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function( factory ) {
	if ( typeof define === "function" && define.amd ) {

		// AMD. Register as an anonymous module.
		define([ "jquery" ], factory );
	} else {

		// Browser globals
		factory( jQuery );
	}
}(function( $ ) {
/*!
 * jQuery UI Core 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */


// $.ui might exist from components with no dependencies, e.g., $.ui.position
$.ui = $.ui || {};

$.extend( $.ui, {
	version: "1.11.4",

	keyCode: {
		BACKSPACE: 8,
		COMMA: 188,
		DELETE: 46,
		DOWN: 40,
		END: 35,
		ENTER: 13,
		ESCAPE: 27,
		HOME: 36,
		LEFT: 37,
		PAGE_DOWN: 34,
		PAGE_UP: 33,
		PERIOD: 190,
		RIGHT: 39,
		SPACE: 32,
		TAB: 9,
		UP: 38
	}
});

// plugins
$.fn.extend({
	scrollParent: function( includeHidden ) {
		var position = this.css( "position" ),
			excludeStaticParent = position === "absolute",
			overflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,
			scrollParent = this.parents().filter( function() {
				var parent = $( this );
				if ( excludeStaticParent && parent.css( "position" ) === "static" ) {
					return false;
				}
				return overflowRegex.test( parent.css( "overflow" ) + parent.css( "overflow-y" ) + parent.css( "overflow-x" ) );
			}).eq( 0 );

		return position === "fixed" || !scrollParent.length ? $( this[ 0 ].ownerDocument || document ) : scrollParent;
	},

	uniqueId: (function() {
		var uuid = 0;

		return function() {
			return this.each(function() {
				if ( !this.id ) {
					this.id = "ui-id-" + ( ++uuid );
				}
			});
		};
	})(),

	removeUniqueId: function() {
		return this.each(function() {
			if ( /^ui-id-\d+$/.test( this.id ) ) {
				$( this ).removeAttr( "id" );
			}
		});
	}
});

// selectors
function focusable( element, isTabIndexNotNaN ) {
	var map, mapName, img,
		nodeName = element.nodeName.toLowerCase();
	if ( "area" === nodeName ) {
		map = element.parentNode;
		mapName = map.name;
		if ( !element.href || !mapName || map.nodeName.toLowerCase() !== "map" ) {
			return false;
		}
		img = $( "img[usemap='#" + mapName + "']" )[ 0 ];
		return !!img && visible( img );
	}
	return ( /^(input|select|textarea|button|object)$/.test( nodeName ) ?
		!element.disabled :
		"a" === nodeName ?
			element.href || isTabIndexNotNaN :
			isTabIndexNotNaN) &&
		// the element and all of its ancestors must be visible
		visible( element );
}

function visible( element ) {
	return $.expr.filters.visible( element ) &&
		!$( element ).parents().addBack().filter(function() {
			return $.css( this, "visibility" ) === "hidden";
		}).length;
}

$.extend( $.expr[ ":" ], {
	data: $.expr.createPseudo ?
		$.expr.createPseudo(function( dataName ) {
			return function( elem ) {
				return !!$.data( elem, dataName );
			};
		}) :
		// support: jQuery <1.8
		function( elem, i, match ) {
			return !!$.data( elem, match[ 3 ] );
		},

	focusable: function( element ) {
		return focusable( element, !isNaN( $.attr( element, "tabindex" ) ) );
	},

	tabbable: function( element ) {
		var tabIndex = $.attr( element, "tabindex" ),
			isTabIndexNaN = isNaN( tabIndex );
		return ( isTabIndexNaN || tabIndex >= 0 ) && focusable( element, !isTabIndexNaN );
	}
});

// support: jQuery <1.8
if ( !$( "<a>" ).outerWidth( 1 ).jquery ) {
	$.each( [ "Width", "Height" ], function( i, name ) {
		var side = name === "Width" ? [ "Left", "Right" ] : [ "Top", "Bottom" ],
			type = name.toLowerCase(),
			orig = {
				innerWidth: $.fn.innerWidth,
				innerHeight: $.fn.innerHeight,
				outerWidth: $.fn.outerWidth,
				outerHeight: $.fn.outerHeight
			};

		function reduce( elem, size, border, margin ) {
			$.each( side, function() {
				size -= parseFloat( $.css( elem, "padding" + this ) ) || 0;
				if ( border ) {
					size -= parseFloat( $.css( elem, "border" + this + "Width" ) ) || 0;
				}
				if ( margin ) {
					size -= parseFloat( $.css( elem, "margin" + this ) ) || 0;
				}
			});
			return size;
		}

		$.fn[ "inner" + name ] = function( size ) {
			if ( size === undefined ) {
				return orig[ "inner" + name ].call( this );
			}

			return this.each(function() {
				$( this ).css( type, reduce( this, size ) + "px" );
			});
		};

		$.fn[ "outer" + name] = function( size, margin ) {
			if ( typeof size !== "number" ) {
				return orig[ "outer" + name ].call( this, size );
			}

			return this.each(function() {
				$( this).css( type, reduce( this, size, true, margin ) + "px" );
			});
		};
	});
}

// support: jQuery <1.8
if ( !$.fn.addBack ) {
	$.fn.addBack = function( selector ) {
		return this.add( selector == null ?
			this.prevObject : this.prevObject.filter( selector )
		);
	};
}

// support: jQuery 1.6.1, 1.6.2 (http://bugs.jquery.com/ticket/9413)
if ( $( "<a>" ).data( "a-b", "a" ).removeData( "a-b" ).data( "a-b" ) ) {
	$.fn.removeData = (function( removeData ) {
		return function( key ) {
			if ( arguments.length ) {
				return removeData.call( this, $.camelCase( key ) );
			} else {
				return removeData.call( this );
			}
		};
	})( $.fn.removeData );
}

// deprecated
$.ui.ie = !!/msie [\w.]+/.exec( navigator.userAgent.toLowerCase() );

$.fn.extend({
	focus: (function( orig ) {
		return function( delay, fn ) {
			return typeof delay === "number" ?
				this.each(function() {
					var elem = this;
					setTimeout(function() {
						$( elem ).focus();
						if ( fn ) {
							fn.call( elem );
						}
					}, delay );
				}) :
				orig.apply( this, arguments );
		};
	})( $.fn.focus ),

	disableSelection: (function() {
		var eventType = "onselectstart" in document.createElement( "div" ) ?
			"selectstart" :
			"mousedown";

		return function() {
			return this.bind( eventType + ".ui-disableSelection", function( event ) {
				event.preventDefault();
			});
		};
	})(),

	enableSelection: function() {
		return this.unbind( ".ui-disableSelection" );
	},

	zIndex: function( zIndex ) {
		if ( zIndex !== undefined ) {
			return this.css( "zIndex", zIndex );
		}

		if ( this.length ) {
			var elem = $( this[ 0 ] ), position, value;
			while ( elem.length && elem[ 0 ] !== document ) {
				// Ignore z-index if position is set to a value where z-index is ignored by the browser
				// This makes behavior of this function consistent across browsers
				// WebKit always returns auto if the element is positioned
				position = elem.css( "position" );
				if ( position === "absolute" || position === "relative" || position === "fixed" ) {
					// IE returns 0 when zIndex is not specified
					// other browsers return a string
					// we ignore the case of nested elements with an explicit value of 0
					// <div style="z-index: -10;"><div style="z-index: 0;"></div></div>
					value = parseInt( elem.css( "zIndex" ), 10 );
					if ( !isNaN( value ) && value !== 0 ) {
						return value;
					}
				}
				elem = elem.parent();
			}
		}

		return 0;
	}
});

// $.ui.plugin is deprecated. Use $.widget() extensions instead.
$.ui.plugin = {
	add: function( module, option, set ) {
		var i,
			proto = $.ui[ module ].prototype;
		for ( i in set ) {
			proto.plugins[ i ] = proto.plugins[ i ] || [];
			proto.plugins[ i ].push( [ option, set[ i ] ] );
		}
	},
	call: function( instance, name, args, allowDisconnected ) {
		var i,
			set = instance.plugins[ name ];

		if ( !set ) {
			return;
		}

		if ( !allowDisconnected && ( !instance.element[ 0 ].parentNode || instance.element[ 0 ].parentNode.nodeType === 11 ) ) {
			return;
		}

		for ( i = 0; i < set.length; i++ ) {
			if ( instance.options[ set[ i ][ 0 ] ] ) {
				set[ i ][ 1 ].apply( instance.element, args );
			}
		}
	}
};


/*!
 * jQuery UI Widget 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */


var widget_uuid = 0,
	widget_slice = Array.prototype.slice;

$.cleanData = (function( orig ) {
	return function( elems ) {
		var events, elem, i;
		for ( i = 0; (elem = elems[i]) != null; i++ ) {
			try {

				// Only trigger remove when necessary to save time
				events = $._data( elem, "events" );
				if ( events && events.remove ) {
					$( elem ).triggerHandler( "remove" );
				}

			// http://bugs.jquery.com/ticket/8235
			} catch ( e ) {}
		}
		orig( elems );
	};
})( $.cleanData );

$.widget = function( name, base, prototype ) {
	var fullName, existingConstructor, constructor, basePrototype,
		// proxiedPrototype allows the provided prototype to remain unmodified
		// so that it can be used as a mixin for multiple widgets (#8876)
		proxiedPrototype = {},
		namespace = name.split( "." )[ 0 ];

	name = name.split( "." )[ 1 ];
	fullName = namespace + "-" + name;

	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}

	// create selector for plugin
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {
		// allow instantiation without "new" keyword
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}

		// allow instantiation without initializing for simple inheritance
		// must use "new" keyword (the code above always passes args)
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};
	// extend with the existing constructor to carry over any static properties
	$.extend( constructor, existingConstructor, {
		version: prototype.version,
		// copy the object used to create the prototype in case we need to
		// redefine the widget later
		_proto: $.extend( {}, prototype ),
		// track widgets that inherit from this widget in case this widget is
		// redefined after a widget inherits from it
		_childConstructors: []
	});

	basePrototype = new base();
	// we need to make the options hash a property directly on the new instance
	// otherwise we'll modify the options hash on the prototype that we're
	// inheriting from
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			return;
		}
		proxiedPrototype[ prop ] = (function() {
			var _super = function() {
					return base.prototype[ prop ].apply( this, arguments );
				},
				_superApply = function( args ) {
					return base.prototype[ prop ].apply( this, args );
				};
			return function() {
				var __super = this._super,
					__superApply = this._superApply,
					returnValue;

				this._super = _super;
				this._superApply = _superApply;

				returnValue = value.apply( this, arguments );

				this._super = __super;
				this._superApply = __superApply;

				return returnValue;
			};
		})();
	});
	constructor.prototype = $.widget.extend( basePrototype, {
		// TODO: remove support for widgetEventPrefix
		// always use the name + a colon as the prefix, e.g., draggable:start
		// don't prefix for widgets that aren't DOM-based
		widgetEventPrefix: existingConstructor ? (basePrototype.widgetEventPrefix || name) : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	});

	// If this widget is being redefined then we need to find all widgets that
	// are inheriting from it and redefine all of them so that they inherit from
	// the new version of this widget. We're essentially trying to replace one
	// level in the prototype chain.
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;

			// redefine the child widget using the same prototype that was
			// originally used, but inherit from the new version of the base
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor, child._proto );
		});
		// remove the list of existing child constructors from the old constructor
		// so the old child constructors can be garbage collected
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );

	return constructor;
};

$.widget.extend = function( target ) {
	var input = widget_slice.call( arguments, 1 ),
		inputIndex = 0,
		inputLength = input.length,
		key,
		value;
	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {
				// Clone objects
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :
						// Don't extend strings, arrays, etc. with objects
						$.widget.extend( {}, value );
				// Copy everything else by reference
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};

$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string",
			args = widget_slice.call( arguments, 1 ),
			returnValue = this;

		if ( isMethodCall ) {
			this.each(function() {
				var methodValue,
					instance = $.data( this, fullName );
				if ( options === "instance" ) {
					returnValue = instance;
					return false;
				}
				if ( !instance ) {
					return $.error( "cannot call methods on " + name + " prior to initialization; " +
						"attempted to call method '" + options + "'" );
				}
				if ( !$.isFunction( instance[options] ) || options.charAt( 0 ) === "_" ) {
					return $.error( "no such method '" + options + "' for " + name + " widget instance" );
				}
				methodValue = instance[ options ].apply( instance, args );
				if ( methodValue !== instance && methodValue !== undefined ) {
					returnValue = methodValue && methodValue.jquery ?
						returnValue.pushStack( methodValue.get() ) :
						methodValue;
					return false;
				}
			});
		} else {

			// Allow multiple hashes to be passed on init
			if ( args.length ) {
				options = $.widget.extend.apply( null, [ options ].concat(args) );
			}

			this.each(function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} );
					if ( instance._init ) {
						instance._init();
					}
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			});
		}

		return returnValue;
	};
};

$.Widget = function( /* options, element */ ) {};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",
	options: {
		disabled: false,

		// callbacks
		create: null
	},
	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = widget_uuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;

		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();

		if ( element !== this ) {
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			});
			this.document = $( element.style ?
				// element within the document
				element.ownerDocument :
				// element is window or document
				element.document || element );
			this.window = $( this.document[0].defaultView || this.document[0].parentWindow );
		}

		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );

		this._create();
		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},
	_getCreateOptions: $.noop,
	_getCreateEventData: $.noop,
	_create: $.noop,
	_init: $.noop,

	destroy: function() {
		this._destroy();
		// we can probably remove the unbind calls in 2.0
		// all event bindings should go through this._on()
		this.element
			.unbind( this.eventNamespace )
			.removeData( this.widgetFullName )
			// support: jquery <1.6.3
			// http://bugs.jquery.com/ticket/9413
			.removeData( $.camelCase( this.widgetFullName ) );
		this.widget()
			.unbind( this.eventNamespace )
			.removeAttr( "aria-disabled" )
			.removeClass(
				this.widgetFullName + "-disabled " +
				"ui-state-disabled" );

		// clean up events and states
		this.bindings.unbind( this.eventNamespace );
		this.hoverable.removeClass( "ui-state-hover" );
		this.focusable.removeClass( "ui-state-focus" );
	},
	_destroy: $.noop,

	widget: function() {
		return this.element;
	},

	option: function( key, value ) {
		var options = key,
			parts,
			curOption,
			i;

		if ( arguments.length === 0 ) {
			// don't return a reference to the internal hash
			return $.widget.extend( {}, this.options );
		}

		if ( typeof key === "string" ) {
			// handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( arguments.length === 1 ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( arguments.length === 1 ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}

		this._setOptions( options );

		return this;
	},
	_setOptions: function( options ) {
		var key;

		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}

		return this;
	},
	_setOption: function( key, value ) {
		this.options[ key ] = value;

		if ( key === "disabled" ) {
			this.widget()
				.toggleClass( this.widgetFullName + "-disabled", !!value );

			// If the widget is becoming disabled, then nothing is interactive
			if ( value ) {
				this.hoverable.removeClass( "ui-state-hover" );
				this.focusable.removeClass( "ui-state-focus" );
			}
		}

		return this;
	},

	enable: function() {
		return this._setOptions({ disabled: false });
	},
	disable: function() {
		return this._setOptions({ disabled: true });
	},

	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement,
			instance = this;

		// no suppressDisabledCheck flag, shuffle arguments
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}

		// no element argument, shuffle and use this.element
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}

		$.each( handlers, function( event, handler ) {
			function handlerProxy() {
				// allow widgets to customize the disabled handling
				// - disabled as an array instead of boolean
				// - disabled class as method for disabling individual parts
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
							$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}

			// copy the guid so direct unbinding works
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			var match = event.match( /^([\w:-]*)\s*(.*)$/ ),
				eventName = match[1] + instance.eventNamespace,
				selector = match[2];
			if ( selector ) {
				delegateElement.delegate( selector, eventName, handlerProxy );
			} else {
				element.bind( eventName, handlerProxy );
			}
		});
	},

	_off: function( element, eventName ) {
		eventName = (eventName || "").split( " " ).join( this.eventNamespace + " " ) +
			this.eventNamespace;
		element.unbind( eventName ).undelegate( eventName );

		// Clear the stack to avoid memory leaks (#10056)
		this.bindings = $( this.bindings.not( element ).get() );
		this.focusable = $( this.focusable.not( element ).get() );
		this.hoverable = $( this.hoverable.not( element ).get() );
	},

	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},

	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-hover" );
			},
			mouseleave: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-hover" );
			}
		});
	},

	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-focus" );
			},
			focusout: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-focus" );
			}
		});
	},

	_trigger: function( type, event, data ) {
		var prop, orig,
			callback = this.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();
		// the original event may come from any element
		// so we need to reset the target on the new event
		event.target = this.element[ 0 ];

		// copy original event properties over to the new event
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[0], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}
		var hasOptions,
			effectName = !options ?
				method :
				options === true || typeof options === "number" ?
					defaultEffect :
					options.effect || defaultEffect;
		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}
		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;
		if ( options.delay ) {
			element.delay( options.delay );
		}
		if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue(function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			});
		}
	};
});

var widget = $.widget;


/*!
 * jQuery UI Mouse 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */


var mouseHandled = false;
$( document ).mouseup( function() {
	mouseHandled = false;
});

var mouse = $.widget("ui.mouse", {
	version: "1.11.4",
	options: {
		cancel: "input,textarea,button,select,option",
		distance: 1,
		delay: 0
	},
	_mouseInit: function() {
		var that = this;

		this.element
			.bind("mousedown." + this.widgetName, function(event) {
				return that._mouseDown(event);
			})
			.bind("click." + this.widgetName, function(event) {
				if (true === $.data(event.target, that.widgetName + ".preventClickEvent")) {
					$.removeData(event.target, that.widgetName + ".preventClickEvent");
					event.stopImmediatePropagation();
					return false;
				}
			});

		this.started = false;
	},

	// TODO: make sure destroying one instance of mouse doesn't mess with
	// other instances of mouse
	_mouseDestroy: function() {
		this.element.unbind("." + this.widgetName);
		if ( this._mouseMoveDelegate ) {
			this.document
				.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate)
				.unbind("mouseup." + this.widgetName, this._mouseUpDelegate);
		}
	},

	_mouseDown: function(event) {
		// don't let more than one widget handle mouseStart
		if ( mouseHandled ) {
			return;
		}

		this._mouseMoved = false;

		// we may have missed mouseup (out of window)
		(this._mouseStarted && this._mouseUp(event));

		this._mouseDownEvent = event;

		var that = this,
			btnIsLeft = (event.which === 1),
			// event.target.nodeName works around a bug in IE 8 with
			// disabled inputs (#7620)
			elIsCancel = (typeof this.options.cancel === "string" && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : false);
		if (!btnIsLeft || elIsCancel || !this._mouseCapture(event)) {
			return true;
		}

		this.mouseDelayMet = !this.options.delay;
		if (!this.mouseDelayMet) {
			this._mouseDelayTimer = setTimeout(function() {
				that.mouseDelayMet = true;
			}, this.options.delay);
		}

		if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
			this._mouseStarted = (this._mouseStart(event) !== false);
			if (!this._mouseStarted) {
				event.preventDefault();
				return true;
			}
		}

		// Click event may never have fired (Gecko & Opera)
		if (true === $.data(event.target, this.widgetName + ".preventClickEvent")) {
			$.removeData(event.target, this.widgetName + ".preventClickEvent");
		}

		// these delegates are required to keep context
		this._mouseMoveDelegate = function(event) {
			return that._mouseMove(event);
		};
		this._mouseUpDelegate = function(event) {
			return that._mouseUp(event);
		};

		this.document
			.bind( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.bind( "mouseup." + this.widgetName, this._mouseUpDelegate );

		event.preventDefault();

		mouseHandled = true;
		return true;
	},

	_mouseMove: function(event) {
		// Only check for mouseups outside the document if you've moved inside the document
		// at least once. This prevents the firing of mouseup in the case of IE<9, which will
		// fire a mousemove event if content is placed under the cursor. See #7778
		// Support: IE <9
		if ( this._mouseMoved ) {
			// IE mouseup check - mouseup happened when mouse was out of window
			if ($.ui.ie && ( !document.documentMode || document.documentMode < 9 ) && !event.button) {
				return this._mouseUp(event);

			// Iframe mouseup check - mouseup occurred in another document
			} else if ( !event.which ) {
				return this._mouseUp( event );
			}
		}

		if ( event.which || event.button ) {
			this._mouseMoved = true;
		}

		if (this._mouseStarted) {
			this._mouseDrag(event);
			return event.preventDefault();
		}

		if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
			this._mouseStarted =
				(this._mouseStart(this._mouseDownEvent, event) !== false);
			(this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));
		}

		return !this._mouseStarted;
	},

	_mouseUp: function(event) {
		this.document
			.unbind( "mousemove." + this.widgetName, this._mouseMoveDelegate )
			.unbind( "mouseup." + this.widgetName, this._mouseUpDelegate );

		if (this._mouseStarted) {
			this._mouseStarted = false;

			if (event.target === this._mouseDownEvent.target) {
				$.data(event.target, this.widgetName + ".preventClickEvent", true);
			}

			this._mouseStop(event);
		}

		mouseHandled = false;
		return false;
	},

	_mouseDistanceMet: function(event) {
		return (Math.max(
				Math.abs(this._mouseDownEvent.pageX - event.pageX),
				Math.abs(this._mouseDownEvent.pageY - event.pageY)
			) >= this.options.distance
		);
	},

	_mouseDelayMet: function(/* event */) {
		return this.mouseDelayMet;
	},

	// These are placeholder methods, to be overriden by extending plugin
	_mouseStart: function(/* event */) {},
	_mouseDrag: function(/* event */) {},
	_mouseStop: function(/* event */) {},
	_mouseCapture: function(/* event */) { return true; }
});


/*!
 * jQuery UI Draggable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */


$.widget("ui.draggable", $.ui.mouse, {
	version: "1.11.4",
	widgetEventPrefix: "drag",
	options: {
		addClasses: true,
		appendTo: "parent",
		axis: false,
		connectToSortable: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		grid: false,
		handle: false,
		helper: "original",
		iframeFix: false,
		opacity: false,
		refreshPositions: false,
		revert: false,
		revertDuration: 500,
		scope: "default",
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		snap: false,
		snapMode: "both",
		snapTolerance: 20,
		stack: false,
		zIndex: false,

		// callbacks
		drag: null,
		start: null,
		stop: null
	},
	_create: function() {

		if ( this.options.helper === "original" ) {
			this._setPositionRelative();
		}
		if (this.options.addClasses){
			this.element.addClass("ui-draggable");
		}
		if (this.options.disabled){
			this.element.addClass("ui-draggable-disabled");
		}
		this._setHandleClassName();

		this._mouseInit();
	},

	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "handle" ) {
			this._removeHandleClassName();
			this._setHandleClassName();
		}
	},

	_destroy: function() {
		if ( ( this.helper || this.element ).is( ".ui-draggable-dragging" ) ) {
			this.destroyOnClear = true;
			return;
		}
		this.element.removeClass( "ui-draggable ui-draggable-dragging ui-draggable-disabled" );
		this._removeHandleClassName();
		this._mouseDestroy();
	},

	_mouseCapture: function(event) {
		var o = this.options;

		this._blurActiveElement( event );

		// among others, prevent a drag on a resizable-handle
		if (this.helper || o.disabled || $(event.target).closest(".ui-resizable-handle").length > 0) {
			return false;
		}

		//Quit if we're not on a valid handle
		this.handle = this._getHandle(event);
		if (!this.handle) {
			return false;
		}

		this._blockFrames( o.iframeFix === true ? "iframe" : o.iframeFix );

		return true;

	},

	_blockFrames: function( selector ) {
		this.iframeBlocks = this.document.find( selector ).map(function() {
			var iframe = $( this );

			return $( "<div>" )
				.css( "position", "absolute" )
				.appendTo( iframe.parent() )
				.outerWidth( iframe.outerWidth() )
				.outerHeight( iframe.outerHeight() )
				.offset( iframe.offset() )[ 0 ];
		});
	},

	_unblockFrames: function() {
		if ( this.iframeBlocks ) {
			this.iframeBlocks.remove();
			delete this.iframeBlocks;
		}
	},

	_blurActiveElement: function( event ) {
		var document = this.document[ 0 ];

		// Only need to blur if the event occurred on the draggable itself, see #10527
		if ( !this.handleElement.is( event.target ) ) {
			return;
		}

		// support: IE9
		// IE9 throws an "Unspecified error" accessing document.activeElement from an <iframe>
		try {

			// Support: IE9, IE10
			// If the <body> is blurred, IE will switch windows, see #9520
			if ( document.activeElement && document.activeElement.nodeName.toLowerCase() !== "body" ) {

				// Blur any element that currently has focus, see #4261
				$( document.activeElement ).blur();
			}
		} catch ( error ) {}
	},

	_mouseStart: function(event) {

		var o = this.options;

		//Create and append the visible helper
		this.helper = this._createHelper(event);

		this.helper.addClass("ui-draggable-dragging");

		//Cache the helper size
		this._cacheHelperProportions();

		//If ddmanager is used for droppables, set the global draggable
		if ($.ui.ddmanager) {
			$.ui.ddmanager.current = this;
		}

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Store the helper's css position
		this.cssPosition = this.helper.css( "position" );
		this.scrollParent = this.helper.scrollParent( true );
		this.offsetParent = this.helper.offsetParent();
		this.hasFixedAncestor = this.helper.parents().filter(function() {
				return $( this ).css( "position" ) === "fixed";
			}).length > 0;

		//The element's absolute position on the page minus margins
		this.positionAbs = this.element.offset();
		this._refreshOffsets( event );

		//Generate the original position
		this.originalPosition = this.position = this._generatePosition( event, false );
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));

		//Set a containment if given in the options
		this._setContainment();

		//Trigger event + callbacks
		if (this._trigger("start", event) === false) {
			this._clear();
			return false;
		}

		//Recache the helper size
		this._cacheHelperProportions();

		//Prepare the droppable offsets
		if ($.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(this, event);
		}

		// Reset helper's right/bottom css if they're set and set explicit width/height instead
		// as this prevents resizing of elements with right/bottom set (see #7772)
		this._normalizeRightBottom();

		this._mouseDrag(event, true); //Execute the drag once - this causes the helper not to be visible before getting its correct position

		//If the ddmanager is used for droppables, inform the manager that dragging has started (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStart(this, event);
		}

		return true;
	},

	_refreshOffsets: function( event ) {
		this.offset = {
			top: this.positionAbs.top - this.margins.top,
			left: this.positionAbs.left - this.margins.left,
			scroll: false,
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset()
		};

		this.offset.click = {
			left: event.pageX - this.offset.left,
			top: event.pageY - this.offset.top
		};
	},

	_mouseDrag: function(event, noPropagation) {
		// reset any necessary cached properties (see #5009)
		if ( this.hasFixedAncestor ) {
			this.offset.parent = this._getParentOffset();
		}

		//Compute the helpers position
		this.position = this._generatePosition( event, true );
		this.positionAbs = this._convertPositionTo("absolute");

		//Call plugins and callbacks and use the resulting position if something is returned
		if (!noPropagation) {
			var ui = this._uiHash();
			if (this._trigger("drag", event, ui) === false) {
				this._mouseUp({});
				return false;
			}
			this.position = ui.position;
		}

		this.helper[ 0 ].style.left = this.position.left + "px";
		this.helper[ 0 ].style.top = this.position.top + "px";

		if ($.ui.ddmanager) {
			$.ui.ddmanager.drag(this, event);
		}

		return false;
	},

	_mouseStop: function(event) {

		//If we are using droppables, inform the manager about the drop
		var that = this,
			dropped = false;
		if ($.ui.ddmanager && !this.options.dropBehaviour) {
			dropped = $.ui.ddmanager.drop(this, event);
		}

		//if a drop comes from outside (a sortable)
		if (this.dropped) {
			dropped = this.dropped;
			this.dropped = false;
		}

		if ((this.options.revert === "invalid" && !dropped) || (this.options.revert === "valid" && dropped) || this.options.revert === true || ($.isFunction(this.options.revert) && this.options.revert.call(this.element, dropped))) {
			$(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
				if (that._trigger("stop", event) !== false) {
					that._clear();
				}
			});
		} else {
			if (this._trigger("stop", event) !== false) {
				this._clear();
			}
		}

		return false;
	},

	_mouseUp: function( event ) {
		this._unblockFrames();

		//If the ddmanager is used for droppables, inform the manager that dragging has stopped (see #5003)
		if ( $.ui.ddmanager ) {
			$.ui.ddmanager.dragStop(this, event);
		}

		// Only need to focus if the event occurred on the draggable itself, see #10527
		if ( this.handleElement.is( event.target ) ) {
			// The interaction is over; whether or not the click resulted in a drag, focus the element
			this.element.focus();
		}

		return $.ui.mouse.prototype._mouseUp.call(this, event);
	},

	cancel: function() {

		if (this.helper.is(".ui-draggable-dragging")) {
			this._mouseUp({});
		} else {
			this._clear();
		}

		return this;

	},

	_getHandle: function(event) {
		return this.options.handle ?
			!!$( event.target ).closest( this.element.find( this.options.handle ) ).length :
			true;
	},

	_setHandleClassName: function() {
		this.handleElement = this.options.handle ?
			this.element.find( this.options.handle ) : this.element;
		this.handleElement.addClass( "ui-draggable-handle" );
	},

	_removeHandleClassName: function() {
		this.handleElement.removeClass( "ui-draggable-handle" );
	},

	_createHelper: function(event) {

		var o = this.options,
			helperIsFunction = $.isFunction( o.helper ),
			helper = helperIsFunction ?
				$( o.helper.apply( this.element[ 0 ], [ event ] ) ) :
				( o.helper === "clone" ?
					this.element.clone().removeAttr( "id" ) :
					this.element );

		if (!helper.parents("body").length) {
			helper.appendTo((o.appendTo === "parent" ? this.element[0].parentNode : o.appendTo));
		}

		// http://bugs.jqueryui.com/ticket/9446
		// a helper function can return the original element
		// which wouldn't have been set to relative in _create
		if ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {
			this._setPositionRelative();
		}

		if (helper[0] !== this.element[0] && !(/(fixed|absolute)/).test(helper.css("position"))) {
			helper.css("position", "absolute");
		}

		return helper;

	},

	_setPositionRelative: function() {
		if ( !( /^(?:r|a|f)/ ).test( this.element.css( "position" ) ) ) {
			this.element[ 0 ].style.position = "relative";
		}
	},

	_adjustOffsetFromHelper: function(obj) {
		if (typeof obj === "string") {
			obj = obj.split(" ");
		}
		if ($.isArray(obj)) {
			obj = { left: +obj[0], top: +obj[1] || 0 };
		}
		if ("left" in obj) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ("right" in obj) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ("top" in obj) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ("bottom" in obj) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_isRootNode: function( element ) {
		return ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];
	},

	_getParentOffset: function() {

		//Get the offsetParent and cache its position
		var po = this.offsetParent.offset(),
			document = this.document[ 0 ];

		// This is a special case where we need to modify a offset calculated on start, since the following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that
		//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag
		if (this.cssPosition === "absolute" && this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0])) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		if ( this._isRootNode( this.offsetParent[ 0 ] ) ) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
			left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
		};

	},

	_getRelativeOffset: function() {
		if ( this.cssPosition !== "relative" ) {
			return { top: 0, left: 0 };
		}

		var p = this.element.position(),
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: p.top - ( parseInt(this.helper.css( "top" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),
			left: p.left - ( parseInt(this.helper.css( "left" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )
		};

	},

	_cacheMargins: function() {
		this.margins = {
			left: (parseInt(this.element.css("marginLeft"), 10) || 0),
			top: (parseInt(this.element.css("marginTop"), 10) || 0),
			right: (parseInt(this.element.css("marginRight"), 10) || 0),
			bottom: (parseInt(this.element.css("marginBottom"), 10) || 0)
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var isUserScrollable, c, ce,
			o = this.options,
			document = this.document[ 0 ];

		this.relativeContainer = null;

		if ( !o.containment ) {
			this.containment = null;
			return;
		}

		if ( o.containment === "window" ) {
			this.containment = [
				$( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,
				$( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,
				$( window ).scrollLeft() + $( window ).width() - this.helperProportions.width - this.margins.left,
				$( window ).scrollTop() + ( $( window ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment === "document") {
			this.containment = [
				0,
				0,
				$( document ).width() - this.helperProportions.width - this.margins.left,
				( $( document ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top
			];
			return;
		}

		if ( o.containment.constructor === Array ) {
			this.containment = o.containment;
			return;
		}

		if ( o.containment === "parent" ) {
			o.containment = this.helper[ 0 ].parentNode;
		}

		c = $( o.containment );
		ce = c[ 0 ];

		if ( !ce ) {
			return;
		}

		isUserScrollable = /(scroll|auto)/.test( c.css( "overflow" ) );

		this.containment = [
			( parseInt( c.css( "borderLeftWidth" ), 10 ) || 0 ) + ( parseInt( c.css( "paddingLeft" ), 10 ) || 0 ),
			( parseInt( c.css( "borderTopWidth" ), 10 ) || 0 ) + ( parseInt( c.css( "paddingTop" ), 10 ) || 0 ),
			( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -
				( parseInt( c.css( "borderRightWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingRight" ), 10 ) || 0 ) -
				this.helperProportions.width -
				this.margins.left -
				this.margins.right,
			( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -
				( parseInt( c.css( "borderBottomWidth" ), 10 ) || 0 ) -
				( parseInt( c.css( "paddingBottom" ), 10 ) || 0 ) -
				this.helperProportions.height -
				this.margins.top -
				this.margins.bottom
		];
		this.relativeContainer = c;
	},

	_convertPositionTo: function(d, pos) {

		if (!pos) {
			pos = this.position;
		}

		var mod = d === "absolute" ? 1 : -1,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );

		return {
			top: (
				pos.top	+																// The absolute mouse position
				this.offset.relative.top * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top * mod -										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod)
			),
			left: (
				pos.left +																// The absolute mouse position
				this.offset.relative.left * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left * mod	-										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod)
			)
		};

	},

	_generatePosition: function( event, constrainPosition ) {

		var containment, co, top, left,
			o = this.options,
			scrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),
			pageX = event.pageX,
			pageY = event.pageY;

		// Cache the scroll
		if ( !scrollIsRootNode || !this.offset.scroll ) {
			this.offset.scroll = {
				top: this.scrollParent.scrollTop(),
				left: this.scrollParent.scrollLeft()
			};
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		// If we are not dragging yet, we won't check for options
		if ( constrainPosition ) {
			if ( this.containment ) {
				if ( this.relativeContainer ){
					co = this.relativeContainer.offset();
					containment = [
						this.containment[ 0 ] + co.left,
						this.containment[ 1 ] + co.top,
						this.containment[ 2 ] + co.left,
						this.containment[ 3 ] + co.top
					];
				} else {
					containment = this.containment;
				}

				if (event.pageX - this.offset.click.left < containment[0]) {
					pageX = containment[0] + this.offset.click.left;
				}
				if (event.pageY - this.offset.click.top < containment[1]) {
					pageY = containment[1] + this.offset.click.top;
				}
				if (event.pageX - this.offset.click.left > containment[2]) {
					pageX = containment[2] + this.offset.click.left;
				}
				if (event.pageY - this.offset.click.top > containment[3]) {
					pageY = containment[3] + this.offset.click.top;
				}
			}

			if (o.grid) {
				//Check for grid elements set to 0 to prevent divide by 0 error causing invalid argument errors in IE (see ticket #6950)
				top = o.grid[1] ? this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY;
				pageY = containment ? ((top - this.offset.click.top >= containment[1] || top - this.offset.click.top > containment[3]) ? top : ((top - this.offset.click.top >= containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;

				left = o.grid[0] ? this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX;
				pageX = containment ? ((left - this.offset.click.left >= containment[0] || left - this.offset.click.left > containment[2]) ? left : ((left - this.offset.click.left >= containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;
			}

			if ( o.axis === "y" ) {
				pageX = this.originalPageX;
			}

			if ( o.axis === "x" ) {
				pageY = this.originalPageY;
			}
		}

		return {
			top: (
				pageY -																	// The absolute mouse position
				this.offset.click.top	-												// Click offset (relative to the element)
				this.offset.relative.top -												// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top +												// The offsetParent's offset without borders (offset + border)
				( this.cssPosition === "fixed" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) )
			),
			left: (
				pageX -																	// The absolute mouse position
				this.offset.click.left -												// Click offset (relative to the element)
				this.offset.relative.left -												// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left +												// The offsetParent's offset without borders (offset + border)
				( this.cssPosition === "fixed" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) )
			)
		};

	},

	_clear: function() {
		this.helper.removeClass("ui-draggable-dragging");
		if (this.helper[0] !== this.element[0] && !this.cancelHelperRemoval) {
			this.helper.remove();
		}
		this.helper = null;
		this.cancelHelperRemoval = false;
		if ( this.destroyOnClear ) {
			this.destroy();
		}
	},

	_normalizeRightBottom: function() {
		if ( this.options.axis !== "y" && this.helper.css( "right" ) !== "auto" ) {
			this.helper.width( this.helper.width() );
			this.helper.css( "right", "auto" );
		}
		if ( this.options.axis !== "x" && this.helper.css( "bottom" ) !== "auto" ) {
			this.helper.height( this.helper.height() );
			this.helper.css( "bottom", "auto" );
		}
	},

	// From now on bulk stuff - mainly helpers

	_trigger: function( type, event, ui ) {
		ui = ui || this._uiHash();
		$.ui.plugin.call( this, type, [ event, ui, this ], true );

		// Absolute position and offset (see #6884 ) have to be recalculated after plugins
		if ( /^(drag|start|stop)/.test( type ) ) {
			this.positionAbs = this._convertPositionTo( "absolute" );
			ui.offset = this.positionAbs;
		}
		return $.Widget.prototype._trigger.call( this, type, event, ui );
	},

	plugins: {},

	_uiHash: function() {
		return {
			helper: this.helper,
			position: this.position,
			originalPosition: this.originalPosition,
			offset: this.positionAbs
		};
	}

});

$.ui.plugin.add( "draggable", "connectToSortable", {
	start: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		});

		draggable.sortables = [];
		$( draggable.options.connectToSortable ).each(function() {
			var sortable = $( this ).sortable( "instance" );

			if ( sortable && !sortable.options.disabled ) {
				draggable.sortables.push( sortable );

				// refreshPositions is called at drag start to refresh the containerCache
				// which is used in drag. This ensures it's initialized and synchronized
				// with any changes that might have happened on the page since initialization.
				sortable.refreshPositions();
				sortable._trigger("activate", event, uiSortable);
			}
		});
	},
	stop: function( event, ui, draggable ) {
		var uiSortable = $.extend( {}, ui, {
			item: draggable.element
		});

		draggable.cancelHelperRemoval = false;

		$.each( draggable.sortables, function() {
			var sortable = this;

			if ( sortable.isOver ) {
				sortable.isOver = 0;

				// Allow this sortable to handle removing the helper
				draggable.cancelHelperRemoval = true;
				sortable.cancelHelperRemoval = false;

				// Use _storedCSS To restore properties in the sortable,
				// as this also handles revert (#9675) since the draggable
				// may have modified them in unexpected ways (#8809)
				sortable._storedCSS = {
					position: sortable.placeholder.css( "position" ),
					top: sortable.placeholder.css( "top" ),
					left: sortable.placeholder.css( "left" )
				};

				sortable._mouseStop(event);

				// Once drag has ended, the sortable should return to using
				// its original helper, not the shared helper from draggable
				sortable.options.helper = sortable.options._helper;
			} else {
				// Prevent this Sortable from removing the helper.
				// However, don't set the draggable to remove the helper
				// either as another connected Sortable may yet handle the removal.
				sortable.cancelHelperRemoval = true;

				sortable._trigger( "deactivate", event, uiSortable );
			}
		});
	},
	drag: function( event, ui, draggable ) {
		$.each( draggable.sortables, function() {
			var innermostIntersecting = false,
				sortable = this;

			// Copy over variables that sortable's _intersectsWith uses
			sortable.positionAbs = draggable.positionAbs;
			sortable.helperProportions = draggable.helperProportions;
			sortable.offset.click = draggable.offset.click;

			if ( sortable._intersectsWith( sortable.containerCache ) ) {
				innermostIntersecting = true;

				$.each( draggable.sortables, function() {
					// Copy over variables that sortable's _intersectsWith uses
					this.positionAbs = draggable.positionAbs;
					this.helperProportions = draggable.helperProportions;
					this.offset.click = draggable.offset.click;

					if ( this !== sortable &&
							this._intersectsWith( this.containerCache ) &&
							$.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {
						innermostIntersecting = false;
					}

					return innermostIntersecting;
				});
			}

			if ( innermostIntersecting ) {
				// If it intersects, we use a little isOver variable and set it once,
				// so that the move-in stuff gets fired only once.
				if ( !sortable.isOver ) {
					sortable.isOver = 1;

					// Store draggable's parent in case we need to reappend to it later.
					draggable._parent = ui.helper.parent();

					sortable.currentItem = ui.helper
						.appendTo( sortable.element )
						.data( "ui-sortable-item", true );

					// Store helper option to later restore it
					sortable.options._helper = sortable.options.helper;

					sortable.options.helper = function() {
						return ui.helper[ 0 ];
					};

					// Fire the start events of the sortable with our passed browser event,
					// and our own helper (so it doesn't create a new one)
					event.target = sortable.currentItem[ 0 ];
					sortable._mouseCapture( event, true );
					sortable._mouseStart( event, true, true );

					// Because the browser event is way off the new appended portlet,
					// modify necessary variables to reflect the changes
					sortable.offset.click.top = draggable.offset.click.top;
					sortable.offset.click.left = draggable.offset.click.left;
					sortable.offset.parent.left -= draggable.offset.parent.left -
						sortable.offset.parent.left;
					sortable.offset.parent.top -= draggable.offset.parent.top -
						sortable.offset.parent.top;

					draggable._trigger( "toSortable", event );

					// Inform draggable that the helper is in a valid drop zone,
					// used solely in the revert option to handle "valid/invalid".
					draggable.dropped = sortable.element;

					// Need to refreshPositions of all sortables in the case that
					// adding to one sortable changes the location of the other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					});

					// hack so receive/update callbacks work (mostly)
					draggable.currentItem = draggable.element;
					sortable.fromOutside = draggable;
				}

				if ( sortable.currentItem ) {
					sortable._mouseDrag( event );
					// Copy the sortable's position because the draggable's can potentially reflect
					// a relative position, while sortable is always absolute, which the dragged
					// element has now become. (#8809)
					ui.position = sortable.position;
				}
			} else {
				// If it doesn't intersect with the sortable, and it intersected before,
				// we fake the drag stop of the sortable, but make sure it doesn't remove
				// the helper by using cancelHelperRemoval.
				if ( sortable.isOver ) {

					sortable.isOver = 0;
					sortable.cancelHelperRemoval = true;

					// Calling sortable's mouseStop would trigger a revert,
					// so revert must be temporarily false until after mouseStop is called.
					sortable.options._revert = sortable.options.revert;
					sortable.options.revert = false;

					sortable._trigger( "out", event, sortable._uiHash( sortable ) );
					sortable._mouseStop( event, true );

					// restore sortable behaviors that were modfied
					// when the draggable entered the sortable area (#9481)
					sortable.options.revert = sortable.options._revert;
					sortable.options.helper = sortable.options._helper;

					if ( sortable.placeholder ) {
						sortable.placeholder.remove();
					}

					// Restore and recalculate the draggable's offset considering the sortable
					// may have modified them in unexpected ways. (#8809, #10669)
					ui.helper.appendTo( draggable._parent );
					draggable._refreshOffsets( event );
					ui.position = draggable._generatePosition( event, true );

					draggable._trigger( "fromSortable", event );

					// Inform draggable that the helper is no longer in a valid drop zone
					draggable.dropped = false;

					// Need to refreshPositions of all sortables just in case removing
					// from one sortable changes the location of other sortables (#9675)
					$.each( draggable.sortables, function() {
						this.refreshPositions();
					});
				}
			}
		});
	}
});

$.ui.plugin.add("draggable", "cursor", {
	start: function( event, ui, instance ) {
		var t = $( "body" ),
			o = instance.options;

		if (t.css("cursor")) {
			o._cursor = t.css("cursor");
		}
		t.css("cursor", o.cursor);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if (o._cursor) {
			$("body").css("cursor", o._cursor);
		}
	}
});

$.ui.plugin.add("draggable", "opacity", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;
		if (t.css("opacity")) {
			o._opacity = t.css("opacity");
		}
		t.css("opacity", o.opacity);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;
		if (o._opacity) {
			$(ui.helper).css("opacity", o._opacity);
		}
	}
});

$.ui.plugin.add("draggable", "scroll", {
	start: function( event, ui, i ) {
		if ( !i.scrollParentNotHidden ) {
			i.scrollParentNotHidden = i.helper.scrollParent( false );
		}

		if ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] && i.scrollParentNotHidden[ 0 ].tagName !== "HTML" ) {
			i.overflowOffset = i.scrollParentNotHidden.offset();
		}
	},
	drag: function( event, ui, i  ) {

		var o = i.options,
			scrolled = false,
			scrollParent = i.scrollParentNotHidden[ 0 ],
			document = i.document[ 0 ];

		if ( scrollParent !== document && scrollParent.tagName !== "HTML" ) {
			if ( !o.axis || o.axis !== "x" ) {
				if ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;
				} else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {
					scrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;
				}
			}

			if ( !o.axis || o.axis !== "y" ) {
				if ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;
				} else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {
					scrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;
				}
			}

		} else {

			if (!o.axis || o.axis !== "x") {
				if (event.pageY - $(document).scrollTop() < o.scrollSensitivity) {
					scrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed);
				} else if ($(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity) {
					scrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed);
				}
			}

			if (!o.axis || o.axis !== "y") {
				if (event.pageX - $(document).scrollLeft() < o.scrollSensitivity) {
					scrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);
				} else if ($(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity) {
					scrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);
				}
			}

		}

		if (scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(i, event);
		}

	}
});

$.ui.plugin.add("draggable", "snap", {
	start: function( event, ui, i ) {

		var o = i.options;

		i.snapElements = [];

		$(o.snap.constructor !== String ? ( o.snap.items || ":data(ui-draggable)" ) : o.snap).each(function() {
			var $t = $(this),
				$o = $t.offset();
			if (this !== i.element[0]) {
				i.snapElements.push({
					item: this,
					width: $t.outerWidth(), height: $t.outerHeight(),
					top: $o.top, left: $o.left
				});
			}
		});

	},
	drag: function( event, ui, inst ) {

		var ts, bs, ls, rs, l, r, t, b, i, first,
			o = inst.options,
			d = o.snapTolerance,
			x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,
			y1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;

		for (i = inst.snapElements.length - 1; i >= 0; i--){

			l = inst.snapElements[i].left - inst.margins.left;
			r = l + inst.snapElements[i].width;
			t = inst.snapElements[i].top - inst.margins.top;
			b = t + inst.snapElements[i].height;

			if ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d || !$.contains( inst.snapElements[ i ].item.ownerDocument, inst.snapElements[ i ].item ) ) {
				if (inst.snapElements[i].snapping) {
					(inst.options.snap.release && inst.options.snap.release.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));
				}
				inst.snapElements[i].snapping = false;
				continue;
			}

			if (o.snapMode !== "inner") {
				ts = Math.abs(t - y2) <= d;
				bs = Math.abs(b - y1) <= d;
				ls = Math.abs(l - x2) <= d;
				rs = Math.abs(r - x1) <= d;
				if (ts) {
					ui.position.top = inst._convertPositionTo("relative", { top: t - inst.helperProportions.height, left: 0 }).top;
				}
				if (bs) {
					ui.position.top = inst._convertPositionTo("relative", { top: b, left: 0 }).top;
				}
				if (ls) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: l - inst.helperProportions.width }).left;
				}
				if (rs) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: r }).left;
				}
			}

			first = (ts || bs || ls || rs);

			if (o.snapMode !== "outer") {
				ts = Math.abs(t - y1) <= d;
				bs = Math.abs(b - y2) <= d;
				ls = Math.abs(l - x1) <= d;
				rs = Math.abs(r - x2) <= d;
				if (ts) {
					ui.position.top = inst._convertPositionTo("relative", { top: t, left: 0 }).top;
				}
				if (bs) {
					ui.position.top = inst._convertPositionTo("relative", { top: b - inst.helperProportions.height, left: 0 }).top;
				}
				if (ls) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: l }).left;
				}
				if (rs) {
					ui.position.left = inst._convertPositionTo("relative", { top: 0, left: r - inst.helperProportions.width }).left;
				}
			}

			if (!inst.snapElements[i].snapping && (ts || bs || ls || rs || first)) {
				(inst.options.snap.snap && inst.options.snap.snap.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));
			}
			inst.snapElements[i].snapping = (ts || bs || ls || rs || first);

		}

	}
});

$.ui.plugin.add("draggable", "stack", {
	start: function( event, ui, instance ) {
		var min,
			o = instance.options,
			group = $.makeArray($(o.stack)).sort(function(a, b) {
				return (parseInt($(a).css("zIndex"), 10) || 0) - (parseInt($(b).css("zIndex"), 10) || 0);
			});

		if (!group.length) { return; }

		min = parseInt($(group[0]).css("zIndex"), 10) || 0;
		$(group).each(function(i) {
			$(this).css("zIndex", min + i);
		});
		this.css("zIndex", (min + group.length));
	}
});

$.ui.plugin.add("draggable", "zIndex", {
	start: function( event, ui, instance ) {
		var t = $( ui.helper ),
			o = instance.options;

		if (t.css("zIndex")) {
			o._zIndex = t.css("zIndex");
		}
		t.css("zIndex", o.zIndex);
	},
	stop: function( event, ui, instance ) {
		var o = instance.options;

		if (o._zIndex) {
			$(ui.helper).css("zIndex", o._zIndex);
		}
	}
});

var draggable = $.ui.draggable;


/*!
 * jQuery UI Sortable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 */


var sortable = $.widget("ui.sortable", $.ui.mouse, {
	version: "1.11.4",
	widgetEventPrefix: "sort",
	ready: false,
	options: {
		appendTo: "parent",
		axis: false,
		connectWith: false,
		containment: false,
		cursor: "auto",
		cursorAt: false,
		dropOnEmpty: true,
		forcePlaceholderSize: false,
		forceHelperSize: false,
		grid: false,
		handle: false,
		helper: "original",
		items: "> *",
		opacity: false,
		placeholder: false,
		revert: false,
		scroll: true,
		scrollSensitivity: 20,
		scrollSpeed: 20,
		scope: "default",
		tolerance: "intersect",
		zIndex: 1000,

		// callbacks
		activate: null,
		beforeStop: null,
		change: null,
		deactivate: null,
		out: null,
		over: null,
		receive: null,
		remove: null,
		sort: null,
		start: null,
		stop: null,
		update: null
	},

	_isOverAxis: function( x, reference, size ) {
		return ( x >= reference ) && ( x < ( reference + size ) );
	},

	_isFloating: function( item ) {
		return (/left|right/).test(item.css("float")) || (/inline|table-cell/).test(item.css("display"));
	},

	_create: function() {
		this.containerCache = {};
		this.element.addClass("ui-sortable");

		//Get the items
		this.refresh();

		//Let's determine the parent's offset
		this.offset = this.element.offset();

		//Initialize mouse events for interaction
		this._mouseInit();

		this._setHandleClassName();

		//We're ready to go
		this.ready = true;

	},

	_setOption: function( key, value ) {
		this._super( key, value );

		if ( key === "handle" ) {
			this._setHandleClassName();
		}
	},

	_setHandleClassName: function() {
		this.element.find( ".ui-sortable-handle" ).removeClass( "ui-sortable-handle" );
		$.each( this.items, function() {
			( this.instance.options.handle ?
				this.item.find( this.instance.options.handle ) : this.item )
				.addClass( "ui-sortable-handle" );
		});
	},

	_destroy: function() {
		this.element
			.removeClass( "ui-sortable ui-sortable-disabled" )
			.find( ".ui-sortable-handle" )
				.removeClass( "ui-sortable-handle" );
		this._mouseDestroy();

		for ( var i = this.items.length - 1; i >= 0; i-- ) {
			this.items[i].item.removeData(this.widgetName + "-item");
		}

		return this;
	},

	_mouseCapture: function(event, overrideHandle) {
		var currentItem = null,
			validHandle = false,
			that = this;

		if (this.reverting) {
			return false;
		}

		if(this.options.disabled || this.options.type === "static") {
			return false;
		}

		//We have to refresh the items data once first
		this._refreshItems(event);

		//Find out if the clicked node (or one of its parents) is a actual item in this.items
		$(event.target).parents().each(function() {
			if($.data(this, that.widgetName + "-item") === that) {
				currentItem = $(this);
				return false;
			}
		});
		if($.data(event.target, that.widgetName + "-item") === that) {
			currentItem = $(event.target);
		}

		if(!currentItem) {
			return false;
		}
		if(this.options.handle && !overrideHandle) {
			$(this.options.handle, currentItem).find("*").addBack().each(function() {
				if(this === event.target) {
					validHandle = true;
				}
			});
			if(!validHandle) {
				return false;
			}
		}

		this.currentItem = currentItem;
		this._removeCurrentsFromItems();
		return true;

	},

	_mouseStart: function(event, overrideHandle, noActivation) {

		var i, body,
			o = this.options;

		this.currentContainer = this;

		//We only need to call refreshPositions, because the refreshItems call has been moved to mouseCapture
		this.refreshPositions();

		//Create and append the visible helper
		this.helper = this._createHelper(event);

		//Cache the helper size
		this._cacheHelperProportions();

		/*
		 * - Position generation -
		 * This block generates everything position related - it's the core of draggables.
		 */

		//Cache the margins of the original element
		this._cacheMargins();

		//Get the next scrolling parent
		this.scrollParent = this.helper.scrollParent();

		//The element's absolute position on the page minus margins
		this.offset = this.currentItem.offset();
		this.offset = {
			top: this.offset.top - this.margins.top,
			left: this.offset.left - this.margins.left
		};

		$.extend(this.offset, {
			click: { //Where the click happened, relative to the element
				left: event.pageX - this.offset.left,
				top: event.pageY - this.offset.top
			},
			parent: this._getParentOffset(),
			relative: this._getRelativeOffset() //This is a relative to absolute position minus the actual position calculation - only used for relative positioned helper
		});

		// Only after we got the offset, we can change the helper's position to absolute
		// TODO: Still need to figure out a way to make relative sorting possible
		this.helper.css("position", "absolute");
		this.cssPosition = this.helper.css("position");

		//Generate the original position
		this.originalPosition = this._generatePosition(event);
		this.originalPageX = event.pageX;
		this.originalPageY = event.pageY;

		//Adjust the mouse offset relative to the helper if "cursorAt" is supplied
		(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));

		//Cache the former DOM position
		this.domPosition = { prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0] };

		//If the helper is not the original, hide the original so it's not playing any role during the drag, won't cause anything bad this way
		if(this.helper[0] !== this.currentItem[0]) {
			this.currentItem.hide();
		}

		//Create the placeholder
		this._createPlaceholder();

		//Set a containment if given in the options
		if(o.containment) {
			this._setContainment();
		}

		if( o.cursor && o.cursor !== "auto" ) { // cursor option
			body = this.document.find( "body" );

			// support: IE
			this.storedCursor = body.css( "cursor" );
			body.css( "cursor", o.cursor );

			this.storedStylesheet = $( "<style>*{ cursor: "+o.cursor+" !important; }</style>" ).appendTo( body );
		}

		if(o.opacity) { // opacity option
			if (this.helper.css("opacity")) {
				this._storedOpacity = this.helper.css("opacity");
			}
			this.helper.css("opacity", o.opacity);
		}

		if(o.zIndex) { // zIndex option
			if (this.helper.css("zIndex")) {
				this._storedZIndex = this.helper.css("zIndex");
			}
			this.helper.css("zIndex", o.zIndex);
		}

		//Prepare scrolling
		if(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {
			this.overflowOffset = this.scrollParent.offset();
		}

		//Call callbacks
		this._trigger("start", event, this._uiHash());

		//Recache the helper size
		if(!this._preserveHelperProportions) {
			this._cacheHelperProportions();
		}


		//Post "activate" events to possible containers
		if( !noActivation ) {
			for ( i = this.containers.length - 1; i >= 0; i-- ) {
				this.containers[ i ]._trigger( "activate", event, this._uiHash( this ) );
			}
		}

		//Prepare possible droppables
		if($.ui.ddmanager) {
			$.ui.ddmanager.current = this;
		}

		if ($.ui.ddmanager && !o.dropBehaviour) {
			$.ui.ddmanager.prepareOffsets(this, event);
		}

		this.dragging = true;

		this.helper.addClass("ui-sortable-helper");
		this._mouseDrag(event); //Execute the drag once - this causes the helper not to be visible before getting its correct position
		return true;

	},

	_mouseDrag: function(event) {
		var i, item, itemElement, intersection,
			o = this.options,
			scrolled = false;

		//Compute the helpers position
		this.position = this._generatePosition(event);
		this.positionAbs = this._convertPositionTo("absolute");

		if (!this.lastPositionAbs) {
			this.lastPositionAbs = this.positionAbs;
		}

		//Do scrolling
		if(this.options.scroll) {
			if(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== "HTML") {

				if((this.overflowOffset.top + this.scrollParent[0].offsetHeight) - event.pageY < o.scrollSensitivity) {
					this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop + o.scrollSpeed;
				} else if(event.pageY - this.overflowOffset.top < o.scrollSensitivity) {
					this.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop - o.scrollSpeed;
				}

				if((this.overflowOffset.left + this.scrollParent[0].offsetWidth) - event.pageX < o.scrollSensitivity) {
					this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft + o.scrollSpeed;
				} else if(event.pageX - this.overflowOffset.left < o.scrollSensitivity) {
					this.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft - o.scrollSpeed;
				}

			} else {

				if(event.pageY - this.document.scrollTop() < o.scrollSensitivity) {
					scrolled = this.document.scrollTop(this.document.scrollTop() - o.scrollSpeed);
				} else if(this.window.height() - (event.pageY - this.document.scrollTop()) < o.scrollSensitivity) {
					scrolled = this.document.scrollTop(this.document.scrollTop() + o.scrollSpeed);
				}

				if(event.pageX - this.document.scrollLeft() < o.scrollSensitivity) {
					scrolled = this.document.scrollLeft(this.document.scrollLeft() - o.scrollSpeed);
				} else if(this.window.width() - (event.pageX - this.document.scrollLeft()) < o.scrollSensitivity) {
					scrolled = this.document.scrollLeft(this.document.scrollLeft() + o.scrollSpeed);
				}

			}

			if(scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {
				$.ui.ddmanager.prepareOffsets(this, event);
			}
		}

		//Regenerate the absolute position used for position checks
		this.positionAbs = this._convertPositionTo("absolute");

		//Set the helper position
		if(!this.options.axis || this.options.axis !== "y") {
			this.helper[0].style.left = this.position.left+"px";
		}
		if(!this.options.axis || this.options.axis !== "x") {
			this.helper[0].style.top = this.position.top+"px";
		}

		//Rearrange
		for (i = this.items.length - 1; i >= 0; i--) {

			//Cache variables and intersection, continue if no intersection
			item = this.items[i];
			itemElement = item.item[0];
			intersection = this._intersectsWithPointer(item);
			if (!intersection) {
				continue;
			}

			// Only put the placeholder inside the current Container, skip all
			// items from other containers. This works because when moving
			// an item from one container to another the
			// currentContainer is switched before the placeholder is moved.
			//
			// Without this, moving items in "sub-sortables" can cause
			// the placeholder to jitter between the outer and inner container.
			if (item.instance !== this.currentContainer) {
				continue;
			}

			// cannot intersect with itself
			// no useless actions that have been done before
			// no action if the item moved is the parent of the item checked
			if (itemElement !== this.currentItem[0] &&
				this.placeholder[intersection === 1 ? "next" : "prev"]()[0] !== itemElement &&
				!$.contains(this.placeholder[0], itemElement) &&
				(this.options.type === "semi-dynamic" ? !$.contains(this.element[0], itemElement) : true)
			) {

				this.direction = intersection === 1 ? "down" : "up";

				if (this.options.tolerance === "pointer" || this._intersectsWithSides(item)) {
					this._rearrange(event, item);
				} else {
					break;
				}

				this._trigger("change", event, this._uiHash());
				break;
			}
		}

		//Post events to containers
		this._contactContainers(event);

		//Interconnect with droppables
		if($.ui.ddmanager) {
			$.ui.ddmanager.drag(this, event);
		}

		//Call callbacks
		this._trigger("sort", event, this._uiHash());

		this.lastPositionAbs = this.positionAbs;
		return false;

	},

	_mouseStop: function(event, noPropagation) {

		if(!event) {
			return;
		}

		//If we are using droppables, inform the manager about the drop
		if ($.ui.ddmanager && !this.options.dropBehaviour) {
			$.ui.ddmanager.drop(this, event);
		}

		if(this.options.revert) {
			var that = this,
				cur = this.placeholder.offset(),
				axis = this.options.axis,
				animation = {};

			if ( !axis || axis === "x" ) {
				animation.left = cur.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollLeft);
			}
			if ( !axis || axis === "y" ) {
				animation.top = cur.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollTop);
			}
			this.reverting = true;
			$(this.helper).animate( animation, parseInt(this.options.revert, 10) || 500, function() {
				that._clear(event);
			});
		} else {
			this._clear(event, noPropagation);
		}

		return false;

	},

	cancel: function() {

		if(this.dragging) {

			this._mouseUp({ target: null });

			if(this.options.helper === "original") {
				this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
			} else {
				this.currentItem.show();
			}

			//Post deactivating events to containers
			for (var i = this.containers.length - 1; i >= 0; i--){
				this.containers[i]._trigger("deactivate", null, this._uiHash(this));
				if(this.containers[i].containerCache.over) {
					this.containers[i]._trigger("out", null, this._uiHash(this));
					this.containers[i].containerCache.over = 0;
				}
			}

		}

		if (this.placeholder) {
			//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!
			if(this.placeholder[0].parentNode) {
				this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
			}
			if(this.options.helper !== "original" && this.helper && this.helper[0].parentNode) {
				this.helper.remove();
			}

			$.extend(this, {
				helper: null,
				dragging: false,
				reverting: false,
				_noFinalSort: null
			});

			if(this.domPosition.prev) {
				$(this.domPosition.prev).after(this.currentItem);
			} else {
				$(this.domPosition.parent).prepend(this.currentItem);
			}
		}

		return this;

	},

	serialize: function(o) {

		var items = this._getItemsAsjQuery(o && o.connected),
			str = [];
		o = o || {};

		$(items).each(function() {
			var res = ($(o.item || this).attr(o.attribute || "id") || "").match(o.expression || (/(.+)[\-=_](.+)/));
			if (res) {
				str.push((o.key || res[1]+"[]")+"="+(o.key && o.expression ? res[1] : res[2]));
			}
		});

		if(!str.length && o.key) {
			str.push(o.key + "=");
		}

		return str.join("&");

	},

	toArray: function(o) {

		var items = this._getItemsAsjQuery(o && o.connected),
			ret = [];

		o = o || {};

		items.each(function() { ret.push($(o.item || this).attr(o.attribute || "id") || ""); });
		return ret;

	},

	/* Be careful with the following core functions */
	_intersectsWith: function(item) {

		var x1 = this.positionAbs.left,
			x2 = x1 + this.helperProportions.width,
			y1 = this.positionAbs.top,
			y2 = y1 + this.helperProportions.height,
			l = item.left,
			r = l + item.width,
			t = item.top,
			b = t + item.height,
			dyClick = this.offset.click.top,
			dxClick = this.offset.click.left,
			isOverElementHeight = ( this.options.axis === "x" ) || ( ( y1 + dyClick ) > t && ( y1 + dyClick ) < b ),
			isOverElementWidth = ( this.options.axis === "y" ) || ( ( x1 + dxClick ) > l && ( x1 + dxClick ) < r ),
			isOverElement = isOverElementHeight && isOverElementWidth;

		if ( this.options.tolerance === "pointer" ||
			this.options.forcePointerForContainers ||
			(this.options.tolerance !== "pointer" && this.helperProportions[this.floating ? "width" : "height"] > item[this.floating ? "width" : "height"])
		) {
			return isOverElement;
		} else {

			return (l < x1 + (this.helperProportions.width / 2) && // Right Half
				x2 - (this.helperProportions.width / 2) < r && // Left Half
				t < y1 + (this.helperProportions.height / 2) && // Bottom Half
				y2 - (this.helperProportions.height / 2) < b ); // Top Half

		}
	},

	_intersectsWithPointer: function(item) {

		var isOverElementHeight = (this.options.axis === "x") || this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top, item.height),
			isOverElementWidth = (this.options.axis === "y") || this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left, item.width),
			isOverElement = isOverElementHeight && isOverElementWidth,
			verticalDirection = this._getDragVerticalDirection(),
			horizontalDirection = this._getDragHorizontalDirection();

		if (!isOverElement) {
			return false;
		}

		return this.floating ?
			( ((horizontalDirection && horizontalDirection === "right") || verticalDirection === "down") ? 2 : 1 )
			: ( verticalDirection && (verticalDirection === "down" ? 2 : 1) );

	},

	_intersectsWithSides: function(item) {

		var isOverBottomHalf = this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top + (item.height/2), item.height),
			isOverRightHalf = this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left + (item.width/2), item.width),
			verticalDirection = this._getDragVerticalDirection(),
			horizontalDirection = this._getDragHorizontalDirection();

		if (this.floating && horizontalDirection) {
			return ((horizontalDirection === "right" && isOverRightHalf) || (horizontalDirection === "left" && !isOverRightHalf));
		} else {
			return verticalDirection && ((verticalDirection === "down" && isOverBottomHalf) || (verticalDirection === "up" && !isOverBottomHalf));
		}

	},

	_getDragVerticalDirection: function() {
		var delta = this.positionAbs.top - this.lastPositionAbs.top;
		return delta !== 0 && (delta > 0 ? "down" : "up");
	},

	_getDragHorizontalDirection: function() {
		var delta = this.positionAbs.left - this.lastPositionAbs.left;
		return delta !== 0 && (delta > 0 ? "right" : "left");
	},

	refresh: function(event) {
		this._refreshItems(event);
		this._setHandleClassName();
		this.refreshPositions();
		return this;
	},

	_connectWith: function() {
		var options = this.options;
		return options.connectWith.constructor === String ? [options.connectWith] : options.connectWith;
	},

	_getItemsAsjQuery: function(connected) {

		var i, j, cur, inst,
			items = [],
			queries = [],
			connectWith = this._connectWith();

		if(connectWith && connected) {
			for (i = connectWith.length - 1; i >= 0; i--){
				cur = $(connectWith[i], this.document[0]);
				for ( j = cur.length - 1; j >= 0; j--){
					inst = $.data(cur[j], this.widgetFullName);
					if(inst && inst !== this && !inst.options.disabled) {
						queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element) : $(inst.options.items, inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), inst]);
					}
				}
			}
		}

		queries.push([$.isFunction(this.options.items) ? this.options.items.call(this.element, null, { options: this.options, item: this.currentItem }) : $(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);

		function addItems() {
			items.push( this );
		}
		for (i = queries.length - 1; i >= 0; i--){
			queries[i][0].each( addItems );
		}

		return $(items);

	},

	_removeCurrentsFromItems: function() {

		var list = this.currentItem.find(":data(" + this.widgetName + "-item)");

		this.items = $.grep(this.items, function (item) {
			for (var j=0; j < list.length; j++) {
				if(list[j] === item.item[0]) {
					return false;
				}
			}
			return true;
		});

	},

	_refreshItems: function(event) {

		this.items = [];
		this.containers = [this];

		var i, j, cur, inst, targetData, _queries, item, queriesLength,
			items = this.items,
			queries = [[$.isFunction(this.options.items) ? this.options.items.call(this.element[0], event, { item: this.currentItem }) : $(this.options.items, this.element), this]],
			connectWith = this._connectWith();

		if(connectWith && this.ready) { //Shouldn't be run the first time through due to massive slow-down
			for (i = connectWith.length - 1; i >= 0; i--){
				cur = $(connectWith[i], this.document[0]);
				for (j = cur.length - 1; j >= 0; j--){
					inst = $.data(cur[j], this.widgetFullName);
					if(inst && inst !== this && !inst.options.disabled) {
						queries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element[0], event, { item: this.currentItem }) : $(inst.options.items, inst.element), inst]);
						this.containers.push(inst);
					}
				}
			}
		}

		for (i = queries.length - 1; i >= 0; i--) {
			targetData = queries[i][1];
			_queries = queries[i][0];

			for (j=0, queriesLength = _queries.length; j < queriesLength; j++) {
				item = $(_queries[j]);

				item.data(this.widgetName + "-item", targetData); // Data for target checking (mouse manager)

				items.push({
					item: item,
					instance: targetData,
					width: 0, height: 0,
					left: 0, top: 0
				});
			}
		}

	},

	refreshPositions: function(fast) {

		// Determine whether items are being displayed horizontally
		this.floating = this.items.length ?
			this.options.axis === "x" || this._isFloating( this.items[ 0 ].item ) :
			false;

		//This has to be redone because due to the item being moved out/into the offsetParent, the offsetParent's position will change
		if(this.offsetParent && this.helper) {
			this.offset.parent = this._getParentOffset();
		}

		var i, item, t, p;

		for (i = this.items.length - 1; i >= 0; i--){
			item = this.items[i];

			//We ignore calculating positions of all connected containers when we're not over them
			if(item.instance !== this.currentContainer && this.currentContainer && item.item[0] !== this.currentItem[0]) {
				continue;
			}

			t = this.options.toleranceElement ? $(this.options.toleranceElement, item.item) : item.item;

			if (!fast) {
				item.width = t.outerWidth();
				item.height = t.outerHeight();
			}

			p = t.offset();
			item.left = p.left;
			item.top = p.top;
		}

		if(this.options.custom && this.options.custom.refreshContainers) {
			this.options.custom.refreshContainers.call(this);
		} else {
			for (i = this.containers.length - 1; i >= 0; i--){
				p = this.containers[i].element.offset();
				this.containers[i].containerCache.left = p.left;
				this.containers[i].containerCache.top = p.top;
				this.containers[i].containerCache.width = this.containers[i].element.outerWidth();
				this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
			}
		}

		return this;
	},

	_createPlaceholder: function(that) {
		that = that || this;
		var className,
			o = that.options;

		if(!o.placeholder || o.placeholder.constructor === String) {
			className = o.placeholder;
			o.placeholder = {
				element: function() {

					var nodeName = that.currentItem[0].nodeName.toLowerCase(),
						element = $( "<" + nodeName + ">", that.document[0] )
							.addClass(className || that.currentItem[0].className+" ui-sortable-placeholder")
							.removeClass("ui-sortable-helper");

					if ( nodeName === "tbody" ) {
						that._createTrPlaceholder(
							that.currentItem.find( "tr" ).eq( 0 ),
							$( "<tr>", that.document[ 0 ] ).appendTo( element )
						);
					} else if ( nodeName === "tr" ) {
						that._createTrPlaceholder( that.currentItem, element );
					} else if ( nodeName === "img" ) {
						element.attr( "src", that.currentItem.attr( "src" ) );
					}

					if ( !className ) {
						element.css( "visibility", "hidden" );
					}

					return element;
				},
				update: function(container, p) {

					// 1. If a className is set as 'placeholder option, we don't force sizes - the class is responsible for that
					// 2. The option 'forcePlaceholderSize can be enabled to force it even if a class name is specified
					if(className && !o.forcePlaceholderSize) {
						return;
					}

					//If the element doesn't have a actual height by itself (without styles coming from a stylesheet), it receives the inline height from the dragged item
					if(!p.height()) { p.height(that.currentItem.innerHeight() - parseInt(that.currentItem.css("paddingTop")||0, 10) - parseInt(that.currentItem.css("paddingBottom")||0, 10)); }
					if(!p.width()) { p.width(that.currentItem.innerWidth() - parseInt(that.currentItem.css("paddingLeft")||0, 10) - parseInt(that.currentItem.css("paddingRight")||0, 10)); }
				}
			};
		}

		//Create the placeholder
		that.placeholder = $(o.placeholder.element.call(that.element, that.currentItem));

		//Append it after the actual current item
		that.currentItem.after(that.placeholder);

		//Update the size of the placeholder (TODO: Logic to fuzzy, see line 316/317)
		o.placeholder.update(that, that.placeholder);

	},

	_createTrPlaceholder: function( sourceTr, targetTr ) {
		var that = this;

		sourceTr.children().each(function() {
			$( "<td>&#160;</td>", that.document[ 0 ] )
				.attr( "colspan", $( this ).attr( "colspan" ) || 1 )
				.appendTo( targetTr );
		});
	},

	_contactContainers: function(event) {
		var i, j, dist, itemWithLeastDistance, posProperty, sizeProperty, cur, nearBottom, floating, axis,
			innermostContainer = null,
			innermostIndex = null;

		// get innermost container that intersects with item
		for (i = this.containers.length - 1; i >= 0; i--) {

			// never consider a container that's located within the item itself
			if($.contains(this.currentItem[0], this.containers[i].element[0])) {
				continue;
			}

			if(this._intersectsWith(this.containers[i].containerCache)) {

				// if we've already found a container and it's more "inner" than this, then continue
				if(innermostContainer && $.contains(this.containers[i].element[0], innermostContainer.element[0])) {
					continue;
				}

				innermostContainer = this.containers[i];
				innermostIndex = i;

			} else {
				// container doesn't intersect. trigger "out" event if necessary
				if(this.containers[i].containerCache.over) {
					this.containers[i]._trigger("out", event, this._uiHash(this));
					this.containers[i].containerCache.over = 0;
				}
			}

		}

		// if no intersecting containers found, return
		if(!innermostContainer) {
			return;
		}

		// move the item into the container if it's not there already
		if(this.containers.length === 1) {
			if (!this.containers[innermostIndex].containerCache.over) {
				this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
				this.containers[innermostIndex].containerCache.over = 1;
			}
		} else {

			//When entering a new container, we will find the item with the least distance and append our item near it
			dist = 10000;
			itemWithLeastDistance = null;
			floating = innermostContainer.floating || this._isFloating(this.currentItem);
			posProperty = floating ? "left" : "top";
			sizeProperty = floating ? "width" : "height";
			axis = floating ? "clientX" : "clientY";

			for (j = this.items.length - 1; j >= 0; j--) {
				if(!$.contains(this.containers[innermostIndex].element[0], this.items[j].item[0])) {
					continue;
				}
				if(this.items[j].item[0] === this.currentItem[0]) {
					continue;
				}

				cur = this.items[j].item.offset()[posProperty];
				nearBottom = false;
				if ( event[ axis ] - cur > this.items[ j ][ sizeProperty ] / 2 ) {
					nearBottom = true;
				}

				if ( Math.abs( event[ axis ] - cur ) < dist ) {
					dist = Math.abs( event[ axis ] - cur );
					itemWithLeastDistance = this.items[ j ];
					this.direction = nearBottom ? "up": "down";
				}
			}

			//Check if dropOnEmpty is enabled
			if(!itemWithLeastDistance && !this.options.dropOnEmpty) {
				return;
			}

			if(this.currentContainer === this.containers[innermostIndex]) {
				if ( !this.currentContainer.containerCache.over ) {
					this.containers[ innermostIndex ]._trigger( "over", event, this._uiHash() );
					this.currentContainer.containerCache.over = 1;
				}
				return;
			}

			itemWithLeastDistance ? this._rearrange(event, itemWithLeastDistance, null, true) : this._rearrange(event, null, this.containers[innermostIndex].element, true);
			this._trigger("change", event, this._uiHash());
			this.containers[innermostIndex]._trigger("change", event, this._uiHash(this));
			this.currentContainer = this.containers[innermostIndex];

			//Update the placeholder
			this.options.placeholder.update(this.currentContainer, this.placeholder);

			this.containers[innermostIndex]._trigger("over", event, this._uiHash(this));
			this.containers[innermostIndex].containerCache.over = 1;
		}


	},

	_createHelper: function(event) {

		var o = this.options,
			helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event, this.currentItem])) : (o.helper === "clone" ? this.currentItem.clone() : this.currentItem);

		//Add the helper to the DOM if that didn't happen already
		if(!helper.parents("body").length) {
			$(o.appendTo !== "parent" ? o.appendTo : this.currentItem[0].parentNode)[0].appendChild(helper[0]);
		}

		if(helper[0] === this.currentItem[0]) {
			this._storedCSS = { width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css("position"), top: this.currentItem.css("top"), left: this.currentItem.css("left") };
		}

		if(!helper[0].style.width || o.forceHelperSize) {
			helper.width(this.currentItem.width());
		}
		if(!helper[0].style.height || o.forceHelperSize) {
			helper.height(this.currentItem.height());
		}

		return helper;

	},

	_adjustOffsetFromHelper: function(obj) {
		if (typeof obj === "string") {
			obj = obj.split(" ");
		}
		if ($.isArray(obj)) {
			obj = {left: +obj[0], top: +obj[1] || 0};
		}
		if ("left" in obj) {
			this.offset.click.left = obj.left + this.margins.left;
		}
		if ("right" in obj) {
			this.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;
		}
		if ("top" in obj) {
			this.offset.click.top = obj.top + this.margins.top;
		}
		if ("bottom" in obj) {
			this.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;
		}
	},

	_getParentOffset: function() {


		//Get the offsetParent and cache its position
		this.offsetParent = this.helper.offsetParent();
		var po = this.offsetParent.offset();

		// This is a special case where we need to modify a offset calculated on start, since the following happened:
		// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent
		// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that
		//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag
		if(this.cssPosition === "absolute" && this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) {
			po.left += this.scrollParent.scrollLeft();
			po.top += this.scrollParent.scrollTop();
		}

		// This needs to be actually done for all browsers, since pageX/pageY includes this information
		// with an ugly IE fix
		if( this.offsetParent[0] === this.document[0].body || (this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === "html" && $.ui.ie)) {
			po = { top: 0, left: 0 };
		}

		return {
			top: po.top + (parseInt(this.offsetParent.css("borderTopWidth"),10) || 0),
			left: po.left + (parseInt(this.offsetParent.css("borderLeftWidth"),10) || 0)
		};

	},

	_getRelativeOffset: function() {

		if(this.cssPosition === "relative") {
			var p = this.currentItem.position();
			return {
				top: p.top - (parseInt(this.helper.css("top"),10) || 0) + this.scrollParent.scrollTop(),
				left: p.left - (parseInt(this.helper.css("left"),10) || 0) + this.scrollParent.scrollLeft()
			};
		} else {
			return { top: 0, left: 0 };
		}

	},

	_cacheMargins: function() {
		this.margins = {
			left: (parseInt(this.currentItem.css("marginLeft"),10) || 0),
			top: (parseInt(this.currentItem.css("marginTop"),10) || 0)
		};
	},

	_cacheHelperProportions: function() {
		this.helperProportions = {
			width: this.helper.outerWidth(),
			height: this.helper.outerHeight()
		};
	},

	_setContainment: function() {

		var ce, co, over,
			o = this.options;
		if(o.containment === "parent") {
			o.containment = this.helper[0].parentNode;
		}
		if(o.containment === "document" || o.containment === "window") {
			this.containment = [
				0 - this.offset.relative.left - this.offset.parent.left,
				0 - this.offset.relative.top - this.offset.parent.top,
				o.containment === "document" ? this.document.width() : this.window.width() - this.helperProportions.width - this.margins.left,
				(o.containment === "document" ? this.document.width() : this.window.height() || this.document[0].body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top
			];
		}

		if(!(/^(document|window|parent)$/).test(o.containment)) {
			ce = $(o.containment)[0];
			co = $(o.containment).offset();
			over = ($(ce).css("overflow") !== "hidden");

			this.containment = [
				co.left + (parseInt($(ce).css("borderLeftWidth"),10) || 0) + (parseInt($(ce).css("paddingLeft"),10) || 0) - this.margins.left,
				co.top + (parseInt($(ce).css("borderTopWidth"),10) || 0) + (parseInt($(ce).css("paddingTop"),10) || 0) - this.margins.top,
				co.left+(over ? Math.max(ce.scrollWidth,ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css("borderLeftWidth"),10) || 0) - (parseInt($(ce).css("paddingRight"),10) || 0) - this.helperProportions.width - this.margins.left,
				co.top+(over ? Math.max(ce.scrollHeight,ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css("borderTopWidth"),10) || 0) - (parseInt($(ce).css("paddingBottom"),10) || 0) - this.helperProportions.height - this.margins.top
			];
		}

	},

	_convertPositionTo: function(d, pos) {

		if(!pos) {
			pos = this.position;
		}
		var mod = d === "absolute" ? 1 : -1,
			scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent,
			scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);

		return {
			top: (
				pos.top	+																// The absolute mouse position
				this.offset.relative.top * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top * mod -											// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ) * mod)
			),
			left: (
				pos.left +																// The absolute mouse position
				this.offset.relative.left * mod +										// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left * mod	-										// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ) * mod)
			)
		};

	},

	_generatePosition: function(event) {

		var top, left,
			o = this.options,
			pageX = event.pageX,
			pageY = event.pageY,
			scroll = this.cssPosition === "absolute" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);

		// This is another very weird special case that only happens for relative elements:
		// 1. If the css position is relative
		// 2. and the scroll parent is the document or similar to the offset parent
		// we have to refresh the relative offset during the scroll so there are no jumps
		if(this.cssPosition === "relative" && !(this.scrollParent[0] !== this.document[0] && this.scrollParent[0] !== this.offsetParent[0])) {
			this.offset.relative = this._getRelativeOffset();
		}

		/*
		 * - Position constraining -
		 * Constrain the position to a mix of grid, containment.
		 */

		if(this.originalPosition) { //If we are not dragging yet, we won't check for options

			if(this.containment) {
				if(event.pageX - this.offset.click.left < this.containment[0]) {
					pageX = this.containment[0] + this.offset.click.left;
				}
				if(event.pageY - this.offset.click.top < this.containment[1]) {
					pageY = this.containment[1] + this.offset.click.top;
				}
				if(event.pageX - this.offset.click.left > this.containment[2]) {
					pageX = this.containment[2] + this.offset.click.left;
				}
				if(event.pageY - this.offset.click.top > this.containment[3]) {
					pageY = this.containment[3] + this.offset.click.top;
				}
			}

			if(o.grid) {
				top = this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1];
				pageY = this.containment ? ( (top - this.offset.click.top >= this.containment[1] && top - this.offset.click.top <= this.containment[3]) ? top : ((top - this.offset.click.top >= this.containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;

				left = this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0];
				pageX = this.containment ? ( (left - this.offset.click.left >= this.containment[0] && left - this.offset.click.left <= this.containment[2]) ? left : ((left - this.offset.click.left >= this.containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;
			}

		}

		return {
			top: (
				pageY -																// The absolute mouse position
				this.offset.click.top -													// Click offset (relative to the element)
				this.offset.relative.top	-											// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.top +												// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ))
			),
			left: (
				pageX -																// The absolute mouse position
				this.offset.click.left -												// Click offset (relative to the element)
				this.offset.relative.left	-											// Only for relative positioned nodes: Relative offset from element to offset parent
				this.offset.parent.left +												// The offsetParent's offset without borders (offset + border)
				( ( this.cssPosition === "fixed" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ))
			)
		};

	},

	_rearrange: function(event, i, a, hardRefresh) {

		a ? a[0].appendChild(this.placeholder[0]) : i.item[0].parentNode.insertBefore(this.placeholder[0], (this.direction === "down" ? i.item[0] : i.item[0].nextSibling));

		//Various things done here to improve the performance:
		// 1. we create a setTimeout, that calls refreshPositions
		// 2. on the instance, we have a counter variable, that get's higher after every append
		// 3. on the local scope, we copy the counter variable, and check in the timeout, if it's still the same
		// 4. this lets only the last addition to the timeout stack through
		this.counter = this.counter ? ++this.counter : 1;
		var counter = this.counter;

		this._delay(function() {
			if(counter === this.counter) {
				this.refreshPositions(!hardRefresh); //Precompute after each DOM insertion, NOT on mousemove
			}
		});

	},

	_clear: function(event, noPropagation) {

		this.reverting = false;
		// We delay all events that have to be triggered to after the point where the placeholder has been removed and
		// everything else normalized again
		var i,
			delayedTriggers = [];

		// We first have to update the dom position of the actual currentItem
		// Note: don't do it if the current item is already removed (by a user), or it gets reappended (see #4088)
		if(!this._noFinalSort && this.currentItem.parent().length) {
			this.placeholder.before(this.currentItem);
		}
		this._noFinalSort = null;

		if(this.helper[0] === this.currentItem[0]) {
			for(i in this._storedCSS) {
				if(this._storedCSS[i] === "auto" || this._storedCSS[i] === "static") {
					this._storedCSS[i] = "";
				}
			}
			this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");
		} else {
			this.currentItem.show();
		}

		if(this.fromOutside && !noPropagation) {
			delayedTriggers.push(function(event) { this._trigger("receive", event, this._uiHash(this.fromOutside)); });
		}
		if((this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !noPropagation) {
			delayedTriggers.push(function(event) { this._trigger("update", event, this._uiHash()); }); //Trigger update callback if the DOM position has changed
		}

		// Check if the items Container has Changed and trigger appropriate
		// events.
		if (this !== this.currentContainer) {
			if(!noPropagation) {
				delayedTriggers.push(function(event) { this._trigger("remove", event, this._uiHash()); });
				delayedTriggers.push((function(c) { return function(event) { c._trigger("receive", event, this._uiHash(this)); };  }).call(this, this.currentContainer));
				delayedTriggers.push((function(c) { return function(event) { c._trigger("update", event, this._uiHash(this));  }; }).call(this, this.currentContainer));
			}
		}


		//Post events to containers
		function delayEvent( type, instance, container ) {
			return function( event ) {
				container._trigger( type, event, instance._uiHash( instance ) );
			};
		}
		for (i = this.containers.length - 1; i >= 0; i--){
			if (!noPropagation) {
				delayedTriggers.push( delayEvent( "deactivate", this, this.containers[ i ] ) );
			}
			if(this.containers[i].containerCache.over) {
				delayedTriggers.push( delayEvent( "out", this, this.containers[ i ] ) );
				this.containers[i].containerCache.over = 0;
			}
		}

		//Do what was originally in plugins
		if ( this.storedCursor ) {
			this.document.find( "body" ).css( "cursor", this.storedCursor );
			this.storedStylesheet.remove();
		}
		if(this._storedOpacity) {
			this.helper.css("opacity", this._storedOpacity);
		}
		if(this._storedZIndex) {
			this.helper.css("zIndex", this._storedZIndex === "auto" ? "" : this._storedZIndex);
		}

		this.dragging = false;

		if(!noPropagation) {
			this._trigger("beforeStop", event, this._uiHash());
		}

		//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!
		this.placeholder[0].parentNode.removeChild(this.placeholder[0]);

		if ( !this.cancelHelperRemoval ) {
			if ( this.helper[ 0 ] !== this.currentItem[ 0 ] ) {
				this.helper.remove();
			}
			this.helper = null;
		}

		if(!noPropagation) {
			for (i=0; i < delayedTriggers.length; i++) {
				delayedTriggers[i].call(this, event);
			} //Trigger all delayed events
			this._trigger("stop", event, this._uiHash());
		}

		this.fromOutside = false;
		return !this.cancelHelperRemoval;

	},

	_trigger: function() {
		if ($.Widget.prototype._trigger.apply(this, arguments) === false) {
			this.cancel();
		}
	},

	_uiHash: function(_inst) {
		var inst = _inst || this;
		return {
			helper: inst.helper,
			placeholder: inst.placeholder || $([]),
			position: inst.position,
			originalPosition: inst.originalPosition,
			offset: inst.positionAbs,
			item: inst.currentItem,
			sender: _inst ? _inst.element : null
		};
	}

});



}));
/* canvas-toBlob.js
 * A canvas.toBlob() implementation.
 * 2013-12-27
 * 
 * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr
 * License: X11/MIT
 *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md
 */

/*global self */
/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,
  plusplus: true */

/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */

(function(view) {
"use strict";
var
	  Uint8Array = view.Uint8Array
	, HTMLCanvasElement = view.HTMLCanvasElement
	, canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype
	, is_base64_regex = /\s*;\s*base64\s*(?:;|$)/i
	, to_data_url = "toDataURL"
	, base64_ranks
	, decode_base64 = function(base64) {
		var
			  len = base64.length
			, buffer = new Uint8Array(len / 4 * 3 | 0)
			, i = 0
			, outptr = 0
			, last = [0, 0]
			, state = 0
			, save = 0
			, rank
			, code
			, undef
		;
		while (len--) {
			code = base64.charCodeAt(i++);
			rank = base64_ranks[code-43];
			if (rank !== 255 && rank !== undef) {
				last[1] = last[0];
				last[0] = code;
				save = (save << 6) | rank;
				state++;
				if (state === 4) {
					buffer[outptr++] = save >>> 16;
					if (last[1] !== 61 /* padding character */) {
						buffer[outptr++] = save >>> 8;
					}
					if (last[0] !== 61 /* padding character */) {
						buffer[outptr++] = save;
					}
					state = 0;
				}
			}
		}
		// 2/3 chance there's going to be some null bytes at the end, but that
		// doesn't really matter with most image formats.
		// If it somehow matters for you, truncate the buffer up outptr.
		return buffer;
	}
;
if (Uint8Array) {
	base64_ranks = new Uint8Array([
		  62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1
		, -1, -1,  0, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9
		, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25
		, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35
		, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51
	]);
}
if (HTMLCanvasElement && !canvas_proto.toBlob) {
	canvas_proto.toBlob = function(callback, type /*, ...args*/) {
		  if (!type) {
			type = "image/png";
		} if (this.mozGetAsFile) {
			callback(this.mozGetAsFile("canvas", type));
			return;
		} if (this.msToBlob && /^\s*image\/png\s*(?:$|;)/i.test(type)) {
			callback(this.msToBlob());
			return;
		}

		var
			  args = Array.prototype.slice.call(arguments, 1)
			, dataURI = this[to_data_url].apply(this, args)
			, header_end = dataURI.indexOf(",")
			, data = dataURI.substring(header_end + 1)
			, is_base64 = is_base64_regex.test(dataURI.substring(0, header_end))
			, blob
		;
		if (Blob.fake) {
			// no reason to decode a data: URI that's just going to become a data URI again
			blob = new Blob
			if (is_base64) {
				blob.encoding = "base64";
			} else {
				blob.encoding = "URI";
			}
			blob.data = data;
			blob.size = data.length;
		} else if (Uint8Array) {
			if (is_base64) {
				blob = new Blob([decode_base64(data)], {type: type});
			} else {
				blob = new Blob([decodeURIComponent(data)], {type: type});
			}
		}
		callback(blob);
	};

	if (canvas_proto.toDataURLHD) {
		canvas_proto.toBlobHD = function() {
			to_data_url = "toDataURLHD";
			var blob = this.toBlob();
			to_data_url = "toDataURL";
			return blob;
		}
	} else {
		canvas_proto.toBlobHD = canvas_proto.toBlob;
	}
}
}(typeof self !== "undefined" && self || typeof window !== "undefined" && window || this.content || this));

/* FileSaver.js
 * A saveAs() FileSaver implementation.
 * 2015-03-04
 *
 * By Eli Grey, http://eligrey.com
 * License: X11/MIT
 *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md
 */

/*global self */
/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */

/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */

var saveAs = saveAs
  // IE 10+ (native saveAs)
  || (typeof navigator !== "undefined" &&
      navigator.msSaveOrOpenBlob && navigator.msSaveOrOpenBlob.bind(navigator))
  // Everyone else
  || (function(view) {
	"use strict";
	// IE <10 is explicitly unsupported
	if (typeof navigator !== "undefined" &&
	    /MSIE [1-9]\./.test(navigator.userAgent)) {
		return;
	}
	var
		  doc = view.document
		  // only get URL when necessary in case Blob.js hasn't overridden it yet
		, get_URL = function() {
			return view.URL || view.webkitURL || view;
		}
		, save_link = doc.createElementNS("http://www.w3.org/1999/xhtml", "a")
		, can_use_save_link = "download" in save_link
		, click = function(node) {
			var event = doc.createEvent("MouseEvents");
			event.initMouseEvent(
				"click", true, false, view, 0, 0, 0, 0, 0
				, false, false, false, false, 0, null
			);
			node.dispatchEvent(event);
		}
		, webkit_req_fs = view.webkitRequestFileSystem
		, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem
		, throw_outside = function(ex) {
			(view.setImmediate || view.setTimeout)(function() {
				throw ex;
			}, 0);
		}
		, force_saveable_type = "application/octet-stream"
		, fs_min_size = 0
		// See https://code.google.com/p/chromium/issues/detail?id=375297#c7 and
		// https://github.com/eligrey/FileSaver.js/commit/485930a#commitcomment-8768047
		// for the reasoning behind the timeout and revocation flow
		, arbitrary_revoke_timeout = 500 // in ms
		, revoke = function(file) {
			var revoker = function() {
				if (typeof file === "string") { // file is an object URL
					get_URL().revokeObjectURL(file);
				} else { // file is a File
					file.remove();
				}
			};
			if (view.chrome) {
				revoker();
			} else {
				setTimeout(revoker, arbitrary_revoke_timeout);
			}
		}
		, dispatch = function(filesaver, event_types, event) {
			event_types = [].concat(event_types);
			var i = event_types.length;
			while (i--) {
				var listener = filesaver["on" + event_types[i]];
				if (typeof listener === "function") {
					try {
						listener.call(filesaver, event || filesaver);
					} catch (ex) {
						throw_outside(ex);
					}
				}
			}
		}
		, FileSaver = function(blob, name) {
			// First try a.download, then web filesystem, then object URLs
			var
				  filesaver = this
				, type = blob.type
				, blob_changed = false
				, object_url
				, target_view
				, dispatch_all = function() {
					dispatch(filesaver, "writestart progress write writeend".split(" "));
				}
				// on any filesys errors revert to saving with object URLs
				, fs_error = function() {
					// don't create more object URLs than needed
					if (blob_changed || !object_url) {
						object_url = get_URL().createObjectURL(blob);
					}
					if (target_view) {
						target_view.location.href = object_url;
					} else {
						var new_tab = view.open(object_url, "_blank");
						if (new_tab == undefined && typeof safari !== "undefined") {
							//Apple do not allow window.open, see http://bit.ly/1kZffRI
							view.location.href = object_url
						}
					}
					filesaver.readyState = filesaver.DONE;
					dispatch_all();
					revoke(object_url);
				}
				, abortable = function(func) {
					return function() {
						if (filesaver.readyState !== filesaver.DONE) {
							return func.apply(this, arguments);
						}
					};
				}
				, create_if_not_found = {create: true, exclusive: false}
				, slice
			;
			filesaver.readyState = filesaver.INIT;
			if (!name) {
				name = "download";
			}
			if (can_use_save_link) {
				object_url = get_URL().createObjectURL(blob);
				save_link.href = object_url;
				save_link.download = name;
				click(save_link);
				filesaver.readyState = filesaver.DONE;
				dispatch_all();
				revoke(object_url);
				return;
			}
			// prepend BOM for UTF-8 XML and text/plain types
			if (/^\s*(?:text\/(?:plain|xml)|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
				blob = new Blob(["\ufeff", blob], {type: blob.type});
			}
			// Object and web filesystem URLs have a problem saving in Google Chrome when
			// viewed in a tab, so I force save with application/octet-stream
			// http://code.google.com/p/chromium/issues/detail?id=91158
			// Update: Google errantly closed 91158, I submitted it again:
			// https://code.google.com/p/chromium/issues/detail?id=389642
			if (view.chrome && type && type !== force_saveable_type) {
				slice = blob.slice || blob.webkitSlice;
				blob = slice.call(blob, 0, blob.size, force_saveable_type);
				blob_changed = true;
			}
			// Since I can't be sure that the guessed media type will trigger a download
			// in WebKit, I append .download to the filename.
			// https://bugs.webkit.org/show_bug.cgi?id=65440
			if (webkit_req_fs && name !== "download") {
				name += ".download";
			}
			if (type === force_saveable_type || webkit_req_fs) {
				target_view = view;
			}
			if (!req_fs) {
				fs_error();
				return;
			}
			fs_min_size += blob.size;
			req_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {
				fs.root.getDirectory("saved", create_if_not_found, abortable(function(dir) {
					var save = function() {
						dir.getFile(name, create_if_not_found, abortable(function(file) {
							file.createWriter(abortable(function(writer) {
								writer.onwriteend = function(event) {
									target_view.location.href = file.toURL();
									filesaver.readyState = filesaver.DONE;
									dispatch(filesaver, "writeend", event);
									revoke(file);
								};
								writer.onerror = function() {
									var error = writer.error;
									if (error.code !== error.ABORT_ERR) {
										fs_error();
									}
								};
								"writestart progress write abort".split(" ").forEach(function(event) {
									writer["on" + event] = filesaver["on" + event];
								});
								writer.write(blob);
								filesaver.abort = function() {
									writer.abort();
									filesaver.readyState = filesaver.DONE;
								};
								filesaver.readyState = filesaver.WRITING;
							}), fs_error);
						}), fs_error);
					};
					dir.getFile(name, {create: false}, abortable(function(file) {
						// delete file if it already exists
						file.remove();
						save();
					}), abortable(function(ex) {
						if (ex.code === ex.NOT_FOUND_ERR) {
							save();
						} else {
							fs_error();
						}
					}));
				}), fs_error);
			}), fs_error);
		}
		, FS_proto = FileSaver.prototype
		, saveAs = function(blob, name) {
			return new FileSaver(blob, name);
		}
	;
	FS_proto.abort = function() {
		var filesaver = this;
		filesaver.readyState = filesaver.DONE;
		dispatch(filesaver, "abort");
	};
	FS_proto.readyState = FS_proto.INIT = 0;
	FS_proto.WRITING = 1;
	FS_proto.DONE = 2;

	FS_proto.error =
	FS_proto.onwritestart =
	FS_proto.onprogress =
	FS_proto.onwrite =
	FS_proto.onabort =
	FS_proto.onerror =
	FS_proto.onwriteend =
		null;

	return saveAs;
}(
	   typeof self !== "undefined" && self
	|| typeof window !== "undefined" && window
	|| this.content
));
// `self` is undefined in Firefox for Android content script context
// while `this` is nsIContentFrameMessageManager
// with an attribute `content` that corresponds to the window

if (typeof module !== "undefined" && module.exports) {
  module.exports.saveAs = saveAs;
} else if ((typeof define !== "undefined" && define !== null) && (define.amd != null)) {
  define([], function() {
    return saveAs;
  });
}

/**
* simplePagination.js v1.6
* A simple jQuery pagination plugin.
* http://flaviusmatis.github.com/simplePagination.js/
*
* Copyright 2012, Flavius Matis
* Released under the MIT license.
* http://flaviusmatis.github.com/license.html
*/

(function($){

	var methods = {
		init: function(options) {
			var o = $.extend({
				items: 1,
				itemsOnPage: 1,
				pages: 0,
				displayedPages: 5,
				edges: 2,
				currentPage: 0,
				hrefTextPrefix: '#page-',
				hrefTextSuffix: '',
				prevText: 'Prev',
				nextText: 'Next',
				ellipseText: '&hellip;',
				cssStyle: 'light-theme',
				labelMap: [],
				selectOnClick: true,
				nextAtFront: false,
				invertPageOrder: false,
				onPageClick: function(pageNumber, event) {
					// Callback triggered when a page is clicked
					// Page number is given as an optional parameter
				},
				onInit: function() {
					// Callback triggered immediately after initialization
				}
			}, options || {});

			var self = this;

			o.pages = o.pages ? o.pages : Math.ceil(o.items / o.itemsOnPage) ? Math.ceil(o.items / o.itemsOnPage) : 1;
			if (o.currentPage)
				o.currentPage = o.currentPage - 1;
			else
				o.currentPage = !o.invertPageOrder ? 0 : o.pages - 1;
			o.halfDisplayed = o.displayedPages / 2;

			this.each(function() {
				self.addClass(o.cssStyle + ' simple-pagination').data('pagination', o);
				methods._draw.call(self);
			});

			o.onInit();

			return this;
		},

		selectPage: function(page) {
			methods._selectPage.call(this, page - 1);
			return this;
		},

		prevPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			} else {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			}
			return this;
		},

		nextPage: function() {
			var o = this.data('pagination');
			if (!o.invertPageOrder) {
				if (o.currentPage < o.pages - 1) {
					methods._selectPage.call(this, o.currentPage + 1);
				}
			} else {
				if (o.currentPage > 0) {
					methods._selectPage.call(this, o.currentPage - 1);
				}
			}
			return this;
		},

		getPagesCount: function() {
			return this.data('pagination').pages;
		},

		getCurrentPage: function () {
			return this.data('pagination').currentPage + 1;
		},

		destroy: function(){
			this.empty();
			return this;
		},

		drawPage: function (page) {
			var o = this.data('pagination');
			o.currentPage = page - 1;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		redraw: function(){
			methods._draw.call(this);
			return this;
		},

		disable: function(){
			var o = this.data('pagination');
			o.disabled = true;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		enable: function(){
			var o = this.data('pagination');
			o.disabled = false;
			this.data('pagination', o);
			methods._draw.call(this);
			return this;
		},

		updateItems: function (newItems) {
			var o = this.data('pagination');
			o.items = newItems;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._draw.call(this);
		},

		updateItemsOnPage: function (itemsOnPage) {
			var o = this.data('pagination');
			o.itemsOnPage = itemsOnPage;
			o.pages = methods._getPages(o);
			this.data('pagination', o);
			methods._selectPage.call(this, 0);
			return this;
		},

		_draw: function() {
			var	o = this.data('pagination'),
				interval = methods._getInterval(o),
				i,
				tagName;

			methods.destroy.call(this);
			
			tagName = (typeof this.prop === 'function') ? this.prop('tagName') : this.attr('tagName');

			var $panel = tagName === 'UL' ? this : $('<ul></ul>').appendTo(this);

			// Generate Prev link
			if (o.prevText) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage - 1 : o.currentPage + 1, {text: o.prevText, classes: 'prev'});
			}

			// Generate Next link (if option set for at front)
			if (o.nextText && o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}

			// Generate start edges
			if (!o.invertPageOrder) {
				if (interval.start > 0 && o.edges > 0) {
					var end = Math.min(o.edges, interval.start);
					for (i = 0; i < end; i++) {
						methods._appendItem.call(this, i);
					}
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}
				}
			} else {
				if (interval.end < o.pages && o.edges > 0) {
					var begin = Math.max(o.pages - o.edges, interval.end);
					for (i = o.pages - 1; i >= begin; i--) {
						methods._appendItem.call(this, i);
					}
					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
				}
			}

			// Generate interval links
			if (!o.invertPageOrder) {
				for (i = interval.start; i < interval.end; i++) {
					methods._appendItem.call(this, i);
				}
			} else {
				for (i = interval.end - 1; i >= interval.start; i--) {
					methods._appendItem.call(this, i);
				}
			}

			// Generate end edges
			if (!o.invertPageOrder) {
				if (interval.end < o.pages && o.edges > 0) {
					if (o.pages - o.edges > interval.end && (o.pages - o.edges - interval.end != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (o.pages - o.edges - interval.end == 1) {
						methods._appendItem.call(this, interval.end);
					}
					var begin = Math.max(o.pages - o.edges, interval.end);
					for (i = begin; i < o.pages; i++) {
						methods._appendItem.call(this, i);
					}
				}
			} else {
				if (interval.start > 0 && o.edges > 0) {
					if (o.edges < interval.start && (interval.start - o.edges != 1)) {
						$panel.append('<li class="disabled"><span class="ellipse">' + o.ellipseText + '</span></li>');
					} else if (interval.start - o.edges == 1) {
						methods._appendItem.call(this, o.edges);
					}
					var end = Math.min(o.edges, interval.start);
					for (i = end - 1; i >= 0; i--) {
						methods._appendItem.call(this, i);
					}
				}
			}

			// Generate Next link (unless option is set for at front)
			if (o.nextText && !o.nextAtFront) {
				methods._appendItem.call(this, !o.invertPageOrder ? o.currentPage + 1 : o.currentPage - 1, {text: o.nextText, classes: 'next'});
			}
		},

		_getPages: function(o) {
			var pages = Math.ceil(o.items / o.itemsOnPage);
			return pages || 1;
		},

		_getInterval: function(o) {
			return {
				start: Math.ceil(o.currentPage > o.halfDisplayed ? Math.max(Math.min(o.currentPage - o.halfDisplayed, (o.pages - o.displayedPages)), 0) : 0),
				end: Math.ceil(o.currentPage > o.halfDisplayed ? Math.min(o.currentPage + o.halfDisplayed, o.pages) : Math.min(o.displayedPages, o.pages))
			};
		},

		_appendItem: function(pageIndex, opts) {
			var self = this, options, $link, o = self.data('pagination'), $linkWrapper = $('<li></li>'), $ul = self.find('ul');

			pageIndex = pageIndex < 0 ? 0 : (pageIndex < o.pages ? pageIndex : o.pages - 1);

			options = {
				text: pageIndex + 1,
				classes: ''
			};

			if (o.labelMap.length && o.labelMap[pageIndex]) {
				options.text = o.labelMap[pageIndex];
			}

			options = $.extend(options, opts || {});

			if (pageIndex == o.currentPage || o.disabled) {
				if (o.disabled) {
					$linkWrapper.addClass('disabled');
				} else {
					$linkWrapper.addClass('active');
				}
				$link = $('<span class="current">' + (options.text) + '</span>');
			} else {
				$link = $('<a href="' + o.hrefTextPrefix + (pageIndex + 1) + o.hrefTextSuffix + '" class="page-link">' + (options.text) + '</a>');
				$link.click(function(event){
					return methods._selectPage.call(self, pageIndex, event);
				});
			}

			if (options.classes) {
				$link.addClass(options.classes);
			}

			$linkWrapper.append($link);

			if ($ul.length) {
				$ul.append($linkWrapper);
			} else {
				self.append($linkWrapper);
			}
		},

		_selectPage: function(pageIndex, event) {
			var o = this.data('pagination');
			o.currentPage = pageIndex;
			if (o.selectOnClick) {
				methods._draw.call(this);
			}
			return o.onPageClick(pageIndex + 1, event);
		}

	};

	$.fn.pagination = function(method) {

		// Method calling logic
		if (methods[method] && method.charAt(0) != '_') {
			return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
		} else if (typeof method === 'object' || !method) {
			return methods.init.apply(this, arguments);
		} else {
			$.error('Method ' +  method + ' does not exist on jQuery.pagination');
		}

	};

})(jQuery);

// Spectrum Colorpicker v1.6.0
// https://github.com/bgrins/spectrum
// Author: Brian Grinstead
// License: MIT

(function (factory) {
    "use strict";

    if (typeof define === 'function' && define.amd) { // AMD
        define(['jquery'], factory);
    }
    else if (typeof exports == "object" && typeof module == "object") { // CommonJS
        module.exports = factory;
    }
    else { // Browser
        factory(jQuery);
    }
})(function($, undefined) {
    "use strict";

    var defaultOpts = {

        // Callbacks
        beforeShow: noop,
        move: noop,
        change: noop,
        show: noop,
        hide: noop,

        // Options
        color: false,
        flat: false,
        showInput: false,
        allowEmpty: false,
        showButtons: true,
        clickoutFiresChange: false,
        showInitial: false,
        showPalette: false,
        showPaletteOnly: false,
        hideAfterPaletteSelect: false,
        togglePaletteOnly: false,
        showSelectionPalette: true,
        localStorageKey: false,
        appendTo: "body",
        maxSelectionSize: 7,
        cancelText: "cancel",
        chooseText: "choose",
        togglePaletteMoreText: "more",
        togglePaletteLessText: "less",
        clearText: "Clear Color Selection",
        noColorSelectedText: "No Color Selected",
        preferredFormat: false,
        className: "", // Deprecated - use containerClassName and replacerClassName instead.
        containerClassName: "",
        replacerClassName: "",
        showAlpha: false,
        theme: "sp-light",
        palette: [["#ffffff", "#000000", "#ff0000", "#ff8000", "#ffff00", "#008000", "#0000ff", "#4b0082", "#9400d3"]],
        selectionPalette: [],
        disabled: false,
        offset: null
    },
    spectrums = [],
    IE = !!/msie/i.exec( window.navigator.userAgent ),
    rgbaSupport = (function() {
        function contains( str, substr ) {
            return !!~('' + str).indexOf(substr);
        }

        var elem = document.createElement('div');
        var style = elem.style;
        style.cssText = 'background-color:rgba(0,0,0,.5)';
        return contains(style.backgroundColor, 'rgba') || contains(style.backgroundColor, 'hsla');
    })(),
    inputTypeColorSupport = (function() {
        var colorInput = $("<input type='color' value='!' />")[0];
        return colorInput.type === "color" && colorInput.value !== "!";
    })(),
    replaceInput = [
        "<div class='sp-replacer'>",
            "<div class='sp-preview'><div class='sp-preview-inner'></div></div>",
            "<div class='sp-dd'>&#9660;</div>",
        "</div>"
    ].join(''),
    markup = (function () {

        // IE does not support gradients with multiple stops, so we need to simulate
        //  that for the rainbow slider with 8 divs that each have a single gradient
        var gradientFix = "";
        if (IE) {
            for (var i = 1; i <= 6; i++) {
                gradientFix += "<div class='sp-" + i + "'></div>";
            }
        }

        return [
            "<div class='sp-container sp-hidden'>",
                "<div class='sp-palette-container'>",
                    "<div class='sp-palette sp-thumb sp-cf'></div>",
                    "<div class='sp-palette-button-container sp-cf'>",
                        "<button type='button' class='sp-palette-toggle'></button>",
                    "</div>",
                "</div>",
                "<div class='sp-picker-container'>",
                    "<div class='sp-top sp-cf'>",
                        "<div class='sp-fill'></div>",
                        "<div class='sp-top-inner'>",
                            "<div class='sp-color'>",
                                "<div class='sp-sat'>",
                                    "<div class='sp-val'>",
                                        "<div class='sp-dragger'></div>",
                                    "</div>",
                                "</div>",
                            "</div>",
                            "<div class='sp-clear sp-clear-display'>",
                            "</div>",
                            "<div class='sp-hue'>",
                                "<div class='sp-slider'></div>",
                                gradientFix,
                            "</div>",
                        "</div>",
                        "<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>",
                    "</div>",
                    "<div class='sp-input-container sp-cf'>",
                        "<input class='sp-input' type='text' spellcheck='false'  />",
                    "</div>",
                    "<div class='sp-initial sp-thumb sp-cf'></div>",
                    "<div class='sp-button-container sp-cf'>",
                        "<a class='sp-cancel' href='#'></a>",
                        "<button type='button' class='sp-choose'></button>",
                    "</div>",
                "</div>",
            "</div>"
        ].join("");
    })();

    function paletteTemplate (p, color, className, opts) {
        var html = [];
        for (var i = 0; i < p.length; i++) {
            var current = p[i];
            if(current) {
                var tiny = tinycolor(current);
                var c = tiny.toHsl().l < 0.5 ? "sp-thumb-el sp-thumb-dark" : "sp-thumb-el sp-thumb-light";
                c += (tinycolor.equals(color, current)) ? " sp-thumb-active" : "";
                var formattedString = tiny.toString(opts.preferredFormat || "rgb");
                var swatchStyle = rgbaSupport ? ("background-color:" + tiny.toRgbString()) : "filter:" + tiny.toFilter();
                html.push('<span title="' + formattedString + '" data-color="' + tiny.toRgbString() + '" class="' + c + '"><span class="sp-thumb-inner" style="' + swatchStyle + ';" /></span>');
            } else {
                var cls = 'sp-clear-display';
                html.push($('<div />')
                    .append($('<span data-color="" style="background-color:transparent;" class="' + cls + '"></span>')
                        .attr('title', opts.noColorSelectedText)
                    )
                    .html()
                );
            }
        }
        return "<div class='sp-cf " + className + "'>" + html.join('') + "</div>";
    }

    function hideAll() {
        for (var i = 0; i < spectrums.length; i++) {
            if (spectrums[i]) {
                spectrums[i].hide();
            }
        }
    }

    function instanceOptions(o, callbackContext) {
        var opts = $.extend({}, defaultOpts, o);
        opts.callbacks = {
            'move': bind(opts.move, callbackContext),
            'change': bind(opts.change, callbackContext),
            'show': bind(opts.show, callbackContext),
            'hide': bind(opts.hide, callbackContext),
            'beforeShow': bind(opts.beforeShow, callbackContext)
        };

        return opts;
    }

    function spectrum(element, o) {

        var opts = instanceOptions(o, element),
            flat = opts.flat,
            showSelectionPalette = opts.showSelectionPalette,
            localStorageKey = opts.localStorageKey,
            theme = opts.theme,
            callbacks = opts.callbacks,
            resize = throttle(reflow, 10),
            visible = false,
            dragWidth = 0,
            dragHeight = 0,
            dragHelperHeight = 0,
            slideHeight = 0,
            slideWidth = 0,
            alphaWidth = 0,
            alphaSlideHelperWidth = 0,
            slideHelperHeight = 0,
            currentHue = 0,
            currentSaturation = 0,
            currentValue = 0,
            currentAlpha = 1,
            palette = [],
            paletteArray = [],
            paletteLookup = {},
            selectionPalette = opts.selectionPalette.slice(0),
            maxSelectionSize = opts.maxSelectionSize,
            draggingClass = "sp-dragging",
            shiftMovementDirection = null;

        var doc = element.ownerDocument,
            body = doc.body,
            boundElement = $(element),
            disabled = false,
            container = $(markup, doc).addClass(theme),
            pickerContainer = container.find(".sp-picker-container"),
            dragger = container.find(".sp-color"),
            dragHelper = container.find(".sp-dragger"),
            slider = container.find(".sp-hue"),
            slideHelper = container.find(".sp-slider"),
            alphaSliderInner = container.find(".sp-alpha-inner"),
            alphaSlider = container.find(".sp-alpha"),
            alphaSlideHelper = container.find(".sp-alpha-handle"),
            textInput = container.find(".sp-input"),
            paletteContainer = container.find(".sp-palette"),
            initialColorContainer = container.find(".sp-initial"),
            cancelButton = container.find(".sp-cancel"),
            clearButton = container.find(".sp-clear"),
            chooseButton = container.find(".sp-choose"),
            toggleButton = container.find(".sp-palette-toggle"),
            isInput = boundElement.is("input"),
            isInputTypeColor = isInput && inputTypeColorSupport && boundElement.attr("type") === "color",
            shouldReplace = isInput && !flat,
            replacer = (shouldReplace) ? $(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName) : $([]),
            offsetElement = (shouldReplace) ? replacer : boundElement,
            previewElement = replacer.find(".sp-preview-inner"),
            initialColor = opts.color || (isInput && boundElement.val()),
            colorOnShow = false,
            preferredFormat = opts.preferredFormat,
            currentPreferredFormat = preferredFormat,
            clickoutFiresChange = !opts.showButtons || opts.clickoutFiresChange,
            isEmpty = !initialColor,
            allowEmpty = opts.allowEmpty && !isInputTypeColor;

        function applyOptions() {

            if (opts.showPaletteOnly) {
                opts.showPalette = true;
            }

            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);

            if (opts.palette) {
                palette = opts.palette.slice(0);
                paletteArray = $.isArray(palette[0]) ? palette : [palette];
                paletteLookup = {};
                for (var i = 0; i < paletteArray.length; i++) {
                    for (var j = 0; j < paletteArray[i].length; j++) {
                        var rgb = tinycolor(paletteArray[i][j]).toRgbString();
                        paletteLookup[rgb] = true;
                    }
                }
            }

            container.toggleClass("sp-flat", flat);
            container.toggleClass("sp-input-disabled", !opts.showInput);
            container.toggleClass("sp-alpha-enabled", opts.showAlpha);
            container.toggleClass("sp-clear-enabled", allowEmpty);
            container.toggleClass("sp-buttons-disabled", !opts.showButtons);
            container.toggleClass("sp-palette-buttons-disabled", !opts.togglePaletteOnly);
            container.toggleClass("sp-palette-disabled", !opts.showPalette);
            container.toggleClass("sp-palette-only", opts.showPaletteOnly);
            container.toggleClass("sp-initial-disabled", !opts.showInitial);
            container.addClass(opts.className).addClass(opts.containerClassName);

            reflow();
        }

        function initialize() {

            if (IE) {
                container.find("*:not(input)").attr("unselectable", "on");
            }

            applyOptions();

            if (shouldReplace) {
                boundElement.after(replacer).hide();
            }

            if (!allowEmpty) {
                clearButton.hide();
            }

            if (flat) {
                boundElement.after(container).hide();
            }
            else {

                var appendTo = opts.appendTo === "parent" ? boundElement.parent() : $(opts.appendTo);
                if (appendTo.length !== 1) {
                    appendTo = $("body");
                }

                appendTo.append(container);
            }

            updateSelectionPaletteFromStorage();

            offsetElement.bind("click.spectrum touchstart.spectrum", function (e) {
                if (!disabled) {
                    toggle();
                }

                e.stopPropagation();

                if (!$(e.target).is("input")) {
                    e.preventDefault();
                }
            });

            if(boundElement.is(":disabled") || (opts.disabled === true)) {
                disable();
            }

            // Prevent clicks from bubbling up to document.  This would cause it to be hidden.
            container.click(stopPropagation);

            // Handle user typed input
            textInput.change(setFromTextInput);
            textInput.bind("paste", function () {
                setTimeout(setFromTextInput, 1);
            });
            textInput.keydown(function (e) { if (e.keyCode == 13) { setFromTextInput(); } });

            cancelButton.text(opts.cancelText);
            cancelButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();
                revert();
                hide();
            });

            clearButton.attr("title", opts.clearText);
            clearButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();
                isEmpty = true;
                move();

                if(flat) {
                    //for the flat style, this is a change event
                    updateOriginalInput(true);
                }
            });

            chooseButton.text(opts.chooseText);
            chooseButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();

                if (isValid()) {
                    updateOriginalInput(true);
                    hide();
                }
            });

            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);
            toggleButton.bind("click.spectrum", function (e) {
                e.stopPropagation();
                e.preventDefault();

                opts.showPaletteOnly = !opts.showPaletteOnly;

                // To make sure the Picker area is drawn on the right, next to the
                // Palette area (and not below the palette), first move the Palette
                // to the left to make space for the picker, plus 5px extra.
                // The 'applyOptions' function puts the whole container back into place
                // and takes care of the button-text and the sp-palette-only CSS class.
                if (!opts.showPaletteOnly && !flat) {
                    container.css('left', '-=' + (pickerContainer.outerWidth(true) + 5));
                }
                applyOptions();
            });

            draggable(alphaSlider, function (dragX, dragY, e) {
                currentAlpha = (dragX / alphaWidth);
                isEmpty = false;
                if (e.shiftKey) {
                    currentAlpha = Math.round(currentAlpha * 10) / 10;
                }

                move();
            }, dragStart, dragStop);

            draggable(slider, function (dragX, dragY) {
                currentHue = parseFloat(dragY / slideHeight);
                isEmpty = false;
                if (!opts.showAlpha) {
                    currentAlpha = 1;
                }
                move();
            }, dragStart, dragStop);

            draggable(dragger, function (dragX, dragY, e) {

                // shift+drag should snap the movement to either the x or y axis.
                if (!e.shiftKey) {
                    shiftMovementDirection = null;
                }
                else if (!shiftMovementDirection) {
                    var oldDragX = currentSaturation * dragWidth;
                    var oldDragY = dragHeight - (currentValue * dragHeight);
                    var furtherFromX = Math.abs(dragX - oldDragX) > Math.abs(dragY - oldDragY);

                    shiftMovementDirection = furtherFromX ? "x" : "y";
                }

                var setSaturation = !shiftMovementDirection || shiftMovementDirection === "x";
                var setValue = !shiftMovementDirection || shiftMovementDirection === "y";

                if (setSaturation) {
                    currentSaturation = parseFloat(dragX / dragWidth);
                }
                if (setValue) {
                    currentValue = parseFloat((dragHeight - dragY) / dragHeight);
                }

                isEmpty = false;
                if (!opts.showAlpha) {
                    currentAlpha = 1;
                }

                move();

            }, dragStart, dragStop);

            if (!!initialColor) {
                set(initialColor);

                // In case color was black - update the preview UI and set the format
                // since the set function will not run (default color is black).
                updateUI();
                currentPreferredFormat = preferredFormat || tinycolor(initialColor).format;

                addColorToSelectionPalette(initialColor);
            }
            else {
                updateUI();
            }

            if (flat) {
                show();
            }

            function paletteElementClick(e) {
                if (e.data && e.data.ignore) {
                    set($(e.target).closest(".sp-thumb-el").data("color"));
                    move();
                }
                else {
                    set($(e.target).closest(".sp-thumb-el").data("color"));
                    move();
                    updateOriginalInput(true);
                    if (opts.hideAfterPaletteSelect) {
                      hide();
                    }
                }

                return false;
            }

            var paletteEvent = IE ? "mousedown.spectrum" : "click.spectrum touchstart.spectrum";
            paletteContainer.delegate(".sp-thumb-el", paletteEvent, paletteElementClick);
            initialColorContainer.delegate(".sp-thumb-el:nth-child(1)", paletteEvent, { ignore: true }, paletteElementClick);
        }

        function updateSelectionPaletteFromStorage() {

            if (localStorageKey && window.localStorage) {

                // Migrate old palettes over to new format.  May want to remove this eventually.
                try {
                    var oldPalette = window.localStorage[localStorageKey].split(",#");
                    if (oldPalette.length > 1) {
                        delete window.localStorage[localStorageKey];
                        $.each(oldPalette, function(i, c) {
                             addColorToSelectionPalette(c);
                        });
                    }
                }
                catch(e) { }

                try {
                    selectionPalette = window.localStorage[localStorageKey].split(";");
                }
                catch (e) { }
            }
        }

        function addColorToSelectionPalette(color) {
            if (showSelectionPalette) {
                var rgb = tinycolor(color).toRgbString();
                if (!paletteLookup[rgb] && $.inArray(rgb, selectionPalette) === -1) {
                    selectionPalette.push(rgb);
                    while(selectionPalette.length > maxSelectionSize) {
                        selectionPalette.shift();
                    }
                }

                if (localStorageKey && window.localStorage) {
                    try {
                        window.localStorage[localStorageKey] = selectionPalette.join(";");
                    }
                    catch(e) { }
                }
            }
        }

        function getUniqueSelectionPalette() {
            var unique = [];
            if (opts.showPalette) {
                for (var i = 0; i < selectionPalette.length; i++) {
                    var rgb = tinycolor(selectionPalette[i]).toRgbString();

                    if (!paletteLookup[rgb]) {
                        unique.push(selectionPalette[i]);
                    }
                }
            }

            return unique.reverse().slice(0, opts.maxSelectionSize);
        }

        function drawPalette() {

            var currentColor = get();

            var html = $.map(paletteArray, function (palette, i) {
                return paletteTemplate(palette, currentColor, "sp-palette-row sp-palette-row-" + i, opts);
            });

            updateSelectionPaletteFromStorage();

            if (selectionPalette) {
                html.push(paletteTemplate(getUniqueSelectionPalette(), currentColor, "sp-palette-row sp-palette-row-selection", opts));
            }

            paletteContainer.html(html.join(""));
        }

        function drawInitial() {
            if (opts.showInitial) {
                var initial = colorOnShow;
                var current = get();
                initialColorContainer.html(paletteTemplate([initial, current], current, "sp-palette-row-initial", opts));
            }
        }

        function dragStart() {
            if (dragHeight <= 0 || dragWidth <= 0 || slideHeight <= 0) {
                reflow();
            }
            container.addClass(draggingClass);
            shiftMovementDirection = null;
            boundElement.trigger('dragstart.spectrum', [ get() ]);
        }

        function dragStop() {
            container.removeClass(draggingClass);
            boundElement.trigger('dragstop.spectrum', [ get() ]);
        }

        function setFromTextInput() {

            var value = textInput.val();

            if ((value === null || value === "") && allowEmpty) {
                set(null);
                updateOriginalInput(true);
            }
            else {
                var tiny = tinycolor(value);
                if (tiny.isValid()) {
                    set(tiny);
                    updateOriginalInput(true);
                }
                else {
                    textInput.addClass("sp-validation-error");
                }
            }
        }

        function toggle() {
            if (visible) {
                hide();
            }
            else {
                show();
            }
        }

        function show() {
            var event = $.Event('beforeShow.spectrum');

            if (visible) {
                reflow();
                return;
            }

            boundElement.trigger(event, [ get() ]);

            if (callbacks.beforeShow(get()) === false || event.isDefaultPrevented()) {
                return;
            }

            hideAll();
            visible = true;

            $(doc).bind("click.spectrum", clickout);
            $(window).bind("resize.spectrum", resize);
            replacer.addClass("sp-active");
            container.removeClass("sp-hidden");

            reflow();
            updateUI();

            colorOnShow = get();

            drawInitial();
            callbacks.show(colorOnShow);
            boundElement.trigger('show.spectrum', [ colorOnShow ]);
        }

        function clickout(e) {
            // Return on right click.
            if (e.button == 2) { return; }

            if (clickoutFiresChange) {
                updateOriginalInput(true);
            }
            else {
                revert();
            }
            hide();
        }

        function hide() {
            // Return if hiding is unnecessary
            if (!visible || flat) { return; }
            visible = false;

            $(doc).unbind("click.spectrum", clickout);
            $(window).unbind("resize.spectrum", resize);

            replacer.removeClass("sp-active");
            container.addClass("sp-hidden");

            callbacks.hide(get());
            boundElement.trigger('hide.spectrum', [ get() ]);
        }

        function revert() {
            set(colorOnShow, true);
        }

        function set(color, ignoreFormatChange) {
            if (tinycolor.equals(color, get())) {
                // Update UI just in case a validation error needs
                // to be cleared.
                updateUI();
                return;
            }

            var newColor, newHsv;
            if (!color && allowEmpty) {
                isEmpty = true;
            } else {
                isEmpty = false;
                newColor = tinycolor(color);
                newHsv = newColor.toHsv();

                currentHue = (newHsv.h % 360) / 360;
                currentSaturation = newHsv.s;
                currentValue = newHsv.v;
                currentAlpha = newHsv.a;
            }
            updateUI();

            if (newColor && newColor.isValid() && !ignoreFormatChange) {
                currentPreferredFormat = preferredFormat || newColor.getFormat();
            }
        }

        function get(opts) {
            opts = opts || { };

            if (allowEmpty && isEmpty) {
                return null;
            }

            return tinycolor.fromRatio({
                h: currentHue,
                s: currentSaturation,
                v: currentValue,
                a: Math.round(currentAlpha * 100) / 100
            }, { format: opts.format || currentPreferredFormat });
        }

        function isValid() {
            return !textInput.hasClass("sp-validation-error");
        }

        function move() {
            updateUI();

            callbacks.move(get());
            boundElement.trigger('move.spectrum', [ get() ]);
        }

        function updateUI() {

            textInput.removeClass("sp-validation-error");

            updateHelperLocations();

            // Update dragger background color (gradients take care of saturation and value).
            var flatColor = tinycolor.fromRatio({ h: currentHue, s: 1, v: 1 });
            dragger.css("background-color", flatColor.toHexString());

            // Get a format that alpha will be included in (hex and names ignore alpha)
            var format = currentPreferredFormat;
            if (currentAlpha < 1 && !(currentAlpha === 0 && format === "name")) {
                if (format === "hex" || format === "hex3" || format === "hex6" || format === "name") {
                    format = "rgb";
                }
            }

            var realColor = get({ format: format }),
                displayColor = '';

             //reset background info for preview element
            previewElement.removeClass("sp-clear-display");
            previewElement.css('background-color', 'transparent');

            if (!realColor && allowEmpty) {
                // Update the replaced elements background with icon indicating no color selection
                previewElement.addClass("sp-clear-display");
            }
            else {
                var realHex = realColor.toHexString(),
                    realRgb = realColor.toRgbString();

                // Update the replaced elements background color (with actual selected color)
                if (rgbaSupport || realColor.alpha === 1) {
                    previewElement.css("background-color", realRgb);
                }
                else {
                    previewElement.css("background-color", "transparent");
                    previewElement.css("filter", realColor.toFilter());
                }

                if (opts.showAlpha) {
                    var rgb = realColor.toRgb();
                    rgb.a = 0;
                    var realAlpha = tinycolor(rgb).toRgbString();
                    var gradient = "linear-gradient(left, " + realAlpha + ", " + realHex + ")";

                    if (IE) {
                        alphaSliderInner.css("filter", tinycolor(realAlpha).toFilter({ gradientType: 1 }, realHex));
                    }
                    else {
                        alphaSliderInner.css("background", "-webkit-" + gradient);
                        alphaSliderInner.css("background", "-moz-" + gradient);
                        alphaSliderInner.css("background", "-ms-" + gradient);
                        // Use current syntax gradient on unprefixed property.
                        alphaSliderInner.css("background",
                            "linear-gradient(to right, " + realAlpha + ", " + realHex + ")");
                    }
                }

                displayColor = realColor.toString(format);
            }

            // Update the text entry input as it changes happen
            if (opts.showInput) {
                textInput.val(displayColor);
            }

            if (opts.showPalette) {
                drawPalette();
            }

            drawInitial();
        }

        function updateHelperLocations() {
            var s = currentSaturation;
            var v = currentValue;

            if(allowEmpty && isEmpty) {
                //if selected color is empty, hide the helpers
                alphaSlideHelper.hide();
                slideHelper.hide();
                dragHelper.hide();
            }
            else {
                //make sure helpers are visible
                alphaSlideHelper.show();
                slideHelper.show();
                dragHelper.show();

                // Where to show the little circle in that displays your current selected color
                var dragX = s * dragWidth;
                var dragY = dragHeight - (v * dragHeight);
                dragX = Math.max(
                    -dragHelperHeight,
                    Math.min(dragWidth - dragHelperHeight, dragX - dragHelperHeight)
                );
                dragY = Math.max(
                    -dragHelperHeight,
                    Math.min(dragHeight - dragHelperHeight, dragY - dragHelperHeight)
                );
                dragHelper.css({
                    "top": dragY + "px",
                    "left": dragX + "px"
                });

                var alphaX = currentAlpha * alphaWidth;
                alphaSlideHelper.css({
                    "left": (alphaX - (alphaSlideHelperWidth / 2)) + "px"
                });

                // Where to show the bar that displays your current selected hue
                var slideY = (currentHue) * slideHeight;
                slideHelper.css({
                    "top": (slideY - slideHelperHeight) + "px"
                });
            }
        }

        function updateOriginalInput(fireCallback) {
            var color = get(),
                displayColor = '',
                hasChanged = !tinycolor.equals(color, colorOnShow);

            if (color) {
                displayColor = color.toString(currentPreferredFormat);
                // Update the selection palette with the current color
                addColorToSelectionPalette(color);
            }

            if (isInput) {
                boundElement.val(displayColor);
            }

            if (fireCallback && hasChanged) {
                callbacks.change(color);
                boundElement.trigger('change', [ color ]);
            }
        }

        function reflow() {
            dragWidth = dragger.width();
            dragHeight = dragger.height();
            dragHelperHeight = dragHelper.height();
            slideWidth = slider.width();
            slideHeight = slider.height();
            slideHelperHeight = slideHelper.height();
            alphaWidth = alphaSlider.width();
            alphaSlideHelperWidth = alphaSlideHelper.width();

            if (!flat) {
                container.css("position", "absolute");
                if (opts.offset) {
                    container.offset(opts.offset);
                } else {
                    container.offset(getOffset(container, offsetElement));
                }
            }

            updateHelperLocations();

            if (opts.showPalette) {
                drawPalette();
            }

            boundElement.trigger('reflow.spectrum');
        }

        function destroy() {
            boundElement.show();
            offsetElement.unbind("click.spectrum touchstart.spectrum");
            container.remove();
            replacer.remove();
            spectrums[spect.id] = null;
        }

        function option(optionName, optionValue) {
            if (optionName === undefined) {
                return $.extend({}, opts);
            }
            if (optionValue === undefined) {
                return opts[optionName];
            }

            opts[optionName] = optionValue;
            applyOptions();
        }

        function enable() {
            disabled = false;
            boundElement.attr("disabled", false);
            offsetElement.removeClass("sp-disabled");
        }

        function disable() {
            hide();
            disabled = true;
            boundElement.attr("disabled", true);
            offsetElement.addClass("sp-disabled");
        }

        function setOffset(coord) {
            opts.offset = coord;
            reflow();
        }

        initialize();

        var spect = {
            show: show,
            hide: hide,
            toggle: toggle,
            reflow: reflow,
            option: option,
            enable: enable,
            disable: disable,
            offset: setOffset,
            set: function (c) {
                set(c);
                updateOriginalInput();
            },
            get: get,
            destroy: destroy,
            container: container
        };

        spect.id = spectrums.push(spect) - 1;

        return spect;
    }

    /**
    * checkOffset - get the offset below/above and left/right element depending on screen position
    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js
    */
    function getOffset(picker, input) {
        var extraY = 0;
        var dpWidth = picker.outerWidth();
        var dpHeight = picker.outerHeight();
        var inputHeight = input.outerHeight();
        var doc = picker[0].ownerDocument;
        var docElem = doc.documentElement;
        var viewWidth = docElem.clientWidth + $(doc).scrollLeft();
        var viewHeight = docElem.clientHeight + $(doc).scrollTop();
        var offset = input.offset();
        offset.top += inputHeight;

        offset.left -=
            Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ?
            Math.abs(offset.left + dpWidth - viewWidth) : 0);

        offset.top -=
            Math.min(offset.top, ((offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ?
            Math.abs(dpHeight + inputHeight - extraY) : extraY));

        return offset;
    }

    /**
    * noop - do nothing
    */
    function noop() {

    }

    /**
    * stopPropagation - makes the code only doing this a little easier to read in line
    */
    function stopPropagation(e) {
        e.stopPropagation();
    }

    /**
    * Create a function bound to a given object
    * Thanks to underscore.js
    */
    function bind(func, obj) {
        var slice = Array.prototype.slice;
        var args = slice.call(arguments, 2);
        return function () {
            return func.apply(obj, args.concat(slice.call(arguments)));
        };
    }

    /**
    * Lightweight drag helper.  Handles containment within the element, so that
    * when dragging, the x is within [0,element.width] and y is within [0,element.height]
    */
    function draggable(element, onmove, onstart, onstop) {
        onmove = onmove || function () { };
        onstart = onstart || function () { };
        onstop = onstop || function () { };
        var doc = document;
        var dragging = false;
        var offset = {};
        var maxHeight = 0;
        var maxWidth = 0;
        var hasTouch = ('ontouchstart' in window);

        var duringDragEvents = {};
        duringDragEvents["selectstart"] = prevent;
        duringDragEvents["dragstart"] = prevent;
        duringDragEvents["touchmove mousemove"] = move;
        duringDragEvents["touchend mouseup"] = stop;

        function prevent(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.returnValue = false;
        }

        function move(e) {
            if (dragging) {
                // Mouseup happened outside of window
                if (IE && doc.documentMode < 9 && !e.button) {
                    return stop();
                }

                var touches = e.originalEvent && e.originalEvent.touches;
                var pageX = touches ? touches[0].pageX : e.pageX;
                var pageY = touches ? touches[0].pageY : e.pageY;

                var dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth));
                var dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));

                if (hasTouch) {
                    // Stop scrolling in iOS
                    prevent(e);
                }

                onmove.apply(element, [dragX, dragY, e]);
            }
        }

        function start(e) {
            var rightclick = (e.which) ? (e.which == 3) : (e.button == 2);

            if (!rightclick && !dragging) {
                if (onstart.apply(element, arguments) !== false) {
                    dragging = true;
                    maxHeight = $(element).height();
                    maxWidth = $(element).width();
                    offset = $(element).offset();

                    $(doc).bind(duringDragEvents);
                    $(doc.body).addClass("sp-dragging");

                    if (!hasTouch) {
                        move(e);
                    }

                    prevent(e);
                }
            }
        }

        function stop() {
            if (dragging) {
                $(doc).unbind(duringDragEvents);
                $(doc.body).removeClass("sp-dragging");
                onstop.apply(element, arguments);
            }
            dragging = false;
        }

        $(element).bind("touchstart mousedown", start);
    }

    function throttle(func, wait, debounce) {
        var timeout;
        return function () {
            var context = this, args = arguments;
            var throttler = function () {
                timeout = null;
                func.apply(context, args);
            };
            if (debounce) clearTimeout(timeout);
            if (debounce || !timeout) timeout = setTimeout(throttler, wait);
        };
    }

    /**
    * Define a jQuery plugin
    */
    var dataID = "spectrum.id";
    $.fn.spectrum = function (opts, extra) {

        if (typeof opts == "string") {

            var returnValue = this;
            var args = Array.prototype.slice.call( arguments, 1 );

            this.each(function () {
                var spect = spectrums[$(this).data(dataID)];
                if (spect) {
                    var method = spect[opts];
                    if (!method) {
                        throw new Error( "Spectrum: no such method: '" + opts + "'" );
                    }

                    if (opts == "get") {
                        returnValue = spect.get();
                    }
                    else if (opts == "container") {
                        returnValue = spect.container;
                    }
                    else if (opts == "option") {
                        returnValue = spect.option.apply(spect, args);
                    }
                    else if (opts == "destroy") {
                        spect.destroy();
                        $(this).removeData(dataID);
                    }
                    else {
                        method.apply(spect, args);
                    }
                }
            });

            return returnValue;
        }

        // Initializing a new instance of spectrum
        return this.spectrum("destroy").each(function () {
            var options = $.extend({}, opts, $(this).data());
            var spect = spectrum(this, options);
            $(this).data(dataID, spect.id);
        });
    };

    $.fn.spectrum.load = true;
    $.fn.spectrum.loadOpts = {};
    $.fn.spectrum.draggable = draggable;
    $.fn.spectrum.defaults = defaultOpts;

    $.spectrum = { };
    $.spectrum.localization = { };
    $.spectrum.palettes = { };

    $.fn.spectrum.processNativeColorInputs = function () {
        if (!inputTypeColorSupport) {
            $("input[type=color]").spectrum({
                preferredFormat: "hex6"
            });
        }
    };

    // TinyColor v1.1.1
    // https://github.com/bgrins/TinyColor
    // Brian Grinstead, MIT License

    (function() {

    var trimLeft = /^[\s,#]+/,
        trimRight = /\s+$/,
        tinyCounter = 0,
        math = Math,
        mathRound = math.round,
        mathMin = math.min,
        mathMax = math.max,
        mathRandom = math.random;

    var tinycolor = function tinycolor (color, opts) {

        color = (color) ? color : '';
        opts = opts || { };

        // If input is already a tinycolor, return itself
        if (color instanceof tinycolor) {
           return color;
        }
        // If we are called as a function, call using new instead
        if (!(this instanceof tinycolor)) {
            return new tinycolor(color, opts);
        }

        var rgb = inputToRGB(color);
        this._originalInput = color,
        this._r = rgb.r,
        this._g = rgb.g,
        this._b = rgb.b,
        this._a = rgb.a,
        this._roundA = mathRound(100*this._a) / 100,
        this._format = opts.format || rgb.format;
        this._gradientType = opts.gradientType;

        // Don't let the range of [0,255] come back in [0,1].
        // Potentially lose a little bit of precision here, but will fix issues where
        // .5 gets interpreted as half of the total, instead of half of 1
        // If it was supposed to be 128, this was already taken care of by `inputToRgb`
        if (this._r < 1) { this._r = mathRound(this._r); }
        if (this._g < 1) { this._g = mathRound(this._g); }
        if (this._b < 1) { this._b = mathRound(this._b); }

        this._ok = rgb.ok;
        this._tc_id = tinyCounter++;
    };

    tinycolor.prototype = {
        isDark: function() {
            return this.getBrightness() < 128;
        },
        isLight: function() {
            return !this.isDark();
        },
        isValid: function() {
            return this._ok;
        },
        getOriginalInput: function() {
          return this._originalInput;
        },
        getFormat: function() {
            return this._format;
        },
        getAlpha: function() {
            return this._a;
        },
        getBrightness: function() {
            var rgb = this.toRgb();
            return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
        },
        setAlpha: function(value) {
            this._a = boundAlpha(value);
            this._roundA = mathRound(100*this._a) / 100;
            return this;
        },
        toHsv: function() {
            var hsv = rgbToHsv(this._r, this._g, this._b);
            return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };
        },
        toHsvString: function() {
            var hsv = rgbToHsv(this._r, this._g, this._b);
            var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);
            return (this._a == 1) ?
              "hsv("  + h + ", " + s + "%, " + v + "%)" :
              "hsva(" + h + ", " + s + "%, " + v + "%, "+ this._roundA + ")";
        },
        toHsl: function() {
            var hsl = rgbToHsl(this._r, this._g, this._b);
            return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };
        },
        toHslString: function() {
            var hsl = rgbToHsl(this._r, this._g, this._b);
            var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);
            return (this._a == 1) ?
              "hsl("  + h + ", " + s + "%, " + l + "%)" :
              "hsla(" + h + ", " + s + "%, " + l + "%, "+ this._roundA + ")";
        },
        toHex: function(allow3Char) {
            return rgbToHex(this._r, this._g, this._b, allow3Char);
        },
        toHexString: function(allow3Char) {
            return '#' + this.toHex(allow3Char);
        },
        toHex8: function() {
            return rgbaToHex(this._r, this._g, this._b, this._a);
        },
        toHex8String: function() {
            return '#' + this.toHex8();
        },
        toRgb: function() {
            return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };
        },
        toRgbString: function() {
            return (this._a == 1) ?
              "rgb("  + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ")" :
              "rgba(" + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ", " + this._roundA + ")";
        },
        toPercentageRgb: function() {
            return { r: mathRound(bound01(this._r, 255) * 100) + "%", g: mathRound(bound01(this._g, 255) * 100) + "%", b: mathRound(bound01(this._b, 255) * 100) + "%", a: this._a };
        },
        toPercentageRgbString: function() {
            return (this._a == 1) ?
              "rgb("  + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%)" :
              "rgba(" + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%, " + this._roundA + ")";
        },
        toName: function() {
            if (this._a === 0) {
                return "transparent";
            }

            if (this._a < 1) {
                return false;
            }

            return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;
        },
        toFilter: function(secondColor) {
            var hex8String = '#' + rgbaToHex(this._r, this._g, this._b, this._a);
            var secondHex8String = hex8String;
            var gradientType = this._gradientType ? "GradientType = 1, " : "";

            if (secondColor) {
                var s = tinycolor(secondColor);
                secondHex8String = s.toHex8String();
            }

            return "progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")";
        },
        toString: function(format) {
            var formatSet = !!format;
            format = format || this._format;

            var formattedString = false;
            var hasAlpha = this._a < 1 && this._a >= 0;
            var needsAlphaFormat = !formatSet && hasAlpha && (format === "hex" || format === "hex6" || format === "hex3" || format === "name");

            if (needsAlphaFormat) {
                // Special case for "transparent", all other non-alpha formats
                // will return rgba when there is transparency.
                if (format === "name" && this._a === 0) {
                    return this.toName();
                }
                return this.toRgbString();
            }
            if (format === "rgb") {
                formattedString = this.toRgbString();
            }
            if (format === "prgb") {
                formattedString = this.toPercentageRgbString();
            }
            if (format === "hex" || format === "hex6") {
                formattedString = this.toHexString();
            }
            if (format === "hex3") {
                formattedString = this.toHexString(true);
            }
            if (format === "hex8") {
                formattedString = this.toHex8String();
            }
            if (format === "name") {
                formattedString = this.toName();
            }
            if (format === "hsl") {
                formattedString = this.toHslString();
            }
            if (format === "hsv") {
                formattedString = this.toHsvString();
            }

            return formattedString || this.toHexString();
        },

        _applyModification: function(fn, args) {
            var color = fn.apply(null, [this].concat([].slice.call(args)));
            this._r = color._r;
            this._g = color._g;
            this._b = color._b;
            this.setAlpha(color._a);
            return this;
        },
        lighten: function() {
            return this._applyModification(lighten, arguments);
        },
        brighten: function() {
            return this._applyModification(brighten, arguments);
        },
        darken: function() {
            return this._applyModification(darken, arguments);
        },
        desaturate: function() {
            return this._applyModification(desaturate, arguments);
        },
        saturate: function() {
            return this._applyModification(saturate, arguments);
        },
        greyscale: function() {
            return this._applyModification(greyscale, arguments);
        },
        spin: function() {
            return this._applyModification(spin, arguments);
        },

        _applyCombination: function(fn, args) {
            return fn.apply(null, [this].concat([].slice.call(args)));
        },
        analogous: function() {
            return this._applyCombination(analogous, arguments);
        },
        complement: function() {
            return this._applyCombination(complement, arguments);
        },
        monochromatic: function() {
            return this._applyCombination(monochromatic, arguments);
        },
        splitcomplement: function() {
            return this._applyCombination(splitcomplement, arguments);
        },
        triad: function() {
            return this._applyCombination(triad, arguments);
        },
        tetrad: function() {
            return this._applyCombination(tetrad, arguments);
        }
    };

    // If input is an object, force 1 into "1.0" to handle ratios properly
    // String input requires "1.0" as input, so 1 will be treated as 1
    tinycolor.fromRatio = function(color, opts) {
        if (typeof color == "object") {
            var newColor = {};
            for (var i in color) {
                if (color.hasOwnProperty(i)) {
                    if (i === "a") {
                        newColor[i] = color[i];
                    }
                    else {
                        newColor[i] = convertToPercentage(color[i]);
                    }
                }
            }
            color = newColor;
        }

        return tinycolor(color, opts);
    };

    // Given a string or object, convert that input to RGB
    // Possible string inputs:
    //
    //     "red"
    //     "#f00" or "f00"
    //     "#ff0000" or "ff0000"
    //     "#ff000000" or "ff000000"
    //     "rgb 255 0 0" or "rgb (255, 0, 0)"
    //     "rgb 1.0 0 0" or "rgb (1, 0, 0)"
    //     "rgba (255, 0, 0, 1)" or "rgba 255, 0, 0, 1"
    //     "rgba (1.0, 0, 0, 1)" or "rgba 1.0, 0, 0, 1"
    //     "hsl(0, 100%, 50%)" or "hsl 0 100% 50%"
    //     "hsla(0, 100%, 50%, 1)" or "hsla 0 100% 50%, 1"
    //     "hsv(0, 100%, 100%)" or "hsv 0 100% 100%"
    //
    function inputToRGB(color) {

        var rgb = { r: 0, g: 0, b: 0 };
        var a = 1;
        var ok = false;
        var format = false;

        if (typeof color == "string") {
            color = stringInputToObject(color);
        }

        if (typeof color == "object") {
            if (color.hasOwnProperty("r") && color.hasOwnProperty("g") && color.hasOwnProperty("b")) {
                rgb = rgbToRgb(color.r, color.g, color.b);
                ok = true;
                format = String(color.r).substr(-1) === "%" ? "prgb" : "rgb";
            }
            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("v")) {
                color.s = convertToPercentage(color.s);
                color.v = convertToPercentage(color.v);
                rgb = hsvToRgb(color.h, color.s, color.v);
                ok = true;
                format = "hsv";
            }
            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("l")) {
                color.s = convertToPercentage(color.s);
                color.l = convertToPercentage(color.l);
                rgb = hslToRgb(color.h, color.s, color.l);
                ok = true;
                format = "hsl";
            }

            if (color.hasOwnProperty("a")) {
                a = color.a;
            }
        }

        a = boundAlpha(a);

        return {
            ok: ok,
            format: color.format || format,
            r: mathMin(255, mathMax(rgb.r, 0)),
            g: mathMin(255, mathMax(rgb.g, 0)),
            b: mathMin(255, mathMax(rgb.b, 0)),
            a: a
        };
    }


    // Conversion Functions
    // --------------------

    // `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:
    // <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>

    // `rgbToRgb`
    // Handle bounds / percentage checking to conform to CSS color spec
    // <http://www.w3.org/TR/css3-color/>
    // *Assumes:* r, g, b in [0, 255] or [0, 1]
    // *Returns:* { r, g, b } in [0, 255]
    function rgbToRgb(r, g, b){
        return {
            r: bound01(r, 255) * 255,
            g: bound01(g, 255) * 255,
            b: bound01(b, 255) * 255
        };
    }

    // `rgbToHsl`
    // Converts an RGB color value to HSL.
    // *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]
    // *Returns:* { h, s, l } in [0,1]
    function rgbToHsl(r, g, b) {

        r = bound01(r, 255);
        g = bound01(g, 255);
        b = bound01(b, 255);

        var max = mathMax(r, g, b), min = mathMin(r, g, b);
        var h, s, l = (max + min) / 2;

        if(max == min) {
            h = s = 0; // achromatic
        }
        else {
            var d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch(max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }

            h /= 6;
        }

        return { h: h, s: s, l: l };
    }

    // `hslToRgb`
    // Converts an HSL color value to RGB.
    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]
    // *Returns:* { r, g, b } in the set [0, 255]
    function hslToRgb(h, s, l) {
        var r, g, b;

        h = bound01(h, 360);
        s = bound01(s, 100);
        l = bound01(l, 100);

        function hue2rgb(p, q, t) {
            if(t < 0) t += 1;
            if(t > 1) t -= 1;
            if(t < 1/6) return p + (q - p) * 6 * t;
            if(t < 1/2) return q;
            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;
            return p;
        }

        if(s === 0) {
            r = g = b = l; // achromatic
        }
        else {
            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
            var p = 2 * l - q;
            r = hue2rgb(p, q, h + 1/3);
            g = hue2rgb(p, q, h);
            b = hue2rgb(p, q, h - 1/3);
        }

        return { r: r * 255, g: g * 255, b: b * 255 };
    }

    // `rgbToHsv`
    // Converts an RGB color value to HSV
    // *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]
    // *Returns:* { h, s, v } in [0,1]
    function rgbToHsv(r, g, b) {

        r = bound01(r, 255);
        g = bound01(g, 255);
        b = bound01(b, 255);

        var max = mathMax(r, g, b), min = mathMin(r, g, b);
        var h, s, v = max;

        var d = max - min;
        s = max === 0 ? 0 : d / max;

        if(max == min) {
            h = 0; // achromatic
        }
        else {
            switch(max) {
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return { h: h, s: s, v: v };
    }

    // `hsvToRgb`
    // Converts an HSV color value to RGB.
    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]
    // *Returns:* { r, g, b } in the set [0, 255]
     function hsvToRgb(h, s, v) {

        h = bound01(h, 360) * 6;
        s = bound01(s, 100);
        v = bound01(v, 100);

        var i = math.floor(h),
            f = h - i,
            p = v * (1 - s),
            q = v * (1 - f * s),
            t = v * (1 - (1 - f) * s),
            mod = i % 6,
            r = [v, q, p, p, t, v][mod],
            g = [t, v, v, q, p, p][mod],
            b = [p, p, t, v, v, q][mod];

        return { r: r * 255, g: g * 255, b: b * 255 };
    }

    // `rgbToHex`
    // Converts an RGB color to hex
    // Assumes r, g, and b are contained in the set [0, 255]
    // Returns a 3 or 6 character hex
    function rgbToHex(r, g, b, allow3Char) {

        var hex = [
            pad2(mathRound(r).toString(16)),
            pad2(mathRound(g).toString(16)),
            pad2(mathRound(b).toString(16))
        ];

        // Return a 3 character hex if possible
        if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {
            return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);
        }

        return hex.join("");
    }
        // `rgbaToHex`
        // Converts an RGBA color plus alpha transparency to hex
        // Assumes r, g, b and a are contained in the set [0, 255]
        // Returns an 8 character hex
        function rgbaToHex(r, g, b, a) {

            var hex = [
                pad2(convertDecimalToHex(a)),
                pad2(mathRound(r).toString(16)),
                pad2(mathRound(g).toString(16)),
                pad2(mathRound(b).toString(16))
            ];

            return hex.join("");
        }

    // `equals`
    // Can be called with any tinycolor input
    tinycolor.equals = function (color1, color2) {
        if (!color1 || !color2) { return false; }
        return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();
    };
    tinycolor.random = function() {
        return tinycolor.fromRatio({
            r: mathRandom(),
            g: mathRandom(),
            b: mathRandom()
        });
    };


    // Modification Functions
    // ----------------------
    // Thanks to less.js for some of the basics here
    // <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>

    function desaturate(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.s -= amount / 100;
        hsl.s = clamp01(hsl.s);
        return tinycolor(hsl);
    }

    function saturate(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.s += amount / 100;
        hsl.s = clamp01(hsl.s);
        return tinycolor(hsl);
    }

    function greyscale(color) {
        return tinycolor(color).desaturate(100);
    }

    function lighten (color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.l += amount / 100;
        hsl.l = clamp01(hsl.l);
        return tinycolor(hsl);
    }

    function brighten(color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var rgb = tinycolor(color).toRgb();
        rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));
        rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));
        rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));
        return tinycolor(rgb);
    }

    function darken (color, amount) {
        amount = (amount === 0) ? 0 : (amount || 10);
        var hsl = tinycolor(color).toHsl();
        hsl.l -= amount / 100;
        hsl.l = clamp01(hsl.l);
        return tinycolor(hsl);
    }

    // Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.
    // Values outside of this range will be wrapped into this range.
    function spin(color, amount) {
        var hsl = tinycolor(color).toHsl();
        var hue = (mathRound(hsl.h) + amount) % 360;
        hsl.h = hue < 0 ? 360 + hue : hue;
        return tinycolor(hsl);
    }

    // Combination Functions
    // ---------------------
    // Thanks to jQuery xColor for some of the ideas behind these
    // <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>

    function complement(color) {
        var hsl = tinycolor(color).toHsl();
        hsl.h = (hsl.h + 180) % 360;
        return tinycolor(hsl);
    }

    function triad(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })
        ];
    }

    function tetrad(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),
            tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })
        ];
    }

    function splitcomplement(color) {
        var hsl = tinycolor(color).toHsl();
        var h = hsl.h;
        return [
            tinycolor(color),
            tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),
            tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})
        ];
    }

    function analogous(color, results, slices) {
        results = results || 6;
        slices = slices || 30;

        var hsl = tinycolor(color).toHsl();
        var part = 360 / slices;
        var ret = [tinycolor(color)];

        for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {
            hsl.h = (hsl.h + part) % 360;
            ret.push(tinycolor(hsl));
        }
        return ret;
    }

    function monochromatic(color, results) {
        results = results || 6;
        var hsv = tinycolor(color).toHsv();
        var h = hsv.h, s = hsv.s, v = hsv.v;
        var ret = [];
        var modification = 1 / results;

        while (results--) {
            ret.push(tinycolor({ h: h, s: s, v: v}));
            v = (v + modification) % 1;
        }

        return ret;
    }

    // Utility Functions
    // ---------------------

    tinycolor.mix = function(color1, color2, amount) {
        amount = (amount === 0) ? 0 : (amount || 50);

        var rgb1 = tinycolor(color1).toRgb();
        var rgb2 = tinycolor(color2).toRgb();

        var p = amount / 100;
        var w = p * 2 - 1;
        var a = rgb2.a - rgb1.a;

        var w1;

        if (w * a == -1) {
            w1 = w;
        } else {
            w1 = (w + a) / (1 + w * a);
        }

        w1 = (w1 + 1) / 2;

        var w2 = 1 - w1;

        var rgba = {
            r: rgb2.r * w1 + rgb1.r * w2,
            g: rgb2.g * w1 + rgb1.g * w2,
            b: rgb2.b * w1 + rgb1.b * w2,
            a: rgb2.a * p  + rgb1.a * (1 - p)
        };

        return tinycolor(rgba);
    };


    // Readability Functions
    // ---------------------
    // <http://www.w3.org/TR/AERT#color-contrast>

    // `readability`
    // Analyze the 2 colors and returns an object with the following properties:
    //    `brightness`: difference in brightness between the two colors
    //    `color`: difference in color/hue between the two colors
    tinycolor.readability = function(color1, color2) {
        var c1 = tinycolor(color1);
        var c2 = tinycolor(color2);
        var rgb1 = c1.toRgb();
        var rgb2 = c2.toRgb();
        var brightnessA = c1.getBrightness();
        var brightnessB = c2.getBrightness();
        var colorDiff = (
            Math.max(rgb1.r, rgb2.r) - Math.min(rgb1.r, rgb2.r) +
            Math.max(rgb1.g, rgb2.g) - Math.min(rgb1.g, rgb2.g) +
            Math.max(rgb1.b, rgb2.b) - Math.min(rgb1.b, rgb2.b)
        );

        return {
            brightness: Math.abs(brightnessA - brightnessB),
            color: colorDiff
        };
    };

    // `readable`
    // http://www.w3.org/TR/AERT#color-contrast
    // Ensure that foreground and background color combinations provide sufficient contrast.
    // *Example*
    //    tinycolor.isReadable("#000", "#111") => false
    tinycolor.isReadable = function(color1, color2) {
        var readability = tinycolor.readability(color1, color2);
        return readability.brightness > 125 && readability.color > 500;
    };

    // `mostReadable`
    // Given a base color and a list of possible foreground or background
    // colors for that base, returns the most readable color.
    // *Example*
    //    tinycolor.mostReadable("#123", ["#fff", "#000"]) => "#000"
    tinycolor.mostReadable = function(baseColor, colorList) {
        var bestColor = null;
        var bestScore = 0;
        var bestIsReadable = false;
        for (var i=0; i < colorList.length; i++) {

            // We normalize both around the "acceptable" breaking point,
            // but rank brightness constrast higher than hue.

            var readability = tinycolor.readability(baseColor, colorList[i]);
            var readable = readability.brightness > 125 && readability.color > 500;
            var score = 3 * (readability.brightness / 125) + (readability.color / 500);

            if ((readable && ! bestIsReadable) ||
                (readable && bestIsReadable && score > bestScore) ||
                ((! readable) && (! bestIsReadable) && score > bestScore)) {
                bestIsReadable = readable;
                bestScore = score;
                bestColor = tinycolor(colorList[i]);
            }
        }
        return bestColor;
    };


    // Big List of Colors
    // ------------------
    // <http://www.w3.org/TR/css3-color/#svg-color>
    var names = tinycolor.names = {
        aliceblue: "f0f8ff",
        antiquewhite: "faebd7",
        aqua: "0ff",
        aquamarine: "7fffd4",
        azure: "f0ffff",
        beige: "f5f5dc",
        bisque: "ffe4c4",
        black: "000",
        blanchedalmond: "ffebcd",
        blue: "00f",
        blueviolet: "8a2be2",
        brown: "a52a2a",
        burlywood: "deb887",
        burntsienna: "ea7e5d",
        cadetblue: "5f9ea0",
        chartreuse: "7fff00",
        chocolate: "d2691e",
        coral: "ff7f50",
        cornflowerblue: "6495ed",
        cornsilk: "fff8dc",
        crimson: "dc143c",
        cyan: "0ff",
        darkblue: "00008b",
        darkcyan: "008b8b",
        darkgoldenrod: "b8860b",
        darkgray: "a9a9a9",
        darkgreen: "006400",
        darkgrey: "a9a9a9",
        darkkhaki: "bdb76b",
        darkmagenta: "8b008b",
        darkolivegreen: "556b2f",
        darkorange: "ff8c00",
        darkorchid: "9932cc",
        darkred: "8b0000",
        darksalmon: "e9967a",
        darkseagreen: "8fbc8f",
        darkslateblue: "483d8b",
        darkslategray: "2f4f4f",
        darkslategrey: "2f4f4f",
        darkturquoise: "00ced1",
        darkviolet: "9400d3",
        deeppink: "ff1493",
        deepskyblue: "00bfff",
        dimgray: "696969",
        dimgrey: "696969",
        dodgerblue: "1e90ff",
        firebrick: "b22222",
        floralwhite: "fffaf0",
        forestgreen: "228b22",
        fuchsia: "f0f",
        gainsboro: "dcdcdc",
        ghostwhite: "f8f8ff",
        gold: "ffd700",
        goldenrod: "daa520",
        gray: "808080",
        green: "008000",
        greenyellow: "adff2f",
        grey: "808080",
        honeydew: "f0fff0",
        hotpink: "ff69b4",
        indianred: "cd5c5c",
        indigo: "4b0082",
        ivory: "fffff0",
        khaki: "f0e68c",
        lavender: "e6e6fa",
        lavenderblush: "fff0f5",
        lawngreen: "7cfc00",
        lemonchiffon: "fffacd",
        lightblue: "add8e6",
        lightcoral: "f08080",
        lightcyan: "e0ffff",
        lightgoldenrodyellow: "fafad2",
        lightgray: "d3d3d3",
        lightgreen: "90ee90",
        lightgrey: "d3d3d3",
        lightpink: "ffb6c1",
        lightsalmon: "ffa07a",
        lightseagreen: "20b2aa",
        lightskyblue: "87cefa",
        lightslategray: "789",
        lightslategrey: "789",
        lightsteelblue: "b0c4de",
        lightyellow: "ffffe0",
        lime: "0f0",
        limegreen: "32cd32",
        linen: "faf0e6",
        magenta: "f0f",
        maroon: "800000",
        mediumaquamarine: "66cdaa",
        mediumblue: "0000cd",
        mediumorchid: "ba55d3",
        mediumpurple: "9370db",
        mediumseagreen: "3cb371",
        mediumslateblue: "7b68ee",
        mediumspringgreen: "00fa9a",
        mediumturquoise: "48d1cc",
        mediumvioletred: "c71585",
        midnightblue: "191970",
        mintcream: "f5fffa",
        mistyrose: "ffe4e1",
        moccasin: "ffe4b5",
        navajowhite: "ffdead",
        navy: "000080",
        oldlace: "fdf5e6",
        olive: "808000",
        olivedrab: "6b8e23",
        orange: "ffa500",
        orangered: "ff4500",
        orchid: "da70d6",
        palegoldenrod: "eee8aa",
        palegreen: "98fb98",
        paleturquoise: "afeeee",
        palevioletred: "db7093",
        papayawhip: "ffefd5",
        peachpuff: "ffdab9",
        peru: "cd853f",
        pink: "ffc0cb",
        plum: "dda0dd",
        powderblue: "b0e0e6",
        purple: "800080",
        rebeccapurple: "663399",
        red: "f00",
        rosybrown: "bc8f8f",
        royalblue: "4169e1",
        saddlebrown: "8b4513",
        salmon: "fa8072",
        sandybrown: "f4a460",
        seagreen: "2e8b57",
        seashell: "fff5ee",
        sienna: "a0522d",
        silver: "c0c0c0",
        skyblue: "87ceeb",
        slateblue: "6a5acd",
        slategray: "708090",
        slategrey: "708090",
        snow: "fffafa",
        springgreen: "00ff7f",
        steelblue: "4682b4",
        tan: "d2b48c",
        teal: "008080",
        thistle: "d8bfd8",
        tomato: "ff6347",
        turquoise: "40e0d0",
        violet: "ee82ee",
        wheat: "f5deb3",
        white: "fff",
        whitesmoke: "f5f5f5",
        yellow: "ff0",
        yellowgreen: "9acd32"
    };

    // Make it easy to access colors via `hexNames[hex]`
    var hexNames = tinycolor.hexNames = flip(names);


    // Utilities
    // ---------

    // `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`
    function flip(o) {
        var flipped = { };
        for (var i in o) {
            if (o.hasOwnProperty(i)) {
                flipped[o[i]] = i;
            }
        }
        return flipped;
    }

    // Return a valid alpha value [0,1] with all invalid values being set to 1
    function boundAlpha(a) {
        a = parseFloat(a);

        if (isNaN(a) || a < 0 || a > 1) {
            a = 1;
        }

        return a;
    }

    // Take input from [0, n] and return it as [0, 1]
    function bound01(n, max) {
        if (isOnePointZero(n)) { n = "100%"; }

        var processPercent = isPercentage(n);
        n = mathMin(max, mathMax(0, parseFloat(n)));

        // Automatically convert percentage into number
        if (processPercent) {
            n = parseInt(n * max, 10) / 100;
        }

        // Handle floating point rounding errors
        if ((math.abs(n - max) < 0.000001)) {
            return 1;
        }

        // Convert into [0, 1] range if it isn't already
        return (n % max) / parseFloat(max);
    }

    // Force a number between 0 and 1
    function clamp01(val) {
        return mathMin(1, mathMax(0, val));
    }

    // Parse a base-16 hex value into a base-10 integer
    function parseIntFromHex(val) {
        return parseInt(val, 16);
    }

    // Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1
    // <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>
    function isOnePointZero(n) {
        return typeof n == "string" && n.indexOf('.') != -1 && parseFloat(n) === 1;
    }

    // Check to see if string passed in is a percentage
    function isPercentage(n) {
        return typeof n === "string" && n.indexOf('%') != -1;
    }

    // Force a hex value to have 2 characters
    function pad2(c) {
        return c.length == 1 ? '0' + c : '' + c;
    }

    // Replace a decimal with it's percentage value
    function convertToPercentage(n) {
        if (n <= 1) {
            n = (n * 100) + "%";
        }

        return n;
    }

    // Converts a decimal to a hex value
    function convertDecimalToHex(d) {
        return Math.round(parseFloat(d) * 255).toString(16);
    }
    // Converts a hex value to a decimal
    function convertHexToDecimal(h) {
        return (parseIntFromHex(h) / 255);
    }

    var matchers = (function() {

        // <http://www.w3.org/TR/css3-values/#integers>
        var CSS_INTEGER = "[-\\+]?\\d+%?";

        // <http://www.w3.org/TR/css3-values/#number-value>
        var CSS_NUMBER = "[-\\+]?\\d*\\.\\d+%?";

        // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.
        var CSS_UNIT = "(?:" + CSS_NUMBER + ")|(?:" + CSS_INTEGER + ")";

        // Actual matching.
        // Parentheses and commas are optional, but not required.
        // Whitespace can take the place of commas or opening paren
        var PERMISSIVE_MATCH3 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";
        var PERMISSIVE_MATCH4 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";

        return {
            rgb: new RegExp("rgb" + PERMISSIVE_MATCH3),
            rgba: new RegExp("rgba" + PERMISSIVE_MATCH4),
            hsl: new RegExp("hsl" + PERMISSIVE_MATCH3),
            hsla: new RegExp("hsla" + PERMISSIVE_MATCH4),
            hsv: new RegExp("hsv" + PERMISSIVE_MATCH3),
            hsva: new RegExp("hsva" + PERMISSIVE_MATCH4),
            hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
            hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,
            hex8: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
        };
    })();

    // `stringInputToObject`
    // Permissive string parsing.  Take in a number of formats, and output an object
    // based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`
    function stringInputToObject(color) {

        color = color.replace(trimLeft,'').replace(trimRight, '').toLowerCase();
        var named = false;
        if (names[color]) {
            color = names[color];
            named = true;
        }
        else if (color == 'transparent') {
            return { r: 0, g: 0, b: 0, a: 0, format: "name" };
        }

        // Try to match string input using regular expressions.
        // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]
        // Just return an object and let the conversion functions handle that.
        // This way the result will be the same whether the tinycolor is initialized with string or object.
        var match;
        if ((match = matchers.rgb.exec(color))) {
            return { r: match[1], g: match[2], b: match[3] };
        }
        if ((match = matchers.rgba.exec(color))) {
            return { r: match[1], g: match[2], b: match[3], a: match[4] };
        }
        if ((match = matchers.hsl.exec(color))) {
            return { h: match[1], s: match[2], l: match[3] };
        }
        if ((match = matchers.hsla.exec(color))) {
            return { h: match[1], s: match[2], l: match[3], a: match[4] };
        }
        if ((match = matchers.hsv.exec(color))) {
            return { h: match[1], s: match[2], v: match[3] };
        }
        if ((match = matchers.hsva.exec(color))) {
            return { h: match[1], s: match[2], v: match[3], a: match[4] };
        }
        if ((match = matchers.hex8.exec(color))) {
            return {
                a: convertHexToDecimal(match[1]),
                r: parseIntFromHex(match[2]),
                g: parseIntFromHex(match[3]),
                b: parseIntFromHex(match[4]),
                format: named ? "name" : "hex8"
            };
        }
        if ((match = matchers.hex6.exec(color))) {
            return {
                r: parseIntFromHex(match[1]),
                g: parseIntFromHex(match[2]),
                b: parseIntFromHex(match[3]),
                format: named ? "name" : "hex"
            };
        }
        if ((match = matchers.hex3.exec(color))) {
            return {
                r: parseIntFromHex(match[1] + '' + match[1]),
                g: parseIntFromHex(match[2] + '' + match[2]),
                b: parseIntFromHex(match[3] + '' + match[3]),
                format: named ? "name" : "hex"
            };
        }

        return false;
    }

    window.tinycolor = tinycolor;
    })();


    $(function () {
        if ($.fn.spectrum.load) {
            $.fn.spectrum.processNativeColorInputs();
        }
    });

});

/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==kb?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ib.length;){if(c=ib[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return ob++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:rb?N:sb?Q:qb?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&yb&&d-e===0,g=b&(Ab|Bb)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=nb(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===yb||f.eventType===Ab)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Bb&&(i>xb||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=mb(l.x)>mb(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:lb(a.pointers[c].clientX),clientY:lb(a.pointers[c].clientY)},c++;return{timeStamp:nb(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:lb(a[0].clientX),y:lb(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:lb(c/b),y:lb(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Cb:mb(a)>=mb(b)?a>0?Db:Eb:b>0?Fb:Gb}function I(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],Lb)-J(a[1],a[0],Lb)}function L(a,b){return I(b[0],b[1],Lb)/I(a[0],a[1],Lb)}function M(){this.evEl=Nb,this.evWin=Ob,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Rb,this.evWin=Sb,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ub,this.evWin=Vb,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Ab|Bb)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xb,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(yb|zb)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===yb)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ab|Bb)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bc))return bc;var b=q(a,cc),c=q(a,dc);return b&&c?cc+" "+dc:b||c?b?cc:dc:q(a,ac)?ac:_b}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=ec,this.simultaneous={},this.requireFail=[]}function W(a){return a&jc?"cancel":a&hc?"end":a&gc?"move":a&fc?"start":""}function X(a){return a==Gb?"down":a==Fb?"up":a==Db?"left":a==Eb?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function ab(){V.apply(this,arguments),this._timer=null,this._input=null}function bb(){Z.apply(this,arguments)}function cb(){Z.apply(this,arguments)}function db(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function eb(a,b){return b=b||{},b.recognizers=m(b.recognizers,eb.defaults.preset),new fb(a,b)}function fb(a,b){b=b||{},this.options=i(b,eb.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),gb(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function gb(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function hb(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ib=["","webkit","moz","MS","ms","o"],jb=b.createElement("div"),kb="function",lb=Math.round,mb=Math.abs,nb=Date.now,ob=1,pb=/mobile|tablet|ip(ad|hone|od)|android/i,qb="ontouchstart"in a,rb=v(a,"PointerEvent")!==d,sb=qb&&pb.test(navigator.userAgent),tb="touch",ub="pen",vb="mouse",wb="kinect",xb=25,yb=1,zb=2,Ab=4,Bb=8,Cb=1,Db=2,Eb=4,Fb=8,Gb=16,Hb=Db|Eb,Ib=Fb|Gb,Jb=Hb|Ib,Kb=["x","y"],Lb=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Mb={mousedown:yb,mousemove:zb,mouseup:Ab},Nb="mousedown",Ob="mousemove mouseup";j(M,y,{handler:function(a){var b=Mb[a.type];b&yb&&0===a.button&&(this.pressed=!0),b&zb&&1!==a.which&&(b=Ab),this.pressed&&this.allow&&(b&Ab&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:vb,srcEvent:a}))}});var Pb={pointerdown:yb,pointermove:zb,pointerup:Ab,pointercancel:Bb,pointerout:Bb},Qb={2:tb,3:ub,4:vb,5:wb},Rb="pointerdown",Sb="pointermove pointerup pointercancel";a.MSPointerEvent&&(Rb="MSPointerDown",Sb="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pb[d],f=Qb[a.pointerType]||a.pointerType,g=f==tb,h=s(b,a.pointerId,"pointerId");e&yb&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ab|Bb)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Tb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Ub="touchstart",Vb="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Tb[a.type];if(b===yb&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Ab|Bb)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}});var Wb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Xb="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wb[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==tb,e=c.pointerType==vb;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Ab|Bb)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Yb=v(jb.style,"touchAction"),Zb=Yb!==d,$b="compute",_b="auto",ac="manipulation",bc="none",cc="pan-x",dc="pan-y";T.prototype={set:function(a){a==$b&&(a=this.compute()),Zb&&(this.manager.element.style[Yb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Zb){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bc),f=q(d,dc),g=q(d,cc);return e||f&&c&Hb||g&&c&Ib?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var ec=1,fc=2,gc=4,hc=8,ic=hc,jc=16,kc=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hc>d&&b(!0),b(),d>=hc&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kc)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kc|ec)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ic|jc|kc)&&(this.state=ec),this.state=this.process(b),void(this.state&(fc|gc|hc|jc)&&this.tryEmit(b))):(this.reset(),void(this.state=kc))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fc|gc),e=this.attrTest(a);return d&&(c&Bb||!e)?b|jc:d||e?c&Ab?b|hc:b&fc?b|gc:fc:kc}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Jb},getTouchAction:function(){var a=this.options.direction,b=[];return a&Hb&&b.push(dc),a&Ib&&b.push(cc),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Hb?(e=0===f?Cb:0>f?Db:Eb,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Cb:0>g?Fb:Gb,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fc||!(this.state&fc)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fc)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(ab,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_b]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ab|Bb)&&!f)this.reset();else if(a.eventType&yb)this.reset(),this._timer=e(function(){this.state=ic,this.tryEmit()},b.time,this);else if(a.eventType&Ab)return ic;return kc},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ic&&(a&&a.eventType&Ab?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=nb(),this.manager.emit(this.options.event,this._input)))}}),j(bb,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fc)}}),j(cb,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Hb|Ib,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Hb|Ib)?b=a.velocity:c&Hb?b=a.velocityX:c&Ib&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&mb(b)>this.options.velocity&&a.eventType&Ab},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(db,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ac]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&yb&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ab)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ic,this.tryEmit()},b.interval,this),fc):ic}return kc},failTimeout:function(){return this._timer=e(function(){this.state=kc},this.options.interval,this),kc},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ic&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),eb.VERSION="2.0.4",eb.defaults={domEvents:!1,touchAction:$b,enable:!0,inputTarget:null,inputClass:null,preset:[[bb,{enable:!1}],[_,{enable:!1},["rotate"]],[cb,{direction:Hb}],[$,{direction:Hb},["swipe"]],[db],[db,{event:"doubletap",taps:2},["tap"]],[ab]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lc=1,mc=2;fb.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mc:lc},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ic)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mc||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fc|gc|hc)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&hb(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&gb(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(eb,{INPUT_START:yb,INPUT_MOVE:zb,INPUT_END:Ab,INPUT_CANCEL:Bb,STATE_POSSIBLE:ec,STATE_BEGAN:fc,STATE_CHANGED:gc,STATE_ENDED:hc,STATE_RECOGNIZED:ic,STATE_CANCELLED:jc,STATE_FAILED:kc,DIRECTION_NONE:Cb,DIRECTION_LEFT:Db,DIRECTION_RIGHT:Eb,DIRECTION_UP:Fb,DIRECTION_DOWN:Gb,DIRECTION_HORIZONTAL:Hb,DIRECTION_VERTICAL:Ib,DIRECTION_ALL:Jb,Manager:fb,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:db,Pan:$,Swipe:cb,Pinch:_,Rotate:bb,Press:ab,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==kb&&define.amd?define(function(){return eb}):"undefined"!=typeof module&&module.exports?module.exports=eb:a[c]=eb}(window,document,"Hammer");
//# sourceMappingURL=hammer.min.map
/* == jquery mousewheel plugin == Version: 3.1.12, License: MIT License (MIT) */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
/* == malihu jquery custom scrollbar plugin == Version: 3.0.7, License: MIT License (MIT) */
!function(e,t,a){!function(t){var o="function"==typeof define&&define.amd,n="https:"==a.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";o||e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E")),t()}(function(){var o,n="mCustomScrollbar",i="mCS",r=".mCustomScrollbar",l={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:!0},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},s=0,c={},d=t.attachEvent&&!t.addEventListener?1:0,u=!1,f=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],h={init:function(t){var t=e.extend(!0,{},l,t),a=m.call(this);if(t.live){var o=t.liveSelector||this.selector||r,n=e(o);if("off"===t.live)return void g(o);c[o]=setTimeout(function(){n.mCustomScrollbar(t),"once"===t.live&&n.length&&g(o)},500)}else g(o);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":v(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=x(t.scrollButtons.scrollType),p(t),e(a).each(function(){var a=e(this);if(!a.data(i)){a.data(i,{idx:++s,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:a.css("direction"),cbOffsets:null,trigger:null});var o=a.data(i),n=o.opt,r=a.data("mcs-axis"),l=a.data("mcs-scrollbar-position"),c=a.data("mcs-theme");r&&(n.axis=r),l&&(n.scrollbarPosition=l),c&&(n.theme=c,p(n)),_.call(this),e("#mCSB_"+o.idx+"_container img:not(."+f[2]+")").addClass(f[2]),h.update.call(null,a)}})},update:function(t,a){var o=t||m.call(this);return e(o).each(function(){var t=e(this);if(t.data(i)){var o=t.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(!r.length)return;o.tweenRunning&&Q(t),t.hasClass(f[3])&&t.removeClass(f[3]),t.hasClass(f[4])&&t.removeClass(f[4]),C.call(this),w.call(this),"y"===n.axis||n.advanced.autoExpandHorizontalScroll||r.css("width",S(r.children())),o.overflowed=k.call(this),R.call(this),n.autoDraggerLength&&y.call(this),B.call(this),O.call(this);var s=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==n.axis&&(o.overflowed[0]?l[0].height()>l[0].parent().height()?M.call(this):(G(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}),o.contentReset.y=null):(M.call(this),"y"===n.axis?I.call(this):"yx"===n.axis&&o.overflowed[1]&&G(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==n.axis&&(o.overflowed[1]?l[1].width()>l[1].parent().width()?M.call(this):(G(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}),o.contentReset.x=null):(M.call(this),"x"===n.axis?I.call(this):"yx"===n.axis&&o.overflowed[0]&&G(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),a&&o&&(2===a&&n.callbacks.onImageLoad&&"function"==typeof n.callbacks.onImageLoad?n.callbacks.onImageLoad.call(this):3===a&&n.callbacks.onSelectorChange&&"function"==typeof n.callbacks.onSelectorChange?n.callbacks.onSelectorChange.call(this):n.callbacks.onUpdate&&"function"==typeof n.callbacks.onUpdate&&n.callbacks.onUpdate.call(this)),N.call(this)}})},scrollTo:function(t,a){if("undefined"!=typeof t&&null!=t){var o=m.call(this);return e(o).each(function(){var o=e(this);if(o.data(i)){var n=o.data(i),r=n.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,a),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=X.call(this,c[0],"y"),c[1]=X.call(this,c[1],"x"),s.moveDragger&&(c[0]*=n.scrollRatio.y,c[1]*=n.scrollRatio.x),s.dur=d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&n.overflowed[0]&&(s.dir="y",s.overwrite="all",G(o,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&n.overflowed[1]&&(s.dir="x",s.overwrite="none",G(o,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=m.call(this);return e(t).each(function(){var t=e(this);t.data(i)&&Q(t)})},disable:function(t){var a=m.call(this);return e(a).each(function(){var a=e(this);if(a.data(i)){{a.data(i)}N.call(this,"remove"),I.call(this),t&&M.call(this),R.call(this,!0),a.addClass(f[3])}})},destroy:function(){var t=m.call(this);return e(t).each(function(){var a=e(this);if(a.data(i)){var o=a.data(i),r=o.opt,l=e("#mCSB_"+o.idx),s=e("#mCSB_"+o.idx+"_container"),c=e(".mCSB_"+o.idx+"_scrollbar");r.live&&g(r.liveSelector||e(t).selector),N.call(this,"remove"),I.call(this),M.call(this),a.removeData(i),$(this,"mcs"),c.remove(),s.find("img."+f[2]).removeClass(f[2]),l.replaceWith(s.contents()),a.removeClass(n+" _"+i+"_"+o.idx+" "+f[6]+" "+f[7]+" "+f[5]+" "+f[3]).addClass(f[4])}})}},m=function(){return"object"!=typeof e(this)||e(this).length<1?r:this},p=function(t){var a=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],o=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,a)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,o)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},g=function(e){c[e]&&(clearTimeout(c[e]),$(c,e))},v=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},x=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},_=function(){var t=e(this),a=t.data(i),o=a.opt,r=o.autoExpandScrollbar?" "+f[1]+"_expand":"",l=["<div id='mCSB_"+a.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+f[12]+"'><div id='mCSB_"+a.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+a.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+a.idx+"_scrollbar mCS-"+o.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+f[12]+"'><div id='mCSB_"+a.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===o.axis?"mCSB_vertical_horizontal":"x"===o.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===o.axis?l[0]+l[1]:"x"===o.axis?l[1]:l[0],d="yx"===o.axis?"<div id='mCSB_"+a.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",u=o.autoHideScrollbar?" "+f[6]:"",h="x"!==o.axis&&"rtl"===a.langDir?" "+f[7]:"";o.setWidth&&t.css("width",o.setWidth),o.setHeight&&t.css("height",o.setHeight),o.setLeft="y"!==o.axis&&"rtl"===a.langDir?"989999px":o.setLeft,t.addClass(n+" _"+i+"_"+a.idx+u+h).wrapInner("<div id='mCSB_"+a.idx+"' class='mCustomScrollBox mCS-"+o.theme+" "+s+"'><div id='mCSB_"+a.idx+"_container' class='mCSB_container' style='position:relative; top:"+o.setTop+"; left:"+o.setLeft+";' dir="+a.langDir+" /></div>");var m=e("#mCSB_"+a.idx),p=e("#mCSB_"+a.idx+"_container");"y"===o.axis||o.advanced.autoExpandHorizontalScroll||p.css("width",S(p.children())),"outside"===o.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(d)),b.call(this);var g=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},S=function(t){return Math.max.apply(Math,t.map(function(){return e(this).outerWidth(!0)}).get())},w=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx+"_container");o.advanced.autoExpandHorizontalScroll&&"y"!==o.axis&&n.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(n[0].getBoundingClientRect().right+.4)-Math.floor(n[0].getBoundingClientRect().left),position:"relative"}).unwrap()},b=function(){var t=e(this),a=t.data(i),o=a.opt,n=e(".mCSB_"+a.idx+"_scrollbar:first"),r=at(o.scrollButtons.tabindex)?"tabindex='"+o.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+f[13]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[14]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[15]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+f[16]+"' oncontextmenu='return false;' "+r+" />"],s=["x"===o.axis?l[2]:l[0],"x"===o.axis?l[3]:l[1],l[2],l[3]];o.scrollButtons.enable&&n.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},C=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=t.css("max-height")||"none",r=-1!==n.indexOf("%"),l=t.css("box-sizing");if("none"!==n){var s=r?t.parent().height()*parseInt(n)/100:parseInt(n);"border-box"===l&&(s-=t.innerHeight()-t.height()+(t.outerHeight()-t.innerHeight())),o.css("max-height",Math.round(s))}},y=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],l=[o.height()/n.outerHeight(!1),o.width()/n.outerWidth(!1)],s=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],c=d&&s[1]<s[0]?s[0]:s[1],u=d&&s[3]<s[2]?s[2]:s[3];r[0].css({height:c,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":s[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},B=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],l=[n.outerHeight(!1)-o.height(),n.outerWidth(!1)-o.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];a.scrollRatio={y:s[0],x:s[1]}},T=function(e,t,a){var o=a?f[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(f[0]+" "+o),n.toggleClass(f[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(f[0]),n.removeClass(f[1])):(e.addClass(f[0]),n.addClass(f[1])))},k=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=null==a.overflowed?n.height():n.outerHeight(!1),l=null==a.overflowed?n.width():n.outerWidth(!1);return[r>o.height(),l>o.width()]},M=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx),r=e("#mCSB_"+a.idx+"_container"),l=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")];if(Q(t),("x"!==o.axis&&!a.overflowed[0]||"y"===o.axis&&a.overflowed[0])&&(l[0].add(r).css("top",0),G(t,"_resetY")),"y"!==o.axis&&!a.overflowed[1]||"x"===o.axis&&a.overflowed[1]){var s=dx=0;"rtl"===a.langDir&&(s=n.width()-r.outerWidth(!1),dx=Math.abs(s/a.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),G(t,"_resetX")}},O=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),A.call(a[0])):t()},100)}var a=e(this),o=a.data(i),n=o.opt;if(!o.bindEvents){if(D.call(this),n.contentTouchScroll&&L.call(this),W.call(this),n.mouseWheel.enable){var r;t()}z.call(this),U.call(this),n.advanced.autoScrollOnFocus&&H.call(this),n.scrollButtons.enable&&F.call(this),n.keyboard.enable&&q.call(this),o.bindEvents=!0}},I=function(){var t=e(this),o=t.data(i),n=o.opt,r=i+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+l+" ."+f[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+l+">a"),c=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&s.add(e(n.advanced.releaseDraggableSelectors)),o.bindEvents&&(e(a).unbind("."+r),s.each(function(){e(this).unbind("."+r)}),clearTimeout(t[0]._focusTimeout),$(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),$(o.sequential,"step"),clearTimeout(c[0].onCompleteTimeout),$(c[0],"onCompleteTimeout"),o.bindEvents=!1)},R=function(t){var a=e(this),o=a.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+o.idx+"_container"),s=[e("#mCSB_"+o.idx+"_scrollbar_vertical"),e("#mCSB_"+o.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==n.axis&&(o.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(f[8]+" "+f[10])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(f[10])):(s[0].css("display","none"),l.addClass(f[10])),l.addClass(f[8]))),"y"!==n.axis&&(o.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(f[9]+" "+f[11])):(n.alwaysShowScrollbar?(2!==n.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(f[11])):(s[1].css("display","none"),l.addClass(f[11])),l.addClass(f[9]))),o.overflowed[0]||o.overflowed[1]?a.removeClass(f[5]):a.addClass(f[5])},E=function(e){var t=e.type;switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var a=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],o=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return[a.pageY,a.pageX,o>1];default:return[e.pageY,e.pageX,!1]}},D=function(){function t(e){var t=p.find("iframe");if(t.length){var a=e?"auto":"none";t.css("pointer-events",a)}}function o(e,t,a,o){if(p[0].idleTimer=f.scrollInertia<233?250:0,n.attr("id")===m[1])var i="x",r=(n[0].offsetLeft-t+o)*c.scrollRatio.x;else var i="y",r=(n[0].offsetTop-e+a)*c.scrollRatio.y;G(s,r.toString(),{dir:i,drag:!0})}var n,r,l,s=e(this),c=s.data(i),f=c.opt,h=i+"_"+c.idx,m=["mCSB_"+c.idx+"_dragger_vertical","mCSB_"+c.idx+"_dragger_horizontal"],p=e("#mCSB_"+c.idx+"_container"),g=e("#"+m[0]+",#"+m[1]),v=f.advanced.releaseDraggableSelectors?g.add(e(f.advanced.releaseDraggableSelectors)):g;g.bind("mousedown."+h+" touchstart."+h+" pointerdown."+h+" MSPointerDown."+h,function(o){if(o.stopImmediatePropagation(),o.preventDefault(),et(o)){u=!0,d&&(a.onselectstart=function(){return!1}),t(!1),Q(s),n=e(this);var i=n.offset(),c=E(o)[0]-i.top,h=E(o)[1]-i.left,m=n.height()+i.top,p=n.width()+i.left;m>c&&c>0&&p>h&&h>0&&(r=c,l=h),T(n,"active",f.autoExpandScrollbar)}}).bind("touchmove."+h,function(e){e.stopImmediatePropagation(),e.preventDefault();var t=n.offset(),a=E(e)[0]-t.top,i=E(e)[1]-t.left;o(r,l,a,i)}),e(a).bind("mousemove."+h+" pointermove."+h+" MSPointerMove."+h,function(e){if(n){var t=n.offset(),a=E(e)[0]-t.top,i=E(e)[1]-t.left;if(r===a)return;o(r,l,a,i)}}).add(v).bind("mouseup."+h+" touchend."+h+" pointerup."+h+" MSPointerUp."+h,function(){n&&(T(n,"active",f.autoExpandScrollbar),n=null),u=!1,d&&(a.onselectstart=null),t(!0)})},L=function(){function t(e,t){var a=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?a[0]:a[3]:e>60?t>3?a[3]:a[2]:e>30?t>8?a[1]:t>6?a[0]:t>4?t:a[2]:t>8?t:a[3]}function a(e,t,a,o,n,i){e&&G(_,e.toString(),{dur:t,scrollEasing:a,dir:o,overwrite:n,drag:i})}var n,r,l,s,c,d,f,h,m,p,g,v,x,_=e(this),S=_.data(i),w=S.opt,b=i+"_"+S.idx,C=e("#mCSB_"+S.idx),y=e("#mCSB_"+S.idx+"_container"),B=[e("#mCSB_"+S.idx+"_dragger_vertical"),e("#mCSB_"+S.idx+"_dragger_horizontal")],T=[],k=[],M=0,O="yx"===w.axis?"none":"all",I=[];y.bind("touchstart."+b+" pointerdown."+b+" MSPointerDown."+b,function(e){if(!tt(e)||u||E(e)[2])return void(o=0);o=1,v=0,x=0;var t=y.offset();n=E(e)[0]-t.top,r=E(e)[1]-t.left,I=[E(e)[0],E(e)[1]]}).bind("touchmove."+b+" pointermove."+b+" MSPointerMove."+b,function(e){if(tt(e)&&!u&&!E(e)[2]&&(e.stopImmediatePropagation(),!x||v)){d=K();var t=C.offset(),o=E(e)[0]-t.top,i=E(e)[1]-t.left,l="mcsLinearOut";if(T.push(o),k.push(i),I[2]=Math.abs(E(e)[0]-I[0]),I[3]=Math.abs(E(e)[1]-I[1]),S.overflowed[0])var s=B[0].parent().height()-B[0].height(),c=n-o>0&&o-n>-(s*S.scrollRatio.y)&&(2*I[3]<I[2]||"yx"===w.axis);if(S.overflowed[1])var f=B[1].parent().width()-B[1].width(),h=r-i>0&&i-r>-(f*S.scrollRatio.x)&&(2*I[2]<I[3]||"yx"===w.axis);c||h?(e.preventDefault(),v=1):x=1,p="yx"===w.axis?[n-o,r-i]:"x"===w.axis?[null,r-i]:[n-o,null],y[0].idleTimer=250,S.overflowed[0]&&a(p[0],M,l,"y","all",!0),S.overflowed[1]&&a(p[1],M,l,"x",O,!0)}}),C.bind("touchstart."+b+" pointerdown."+b+" MSPointerDown."+b,function(e){if(!tt(e)||u||E(e)[2])return void(o=0);o=1,e.stopImmediatePropagation(),Q(_),c=K();var t=C.offset();l=E(e)[0]-t.top,s=E(e)[1]-t.left,T=[],k=[]}).bind("touchend."+b+" pointerup."+b+" MSPointerUp."+b,function(e){if(tt(e)&&!u&&!E(e)[2]){e.stopImmediatePropagation(),v=0,x=0,f=K();var o=C.offset(),n=E(e)[0]-o.top,i=E(e)[1]-o.left;if(!(f-d>30)){m=1e3/(f-c);var r="mcsEaseOut",_=2.5>m,b=_?[T[T.length-2],k[k.length-2]]:[0,0];h=_?[n-b[0],i-b[1]]:[n-l,i-s];var B=[Math.abs(h[0]),Math.abs(h[1])];m=_?[Math.abs(h[0]/4),Math.abs(h[1]/4)]:[m,m];var M=[Math.abs(y[0].offsetTop)-h[0]*t(B[0]/m[0],m[0]),Math.abs(y[0].offsetLeft)-h[1]*t(B[1]/m[1],m[1])];p="yx"===w.axis?[M[0],M[1]]:"x"===w.axis?[null,M[1]]:[M[0],null],g=[4*B[0]+w.scrollInertia,4*B[1]+w.scrollInertia];var I=parseInt(w.contentTouchScroll)||0;p[0]=B[0]>I?p[0]:0,p[1]=B[1]>I?p[1]:0,S.overflowed[0]&&a(p[0],g[0],r,"y",O,!1),S.overflowed[1]&&a(p[1],g[1],r,"x",O,!1)}}})},W=function(){function n(){return t.getSelection?t.getSelection().toString():a.selection&&"Control"!=a.selection.type?a.selection.createRange().text:0}function r(e,t,a){f.type=a&&l?"stepped":"stepless",f.scrollAmount=10,j(s,e,t,"mcsLinearOut",a?60:null)}var l,s=e(this),c=s.data(i),d=c.opt,f=c.sequential,h=i+"_"+c.idx,m=e("#mCSB_"+c.idx+"_container"),p=m.parent();m.bind("mousedown."+h,function(){o||l||(l=1,u=!0)}).add(a).bind("mousemove."+h,function(e){if(!o&&l&&n()){var t=m.offset(),a=E(e)[0]-t.top+m[0].offsetTop,i=E(e)[1]-t.left+m[0].offsetLeft;a>0&&a<p.height()&&i>0&&i<p.width()?f.step&&r("off",null,"stepped"):("x"!==d.axis&&c.overflowed[0]&&(0>a?r("on",38):a>p.height()&&r("on",40)),"y"!==d.axis&&c.overflowed[1]&&(0>i?r("on",37):i>p.width()&&r("on",39)))}}).bind("mouseup."+h,function(){o||(l&&(l=0,r("off",null)),u=!1)})},A=function(){function t(e){var t=null;try{var a=e.contentDocument||e.contentWindow.document;t=a.body.innerHTML}catch(o){}return null!==t}var a=e(this),o=a.data(i);if(o){var n=o.opt,r=i+"_"+o.idx,l=e("#mCSB_"+o.idx),s=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],c=e("#mCSB_"+o.idx+"_container").find("iframe"),u=l;c.length&&c.each(function(){var a=this;t(a)&&(u=u.add(e(a).contents().find("body")))}),u.bind("mousewheel."+r,function(t,i){if(Q(a),!P(a,t.target)){var r="auto"!==n.mouseWheel.deltaFactor?parseInt(n.mouseWheel.deltaFactor):d&&t.deltaFactor<100?100:t.deltaFactor||100;if("x"===n.axis||"x"===n.mouseWheel.axis)var c="x",u=[Math.round(r*o.scrollRatio.x),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.width()?.9*l.width():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetLeft),m=s[1][0].offsetLeft,p=s[1].parent().width()-s[1].width(),g=t.deltaX||t.deltaY||i;else var c="y",u=[Math.round(r*o.scrollRatio.y),parseInt(n.mouseWheel.scrollAmount)],f="auto"!==n.mouseWheel.scrollAmount?u[1]:u[0]>=l.height()?.9*l.height():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetTop),m=s[0][0].offsetTop,p=s[0].parent().height()-s[0].height(),g=t.deltaY||i;"y"===c&&!o.overflowed[0]||"x"===c&&!o.overflowed[1]||(n.mouseWheel.invert&&(g=-g),n.mouseWheel.normalizeDelta&&(g=0>g?-1:1),(g>0&&0!==m||0>g&&m!==p||n.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),G(a,(h-g*f).toString(),{dir:c}))}})}},P=function(t,a){var o=a.nodeName.toLowerCase(),n=t.data(i).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(o,n)>-1&&!(e.inArray(o,r)>-1&&!e(a).is(":focus"))},z=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container"),r=n.parent(),l=e(".mCSB_"+a.idx+"_scrollbar ."+f[12]);l.bind("touchstart."+o+" pointerdown."+o+" MSPointerDown."+o,function(){u=!0}).bind("touchend."+o+" pointerup."+o+" MSPointerUp."+o,function(){u=!1}).bind("click."+o,function(o){if(e(o.target).hasClass(f[12])||e(o.target).hasClass("mCSB_draggerRail")){Q(t);var i=e(this),l=i.find(".mCSB_dragger");if(i.parent(".mCSB_scrollTools_horizontal").length>0){if(!a.overflowed[1])return;var s="x",c=o.pageX>l.offset().left?-1:1,d=Math.abs(n[0].offsetLeft)-.9*c*r.width()}else{if(!a.overflowed[0])return;var s="y",c=o.pageY>l.offset().top?-1:1,d=Math.abs(n[0].offsetTop)-.9*c*r.height()}G(t,d.toString(),{dir:s,scrollEasing:"mcsEaseInOut"})}})},H=function(){var t=e(this),o=t.data(i),n=o.opt,r=i+"_"+o.idx,l=e("#mCSB_"+o.idx+"_container"),s=l.parent();l.bind("focusin."+r,function(){var o=e(a.activeElement),i=l.find(".mCustomScrollBox").length,r=0;o.is(n.advanced.autoScrollOnFocus)&&(Q(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=i?(r+17)*i:0,t[0]._focusTimeout=setTimeout(function(){var e=[ot(o)[0],ot(o)[1]],a=[l[0].offsetTop,l[0].offsetLeft],i=[a[0]+e[0]>=0&&a[0]+e[0]<s.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<s.width()-o.outerWidth(!1)],c="yx"!==n.axis||i[0]||i[1]?"all":"none";"x"===n.axis||i[0]||G(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:r}),"y"===n.axis||i[1]||G(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:r})},t[0]._focusTimer))})},U=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container").parent();n.bind("scroll."+o,function(){(0!==n.scrollTop()||0!==n.scrollLeft())&&e(".mCSB_"+a.idx+"_scrollbar").css("visibility","hidden")})},F=function(){var t=e(this),a=t.data(i),o=a.opt,n=a.sequential,r=i+"_"+a.idx,l=".mCSB_"+a.idx+"_scrollbar",s=e(l+">a");s.bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(i){function r(e,a){n.scrollAmount=o.snapAmount||o.scrollButtons.scrollAmount,j(t,e,a)}if(i.preventDefault(),et(i)){var l=e(this).attr("class");switch(n.type=o.scrollButtons.scrollType,i.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===n.type)return;u=!0,a.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===n.type)return;u=!1,n.dir&&r("off",l);break;case"click":if("stepped"!==n.type||a.tweenRunning)return;r("on",l)}}})},q=function(){var t=e(this),o=t.data(i),n=o.opt,r=o.sequential,l=i+"_"+o.idx,s=e("#mCSB_"+o.idx),c=e("#mCSB_"+o.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']";s.attr("tabindex","0").bind("blur."+l+" keydown."+l+" keyup."+l,function(i){function l(e,a){r.type=n.keyboard.scrollType,r.scrollAmount=n.snapAmount||n.keyboard.scrollAmount,"stepped"===r.type&&o.tweenRunning||j(t,e,a)}switch(i.type){case"blur":o.tweenRunning&&r.dir&&l("off",null);break;case"keydown":case"keyup":var s=i.keyCode?i.keyCode:i.which,f="on";if("x"!==n.axis&&(38===s||40===s)||"y"!==n.axis&&(37===s||39===s)){if((38===s||40===s)&&!o.overflowed[0]||(37===s||39===s)&&!o.overflowed[1])return;"keyup"===i.type&&(f="off"),e(a.activeElement).is(u)||(i.preventDefault(),i.stopImmediatePropagation(),l(f,s))}else if(33===s||34===s){if((o.overflowed[0]||o.overflowed[1])&&(i.preventDefault(),i.stopImmediatePropagation()),"keyup"===i.type){Q(t);var h=34===s?-1:1;if("x"===n.axis||"yx"===n.axis&&o.overflowed[1]&&!o.overflowed[0])var m="x",p=Math.abs(c[0].offsetLeft)-.9*h*d.width();else var m="y",p=Math.abs(c[0].offsetTop)-.9*h*d.height();G(t,p.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}else if((35===s||36===s)&&!e(a.activeElement).is(u)&&((o.overflowed[0]||o.overflowed[1])&&(i.preventDefault(),i.stopImmediatePropagation()),"keyup"===i.type)){if("x"===n.axis||"yx"===n.axis&&o.overflowed[1]&&!o.overflowed[0])var m="x",p=35===s?Math.abs(d.width()-c.outerWidth(!1)):0;else var m="y",p=35===s?Math.abs(d.height()-c.outerHeight(!1)):0;G(t,p.toString(),{dir:m,scrollEasing:"mcsEaseInOut"})}}})},j=function(t,a,o,n,r){function l(e){var a="stepped"!==u.type,o=r?r:e?a?p/1.5:g:1e3/60,i=e?a?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],f="x"===u.dir[0]?s[1]+u.dir[1]*d[1]*i:s[0]+u.dir[1]*d[0]*i,m="x"===u.dir[0]?s[1]+u.dir[1]*parseInt(u.scrollAmount):s[0]+u.dir[1]*parseInt(u.scrollAmount),v="auto"!==u.scrollAmount?m:f,x=n?n:e?a?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",_=e?!0:!1;return e&&17>o&&(v="x"===u.dir[0]?s[1]:s[0]),G(t,v.toString(),{dir:u.dir[0],scrollEasing:x,dur:o,onComplete:_}),e?void(u.dir=!1):(clearTimeout(u.step),void(u.step=setTimeout(function(){l()},o)))}function s(){clearTimeout(u.step),$(u,"step"),Q(t)}var c=t.data(i),d=c.opt,u=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===u.type?!0:!1,p=d.scrollInertia<26?26:d.scrollInertia,g=d.scrollInertia<1?17:d.scrollInertia;switch(a){case"on":if(u.dir=[o===f[16]||o===f[15]||39===o||37===o?"x":"y",o===f[13]||o===f[15]||38===o||37===o?-1:1],Q(t),at(o)&&"stepped"===u.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&u.dir)&&l(!0)}},Y=function(t){var a=e(this).data(i).opt,o=[];return"function"==typeof t&&(t=t()),t instanceof Array?o=t.length>1?[t[0],t[1]]:"x"===a.axis?[null,t[0]]:[t[0],null]:(o[0]=t.y?t.y:t.x||"x"===a.axis?null:t,o[1]=t.x?t.x:t.y||"y"===a.axis?null:t),"function"==typeof o[0]&&(o[0]=o[0]()),"function"==typeof o[1]&&(o[1]=o[1]()),o},X=function(t,a){if(null!=t&&"undefined"!=typeof t){var o=e(this),n=o.data(i),r=n.opt,l=e("#mCSB_"+n.idx+"_container"),s=l.parent(),c=typeof t;a||(a="x"===r.axis?"x":"y");var d="x"===a?l.outerWidth(!1):l.outerHeight(!1),u="x"===a?l[0].offsetLeft:l[0].offsetTop,f="x"===a?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===a?ot(m)[1]:ot(m)[0];case"string":case"number":if(at(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(u-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=u+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&at(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===a?ot(m)[1]:ot(m)[0]}return e(t).length?"x"===a?ot(e(t))[1]:ot(e(t))[0]:(l.css(f,t),void h.update.call(null,o[0]))}}},N=function(t){function a(){clearTimeout(u[0].autoUpdate),u[0].autoUpdate=setTimeout(function(){return d.advanced.updateOnSelectorChange&&(m=r(),m!==S)?(l(3),void(S=m)):(d.advanced.updateOnContentResize&&(p=[u.outerHeight(!1),u.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],(p[0]!==w[0]||p[1]!==w[1]||p[2]!==w[2]||p[3]!==w[3]||p[4]!==w[4]||p[5]!==w[5])&&(l(p[0]!==w[0]||p[1]!==w[1]),w=p)),d.advanced.updateOnImageLoad&&(g=o(),g!==b&&(u.find("img").each(function(){n(this)}),b=g)),void((d.advanced.updateOnSelectorChange||d.advanced.updateOnContentResize||d.advanced.updateOnImageLoad)&&a()))},60)}function o(){var e=0;return d.advanced.updateOnImageLoad&&(e=u.find("img").length),e}function n(t){function a(e,t){return function(){return t.apply(e,arguments)}}function o(){this.onload=null,e(t).addClass(f[2]),l(2)}if(e(t).hasClass(f[2]))return void l();var n=new Image;n.onload=a(n,o),n.src=t.src}function r(){d.advanced.updateOnSelectorChange===!0&&(d.advanced.updateOnSelectorChange="*");var t=0,a=u.find(d.advanced.updateOnSelectorChange);return d.advanced.updateOnSelectorChange&&a.length>0&&a.each(function(){t+=e(this).height()+e(this).width()}),t}function l(e){clearTimeout(u[0].autoUpdate),h.update.call(null,s[0],e)}var s=e(this),c=s.data(i),d=c.opt,u=e("#mCSB_"+c.idx+"_container");if(t)return clearTimeout(u[0].autoUpdate),void $(u[0],"autoUpdate");var m,p,g,v=u.parent(),x=[e("#mCSB_"+c.idx+"_scrollbar_vertical"),e("#mCSB_"+c.idx+"_scrollbar_horizontal")],_=function(){return[x[0].is(":visible")?x[0].outerHeight(!0):0,x[1].is(":visible")?x[1].outerWidth(!0):0]},S=r(),w=[u.outerHeight(!1),u.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],b=o();a()},V=function(e,t,a){return Math.round(e/t)*t-a},Q=function(t){var a=t.data(i),o=e("#mCSB_"+a.idx+"_container,#mCSB_"+a.idx+"_container_wrapper,#mCSB_"+a.idx+"_dragger_vertical,#mCSB_"+a.idx+"_dragger_horizontal");o.each(function(){Z.call(this)})},G=function(t,a,o){function n(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||_>=S[0]+b,c.callbacks.alwaysTriggerOffsets||-C>=_]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],a=[v[0].offsetTop,v[0].offsetLeft],n=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:a[0],draggerLeft:a[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(n[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(n[1])-i[1])),direction:o.dir}}var s=t.data(i),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},o=e.extend(d,o),u=[o.dur,o.drag?0:o.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=o.trigger,(0!==m.scrollTop()||0!==m.scrollLeft())&&(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==a||s.contentReset.y||(n("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==a||s.contentReset.x||(n("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==a&&"_resetX"!==a){switch(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(n("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(n("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount&&(a=V(a,c.snapAmount,c.snapOffset)),o.dir){case"x":var v=e("#mCSB_"+s.idx+"_dragger_horizontal"),x="left",_=h[0].offsetLeft,S=[f.width()-h.outerWidth(!1),v.parent().width()-v.width()],w=[a,0===a?0:a/s.scrollRatio.x],b=p[1],C=g[1],y=b>0?b/s.scrollRatio.x:0,B=C>0?C/s.scrollRatio.x:0;
break;case"y":var v=e("#mCSB_"+s.idx+"_dragger_vertical"),x="top",_=h[0].offsetTop,S=[f.height()-h.outerHeight(!1),v.parent().height()-v.height()],w=[a,0===a?0:a/s.scrollRatio.y],b=p[0],C=g[0],y=b>0?b/s.scrollRatio.y:0,B=C>0?C/s.scrollRatio.y:0}w[1]<0||0===w[0]&&0===w[1]?w=[0,0]:w[1]>=S[1]?w=[S[0],S[1]]:w[0]=-w[0],t[0].mcs||(l(),n("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),(s.tweenRunning||!(0===_&&w[0]>=0||_===S[0]&&w[0]<=S[0]))&&(J(v[0],x,Math.round(w[1]),u[1],o.scrollEasing),J(h[0],x,Math.round(w[0]),u[0],o.scrollEasing,o.overwrite,{onStart:function(){o.callbacks&&o.onStart&&!s.tweenRunning&&(n("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,T(v),s.cbOffsets=r())},onUpdate:function(){o.callbacks&&o.onUpdate&&n("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(o.callbacks&&o.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){n("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),n("onTotalScroll")&&w[1]>=S[1]-y&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),n("onTotalScrollBack")&&w[1]<=B&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,T(v,"hide")},e)}}}))}},J=function(e,a,o,n,i,r,l){function s(){b.stop||(_||p.call(),_=K()-x,c(),_>=b.time&&(b.time=_>b.time?_+h-(_-b.time):_+h-1,b.time<_+1&&(b.time=_+1)),b.time<n?b.id=m(s):v.call())}function c(){n>0?(b.currVal=f(b.time,S,C,n,i),w[a]=Math.round(b.currVal)+"px"):w[a]=o+"px",g.call()}function d(){h=1e3/60,b.time=_+h,m=t.requestAnimationFrame?t.requestAnimationFrame:function(e){return c(),setTimeout(e,.01)},b.id=m(s)}function u(){null!=b.id&&(t.requestAnimationFrame?t.cancelAnimationFrame(b.id):clearTimeout(b.id),b.id=null)}function f(e,t,a,o,n){switch(n){case"linear":case"mcsLinear":return a*e/o+t;case"mcsLinearOut":return e/=o,e--,a*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=o/2,1>e?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=o/2,1>e?a/2*Math.pow(2,10*(e-1))+t:(e--,a/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=o/2,1>e?a/2*e*e*e+t:(e-=2,a/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=o,e--,-a*(e*e*e*e-1)+t;case"easeOutStrong":return a*(-Math.pow(2,-10*e/o)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=o)*e,r=i*e;return t+a*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var h,m,l=l||{},p=l.onStart||function(){},g=l.onUpdate||function(){},v=l.onComplete||function(){},x=K(),_=0,S=e.offsetTop,w=e.style,b=e._mTween[a];"left"===a&&(S=e.offsetLeft);var C=o-S;b.stop=0,"none"!==r&&u(),d()},K=function(){return t.performance&&t.performance.now?t.performance.now():t.performance&&t.performance.webkitNow?t.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},Z=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var a=["top","left"],o=0;o<a.length;o++){var n=a[o];e._mTween[n].id&&(t.requestAnimationFrame?t.cancelAnimationFrame(e._mTween[n].id):clearTimeout(e._mTween[n].id),e._mTween[n].id=null,e._mTween[n].stop=1)}},$=function(e,t){try{delete e[t]}catch(a){e[t]=null}},et=function(e){return!(e.which&&1!==e.which)},tt=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},at=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ot=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]};e.fn[n]=function(t){return h[t]?h[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):h.init.apply(this,arguments)},e[n]=function(t){return h[t]?h[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):h.init.apply(this,arguments)},e[n].defaults=l,t[n]=!0,e(t).load(function(){e(r)[n](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var a,o,n=e(t),i=n.parents(".mCSB_container");if(i.length)return a=i.parent(),o=[i[0].offsetTop,i[0].offsetLeft],o[0]+ot(n)[0]>=0&&o[0]+ot(n)[0]<a.height()-n.outerHeight(!1)&&o[1]+ot(n)[1]>=0&&o[1]+ot(n)[1]<a.width()-n.outerWidth(!1)},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var a=e(t).data(i);if(a)return a.overflowed[0]||a.overflowed[1]}})})})}(jQuery,window,document);
/*
 AngularJS v1.3.9
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(M,Y,t){'use strict';function T(b){return function(){var a=arguments[0],c;c="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.3.9/"+(b?b+"/":"")+a;for(a=1;a<arguments.length;a++){c=c+(1==a?"?":"&")+"p"+(a-1)+"=";var d=encodeURIComponent,e;e=arguments[a];e="function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof e?"undefined":"string"!=typeof e?JSON.stringify(e):e;c+=d(e)}return Error(c)}}function Ta(b){if(null==b||Ua(b))return!1;var a=b.length;return b.nodeType===
oa&&a?!0:F(b)||D(b)||0===a||"number"===typeof a&&0<a&&a-1 in b}function s(b,a,c){var d,e;if(b)if(G(b))for(d in b)"prototype"==d||"length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d)||a.call(c,b[d],d,b);else if(D(b)||Ta(b)){var f="object"!==typeof b;d=0;for(e=b.length;d<e;d++)(f||d in b)&&a.call(c,b[d],d,b)}else if(b.forEach&&b.forEach!==s)b.forEach(a,c,b);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d,b);return b}function Ed(b,a,c){for(var d=Object.keys(b).sort(),e=0;e<d.length;e++)a.call(c,
b[d[e]],d[e]);return d}function kc(b){return function(a,c){b(c,a)}}function Fd(){return++nb}function lc(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function z(b){for(var a=b.$$hashKey,c=1,d=arguments.length;c<d;c++){var e=arguments[c];if(e)for(var f=Object.keys(e),g=0,h=f.length;g<h;g++){var l=f[g];b[l]=e[l]}}lc(b,a);return b}function ba(b){return parseInt(b,10)}function H(){}function pa(b){return b}function da(b){return function(){return b}}function A(b){return"undefined"===typeof b}function y(b){return"undefined"!==
typeof b}function I(b){return null!==b&&"object"===typeof b}function F(b){return"string"===typeof b}function V(b){return"number"===typeof b}function qa(b){return"[object Date]"===Da.call(b)}function G(b){return"function"===typeof b}function ob(b){return"[object RegExp]"===Da.call(b)}function Ua(b){return b&&b.window===b}function Va(b){return b&&b.$evalAsync&&b.$watch}function Wa(b){return"boolean"===typeof b}function mc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Gd(b){var a={};
b=b.split(",");var c;for(c=0;c<b.length;c++)a[b[c]]=!0;return a}function ua(b){return Q(b.nodeName||b[0]&&b[0].nodeName)}function Xa(b,a){var c=b.indexOf(a);0<=c&&b.splice(c,1);return a}function Ea(b,a,c,d){if(Ua(b)||Va(b))throw Ka("cpws");if(a){if(b===a)throw Ka("cpi");c=c||[];d=d||[];if(I(b)){var e=c.indexOf(b);if(-1!==e)return d[e];c.push(b);d.push(a)}if(D(b))for(var f=a.length=0;f<b.length;f++)e=Ea(b[f],null,c,d),I(b[f])&&(c.push(b[f]),d.push(e)),a.push(e);else{var g=a.$$hashKey;D(a)?a.length=
0:s(a,function(b,c){delete a[c]});for(f in b)b.hasOwnProperty(f)&&(e=Ea(b[f],null,c,d),I(b[f])&&(c.push(b[f]),d.push(e)),a[f]=e);lc(a,g)}}else if(a=b)D(b)?a=Ea(b,[],c,d):qa(b)?a=new Date(b.getTime()):ob(b)?(a=new RegExp(b.source,b.toString().match(/[^\/]*$/)[0]),a.lastIndex=b.lastIndex):I(b)&&(e=Object.create(Object.getPrototypeOf(b)),a=Ea(b,e,c,d));return a}function ra(b,a){if(D(b)){a=a||[];for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}else if(I(b))for(c in a=a||{},b)if("$"!==c.charAt(0)||"$"!==c.charAt(1))a[c]=
b[c];return a||b}function fa(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&"object"==c)if(D(b)){if(!D(a))return!1;if((c=b.length)==a.length){for(d=0;d<c;d++)if(!fa(b[d],a[d]))return!1;return!0}}else{if(qa(b))return qa(a)?fa(b.getTime(),a.getTime()):!1;if(ob(b)&&ob(a))return b.toString()==a.toString();if(Va(b)||Va(a)||Ua(b)||Ua(a)||D(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!G(b[d])){if(!fa(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&
"$"!==d.charAt(0)&&a[d]!==t&&!G(a[d]))return!1;return!0}return!1}function Ya(b,a,c){return b.concat(Za.call(a,c))}function nc(b,a){var c=2<arguments.length?Za.call(arguments,2):[];return!G(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,Ya(c,arguments,0)):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}}function Hd(b,a){var c=a;"string"===typeof b&&"$"===b.charAt(0)&&"$"===b.charAt(1)?c=t:Ua(a)?c="$WINDOW":a&&Y===a?c="$DOCUMENT":Va(a)&&
(c="$SCOPE");return c}function $a(b,a){if("undefined"===typeof b)return t;V(a)||(a=a?2:null);return JSON.stringify(b,Hd,a)}function oc(b){return F(b)?JSON.parse(b):b}function va(b){b=B(b).clone();try{b.empty()}catch(a){}var c=B("<div>").append(b).html();try{return b[0].nodeType===pb?Q(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+Q(b)})}catch(d){return Q(c)}}function pc(b){try{return decodeURIComponent(b)}catch(a){}}function qc(b){var a={},c,d;s((b||"").split("&"),function(b){b&&
(c=b.replace(/\+/g,"%20").split("="),d=pc(c[0]),y(d)&&(b=y(c[1])?pc(c[1]):!0,rc.call(a,d)?D(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))});return a}function Nb(b){var a=[];s(b,function(b,d){D(b)?s(b,function(b){a.push(Fa(d,!0)+(!0===b?"":"="+Fa(b,!0)))}):a.push(Fa(d,!0)+(!0===b?"":"="+Fa(b,!0)))});return a.length?a.join("&"):""}function qb(b){return Fa(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Fa(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,
":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,a?"%20":"+")}function Id(b,a){var c,d,e=rb.length;b=B(b);for(d=0;d<e;++d)if(c=rb[d]+a,F(c=b.attr(c)))return c;return null}function Jd(b,a){var c,d,e={};s(rb,function(a){a+="app";!c&&b.hasAttribute&&b.hasAttribute(a)&&(c=b,d=b.getAttribute(a))});s(rb,function(a){a+="app";var e;!c&&(e=b.querySelector("["+a.replace(":","\\:")+"]"))&&(c=e,d=e.getAttribute(a))});c&&(e.strictDi=null!==Id(c,"strict-di"),a(c,d?[d]:[],e))}function sc(b,
a,c){I(c)||(c={});c=z({strictDi:!1},c);var d=function(){b=B(b);if(b.injector()){var d=b[0]===Y?"document":va(b);throw Ka("btstrpd",d.replace(/</,"&lt;").replace(/>/,"&gt;"));}a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);c.debugInfoEnabled&&a.push(["$compileProvider",function(a){a.debugInfoEnabled(!0)}]);a.unshift("ng");d=Ob(a,c.strictDi);d.invoke(["$rootScope","$rootElement","$compile","$injector",function(a,b,c,d){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return d},
e=/^NG_ENABLE_DEBUG_INFO!/,f=/^NG_DEFER_BOOTSTRAP!/;M&&e.test(M.name)&&(c.debugInfoEnabled=!0,M.name=M.name.replace(e,""));if(M&&!f.test(M.name))return d();M.name=M.name.replace(f,"");ga.resumeBootstrap=function(b){s(b,function(b){a.push(b)});d()}}function Kd(){M.name="NG_ENABLE_DEBUG_INFO!"+M.name;M.location.reload()}function Ld(b){b=ga.element(b).injector();if(!b)throw Ka("test");return b.get("$$testability")}function tc(b,a){a=a||"_";return b.replace(Md,function(b,d){return(d?a:"")+b.toLowerCase()})}
function Nd(){var b;uc||((sa=M.jQuery)&&sa.fn.on?(B=sa,z(sa.fn,{scope:La.scope,isolateScope:La.isolateScope,controller:La.controller,injector:La.injector,inheritedData:La.inheritedData}),b=sa.cleanData,sa.cleanData=function(a){var c;if(Pb)Pb=!1;else for(var d=0,e;null!=(e=a[d]);d++)(c=sa._data(e,"events"))&&c.$destroy&&sa(e).triggerHandler("$destroy");b(a)}):B=R,ga.element=B,uc=!0)}function Qb(b,a,c){if(!b)throw Ka("areq",a||"?",c||"required");return b}function sb(b,a,c){c&&D(b)&&(b=b[b.length-1]);
Qb(G(b),a,"not a function, got "+(b&&"object"===typeof b?b.constructor.name||"Object":typeof b));return b}function Ma(b,a){if("hasOwnProperty"===b)throw Ka("badname",a);}function vc(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,f=a.length,g=0;g<f;g++)d=a[g],b&&(b=(e=b)[d]);return!c&&G(b)?nc(e,b):b}function tb(b){var a=b[0];b=b[b.length-1];var c=[a];do{a=a.nextSibling;if(!a)break;c.push(a)}while(a!==b);return B(c)}function ha(){return Object.create(null)}function Od(b){function a(a,b,c){return a[b]||
(a[b]=c())}var c=T("$injector"),d=T("ng");b=a(b,"angular",Object);b.$$minErr=b.$$minErr||T;return a(b,"module",function(){var b={};return function(f,g,h){if("hasOwnProperty"===f)throw d("badname","module");g&&b.hasOwnProperty(f)&&(b[f]=null);return a(b,f,function(){function a(c,d,e,f){f||(f=b);return function(){f[e||"push"]([c,d,arguments]);return u}}if(!g)throw c("nomod",f);var b=[],d=[],e=[],q=a("$injector","invoke","push",d),u={_invokeQueue:b,_configBlocks:d,_runBlocks:e,requires:g,name:f,provider:a("$provide",
"provider"),factory:a("$provide","factory"),service:a("$provide","service"),value:a("$provide","value"),constant:a("$provide","constant","unshift"),animation:a("$animateProvider","register"),filter:a("$filterProvider","register"),controller:a("$controllerProvider","register"),directive:a("$compileProvider","directive"),config:q,run:function(a){e.push(a);return this}};h&&q(h);return u})}})}function Pd(b){z(b,{bootstrap:sc,copy:Ea,extend:z,equals:fa,element:B,forEach:s,injector:Ob,noop:H,bind:nc,toJson:$a,
fromJson:oc,identity:pa,isUndefined:A,isDefined:y,isString:F,isFunction:G,isObject:I,isNumber:V,isElement:mc,isArray:D,version:Qd,isDate:qa,lowercase:Q,uppercase:ub,callbacks:{counter:0},getTestability:Ld,$$minErr:T,$$csp:ab,reloadWithDebugInfo:Kd});bb=Od(M);try{bb("ngLocale")}catch(a){bb("ngLocale",[]).provider("$locale",Rd)}bb("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:Sd});a.provider("$compile",wc).directive({a:Td,input:xc,textarea:xc,form:Ud,script:Vd,select:Wd,style:Xd,
option:Yd,ngBind:Zd,ngBindHtml:$d,ngBindTemplate:ae,ngClass:be,ngClassEven:ce,ngClassOdd:de,ngCloak:ee,ngController:fe,ngForm:ge,ngHide:he,ngIf:ie,ngInclude:je,ngInit:ke,ngNonBindable:le,ngPluralize:me,ngRepeat:ne,ngShow:oe,ngStyle:pe,ngSwitch:qe,ngSwitchWhen:re,ngSwitchDefault:se,ngOptions:te,ngTransclude:ue,ngModel:ve,ngList:we,ngChange:xe,pattern:yc,ngPattern:yc,required:zc,ngRequired:zc,minlength:Ac,ngMinlength:Ac,maxlength:Bc,ngMaxlength:Bc,ngValue:ye,ngModelOptions:ze}).directive({ngInclude:Ae}).directive(vb).directive(Cc);
a.provider({$anchorScroll:Be,$animate:Ce,$browser:De,$cacheFactory:Ee,$controller:Fe,$document:Ge,$exceptionHandler:He,$filter:Dc,$interpolate:Ie,$interval:Je,$http:Ke,$httpBackend:Le,$location:Me,$log:Ne,$parse:Oe,$rootScope:Pe,$q:Qe,$$q:Re,$sce:Se,$sceDelegate:Te,$sniffer:Ue,$templateCache:Ve,$templateRequest:We,$$testability:Xe,$timeout:Ye,$window:Ze,$$rAF:$e,$$asyncCallback:af,$$jqLite:bf})}])}function cb(b){return b.replace(cf,function(a,b,d,e){return e?d.toUpperCase():d}).replace(df,"Moz$1")}
function Ec(b){b=b.nodeType;return b===oa||!b||9===b}function Fc(b,a){var c,d,e=a.createDocumentFragment(),f=[];if(Rb.test(b)){c=c||e.appendChild(a.createElement("div"));d=(ef.exec(b)||["",""])[1].toLowerCase();d=ia[d]||ia._default;c.innerHTML=d[1]+b.replace(ff,"<$1></$2>")+d[2];for(d=d[0];d--;)c=c.lastChild;f=Ya(f,c.childNodes);c=e.firstChild;c.textContent=""}else f.push(a.createTextNode(b));e.textContent="";e.innerHTML="";s(f,function(a){e.appendChild(a)});return e}function R(b){if(b instanceof
R)return b;var a;F(b)&&(b=U(b),a=!0);if(!(this instanceof R)){if(a&&"<"!=b.charAt(0))throw Sb("nosel");return new R(b)}if(a){a=Y;var c;b=(c=gf.exec(b))?[a.createElement(c[1])]:(c=Fc(b,a))?c.childNodes:[]}Gc(this,b)}function Tb(b){return b.cloneNode(!0)}function wb(b,a){a||xb(b);if(b.querySelectorAll)for(var c=b.querySelectorAll("*"),d=0,e=c.length;d<e;d++)xb(c[d])}function Hc(b,a,c,d){if(y(d))throw Sb("offargs");var e=(d=yb(b))&&d.events,f=d&&d.handle;if(f)if(a)s(a.split(" "),function(a){if(y(c)){var d=
e[a];Xa(d||[],c);if(d&&0<d.length)return}b.removeEventListener(a,f,!1);delete e[a]});else for(a in e)"$destroy"!==a&&b.removeEventListener(a,f,!1),delete e[a]}function xb(b,a){var c=b.ng339,d=c&&zb[c];d&&(a?delete d.data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),Hc(b)),delete zb[c],b.ng339=t))}function yb(b,a){var c=b.ng339,c=c&&zb[c];a&&!c&&(b.ng339=c=++hf,c=zb[c]={events:{},data:{},handle:t});return c}function Ub(b,a,c){if(Ec(b)){var d=y(c),e=!d&&a&&!I(a),f=!a;b=(b=yb(b,!e))&&b.data;
if(d)b[a]=c;else{if(f)return b;if(e)return b&&b[a];z(b,a)}}}function Ab(b,a){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" "):!1}function Bb(b,a){a&&b.setAttribute&&s(a.split(" "),function(a){b.setAttribute("class",U((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+U(a)+" "," ")))})}function Cb(b,a){if(a&&b.setAttribute){var c=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");s(a.split(" "),function(a){a=
U(a);-1===c.indexOf(" "+a+" ")&&(c+=a+" ")});b.setAttribute("class",U(c))}}function Gc(b,a){if(a)if(a.nodeType)b[b.length++]=a;else{var c=a.length;if("number"===typeof c&&a.window!==a){if(c)for(var d=0;d<c;d++)b[b.length++]=a[d]}else b[b.length++]=a}}function Ic(b,a){return Db(b,"$"+(a||"ngController")+"Controller")}function Db(b,a,c){9==b.nodeType&&(b=b.documentElement);for(a=D(a)?a:[a];b;){for(var d=0,e=a.length;d<e;d++)if((c=B.data(b,a[d]))!==t)return c;b=b.parentNode||11===b.nodeType&&b.host}}
function Jc(b){for(wb(b,!0);b.firstChild;)b.removeChild(b.firstChild)}function Kc(b,a){a||wb(b);var c=b.parentNode;c&&c.removeChild(b)}function jf(b,a){a=a||M;if("complete"===a.document.readyState)a.setTimeout(b);else B(a).on("load",b)}function Lc(b,a){var c=Eb[a.toLowerCase()];return c&&Mc[ua(b)]&&c}function kf(b,a){var c=b.nodeName;return("INPUT"===c||"TEXTAREA"===c)&&Nc[a]}function lf(b,a){var c=function(c,e){c.isDefaultPrevented=function(){return c.defaultPrevented};var f=a[e||c.type],g=f?f.length:
0;if(g){if(A(c.immediatePropagationStopped)){var h=c.stopImmediatePropagation;c.stopImmediatePropagation=function(){c.immediatePropagationStopped=!0;c.stopPropagation&&c.stopPropagation();h&&h.call(c)}}c.isImmediatePropagationStopped=function(){return!0===c.immediatePropagationStopped};1<g&&(f=ra(f));for(var l=0;l<g;l++)c.isImmediatePropagationStopped()||f[l].call(b,c)}};c.elem=b;return c}function bf(){this.$get=function(){return z(R,{hasClass:function(b,a){b.attr&&(b=b[0]);return Ab(b,a)},addClass:function(b,
a){b.attr&&(b=b[0]);return Cb(b,a)},removeClass:function(b,a){b.attr&&(b=b[0]);return Bb(b,a)}})}}function Na(b,a){var c=b&&b.$$hashKey;if(c)return"function"===typeof c&&(c=b.$$hashKey()),c;c=typeof b;return c="function"==c||"object"==c&&null!==b?b.$$hashKey=c+":"+(a||Fd)():c+":"+b}function db(b,a){if(a){var c=0;this.nextUid=function(){return++c}}s(b,this.put,this)}function mf(b){return(b=b.toString().replace(Oc,"").match(Pc))?"function("+(b[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function Vb(b,
a,c){var d;if("function"===typeof b){if(!(d=b.$inject)){d=[];if(b.length){if(a)throw F(c)&&c||(c=b.name||mf(b)),Ga("strictdi",c);a=b.toString().replace(Oc,"");a=a.match(Pc);s(a[1].split(nf),function(a){a.replace(of,function(a,b,c){d.push(c)})})}b.$inject=d}}else D(b)?(a=b.length-1,sb(b[a],"fn"),d=b.slice(0,a)):sb(b,"fn",!0);return d}function Ob(b,a){function c(a){return function(b,c){if(I(b))s(b,kc(a));else return a(b,c)}}function d(a,b){Ma(a,"service");if(G(b)||D(b))b=q.instantiate(b);if(!b.$get)throw Ga("pget",
a);return p[a+"Provider"]=b}function e(a,b){return function(){var c=r.invoke(b,this);if(A(c))throw Ga("undef",a);return c}}function f(a,b,c){return d(a,{$get:!1!==c?e(a,b):b})}function g(a){var b=[],c;s(a,function(a){function d(a){var b,c;b=0;for(c=a.length;b<c;b++){var e=a[b],f=q.get(e[0]);f[e[1]].apply(f,e[2])}}if(!m.get(a)){m.put(a,!0);try{F(a)?(c=bb(a),b=b.concat(g(c.requires)).concat(c._runBlocks),d(c._invokeQueue),d(c._configBlocks)):G(a)?b.push(q.invoke(a)):D(a)?b.push(q.invoke(a)):sb(a,"module")}catch(e){throw D(a)&&
(a=a[a.length-1]),e.message&&e.stack&&-1==e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),Ga("modulerr",a,e.stack||e.message||e);}}});return b}function h(b,c){function d(a,e){if(b.hasOwnProperty(a)){if(b[a]===l)throw Ga("cdep",a+" <- "+k.join(" <- "));return b[a]}try{return k.unshift(a),b[a]=l,b[a]=c(a,e)}catch(f){throw b[a]===l&&delete b[a],f;}finally{k.shift()}}function e(b,c,f,g){"string"===typeof f&&(g=f,f=null);var h=[],k=Vb(b,a,g),l,q,p;q=0;for(l=k.length;q<l;q++){p=k[q];if("string"!==
typeof p)throw Ga("itkn",p);h.push(f&&f.hasOwnProperty(p)?f[p]:d(p,g))}D(b)&&(b=b[l]);return b.apply(c,h)}return{invoke:e,instantiate:function(a,b,c){var d=Object.create((D(a)?a[a.length-1]:a).prototype);a=e(a,d,b,c);return I(a)||G(a)?a:d},get:d,annotate:Vb,has:function(a){return p.hasOwnProperty(a+"Provider")||b.hasOwnProperty(a)}}}a=!0===a;var l={},k=[],m=new db([],!0),p={$provide:{provider:c(d),factory:c(f),service:c(function(a,b){return f(a,["$injector",function(a){return a.instantiate(b)}])}),
value:c(function(a,b){return f(a,da(b),!1)}),constant:c(function(a,b){Ma(a,"constant");p[a]=b;u[a]=b}),decorator:function(a,b){var c=q.get(a+"Provider"),d=c.$get;c.$get=function(){var a=r.invoke(d,c);return r.invoke(b,null,{$delegate:a})}}}},q=p.$injector=h(p,function(a,b){ga.isString(b)&&k.push(b);throw Ga("unpr",k.join(" <- "));}),u={},r=u.$injector=h(u,function(a,b){var c=q.get(a+"Provider",b);return r.invoke(c.$get,c,t,a)});s(g(b),function(a){r.invoke(a||H)});return r}function Be(){var b=!0;this.disableAutoScrolling=
function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;Array.prototype.some.call(a,function(a){if("a"===ua(a))return b=a,!0});return b}function f(b){if(b){b.scrollIntoView();var c;c=g.yOffset;G(c)?c=c():mc(c)?(c=c[0],c="fixed"!==a.getComputedStyle(c).position?0:c.getBoundingClientRect().bottom):V(c)||(c=0);c&&(b=b.getBoundingClientRect().top,a.scrollBy(0,b-c))}else a.scrollTo(0,0)}function g(){var a=c.hash(),b;a?(b=h.getElementById(a))?f(b):(b=e(h.getElementsByName(a)))?
f(b):"top"===a&&f(null):f(null)}var h=a.document;b&&d.$watch(function(){return c.hash()},function(a,b){a===b&&""===a||jf(function(){d.$evalAsync(g)})});return g}]}function af(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function pf(b,a,c,d){function e(a){try{a.apply(null,Za.call(arguments,1))}finally{if(v--,0===v)for(;w.length;)try{w.pop()()}catch(b){c.error(b)}}}function f(a,b){(function N(){s(L,function(a){a()});C=b(N,
a)})()}function g(){h();l()}function h(){x=b.history.state;x=A(x)?null:x;fa(x,J)&&(x=J);J=x}function l(){if(E!==m.url()||P!==x)E=m.url(),P=x,s(W,function(a){a(m.url(),x)})}function k(a){try{return decodeURIComponent(a)}catch(b){return a}}var m=this,p=a[0],q=b.location,u=b.history,r=b.setTimeout,O=b.clearTimeout,n={};m.isMock=!1;var v=0,w=[];m.$$completeOutstandingRequest=e;m.$$incOutstandingRequestCount=function(){v++};m.notifyWhenNoOutstandingRequests=function(a){s(L,function(a){a()});0===v?a():
w.push(a)};var L=[],C;m.addPollFn=function(a){A(C)&&f(100,r);L.push(a);return a};var x,P,E=q.href,S=a.find("base"),X=null;h();P=x;m.url=function(a,c,e){A(e)&&(e=null);q!==b.location&&(q=b.location);u!==b.history&&(u=b.history);if(a){var f=P===e;if(E===a&&(!d.history||f))return m;var g=E&&Ha(E)===Ha(a);E=a;P=e;!d.history||g&&f?(g||(X=a),c?q.replace(a):g?(c=q,e=a.indexOf("#"),a=-1===e?"":a.substr(e+1),c.hash=a):q.href=a):(u[c?"replaceState":"pushState"](e,"",a),h(),P=x);return m}return X||q.href.replace(/%27/g,
"'")};m.state=function(){return x};var W=[],wa=!1,J=null;m.onUrlChange=function(a){if(!wa){if(d.history)B(b).on("popstate",g);B(b).on("hashchange",g);wa=!0}W.push(a);return a};m.$$checkUrlChange=l;m.baseHref=function(){var a=S.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var ea={},y="",ca=m.baseHref();m.cookies=function(a,b){var d,e,f,g;if(a)b===t?p.cookie=encodeURIComponent(a)+"=;path="+ca+";expires=Thu, 01 Jan 1970 00:00:00 GMT":F(b)&&(d=(p.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+
";path="+ca).length+1,4096<d&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"));else{if(p.cookie!==y)for(y=p.cookie,d=y.split("; "),ea={},f=0;f<d.length;f++)e=d[f],g=e.indexOf("="),0<g&&(a=k(e.substring(0,g)),ea[a]===t&&(ea[a]=k(e.substring(g+1))));return ea}};m.defer=function(a,b){var c;v++;c=r(function(){delete n[c];e(a)},b||0);n[c]=!0;return c};m.defer.cancel=function(a){return n[a]?(delete n[a],O(a),e(H),!0):!1}}function De(){this.$get=["$window",
"$log","$sniffer","$document",function(b,a,c,d){return new pf(b,d,a,c)}]}function Ee(){this.$get=function(){function b(b,d){function e(a){a!=p&&(q?q==a&&(q=a.n):q=a,f(a.n,a.p),f(a,p),p=a,p.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in a)throw T("$cacheFactory")("iid",b);var g=0,h=z({},d,{id:b}),l={},k=d&&d.capacity||Number.MAX_VALUE,m={},p=null,q=null;return a[b]={put:function(a,b){if(k<Number.MAX_VALUE){var c=m[a]||(m[a]={key:a});e(c)}if(!A(b))return a in l||g++,l[a]=b,g>k&&this.remove(q.key),
b},get:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;e(b)}return l[a]},remove:function(a){if(k<Number.MAX_VALUE){var b=m[a];if(!b)return;b==p&&(p=b.p);b==q&&(q=b.n);f(b.n,b.p);delete m[a]}delete l[a];g--},removeAll:function(){l={};g=0;m={};p=q=null},destroy:function(){m=h=l=null;delete a[b]},info:function(){return z({},h,{size:g})}}}var a={};b.info=function(){var b={};s(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};return b}}function Ve(){this.$get=["$cacheFactory",
function(b){return b("templates")}]}function wc(b,a){function c(a,b){var c=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,d={};s(a,function(a,e){var f=a.match(c);if(!f)throw ja("iscp",b,e,a);d[e]={mode:f[1][0],collection:"*"===f[2],optional:"?"===f[3],attrName:f[4]||e}});return d}var d={},e=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,f=/(([\w\-]+)(?:\:([^;]+))?;?)/,g=Gd("ngSrc,ngSrcset,src,srcset"),h=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,l=/^(on[a-z]+|formaction)$/;this.directive=function p(a,e){Ma(a,"directive");F(a)?(Qb(e,
"directiveFactory"),d.hasOwnProperty(a)||(d[a]=[],b.factory(a+"Directive",["$injector","$exceptionHandler",function(b,e){var f=[];s(d[a],function(d,g){try{var h=b.invoke(d);G(h)?h={compile:da(h)}:!h.compile&&h.link&&(h.compile=da(h.link));h.priority=h.priority||0;h.index=g;h.name=h.name||a;h.require=h.require||h.controller&&h.name;h.restrict=h.restrict||"EA";I(h.scope)&&(h.$$isolateBindings=c(h.scope,h.name));f.push(h)}catch(l){e(l)}});return f}])),d[a].push(e)):s(a,kc(p));return this};this.aHrefSanitizationWhitelist=
function(b){return y(b)?(a.aHrefSanitizationWhitelist(b),this):a.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()};var k=!0;this.debugInfoEnabled=function(a){return y(a)?(k=a,this):k};this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,c,r,O,n,v,w,L,C,x){function P(a,b){try{a.addClass(b)}catch(c){}}
function E(a,b,c,d,e){a instanceof B||(a=B(a));s(a,function(b,c){b.nodeType==pb&&b.nodeValue.match(/\S+/)&&(a[c]=B(b).wrap("<span></span>").parent()[0])});var f=S(a,b,a,c,d,e);E.$$addScopeClass(a);var g=null;return function(b,c,d){Qb(b,"scope");d=d||{};var e=d.parentBoundTranscludeFn,h=d.transcludeControllers;d=d.futureParentElement;e&&e.$$boundTransclude&&(e=e.$$boundTransclude);g||(g=(d=d&&d[0])?"foreignobject"!==ua(d)&&d.toString().match(/SVG/)?"svg":"html":"html");d="html"!==g?B(Wb(g,B("<div>").append(a).html())):
c?La.clone.call(a):a;if(h)for(var l in h)d.data("$"+l+"Controller",h[l].instance);E.$$addScopeInfo(d,b);c&&c(d,b);f&&f(b,d,d,e);return d}}function S(a,b,c,d,e,f){function g(a,c,d,e){var f,l,k,q,p,n,w;if(r)for(w=Array(c.length),q=0;q<h.length;q+=3)f=h[q],w[f]=c[f];else w=c;q=0;for(p=h.length;q<p;)l=w[h[q++]],c=h[q++],f=h[q++],c?(c.scope?(k=a.$new(),E.$$addScopeInfo(B(l),k)):k=a,n=c.transcludeOnThisElement?X(a,c.transclude,e,c.elementTranscludeOnThisElement):!c.templateOnThisElement&&e?e:!e&&b?X(a,
b):null,c(f,k,l,d,n)):f&&f(a,l.childNodes,t,e)}for(var h=[],l,k,q,p,r,n=0;n<a.length;n++){l=new Xb;k=W(a[n],[],l,0===n?d:t,e);(f=k.length?ea(k,a[n],l,b,c,null,[],[],f):null)&&f.scope&&E.$$addScopeClass(l.$$element);l=f&&f.terminal||!(q=a[n].childNodes)||!q.length?null:S(q,f?(f.transcludeOnThisElement||!f.templateOnThisElement)&&f.transclude:b);if(f||l)h.push(n,f,l),p=!0,r=r||f;f=null}return p?g:null}function X(a,b,c,d){return function(d,e,f,g,h){d||(d=a.$new(!1,h),d.$$transcluded=!0);return b(d,e,
{parentBoundTranscludeFn:c,transcludeControllers:f,futureParentElement:g})}}function W(a,b,c,d,g){var h=c.$attr,l;switch(a.nodeType){case oa:ca(b,ya(ua(a)),"E",d,g);for(var k,q,p,r=a.attributes,n=0,w=r&&r.length;n<w;n++){var O=!1,L=!1;k=r[n];l=k.name;q=U(k.value);k=ya(l);if(p=fb.test(k))l=l.replace(Rc,"").substr(8).replace(/_(.)/g,function(a,b){return b.toUpperCase()});var u=k.replace(/(Start|End)$/,"");A(u)&&k===u+"Start"&&(O=l,L=l.substr(0,l.length-5)+"end",l=l.substr(0,l.length-6));k=ya(l.toLowerCase());
h[k]=l;if(p||!c.hasOwnProperty(k))c[k]=q,Lc(a,k)&&(c[k]=!0);Pa(a,b,q,k,p);ca(b,k,"A",d,g,O,L)}a=a.className;if(F(a)&&""!==a)for(;l=f.exec(a);)k=ya(l[2]),ca(b,k,"C",d,g)&&(c[k]=U(l[3])),a=a.substr(l.index+l[0].length);break;case pb:M(b,a.nodeValue);break;case 8:try{if(l=e.exec(a.nodeValue))k=ya(l[1]),ca(b,k,"M",d,g)&&(c[k]=U(l[2]))}catch(v){}}b.sort(N);return b}function wa(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ja("uterdir",b,c);a.nodeType==oa&&(a.hasAttribute(b)&&
e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return B(d)}function J(a,b,c){return function(d,e,f,g,h){e=wa(e[0],b,c);return a(d,e,f,g,h)}}function ea(a,d,e,f,g,l,k,p,r){function w(a,b,c,d){if(a){c&&(a=J(a,c,d));a.require=K.require;a.directiveName=z;if(S===K||K.$$isolateScope)a=Z(a,{isolateScope:!0});k.push(a)}if(b){c&&(b=J(b,c,d));b.require=K.require;b.directiveName=z;if(S===K||K.$$isolateScope)b=Z(b,{isolateScope:!0});p.push(b)}}function L(a,b,c,d){var e,f="data",
g=!1,l=c,k;if(F(b)){k=b.match(h);b=b.substring(k[0].length);k[3]&&(k[1]?k[3]=null:k[1]=k[3]);"^"===k[1]?f="inheritedData":"^^"===k[1]&&(f="inheritedData",l=c.parent());"?"===k[2]&&(g=!0);e=null;d&&"data"===f&&(e=d[b])&&(e=e.instance);e=e||l[f]("$"+b+"Controller");if(!e&&!g)throw ja("ctreq",b,a);return e||null}D(b)&&(e=[],s(b,function(b){e.push(L(a,b,c,d))}));return e}function v(a,c,f,g,h){function l(a,b,c){var d;Va(a)||(c=b,b=a,a=t);H&&(d=P);c||(c=H?W.parent():W);return h(a,b,d,c,wa)}var r,w,u,x,
P,eb,W,J;d===f?(J=e,W=e.$$element):(W=B(f),J=new Xb(W,e));S&&(x=c.$new(!0));h&&(eb=l,eb.$$boundTransclude=h);C&&(X={},P={},s(C,function(a){var b={$scope:a===S||a.$$isolateScope?x:c,$element:W,$attrs:J,$transclude:eb};u=a.controller;"@"==u&&(u=J[a.name]);b=n(u,b,!0,a.controllerAs);P[a.name]=b;H||W.data("$"+a.name+"Controller",b.instance);X[a.name]=b}));if(S){E.$$addScopeInfo(W,x,!0,!(ka&&(ka===S||ka===S.$$originalDirective)));E.$$addScopeClass(W,!0);g=X&&X[S.name];var xa=x;g&&g.identifier&&!0===S.bindToController&&
(xa=g.instance);s(x.$$isolateBindings=S.$$isolateBindings,function(a,d){var e=a.attrName,f=a.optional,g,h,l,k;switch(a.mode){case "@":J.$observe(e,function(a){xa[d]=a});J.$$observers[e].$$scope=c;J[e]&&(xa[d]=b(J[e])(c));break;case "=":if(f&&!J[e])break;h=O(J[e]);k=h.literal?fa:function(a,b){return a===b||a!==a&&b!==b};l=h.assign||function(){g=xa[d]=h(c);throw ja("nonassign",J[e],S.name);};g=xa[d]=h(c);f=function(a){k(a,xa[d])||(k(a,g)?l(c,a=xa[d]):xa[d]=a);return g=a};f.$stateful=!0;f=a.collection?
c.$watchCollection(J[e],f):c.$watch(O(J[e],f),null,h.literal);x.$on("$destroy",f);break;case "&":h=O(J[e]),xa[d]=function(a){return h(c,a)}}})}X&&(s(X,function(a){a()}),X=null);g=0;for(r=k.length;g<r;g++)w=k[g],$(w,w.isolateScope?x:c,W,J,w.require&&L(w.directiveName,w.require,W,P),eb);var wa=c;S&&(S.template||null===S.templateUrl)&&(wa=x);a&&a(wa,f.childNodes,t,h);for(g=p.length-1;0<=g;g--)w=p[g],$(w,w.isolateScope?x:c,W,J,w.require&&L(w.directiveName,w.require,W,P),eb)}r=r||{};for(var x=-Number.MAX_VALUE,
P,C=r.controllerDirectives,X,S=r.newIsolateScopeDirective,ka=r.templateDirective,ea=r.nonTlbTranscludeDirective,ca=!1,A=!1,H=r.hasElementTranscludeDirective,aa=e.$$element=B(d),K,z,N,Aa=f,Q,M=0,R=a.length;M<R;M++){K=a[M];var Pa=K.$$start,fb=K.$$end;Pa&&(aa=wa(d,Pa,fb));N=t;if(x>K.priority)break;if(N=K.scope)K.templateUrl||(I(N)?(Oa("new/isolated scope",S||P,K,aa),S=K):Oa("new/isolated scope",S,K,aa)),P=P||K;z=K.name;!K.templateUrl&&K.controller&&(N=K.controller,C=C||{},Oa("'"+z+"' controller",C[z],
K,aa),C[z]=K);if(N=K.transclude)ca=!0,K.$$tlb||(Oa("transclusion",ea,K,aa),ea=K),"element"==N?(H=!0,x=K.priority,N=aa,aa=e.$$element=B(Y.createComment(" "+z+": "+e[z]+" ")),d=aa[0],V(g,Za.call(N,0),d),Aa=E(N,f,x,l&&l.name,{nonTlbTranscludeDirective:ea})):(N=B(Tb(d)).contents(),aa.empty(),Aa=E(N,f));if(K.template)if(A=!0,Oa("template",ka,K,aa),ka=K,N=G(K.template)?K.template(aa,e):K.template,N=Sc(N),K.replace){l=K;N=Rb.test(N)?Tc(Wb(K.templateNamespace,U(N))):[];d=N[0];if(1!=N.length||d.nodeType!==
oa)throw ja("tplrt",z,"");V(g,aa,d);R={$attr:{}};N=W(d,[],R);var ba=a.splice(M+1,a.length-(M+1));S&&y(N);a=a.concat(N).concat(ba);Qc(e,R);R=a.length}else aa.html(N);if(K.templateUrl)A=!0,Oa("template",ka,K,aa),ka=K,K.replace&&(l=K),v=T(a.splice(M,a.length-M),aa,e,g,ca&&Aa,k,p,{controllerDirectives:C,newIsolateScopeDirective:S,templateDirective:ka,nonTlbTranscludeDirective:ea}),R=a.length;else if(K.compile)try{Q=K.compile(aa,e,Aa),G(Q)?w(null,Q,Pa,fb):Q&&w(Q.pre,Q.post,Pa,fb)}catch(qf){c(qf,va(aa))}K.terminal&&
(v.terminal=!0,x=Math.max(x,K.priority))}v.scope=P&&!0===P.scope;v.transcludeOnThisElement=ca;v.elementTranscludeOnThisElement=H;v.templateOnThisElement=A;v.transclude=Aa;r.hasElementTranscludeDirective=H;return v}function y(a){for(var b=0,c=a.length;b<c;b++){var d=b,e;e=z(Object.create(a[b]),{$$isolateScope:!0});a[d]=e}}function ca(b,e,f,g,h,l,k){if(e===h)return null;h=null;if(d.hasOwnProperty(e)){var q;e=a.get(e+"Directive");for(var r=0,n=e.length;r<n;r++)try{if(q=e[r],(g===t||g>q.priority)&&-1!=
q.restrict.indexOf(f)){if(l){var w={$$start:l,$$end:k};q=z(Object.create(q),w)}b.push(q);h=q}}catch(O){c(O)}}return h}function A(b){if(d.hasOwnProperty(b))for(var c=a.get(b+"Directive"),e=0,f=c.length;e<f;e++)if(b=c[e],b.multiElement)return!0;return!1}function Qc(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;s(a,function(d,e){"$"!=e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});s(b,function(b,f){"class"==f?(P(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):"style"==
f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function T(a,b,c,d,e,f,g,h){var l=[],k,q,p=b[0],n=a.shift(),w=z({},n,{templateUrl:null,transclude:null,replace:null,$$originalDirective:n}),O=G(n.templateUrl)?n.templateUrl(b,c):n.templateUrl,u=n.templateNamespace;b.empty();r(L.getTrustedResourceUrl(O)).then(function(r){var L,v;r=Sc(r);if(n.replace){r=Rb.test(r)?Tc(Wb(u,U(r))):[];L=r[0];if(1!=r.length||L.nodeType!==
oa)throw ja("tplrt",n.name,O);r={$attr:{}};V(d,b,L);var x=W(L,[],r);I(n.scope)&&y(x);a=x.concat(a);Qc(c,r)}else L=p,b.html(r);a.unshift(w);k=ea(a,L,c,e,b,n,f,g,h);s(d,function(a,c){a==L&&(d[c]=b[0])});for(q=S(b[0].childNodes,e);l.length;){r=l.shift();v=l.shift();var C=l.shift(),E=l.shift(),x=b[0];if(!r.$$destroyed){if(v!==p){var J=v.className;h.hasElementTranscludeDirective&&n.replace||(x=Tb(L));V(C,B(v),x);P(B(x),J)}v=k.transcludeOnThisElement?X(r,k.transclude,E):E;k(q,r,x,d,v)}}l=null});return function(a,
b,c,d,e){a=e;b.$$destroyed||(l?l.push(b,c,d,a):(k.transcludeOnThisElement&&(a=X(b,k.transclude,e)),k(q,b,c,d,a)))}}function N(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function Oa(a,b,c,d){if(b)throw ja("multidir",b.name,c.name,a,va(d));}function M(a,c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){a=a.parent();var b=!!a.length;b&&E.$$addBindingClass(a);return function(a,c){var e=c.parent();b||E.$$addBindingClass(e);E.$$addBindingInfo(e,
d.expressions);a.$watch(d,function(a){c[0].nodeValue=a})}}})}function Wb(a,b){a=Q(a||"html");switch(a){case "svg":case "math":var c=Y.createElement("div");c.innerHTML="<"+a+">"+b+"</"+a+">";return c.childNodes[0].childNodes;default:return b}}function R(a,b){if("srcdoc"==b)return L.HTML;var c=ua(a);if("xlinkHref"==b||"form"==c&&"action"==b||"img"!=c&&("src"==b||"ngSrc"==b))return L.RESOURCE_URL}function Pa(a,c,d,e,f){var h=R(a,e);f=g[e]||f;var k=b(d,!0,h,f);if(k){if("multiple"===e&&"select"===ua(a))throw ja("selmulti",
va(a));c.push({priority:100,compile:function(){return{pre:function(a,c,g){c=g.$$observers||(g.$$observers={});if(l.test(e))throw ja("nodomevents");var p=g[e];p!==d&&(k=p&&b(p,!0,h,f),d=p);k&&(g[e]=k(a),(c[e]||(c[e]=[])).$$inter=!0,(g.$$observers&&g.$$observers[e].$$scope||a).$watch(k,function(a,b){"class"===e&&a!=b?g.$updateClass(a,b):g.$set(e,a)}))}}}})}}function V(a,b,c){var d=b[0],e=b.length,f=d.parentNode,g,h;if(a)for(g=0,h=a.length;g<h;g++)if(a[g]==d){a[g++]=c;h=g+e-1;for(var l=a.length;g<l;g++,
h++)h<l?a[g]=a[h]:delete a[g];a.length-=e-1;a.context===d&&(a.context=c);break}f&&f.replaceChild(c,d);a=Y.createDocumentFragment();a.appendChild(d);B(c).data(B(d).data());sa?(Pb=!0,sa.cleanData([d])):delete B.cache[d[B.expando]];d=1;for(e=b.length;d<e;d++)f=b[d],B(f).remove(),a.appendChild(f),delete b[d];b[0]=c;b.length=1}function Z(a,b){return z(function(){return a.apply(null,arguments)},a,b)}function $(a,b,d,e,f,g){try{a(b,d,e,f,g)}catch(h){c(h,va(d))}}var Xb=function(a,b){if(b){var c=Object.keys(b),
d,e,f;d=0;for(e=c.length;d<e;d++)f=c[d],this[f]=b[f]}else this.$attr={};this.$$element=a};Xb.prototype={$normalize:ya,$addClass:function(a){a&&0<a.length&&C.addClass(this.$$element,a)},$removeClass:function(a){a&&0<a.length&&C.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=Uc(a,b);c&&c.length&&C.addClass(this.$$element,c);(c=Uc(b,a))&&c.length&&C.removeClass(this.$$element,c)},$set:function(a,b,d,e){var f=this.$$element[0],g=Lc(f,a),h=kf(f,a),f=a;g?(this.$$element.prop(a,b),e=g):
h&&(this[h]=b,f=h);this[a]=b;e?this.$attr[a]=e:(e=this.$attr[a])||(this.$attr[a]=e=tc(a,"-"));g=ua(this.$$element);if("a"===g&&"href"===a||"img"===g&&"src"===a)this[a]=b=x(b,"src"===a);else if("img"===g&&"srcset"===a){for(var g="",h=U(b),l=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,l=/\s/.test(h)?l:/(,)/,h=h.split(l),l=Math.floor(h.length/2),k=0;k<l;k++)var q=2*k,g=g+x(U(h[q]),!0),g=g+(" "+U(h[q+1]));h=U(h[2*k]).split(/\s/);g+=x(U(h[0]),!0);2===h.length&&(g+=" "+U(h[1]));this[a]=b=g}!1!==d&&(null===b||
b===t?this.$$element.removeAttr(e):this.$$element.attr(e,b));(a=this.$$observers)&&s(a[f],function(a){try{a(b)}catch(d){c(d)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers=ha()),e=d[a]||(d[a]=[]);e.push(b);v.$evalAsync(function(){!e.$$inter&&c.hasOwnProperty(a)&&b(c[a])});return function(){Xa(e,b)}}};var Aa=b.startSymbol(),ka=b.endSymbol(),Sc="{{"==Aa||"}}"==ka?pa:function(a){return a.replace(/\{\{/g,Aa).replace(/}}/g,ka)},fb=/^ngAttr[A-Z]/;E.$$addBindingInfo=k?function(a,b){var c=
a.data("$binding")||[];D(b)?c=c.concat(b):c.push(b);a.data("$binding",c)}:H;E.$$addBindingClass=k?function(a){P(a,"ng-binding")}:H;E.$$addScopeInfo=k?function(a,b,c,d){a.data(c?d?"$isolateScopeNoTemplate":"$isolateScope":"$scope",b)}:H;E.$$addScopeClass=k?function(a,b){P(a,b?"ng-isolate-scope":"ng-scope")}:H;return E}]}function ya(b){return cb(b.replace(Rc,""))}function Uc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),f=0;a:for(;f<d.length;f++){for(var g=d[f],h=0;h<e.length;h++)if(g==e[h])continue a;
c+=(0<c.length?" ":"")+g}return c}function Tc(b){b=B(b);var a=b.length;if(1>=a)return b;for(;a--;)8===b[a].nodeType&&rf.call(b,a,1);return b}function Fe(){var b={},a=!1,c=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,c){Ma(a,"controller");I(a)?z(b,a):b[a]=c};this.allowGlobals=function(){a=!0};this.$get=["$injector","$window",function(d,e){function f(a,b,c,d){if(!a||!I(a.$scope))throw T("$controller")("noscp",d,b);a.$scope[b]=c}return function(g,h,l,k){var m,p,q;l=!0===l;k&&F(k)&&(q=k);F(g)&&
(k=g.match(c),p=k[1],q=q||k[3],g=b.hasOwnProperty(p)?b[p]:vc(h.$scope,p,!0)||(a?vc(e,p,!0):t),sb(g,p,!0));if(l)return l=(D(g)?g[g.length-1]:g).prototype,m=Object.create(l),q&&f(h,q,m,p||g.name),z(function(){d.invoke(g,m,h,p);return m},{instance:m,identifier:q});m=d.instantiate(g,h,p);q&&f(h,q,m,p||g.name);return m}}]}function Ge(){this.$get=["$window",function(b){return B(b.document)}]}function He(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function Yb(b,a){if(F(b)){var c=
b.replace(sf,"").trim();if(c){var d=a("Content-Type");(d=d&&0===d.indexOf(Vc))||(d=(d=c.match(tf))&&uf[d[0]].test(c));d&&(b=oc(c))}}return b}function Wc(b){var a=ha(),c,d,e;if(!b)return a;s(b.split("\n"),function(b){e=b.indexOf(":");c=Q(U(b.substr(0,e)));d=U(b.substr(e+1));c&&(a[c]=a[c]?a[c]+", "+d:d)});return a}function Xc(b){var a=I(b)?b:t;return function(c){a||(a=Wc(b));return c?(c=a[Q(c)],void 0===c&&(c=null),c):a}}function Yc(b,a,c,d){if(G(d))return d(b,a,c);s(d,function(d){b=d(b,a,c)});return b}
function Ke(){var b=this.defaults={transformResponse:[Yb],transformRequest:[function(a){return I(a)&&"[object File]"!==Da.call(a)&&"[object Blob]"!==Da.call(a)&&"[object FormData]"!==Da.call(a)?$a(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ra(Zb),put:ra(Zb),patch:ra(Zb)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},a=!1;this.useApplyAsync=function(b){return y(b)?(a=!!b,this):a};var c=this.interceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory",
"$rootScope","$q","$injector",function(d,e,f,g,h,l){function k(a){function c(a){var b=z({},a);b.data=a.data?Yc(a.data,a.headers,a.status,e.transformResponse):a.data;a=a.status;return 200<=a&&300>a?b:h.reject(b)}function d(a){var b,c={};s(a,function(a,d){G(a)?(b=a(),null!=b&&(c[d]=b)):c[d]=a});return c}if(!ga.isObject(a))throw T("$http")("badreq",a);var e=z({method:"get",transformRequest:b.transformRequest,transformResponse:b.transformResponse},a);e.headers=function(a){var c=b.headers,e=z({},a.headers),
f,g,c=z({},c.common,c[Q(a.method)]);a:for(f in c){a=Q(f);for(g in e)if(Q(g)===a)continue a;e[f]=c[f]}return d(e)}(a);e.method=ub(e.method);var f=[function(a){var d=a.headers,e=Yc(a.data,Xc(d),t,a.transformRequest);A(e)&&s(d,function(a,b){"content-type"===Q(b)&&delete d[b]});A(a.withCredentials)&&!A(b.withCredentials)&&(a.withCredentials=b.withCredentials);return m(a,e).then(c,c)},t],g=h.when(e);for(s(u,function(a){(a.request||a.requestError)&&f.unshift(a.request,a.requestError);(a.response||a.responseError)&&
f.push(a.response,a.responseError)});f.length;){a=f.shift();var l=f.shift(),g=g.then(a,l)}g.success=function(a){g.then(function(b){a(b.data,b.status,b.headers,e)});return g};g.error=function(a){g.then(null,function(b){a(b.data,b.status,b.headers,e)});return g};return g}function m(c,f){function l(b,c,d,e){function f(){m(c,b,d,e)}P&&(200<=b&&300>b?P.put(X,[b,c,Wc(d),e]):P.remove(X));a?g.$applyAsync(f):(f(),g.$$phase||g.$apply())}function m(a,b,d,e){b=Math.max(b,0);(200<=b&&300>b?C.resolve:C.reject)({data:a,
status:b,headers:Xc(d),config:c,statusText:e})}function w(a){m(a.data,a.status,ra(a.headers()),a.statusText)}function u(){var a=k.pendingRequests.indexOf(c);-1!==a&&k.pendingRequests.splice(a,1)}var C=h.defer(),x=C.promise,P,E,s=c.headers,X=p(c.url,c.params);k.pendingRequests.push(c);x.then(u,u);!c.cache&&!b.cache||!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method||(P=I(c.cache)?c.cache:I(b.cache)?b.cache:q);P&&(E=P.get(X),y(E)?E&&G(E.then)?E.then(w,w):D(E)?m(E[1],E[0],ra(E[2]),E[3]):m(E,200,{},
"OK"):P.put(X,x));A(E)&&((E=Zc(c.url)?e.cookies()[c.xsrfCookieName||b.xsrfCookieName]:t)&&(s[c.xsrfHeaderName||b.xsrfHeaderName]=E),d(c.method,X,f,l,s,c.timeout,c.withCredentials,c.responseType));return x}function p(a,b){if(!b)return a;var c=[];Ed(b,function(a,b){null===a||A(a)||(D(a)||(a=[a]),s(a,function(a){I(a)&&(a=qa(a)?a.toISOString():$a(a));c.push(Fa(b)+"="+Fa(a))}))});0<c.length&&(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&"));return a}var q=f("$http"),u=[];s(c,function(a){u.unshift(F(a)?l.get(a):
l.invoke(a))});k.pendingRequests=[];(function(a){s(arguments,function(a){k[a]=function(b,c){return k(z(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){s(arguments,function(a){k[a]=function(b,c,d){return k(z(d||{},{method:a,url:b,data:c}))}})})("post","put","patch");k.defaults=b;return k}]}function vf(){return new M.XMLHttpRequest}function Le(){this.$get=["$browser","$window","$document",function(b,a,c){return wf(b,vf,b.defer,a.angular.callbacks,c[0])}]}function wf(b,a,c,
d,e){function f(a,b,c){var f=e.createElement("script"),m=null;f.type="text/javascript";f.src=a;f.async=!0;m=function(a){f.removeEventListener("load",m,!1);f.removeEventListener("error",m,!1);e.body.removeChild(f);f=null;var g=-1,u="unknown";a&&("load"!==a.type||d[b].called||(a={type:"error"}),u=a.type,g="error"===a.type?404:200);c&&c(g,u)};f.addEventListener("load",m,!1);f.addEventListener("error",m,!1);e.body.appendChild(f);return m}return function(e,h,l,k,m,p,q,u){function r(){v&&v();w&&w.abort()}
function O(a,d,e,f,g){C!==t&&c.cancel(C);v=w=null;a(d,e,f,g);b.$$completeOutstandingRequest(H)}b.$$incOutstandingRequestCount();h=h||b.url();if("jsonp"==Q(e)){var n="_"+(d.counter++).toString(36);d[n]=function(a){d[n].data=a;d[n].called=!0};var v=f(h.replace("JSON_CALLBACK","angular.callbacks."+n),n,function(a,b){O(k,a,d[n].data,"",b);d[n]=H})}else{var w=a();w.open(e,h,!0);s(m,function(a,b){y(a)&&w.setRequestHeader(b,a)});w.onload=function(){var a=w.statusText||"",b="response"in w?w.response:w.responseText,
c=1223===w.status?204:w.status;0===c&&(c=b?200:"file"==Ba(h).protocol?404:0);O(k,c,b,w.getAllResponseHeaders(),a)};e=function(){O(k,-1,null,null,"")};w.onerror=e;w.onabort=e;q&&(w.withCredentials=!0);if(u)try{w.responseType=u}catch(L){if("json"!==u)throw L;}w.send(l||null)}if(0<p)var C=c(r,p);else p&&G(p.then)&&p.then(r)}}function Ie(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler","$sce",
function(c,d,e){function f(a){return"\\\\\\"+a}function g(f,g,u,r){function O(c){return c.replace(k,b).replace(m,a)}function n(a){try{var b=a;a=u?e.getTrusted(u,b):e.valueOf(b);var c;if(r&&!y(a))c=a;else if(null==a)c="";else{switch(typeof a){case "string":break;case "number":a=""+a;break;default:a=$a(a)}c=a}return c}catch(g){c=$b("interr",f,g.toString()),d(c)}}r=!!r;for(var v,w,L=0,C=[],x=[],P=f.length,E=[],s=[];L<P;)if(-1!=(v=f.indexOf(b,L))&&-1!=(w=f.indexOf(a,v+h)))L!==v&&E.push(O(f.substring(L,
v))),L=f.substring(v+h,w),C.push(L),x.push(c(L,n)),L=w+l,s.push(E.length),E.push("");else{L!==P&&E.push(O(f.substring(L)));break}if(u&&1<E.length)throw $b("noconcat",f);if(!g||C.length){var X=function(a){for(var b=0,c=C.length;b<c;b++){if(r&&A(a[b]))return;E[s[b]]=a[b]}return E.join("")};return z(function(a){var b=0,c=C.length,e=Array(c);try{for(;b<c;b++)e[b]=x[b](a);return X(e)}catch(g){a=$b("interr",f,g.toString()),d(a)}},{exp:f,expressions:C,$$watchDelegate:function(a,b,c){var d;return a.$watchGroup(x,
function(c,e){var f=X(c);G(b)&&b.call(this,f,c!==e?d:f,a);d=f},c)}})}}var h=b.length,l=a.length,k=new RegExp(b.replace(/./g,f),"g"),m=new RegExp(a.replace(/./g,f),"g");g.startSymbol=function(){return b};g.endSymbol=function(){return a};return g}]}function Je(){this.$get=["$rootScope","$window","$q","$$q",function(b,a,c,d){function e(e,h,l,k){var m=a.setInterval,p=a.clearInterval,q=0,u=y(k)&&!k,r=(u?d:c).defer(),O=r.promise;l=y(l)?l:0;O.then(null,null,e);O.$$intervalId=m(function(){r.notify(q++);0<
l&&q>=l&&(r.resolve(q),p(O.$$intervalId),delete f[O.$$intervalId]);u||b.$apply()},h);f[O.$$intervalId]=r;return O}var f={};e.cancel=function(b){return b&&b.$$intervalId in f?(f[b.$$intervalId].reject("canceled"),a.clearInterval(b.$$intervalId),delete f[b.$$intervalId],!0):!1};return e}]}function Rd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,
maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",
longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function ac(b){b=b.split("/");for(var a=b.length;a--;)b[a]=qb(b[a]);return b.join("/")}function $c(b,a){var c=Ba(b);a.$$protocol=c.protocol;a.$$host=c.hostname;a.$$port=ba(c.port)||xf[c.protocol]||null}function ad(b,a){var c="/"!==b.charAt(0);c&&(b="/"+b);var d=Ba(b);a.$$path=decodeURIComponent(c&&"/"===d.pathname.charAt(0)?d.pathname.substring(1):
d.pathname);a.$$search=qc(d.search);a.$$hash=decodeURIComponent(d.hash);a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function za(b,a){if(0===a.indexOf(b))return a.substr(b.length)}function Ha(b){var a=b.indexOf("#");return-1==a?b:b.substr(0,a)}function bd(b){return b.replace(/(#.+)|#$/,"$1")}function bc(b){return b.substr(0,Ha(b).lastIndexOf("/")+1)}function cc(b,a){this.$$html5=!0;a=a||"";var c=bc(b);$c(b,this);this.$$parse=function(a){var b=za(c,a);if(!F(b))throw Fb("ipthprfx",a,c);
ad(b,this);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=Nb(this.$$search),b=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;(f=za(b,d))!==t?(g=f,g=(f=za(a,f))!==t?c+(za("/",f)||f):b+g):(f=za(c,d))!==t?g=c+f:c==d+"/"&&(g=c);g&&this.$$parse(g);return!!g}}function dc(b,a){var c=bc(b);$c(b,this);this.$$parse=function(d){d=
za(b,d)||za(c,d);var e;"#"===d.charAt(0)?(e=za(a,d),A(e)&&(e=d)):e=this.$$html5?d:"";ad(e,this);d=this.$$path;var f=/^\/[A-Z]:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,""));f.exec(e)||(d=(e=f.exec(d))?e[1]:d);this.$$path=d;this.$$compose()};this.$$compose=function(){var c=Nb(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+(this.$$url?a+this.$$url:"")};this.$$parseLinkUrl=function(a,c){return Ha(b)==Ha(a)?(this.$$parse(a),!0):!1}}function cd(b,
a){this.$$html5=!0;dc.apply(this,arguments);var c=bc(b);this.$$parseLinkUrl=function(d,e){if(e&&"#"===e[0])return this.hash(e.slice(1)),!0;var f,g;b==Ha(d)?f=d:(g=za(c,d))?f=b+a+g:c===d+"/"&&(f=c);f&&this.$$parse(f);return!!f};this.$$compose=function(){var c=Nb(this.$$search),e=this.$$hash?"#"+qb(this.$$hash):"";this.$$url=ac(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+a+this.$$url}}function Gb(b){return function(){return this[b]}}function dd(b,a){return function(c){if(A(c))return this[b];this[b]=
a(c);this.$$compose();return this}}function Me(){var b="",a={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(a){return y(a)?(b=a,this):b};this.html5Mode=function(b){return Wa(b)?(a.enabled=b,this):I(b)?(Wa(b.enabled)&&(a.enabled=b.enabled),Wa(b.requireBase)&&(a.requireBase=b.requireBase),Wa(b.rewriteLinks)&&(a.rewriteLinks=b.rewriteLinks),this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(c,d,e,f,g){function h(a,b,c){var e=k.url(),f=k.$$state;
try{d.url(a,b,c),k.$$state=d.state()}catch(g){throw k.url(e),k.$$state=f,g;}}function l(a,b){c.$broadcast("$locationChangeSuccess",k.absUrl(),a,k.$$state,b)}var k,m;m=d.baseHref();var p=d.url(),q;if(a.enabled){if(!m&&a.requireBase)throw Fb("nobase");q=p.substring(0,p.indexOf("/",p.indexOf("//")+2))+(m||"/");m=e.history?cc:cd}else q=Ha(p),m=dc;k=new m(q,"#"+b);k.$$parseLinkUrl(p,p);k.$$state=d.state();var u=/^\s*(javascript|mailto):/i;f.on("click",function(b){if(a.rewriteLinks&&!b.ctrlKey&&!b.metaKey&&
2!=b.which){for(var e=B(b.target);"a"!==ua(e[0]);)if(e[0]===f[0]||!(e=e.parent())[0])return;var h=e.prop("href"),l=e.attr("href")||e.attr("xlink:href");I(h)&&"[object SVGAnimatedString]"===h.toString()&&(h=Ba(h.animVal).href);u.test(h)||!h||e.attr("target")||b.isDefaultPrevented()||!k.$$parseLinkUrl(h,l)||(b.preventDefault(),k.absUrl()!=d.url()&&(c.$apply(),g.angular["ff-684208-preventDefault"]=!0))}});k.absUrl()!=p&&d.url(k.absUrl(),!0);var r=!0;d.onUrlChange(function(a,b){c.$evalAsync(function(){var d=
k.absUrl(),e=k.$$state,f;k.$$parse(a);k.$$state=b;f=c.$broadcast("$locationChangeStart",a,d,b,e).defaultPrevented;k.absUrl()===a&&(f?(k.$$parse(d),k.$$state=e,h(d,!1,e)):(r=!1,l(d,e)))});c.$$phase||c.$digest()});c.$watch(function(){var a=bd(d.url()),b=bd(k.absUrl()),f=d.state(),g=k.$$replace,q=a!==b||k.$$html5&&e.history&&f!==k.$$state;if(r||q)r=!1,c.$evalAsync(function(){var b=k.absUrl(),d=c.$broadcast("$locationChangeStart",b,a,k.$$state,f).defaultPrevented;k.absUrl()===b&&(d?(k.$$parse(a),k.$$state=
f):(q&&h(b,g,f===k.$$state?null:k.$$state),l(a,f)))});k.$$replace=!1});return k}]}function Ne(){var b=!0,a=this;this.debugEnabled=function(a){return y(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||H;a=!1;try{a=!!e.apply}catch(l){}return a?function(){var a=
[];s(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function ta(b,a){if("__defineGetter__"===b||"__defineSetter__"===b||"__lookupGetter__"===b||"__lookupSetter__"===b||"__proto__"===b)throw la("isecfld",a);return b}function ma(b,a){if(b){if(b.constructor===b)throw la("isecfn",a);if(b.window===b)throw la("isecwindow",
a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw la("isecdom",a);if(b===Object)throw la("isecobj",a);}return b}function ec(b){return b.constant}function gb(b,a,c,d,e){ma(b,e);ma(a,e);c=c.split(".");for(var f,g=0;1<c.length;g++){f=ta(c.shift(),e);var h=0===g&&a&&a[f]||b[f];h||(h={},b[f]=h);b=ma(h,e)}f=ta(c.shift(),e);ma(b[f],e);return b[f]=d}function Qa(b){return"constructor"==b}function ed(b,a,c,d,e,f,g){ta(b,f);ta(a,f);ta(c,f);ta(d,f);ta(e,f);var h=function(a){return ma(a,f)},l=g||Qa(b)?
h:pa,k=g||Qa(a)?h:pa,m=g||Qa(c)?h:pa,p=g||Qa(d)?h:pa,q=g||Qa(e)?h:pa;return function(f,g){var h=g&&g.hasOwnProperty(b)?g:f;if(null==h)return h;h=l(h[b]);if(!a)return h;if(null==h)return t;h=k(h[a]);if(!c)return h;if(null==h)return t;h=m(h[c]);if(!d)return h;if(null==h)return t;h=p(h[d]);return e?null==h?t:h=q(h[e]):h}}function yf(b,a){return function(c,d){return b(c,d,ma,a)}}function zf(b,a,c){var d=a.expensiveChecks,e=d?Af:Bf,f=e[b];if(f)return f;var g=b.split("."),h=g.length;if(a.csp)f=6>h?ed(g[0],
g[1],g[2],g[3],g[4],c,d):function(a,b){var e=0,f;do f=ed(g[e++],g[e++],g[e++],g[e++],g[e++],c,d)(a,b),b=t,a=f;while(e<h);return f};else{var l="";d&&(l+="s = eso(s, fe);\nl = eso(l, fe);\n");var k=d;s(g,function(a,b){ta(a,c);var e=(b?"s":'((l&&l.hasOwnProperty("'+a+'"))?l:s)')+"."+a;if(d||Qa(a))e="eso("+e+", fe)",k=!0;l+="if(s == null) return undefined;\ns="+e+";\n"});l+="return s;";a=new Function("s","l","eso","fe",l);a.toString=da(l);k&&(a=yf(a,c));f=a}f.sharedGetter=!0;f.assign=function(a,c,d){return gb(a,
d,b,c,b)};return e[b]=f}function fc(b){return G(b.valueOf)?b.valueOf():Cf.call(b)}function Oe(){var b=ha(),a=ha();this.$get=["$filter","$sniffer",function(c,d){function e(a){var b=a;a.sharedGetter&&(b=function(b,c){return a(b,c)},b.literal=a.literal,b.constant=a.constant,b.assign=a.assign);return b}function f(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];e.constant||(e.inputs?f(e.inputs,b):-1===b.indexOf(e)&&b.push(e))}return b}function g(a,b){return null==a||null==b?a===b:"object"===typeof a&&
(a=fc(a),"object"===typeof a)?!1:a===b||a!==a&&b!==b}function h(a,b,c,d){var e=d.$$inputs||(d.$$inputs=f(d.inputs,[])),h;if(1===e.length){var l=g,e=e[0];return a.$watch(function(a){var b=e(a);g(b,l)||(h=d(a),l=b&&fc(b));return h},b,c)}for(var k=[],q=0,p=e.length;q<p;q++)k[q]=g;return a.$watch(function(a){for(var b=!1,c=0,f=e.length;c<f;c++){var l=e[c](a);if(b||(b=!g(l,k[c])))k[c]=l&&fc(l)}b&&(h=d(a));return h},b,c)}function l(a,b,c,d){var e,f;return e=a.$watch(function(a){return d(a)},function(a,
c,d){f=a;G(b)&&b.apply(this,arguments);y(a)&&d.$$postDigest(function(){y(f)&&e()})},c)}function k(a,b,c,d){function e(a){var b=!0;s(a,function(a){y(a)||(b=!1)});return b}var f,g;return f=a.$watch(function(a){return d(a)},function(a,c,d){g=a;G(b)&&b.call(this,a,c,d);e(a)&&d.$$postDigest(function(){e(g)&&f()})},c)}function m(a,b,c,d){var e;return e=a.$watch(function(a){return d(a)},function(a,c,d){G(b)&&b.apply(this,arguments);e()},c)}function p(a,b){if(!b)return a;var c=a.$$watchDelegate,c=c!==k&&
c!==l?function(c,d){var e=a(c,d);return b(e,c,d)}:function(c,d){var e=a(c,d),f=b(e,c,d);return y(e)?f:e};a.$$watchDelegate&&a.$$watchDelegate!==h?c.$$watchDelegate=a.$$watchDelegate:b.$stateful||(c.$$watchDelegate=h,c.inputs=[a]);return c}var q={csp:d.csp,expensiveChecks:!1},u={csp:d.csp,expensiveChecks:!0};return function(d,f,g){var v,w,L;switch(typeof d){case "string":L=d=d.trim();var C=g?a:b;v=C[L];v||(":"===d.charAt(0)&&":"===d.charAt(1)&&(w=!0,d=d.substring(2)),g=g?u:q,v=new gc(g),v=(new hb(v,
c,g)).parse(d),v.constant?v.$$watchDelegate=m:w?(v=e(v),v.$$watchDelegate=v.literal?k:l):v.inputs&&(v.$$watchDelegate=h),C[L]=v);return p(v,f);case "function":return p(d,f);default:return p(H,f)}}}]}function Qe(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return fd(function(a){b.$evalAsync(a)},a)}]}function Re(){this.$get=["$browser","$exceptionHandler",function(b,a){return fd(function(a){b.defer(a)},a)}]}function fd(b,a){function c(a,b,c){function d(b){return function(c){e||(e=!0,
b.call(a,c))}}var e=!1;return[d(b),d(c)]}function d(){this.$$state={status:0}}function e(a,b){return function(c){b.call(a,c)}}function f(c){!c.processScheduled&&c.pending&&(c.processScheduled=!0,b(function(){var b,d,e;e=c.pending;c.processScheduled=!1;c.pending=t;for(var f=0,g=e.length;f<g;++f){d=e[f][0];b=e[f][c.status];try{G(b)?d.resolve(b(c.value)):1===c.status?d.resolve(c.value):d.reject(c.value)}catch(h){d.reject(h),a(h)}}}))}function g(){this.promise=new d;this.resolve=e(this,this.resolve);
this.reject=e(this,this.reject);this.notify=e(this,this.notify)}var h=T("$q",TypeError);d.prototype={then:function(a,b,c){var d=new g;this.$$state.pending=this.$$state.pending||[];this.$$state.pending.push([d,a,b,c]);0<this.$$state.status&&f(this.$$state);return d.promise},"catch":function(a){return this.then(null,a)},"finally":function(a,b){return this.then(function(b){return k(b,!0,a)},function(b){return k(b,!1,a)},b)}};g.prototype={resolve:function(a){this.promise.$$state.status||(a===this.promise?
this.$$reject(h("qcycle",a)):this.$$resolve(a))},$$resolve:function(b){var d,e;e=c(this,this.$$resolve,this.$$reject);try{if(I(b)||G(b))d=b&&b.then;G(d)?(this.promise.$$state.status=-1,d.call(b,e[0],e[1],this.notify)):(this.promise.$$state.value=b,this.promise.$$state.status=1,f(this.promise.$$state))}catch(g){e[1](g),a(g)}},reject:function(a){this.promise.$$state.status||this.$$reject(a)},$$reject:function(a){this.promise.$$state.value=a;this.promise.$$state.status=2;f(this.promise.$$state)},notify:function(c){var d=
this.promise.$$state.pending;0>=this.promise.$$state.status&&d&&d.length&&b(function(){for(var b,e,f=0,g=d.length;f<g;f++){e=d[f][0];b=d[f][3];try{e.notify(G(b)?b(c):c)}catch(h){a(h)}}})}};var l=function(a,b){var c=new g;b?c.resolve(a):c.reject(a);return c.promise},k=function(a,b,c){var d=null;try{G(c)&&(d=c())}catch(e){return l(e,!1)}return d&&G(d.then)?d.then(function(){return l(a,b)},function(a){return l(a,!1)}):l(a,b)},m=function(a,b,c,d){var e=new g;e.resolve(a);return e.promise.then(b,c,d)},
p=function u(a){if(!G(a))throw h("norslvr",a);if(!(this instanceof u))return new u(a);var b=new g;a(function(a){b.resolve(a)},function(a){b.reject(a)});return b.promise};p.defer=function(){return new g};p.reject=function(a){var b=new g;b.reject(a);return b.promise};p.when=m;p.all=function(a){var b=new g,c=0,d=D(a)?[]:{};s(a,function(a,e){c++;m(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});0===c&&b.resolve(d);return b.promise};
return p}function $e(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};f.supported=e;return f}]}function Pe(){var b=10,a=T("$rootScope"),c=null,d=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector",
"$exceptionHandler","$parse","$browser",function(e,f,g,h){function l(){this.$id=++nb;this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this.$root=this;this.$$destroyed=!1;this.$$listeners={};this.$$listenerCount={};this.$$isolateBindings=null}function k(b){if(r.$$phase)throw a("inprog",r.$$phase);r.$$phase=b}function m(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function p(){}
function q(){for(;v.length;)try{v.shift()()}catch(a){f(a)}d=null}function u(){null===d&&(d=h.defer(function(){r.$apply(q)}))}l.prototype={constructor:l,$new:function(a,b){function c(){d.$$destroyed=!0}var d;b=b||this;a?(d=new l,d.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$id=++nb;this.$$ChildScope=null},this.$$ChildScope.prototype=this),d=new this.$$ChildScope);
d.$parent=b;d.$$prevSibling=b.$$childTail;b.$$childHead?(b.$$childTail.$$nextSibling=d,b.$$childTail=d):b.$$childHead=b.$$childTail=d;(a||b!=this)&&d.$on("$destroy",c);return d},$watch:function(a,b,d){var e=g(a);if(e.$$watchDelegate)return e.$$watchDelegate(this,b,d,e);var f=this.$$watchers,h={fn:b,last:p,get:e,exp:a,eq:!!d};c=null;G(b)||(h.fn=H);f||(f=this.$$watchers=[]);f.unshift(h);return function(){Xa(f,h);c=null}},$watchGroup:function(a,b){function c(){h=!1;l?(l=!1,b(e,e,g)):b(e,d,g)}var d=Array(a.length),
e=Array(a.length),f=[],g=this,h=!1,l=!0;if(!a.length){var k=!0;g.$evalAsync(function(){k&&b(e,e,g)});return function(){k=!1}}if(1===a.length)return this.$watch(a[0],function(a,c,f){e[0]=a;d[0]=c;b(e,a===c?e:d,f)});s(a,function(a,b){var l=g.$watch(a,function(a,f){e[b]=a;d[b]=f;h||(h=!0,g.$evalAsync(c))});f.push(l)});return function(){for(;f.length;)f.shift()()}},$watchCollection:function(a,b){function c(a){e=a;var b,d,g,h;if(!A(e)){if(I(e))if(Ta(e))for(f!==q&&(f=q,u=f.length=0,k++),a=e.length,u!==
a&&(k++,f.length=u=a),b=0;b<a;b++)h=f[b],g=e[b],d=h!==h&&g!==g,d||h===g||(k++,f[b]=g);else{f!==m&&(f=m={},u=0,k++);a=0;for(b in e)e.hasOwnProperty(b)&&(a++,g=e[b],h=f[b],b in f?(d=h!==h&&g!==g,d||h===g||(k++,f[b]=g)):(u++,f[b]=g,k++));if(u>a)for(b in k++,f)e.hasOwnProperty(b)||(u--,delete f[b])}else f!==e&&(f=e,k++);return k}}c.$stateful=!0;var d=this,e,f,h,l=1<b.length,k=0,p=g(a,c),q=[],m={},n=!0,u=0;return this.$watch(p,function(){n?(n=!1,b(e,e,d)):b(e,h,d);if(l)if(I(e))if(Ta(e)){h=Array(e.length);
for(var a=0;a<e.length;a++)h[a]=e[a]}else for(a in h={},e)rc.call(e,a)&&(h[a]=e[a]);else h=e})},$digest:function(){var e,g,l,m,u,v,s=b,t,W=[],y,J;k("$digest");h.$$checkUrlChange();this===r&&null!==d&&(h.defer.cancel(d),q());c=null;do{v=!1;for(t=this;O.length;){try{J=O.shift(),J.scope.$eval(J.expression,J.locals)}catch(B){f(B)}c=null}a:do{if(m=t.$$watchers)for(u=m.length;u--;)try{if(e=m[u])if((g=e.get(t))!==(l=e.last)&&!(e.eq?fa(g,l):"number"===typeof g&&"number"===typeof l&&isNaN(g)&&isNaN(l)))v=
!0,c=e,e.last=e.eq?Ea(g,null):g,e.fn(g,l===p?g:l,t),5>s&&(y=4-s,W[y]||(W[y]=[]),W[y].push({msg:G(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,newVal:g,oldVal:l}));else if(e===c){v=!1;break a}}catch(A){f(A)}if(!(m=t.$$childHead||t!==this&&t.$$nextSibling))for(;t!==this&&!(m=t.$$nextSibling);)t=t.$parent}while(t=m);if((v||O.length)&&!s--)throw r.$$phase=null,a("infdig",b,W);}while(v||O.length);for(r.$$phase=null;n.length;)try{n.shift()()}catch(ca){f(ca)}},$destroy:function(){if(!this.$$destroyed){var a=
this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;if(this!==r){for(var b in this.$$listenerCount)m(this,this.$$listenerCount[b],b);a.$$childHead==this&&(a.$$childHead=this.$$nextSibling);a.$$childTail==this&&(a.$$childTail=this.$$prevSibling);this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling);this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling);this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=H;this.$on=this.$watch=this.$watchGroup=
function(){return H};this.$$listeners={};this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}}},$eval:function(a,b){return g(a)(this,b)},$evalAsync:function(a,b){r.$$phase||O.length||h.defer(function(){O.length&&r.$digest()});O.push({scope:this,expression:a,locals:b})},$$postDigest:function(a){n.push(a)},$apply:function(a){try{return k("$apply"),this.$eval(a)}catch(b){f(b)}finally{r.$$phase=null;try{r.$digest()}catch(c){throw f(c),c;
}}},$applyAsync:function(a){function b(){c.$eval(a)}var c=this;a&&v.push(b);u()},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){var d=c.indexOf(b);-1!==d&&(c[d]=null,m(e,1,a))}},$emit:function(a,b){var c=[],d,e=this,g=!1,h={name:a,targetScope:e,stopPropagation:function(){g=!0},preventDefault:function(){h.defaultPrevented=!0},defaultPrevented:!1},
l=Ya([h],arguments,1),k,p;do{d=e.$$listeners[a]||c;h.currentScope=e;k=0;for(p=d.length;k<p;k++)if(d[k])try{d[k].apply(null,l)}catch(m){f(m)}else d.splice(k,1),k--,p--;if(g)return h.currentScope=null,h;e=e.$parent}while(e);h.currentScope=null;return h},$broadcast:function(a,b){var c=this,d=this,e={name:a,targetScope:this,preventDefault:function(){e.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[a])return e;for(var g=Ya([e],arguments,1),h,l;c=d;){e.currentScope=c;d=c.$$listeners[a]||
[];h=0;for(l=d.length;h<l;h++)if(d[h])try{d[h].apply(null,g)}catch(k){f(k)}else d.splice(h,1),h--,l--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}e.currentScope=null;return e}};var r=new l,O=r.$$asyncQueue=[],n=r.$$postDigestQueue=[],v=r.$$applyAsyncQueue=[];return r}]}function Sd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,a=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(a){return y(a)?
(b=a,this):b};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a=b,this):a};this.$get=function(){return function(c,d){var e=d?a:b,f;f=Ba(c).href;return""===f||f.match(e)?c:"unsafe:"+f}}}function Df(b){if("self"===b)return b;if(F(b)){if(-1<b.indexOf("***"))throw Ca("iwcard",b);b=gd(b).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*");return new RegExp("^"+b+"$")}if(ob(b))return new RegExp("^"+b.source+"$");throw Ca("imatcher");}function hd(b){var a=[];y(b)&&s(b,function(b){a.push(Df(b))});
return a}function Te(){this.SCE_CONTEXTS=na;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){arguments.length&&(b=hd(a));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(a=hd(b));return a};this.$get=["$injector",function(c){function d(a,b){return"self"===a?Zc(b):!!a.exec(b.href)}function e(a){var b=function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};
return b}var f=function(a){throw Ca("unsafe");};c.has("$sanitize")&&(f=c.get("$sanitize"));var g=e(),h={};h[na.HTML]=e(g);h[na.CSS]=e(g);h[na.URL]=e(g);h[na.JS]=e(g);h[na.RESOURCE_URL]=e(h[na.URL]);return{trustAs:function(a,b){var c=h.hasOwnProperty(a)?h[a]:null;if(!c)throw Ca("icontext",a,b);if(null===b||b===t||""===b)return b;if("string"!==typeof b)throw Ca("itype",a);return new c(b)},getTrusted:function(c,e){if(null===e||e===t||""===e)return e;var g=h.hasOwnProperty(c)?h[c]:null;if(g&&e instanceof
g)return e.$$unwrapTrustedValue();if(c===na.RESOURCE_URL){var g=Ba(e.toString()),p,q,u=!1;p=0;for(q=b.length;p<q;p++)if(d(b[p],g)){u=!0;break}if(u)for(p=0,q=a.length;p<q;p++)if(d(a[p],g)){u=!1;break}if(u)return e;throw Ca("insecurl",e.toString());}if(c===na.HTML)return f(e);throw Ca("unsafe");},valueOf:function(a){return a instanceof g?a.$$unwrapTrustedValue():a}}}]}function Se(){var b=!0;this.enabled=function(a){arguments.length&&(b=!!a);return b};this.$get=["$parse","$sceDelegate",function(a,c){if(b&&
8>Ra)throw Ca("iequirks");var d=ra(na);d.isEnabled=function(){return b};d.trustAs=c.trustAs;d.getTrusted=c.getTrusted;d.valueOf=c.valueOf;b||(d.trustAs=d.getTrusted=function(a,b){return b},d.valueOf=pa);d.parseAs=function(b,c){var e=a(c);return e.literal&&e.constant?e:a(c,function(a){return d.getTrusted(b,a)})};var e=d.parseAs,f=d.getTrusted,g=d.trustAs;s(na,function(a,b){var c=Q(b);d[cb("parse_as_"+c)]=function(b){return e(a,b)};d[cb("get_trusted_"+c)]=function(b){return f(a,b)};d[cb("trust_as_"+
c)]=function(b){return g(a,b)}});return d}]}function Ue(){this.$get=["$window","$document",function(b,a){var c={},d=ba((/android (\d+)/.exec(Q((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||{}).userAgent),f=a[0]||{},g,h=/^(Moz|webkit|ms)(?=[A-Z])/,l=f.body&&f.body.style,k=!1,m=!1;if(l){for(var p in l)if(k=h.exec(p)){g=k[0];g=g.substr(0,1).toUpperCase()+g.substr(1);break}g||(g="WebkitOpacity"in l&&"webkit");k=!!("transition"in l||g+"Transition"in l);m=!!("animation"in l||g+"Animation"in
l);!d||k&&m||(k=F(f.body.style.webkitTransition),m=F(f.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hasEvent:function(a){if("input"===a&&11>=Ra)return!1;if(A(c[a])){var b=f.createElement("div");c[a]="on"+a in b}return c[a]},csp:ab(),vendorPrefix:g,transitions:k,animations:m,android:d}}]}function We(){this.$get=["$templateCache","$http","$q",function(b,a,c){function d(e,f){d.totalPendingRequests++;var g=a.defaults&&a.defaults.transformResponse;D(g)?g=g.filter(function(a){return a!==
Yb}):g===Yb&&(g=null);return a.get(e,{cache:b,transformResponse:g}).then(function(a){d.totalPendingRequests--;return a.data},function(a){d.totalPendingRequests--;if(!f)throw ja("tpload",e);return c.reject(a)})}d.totalPendingRequests=0;return d}]}function Xe(){this.$get=["$rootScope","$browser","$location",function(b,a,c){return{findBindings:function(a,b,c){a=a.getElementsByClassName("ng-binding");var g=[];s(a,function(a){var d=ga.element(a).data("$binding");d&&s(d,function(d){c?(new RegExp("(^|\\s)"+
gd(b)+"(\\s|\\||$)")).test(d)&&g.push(a):-1!=d.indexOf(b)&&g.push(a)})});return g},findModels:function(a,b,c){for(var g=["ng-","data-ng-","ng\\:"],h=0;h<g.length;++h){var l=a.querySelectorAll("["+g[h]+"model"+(c?"=":"*=")+'"'+b+'"]');if(l.length)return l}},getLocation:function(){return c.url()},setLocation:function(a){a!==c.url()&&(c.url(a),b.$digest())},whenStable:function(b){a.notifyWhenNoOutstandingRequests(b)}}}]}function Ye(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",
function(b,a,c,d,e){function f(f,l,k){var m=y(k)&&!k,p=(m?d:c).defer(),q=p.promise;l=a.defer(function(){try{p.resolve(f())}catch(a){p.reject(a),e(a)}finally{delete g[q.$$timeoutId]}m||b.$apply()},l);q.$$timeoutId=l;g[l]=p;return q}var g={};f.cancel=function(b){return b&&b.$$timeoutId in g?(g[b.$$timeoutId].reject("canceled"),delete g[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1};return f}]}function Ba(b){Ra&&(Z.setAttribute("href",b),b=Z.href);Z.setAttribute("href",b);return{href:Z.href,protocol:Z.protocol?
Z.protocol.replace(/:$/,""):"",host:Z.host,search:Z.search?Z.search.replace(/^\?/,""):"",hash:Z.hash?Z.hash.replace(/^#/,""):"",hostname:Z.hostname,port:Z.port,pathname:"/"===Z.pathname.charAt(0)?Z.pathname:"/"+Z.pathname}}function Zc(b){b=F(b)?Ba(b):b;return b.protocol===id.protocol&&b.host===id.host}function Ze(){this.$get=da(M)}function Dc(b){function a(c,d){if(I(c)){var e={};s(c,function(b,c){e[c]=a(c,b)});return e}return b.factory(c+"Filter",d)}this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+
"Filter")}}];a("currency",jd);a("date",kd);a("filter",Ef);a("json",Ff);a("limitTo",Gf);a("lowercase",Hf);a("number",ld);a("orderBy",md);a("uppercase",If)}function Ef(){return function(b,a,c){if(!D(b))return b;var d;switch(typeof a){case "function":break;case "boolean":case "number":case "string":d=!0;case "object":a=Jf(a,c,d);break;default:return b}return b.filter(a)}}function Jf(b,a,c){var d=I(b)&&"$"in b;!0===a?a=fa:G(a)||(a=function(a,b){if(I(a)||I(b))return!1;a=Q(""+a);b=Q(""+b);return-1!==a.indexOf(b)});
return function(e){return d&&!I(e)?Ia(e,b.$,a,!1):Ia(e,b,a,c)}}function Ia(b,a,c,d,e){var f=typeof b,g=typeof a;if("string"===g&&"!"===a.charAt(0))return!Ia(b,a.substring(1),c,d);if(D(b))return b.some(function(b){return Ia(b,a,c,d)});switch(f){case "object":var h;if(d){for(h in b)if("$"!==h.charAt(0)&&Ia(b[h],a,c,!0))return!0;return e?!1:Ia(b,a,c,!1)}if("object"===g){for(h in a)if(e=a[h],!G(e)&&(f="$"===h,!Ia(f?b:b[h],e,c,f,f)))return!1;return!0}return c(b,a);case "function":return!1;default:return c(b,
a)}}function jd(b){var a=b.NUMBER_FORMATS;return function(b,d,e){A(d)&&(d=a.CURRENCY_SYM);A(e)&&(e=a.PATTERNS[1].maxFrac);return null==b?b:nd(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,e).replace(/\u00A4/g,d)}}function ld(b){var a=b.NUMBER_FORMATS;return function(b,d){return null==b?b:nd(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function nd(b,a,c,d,e){if(!isFinite(b)||I(b))return"";var f=0>b;b=Math.abs(b);var g=b+"",h="",l=[],k=!1;if(-1!==g.indexOf("e")){var m=g.match(/([\d\.]+)e(-?)(\d+)/);m&&
"-"==m[2]&&m[3]>e+1?b=0:(h=g,k=!0)}if(k)0<e&&1>b&&(h=b.toFixed(e),b=parseFloat(h));else{g=(g.split(od)[1]||"").length;A(e)&&(e=Math.min(Math.max(a.minFrac,g),a.maxFrac));b=+(Math.round(+(b.toString()+"e"+e)).toString()+"e"+-e);var g=(""+b).split(od),k=g[0],g=g[1]||"",p=0,q=a.lgSize,u=a.gSize;if(k.length>=q+u)for(p=k.length-q,m=0;m<p;m++)0===(p-m)%u&&0!==m&&(h+=c),h+=k.charAt(m);for(m=p;m<k.length;m++)0===(k.length-m)%q&&0!==m&&(h+=c),h+=k.charAt(m);for(;g.length<e;)g+="0";e&&"0"!==e&&(h+=d+g.substr(0,
e))}0===b&&(f=!1);l.push(f?a.negPre:a.posPre,h,f?a.negSuf:a.posSuf);return l.join("")}function Hb(b,a,c){var d="";0>b&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function $(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(0<c||e>-c)e+=c;0===e&&-12==c&&(e=12);return Hb(e,a,d)}}function Ib(b,a){return function(c,d){var e=c["get"+b](),f=ub(a?"SHORT"+b:b);return d[f][e]}}function pd(b){var a=(new Date(b,0,1)).getDay();return new Date(b,0,(4>=a?5:12)-a)}function qd(b){return function(a){var c=
pd(a.getFullYear());a=+new Date(a.getFullYear(),a.getMonth(),a.getDate()+(4-a.getDay()))-+c;a=1+Math.round(a/6048E5);return Hb(a,b)}}function kd(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var f=0,g=0,h=b[8]?a.setUTCFullYear:a.setFullYear,l=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=ba(b[9]+b[10]),g=ba(b[9]+b[11]));h.call(a,ba(b[1]),ba(b[2])-1,ba(b[3]));f=ba(b[4]||0)-f;g=ba(b[5]||0)-g;h=ba(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));l.call(a,f,g,h,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;
return function(c,e,f){var g="",h=[],l,k;e=e||"mediumDate";e=b.DATETIME_FORMATS[e]||e;F(c)&&(c=Kf.test(c)?ba(c):a(c));V(c)&&(c=new Date(c));if(!qa(c))return c;for(;e;)(k=Lf.exec(e))?(h=Ya(h,k,1),e=h.pop()):(h.push(e),e=null);f&&"UTC"===f&&(c=new Date(c.getTime()),c.setMinutes(c.getMinutes()+c.getTimezoneOffset()));s(h,function(a){l=Mf[a];g+=l?l(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return g}}function Ff(){return function(b,a){A(a)&&(a=2);return $a(b,a)}}function Gf(){return function(b,
a){V(b)&&(b=b.toString());return D(b)||F(b)?(a=Infinity===Math.abs(Number(a))?Number(a):ba(a))?0<a?b.slice(0,a):b.slice(a):F(b)?"":[]:b}}function md(b){return function(a,c,d){function e(a,b){return b?function(b,c){return a(c,b)}:a}function f(a){switch(typeof a){case "number":case "boolean":case "string":return!0;default:return!1}}function g(a){return null===a?"null":"function"===typeof a.valueOf&&(a=a.valueOf(),f(a))||"function"===typeof a.toString&&(a=a.toString(),f(a))?a:""}function h(a,b){var c=
typeof a,d=typeof b;c===d&&"object"===c&&(a=g(a),b=g(b));return c===d?("string"===c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}if(!Ta(a))return a;c=D(c)?c:[c];0===c.length&&(c=["+"]);c=c.map(function(a){var c=!1,d=a||pa;if(F(a)){if("+"==a.charAt(0)||"-"==a.charAt(0))c="-"==a.charAt(0),a=a.substring(1);if(""===a)return e(h,c);d=b(a);if(d.constant){var f=d();return e(function(a,b){return h(a[f],b[f])},c)}}return e(function(a,b){return h(d(a),d(b))},c)});return Za.call(a).sort(e(function(a,
b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function Ja(b){G(b)&&(b={link:b});b.restrict=b.restrict||"AC";return da(b)}function rd(b,a,c,d,e){var f=this,g=[],h=f.$$parentForm=b.parent().controller("form")||Jb;f.$error={};f.$$success={};f.$pending=t;f.$name=e(a.name||a.ngForm||"")(c);f.$dirty=!1;f.$pristine=!0;f.$valid=!0;f.$invalid=!1;f.$submitted=!1;h.$addControl(f);f.$rollbackViewValue=function(){s(g,function(a){a.$rollbackViewValue()})};f.$commitViewValue=function(){s(g,
function(a){a.$commitViewValue()})};f.$addControl=function(a){Ma(a.$name,"input");g.push(a);a.$name&&(f[a.$name]=a)};f.$$renameControl=function(a,b){var c=a.$name;f[c]===a&&delete f[c];f[b]=a;a.$name=b};f.$removeControl=function(a){a.$name&&f[a.$name]===a&&delete f[a.$name];s(f.$pending,function(b,c){f.$setValidity(c,null,a)});s(f.$error,function(b,c){f.$setValidity(c,null,a)});Xa(g,a)};sd({ctrl:this,$element:b,set:function(a,b,c){var d=a[b];d?-1===d.indexOf(c)&&d.push(c):a[b]=[c]},unset:function(a,
b,c){var d=a[b];d&&(Xa(d,c),0===d.length&&delete a[b])},parentForm:h,$animate:d});f.$setDirty=function(){d.removeClass(b,Sa);d.addClass(b,Kb);f.$dirty=!0;f.$pristine=!1;h.$setDirty()};f.$setPristine=function(){d.setClass(b,Sa,Kb+" ng-submitted");f.$dirty=!1;f.$pristine=!0;f.$submitted=!1;s(g,function(a){a.$setPristine()})};f.$setUntouched=function(){s(g,function(a){a.$setUntouched()})};f.$setSubmitted=function(){d.addClass(b,"ng-submitted");f.$submitted=!0;h.$setSubmitted()}}function hc(b){b.$formatters.push(function(a){return b.$isEmpty(a)?
a:a.toString()})}function ib(b,a,c,d,e,f){var g=Q(a[0].type);if(!e.android){var h=!1;a.on("compositionstart",function(a){h=!0});a.on("compositionend",function(){h=!1;l()})}var l=function(b){k&&(f.defer.cancel(k),k=null);if(!h){var e=a.val();b=b&&b.type;"password"===g||c.ngTrim&&"false"===c.ngTrim||(e=U(e));(d.$viewValue!==e||""===e&&d.$$hasNativeValidators)&&d.$setViewValue(e,b)}};if(e.hasEvent("input"))a.on("input",l);else{var k,m=function(a,b,c){k||(k=f.defer(function(){k=null;b&&b.value===c||l(a)}))};
a.on("keydown",function(a){var b=a.keyCode;91===b||15<b&&19>b||37<=b&&40>=b||m(a,this,this.value)});if(e.hasEvent("paste"))a.on("paste cut",m)}a.on("change",l);d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?"":d.$viewValue)}}function Lb(b,a){return function(c,d){var e,f;if(qa(c))return c;if(F(c)){'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substring(1,c.length-1));if(Nf.test(c))return new Date(c);b.lastIndex=0;if(e=b.exec(c))return e.shift(),f=d?{yyyy:d.getFullYear(),MM:d.getMonth()+1,
dd:d.getDate(),HH:d.getHours(),mm:d.getMinutes(),ss:d.getSeconds(),sss:d.getMilliseconds()/1E3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},s(e,function(b,c){c<a.length&&(f[a[c]]=+b)}),new Date(f.yyyy,f.MM-1,f.dd,f.HH,f.mm,f.ss||0,1E3*f.sss||0)}return NaN}}function jb(b,a,c,d){return function(e,f,g,h,l,k,m){function p(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())}function q(a){return y(a)?qa(a)?a:c(a):t}td(e,f,g,h);ib(e,f,g,h,l,k);var u=h&&h.$options&&h.$options.timezone,r;h.$$parserName=b;
h.$parsers.push(function(b){return h.$isEmpty(b)?null:a.test(b)?(b=c(b,r),"UTC"===u&&b.setMinutes(b.getMinutes()-b.getTimezoneOffset()),b):t});h.$formatters.push(function(a){if(a&&!qa(a))throw Mb("datefmt",a);if(p(a)){if((r=a)&&"UTC"===u){var b=6E4*r.getTimezoneOffset();r=new Date(r.getTime()+b)}return m("date")(a,d,u)}r=null;return""});if(y(g.min)||g.ngMin){var s;h.$validators.min=function(a){return!p(a)||A(s)||c(a)>=s};g.$observe("min",function(a){s=q(a);h.$validate()})}if(y(g.max)||g.ngMax){var n;
h.$validators.max=function(a){return!p(a)||A(n)||c(a)<=n};g.$observe("max",function(a){n=q(a);h.$validate()})}}}function td(b,a,c,d){(d.$$hasNativeValidators=I(a[0].validity))&&d.$parsers.push(function(b){var c=a.prop("validity")||{};return c.badInput&&!c.typeMismatch?t:b})}function ud(b,a,c,d,e){if(y(d)){b=b(d);if(!b.constant)throw T("ngModel")("constexpr",c,d);return b(a)}return e}function ic(b,a){b="ngClass"+b;return["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;d<a.length;d++){for(var e=
a[d],m=0;m<b.length;m++)if(e==b[m])continue a;c.push(e)}return c}function e(a){if(!D(a)){if(F(a))return a.split(" ");if(I(a)){var b=[];s(a,function(a,c){a&&(b=b.concat(c.split(" ")))});return b}}return a}return{restrict:"AC",link:function(f,g,h){function l(a,b){var c=g.data("$classCounts")||{},d=[];s(a,function(a){if(0<b||c[a])c[a]=(c[a]||0)+b,c[a]===+(0<b)&&d.push(a)});g.data("$classCounts",c);return d.join(" ")}function k(b){if(!0===a||f.$index%2===a){var k=e(b||[]);if(!m){var u=l(k,1);h.$addClass(u)}else if(!fa(b,
m)){var r=e(m),u=d(k,r),k=d(r,k),u=l(u,1),k=l(k,-1);u&&u.length&&c.addClass(g,u);k&&k.length&&c.removeClass(g,k)}}m=ra(b)}var m;f.$watch(h[b],k,!0);h.$observe("class",function(a){k(f.$eval(h[b]))});"ngClass"!==b&&f.$watch("$index",function(c,d){var g=c&1;if(g!==(d&1)){var k=e(f.$eval(h[b]));g===a?(g=l(k,1),h.$addClass(g)):(g=l(k,-1),h.$removeClass(g))}})}}}]}function sd(b){function a(a,b){b&&!f[a]?(k.addClass(e,a),f[a]=!0):!b&&f[a]&&(k.removeClass(e,a),f[a]=!1)}function c(b,c){b=b?"-"+tc(b,"-"):"";
a(kb+b,!0===c);a(vd+b,!1===c)}var d=b.ctrl,e=b.$element,f={},g=b.set,h=b.unset,l=b.parentForm,k=b.$animate;f[vd]=!(f[kb]=e.hasClass(kb));d.$setValidity=function(b,e,f){e===t?(d.$pending||(d.$pending={}),g(d.$pending,b,f)):(d.$pending&&h(d.$pending,b,f),wd(d.$pending)&&(d.$pending=t));Wa(e)?e?(h(d.$error,b,f),g(d.$$success,b,f)):(g(d.$error,b,f),h(d.$$success,b,f)):(h(d.$error,b,f),h(d.$$success,b,f));d.$pending?(a(xd,!0),d.$valid=d.$invalid=t,c("",null)):(a(xd,!1),d.$valid=wd(d.$error),d.$invalid=
!d.$valid,c("",d.$valid));e=d.$pending&&d.$pending[b]?t:d.$error[b]?!1:d.$$success[b]?!0:null;c(b,e);l.$setValidity(b,e,d)}}function wd(b){if(b)for(var a in b)return!1;return!0}var Of=/^\/(.+)\/([a-z]*)$/,Q=function(b){return F(b)?b.toLowerCase():b},rc=Object.prototype.hasOwnProperty,ub=function(b){return F(b)?b.toUpperCase():b},Ra,B,sa,Za=[].slice,rf=[].splice,Pf=[].push,Da=Object.prototype.toString,Ka=T("ng"),ga=M.angular||(M.angular={}),bb,nb=0;Ra=Y.documentMode;H.$inject=[];pa.$inject=[];var D=
Array.isArray,U=function(b){return F(b)?b.trim():b},gd=function(b){return b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},ab=function(){if(y(ab.isActive_))return ab.isActive_;var b=!(!Y.querySelector("[ng-csp]")&&!Y.querySelector("[data-ng-csp]"));if(!b)try{new Function("")}catch(a){b=!0}return ab.isActive_=b},rb=["ng-","data-ng-","ng:","x-ng-"],Md=/[A-Z]/g,uc=!1,Pb,oa=1,pb=3,Qd={full:"1.3.9",major:1,minor:3,dot:9,codeName:"multidimensional-awareness"};R.expando="ng339";
var zb=R.cache={},hf=1;R._data=function(b){return this.cache[b[this.expando]]||{}};var cf=/([\:\-\_]+(.))/g,df=/^moz([A-Z])/,Qf={mouseleave:"mouseout",mouseenter:"mouseover"},Sb=T("jqLite"),gf=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Rb=/<|&#?\w+;/,ef=/<([\w:]+)/,ff=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ia={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],
td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ia.optgroup=ia.option;ia.tbody=ia.tfoot=ia.colgroup=ia.caption=ia.thead;ia.th=ia.td;var La=R.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===Y.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),R(M).on("load",a))},toString:function(){var b=[];s(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?B(this[b]):B(this[this.length+b])},length:0,push:Pf,sort:[].sort,
splice:[].splice},Eb={};s("multiple selected checked disabled readOnly required open".split(" "),function(b){Eb[Q(b)]=b});var Mc={};s("input select option textarea button form details".split(" "),function(b){Mc[b]=!0});var Nc={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};s({data:Ub,removeData:xb},function(b,a){R[a]=b});s({data:Ub,inheritedData:Db,scope:function(b){return B.data(b,"$scope")||Db(b.parentNode||b,["$isolateScope","$scope"])},isolateScope:function(b){return B.data(b,
"$isolateScope")||B.data(b,"$isolateScopeNoTemplate")},controller:Ic,injector:function(b){return Db(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Ab,css:function(b,a,c){a=cb(a);if(y(c))b.style[a]=c;else return b.style[a]},attr:function(b,a,c){var d=Q(a);if(Eb[d])if(y(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));else return b[a]||(b.attributes.getNamedItem(a)||H).specified?d:t;else if(y(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,
2),null===b?t:b},prop:function(b,a,c){if(y(c))b[a]=c;else return b[a]},text:function(){function b(a,b){if(A(b)){var d=a.nodeType;return d===oa||d===pb?a.textContent:""}a.textContent=b}b.$dv="";return b}(),val:function(b,a){if(A(a)){if(b.multiple&&"select"===ua(b)){var c=[];s(b.options,function(a){a.selected&&c.push(a.value||a.text)});return 0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(A(a))return b.innerHTML;wb(b,!0);b.innerHTML=a},empty:Jc},function(b,a){R.prototype[a]=function(a,
d){var e,f,g=this.length;if(b!==Jc&&(2==b.length&&b!==Ab&&b!==Ic?a:d)===t){if(I(a)){for(e=0;e<g;e++)if(b===Ub)b(this[e],a);else for(f in a)b(this[e],f,a[f]);return this}e=b.$dv;g=e===t?Math.min(g,1):g;for(f=0;f<g;f++){var h=b(this[f],a,d);e=e?e+h:h}return e}for(e=0;e<g;e++)b(this[e],a,d);return this}});s({removeData:xb,on:function a(c,d,e,f){if(y(f))throw Sb("onargs");if(Ec(c)){var g=yb(c,!0);f=g.events;var h=g.handle;h||(h=g.handle=lf(c,f));for(var g=0<=d.indexOf(" ")?d.split(" "):[d],l=g.length;l--;){d=
g[l];var k=f[d];k||(f[d]=[],"mouseenter"===d||"mouseleave"===d?a(c,Qf[d],function(a){var c=a.relatedTarget;c&&(c===this||this.contains(c))||h(a,d)}):"$destroy"!==d&&c.addEventListener(d,h,!1),k=f[d]);k.push(e)}}},off:Hc,one:function(a,c,d){a=B(a);a.on(c,function f(){a.off(c,d);a.off(c,f)});a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;wb(a);s(new R(c),function(c){d?e.insertBefore(c,d.nextSibling):e.replaceChild(c,a);d=c})},children:function(a){var c=[];s(a.childNodes,function(a){a.nodeType===
oa&&c.push(a)});return c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){var d=a.nodeType;if(d===oa||11===d){c=new R(c);for(var d=0,e=c.length;d<e;d++)a.appendChild(c[d])}},prepend:function(a,c){if(a.nodeType===oa){var d=a.firstChild;s(new R(c),function(c){a.insertBefore(c,d)})}},wrap:function(a,c){c=B(c).eq(0).clone()[0];var d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:Kc,detach:function(a){Kc(a,!0)},after:function(a,c){var d=a,e=a.parentNode;
c=new R(c);for(var f=0,g=c.length;f<g;f++){var h=c[f];e.insertBefore(h,d.nextSibling);d=h}},addClass:Cb,removeClass:Bb,toggleClass:function(a,c,d){c&&s(c.split(" "),function(c){var f=d;A(f)&&(f=!Ab(a,c));(f?Cb:Bb)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){return a.nextElementSibling},find:function(a,c){return a.getElementsByTagName?a.getElementsByTagName(c):[]},clone:Tb,triggerHandler:function(a,c,d){var e,f,g=c.type||c,h=yb(a);if(h=(h=h&&h.events)&&
h[g])e={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:H,type:g,target:a},c.type&&(e=z(e,c)),c=ra(h),f=d?[e].concat(d):[e],s(c,function(c){e.isImmediatePropagationStopped()||c.apply(a,f)})}},function(a,c){R.prototype[c]=function(c,e,f){for(var g,h=0,l=this.length;h<
l;h++)A(g)?(g=a(this[h],c,e,f),y(g)&&(g=B(g))):Gc(g,a(this[h],c,e,f));return y(g)?g:this};R.prototype.bind=R.prototype.on;R.prototype.unbind=R.prototype.off});db.prototype={put:function(a,c){this[Na(a,this.nextUid)]=c},get:function(a){return this[Na(a,this.nextUid)]},remove:function(a){var c=this[a=Na(a,this.nextUid)];delete this[a];return c}};var Pc=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,nf=/,/,of=/^\s*(_?)(\S+?)\1\s*$/,Oc=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Ga=T("$injector");Ob.$$annotate=Vb;var Rf=
T("$animate"),Ce=["$provide",function(a){this.$$selectors={};this.register=function(c,d){var e=c+"-animation";if(c&&"."!=c.charAt(0))throw Rf("notcsel",c);this.$$selectors[c.substr(1)]=e;a.factory(e,d)};this.classNameFilter=function(a){1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null);return this.$$classNameFilter};this.$get=["$$q","$$asyncCallback","$rootScope",function(a,d,e){function f(d){var f,g=a.defer();g.promise.$$cancelFn=function(){f&&f()};e.$$postDigest(function(){f=
d(function(){g.resolve()})});return g.promise}function g(a,c){var d=[],e=[],f=ha();s((a.attr("class")||"").split(/\s+/),function(a){f[a]=!0});s(c,function(a,c){var g=f[c];!1===a&&g?e.push(c):!0!==a||g||d.push(c)});return 0<d.length+e.length&&[d.length?d:null,e.length?e:null]}function h(a,c,d){for(var e=0,f=c.length;e<f;++e)a[c[e]]=d}function l(){m||(m=a.defer(),d(function(){m.resolve();m=null}));return m.promise}function k(a,c){if(ga.isObject(c)){var d=z(c.from||{},c.to||{});a.css(d)}}var m;return{animate:function(a,
c,d){k(a,{from:c,to:d});return l()},enter:function(a,c,d,e){k(a,e);d?d.after(a):c.prepend(a);return l()},leave:function(a,c){a.remove();return l()},move:function(a,c,d,e){return this.enter(a,c,d,e)},addClass:function(a,c,d){return this.setClass(a,c,[],d)},$$addClassImmediately:function(a,c,d){a=B(a);c=F(c)?c:D(c)?c.join(" "):"";s(a,function(a){Cb(a,c)});k(a,d);return l()},removeClass:function(a,c,d){return this.setClass(a,[],c,d)},$$removeClassImmediately:function(a,c,d){a=B(a);c=F(c)?c:D(c)?c.join(" "):
"";s(a,function(a){Bb(a,c)});k(a,d);return l()},setClass:function(a,c,d,e){var k=this,l=!1;a=B(a);var m=a.data("$$animateClasses");m?e&&m.options&&(m.options=ga.extend(m.options||{},e)):(m={classes:{},options:e},l=!0);e=m.classes;c=D(c)?c:c.split(" ");d=D(d)?d:d.split(" ");h(e,c,!0);h(e,d,!1);l&&(m.promise=f(function(c){var d=a.data("$$animateClasses");a.removeData("$$animateClasses");if(d){var e=g(a,d.classes);e&&k.$$setClassImmediately(a,e[0],e[1],d.options)}c()}),a.data("$$animateClasses",m));
return m.promise},$$setClassImmediately:function(a,c,d,e){c&&this.$$addClassImmediately(a,c);d&&this.$$removeClassImmediately(a,d);k(a,e);return l()},enabled:H,cancel:H}}]}],ja=T("$compile");wc.$inject=["$provide","$$sanitizeUriProvider"];var Rc=/^((?:x|data)[\:\-_])/i,Vc="application/json",Zb={"Content-Type":Vc+";charset=utf-8"},tf=/^\[|^\{(?!\{)/,uf={"[":/]$/,"{":/}$/},sf=/^\)\]\}',?\n/,$b=T("$interpolate"),Sf=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,xf={http:80,https:443,ftp:21},Fb=T("$location"),Tf=
{$$html5:!1,$$replace:!1,absUrl:Gb("$$absUrl"),url:function(a){if(A(a))return this.$$url;var c=Sf.exec(a);(c[1]||""===a)&&this.path(decodeURIComponent(c[1]));(c[2]||c[1]||""===a)&&this.search(c[3]||"");this.hash(c[5]||"");return this},protocol:Gb("$$protocol"),host:Gb("$$host"),port:Gb("$$port"),path:dd("$$path",function(a){a=null!==a?a.toString():"";return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;case 1:if(F(a)||V(a))a=a.toString(),this.$$search=
qc(a);else if(I(a))a=Ea(a,{}),s(a,function(c,e){null==c&&delete a[e]}),this.$$search=a;else throw Fb("isrcharg");break;default:A(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}this.$$compose();return this},hash:dd("$$hash",function(a){return null!==a?a.toString():""}),replace:function(){this.$$replace=!0;return this}};s([cd,dc,cc],function(a){a.prototype=Object.create(Tf);a.prototype.state=function(c){if(!arguments.length)return this.$$state;if(a!==cc||!this.$$html5)throw Fb("nostate");this.$$state=
A(c)?null:c;return this}});var la=T("$parse"),Uf=Function.prototype.call,Vf=Function.prototype.apply,Wf=Function.prototype.bind,lb=ha();s({"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:function(){}},function(a,c){a.constant=a.literal=a.sharedGetter=!0;lb[c]=a});lb["this"]=function(a){return a};lb["this"].sharedGetter=!0;var mb=z(ha(),{"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return y(d)?y(e)?d+e:d:y(e)?e:t},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);
return(y(d)?d:0)-(y(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,
d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"!":function(a,c,d){return!d(a,c)},"=":!0,"|":!0}),Xf={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},gc=function(a){this.options=a};gc.prototype={constructor:gc,lex:function(a){this.text=a;this.index=0;for(this.tokens=[];this.index<this.text.length;)if(a=this.text.charAt(this.index),'"'===a||"'"===a)this.readString(a);else if(this.isNumber(a)||"."===a&&this.isNumber(this.peek()))this.readNumber();
else if(this.isIdent(a))this.readIdent();else if(this.is(a,"(){}[].,;:?"))this.tokens.push({index:this.index,text:a}),this.index++;else if(this.isWhitespace(a))this.index++;else{var c=a+this.peek(),d=c+this.peek(2),e=mb[c],f=mb[d];mb[a]||e||f?(a=f?d:e?c:a,this.tokens.push({index:this.index,text:a,operator:!0}),this.index+=a.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(a,c){return-1!==c.indexOf(a)},peek:function(a){a=a||1;return this.index+
a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a&&"string"===typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;c=y(c)?"s "+c+"-"+this.index+" ["+this.text.substring(c,d)+"]":" "+d;throw la("lexerr",a,c,this.text);
},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=Q(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}this.tokens.push({index:c,text:a,constant:!0,value:Number(a)})},readIdent:function(){for(var a=
this.index;this.index<this.text.length;){var c=this.text.charAt(this.index);if(!this.isIdent(c)&&!this.isNumber(c))break;this.index++}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var c=this.index;this.index++;for(var d="",e=a,f=!1;this.index<this.text.length;){var g=this.text.charAt(this.index),e=e+g;if(f)"u"===g?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=
4,d+=String.fromCharCode(parseInt(f,16))):d+=Xf[g]||g,f=!1;else if("\\"===g)f=!0;else{if(g===a){this.index++;this.tokens.push({index:c,text:e,constant:!0,value:d});return}d+=g}this.index++}this.throwError("Unterminated quote",c)}};var hb=function(a,c,d){this.lexer=a;this.$filter=c;this.options=d};hb.ZERO=z(function(){return 0},{sharedGetter:!0,constant:!0});hb.prototype={constructor:hb,parse:function(a){this.text=a;this.tokens=this.lexer.lex(a);a=this.statements();0!==this.tokens.length&&this.throwError("is an unexpected token",
this.tokens[0]);a.literal=!!a.literal;a.constant=!!a.constant;return a},primary:function(){var a;this.expect("(")?(a=this.filterChain(),this.consume(")")):this.expect("[")?a=this.arrayDeclaration():this.expect("{")?a=this.object():this.peek().identifier&&this.peek().text in lb?a=lb[this.consume().text]:this.peek().identifier?a=this.identifier():this.peek().constant?a=this.constant():this.throwError("not a primary expression",this.peek());for(var c,d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,
d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,c){throw la("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index));},peekToken:function(){if(0===this.tokens.length)throw la("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){return this.peekAhead(0,a,c,d,e)},peekAhead:function(a,c,d,e,f){if(this.tokens.length>a){a=this.tokens[a];var g=a.text;if(g===c||g===d||g===e||g===
f||!(c||d||e||f))return a}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,e))?(this.tokens.shift(),a):!1},consume:function(a){if(0===this.tokens.length)throw la("ueoe",this.text);var c=this.expect(a);c||this.throwError("is unexpected, expecting ["+a+"]",this.peek());return c},unaryFn:function(a,c){var d=mb[a];return z(function(a,f){return d(a,f,c)},{constant:c.constant,inputs:[c]})},binaryFn:function(a,c,d,e){var f=mb[c];return z(function(c,e){return f(c,e,a,d)},{constant:a.constant&&
d.constant,inputs:!e&&[a,d]})},identifier:function(){for(var a=this.consume().text;this.peek(".")&&this.peekAhead(1).identifier&&!this.peekAhead(2,"(");)a+=this.consume().text+this.consume().text;return zf(a,this.options,this.text)},constant:function(){var a=this.consume().value;return z(function(){return a},{constant:!0,literal:!0})},statements:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,
d){for(var e,f=0,g=a.length;f<g;f++)e=a[f](c,d);return e}},filterChain:function(){for(var a=this.expression();this.expect("|");)a=this.filter(a);return a},filter:function(a){var c=this.$filter(this.consume().text),d,e;if(this.peek(":"))for(d=[],e=[];this.expect(":");)d.push(this.expression());var f=[a].concat(d||[]);return z(function(f,h){var l=a(f,h);if(e){e[0]=l;for(l=d.length;l--;)e[l+1]=d[l](f,h);return c.apply(t,e)}return c(l)},{constant:!c.$stateful&&f.every(ec),inputs:!c.$stateful&&f})},expression:function(){return this.assignment()},
assignment:function(){var a=this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),z(function(d,f){return a.assign(d,c(d,f),f)},{inputs:[a,c]})):a},ternary:function(){var a=this.logicalOR(),c;if(this.expect("?")&&(c=this.assignment(),this.consume(":"))){var d=this.assignment();return z(function(e,f){return a(e,f)?c(e,f):d(e,f)},{constant:a.constant&&c.constant&&d.constant})}return a},
logicalOR:function(){for(var a=this.logicalAND(),c;c=this.expect("||");)a=this.binaryFn(a,c.text,this.logicalAND(),!0);return a},logicalAND:function(){for(var a=this.equality(),c;c=this.expect("&&");)a=this.binaryFn(a,c.text,this.equality(),!0);return a},equality:function(){for(var a=this.relational(),c;c=this.expect("==","!=","===","!==");)a=this.binaryFn(a,c.text,this.relational());return a},relational:function(){for(var a=this.additive(),c;c=this.expect("<",">","<=",">=");)a=this.binaryFn(a,c.text,
this.additive());return a},additive:function(){for(var a=this.multiplicative(),c;c=this.expect("+","-");)a=this.binaryFn(a,c.text,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.text,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(hb.ZERO,a.text,this.unary()):(a=this.expect("!"))?this.unaryFn(a.text,this.unary()):this.primary()},fieldAccess:function(a){var c=
this.identifier();return z(function(d,e,f){d=f||a(d,e);return null==d?t:c(d)},{assign:function(d,e,f){var g=a(d,f);g||a.assign(d,g={},f);return c.assign(g,e)}})},objectIndex:function(a){var c=this.text,d=this.expression();this.consume("]");return z(function(e,f){var g=a(e,f),h=d(e,f);ta(h,c);return g?ma(g[h],c):t},{assign:function(e,f,g){var h=ta(d(e,g),c),l=ma(a(e,g),c);l||a.assign(e,l={},g);return l[h]=f}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text){do d.push(this.expression());
while(this.expect(","))}this.consume(")");var e=this.text,f=d.length?[]:null;return function(g,h){var l=c?c(g,h):y(c)?t:g,k=a(g,h,l)||H;if(f)for(var m=d.length;m--;)f[m]=ma(d[m](g,h),e);ma(l,e);if(k){if(k.constructor===k)throw la("isecfn",e);if(k===Uf||k===Vf||k===Wf)throw la("isecff",e);}l=k.apply?k.apply(l,f):k(f[0],f[1],f[2],f[3],f[4]);return ma(l,e)}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text){do{if(this.peek("]"))break;a.push(this.expression())}while(this.expect(","))
}this.consume("]");return z(function(c,d){for(var e=[],f=0,g=a.length;f<g;f++)e.push(a[f](c,d));return e},{literal:!0,constant:a.every(ec),inputs:a})},object:function(){var a=[],c=[];if("}"!==this.peekToken().text){do{if(this.peek("}"))break;var d=this.consume();d.constant?a.push(d.value):d.identifier?a.push(d.text):this.throwError("invalid key",d);this.consume(":");c.push(this.expression())}while(this.expect(","))}this.consume("}");return z(function(d,f){for(var g={},h=0,l=c.length;h<l;h++)g[a[h]]=
c[h](d,f);return g},{literal:!0,constant:c.every(ec),inputs:c})}};var Bf=ha(),Af=ha(),Cf=Object.prototype.valueOf,Ca=T("$sce"),na={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},ja=T("$compile"),Z=Y.createElement("a"),id=Ba(M.location.href);Dc.$inject=["$provide"];jd.$inject=["$locale"];ld.$inject=["$locale"];var od=".",Mf={yyyy:$("FullYear",4),yy:$("FullYear",2,0,!0),y:$("FullYear",1),MMMM:Ib("Month"),MMM:Ib("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),dd:$("Date",2),d:$("Date",
1),HH:$("Hours",2),H:$("Hours",1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:Ib("Day"),EEE:Ib("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){a=-1*a.getTimezoneOffset();return a=(0<=a?"+":"")+(Hb(Math[0<a?"floor":"ceil"](a/60),2)+Hb(Math.abs(a%60),2))},ww:qd(2),w:qd(1)},Lf=/((?:[^yMdHhmsaZEw']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|w+))(.*)/,Kf=/^\-?\d+$/;
kd.$inject=["$locale"];var Hf=da(Q),If=da(ub);md.$inject=["$parse"];var Td=da({restrict:"E",compile:function(a,c){if(!c.href&&!c.xlinkHref&&!c.name)return function(a,c){var f="[object SVGAnimatedString]"===Da.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(f)||a.preventDefault()})}}}),vb={};s(Eb,function(a,c){if("multiple"!=a){var d=ya("ng-"+c);vb[d]=function(){return{restrict:"A",priority:100,link:function(a,f,g){a.$watch(g[d],function(a){g.$set(c,!!a)})}}}}});s(Nc,function(a,
c){vb[c]=function(){return{priority:100,link:function(a,e,f){if("ngPattern"===c&&"/"==f.ngPattern.charAt(0)&&(e=f.ngPattern.match(Of))){f.$set("ngPattern",new RegExp(e[1],e[2]));return}a.$watch(f[c],function(a){f.$set(c,a)})}}}});s(["src","srcset","href"],function(a){var c=ya("ng-"+a);vb[c]=function(){return{priority:99,link:function(d,e,f){var g=a,h=a;"href"===a&&"[object SVGAnimatedString]"===Da.call(e.prop("href"))&&(h="xlinkHref",f.$attr[h]="xlink:href",g=null);f.$observe(c,function(c){c?(f.$set(h,
c),Ra&&g&&e.prop(g,f[h])):"href"===a&&f.$set(h,null)})}}}});var Jb={$addControl:H,$$renameControl:function(a,c){a.$name=c},$removeControl:H,$setValidity:H,$setDirty:H,$setPristine:H,$setSubmitted:H};rd.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var yd=function(a){return["$timeout",function(c){return{name:"form",restrict:a?"EAC":"E",controller:rd,compile:function(a){a.addClass(Sa).addClass(kb);return{pre:function(a,d,g,h){if(!("action"in g)){var l=function(c){a.$apply(function(){h.$commitViewValue();
h.$setSubmitted()});c.preventDefault()};d[0].addEventListener("submit",l,!1);d.on("$destroy",function(){c(function(){d[0].removeEventListener("submit",l,!1)},0,!1)})}var k=h.$$parentForm,m=h.$name;m&&(gb(a,null,m,h,m),g.$observe(g.name?"name":"ngForm",function(c){m!==c&&(gb(a,null,m,t,m),m=c,gb(a,null,m,h,m),k.$$renameControl(h,m))}));d.on("$destroy",function(){k.$removeControl(h);m&&gb(a,null,m,t,m);z(h,Jb)})}}}}}]},Ud=yd(),ge=yd(!0),Nf=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,
Yf=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Zf=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,$f=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,zd=/^(\d{4})-(\d{2})-(\d{2})$/,Ad=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,jc=/^(\d{4})-W(\d\d)$/,Bd=/^(\d{4})-(\d\d)$/,Cd=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Dd={text:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e)},date:jb("date",zd,Lb(zd,["yyyy",
"MM","dd"]),"yyyy-MM-dd"),"datetime-local":jb("datetimelocal",Ad,Lb(Ad,"yyyy MM dd HH mm ss sss".split(" ")),"yyyy-MM-ddTHH:mm:ss.sss"),time:jb("time",Cd,Lb(Cd,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:jb("week",jc,function(a,c){if(qa(a))return a;if(F(a)){jc.lastIndex=0;var d=jc.exec(a);if(d){var e=+d[1],f=+d[2],g=d=0,h=0,l=0,k=pd(e),f=7*(f-1);c&&(d=c.getHours(),g=c.getMinutes(),h=c.getSeconds(),l=c.getMilliseconds());return new Date(e,0,k.getDate()+f,d,g,h,l)}}return NaN},"yyyy-Www"),month:jb("month",
Bd,Lb(Bd,["yyyy","MM"]),"yyyy-MM"),number:function(a,c,d,e,f,g){td(a,c,d,e);ib(a,c,d,e,f,g);e.$$parserName="number";e.$parsers.push(function(a){return e.$isEmpty(a)?null:$f.test(a)?parseFloat(a):t});e.$formatters.push(function(a){if(!e.$isEmpty(a)){if(!V(a))throw Mb("numfmt",a);a=a.toString()}return a});if(d.min||d.ngMin){var h;e.$validators.min=function(a){return e.$isEmpty(a)||A(h)||a>=h};d.$observe("min",function(a){y(a)&&!V(a)&&(a=parseFloat(a,10));h=V(a)&&!isNaN(a)?a:t;e.$validate()})}if(d.max||
d.ngMax){var l;e.$validators.max=function(a){return e.$isEmpty(a)||A(l)||a<=l};d.$observe("max",function(a){y(a)&&!V(a)&&(a=parseFloat(a,10));l=V(a)&&!isNaN(a)?a:t;e.$validate()})}},url:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e);e.$$parserName="url";e.$validators.url=function(a,c){var d=a||c;return e.$isEmpty(d)||Yf.test(d)}},email:function(a,c,d,e,f,g){ib(a,c,d,e,f,g);hc(e);e.$$parserName="email";e.$validators.email=function(a,c){var d=a||c;return e.$isEmpty(d)||Zf.test(d)}},radio:function(a,c,
d,e){A(d.name)&&c.attr("name",++nb);c.on("click",function(a){c[0].checked&&e.$setViewValue(d.value,a&&a.type)});e.$render=function(){c[0].checked=d.value==e.$viewValue};d.$observe("value",e.$render)},checkbox:function(a,c,d,e,f,g,h,l){var k=ud(l,a,"ngTrueValue",d.ngTrueValue,!0),m=ud(l,a,"ngFalseValue",d.ngFalseValue,!1);c.on("click",function(a){e.$setViewValue(c[0].checked,a&&a.type)});e.$render=function(){c[0].checked=e.$viewValue};e.$isEmpty=function(a){return!1===a};e.$formatters.push(function(a){return fa(a,
k)});e.$parsers.push(function(a){return a?k:m})},hidden:H,button:H,submit:H,reset:H,file:H},xc=["$browser","$sniffer","$filter","$parse",function(a,c,d,e){return{restrict:"E",require:["?ngModel"],link:{pre:function(f,g,h,l){l[0]&&(Dd[Q(h.type)]||Dd.text)(f,g,h,l[0],c,a,d,e)}}}}],ag=/^(true|false|\d+)$/,ye=function(){return{restrict:"A",priority:100,compile:function(a,c){return ag.test(c.ngValue)?function(a,c,f){f.$set("value",a.$eval(f.ngValue))}:function(a,c,f){a.$watch(f.ngValue,function(a){f.$set("value",
a)})}}}},Zd=["$compile",function(a){return{restrict:"AC",compile:function(c){a.$$addBindingClass(c);return function(c,e,f){a.$$addBindingInfo(e,f.ngBind);e=e[0];c.$watch(f.ngBind,function(a){e.textContent=a===t?"":a})}}}}],ae=["$interpolate","$compile",function(a,c){return{compile:function(d){c.$$addBindingClass(d);return function(d,f,g){d=a(f.attr(g.$attr.ngBindTemplate));c.$$addBindingInfo(f,d.expressions);f=f[0];g.$observe("ngBindTemplate",function(a){f.textContent=a===t?"":a})}}}}],$d=["$sce",
"$parse","$compile",function(a,c,d){return{restrict:"A",compile:function(e,f){var g=c(f.ngBindHtml),h=c(f.ngBindHtml,function(a){return(a||"").toString()});d.$$addBindingClass(e);return function(c,e,f){d.$$addBindingInfo(e,f.ngBindHtml);c.$watch(h,function(){e.html(a.getTrustedHtml(g(c))||"")})}}}}],xe=da({restrict:"A",require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),be=ic("",!0),de=ic("Odd",0),ce=ic("Even",1),ee=Ja({compile:function(a,c){c.$set("ngCloak",
t);a.removeClass("ng-cloak")}}),fe=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],Cc={},bg={blur:!0,focus:!0};s("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(a){var c=ya("ng-"+a);Cc[c]=["$parse","$rootScope",function(d,e){return{restrict:"A",compile:function(f,g){var h=d(g[c],null,!0);return function(c,d){d.on(a,function(d){var f=function(){h(c,{$event:d})};
bg[a]&&e.$$phase?c.$evalAsync(f):c.$apply(f)})}}}}]});var ie=["$animate",function(a){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var h,l,k;c.$watch(e.ngIf,function(c){c?l||g(function(c,f){l=f;c[c.length++]=Y.createComment(" end ngIf: "+e.ngIf+" ");h={clone:c};a.enter(c,d.parent(),d)}):(k&&(k.remove(),k=null),l&&(l.$destroy(),l=null),h&&(k=tb(h.clone),a.leave(k).then(function(){k=null}),h=null))})}}}],je=["$templateRequest","$anchorScroll",
"$animate","$sce",function(a,c,d,e){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:ga.noop,compile:function(f,g){var h=g.ngInclude||g.src,l=g.onload||"",k=g.autoscroll;return function(f,g,q,s,r){var t=0,n,v,w,L=function(){v&&(v.remove(),v=null);n&&(n.$destroy(),n=null);w&&(d.leave(w).then(function(){v=null}),v=w,w=null)};f.$watch(e.parseAsResourceUrl(h),function(e){var h=function(){!y(k)||k&&!f.$eval(k)||c()},q=++t;e?(a(e,!0).then(function(a){if(q===t){var c=f.$new();
s.template=a;a=r(c,function(a){L();d.enter(a,null,g).then(h)});n=c;w=a;n.$emit("$includeContentLoaded",e);f.$eval(l)}},function(){q===t&&(L(),f.$emit("$includeContentError",e))}),f.$emit("$includeContentRequested",e)):(L(),s.template=null)})}}}}],Ae=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(c,d,e,f){/SVG/.test(d[0].toString())?(d.empty(),a(Fc(f.template,Y).childNodes)(c,function(a){d.append(a)},{futureParentElement:d})):(d.html(f.template),a(d.contents())(c))}}}],
ke=Ja({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),we=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(a,c,d,e){var f=c.attr(d.$attr.ngList)||", ",g="false"!==d.ngTrim,h=g?U(f):f;e.$parsers.push(function(a){if(!A(a)){var c=[];a&&s(a.split(h),function(a){a&&c.push(g?U(a):a)});return c}});e.$formatters.push(function(a){return D(a)?a.join(f):t});e.$isEmpty=function(a){return!a||!a.length}}}},kb="ng-valid",vd="ng-invalid",Sa="ng-pristine",
Kb="ng-dirty",xd="ng-pending",Mb=new T("ngModel"),cg=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(a,c,d,e,f,g,h,l,k,m){this.$modelValue=this.$viewValue=Number.NaN;this.$$rawModelValue=t;this.$validators={};this.$asyncValidators={};this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$untouched=!0;this.$touched=!1;this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$error={};this.$$success=
{};this.$pending=t;this.$name=m(d.name||"",!1)(a);var p=f(d.ngModel),q=p.assign,u=p,r=q,O=null,n=this;this.$$setOptions=function(a){if((n.$options=a)&&a.getterSetter){var c=f(d.ngModel+"()"),g=f(d.ngModel+"($$$p)");u=function(a){var d=p(a);G(d)&&(d=c(a));return d};r=function(a,c){G(p(a))?g(a,{$$$p:n.$modelValue}):q(a,n.$modelValue)}}else if(!p.assign)throw Mb("nonassign",d.ngModel,va(e));};this.$render=H;this.$isEmpty=function(a){return A(a)||""===a||null===a||a!==a};var v=e.inheritedData("$formController")||
Jb,w=0;sd({ctrl:this,$element:e,set:function(a,c){a[c]=!0},unset:function(a,c){delete a[c]},parentForm:v,$animate:g});this.$setPristine=function(){n.$dirty=!1;n.$pristine=!0;g.removeClass(e,Kb);g.addClass(e,Sa)};this.$setDirty=function(){n.$dirty=!0;n.$pristine=!1;g.removeClass(e,Sa);g.addClass(e,Kb);v.$setDirty()};this.$setUntouched=function(){n.$touched=!1;n.$untouched=!0;g.setClass(e,"ng-untouched","ng-touched")};this.$setTouched=function(){n.$touched=!0;n.$untouched=!1;g.setClass(e,"ng-touched",
"ng-untouched")};this.$rollbackViewValue=function(){h.cancel(O);n.$viewValue=n.$$lastCommittedViewValue;n.$render()};this.$validate=function(){if(!V(n.$modelValue)||!isNaN(n.$modelValue)){var a=n.$$rawModelValue,c=n.$valid,d=n.$modelValue,e=n.$options&&n.$options.allowInvalid;n.$$runValidators(n.$error[n.$$parserName||"parse"]?!1:t,a,n.$$lastCommittedViewValue,function(f){e||c===f||(n.$modelValue=f?a:t,n.$modelValue!==d&&n.$$writeModelToScope())})}};this.$$runValidators=function(a,c,d,e){function f(){var a=
!0;s(n.$validators,function(e,f){var g=e(c,d);a=a&&g;h(f,g)});return a?!0:(s(n.$asyncValidators,function(a,c){h(c,null)}),!1)}function g(){var a=[],e=!0;s(n.$asyncValidators,function(f,g){var l=f(c,d);if(!l||!G(l.then))throw Mb("$asyncValidators",l);h(g,t);a.push(l.then(function(){h(g,!0)},function(a){e=!1;h(g,!1)}))});a.length?k.all(a).then(function(){l(e)},H):l(!0)}function h(a,c){m===w&&n.$setValidity(a,c)}function l(a){m===w&&e(a)}w++;var m=w;(function(a){var c=n.$$parserName||"parse";if(a===
t)h(c,null);else if(h(c,a),!a)return s(n.$validators,function(a,c){h(c,null)}),s(n.$asyncValidators,function(a,c){h(c,null)}),!1;return!0})(a)?f()?g():l(!1):l(!1)};this.$commitViewValue=function(){var a=n.$viewValue;h.cancel(O);if(n.$$lastCommittedViewValue!==a||""===a&&n.$$hasNativeValidators)n.$$lastCommittedViewValue=a,n.$pristine&&this.$setDirty(),this.$$parseAndValidate()};this.$$parseAndValidate=function(){var c=n.$$lastCommittedViewValue,d=A(c)?t:!0;if(d)for(var e=0;e<n.$parsers.length;e++)if(c=
n.$parsers[e](c),A(c)){d=!1;break}V(n.$modelValue)&&isNaN(n.$modelValue)&&(n.$modelValue=u(a));var f=n.$modelValue,g=n.$options&&n.$options.allowInvalid;n.$$rawModelValue=c;g&&(n.$modelValue=c,n.$modelValue!==f&&n.$$writeModelToScope());n.$$runValidators(d,c,n.$$lastCommittedViewValue,function(a){g||(n.$modelValue=a?c:t,n.$modelValue!==f&&n.$$writeModelToScope())})};this.$$writeModelToScope=function(){r(a,n.$modelValue);s(n.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}})};this.$setViewValue=
function(a,c){n.$viewValue=a;n.$options&&!n.$options.updateOnDefault||n.$$debounceViewValueCommit(c)};this.$$debounceViewValueCommit=function(c){var d=0,e=n.$options;e&&y(e.debounce)&&(e=e.debounce,V(e)?d=e:V(e[c])?d=e[c]:V(e["default"])&&(d=e["default"]));h.cancel(O);d?O=h(function(){n.$commitViewValue()},d):l.$$phase?n.$commitViewValue():a.$apply(function(){n.$commitViewValue()})};a.$watch(function(){var c=u(a);if(c!==n.$modelValue){n.$modelValue=n.$$rawModelValue=c;for(var d=n.$formatters,e=d.length,
f=c;e--;)f=d[e](f);n.$viewValue!==f&&(n.$viewValue=n.$$lastCommittedViewValue=f,n.$render(),n.$$runValidators(t,c,f,H))}return c})}],ve=["$rootScope",function(a){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:cg,priority:1,compile:function(c){c.addClass(Sa).addClass("ng-untouched").addClass(kb);return{pre:function(a,c,f,g){var h=g[0],l=g[1]||Jb;h.$$setOptions(g[2]&&g[2].$options);l.$addControl(h);f.$observe("name",function(a){h.$name!==a&&l.$$renameControl(h,a)});a.$on("$destroy",
function(){l.$removeControl(h)})},post:function(c,e,f,g){var h=g[0];if(h.$options&&h.$options.updateOn)e.on(h.$options.updateOn,function(a){h.$$debounceViewValueCommit(a&&a.type)});e.on("blur",function(e){h.$touched||(a.$$phase?c.$evalAsync(h.$setTouched):c.$apply(h.$setTouched))})}}}}}],dg=/(\s+|^)default(\s+|$)/,ze=function(){return{restrict:"A",controller:["$scope","$attrs",function(a,c){var d=this;this.$options=a.$eval(c.ngModelOptions);this.$options.updateOn!==t?(this.$options.updateOnDefault=
!1,this.$options.updateOn=U(this.$options.updateOn.replace(dg,function(){d.$options.updateOnDefault=!0;return" "}))):this.$options.updateOnDefault=!0}]}},le=Ja({terminal:!0,priority:1E3}),me=["$locale","$interpolate",function(a,c){var d=/{}/g,e=/^when(Minus)?(.+)$/;return{restrict:"EA",link:function(f,g,h){function l(a){g.text(a||"")}var k=h.count,m=h.$attr.when&&g.attr(h.$attr.when),p=h.offset||0,q=f.$eval(m)||{},u={},m=c.startSymbol(),r=c.endSymbol(),t=m+k+"-"+p+r,n=ga.noop,v;s(h,function(a,c){var d=
e.exec(c);d&&(d=(d[1]?"-":"")+Q(d[2]),q[d]=g.attr(h.$attr[c]))});s(q,function(a,e){u[e]=c(a.replace(d,t))});f.$watch(k,function(c){c=parseFloat(c);var d=isNaN(c);d||c in q||(c=a.pluralCat(c-p));c===v||d&&isNaN(v)||(n(),n=f.$watch(u[c],l),v=c)})}}}],ne=["$parse","$animate",function(a,c){var d=T("ngRepeat"),e=function(a,c,d,e,k,m,p){a[d]=e;k&&(a[k]=m);a.$index=c;a.$first=0===c;a.$last=c===p-1;a.$middle=!(a.$first||a.$last);a.$odd=!(a.$even=0===(c&1))};return{restrict:"A",multiElement:!0,transclude:"element",
priority:1E3,terminal:!0,$$tlb:!0,compile:function(f,g){var h=g.ngRepeat,l=Y.createComment(" end ngRepeat: "+h+" "),k=h.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!k)throw d("iexp",h);var m=k[1],p=k[2],q=k[3],u=k[4],k=m.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/);if(!k)throw d("iidexp",m);var r=k[3]||k[1],y=k[2];if(q&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(q)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent)$/.test(q)))throw d("badident",
q);var n,v,w,A,z={$id:Na};u?n=a(u):(w=function(a,c){return Na(c)},A=function(a){return a});return function(a,f,g,k,m){n&&(v=function(c,d,e){y&&(z[y]=c);z[r]=d;z.$index=e;return n(a,z)});var u=ha();a.$watchCollection(p,function(g){var k,p,n=f[0],E,z=ha(),H,S,N,D,G,C,I;q&&(a[q]=g);if(Ta(g))G=g,p=v||w;else{p=v||A;G=[];for(I in g)g.hasOwnProperty(I)&&"$"!=I.charAt(0)&&G.push(I);G.sort()}H=G.length;I=Array(H);for(k=0;k<H;k++)if(S=g===G?k:G[k],N=g[S],D=p(S,N,k),u[D])C=u[D],delete u[D],z[D]=C,I[k]=C;else{if(z[D])throw s(I,
function(a){a&&a.scope&&(u[a.id]=a)}),d("dupes",h,D,N);I[k]={id:D,scope:t,clone:t};z[D]=!0}for(E in u){C=u[E];D=tb(C.clone);c.leave(D);if(D[0].parentNode)for(k=0,p=D.length;k<p;k++)D[k].$$NG_REMOVED=!0;C.scope.$destroy()}for(k=0;k<H;k++)if(S=g===G?k:G[k],N=g[S],C=I[k],C.scope){E=n;do E=E.nextSibling;while(E&&E.$$NG_REMOVED);C.clone[0]!=E&&c.move(tb(C.clone),null,B(n));n=C.clone[C.clone.length-1];e(C.scope,k,r,N,y,S,H)}else m(function(a,d){C.scope=d;var f=l.cloneNode(!1);a[a.length++]=f;c.enter(a,
null,B(n));n=f;C.clone=a;z[C.id]=C;e(C.scope,k,r,N,y,S,H)});u=z})}}}}],oe=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(c,d,e){c.$watch(e.ngShow,function(c){a[c?"removeClass":"addClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],he=["$animate",function(a){return{restrict:"A",multiElement:!0,link:function(c,d,e){c.$watch(e.ngHide,function(c){a[c?"addClass":"removeClass"](d,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],pe=Ja(function(a,c,d){a.$watchCollection(d.ngStyle,
function(a,d){d&&a!==d&&s(d,function(a,d){c.css(d,"")});a&&c.css(a)})}),qe=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,f){var g=[],h=[],l=[],k=[],m=function(a,c){return function(){a.splice(c,1)}};c.$watch(e.ngSwitch||e.on,function(c){var d,e;d=0;for(e=l.length;d<e;++d)a.cancel(l[d]);d=l.length=0;for(e=k.length;d<e;++d){var r=tb(h[d].clone);k[d].$destroy();(l[d]=a.leave(r)).then(m(l,d))}h.length=0;k.length=0;(g=
f.cases["!"+c]||f.cases["?"])&&s(g,function(c){c.transclude(function(d,e){k.push(e);var f=c.element;d[d.length++]=Y.createComment(" end ngSwitchWhen: ");h.push({clone:d});a.enter(d,f.parent(),f)})})})}}}],re=Ja({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(a,c,d,e,f){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:f,element:c})}}),se=Ja({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,
link:function(a,c,d,e,f){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:f,element:c})}}),ue=Ja({restrict:"EAC",link:function(a,c,d,e,f){if(!f)throw T("ngTransclude")("orphan",va(c));f(function(a){c.empty();c.append(a)})}}),Vd=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],eg=T("ngOptions"),te=da({restrict:"A",terminal:!0}),Wd=["$compile","$parse",function(a,c){var d=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,
e={$setViewValue:H};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var l=this,k={},m=e,p;l.databound=d.ngModel;l.init=function(a,c,d){m=a;p=d};l.addOption=function(c,d){Ma(c,'"option value"');k[c]=!0;m.$viewValue==c&&(a.val(c),p.parent()&&p.remove());d&&d[0].hasAttribute("selected")&&(d[0].selected=!0)};l.removeOption=function(a){this.hasOption(a)&&(delete k[a],m.$viewValue===a&&this.renderUnknownOption(a))};l.renderUnknownOption=function(c){c=
"? "+Na(c)+" ?";p.val(c);a.prepend(p);a.val(c);p.prop("selected",!0)};l.hasOption=function(a){return k.hasOwnProperty(a)};c.$on("$destroy",function(){l.renderUnknownOption=H})}],link:function(e,g,h,l){function k(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(C.parent()&&C.remove(),c.val(a),""===a&&n.prop("selected",!0)):A(a)&&n?c.val(""):e.renderUnknownOption(a)};c.on("change",function(){a.$apply(function(){C.parent()&&C.remove();d.$setViewValue(c.val())})})}function m(a,c,d){var e;
d.$render=function(){var a=new db(d.$viewValue);s(c.find("option"),function(c){c.selected=y(a.get(c.value))})};a.$watch(function(){fa(e,d.$viewValue)||(e=ra(d.$viewValue),d.$render())});c.on("change",function(){a.$apply(function(){var a=[];s(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function p(e,f,g){function h(a,c,d){T[x]=d;G&&(T[G]=c);return a(e,T)}function k(a){var c;if(u)if(M&&D(a)){c=new db([]);for(var d=0;d<a.length;d++)c.put(h(M,null,a[d]),!0)}else c=
new db(a);else M&&(a=h(M,null,a));return function(d,e){var f;f=M?M:B?B:F;return u?y(c.remove(h(f,d,e))):a===h(f,d,e)}}function l(){v||(e.$$postDigest(p),v=!0)}function m(a,c,d){a[c]=a[c]||0;a[c]+=d?1:-1}function p(){v=!1;var a={"":[]},c=[""],d,l,n,r,t;n=g.$viewValue;r=P(e)||[];var B=G?Object.keys(r).sort():r,x,A,D,F,N={};t=k(n);var J=!1,U,V;Q={};for(F=0;D=B.length,F<D;F++){x=F;if(G&&(x=B[F],"$"===x.charAt(0)))continue;A=r[x];d=h(I,x,A)||"";(l=a[d])||(l=a[d]=[],c.push(d));d=t(x,A);J=J||d;A=h(C,x,A);
A=y(A)?A:"";V=M?M(e,T):G?B[F]:F;M&&(Q[V]=x);l.push({id:V,label:A,selected:d})}u||(z||null===n?a[""].unshift({id:"",label:"",selected:!J}):J||a[""].unshift({id:"?",label:"",selected:!0}));x=0;for(B=c.length;x<B;x++){d=c[x];l=a[d];R.length<=x?(n={element:H.clone().attr("label",d),label:l.label},r=[n],R.push(r),f.append(n.element)):(r=R[x],n=r[0],n.label!=d&&n.element.attr("label",n.label=d));J=null;F=0;for(D=l.length;F<D;F++)d=l[F],(t=r[F+1])?(J=t.element,t.label!==d.label&&(m(N,t.label,!1),m(N,d.label,
!0),J.text(t.label=d.label),J.prop("label",t.label)),t.id!==d.id&&J.val(t.id=d.id),J[0].selected!==d.selected&&(J.prop("selected",t.selected=d.selected),Ra&&J.prop("selected",t.selected))):(""===d.id&&z?U=z:(U=w.clone()).val(d.id).prop("selected",d.selected).attr("selected",d.selected).prop("label",d.label).text(d.label),r.push(t={element:U,label:d.label,id:d.id,selected:d.selected}),m(N,d.label,!0),J?J.after(U):n.element.append(U),J=U);for(F++;r.length>F;)d=r.pop(),m(N,d.label,!1),d.element.remove()}for(;R.length>
x;){l=R.pop();for(F=1;F<l.length;++F)m(N,l[F].label,!1);l[0].element.remove()}s(N,function(a,c){0<a?q.addOption(c):0>a&&q.removeOption(c)})}var n;if(!(n=r.match(d)))throw eg("iexp",r,va(f));var C=c(n[2]||n[1]),x=n[4]||n[6],A=/ as /.test(n[0])&&n[1],B=A?c(A):null,G=n[5],I=c(n[3]||""),F=c(n[2]?n[1]:x),P=c(n[7]),M=n[8]?c(n[8]):null,Q={},R=[[{element:f,label:""}]],T={};z&&(a(z)(e),z.removeClass("ng-scope"),z.remove());f.empty();f.on("change",function(){e.$apply(function(){var a=P(e)||[],c;if(u)c=[],s(f.val(),
function(d){d=M?Q[d]:d;c.push("?"===d?t:""===d?null:h(B?B:F,d,a[d]))});else{var d=M?Q[f.val()]:f.val();c="?"===d?t:""===d?null:h(B?B:F,d,a[d])}g.$setViewValue(c);p()})});g.$render=p;e.$watchCollection(P,l);e.$watchCollection(function(){var a=P(e),c;if(a&&D(a)){c=Array(a.length);for(var d=0,f=a.length;d<f;d++)c[d]=h(C,d,a[d])}else if(a)for(d in c={},a)a.hasOwnProperty(d)&&(c[d]=h(C,d,a[d]));return c},l);u&&e.$watchCollection(function(){return g.$modelValue},l)}if(l[1]){var q=l[0];l=l[1];var u=h.multiple,
r=h.ngOptions,z=!1,n,v=!1,w=B(Y.createElement("option")),H=B(Y.createElement("optgroup")),C=w.clone();h=0;for(var x=g.children(),G=x.length;h<G;h++)if(""===x[h].value){n=z=x.eq(h);break}q.init(l,z,C);u&&(l.$isEmpty=function(a){return!a||0===a.length});r?p(e,g,l):u?m(e,g,l):k(e,g,l,q)}}}}],Yd=["$interpolate",function(a){var c={addOption:H,removeOption:H};return{restrict:"E",priority:100,compile:function(d,e){if(A(e.value)){var f=a(d.text(),!0);f||e.$set("value",d.text())}return function(a,d,e){var k=
d.parent(),m=k.data("$selectController")||k.parent().data("$selectController");m&&m.databound||(m=c);f?a.$watch(f,function(a,c){e.$set("value",a);c!==a&&m.removeOption(c);m.addOption(a,d)}):m.addOption(e.value,d);d.on("$destroy",function(){m.removeOption(e.value)})}}}}],Xd=da({restrict:"E",terminal:!1}),zc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){e&&(d.required=!0,e.$validators.required=function(a,c){return!d.required||!e.$isEmpty(c)},d.$observe("required",function(){e.$validate()}))}}},
yc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f,g=d.ngPattern||d.pattern;d.$observe("pattern",function(a){F(a)&&0<a.length&&(a=new RegExp("^"+a+"$"));if(a&&!a.test)throw T("ngPattern")("noregexp",g,a,va(c));f=a||t;e.$validate()});e.$validators.pattern=function(a){return e.$isEmpty(a)||A(f)||f.test(a)}}}}},Bc=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f=-1;d.$observe("maxlength",function(a){a=ba(a);f=isNaN(a)?-1:a;e.$validate()});
e.$validators.maxlength=function(a,c){return 0>f||e.$isEmpty(a)||c.length<=f}}}}},Ac=function(){return{restrict:"A",require:"?ngModel",link:function(a,c,d,e){if(e){var f=0;d.$observe("minlength",function(a){f=ba(a)||0;e.$validate()});e.$validators.minlength=function(a,c){return e.$isEmpty(c)||c.length>=f}}}}};M.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):(Nd(),Pd(ga),B(Y).ready(function(){Jd(Y,sc)}))})(window,document);!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}</style>');
//# sourceMappingURL=angular.min.js.map

/**
 * @license AngularJS v1.3.11
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/* jshint maxlen: false */

/**
 * @ngdoc module
 * @name ngAnimate
 * @description
 *
 * The `ngAnimate` module provides support for JavaScript, CSS3 transition and CSS3 keyframe animation hooks within existing core and custom directives.
 *
 * <div doc-module-components="ngAnimate"></div>
 *
 * # Usage
 *
 * To see animations in action, all that is required is to define the appropriate CSS classes
 * or to register a JavaScript animation via the `myModule.animation()` function. The directives that support animation automatically are:
 * `ngRepeat`, `ngInclude`, `ngIf`, `ngSwitch`, `ngShow`, `ngHide`, `ngView` and `ngClass`. Custom directives can take advantage of animation
 * by using the `$animate` service.
 *
 * Below is a more detailed breakdown of the supported animation events provided by pre-existing ng directives:
 *
 * | Directive                                                                                                | Supported Animations                                                     |
 * |----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
 * | {@link ng.directive:ngRepeat#animations ngRepeat}                                                        | enter, leave and move                                                    |
 * | {@link ngRoute.directive:ngView#animations ngView}                                                       | enter and leave                                                          |
 * | {@link ng.directive:ngInclude#animations ngInclude}                                                      | enter and leave                                                          |
 * | {@link ng.directive:ngSwitch#animations ngSwitch}                                                        | enter and leave                                                          |
 * | {@link ng.directive:ngIf#animations ngIf}                                                                | enter and leave                                                          |
 * | {@link ng.directive:ngClass#animations ngClass}                                                          | add and remove (the CSS class(es) present)                               |
 * | {@link ng.directive:ngShow#animations ngShow} & {@link ng.directive:ngHide#animations ngHide}            | add and remove (the ng-hide class value)                                 |
 * | {@link ng.directive:form#animation-hooks form} & {@link ng.directive:ngModel#animation-hooks ngModel}    | add and remove (dirty, pristine, valid, invalid & all other validations) |
 * | {@link module:ngMessages#animations ngMessages}                                                          | add and remove (ng-active & ng-inactive)                                 |
 * | {@link module:ngMessages#animations ngMessage}                                                           | enter and leave                                                          |
 *
 * You can find out more information about animations upon visiting each directive page.
 *
 * Below is an example of how to apply animations to a directive that supports animation hooks:
 *
 * ```html
 * <style type="text/css">
 * .slide.ng-enter, .slide.ng-leave {
 *   -webkit-transition:0.5s linear all;
 *   transition:0.5s linear all;
 * }
 *
 * .slide.ng-enter { }        /&#42; starting animations for enter &#42;/
 * .slide.ng-enter.ng-enter-active { } /&#42; terminal animations for enter &#42;/
 * .slide.ng-leave { }        /&#42; starting animations for leave &#42;/
 * .slide.ng-leave.ng-leave-active { } /&#42; terminal animations for leave &#42;/
 * </style>
 *
 * <!--
 * the animate service will automatically add .ng-enter and .ng-leave to the element
 * to trigger the CSS transition/animations
 * -->
 * <ANY class="slide" ng-include="..."></ANY>
 * ```
 *
 * Keep in mind that, by default, if an animation is running, any child elements cannot be animated
 * until the parent element's animation has completed. This blocking feature can be overridden by
 * placing the `ng-animate-children` attribute on a parent container tag.
 *
 * ```html
 * <div class="slide-animation" ng-if="on" ng-animate-children>
 *   <div class="fade-animation" ng-if="on">
 *     <div class="explode-animation" ng-if="on">
 *        ...
 *     </div>
 *   </div>
 * </div>
 * ```
 *
 * When the `on` expression value changes and an animation is triggered then each of the elements within
 * will all animate without the block being applied to child elements.
 *
 * ## Are animations run when the application starts?
 * No they are not. When an application is bootstrapped Angular will disable animations from running to avoid
 * a frenzy of animations from being triggered as soon as the browser has rendered the screen. For this to work,
 * Angular will wait for two digest cycles until enabling animations. From there on, any animation-triggering
 * layout changes in the application will trigger animations as normal.
 *
 * In addition, upon bootstrap, if the routing system or any directives or load remote data (via $http) then Angular
 * will automatically extend the wait time to enable animations once **all** of the outbound HTTP requests
 * are complete.
 *
 * ## CSS-defined Animations
 * The animate service will automatically apply two CSS classes to the animated element and these two CSS classes
 * are designed to contain the start and end CSS styling. Both CSS transitions and keyframe animations are supported
 * and can be used to play along with this naming structure.
 *
 * The following code below demonstrates how to perform animations using **CSS transitions** with Angular:
 *
 * ```html
 * <style type="text/css">
 * /&#42;
 *  The animate class is apart of the element and the ng-enter class
 *  is attached to the element once the enter animation event is triggered
 * &#42;/
 * .reveal-animation.ng-enter {
 *  -webkit-transition: 1s linear all; /&#42; Safari/Chrome &#42;/
 *  transition: 1s linear all; /&#42; All other modern browsers and IE10+ &#42;/
 *
 *  /&#42; The animation preparation code &#42;/
 *  opacity: 0;
 * }
 *
 * /&#42;
 *  Keep in mind that you want to combine both CSS
 *  classes together to avoid any CSS-specificity
 *  conflicts
 * &#42;/
 * .reveal-animation.ng-enter.ng-enter-active {
 *  /&#42; The animation code itself &#42;/
 *  opacity: 1;
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * The following code below demonstrates how to perform animations using **CSS animations** with Angular:
 *
 * ```html
 * <style type="text/css">
 * .reveal-animation.ng-enter {
 *   -webkit-animation: enter_sequence 1s linear; /&#42; Safari/Chrome &#42;/
 *   animation: enter_sequence 1s linear; /&#42; IE10+ and Future Browsers &#42;/
 * }
 * @-webkit-keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * @keyframes enter_sequence {
 *   from { opacity:0; }
 *   to { opacity:1; }
 * }
 * </style>
 *
 * <div class="view-container">
 *   <div ng-view class="reveal-animation"></div>
 * </div>
 * ```
 *
 * Both CSS3 animations and transitions can be used together and the animate service will figure out the correct duration and delay timing.
 *
 * Upon DOM mutation, the event class is added first (something like `ng-enter`), then the browser prepares itself to add
 * the active class (in this case `ng-enter-active`) which then triggers the animation. The animation module will automatically
 * detect the CSS code to determine when the animation ends. Once the animation is over then both CSS classes will be
 * removed from the DOM. If a browser does not support CSS transitions or CSS animations then the animation will start and end
 * immediately resulting in a DOM element that is at its final state. This final state is when the DOM element
 * has no CSS transition/animation classes applied to it.
 *
 * ### Structural transition animations
 *
 * Structural transitions (such as enter, leave and move) will always apply a `0s none` transition
 * value to force the browser into rendering the styles defined in the setup (`.ng-enter`, `.ng-leave`
 * or `.ng-move`) class. This means that any active transition animations operating on the element
 * will be cut off to make way for the enter, leave or move animation.
 *
 * ### Class-based transition animations
 *
 * Class-based transitions refer to transition animations that are triggered when a CSS class is
 * added to or removed from the element (via `$animate.addClass`, `$animate.removeClass`,
 * `$animate.setClass`, or by directives such as `ngClass`, `ngModel` and `form`).
 * They are different when compared to structural animations since they **do not cancel existing
 * animations** nor do they **block successive transitions** from rendering on the same element.
 * This distinction allows for **multiple class-based transitions** to be performed on the same element.
 *
 * In addition to ngAnimate supporting the default (natural) functionality of class-based transition
 * animations, ngAnimate also decorates the element with starting and ending CSS classes to aid the
 * developer in further styling the element throughout the transition animation. Earlier versions
 * of ngAnimate may have caused natural CSS transitions to break and not render properly due to
 * $animate temporarily blocking transitions using `0s none` in order to allow the setup CSS class
 * (the `-add` or `-remove` class) to be applied without triggering an animation. However, as of
 * **version 1.3**, this workaround has been removed with ngAnimate and all non-ngAnimate CSS
 * class transitions are compatible with ngAnimate.
 *
 * There is, however, one special case when dealing with class-based transitions in ngAnimate.
 * When rendering class-based transitions that make use of the setup and active CSS classes
 * (e.g. `.fade-add` and `.fade-add-active` for when `.fade` is added) be sure to define
 * the transition value **on the active CSS class** and not the setup class.
 *
 * ```css
 * .fade-add {
 *   /&#42; remember to place a 0s transition here
 *      to ensure that the styles are applied instantly
 *      even if the element already has a transition style &#42;/
 *   transition:0s linear all;
 *
 *   /&#42; starting CSS styles &#42;/
 *   opacity:1;
 * }
 * .fade-add.fade-add-active {
 *   /&#42; this will be the length of the animation &#42;/
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * The setup CSS class (in this case `.fade-add`) also has a transition style property, however, it
 * has a duration of zero. This may not be required, however, incase the browser is unable to render
 * the styling present in this CSS class instantly then it could be that the browser is attempting
 * to perform an unnecessary transition.
 *
 * This workaround, however, does not apply to  standard class-based transitions that are rendered
 * when a CSS class containing a transition is applied to an element:
 *
 * ```css
 * /&#42; this works as expected &#42;/
 * .fade {
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * Please keep this in mind when coding the CSS markup that will be used within class-based transitions.
 * Also, try not to mix the two class-based animation flavors together since the CSS code may become
 * overly complex.
 *
 *
 * ### Preventing Collisions With Third Party Libraries
 *
 * Some third-party frameworks place animation duration defaults across many element or className
 * selectors in order to make their code small and reuseable. This can lead to issues with ngAnimate, which
 * is expecting actual animations on these elements and has to wait for their completion.
 *
 * You can prevent this unwanted behavior by using a prefix on all your animation classes:
 *
 * ```css
 * /&#42; prefixed with animate- &#42;/
 * .animate-fade-add.animate-fade-add-active {
 *   transition:1s linear all;
 *   opacity:0;
 * }
 * ```
 *
 * You then configure `$animate` to enforce this prefix:
 *
 * ```js
 * $animateProvider.classNameFilter(/animate-/);
 * ```
 * </div>
 *
 * ### CSS Staggering Animations
 * A Staggering animation is a collection of animations that are issued with a slight delay in between each successive operation resulting in a
 * curtain-like effect. The ngAnimate module (versions >=1.2) supports staggering animations and the stagger effect can be
 * performed by creating a **ng-EVENT-stagger** CSS class and attaching that class to the base CSS class used for
 * the animation. The style property expected within the stagger class can either be a **transition-delay** or an
 * **animation-delay** property (or both if your animation contains both transitions and keyframe animations).
 *
 * ```css
 * .my-animation.ng-enter {
 *   /&#42; standard transition code &#42;/
 *   -webkit-transition: 1s linear all;
 *   transition: 1s linear all;
 *   opacity:0;
 * }
 * .my-animation.ng-enter-stagger {
 *   /&#42; this will have a 100ms delay between each successive leave animation &#42;/
 *   -webkit-transition-delay: 0.1s;
 *   transition-delay: 0.1s;
 *
 *   /&#42; in case the stagger doesn't work then these two values
 *    must be set to 0 to avoid an accidental CSS inheritance &#42;/
 *   -webkit-transition-duration: 0s;
 *   transition-duration: 0s;
 * }
 * .my-animation.ng-enter.ng-enter-active {
 *   /&#42; standard transition styles &#42;/
 *   opacity:1;
 * }
 * ```
 *
 * Staggering animations work by default in ngRepeat (so long as the CSS class is defined). Outside of ngRepeat, to use staggering animations
 * on your own, they can be triggered by firing multiple calls to the same event on $animate. However, the restrictions surrounding this
 * are that each of the elements must have the same CSS className value as well as the same parent element. A stagger operation
 * will also be reset if more than 10ms has passed after the last animation has been fired.
 *
 * The following code will issue the **ng-leave-stagger** event on the element provided:
 *
 * ```js
 * var kids = parent.children();
 *
 * $animate.leave(kids[0]); //stagger index=0
 * $animate.leave(kids[1]); //stagger index=1
 * $animate.leave(kids[2]); //stagger index=2
 * $animate.leave(kids[3]); //stagger index=3
 * $animate.leave(kids[4]); //stagger index=4
 *
 * $timeout(function() {
 *   //stagger has reset itself
 *   $animate.leave(kids[5]); //stagger index=0
 *   $animate.leave(kids[6]); //stagger index=1
 * }, 100, false);
 * ```
 *
 * Stagger animations are currently only supported within CSS-defined animations.
 *
 * ## JavaScript-defined Animations
 * In the event that you do not want to use CSS3 transitions or CSS3 animations or if you wish to offer animations on browsers that do not
 * yet support CSS transitions/animations, then you can make use of JavaScript animations defined inside of your AngularJS module.
 *
 * ```js
 * //!annotate="YourApp" Your AngularJS Module|Replace this or ngModule with the module that you used to define your application.
 * var ngModule = angular.module('YourApp', ['ngAnimate']);
 * ngModule.animation('.my-crazy-animation', function() {
 *   return {
 *     enter: function(element, done) {
 *       //run the animation here and call done when the animation is complete
 *       return function(cancelled) {
 *         //this (optional) function will be called when the animation
 *         //completes or when the animation is cancelled (the cancelled
 *         //flag will be set to true if cancelled).
 *       };
 *     },
 *     leave: function(element, done) { },
 *     move: function(element, done) { },
 *
 *     //animation that can be triggered before the class is added
 *     beforeAddClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is added
 *     addClass: function(element, className, done) { },
 *
 *     //animation that can be triggered before the class is removed
 *     beforeRemoveClass: function(element, className, done) { },
 *
 *     //animation that can be triggered after the class is removed
 *     removeClass: function(element, className, done) { }
 *   };
 * });
 * ```
 *
 * JavaScript-defined animations are created with a CSS-like class selector and a collection of events which are set to run
 * a javascript callback function. When an animation is triggered, $animate will look for a matching animation which fits
 * the element's CSS class attribute value and then run the matching animation event function (if found).
 * In other words, if the CSS classes present on the animated element match any of the JavaScript animations then the callback function will
 * be executed. It should be also noted that only simple, single class selectors are allowed (compound class selectors are not supported).
 *
 * Within a JavaScript animation, an object containing various event callback animation functions is expected to be returned.
 * As explained above, these callbacks are triggered based on the animation event. Therefore if an enter animation is run,
 * and the JavaScript animation is found, then the enter callback will handle that animation (in addition to the CSS keyframe animation
 * or transition code that is defined via a stylesheet).
 *
 *
 * ### Applying Directive-specific Styles to an Animation
 * In some cases a directive or service may want to provide `$animate` with extra details that the animation will
 * include into its animation. Let's say for example we wanted to render an animation that animates an element
 * towards the mouse coordinates as to where the user clicked last. By collecting the X/Y coordinates of the click
 * (via the event parameter) we can set the `top` and `left` styles into an object and pass that into our function
 * call to `$animate.addClass`.
 *
 * ```js
 * canvas.on('click', function(e) {
 *   $animate.addClass(element, 'on', {
 *     to: {
 *       left : e.client.x + 'px',
 *       top : e.client.y + 'px'
 *     }
 *   }):
 * });
 * ```
 *
 * Now when the animation runs, and a transition or keyframe animation is picked up, then the animation itself will
 * also include and transition the styling of the `left` and `top` properties into its running animation. If we want
 * to provide some starting animation values then we can do so by placing the starting animations styles into an object
 * called `from` in the same object as the `to` animations.
 *
 * ```js
 * canvas.on('click', function(e) {
 *   $animate.addClass(element, 'on', {
 *     from: {
 *        position: 'absolute',
 *        left: '0px',
 *        top: '0px'
 *     },
 *     to: {
 *       left : e.client.x + 'px',
 *       top : e.client.y + 'px'
 *     }
 *   }):
 * });
 * ```
 *
 * Once the animation is complete or cancelled then the union of both the before and after styles are applied to the
 * element. If `ngAnimate` is not present then the styles will be applied immediately.
 *
 */

angular.module('ngAnimate', ['ng'])

  /**
   * @ngdoc provider
   * @name $animateProvider
   * @description
   *
   * The `$animateProvider` allows developers to register JavaScript animation event handlers directly inside of a module.
   * When an animation is triggered, the $animate service will query the $animate service to find any animations that match
   * the provided name value.
   *
   * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
   *
   * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
   *
   */
  .directive('ngAnimateChildren', function() {
    var NG_ANIMATE_CHILDREN = '$$ngAnimateChildren';
    return function(scope, element, attrs) {
      var val = attrs.ngAnimateChildren;
      if (angular.isString(val) && val.length === 0) { //empty attribute
        element.data(NG_ANIMATE_CHILDREN, true);
      } else {
        scope.$watch(val, function(value) {
          element.data(NG_ANIMATE_CHILDREN, !!value);
        });
      }
    };
  })

  //this private service is only used within CSS-enabled animations
  //IE8 + IE9 do not support rAF natively, but that is fine since they
  //also don't support transitions and keyframes which means that the code
  //below will never be used by the two browsers.
  .factory('$$animateReflow', ['$$rAF', '$document', function($$rAF, $document) {
    var bod = $document[0].body;
    return function(fn) {
      //the returned function acts as the cancellation function
      return $$rAF(function() {
        //the line below will force the browser to perform a repaint
        //so that all the animated elements within the animation frame
        //will be properly updated and drawn on screen. This is
        //required to perform multi-class CSS based animations with
        //Firefox. DO NOT REMOVE THIS LINE.
        var a = bod.offsetWidth + 1;
        fn();
      });
    };
  }])

  .config(['$provide', '$animateProvider', function($provide, $animateProvider) {
    var noop = angular.noop;
    var forEach = angular.forEach;
    var selectors = $animateProvider.$$selectors;
    var isArray = angular.isArray;
    var isString = angular.isString;
    var isObject = angular.isObject;

    var ELEMENT_NODE = 1;
    var NG_ANIMATE_STATE = '$$ngAnimateState';
    var NG_ANIMATE_CHILDREN = '$$ngAnimateChildren';
    var NG_ANIMATE_CLASS_NAME = 'ng-animate';
    var rootAnimateState = {running: true};

    function extractElementNode(element) {
      for (var i = 0; i < element.length; i++) {
        var elm = element[i];
        if (elm.nodeType == ELEMENT_NODE) {
          return elm;
        }
      }
    }

    function prepareElement(element) {
      return element && angular.element(element);
    }

    function stripCommentsFromElement(element) {
      return angular.element(extractElementNode(element));
    }

    function isMatchingElement(elm1, elm2) {
      return extractElementNode(elm1) == extractElementNode(elm2);
    }
    var $$jqLite;
    $provide.decorator('$animate',
        ['$delegate', '$$q', '$injector', '$sniffer', '$rootElement', '$$asyncCallback', '$rootScope', '$document', '$templateRequest', '$$jqLite',
 function($delegate,   $$q,   $injector,   $sniffer,   $rootElement,   $$asyncCallback,   $rootScope,   $document,   $templateRequest,   $$$jqLite) {

      $$jqLite = $$$jqLite;
      $rootElement.data(NG_ANIMATE_STATE, rootAnimateState);

      // Wait until all directive and route-related templates are downloaded and
      // compiled. The $templateRequest.totalPendingRequests variable keeps track of
      // all of the remote templates being currently downloaded. If there are no
      // templates currently downloading then the watcher will still fire anyway.
      var deregisterWatch = $rootScope.$watch(
        function() { return $templateRequest.totalPendingRequests; },
        function(val, oldVal) {
          if (val !== 0) return;
          deregisterWatch();

          // Now that all templates have been downloaded, $animate will wait until
          // the post digest queue is empty before enabling animations. By having two
          // calls to $postDigest calls we can ensure that the flag is enabled at the
          // very end of the post digest queue. Since all of the animations in $animate
          // use $postDigest, it's important that the code below executes at the end.
          // This basically means that the page is fully downloaded and compiled before
          // any animations are triggered.
          $rootScope.$$postDigest(function() {
            $rootScope.$$postDigest(function() {
              rootAnimateState.running = false;
            });
          });
        }
      );

      var globalAnimationCounter = 0;
      var classNameFilter = $animateProvider.classNameFilter();
      var isAnimatableClassName = !classNameFilter
              ? function() { return true; }
              : function(className) {
                return classNameFilter.test(className);
              };

      function classBasedAnimationsBlocked(element, setter) {
        var data = element.data(NG_ANIMATE_STATE) || {};
        if (setter) {
          data.running = true;
          data.structural = true;
          element.data(NG_ANIMATE_STATE, data);
        }
        return data.disabled || (data.running && data.structural);
      }

      function runAnimationPostDigest(fn) {
        var cancelFn, defer = $$q.defer();
        defer.promise.$$cancelFn = function() {
          cancelFn && cancelFn();
        };
        $rootScope.$$postDigest(function() {
          cancelFn = fn(function() {
            defer.resolve();
          });
        });
        return defer.promise;
      }

      function parseAnimateOptions(options) {
        // some plugin code may still be passing in the callback
        // function as the last param for the $animate methods so
        // it's best to only allow string or array values for now
        if (isObject(options)) {
          if (options.tempClasses && isString(options.tempClasses)) {
            options.tempClasses = options.tempClasses.split(/\s+/);
          }
          return options;
        }
      }

      function resolveElementClasses(element, cache, runningAnimations) {
        runningAnimations = runningAnimations || {};

        var lookup = {};
        forEach(runningAnimations, function(data, selector) {
          forEach(selector.split(' '), function(s) {
            lookup[s]=data;
          });
        });

        var hasClasses = Object.create(null);
        forEach((element.attr('class') || '').split(/\s+/), function(className) {
          hasClasses[className] = true;
        });

        var toAdd = [], toRemove = [];
        forEach((cache && cache.classes) || [], function(status, className) {
          var hasClass = hasClasses[className];
          var matchingAnimation = lookup[className] || {};

          // When addClass and removeClass is called then $animate will check to
          // see if addClass and removeClass cancel each other out. When there are
          // more calls to removeClass than addClass then the count falls below 0
          // and then the removeClass animation will be allowed. Otherwise if the
          // count is above 0 then that means an addClass animation will commence.
          // Once an animation is allowed then the code will also check to see if
          // there exists any on-going animation that is already adding or remvoing
          // the matching CSS class.
          if (status === false) {
            //does it have the class or will it have the class
            if (hasClass || matchingAnimation.event == 'addClass') {
              toRemove.push(className);
            }
          } else if (status === true) {
            //is the class missing or will it be removed?
            if (!hasClass || matchingAnimation.event == 'removeClass') {
              toAdd.push(className);
            }
          }
        });

        return (toAdd.length + toRemove.length) > 0 && [toAdd.join(' '), toRemove.join(' ')];
      }

      function lookup(name) {
        if (name) {
          var matches = [],
              flagMap = {},
              classes = name.substr(1).split('.');

          //the empty string value is the default animation
          //operation which performs CSS transition and keyframe
          //animations sniffing. This is always included for each
          //element animation procedure if the browser supports
          //transitions and/or keyframe animations. The default
          //animation is added to the top of the list to prevent
          //any previous animations from affecting the element styling
          //prior to the element being animated.
          if ($sniffer.transitions || $sniffer.animations) {
            matches.push($injector.get(selectors['']));
          }

          for (var i=0; i < classes.length; i++) {
            var klass = classes[i],
                selectorFactoryName = selectors[klass];
            if (selectorFactoryName && !flagMap[klass]) {
              matches.push($injector.get(selectorFactoryName));
              flagMap[klass] = true;
            }
          }
          return matches;
        }
      }

      function animationRunner(element, animationEvent, className, options) {
        //transcluded directives may sometimes fire an animation using only comment nodes
        //best to catch this early on to prevent any animation operations from occurring
        var node = element[0];
        if (!node) {
          return;
        }

        if (options) {
          options.to = options.to || {};
          options.from = options.from || {};
        }

        var classNameAdd;
        var classNameRemove;
        if (isArray(className)) {
          classNameAdd = className[0];
          classNameRemove = className[1];
          if (!classNameAdd) {
            className = classNameRemove;
            animationEvent = 'removeClass';
          } else if (!classNameRemove) {
            className = classNameAdd;
            animationEvent = 'addClass';
          } else {
            className = classNameAdd + ' ' + classNameRemove;
          }
        }

        var isSetClassOperation = animationEvent == 'setClass';
        var isClassBased = isSetClassOperation
                           || animationEvent == 'addClass'
                           || animationEvent == 'removeClass'
                           || animationEvent == 'animate';

        var currentClassName = element.attr('class');
        var classes = currentClassName + ' ' + className;
        if (!isAnimatableClassName(classes)) {
          return;
        }

        var beforeComplete = noop,
            beforeCancel = [],
            before = [],
            afterComplete = noop,
            afterCancel = [],
            after = [];

        var animationLookup = (' ' + classes).replace(/\s+/g,'.');
        forEach(lookup(animationLookup), function(animationFactory) {
          var created = registerAnimation(animationFactory, animationEvent);
          if (!created && isSetClassOperation) {
            registerAnimation(animationFactory, 'addClass');
            registerAnimation(animationFactory, 'removeClass');
          }
        });

        function registerAnimation(animationFactory, event) {
          var afterFn = animationFactory[event];
          var beforeFn = animationFactory['before' + event.charAt(0).toUpperCase() + event.substr(1)];
          if (afterFn || beforeFn) {
            if (event == 'leave') {
              beforeFn = afterFn;
              //when set as null then animation knows to skip this phase
              afterFn = null;
            }
            after.push({
              event: event, fn: afterFn
            });
            before.push({
              event: event, fn: beforeFn
            });
            return true;
          }
        }

        function run(fns, cancellations, allCompleteFn) {
          var animations = [];
          forEach(fns, function(animation) {
            animation.fn && animations.push(animation);
          });

          var count = 0;
          function afterAnimationComplete(index) {
            if (cancellations) {
              (cancellations[index] || noop)();
              if (++count < animations.length) return;
              cancellations = null;
            }
            allCompleteFn();
          }

          //The code below adds directly to the array in order to work with
          //both sync and async animations. Sync animations are when the done()
          //operation is called right away. DO NOT REFACTOR!
          forEach(animations, function(animation, index) {
            var progress = function() {
              afterAnimationComplete(index);
            };
            switch (animation.event) {
              case 'setClass':
                cancellations.push(animation.fn(element, classNameAdd, classNameRemove, progress, options));
                break;
              case 'animate':
                cancellations.push(animation.fn(element, className, options.from, options.to, progress));
                break;
              case 'addClass':
                cancellations.push(animation.fn(element, classNameAdd || className,     progress, options));
                break;
              case 'removeClass':
                cancellations.push(animation.fn(element, classNameRemove || className,  progress, options));
                break;
              default:
                cancellations.push(animation.fn(element, progress, options));
                break;
            }
          });

          if (cancellations && cancellations.length === 0) {
            allCompleteFn();
          }
        }

        return {
          node: node,
          event: animationEvent,
          className: className,
          isClassBased: isClassBased,
          isSetClassOperation: isSetClassOperation,
          applyStyles: function() {
            if (options) {
              element.css(angular.extend(options.from || {}, options.to || {}));
            }
          },
          before: function(allCompleteFn) {
            beforeComplete = allCompleteFn;
            run(before, beforeCancel, function() {
              beforeComplete = noop;
              allCompleteFn();
            });
          },
          after: function(allCompleteFn) {
            afterComplete = allCompleteFn;
            run(after, afterCancel, function() {
              afterComplete = noop;
              allCompleteFn();
            });
          },
          cancel: function() {
            if (beforeCancel) {
              forEach(beforeCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              beforeComplete(true);
            }
            if (afterCancel) {
              forEach(afterCancel, function(cancelFn) {
                (cancelFn || noop)(true);
              });
              afterComplete(true);
            }
          }
        };
      }

      /**
       * @ngdoc service
       * @name $animate
       * @kind object
       *
       * @description
       * The `$animate` service provides animation detection support while performing DOM operations (enter, leave and move) as well as during addClass and removeClass operations.
       * When any of these operations are run, the $animate service
       * will examine any JavaScript-defined animations (which are defined by using the $animateProvider provider object)
       * as well as any CSS-defined animations against the CSS classes present on the element once the DOM operation is run.
       *
       * The `$animate` service is used behind the scenes with pre-existing directives and animation with these directives
       * will work out of the box without any extra configuration.
       *
       * Requires the {@link ngAnimate `ngAnimate`} module to be installed.
       *
       * Please visit the {@link ngAnimate `ngAnimate`} module overview page learn more about how to use animations in your application.
       * ## Callback Promises
       * With AngularJS 1.3, each of the animation methods, on the `$animate` service, return a promise when called. The
       * promise itself is then resolved once the animation has completed itself, has been cancelled or has been
       * skipped due to animations being disabled. (Note that even if the animation is cancelled it will still
       * call the resolve function of the animation.)
       *
       * ```js
       * $animate.enter(element, container).then(function() {
       *   //...this is called once the animation is complete...
       * });
       * ```
       *
       * Also note that, due to the nature of the callback promise, if any Angular-specific code (like changing the scope,
       * location of the page, etc...) is executed within the callback promise then be sure to wrap the code using
       * `$scope.$apply(...)`;
       *
       * ```js
       * $animate.leave(element).then(function() {
       *   $scope.$apply(function() {
       *     $location.path('/new-page');
       *   });
       * });
       * ```
       *
       * An animation can also be cancelled by calling the `$animate.cancel(promise)` method with the provided
       * promise that was returned when the animation was started.
       *
       * ```js
       * var promise = $animate.addClass(element, 'super-long-animation');
       * promise.then(function() {
       *   //this will still be called even if cancelled
       * });
       *
       * element.on('click', function() {
       *   //tooo lazy to wait for the animation to end
       *   $animate.cancel(promise);
       * });
       * ```
       *
       * (Keep in mind that the promise cancellation is unique to `$animate` since promises in
       * general cannot be cancelled.)
       *
       */
      return {
        /**
         * @ngdoc method
         * @name $animate#animate
         * @kind function
         *
         * @description
         * Performs an inline animation on the element which applies the provided `to` and `from` CSS styles to the element.
         * If any detected CSS transition, keyframe or JavaScript matches the provided `className` value then the animation
         * will take on the provided styles. For example, if a transition animation is set for the given className then the
         * provided `from` and `to` styles will be applied alongside the given transition. If a JavaScript animation is
         * detected then the provided styles will be given in as function paramters.
         *
         * ```js
         * ngModule.animation('.my-inline-animation', function() {
         *   return {
         *     animate : function(element, className, from, to, done) {
         *       //styles
         *     }
         *   }
         * });
         * ```
         *
         * Below is a breakdown of each step that occurs during the `animate` animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                  |
         * |-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
         * | 1. `$animate.animate(...)` is called                                                                                  | `class="my-animation"`                                       |
         * | 2. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                            |
         * | 3. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                            |
         * | 4. the `className` class value is added to the element                                                                | `class="my-animation ng-animate className"`                  |
         * | 5. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate className"`                  |
         * | 6. `$animate` blocks all CSS transitions on the element to ensure the `.className` class styling is applied right away| `class="my-animation ng-animate className"`                  |
         * | 7. `$animate` applies the provided collection of `from` CSS styles to the element                                     | `class="my-animation ng-animate className"`                  |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate className"`                  |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate className"`                  |
         * | 10. the `className-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate className className-active"` |
         * | 11. `$animate` applies the collection of `to` CSS styles to the element which are then handled by the transition      | `class="my-animation ng-animate className className-active"` |
         * | 12. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate className className-active"` |
         * | 13. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                       |
         * | 14. The returned promise is resolved.                                                                                 | `class="my-animation"`                                       |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {object} from a collection of CSS styles that will be applied to the element at the start of the animation
         * @param {object} to a collection of CSS styles that the element will animate towards
         * @param {string=} className an optional CSS class that will be added to the element for the duration of the animation (the default class is `ng-inline-animate`)
         * @param {object=} options an optional collection of options that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        animate: function(element, from, to, className, options) {
          className = className || 'ng-inline-animate';
          options = parseAnimateOptions(options) || {};
          options.from = to ? from : null;
          options.to   = to ? to : from;

          return runAnimationPostDigest(function(done) {
            return performAnimation('animate', className, stripCommentsFromElement(element), null, null, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#enter
         * @kind function
         *
         * @description
         * Appends the element to the parentElement element that resides in the document and then runs the enter animation. Once
         * the animation is started, the following CSS classes will be present on the element for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during enter animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                |
         * |-----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
         * | 1. `$animate.enter(...)` is called                                                                                    | `class="my-animation"`                                     |
         * | 2. element is inserted into the `parentElement` element or beside the `afterElement` element                          | `class="my-animation"`                                     |
         * | 3. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                          |
         * | 4. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                          |
         * | 5. the `.ng-enter` class is added to the element                                                                      | `class="my-animation ng-animate ng-enter"`                 |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate ng-enter"`                 |
         * | 7. `$animate` blocks all CSS transitions on the element to ensure the `.ng-enter` class styling is applied right away | `class="my-animation ng-animate ng-enter"`                 |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate ng-enter"`                 |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate ng-enter"`                 |
         * | 10. the `.ng-enter-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate ng-enter ng-enter-active"` |
         * | 11. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate ng-enter ng-enter-active"` |
         * | 12. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                     |
         * | 13. The returned promise is resolved.                                                                                 | `class="my-animation"`                                     |
         *
         * @param {DOMElement} element the element that will be the focus of the enter animation
         * @param {DOMElement} parentElement the parent element of the element that will be the focus of the enter animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the enter animation
         * @param {object=} options an optional collection of options that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        enter: function(element, parentElement, afterElement, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);
          parentElement = prepareElement(parentElement);
          afterElement = prepareElement(afterElement);

          classBasedAnimationsBlocked(element, true);
          $delegate.enter(element, parentElement, afterElement);
          return runAnimationPostDigest(function(done) {
            return performAnimation('enter', 'ng-enter', stripCommentsFromElement(element), parentElement, afterElement, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#leave
         * @kind function
         *
         * @description
         * Runs the leave animation operation and, upon completion, removes the element from the DOM. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during leave animation:
         *
         * | Animation Step                                                                                                        | What the element class attribute looks like                |
         * |-----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
         * | 1. `$animate.leave(...)` is called                                                                                    | `class="my-animation"`                                     |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                          | `class="my-animation ng-animate"`                          |
         * | 3. `$animate` waits for the next digest to start the animation                                                        | `class="my-animation ng-animate"`                          |
         * | 4. the `.ng-leave` class is added to the element                                                                      | `class="my-animation ng-animate ng-leave"`                 |
         * | 5. `$animate` scans the element styles to get the CSS transition/animation duration and delay                         | `class="my-animation ng-animate ng-leave"`                 |
         * | 6. `$animate` blocks all CSS transitions on the element to ensure the `.ng-leave` class styling is applied right away | `class="my-animation ng-animate ng-leave"`                 |
         * | 7. `$animate` waits for a single animation frame (this performs a reflow)                                             | `class="my-animation ng-animate ng-leave"`                 |
         * | 8. `$animate` removes the CSS transition block placed on the element                                                  | `class="my-animation ng-animate ng-leave"`                 |
         * | 9. the `.ng-leave-active` class is added (this triggers the CSS transition/animation)                                 | `class="my-animation ng-animate ng-leave ng-leave-active"` |
         * | 10. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate ng-leave ng-leave-active"` |
         * | 11. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                     |
         * | 12. The element is removed from the DOM                                                                               | ...                                                        |
         * | 13. The returned promise is resolved.                                                                                 | ...                                                        |
         *
         * @param {DOMElement} element the element that will be the focus of the leave animation
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        leave: function(element, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);

          cancelChildAnimations(element);
          classBasedAnimationsBlocked(element, true);
          return runAnimationPostDigest(function(done) {
            return performAnimation('leave', 'ng-leave', stripCommentsFromElement(element), null, null, function() {
              $delegate.leave(element);
            }, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#move
         * @kind function
         *
         * @description
         * Fires the move DOM operation. Just before the animation starts, the animate service will either append it into the parentElement container or
         * add the element directly after the afterElement element if present. Then the move animation will be run. Once
         * the animation is started, the following CSS classes will be added for the duration of the animation:
         *
         * Below is a breakdown of each step that occurs during move animation:
         *
         * | Animation Step                                                                                                       | What the element class attribute looks like              |
         * |----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
         * | 1. `$animate.move(...)` is called                                                                                    | `class="my-animation"`                                   |
         * | 2. element is moved into the parentElement element or beside the afterElement element                                | `class="my-animation"`                                   |
         * | 3. `$animate` waits for the next digest to start the animation                                                       | `class="my-animation ng-animate"`                        |
         * | 4. `$animate` runs the JavaScript-defined animations detected on the element                                         | `class="my-animation ng-animate"`                        |
         * | 5. the `.ng-move` class is added to the element                                                                      | `class="my-animation ng-animate ng-move"`                |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                        | `class="my-animation ng-animate ng-move"`                |
         * | 7. `$animate` blocks all CSS transitions on the element to ensure the `.ng-move` class styling is applied right away | `class="my-animation ng-animate ng-move"`                |
         * | 8. `$animate` waits for a single animation frame (this performs a reflow)                                            | `class="my-animation ng-animate ng-move"`                |
         * | 9. `$animate` removes the CSS transition block placed on the element                                                 | `class="my-animation ng-animate ng-move"`                |
         * | 10. the `.ng-move-active` class is added (this triggers the CSS transition/animation)                                | `class="my-animation ng-animate ng-move ng-move-active"` |
         * | 11. `$animate` waits for the animation to complete (via events and timeout)                                          | `class="my-animation ng-animate ng-move ng-move-active"` |
         * | 12. The animation ends and all generated CSS classes are removed from the element                                    | `class="my-animation"`                                   |
         * | 13. The returned promise is resolved.                                                                                | `class="my-animation"`                                   |
         *
         * @param {DOMElement} element the element that will be the focus of the move animation
         * @param {DOMElement} parentElement the parentElement element of the element that will be the focus of the move animation
         * @param {DOMElement} afterElement the sibling element (which is the previous element) of the element that will be the focus of the move animation
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        move: function(element, parentElement, afterElement, options) {
          options = parseAnimateOptions(options);
          element = angular.element(element);
          parentElement = prepareElement(parentElement);
          afterElement = prepareElement(afterElement);

          cancelChildAnimations(element);
          classBasedAnimationsBlocked(element, true);
          $delegate.move(element, parentElement, afterElement);
          return runAnimationPostDigest(function(done) {
            return performAnimation('move', 'ng-move', stripCommentsFromElement(element), parentElement, afterElement, noop, options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#addClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then attaches the className value to the element as a CSS class.
         * Unlike the other animation methods, the animate service will suffix the className value with {@type -add} in order to provide
         * the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if no CSS transitions
         * or keyframes are defined on the -add-active or base CSS class).
         *
         * Below is a breakdown of each step that occurs during addClass animation:
         *
         * | Animation Step                                                                                         | What the element class attribute looks like                        |
         * |--------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
         * | 1. `$animate.addClass(element, 'super')` is called                                                     | `class="my-animation"`                                             |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                           | `class="my-animation ng-animate"`                                  |
         * | 3. the `.super-add` class is added to the element                                                      | `class="my-animation ng-animate super-add"`                        |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                              | `class="my-animation ng-animate super-add"`                        |
         * | 5. the `.super` and `.super-add-active` classes are added (this triggers the CSS transition/animation) | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay          | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                             | `class="my-animation ng-animate super super-add super-add-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                       | `class="my-animation super"`                                       |
         * | 9. The super class is kept on the element                                                              | `class="my-animation super"`                                       |
         * | 10. The returned promise is resolved.                                                                  | `class="my-animation super"`                                       |
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be added to the element and then animated
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        addClass: function(element, className, options) {
          return this.setClass(element, className, [], options);
        },

        /**
         * @ngdoc method
         * @name $animate#removeClass
         *
         * @description
         * Triggers a custom animation event based off the className variable and then removes the CSS class provided by the className value
         * from the element. Unlike the other animation methods, the animate service will suffix the className value with {@type -remove} in
         * order to provide the animate service the setup and active CSS classes in order to trigger the animation (this will be skipped if
         * no CSS transitions or keyframes are defined on the -remove or base CSS classes).
         *
         * Below is a breakdown of each step that occurs during removeClass animation:
         *
         * | Animation Step                                                                                                       | What the element class attribute looks like                        |
         * |----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
         * | 1. `$animate.removeClass(element, 'super')` is called                                                                | `class="my-animation super"`                                       |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                         | `class="my-animation super ng-animate"`                            |
         * | 3. the `.super-remove` class is added to the element                                                                 | `class="my-animation super ng-animate super-remove"`               |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                                            | `class="my-animation super ng-animate super-remove"`               |
         * | 5. the `.super-remove-active` classes are added and `.super` is removed (this triggers the CSS transition/animation) | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                        | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                                           | `class="my-animation ng-animate super-remove super-remove-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                                     | `class="my-animation"`                                             |
         * | 9. The returned promise is resolved.                                                                                 | `class="my-animation"`                                             |
         *
         *
         * @param {DOMElement} element the element that will be animated
         * @param {string} className the CSS class that will be animated and then removed from the element
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
        */
        removeClass: function(element, className, options) {
          return this.setClass(element, [], className, options);
        },

        /**
         *
         * @ngdoc method
         * @name $animate#setClass
         *
         * @description Adds and/or removes the given CSS classes to and from the element.
         * Once complete, the `done()` callback will be fired (if provided).
         *
         * | Animation Step                                                                                                                               | What the element class attribute looks like                                            |
         * |----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
         * | 1. `$animate.setClass(element, 'on', 'off')` is called                                                                                       | `class="my-animation off"`                                                             |
         * | 2. `$animate` runs the JavaScript-defined animations detected on the element                                                                 | `class="my-animation ng-animate off"`                                                  |
         * | 3. the `.on-add` and `.off-remove` classes are added to the element                                                                          | `class="my-animation ng-animate on-add off-remove off"`                                |
         * | 4. `$animate` waits for a single animation frame (this performs a reflow)                                                                    | `class="my-animation ng-animate on-add off-remove off"`                                |
         * | 5. the `.on`, `.on-add-active` and `.off-remove-active` classes are added and `.off` is removed (this triggers the CSS transition/animation) | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 6. `$animate` scans the element styles to get the CSS transition/animation duration and delay                                                | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 7. `$animate` waits for the animation to complete (via events and timeout)                                                                   | `class="my-animation ng-animate on on-add on-add-active off-remove off-remove-active"` |
         * | 8. The animation ends and all generated CSS classes are removed from the element                                                             | `class="my-animation on"`                                                              |
         * | 9. The returned promise is resolved.                                                                                                         | `class="my-animation on"`                                                              |
         *
         * @param {DOMElement} element the element which will have its CSS classes changed
         *   removed from it
         * @param {string} add the CSS classes which will be added to the element
         * @param {string} remove the CSS class which will be removed from the element
         *   CSS classes have been set on the element
         * @param {object=} options an optional collection of styles that will be picked up by the CSS transition/animation
         * @return {Promise} the animation callback promise
         */
        setClass: function(element, add, remove, options) {
          options = parseAnimateOptions(options);

          var STORAGE_KEY = '$$animateClasses';
          element = angular.element(element);
          element = stripCommentsFromElement(element);

          if (classBasedAnimationsBlocked(element)) {
            return $delegate.$$setClassImmediately(element, add, remove, options);
          }

          // we're using a combined array for both the add and remove
          // operations since the ORDER OF addClass and removeClass matters
          var classes, cache = element.data(STORAGE_KEY);
          var hasCache = !!cache;
          if (!cache) {
            cache = {};
            cache.classes = {};
          }
          classes = cache.classes;

          add = isArray(add) ? add : add.split(' ');
          forEach(add, function(c) {
            if (c && c.length) {
              classes[c] = true;
            }
          });

          remove = isArray(remove) ? remove : remove.split(' ');
          forEach(remove, function(c) {
            if (c && c.length) {
              classes[c] = false;
            }
          });

          if (hasCache) {
            if (options && cache.options) {
              cache.options = angular.extend(cache.options || {}, options);
            }

            //the digest cycle will combine all the animations into one function
            return cache.promise;
          } else {
            element.data(STORAGE_KEY, cache = {
              classes: classes,
              options: options
            });
          }

          return cache.promise = runAnimationPostDigest(function(done) {
            var parentElement = element.parent();
            var elementNode = extractElementNode(element);
            var parentNode = elementNode.parentNode;
            // TODO(matsko): move this code into the animationsDisabled() function once #8092 is fixed
            if (!parentNode || parentNode['$$NG_REMOVED'] || elementNode['$$NG_REMOVED']) {
              done();
              return;
            }

            var cache = element.data(STORAGE_KEY);
            element.removeData(STORAGE_KEY);

            var state = element.data(NG_ANIMATE_STATE) || {};
            var classes = resolveElementClasses(element, cache, state.active);
            return !classes
              ? done()
              : performAnimation('setClass', classes, element, parentElement, null, function() {
                  if (classes[0]) $delegate.$$addClassImmediately(element, classes[0]);
                  if (classes[1]) $delegate.$$removeClassImmediately(element, classes[1]);
                }, cache.options, done);
          });
        },

        /**
         * @ngdoc method
         * @name $animate#cancel
         * @kind function
         *
         * @param {Promise} animationPromise The animation promise that is returned when an animation is started.
         *
         * @description
         * Cancels the provided animation.
        */
        cancel: function(promise) {
          promise.$$cancelFn();
        },

        /**
         * @ngdoc method
         * @name $animate#enabled
         * @kind function
         *
         * @param {boolean=} value If provided then set the animation on or off.
         * @param {DOMElement=} element If provided then the element will be used to represent the enable/disable operation
         * @return {boolean} Current animation state.
         *
         * @description
         * Globally enables/disables animations.
         *
        */
        enabled: function(value, element) {
          switch (arguments.length) {
            case 2:
              if (value) {
                cleanup(element);
              } else {
                var data = element.data(NG_ANIMATE_STATE) || {};
                data.disabled = true;
                element.data(NG_ANIMATE_STATE, data);
              }
            break;

            case 1:
              rootAnimateState.disabled = !value;
            break;

            default:
              value = !rootAnimateState.disabled;
            break;
          }
          return !!value;
         }
      };

      /*
        all animations call this shared animation triggering function internally.
        The animationEvent variable refers to the JavaScript animation event that will be triggered
        and the className value is the name of the animation that will be applied within the
        CSS code. Element, `parentElement` and `afterElement` are provided DOM elements for the animation
        and the onComplete callback will be fired once the animation is fully complete.
      */
      function performAnimation(animationEvent, className, element, parentElement, afterElement, domOperation, options, doneCallback) {
        var noopCancel = noop;
        var runner = animationRunner(element, animationEvent, className, options);
        if (!runner) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return noopCancel;
        }

        animationEvent = runner.event;
        className = runner.className;
        var elementEvents = angular.element._data(runner.node);
        elementEvents = elementEvents && elementEvents.events;

        if (!parentElement) {
          parentElement = afterElement ? afterElement.parent() : element.parent();
        }

        //skip the animation if animations are disabled, a parent is already being animated,
        //the element is not currently attached to the document body or then completely close
        //the animation if any matching animations are not found at all.
        //NOTE: IE8 + IE9 should close properly (run closeAnimation()) in case an animation was found.
        if (animationsDisabled(element, parentElement)) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          closeAnimation();
          return noopCancel;
        }

        var ngAnimateState  = element.data(NG_ANIMATE_STATE) || {};
        var runningAnimations     = ngAnimateState.active || {};
        var totalActiveAnimations = ngAnimateState.totalActive || 0;
        var lastAnimation         = ngAnimateState.last;
        var skipAnimation = false;

        if (totalActiveAnimations > 0) {
          var animationsToCancel = [];
          if (!runner.isClassBased) {
            if (animationEvent == 'leave' && runningAnimations['ng-leave']) {
              skipAnimation = true;
            } else {
              //cancel all animations when a structural animation takes place
              for (var klass in runningAnimations) {
                animationsToCancel.push(runningAnimations[klass]);
              }
              ngAnimateState = {};
              cleanup(element, true);
            }
          } else if (lastAnimation.event == 'setClass') {
            animationsToCancel.push(lastAnimation);
            cleanup(element, className);
          }
          else if (runningAnimations[className]) {
            var current = runningAnimations[className];
            if (current.event == animationEvent) {
              skipAnimation = true;
            } else {
              animationsToCancel.push(current);
              cleanup(element, className);
            }
          }

          if (animationsToCancel.length > 0) {
            forEach(animationsToCancel, function(operation) {
              operation.cancel();
            });
          }
        }

        if (runner.isClassBased
            && !runner.isSetClassOperation
            && animationEvent != 'animate'
            && !skipAnimation) {
          skipAnimation = (animationEvent == 'addClass') == element.hasClass(className); //opposite of XOR
        }

        if (skipAnimation) {
          fireDOMOperation();
          fireBeforeCallbackAsync();
          fireAfterCallbackAsync();
          fireDoneCallbackAsync();
          return noopCancel;
        }

        runningAnimations     = ngAnimateState.active || {};
        totalActiveAnimations = ngAnimateState.totalActive || 0;

        if (animationEvent == 'leave') {
          //there's no need to ever remove the listener since the element
          //will be removed (destroyed) after the leave animation ends or
          //is cancelled midway
          element.one('$destroy', function(e) {
            var element = angular.element(this);
            var state = element.data(NG_ANIMATE_STATE);
            if (state) {
              var activeLeaveAnimation = state.active['ng-leave'];
              if (activeLeaveAnimation) {
                activeLeaveAnimation.cancel();
                cleanup(element, 'ng-leave');
              }
            }
          });
        }

        //the ng-animate class does nothing, but it's here to allow for
        //parent animations to find and cancel child animations when needed
        $$jqLite.addClass(element, NG_ANIMATE_CLASS_NAME);
        if (options && options.tempClasses) {
          forEach(options.tempClasses, function(className) {
            $$jqLite.addClass(element, className);
          });
        }

        var localAnimationCount = globalAnimationCounter++;
        totalActiveAnimations++;
        runningAnimations[className] = runner;

        element.data(NG_ANIMATE_STATE, {
          last: runner,
          active: runningAnimations,
          index: localAnimationCount,
          totalActive: totalActiveAnimations
        });

        //first we run the before animations and when all of those are complete
        //then we perform the DOM operation and run the next set of animations
        fireBeforeCallbackAsync();
        runner.before(function(cancelled) {
          var data = element.data(NG_ANIMATE_STATE);
          cancelled = cancelled ||
                        !data || !data.active[className] ||
                        (runner.isClassBased && data.active[className].event != animationEvent);

          fireDOMOperation();
          if (cancelled === true) {
            closeAnimation();
          } else {
            fireAfterCallbackAsync();
            runner.after(closeAnimation);
          }
        });

        return runner.cancel;

        function fireDOMCallback(animationPhase) {
          var eventName = '$animate:' + animationPhase;
          if (elementEvents && elementEvents[eventName] && elementEvents[eventName].length > 0) {
            $$asyncCallback(function() {
              element.triggerHandler(eventName, {
                event: animationEvent,
                className: className
              });
            });
          }
        }

        function fireBeforeCallbackAsync() {
          fireDOMCallback('before');
        }

        function fireAfterCallbackAsync() {
          fireDOMCallback('after');
        }

        function fireDoneCallbackAsync() {
          fireDOMCallback('close');
          doneCallback();
        }

        //it is less complicated to use a flag than managing and canceling
        //timeouts containing multiple callbacks.
        function fireDOMOperation() {
          if (!fireDOMOperation.hasBeenRun) {
            fireDOMOperation.hasBeenRun = true;
            domOperation();
          }
        }

        function closeAnimation() {
          if (!closeAnimation.hasBeenRun) {
            if (runner) { //the runner doesn't exist if it fails to instantiate
              runner.applyStyles();
            }

            closeAnimation.hasBeenRun = true;
            if (options && options.tempClasses) {
              forEach(options.tempClasses, function(className) {
                $$jqLite.removeClass(element, className);
              });
            }

            var data = element.data(NG_ANIMATE_STATE);
            if (data) {

              /* only structural animations wait for reflow before removing an
                 animation, but class-based animations don't. An example of this
                 failing would be when a parent HTML tag has a ng-class attribute
                 causing ALL directives below to skip animations during the digest */
              if (runner && runner.isClassBased) {
                cleanup(element, className);
              } else {
                $$asyncCallback(function() {
                  var data = element.data(NG_ANIMATE_STATE) || {};
                  if (localAnimationCount == data.index) {
                    cleanup(element, className, animationEvent);
                  }
                });
                element.data(NG_ANIMATE_STATE, data);
              }
            }
            fireDoneCallbackAsync();
          }
        }
      }

      function cancelChildAnimations(element) {
        var node = extractElementNode(element);
        if (node) {
          var nodes = angular.isFunction(node.getElementsByClassName) ?
            node.getElementsByClassName(NG_ANIMATE_CLASS_NAME) :
            node.querySelectorAll('.' + NG_ANIMATE_CLASS_NAME);
          forEach(nodes, function(element) {
            element = angular.element(element);
            var data = element.data(NG_ANIMATE_STATE);
            if (data && data.active) {
              forEach(data.active, function(runner) {
                runner.cancel();
              });
            }
          });
        }
      }

      function cleanup(element, className) {
        if (isMatchingElement(element, $rootElement)) {
          if (!rootAnimateState.disabled) {
            rootAnimateState.running = false;
            rootAnimateState.structural = false;
          }
        } else if (className) {
          var data = element.data(NG_ANIMATE_STATE) || {};

          var removeAnimations = className === true;
          if (!removeAnimations && data.active && data.active[className]) {
            data.totalActive--;
            delete data.active[className];
          }

          if (removeAnimations || !data.totalActive) {
            $$jqLite.removeClass(element, NG_ANIMATE_CLASS_NAME);
            element.removeData(NG_ANIMATE_STATE);
          }
        }
      }

      function animationsDisabled(element, parentElement) {
        if (rootAnimateState.disabled) {
          return true;
        }

        if (isMatchingElement(element, $rootElement)) {
          return rootAnimateState.running;
        }

        var allowChildAnimations, parentRunningAnimation, hasParent;
        do {
          //the element did not reach the root element which means that it
          //is not apart of the DOM. Therefore there is no reason to do
          //any animations on it
          if (parentElement.length === 0) break;

          var isRoot = isMatchingElement(parentElement, $rootElement);
          var state = isRoot ? rootAnimateState : (parentElement.data(NG_ANIMATE_STATE) || {});
          if (state.disabled) {
            return true;
          }

          //no matter what, for an animation to work it must reach the root element
          //this implies that the element is attached to the DOM when the animation is run
          if (isRoot) {
            hasParent = true;
          }

          //once a flag is found that is strictly false then everything before
          //it will be discarded and all child animations will be restricted
          if (allowChildAnimations !== false) {
            var animateChildrenFlag = parentElement.data(NG_ANIMATE_CHILDREN);
            if (angular.isDefined(animateChildrenFlag)) {
              allowChildAnimations = animateChildrenFlag;
            }
          }

          parentRunningAnimation = parentRunningAnimation ||
                                   state.running ||
                                   (state.last && !state.last.isClassBased);
        }
        while (parentElement = parentElement.parent());

        return !hasParent || (!allowChildAnimations && parentRunningAnimation);
      }
    }]);

    $animateProvider.register('', ['$window', '$sniffer', '$timeout', '$$animateReflow',
                           function($window,   $sniffer,   $timeout,   $$animateReflow) {
      // Detect proper transitionend/animationend event names.
      var CSS_PREFIX = '', TRANSITION_PROP, TRANSITIONEND_EVENT, ANIMATION_PROP, ANIMATIONEND_EVENT;

      // If unprefixed events are not supported but webkit-prefixed are, use the latter.
      // Otherwise, just use W3C names, browsers not supporting them at all will just ignore them.
      // Note: Chrome implements `window.onwebkitanimationend` and doesn't implement `window.onanimationend`
      // but at the same time dispatches the `animationend` event and not `webkitAnimationEnd`.
      // Register both events in case `window.onanimationend` is not supported because of that,
      // do the same for `transitionend` as Safari is likely to exhibit similar behavior.
      // Also, the only modern browser that uses vendor prefixes for transitions/keyframes is webkit
      // therefore there is no reason to test anymore for other vendor prefixes: http://caniuse.com/#search=transition
      if (window.ontransitionend === undefined && window.onwebkittransitionend !== undefined) {
        CSS_PREFIX = '-webkit-';
        TRANSITION_PROP = 'WebkitTransition';
        TRANSITIONEND_EVENT = 'webkitTransitionEnd transitionend';
      } else {
        TRANSITION_PROP = 'transition';
        TRANSITIONEND_EVENT = 'transitionend';
      }

      if (window.onanimationend === undefined && window.onwebkitanimationend !== undefined) {
        CSS_PREFIX = '-webkit-';
        ANIMATION_PROP = 'WebkitAnimation';
        ANIMATIONEND_EVENT = 'webkitAnimationEnd animationend';
      } else {
        ANIMATION_PROP = 'animation';
        ANIMATIONEND_EVENT = 'animationend';
      }

      var DURATION_KEY = 'Duration';
      var PROPERTY_KEY = 'Property';
      var DELAY_KEY = 'Delay';
      var ANIMATION_ITERATION_COUNT_KEY = 'IterationCount';
      var ANIMATION_PLAYSTATE_KEY = 'PlayState';
      var NG_ANIMATE_PARENT_KEY = '$$ngAnimateKey';
      var NG_ANIMATE_CSS_DATA_KEY = '$$ngAnimateCSS3Data';
      var ELAPSED_TIME_MAX_DECIMAL_PLACES = 3;
      var CLOSING_TIME_BUFFER = 1.5;
      var ONE_SECOND = 1000;

      var lookupCache = {};
      var parentCounter = 0;
      var animationReflowQueue = [];
      var cancelAnimationReflow;
      function clearCacheAfterReflow() {
        if (!cancelAnimationReflow) {
          cancelAnimationReflow = $$animateReflow(function() {
            animationReflowQueue = [];
            cancelAnimationReflow = null;
            lookupCache = {};
          });
        }
      }

      function afterReflow(element, callback) {
        if (cancelAnimationReflow) {
          cancelAnimationReflow();
        }
        animationReflowQueue.push(callback);
        cancelAnimationReflow = $$animateReflow(function() {
          forEach(animationReflowQueue, function(fn) {
            fn();
          });

          animationReflowQueue = [];
          cancelAnimationReflow = null;
          lookupCache = {};
        });
      }

      var closingTimer = null;
      var closingTimestamp = 0;
      var animationElementQueue = [];
      function animationCloseHandler(element, totalTime) {
        var node = extractElementNode(element);
        element = angular.element(node);

        //this item will be garbage collected by the closing
        //animation timeout
        animationElementQueue.push(element);

        //but it may not need to cancel out the existing timeout
        //if the timestamp is less than the previous one
        var futureTimestamp = Date.now() + totalTime;
        if (futureTimestamp <= closingTimestamp) {
          return;
        }

        $timeout.cancel(closingTimer);

        closingTimestamp = futureTimestamp;
        closingTimer = $timeout(function() {
          closeAllAnimations(animationElementQueue);
          animationElementQueue = [];
        }, totalTime, false);
      }

      function closeAllAnimations(elements) {
        forEach(elements, function(element) {
          var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
          if (elementData) {
            forEach(elementData.closeAnimationFns, function(fn) {
              fn();
            });
          }
        });
      }

      function getElementAnimationDetails(element, cacheKey) {
        var data = cacheKey ? lookupCache[cacheKey] : null;
        if (!data) {
          var transitionDuration = 0;
          var transitionDelay = 0;
          var animationDuration = 0;
          var animationDelay = 0;

          //we want all the styles defined before and after
          forEach(element, function(element) {
            if (element.nodeType == ELEMENT_NODE) {
              var elementStyles = $window.getComputedStyle(element) || {};

              var transitionDurationStyle = elementStyles[TRANSITION_PROP + DURATION_KEY];
              transitionDuration = Math.max(parseMaxTime(transitionDurationStyle), transitionDuration);

              var transitionDelayStyle = elementStyles[TRANSITION_PROP + DELAY_KEY];
              transitionDelay  = Math.max(parseMaxTime(transitionDelayStyle), transitionDelay);

              var animationDelayStyle = elementStyles[ANIMATION_PROP + DELAY_KEY];
              animationDelay   = Math.max(parseMaxTime(elementStyles[ANIMATION_PROP + DELAY_KEY]), animationDelay);

              var aDuration  = parseMaxTime(elementStyles[ANIMATION_PROP + DURATION_KEY]);

              if (aDuration > 0) {
                aDuration *= parseInt(elementStyles[ANIMATION_PROP + ANIMATION_ITERATION_COUNT_KEY], 10) || 1;
              }
              animationDuration = Math.max(aDuration, animationDuration);
            }
          });
          data = {
            total: 0,
            transitionDelay: transitionDelay,
            transitionDuration: transitionDuration,
            animationDelay: animationDelay,
            animationDuration: animationDuration
          };
          if (cacheKey) {
            lookupCache[cacheKey] = data;
          }
        }
        return data;
      }

      function parseMaxTime(str) {
        var maxValue = 0;
        var values = isString(str) ?
          str.split(/\s*,\s*/) :
          [];
        forEach(values, function(value) {
          maxValue = Math.max(parseFloat(value) || 0, maxValue);
        });
        return maxValue;
      }

      function getCacheKey(element) {
        var parentElement = element.parent();
        var parentID = parentElement.data(NG_ANIMATE_PARENT_KEY);
        if (!parentID) {
          parentElement.data(NG_ANIMATE_PARENT_KEY, ++parentCounter);
          parentID = parentCounter;
        }
        return parentID + '-' + extractElementNode(element).getAttribute('class');
      }

      function animateSetup(animationEvent, element, className, styles) {
        var structural = ['ng-enter','ng-leave','ng-move'].indexOf(className) >= 0;

        var cacheKey = getCacheKey(element);
        var eventCacheKey = cacheKey + ' ' + className;
        var itemIndex = lookupCache[eventCacheKey] ? ++lookupCache[eventCacheKey].total : 0;

        var stagger = {};
        if (itemIndex > 0) {
          var staggerClassName = className + '-stagger';
          var staggerCacheKey = cacheKey + ' ' + staggerClassName;
          var applyClasses = !lookupCache[staggerCacheKey];

          applyClasses && $$jqLite.addClass(element, staggerClassName);

          stagger = getElementAnimationDetails(element, staggerCacheKey);

          applyClasses && $$jqLite.removeClass(element, staggerClassName);
        }

        $$jqLite.addClass(element, className);

        var formerData = element.data(NG_ANIMATE_CSS_DATA_KEY) || {};
        var timings = getElementAnimationDetails(element, eventCacheKey);
        var transitionDuration = timings.transitionDuration;
        var animationDuration = timings.animationDuration;

        if (structural && transitionDuration === 0 && animationDuration === 0) {
          $$jqLite.removeClass(element, className);
          return false;
        }

        var blockTransition = styles || (structural && transitionDuration > 0);
        var blockAnimation = animationDuration > 0 &&
                             stagger.animationDelay > 0 &&
                             stagger.animationDuration === 0;

        var closeAnimationFns = formerData.closeAnimationFns || [];
        element.data(NG_ANIMATE_CSS_DATA_KEY, {
          stagger: stagger,
          cacheKey: eventCacheKey,
          running: formerData.running || 0,
          itemIndex: itemIndex,
          blockTransition: blockTransition,
          closeAnimationFns: closeAnimationFns
        });

        var node = extractElementNode(element);

        if (blockTransition) {
          blockTransitions(node, true);
          if (styles) {
            element.css(styles);
          }
        }

        if (blockAnimation) {
          blockAnimations(node, true);
        }

        return true;
      }

      function animateRun(animationEvent, element, className, activeAnimationComplete, styles) {
        var node = extractElementNode(element);
        var elementData = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if (node.getAttribute('class').indexOf(className) == -1 || !elementData) {
          activeAnimationComplete();
          return;
        }

        var activeClassName = '';
        var pendingClassName = '';
        forEach(className.split(' '), function(klass, i) {
          var prefix = (i > 0 ? ' ' : '') + klass;
          activeClassName += prefix + '-active';
          pendingClassName += prefix + '-pending';
        });

        var style = '';
        var appliedStyles = [];
        var itemIndex = elementData.itemIndex;
        var stagger = elementData.stagger;
        var staggerTime = 0;
        if (itemIndex > 0) {
          var transitionStaggerDelay = 0;
          if (stagger.transitionDelay > 0 && stagger.transitionDuration === 0) {
            transitionStaggerDelay = stagger.transitionDelay * itemIndex;
          }

          var animationStaggerDelay = 0;
          if (stagger.animationDelay > 0 && stagger.animationDuration === 0) {
            animationStaggerDelay = stagger.animationDelay * itemIndex;
            appliedStyles.push(CSS_PREFIX + 'animation-play-state');
          }

          staggerTime = Math.round(Math.max(transitionStaggerDelay, animationStaggerDelay) * 100) / 100;
        }

        if (!staggerTime) {
          $$jqLite.addClass(element, activeClassName);
          if (elementData.blockTransition) {
            blockTransitions(node, false);
          }
        }

        var eventCacheKey = elementData.cacheKey + ' ' + activeClassName;
        var timings = getElementAnimationDetails(element, eventCacheKey);
        var maxDuration = Math.max(timings.transitionDuration, timings.animationDuration);
        if (maxDuration === 0) {
          $$jqLite.removeClass(element, activeClassName);
          animateClose(element, className);
          activeAnimationComplete();
          return;
        }

        if (!staggerTime && styles && Object.keys(styles).length > 0) {
          if (!timings.transitionDuration) {
            element.css('transition', timings.animationDuration + 's linear all');
            appliedStyles.push('transition');
          }
          element.css(styles);
        }

        var maxDelay = Math.max(timings.transitionDelay, timings.animationDelay);
        var maxDelayTime = maxDelay * ONE_SECOND;

        if (appliedStyles.length > 0) {
          //the element being animated may sometimes contain comment nodes in
          //the jqLite object, so we're safe to use a single variable to house
          //the styles since there is always only one element being animated
          var oldStyle = node.getAttribute('style') || '';
          if (oldStyle.charAt(oldStyle.length - 1) !== ';') {
            oldStyle += ';';
          }
          node.setAttribute('style', oldStyle + ' ' + style);
        }

        var startTime = Date.now();
        var css3AnimationEvents = ANIMATIONEND_EVENT + ' ' + TRANSITIONEND_EVENT;
        var animationTime     = (maxDelay + maxDuration) * CLOSING_TIME_BUFFER;
        var totalTime         = (staggerTime + animationTime) * ONE_SECOND;

        var staggerTimeout;
        if (staggerTime > 0) {
          $$jqLite.addClass(element, pendingClassName);
          staggerTimeout = $timeout(function() {
            staggerTimeout = null;

            if (timings.transitionDuration > 0) {
              blockTransitions(node, false);
            }
            if (timings.animationDuration > 0) {
              blockAnimations(node, false);
            }

            $$jqLite.addClass(element, activeClassName);
            $$jqLite.removeClass(element, pendingClassName);

            if (styles) {
              if (timings.transitionDuration === 0) {
                element.css('transition', timings.animationDuration + 's linear all');
              }
              element.css(styles);
              appliedStyles.push('transition');
            }
          }, staggerTime * ONE_SECOND, false);
        }

        element.on(css3AnimationEvents, onAnimationProgress);
        elementData.closeAnimationFns.push(function() {
          onEnd();
          activeAnimationComplete();
        });

        elementData.running++;
        animationCloseHandler(element, totalTime);
        return onEnd;

        // This will automatically be called by $animate so
        // there is no need to attach this internally to the
        // timeout done method.
        function onEnd() {
          element.off(css3AnimationEvents, onAnimationProgress);
          $$jqLite.removeClass(element, activeClassName);
          $$jqLite.removeClass(element, pendingClassName);
          if (staggerTimeout) {
            $timeout.cancel(staggerTimeout);
          }
          animateClose(element, className);
          var node = extractElementNode(element);
          for (var i in appliedStyles) {
            node.style.removeProperty(appliedStyles[i]);
          }
        }

        function onAnimationProgress(event) {
          event.stopPropagation();
          var ev = event.originalEvent || event;
          var timeStamp = ev.$manualTimeStamp || ev.timeStamp || Date.now();

          /* Firefox (or possibly just Gecko) likes to not round values up
           * when a ms measurement is used for the animation */
          var elapsedTime = parseFloat(ev.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES));

          /* $manualTimeStamp is a mocked timeStamp value which is set
           * within browserTrigger(). This is only here so that tests can
           * mock animations properly. Real events fallback to event.timeStamp,
           * or, if they don't, then a timeStamp is automatically created for them.
           * We're checking to see if the timeStamp surpasses the expected delay,
           * but we're using elapsedTime instead of the timeStamp on the 2nd
           * pre-condition since animations sometimes close off early */
          if (Math.max(timeStamp - startTime, 0) >= maxDelayTime && elapsedTime >= maxDuration) {
            activeAnimationComplete();
          }
        }
      }

      function blockTransitions(node, bool) {
        node.style[TRANSITION_PROP + PROPERTY_KEY] = bool ? 'none' : '';
      }

      function blockAnimations(node, bool) {
        node.style[ANIMATION_PROP + ANIMATION_PLAYSTATE_KEY] = bool ? 'paused' : '';
      }

      function animateBefore(animationEvent, element, className, styles) {
        if (animateSetup(animationEvent, element, className, styles)) {
          return function(cancelled) {
            cancelled && animateClose(element, className);
          };
        }
      }

      function animateAfter(animationEvent, element, className, afterAnimationComplete, styles) {
        if (element.data(NG_ANIMATE_CSS_DATA_KEY)) {
          return animateRun(animationEvent, element, className, afterAnimationComplete, styles);
        } else {
          animateClose(element, className);
          afterAnimationComplete();
        }
      }

      function animate(animationEvent, element, className, animationComplete, options) {
        //If the animateSetup function doesn't bother returning a
        //cancellation function then it means that there is no animation
        //to perform at all
        var preReflowCancellation = animateBefore(animationEvent, element, className, options.from);
        if (!preReflowCancellation) {
          clearCacheAfterReflow();
          animationComplete();
          return;
        }

        //There are two cancellation functions: one is before the first
        //reflow animation and the second is during the active state
        //animation. The first function will take care of removing the
        //data from the element which will not make the 2nd animation
        //happen in the first place
        var cancel = preReflowCancellation;
        afterReflow(element, function() {
          //once the reflow is complete then we point cancel to
          //the new cancellation function which will remove all of the
          //animation properties from the active animation
          cancel = animateAfter(animationEvent, element, className, animationComplete, options.to);
        });

        return function(cancelled) {
          (cancel || noop)(cancelled);
        };
      }

      function animateClose(element, className) {
        $$jqLite.removeClass(element, className);
        var data = element.data(NG_ANIMATE_CSS_DATA_KEY);
        if (data) {
          if (data.running) {
            data.running--;
          }
          if (!data.running || data.running === 0) {
            element.removeData(NG_ANIMATE_CSS_DATA_KEY);
          }
        }
      }

      return {
        animate: function(element, className, from, to, animationCompleted, options) {
          options = options || {};
          options.from = from;
          options.to = to;
          return animate('animate', element, className, animationCompleted, options);
        },

        enter: function(element, animationCompleted, options) {
          options = options || {};
          return animate('enter', element, 'ng-enter', animationCompleted, options);
        },

        leave: function(element, animationCompleted, options) {
          options = options || {};
          return animate('leave', element, 'ng-leave', animationCompleted, options);
        },

        move: function(element, animationCompleted, options) {
          options = options || {};
          return animate('move', element, 'ng-move', animationCompleted, options);
        },

        beforeSetClass: function(element, add, remove, animationCompleted, options) {
          options = options || {};
          var className = suffixClasses(remove, '-remove') + ' ' +
                          suffixClasses(add, '-add');
          var cancellationMethod = animateBefore('setClass', element, className, options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        beforeAddClass: function(element, className, animationCompleted, options) {
          options = options || {};
          var cancellationMethod = animateBefore('addClass', element, suffixClasses(className, '-add'), options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        beforeRemoveClass: function(element, className, animationCompleted, options) {
          options = options || {};
          var cancellationMethod = animateBefore('removeClass', element, suffixClasses(className, '-remove'), options.from);
          if (cancellationMethod) {
            afterReflow(element, animationCompleted);
            return cancellationMethod;
          }
          clearCacheAfterReflow();
          animationCompleted();
        },

        setClass: function(element, add, remove, animationCompleted, options) {
          options = options || {};
          remove = suffixClasses(remove, '-remove');
          add = suffixClasses(add, '-add');
          var className = remove + ' ' + add;
          return animateAfter('setClass', element, className, animationCompleted, options.to);
        },

        addClass: function(element, className, animationCompleted, options) {
          options = options || {};
          return animateAfter('addClass', element, suffixClasses(className, '-add'), animationCompleted, options.to);
        },

        removeClass: function(element, className, animationCompleted, options) {
          options = options || {};
          return animateAfter('removeClass', element, suffixClasses(className, '-remove'), animationCompleted, options.to);
        }
      };

      function suffixClasses(classes, suffix) {
        var className = '';
        classes = isArray(classes) ? classes : classes.split(/\s+/);
        forEach(classes, function(klass, i) {
          if (klass && klass.length > 0) {
            className += (i > 0 ? ' ' : '') + klass + suffix;
          }
        });
        return className;
      }
    }]);
  }]);


})(window, window.angular);

/**
 * @license AngularJS v1.3.11
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {'use strict';

/**
 * @ngdoc module
 * @name ngAria
 * @description
 *
 * The `ngAria` module provides support for common
 * [<abbr title="Accessible Rich Internet Applications">ARIA</abbr>](http://www.w3.org/TR/wai-aria/)
 * attributes that convey state or semantic information about the application for users
 * of assistive technologies, such as screen readers.
 *
 * <div doc-module-components="ngAria"></div>
 *
 * ## Usage
 *
 * For ngAria to do its magic, simply include the module as a dependency. The directives supported
 * by ngAria are:
 * `ngModel`, `ngDisabled`, `ngShow`, `ngHide`, `ngClick`, `ngDblClick`, and `ngMessages`.
 *
 * Below is a more detailed breakdown of the attributes handled by ngAria:
 *
 * | Directive                                   | Supported Attributes                                                                   |
 * |---------------------------------------------|----------------------------------------------------------------------------------------|
 * | {@link ng.directive:ngModel ngModel}        | aria-checked, aria-valuemin, aria-valuemax, aria-valuenow, aria-invalid, aria-required |
 * | {@link ng.directive:ngDisabled ngDisabled}  | aria-disabled                                                                          |
 * | {@link ng.directive:ngShow ngShow}          | aria-hidden                                                                            |
 * | {@link ng.directive:ngHide ngHide}          | aria-hidden                                                                            |
 * | {@link ng.directive:ngClick ngClick}        | tabindex, keypress event                                                               |
 * | {@link ng.directive:ngDblclick ngDblclick}  | tabindex                                                                               |
 * | {@link module:ngMessages ngMessages}        | aria-live                                                                              |
 *
 * Find out more information about each directive by reading the
 * {@link guide/accessibility ngAria Developer Guide}.
 *
 * ##Example
 * Using ngDisabled with ngAria:
 * ```html
 * <md-checkbox ng-disabled="disabled">
 * ```
 * Becomes:
 * ```html
 * <md-checkbox ng-disabled="disabled" aria-disabled="true">
 * ```
 *
 * ##Disabling Attributes
 * It's possible to disable individual attributes added by ngAria with the
 * {@link ngAria.$ariaProvider#config config} method. For more details, see the
 * {@link guide/accessibility Developer Guide}.
 */
 /* global -ngAriaModule */
var ngAriaModule = angular.module('ngAria', ['ng']).
                        provider('$aria', $AriaProvider);

/**
 * @ngdoc provider
 * @name $ariaProvider
 *
 * @description
 *
 * Used for configuring the ARIA attributes injected and managed by ngAria.
 *
 * ```js
 * angular.module('myApp', ['ngAria'], function config($ariaProvider) {
 *   $ariaProvider.config({
 *     ariaValue: true,
 *     tabindex: false
 *   });
 * });
 *```
 *
 * ## Dependencies
 * Requires the {@link ngAria} module to be installed.
 *
 */
function $AriaProvider() {
  var config = {
    ariaHidden: true,
    ariaChecked: true,
    ariaDisabled: true,
    ariaRequired: true,
    ariaInvalid: true,
    ariaMultiline: true,
    ariaValue: true,
    tabindex: true,
    bindKeypress: true
  };

  /**
   * @ngdoc method
   * @name $ariaProvider#config
   *
   * @param {object} config object to enable/disable specific ARIA attributes
   *
   *  - **ariaHidden**  `{boolean}`  Enables/disables aria-hidden tags
   *  - **ariaChecked**  `{boolean}`  Enables/disables aria-checked tags
   *  - **ariaDisabled**  `{boolean}`  Enables/disables aria-disabled tags
   *  - **ariaRequired**  `{boolean}`  Enables/disables aria-required tags
   *  - **ariaInvalid**  `{boolean}`  Enables/disables aria-invalid tags
   *  - **ariaMultiline**  `{boolean}`  Enables/disables aria-multiline tags
   *  - **ariaValue**  `{boolean}`  Enables/disables aria-valuemin, aria-valuemax and aria-valuenow tags
   *  - **tabindex**  `{boolean}`  Enables/disables tabindex tags
   *  - **bindKeypress**  `{boolean}`  Enables/disables keypress event binding on ng-click
   *
   * @description
   * Enables/disables various ARIA attributes
   */
  this.config = function(newConfig) {
    config = angular.extend(config, newConfig);
  };

  function watchExpr(attrName, ariaAttr, negate) {
    return function(scope, elem, attr) {
      var ariaCamelName = attr.$normalize(ariaAttr);
      if (config[ariaCamelName] && !attr[ariaCamelName]) {
        scope.$watch(attr[attrName], function(boolVal) {
          if (negate) {
            boolVal = !boolVal;
          }
          elem.attr(ariaAttr, boolVal);
        });
      }
    };
  }

  /**
   * @ngdoc service
   * @name $aria
   *
   * @description
   *
   * The $aria service contains helper methods for applying common
   * [ARIA](http://www.w3.org/TR/wai-aria/) attributes to HTML directives.
   *
   * ngAria injects common accessibility attributes that tell assistive technologies when HTML
   * elements are enabled, selected, hidden, and more. To see how this is performed with ngAria,
   * let's review a code snippet from ngAria itself:
   *
   *```js
   * ngAriaModule.directive('ngDisabled', ['$aria', function($aria) {
   *   return $aria.$$watchExpr('ngDisabled', 'aria-disabled');
   * }])
   *```
   * Shown above, the ngAria module creates a directive with the same signature as the
   * traditional `ng-disabled` directive. But this ngAria version is dedicated to
   * solely managing accessibility attributes. The internal `$aria` service is used to watch the
   * boolean attribute `ngDisabled`. If it has not been explicitly set by the developer,
   * `aria-disabled` is injected as an attribute with its value synchronized to the value in
   * `ngDisabled`.
   *
   * Because ngAria hooks into the `ng-disabled` directive, developers do not have to do
   * anything to enable this feature. The `aria-disabled` attribute is automatically managed
   * simply as a silent side-effect of using `ng-disabled` with the ngAria module.
   *
   * The full list of directives that interface with ngAria:
   * * **ngModel**
   * * **ngShow**
   * * **ngHide**
   * * **ngClick**
   * * **ngDblclick**
   * * **ngMessages**
   * * **ngDisabled**
   *
   * Read the {@link guide/accessibility ngAria Developer Guide} for a thorough explanation of each
   * directive.
   *
   *
   * ## Dependencies
   * Requires the {@link ngAria} module to be installed.
   */
  this.$get = function() {
    return {
      config: function(key) {
        return config[key];
      },
      $$watchExpr: watchExpr
    };
  };
}


ngAriaModule.directive('ngShow', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngShow', 'aria-hidden', true);
}])
.directive('ngHide', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngHide', 'aria-hidden', false);
}])
.directive('ngModel', ['$aria', function($aria) {

  function shouldAttachAttr(attr, normalizedAttr, elem) {
    return $aria.config(normalizedAttr) && !elem.attr(attr);
  }

  function getShape(attr, elem) {
    var type = attr.type,
        role = attr.role;

    return ((type || role) === 'checkbox' || role === 'menuitemcheckbox') ? 'checkbox' :
           ((type || role) === 'radio'    || role === 'menuitemradio') ? 'radio' :
           (type === 'range'              || role === 'progressbar' || role === 'slider') ? 'range' :
           (type || role) === 'textbox'   || elem[0].nodeName === 'TEXTAREA' ? 'multiline' : '';
  }

  return {
    restrict: 'A',
    require: '?ngModel',
    link: function(scope, elem, attr, ngModel) {
      var shape = getShape(attr, elem);
      var needsTabIndex = shouldAttachAttr('tabindex', 'tabindex', elem);

      function ngAriaWatchModelValue() {
        return ngModel.$modelValue;
      }

      function getRadioReaction() {
        if (needsTabIndex) {
          needsTabIndex = false;
          return function ngAriaRadioReaction(newVal) {
            var boolVal = newVal === attr.value;
            elem.attr('aria-checked', boolVal);
            elem.attr('tabindex', 0 - !boolVal);
          };
        } else {
          return function ngAriaRadioReaction(newVal) {
            elem.attr('aria-checked', newVal === attr.value);
          };
        }
      }

      function ngAriaCheckboxReaction(newVal) {
        elem.attr('aria-checked', !!newVal);
      }

      switch (shape) {
        case 'radio':
        case 'checkbox':
          if (shouldAttachAttr('aria-checked', 'ariaChecked', elem)) {
            scope.$watch(ngAriaWatchModelValue, shape === 'radio' ?
                getRadioReaction() : ngAriaCheckboxReaction);
          }
          break;
        case 'range':
          if ($aria.config('ariaValue')) {
            if (attr.min && !elem.attr('aria-valuemin')) {
              elem.attr('aria-valuemin', attr.min);
            }
            if (attr.max && !elem.attr('aria-valuemax')) {
              elem.attr('aria-valuemax', attr.max);
            }
            if (!elem.attr('aria-valuenow')) {
              scope.$watch(ngAriaWatchModelValue, function ngAriaValueNowReaction(newVal) {
                elem.attr('aria-valuenow', newVal);
              });
            }
          }
          break;
        case 'multiline':
          if (shouldAttachAttr('aria-multiline', 'ariaMultiline', elem)) {
            elem.attr('aria-multiline', true);
          }
          break;
      }

      if (needsTabIndex) {
        elem.attr('tabindex', 0);
      }

      if (ngModel.$validators.required && shouldAttachAttr('aria-required', 'ariaRequired', elem)) {
        scope.$watch(function ngAriaRequiredWatch() {
          return ngModel.$error.required;
        }, function ngAriaRequiredReaction(newVal) {
          elem.attr('aria-required', !!newVal);
        });
      }

      if (shouldAttachAttr('aria-invalid', 'ariaInvalid', elem)) {
        scope.$watch(function ngAriaInvalidWatch() {
          return ngModel.$invalid;
        }, function ngAriaInvalidReaction(newVal) {
          elem.attr('aria-invalid', !!newVal);
        });
      }
    }
  };
}])
.directive('ngDisabled', ['$aria', function($aria) {
  return $aria.$$watchExpr('ngDisabled', 'aria-disabled');
}])
.directive('ngMessages', function() {
  return {
    restrict: 'A',
    require: '?ngMessages',
    link: function(scope, elem, attr, ngMessages) {
      if (!elem.attr('aria-live')) {
        elem.attr('aria-live', 'assertive');
      }
    }
  };
})
.directive('ngClick',['$aria', '$parse', function($aria, $parse) {
  return {
    restrict: 'A',
    compile: function(elem, attr) {
      var fn = $parse(attr.ngClick, /* interceptorFn */ null, /* expensiveChecks */ true);
      return function(scope, elem, attr) {
        if ($aria.config('tabindex') && !elem.attr('tabindex')) {
          elem.attr('tabindex', 0);
        }

        if ($aria.config('bindKeypress') && !attr.ngKeypress) {
          elem.on('keypress', function(event) {
            if (event.keyCode === 32 || event.keyCode === 13) {
              scope.$apply(callback);
            }

            function callback() {
              fn(scope, { $event: event });
            }
          });
        }
      };
    }
  };
}])
.directive('ngDblclick', ['$aria', function($aria) {
  return function(scope, elem, attr) {
    if ($aria.config('tabindex') && !elem.attr('tabindex')) {
      elem.attr('tabindex', 0);
    }
  };
}]);


})(window, window.angular);

/*!
 * Angular Material Design
 * https://github.com/angular/material
 * @license MIT
 * v0.10.0-master-6e9abdd
 */
(function( window, angular, undefined ){
"use strict";

(function(){
"use strict";

angular.module('ngMaterial', ["ng","ngAnimate","ngAria","material.core","material.core.gestures","material.core.theming.palette","material.core.theming","material.components.autocomplete","material.components.backdrop","material.components.bottomSheet","material.components.button","material.components.card","material.components.checkbox","material.components.chips","material.components.content","material.components.dialog","material.components.divider","material.components.fabActions","material.components.fabSpeedDial","material.components.fabToolbar","material.components.fabTrigger","material.components.gridList","material.components.icon","material.components.input","material.components.list","material.components.menu","material.components.progressCircular","material.components.progressLinear","material.components.radioButton","material.components.select","material.components.sidenav","material.components.slider","material.components.sticky","material.components.subheader","material.components.swipe","material.components.switch","material.components.tabs","material.components.toast","material.components.toolbar","material.components.tooltip","material.components.whiteframe"]);
})();
(function(){
"use strict";


/**
 * Initialization function that validates environment
 * requirements.
 */
angular
  .module('material.core', [ 'material.core.gestures', 'material.core.theming' ])
  .config( MdCoreConfigure );


function MdCoreConfigure($provide, $mdThemingProvider) {

  $provide.decorator('$$rAF', ["$delegate", rAFDecorator]);

  $mdThemingProvider.theme('default')
    .primaryPalette('indigo')
    .accentPalette('pink')
    .warnPalette('red')
    .backgroundPalette('grey');
}
MdCoreConfigure.$inject = ["$provide", "$mdThemingProvider"];

function rAFDecorator( $delegate ) {
  /**
   * Use this to throttle events that come in often.
   * The throttled function will always use the *last* invocation before the
   * coming frame.
   *
   * For example, window resize events that fire many times a second:
   * If we set to use an raf-throttled callback on window resize, then
   * our callback will only be fired once per frame, with the last resize
   * event that happened before that frame.
   *
   * @param {function} callback function to debounce
   */
  $delegate.throttle = function(cb) {
    var queueArgs, alreadyQueued, queueCb, context;
    return function debounced() {
      queueArgs = arguments;
      context = this;
      queueCb = cb;
      if (!alreadyQueued) {
        alreadyQueued = true;
        $delegate(function() {
          queueCb.apply(context, queueArgs);
          alreadyQueued = false;
        });
      }
    };
  };
  return $delegate;
}

})();
(function(){
"use strict";

angular.module('material.core')
.factory('$mdConstant', MdConstantFactory);

function MdConstantFactory($$rAF, $sniffer) {

  var webkit = /webkit/i.test($sniffer.vendorPrefix);
  function vendorProperty(name) {
    return webkit ?  ('webkit' + name.charAt(0).toUpperCase() + name.substring(1)) : name;
  }

  return {
    KEY_CODE: {
      ENTER: 13,
      ESCAPE: 27,
      SPACE: 32,
      LEFT_ARROW : 37,
      UP_ARROW : 38,
      RIGHT_ARROW : 39,
      DOWN_ARROW : 40,
      TAB : 9,
      BACKSPACE: 8,
      DELETE: 46
    },
    CSS: {
      /* Constants */
      TRANSITIONEND: 'transitionend' + (webkit ? ' webkitTransitionEnd' : ''),
      ANIMATIONEND: 'animationend' + (webkit ? ' webkitAnimationEnd' : ''),

      TRANSFORM: vendorProperty('transform'),
      TRANSFORM_ORIGIN: vendorProperty('transformOrigin'),
      TRANSITION: vendorProperty('transition'),
      TRANSITION_DURATION: vendorProperty('transitionDuration'),
      ANIMATION_PLAY_STATE: vendorProperty('animationPlayState'),
      ANIMATION_DURATION: vendorProperty('animationDuration'),
      ANIMATION_NAME: vendorProperty('animationName'),
      ANIMATION_TIMING: vendorProperty('animationTimingFunction'),
      ANIMATION_DIRECTION: vendorProperty('animationDirection')
    },
    MEDIA: {
      'sm': '(max-width: 600px)',
      'gt-sm': '(min-width: 600px)',
      'md': '(min-width: 600px) and (max-width: 960px)',
      'gt-md': '(min-width: 960px)',
      'lg': '(min-width: 960px) and (max-width: 1200px)',
      'gt-lg': '(min-width: 1200px)'
    },
    MEDIA_PRIORITY: [
      'gt-lg',
      'lg',
      'gt-md',
      'md',
      'gt-sm',
      'sm'
    ]
  };
}
MdConstantFactory.$inject = ["$$rAF", "$sniffer"];

})();
(function(){
"use strict";

  angular
    .module('material.core')
    .config( ["$provide", function($provide){
       $provide.decorator('$mdUtil', ['$delegate', function ($delegate){
           /**
            * Inject the iterator facade to easily support iteration and accessors
            * @see iterator below
            */
           $delegate.iterator = MdIterator;

           return $delegate;
         }
       ]);
     }]);

  /**
   * iterator is a list facade to easily support iteration and accessors
   *
   * @param items Array list which this iterator will enumerate
   * @param reloop Boolean enables iterator to consider the list as an endless reloop
   */
  function MdIterator(items, reloop) {
    var trueFn = function() { return true; };

    if (items && !angular.isArray(items)) {
      items = Array.prototype.slice.call(items);
    }

    reloop = !!reloop;
    var _items = items || [ ];

    // Published API
    return {
      items: getItems,
      count: count,

      inRange: inRange,
      contains: contains,
      indexOf: indexOf,
      itemAt: itemAt,

      findBy: findBy,

      add: add,
      remove: remove,

      first: first,
      last: last,
      next: angular.bind(null, findSubsequentItem, false),
      previous: angular.bind(null, findSubsequentItem, true),

      hasPrevious: hasPrevious,
      hasNext: hasNext

    };

    /**
     * Publish copy of the enumerable set
     * @returns {Array|*}
     */
    function getItems() {
      return [].concat(_items);
    }

    /**
     * Determine length of the list
     * @returns {Array.length|*|number}
     */
    function count() {
      return _items.length;
    }

    /**
     * Is the index specified valid
     * @param index
     * @returns {Array.length|*|number|boolean}
     */
    function inRange(index) {
      return _items.length && ( index > -1 ) && (index < _items.length );
    }

    /**
     * Can the iterator proceed to the next item in the list; relative to
     * the specified item.
     *
     * @param item
     * @returns {Array.length|*|number|boolean}
     */
    function hasNext(item) {
      return item ? inRange(indexOf(item) + 1) : false;
    }

    /**
     * Can the iterator proceed to the previous item in the list; relative to
     * the specified item.
     *
     * @param item
     * @returns {Array.length|*|number|boolean}
     */
    function hasPrevious(item) {
      return item ? inRange(indexOf(item) - 1) : false;
    }

    /**
     * Get item at specified index/position
     * @param index
     * @returns {*}
     */
    function itemAt(index) {
      return inRange(index) ? _items[index] : null;
    }

    /**
     * Find all elements matching the key/value pair
     * otherwise return null
     *
     * @param val
     * @param key
     *
     * @return array
     */
    function findBy(key, val) {
      return _items.filter(function(item) {
        return item[key] === val;
      });
    }

    /**
     * Add item to list
     * @param item
     * @param index
     * @returns {*}
     */
    function add(item, index) {
      if ( !item ) return -1;

      if (!angular.isNumber(index)) {
        index = _items.length;
      }

      _items.splice(index, 0, item);

      return indexOf(item);
    }

    /**
     * Remove item from list...
     * @param item
     */
    function remove(item) {
      if ( contains(item) ){
        _items.splice(indexOf(item), 1);
      }
    }

    /**
     * Get the zero-based index of the target item
     * @param item
     * @returns {*}
     */
    function indexOf(item) {
      return _items.indexOf(item);
    }

    /**
     * Boolean existence check
     * @param item
     * @returns {boolean}
     */
    function contains(item) {
      return item && (indexOf(item) > -1);
    }

    /**
     * Return first item in the list
     * @returns {*}
     */
    function first() {
      return _items.length ? _items[0] : null;
    }

    /**
     * Return last item in the list...
     * @returns {*}
     */
    function last() {
      return _items.length ? _items[_items.length - 1] : null;
    }

    /**
     * Find the next item. If reloop is true and at the end of the list, it will go back to the
     * first item. If given, the `validate` callback will be used to determine whether the next item
     * is valid. If not valid, it will try to find the next item again.
     *
     * @param {boolean} backwards Specifies the direction of searching (forwards/backwards)
     * @param {*} item The item whose subsequent item we are looking for
     * @param {Function=} validate The `validate` function
     * @param {integer=} limit The recursion limit
     *
     * @returns {*} The subsequent item or null
     */
    function findSubsequentItem(backwards, item, validate, limit) {
      validate = validate || trueFn;

      var curIndex = indexOf(item);
      while (true) {
        if (!inRange(curIndex)) return null;

        var nextIndex = curIndex + (backwards ? -1 : 1);
        var foundItem = null;
        if (inRange(nextIndex)) {
          foundItem = _items[nextIndex];
        } else if (reloop) {
          foundItem = backwards ? last() : first();
          nextIndex = indexOf(foundItem);
        }

        if ((foundItem === null) || (nextIndex === limit)) return null;
        if (validate(foundItem)) return foundItem;

        if (angular.isUndefined(limit)) limit = nextIndex;

        curIndex = nextIndex;
      }
    }
  }


})();
(function(){
"use strict";

angular.module('material.core')
.factory('$mdMedia', mdMediaFactory);

/**
 * @ngdoc service
 * @name $mdMedia
 * @module material.core
 *
 * @description
 * `$mdMedia` is used to evaluate whether a given media query is true or false given the
 * current device's screen / window size. The media query will be re-evaluated on resize, allowing
 * you to register a watch.
 *
 * `$mdMedia` also has pre-programmed support for media queries that match the layout breakpoints.
 *  (`sm`, `gt-sm`, `md`, `gt-md`, `lg`, `gt-lg`).
 *
 * @returns {boolean} a boolean representing whether or not the given media query is true or false.
 *
 * @usage
 * <hljs lang="js">
 * app.controller('MyController', function($mdMedia, $scope) {
 *   $scope.$watch(function() { return $mdMedia('lg'); }, function(big) {
 *     $scope.bigScreen = big;
 *   });
 *
 *   $scope.screenIsSmall = $mdMedia('sm');
 *   $scope.customQuery = $mdMedia('(min-width: 1234px)');
 *   $scope.anotherCustom = $mdMedia('max-width: 300px');
 * });
 * </hljs>
 */

function mdMediaFactory($mdConstant, $rootScope, $window) {
  var queries = {};
  var mqls = {};
  var results = {};
  var normalizeCache = {};

  $mdMedia.getResponsiveAttribute = getResponsiveAttribute;
  $mdMedia.getQuery = getQuery;
  $mdMedia.watchResponsiveAttributes = watchResponsiveAttributes;

  return $mdMedia;

  function $mdMedia(query) {
    var validated = queries[query];
    if (angular.isUndefined(validated)) {
      validated = queries[query] = validate(query);
    }

    var result = results[validated];
    if (angular.isUndefined(result)) {
      result = add(validated);
    }

    return result;
  }

  function validate(query) {
    return $mdConstant.MEDIA[query] ||
           ((query.charAt(0) !== '(') ? ('(' + query + ')') : query);
  }

  function add(query) {
    var result = mqls[query] = $window.matchMedia(query);
    result.addListener(onQueryChange);
    return (results[result.media] = !!result.matches);
  }

  function onQueryChange(query) {
    $rootScope.$evalAsync(function() {
      results[query.media] = !!query.matches;
    });
  }

  function getQuery(name) {
    return mqls[name];
  }

  function getResponsiveAttribute(attrs, attrName) {
    for (var i = 0; i < $mdConstant.MEDIA_PRIORITY.length; i++) {
      var mediaName = $mdConstant.MEDIA_PRIORITY[i];
      if (!mqls[queries[mediaName]].matches) {
        continue;
      }

      var normalizedName = getNormalizedName(attrs, attrName + '-' + mediaName);
      if (attrs[normalizedName]) {
        return attrs[normalizedName];
      }
    }

    // fallback on unprefixed
    return attrs[getNormalizedName(attrs, attrName)];
  }

  function watchResponsiveAttributes(attrNames, attrs, watchFn) {
    var unwatchFns = [];
    attrNames.forEach(function(attrName) {
      var normalizedName = getNormalizedName(attrs, attrName);
      if (attrs[normalizedName]) {
        unwatchFns.push(
            attrs.$observe(normalizedName, angular.bind(void 0, watchFn, null)));
      }

      for (var mediaName in $mdConstant.MEDIA) {
        normalizedName = getNormalizedName(attrs, attrName + '-' + mediaName);
        if (!attrs[normalizedName]) {
          return;
        }

        unwatchFns.push(attrs.$observe(normalizedName, angular.bind(void 0, watchFn, mediaName)));
      }
    });

    return function unwatch() {
      unwatchFns.forEach(function(fn) { fn(); })
    };
  }

  // Improves performance dramatically
  function getNormalizedName(attrs, attrName) {
    return normalizeCache[attrName] ||
        (normalizeCache[attrName] = attrs.$normalize(attrName));
  }
}
mdMediaFactory.$inject = ["$mdConstant", "$rootScope", "$window"];

})();
(function(){
"use strict";

/*
 * This var has to be outside the angular factory, otherwise when
 * there are multiple material apps on the same page, each app
 * will create its own instance of this array and the app's IDs
 * will not be unique.
 */
var nextUniqueId = 0;

angular.module('material.core')
  .factory('$mdUtil', ["$cacheFactory", "$document", "$timeout", "$q", "$window", "$mdConstant", function ($cacheFactory, $document, $timeout, $q, $window, $mdConstant) {
    var Util;

    function getNode(el) {
      return el[0] || el;
    }

    return Util = {
      now: window.performance ?
        angular.bind(window.performance, window.performance.now) :
        Date.now,

      clientRect: function (element, offsetParent, isOffsetRect) {
        var node = getNode(element);
        offsetParent = getNode(offsetParent || node.offsetParent || document.body);
        var nodeRect = node.getBoundingClientRect();

        // The user can ask for an offsetRect: a rect relative to the offsetParent,
        // or a clientRect: a rect relative to the page
        var offsetRect = isOffsetRect ?
          offsetParent.getBoundingClientRect() :
        {left: 0, top: 0, width: 0, height: 0};
        return {
          left: nodeRect.left - offsetRect.left,
          top: nodeRect.top - offsetRect.top,
          width: nodeRect.width,
          height: nodeRect.height
        };
      },
      offsetRect: function (element, offsetParent) {
        return Util.clientRect(element, offsetParent, true);
      },

      // Annoying method to copy nodes to an array, thanks to IE
      nodesToArray: function (nodes) {
        var results = [];
        for (var i = 0; i < nodes.length; ++i) {
          results.push(nodes.item(i));
        }
        return results;
      },

      // Disables scroll around the passed element.
      disableScrollAround: function (element) {
        if (Util.disableScrollAround._enableScrolling) return Util.disableScrollAround._enableScrolling;
        element = angular.element(element);
        var body = $document[0].body,
          restoreBody = disableBodyScroll(),
          restoreElement = disableElementScroll();

        return Util.disableScrollAround._enableScrolling = function () {
          restoreBody();
          restoreElement();
          delete Util.disableScrollAround._enableScrolling;
        };

        // Creates a virtual scrolling mask to absorb touchmove, keyboard, scrollbar clicking, and wheel events
        function disableElementScroll() {
          var zIndex = $window.getComputedStyle(element[0]).zIndex - 1;
          if (isNaN(zIndex)) zIndex = 99;
          var scrollMask = angular.element(
            '<div class="md-scroll-mask" style="z-index: ' + zIndex + '">' +
            '  <div class="md-scroll-mask-bar"></div>' +
            '</div>');
          body.appendChild(scrollMask[0]);

          scrollMask.on('wheel', preventDefault);
          scrollMask.on('touchmove', preventDefault);
          $document.on('keydown', disableKeyNav);

          return function restoreScroll() {
            scrollMask.off('wheel');
            scrollMask.off('touchmove');
            scrollMask[0].parentNode.removeChild(scrollMask[0]);
            $document.off('keydown', disableKeyNav);
            delete Util.disableScrollAround._enableScrolling;
          };

          // Prevent keypresses from elements inside the body
          // used to stop the keypresses that could cause the page to scroll
          // (arrow keys, spacebar, tab, etc).
          function disableKeyNav(e) {
            //-- temporarily removed this logic, will possibly re-add at a later date
            return;
            if (!element[0].contains(e.target)) {
              e.preventDefault();
              e.stopImmediatePropagation();
            }
          }

          function preventDefault(e) {
            e.preventDefault();
          }
        }

        // Converts the body to a position fixed block and translate it to the proper scroll
        // position
        function disableBodyScroll() {
          var restoreStyle = body.getAttribute('style') || '';
          var scrollOffset = body.scrollTop + body.parentElement.scrollTop;
          var clientWidth = body.clientWidth;

          applyStyles(body, {
            position: 'fixed',
            width: '100%',
            overflowY: 'scroll',
            top: -scrollOffset + 'px'
          });

          if (body.clientWidth < clientWidth) applyStyles(body, {overflow: 'hidden'});

          return function restoreScroll() {
            body.setAttribute('style', restoreStyle);
            body.scrollTop = scrollOffset;
          };
        }

        function applyStyles(el, styles) {
          for (var key in styles) {
            el.style[key] = styles[key];
          }
        }
      },
      enableScrolling: function () {
        var method = this.disableScrollAround._enableScrolling;
        method && method();
      },
      floatingScrollbars: function () {
        if (this.floatingScrollbars.cached === undefined) {
          var tempNode = angular.element('<div style="width: 100%; z-index: -1; position: absolute; height: 35px; overflow-y: scroll"><div style="height: 60;"></div></div>');
          $document[0].body.appendChild(tempNode[0]);
          this.floatingScrollbars.cached = (tempNode[0].offsetWidth == tempNode[0].childNodes[0].offsetWidth);
          tempNode.remove();
        }
        return this.floatingScrollbars.cached;
      },

      // Mobile safari only allows you to set focus in click event listeners...
      forceFocus: function (element) {
        var node = element[0] || element;

        document.addEventListener('click', function focusOnClick(ev) {
          if (ev.target === node && ev.$focus) {
            node.focus();
            ev.stopImmediatePropagation();
            ev.preventDefault();
            node.removeEventListener('click', focusOnClick);
          }
        }, true);

        var newEvent = document.createEvent('MouseEvents');
        newEvent.initMouseEvent('click', false, true, window, {}, 0, 0, 0, 0,
          false, false, false, false, 0, null);
        newEvent.$material = true;
        newEvent.$focus = true;
        node.dispatchEvent(newEvent);
      },

      transitionEndPromise: function (element, opts) {
        opts = opts || {};
        var deferred = $q.defer();
        element.on($mdConstant.CSS.TRANSITIONEND, finished);
        function finished(ev) {
          // Make sure this transitionend didn't bubble up from a child
          if (!ev || ev.target === element[0]) {
            element.off($mdConstant.CSS.TRANSITIONEND, finished);
            deferred.resolve();
          }
        }

        if (opts.timeout) $timeout(finished, opts.timeout);
        return deferred.promise;
      },

      fakeNgModel: function () {
        return {
          $fake: true,
          $setTouched: angular.noop,
          $setViewValue: function (value) {
            this.$viewValue = value;
            this.$render(value);
            this.$viewChangeListeners.forEach(function (cb) {
              cb();
            });
          },
          $isEmpty: function (value) {
            return ('' + value).length === 0;
          },
          $parsers: [],
          $formatters: [],
          $viewChangeListeners: [],
          $render: angular.noop
        };
      },

      // Returns a function, that, as long as it continues to be invoked, will not
      // be triggered. The function will be called after it stops being called for
      // N milliseconds.
      // @param wait Integer value of msecs to delay (since last debounce reset); default value 10 msecs
      // @param invokeApply should the $timeout trigger $digest() dirty checking
      debounce: function (func, wait, scope, invokeApply) {
        var timer;

        return function debounced() {
          var context = scope,
            args = Array.prototype.slice.call(arguments);

          $timeout.cancel(timer);
          timer = $timeout(function () {

            timer = undefined;
            func.apply(context, args);

          }, wait || 10, invokeApply);
        };
      },

      // Returns a function that can only be triggered every `delay` milliseconds.
      // In other words, the function will not be called unless it has been more
      // than `delay` milliseconds since the last call.
      throttle: function throttle(func, delay) {
        var recent;
        return function throttled() {
          var context = this;
          var args = arguments;
          var now = Util.now();

          if (!recent || (now - recent > delay)) {
            func.apply(context, args);
            recent = now;
          }
        };
      },

      /**
       * Measures the number of milliseconds taken to run the provided callback
       * function. Uses a high-precision timer if available.
       */
      time: function time(cb) {
        var start = Util.now();
        cb();
        return Util.now() - start;
      },

      /**
       * Get a unique ID.
       *
       * @returns {string} an unique numeric string
       */
      nextUid: function () {
        return '' + nextUniqueId++;
      },

      // Stop watchers and events from firing on a scope without destroying it,
      // by disconnecting it from its parent and its siblings' linked lists.
      disconnectScope: function disconnectScope(scope) {
        if (!scope) return;

        // we can't destroy the root scope or a scope that has been already destroyed
        if (scope.$root === scope) return;
        if (scope.$$destroyed) return;

        var parent = scope.$parent;
        scope.$$disconnected = true;

        // See Scope.$destroy
        if (parent.$$childHead === scope) parent.$$childHead = scope.$$nextSibling;
        if (parent.$$childTail === scope) parent.$$childTail = scope.$$prevSibling;
        if (scope.$$prevSibling) scope.$$prevSibling.$$nextSibling = scope.$$nextSibling;
        if (scope.$$nextSibling) scope.$$nextSibling.$$prevSibling = scope.$$prevSibling;

        scope.$$nextSibling = scope.$$prevSibling = null;

      },

      // Undo the effects of disconnectScope above.
      reconnectScope: function reconnectScope(scope) {
        if (!scope) return;

        // we can't disconnect the root node or scope already disconnected
        if (scope.$root === scope) return;
        if (!scope.$$disconnected) return;

        var child = scope;

        var parent = child.$parent;
        child.$$disconnected = false;
        // See Scope.$new for this logic...
        child.$$prevSibling = parent.$$childTail;
        if (parent.$$childHead) {
          parent.$$childTail.$$nextSibling = child;
          parent.$$childTail = child;
        } else {
          parent.$$childHead = parent.$$childTail = child;
        }
      },

      /*
       * getClosest replicates jQuery.closest() to walk up the DOM tree until it finds a matching nodeName
       *
       * @param el Element to start walking the DOM from
       * @param tagName Tag name to find closest to el, such as 'form'
       */
      getClosest: function getClosest(el, tagName, onlyParent) {
        if (el instanceof angular.element) el = el[0];
        tagName = tagName.toUpperCase();
        if (onlyParent) el = el.parentNode;
        if (!el) return null;
        do {
          if (el.nodeName === tagName) {
            return el;
          }
        } while (el = el.parentNode);
        return null;
      },

      /**
       * Functional equivalent for $element.filter(md-bottom-sheet)
       * useful with interimElements where the element and its container are important...
       */
      extractElementByName: function (element, nodeName) {
        for (var i = 0, len = element.length; i < len; i++) {
          if (element[i].nodeName.toLowerCase() === nodeName) {
            return angular.element(element[i]);
          }
        }
        return element;
      },

      /**
       * Give optional properties with no value a boolean true if attr provided or false otherwise
       */
      initOptionalProperties: function (scope, attr, defaults) {
        defaults = defaults || {};
        angular.forEach(scope.$$isolateBindings, function (binding, key) {
          if (binding.optional && angular.isUndefined(scope[key])) {
            var attrIsDefined = angular.isDefined(attr[binding.attrName]);
            scope[key] = angular.isDefined(defaults[key]) ? defaults[key] : attrIsDefined;
          }
        });
      }

    };

  }]);

/*
 * Since removing jQuery from the demos, some code that uses `element.focus()` is broken.
 *
 * We need to add `element.focus()`, because it's testable unlike `element[0].focus`.
 *
 * TODO(ajoslin): This should be added in a better place later.
 */

angular.element.prototype.focus = angular.element.prototype.focus || function () {
    if (this.length) {
      this[0].focus();
    }
    return this;
  };
angular.element.prototype.blur = angular.element.prototype.blur || function () {
    if (this.length) {
      this[0].blur();
    }
    return this;
  };

})();
(function(){
"use strict";


angular.module('material.core')
  .service('$mdAria', AriaService);

/*
 * @ngInject
 */
function AriaService($$rAF, $log, $window) {

  return {
    expect: expect,
    expectAsync: expectAsync,
    expectWithText: expectWithText
  };

  /**
   * Check if expected attribute has been specified on the target element or child
   * @param element
   * @param attrName
   * @param {optional} defaultValue What to set the attr to if no value is found
   */
  function expect(element, attrName, defaultValue) {
    var node = element[0] || element;

    // if node exists and neither it nor its children have the attribute
    if (node &&
       ((!node.hasAttribute(attrName) ||
        node.getAttribute(attrName).length === 0) &&
        !childHasAttribute(node, attrName))) {

      defaultValue = angular.isString(defaultValue) ? defaultValue.trim() : '';
      if (defaultValue.length) {
        element.attr(attrName, defaultValue);
      } else {
        $log.warn('ARIA: Attribute "', attrName, '", required for accessibility, is missing on node:', node);
      }

    }
  }

  function expectAsync(element, attrName, defaultValueGetter) {
    // Problem: when retrieving the element's contents synchronously to find the label,
    // the text may not be defined yet in the case of a binding.
    // There is a higher chance that a binding will be defined if we wait one frame.
    $$rAF(function() {
      expect(element, attrName, defaultValueGetter());
    });
  }

  function expectWithText(element, attrName) {
    expectAsync(element, attrName, function() {
      return getText(element);
    });
  }

  function getText(element) {
    return element.text().trim();
  }

  function childHasAttribute(node, attrName) {
    var hasChildren = node.hasChildNodes(),
        hasAttr = false;

    function isHidden(el) {
      var style = el.currentStyle ? el.currentStyle : $window.getComputedStyle(el);
      return (style.display === 'none');
    }

    if(hasChildren) {
      var children = node.childNodes;
      for(var i=0; i<children.length; i++){
        var child = children[i];
        if(child.nodeType === 1 && child.hasAttribute(attrName)) {
          if(!isHidden(child)){
            hasAttr = true;
          }
        }
      }
    }
    return hasAttr;
  }
}
AriaService.$inject = ["$$rAF", "$log", "$window"];

})();
(function(){
"use strict";

angular.module('material.core')
  .service('$mdCompiler', mdCompilerService);

function mdCompilerService($q, $http, $injector, $compile, $controller, $templateCache) {
  /* jshint validthis: true */

  /*
   * @ngdoc service
   * @name $mdCompiler
   * @module material.core
   * @description
   * The $mdCompiler service is an abstraction of angular's compiler, that allows the developer
   * to easily compile an element with a templateUrl, controller, and locals.
   *
   * @usage
   * <hljs lang="js">
   * $mdCompiler.compile({
   *   templateUrl: 'modal.html',
   *   controller: 'ModalCtrl',
   *   locals: {
   *     modal: myModalInstance;
   *   }
   * }).then(function(compileData) {
   *   compileData.element; // modal.html's template in an element
   *   compileData.link(myScope); //attach controller & scope to element
   * });
   * </hljs>
   */

   /*
    * @ngdoc method
    * @name $mdCompiler#compile
    * @description A helper to compile an HTML template/templateUrl with a given controller,
    * locals, and scope.
    * @param {object} options An options object, with the following properties:
    *
    *    - `controller` - `{(string=|function()=}` Controller fn that should be associated with
    *      newly created scope or the name of a registered controller if passed as a string.
    *    - `controllerAs` - `{string=}` A controller alias name. If present the controller will be
    *      published to scope under the `controllerAs` name.
    *    - `template` - `{string=}` An html template as a string.
    *    - `templateUrl` - `{string=}` A path to an html template.
    *    - `transformTemplate` - `{function(template)=}` A function which transforms the template after
    *      it is loaded. It will be given the template string as a parameter, and should
    *      return a a new string representing the transformed template.
    *    - `resolve` - `{Object.<string, function>=}` - An optional map of dependencies which should
    *      be injected into the controller. If any of these dependencies are promises, the compiler
    *      will wait for them all to be resolved, or if one is rejected before the controller is
    *      instantiated `compile()` will fail..
    *      * `key` - `{string}`: a name of a dependency to be injected into the controller.
    *      * `factory` - `{string|function}`: If `string` then it is an alias for a service.
    *        Otherwise if function, then it is injected and the return value is treated as the
    *        dependency. If the result is a promise, it is resolved before its value is 
    *        injected into the controller.
    *
    * @returns {object=} promise A promise, which will be resolved with a `compileData` object.
    * `compileData` has the following properties: 
    *
    *   - `element` - `{element}`: an uncompiled element matching the provided template.
    *   - `link` - `{function(scope)}`: A link function, which, when called, will compile
    *     the element and instantiate the provided controller (if given).
    *   - `locals` - `{object}`: The locals which will be passed into the controller once `link` is
    *     called. If `bindToController` is true, they will be coppied to the ctrl instead
    *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in.
    */
  this.compile = function(options) {
    var templateUrl = options.templateUrl;
    var template = options.template || '';
    var controller = options.controller;
    var controllerAs = options.controllerAs;
    var resolve = options.resolve || {};
    var locals = options.locals || {};
    var transformTemplate = options.transformTemplate || angular.identity;
    var bindToController = options.bindToController;

    // Take resolve values and invoke them.  
    // Resolves can either be a string (value: 'MyRegisteredAngularConst'),
    // or an invokable 'factory' of sorts: (value: function ValueGetter($dependency) {})
    angular.forEach(resolve, function(value, key) {
      if (angular.isString(value)) {
        resolve[key] = $injector.get(value);
      } else {
        resolve[key] = $injector.invoke(value);
      }
    });
    //Add the locals, which are just straight values to inject
    //eg locals: { three: 3 }, will inject three into the controller
    angular.extend(resolve, locals);

    if (templateUrl) {
      resolve.$template = $http.get(templateUrl, {cache: $templateCache})
        .then(function(response) {
          return response.data;
        });
    } else {
      resolve.$template = $q.when(template);
    }

    // Wait for all the resolves to finish if they are promises
    return $q.all(resolve).then(function(locals) {

      var template = transformTemplate(locals.$template);
      var element = options.element || angular.element('<div>').html(template.trim()).contents();
      var linkFn = $compile(element);

      //Return a linking function that can be used later when the element is ready
      return {
        locals: locals,
        element: element,
        link: function link(scope) {
          locals.$scope = scope;

          //Instantiate controller if it exists, because we have scope
          if (controller) {
            var invokeCtrl = $controller(controller, locals, true);
            if (bindToController) {
              angular.extend(invokeCtrl.instance, locals);
            }
            var ctrl = invokeCtrl();
            //See angular-route source for this logic
            element.data('$ngControllerController', ctrl);
            element.children().data('$ngControllerController', ctrl);

            if (controllerAs) {
              scope[controllerAs] = ctrl;
            }
          }
          return linkFn(scope);
        }
      };
    });

  };
}
mdCompilerService.$inject = ["$q", "$http", "$injector", "$compile", "$controller", "$templateCache"];

})();
(function(){
"use strict";

  var HANDLERS = {};
  /* The state of the current 'pointer'
   * The pointer represents the state of the current touch.
   * It contains normalized x and y coordinates from DOM events,
   * as well as other information abstracted from the DOM.
   */
  var pointer, lastPointer, forceSkipClickHijack = false;

  // Used to attach event listeners once when multiple ng-apps are running.
  var isInitialized = false;
  
  angular
    .module('material.core.gestures', [ ])
    .provider('$mdGesture', MdGestureProvider)
    .factory('$$MdGestureHandler', MdGestureHandler)
    .run( attachToDocument );

  /**
     * @ngdoc service
     * @name $mdGestureProvider
     * @module material.core.gestures
     *
     * @description
     * In some scenarios on Mobile devices (without jQuery), the click events should NOT be hijacked.
     * `$mdGestureProvider` is used to configure the Gesture module to ignore or skip click hijacking on mobile
     * devices.
     *
     * <hljs lang="js">
     *   app.config(function($mdGestureProvider) {
     *
     *     // For mobile devices without jQuery loaded, do not
     *     // intercept click events during the capture phase.
     *     $mdGestureProvider.skipClickHijack();
     *
     *   });
     * </hljs>
     *
     */
  function MdGestureProvider() { }

  MdGestureProvider.prototype = {

    // Publish access to setter to configure a variable  BEFORE the
    // $mdGesture service is instantiated...
    skipClickHijack: function() {
      return forceSkipClickHijack = true;
    },

    /**
     * $get is used to build an instance of $mdGesture
     * @ngInject
     */
    $get : ["$$MdGestureHandler", "$$rAF", "$timeout", function($$MdGestureHandler, $$rAF, $timeout) {
         return new MdGesture($$MdGestureHandler, $$rAF, $timeout);
    }]
  };



  /**
   * MdGesture factory construction function
   * @ngInject
   */
  function MdGesture($$MdGestureHandler, $$rAF, $timeout) {
    var userAgent = navigator.userAgent || navigator.vendor || window.opera;
    var isIos = userAgent.match(/ipad|iphone|ipod/i);
    var isAndroid = userAgent.match(/android/i);
    var hasJQuery =  (typeof window.jQuery !== 'undefined') && (angular.element === window.jQuery);

    var self = {
      handler: addHandler,
      register: register,
      // On mobile w/out jQuery, we normally intercept clicks. Should we skip that?
      isHijackingClicks: (isIos || isAndroid) && !hasJQuery && !forceSkipClickHijack
    };

    if (self.isHijackingClicks) {
      self.handler('click', {
        options: {
          maxDistance: 6
        },
        onEnd: function (ev, pointer) {
          if (pointer.distance < this.state.options.maxDistance) {
            this.dispatchEvent(ev, 'click');
          }
        }
      });
    }

    /*
     * Register an element to listen for a handler.
     * This allows an element to override the default options for a handler.
     * Additionally, some handlers like drag and hold only dispatch events if
     * the domEvent happens inside an element that's registered to listen for these events.
     *
     * @see GestureHandler for how overriding of default options works.
     * @example $mdGesture.register(myElement, 'drag', { minDistance: 20, horziontal: false })
     */
    function register(element, handlerName, options) {
      var handler = HANDLERS[handlerName.replace(/^\$md./, '')];
      if (!handler) {
        throw new Error('Failed to register element with handler ' + handlerName + '. ' +
        'Available handlers: ' + Object.keys(HANDLERS).join(', '));
      }
      return handler.registerElement(element, options);
    }

    /*
     * add a handler to $mdGesture. see below.
     */
    function addHandler(name, definition) {
      var handler = new $$MdGestureHandler(name);
      angular.extend(handler, definition);
      HANDLERS[name] = handler;

      return self;
    }

    /*
     * Register handlers. These listen to touch/start/move events, interpret them,
     * and dispatch gesture events depending on options & conditions. These are all
     * instances of GestureHandler.
     * @see GestureHandler 
     */
    return self
      /*
       * The press handler dispatches an event on touchdown/touchend.
       * It's a simple abstraction of touch/mouse/pointer start and end.
       */
      .handler('press', {
        onStart: function (ev, pointer) {
          this.dispatchEvent(ev, '$md.pressdown');
        },
        onEnd: function (ev, pointer) {
          this.dispatchEvent(ev, '$md.pressup');
        }
      })

      /*
       * The hold handler dispatches an event if the user keeps their finger within
       * the same <maxDistance> area for <delay> ms.
       * The hold handler will only run if a parent of the touch target is registered
       * to listen for hold events through $mdGesture.register()
       */
      .handler('hold', {
        options: {
          maxDistance: 6,
          delay: 500
        },
        onCancel: function () {
          $timeout.cancel(this.state.timeout);
        },
        onStart: function (ev, pointer) {
          // For hold, require a parent to be registered with $mdGesture.register()
          // Because we prevent scroll events, this is necessary.
          if (!this.state.registeredParent) return this.cancel();

          this.state.pos = {x: pointer.x, y: pointer.y};
          this.state.timeout = $timeout(angular.bind(this, function holdDelayFn() {
            this.dispatchEvent(ev, '$md.hold');
            this.cancel(); //we're done!
          }), this.state.options.delay, false);
        },
        onMove: function (ev, pointer) {
          // Don't scroll while waiting for hold.
          // If we don't preventDefault touchmove events here, Android will assume we don't
          // want to listen to anymore touch events. It will start scrolling and stop sending
          // touchmove events.
          ev.preventDefault();

          // If the user moves greater than <maxDistance> pixels, stop the hold timer
          // set in onStart
          var dx = this.state.pos.x - pointer.x;
          var dy = this.state.pos.y - pointer.y;
          if (Math.sqrt(dx * dx + dy * dy) > this.options.maxDistance) {
            this.cancel();
          }
        },
        onEnd: function () {
          this.onCancel();
        }
      })

      /*
       * The drag handler dispatches a drag event if the user holds and moves his finger greater than
       * <minDistance> px in the x or y direction, depending on options.horizontal.
       * The drag will be cancelled if the user moves his finger greater than <minDistance>*<cancelMultiplier> in
       * the perpindicular direction. Eg if the drag is horizontal and the user moves his finger <minDistance>*<cancelMultiplier>
       * pixels vertically, this handler won't consider the move part of a drag.
       */
      .handler('drag', {
        options: {
          minDistance: 6,
          horizontal: true,
          cancelMultiplier: 1.5
        },
        onStart: function (ev) {
          // For drag, require a parent to be registered with $mdGesture.register()
          if (!this.state.registeredParent) this.cancel();
        },
        onMove: function (ev, pointer) {
          var shouldStartDrag, shouldCancel;
          // Don't scroll while deciding if this touchmove qualifies as a drag event.
          // If we don't preventDefault touchmove events here, Android will assume we don't
          // want to listen to anymore touch events. It will start scrolling and stop sending
          // touchmove events.
          ev.preventDefault();

          if (!this.state.dragPointer) {
            if (this.state.options.horizontal) {
              shouldStartDrag = Math.abs(pointer.distanceX) > this.state.options.minDistance;
              shouldCancel = Math.abs(pointer.distanceY) > this.state.options.minDistance * this.state.options.cancelMultiplier;
            } else {
              shouldStartDrag = Math.abs(pointer.distanceY) > this.state.options.minDistance;
              shouldCancel = Math.abs(pointer.distanceX) > this.state.options.minDistance * this.state.options.cancelMultiplier;
            }

            if (shouldStartDrag) {
              // Create a new pointer representing this drag, starting at this point where the drag started.
              this.state.dragPointer = makeStartPointer(ev);
              updatePointerState(ev, this.state.dragPointer);
              this.dispatchEvent(ev, '$md.dragstart', this.state.dragPointer);

            } else if (shouldCancel) {
              this.cancel();
            }
          } else {
            this.dispatchDragMove(ev);
          }
        },
        // Only dispatch dragmove events every frame; any more is unnecessray
        dispatchDragMove: $$rAF.throttle(function (ev) {
          // Make sure the drag didn't stop while waiting for the next frame
          if (this.state.isRunning) {
            updatePointerState(ev, this.state.dragPointer);
            this.dispatchEvent(ev, '$md.drag', this.state.dragPointer);
          }
        }),
        onEnd: function (ev, pointer) {
          if (this.state.dragPointer) {
            updatePointerState(ev, this.state.dragPointer);
            this.dispatchEvent(ev, '$md.dragend', this.state.dragPointer);
          }
        }
      })

      /*
       * The swipe handler will dispatch a swipe event if, on the end of a touch,
       * the velocity and distance were high enough.
       * TODO: add vertical swiping with a `horizontal` option similar to the drag handler.
       */
      .handler('swipe', {
        options: {
          minVelocity: 0.65,
          minDistance: 10
        },
        onEnd: function (ev, pointer) {
          if (Math.abs(pointer.velocityX) > this.state.options.minVelocity &&
            Math.abs(pointer.distanceX) > this.state.options.minDistance) {
            var eventType = pointer.directionX == 'left' ? '$md.swipeleft' : '$md.swiperight';
            this.dispatchEvent(ev, eventType);
          }
        }
      });

  }
  MdGesture.$inject = ["$$MdGestureHandler", "$$rAF", "$timeout"];

  /**
   * MdGestureHandler
   * A GestureHandler is an object which is able to dispatch custom dom events
   * based on native dom {touch,pointer,mouse}{start,move,end} events.
   *
   * A gesture will manage its lifecycle through the start,move,end, and cancel
   * functions, which are called by native dom events.
   *
   * A gesture has the concept of 'options' (eg a swipe's required velocity), which can be
   * overridden by elements registering through $mdGesture.register()
   */
  function GestureHandler (name) {
    this.name = name;
    this.state = {};
  }

  function MdGestureHandler() {
    var hasJQuery =  (typeof window.jQuery !== 'undefined') && (angular.element === window.jQuery);

    GestureHandler.prototype = {
      options: {},
      // jQuery listeners don't work with custom DOMEvents, so we have to dispatch events
      // differently when jQuery is loaded
      dispatchEvent: hasJQuery ?  jQueryDispatchEvent : nativeDispatchEvent,

      // These are overridden by the registered handler
      onStart: angular.noop,
      onMove: angular.noop,
      onEnd: angular.noop,
      onCancel: angular.noop,

      // onStart sets up a new state for the handler, which includes options from the
      // nearest registered parent element of ev.target.
      start: function (ev, pointer) {
        if (this.state.isRunning) return;
        var parentTarget = this.getNearestParent(ev.target);
        // Get the options from the nearest registered parent
        var parentTargetOptions = parentTarget && parentTarget.$mdGesture[this.name] || {};

        this.state = {
          isRunning: true,
          // Override the default options with the nearest registered parent's options
          options: angular.extend({}, this.options, parentTargetOptions),
          // Pass in the registered parent node to the state so the onStart listener can use
          registeredParent: parentTarget
        };
        this.onStart(ev, pointer);
      },
      move: function (ev, pointer) {
        if (!this.state.isRunning) return;
        this.onMove(ev, pointer);
      },
      end: function (ev, pointer) {
        if (!this.state.isRunning) return;
        this.onEnd(ev, pointer);
        this.state.isRunning = false;
      },
      cancel: function (ev, pointer) {
        this.onCancel(ev, pointer);
        this.state = {};
      },

      // Find and return the nearest parent element that has been registered to
      // listen for this handler via $mdGesture.register(element, 'handlerName').
      getNearestParent: function (node) {
        var current = node;
        while (current) {
          if ((current.$mdGesture || {})[this.name]) {
            return current;
          }
          current = current.parentNode;
        }
        return null;
      },

      // Called from $mdGesture.register when an element reigsters itself with a handler.
      // Store the options the user gave on the DOMElement itself. These options will
      // be retrieved with getNearestParent when the handler starts.
      registerElement: function (element, options) {
        var self = this;
        element[0].$mdGesture = element[0].$mdGesture || {};
        element[0].$mdGesture[this.name] = options || {};
        element.on('$destroy', onDestroy);

        return onDestroy;

        function onDestroy() {
          delete element[0].$mdGesture[self.name];
          element.off('$destroy', onDestroy);
        }
      }
    };

    return GestureHandler;

    /*
     * Dispatch an event with jQuery
     * TODO: Make sure this sends bubbling events
     *
     * @param srcEvent the original DOM touch event that started this.
     * @param eventType the name of the custom event to send (eg 'click' or '$md.drag')
     * @param eventPointer the pointer object that matches this event.
     */
    function jQueryDispatchEvent(srcEvent, eventType, eventPointer) {
      eventPointer = eventPointer || pointer;
      var eventObj = new angular.element.Event(eventType);

      eventObj.$material = true;
      eventObj.pointer = eventPointer;
      eventObj.srcEvent = srcEvent;

      angular.extend(eventObj, {
        clientX: eventPointer.x,
        clientY: eventPointer.y,
        screenX: eventPointer.x,
        screenY: eventPointer.y,
        pageX: eventPointer.x,
        pageY: eventPointer.y,
        ctrlKey: srcEvent.ctrlKey,
        altKey: srcEvent.altKey,
        shiftKey: srcEvent.shiftKey,
        metaKey: srcEvent.metaKey
      });
      angular.element(eventPointer.target).trigger(eventObj);
    }

    /*
     * NOTE: nativeDispatchEvent is very performance sensitive.
     * @param srcEvent the original DOM touch event that started this.
     * @param eventType the name of the custom event to send (eg 'click' or '$md.drag')
     * @param eventPointer the pointer object that matches this event.
     */
    function nativeDispatchEvent(srcEvent, eventType, eventPointer) {
      eventPointer = eventPointer || pointer;
      var eventObj;

      if (eventType === 'click') {
        eventObj = document.createEvent('MouseEvents');
        eventObj.initMouseEvent(
          'click', true, true, window, srcEvent.detail,
          eventPointer.x, eventPointer.y, eventPointer.x, eventPointer.y,
          srcEvent.ctrlKey, srcEvent.altKey, srcEvent.shiftKey, srcEvent.metaKey,
          srcEvent.button, srcEvent.relatedTarget || null
        );

      } else {
        eventObj = document.createEvent('CustomEvent');
        eventObj.initCustomEvent(eventType, true, true, {});
      }
      eventObj.$material = true;
      eventObj.pointer = eventPointer;
      eventObj.srcEvent = srcEvent;
      eventPointer.target.dispatchEvent(eventObj);
    }

  }

  /**
   * Attach Gestures: hook document and check shouldHijack clicks
   * @ngInject
   */
  function attachToDocument( $mdGesture, $$MdGestureHandler ) {

    // Polyfill document.contains for IE11.
    // TODO: move to util
    document.contains || (document.contains = function (node) {
      return document.body.contains(node);
    });

    if (!isInitialized && $mdGesture.isHijackingClicks ) {
      /*
       * If hijack clicks is true, we preventDefault any click that wasn't
       * sent by ngMaterial. This is because on older Android & iOS, a false, or 'ghost',
       * click event will be sent ~400ms after a touchend event happens.
       * The only way to know if this click is real is to prevent any normal
       * click events, and add a flag to events sent by material so we know not to prevent those.
       * 
       * Two exceptions to click events that should be prevented are:
       *  - click events sent by the keyboard (eg form submit)
       *  - events that originate from an Ionic app
       */
      document.addEventListener('click', function clickHijacker(ev) {
        var isKeyClick = ev.clientX === 0 && ev.clientY === 0;
        if (!isKeyClick && !ev.$material && !ev.isIonicTap) {
          ev.preventDefault();
          ev.stopPropagation();
        }
      }, true);
      
      isInitialized = true;
    }

    // Listen to all events to cover all platforms.
    var START_EVENTS = 'mousedown touchstart pointerdown';
    var MOVE_EVENTS = 'mousemove touchmove pointermove';
    var END_EVENTS = 'mouseup mouseleave touchend touchcancel pointerup pointercancel';

    angular.element(document)
      .on(START_EVENTS, gestureStart)
      .on(MOVE_EVENTS, gestureMove)
      .on(END_EVENTS, gestureEnd)
      // For testing
      .on('$$mdGestureReset', function gestureClearCache () {
        lastPointer = pointer = null;
      });

    /*
     * When a DOM event happens, run all registered gesture handlers' lifecycle
     * methods which match the DOM event.
     * Eg when a 'touchstart' event happens, runHandlers('start') will call and
     * run `handler.cancel()` and `handler.start()` on all registered handlers.
     */
    function runHandlers(handlerEvent, event) {
      var handler;
      for (var name in HANDLERS) {
        handler = HANDLERS[name];
        if( handler instanceof $$MdGestureHandler ) {

          if (handlerEvent === 'start') {
            // Run cancel to reset any handlers' state
            handler.cancel();
          }
          handler[handlerEvent](event, pointer);

        }
      }
    }

    /*
     * gestureStart vets if a start event is legitimate (and not part of a 'ghost click' from iOS/Android)
     * If it is legitimate, we initiate the pointer state and mark the current pointer's type
     * For example, for a touchstart event, mark the current pointer as a 'touch' pointer, so mouse events
     * won't effect it.
     */
    function gestureStart(ev) {
      // If we're already touched down, abort
      if (pointer) return;

      var now = +Date.now();

      // iOS & old android bug: after a touch event, a click event is sent 350 ms later.
      // If <400ms have passed, don't allow an event of a different type than the previous event
      if (lastPointer && !typesMatch(ev, lastPointer) && (now - lastPointer.endTime < 1500)) {
        return;
      }

      pointer = makeStartPointer(ev);

      runHandlers('start', ev);
    }
    /*
     * If a move event happens of the right type, update the pointer and run all the move handlers.
     * "of the right type": if a mousemove happens but our pointer started with a touch event, do nothing.
     */
    function gestureMove(ev) {
      if (!pointer || !typesMatch(ev, pointer)) return;

      updatePointerState(ev, pointer);
      runHandlers('move', ev);
    }
    /*
     * If an end event happens of the right type, update the pointer, run endHandlers, and save the pointer as 'lastPointer'
     */
    function gestureEnd(ev) {
      if (!pointer || !typesMatch(ev, pointer)) return;

      updatePointerState(ev, pointer);
      pointer.endTime = +Date.now();

      runHandlers('end', ev);

      lastPointer = pointer;
      pointer = null;
    }

  }
  attachToDocument.$inject = ["$mdGesture", "$$MdGestureHandler"];

  // ********************
  // Module Functions
  // ********************

  /*
   * Initiate the pointer. x, y, and the pointer's type.
   */
  function makeStartPointer(ev) {
    var point = getEventPoint(ev);
    var startPointer = {
      startTime: +Date.now(),
      target: ev.target,
      // 'p' for pointer events, 'm' for mouse, 't' for touch
      type: ev.type.charAt(0)
    };
    startPointer.startX = startPointer.x = point.pageX;
    startPointer.startY = startPointer.y = point.pageY;
    return startPointer;
  }

  /*
   * return whether the pointer's type matches the event's type.
   * Eg if a touch event happens but the pointer has a mouse type, return false.
   */
  function typesMatch(ev, pointer) {
    return ev && pointer && ev.type.charAt(0) === pointer.type;
  }

  /*
   * Update the given pointer based upon the given DOMEvent.
   * Distance, velocity, direction, duration, etc
   */
  function updatePointerState(ev, pointer) {
    var point = getEventPoint(ev);
    var x = pointer.x = point.pageX;
    var y = pointer.y = point.pageY;

    pointer.distanceX = x - pointer.startX;
    pointer.distanceY = y - pointer.startY;
    pointer.distance = Math.sqrt(
      pointer.distanceX * pointer.distanceX + pointer.distanceY * pointer.distanceY
    );

    pointer.directionX = pointer.distanceX > 0 ? 'right' : pointer.distanceX < 0 ? 'left' : '';
    pointer.directionY = pointer.distanceY > 0 ? 'up' : pointer.distanceY < 0 ? 'down' : '';

    pointer.duration = +Date.now() - pointer.startTime;
    pointer.velocityX = pointer.distanceX / pointer.duration;
    pointer.velocityY = pointer.distanceY / pointer.duration;
  }

  /*
   * Normalize the point where the DOM event happened whether it's touch or mouse.
   * @returns point event obj with pageX and pageY on it.
   */
  function getEventPoint(ev) {
    ev = ev.originalEvent || ev; // support jQuery events
    return (ev.touches && ev.touches[0]) ||
      (ev.changedTouches && ev.changedTouches[0]) ||
      ev;
  }

})();
(function(){
"use strict";

angular.module('material.core')
  .provider('$$interimElement', InterimElementProvider);

/*
 * @ngdoc service
 * @name $$interimElement
 * @module material.core
 *
 * @description
 *
 * Factory that contructs `$$interimElement.$service` services.
 * Used internally in material design for elements that appear on screen temporarily.
 * The service provides a promise-like API for interacting with the temporary
 * elements.
 *
 * ```js
 * app.service('$mdToast', function($$interimElement) {
 *   var $mdToast = $$interimElement(toastDefaultOptions);
 *   return $mdToast;
 * });
 * ```
 * @param {object=} defaultOptions Options used by default for the `show` method on the service.
 *
 * @returns {$$interimElement.$service}
 *
 */

function InterimElementProvider() {
  createInterimElementProvider.$get = InterimElementFactory;
  InterimElementFactory.$inject = ["$document", "$q", "$rootScope", "$timeout", "$rootElement", "$animate", "$interpolate", "$mdCompiler", "$mdTheming"];
  return createInterimElementProvider;

  /**
   * Returns a new provider which allows configuration of a new interimElement
   * service. Allows configuration of default options & methods for options,
   * as well as configuration of 'preset' methods (eg dialog.basic(): basic is a preset method)
   */
  function createInterimElementProvider(interimFactoryName) {
    var EXPOSED_METHODS = ['onHide', 'onShow', 'onRemove'];

    var customMethods = {};
    var providerConfig = {
      presets: {}
    };

    var provider = {
      setDefaults: setDefaults,
      addPreset: addPreset,
      addMethod: addMethod,
      $get: factory
    };

    /**
     * all interim elements will come with the 'build' preset
     */
    provider.addPreset('build', {
      methods: ['controller', 'controllerAs', 'resolve',
        'template', 'templateUrl', 'themable', 'transformTemplate', 'parent']
    });

    factory.$inject = ["$$interimElement", "$animate", "$injector"];
    return provider;

    /**
     * Save the configured defaults to be used when the factory is instantiated
     */
    function setDefaults(definition) {
      providerConfig.optionsFactory = definition.options;
      providerConfig.methods = (definition.methods || []).concat(EXPOSED_METHODS);
      return provider;
    }

    /**
     * Add a method to the factory that isn't specific to any interim element operations
     */

    function addMethod(name, fn) {
      customMethods[name] = fn;
      return provider;
    }

    /**
     * Save the configured preset to be used when the factory is instantiated
     */
    function addPreset(name, definition) {
      definition = definition || {};
      definition.methods = definition.methods || [];
      definition.options = definition.options || function() { return {}; };

      if (/^cancel|hide|show$/.test(name)) {
        throw new Error("Preset '" + name + "' in " + interimFactoryName + " is reserved!");
      }
      if (definition.methods.indexOf('_options') > -1) {
        throw new Error("Method '_options' in " + interimFactoryName + " is reserved!");
      }
      providerConfig.presets[name] = {
        methods: definition.methods.concat(EXPOSED_METHODS),
        optionsFactory: definition.options,
        argOption: definition.argOption
      };
      return provider;
    }

    /**
     * Create a factory that has the given methods & defaults implementing interimElement
     */
    /* @ngInject */
    function factory($$interimElement, $animate, $injector) {
      var defaultMethods;
      var defaultOptions;
      var interimElementService = $$interimElement();

      /*
       * publicService is what the developer will be using.
       * It has methods hide(), cancel(), show(), build(), and any other
       * presets which were set during the config phase.
       */
      var publicService = {
        hide: interimElementService.hide,
        cancel: interimElementService.cancel,
        show: showInterimElement
      };

      defaultMethods = providerConfig.methods || [];
      // This must be invoked after the publicService is initialized
      defaultOptions = invokeFactory(providerConfig.optionsFactory, {});

      // Copy over the simple custom methods
      angular.forEach(customMethods, function(fn, name) {
        publicService[name] = fn;
      });

      angular.forEach(providerConfig.presets, function(definition, name) {
        var presetDefaults = invokeFactory(definition.optionsFactory, {});
        var presetMethods = (definition.methods || []).concat(defaultMethods);

        // Every interimElement built with a preset has a field called `$type`,
        // which matches the name of the preset.
        // Eg in preset 'confirm', options.$type === 'confirm'
        angular.extend(presetDefaults, { $type: name });

        // This creates a preset class which has setter methods for every
        // method given in the `.addPreset()` function, as well as every
        // method given in the `.setDefaults()` function.
        //
        // @example
        // .setDefaults({
        //   methods: ['hasBackdrop', 'clickOutsideToClose', 'escapeToClose', 'targetEvent'],
        //   options: dialogDefaultOptions
        // })
        // .addPreset('alert', {
        //   methods: ['title', 'ok'],
        //   options: alertDialogOptions
        // })
        //
        // Set values will be passed to the options when interimElemnt.show() is called.
        function Preset(opts) {
          this._options = angular.extend({}, presetDefaults, opts);
        }
        angular.forEach(presetMethods, function(name) {
          Preset.prototype[name] = function(value) {
            this._options[name] = value;
            return this;
          };
        });

        // Create shortcut method for one-linear methods
        if (definition.argOption) {
          var methodName = 'show' + name.charAt(0).toUpperCase() + name.slice(1);
          publicService[methodName] = function(arg) {
            var config = publicService[name](arg);
            return publicService.show(config);
          };
        }

        // eg $mdDialog.alert() will return a new alert preset
        publicService[name] = function(arg) {
          // If argOption is supplied, eg `argOption: 'content'`, then we assume
          // if the argument is not an options object then it is the `argOption` option.
          //
          // @example `$mdToast.simple('hello')` // sets options.content to hello
          //                                     // because argOption === 'content'
          if (arguments.length && definition.argOption && !angular.isObject(arg) &&
              !angular.isArray(arg)) {
            return (new Preset())[definition.argOption](arg);
          } else {
            return new Preset(arg);
          }

        };
      });

      return publicService;

      function showInterimElement(opts) {
        // opts is either a preset which stores its options on an _options field,
        // or just an object made up of options
        if (opts && opts._options) opts = opts._options;
        return interimElementService.show(
          angular.extend({}, defaultOptions, opts)
        );
      }

      /**
       * Helper to call $injector.invoke with a local of the factory name for
       * this provider.
       * If an $mdDialog is providing options for a dialog and tries to inject
       * $mdDialog, a circular dependency error will happen.
       * We get around that by manually injecting $mdDialog as a local.
       */
      function invokeFactory(factory, defaultVal) {
        var locals = {};
        locals[interimFactoryName] = publicService;
        return $injector.invoke(factory || function() { return defaultVal; }, {}, locals);
      }

    }

  }

  /* @ngInject */
  function InterimElementFactory($document, $q, $rootScope, $timeout, $rootElement, $animate,
                                 $interpolate, $mdCompiler, $mdTheming ) {
    var startSymbol = $interpolate.startSymbol(),
        endSymbol = $interpolate.endSymbol(),
        usesStandardSymbols = ((startSymbol === '{{') && (endSymbol === '}}')),
        processTemplate  = usesStandardSymbols ? angular.identity : replaceInterpolationSymbols;

    return function createInterimElementService() {
      /*
       * @ngdoc service
       * @name $$interimElement.$service
       *
       * @description
       * A service used to control inserting and removing an element into the DOM.
       *
       */
      var stack = [];
      var service;
      return service = {
        show: show,
        hide: hide,
        cancel: cancel
      };

      /*
       * @ngdoc method
       * @name $$interimElement.$service#show
       * @kind function
       *
       * @description
       * Adds the `$interimElement` to the DOM and returns a promise that will be resolved or rejected
       * with hide or cancel, respectively.
       *
       * @param {*} options is hashMap of settings
       * @returns a Promise
       *
       */
      function show(options) {
        if (stack.length) {
          return service.cancel().then(function() {
            return show(options);
          });
        } else {
          var interimElement = new InterimElement(options);
          stack.push(interimElement);
          return interimElement.show().then(function() {
            return interimElement.deferred.promise;
          });
        }
      }

      /*
       * @ngdoc method
       * @name $$interimElement.$service#hide
       * @kind function
       *
       * @description
       * Removes the `$interimElement` from the DOM and resolves the promise returned from `show`
       *
       * @param {*} resolveParam Data to resolve the promise with
       * @returns a Promise that will be resolved after the element has been removed.
       *
       */
      function hide(response) {
        var interimElement = stack.shift();
        return interimElement && interimElement.remove().then(function() {
          interimElement.deferred.resolve(response);
        });
      }

      /*
       * @ngdoc method
       * @name $$interimElement.$service#cancel
       * @kind function
       *
       * @description
       * Removes the `$interimElement` from the DOM and rejects the promise returned from `show`
       *
       * @param {*} reason Data to reject the promise with
       * @returns Promise that will be resolved after the element has been removed.
       *
       */
      function cancel(reason) {
        var interimElement = stack.shift();
        return $q.when(interimElement && interimElement.remove().then(function() {
          interimElement.deferred.reject(reason);
        }));
      }


      /*
       * Internal Interim Element Object
       * Used internally to manage the DOM element and related data
       */
      function InterimElement(options) {
        var self;
        var hideTimeout, element, showDone, removeDone;

        options = options || {};
        options = angular.extend({
          preserveScope: false,
          scope: options.scope || $rootScope.$new(options.isolateScope),
          onShow: function(scope, element, options) {
            return $animate.enter(element, options.parent);
          },
          onRemove: function(scope, element, options) {
            // Element could be undefined if a new element is shown before
            // the old one finishes compiling.
            return element && $animate.leave(element) || $q.when();
          }
        }, options);

        if (options.template) {
          options.template = processTemplate(options.template);
        }

        return self = {
          options: options,
          deferred: $q.defer(),
          show: function() {
            var compilePromise;
            if (options.skipCompile) {
              compilePromise = $q(function(resolve) { 
                resolve({
                  locals: {},
                  link: function() { return options.element; }
                });
              });
            } else {
              compilePromise = $mdCompiler.compile(options);
            }

            return showDone = compilePromise.then(function(compileData) {
              angular.extend(compileData.locals, self.options);

              element = compileData.link(options.scope);

              // Search for parent at insertion time, if not specified
              if (angular.isFunction(options.parent)) {
                options.parent = options.parent(options.scope, element, options);
              } else if (angular.isString(options.parent)) {
                options.parent = angular.element($document[0].querySelector(options.parent));
              }

              // If parent querySelector/getter function fails, or it's just null,
              // find a default.
              if (!(options.parent || {}).length) {
                var el;
                if ($rootElement[0] && $rootElement[0].querySelector) {
                  el = $rootElement[0].querySelector(':not(svg) > body');
                }
                if (!el) el = $rootElement[0];
                if (el.nodeName == '#comment') {
                  el = $document[0].body;
                }
                options.parent = angular.element(el);
              }

              if (options.themable) $mdTheming(element);
              var ret = options.onShow(options.scope, element, options);
              return $q.when(ret)
                .then(function(){
                  // Issue onComplete callback when the `show()` finishes
                  (options.onComplete || angular.noop)(options.scope, element, options);
                  startHideTimeout();
                });

              function startHideTimeout() {
                if (options.hideDelay) {
                  hideTimeout = $timeout(service.cancel, options.hideDelay) ;
                }
              }
            }, function(reason) { showDone = true; self.deferred.reject(reason); });
          },
          cancelTimeout: function() {
            if (hideTimeout) {
              $timeout.cancel(hideTimeout);
              hideTimeout = undefined;
            }
          },
          remove: function() {
            self.cancelTimeout();
            return removeDone = $q.when(showDone).then(function() {
              var ret = element ? options.onRemove(options.scope, element, options) : true;
              return $q.when(ret).then(function() {
                if (!options.preserveScope) options.scope.$destroy();
                removeDone = true;
              });
            });
          }
        };
      }
    };

    /*
     * Replace `{{` and `}}` in a string (usually a template) with the actual start-/endSymbols used
     * for interpolation. This allows pre-defined templates (for components such as dialog, toast etc)
     * to continue to work in apps that use custom interpolation start-/endSymbols.
     *
     * @param {string} text The text in which to replace `{{` / `}}`
     * @returns {string} The modified string using the actual interpolation start-/endSymbols
     */
    function replaceInterpolationSymbols(text) {
      if (!text || !angular.isString(text)) return text;
      return text.replace(/\{\{/g, startSymbol).replace(/}}/g, endSymbol);
    }
  }

}

})();
(function(){
"use strict";

  /**
   * @ngdoc module
   * @name material.core.componentRegistry
   *
   * @description
   * A component instance registration service.
   * Note: currently this as a private service in the SideNav component.
   */
  angular.module('material.core')
    .factory('$mdComponentRegistry', ComponentRegistry);

  /*
   * @private
   * @ngdoc factory
   * @name ComponentRegistry
   * @module material.core.componentRegistry
   *
   */
  function ComponentRegistry($log, $q) {

    var self;
    var instances = [ ];
    var pendings = { };

    return self = {
      /**
       * Used to print an error when an instance for a handle isn't found.
       */
      notFoundError: function(handle) {
        $log.error('No instance found for handle', handle);
      },
      /**
       * Return all registered instances as an array.
       */
      getInstances: function() {
        return instances;
      },

      /**
       * Get a registered instance.
       * @param handle the String handle to look up for a registered instance.
       */
      get: function(handle) {
        if ( !isValidID(handle) ) return null;

        var i, j, instance;
        for(i = 0, j = instances.length; i < j; i++) {
          instance = instances[i];
          if(instance.$$mdHandle === handle) {
            return instance;
          }
        }
        return null;
      },

      /**
       * Register an instance.
       * @param instance the instance to register
       * @param handle the handle to identify the instance under.
       */
      register: function(instance, handle) {
        if ( !handle ) return angular.noop;

        instance.$$mdHandle = handle;
        instances.push(instance);
        resolveWhen();

        return deregister;

        /**
         * Remove registration for an instance
         */
        function deregister() {
          var index = instances.indexOf(instance);
          if (index !== -1) {
            instances.splice(index, 1);
          }
        }

        /**
         * Resolve any pending promises for this instance
         */
        function resolveWhen() {
          var dfd = pendings[handle];
          if ( dfd ) {
            dfd.resolve( instance );
            delete pendings[handle];
          }
        }
      },

      /**
       * Async accessor to registered component instance
       * If not available then a promise is created to notify
       * all listeners when the instance is registered.
       */
      when : function(handle) {
        if ( isValidID(handle) ) {
          var deferred = $q.defer();
          var instance = self.get(handle);

          if ( instance )  {
            deferred.resolve( instance );
          } else {
            pendings[handle] = deferred;
          }

          return deferred.promise;
        }
        return $q.reject("Invalid `md-component-id` value.");
      }

    };

    function isValidID(handle){
      return handle && (handle !== "");
    }

  }
  ComponentRegistry.$inject = ["$log", "$q"];

})();
(function(){
"use strict";

(function() {
  'use strict';

  /**
   * @ngdoc service
   * @name $mdButtonInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-button.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdButtonInkRipple', MdButtonInkRipple);

  function MdButtonInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      var elementOptions = optionsForElement(element);
      return $mdInkRipple.attach(scope, element, angular.extend(elementOptions, options));
    };

    function optionsForElement(element) {
      if (element.hasClass('md-icon-button')) {
        return {
          isMenuItem: element.hasClass('md-menu-item'),
          fitRipple: true,
          center: true
        };
      } else {
        return {
          isMenuItem: element.hasClass('md-menu-item'),
          dimBackground: true
        }
      }
    };
  }
  MdButtonInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

    /**
   * @ngdoc service
   * @name $mdCheckboxInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-checkbox.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdCheckboxInkRipple', MdCheckboxInkRipple);

  function MdCheckboxInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: true,
        dimBackground: false,
        fitRipple: true
      }, options));
    };
  }
  MdCheckboxInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

  /**
   * @ngdoc service
   * @name $mdListInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-list.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdListInkRipple', MdListInkRipple);

  function MdListInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: false,
        dimBackground: true,
        outline: false,
        rippleSize: 'full'
      }, options));
    };
  }
  MdListInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

angular.module('material.core')
  .factory('$mdInkRipple', InkRippleService)
  .directive('mdInkRipple', InkRippleDirective)
  .directive('mdNoInk', attrNoDirective())
  .directive('mdNoBar', attrNoDirective())
  .directive('mdNoStretch', attrNoDirective());

function InkRippleDirective($mdButtonInkRipple, $mdCheckboxInkRipple) {
  return {
    controller: angular.noop,
    link: function (scope, element, attr) {
      if (attr.hasOwnProperty('mdInkRippleCheckbox')) {
        $mdCheckboxInkRipple.attach(scope, element);
      } else {
        $mdButtonInkRipple.attach(scope, element);
      }
    }
  };
}
InkRippleDirective.$inject = ["$mdButtonInkRipple", "$mdCheckboxInkRipple"];

function InkRippleService($window, $timeout) {

  return {
    attach: attach
  };

  function attach(scope, element, options) {
    if (element.controller('mdNoInk')) return angular.noop;

    options = angular.extend({
      colorElement: element,
      mousedown: true,
      hover: true,
      focus: true,
      center: false,
      mousedownPauseTime: 150,
      dimBackground: false,
      outline: false,
      fullRipple: true,
      isMenuItem: false,
      fitRipple: false
    }, options);

    var rippleSize,
        controller = element.controller('mdInkRipple') || {},
        counter = 0,
        ripples = [],
        states = [],
        isActiveExpr = element.attr('md-highlight'),
        isActive = false,
        isHeld = false,
        node = element[0],
        rippleSizeSetting = element.attr('md-ripple-size'),
        color = parseColor(element.attr('md-ink-ripple')) || parseColor(options.colorElement.length && $window.getComputedStyle(options.colorElement[0]).color || 'rgb(0, 0, 0)');

    switch (rippleSizeSetting) {
      case 'full':
        options.fullRipple = true;
        break;
      case 'partial':
        options.fullRipple = false;
        break;
    }

    // expose onInput for ripple testing
    if (options.mousedown) {
      element.on('$md.pressdown', onPressDown)
        .on('$md.pressup', onPressUp);
    }

    controller.createRipple = createRipple;

    if (isActiveExpr) {
      scope.$watch(isActiveExpr, function watchActive(newValue) {
        isActive = newValue;
        if (isActive && !ripples.length) {
          $timeout(function () { createRipple(0, 0); }, 0, false);
        }
        angular.forEach(ripples, updateElement);
      });
    }

    // Publish self-detach method if desired...
    return function detach() {
      element.off('$md.pressdown', onPressDown)
        .off('$md.pressup', onPressUp);
      getRippleContainer().remove();
    };

    /**
     * Gets the current ripple container
     * If there is no ripple container, it creates one and returns it
     *
     * @returns {angular.element} ripple container element
     */
    function getRippleContainer() {
      var container = element.data('$mdRippleContainer');
      if (container) return container;
      container = angular.element('<div class="md-ripple-container">');
      element.append(container);
      element.data('$mdRippleContainer', container);
      return container;
    }

    function parseColor(color) {
      if (!color) return;
      if (color.indexOf('rgba') === 0) return color.replace(/\d?\.?\d*\s*\)\s*$/, '0.1)');
      if (color.indexOf('rgb')  === 0) return rgbToRGBA(color);
      if (color.indexOf('#')    === 0) return hexToRGBA(color);

      /**
       * Converts a hex value to an rgba string
       *
       * @param {string} hex value (3 or 6 digits) to be converted
       *
       * @returns {string} rgba color with 0.1 alpha
       */
      function hexToRGBA(color) {
        var hex = color.charAt(0) === '#' ? color.substr(1) : color,
          dig = hex.length / 3,
          red = hex.substr(0, dig),
          grn = hex.substr(dig, dig),
          blu = hex.substr(dig * 2);
        if (dig === 1) {
          red += red;
          grn += grn;
          blu += blu;
        }
        return 'rgba(' + parseInt(red, 16) + ',' + parseInt(grn, 16) + ',' + parseInt(blu, 16) + ',0.1)';
      }

      /**
       * Converts rgb value to rgba string
       *
       * @param {string} rgb color string
       *
       * @returns {string} rgba color with 0.1 alpha
       */
      function rgbToRGBA(color) {
        return color.replace(')', ', 0.1)').replace('(', 'a(');
      }

    }

    function removeElement(elem, wait) {
      ripples.splice(ripples.indexOf(elem), 1);
      if (ripples.length === 0) {
        getRippleContainer().css({ backgroundColor: '' });
      }
      $timeout(function () { elem.remove(); }, wait, false);
    }

    function updateElement(elem) {
      var index = ripples.indexOf(elem),
          state = states[index] || {},
          elemIsActive = ripples.length > 1 ? false : isActive,
          elemIsHeld   = ripples.length > 1 ? false : isHeld;
      if (elemIsActive || state.animating || elemIsHeld) {
        elem.addClass('md-ripple-visible');
      } else if (elem) {
        elem.removeClass('md-ripple-visible');
        if (options.outline) {
          elem.css({
            width: rippleSize + 'px',
            height: rippleSize + 'px',
            marginLeft: (rippleSize * -1) + 'px',
            marginTop: (rippleSize * -1) + 'px'
          });
        }
        removeElement(elem, options.outline ? 450 : 650);
      }
    }

    /**
     * Creates a ripple at the provided coordinates
     *
     * @param {number} left cursor position
     * @param {number} top cursor position
     *
     * @returns {angular.element} the generated ripple element
     */
    function createRipple(left, top) {

      color = parseColor(element.attr('md-ink-ripple')) || parseColor($window.getComputedStyle(options.colorElement[0]).color || 'rgb(0, 0, 0)');

      var container = getRippleContainer(),
          size = getRippleSize(left, top),
          css = getRippleCss(size, left, top),
          elem = getRippleElement(css),
          index = ripples.indexOf(elem),
          state = states[index] || {};

      rippleSize = size;

      state.animating = true;

      $timeout(function () {
        if (options.dimBackground) {
          container.css({ backgroundColor: color });
        }
        elem.addClass('md-ripple-placed md-ripple-scaled');
        if (options.outline) {
          elem.css({
            borderWidth: (size * 0.5) + 'px',
            marginLeft: (size * -0.5) + 'px',
            marginTop: (size * -0.5) + 'px'
          });
        } else {
          elem.css({ left: '50%', top: '50%' });
        }
        updateElement(elem);
        $timeout(function () {
          state.animating = false;
          updateElement(elem);
        }, (options.outline ? 450 : 225), false);
      }, 0, false);

      return elem;

      /**
       * Creates the ripple element with the provided css
       *
       * @param {object} css properties to be applied
       *
       * @returns {angular.element} the generated ripple element
       */
      function getRippleElement(css) {
        var elem = angular.element('<div class="md-ripple" data-counter="' + counter++ + '">');
        ripples.unshift(elem);
        states.unshift({ animating: true });
        container.append(elem);
        css && elem.css(css);
        return elem;
      }

      /**
       * Calculate the ripple size
       *
       * @returns {number} calculated ripple diameter
       */
      function getRippleSize(left, top) {
        var width = container.prop('offsetWidth'),
            height = container.prop('offsetHeight'),
            multiplier, size, rect;
        if (options.isMenuItem) {
          size = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));
        } else if (options.outline) {
          rect = node.getBoundingClientRect();
          left -= rect.left;
          top -= rect.top;
          width = Math.max(left, width - left);
          height = Math.max(top, height - top);
          size = 2 * Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));
        } else {
          multiplier = options.fullRipple ? 1.1 : 0.8;
          size = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2)) * multiplier;
          if (options.fitRipple) {
            size = Math.min(height, width, size);
          }
        }
        return size;
      }

      /**
       * Generates the ripple css
       *
       * @param {number} the diameter of the ripple
       * @param {number} the left cursor offset
       * @param {number} the top cursor offset
       *
       * @returns {{backgroundColor: string, borderColor: string, width: string, height: string}}
       */
      function getRippleCss(size, left, top) {
        var rect = node.getBoundingClientRect(),
            css  = {
              backgroundColor: rgbaToRGB(color),
              borderColor: rgbaToRGB(color),
              width: size + 'px',
              height: size + 'px'
            };

        if (options.outline) {
          css.width = 0;
          css.height = 0;
        } else {
          css.marginLeft = css.marginTop = (size * -0.5) + 'px';
        }

        if (options.center) {
          css.left = css.top = '50%';
        } else {
          css.left = Math.round((left - rect.left) / container.prop('offsetWidth') * 100) + '%';
          css.top = Math.round((top - rect.top) / container.prop('offsetHeight') * 100) + '%';
        }

        return css;

        /**
         * Converts rgba string to rgb, removing the alpha value
         *
         * @param {string} rgba color
         *
         * @returns {string} rgb color
         */
        function rgbaToRGB(color) {
          return color.replace('rgba', 'rgb').replace(/,[^\),]+\)/, ')');
        }
      }
    }

    /**
     * Handles user input start and stop events
     *
     */
    function onPressDown(ev) {
      if (!isRippleAllowed()) return;

      createRipple(ev.pointer.x, ev.pointer.y);
      isHeld = true;
    }
    function onPressUp() {
      isHeld = false;
      var ripple = ripples[ ripples.length - 1 ];
      $timeout(function () { updateElement(ripple); }, 0, false);
    }

    /**
     * Determines if the ripple is allowed
     *
     * @returns {boolean} true if the ripple is allowed, false if not
     */
    function isRippleAllowed() {
      var parent = node.parentNode;
      var grandparent = parent && parent.parentNode;
      var ancestor = grandparent && grandparent.parentNode;
      return !isDisabled(node) && !isDisabled(parent) && !isDisabled(grandparent) && !isDisabled(ancestor);
      function isDisabled (elem) {
        return elem && elem.hasAttribute && elem.hasAttribute('disabled');
      }
    }

  }
}
InkRippleService.$inject = ["$window", "$timeout"];

/**
 * noink/nobar/nostretch directive: make any element that has one of
 * these attributes be given a controller, so that other directives can
 * `require:` these and see if there is a `no<xxx>` parent attribute.
 *
 * @usage
 * <hljs lang="html">
 * <parent md-no-ink>
 *   <child detect-no>
 *   </child>
 * </parent>
 * </hljs>
 *
 * <hljs lang="js">
 * myApp.directive('detectNo', function() {
 *   return {
 *     require: ['^?mdNoInk', ^?mdNoBar'],
 *     link: function(scope, element, attr, ctrls) {
 *       var noinkCtrl = ctrls[0];
 *       var nobarCtrl = ctrls[1];
 *       if (noInkCtrl) {
 *         alert("the md-no-ink flag has been specified on an ancestor!");
 *       }
 *       if (nobarCtrl) {
 *         alert("the md-no-bar flag has been specified on an ancestor!");
 *       }
 *     }
 *   };
 * });
 * </hljs>
 */
function attrNoDirective() {
  return function() {
    return {
      controller: angular.noop
    };
  };
}

})();
(function(){
"use strict";

(function() {
  'use strict';

    /**
   * @ngdoc service
   * @name $mdTabInkRipple
   * @module material.core
   *
   * @description
   * Provides ripple effects for md-tabs.  See $mdInkRipple service for all possible configuration options.
   *
   * @param {object=} scope Scope within the current context
   * @param {object=} element The element the ripple effect should be applied to
   * @param {object=} options (Optional) Configuration options to override the defaultripple configuration
   */

  angular.module('material.core')
    .factory('$mdTabInkRipple', MdTabInkRipple);

  function MdTabInkRipple($mdInkRipple) {
    return {
      attach: attach
    };

    function attach(scope, element, options) {
      return $mdInkRipple.attach(scope, element, angular.extend({
        center: false,
        dimBackground: true,
        outline: false,
        rippleSize: 'full'
      }, options));
    };
  }
  MdTabInkRipple.$inject = ["$mdInkRipple"];;
})();

})();
(function(){
"use strict";

angular.module('material.core.theming.palette', [])
.constant('$mdColorPalette', {
  'red': {
    '50': '#ffebee',
    '100': '#ffcdd2',
    '200': '#ef9a9a',
    '300': '#e57373',
    '400': '#ef5350',
    '500': '#f44336',
    '600': '#e53935',
    '700': '#d32f2f',
    '800': '#c62828',
    '900': '#b71c1c',
    'A100': '#ff8a80',
    'A200': '#ff5252',
    'A400': '#ff1744',
    'A700': '#d50000',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 700 A200 A400 A700'
  },
  'pink': {
    '50': '#fce4ec',
    '100': '#f8bbd0',
    '200': '#f48fb1',
    '300': '#f06292',
    '400': '#ec407a',
    '500': '#e91e63',
    '600': '#d81b60',
    '700': '#c2185b',
    '800': '#ad1457',
    '900': '#880e4f',
    'A100': '#ff80ab',
    'A200': '#ff4081',
    'A400': '#f50057',
    'A700': '#c51162',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 A200 A400 A700'
  },
  'purple': {
    '50': '#f3e5f5',
    '100': '#e1bee7',
    '200': '#ce93d8',
    '300': '#ba68c8',
    '400': '#ab47bc',
    '500': '#9c27b0',
    '600': '#8e24aa',
    '700': '#7b1fa2',
    '800': '#6a1b9a',
    '900': '#4a148c',
    'A100': '#ea80fc',
    'A200': '#e040fb',
    'A400': '#d500f9',
    'A700': '#aa00ff',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200 A400 A700'
  },
  'deep-purple': {
    '50': '#ede7f6',
    '100': '#d1c4e9',
    '200': '#b39ddb',
    '300': '#9575cd',
    '400': '#7e57c2',
    '500': '#673ab7',
    '600': '#5e35b1',
    '700': '#512da8',
    '800': '#4527a0',
    '900': '#311b92',
    'A100': '#b388ff',
    'A200': '#7c4dff',
    'A400': '#651fff',
    'A700': '#6200ea',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200'
  },
  'indigo': {
    '50': '#e8eaf6',
    '100': '#c5cae9',
    '200': '#9fa8da',
    '300': '#7986cb',
    '400': '#5c6bc0',
    '500': '#3f51b5',
    '600': '#3949ab',
    '700': '#303f9f',
    '800': '#283593',
    '900': '#1a237e',
    'A100': '#8c9eff',
    'A200': '#536dfe',
    'A400': '#3d5afe',
    'A700': '#304ffe',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 A100',
    'contrastStrongLightColors': '300 400 A200 A400'
  },
  'blue': {
    '50': '#e3f2fd',
    '100': '#bbdefb',
    '200': '#90caf9',
    '300': '#64b5f6',
    '400': '#42a5f5',
    '500': '#2196f3',
    '600': '#1e88e5',
    '700': '#1976d2',
    '800': '#1565c0',
    '900': '#0d47a1',
    'A100': '#82b1ff',
    'A200': '#448aff',
    'A400': '#2979ff',
    'A700': '#2962ff',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '100 200 300 400 A100',
    'contrastStrongLightColors': '500 600 700 A200 A400 A700'
  },
  'light-blue': {
    '50': '#e1f5fe',
    '100': '#b3e5fc',
    '200': '#81d4fa',
    '300': '#4fc3f7',
    '400': '#29b6f6',
    '500': '#03a9f4',
    '600': '#039be5',
    '700': '#0288d1',
    '800': '#0277bd',
    '900': '#01579b',
    'A100': '#80d8ff',
    'A200': '#40c4ff',
    'A400': '#00b0ff',
    'A700': '#0091ea',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900 A700',
    'contrastStrongLightColors': '500 600 700 800 A700'
  },
  'cyan': {
    '50': '#e0f7fa',
    '100': '#b2ebf2',
    '200': '#80deea',
    '300': '#4dd0e1',
    '400': '#26c6da',
    '500': '#00bcd4',
    '600': '#00acc1',
    '700': '#0097a7',
    '800': '#00838f',
    '900': '#006064',
    'A100': '#84ffff',
    'A200': '#18ffff',
    'A400': '#00e5ff',
    'A700': '#00b8d4',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700 800'
  },
  'teal': {
    '50': '#e0f2f1',
    '100': '#b2dfdb',
    '200': '#80cbc4',
    '300': '#4db6ac',
    '400': '#26a69a',
    '500': '#009688',
    '600': '#00897b',
    '700': '#00796b',
    '800': '#00695c',
    '900': '#004d40',
    'A100': '#a7ffeb',
    'A200': '#64ffda',
    'A400': '#1de9b6',
    'A700': '#00bfa5',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700'
  },
  'green': {
    '50': '#e8f5e9',
    '100': '#c8e6c9',
    '200': '#a5d6a7',
    '300': '#81c784',
    '400': '#66bb6a',
    '500': '#4caf50',
    '600': '#43a047',
    '700': '#388e3c',
    '800': '#2e7d32',
    '900': '#1b5e20',
    'A100': '#b9f6ca',
    'A200': '#69f0ae',
    'A400': '#00e676',
    'A700': '#00c853',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '500 600 700 800 900',
    'contrastStrongLightColors': '500 600 700'
  },
  'light-green': {
    '50': '#f1f8e9',
    '100': '#dcedc8',
    '200': '#c5e1a5',
    '300': '#aed581',
    '400': '#9ccc65',
    '500': '#8bc34a',
    '600': '#7cb342',
    '700': '#689f38',
    '800': '#558b2f',
    '900': '#33691e',
    'A100': '#ccff90',
    'A200': '#b2ff59',
    'A400': '#76ff03',
    'A700': '#64dd17',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '800 900',
    'contrastStrongLightColors': '800 900'
  },
  'lime': {
    '50': '#f9fbe7',
    '100': '#f0f4c3',
    '200': '#e6ee9c',
    '300': '#dce775',
    '400': '#d4e157',
    '500': '#cddc39',
    '600': '#c0ca33',
    '700': '#afb42b',
    '800': '#9e9d24',
    '900': '#827717',
    'A100': '#f4ff81',
    'A200': '#eeff41',
    'A400': '#c6ff00',
    'A700': '#aeea00',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '900',
    'contrastStrongLightColors': '900'
  },
  'yellow': {
    '50': '#fffde7',
    '100': '#fff9c4',
    '200': '#fff59d',
    '300': '#fff176',
    '400': '#ffee58',
    '500': '#ffeb3b',
    '600': '#fdd835',
    '700': '#fbc02d',
    '800': '#f9a825',
    '900': '#f57f17',
    'A100': '#ffff8d',
    'A200': '#ffff00',
    'A400': '#ffea00',
    'A700': '#ffd600',
    'contrastDefaultColor': 'dark'
  },
  'amber': {
    '50': '#fff8e1',
    '100': '#ffecb3',
    '200': '#ffe082',
    '300': '#ffd54f',
    '400': '#ffca28',
    '500': '#ffc107',
    '600': '#ffb300',
    '700': '#ffa000',
    '800': '#ff8f00',
    '900': '#ff6f00',
    'A100': '#ffe57f',
    'A200': '#ffd740',
    'A400': '#ffc400',
    'A700': '#ffab00',
    'contrastDefaultColor': 'dark'
  },
  'orange': {
    '50': '#fff3e0',
    '100': '#ffe0b2',
    '200': '#ffcc80',
    '300': '#ffb74d',
    '400': '#ffa726',
    '500': '#ff9800',
    '600': '#fb8c00',
    '700': '#f57c00',
    '800': '#ef6c00',
    '900': '#e65100',
    'A100': '#ffd180',
    'A200': '#ffab40',
    'A400': '#ff9100',
    'A700': '#ff6d00',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '800 900',
    'contrastStrongLightColors': '800 900'
  },
  'deep-orange': {
    '50': '#fbe9e7',
    '100': '#ffccbc',
    '200': '#ffab91',
    '300': '#ff8a65',
    '400': '#ff7043',
    '500': '#ff5722',
    '600': '#f4511e',
    '700': '#e64a19',
    '800': '#d84315',
    '900': '#bf360c',
    'A100': '#ff9e80',
    'A200': '#ff6e40',
    'A400': '#ff3d00',
    'A700': '#dd2c00',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300 400 A100 A200',
    'contrastStrongLightColors': '500 600 700 800 900 A400 A700'
  },
  'brown': {
    '50': '#efebe9',
    '100': '#d7ccc8',
    '200': '#bcaaa4',
    '300': '#a1887f',
    '400': '#8d6e63',
    '500': '#795548',
    '600': '#6d4c41',
    '700': '#5d4037',
    '800': '#4e342e',
    '900': '#3e2723',
    'A100': '#d7ccc8',
    'A200': '#bcaaa4',
    'A400': '#8d6e63',
    'A700': '#5d4037',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200',
    'contrastStrongLightColors': '300 400'
  },
  'grey': {
    '50': '#fafafa',
    '100': '#f5f5f5',
    '200': '#eeeeee',
    '300': '#e0e0e0',
    '400': '#bdbdbd',
    '500': '#9e9e9e',
    '600': '#757575',
    '700': '#616161',
    '800': '#424242',
    '900': '#212121',
    '1000': '#000000',
    'A100': '#ffffff',
    'A200': '#eeeeee',
    'A400': '#bdbdbd',
    'A700': '#616161',
    'contrastDefaultColor': 'dark',
    'contrastLightColors': '600 700 800 900'
  },
  'blue-grey': {
    '50': '#eceff1',
    '100': '#cfd8dc',
    '200': '#b0bec5',
    '300': '#90a4ae',
    '400': '#78909c',
    '500': '#607d8b',
    '600': '#546e7a',
    '700': '#455a64',
    '800': '#37474f',
    '900': '#263238',
    'A100': '#cfd8dc',
    'A200': '#b0bec5',
    'A400': '#78909c',
    'A700': '#455a64',
    'contrastDefaultColor': 'light',
    'contrastDarkColors': '50 100 200 300',
    'contrastStrongLightColors': '400 500'
  }
});

})();
(function(){
"use strict";

angular.module('material.core.theming', ['material.core.theming.palette'])
  .directive('mdTheme', ThemingDirective)
  .directive('mdThemable', ThemableDirective)
  .provider('$mdTheming', ThemingProvider)
  .run(generateThemes);

/**
 * @ngdoc provider
 * @name $mdThemingProvider
 * @module material.core
 *
 * @description Provider to configure the `$mdTheming` service.
 */

/**
 * @ngdoc method
 * @name $mdThemingProvider#setDefaultTheme
 * @param {string} themeName Default theme name to be applied to elements. Default value is `default`.
 */

/**
 * @ngdoc method
 * @name $mdThemingProvider#alwaysWatchTheme
 * @param {boolean} watch Whether or not to always watch themes for changes and re-apply
 * classes when they change. Default is `false`. Enabling can reduce performance.
 */

/* Some Example Valid Theming Expressions
 * =======================================
 *
 * Intention group expansion: (valid for primary, accent, warn, background)
 *
 * {{primary-100}} - grab shade 100 from the primary palette
 * {{primary-100-0.7}} - grab shade 100, apply opacity of 0.7
 * {{primary-hue-1}} - grab the shade assigned to hue-1 from the primary palette
 * {{primary-hue-1-0.7}} - apply 0.7 opacity to primary-hue-1
 * {{primary-color}} - Generates .md-hue-1, .md-hue-2, .md-hue-3 with configured shades set for each hue
 * {{primary-color-0.7}} - Apply 0.7 opacity to each of the above rules
 * {{primary-contrast}} - Generates .md-hue-1, .md-hue-2, .md-hue-3 with configured contrast (ie. text) color shades set for each hue
 * {{primary-contrast-0.7}} - Apply 0.7 opacity to each of the above rules
 *
 * Foreground expansion: Applies rgba to black/white foreground text
 *
 * {{foreground-1}} - used for primary text
 * {{foreground-2}} - used for secondary text/divider
 * {{foreground-3}} - used for disabled text
 * {{foreground-4}} - used for dividers
 *
 */

// In memory generated CSS rules; registered by theme.name
var GENERATED = { };

// In memory storage of defined themes and color palettes (both loaded by CSS, and user specified)
var PALETTES;
var THEMES;

var DARK_FOREGROUND = {
  name: 'dark',
  '1': 'rgba(0,0,0,0.87)',
  '2': 'rgba(0,0,0,0.54)',
  '3': 'rgba(0,0,0,0.26)',
  '4': 'rgba(0,0,0,0.12)'
};
var LIGHT_FOREGROUND = {
  name: 'light',
  '1': 'rgba(255,255,255,1.0)',
  '2': 'rgba(255,255,255,0.7)',
  '3': 'rgba(255,255,255,0.3)',
  '4': 'rgba(255,255,255,0.12)'
};

var DARK_SHADOW = '1px 1px 0px rgba(0,0,0,0.4), -1px -1px 0px rgba(0,0,0,0.4)';
var LIGHT_SHADOW = '';

var DARK_CONTRAST_COLOR = colorToRgbaArray('rgba(0,0,0,0.87)');
var LIGHT_CONTRAST_COLOR = colorToRgbaArray('rgba(255,255,255,0.87');
var STRONG_LIGHT_CONTRAST_COLOR = colorToRgbaArray('rgb(255,255,255)');

var THEME_COLOR_TYPES = ['primary', 'accent', 'warn', 'background'];
var DEFAULT_COLOR_TYPE = 'primary';

// A color in a theme will use these hues by default, if not specified by user.
var LIGHT_DEFAULT_HUES = {
  'accent': {
    'default': 'A200',
    'hue-1': 'A100',
    'hue-2': 'A400',
    'hue-3': 'A700'
  },
  'background': {
    'default': 'A100',
    'hue-1': '300',
    'hue-2': '800',
    'hue-3': '900'
  }
};

var DARK_DEFAULT_HUES = {
  'background': {
    'default': '800',
    'hue-1': '300',
    'hue-2': '600',
    'hue-3': '900'
  }
};
THEME_COLOR_TYPES.forEach(function(colorType) {
  // Color types with unspecified default hues will use these default hue values
  var defaultDefaultHues = {
    'default': '500',
    'hue-1': '300',
    'hue-2': '800',
    'hue-3': 'A100'
  };
  if (!LIGHT_DEFAULT_HUES[colorType]) LIGHT_DEFAULT_HUES[colorType] = defaultDefaultHues;
  if (!DARK_DEFAULT_HUES[colorType]) DARK_DEFAULT_HUES[colorType] = defaultDefaultHues;
});

var VALID_HUE_VALUES = [
  '50', '100', '200', '300', '400', '500', '600',
  '700', '800', '900', 'A100', 'A200', 'A400', 'A700'
];

function ThemingProvider($mdColorPalette) {
  PALETTES = { };
  THEMES = { };

  var themingProvider;
  var defaultTheme = 'default';
  var alwaysWatchTheme = false;

  // Load JS Defined Palettes
  angular.extend(PALETTES, $mdColorPalette);

  // Default theme defined in core.js

  ThemingService.$inject = ["$rootScope", "$log"];
  return themingProvider = {
    definePalette: definePalette,
    extendPalette: extendPalette,
    theme: registerTheme,

    setDefaultTheme: function(theme) {
      defaultTheme = theme;
    },
    alwaysWatchTheme: function(alwaysWatch) {
      alwaysWatchTheme = alwaysWatch;
    },
    $get: ThemingService,
    _LIGHT_DEFAULT_HUES: LIGHT_DEFAULT_HUES,
    _DARK_DEFAULT_HUES: DARK_DEFAULT_HUES,
    _PALETTES: PALETTES,
    _THEMES: THEMES,
    _parseRules: parseRules,
    _rgba: rgba
  };

  // Example: $mdThemingProvider.definePalette('neonRed', { 50: '#f5fafa', ... });
  function definePalette(name, map) {
    map = map || {};
    PALETTES[name] = checkPaletteValid(name, map);
    return themingProvider;
  }

  // Returns an new object which is a copy of a given palette `name` with variables from
  // `map` overwritten
  // Example: var neonRedMap = $mdThemingProvider.extendPalette('red', { 50: '#f5fafafa' });
  function extendPalette(name, map) {
    return checkPaletteValid(name,  angular.extend({}, PALETTES[name] || {}, map) );
  }

  // Make sure that palette has all required hues
  function checkPaletteValid(name, map) {
    var missingColors = VALID_HUE_VALUES.filter(function(field) {
      return !map[field];
    });
    if (missingColors.length) {
      throw new Error("Missing colors %1 in palette %2!"
                      .replace('%1', missingColors.join(', '))
                      .replace('%2', name));
    }

    return map;
  }

  // Register a theme (which is a collection of color palettes to use with various states
  // ie. warn, accent, primary )
  // Optionally inherit from an existing theme
  // $mdThemingProvider.theme('custom-theme').primaryPalette('red');
  function registerTheme(name, inheritFrom) {
    if (THEMES[name]) return THEMES[name];

    inheritFrom = inheritFrom || 'default';

    var parentTheme = typeof inheritFrom === 'string' ? THEMES[inheritFrom] : inheritFrom;
    var theme = new Theme(name);

    if (parentTheme) {
      angular.forEach(parentTheme.colors, function(color, colorType) {
        theme.colors[colorType] = {
          name: color.name,
          // Make sure a COPY of the hues is given to the child color,
          // not the same reference.
          hues: angular.extend({}, color.hues)
        };
      });
    }
    THEMES[name] = theme;

    return theme;
  }

  function Theme(name) {
    var self = this;
    self.name = name;
    self.colors = {};

    self.dark = setDark;
    setDark(false);

    function setDark(isDark) {
      isDark = arguments.length === 0 ? true : !!isDark;

      // If no change, abort
      if (isDark === self.isDark) return;

      self.isDark = isDark;

      self.foregroundPalette = self.isDark ? LIGHT_FOREGROUND : DARK_FOREGROUND;
      self.foregroundShadow = self.isDark ? DARK_SHADOW : LIGHT_SHADOW;

      // Light and dark themes have different default hues.
      // Go through each existing color type for this theme, and for every
      // hue value that is still the default hue value from the previous light/dark setting,
      // set it to the default hue value from the new light/dark setting.
      var newDefaultHues = self.isDark ? DARK_DEFAULT_HUES : LIGHT_DEFAULT_HUES;
      var oldDefaultHues = self.isDark ? LIGHT_DEFAULT_HUES : DARK_DEFAULT_HUES;
      angular.forEach(newDefaultHues, function(newDefaults, colorType) {
        var color = self.colors[colorType];
        var oldDefaults = oldDefaultHues[colorType];
        if (color) {
          for (var hueName in color.hues) {
            if (color.hues[hueName] === oldDefaults[hueName]) {
              color.hues[hueName] = newDefaults[hueName];
            }
          }
        }
      });

      return self;
    }

    THEME_COLOR_TYPES.forEach(function(colorType) {
      var defaultHues = (self.isDark ? DARK_DEFAULT_HUES : LIGHT_DEFAULT_HUES)[colorType];
      self[colorType + 'Palette'] = function setPaletteType(paletteName, hues) {
        var color = self.colors[colorType] = {
          name: paletteName,
          hues: angular.extend({}, defaultHues, hues)
        };

        Object.keys(color.hues).forEach(function(name) {
          if (!defaultHues[name]) {
            throw new Error("Invalid hue name '%1' in theme %2's %3 color %4. Available hue names: %4"
              .replace('%1', name)
              .replace('%2', self.name)
              .replace('%3', paletteName)
              .replace('%4', Object.keys(defaultHues).join(', '))
            );
          }
        });
        Object.keys(color.hues).map(function(key) {
          return color.hues[key];
        }).forEach(function(hueValue) {
          if (VALID_HUE_VALUES.indexOf(hueValue) == -1) {
            throw new Error("Invalid hue value '%1' in theme %2's %3 color %4. Available hue values: %5"
              .replace('%1', hueValue)
              .replace('%2', self.name)
              .replace('%3', colorType)
              .replace('%4', paletteName)
              .replace('%5', VALID_HUE_VALUES.join(', '))
            );
          }
        });
        return self;
      };

      self[colorType + 'Color'] = function() {
        var args = Array.prototype.slice.call(arguments);
        console.warn('$mdThemingProviderTheme.' + colorType + 'Color() has been deprecated. ' +
                     'Use $mdThemingProviderTheme.' + colorType + 'Palette() instead.');
        return self[colorType + 'Palette'].apply(self, args);
      };
    });
  }

  /**
   * @ngdoc service
   * @name $mdTheming
   *
   * @description
   *
   * Service that makes an element apply theming related classes to itself.
   *
   * ```js
   * app.directive('myFancyDirective', function($mdTheming) {
   *   return {
   *     restrict: 'e',
   *     link: function(scope, el, attrs) {
   *       $mdTheming(el);
   *     }
   *   };
   * });
   * ```
   * @param {el=} element to apply theming to
   */
  /* @ngInject */
  function ThemingService($rootScope, $log) {

    applyTheme.inherit = function(el, parent) {
      var ctrl = parent.controller('mdTheme');

      var attrThemeValue = el.attr('md-theme-watch');
      if ( (alwaysWatchTheme || angular.isDefined(attrThemeValue)) && attrThemeValue != 'false') {
        var deregisterWatch = $rootScope.$watch(function() {
          return ctrl && ctrl.$mdTheme || defaultTheme;
        }, changeTheme);
        el.on('$destroy', deregisterWatch);
      } else {
        var theme = ctrl && ctrl.$mdTheme || defaultTheme;
        changeTheme(theme);
      }

      function changeTheme(theme) {
        if (!registered(theme)) {
          $log.warn('Attempted to use unregistered theme \'' + theme + '\'. ' +
                    'Register it with $mdThemingProvider.theme().');
        }
        var oldTheme = el.data('$mdThemeName');
        if (oldTheme) el.removeClass('md-' + oldTheme +'-theme');
        el.addClass('md-' + theme + '-theme');
        el.data('$mdThemeName', theme);
      }
    };

    applyTheme.THEMES = angular.extend({}, THEMES);
    applyTheme.defaultTheme = function() { return defaultTheme; };
    applyTheme.registered = registered;

    return applyTheme;

    function registered(themeName) {
      if (themeName === undefined || themeName === '') return true;
      return applyTheme.THEMES[themeName] !== undefined;
    }

    function applyTheme(scope, el) {
      // Allow us to be invoked via a linking function signature.
      if (el === undefined) {
        el = scope;
        scope = undefined;
      }
      if (scope === undefined) {
        scope = $rootScope;
      }
      applyTheme.inherit(el, el);
    }
  }
}
ThemingProvider.$inject = ["$mdColorPalette"];

function ThemingDirective($mdTheming, $interpolate, $log) {
  return {
    priority: 100,
    link: {
      pre: function(scope, el, attrs) {
        var ctrl = {
          $setTheme: function(theme) {
            if (!$mdTheming.registered(theme)) {
              $log.warn('attempted to use unregistered theme \'' + theme + '\'');
            }
            ctrl.$mdTheme = theme;
          }
        };
        el.data('$mdThemeController', ctrl);
        ctrl.$setTheme($interpolate(attrs.mdTheme)(scope));
        attrs.$observe('mdTheme', ctrl.$setTheme);
      }
    }
  };
}
ThemingDirective.$inject = ["$mdTheming", "$interpolate", "$log"];

function ThemableDirective($mdTheming) {
  return $mdTheming;
}
ThemableDirective.$inject = ["$mdTheming"];

function parseRules(theme, colorType, rules) {
  checkValidPalette(theme, colorType);

  rules = rules.replace(/THEME_NAME/g, theme.name);
  var generatedRules = [];
  var color = theme.colors[colorType];

  var themeNameRegex = new RegExp('.md-' + theme.name + '-theme', 'g');
  // Matches '{{ primary-color }}', etc
  var hueRegex = new RegExp('(\'|")?{{\\s*(' + colorType + ')-(color|contrast)-?(\\d\\.?\\d*)?\\s*}}(\"|\')?','g');
  var simpleVariableRegex = /'?"?\{\{\s*([a-zA-Z]+)-(A?\d+|hue\-[0-3]|shadow)-?(\d\.?\d*)?\s*\}\}'?"?/g;
  var palette = PALETTES[color.name];

  // find and replace simple variables where we use a specific hue, not an entire palette
  // eg. "{{primary-100}}"
  //\(' + THEME_COLOR_TYPES.join('\|') + '\)'
  rules = rules.replace(simpleVariableRegex, function(match, colorType, hue, opacity) {
    if (colorType === 'foreground') {
      if (hue == 'shadow') {
        return theme.foregroundShadow;
      } else {
        return theme.foregroundPalette[hue] || theme.foregroundPalette['1'];
      }
    }
    if (hue.indexOf('hue') === 0) {
      hue = theme.colors[colorType].hues[hue];
    }
    return rgba( (PALETTES[ theme.colors[colorType].name ][hue] || '').value, opacity );
  });

  // For each type, generate rules for each hue (ie. default, md-hue-1, md-hue-2, md-hue-3)
  angular.forEach(color.hues, function(hueValue, hueName) {
    var newRule = rules
      .replace(hueRegex, function(match, _, colorType, hueType, opacity) {
        return rgba(palette[hueValue][hueType === 'color' ? 'value' : 'contrast'], opacity);
      });
    if (hueName !== 'default') {
      newRule = newRule.replace(themeNameRegex, '.md-' + theme.name + '-theme.md-' + hueName);
    }

    // Don't apply a selector rule to the default theme, making it easier to override
    // styles of the base-component
    if (theme.name == 'default') {
      newRule = newRule.replace(/\.md-default-theme/g, '');
    }
    generatedRules.push(newRule);
  });

  return generatedRules;
}

// Generate our themes at run time given the state of THEMES and PALETTES
function generateThemes($injector) {

  var head = document.getElementsByTagName('head')[0];
  var firstChild = head ? head.firstElementChild : null;
  var themeCss = $injector.has('$MD_THEME_CSS') ? $injector.get('$MD_THEME_CSS') : '';

  if ( !firstChild ) return;
  if (themeCss.length === 0) return; // no rules, so no point in running this expensive task

  // Expose contrast colors for palettes to ensure that text is always readable
  angular.forEach(PALETTES, sanitizePalette);

  // MD_THEME_CSS is a string generated by the build process that includes all the themable
  // components as templates

  // Break the CSS into individual rules
  var rulesByType = {};
  var rules = themeCss
                  .split(/\}(?!(\}|'|"|;))/)
                  .filter(function(rule) { return rule && rule.length; })
                  .map(function(rule) { return rule.trim() + '}'; });


  var ruleMatchRegex = new RegExp('md-(' + THEME_COLOR_TYPES.join('|') + ')', 'g');

  THEME_COLOR_TYPES.forEach(function(type) {
    rulesByType[type] = '';
  });


  // Sort the rules based on type, allowing us to do color substitution on a per-type basis
  rules.forEach(function(rule) {
    var match = rule.match(ruleMatchRegex);
    // First: test that if the rule has '.md-accent', it goes into the accent set of rules
    for (var i = 0, type; type = THEME_COLOR_TYPES[i]; i++) {
      if (rule.indexOf('.md-' + type) > -1) {
        return rulesByType[type] += rule;
      }
    }

    // If no eg 'md-accent' class is found, try to just find 'accent' in the rule and guess from
    // there
    for (i = 0; type = THEME_COLOR_TYPES[i]; i++) {
      if (rule.indexOf(type) > -1) {
        return rulesByType[type] += rule;
      }
    }

    // Default to the primary array
    return rulesByType[DEFAULT_COLOR_TYPE] += rule;
  });

    // For each theme, use the color palettes specified for
    // `primary`, `warn` and `accent` to generate CSS rules.

    angular.forEach(THEMES, function(theme) {
      if ( !GENERATED[theme.name] ) {


        THEME_COLOR_TYPES.forEach(function(colorType) {
          var styleStrings = parseRules(theme, colorType, rulesByType[colorType]);
          while (styleStrings.length) {
            var style = document.createElement('style');
                style.setAttribute('type', 'text/css');
            style.appendChild(document.createTextNode(styleStrings.shift()));
            head.insertBefore(style, firstChild);
          }
        });


        if (theme.colors.primary.name == theme.colors.accent.name) {
          console.warn("$mdThemingProvider: Using the same palette for primary and" +
                       " accent. This violates the material design spec.");
        }

        GENERATED[theme.name] = true;
      }
    });


  // *************************
  // Internal functions
  // *************************

  // The user specifies a 'default' contrast color as either light or dark,
  // then explicitly lists which hues are the opposite contrast (eg. A100 has dark, A200 has light)
  function sanitizePalette(palette) {
    var defaultContrast = palette.contrastDefaultColor;
    var lightColors = palette.contrastLightColors || [];
    var strongLightColors = palette.contrastStrongLightColors || [];
    var darkColors = palette.contrastDarkColors || [];

    // These colors are provided as space-separated lists
    if (typeof lightColors === 'string') lightColors = lightColors.split(' ');
    if (typeof strongLightColors === 'string') strongLightColors = strongLightColors.split(' ');
    if (typeof darkColors === 'string') darkColors = darkColors.split(' ');

    // Cleanup after ourselves
    delete palette.contrastDefaultColor;
    delete palette.contrastLightColors;
    delete palette.contrastStrongLightColors;
    delete palette.contrastDarkColors;

    // Change { 'A100': '#fffeee' } to { 'A100': { value: '#fffeee', contrast:DARK_CONTRAST_COLOR }
    angular.forEach(palette, function(hueValue, hueName) {
      if (angular.isObject(hueValue)) return; // Already converted
      // Map everything to rgb colors
      var rgbValue = colorToRgbaArray(hueValue);
      if (!rgbValue) {
        throw new Error("Color %1, in palette %2's hue %3, is invalid. Hex or rgb(a) color expected."
                        .replace('%1', hueValue)
                        .replace('%2', palette.name)
                        .replace('%3', hueName));
      }

      palette[hueName] = {
        value: rgbValue,
        contrast: getContrastColor()
      };
      function getContrastColor() {
        if (defaultContrast === 'light') {
          if (darkColors.indexOf(hueName) > -1) {
            return DARK_CONTRAST_COLOR;
          } else {
            return strongLightColors.indexOf(hueName) > -1 ? STRONG_LIGHT_CONTRAST_COLOR
              : LIGHT_CONTRAST_COLOR;
          }
        } else {
          if (lightColors.indexOf(hueName) > -1) {
            return strongLightColors.indexOf(hueName) > -1 ? STRONG_LIGHT_CONTRAST_COLOR
              : LIGHT_CONTRAST_COLOR;
          } else {
            return DARK_CONTRAST_COLOR;
          }
        }
      }
    });
  }


}
generateThemes.$inject = ["$injector"];

function checkValidPalette(theme, colorType) {
  // If theme attempts to use a palette that doesnt exist, throw error
  if (!PALETTES[ (theme.colors[colorType] || {}).name ]) {
    throw new Error(
      "You supplied an invalid color palette for theme %1's %2 palette. Available palettes: %3"
                    .replace('%1', theme.name)
                    .replace('%2', colorType)
                    .replace('%3', Object.keys(PALETTES).join(', '))
    );
  }
}

function colorToRgbaArray(clr) {
  if (angular.isArray(clr) && clr.length == 3) return clr;
  if (/^rgb/.test(clr)) {
    return clr.replace(/(^\s*rgba?\(|\)\s*$)/g, '').split(',').map(function(value, i) {
      return i == 3 ? parseFloat(value, 10) : parseInt(value, 10);
    });
  }
  if (clr.charAt(0) == '#') clr = clr.substring(1);
  if (!/^([a-fA-F0-9]{3}){1,2}$/g.test(clr)) return;

  var dig = clr.length / 3;
  var red = clr.substr(0, dig);
  var grn = clr.substr(dig, dig);
  var blu = clr.substr(dig * 2);
  if (dig === 1) {
    red += red;
    grn += grn;
    blu += blu;
  }
  return [parseInt(red, 16), parseInt(grn, 16), parseInt(blu, 16)];
}

function rgba(rgbArray, opacity) {
  if ( !rgbArray ) return "rgb('0,0,0')";

  if (rgbArray.length == 4) {
    rgbArray = angular.copy(rgbArray);
    opacity ? rgbArray.pop() : opacity = rgbArray.pop();
  }
  return opacity && (typeof opacity == 'number' || (typeof opacity == 'string' && opacity.length)) ?
    'rgba(' + rgbArray.join(',') + ',' + opacity + ')' :
    'rgb(' + rgbArray.join(',') + ')';
}


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.autocomplete
 */
/*
 * @see js folder for autocomplete implementation
 */
angular.module('material.components.autocomplete', [
  'material.core',
  'material.components.icon'
]);

})();
(function(){
"use strict";

/*
 * @ngdoc module
 * @name material.components.backdrop
 * @description Backdrop
 */

/**
 * @ngdoc directive
 * @name mdBackdrop
 * @module material.components.backdrop
 *
 * @restrict E
 *
 * @description
 * `<md-backdrop>` is a backdrop element used by other components, such as dialog and bottom sheet.
 * Apply class `opaque` to make the backdrop use the theme backdrop color.
 *
 */

angular.module('material.components.backdrop', [
  'material.core'
])
  .directive('mdBackdrop', BackdropDirective);

function BackdropDirective($mdTheming) {
  return $mdTheming;
}
BackdropDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.bottomSheet
 * @description
 * BottomSheet
 */
angular.module('material.components.bottomSheet', [
  'material.core',
  'material.components.backdrop'
])
  .directive('mdBottomSheet', MdBottomSheetDirective)
  .provider('$mdBottomSheet', MdBottomSheetProvider);

function MdBottomSheetDirective() {
  return {
    restrict: 'E'
  };
}

/**
 * @ngdoc service
 * @name $mdBottomSheet
 * @module material.components.bottomSheet
 *
 * @description
 * `$mdBottomSheet` opens a bottom sheet over the app and provides a simple promise API.
 *
 * ## Restrictions
 *
 * - The bottom sheet's template must have an outer `<md-bottom-sheet>` element.
 * - Add the `md-grid` class to the bottom sheet for a grid layout.
 * - Add the `md-list` class to the bottom sheet for a list layout.
 *
 * @usage
 * <hljs lang="html">
 * <div ng-controller="MyController">
 *   <md-button ng-click="openBottomSheet()">
 *     Open a Bottom Sheet!
 *   </md-button>
 * </div>
 * </hljs>
 * <hljs lang="js">
 * var app = angular.module('app', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdBottomSheet) {
 *   $scope.openBottomSheet = function() {
 *     $mdBottomSheet.show({
 *       template: '<md-bottom-sheet>Hello!</md-bottom-sheet>'
 *     });
 *   };
 * });
 * </hljs>
 */

 /**
 * @ngdoc method
 * @name $mdBottomSheet#show
 *
 * @description
 * Show a bottom sheet with the specified options.
 *
 * @param {object} options An options object, with the following properties:
 *
 *   - `templateUrl` - `{string=}`: The url of an html template file that will
 *   be used as the content of the bottom sheet. Restrictions: the template must
 *   have an outer `md-bottom-sheet` element.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual
 *   template string.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified, it will create a new child scope.
 *     This scope will be destroyed when the bottom sheet is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `controller` - `{string=}`: The controller to associate with this bottom sheet.
 *   - `locals` - `{string=}`: An object containing key/value pairs. The keys will
 *   be used as names of values to inject into the controller. For example,
 *   `locals: {three: 3}` would inject `three` into the controller with the value
 *   of 3.
 *   - `targetEvent` - `{DOMClickEvent=}`: A click's event object. When passed in as an option,
 *   the location of the click will be used as the starting point for the opening animation
 *   of the the dialog.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values
 *   and the bottom sheet will not open until the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the bottom sheet to. The `parent` may be a `function`, `string`,
 *   `object`, or null. Defaults to appending to the body of the root element (or the root element) of the application.
 *   e.g. angular.element(document.getElementById('content')) or "#content"
 *   - `disableParentScroll` - `{boolean=}`: Whether to disable scrolling while the bottom sheet is open.
 *     Default true.
 *
 * @returns {promise} A promise that can be resolved with `$mdBottomSheet.hide()` or
 * rejected with `$mdBottomSheet.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdBottomSheet#hide
 *
 * @description
 * Hide the existing bottom sheet and resolve the promise returned from
 * `$mdBottomSheet.show()`. This call will close the most recently opened/current bottomsheet (if any).
 *
 * @param {*=} response An argument for the resolved promise.
 *
 */

/**
 * @ngdoc method
 * @name $mdBottomSheet#cancel
 *
 * @description
 * Hide the existing bottom sheet and reject the promise returned from
 * `$mdBottomSheet.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 */

function MdBottomSheetProvider($$interimElementProvider) {
  // how fast we need to flick down to close the sheet, pixels/ms
  var CLOSING_VELOCITY = 0.5;
  var PADDING = 80; // same as css

  bottomSheetDefaults.$inject = ["$animate", "$mdConstant", "$mdUtil", "$timeout", "$compile", "$mdTheming", "$mdBottomSheet", "$rootElement", "$mdGesture"];
  return $$interimElementProvider('$mdBottomSheet')
    .setDefaults({
      methods: ['disableParentScroll', 'escapeToClose', 'targetEvent'],
      options: bottomSheetDefaults
    });

  /* @ngInject */
  function bottomSheetDefaults($animate, $mdConstant, $mdUtil, $timeout, $compile, $mdTheming, $mdBottomSheet, $rootElement, $mdGesture) {
    var backdrop;

    return {
      themable: true,
      targetEvent: null,
      onShow: onShow,
      onRemove: onRemove,
      escapeToClose: true,
      disableParentScroll: true
    };


    function onShow(scope, element, options) {

      element = $mdUtil.extractElementByName(element, 'md-bottom-sheet');

      // Add a backdrop that will close on click
      backdrop = $compile('<md-backdrop class="md-opaque md-bottom-sheet-backdrop">')(scope);
      backdrop.on('click', function() {
        $timeout($mdBottomSheet.cancel);
      });
      $mdTheming.inherit(backdrop, options.parent);

      $animate.enter(backdrop, options.parent, null);

      var bottomSheet = new BottomSheet(element, options.parent);
      options.bottomSheet = bottomSheet;

      // Give up focus on calling item
      options.targetEvent && angular.element(options.targetEvent.target).blur();
      $mdTheming.inherit(bottomSheet.element, options.parent);

      if (options.disableParentScroll) {
        options.lastOverflow = options.parent.css('overflow');
        options.parent.css('overflow', 'hidden');
      }

      return $animate.enter(bottomSheet.element, options.parent)
        .then(function() {
          var focusable = angular.element(
            element[0].querySelector('button') ||
            element[0].querySelector('a') ||
            element[0].querySelector('[ng-click]')
          );
          focusable.focus();

          if (options.escapeToClose) {
            options.rootElementKeyupCallback = function(e) {
              if (e.keyCode === $mdConstant.KEY_CODE.ESCAPE) {
                $timeout($mdBottomSheet.cancel);
              }
            };
            $rootElement.on('keyup', options.rootElementKeyupCallback);
          }
        });

    }

    function onRemove(scope, element, options) {

      var bottomSheet = options.bottomSheet;

      $animate.leave(backdrop);
      return $animate.leave(bottomSheet.element).then(function() {
        if (options.disableParentScroll) {
          options.parent.css('overflow', options.lastOverflow);
          delete options.lastOverflow;
        }

        bottomSheet.cleanup();

        // Restore focus
        options.targetEvent && angular.element(options.targetEvent.target).focus();
      });
    }

    /**
     * BottomSheet class to apply bottom-sheet behavior to an element
     */
    function BottomSheet(element, parent) {
      var deregister = $mdGesture.register(parent, 'drag', { horizontal: false });
      parent.on('$md.dragstart', onDragStart)
        .on('$md.drag', onDrag)
        .on('$md.dragend', onDragEnd);

      return {
        element: element,
        cleanup: function cleanup() {
          deregister();
          parent.off('$md.dragstart', onDragStart)
            .off('$md.drag', onDrag)
            .off('$md.dragend', onDragEnd);
        }
      };

      function onDragStart(ev) {
        // Disable transitions on transform so that it feels fast
        element.css($mdConstant.CSS.TRANSITION_DURATION, '0ms');
      }

      function onDrag(ev) {
        var transform = ev.pointer.distanceY;
        if (transform < 5) {
          // Slow down drag when trying to drag up, and stop after PADDING
          transform = Math.max(-PADDING, transform / 2);
        }
        element.css($mdConstant.CSS.TRANSFORM, 'translate3d(0,' + (PADDING + transform) + 'px,0)');
      }

      function onDragEnd(ev) {
        if (ev.pointer.distanceY > 0 &&
            (ev.pointer.distanceY > 20 || Math.abs(ev.pointer.velocityY) > CLOSING_VELOCITY)) {
          var distanceRemaining = element.prop('offsetHeight') - ev.pointer.distanceY;
          var transitionDuration = Math.min(distanceRemaining / ev.pointer.velocityY * 0.75, 500);
          element.css($mdConstant.CSS.TRANSITION_DURATION, transitionDuration + 'ms');
          $timeout($mdBottomSheet.cancel);
        } else {
          element.css($mdConstant.CSS.TRANSITION_DURATION, '');
          element.css($mdConstant.CSS.TRANSFORM, '');
        }
      }
    }

  }

}
MdBottomSheetProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.button
 * @description
 *
 * Button
 */
angular
    .module('material.components.button', [ 'material.core' ])
    .directive('mdButton', MdButtonDirective);

/**
 * @ngdoc directive
 * @name mdButton
 * @module material.components.button
 *
 * @restrict E
 *
 * @description
 * `<md-button>` is a button directive with optional ink ripples (default enabled).
 *
 * If you supply a `href` or `ng-href` attribute, it will become an `<a>` element. Otherwise, it will
 * become a `<button>` element. As per the [Material Design specifications](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the FAB button background is filled with the accent color [by default]. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {boolean=} md-no-ink If present, disable ripple ink effects.
 * @param {expression=} ng-disabled En/Disable based on the expression
 * @param {string=} md-ripple-size Overrides the default ripple size logic. Options: `full`, `partial`, `auto`
 * @param {string=} aria-label Adds alternative text to button for accessibility, useful for icon buttons.
 * If no default text is found, a warning will be logged.
 *
 * @usage
 *
 * Regular buttons:
 *
 * <hljs lang="html">
 *  <md-button> Flat Button </md-button>
 *  <md-button href="http://google.com"> Flat link </md-button>
 *  <md-button class="md-raised"> Raised Button </md-button>
 *  <md-button ng-disabled="true"> Disabled Button </md-button>
 *  <md-button>
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *    Register Now
 *  </md-button>
 * </hljs>
 *
 * FAB buttons:
 *
 * <hljs lang="html">
 *  <md-button class="md-fab" aria-label="FAB">
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *  </md-button>
 *  <!-- mini-FAB -->
 *  <md-button class="md-fab md-mini" aria-label="Mini FAB">
 *    <md-icon md-svg-src="your/icon.svg"></md-icon>
 *  </md-button>
 *  <!-- Button with SVG Icon -->
 *  <md-button class="md-icon-button" aria-label="Custom Icon Button">
 *    <md-icon md-svg-icon="path/to/your.svg"></md-icon>
 *  </md-button>
 * </hljs>
 */
function MdButtonDirective($mdButtonInkRipple, $mdTheming, $mdAria, $timeout) {

  return {
    restrict: 'EA',
    replace: true,
    transclude: true,
    template: getTemplate,
    link: postLink
  };

  function isAnchor(attr) {
    return angular.isDefined(attr.href) || angular.isDefined(attr.ngHref) || angular.isDefined(attr.ngLink) || angular.isDefined(attr.uiSref);
  }

  function getTemplate(element, attr) {
    return isAnchor(attr) ?
           '<a class="md-button" ng-transclude></a>' :
           '<button class="md-button" ng-transclude></button>';
  }

  function postLink(scope, element, attr) {
    var node = element[0];
    $mdTheming(element);
    $mdButtonInkRipple.attach(scope, element);

    var elementHasText = node.textContent.trim();
    if (!elementHasText) {
      $mdAria.expect(element, 'aria-label');
    }

    // For anchor elements, we have to set tabindex manually when the
    // element is disabled
    if (isAnchor(attr) && angular.isDefined(attr.ngDisabled) ) {
      scope.$watch(attr.ngDisabled, function(isDisabled) {
        element.attr('tabindex', isDisabled ? -1 : 0);
      });
    }

    // disabling click event when disabled is true
    element.on('click', function(e){
      if (attr.disabled === true) {
        e.preventDefault();
        e.stopImmediatePropagation();
      }
    });

    // restrict focus styles to the keyboard
    scope.mouseActive = false;
    element.on('mousedown', function() {
        scope.mouseActive = true;
        $timeout(function(){
          scope.mouseActive = false;
        }, 100);
      })
      .on('focus', function() {
        if(scope.mouseActive === false) { element.addClass('md-focused'); }
      })
      .on('blur', function() { element.removeClass('md-focused'); });
  }

}
MdButtonDirective.$inject = ["$mdButtonInkRipple", "$mdTheming", "$mdAria", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.card
 *
 * @description
 * Card components.
 */
angular.module('material.components.card', [
  'material.core'
])
  .directive('mdCard', mdCardDirective);



/**
 * @ngdoc directive
 * @name mdCard
 * @module material.components.card
 *
 * @restrict E
 *
 * @description
 * The `<md-card>` directive is a container element used within `<md-content>` containers.
 *
 * An image included as a direct descendant will fill the card's width, while the `<md-card-content>`
 * container will wrap text content and provide padding. An `<md-card-footer>` element can be
 * optionally included to put content flush against the bottom edge of the card.
 *
 * Action buttons can be included in an element with the `.md-actions` class, also used in `md-dialog`.
 * You can then position buttons using layout attributes.
 *
 * Cards have constant width and variable heights; where the maximum height is limited to what can
 * fit within a single view on a platform, but it can temporarily expand as needed.
 *
 * @usage
 * ###Card with optional footer
 * <hljs lang="html">
 * <md-card>
 *  <img src="card-image.png" class="md-card-image" alt="image caption">
 *  <md-card-content>
 *    <h2>Card headline</h2>
 *    <p>Card content</p>
 *  </md-card-content>
 *  <md-card-footer>
 *    Card footer
 *  </md-card-footer>
 * </md-card>
 * </hljs>
 *
 * ###Card with actions
 * <hljs lang="html">
 * <md-card>
 *  <img src="card-image.png" class="md-card-image" alt="image caption">
 *  <md-card-content>
 *    <h2>Card headline</h2>
 *    <p>Card content</p>
 *  </md-card-content>
 *  <div class="md-actions" layout="row" layout-align="end center">
 *    <md-button>Action 1</md-button>
 *    <md-button>Action 2</md-button>
 *  </div>
 * </md-card>
 * </hljs>
 *
 */
function mdCardDirective($mdTheming) {
  return {
    restrict: 'E',
    link: function($scope, $element, $attr) {
      $mdTheming($element);
    }
  };
}
mdCardDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.checkbox
 * @description Checkbox module!
 */
angular
  .module('material.components.checkbox', ['material.core'])
  .directive('mdCheckbox', MdCheckboxDirective);

/**
 * @ngdoc directive
 * @name mdCheckbox
 * @module material.components.checkbox
 * @restrict E
 *
 * @description
 * The checkbox directive is used like the normal [angular checkbox](https://docs.angularjs.org/api/ng/input/input%5Bcheckbox%5D).
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the checkbox is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {expression=} ng-true-value The value to which the expression should be set when selected.
 * @param {expression=} ng-false-value The value to which the expression should be set when not selected.
 * @param {string=} ng-change Angular expression to be executed when input changes due to user interaction with the input element.
 * @param {boolean=} md-no-ink Use of attribute indicates use of ripple ink effects
 * @param {string=} aria-label Adds label to checkbox for accessibility.
 * Defaults to checkbox's text. If no default text is found, a warning will be logged.
 *
 * @usage
 * <hljs lang="html">
 * <md-checkbox ng-model="isChecked" aria-label="Finished?">
 *   Finished ?
 * </md-checkbox>
 *
 * <md-checkbox md-no-ink ng-model="hasInk" aria-label="No Ink Effects">
 *   No Ink Effects
 * </md-checkbox>
 *
 * <md-checkbox ng-disabled="true" ng-model="isDisabled" aria-label="Disabled">
 *   Disabled
 * </md-checkbox>
 *
 * </hljs>
 *
 */
function MdCheckboxDirective(inputDirective, $mdInkRipple, $mdAria, $mdConstant, $mdTheming, $mdUtil, $timeout) {
  inputDirective = inputDirective[0];
  var CHECKED_CSS = 'md-checked';

  return {
    restrict: 'E',
    transclude: true,
    require: '?ngModel',
    priority:210, // Run before ngAria
    template: 
      '<div class="md-container" md-ink-ripple md-ink-ripple-checkbox>' +
        '<div class="md-icon"></div>' +
      '</div>' +
      '<div ng-transclude class="md-label"></div>',
    compile: compile
  };

  // **********************************************************
  // Private Methods
  // **********************************************************

  function compile (tElement, tAttrs) {

    tAttrs.type = 'checkbox';
    tAttrs.tabindex = tAttrs.tabindex || '0';
    tElement.attr('role', tAttrs.type);

    return function postLink(scope, element, attr, ngModelCtrl) {
      ngModelCtrl = ngModelCtrl || $mdUtil.fakeNgModel();
      $mdTheming(element);

      if (attr.ngChecked) {
        scope.$watch(
            scope.$eval.bind(scope, attr.ngChecked),
            ngModelCtrl.$setViewValue.bind(ngModelCtrl)
        );
      }
      $$watchExpr('ngDisabled', 'tabindex', {
        true: '-1',
        false: attr.tabindex
      });
      $mdAria.expectWithText(element, 'aria-label');

      // Reuse the original input[type=checkbox] directive from Angular core.
      // This is a bit hacky as we need our own event listener and own render
      // function.
      inputDirective.link.pre(scope, {
        on: angular.noop,
        0: {}
      }, attr, [ngModelCtrl]);

      scope.mouseActive = false;
      element.on('click', listener)
        .on('keypress', keypressHandler)
        .on('mousedown', function() {
          scope.mouseActive = true;
          $timeout(function(){
            scope.mouseActive = false;
          }, 100);
        })
        .on('focus', function() {
          if(scope.mouseActive === false) { element.addClass('md-focused'); }
        })
        .on('blur', function() { element.removeClass('md-focused'); });

      ngModelCtrl.$render = render;

      function $$watchExpr(expr, htmlAttr, valueOpts) {
        if (attr[expr]) {
          scope.$watch(attr[expr], function(val) {
            if (valueOpts[val]) {
              element.attr(htmlAttr, valueOpts[val]);
            }
          });
        }
      }

      function keypressHandler(ev) {
        var keyCode = ev.which || ev.keyCode;
        if (keyCode === $mdConstant.KEY_CODE.SPACE || keyCode === $mdConstant.KEY_CODE.ENTER) {
          ev.preventDefault();
          if (!element.hasClass('md-focused')) { element.addClass('md-focused'); }
          listener(ev);
        }
      }
      function listener(ev) {
        if (element[0].hasAttribute('disabled')) return;

        scope.$apply(function() {
          // Toggle the checkbox value...
          var viewValue = attr.ngChecked ? attr.checked : !ngModelCtrl.$viewValue;

          ngModelCtrl.$setViewValue( viewValue, ev && ev.type);
          ngModelCtrl.$render();
        });
      }

      function render() {
        if(ngModelCtrl.$viewValue) {
          element.addClass(CHECKED_CSS);
        } else {
          element.removeClass(CHECKED_CSS);
        }
      }
    };
  }
}
MdCheckboxDirective.$inject = ["inputDirective", "$mdInkRipple", "$mdAria", "$mdConstant", "$mdTheming", "$mdUtil", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.chips
 */
/*
 * @see js folder for chips implementation
 */
angular.module('material.components.chips', [
  'material.core',
  'material.components.autocomplete'
]);

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.content
 *
 * @description
 * Scrollable content
 */
angular.module('material.components.content', [
  'material.core'
])
  .directive('mdContent', mdContentDirective);

/**
 * @ngdoc directive
 * @name mdContent
 * @module material.components.content
 *
 * @restrict E
 *
 * @description
 * The `<md-content>` directive is a container element useful for scrollable content
 *
 * @usage
 *
 * - Add the `[layout-padding]` attribute to make the content padded.
 *
 * <hljs lang="html">
 *  <md-content layout-padding>
 *      Lorem ipsum dolor sit amet, ne quod novum mei.
 *  </md-content>
 * </hljs>
 *
 */

function mdContentDirective($mdTheming) {
  return {
    restrict: 'E',
    controller: ['$scope', '$element', ContentController],
    link: function(scope, element, attr) {
      var node = element[0];

      $mdTheming(element);
      scope.$broadcast('$mdContentLoaded', element);

      iosScrollFix(element[0]);
    }
  };

  function ContentController($scope, $element) {
    this.$scope = $scope;
    this.$element = $element;
  }
}
mdContentDirective.$inject = ["$mdTheming"];

function iosScrollFix(node) {
  // IOS FIX:
  // If we scroll where there is no more room for the webview to scroll,
  // by default the webview itself will scroll up and down, this looks really
  // bad.  So if we are scrolling to the very top or bottom, add/subtract one
  angular.element(node).on('$md.pressdown', function(ev) {
    // Only touch events
    if (ev.pointer.type !== 't') return;
    // Don't let a child content's touchstart ruin it for us.
    if (ev.$materialScrollFixed) return;
    ev.$materialScrollFixed = true;

    if (node.scrollTop === 0) {
      node.scrollTop = 1;
    } else if (node.scrollHeight === node.scrollTop + node.offsetHeight) {
      node.scrollTop -= 1;
    }
  });
}

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.dialog
 */
angular.module('material.components.dialog', [
  'material.core',
  'material.components.backdrop'
])
  .directive('mdDialog', MdDialogDirective)
  .provider('$mdDialog', MdDialogProvider);

function MdDialogDirective($$rAF, $mdTheming) {
  return {
    restrict: 'E',
    link: function(scope, element, attr) {
      $mdTheming(element);
      $$rAF(function() {
        var content = element[0].querySelector('md-dialog-content');
        if (content && content.scrollHeight > content.clientHeight) {
          element.addClass('md-content-overflow');
        }
      });
    }
  };
}
MdDialogDirective.$inject = ["$$rAF", "$mdTheming"];

/**
 * @ngdoc service
 * @name $mdDialog
 * @module material.components.dialog
 *
 * @description
 * `$mdDialog` opens a dialog over the app to inform users about critical information or require
 *  them to make decisions. There are two approaches for setup: a simple promise API
 *  and regular object syntax.
 *
 * ## Restrictions
 *
 * - The dialog is always given an isolate scope.
 * - The dialog's template must have an outer `<md-dialog>` element.
 *   Inside, use an `<md-dialog-content>` element for the dialog's content, and use
 *   an element with class `md-actions` for the dialog's actions.
 * - Dialogs must cover the entire application to keep interactions inside of them.
 * Use the `parent` option to change where dialogs are appended.
 *
 * ## Sizing
 * - Complex dialogs can be sized with `flex="percentage"`, i.e. `flex="66"`.
 * - Default max-width is 80% of the `rootElement` or `parent`.
 *
 * @usage
 * <hljs lang="html">
 * <div  ng-app="demoApp" ng-controller="EmployeeController">
 *   <div>
 *     <md-button ng-click="showAlert()" class="md-raised md-warn">
 *       Employee Alert!
 *       </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="showDialog($event)" class="md-raised">
 *       Custom Dialog
 *       </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="closeAlert()" ng-disabled="!hasAlert()" class="md-raised">
 *       Close Alert
 *     </md-button>
 *   </div>
 *   <div>
 *     <md-button ng-click="showGreeting($event)" class="md-raised md-primary" >
 *       Greet Employee
 *       </md-button>
 *   </div>
 * </div>
 * </hljs>
 *
 * ### JavaScript: object syntax
 * <hljs lang="js">
 * (function(angular, undefined){
 *   "use strict";
 *
 *   angular
 *    .module('demoApp', ['ngMaterial'])
 *    .controller('AppCtrl', AppController);
 *
 *   function AppController($scope, $mdDialog) {
 *     var alert;
 *     $scope.showAlert = showAlert;
 *     $scope.showDialog = showDialog;
 *     $scope.items = [1, 2, 3];
 *
 *     // Internal method
 *     function showAlert() {
 *       alert = $mdDialog.alert({
 *         title: 'Attention',
 *         content: 'This is an example of how easy dialogs can be!',
 *         ok: 'Close'
 *       });
 *
 *       $mdDialog
 *         .show( alert )
 *         .finally(function() {
 *           alert = undefined;
 *         });
 *     }
 *
 *     function showDialog($event) {
 *        var parentEl = angular.element(document.body);
 *        $mdDialog.show({
 *          parent: parentEl,
 *          targetEvent: $event,
 *          template:
 *            '<md-dialog aria-label="List dialog">' +
 *            '  <md-dialog-content>'+
 *            '    <md-list>'+
 *            '      <md-list-item ng-repeat="item in items">'+
 *            '       <p>Number {{item}}</p>' +
 *            '      </md-item>'+
 *            '    </md-list>'+
 *            '  </md-dialog-content>' +
 *            '  <div class="md-actions">' +
 *            '    <md-button ng-click="closeDialog()" class="md-primary">' +
 *            '      Close Dialog' +
 *            '    </md-button>' +
 *            '  </div>' +
 *            '</md-dialog>',
 *          locals: {
 *            items: $scope.items
 *          },
 *          controller: DialogController
 *       });
 *       function DialogController($scope, $mdDialog, items) {
 *         $scope.items = items;
 *         $scope.closeDialog = function() {
 *           $mdDialog.hide();
 *         }
 *       }
 *     }
 *   }
 * })(angular);
 * </hljs>
 *
 * ### JavaScript: promise API syntax, custom dialog template
 * <hljs lang="js">
 * (function(angular, undefined){
 *   "use strict";
 *
 *   angular
 *     .module('demoApp', ['ngMaterial'])
 *     .controller('EmployeeController', EmployeeEditor)
 *     .controller('GreetingController', GreetingController);
 *
 *   // Fictitious Employee Editor to show how to use simple and complex dialogs.
 *
 *   function EmployeeEditor($scope, $mdDialog) {
 *     var alert;
 *
 *     $scope.showAlert = showAlert;
 *     $scope.closeAlert = closeAlert;
 *     $scope.showGreeting = showCustomGreeting;
 *
 *     $scope.hasAlert = function() { return !!alert };
 *     $scope.userName = $scope.userName || 'Bobby';
 *
 *     // Dialog #1 - Show simple alert dialog and cache
 *     // reference to dialog instance
 *
 *     function showAlert() {
 *       alert = $mdDialog.alert()
 *         .title('Attention, ' + $scope.userName)
 *         .content('This is an example of how easy dialogs can be!')
 *         .ok('Close');
 *
 *       $mdDialog
 *           .show( alert )
 *           .finally(function() {
 *             alert = undefined;
 *           });
 *     }
 *
 *     // Close the specified dialog instance and resolve with 'finished' flag
 *     // Normally this is not needed, just use '$mdDialog.hide()' to close
 *     // the most recent dialog popup.
 *
 *     function closeAlert() {
 *       $mdDialog.hide( alert, "finished" );
 *       alert = undefined;
 *     }
 *
 *     // Dialog #2 - Demonstrate more complex dialogs construction and popup.
 *
 *     function showCustomGreeting($event) {
 *         $mdDialog.show({
 *           targetEvent: $event,
 *           template:
 *             '<md-dialog>' +
 *
 *             '  <md-dialog-content>Hello {{ employee }}!</md-dialog-content>' +
 *
 *             '  <div class="md-actions">' +
 *             '    <md-button ng-click="closeDialog()" class="md-primary">' +
 *             '      Close Greeting' +
 *             '    </md-button>' +
 *             '  </div>' +
 *             '</md-dialog>',
 *           controller: 'GreetingController',
 *           onComplete: afterShowAnimation,
 *           locals: { employee: $scope.userName }
 *         });
 *
 *         // When the 'enter' animation finishes...
 *
 *         function afterShowAnimation(scope, element, options) {
 *            // post-show code here: DOM element focus, etc.
 *         }
 *     }
 *
 *     // Dialog #3 - Demonstrate use of ControllerAs and passing $scope to dialog
 *     //             Here we used ng-controller="GreetingController as vm" and
 *     //             $scope.vm === <controller instance>
 *
 *     function showCustomGreeting() {
 *
 *        $mdDialog.show({
 *           clickOutsideToClose: true,
 *
 *           scope: $scope,        // use parent scope in template
 *           preserveScope: true,  // do not forget this if use parent scope

 *           // Since GreetingController is instantiated with ControllerAs syntax
 *           // AND we are passing the parent '$scope' to the dialog, we MUST
 *           // use 'vm.<xxx>' in the template markup
 *
 *           template: '<md-dialog>' +
 *                     '  <md-dialog-content>' +
 *                     '     Hi There {{vm.employee}}' +
 *                     '  </md-dialog-content>' +
 *                     '</md-dialog>',
 *
 *           controller: function DialogController($scope, $mdDialog) {
 *             $scope.closeDialog = function() {
 *               $mdDialog.hide();
 *             }
 *           }
 *        });
 *     }
 *
 *   }
 *
 *   // Greeting controller used with the more complex 'showCustomGreeting()' custom dialog
 *
 *   function GreetingController($scope, $mdDialog, employee) {
 *     // Assigned from construction <code>locals</code> options...
 *     $scope.employee = employee;
 *
 *     $scope.closeDialog = function() {
 *       // Easily hides most recent dialog shown...
 *       // no specific instance reference is needed.
 *       $mdDialog.hide();
 *     };
 *   }
 *
 * })(angular);
 * </hljs>
 */

 /**
 * @ngdoc method
 * @name $mdDialog#alert
 *
 * @description
 * Builds a preconfigured dialog with the specified message.
 *
 * @returns {obj} an `$mdDialogPreset` with the chainable configuration methods:
 *
 * - $mdDialogPreset#title(string) - sets title to string
 * - $mdDialogPreset#content(string) - sets content / message to string
 * - $mdDialogPreset#ok(string) - sets okay button text to string
 * - $mdDialogPreset#theme(string) - sets the theme of the dialog
 *
 */

 /**
 * @ngdoc method
 * @name $mdDialog#confirm
 *
 * @description
 * Builds a preconfigured dialog with the specified message. You can call show and the promise returned
 * will be resolved only if the user clicks the confirm action on the dialog.
 *
 * @returns {obj} an `$mdDialogPreset` with the chainable configuration methods:
 *
 * Additionally, it supports the following methods:
 *
 * - $mdDialogPreset#title(string) - sets title to string
 * - $mdDialogPreset#content(string) - sets content / message to string
 * - $mdDialogPreset#ok(string) - sets okay button text to string
 * - $mdDialogPreset#cancel(string) - sets cancel button text to string
 * - $mdDialogPreset#theme(string) - sets the theme of the dialog
 *
 */

/**
 * @ngdoc method
 * @name $mdDialog#show
 *
 * @description
 * Show a dialog with the specified options.
 *
 * @param {object} optionsOrPreset Either provide an `$mdDialogPreset` returned from `alert()`, and
 * `confirm()`, or an options object with the following properties:
 *   - `templateUrl` - `{string=}`: The url of a template that will be used as the content
 *   of the dialog.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual template string.
 *   - `targetEvent` - `{DOMClickEvent=}`: A click's event object. When passed in as an option,
 *     the location of the click will be used as the starting point for the opening animation
 *     of the the dialog.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified,
 *     it will create a new isolate scope.
 *     This scope will be destroyed when the dialog is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `disableParentScroll` - `{boolean=}`: Whether to disable scrolling while the dialog is open.
 *     Default true.
 *   - `hasBackdrop` - `{boolean=}`: Whether there should be an opaque backdrop behind the dialog.
 *     Default true.
 *   - `clickOutsideToClose` - `{boolean=}`: Whether the user can click outside the dialog to
 *     close it. Default false.
 *   - `escapeToClose` - `{boolean=}`: Whether the user can press escape to close the dialog.
 *     Default true.
 *   - `focusOnOpen` - `{boolean=}`: An option to override focus behavior on open. Only disable if
 *     focusing some other way, as focus management is required for dialogs to be accessible.
 *     Defaults to true.
 *   - `controller` - `{string=}`: The controller to associate with the dialog. The controller
 *     will be injected with the local `$mdDialog`, which passes along a scope for the dialog.
 *   - `locals` - `{object=}`: An object containing key/value pairs. The keys will be used as names
 *     of values to inject into the controller. For example, `locals: {three: 3}` would inject
 *     `three` into the controller, with the value 3. If `bindToController` is true, they will be
 *     copied to the controller instead.
 *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in.
 *     These values will not be available until after initialization.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values, and the
 *     dialog will not open until all of the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the dialog to. Defaults to appending
 *     to the root element of the application.
 *   - `onComplete` `{function=}`: Callback function used to announce when the show() action is
 *     finished.
 *
 * @returns {promise} A promise that can be resolved with `$mdDialog.hide()` or
 * rejected with `$mdDialog.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdDialog#hide
 *
 * @description
 * Hide an existing dialog and resolve the promise returned from `$mdDialog.show()`.
 *
 * @param {*=} response An argument for the resolved promise.
 *
 * @returns {promise} A promise that is resolved when the dialog has been closed.
 */

/**
 * @ngdoc method
 * @name $mdDialog#cancel
 *
 * @description
 * Hide an existing dialog and reject the promise returned from `$mdDialog.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 * @returns {promise} A promise that is resolved when the dialog has been closed.
 */

function MdDialogProvider($$interimElementProvider) {

  var alertDialogMethods = ['title', 'content', 'ariaLabel', 'ok'];

  advancedDialogOptions.$inject = ["$mdDialog", "$mdTheming"];
  dialogDefaultOptions.$inject = ["$mdAria", "$document", "$mdUtil", "$mdConstant", "$mdTheming", "$mdDialog", "$timeout", "$rootElement", "$animate", "$$rAF", "$q"];
  return $$interimElementProvider('$mdDialog')
    .setDefaults({
      methods: ['disableParentScroll', 'hasBackdrop', 'clickOutsideToClose', 'escapeToClose', 'targetEvent', 'parent'],
      options: dialogDefaultOptions
    })
    .addPreset('alert', {
      methods: ['title', 'content', 'ariaLabel', 'ok', 'theme'],
      options: advancedDialogOptions
    })
    .addPreset('confirm', {
      methods: ['title', 'content', 'ariaLabel', 'ok', 'cancel', 'theme'],
      options: advancedDialogOptions
    });

  /* @ngInject */
  function advancedDialogOptions($mdDialog, $mdTheming) {
    return {
      template: [
        '<md-dialog md-theme="{{ dialog.theme }}" aria-label="{{ dialog.ariaLabel }}">',
          '<md-dialog-content role="document" tabIndex="-1">',
            '<h2 class="md-title">{{ dialog.title }}</h2>',
            '<p>{{ dialog.content }}</p>',
          '</md-dialog-content>',
          '<div class="md-actions">',
            '<md-button ng-if="dialog.$type == \'confirm\'"' +
                      ' ng-click="dialog.abort()" class="md-primary">',
              '{{ dialog.cancel }}',
            '</md-button>',
            '<md-button ng-click="dialog.hide()" class="md-primary">',
              '{{ dialog.ok }}',
            '</md-button>',
          '</div>',
        '</md-dialog>'
      ].join(''),
      controller: function mdDialogCtrl() {
        this.hide = function() {
          $mdDialog.hide(true);
        };
        this.abort = function() {
          $mdDialog.cancel();
        };
      },
      controllerAs: 'dialog',
      bindToController: true,
      theme: $mdTheming.defaultTheme()
    };
  }

  /* @ngInject */
  function dialogDefaultOptions($mdAria, $document, $mdUtil, $mdConstant, $mdTheming, $mdDialog, $timeout, $rootElement, $animate, $$rAF, $q) {
    return {
      hasBackdrop: true,
      isolateScope: true,
      onShow: onShow,
      onRemove: onRemove,
      clickOutsideToClose: false,
      escapeToClose: true,
      targetEvent: null,
      focusOnOpen: true,
      disableParentScroll: true,
      transformTemplate: function(template) {
        return '<div class="md-dialog-container">' + template + '</div>';
      }
    };

    function trapFocus(ev) {
      var dialog = document.querySelector('md-dialog');

      if (dialog && !dialog.contains(ev.target)) {
        ev.stopImmediatePropagation();
        dialog.focus();
      }
    }

    // On show method for dialogs
    function onShow(scope, element, options) {
      angular.element($document[0].body).addClass('md-dialog-is-showing');
      element = $mdUtil.extractElementByName(element, 'md-dialog');

      // Incase the user provides a raw dom element, always wrap it in jqLite
      options.parent = angular.element(options.parent);

      options.popInTarget = angular.element((options.targetEvent || {}).target);
      var closeButton = findCloseButton();

      if (options.hasBackdrop) {
        // Fix for IE 10
        var computeFrom = (options.parent[0] == $document[0].body && $document[0].documentElement
                           && $document[0].documentElement.scrollTop) ? angular.element($document[0].documentElement) : options.parent;
        var parentOffset = computeFrom.prop('scrollTop');
        options.backdrop = angular.element('<md-backdrop class="md-dialog-backdrop md-opaque">');
        options.backdrop.css('top', parentOffset +'px');
        $mdTheming.inherit(options.backdrop, options.parent);
        $animate.enter(options.backdrop, options.parent);
        element.css('top', parentOffset +'px');
      }

      var role = 'dialog',
          elementToFocus = closeButton;

      if (options.$type === 'alert') {
        role = 'alertdialog';
        elementToFocus = element.find('md-dialog-content');
      }

      configureAria(element.find('md-dialog'), role, options);

      document.addEventListener('focus', trapFocus, true);

      if (options.disableParentScroll) {
        options.lastOverflow = options.parent.css('overflow');
        options.parent.css('overflow', 'hidden');
      }

      return dialogPopIn(
        element,
        options.parent,
        options.popInTarget && options.popInTarget.length && options.popInTarget
      )
      .then(function() {

        applyAriaToSiblings(element, true);

        if (options.escapeToClose) {
          options.rootElementKeyupCallback = function(e) {
            if (e.keyCode === $mdConstant.KEY_CODE.ESCAPE) {
              $timeout($mdDialog.cancel);
            }
          };
          $rootElement.on('keyup', options.rootElementKeyupCallback);
        }

        if (options.clickOutsideToClose) {
          options.dialogClickOutsideCallback = function(ev) {
            // Only close if we click the flex container outside the backdrop
            if (ev.target === element[0]) {
              $timeout($mdDialog.cancel);
            }
          };
          element.on('click', options.dialogClickOutsideCallback);
        }

        if (options.focusOnOpen) {
          elementToFocus.focus();
        }
      });


      function findCloseButton() {
        //If no element with class dialog-close, try to find the last
        //button child in md-actions and assume it is a close button
        var closeButton = element[0].querySelector('.dialog-close');
        if (!closeButton) {
          var actionButtons = element[0].querySelectorAll('.md-actions button');
          closeButton = actionButtons[ actionButtons.length - 1 ];
        }
        return angular.element(closeButton);
      }

    }

    // On remove function for all dialogs
    function onRemove(scope, element, options) {
      angular.element($document[0].body).removeClass('md-dialog-is-showing');

      if (options.backdrop) {
        $animate.leave(options.backdrop);
      }
      if (options.disableParentScroll) {
        options.parent.css('overflow', options.lastOverflow);
        delete options.lastOverflow;
      }
      if (options.escapeToClose) {
        $rootElement.off('keyup', options.rootElementKeyupCallback);
      }
      if (options.clickOutsideToClose) {
        element.off('click', options.dialogClickOutsideCallback);
      }

      applyAriaToSiblings(element, false);

      document.removeEventListener('focus', trapFocus, true);

      return dialogPopOut(
        element,
        options.parent,
        options.popInTarget && options.popInTarget.length && options.popInTarget
      ).then(function() {
        element.remove();
        options.popInTarget && options.popInTarget.focus();
      });

    }

    /**
     * Inject ARIA-specific attributes appropriate for Dialogs
     */
    function configureAria(element, role, options) {

      element.attr({
        'role': role,
        'tabIndex': '-1'
      });

      var dialogContent = element.find('md-dialog-content');
      if (dialogContent.length === 0){
        dialogContent = element;
      }

      var dialogId = element.attr('id') || ('dialog_' + $mdUtil.nextUid());
      dialogContent.attr('id', dialogId);
      element.attr('aria-describedby', dialogId);

      if (options.ariaLabel) {
        $mdAria.expect(element, 'aria-label', options.ariaLabel);
      }
      else {
        $mdAria.expectAsync(element, 'aria-label', function() {
          var words = dialogContent.text().split(/\s+/);
          if (words.length > 3) words = words.slice(0,3).concat('...');
          return words.join(' ');
        });
      }
    }
    /**
     * Utility function to filter out raw DOM nodes
     */
    function isNodeOneOf(elem, nodeTypeArray) {
      if (nodeTypeArray.indexOf(elem.nodeName) !== -1) {
        return true;
      }
    }
    /**
     * Walk DOM to apply or remove aria-hidden on sibling nodes
     * and parent sibling nodes
     *
     * Prevents screen reader interaction behind modal window
     * on swipe interfaces
     */
    function applyAriaToSiblings(element, value) {
      var attribute = 'aria-hidden';

      // get raw DOM node
      element = element[0];

      function walkDOM(element) {
        while (element.parentNode) {
          if (element === document.body) {
            return;
          }
          var children = element.parentNode.children;
          for (var i = 0; i < children.length; i++) {
            // skip over child if it is an ascendant of the dialog
            // or a script or style tag
            if (element !== children[i] && !isNodeOneOf(children[i], ['SCRIPT', 'STYLE'])) {
              children[i].setAttribute(attribute, value);
            }
          }

          walkDOM(element = element.parentNode);
        }
      }
      walkDOM(element);
    }

    function dialogPopIn(container, parentElement, clickElement) {
      var dialogEl = container.find('md-dialog');

      parentElement.append(container);
      transformToClickElement(dialogEl, clickElement);

      $$rAF(function() {
        dialogEl.addClass('transition-in')
          .css($mdConstant.CSS.TRANSFORM, '');
      });

      return $mdUtil.transitionEndPromise(dialogEl);
    }

    function dialogPopOut(container, parentElement, clickElement) {
      var dialogEl = container.find('md-dialog');

      dialogEl.addClass('transition-out').removeClass('transition-in');
      transformToClickElement(dialogEl, clickElement);

      return $mdUtil.transitionEndPromise(dialogEl);
    }

    function transformToClickElement(dialogEl, clickElement) {
      if (clickElement) {
        var clickRect = clickElement[0].getBoundingClientRect();
        var dialogRect = dialogEl[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / dialogRect.width);
        var scaleY = Math.min(0.5, clickRect.height / dialogRect.height);

        dialogEl.css($mdConstant.CSS.TRANSFORM, 'translate3d(' +
          (-dialogRect.left + clickRect.left + clickRect.width/2 - dialogRect.width/2) + 'px,' +
          (-dialogRect.top + clickRect.top + clickRect.height/2 - dialogRect.height/2) + 'px,' +
          '0) scale(' + scaleX + ',' + scaleY + ')'
        );
      }
    }

    function dialogTransitionEnd(dialogEl) {
      var deferred = $q.defer();
      dialogEl.on($mdConstant.CSS.TRANSITIONEND, finished);
      function finished(ev) {
        //Make sure this transitionend didn't bubble up from a child
        if (ev.target === dialogEl[0]) {
          dialogEl.off($mdConstant.CSS.TRANSITIONEND, finished);
          deferred.resolve();
        }
      }
      return deferred.promise;
    }

  }
}
MdDialogProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.divider
 * @description Divider module!
 */
angular.module('material.components.divider', [
  'material.core'
])
  .directive('mdDivider', MdDividerDirective);

/**
 * @ngdoc directive
 * @name mdDivider
 * @module material.components.divider
 * @restrict E
 *
 * @description
 * Dividers group and separate content within lists and page layouts using strong visual and spatial distinctions. This divider is a thin rule, lightweight enough to not distract the user from content.
 *
 * @param {boolean=} md-inset Add this attribute to activate the inset divider style.
 * @usage
 * <hljs lang="html">
 * <md-divider></md-divider>
 *
 * <md-divider md-inset></md-divider>
 * </hljs>
 *
 */
function MdDividerDirective($mdTheming) {
  return {
    restrict: 'E',
    link: $mdTheming
  };
}
MdDividerDirective.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabActions', ['material.core'])
    .directive('mdFabActions', MdFabActionsDirective);

  /**
   * @ngdoc directive
   * @name mdFabActions
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-actions>` directive is used inside of a `<md-fab-speed-dial>` or
   * `<md-fab-toolbar>` directive to mark the an element (or elements) as the actions and setup the
   * proper event listeners.
   *
   * @usage
   * See the `<md-fab-speed-dial>` or `<md-fab-toolbar>` directives for example usage.
   */
  function MdFabActionsDirective() {
    return {
      restrict: 'E',

      require: ['^?mdFabSpeedDial', '^?mdFabToolbar'],

      link: function(scope, element, attributes, controllers) {
        // Grab whichever parent controller is used
        var controller = controllers[0] || controllers[1];

        // Make the children open/close their parent directive
        if (controller) {
          angular.forEach(element.children(), function(child) {
            angular.element(child).on('focus', controller.open);
            angular.element(child).on('blur', controller.close);
          });
        }

        // After setting up the listeners, wrap every child in a new div and add a class that we can
        // scale/fling independently
        element.children().wrap('<div class="md-fab-action-item">');
      }
    }
  }

})();
})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabSpeedDial', [
      'material.core',
      'material.components.fabTrigger',
      'material.components.fabActions'
    ])
    .directive('mdFabSpeedDial', MdFabSpeedDialDirective)
    .animation('.md-fling', MdFabSpeedDialFlingAnimation)
    .animation('.md-scale', MdFabSpeedDialScaleAnimation);

  /**
   * @ngdoc directive
   * @name mdFabSpeedDial
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-speed-dial>` directive is used to present a series of popup elements (usually
   * `<md-button>`s) for quick access to common actions.
   *
   * There are currently two animations available by applying one of the following classes to
   * the component:
   *
   *  - `md-fling` - The speed dial items appear from underneath the trigger and move into their
   *    appropriate positions.
   *  - `md-scale` - The speed dial items appear in their proper places by scaling from 0% to 100%.
   *
   * @usage
   * <hljs lang="html">
   * <md-fab-speed-dial direction="up" class="md-fling">
   *   <md-fab-trigger>
   *     <md-button aria-label="Add..."><md-icon icon="/img/icons/plus.svg"></md-icon></md-button>
   *   </md-fab-trigger>
   *
   *   <md-fab-actions>
   *     <md-button aria-label="Add User">
   *       <md-icon icon="/img/icons/user.svg"></md-icon>
   *     </md-button>
   *
   *     <md-button aria-label="Add Group">
   *       <md-icon icon="/img/icons/group.svg"></md-icon>
   *     </md-button>
   *   </md-fab-actions>
   * </md-fab-speed-dial>
   * </hljs>
   *
   * @param {string=} md-direction From which direction you would like the speed dial to appear
   * relative to the trigger element.
   * @param {expression=} md-open Programmatically control whether or not the speed-dial is visible.
   */
  function MdFabSpeedDialDirective() {
    FabSpeedDialController.$inject = ["$scope", "$element", "$animate"];
    return {
      restrict: 'E',

      scope: {
        direction: '@?mdDirection',
        isOpen: '=?mdOpen'
      },

      bindToController: true,
      controller: FabSpeedDialController,
      controllerAs: 'vm',

      link: FabSpeedDialLink
    };

    function FabSpeedDialLink(scope, element) {
      // Prepend an element to hold our CSS variables so we can use them in the animations below
      element.prepend('<div class="md-css-variables"></div>');
    }

    function FabSpeedDialController($scope, $element, $animate) {
      var vm = this;

      // Define our open/close functions
      // Note: Used by fabTrigger and fabActions directives
      vm.open = function() {
        $scope.$apply('vm.isOpen = true');
      };

      vm.close = function() {
        $scope.$apply('vm.isOpen = false');
      };

      setupDefaults();
      setupListeners();
      setupWatchers();

      // Set our default variables
      function setupDefaults() {
        // Set the default direction to 'down' if none is specified
        vm.direction = vm.direction || 'down';

        // Set the default to be closed
        vm.isOpen = vm.isOpen || false;
      }

      // Setup our event listeners
      function setupListeners() {
        $element.on('mouseenter', vm.open);
        $element.on('mouseleave', vm.close);
      }

      // Setup our watchers
      function setupWatchers() {
        // Watch for changes to the direction and update classes/attributes
        $scope.$watch('vm.direction', function(newDir, oldDir) {
          // Add the appropriate classes so we can target the direction in the CSS
          $animate.removeClass($element, 'md-' + oldDir);
          $animate.addClass($element, 'md-' + newDir);
        });


        // Watch for changes to md-open
        $scope.$watch('vm.isOpen', function(isOpen) {
          var toAdd = isOpen ? 'md-is-open' : '';
          var toRemove = isOpen ? '' : 'md-is-open';

          $animate.setClass($element, toAdd, toRemove);
        });
      }
    }
  }

  function MdFabSpeedDialFlingAnimation() {
    function runAnimation(element) {
      var el = element[0];
      var ctrl = element.controller('mdFabSpeedDial');
      var items = el.querySelectorAll('.md-fab-action-item');

      // Grab our element which stores CSS variables
      var variablesElement = el.querySelector('.md-css-variables');

      // Setup JS variables based on our CSS variables
      var startZIndex = variablesElement.style.zIndex;

      // Always reset the items to their natural position/state
      angular.forEach(items, function(item, index) {
        var styles = item.style;

        styles.transform = '';
        styles.transitionDelay = '';
        styles.opacity = 1;

        // Make the items closest to the trigger have the highest z-index
        item.style.zIndex = (items.length - index) + startZIndex;
      });

      // If the control is closed, hide the items behind the trigger
      if (!ctrl.isOpen) {
        angular.forEach(items, function(item, index) {
          var newPosition, axis;

          switch (ctrl.direction) {
            case 'up':
              newPosition = item.scrollHeight * (index + 1);
              axis = 'Y';
              break;
            case 'down':
              newPosition = -item.scrollHeight * (index + 1);
              axis = 'Y';
              break;
            case 'left':
              newPosition = item.scrollWidth * (index + 1);
              axis = 'X';
              break;
            case 'right':
              newPosition = -item.scrollWidth * (index + 1);
              axis = 'X';
              break;
          }

          item.style.transform = 'translate' + axis + '(' + newPosition + 'px)';
        });
      }
    }

    return {
      addClass: function(element, className, done) {
        if (element.hasClass('md-fling')) {
          runAnimation(element);
        }
      },
      removeClass: function(element, className, done) {
        runAnimation(element);
      }
    }
  }

  function MdFabSpeedDialScaleAnimation() {
    var delay = 65;

    function runAnimation(element) {
      var el = element[0];
      var ctrl = element.controller('mdFabSpeedDial');
      var items = el.querySelectorAll('.md-fab-action-item');

      // Always reset the items to their natural position/state
      angular.forEach(items, function(item, index) {
        var styles = item.style,
          offsetDelay = index * delay;

        styles.opacity = ctrl.isOpen ? 1 : 0;
        styles.transform = ctrl.isOpen ? 'scale(1)' : 'scale(0)';
        styles.transitionDelay = (ctrl.isOpen ?  offsetDelay : (items.length - offsetDelay)) + 'ms';
      });
    }

    return {
      addClass: function(element, className, done) {
        runAnimation(element);
      },

      removeClass: function(element, className, done) {
        runAnimation(element);
      }
    }
  }
})();

})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabToolbar', [
      'material.core',
      'material.components.fabTrigger',
      'material.components.fabActions'
    ])
    .directive('mdFabToolbar', MdFabToolbarDirective)
    .animation('.md-fab-toolbar', MdFabToolbarAnimation);

  /**
   * @ngdoc directive
   * @name mdFabToolbar
   * @module material.components.fabToolbar
   *
   * @restrict E
   *
   * @description
   *
   * The `<md-fab-toolbar>` directive is used present a toolbar of elements (usually `<md-button>`s)
   * for quick access to common actions when a floating action button is activated (via hover or
   * keyboard navigation).
   *
   * @usage
   *
   * <hljs lang="html">
   * <md-fab-toolbar>
   *   <md-fab-trigger>
   *     <md-button aria-label="Add..."><md-icon icon="/img/icons/plus.svg"></md-icon></md-button>
   *   </md-fab-trigger>
   *
   *   <md-fab-actions>
   *     <md-button aria-label="Add User">
   *       <md-icon icon="/img/icons/user.svg"></md-icon>
   *     </md-button>
   *
   *     <md-button aria-label="Add Group">
   *       <md-icon icon="/img/icons/group.svg"></md-icon>
   *     </md-button>
   *   </md-fab-actions>
   * </md-fab-toolbar>
   * </hljs>
   *
   * @param {expression=} md-open Programmatically control whether or not the toolbar is visible.
   */
  function MdFabToolbarDirective() {
    FabToolbarController.$inject = ["$scope", "$element", "$animate"];
    return {
      restrict: 'E',
      transclude: true,
      template:
        '<div class="md-fab-toolbar-wrapper">' +
        '  <div class="md-fab-toolbar-content" ng-transclude></div>' +
        '</div>',

      scope: {
        isOpen: '=?mdOpen'
      },

      bindToController: true,
      controller: FabToolbarController,
      controllerAs: 'vm',

      link: link
    };

    function FabToolbarController($scope, $element, $animate) {
      var vm = this;

      // Set the default to be closed
      vm.isOpen = vm.isOpen || false;

      vm.open = function() {
        vm.isOpen = true;
        $scope.$apply();
      };

      vm.close = function() {
        vm.isOpen = false;
        $scope.$apply();
      };

      // Add our class so we can trigger the animation on start
      $element.addClass('md-fab-toolbar');

      // Setup some mouse events so the hover effect can be triggered
      // anywhere over the toolbar
      $element.on('mouseenter', vm.open);
      $element.on('mouseleave', vm.close);

      // Watch for changes to md-open and toggle our class
      $scope.$watch('vm.isOpen', function(isOpen) {
        var toAdd = isOpen ? 'md-is-open' : '';
        var toRemove = isOpen ? '' : 'md-is-open';

        $animate.setClass($element, toAdd, toRemove);
      });
    }

    function link(scope, element, attributes) {
      // Don't allow focus on the trigger
      element.find('md-fab-trigger').find('button').attr('tabindex', '-1');

      // Prepend the background element to the trigger's button
      element.find('md-fab-trigger').find('button')
        .prepend('<div class="md-fab-toolbar-background"></div>');
    }
  }

  function MdFabToolbarAnimation() {
    var originalIconDelay;

    function runAnimation(element, className, done) {
      var el = element[0];
      var ctrl = element.controller('mdFabToolbar');

      // Grab the relevant child elements
      var backgroundElement = el.querySelector('.md-fab-toolbar-background');
      var triggerElement = el.querySelector('md-fab-trigger button');
      var iconElement = el.querySelector('md-fab-trigger button md-icon');
      var actions = element.find('md-fab-actions').children();

      // If we have both elements, use them to position the new background
      if (triggerElement && backgroundElement) {
        // Get our variables
        var color = window.getComputedStyle(triggerElement).getPropertyValue('background-color');
        var width = el.offsetWidth;
        var height = el.offsetHeight;

        // Make a square
        var scale = width * 2;

        // Set some basic styles no matter what animation we're doing
        backgroundElement.style.backgroundColor = color;
        backgroundElement.style.borderRadius = width + 'px';

        // If we're open
        if (ctrl.isOpen) {

          // Set the width/height to take up the full toolbar width
          backgroundElement.style.width = scale + 'px';
          backgroundElement.style.height = scale + 'px';

          // Set the top/left to move up/left (or right) by the scale width/height
          backgroundElement.style.top = -(scale / 2) + 'px';

          if (element.hasClass('md-left')) {
            backgroundElement.style.left = -(scale / 2) + 'px';
            backgroundElement.style.right = null;
          }

          if (element.hasClass('md-right')) {
            backgroundElement.style.right = -(scale / 2) + 'px';
            backgroundElement.style.left = null;
          }

          // Set the next close animation to have the proper delays
          backgroundElement.style.transitionDelay = '0ms';
          iconElement.style.transitionDelay = '.3s';

          // Apply a transition delay to actions
          angular.forEach(actions, function(action, index) {
            action.style.transitionDelay = (actions.length - index) * 25 + 'ms';
          });
        } else {
          // Otherwise, set the width/height to the trigger's width/height
          backgroundElement.style.width = triggerElement.offsetWidth + 'px';
          backgroundElement.style.height = triggerElement.offsetHeight + 'px';

          // Reset the position
          backgroundElement.style.top = '0px';

          if (element.hasClass('md-left')) {
            backgroundElement.style.left = '0px';
            backgroundElement.style.right = null;
          }

          if (element.hasClass('md-right')) {
            backgroundElement.style.right = '0px';
            backgroundElement.style.left = null;
          }

          // Set the next open animation to have the proper delays
          backgroundElement.style.transitionDelay = '200ms';
          iconElement.style.transitionDelay = '0ms';

          // Apply a transition delay to actions
          angular.forEach(actions, function(action, index) {
            action.style.transitionDelay = (index * 25) + 'ms';
          });
        }
      }
    }

    return {
      addClass: function(element, className, done) {
        runAnimation(element, className, done);
      },

      removeClass: function(element, className, done) {
        runAnimation(element, className, done);
      }
    }
  }
})();
})();
(function(){
"use strict";

(function() {
  'use strict';

  angular
    .module('material.components.fabTrigger', [ 'material.core' ])
    .directive('mdFabTrigger', MdFabTriggerDirective);

  /**
   * @ngdoc directive
   * @name mdFabTrigger
   * @module material.components.fabSpeedDial
   *
   * @restrict E
   *
   * @description
   * The `<md-fab-trigger>` directive is used inside of a `<md-fab-speed-dial>` or
   * `<md-fab-toolbar>` directive to mark the an element (or elements) as the trigger and setup the
   * proper event listeners.
   *
   * @usage
   * See the `<md-fab-speed-dial>` or `<md-fab-toolbar>` directives for example usage.
   */
  function MdFabTriggerDirective() {
    return {
      restrict: 'E',

      require: ['^?mdFabSpeedDial', '^?mdFabToolbar'],

      link: function(scope, element, attributes, controllers) {
        // Grab whichever parent controller is used
        var controller = controllers[0] || controllers[1];

        // Make the children open/close their parent directive
        if (controller) {
          angular.forEach(element.children(), function(child) {
            angular.element(child).on('focus', controller.open);
            angular.element(child).on('blur', controller.close);
          });
        }
      }
    }
  }
})();


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.gridList
 */
angular.module('material.components.gridList', ['material.core'])
       .directive('mdGridList', GridListDirective)
       .directive('mdGridTile', GridTileDirective)
       .directive('mdGridTileFooter', GridTileCaptionDirective)
       .directive('mdGridTileHeader', GridTileCaptionDirective)
       .factory('$mdGridLayout', GridLayoutFactory);

/**
 * @ngdoc directive
 * @name mdGridList
 * @module material.components.gridList
 * @restrict E
 * @description
 * Grid lists are an alternative to standard list views. Grid lists are distinct
 * from grids used for layouts and other visual presentations.
 *
 * A grid list is best suited to presenting a homogenous data type, typically
 * images, and is optimized for visual comprehension and differentiating between
 * like data types.
 *
 * A grid list is a continuous element consisting of tessellated, regular
 * subdivisions called cells that contain tiles (`md-grid-tile`).
 *
 * <img src="//material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0Bx4BSt6jniD7OVlEaXZ5YmU1Xzg/components_grids_usage2.png"
 *    style="width: 300px; height: auto; margin-right: 16px;" alt="Concept of grid explained visually">
 * <img src="//material-design.storage.googleapis.com/publish/v_2/material_ext_publish/0Bx4BSt6jniD7VGhsOE5idWlJWXM/components_grids_usage3.png"
 *    style="width: 300px; height: auto;" alt="Grid concepts legend">
 *
 * Cells are arrayed vertically and horizontally within the grid.
 *
 * Tiles hold content and can span one or more cells vertically or horizontally.
 *
 * ### Responsive Attributes
 *
 * The `md-grid-list` directive supports "responsive" attributes, which allow
 * different `md-cols`, `md-gutter` and `md-row-height` values depending on the
 * currently matching media query (as defined in `$mdConstant.MEDIA`).
 *
 * In order to set a responsive attribute, first define the fallback value with
 * the standard attribute name, then add additional attributes with the
 * following convention: `{base-attribute-name}-{media-query-name}="{value}"`
 * (ie. `md-cols-lg="8"`)
 *
 * @param {number} md-cols Number of columns in the grid.
 * @param {string} md-row-height One of
 * <ul>
 *   <li>CSS length - Fixed height rows (eg. `8px` or `1rem`)</li>
 *   <li>`{width}:{height}` - Ratio of width to height (eg.
 *   `md-row-height="16:9"`)</li>
 *   <li>`"fit"` - Height will be determined by subdividing the available
 *   height by the number of rows</li>
 * </ul>
 * @param {string=} md-gutter The amount of space between tiles in CSS units
 *     (default 1px)
 * @param {expression=} md-on-layout Expression to evaluate after layout. Event
 *     object is available as `$event`, and contains performance information.
 *
 * @usage
 * Basic:
 * <hljs lang="html">
 * <md-grid-list md-cols="5" md-gutter="1em" md-row-height="4:3">
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Fixed-height rows:
 * <hljs lang="html">
 * <md-grid-list md-cols="4" md-row-height="200px" ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Fit rows:
 * <hljs lang="html">
 * <md-grid-list md-cols="4" md-row-height="fit" style="height: 400px;" ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 *
 * Using responsive attributes:
 * <hljs lang="html">
 * <md-grid-list
 *     md-cols-sm="2"
 *     md-cols-md="4"
 *     md-cols-lg="8"
 *     md-cols-gt-lg="12"
 *     ...>
 *   <md-grid-tile></md-grid-tile>
 * </md-grid-list>
 * </hljs>
 */
function GridListDirective($interpolate, $mdConstant, $mdGridLayout, $mdMedia) {
  return {
    restrict: 'E',
    controller: GridListController,
    scope: {
      mdOnLayout: '&'
    },
    link: postLink
  };

  function postLink(scope, element, attrs, ctrl) {
    // Apply semantics
    element.attr('role', 'list');

    // Provide the controller with a way to trigger layouts.
    ctrl.layoutDelegate = layoutDelegate;

    var invalidateLayout = angular.bind(ctrl, ctrl.invalidateLayout),
        unwatchAttrs = watchMedia();
      scope.$on('$destroy', unwatchMedia);

    /**
     * Watches for changes in media, invalidating layout as necessary.
     */
    function watchMedia() {
      for (var mediaName in $mdConstant.MEDIA) {
        $mdMedia(mediaName); // initialize
        $mdMedia.getQuery($mdConstant.MEDIA[mediaName])
            .addListener(invalidateLayout);
      }
      return $mdMedia.watchResponsiveAttributes(
          ['md-cols', 'md-row-height'], attrs, layoutIfMediaMatch);
    }

    function unwatchMedia() {
      ctrl.layoutDelegate = angular.noop;

      unwatchAttrs();
      for (var mediaName in $mdConstant.MEDIA) {
        $mdMedia.getQuery($mdConstant.MEDIA[mediaName])
            .removeListener(invalidateLayout);
      }
    }

    /**
     * Performs grid layout if the provided mediaName matches the currently
     * active media type.
     */
    function layoutIfMediaMatch(mediaName) {
      if (mediaName == null) {
        // TODO(shyndman): It would be nice to only layout if we have
        // instances of attributes using this media type
        ctrl.invalidateLayout();
      } else if ($mdMedia(mediaName)) {
        ctrl.invalidateLayout();
      }
    }

    var lastLayoutProps;

    /**
     * Invokes the layout engine, and uses its results to lay out our
     * tile elements.
     *
     * @param {boolean} tilesInvalidated Whether tiles have been
     *    added/removed/moved since the last layout. This is to avoid situations
     *    where tiles are replaced with properties identical to their removed
     *    counterparts.
     */
    function layoutDelegate(tilesInvalidated) {
      var tiles = getTileElements();
      var props = {
        tileSpans: getTileSpans(tiles),
        colCount: getColumnCount(),
        rowMode: getRowMode(),
        rowHeight: getRowHeight(),
        gutter: getGutter()
      };

      if (!tilesInvalidated && angular.equals(props, lastLayoutProps)) {
        return;
      }

      var performance =
        $mdGridLayout(props.colCount, props.tileSpans, tiles)
          .map(function(tilePositions, rowCount) {
            return {
              grid: {
                element: element,
                style: getGridStyle(props.colCount, rowCount,
                    props.gutter, props.rowMode, props.rowHeight)
              },
              tiles: tilePositions.map(function(ps, i) {
                return {
                  element: angular.element(tiles[i]),
                  style: getTileStyle(ps.position, ps.spans,
                      props.colCount, props.rowCount,
                      props.gutter, props.rowMode, props.rowHeight)
                }
              })
            }
          })
          .reflow()
          .performance();

      // Report layout
      scope.mdOnLayout({
        $event: {
          performance: performance
        }
      });

      lastLayoutProps = props;
    }

    // Use $interpolate to do some simple string interpolation as a convenience.

    var startSymbol = $interpolate.startSymbol();
    var endSymbol = $interpolate.endSymbol();

    // Returns an expression wrapped in the interpolator's start and end symbols.
    function expr(exprStr) {
      return startSymbol + exprStr + endSymbol;
    }

    // The amount of space a single 1x1 tile would take up (either width or height), used as
    // a basis for other calculations. This consists of taking the base size percent (as would be
    // if evenly dividing the size between cells), and then subtracting the size of one gutter.
    // However, since there are no gutters on the edges, each tile only uses a fration
    // (gutterShare = numGutters / numCells) of the gutter size. (Imagine having one gutter per
    // tile, and then breaking up the extra gutter on the edge evenly among the cells).
    var UNIT = $interpolate(expr('share') + '% - (' + expr('gutter') + ' * ' + expr('gutterShare') + ')');

    // The horizontal or vertical position of a tile, e.g., the 'top' or 'left' property value.
    // The position comes the size of a 1x1 tile plus gutter for each previous tile in the
    // row/column (offset).
    var POSITION  = $interpolate('calc((' + expr('unit') + ' + ' + expr('gutter') + ') * ' + expr('offset') + ')');

    // The actual size of a tile, e.g., width or height, taking rowSpan or colSpan into account.
    // This is computed by multiplying the base unit by the rowSpan/colSpan, and then adding back
    // in the space that the gutter would normally have used (which was already accounted for in
    // the base unit calculation).
    var DIMENSION = $interpolate('calc((' + expr('unit') + ') * ' + expr('span') + ' + (' + expr('span') + ' - 1) * ' + expr('gutter') + ')');

    /**
     * Gets the styles applied to a tile element described by the given parameters.
     * @param {{row: number, col: number}} position The row and column indices of the tile.
     * @param {{row: number, col: number}} spans The rowSpan and colSpan of the tile.
     * @param {number} colCount The number of columns.
     * @param {number} rowCount The number of rows.
     * @param {string} gutter The amount of space between tiles. This will be something like
     *     '5px' or '2em'.
     * @param {string} rowMode The row height mode. Can be one of:
     *     'fixed': all rows have a fixed size, given by rowHeight,
     *     'ratio': row height defined as a ratio to width, or
     *     'fit': fit to the grid-list element height, divinding evenly among rows.
     * @param {string|number} rowHeight The height of a row. This is only used for 'fixed' mode and
     *     for 'ratio' mode. For 'ratio' mode, this is the *ratio* of width-to-height (e.g., 0.75).
     * @returns {Object} Map of CSS properties to be applied to the style element. Will define
     *     values for top, left, width, height, marginTop, and paddingTop.
     */
    function getTileStyle(position, spans, colCount, rowCount, gutter, rowMode, rowHeight) {
      // TODO(shyndman): There are style caching opportunities here.

      // Percent of the available horizontal space that one column takes up.
      var hShare = (1 / colCount) * 100;

      // Fraction of the gutter size that each column takes up.
      var hGutterShare = (colCount - 1) / colCount;

      // Base horizontal size of a column.
      var hUnit = UNIT({share: hShare, gutterShare: hGutterShare, gutter: gutter});

      // The width and horizontal position of each tile is always calculated the same way, but the
      // height and vertical position depends on the rowMode.
      var style = {
        left: POSITION({ unit: hUnit, offset: position.col, gutter: gutter }),
        width: DIMENSION({ unit: hUnit, span: spans.col, gutter: gutter }),
        // resets
        paddingTop: '',
        marginTop: '',
        top: '',
        height: ''
      };

      switch (rowMode) {
        case 'fixed':
          // In fixed mode, simply use the given rowHeight.
          style.top = POSITION({ unit: rowHeight, offset: position.row, gutter: gutter });
          style.height = DIMENSION({ unit: rowHeight, span: spans.row, gutter: gutter });
          break;

        case 'ratio':
          // Percent of the available vertical space that one row takes up. Here, rowHeight holds
          // the ratio value. For example, if the width:height ratio is 4:3, rowHeight = 1.333.
          var vShare = hShare / rowHeight;

          // Base veritcal size of a row.
          var vUnit = UNIT({ share: vShare, gutterShare: hGutterShare, gutter: gutter });

          // padidngTop and marginTop are used to maintain the given aspect ratio, as
          // a percentage-based value for these properties is applied to the *width* of the
          // containing block. See http://www.w3.org/TR/CSS2/box.html#margin-properties
          style.paddingTop = DIMENSION({ unit: vUnit, span: spans.row, gutter: gutter});
          style.marginTop = POSITION({ unit: vUnit, offset: position.row, gutter: gutter });
          break;

        case 'fit':
          // Fraction of the gutter size that each column takes up.
          var vGutterShare = (rowCount - 1) / rowCount;

          // Percent of the available vertical space that one row takes up.
          var vShare = (1 / rowCount) * 100;

          // Base vertical size of a row.
          var vUnit = UNIT({share: vShare, gutterShare: vGutterShare, gutter: gutter});

          style.top = POSITION({unit: vUnit, offset: position.row, gutter: gutter});
          style.height = DIMENSION({unit: vUnit, span: spans.row, gutter: gutter});
          break;
      }

      return style;
    }

    function getGridStyle(colCount, rowCount, gutter, rowMode, rowHeight) {
      var style = {
        height: '',
        paddingBottom: ''
      };

      switch(rowMode) {
        case 'fixed':
          style.height = DIMENSION({ unit: rowHeight, span: rowCount, gutter: gutter });
          break;

        case 'ratio':
          // rowHeight is width / height
          var hGutterShare = colCount === 1 ? 0 : (colCount - 1) / colCount,
              hShare = (1 / colCount) * 100,
              vShare = hShare * (1 / rowHeight),
              vUnit = UNIT({ share: vShare, gutterShare: hGutterShare, gutter: gutter });

          style.paddingBottom = DIMENSION({ unit: vUnit, span: rowCount, gutter: gutter});
          break;

        case 'fit':
          // noop, as the height is user set
          break;
      }

      return style;
    }

    function getTileElements() {
      return [].filter.call(element.children(), function(ele) {
        return ele.tagName == 'MD-GRID-TILE';
      });
    }

    /**
     * Gets an array of objects containing the rowspan and colspan for each tile.
     * @returns {Array<{row: number, col: number}>}
     */
    function getTileSpans(tileElements) {
      return [].map.call(tileElements, function(ele) {
        var ctrl = angular.element(ele).controller('mdGridTile');
        return {
          row: parseInt(
              $mdMedia.getResponsiveAttribute(ctrl.$attrs, 'md-rowspan'), 10) || 1,
          col: parseInt(
              $mdMedia.getResponsiveAttribute(ctrl.$attrs, 'md-colspan'), 10) || 1
        };
      });
    }

    function getColumnCount() {
      var colCount = parseInt($mdMedia.getResponsiveAttribute(attrs, 'md-cols'), 10);
      if (isNaN(colCount)) {
        throw 'md-grid-list: md-cols attribute was not found, or contained a non-numeric value';
      }
      return colCount;
    }

    function getGutter() {
      return applyDefaultUnit($mdMedia.getResponsiveAttribute(attrs, 'md-gutter') || 1);
    }

    function getRowHeight() {
      var rowHeight = $mdMedia.getResponsiveAttribute(attrs, 'md-row-height');
      switch (getRowMode()) {
        case 'fixed':
          return applyDefaultUnit(rowHeight);
        case 'ratio':
          var whRatio = rowHeight.split(':');
          return parseFloat(whRatio[0]) / parseFloat(whRatio[1]);
        case 'fit':
          return 0; // N/A
      }
    }

    function getRowMode() {
      var rowHeight = $mdMedia.getResponsiveAttribute(attrs, 'md-row-height');
      if (rowHeight == 'fit') {
        return 'fit';
      } else if (rowHeight.indexOf(':') !== -1) {
        return 'ratio';
      } else {
        return 'fixed';
      }
    }

    function applyDefaultUnit(val) {
      return /\D$/.test(val) ? val : val + 'px';
    }
  }
}
GridListDirective.$inject = ["$interpolate", "$mdConstant", "$mdGridLayout", "$mdMedia"];

/* @ngInject */
function GridListController($timeout) {
  this.layoutInvalidated = false;
  this.tilesInvalidated = false;
  this.$timeout_ = $timeout;
  this.layoutDelegate = angular.noop;
}
GridListController.$inject = ["$timeout"];

GridListController.prototype = {
  invalidateTiles: function() {
    this.tilesInvalidated = true;
    this.invalidateLayout();
  },

  invalidateLayout: function() {
    if (this.layoutInvalidated) {
      return;
    }
    this.layoutInvalidated = true;
    this.$timeout_(angular.bind(this, this.layout));
  },

  layout: function() {
    try {
      this.layoutDelegate(this.tilesInvalidated);
    } finally {
      this.layoutInvalidated = false;
      this.tilesInvalidated = false;
    }
  }
};


/* @ngInject */
function GridLayoutFactory($mdUtil) {
  var defaultAnimator = GridTileAnimator;

  /**
   * Set the reflow animator callback
   */
  GridLayout.animateWith = function(customAnimator) {
    defaultAnimator = !angular.isFunction(customAnimator) ? GridTileAnimator : customAnimator;
  };

  return GridLayout;

  /**
   * Publish layout function
   */
  function GridLayout(colCount, tileSpans) {
      var self, layoutInfo, gridStyles, layoutTime, mapTime, reflowTime;

      layoutTime = $mdUtil.time(function() {
        layoutInfo = calculateGridFor(colCount, tileSpans);
      });

      return self = {

        /**
         * An array of objects describing each tile's position in the grid.
         */
        layoutInfo: function() {
          return layoutInfo;
        },

        /**
         * Maps grid positioning to an element and a set of styles using the
         * provided updateFn.
         */
        map: function(updateFn) {
          mapTime = $mdUtil.time(function() {
            var info = self.layoutInfo();
            gridStyles = updateFn(info.positioning, info.rowCount);
          });
          return self;
        },

        /**
         * Default animator simply sets the element.css( <styles> ). An alternate
         * animator can be provided as an argument. The function has the following
         * signature:
         *
         *    function({grid: {element: JQLite, style: Object}, tiles: Array<{element: JQLite, style: Object}>)
         */
        reflow: function(animatorFn) {
          reflowTime = $mdUtil.time(function() {
            var animator = animatorFn || defaultAnimator;
            animator(gridStyles.grid, gridStyles.tiles);
          });
          return self;
        },

        /**
         * Timing for the most recent layout run.
         */
        performance: function() {
          return {
            tileCount: tileSpans.length,
            layoutTime: layoutTime,
            mapTime: mapTime,
            reflowTime: reflowTime,
            totalTime: layoutTime + mapTime + reflowTime
          };
        }
      };
    }

  /**
   * Default Gridlist animator simple sets the css for each element;
   * NOTE: any transitions effects must be manually set in the CSS.
   * e.g.
   *
   *  md-grid-tile {
   *    transition: all 700ms ease-out 50ms;
   *  }
   *
   */
  function GridTileAnimator(grid, tiles) {
    grid.element.css(grid.style);
    tiles.forEach(function(t) {
      t.element.css(t.style);
    })
  }

  /**
   * Calculates the positions of tiles.
   *
   * The algorithm works as follows:
   *    An Array<Number> with length colCount (spaceTracker) keeps track of
   *    available tiling positions, where elements of value 0 represents an
   *    empty position. Space for a tile is reserved by finding a sequence of
   *    0s with length <= than the tile's colspan. When such a space has been
   *    found, the occupied tile positions are incremented by the tile's
   *    rowspan value, as these positions have become unavailable for that
   *    many rows.
   *
   *    If the end of a row has been reached without finding space for the
   *    tile, spaceTracker's elements are each decremented by 1 to a minimum
   *    of 0. Rows are searched in this fashion until space is found.
   */
  function calculateGridFor(colCount, tileSpans) {
    var curCol = 0,
        curRow = 0,
        spaceTracker = newSpaceTracker();

    return {
      positioning: tileSpans.map(function(spans, i) {
        return {
          spans: spans,
          position: reserveSpace(spans, i)
        };
      }),
      rowCount: curRow + Math.max.apply(Math, spaceTracker)
    };

    function reserveSpace(spans, i) {
      if (spans.col > colCount) {
        throw 'md-grid-list: Tile at position ' + i + ' has a colspan ' +
            '(' + spans.col + ') that exceeds the column count ' +
            '(' + colCount + ')';
      }

      var start = 0,
          end = 0;

      // TODO(shyndman): This loop isn't strictly necessary if you can
      // determine the minimum number of rows before a space opens up. To do
      // this, recognize that you've iterated across an entire row looking for
      // space, and if so fast-forward by the minimum rowSpan count. Repeat
      // until the required space opens up.
      while (end - start < spans.col) {
        if (curCol >= colCount) {
          nextRow();
          continue;
        }

        start = spaceTracker.indexOf(0, curCol);
        if (start === -1 || (end = findEnd(start + 1)) === -1) {
          start = end = 0;
          nextRow();
          continue;
        }

        curCol = end + 1;
      }

      adjustRow(start, spans.col, spans.row);
      curCol = start + spans.col;

      return {
        col: start,
        row: curRow
      };
    }

    function nextRow() {
      curCol = 0;
      curRow++;
      adjustRow(0, colCount, -1); // Decrement row spans by one
    }

    function adjustRow(from, cols, by) {
      for (var i = from; i < from + cols; i++) {
        spaceTracker[i] = Math.max(spaceTracker[i] + by, 0);
      }
    }

    function findEnd(start) {
      var i;
      for (i = start; i < spaceTracker.length; i++) {
        if (spaceTracker[i] !== 0) {
          return i;
        }
      }

      if (i === spaceTracker.length) {
        return i;
      }
    }

    function newSpaceTracker() {
      var tracker = [];
      for (var i = 0; i < colCount; i++) {
        tracker.push(0);
      }
      return tracker;
    }
  }
}
GridLayoutFactory.$inject = ["$mdUtil"];

/**
 * @ngdoc directive
 * @name mdGridTile
 * @module material.components.gridList
 * @restrict E
 * @description
 * Tiles contain the content of an `md-grid-list`. They span one or more grid
 * cells vertically or horizontally, and use `md-grid-tile-{footer,header}` to
 * display secondary content.
 *
 * ### Responsive Attributes
 *
 * The `md-grid-tile` directive supports "responsive" attributes, which allow
 * different `md-rowspan` and `md-colspan` values depending on the currently
 * matching media query (as defined in `$mdConstant.MEDIA`).
 *
 * In order to set a responsive attribute, first define the fallback value with
 * the standard attribute name, then add additional attributes with the
 * following convention: `{base-attribute-name}-{media-query-name}="{value}"`
 * (ie. `md-colspan-sm="4"`)
 *
 * @param {number=} md-colspan The number of columns to span (default 1). Cannot
 *    exceed the number of columns in the grid. Supports interpolation.
 * @param {number=} md-rowspan The number of rows to span (default 1). Supports
 *     interpolation.
 *
 * @usage
 * With header:
 * <hljs lang="html">
 * <md-grid-tile>
 *   <md-grid-tile-header>
 *     <h3>This is a header</h3>
 *   </md-grid-tile-header>
 * </md-grid-tile>
 * </hljs>
 *
 * With footer:
 * <hljs lang="html">
 * <md-grid-tile>
 *   <md-grid-tile-footer>
 *     <h3>This is a footer</h3>
 *   </md-grid-tile-footer>
 * </md-grid-tile>
 * </hljs>
 *
 * Spanning multiple rows/columns:
 * <hljs lang="html">
 * <md-grid-tile md-colspan="2" md-rowspan="3">
 * </md-grid-tile>
 * </hljs>
 *
 * Responsive attributes:
 * <hljs lang="html">
 * <md-grid-tile md-colspan="1" md-colspan-sm="3" md-colspan-md="5">
 * </md-grid-tile>
 * </hljs>
 */
function GridTileDirective($mdMedia) {
  return {
    restrict: 'E',
    require: '^mdGridList',
    template: '<figure ng-transclude></figure>',
    transclude: true,
    scope: {},
    // Simple controller that exposes attributes to the grid directive
    controller: ["$attrs", function($attrs) {
      this.$attrs = $attrs;
    }],
    link: postLink
  };

  function postLink(scope, element, attrs, gridCtrl) {
    // Apply semantics
    element.attr('role', 'listitem');

    // If our colspan or rowspan changes, trigger a layout
    var unwatchAttrs = $mdMedia.watchResponsiveAttributes(['md-colspan', 'md-rowspan'],
        attrs, angular.bind(gridCtrl, gridCtrl.invalidateLayout));

    // Tile registration/deregistration
    gridCtrl.invalidateTiles();
    scope.$on('$destroy', function() {
      unwatchAttrs();
      gridCtrl.invalidateLayout();
    });

    if (angular.isDefined(scope.$parent.$index)) {
      scope.$watch(function() { return scope.$parent.$index; },
        function indexChanged(newIdx, oldIdx) {
          if (newIdx === oldIdx) {
            return;
          }
          gridCtrl.invalidateTiles();
        });
    }
  }
}
GridTileDirective.$inject = ["$mdMedia"];


function GridTileCaptionDirective() {
  return {
    template: '<figcaption ng-transclude></figcaption>',
    transclude: true
  };
}

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.icon
 * @description
 * Icon
 */
angular.module('material.components.icon', [
    'material.core'
  ])
  .directive('mdIcon', mdIconDirective);

/**
 * @ngdoc directive
 * @name mdIcon
 * @module material.components.icon
 *
 * @restrict E
 *
 * @description
 * The `<md-icon>` directive is an markup element useful for showing an icon based on a font-icon
 * or a SVG. Icons are view-only elements that should not be used directly as buttons; instead nest a `<md-icon>`
 * inside a `md-button` to add hover and click features.
 *
 * When using SVGs, both external SVGs (via URLs) or sets of SVGs [from icon sets] can be
 * easily loaded and used.When use font-icons, developers must following three (3) simple steps:
 *
 * <ol>
 * <li>Load the font library. e.g.<br/>
 *    &lt;link href="https://fonts.googleapis.com/icon?family=Material+Icons"
 *    rel="stylesheet"&gt;
 * </li>
 * <li> Use either (a) font-icon class names or (b) font ligatures to render the font glyph by using its textual name</li>
 * <li> Use &lt;md-icon md-font-icon="classname" /&gt; or <br/>
 *     use &lt;md-icon md-font-set="font library classname or alias"&gt; textual_name &lt;/md-icon&gt; or <br/>
 *     use &lt;md-icon md-font-set="font library classname or alias"&gt; numerical_character_reference &lt;/md-icon&gt;
 * </li>
 * </ol>
 *
 * Full details for these steps can be found:
 *
 * <ul>
 * <li>http://google.github.io/material-design-icons/</li>
 * <li>http://google.github.io/material-design-icons/#icon-font-for-the-web</li>
 * </ul>
 *
 * The Material Design icon style <code>.material-icons</code> and the icon font references are published in
 * Material Design Icons:
 *
 * <ul>
 * <li>http://www.google.com/design/icons/</li>
 * <li>https://www.google.com/design/icons/#ic_accessibility</li>
 * </ul>
 *
 * <h2 id="material_design_icons">Material Design Icons</h2>
 * Using the Material Design Icon-Selector, developers can easily and quickly search for a Material Design font-icon and
 * determine its textual name and character reference code. Click on any icon to see the slide-up information
 * panel with details regarding a SVG download or information on the font-icon usage.
 *
 * <a href="https://www.google.com/design/icons/#ic_accessibility" target="_blank" style="border-bottom:none;">
 * <img src="https://cloud.githubusercontent.com/assets/210413/7902490/fe8dd14c-0780-11e5-98fb-c821cc6475e6.png"
 *      aria-label="Material Design Icon-Selector" style="max-width:75%;padding-left:10%">
 * </a>
 *
 * <span class="image_caption">
 *  Click on the image above to link to the
 *  <a href="https://www.google.com/design/icons/#ic_accessibility" target="_blank">Material Design Icon-Selector</a>.
 * </span>
 *
 * @param {string} md-font-icon Name of CSS icon associated with the font-face will be used
 * to render the icon. Requires the fonts and the named CSS styles to be preloaded.
 * @param {string} md-font-set CSS style name associated with the font library; which will be assigned as
 * the class for the font-icon ligature. This value may also be an alias that is used to lookup the classname;
 * internally use `$mdIconProvider.fontSet(<alias>)` to determine the style name.
 * @param {string} md-svg-src URL [or expression ] used to load, cache, and display an external SVG.
 * @param {string} md-svg-icon Name used for lookup of the icon from the internal cache; interpolated strings or
 * expressions may also be used. Specific set names can be used with the syntax `<set name>:<icon name>`.<br/><br/>
 * To use icon sets, developers are required to pre-register the sets using the `$mdIconProvider` service.
 * @param {string=} aria-label Labels icon for accessibility. If an empty string is provided, icon
 * will be hidden from accessibility layer with `aria-hidden="true"`. If there's no aria-label on the icon
 * nor a label on the parent element, a warning will be logged to the console.
 *
 * @usage
 * When using SVGs:
 * <hljs lang="html">
 *
 *  <!-- Icon ID; may contain optional icon set prefix; icons must registered using $mdIconProvider -->
 *  <md-icon md-svg-icon="social:android"    aria-label="android " ></md-icon>
 *
 *  <!-- Icon urls; may be preloaded in templateCache -->
 *  <md-icon md-svg-src="/android.svg"       aria-label="android " ></md-icon>
 *  <md-icon md-svg-src="{{ getAndroid() }}" aria-label="android " ></md-icon>
 *
 * </hljs>
 *
 * Use the <code>$mdIconProvider</code> to configure your application with
 * svg iconsets.
 *
 * <hljs lang="js">
 *  angular.module('appSvgIconSets', ['ngMaterial'])
 *    .controller('DemoCtrl', function($scope) {})
 *    .config(function($mdIconProvider) {
 *      $mdIconProvider
 *         .iconSet('social', 'img/icons/sets/social-icons.svg', 24)
 *         .defaultIconSet('img/icons/sets/core-icons.svg', 24);
 *     });
 * </hljs>
 *
 *
 * When using Font Icons with classnames:
 * <hljs lang="html">
 *
 *  <md-icon md-font-icon="android" aria-label="android" ></md-icon>
 *  <md-icon class="icon_home"      aria-label="Home"    ></md-icon>
 *
 * </hljs>
 *
 * When using Material Font Icons with ligatures:
 * <hljs lang="html">
 *  <!-- For Material Design Icons -->
 *  <!-- The class '.material-icons' is auto-added if a style has NOT been specified -->
 *  <md-icon> face </md-icon>
 *  <md-icon md-font-set="material-icons"> face </md-icon>
 *  <md-icon> #xE87C; </md-icon>
 *  <!-- The class '.material-icons' must be manually added if other styles are also specified-->
 *  <md-icon class="material-icons md-light md-48"> face </md-icon>
 * </hljs>
 *
 * When using other Font-Icon libraries:
 *
 * <hljs lang="js">
 *  // Specify a font-icon style alias
 *  angular.config(function($mdIconProvider) {
 *    $mdIconProvider.fontSet('fa', 'fontawesome');
 *  });
 * </hljs>
 *
 * <hljs lang="html">
 *  <md-icon md-font-set="fa">email</md-icon>
 * </hljs>
 *
 */
function mdIconDirective($mdIcon, $mdTheming, $mdAria, $interpolate ) {

  return {
    scope: {
      fontSet : '@mdFontSet',
      fontIcon: '@mdFontIcon',
      svgIcon : '@mdSvgIcon',
      svgSrc  : '@mdSvgSrc'
    },
    restrict: 'E',
    link : postLink
  };


  /**
   * Directive postLink
   * Supports embedded SVGs, font-icons, & external SVGs
   */
  function postLink(scope, element, attr) {
    $mdTheming(element);

    prepareForFontIcon();

    // If using a font-icon, then the textual name of the icon itself
    // provides the aria-label.

    var label = attr.alt || scope.fontIcon || scope.svgIcon || element.text();
    var attrName = attr.$normalize(attr.$attr.mdSvgIcon || attr.$attr.mdSvgSrc || '');

    if ( !attr['aria-label'] ) {

      if (label != '' && !parentsHaveText() ) {

        $mdAria.expect(element, 'aria-label', label);
        $mdAria.expect(element, 'role', 'img');

      } else if ( !element.text() ) {
        // If not a font-icon with ligature, then
        // hide from the accessibility layer.

        $mdAria.expect(element, 'aria-hidden', 'true');
      }
    }

    if (attrName) {
      // Use either pre-configured SVG or URL source, respectively.
      attr.$observe(attrName, function(attrVal) {

        element.empty();
        if (attrVal) {
          $mdIcon(attrVal).then(function(svg) {
            element.append(svg);
          });
        }

      });
    }

    function parentsHaveText() {
      var parent = element.parent();
      if (parent.attr('aria-label') || parent.text()) {
        return true;
      }
      else if(parent.parent().attr('aria-label') || parent.parent().text()) {
        return true;
      }
      return false;
    }

    function prepareForFontIcon () {
      if (!scope.svgIcon && !scope.svgSrc) {

        if (scope.fontIcon) {
          element.addClass('md-font');
          element.addClass(scope.fontIcon);
        }

        if (scope.fontSet) {
          element.addClass($mdIcon.fontSet(scope.fontSet));
        }

        // For Material Design font icons, the class '.material-icons'
        // is auto-added IF a style has not been specified

        if (!scope.fontIcon && !scope.fontSet && !angular.isDefined(attr.class)) {

            element.addClass('material-icons');
        }
      }

    }
  }
}
mdIconDirective.$inject = ["$mdIcon", "$mdTheming", "$mdAria", "$interpolate"];

})();
(function(){
"use strict";

  angular
    .module('material.components.icon' )
    .provider('$mdIcon', MdIconProvider);

  /**
    * @ngdoc service
    * @name $mdIconProvider
    * @module material.components.icon
    *
    * @description
    * `$mdIconProvider` is used only to register icon IDs with URLs. These configuration features allow
    * icons and icon sets to be pre-registered and associated with source URLs **before** the `<md-icon />`
    * directives are compiled.
    *
    * If using font-icons, the developer is repsonsible for loading the fonts.
    *
    * If using SVGs, loading of the actual svg files are deferred to on-demand requests and are loaded
    * internally by the `$mdIcon` service using the `$http` service. When an SVG is requested by name/ID,
    * the `$mdIcon` service searches its registry for the associated source URL;
    * that URL is used to on-demand load and parse the SVG dynamically.
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultFontSet( 'fontawesome' )
    *          .defaultIconSet('my/app/icons.svg')       // Register a default set of SVG icons
    *          .iconSet('social', 'my/app/social.svg')   // Register a named icon set of SVGs
    *          .icon('android', 'my/app/android.svg')    // Register a specific icon (by name)
    *          .icon('work:chair', 'my/app/chair.svg');  // Register icon in a specific set
    *   });
    * </hljs>
    *
    * SVG icons and icon sets can be easily pre-loaded and cached using either (a) a build process or (b) a runtime
    * **startup** process (shown below):
    *
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Register a default set of SVG icon definitions
    *     $mdIconProvider.defaultIconSet('my/app/icons.svg')
    *
    *   })
    *   .run(function($http, $templateCache){
    *
    *     // Pre-fetch icons sources by URL and cache in the $templateCache...
    *     // subsequent $http calls will look there first.
    *
    *     var urls = [ 'imy/app/icons.svg', 'img/icons/android.svg'];
    *
    *     angular.forEach(urls, function(url) {
    *       $http.get(url, {cache: $templateCache});
    *     });
    *
    *   });
    *
    * </hljs>
    *
    * NOTE: the loaded SVG data is subsequently cached internally for future requests.
    *
    */

   /**
    * @ngdoc method
    * @name $mdIconProvider#icon
    *
    * @description
    * Register a source URL for a specific icon name; the name may include optional 'icon set' name prefix.
    * These icons  will later be retrieved from the cache using `$mdIcon( <icon name> )`
    *
    * @param {string} id Icon name/id used to register the icon
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height the icon's viewBox.
    * It is ignored for icons with an existing viewBox. Default size is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .icon('android', 'my/app/android.svg')    // Register a specific icon (by name)
    *          .icon('work:chair', 'my/app/chair.svg');  // Register icon in a specific set
    *   });
    * </hljs>
    *
    */
   /**
    * @ngdoc method
    * @name $mdIconProvider#iconSet
    *
    * @description
    * Register a source URL for a 'named' set of icons; group of SVG definitions where each definition
    * has an icon id. Individual icons can be subsequently retrieved from this cached set using
    * `$mdIcon(<icon set name>:<icon name>)`
    *
    * @param {string} id Icon name/id used to register the iconset
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height of the viewBox of all icons in the set. 
    * It is ignored for icons with an existing viewBox. All icons in the icon set should be the same size.
    * Default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .iconSet('social', 'my/app/social.svg')   // Register a named icon set
    *   });
    * </hljs>
    *
    */
   /**
    * @ngdoc method
    * @name $mdIconProvider#defaultIconSet
    *
    * @description
    * Register a source URL for the default 'named' set of icons. Unless explicitly registered,
    * subsequent lookups of icons will failover to search this 'default' icon set.
    * Icon can be retrieved from this cached, default set using `$mdIcon(<name>)`
    *
    * @param {string} url specifies the external location for the data file. Used internally by `$http` to load the
    * data or as part of the lookup in `$templateCache` if pre-loading was configured.
    * @param {number=} viewBoxSize Sets the width and height of the viewBox of all icons in the set. 
    * It is ignored for icons with an existing viewBox. All icons in the icon set should be the same size.
    * Default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultIconSet( 'my/app/social.svg' )   // Register a default icon set
    *   });
    * </hljs>
    *
    */
  /**
   * @ngdoc method
   * @name $mdIconProvider#defaultFontSet
   *
   * @description
   * When using Font-Icons, Angular Material assumes the the Material Design icons will be used and automatically
   * configures the default font-set == 'material-icons'. Note that the font-set references the font-icon library
   * class style that should be applied to the `<md-icon>`.
   *
   * Configuring the default means that the attributes
   * `md-font-set="material-icons"` or `class="material-icons"` do not need to be explicitly declared on the
   * `<md-icon>` markup. For example:
   *
   *  `<md-icon> face </md-icon>`
   *  will render as
   *  `<span class="material-icons"> face </span>`, and
   *
   *  `<md-icon md-font-set="fa"> face </md-icon>`
   *  will render as
   *  `<span class="fa"> face </span>`
   *
   * @param {string} name of the font-library style that should be applied to the md-icon DOM element
   *
   * @usage
   * <hljs lang="js">
   *   app.config(function($mdIconProvider) {
   *     $mdIconProvider.defaultFontSet( 'fontawesome' );
   *   });
   * </hljs>
   *
   */

   /**
    * @ngdoc method
    * @name $mdIconProvider#defaultViewBoxSize
    *
    * @description
    * While `<md-icon />` markup can also be style with sizing CSS, this method configures
    * the default width **and** height used for all icons; unless overridden by specific CSS.
    * The default sizing is (24px, 24px).
    * @param {number=} viewBoxSize Sets the width and height of the viewBox for an icon or an icon set.
    * All icons in a set should be the same size. The default value is 24.
    *
    * @returns {obj} an `$mdIconProvider` reference; used to support method call chains for the API
    *
    * @usage
    * <hljs lang="js">
    *   app.config(function($mdIconProvider) {
    *
    *     // Configure URLs for icons specified by [set:]id.
    *
    *     $mdIconProvider
    *          .defaultViewBoxSize(36)   // Register a default icon size (width == height)
    *   });
    * </hljs>
    *
    */

 var config = {
   defaultViewBoxSize: 24,
   defaultFontSet: 'material-icons',
   fontSets : [ ]
 };

 function MdIconProvider() { }

 MdIconProvider.prototype = {
   icon : function (id, url, viewBoxSize) {
     if ( id.indexOf(':') == -1 ) id = '$default:' + id;

     config[id] = new ConfigurationItem(url, viewBoxSize );
     return this;
   },

   iconSet : function (id, url, viewBoxSize) {
     config[id] = new ConfigurationItem(url, viewBoxSize );
     return this;
   },

   defaultIconSet : function (url, viewBoxSize) {
     var setName = '$default';

     if ( !config[setName] ) {
       config[setName] = new ConfigurationItem(url, viewBoxSize );
     }

     config[setName].viewBoxSize = viewBoxSize || config.defaultViewBoxSize;

     return this;
   },

   defaultViewBoxSize : function (viewBoxSize) {
     config.defaultViewBoxSize = viewBoxSize;
     return this;
   },
   
   /**
    * Register an alias name associated with a font-icon library style ;
    */
   fontSet : function fontSet(alias, className) {
    config.fontSets.push({
      alias : alias,
      fontSet : className || alias
    });
   },

   /**
    * Specify a default style name associated with a font-icon library
    * fallback to Material Icons.
    *
    */
   defaultFontSet : function defaultFontSet(className) {
    config.defaultFontSet = !className ? '' : className;
    return this;
   },

   defaultIconSize : function defaultIconSize(iconSize) {
     config.defaultIconSize = iconSize;
     return this;
   },

   preloadIcons: function ($templateCache) {
     var iconProvider = this;
     var svgRegistry = [
       {
         id : 'md-tabs-arrow',
         url: 'md-tabs-arrow.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><polygon points="15.4,7.4 14,6 8,12 14,18 15.4,16.6 10.8,12 "/></g></svg>'
       },
       {
         id : 'md-close',
         url: 'md-close.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><path d="M19 6.41l-1.41-1.41-5.59 5.59-5.59-5.59-1.41 1.41 5.59 5.59-5.59 5.59 1.41 1.41 5.59-5.59 5.59 5.59 1.41-1.41-5.59-5.59z"/></g></svg>'
       },
       {
         id:  'md-cancel',
         url: 'md-cancel.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 24 24"><g><path d="M12 2c-5.53 0-10 4.47-10 10s4.47 10 10 10 10-4.47 10-10-4.47-10-10-10zm5 13.59l-1.41 1.41-3.59-3.59-3.59 3.59-1.41-1.41 3.59-3.59-3.59-3.59 1.41-1.41 3.59 3.59 3.59-3.59 1.41 1.41-3.59 3.59 3.59 3.59z"/></g></svg>'
       },
       {
         id:  'md-menu',
         url: 'md-menu.svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 100 100"><path d="M 50 0 L 100 14 L 92 80 L 50 100 L 8 80 L 0 14 Z" fill="#b2b2b2"></path><path d="M 50 5 L 6 18 L 13.5 77 L 50 94 Z" fill="#E42939"></path><path d="M 50 5 L 94 18 L 86.5 77 L 50 94 Z" fill="#B72833"></path><path d="M 50 7 L 83 75 L 72 75 L 65 59 L 50 59 L 50 50 L 61 50 L 50 26 Z" fill="#b2b2b2"></path><path d="M 50 7 L 17 75 L 28 75 L 35 59 L 50 59 L 50 50 L 39 50 L 50 26 Z" fill="#fff"></path></svg>'
       },
       {
         id:  'md-toggle-arrow',
         url: 'md-toggle-arrow-svg',
         svg: '<svg version="1.1" x="0px" y="0px" viewBox="0 0 48 48"><path d="M24 16l-12 12 2.83 2.83 9.17-9.17 9.17 9.17 2.83-2.83z"/><path d="M0 0h48v48h-48z" fill="none"/></svg>'
       }
     ];

     svgRegistry.forEach(function(asset){
       iconProvider.icon(asset.id,  asset.url);
       $templateCache.put(asset.url, asset.svg);
     });

   },

   $get : ['$http', '$q', '$log', '$templateCache', function($http, $q, $log, $templateCache) {
     this.preloadIcons($templateCache);
     return MdIconService(config, $http, $q, $log, $templateCache);
   }]
 };

   /**
    *  Configuration item stored in the Icon registry; used for lookups
    *  to load if not already cached in the `loaded` cache
    */
   function ConfigurationItem(url, viewBoxSize) {
     this.url = url;
     this.viewBoxSize = viewBoxSize || config.defaultViewBoxSize;
   }

 /**
  * @ngdoc service
  * @name $mdIcon
  * @module material.components.icon
  *
  * @description
  * The `$mdIcon` service is a function used to lookup SVG icons.
  *
  * @param {string} id Query value for a unique Id or URL. If the argument is a URL, then the service will retrieve the icon element
  * from its internal cache or load the icon and cache it first. If the value is not a URL-type string, then an ID lookup is
  * performed. The Id may be a unique icon ID or may include an iconSet ID prefix.
  *
  * For the **id** query to work properly, this means that all id-to-URL mappings must have been previously configured
  * using the `$mdIconProvider`.
  *
  * @returns {obj} Clone of the initial SVG DOM element; which was created from the SVG markup in the SVG data file.
  *
  * @usage
  * <hljs lang="js">
  * function SomeDirective($mdIcon) {
  *
  *   // See if the icon has already been loaded, if not
  *   // then lookup the icon from the registry cache, load and cache
  *   // it for future requests.
  *   // NOTE: ID queries require configuration with $mdIconProvider
  *
  *   $mdIcon('android').then(function(iconEl)    { element.append(iconEl); });
  *   $mdIcon('work:chair').then(function(iconEl) { element.append(iconEl); });
  *
  *   // Load and cache the external SVG using a URL
  *
  *   $mdIcon('img/icons/android.svg').then(function(iconEl) {
  *     element.append(iconEl);
  *   });
  * };
  * </hljs>
  *
  * NOTE: The `<md-icon />  ` directive internally uses the `$mdIcon` service to query, loaded, and instantiate
  * SVG DOM elements.
  */
 function MdIconService(config, $http, $q, $log, $templateCache) {
   var iconCache = {};
   var urlRegex = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/i;

   Icon.prototype = { clone : cloneSVG, prepare: prepareAndStyle };
   getIcon.fontSet = findRegisteredFontSet;

   // Publish service...
   return getIcon;

   /**
    * Actual $mdIcon service is essentially a lookup function
    */
   function getIcon(id) {
     id = id || '';

     // If already loaded and cached, use a clone of the cached icon.
     // Otherwise either load by URL, or lookup in the registry and then load by URL, and cache.

     if ( iconCache[id]         ) return $q.when( iconCache[id].clone() );
     if ( urlRegex.test(id)     ) return loadByURL(id).then( cacheIcon(id) );
     if ( id.indexOf(':') == -1 ) id = '$default:' + id;

     return loadByID(id)
         .catch(loadFromIconSet)
         .catch(announceIdNotFound)
         .catch(announceNotFound)
         .then( cacheIcon(id) );
   }

   /**
    * Lookup registered fontSet style using its alias...
    * If not found,
    */
   function findRegisteredFontSet(alias) {
      var useDefault = angular.isUndefined(alias) || !(alias && alias.length);
      if ( useDefault ) return config.defaultFontSet;

      var result = alias;
      angular.forEach(config.fontSets, function(it){
        if ( it.alias == alias ) result = it.fontSet || result;
      });

      return result;
   }

   /**
    * Prepare and cache the loaded icon for the specified `id`
    */
   function cacheIcon( id ) {

     return function updateCache( icon ) {
       iconCache[id] = isIcon(icon) ? icon : new Icon(icon, config[id]);

       return iconCache[id].clone();
     };
   }

   /**
    * Lookup the configuration in the registry, if !registered throw an error
    * otherwise load the icon [on-demand] using the registered URL.
    *
    */
   function loadByID(id) {
     var iconConfig = config[id];

     return !iconConfig ? $q.reject(id) : loadByURL(iconConfig.url).then(function(icon) {
       return new Icon(icon, iconConfig);
     });
   }

   /**
    *    Loads the file as XML and uses querySelector( <id> ) to find
    *    the desired node...
    */
   function loadFromIconSet(id) {
     var setName = id.substring(0, id.lastIndexOf(':')) || '$default';
     var iconSetConfig = config[setName];

     return !iconSetConfig ? $q.reject(id) : loadByURL(iconSetConfig.url).then(extractFromSet);

     function extractFromSet(set) {
       var iconName = id.slice(id.lastIndexOf(':') + 1);
       var icon = set.querySelector('#' + iconName);
       return !icon ? $q.reject(id) : new Icon(icon, iconSetConfig);
     }
   }

   /**
    * Load the icon by URL (may use the $templateCache).
    * Extract the data for later conversion to Icon
    */
   function loadByURL(url) {
     return $http
       .get(url, { cache: $templateCache })
       .then(function(response) {
         return angular.element('<div>').append(response.data).find('svg')[0];
       });
   }

   /**
    * User did not specify a URL and the ID has not been registered with the $mdIcon
    * registry
    */
   function announceIdNotFound(id) {
     var msg;

     if (angular.isString(id)) {
       msg = 'icon ' + id + ' not found';
       $log.warn(msg);
     }

     return $q.reject(msg || id);
   }

   /**
    * Catch HTTP or generic errors not related to incorrect icon IDs.
    */
   function announceNotFound(err) {
     var msg = angular.isString(err) ? err : (err.message || err.data || err.statusText);
     $log.warn(msg);

     return $q.reject(msg);
   }

   /**
    * Check target signature to see if it is an Icon instance.
    */
   function isIcon(target) {
     return angular.isDefined(target.element) && angular.isDefined(target.config);
   }

   /**
    *  Define the Icon class
    */
   function Icon(el, config) {
     if (el.tagName != 'svg') {
       el = angular.element('<svg xmlns="http://www.w3.org/2000/svg">').append(el)[0];
     }

     // Inject the namespace if not available...
     if ( !el.getAttribute('xmlns') ) {
       el.setAttribute('xmlns', "http://www.w3.org/2000/svg");
     }

     this.element = el;
     this.config = config;
     this.prepare();
   }

   /**
    *  Prepare the DOM element that will be cached in the
    *  loaded iconCache store.
    */
   function prepareAndStyle() {
     var viewBoxSize = this.config ? this.config.viewBoxSize : config.defaultViewBoxSize;
         angular.forEach({
           'fit'   : '',
           'height': '100%',
           'width' : '100%',
           'preserveAspectRatio': 'xMidYMid meet',
           'viewBox' : this.element.getAttribute('viewBox') || ('0 0 ' + viewBoxSize + ' ' + viewBoxSize)
         }, function(val, attr) {
           this.element.setAttribute(attr, val);
         }, this);

         angular.forEach({
           'pointer-events' : 'none',
           'display' : 'block'
         }, function(val, style) {
           this.element.style[style] = val;
         }, this);
   }

   /**
    * Clone the Icon DOM element.
    */
   function cloneSVG(){
     return this.element.cloneNode(true);
   }

 }

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.input
 */

angular.module('material.components.input', [
  'material.core'
])
  .directive('mdInputContainer', mdInputContainerDirective)
  .directive('label', labelDirective)
  .directive('input', inputTextareaDirective)
  .directive('textarea', inputTextareaDirective)
  .directive('mdMaxlength', mdMaxlengthDirective)
  .directive('placeholder', placeholderDirective);

/**
 * @ngdoc directive
 * @name mdInputContainer
 * @module material.components.input
 *
 * @restrict E
 *
 * @description
 * `<md-input-container>` is the parent of any input or textarea element.
 *
 * Input and textarea elements will not behave properly unless the md-input-container
 * parent is provided.
 *
 * @param md-is-error {expression=} When the given expression evaluates to true, the input container will go into error state. Defaults to erroring if the input has been touched and is invalid.
 * @param md-no-float {boolean=} When present, placeholders will not be converted to floating labels
 *
 * @usage
 * <hljs lang="html">
 *
 * <md-input-container>
 *   <label>Username</label>
 *   <input type="text" ng-model="user.name">
 * </md-input-container>
 *
 * <md-input-container>
 *   <label>Description</label>
 *   <textarea ng-model="user.description"></textarea>
 * </md-input-container>
 *
 * </hljs>
 */
function mdInputContainerDirective($mdTheming, $parse) {
  ContainerCtrl.$inject = ["$scope", "$element", "$attrs"];
  return {
    restrict: 'E',
    link: postLink,
    controller: ContainerCtrl
  };

  function postLink(scope, element, attr) {
    $mdTheming(element);
  }
  function ContainerCtrl($scope, $element, $attrs) {
    var self = this;

    self.isErrorGetter = $attrs.mdIsError && $parse($attrs.mdIsError);

    self.delegateClick = function() {
      self.input.focus();
    };
    self.element = $element;
    self.setFocused = function(isFocused) {
      $element.toggleClass('md-input-focused', !!isFocused);
    };
    self.setHasValue = function(hasValue) {
      $element.toggleClass('md-input-has-value', !!hasValue);
    };
    self.setInvalid = function(isInvalid) {
      $element.toggleClass('md-input-invalid', !!isInvalid);
    };
    $scope.$watch(function() {
      return self.label && self.input;
    }, function(hasLabelAndInput) {
      if (hasLabelAndInput && !self.label.attr('for')) {
        self.label.attr('for', self.input.attr('id'));
      }
    });
  }
}
mdInputContainerDirective.$inject = ["$mdTheming", "$parse"];

function labelDirective() {
  return {
    restrict: 'E',
    require: '^?mdInputContainer',
    link: function(scope, element, attr, containerCtrl) {
      if (!containerCtrl || attr.mdNoFloat) return;

      containerCtrl.label = element;
      scope.$on('$destroy', function() {
        containerCtrl.label = null;
      });
    }
  };
}

/**
 * @ngdoc directive
 * @name mdInput
 * @restrict E
 * @module material.components.input
 *
 * @description
 * Use the `<input>` or the  `<textarea>` as a child of an `<md-input-container>`.
 *
 * @param {number=} md-maxlength The maximum number of characters allowed in this input. If this is specified, a character counter will be shown underneath the input.<br/><br/>
 * The purpose of **`md-maxlength`** is exactly to show the max length counter text. If you don't want the counter text and only need "plain" validation, you can use the "simple" `ng-maxlength` or maxlength attributes.
 * @param {string=} aria-label Aria-label is required when no label is present.  A warning message will be logged in the console if not present.
 * @param {string=} placeholder An alternative approach to using aria-label when the label is not present.  The placeholder text is copied to the aria-label attribute.
 *
 * @usage
 * <hljs lang="html">
 * <md-input-container>
 *   <label>Color</label>
 *   <input type="text" ng-model="color" required md-maxlength="10">
 * </md-input-container>
 * </hljs>
 * <h3>With Errors</h3>
 *
 * <hljs lang="html">
 * <form name="userForm">
 *   <md-input-container>
 *     <label>Last Name</label>
 *     <input name="lastName" ng-model="lastName" required md-maxlength="10" minlength="4">
 *     <div ng-messages="userForm.lastName.$error" ng-show="userForm.lastName.$dirty">
 *       <div ng-message="required">This is required!</div>
 *       <div ng-message="md-maxlength">That's too long!</div>
 *       <div ng-message="minlength">That's too short!</div>
 *     </div>
 *   </md-input-container>
 *   <md-input-container>
 *     <label>Biography</label>
 *     <textarea name="bio" ng-model="biography" required md-maxlength="150"></textarea>
 *     <div ng-messages="userForm.bio.$error" ng-show="userForm.bio.$dirty">
 *       <div ng-message="required">This is required!</div>
 *       <div ng-message="md-maxlength">That's too long!</div>
 *     </div>
 *   </md-input-container>
 *   <md-input-container>
 *     <input aria-label='title' ng-model='title'>
 *   </md-input-container>
 *   <md-input-container>
 *     <input placeholder='title' ng-model='title'>
 *   </md-input-container>
 * </form>
 * </hljs>
 *
 * Requires [ngMessages](https://docs.angularjs.org/api/ngMessages).
 * Behaves like the [AngularJS input directive](https://docs.angularjs.org/api/ng/directive/input).
 *
 */

function inputTextareaDirective($mdUtil, $window, $mdAria) {
  return {
    restrict: 'E',
    require: ['^?mdInputContainer', '?ngModel'],
    link: postLink
  };

  function postLink(scope, element, attr, ctrls) {

    var containerCtrl = ctrls[0];
    var ngModelCtrl = ctrls[1] || $mdUtil.fakeNgModel();
    var isReadonly = angular.isDefined(attr.readonly);

    if ( !containerCtrl ) return;
    if (containerCtrl.input) {
      throw new Error("<md-input-container> can only have *one* <input> or <textarea> child element!");
    }
    containerCtrl.input = element;

    if(!containerCtrl.label) {
      $mdAria.expect(element, 'aria-label', element.attr('placeholder'));
    }

    element.addClass('md-input');
    if (!element.attr('id')) {
      element.attr('id', 'input_' + $mdUtil.nextUid());
    }

    if (element[0].tagName.toLowerCase() === 'textarea') {
      setupTextarea();
    }

    var isErrorGetter = containerCtrl.isErrorGetter || function() {
      return ngModelCtrl.$invalid && ngModelCtrl.$touched;
    };
    scope.$watch(isErrorGetter, containerCtrl.setInvalid);

    ngModelCtrl.$parsers.push(ngModelPipelineCheckValue);
    ngModelCtrl.$formatters.push(ngModelPipelineCheckValue);

    element.on('input', inputCheckValue);

    if (!isReadonly) {
      element
        .on('focus', function(ev) {
          containerCtrl.setFocused(true);
        })
        .on('blur', function(ev) {
          containerCtrl.setFocused(false);
          inputCheckValue();
        });

    }

    //ngModelCtrl.$setTouched();
    //if( ngModelCtrl.$invalid ) containerCtrl.setInvalid();

    scope.$on('$destroy', function() {
      containerCtrl.setFocused(false);
      containerCtrl.setHasValue(false);
      containerCtrl.input = null;
    });

    /**
     *
     */
    function ngModelPipelineCheckValue(arg) {
      containerCtrl.setHasValue(!ngModelCtrl.$isEmpty(arg));
      return arg;
    }
    function inputCheckValue() {
      // An input's value counts if its length > 0,
      // or if the input's validity state says it has bad input (eg string in a number input)
      containerCtrl.setHasValue(element.val().length > 0 || (element[0].validity||{}).badInput);
    }

    function setupTextarea() {
      var node = element[0];
      var onChangeTextarea = $mdUtil.debounce(growTextarea, 1);

      function pipelineListener(value) {
        onChangeTextarea();
        return value;
      }

      if (ngModelCtrl) {
        ngModelCtrl.$formatters.push(pipelineListener);
        ngModelCtrl.$viewChangeListeners.push(pipelineListener);
      } else {
        onChangeTextarea();
      }
      element.on('keydown input', onChangeTextarea);
      element.on('scroll', onScroll);
      angular.element($window).on('resize', onChangeTextarea);

      scope.$on('$destroy', function() {
        angular.element($window).off('resize', onChangeTextarea);
      });

      function growTextarea() {
        node.style.height = "auto";
        node.scrollTop = 0;
        var height = getHeight();
        if (height) node.style.height = height + 'px';
      }

      function getHeight () {
        var line = node.scrollHeight - node.offsetHeight;
        return node.offsetHeight + (line > 0 ? line : 0);
      }

      function onScroll(e) {
        node.scrollTop = 0;
        // for smooth new line adding
        var line = node.scrollHeight - node.offsetHeight;
        var height = node.offsetHeight + line;
        node.style.height = height + 'px';
      }
    }
  }
}
inputTextareaDirective.$inject = ["$mdUtil", "$window", "$mdAria"];

function mdMaxlengthDirective($animate) {
  return {
    restrict: 'A',
    require: ['ngModel', '^mdInputContainer'],
    link: postLink
  };

  function postLink(scope, element, attr, ctrls) {
    var maxlength;
    var ngModelCtrl = ctrls[0];
    var containerCtrl = ctrls[1];
    var charCountEl = angular.element('<div class="md-char-counter">');

    // Stop model from trimming. This makes it so whitespace
    // over the maxlength still counts as invalid.
    attr.$set('ngTrim', 'false');
    containerCtrl.element.append(charCountEl);

    ngModelCtrl.$formatters.push(renderCharCount);
    ngModelCtrl.$viewChangeListeners.push(renderCharCount);
    element.on('input keydown', function() {
      renderCharCount(); //make sure it's called with no args
    });

    scope.$watch(attr.mdMaxlength, function(value) {
      maxlength = value;
      if (angular.isNumber(value) && value > 0) {
        if (!charCountEl.parent().length) {
          $animate.enter(charCountEl, containerCtrl.element,
                         angular.element(containerCtrl.element[0].lastElementChild));
        }
        renderCharCount();
      } else {
        $animate.leave(charCountEl);
      }
    });

    ngModelCtrl.$validators['md-maxlength'] = function(modelValue, viewValue) {
      if (!angular.isNumber(maxlength) || maxlength < 0) {
        return true;
      }
      return ( modelValue || element.val() || viewValue || '' ).length <= maxlength;
    };

    function renderCharCount(value) {
      charCountEl.text( ( element.val() || value || '' ).length + '/' + maxlength );
      return value;
    }
  }
}
mdMaxlengthDirective.$inject = ["$animate"];

function placeholderDirective($log) {
  var blackListElements = ['MD-SELECT'];
  return {
    restrict: 'A',
    require: '^^?mdInputContainer',
    priority: 200,
    link: postLink
  };

  function postLink(scope, element, attr, inputContainer) {
    if (!inputContainer) return;
    if (blackListElements.indexOf(element[0].nodeName) != -1) return;
    if (angular.isDefined(inputContainer.element.attr('md-no-float'))) return;

    var placeholderText = attr.placeholder;
    element.removeAttr('placeholder');

    if ( inputContainer.element.find('label').length == 0 ) {
      var placeholder = '<label ng-click="delegateClick()">' + placeholderText + '</label>';

      inputContainer.element.addClass('md-icon-float');
      inputContainer.element.prepend(placeholder);
    } else {
      $log.warn("The placeholder='" + placeholderText + "' will be ignored since this md-input-container has a child label element.");
    }

  }
}
placeholderDirective.$inject = ["$log"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.list
 * @description
 * List module
 */
angular.module('material.components.list', [
  'material.core'
])
  .controller('MdListController', MdListController)
  .directive('mdList', mdListDirective)
  .directive('mdListItem', mdListItemDirective);

/**
 * @ngdoc directive
 * @name mdList
 * @module material.components.list
 *
 * @restrict E
 *
 * @description
 * The `<md-list>` directive is a list container for 1..n `<md-list-item>` tags.
 *
 * @usage
 * <hljs lang="html">
 * <md-list>
 *   <md-list-item class="md-2-line" ng-repeat="item in todos">
 *     <md-checkbox ng-model="item.done"></md-checkbox>
 *     <div class="md-list-item-text">
 *       <h3>{{item.title}}</h3>
 *       <p>{{item.description}}</p>
 *     </div>
 *   </md-list-item>
 * </md-list>
 * </hljs>
 */

function mdListDirective($mdTheming) {
  return {
    restrict: 'E',
    compile: function(tEl) {
      tEl[0].setAttribute('role', 'list');
      return $mdTheming;
    }
  };
}
mdListDirective.$inject = ["$mdTheming"];
/**
 * @ngdoc directive
 * @name mdListItem
 * @module material.components.list
 *
 * @restrict E
 *
 * @description
 * The `<md-list-item>` directive is a container intended for row items in a `<md-list>` container.
 *
 * @usage
 * <hljs lang="html">
 *  <md-list>
 *    <md-list-item>
 *            Item content in list
 *    </md-list-item>
 *  </md-list>
 * </hljs>
 *
 */
function mdListItemDirective($mdAria, $mdConstant, $timeout) {
  var proxiedTypes = ['md-checkbox', 'md-switch'];
  return {
    restrict: 'E',
    controller: 'MdListController',
    compile: function(tEl, tAttrs) {
      // Check for proxy controls (no ng-click on parent, and a control inside)
      var secondaryItem = tEl[0].querySelector('.md-secondary');
      var hasProxiedElement;
      var proxyElement;

      tEl[0].setAttribute('role', 'listitem');

      if (!tAttrs.ngClick) {
        for (var i = 0, type; type = proxiedTypes[i]; ++i) {
          if (proxyElement = tEl[0].querySelector(type)) {
            hasProxiedElement = true;
            break;
          }
        }
        if (hasProxiedElement) {
          wrapIn('div');
        } else if (!tEl[0].querySelector('md-button')) {
          tEl.addClass('md-no-proxy');
        }
      } else {
        wrapIn('button');
      }
      setupToggleAria();


      function setupToggleAria() {
        var toggleTypes = ['md-switch', 'md-checkbox'];
        var toggle;

        for (var i = 0, toggleType; toggleType = toggleTypes[i]; ++i) {
          if (toggle = tEl.find(toggleType)[0]) {
            if (!toggle.hasAttribute('aria-label')) {
              var p = tEl.find('p')[0];
              if (!p) return;
              toggle.setAttribute('aria-label', 'Toggle ' + p.textContent);
            }
          }
        }
      }

      function wrapIn(type) {
        var container;
        if (type == 'div') {
          container = angular.element('<div class="md-no-style md-list-item-inner">');
          container.append(tEl.contents());
          tEl.addClass('md-proxy-focus');
        } else {
          container = angular.element('<md-button class="md-no-style"><div class="md-list-item-inner"></div></md-button>');
          var copiedAttrs = ['ng-click', 'aria-label', 'ng-disabled'];
          angular.forEach(copiedAttrs, function(attr) {
            if (tEl[0].hasAttribute(attr)) {
              container[0].setAttribute(attr, tEl[0].getAttribute(attr));
              tEl[0].removeAttribute(attr);
            }
          });
          container.children().eq(0).append(tEl.contents());
        }

        tEl[0].setAttribute('tabindex', '-1');
        tEl.append(container);

        if (secondaryItem && secondaryItem.hasAttribute('ng-click')) {
          $mdAria.expect(secondaryItem, 'aria-label');
          var buttonWrapper = angular.element('<md-button class="md-secondary-container md-icon-button">');
          buttonWrapper.attr('ng-click', secondaryItem.getAttribute('ng-click'));
          secondaryItem.removeAttribute('ng-click');
          secondaryItem.setAttribute('tabindex', '-1');
          secondaryItem.classList.remove('md-secondary');
          buttonWrapper.append(secondaryItem);
          secondaryItem = buttonWrapper[0];
        }

        // Check for a secondary item and move it outside
        if ( secondaryItem && (
          secondaryItem.hasAttribute('ng-click') ||
            ( tAttrs.ngClick &&
             isProxiedElement(secondaryItem) )
        )) {
          tEl.addClass('md-with-secondary');
          tEl.append(secondaryItem);
        }
      }

      function isProxiedElement(el) {
        return proxiedTypes.indexOf(el.nodeName.toLowerCase()) != -1;
      }

      return postLink;

      function postLink($scope, $element, $attr, ctrl) {

        var proxies    = [],
            firstChild = $element[0].firstElementChild,
            hasClick   = firstChild && firstChild.hasAttribute('ng-click');

        computeProxies();
        computeClickable();

        if ($element.hasClass('md-proxy-focus') && proxies.length) {
          angular.forEach(proxies, function(proxy) {
            proxy = angular.element(proxy);

            $scope.mouseActive = false;
            proxy.on('mousedown', function() {
              $scope.mouseActive = true;
              $timeout(function(){
                $scope.mouseActive = false;
              }, 100);
            })
            .on('focus', function() {
              if ($scope.mouseActive === false) { $element.addClass('md-focused'); }
              proxy.on('blur', function proxyOnBlur() {
                $element.removeClass('md-focused');
                proxy.off('blur', proxyOnBlur);
              });
            });
          });
        }

        function computeProxies() {
          var children = $element.children();
          if (children.length && !children[0].hasAttribute('ng-click')) {
            angular.forEach(proxiedTypes, function(type) {
              angular.forEach(firstChild.querySelectorAll(type), function(child) {
                proxies.push(child);
              });
            });
          }
        }
        function computeClickable() {
          if (proxies.length || hasClick) {
            $element.addClass('md-clickable');

            ctrl.attachRipple($scope, angular.element($element[0].querySelector('.md-no-style')));
          }
        }

        if (!hasClick && !proxies.length) {
          firstChild && firstChild.addEventListener('keypress', function(e) {
            if (e.target.nodeName != 'INPUT' && e.target.nodeName != 'TEXTAREA') {
              var keyCode = e.which || e.keyCode;
              if (keyCode == $mdConstant.KEY_CODE.SPACE) {
                if (firstChild) {
                  firstChild.click();
                  e.preventDefault();
                  e.stopPropagation();
                }
              }
            }
          });
        }

        $element.off('click');
        $element.off('keypress');

        if (proxies.length && firstChild) {
          $element.children().eq(0).on('click', function(e) {
            if (firstChild.contains(e.target)) {
              angular.forEach(proxies, function(proxy) {
                if (e.target !== proxy && !proxy.contains(e.target)) {
                  angular.element(proxy).triggerHandler('click');
                }
              });
            }
          });
        }
      }
    }
  };
}
mdListItemDirective.$inject = ["$mdAria", "$mdConstant", "$timeout"];

/*
 * @private
 * @ngdoc controller
 * @name MdListController
 * @module material.components.list
 *
 */
function MdListController($scope, $element, $mdListInkRipple) {
  var ctrl = this;
  ctrl.attachRipple = attachRipple;

  function attachRipple (scope, element) {
    var options = {};
    $mdListInkRipple.attach(scope, element, options);
  }
}
MdListController.$inject = ["$scope", "$element", "$mdListInkRipple"];


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.menu
 */

angular.module('material.components.menu', [
  'material.core',
  'material.components.backdrop'
])
.directive('mdMenu', MenuDirective)
.controller('mdMenuCtrl', MenuController);

/**
 * @ngdoc directive
 * @name mdMenu
 * @module material.components.menu
 * @restrict E
 * @description
 *
 * Menus are elements that open when clicked. They are useful for displaying
 * additional options within the context of an action.
 *
 * Every `md-menu` must specify exactly two child elements. The first element is what is
 * left in the DOM and is used to open the menu. This element is called the trigger element.
 * The trigger element's scope has access to `$mdOpenMenu($event)`
 * which it may call to open the menu. By passing $event as argument, the
 * corresponding event is stopped from propagating up the DOM-tree.
 *
 * The second element is the `md-menu-content` element which represents the
 * contents of the menu when it is open. Typically this will contain `md-menu-item`s,
 * but you can do custom content as well.
 *
 * <hljs lang="html">
 * <md-menu>
 *  <!-- Trigger element is a md-button with an icon -->
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button" aria-label="Open sample menu">
 *    <md-icon md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item><md-button ng-click="doSomething()">Do Something</md-button></md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>

 * ## Sizing Menus
 *
 * The width of the menu when it is open may be specified by specifying a `width`
 * attribute on the `md-menu-content` element.
 * See the [Material Design Spec](http://www.google.com/design/spec/components/menus.html#menus-specs)
 * for more information.
 *
 *
 * ## Aligning Menus
 *
 * When a menu opens, it is important that the content aligns with the trigger element.
 * Failure to align menus can result in jarring experiences for users as content
 * suddenly shifts. To help with this, `md-menu` provides serveral APIs to help
 * with alignment.
 *
 * ### Target Mode
 *
 * By default, `md-menu` will attempt to align the `md-menu-content` by aligning
 * designated child elements in both the trigger and the menu content.
 *
 * To specify the alignment element in the `trigger` you can use the `md-menu-origin`
 * attribute on a child element. If no `md-menu-origin` is specified, the `md-menu`
 * will be used as the origin element.
 *
 * Similarly, the `md-menu-content` may specify a `md-menu-align-target` for a
 * `md-menu-item` to specify the node that it should try and align with.
 *
 * In this example code, we specify an icon to be our origin element, and an
 * icon in our menu content to be our alignment target. This ensures that both
 * icons are aligned when the menu opens.
 *
 * <hljs lang="html">
 * <md-menu>
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button" aria-label="Open some menu">
 *    <md-icon md-menu-origin md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item>
 *      <md-button ng-click="doSomething()" aria-label="Do something">
 *        <md-icon md-menu-align-target md-svg-icon="call:phone"></md-icon>
 *        Do Something
 *      </md-button>
 *    </md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>
 *
 * Sometimes we want to specify alignment on the right side of an element, for example
 * if we have a menu on the right side a toolbar, we want to right align our menu content.
 *
 * We can specify the origin by using the `md-position-mode` attribute on both
 * the `x` and `y` axis. Right now only the `x-axis` has more than one option.
 * You may specify the default mode of `target target` or
 * `target-right target` to specify a right-oriented alignment target. See the
 * position section of the demos for more examples.
 *
 * ### Menu Offsets
 *
 * It is sometimes unavoidable to need to have a deeper level of control for
 * the positioning of a menu to ensure perfect alignment. `md-menu` provides
 * the `md-offset` attribute to allow pixel level specificty of adjusting the
 * exact positioning.
 *
 * This offset is provided in the format of `x y` or `n` where `n` will be used
 * in both the `x` and `y` axis.
 *
 * For example, to move a menu by `2px` from the top, we can use:
 * <hljs lang="html">
 * <md-menu md-offset="2 0">
 *   <!-- menu-content -->
 * </md-menu>
 * </hljs>
 *
 * @usage
 * <hljs lang="html">
 * <md-menu>
 *  <md-button ng-click="$mdOpenMenu($event)" class="md-icon-button">
 *    <md-icon md-svg-icon="call:phone"></md-icon>
 *  </md-button>
 *  <md-menu-content>
 *    <md-menu-item><md-button ng-click="doSomething()">Do Something</md-button></md-menu-item>
 *  </md-menu-content>
 * </md-menu>
 * </hljs>
 *
 * @param {string} md-position-mode The position mode in the form of
             `x`, `y`. Default value is `target`,`target`. Right now the `x` axis
             also suppports `target-right`.
 * @param {string} md-offset An offset to apply to the dropdown after positioning
             `x`, `y`. Default value is `0`,`0`.
 *
 */

function MenuDirective($mdMenu) {
  return {
    restrict: 'E',
    require: 'mdMenu',
    controller: 'mdMenuCtrl', // empty function to be built by link
    scope: true,
    compile: compile
  };

  function compile(templateElement) {
    templateElement.addClass('md-menu');
    var triggerElement = templateElement.children()[0];
    if (!triggerElement.hasAttribute('ng-click')) {
      triggerElement = triggerElement.querySelector('[ng-click]');
    }
    triggerElement && triggerElement.setAttribute('aria-haspopup', 'true');
    if (templateElement.children().length != 2) {
      throw Error('Invalid HTML for md-menu. Expected two children elements.');
    }
    return link;
  }

  function link(scope, element, attrs, mdMenuCtrl) {

    // Move everything into a md-menu-container and pass it to the controller
    var menuContainer = angular.element(
      '<div class="md-open-menu-container md-whiteframe-z2"></div>'
    );
    var menuContents = element.children()[1];
    menuContainer.append(menuContents);
    mdMenuCtrl.init(menuContainer);

    scope.$on('$destroy', function() {
      if (mdMenuCtrl.isOpen) {
        menuContainer.remove();
        mdMenuCtrl.close();
      }
    });

  }
}
MenuDirective.$inject = ["$mdMenu"];

function MenuController($mdMenu, $attrs, $element, $scope) {

  var menuContainer;
  var ctrl = this;
  var triggerElement;

  // Called by our linking fn to provide access to the menu-content
  // element removed during link
  this.init = function(setMenuContainer) {
    menuContainer = setMenuContainer;
    triggerElement = $element[0].querySelector('[ng-click]');
  };

  // Uses the $mdMenu interim element service to open the menu contents
  this.open = function openMenu(ev) {
    ev && ev.stopPropagation();

    ctrl.isOpen = true;
    triggerElement.setAttribute('aria-expanded', 'true');
    $mdMenu.show({
      mdMenuCtrl: ctrl,
      element: menuContainer,
      target: $element[0]
    });
  };
  // Expose a open function to the child scope for html to use
  $scope.$mdOpenMenu = this.open;

  // Use the $mdMenu interim element service to close the menu contents
  this.close = function closeMenu(skipFocus) {
    ctrl.isOpen = false;
    triggerElement.setAttribute('aria-expanded', 'false');
    $mdMenu.hide();

    if (!skipFocus) {
      $element.children()[0].focus();
    }
  };

  // Build a nice object out of our string attribute which specifies the
  // target mode for left and top positioning
  this.positionMode = function() {
    var attachment = ($attrs.mdPositionMode || 'target').split(' ');

    // If attachment is a single item, duplicate it for our second value.
    // ie. 'target' -> 'target target'
    if (attachment.length == 1) {
      attachment.push(attachment[0]);
    }

    return {
      left: attachment[0],
      top: attachment[1]
    };
  };

  // Build a nice object out of our string attribute which specifies
  // the offset of top and left in pixels.
  this.offsets = function() {
    var offsets = ($attrs.mdOffset || '0 0').split(' ').map(parseFloat);
    if (offsets.length == 2) {
      return {
        left: offsets[0],
        top: offsets[1]
      };
    } else if (offsets.length == 1) {
      return {
        top: offsets[0],
        left: offsets[0]
      };
    } else {
      throw Error('Invalid offsets specified. Please follow format <x, y> or <n>');
    }
  };
}
MenuController.$inject = ["$mdMenu", "$attrs", "$element", "$scope"];

})();
(function(){
"use strict";

angular.module('material.components.menu')
.provider('$mdMenu', MenuProvider);

/*
 * Interim element provider for the menu.
 * Handles behavior for a menu while it is open, including:
 *    - handling animating the menu opening/closing
 *    - handling key/mouse events on the menu element
 *    - handling enabling/disabling scroll while the menu is open
 *    - handling redrawing during resizes and orientation changes
 *
 */

function MenuProvider($$interimElementProvider) {
  var MENU_EDGE_MARGIN = 8;

  menuDefaultOptions.$inject = ["$$rAF", "$window", "$mdUtil", "$mdTheming", "$timeout", "$mdConstant", "$document"];
  return $$interimElementProvider('$mdMenu')
    .setDefaults({
      methods: ['target'],
      options: menuDefaultOptions
    });

  /* @ngInject */
  function menuDefaultOptions($$rAF, $window, $mdUtil, $mdTheming, $timeout, $mdConstant, $document) {
    return {
      parent: 'body',
      onShow: onShow,
      onRemove: onRemove,
      hasBackdrop: true,
      disableParentScroll: true,
      skipCompile: true,
      themable: true
    };

    /**
     * Boilerplate interimElement onShow function
     * Handles inserting the menu into the DOM, positioning it, and wiring up
     * various interaction events
     */
    function onShow(scope, element, opts) {

      // Sanitize and set defaults on opts
      buildOpts(opts);

      // Wire up theming on our menu element
      $mdTheming.inherit(opts.menuContentEl, opts.target);

      // Register various listeners to move menu on resize/orientation change
      handleResizing();

      // Disable scrolling
      if (opts.disableParentScroll) {
        opts.restoreScroll = $mdUtil.disableScrollAround(opts.element);
      }

      // Only activate click listeners after a short time to stop accidental double taps/clicks
      // from clicking the wrong item
      $timeout(activateInteraction, 75, false);

      if (opts.backdrop) {
        $mdTheming.inherit(opts.backdrop, opts.parent);
        opts.parent.append(opts.backdrop);
      }
      showMenu();

      // Return the promise for when our menu is done animating in
      return $mdUtil.transitionEndPromise(element, {timeout: 350});

      /** Check for valid opts and set some sane defaults */
      function buildOpts() {
        if (!opts.target) {
          throw Error(
            '$mdMenu.show() expected a target to animate from in options.target'
          );
        }
        angular.extend(opts, {
          alreadyOpen: false,
          isRemoved: false,
          target: angular.element(opts.target), //make sure it's not a naked dom node
          parent: angular.element(opts.parent),
          menuContentEl: angular.element(element[0].querySelector('md-menu-content')),
          backdrop: opts.hasBackdrop && angular.element('<md-backdrop class="md-menu-backdrop md-click-catcher">')
        });
      }

      /** Wireup various resize listeners for screen changes */
      function handleResizing() {
        opts.resizeFn = function() {
          positionMenu(element, opts);
        };
        angular.element($window).on('resize', opts.resizeFn);
        angular.element($window).on('orientationchange', opts.resizeFn);
      }

      /**
       * Place the menu into the DOM and call positioning related functions
       */
      function showMenu() {
        opts.parent.append(element);

        element.removeClass('md-leave');
        // Kick off our animation/positioning but first, wait a few frames
        // so all of our computed positions/sizes are accurate
        $$rAF(function() {
          $$rAF(function() {
            positionMenu(element, opts);
            // Wait a frame before fading in menu (md-active) so that we don't trigger
            // transitions on the menu position changing
            $$rAF(function() {
              element.addClass('md-active');
              opts.alreadyOpen = true;
              element[0].style[$mdConstant.CSS.TRANSFORM] = '';
            });
          });
        });
      }


      /**
       * Activate interaction on the menu. Wire up keyboard listerns for
       * clicks, keypresses, backdrop closing, etc.
       */
      function activateInteraction() {
        element.addClass('md-clickable');

        // close on backdrop click
        opts.backdrop && opts.backdrop.on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          opts.mdMenuCtrl.close(true);
        });

        // Wire up keyboard listeners.
        // Close on escape, focus next item on down arrow, focus prev item on up
        opts.menuContentEl.on('keydown', function(ev) {
          scope.$apply(function() {
            switch (ev.keyCode) {
              case $mdConstant.KEY_CODE.ESCAPE: opts.mdMenuCtrl.close(); break;
              case $mdConstant.KEY_CODE.UP_ARROW: focusMenuItem(ev, opts.menuContentEl, opts, -1); break;
              case $mdConstant.KEY_CODE.DOWN_ARROW: focusMenuItem(ev, opts.menuContentEl, opts, 1); break;
            }
          });
        });

        // Close menu on menu item click, if said menu-item is not disabled
        opts.menuContentEl.on('click', function(e) {
          var target = e.target;
          // Traverse up the event until we get to the menuContentEl to see if
          // there is an ng-click and that the ng-click is not disabled
          do {
            if (target && target.hasAttribute('ng-click')) {
              if (!target.hasAttribute('disabled')) {
                close();
              }
              break;
            }
          } while ((target = target.parentNode) && target != opts.menuContentEl)

          function close() {
            scope.$apply(function() {
              opts.mdMenuCtrl.close();
            });
          }
        });

        // kick off initial focus in the menu on the first element
        var focusTarget = opts.menuContentEl[0].querySelector('[md-menu-focus-target]');
        if (!focusTarget) focusTarget = opts.menuContentEl[0].firstElementChild.firstElementChild;
        focusTarget.focus();
      }
    }

    /**
      * Takes a keypress event and focuses the next/previous menu
      * item from the emitting element
      * @param {event} e - The origin keypress event
      * @param {angular.element} menuEl - The menu element
      * @param {object} opts - The interim element options for the mdMenu
      * @param {number} direction - The direction to move in (+1 = next, -1 = prev)
      */
    function focusMenuItem(e, menuEl, opts, direction) {
      var currentItem = $mdUtil.getClosest(e.target, 'MD-MENU-ITEM');

      var items = $mdUtil.nodesToArray(menuEl[0].children);
      var currentIndex = items.indexOf(currentItem);

      // Traverse through our elements in the specified direction (+/-1) and try to
      // focus them until we find one that accepts focus
      for (var i = currentIndex + direction; i >= 0 && i < items.length; i = i + direction) {
        var focusTarget = items[i].firstElementChild || items[i];
        var didFocus = attemptFocus(focusTarget);
        if (didFocus) {
          break;
        }
      }
    }

    /**
     * Attempts to focus an element. Checks whether that element is the currently
     * focused element after attempting.
     * @param {HTMLElement} el - the element to attempt focus on
     * @returns {bool} - whether the element was successfully focused
     */
    function attemptFocus(el) {
      if (el && el.getAttribute('tabindex') != -1) {
        el.focus();
        if ($document[0].activeElement == el) {
          return true;
        } else {
          return false;
        }
      }
    }

    /**
     * Boilerplate interimElement onRemove function
     * Handles removing the menu from the DOM, cleaning up the element
     * and removing various listeners
     */
    function onRemove(scope, element, opts) {
      opts.isRemoved = true;
      element.addClass('md-leave')
        .removeClass('md-clickable');

      // Disable resizing handlers
      angular.element($window).off('resize', opts.resizeFn);
      angular.element($window).off('orientationchange', opts.resizeFn);
      opts.resizeFn = undefined;

      // Wait for animate out, then remove from the DOM
      return $mdUtil.transitionEndPromise(element, { timeout: 350 }).then(function() {
        element.removeClass('md-active');
        opts.backdrop && opts.backdrop.remove();
        if (element[0].parentNode === opts.parent[0]) {
          opts.parent[0].removeChild(element[0]);
        }
        opts.restoreScroll && opts.restoreScroll();
      });
    }

    /**
     * Computes menu position and sets the style on the menu container
     * @param {HTMLElement} el - the menu container element
     * @param {object} opts - the interim element options object
     */
    function positionMenu(el, opts) {
      if (opts.isRemoved) return;

      var containerNode = el[0],
          openMenuNode = el[0].firstElementChild,
          openMenuNodeRect = openMenuNode.getBoundingClientRect(),
          boundryNode = opts.parent[0],
          boundryNodeRect = boundryNode.getBoundingClientRect();

      var originNode = opts.target[0].querySelector('[md-menu-origin]') || opts.target[0],
          originNodeRect = originNode.getBoundingClientRect();


      var bounds = {
        left: boundryNodeRect.left + MENU_EDGE_MARGIN,
        top: boundryNodeRect.top + MENU_EDGE_MARGIN,
        bottom: boundryNodeRect.bottom - MENU_EDGE_MARGIN,
        right: boundryNodeRect.right - MENU_EDGE_MARGIN
      };


      var alignTarget, alignTargetRect, existingOffsets;
      var positionMode = opts.mdMenuCtrl.positionMode();

      if (positionMode.top == 'target' || positionMode.left == 'target' || positionMode.left == 'target-right') {
        // TODO: Allow centering on an arbitrary node, for now center on first menu-item's child
        alignTarget = openMenuNode.firstElementChild.firstElementChild || openMenuNode.firstElementChild;
        alignTarget = alignTarget.querySelector('[md-menu-align-target]') || alignTarget;
        alignTargetRect = alignTarget.getBoundingClientRect();

        existingOffsets = {
          top: parseFloat(containerNode.style.top || 0),
          left: parseFloat(containerNode.style.left || 0)
        };
      }

      var position = { };
      var transformOrigin = 'top ';

      switch (positionMode.top) {
        case 'target':
          position.top = existingOffsets.top + originNodeRect.top - alignTargetRect.top;
          break;
        // Future support for mdMenuBar
        // case 'top':
        //   position.top = originNodeRect.top;
        //   break;
        // case 'bottom':
        //   position.top = originNodeRect.top + originNodeRect.height;
        //   break;
        default:
          throw new Error('Invalid target mode "' + positionMode.top + '" specified for md-menu on Y axis.');
      }

      switch (positionMode.left) {
        case 'target':
          position.left = existingOffsets.left + originNodeRect.left - alignTargetRect.left;
          transformOrigin += 'left';
          break;
        case 'target-right':
          position.left = originNodeRect.right - openMenuNodeRect.width + (openMenuNodeRect.right - alignTargetRect.right);
          transformOrigin += 'right';
          break;
        // Future support for mdMenuBar
        // case 'left':
        //   position.left = originNodeRect.left;
        //   transformOrigin += 'left';
        //   break;
        // case 'right':
        //   position.left = originNodeRect.right - containerNode.offsetWidth;
        //   transformOrigin += 'right';
        //   break;
        default:
          throw new Error('Invalid target mode "' + positionMode.left + '" specified for md-menu on X axis.');
      }

      var offsets = opts.mdMenuCtrl.offsets();
      position.top += offsets.top;
      position.left += offsets.left;

      clamp(position);

      el.css({
        top: position.top + 'px',
        left: position.left + 'px'
      });

      containerNode.style[$mdConstant.CSS.TRANSFORM_ORIGIN] = transformOrigin;

      // Animate a scale out if we aren't just repositioning
      if (!opts.alreadyOpen) {
        containerNode.style[$mdConstant.CSS.TRANSFORM] = 'scale(' +
          Math.min(originNodeRect.width / containerNode.offsetWidth, 1.0) + ',' +
          Math.min(originNodeRect.height / containerNode.offsetHeight, 1.0) +
        ')';
      }

      /**
       * Clamps the repositioning of the menu within the confines of
       * bounding element (often the screen/body)
       */
      function clamp(pos) {
        pos.top = Math.max(Math.min(pos.top, bounds.bottom - containerNode.offsetHeight), bounds.top);
        pos.left = Math.max(Math.min(pos.left, bounds.right - containerNode.offsetWidth), bounds.left);
      }
    }
  }
}
MenuProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.progressCircular
 * @description Circular Progress module!
 */
angular.module('material.components.progressCircular', [
  'material.core'
])
  .directive('mdProgressCircular', MdProgressCircularDirective);

/**
 * @ngdoc directive
 * @name mdProgressCircular
 * @module material.components.progressCircular
 * @restrict E
 *
* @description
 * The circular progress directive is used to make loading content in your app as delightful and
 * painless as possible by minimizing the amount of visual change a user sees before they can view
 * and interact with content.
 *
 * For operations where the percentage of the operation completed can be determined, use a
 * determinate indicator. They give users a quick sense of how long an operation will take.
 *
 * For operations where the user is asked to wait a moment while something finishes up, and its
 * not necessary to expose what's happening behind the scenes and how long it will take, use an
 * indeterminate indicator.
 *
 * @param {string} md-mode Select from one of two modes: determinate and indeterminate.
 * @param {number=} value In determinate mode, this number represents the percentage of the
 *     circular progress. Default: 0
 * @param {number=} md-diameter This specifies the diamter of the circular progress. Default: 48
 *
 * @usage
 * <hljs lang="html">
 * <md-progress-circular md-mode="determinate" value="..."></md-progress-circular>
 *
 * <md-progress-circular md-mode="determinate" ng-value="..."></md-progress-circular>
 *
 * <md-progress-circular md-mode="determinate" value="..." md-diameter="100"></md-progress-circular>
 *
 * <md-progress-circular md-mode="indeterminate"></md-progress-circular>
 * </hljs>
 */
function MdProgressCircularDirective($mdConstant, $mdTheming) {
  return {
    restrict: 'E',
    template:
        // The progress 'circle' is composed of two half-circles: the left side and the right
        // side. Each side has CSS applied to 'fill-in' the half-circle to the appropriate progress.
        '<div class="md-spinner-wrapper">' +
          '<div class="md-inner">' +
            '<div class="md-gap"></div>' +
            '<div class="md-left">' +
              '<div class="md-half-circle"></div>' +
            '</div>' +
            '<div class="md-right">' +
              '<div class="md-half-circle"></div>' +
            '</div>' +
          '</div>' +
        '</div>',
    compile: compile
  };

  function compile(tElement) {
    // The javascript in this file is mainly responsible for setting the correct aria attributes.
    // The animation of the progress spinner is done entirely with just CSS.
    tElement.attr('aria-valuemin', 0);
    tElement.attr('aria-valuemax', 100);
    tElement.attr('role', 'progressbar');

    return postLink;
  }

  function postLink(scope, element, attr) {
    $mdTheming(element);
    var circle = element[0];

    // Scale the progress circle based on the default diameter.
    var diameter = attr.mdDiameter || 48;
    var scale = diameter / 48;
    circle.style[$mdConstant.CSS.TRANSFORM] = 'scale(' + scale + ')';

    attr.$observe('value', function(value) {
      var percentValue = clamp(value);
      element.attr('aria-valuenow', percentValue);
    });
  }

  /**
   * Clamps the value to be between 0 and 100.
   * @param {number} value The value to clamp.
   * @returns {number}
   */
  function clamp(value) {
    return Math.max(0, Math.min(value || 0, 100));
  }
}
MdProgressCircularDirective.$inject = ["$mdConstant", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.progressLinear
 * @description Linear Progress module!
 */
angular.module('material.components.progressLinear', [
  'material.core'
])
  .directive('mdProgressLinear', MdProgressLinearDirective);

/**
 * @ngdoc directive
 * @name mdProgressLinear
 * @module material.components.progressLinear
 * @restrict E
 *
 * @description
 * The linear progress directive is used to make loading content in your app as delightful and painless as possible by minimizing the amount of visual change a user sees before they can view and interact with content. Each operation should only be represented by one activity indicatorfor example, one refresh operation should not display both a refresh bar and an activity circle.
 *
 * For operations where the percentage of the operation completed can be determined, use a determinate indicator. They give users a quick sense of how long an operation will take.
 *
 * For operations where the user is asked to wait a moment while something finishes up, and its not necessary to expose what's happening behind the scenes and how long it will take, use an indeterminate indicator.
 *
 * @param {string} md-mode Select from one of four modes: determinate, indeterminate, buffer or query.
 * @param {number=} value In determinate and buffer modes, this number represents the percentage of the primary progress bar. Default: 0
 * @param {number=} md-buffer-value In the buffer mode, this number represents the precentage of the secondary progress bar. Default: 0
 *
 * @usage
 * <hljs lang="html">
 * <md-progress-linear md-mode="determinate" value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="determinate" ng-value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="indeterminate"></md-progress-linear>
 *
 * <md-progress-linear md-mode="buffer" value="..." md-buffer-value="..."></md-progress-linear>
 *
 * <md-progress-linear md-mode="query"></md-progress-linear>
 * </hljs>
 */
function MdProgressLinearDirective($$rAF, $mdConstant, $mdTheming) {

  return {
    restrict: 'E',
    template: '<div class="md-container">' +
      '<div class="md-dashed"></div>' +
      '<div class="md-bar md-bar1"></div>' +
      '<div class="md-bar md-bar2"></div>' +
      '</div>',
    compile: compile
  };
  
  function compile(tElement, tAttrs, transclude) {
    tElement.attr('aria-valuemin', 0);
    tElement.attr('aria-valuemax', 100);
    tElement.attr('role', 'progressbar');

    return postLink;
  }
  function postLink(scope, element, attr) {
    $mdTheming(element);
    var bar1Style = element[0].querySelector('.md-bar1').style,
      bar2Style = element[0].querySelector('.md-bar2').style,
      container = angular.element(element[0].querySelector('.md-container'));

    attr.$observe('value', function(value) {
      if (attr.mdMode == 'query') {
        return;
      }

      var clamped = clamp(value);
      element.attr('aria-valuenow', clamped);
      bar2Style[$mdConstant.CSS.TRANSFORM] = transforms[clamped];
    });

    attr.$observe('mdBufferValue', function(value) {
      bar1Style[$mdConstant.CSS.TRANSFORM] = transforms[clamp(value)];
    });

    $$rAF(function() {
      container.addClass('md-ready');
    });
  }

  function clamp(value) {
    if (value > 100) {
      return 100;
    }

    if (value < 0) {
      return 0;
    }

    return Math.ceil(value || 0);
  }
}
MdProgressLinearDirective.$inject = ["$$rAF", "$mdConstant", "$mdTheming"];


// **********************************************************
// Private Methods
// **********************************************************
var transforms = (function() {
  var values = new Array(101);
  for(var i = 0; i < 101; i++){
    values[i] = makeTransform(i);
  }

  return values;

  function makeTransform(value){
    var scale = value/100;
    var translateX = (value-100)/2;
    return 'translateX(' + translateX.toString() + '%) scale(' + scale.toString() + ', 1)';
  }
})();

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.radioButton
 * @description radioButton module!
 */
angular.module('material.components.radioButton', [
  'material.core'
])
  .directive('mdRadioGroup', mdRadioGroupDirective)
  .directive('mdRadioButton', mdRadioButtonDirective);

/**
 * @ngdoc directive
 * @module material.components.radioButton
 * @name mdRadioGroup
 *
 * @restrict E
 *
 * @description
 * The `<md-radio-group>` directive identifies a grouping
 * container for the 1..n grouped radio buttons; specified using nested
 * `<md-radio-button>` tags.
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the radio button is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * Note: `<md-radio-group>` and `<md-radio-button>` handle tabindex differently
 * than the native `<input type='radio'>` controls. Whereas the native controls
 * force the user to tab through all the radio buttons, `<md-radio-group>`
 * is focusable, and by default the `<md-radio-button>`s are not.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {boolean=} md-no-ink Use of attribute indicates flag to disable ink ripple effects.
 *
 * @usage
 * <hljs lang="html">
 * <md-radio-group ng-model="selected">
 *
 *   <md-radio-button
 *        ng-repeat="d in colorOptions"
 *        ng-value="d.value" aria-label="{{ d.label }}">
 *
 *          {{ d.label }}
 *
 *   </md-radio-button>
 *
 * </md-radio-group>
 * </hljs>
 *
 */
function mdRadioGroupDirective($mdUtil, $mdConstant, $mdTheming, $timeout) {
  RadioGroupController.prototype = createRadioGroupControllerProto();

  return {
    restrict: 'E',
    controller: ['$element', RadioGroupController],
    require: ['mdRadioGroup', '?ngModel'],
    link: { pre: linkRadioGroup }
  };

  function linkRadioGroup(scope, element, attr, ctrls) {
    $mdTheming(element);
    var rgCtrl = ctrls[0];
    var ngModelCtrl = ctrls[1] || $mdUtil.fakeNgModel();

    function setFocus() {
      if (!element.hasClass('md-focused')) { element.addClass('md-focused'); }
    }

    function keydownListener(ev) {
      var keyCode = ev.which || ev.keyCode;
      switch(keyCode) {
        case $mdConstant.KEY_CODE.LEFT_ARROW:
        case $mdConstant.KEY_CODE.UP_ARROW:
          ev.preventDefault();
          rgCtrl.selectPrevious();
          setFocus();
          break;

        case $mdConstant.KEY_CODE.RIGHT_ARROW:
        case $mdConstant.KEY_CODE.DOWN_ARROW:
          ev.preventDefault();
          rgCtrl.selectNext();
          setFocus();
          break;

        case $mdConstant.KEY_CODE.ENTER:
          var form = angular.element($mdUtil.getClosest(element[0], 'form'));
          if (form.length > 0) {
            form.triggerHandler('submit');
          }
          break;
      }
    }

    rgCtrl.init(ngModelCtrl);

    scope.mouseActive = false;
    element.attr({
              'role': 'radiogroup',
              'tabIndex': element.attr('tabindex') || '0'
            })
            .on('keydown', keydownListener)
            .on('mousedown', function(event) {
              scope.mouseActive = true;
              $timeout(function() {
                scope.mouseActive = false;
              }, 100);
            })
            .on('focus', function() {
              if(scope.mouseActive === false) { rgCtrl.$element.addClass('md-focused'); }
            })
            .on('blur', function() { rgCtrl.$element.removeClass('md-focused'); });
  }

  function RadioGroupController($element) {
    this._radioButtonRenderFns = [];
    this.$element = $element;
  }

  function createRadioGroupControllerProto() {
    return {
      init: function(ngModelCtrl) {
        this._ngModelCtrl = ngModelCtrl;
        this._ngModelCtrl.$render = angular.bind(this, this.render);
      },
      add: function(rbRender) {
        this._radioButtonRenderFns.push(rbRender);
      },
      remove: function(rbRender) {
        var index = this._radioButtonRenderFns.indexOf(rbRender);
        if (index !== -1) {
          this._radioButtonRenderFns.splice(index, 1);
        }
      },
      render: function() {
        this._radioButtonRenderFns.forEach(function(rbRender) {
          rbRender();
        });
      },
      setViewValue: function(value, eventType) {
        this._ngModelCtrl.$setViewValue(value, eventType);
        // update the other radio buttons as well
        this.render();
      },
      getViewValue: function() {
        return this._ngModelCtrl.$viewValue;
      },
      selectNext: function() {
        return changeSelectedButton(this.$element, 1);
      },
      selectPrevious: function() {
        return changeSelectedButton(this.$element, -1);
      },
      setActiveDescendant: function (radioId) {
        this.$element.attr('aria-activedescendant', radioId);
      }
    };
  }
  /**
   * Change the radio group's selected button by a given increment.
   * If no button is selected, select the first button.
   */
  function changeSelectedButton(parent, increment) {
    // Coerce all child radio buttons into an array, then wrap then in an iterator
    var buttons = $mdUtil.iterator(parent[0].querySelectorAll('md-radio-button'), true);

    if (buttons.count()) {
      var validate = function (button) {
        // If disabled, then NOT valid
        return !angular.element(button).attr("disabled");
      };
      var selected = parent[0].querySelector('md-radio-button.md-checked');
      var target = buttons[increment < 0 ? 'previous' : 'next'](selected, validate) || buttons.first();
      // Activate radioButton's click listener (triggerHandler won't create a real click event)
      angular.element(target).triggerHandler('click');


    }
  }

}
mdRadioGroupDirective.$inject = ["$mdUtil", "$mdConstant", "$mdTheming", "$timeout"];

/**
 * @ngdoc directive
 * @module material.components.radioButton
 * @name mdRadioButton
 *
 * @restrict E
 *
 * @description
 * The `<md-radio-button>`directive is the child directive required to be used within `<md-radio-group>` elements.
 *
 * While similar to the `<input type="radio" ng-model="" value="">` directive,
 * the `<md-radio-button>` directive provides ink effects, ARIA support, and
 * supports use within named radio groups.
 *
 * @param {string} ngModel Assignable angular expression to data-bind to.
 * @param {string=} ngChange Angular expression to be executed when input changes due to user
 *    interaction with the input element.
 * @param {string} ngValue Angular expression which sets the value to which the expression should
 *    be set when selected.*
 * @param {string} value The value to which the expression should be set when selected.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {string=} aria-label Adds label to radio button for accessibility.
 * Defaults to radio button's text. If no text content is available, a warning will be logged.
 *
 * @usage
 * <hljs lang="html">
 *
 * <md-radio-button value="1" aria-label="Label 1">
 *   Label 1
 * </md-radio-button>
 *
 * <md-radio-button ng-model="color" ng-value="specialValue" aria-label="Green">
 *   Green
 * </md-radio-button>
 *
 * </hljs>
 *
 */
function mdRadioButtonDirective($mdAria, $mdUtil, $mdTheming) {

  var CHECKED_CSS = 'md-checked';

  return {
    restrict: 'E',
    require: '^mdRadioGroup',
    transclude: true,
    template: '<div class="md-container" md-ink-ripple md-ink-ripple-checkbox>' +
                '<div class="md-off"></div>' +
                '<div class="md-on"></div>' +
              '</div>' +
              '<div ng-transclude class="md-label"></div>',
    link: link
  };

  function link(scope, element, attr, rgCtrl) {
    var lastChecked;

    $mdTheming(element);
    configureAria(element, scope);

    rgCtrl.add(render);
    attr.$observe('value', render);

    element
      .on('click', listener)
      .on('$destroy', function() {
        rgCtrl.remove(render);
      });

    function listener(ev) {
      if (element[0].hasAttribute('disabled')) return;

      scope.$apply(function() {
        rgCtrl.setViewValue(attr.value, ev && ev.type);
      });
    }

    function render() {
      var checked = (rgCtrl.getViewValue() == attr.value);
      if (checked === lastChecked) {
        return;
      }
      lastChecked = checked;
      element.attr('aria-checked', checked);
      if (checked) {
        element.addClass(CHECKED_CSS);
        rgCtrl.setActiveDescendant(element.attr('id'));
      } else {
        element.removeClass(CHECKED_CSS);
      }
    }
    /**
     * Inject ARIA-specific attributes appropriate for each radio button
     */
    function configureAria( element, scope ){
      scope.ariaId = buildAriaID();

      element.attr({
        'id' :  scope.ariaId,
        'role' : 'radio',
        'aria-checked' : 'false'
      });

      $mdAria.expectWithText(element, 'aria-label');

      /**
       * Build a unique ID for each radio button that will be used with aria-activedescendant.
       * Preserve existing ID if already specified.
       * @returns {*|string}
       */
      function buildAriaID() {
        return attr.id || ( 'radio' + "_" + $mdUtil.nextUid() );
      }
    }
  }
}
mdRadioButtonDirective.$inject = ["$mdAria", "$mdUtil", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.select
 */

/***************************************************

### TODO ###
**DOCUMENTATION AND DEMOS**

- [ ] ng-model with child mdOptions (basic)
- [ ] ng-model="foo" ng-model-options="{ trackBy: '$value.id' }" for objects
- [ ] mdOption with value
- [ ] Usage with input inside

### TODO - POST RC1 ###
- [ ] Abstract placement logic in $mdSelect service to $mdMenu service

***************************************************/

var SELECT_EDGE_MARGIN = 8;
var selectNextId = 0;

angular.module('material.components.select', [
  'material.core',
  'material.components.backdrop'
])
.directive('mdSelect', SelectDirective)
.directive('mdSelectMenu', SelectMenuDirective)
.directive('mdOption', OptionDirective)
.directive('mdOptgroup', OptgroupDirective)
.provider('$mdSelect', SelectProvider);


/**
 * @ngdoc directive
 * @name mdSelect
 * @restrict E
 * @module material.components.select
 *
 * @description Displays a select box, bound to an ng-model.
 *
 * @param {expression} ng-model The model!
 * @param {expression=} md-on-close expression to be evaluated when the select is closed
 * @param {boolean=} multiple Whether it's multiple.
 * @param {string=} placeholder Placeholder hint text.
 * @param {string=} aria-label Optional label for accessibility. Only necessary if no placeholder or
 * explicit label is present.
 *
 * @usage
 * With a placeholder (label and aria-label are added dynamically)
 * <hljs lang="html">
 *   <md-select
 *     ng-model="someModel"
 *     placeholder="Select a state">
 *     <md-option ng-value="opt" ng-repeat="opt in neighborhoods2">{{ opt }}</md-option>
 *   </md-select>
 * </hljs>
 *
 * With an explicit label
 * <hljs lang="html">
 *   <md-select
 *     ng-model="someModel">
 *     <md-select-label>Select a state</md-select-label>
 *     <md-option ng-value="opt" ng-repeat="opt in neighborhoods2">{{ opt }}</md-option>
 *   </md-select>
 * </hljs>
 */
function SelectDirective($mdSelect, $mdUtil, $mdTheming, $mdAria, $interpolate, $compile, $parse) {
  return {
    restrict: 'E',
    require: ['mdSelect', 'ngModel', '?^form'],
    compile: compile,
    controller: function() { } // empty placeholder controller to be initialized in link
  };

  function compile(element, attr) {
    // The user is allowed to provide a label for the select as md-select-label child
    var labelEl = element.find('md-select-label').remove();

    // If not provided, we automatically make one
    if (!labelEl.length) {
      labelEl = angular.element('<md-select-label><span></span></md-select-label>');
    } else {
      if (!labelEl[0].firstElementChild) {
        var spanWrapper = angular.element('<span>');
        spanWrapper.append(labelEl.contents());
        labelEl.append(spanWrapper);
      }
    }
    labelEl.append('<span class="md-select-icon" aria-hidden="true"></span>');
    labelEl.addClass('md-select-label');
    if (!labelEl[0].hasAttribute('id')) {
      labelEl.attr('id', 'select_label_' + $mdUtil.nextUid());
    }

    // There's got to be an md-content inside. If there's not one, let's add it.
    if (!element.find('md-content').length) {
      element.append( angular.element('<md-content>').append(element.contents()) );
    }

    // Add progress spinner for md-options-loading
    if (attr.mdOnOpen) {
      element.find('md-content').prepend(
        angular.element('<md-progress-circular>')
               .attr('md-mode', 'indeterminate')
               .attr('ng-hide', '$$loadingAsyncDone')
               .wrap('<div>')
               .parent()
      );
    }

    if (attr.name) {
      var autofillClone = angular.element('<select class="md-visually-hidden">');
      autofillClone.attr({
        'name': '.' + attr.name,
        'ng-model': attr.ngModel,
        'aria-hidden': 'true',
        'tabindex': '-1'
      });
      var opts = element.find('md-option');
      angular.forEach(opts, function(el) {
        var newEl = angular.element('<option>' + el.innerHTML + '</option>');
        if (el.hasAttribute('ng-value')) newEl.attr('ng-value', el.getAttribute('ng-value'));
        else if (el.hasAttribute('value')) newEl.attr('value', el.getAttribute('value'));
        autofillClone.append(newEl);
      });

      element.parent().append(autofillClone);
    }

    // Use everything that's left inside element.contents() as the contents of the menu
    var selectTemplate = '<div class="md-select-menu-container">' +
        '<md-select-menu ' +
        (angular.isDefined(attr.multiple) ? 'multiple' : '') + '>' +
          element.html() +
        '</md-select-menu></div>';

    element.empty().append(labelEl);

    attr.tabindex = attr.tabindex || '0';

    return function postLink(scope, element, attr, ctrls) {
      var isOpen;
      var isDisabled;

      var mdSelectCtrl = ctrls[0];
      var ngModel = ctrls[1];
      var formCtrl = ctrls[2];

      var labelEl = element.find('md-select-label');
      var customLabel = labelEl.text().length !== 0;
      var selectContainer, selectScope, selectMenuCtrl;
      createSelect();

      $mdTheming(element);

      if (attr.name && formCtrl) {
        var selectEl = element.parent()[0].querySelector('select[name=".' + attr.name + '"]');
        formCtrl.$removeControl(angular.element(selectEl).controller());
      }

      var originalRender = ngModel.$render;
      ngModel.$render = function() {
        originalRender();
        syncLabelText();
      };

      mdSelectCtrl.setLabelText = function(text) {
        if (customLabel) return; // Assume that user is handling it on their own
        mdSelectCtrl.setIsPlaceholder(!text);
        text = text || attr.placeholder || '';
        var target = customLabel ? labelEl : labelEl.children().eq(0);
        target.text(text);
      };

      mdSelectCtrl.setIsPlaceholder = function(val) {
        val ? labelEl.addClass('md-placeholder') : labelEl.removeClass('md-placeholder');
      };

      mdSelectCtrl.triggerClose = function() {
        $parse(attr.mdOnClose)(scope);
      };

      scope.$$postDigest(function() {
        setAriaLabel();
        syncLabelText();
      });

      function setAriaLabel() {
        var labelText = element.attr('placeholder');
        if (!labelText) {
          labelText = element.find('md-select-label').text();
        }
        $mdAria.expect(element, 'aria-label', labelText);
      }

      function syncLabelText() {
        if (selectContainer) {
          selectMenuCtrl = selectMenuCtrl || selectContainer.find('md-select-menu').controller('mdSelectMenu');
          mdSelectCtrl.setLabelText(selectMenuCtrl.selectedLabels());
        }
      }

      var deregisterWatcher;
      attr.$observe('ngMultiple', function(val) {
        if (deregisterWatcher) deregisterWatcher();
        var parser = $parse(val);
        deregisterWatcher = scope.$watch(function() { return parser(scope); }, function(multiple, prevVal) {
          if (multiple === undefined && prevVal === undefined) return; // assume compiler did a good job
          if (multiple) {
            element.attr('multiple', 'multiple');
          } else {
            element.removeAttr('multiple');
          }
          if (selectContainer) {
            selectMenuCtrl.setMultiple(multiple);
            originalRender = ngModel.$render;
            ngModel.$render = function() {
              originalRender();
              syncLabelText();
            };
            selectMenuCtrl.refreshViewValue();
            ngModel.$render();
          }
        });
      });

      attr.$observe('disabled', function(disabled) {
        if (typeof disabled == "string") {
          disabled = true;
        }
        // Prevent click event being registered twice
        if (isDisabled !== undefined && isDisabled === disabled) {
          return;
        }
        isDisabled = disabled;
        if (disabled) {
          element.attr({'tabindex': -1, 'aria-disabled': 'true'});
          element.off('click', openSelect);
          element.off('keydown', handleKeypress);
        } else {
          element.attr({'tabindex': attr.tabindex, 'aria-disabled': 'false'});
          element.on('click', openSelect);
          element.on('keydown', handleKeypress);
        }
      });

      if (!attr.disabled && !attr.ngDisabled) {
        element.attr({'tabindex': attr.tabindex, 'aria-disabled': 'false'});
        element.on('click', openSelect);
        element.on('keydown', handleKeypress);
      }

      var ariaAttrs = {
        role: 'combobox',
        'aria-expanded': 'false'
      };
      if (!element[0].hasAttribute('id')) {
        ariaAttrs.id = 'select_' + $mdUtil.nextUid();
      }
      element.attr(ariaAttrs);

      scope.$on('$destroy', function() {
        if (isOpen) {
          $mdSelect.cancel().then(function() {
            selectContainer.remove();
          });
        } else {
          selectContainer.remove();
        }
      });


      // Create a fake select to find out the label value
      function createSelect() {
        selectContainer = angular.element(selectTemplate);
        var selectEl = selectContainer.find('md-select-menu');
        selectEl.data('$ngModelController', ngModel);
        selectEl.data('$mdSelectController', mdSelectCtrl);
        selectScope = scope.$new();
        selectContainer = $compile(selectContainer)(selectScope);
        selectMenuCtrl = selectContainer.find('md-select-menu').controller('mdSelectMenu');
      }

      function handleKeypress(e) {
        var allowedCodes = [32, 13, 38, 40];
        if (allowedCodes.indexOf(e.keyCode) != -1 ) {
          // prevent page scrolling on interaction
          e.preventDefault();
          openSelect(e);
        } else {
          if (e.keyCode <= 90 && e.keyCode >= 31) {
            e.preventDefault();
            var node = selectMenuCtrl.optNodeForKeyboardSearch(e);
            if (!node) return;
            var optionCtrl = angular.element(node).controller('mdOption');
            if (!selectMenuCtrl.isMultiple) {
              selectMenuCtrl.deselect( Object.keys(selectMenuCtrl.selected)[0] );
            }
            selectMenuCtrl.select(optionCtrl.hashKey, optionCtrl.value);
            selectMenuCtrl.refreshViewValue();
            ngModel.$render();
          }
        }
      }

      function openSelect() {
        scope.$evalAsync(function() {
          isOpen = true;
          $mdSelect.show({
            scope: selectScope,
            preserveScope: true,
            skipCompile: true,
            element: selectContainer,
            target: element[0],
            hasBackdrop: true,
            loadingAsync: attr.mdOnOpen ? scope.$eval(attr.mdOnOpen) || true : false,
          }).then(function(selectedText) {
            isOpen = false;
          });
        });
      }
    };
  }
}
SelectDirective.$inject = ["$mdSelect", "$mdUtil", "$mdTheming", "$mdAria", "$interpolate", "$compile", "$parse"];

function SelectMenuDirective($parse, $mdUtil, $mdTheming) {

  SelectMenuController.$inject = ["$scope", "$attrs", "$element"];
  return {
    restrict: 'E',
    require: ['mdSelectMenu', '?ngModel'],
    controller: SelectMenuController,
    link: { pre: preLink }
  };

  // We use preLink instead of postLink to ensure that the select is initialized before
  // its child options run postLink.
  function preLink(scope, element, attr, ctrls) {
    var selectCtrl = ctrls[0];
    var ngModel = ctrls[1];

    $mdTheming(element);
    element.on('click', clickListener);
    element.on('keypress', keyListener);
    if (ngModel) selectCtrl.init(ngModel);
    configureAria();

    function configureAria() {
      element.attr({
        'id': 'select_menu_' + $mdUtil.nextUid(),
        'role': 'listbox',
        'aria-multiselectable': (selectCtrl.isMultiple ? 'true' : 'false')
      });
    }

    function keyListener(e) {
      if (e.keyCode == 13 || e.keyCode == 32) {
        clickListener(e);
      }
    }

    function clickListener(ev) {
      var option = $mdUtil.getClosest(ev.target, 'md-option');
      var optionCtrl = option && angular.element(option).data('$mdOptionController');
      if (!option || !optionCtrl) return;

      var optionHashKey = selectCtrl.hashGetter(optionCtrl.value);
      var isSelected = angular.isDefined(selectCtrl.selected[optionHashKey]);

      scope.$apply(function() {
        if (selectCtrl.isMultiple) {
          if (isSelected) {
            selectCtrl.deselect(optionHashKey);
          } else {
            selectCtrl.select(optionHashKey, optionCtrl.value);
          }
        } else {
          if (!isSelected) {
            selectCtrl.deselect( Object.keys(selectCtrl.selected)[0] );
            selectCtrl.select( optionHashKey, optionCtrl.value );
          }
        }
        selectCtrl.refreshViewValue();
      });
    }
  }



  function SelectMenuController($scope, $attrs, $element) {
    var self = this;
    self.isMultiple = angular.isDefined($attrs.multiple);
    // selected is an object with keys matching all of the selected options' hashed values
    self.selected = {};
    // options is an object with keys matching every option's hash value,
    // and values matching every option's controller.
    self.options = {};

    $scope.$watch(function() { return self.options; }, function() {
      self.ngModel.$render();
    }, true);

    var deregisterCollectionWatch;
    self.setMultiple = function(isMultiple) {
      var ngModel = self.ngModel;
      self.isMultiple = isMultiple;
      if (deregisterCollectionWatch) deregisterCollectionWatch();

      if (self.isMultiple) {
        ngModel.$validators['md-multiple'] = validateArray;
        ngModel.$render = renderMultiple;

        // watchCollection on the model because by default ngModel only watches the model's
        // reference. This allowed the developer to also push and pop from their array.
        $scope.$watchCollection($attrs.ngModel, function(value) {
          if (validateArray(value)) renderMultiple(value);
        });
      } else {
        delete ngModel.$validators['md-multiple'];
        ngModel.$render = renderSingular;
      }

      function validateArray(modelValue, viewValue) {
        // If a value is truthy but not an array, reject it.
        // If value is undefined/falsy, accept that it's an empty array.
        return angular.isArray(modelValue || viewValue || []);
      }
    };

    var searchStr = '';
    var clearSearchTimeout, optNodes, optText;
    var CLEAR_SEARCH_AFTER = 300;
    self.optNodeForKeyboardSearch = function(e) {
      clearSearchTimeout && clearTimeout(clearSearchTimeout);
      clearSearchTimeout = setTimeout(function() {
        clearSearchTimeout = undefined;
        searchStr = '';
        optText = undefined;
        optNodes = undefined;
      }, CLEAR_SEARCH_AFTER);
      searchStr += String.fromCharCode(e.keyCode);
      var search = new RegExp('^' + searchStr, 'i');
      if (!optNodes) {
        optNodes = $element.find('md-option');
        optText = new Array(optNodes.length);
        angular.forEach(optNodes, function(el, i) {
          optText[i] = el.textContent.trim();
        });
      }
      for (var i = 0; i < optText.length; ++i) {
        if (search.test(optText[i])) {
          return optNodes[i];
        }
      }
    };


    self.init = function(ngModel) {
      self.ngModel = ngModel;

      // Allow users to provide `ng-model="foo" ng-model-options="{trackBy: 'foo.id'}"` so
      // that we can properly compare objects set on the model to the available options
      if (ngModel.$options && ngModel.$options.trackBy) {
        var trackByLocals = {};
        var trackByParsed = $parse(ngModel.$options.trackBy);
        self.hashGetter = function(value, valueScope) {
          trackByLocals.$value = value;
          return trackByParsed(valueScope || $scope, trackByLocals);
        };
      // If the user doesn't provide a trackBy, we automatically generate an id for every
      // value passed in
      } else {
        self.hashGetter = function getHashValue(value) {
          if (angular.isObject(value)) {
            return 'object_' + (value.$$mdSelectId || (value.$$mdSelectId = ++selectNextId));
          }
          return value;
        };
      }
      self.setMultiple(self.isMultiple);
    };

    self.selectedLabels = function() {
      var selectedOptionEls = $mdUtil.nodesToArray($element[0].querySelectorAll('md-option[selected]'));
      if (selectedOptionEls.length) {
        return selectedOptionEls.map(function(el) { return el.textContent; }).join(', ');
      } else {
        return '';
      }
    };

    self.select = function(hashKey, hashedValue) {
      var option = self.options[hashKey];
      option && option.setSelected(true);
      self.selected[hashKey] = hashedValue;
    };
    self.deselect = function(hashKey) {
      var option = self.options[hashKey];
      option && option.setSelected(false);
      delete self.selected[hashKey];
    };

    self.addOption = function(hashKey, optionCtrl) {
      if (angular.isDefined(self.options[hashKey])) {
        throw new Error('Duplicate md-option values are not allowed in a select. ' +
                        'Duplicate value "' + optionCtrl.value + '" found.');
      }
      self.options[hashKey] = optionCtrl;

      // If this option's value was already in our ngModel, go ahead and select it.
      if (angular.isDefined(self.selected[hashKey])) {
        self.select(hashKey, optionCtrl.value);
        self.refreshViewValue();
      }
    };
    self.removeOption = function(hashKey) {
      delete self.options[hashKey];
      // Don't deselect an option when it's removed - the user's ngModel should be allowed
      // to have values that do not match a currently available option.
    };

    self.refreshViewValue = function() {
      var values = [];
      var option;
      for (var hashKey in self.selected) {
         // If this hashKey has an associated option, push that option's value to the model.
         if ((option = self.options[hashKey])) {
           values.push(option.value);
         } else {
           // Otherwise, the given hashKey has no associated option, and we got it
           // from an ngModel value at an earlier time. Push the unhashed value of
           // this hashKey to the model.
           // This allows the developer to put a value in the model that doesn't yet have
           // an associated option.
           values.push(self.selected[hashKey]);
         }
      }
      self.ngModel.$setViewValue(self.isMultiple ? values : values[0]);
    };

    function renderMultiple() {
      var newSelectedValues = self.ngModel.$modelValue || self.ngModel.$viewValue;
      if (!angular.isArray(newSelectedValues)) return;

      var oldSelected = Object.keys(self.selected);

      var newSelectedHashes = newSelectedValues.map(self.hashGetter);
      var deselected = oldSelected.filter(function(hash) {
        return newSelectedHashes.indexOf(hash) === -1;
      });

      deselected.forEach(self.deselect);
      newSelectedHashes.forEach(function(hashKey, i) {
        self.select(hashKey, newSelectedValues[i]);
      });
    }
    function renderSingular() {
      var value = self.ngModel.$viewValue || self.ngModel.$modelValue;
      Object.keys(self.selected).forEach(self.deselect);
      self.select( self.hashGetter(value), value );
    }
  }

}
SelectMenuDirective.$inject = ["$parse", "$mdUtil", "$mdTheming"];

function OptionDirective($mdButtonInkRipple, $mdUtil) {

  OptionController.$inject = ["$element"];
  return {
    restrict: 'E',
    require: ['mdOption', '^^mdSelectMenu'],
    controller: OptionController,
    compile: compile
  };

  function compile(element, attr) {
    // Manual transclusion to avoid the extra inner <span> that ng-transclude generates
    element.append( angular.element('<div class="md-text">').append(element.contents()) );

    element.attr('tabindex', attr.tabindex || '0');
    return postLink;
  }

  function postLink(scope, element, attr, ctrls) {
    var optionCtrl = ctrls[0];
    var selectCtrl = ctrls[1];

    if (angular.isDefined(attr.ngValue)) {
      scope.$watch(attr.ngValue, setOptionValue);
    } else if (angular.isDefined(attr.value)) {
      setOptionValue(attr.value);
    } else {
      scope.$watch(function() { return element.text(); }, setOptionValue);
    }

    scope.$$postDigest(function() {
      attr.$observe('selected', function(selected) {
        if (!angular.isDefined(selected)) return;
        if (selected) {
          if (!selectCtrl.isMultiple) {
            selectCtrl.deselect( Object.keys(selectCtrl.selected)[0] );
          }
          selectCtrl.select(optionCtrl.hashKey, optionCtrl.value);
        } else {
          selectCtrl.deselect(optionCtrl.hashKey);
        }
        selectCtrl.refreshViewValue();
        selectCtrl.ngModel.$render();
      });
    });

    $mdButtonInkRipple.attach(scope, element);
    configureAria();

    function setOptionValue(newValue, oldValue) {
      var oldHashKey = selectCtrl.hashGetter(oldValue, scope);
      var newHashKey = selectCtrl.hashGetter(newValue, scope);

      optionCtrl.hashKey = newHashKey;
      optionCtrl.value = newValue;

      selectCtrl.removeOption(oldHashKey, optionCtrl);
      selectCtrl.addOption(newHashKey, optionCtrl);
    }

    scope.$on('$destroy', function() {
      selectCtrl.removeOption(optionCtrl.hashKey, optionCtrl);
    });

    function configureAria() {
      var ariaAttrs = {
        'role': 'option',
        'aria-selected': 'false'
      };

      if (!element[0].hasAttribute('id')) {
        ariaAttrs.id = 'select_option_' + $mdUtil.nextUid();
      }
      element.attr(ariaAttrs);
    }
  }

  function OptionController($element) {
    this.selected = false;
    this.setSelected = function(isSelected) {
      if (isSelected && !this.selected) {
        $element.attr({
          'selected': 'selected',
          'aria-selected': 'true'
        });
      } else if (!isSelected && this.selected) {
        $element.removeAttr('selected');
        $element.attr('aria-selected', 'false');
      }
      this.selected = isSelected;
    };
  }

}
OptionDirective.$inject = ["$mdButtonInkRipple", "$mdUtil"];

function OptgroupDirective() {
  return {
    restrict: 'E',
    compile: compile
  };
  function compile(el, attrs) {
    var labelElement = el.find('label');
    if (!labelElement.length) {
      labelElement = angular.element('<label>');
      el.prepend(labelElement);
    }
    if (attrs.label) labelElement.text(attrs.label);
  }
}

function SelectProvider($$interimElementProvider) {
  selectDefaultOptions.$inject = ["$mdSelect", "$mdConstant", "$$rAF", "$mdUtil", "$mdTheming", "$timeout", "$window"];
  return $$interimElementProvider('$mdSelect')
    .setDefaults({
      methods: ['target'],
      options: selectDefaultOptions
    });

  /* @ngInject */
  function selectDefaultOptions($mdSelect, $mdConstant, $$rAF, $mdUtil, $mdTheming, $timeout, $window ) {
    return {
      parent: 'body',
      onShow: onShow,
      onRemove: onRemove,
      hasBackdrop: true,
      disableParentScroll: true,
      themable: true
    };

    function onShow(scope, element, opts) {
      if (!opts.target) {
        throw new Error('$mdSelect.show() expected a target element in options.target but got ' +
                        '"' + opts.target + '"!');
      }

      angular.extend(opts, {
        isRemoved: false,
        target: angular.element(opts.target), //make sure it's not a naked dom node
        parent: angular.element(opts.parent),
        selectEl: element.find('md-select-menu'),
        contentEl: element.find('md-content'),
        backdrop: opts.hasBackdrop && angular.element('<md-backdrop class="md-select-backdrop md-click-catcher">')
      });

      opts.resizeFn = function() {
        $$rAF(function() {
          $$rAF(function() {
            animateSelect(scope, element, opts);
          });
        });
      };

      angular.element($window).on('resize', opts.resizeFn);
      angular.element($window).on('orientationchange', opts.resizeFn);


      configureAria();

      element.removeClass('md-leave');

      var optionNodes = opts.selectEl[0].getElementsByTagName('md-option');

      if (opts.loadingAsync && opts.loadingAsync.then) {
        opts.loadingAsync.then(function() {
          scope.$$loadingAsyncDone = true;
          // Give ourselves two frames for the progress loader to clear out.
          $$rAF(function() {
            $$rAF(function() {
              // Don't go forward if the select has been removed in this time...
              if (opts.isRemoved) return;
              animateSelect(scope, element, opts);
            });
          });
        });
      } else if (opts.loadingAsync) {
        scope.$$loadingAsyncDone = true;
      }

      if (opts.disableParentScroll && !$mdUtil.getClosest(opts.target, 'MD-DIALOG')) {
        opts.restoreScroll = $mdUtil.disableScrollAround(opts.element);
      } else {
        opts.disableParentScroll = false;
      }
      // Only activate click listeners after a short time to stop accidental double taps/clicks
      // from clicking the wrong item
      $timeout(activateInteraction, 75, false);

      if (opts.backdrop) {
        $mdTheming.inherit(opts.backdrop, opts.parent);
        opts.parent.append(opts.backdrop);
      }
      opts.parent.append(element);

      // Give the select a frame to 'initialize' in the DOM,
      // so we can read its height/width/position
      $$rAF(function() {
        $$rAF(function() {
          if (opts.isRemoved) return;
          animateSelect(scope, element, opts);
        });
      });

      return $mdUtil.transitionEndPromise(opts.selectEl, {timeout: 350});

      function configureAria() {
        opts.target.attr('aria-expanded', 'true');
      }

      function activateInteraction() {
        if (opts.isRemoved) return;
        var selectCtrl = opts.selectEl.controller('mdSelectMenu') || {};
        element.addClass('md-clickable');

        opts.backdrop && opts.backdrop.on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          opts.restoreFocus = false;
          scope.$apply($mdSelect.cancel);
        });

        // Escape to close
        opts.selectEl.on('keydown', function(ev) {
          switch (ev.keyCode) {
            case $mdConstant.KEY_CODE.SPACE:
            case $mdConstant.KEY_CODE.ENTER:
              var option = $mdUtil.getClosest(ev.target, 'md-option');
              if (option) {
                opts.selectEl.triggerHandler({
                  type: 'click',
                  target: option
                });
                ev.preventDefault();
              }
              break;
            case $mdConstant.KEY_CODE.TAB:
            case $mdConstant.KEY_CODE.ESCAPE:
              ev.preventDefault();
              opts.restoreFocus = true;
              scope.$apply($mdSelect.cancel);
          }
        });

        // Cycling of options, and closing on enter
        opts.selectEl.on('keydown', function(ev) {
          switch (ev.keyCode) {
            case $mdConstant.KEY_CODE.UP_ARROW: return focusPrevOption();
            case $mdConstant.KEY_CODE.DOWN_ARROW: return focusNextOption();
            default:
              if (ev.keyCode >= 31 && ev.keyCode <= 90) {
                var optNode = opts.selectEl.controller('mdSelectMenu').optNodeForKeyboardSearch(ev);
                optNode && optNode.focus();
              }
          }
        });


        function focusOption(direction) {
          var optionsArray = $mdUtil.nodesToArray(optionNodes);
          var index = optionsArray.indexOf(opts.focusedNode);
          if (index === -1) {
            // We lost the previously focused element, reset to first option
            index = 0;
          } else if (direction === 'next' && index < optionsArray.length - 1) {
            index++;
          } else if (direction === 'prev' && index > 0) {
            index--;
          }
          var newOption = opts.focusedNode = optionsArray[index];
          newOption && newOption.focus();
        }
        function focusNextOption() {
          focusOption('next');
        }
        function focusPrevOption() {
          focusOption('prev');
        }

        opts.selectEl.on('click', checkCloseMenu);
        opts.selectEl.on('keydown', function(e) {
          if (e.keyCode == 32 || e.keyCode == 13) {
            checkCloseMenu();
          }
        });

        function checkCloseMenu() {
          if (!selectCtrl.isMultiple) {
            opts.restoreFocus = true;
            scope.$evalAsync(function() {
              $mdSelect.hide(selectCtrl.ngModel.$viewValue);
            });
          }
        }
      }

    }

    function onRemove(scope, element, opts) {
      opts.isRemoved = true;
      element.addClass('md-leave')
        .removeClass('md-clickable');
      opts.target.attr('aria-expanded', 'false');


      angular.element($window).off('resize', opts.resizeFn);
      angular.element($window).off('orientationchange', opts.resizefn);
      opts.resizeFn = undefined;

      var mdSelect = opts.selectEl.controller('mdSelect');
      if (mdSelect) {
        mdSelect.setLabelText(opts.selectEl.controller('mdSelectMenu').selectedLabels());
      }

      return $mdUtil.transitionEndPromise(element, { timeout: 350 }).then(function() {
        element.removeClass('md-active');
        opts.backdrop && opts.backdrop.remove();
        if (element[0].parentNode === opts.parent[0]) {
          opts.parent[0].removeChild(element[0]); // use browser to avoid $destroy event
        }
        if (opts.disableParentScroll) {
          opts.restoreScroll();
        }
        if (opts.restoreFocus) opts.target.focus();
        mdSelect && mdSelect.triggerClose();
      });
    }

    function animateSelect(scope, element, opts) {
      var containerNode = element[0],
          targetNode = opts.target[0].firstElementChild.firstElementChild, // target the first span, functioning as the label
          parentNode = opts.parent[0],
          selectNode = opts.selectEl[0],
          contentNode = opts.contentEl[0],
          parentRect = parentNode.getBoundingClientRect(),
          targetRect = targetNode.getBoundingClientRect(),
          shouldOpenAroundTarget = false,
          bounds = {
            left: parentRect.left + SELECT_EDGE_MARGIN,
            top: SELECT_EDGE_MARGIN,
            bottom: parentRect.height - SELECT_EDGE_MARGIN,
            right: parentRect.width - SELECT_EDGE_MARGIN - ($mdUtil.floatingScrollbars() ? 16 : 0)
          },
          spaceAvailable = {
            top: targetRect.top - bounds.top,
            left: targetRect.left - bounds.left,
            right: bounds.right - (targetRect.left + targetRect.width),
            bottom: bounds.bottom - (targetRect.top + targetRect.height)
          },
          maxWidth = parentRect.width - SELECT_EDGE_MARGIN * 2,
          isScrollable = contentNode.scrollHeight > contentNode.offsetHeight,
          selectedNode = selectNode.querySelector('md-option[selected]'),
          optionNodes = selectNode.getElementsByTagName('md-option'),
          optgroupNodes = selectNode.getElementsByTagName('md-optgroup');


      var centeredNode;
      // If a selected node, center around that
      if (selectedNode) {
        centeredNode = selectedNode;
      // If there are option groups, center around the first option group
      } else if (optgroupNodes.length) {
        centeredNode = optgroupNodes[0];
      // Otherwise, center around the first optionNode
      } else if (optionNodes.length){
        centeredNode = optionNodes[0];
      // In case there are no options, center on whatever's in there... (eg progress indicator)
      } else {
        centeredNode = contentNode.firstElementChild || contentNode;
      }

      if (contentNode.offsetWidth > maxWidth) {
        contentNode.style['max-width'] = maxWidth + 'px';
      }
      if (shouldOpenAroundTarget) {
        contentNode.style['min-width'] = targetRect.width + 'px';
      }

      // Remove padding before we compute the position of the menu
      if (isScrollable) {
        selectNode.classList.add('md-overflow');
      }

      // Get the selectMenuRect *after* max-width is possibly set above
      var selectMenuRect = selectNode.getBoundingClientRect();
      var centeredRect = getOffsetRect(centeredNode);

      if (centeredNode) {
        var centeredStyle = $window.getComputedStyle(centeredNode);
        centeredRect.paddingLeft = parseInt(centeredStyle.paddingLeft, 10) || 0;
        centeredRect.paddingRight = parseInt(centeredStyle.paddingRight, 10) || 0;
      }

      var focusedNode = centeredNode;
      if ((focusedNode.tagName || '').toUpperCase() === 'MD-OPTGROUP') {
        focusedNode = optionNodes[0] || contentNode.firstElementChild || contentNode;
      }

      if (isScrollable) {
        var scrollBuffer = contentNode.offsetHeight / 2;
        contentNode.scrollTop = centeredRect.top + centeredRect.height / 2 - scrollBuffer;

        if (spaceAvailable.top < scrollBuffer) {
          contentNode.scrollTop = Math.min(
            centeredRect.top,
            contentNode.scrollTop + scrollBuffer - spaceAvailable.top
          );
        } else if (spaceAvailable.bottom < scrollBuffer) {
          contentNode.scrollTop = Math.max(
            centeredRect.top + centeredRect.height - selectMenuRect.height,
            contentNode.scrollTop - scrollBuffer + spaceAvailable.bottom
          );
        }
      }

      var left, top, transformOrigin;
      if (shouldOpenAroundTarget) {
        left = targetRect.left;
        top = targetRect.top + targetRect.height;
        transformOrigin = '50% 0';
        if (top + selectMenuRect.height > bounds.bottom) {
          top = targetRect.top - selectMenuRect.height;
          transformOrigin = '50% 100%';
        }
      } else {
        left = targetRect.left + centeredRect.left - centeredRect.paddingLeft;
        top = Math.floor(targetRect.top + targetRect.height / 2 - centeredRect.height / 2 -
          centeredRect.top + contentNode.scrollTop);


        transformOrigin = (centeredRect.left + targetRect.width / 2) + 'px ' +
        (centeredRect.top + centeredRect.height / 2 - contentNode.scrollTop) + 'px 0px';

        containerNode.style.minWidth = targetRect.width + centeredRect.paddingLeft +
          centeredRect.paddingRight + 'px';
      }

      // Keep left and top within the window
      var containerRect = containerNode.getBoundingClientRect();
      containerNode.style.left = clamp(bounds.left, left, bounds.right - containerRect.width) + 'px';
      containerNode.style.top = clamp(bounds.top, top, bounds.bottom - containerRect.height) + 'px';
      selectNode.style[$mdConstant.CSS.TRANSFORM_ORIGIN] = transformOrigin;

      selectNode.style[$mdConstant.CSS.TRANSFORM] = 'scale(' +
        Math.min(targetRect.width / selectMenuRect.width, 1.0) + ',' +
        Math.min(targetRect.height / selectMenuRect.height, 1.0) +
      ')';


      $$rAF(function() {
        element.addClass('md-active');
        selectNode.style[$mdConstant.CSS.TRANSFORM] = '';
        if (focusedNode) {
          opts.focusedNode = focusedNode;
          focusedNode.focus();
        }
      });
    }

  }

  function clamp(min, n, max) {
    return Math.max(min, Math.min(n, max));
  }

  function getOffsetRect(node) {
    return node ? {
      left: node.offsetLeft,
      top: node.offsetTop,
      width: node.offsetWidth,
      height: node.offsetHeight
    } : { left: 0, top: 0, width: 0, height: 0 };
  }
}
SelectProvider.$inject = ["$$interimElementProvider"];


})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.sidenav
 *
 * @description
 * A Sidenav QP component.
 */
angular.module('material.components.sidenav', [
    'material.core',
    'material.components.backdrop'
  ])
  .factory('$mdSidenav', SidenavService )
  .directive('mdSidenav', SidenavDirective)
  .directive('mdSidenavFocus', SidenavFocusDirective)
  .controller('$mdSidenavController', SidenavController);


/**
 * @private
 * @ngdoc service
 * @name $mdSidenav
 * @module material.components.sidenav
 *
 * @description
 * `$mdSidenav` makes it easy to interact with multiple sidenavs
 * in an app.
 *
 * @usage
 * <hljs lang="js">
 * // Async lookup for sidenav instance; will resolve when the instance is available
 * $mdSidenav(componentId).then(function(instance) {
 *   $log.debug( componentId + "is now ready" );
 * });
 * // Async toggle the given sidenav;
 * // when instance is known ready and lazy lookup is not needed.
 * $mdSidenav(componentId)
 *    .toggle()
 *    .then(function(){
 *      $log.debug('toggled');
 *    });
 * // Async open the given sidenav
 * $mdSidenav(componentId)
 *    .open()
 *    .then(function(){
 *      $log.debug('opened');
 *    });
 * // Async close the given sidenav
 * $mdSidenav(componentId)
 *    .close()
 *    .then(function(){
 *      $log.debug('closed');
 *    });
 * // Sync check to see if the specified sidenav is set to be open
 * $mdSidenav(componentId).isOpen();
 * // Sync check to whether given sidenav is locked open
 * // If this is true, the sidenav will be open regardless of close()
 * $mdSidenav(componentId).isLockedOpen();
 * </hljs>
 */
function SidenavService($mdComponentRegistry, $q) {
  return function(handle) {

    // Lookup the controller instance for the specified sidNav instance
    var self;
    var errorMsg = "SideNav '" + handle + "' is not available!";
    var instance = $mdComponentRegistry.get(handle);

    if(!instance) {
      $mdComponentRegistry.notFoundError(handle);
    }

    return self = {
      // -----------------
      // Sync methods
      // -----------------
      isOpen: function() {
        return instance && instance.isOpen();
      },
      isLockedOpen: function() {
        return instance && instance.isLockedOpen();
      },
      // -----------------
      // Async methods
      // -----------------
      toggle: function() {
        return instance ? instance.toggle() : $q.reject(errorMsg);
      },
      open: function() {
        return instance ? instance.open() : $q.reject(errorMsg);
      },
      close: function() {
        return instance ? instance.close() : $q.reject(errorMsg);
      },
      then : function( callbackFn ) {
        var promise = instance ? $q.when(instance) : waitForInstance();
        return promise.then( callbackFn || angular.noop );
      }
    };

    /**
     * Deferred lookup of component instance using $component registry
     */
    function waitForInstance() {
      return $mdComponentRegistry
                .when(handle)
                .then(function( it ){
                  instance = it;
                  return it;
                });
    }
  };
}
SidenavService.$inject = ["$mdComponentRegistry", "$q"];
/**
 * @ngdoc directive
 * @name mdSidenavFocus
 * @module material.components.sidenav
 *
 * @restrict A
 *
 * @description
 * `$mdSidenavFocus` provides a way to specify the focused element when a sidenav opens.
 * This is completely optional, as the sidenav itself is focused by default.
 *
 * @usage
 * <hljs lang="html">
 * <md-sidenav>
 *   <form>
 *     <md-input-container>
 *       <label for="testInput">Label</label>
 *       <input id="testInput" type="text" md-sidenav-focus>
 *     </md-input-container>
 *   </form>
 * </md-sidenav>
 * </hljs>
 **/
function SidenavFocusDirective() {
  return {
    restrict: 'A',
    require: '^mdSidenav',
    link: function(scope, element, attr, sidenavCtrl) {
      sidenavCtrl.focusElement(element);
    }
  };
}
/**
 * @ngdoc directive
 * @name mdSidenav
 * @module material.components.sidenav
 * @restrict E
 *
 * @description
 *
 * A Sidenav component that can be opened and closed programatically.
 *
 * By default, upon opening it will slide out on top of the main content area.
 *
 * For keyboard and screen reader accessibility, focus is sent to the sidenav wrapper by default.
 * It can be overridden with the `md-sidenav-focus` directive on the child element you want focused.
 *
 * @usage
 * <hljs lang="html">
 * <div layout="row" ng-controller="MyController">
 *   <md-sidenav md-component-id="left" class="md-sidenav-left">
 *     Left Nav!
 *   </md-sidenav>
 *
 *   <md-content>
 *     Center Content
 *     <md-button ng-click="openLeftMenu()">
 *       Open Left Menu
 *     </md-button>
 *   </md-content>
 *
 *   <md-sidenav md-component-id="right"
 *     md-is-locked-open="$mdMedia('min-width: 333px')"
 *     class="md-sidenav-right">
 *     <form>
 *       <md-input-container>
 *         <label for="testInput">Test input</label>
 *         <input id="testInput" type="text"
 *                ng-model="data" md-sidenav-focus>
 *       </md-input-container>
 *     </form>
 *   </md-sidenav>
 * </div>
 * </hljs>
 *
 * <hljs lang="js">
 * var app = angular.module('myApp', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdSidenav) {
 *   $scope.openLeftMenu = function() {
 *     $mdSidenav('left').toggle();
 *   };
 * });
 * </hljs>
 *
 * @param {expression=} md-is-open A model bound to whether the sidenav is opened.
 * @param {string=} md-component-id componentId to use with $mdSidenav service.
 * @param {expression=} md-is-locked-open When this expression evalutes to true,
 * the sidenav 'locks open': it falls into the content's flow instead
 * of appearing over it. This overrides the `is-open` attribute.
 *
 * The $mdMedia() service is exposed to the is-locked-open attribute, which
 * can be given a media query or one of the `sm`, `gt-sm`, `md`, `gt-md`, `lg` or `gt-lg` presets.
 * Examples:
 *
 *   - `<md-sidenav md-is-locked-open="shouldLockOpen"></md-sidenav>`
 *   - `<md-sidenav md-is-locked-open="$mdMedia('min-width: 1000px')"></md-sidenav>`
 *   - `<md-sidenav md-is-locked-open="$mdMedia('sm')"></md-sidenav>` (locks open on small screens)
 */
function SidenavDirective($timeout, $animate, $parse, $log, $mdMedia, $mdConstant, $compile, $mdTheming, $q, $document) {
  return {
    restrict: 'E',
    scope: {
      isOpen: '=?mdIsOpen'
    },
    controller: '$mdSidenavController',
    compile: function(element) {
      element.addClass('md-closed');
      element.attr('tabIndex', '-1');
      return postLink;
    }
  };

  /**
   * Directive Post Link function...
   */
  function postLink(scope, element, attr, sidenavCtrl) {
    var lastParentOverFlow;
    var triggeringElement = null;
    var promise = $q.when(true);

    var isLockedOpenParsed = $parse(attr.mdIsLockedOpen);
    var isLocked = function() {
      return isLockedOpenParsed(scope.$parent, {
        $media: function(arg) {
          $log.warn("$media is deprecated for is-locked-open. Use $mdMedia instead.");
          return $mdMedia(arg);
        },
        $mdMedia: $mdMedia
      });
    };
    var backdrop = $compile(
      '<md-backdrop class="md-sidenav-backdrop md-opaque ng-enter">'
    )(scope);

    element.on('$destroy', sidenavCtrl.destroy);
    $mdTheming.inherit(backdrop, element);

    scope.$watch(isLocked, updateIsLocked);
    scope.$watch('isOpen', updateIsOpen);


    // Publish special accessor for the Controller instance
    sidenavCtrl.$toggleOpen = toggleOpen;
    sidenavCtrl.focusElement( sidenavCtrl.focusElement() || element );

    /**
     * Toggle the DOM classes to indicate `locked`
     * @param isLocked
     */
    function updateIsLocked(isLocked, oldValue) {
      scope.isLockedOpen = isLocked;
      if (isLocked === oldValue) {
        element.toggleClass('md-locked-open', !!isLocked);
      } else {
        $animate[isLocked ? 'addClass' : 'removeClass'](element, 'md-locked-open');
      }
      backdrop.toggleClass('md-locked-open', !!isLocked);
    }

    /**
     * Toggle the SideNav view and attach/detach listeners
     * @param isOpen
     */
    function updateIsOpen(isOpen) {
      var parent = element.parent();

      parent[isOpen ? 'on' : 'off']('keydown', onKeyDown);
      backdrop[isOpen ? 'on' : 'off']('click', close);

      if ( isOpen ) {
        // Capture upon opening..
        triggeringElement = $document[0].activeElement;
      }
      var focusEl = sidenavCtrl.focusElement();

      disableParentScroll(isOpen);

      return promise = $q.all([
                isOpen ? $animate.enter(backdrop, parent) : $animate.leave(backdrop),
                $animate[isOpen ? 'removeClass' : 'addClass'](element, 'md-closed')
              ])
              .then(function() {
                // Perform focus when animations are ALL done...
                if (scope.isOpen) {
                  focusEl && focusEl.focus();
                }
              });
    }

    /**
     * Prevent parent scrolling (when the SideNav is open)
     */
    function disableParentScroll(disabled) {
      var parent = element.parent();
      if ( disabled ) {
        lastParentOverFlow = parent.css('overflow');
        parent.css('overflow', 'hidden');
      } else if (angular.isDefined(lastParentOverFlow)) {
        parent.css('overflow', lastParentOverFlow);
        lastParentOverFlow = undefined;
      }
    }

    /**
     * Toggle the sideNav view and publish a promise to be resolved when
     * the view animation finishes.
     *
     * @param isOpen
     * @returns {*}
     */
    function toggleOpen( isOpen ) {
      if (scope.isOpen == isOpen ) {

        return $q.when(true);

      } else {
        var deferred = $q.defer();

        // Toggle value to force an async `updateIsOpen()` to run
        scope.isOpen = isOpen;

        $timeout(function() {

          // When the current `updateIsOpen()` animation finishes
          promise.then(function(result) {

            if ( !scope.isOpen ) {
              // reset focus to originating element (if available) upon close
              triggeringElement && triggeringElement.focus();
              triggeringElement = null;
            }

            deferred.resolve(result);
          });

        },0,false);

        return deferred.promise;
      }
    }

    /**
     * Auto-close sideNav when the `escape` key is pressed.
     * @param evt
     */
    function onKeyDown(ev) {
      var isEscape = (ev.keyCode === $mdConstant.KEY_CODE.ESCAPE);
      return isEscape ? close(ev) : $q.when(true);
    }

    /**
     * With backdrop `clicks` or `escape` key-press, immediately
     * apply the CSS close transition... Then notify the controller
     * to close() and perform its own actions.
     */
    function close(ev) {
      ev.preventDefault();
      ev.stopPropagation();

      return sidenavCtrl.close();
    }

  }
}
SidenavDirective.$inject = ["$timeout", "$animate", "$parse", "$log", "$mdMedia", "$mdConstant", "$compile", "$mdTheming", "$q", "$document"];

/*
 * @private
 * @ngdoc controller
 * @name SidenavController
 * @module material.components.sidenav
 *
 */
function SidenavController($scope, $element, $attrs, $mdComponentRegistry, $q) {

  var self = this,
      focusElement;

  // Use Default internal method until overridden by directive postLink

  // Synchronous getters
  self.isOpen = function() { return !!$scope.isOpen; };
  self.isLockedOpen = function() { return !!$scope.isLockedOpen; };

  // Async actions
  self.open   = function() { return self.$toggleOpen( true );  };
  self.close  = function() { return self.$toggleOpen( false ); };
  self.toggle = function() { return self.$toggleOpen( !$scope.isOpen );  };
  self.focusElement = function(el) {
    if ( angular.isDefined(el) ) {
      focusElement = el;
    }
    return focusElement;
  };

  self.$toggleOpen = function() { return $q.when($scope.isOpen); };

  self.destroy = $mdComponentRegistry.register(self, $attrs.mdComponentId);
}
SidenavController.$inject = ["$scope", "$element", "$attrs", "$mdComponentRegistry", "$q"];

})();
(function(){
"use strict";

  /**
   * @ngdoc module
   * @name material.components.slider
   */
  angular.module('material.components.slider', [
    'material.core'
  ])
  .directive('mdSlider', SliderDirective);

/**
 * @ngdoc directive
 * @name mdSlider
 * @module material.components.slider
 * @restrict E
 * @description
 * The `<md-slider>` component allows the user to choose from a range of
 * values.
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the slider is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * It has two modes: 'normal' mode, where the user slides between a wide range
 * of values, and 'discrete' mode, where the user slides between only a few
 * select values.
 *
 * To enable discrete mode, add the `md-discrete` attribute to a slider,
 * and use the `step` attribute to change the distance between
 * values the user is allowed to pick.
 *
 * @usage
 * <h4>Normal Mode</h4>
 * <hljs lang="html">
 * <md-slider ng-model="myValue" min="5" max="500">
 * </md-slider>
 * </hljs>
 * <h4>Discrete Mode</h4>
 * <hljs lang="html">
 * <md-slider md-discrete ng-model="myDiscreteValue" step="10" min="10" max="130">
 * </md-slider>
 * </hljs>
 *
 * @param {boolean=} md-discrete Whether to enable discrete mode.
 * @param {number=} step The distance between values the user is allowed to pick. Default 1.
 * @param {number=} min The minimum value the user is allowed to pick. Default 0.
 * @param {number=} max The maximum value the user is allowed to pick. Default 100.
 */
function SliderDirective($$rAF, $window, $mdAria, $mdUtil, $mdConstant, $mdTheming, $mdGesture, $parse) {
  return {
    scope: {},
    require: '?ngModel',
    template:
      '<div class="md-slider-wrapper">\
        <div class="md-track-container">\
          <div class="md-track"></div>\
          <div class="md-track md-track-fill"></div>\
          <div class="md-track-ticks"></div>\
        </div>\
        <div class="md-thumb-container">\
          <div class="md-thumb"></div>\
          <div class="md-focus-thumb"></div>\
          <div class="md-focus-ring"></div>\
          <div class="md-sign">\
            <span class="md-thumb-text"></span>\
          </div>\
          <div class="md-disabled-thumb"></div>\
        </div>\
      </div>',
    compile: compile
  };

  // **********************************************************
  // Private Methods
  // **********************************************************

  function compile (tElement, tAttrs) {
    tElement.attr({
      tabIndex: 0,
      role: 'slider'
    });

    $mdAria.expect(tElement, 'aria-label');

    return postLink;
  }

  function postLink(scope, element, attr, ngModelCtrl) {
    $mdTheming(element);
    ngModelCtrl = ngModelCtrl || {
      // Mock ngModelController if it doesn't exist to give us
      // the minimum functionality needed
      $setViewValue: function(val) {
        this.$viewValue = val;
        this.$viewChangeListeners.forEach(function(cb) { cb(); });
      },
      $parsers: [],
      $formatters: [],
      $viewChangeListeners: []
    };

    var isDisabledParsed = attr.ngDisabled && $parse(attr.ngDisabled);
    var isDisabledGetter = isDisabledParsed ?
      function() { return isDisabledParsed(scope.$parent); } :
      angular.noop;
    var thumb = angular.element(element[0].querySelector('.md-thumb'));
    var thumbText = angular.element(element[0].querySelector('.md-thumb-text'));
    var thumbContainer = thumb.parent();
    var trackContainer = angular.element(element[0].querySelector('.md-track-container'));
    var activeTrack = angular.element(element[0].querySelector('.md-track-fill'));
    var tickContainer = angular.element(element[0].querySelector('.md-track-ticks'));
    var throttledRefreshDimensions = $mdUtil.throttle(refreshSliderDimensions, 5000);

    // Default values, overridable by attrs
    angular.isDefined(attr.min) ? attr.$observe('min', updateMin) : updateMin(0);
    angular.isDefined(attr.max) ? attr.$observe('max', updateMax) : updateMax(100);
    angular.isDefined(attr.step)? attr.$observe('step', updateStep) : updateStep(1);

    // We have to manually stop the $watch on ngDisabled because it exists
    // on the parent scope, and won't be automatically destroyed when
    // the component is destroyed.
    var stopDisabledWatch = angular.noop;
    if (attr.ngDisabled) {
      stopDisabledWatch = scope.$parent.$watch(attr.ngDisabled, updateAriaDisabled);
    }

    $mdGesture.register(element, 'drag');

    element
      .on('keydown', keydownListener)
      .on('$md.pressdown', onPressDown)
      .on('$md.pressup', onPressUp)
      .on('$md.dragstart', onDragStart)
      .on('$md.drag', onDrag)
      .on('$md.dragend', onDragEnd);

    // On resize, recalculate the slider's dimensions and re-render
    function updateAll() {
      refreshSliderDimensions();
      ngModelRender();
      redrawTicks();
    }
    setTimeout(updateAll);

    var debouncedUpdateAll = $$rAF.throttle(updateAll);
    angular.element($window).on('resize', debouncedUpdateAll);

    scope.$on('$destroy', function() {
      angular.element($window).off('resize', debouncedUpdateAll);
      stopDisabledWatch();
    });

    ngModelCtrl.$render = ngModelRender;
    ngModelCtrl.$viewChangeListeners.push(ngModelRender);
    ngModelCtrl.$formatters.push(minMaxValidator);
    ngModelCtrl.$formatters.push(stepValidator);

    /**
     * Attributes
     */
    var min;
    var max;
    var step;
    function updateMin(value) {
      min = parseFloat(value);
      element.attr('aria-valuemin', value);
      updateAll();
    }
    function updateMax(value) {
      max = parseFloat(value);
      element.attr('aria-valuemax', value);
      updateAll();
    }
    function updateStep(value) {
      step = parseFloat(value);
      redrawTicks();
    }
    function updateAriaDisabled(isDisabled) {
      element.attr('aria-disabled', !!isDisabled);
    }

    // Draw the ticks with canvas.
    // The alternative to drawing ticks with canvas is to draw one element for each tick,
    // which could quickly become a performance bottleneck.
    var tickCanvas, tickCtx;
    function redrawTicks() {
      if (!angular.isDefined(attr.mdDiscrete)) return;

      var numSteps = Math.floor( (max - min) / step );
      if (!tickCanvas) {
        var trackTicksStyle = $window.getComputedStyle(tickContainer[0]);
        tickCanvas = angular.element('<canvas style="position:absolute;">');
        tickCtx = tickCanvas[0].getContext('2d');
        tickCtx.fillStyle = trackTicksStyle.backgroundColor || 'black';
        tickContainer.append(tickCanvas);
      }
      var dimensions = getSliderDimensions();
      tickCanvas[0].width = dimensions.width;
      tickCanvas[0].height = dimensions.height;

      var distance;
      for (var i = 0; i <= numSteps; i++) {
        distance = Math.floor(dimensions.width * (i / numSteps));
        tickCtx.fillRect(distance - 1, 0, 2, dimensions.height);
      }
    }


    /**
     * Refreshing Dimensions
     */
    var sliderDimensions = {};
    refreshSliderDimensions();
    function refreshSliderDimensions() {
      sliderDimensions = trackContainer[0].getBoundingClientRect();
    }
    function getSliderDimensions() {
      throttledRefreshDimensions();
      return sliderDimensions;
    }

    /**
     * left/right arrow listener
     */
    function keydownListener(ev) {
      if(element[0].hasAttribute('disabled')) {
        return;
      }

      var changeAmount;
      if (ev.keyCode === $mdConstant.KEY_CODE.LEFT_ARROW) {
        changeAmount = -step;
      } else if (ev.keyCode === $mdConstant.KEY_CODE.RIGHT_ARROW) {
        changeAmount = step;
      }
      if (changeAmount) {
        if (ev.metaKey || ev.ctrlKey || ev.altKey) {
          changeAmount *= 4;
        }
        ev.preventDefault();
        ev.stopPropagation();
        scope.$evalAsync(function() {
          setModelValue(ngModelCtrl.$viewValue + changeAmount);
        });
      }
    }

    /**
     * ngModel setters and validators
     */
    function setModelValue(value) {
      ngModelCtrl.$setViewValue( minMaxValidator(stepValidator(value)) );
    }
    function ngModelRender() {
      if (isNaN(ngModelCtrl.$viewValue)) {
        ngModelCtrl.$viewValue = ngModelCtrl.$modelValue;
      }

      var percent = (ngModelCtrl.$viewValue - min) / (max - min);
      scope.modelValue = ngModelCtrl.$viewValue;
      element.attr('aria-valuenow', ngModelCtrl.$viewValue);
      setSliderPercent(percent);
      thumbText.text( ngModelCtrl.$viewValue );
    }

    function minMaxValidator(value) {
      if (angular.isNumber(value)) {
        return Math.max(min, Math.min(max, value));
      }
    }
    function stepValidator(value) {
      if (angular.isNumber(value)) {
        var formattedValue = (Math.round(value / step) * step);
        // Format to 3 digits after the decimal point - fixes #2015.
        return (Math.round(formattedValue * 1000) / 1000);
      }
    }

    /**
     * @param percent 0-1
     */
    function setSliderPercent(percent) {
      activeTrack.css('width', (percent * 100) + '%');
      thumbContainer.css(
        'left',
        (percent * 100) + '%'
      );
      element.toggleClass('md-min', percent === 0);
    }


    /**
     * Slide listeners
     */
    var isDragging = false;
    var isDiscrete = angular.isDefined(attr.mdDiscrete);

    function onPressDown(ev) {
      if (isDisabledGetter()) return;

      element.addClass('active');
      element[0].focus();
      refreshSliderDimensions();

      var exactVal = percentToValue( positionToPercent( ev.pointer.x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      scope.$apply(function() {
        setModelValue( closestVal );
        setSliderPercent( valueToPercent(closestVal));
      });
    }
    function onPressUp(ev) {
      if (isDisabledGetter()) return;

      element.removeClass('dragging active');

      var exactVal = percentToValue( positionToPercent( ev.pointer.x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      scope.$apply(function() {
        setModelValue(closestVal);
        ngModelRender();
      });
    }
    function onDragStart(ev) {
      if (isDisabledGetter()) return;
      isDragging = true;
      ev.stopPropagation();

      element.addClass('dragging');
      setSliderFromEvent(ev);
    }
    function onDrag(ev) {
      if (!isDragging) return;
      ev.stopPropagation();
      setSliderFromEvent(ev);
    }
    function onDragEnd(ev) {
      if (!isDragging) return;
      ev.stopPropagation();
      isDragging = false;
    }

    function setSliderFromEvent(ev) {
      // While panning discrete, update only the
      // visual positioning but not the model value.
      if ( isDiscrete ) adjustThumbPosition( ev.pointer.x );
      else              doSlide( ev.pointer.x );
    }

    /**
     * Slide the UI by changing the model value
     * @param x
     */
    function doSlide( x ) {
      scope.$evalAsync( function() {
        setModelValue( percentToValue( positionToPercent(x) ));
      });
    }

    /**
     * Slide the UI without changing the model (while dragging/panning)
     * @param x
     */
    function adjustThumbPosition( x ) {
      var exactVal = percentToValue( positionToPercent( x ));
      var closestVal = minMaxValidator( stepValidator(exactVal) );
      setSliderPercent( positionToPercent(x) );
      thumbText.text( closestVal );
    }

    /**
     * Convert horizontal position on slider to percentage value of offset from beginning...
     * @param x
     * @returns {number}
     */
    function positionToPercent( x ) {
      return Math.max(0, Math.min(1, (x - sliderDimensions.left) / (sliderDimensions.width)));
    }

    /**
     * Convert percentage offset on slide to equivalent model value
     * @param percent
     * @returns {*}
     */
    function percentToValue( percent ) {
      return (min + percent * (max - min));
    }

    function valueToPercent( val ) {
      return (val - min)/(max - min);
    }
  }
}
SliderDirective.$inject = ["$$rAF", "$window", "$mdAria", "$mdUtil", "$mdConstant", "$mdTheming", "$mdGesture", "$parse"];

})();
(function(){
"use strict";

/*
 * @ngdoc module
 * @name material.components.sticky
 * @description
 *
 * Sticky effects for md
 */

angular.module('material.components.sticky', [
  'material.core',
  'material.components.content'
])
  .factory('$mdSticky', MdSticky);

/*
 * @ngdoc service
 * @name $mdSticky
 * @module material.components.sticky
 *
 * @description
 * The `$mdSticky`service provides a mixin to make elements sticky.
 *
 * @returns A `$mdSticky` function that takes three arguments:
 *   - `scope`
 *   - `element`: The element that will be 'sticky'
 *   - `elementClone`: A clone of the element, that will be shown
 *     when the user starts scrolling past the original element.
 *     If not provided, it will use the result of `element.clone()`.
 */

function MdSticky($document, $mdConstant, $compile, $$rAF, $mdUtil) {

  var browserStickySupport = checkStickySupport();

  /**
   * Registers an element as sticky, used internally by directives to register themselves
   */
  return function registerStickyElement(scope, element, stickyClone) {
    var contentCtrl = element.controller('mdContent');
    if (!contentCtrl) return;

    if (browserStickySupport) {
      element.css({
        position: browserStickySupport,
        top: 0,
        'z-index': 2
      });
    } else {
      var $$sticky = contentCtrl.$element.data('$$sticky');
      if (!$$sticky) {
        $$sticky = setupSticky(contentCtrl);
        contentCtrl.$element.data('$$sticky', $$sticky);
      }

      var deregister = $$sticky.add(element, stickyClone || element.clone());
      scope.$on('$destroy', deregister);
    }
  };

  function setupSticky(contentCtrl) {
    var contentEl = contentCtrl.$element;

    // Refresh elements is very expensive, so we use the debounced
    // version when possible.
    var debouncedRefreshElements = $$rAF.throttle(refreshElements);

    // setupAugmentedScrollEvents gives us `$scrollstart` and `$scroll`,
    // more reliable than `scroll` on android.
    setupAugmentedScrollEvents(contentEl);
    contentEl.on('$scrollstart', debouncedRefreshElements);
    contentEl.on('$scroll', onScroll);

    var self;
    var stickyBaseoffset = contentEl.prop('offsetTop');
    return self = {
      prev: null,
      current: null, //the currently stickied item
      next: null,
      items: [],
      add: add,
      refreshElements: refreshElements
    };

    /***************
     * Public
     ***************/
    // Add an element and its sticky clone to this content's sticky collection
    function add(element, stickyClone) {
      stickyClone.addClass('md-sticky-clone');
      stickyClone.css('top', stickyBaseoffset + 'px');

      var item = {
        element: element,
        clone: stickyClone
      };
      self.items.push(item);

      contentEl.parent().prepend(item.clone);

      debouncedRefreshElements();

      return function remove() {
        self.items.forEach(function(item, index) {
          if (item.element[0] === element[0]) {
            self.items.splice(index, 1);
            item.clone.remove();
          }
        });
        debouncedRefreshElements();
      };
    }

    function refreshElements() {
      // Sort our collection of elements by their current position in the DOM.
      // We need to do this because our elements' order of being added may not
      // be the same as their order of display.
      self.items.forEach(refreshPosition);
      self.items = self.items.sort(function(a, b) {
        return a.top < b.top ? -1 : 1;
      });

      // Find which item in the list should be active, 
      // based upon the content's current scroll position
      var item;
      var currentScrollTop = contentEl.prop('scrollTop');
      for (var i = self.items.length - 1; i >= 0; i--) {
        if (currentScrollTop > self.items[i].top) {
          item = self.items[i];
          break;
        }
      }
      setCurrentItem(item);
    }


    /***************
     * Private
     ***************/

    // Find the `top` of an item relative to the content element,
    // and also the height.
    function refreshPosition(item) {
      // Find the top of an item by adding to the offsetHeight until we reach the 
      // content element.
      var current = item.element[0];
      item.top = 0;
      item.left = 0;
      while (current && current !== contentEl[0]) {
        item.top += current.offsetTop;
        item.left += current.offsetLeft;
        current = current.offsetParent;
      }
      item.height = item.element.prop('offsetHeight');
      item.clone.css('margin-left', item.left + 'px');
      if ($mdUtil.floatingScrollbars()) {
        item.clone.css('margin-right', '0');
      }
    }


    // As we scroll, push in and select the correct sticky element.
    function onScroll() {
      var scrollTop = contentEl.prop('scrollTop');
      var isScrollingDown = scrollTop > (onScroll.prevScrollTop || 0);
      onScroll.prevScrollTop = scrollTop;

      // At the top?
      if (scrollTop === 0) {
        setCurrentItem(null);

      // Going to next item?
      } else if (isScrollingDown && self.next) {
        if (self.next.top - scrollTop <= 0) {
          // Sticky the next item if we've scrolled past its position.
          setCurrentItem(self.next);
        } else if (self.current) {
          // Push the current item up when we're almost at the next item.
          if (self.next.top - scrollTop <= self.next.height) {
            translate(self.current, self.next.top - self.next.height - scrollTop);
          } else {
            translate(self.current, null);
          }
        }
        
      // Scrolling up with a current sticky item?
      } else if (!isScrollingDown && self.current) {
        if (scrollTop < self.current.top) {
          // Sticky the previous item if we've scrolled up past
          // the original position of the currently stickied item.
          setCurrentItem(self.prev);
        }
        // Scrolling up, and just bumping into the item above (just set to current)?
        // If we have a next item bumping into the current item, translate
        // the current item up from the top as it scrolls into view.
        if (self.current && self.next) {
          if (scrollTop >= self.next.top - self.current.height) {
            translate(self.current, self.next.top - scrollTop - self.current.height);
          } else {
            translate(self.current, null);
          }
        }
      }
    }
     
   function setCurrentItem(item) {
     if (self.current === item) return;
     // Deactivate currently active item
     if (self.current) {
       translate(self.current, null);
       setStickyState(self.current, null);
     }

     // Activate new item if given
     if (item) {
       setStickyState(item, 'active');
     }

     self.current = item;
     var index = self.items.indexOf(item);
     // If index === -1, index + 1 = 0. It works out.
     self.next = self.items[index + 1];
     self.prev = self.items[index - 1];
     setStickyState(self.next, 'next');
     setStickyState(self.prev, 'prev');
   }

   function setStickyState(item, state) {
     if (!item || item.state === state) return;
     if (item.state) {
       item.clone.attr('sticky-prev-state', item.state);
       item.element.attr('sticky-prev-state', item.state);
     }
     item.clone.attr('sticky-state', state);
     item.element.attr('sticky-state', state);
     item.state = state;
   }

   function translate(item, amount) {
     if (!item) return;
     if (amount === null || amount === undefined) {
       if (item.translateY) {
         item.translateY = null;
         item.clone.css($mdConstant.CSS.TRANSFORM, '');
       }
     } else {
       item.translateY = amount;
       item.clone.css(
         $mdConstant.CSS.TRANSFORM, 
         'translate3d(' + item.left + 'px,' + amount + 'px,0)'
       );
     }
   }
  }

  // Function to check for browser sticky support
  function checkStickySupport($el) {
    var stickyProp;
    var testEl = angular.element('<div>');
    $document[0].body.appendChild(testEl[0]);

    var stickyProps = ['sticky', '-webkit-sticky'];
    for (var i = 0; i < stickyProps.length; ++i) {
      testEl.css({position: stickyProps[i], top: 0, 'z-index': 2});
      if (testEl.css('position') == stickyProps[i]) {
        stickyProp = stickyProps[i];
        break;
      }
    }
    testEl.remove();
    return stickyProp;
  }

  // Android 4.4 don't accurately give scroll events.
  // To fix this problem, we setup a fake scroll event. We say:
  // > If a scroll or touchmove event has happened in the last DELAY milliseconds, 
  //   then send a `$scroll` event every animationFrame.
  // Additionally, we add $scrollstart and $scrollend events.
  function setupAugmentedScrollEvents(element) {
    var SCROLL_END_DELAY = 200;
    var isScrolling;
    var lastScrollTime;
    element.on('scroll touchmove', function() {
      if (!isScrolling) {
        isScrolling = true;
        $$rAF(loopScrollEvent);
        element.triggerHandler('$scrollstart');
      }
      element.triggerHandler('$scroll');
      lastScrollTime = +$mdUtil.now();
    });

    function loopScrollEvent() {
      if (+$mdUtil.now() - lastScrollTime > SCROLL_END_DELAY) {
        isScrolling = false;
        element.triggerHandler('$scrollend');
      } else {
        element.triggerHandler('$scroll');
        $$rAF(loopScrollEvent);
      }
    }
  }

}
MdSticky.$inject = ["$document", "$mdConstant", "$compile", "$$rAF", "$mdUtil"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.subheader
 * @description
 * SubHeader module
 *
 *  Subheaders are special list tiles that delineate distinct sections of a
 *  list or grid list and are typically related to the current filtering or
 *  sorting criteria. Subheader tiles are either displayed inline with tiles or
 *  can be associated with content, for example, in an adjacent column.
 *
 *  Upon scrolling, subheaders remain pinned to the top of the screen and remain
 *  pinned until pushed on or off screen by the next subheader. @see [Material
 *  Design Specifications](https://www.google.com/design/spec/components/subheaders.html)
 *
 *  > To improve the visual grouping of content, use the system color for your subheaders.
 *
 */
angular.module('material.components.subheader', [
  'material.core',
  'material.components.sticky'
])
  .directive('mdSubheader', MdSubheaderDirective);

/**
 * @ngdoc directive
 * @name mdSubheader
 * @module material.components.subheader
 *
 * @restrict E
 *
 * @description
 * The `<md-subheader>` directive is a subheader for a section. By default it is sticky.
 * You can make it not sticky by applying the `md-no-sticky` class to the subheader.
 *
 *
 * @usage
 * <hljs lang="html">
 * <md-subheader>Online Friends</md-subheader>
 * </hljs>
 */

function MdSubheaderDirective($mdSticky, $compile, $mdTheming) {
  return {
    restrict: 'E',
    replace: true,
    transclude: true,
    template: 
      '<h2 class="md-subheader">' +
        '<div class="md-subheader-inner">' +
          '<span class="md-subheader-content"></span>' +
        '</div>' +
      '</h2>',
    compile: function(element, attr, transclude) {
      return function postLink(scope, element, attr) {
        $mdTheming(element);
        var outerHTML = element[0].outerHTML;

        function getContent(el) {
          return angular.element(el[0].querySelector('.md-subheader-content'));
        }

        // Transclude the user-given contents of the subheader
        // the conventional way.
        transclude(scope, function(clone) {
          getContent(element).append(clone);
        });

        // Create another clone, that uses the outer and inner contents
        // of the element, that will be 'stickied' as the user scrolls.
        if (!element.hasClass('md-no-sticky')) {
          transclude(scope, function(clone) {
            var stickyClone = $compile(angular.element(outerHTML))(scope);
            getContent(stickyClone).append(clone);
            $mdSticky(scope, element, stickyClone);
          });
        }
      };
    }
  };
}
MdSubheaderDirective.$inject = ["$mdSticky", "$compile", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.swipe
 * @description Swipe module!
 */
/**
 * @ngdoc directive
 * @module material.components.swipe
 * @name mdSwipeLeft
 *
 * @restrict A
 *
 * @description
 * The md-swipe-left directives allows you to specify custom behavior when an element is swiped
 * left.
 *
 * @usage
 * <hljs lang="html">
 * <div md-swipe-left="onSwipeLeft()">Swipe me left!</div>
 * </hljs>
 */
/**
 * @ngdoc directive
 * @module material.components.swipe
 * @name mdSwipeRight
 *
 * @restrict A
 *
 * @description
 * The md-swipe-right directives allows you to specify custom behavior when an element is swiped
 * right.
 *
 * @usage
 * <hljs lang="html">
 * <div md-swipe-right="onSwipeRight()">Swipe me right!</div>
 * </hljs>
 */

angular.module('material.components.swipe', ['material.core'])
    .directive('mdSwipeLeft', getDirective('SwipeLeft'))
    .directive('mdSwipeRight', getDirective('SwipeRight'));

function getDirective(name) {
  var directiveName = 'md' + name;
  var eventName = '$md.' + name.toLowerCase();

    DirectiveFactory.$inject = ["$parse"];
  return DirectiveFactory;

  /* @ngInject */
  function DirectiveFactory($parse) {
      return { restrict: 'A', link: postLink };
      function postLink(scope, element, attr) {
        var fn = $parse(attr[directiveName]);
        element.on(eventName, function(ev) {
          scope.$apply(function() { fn(scope, { $event: ev }); });
        });
      }
    }
}



})();
(function(){
"use strict";

/**
 * @private
 * @ngdoc module
 * @name material.components.switch
 */

angular.module('material.components.switch', [
  'material.core',
  'material.components.checkbox'
])
  .directive('mdSwitch', MdSwitch);

/**
 * @private
 * @ngdoc directive
 * @module material.components.switch
 * @name mdSwitch
 * @restrict E
 *
 * The switch directive is used very much like the normal [angular checkbox](https://docs.angularjs.org/api/ng/input/input%5Bcheckbox%5D).
 *
 * As per the [material design spec](http://www.google.com/design/spec/style/color.html#color-ui-color-application)
 * the switch is in the accent color by default. The primary color palette may be used with
 * the `md-primary` class.
 *
 * @param {string} ng-model Assignable angular expression to data-bind to.
 * @param {string=} name Property name of the form under which the control is published.
 * @param {expression=} ng-true-value The value to which the expression should be set when selected.
 * @param {expression=} ng-false-value The value to which the expression should be set when not selected.
 * @param {string=} ng-change Angular expression to be executed when input changes due to user interaction with the input element.
 * @param {boolean=} md-no-ink Use of attribute indicates use of ripple ink effects.
 * @param {string=} aria-label Publish the button label used by screen-readers for accessibility. Defaults to the switch's text.
 *
 * @usage
 * <hljs lang="html">
 * <md-switch ng-model="isActive" aria-label="Finished?">
 *   Finished ?
 * </md-switch>
 *
 * <md-switch md-no-ink ng-model="hasInk" aria-label="No Ink Effects">
 *   No Ink Effects
 * </md-switch>
 *
 * <md-switch ng-disabled="true" ng-model="isDisabled" aria-label="Disabled">
 *   Disabled
 * </md-switch>
 *
 * </hljs>
 */
function MdSwitch(mdCheckboxDirective, $mdTheming, $mdUtil, $document, $mdConstant, $parse, $$rAF, $mdGesture) {
  var checkboxDirective = mdCheckboxDirective[0];

  return {
    restrict: 'E',
    priority:210, // Run before ngAria
    transclude: true,
    template:
      '<div class="md-container">' +
        '<div class="md-bar"></div>' +
        '<div class="md-thumb-container">' +
          '<div class="md-thumb" md-ink-ripple md-ink-ripple-checkbox></div>' +
        '</div>'+
      '</div>' +
      '<div ng-transclude class="md-label">' +
      '</div>',
    require: '?ngModel',
    compile: compile
  };

  function compile(element, attr) {
    var checkboxLink = checkboxDirective.compile(element, attr);
    // no transition on initial load
    element.addClass('md-dragging');

    return function (scope, element, attr, ngModel) {
      ngModel = ngModel || $mdUtil.fakeNgModel();
      var disabledGetter = $parse(attr.ngDisabled);
      var thumbContainer = angular.element(element[0].querySelector('.md-thumb-container'));
      var switchContainer = angular.element(element[0].querySelector('.md-container'));

      // no transition on initial load
      $$rAF(function() {
        element.removeClass('md-dragging');
      });

      checkboxLink(scope, element, attr, ngModel);

      if (angular.isDefined(attr.ngDisabled)) {
        scope.$watch(disabledGetter, function(isDisabled) {
          element.attr('tabindex', isDisabled ? -1 : 0);
        });
      }

      // These events are triggered by setup drag
      $mdGesture.register(switchContainer, 'drag');
      switchContainer
        .on('$md.dragstart', onDragStart)
        .on('$md.drag', onDrag)
        .on('$md.dragend', onDragEnd);

      var drag;
      function onDragStart(ev) {
        // Don't go if ng-disabled===true
        if (disabledGetter(scope)) return;
        ev.stopPropagation();

        element.addClass('md-dragging');
        drag = {
          width: thumbContainer.prop('offsetWidth')
        };
        element.removeClass('transition');
      }

      function onDrag(ev) {
        if (!drag) return;
        ev.stopPropagation();
        ev.srcEvent && ev.srcEvent.preventDefault();

        var percent = ev.pointer.distanceX / drag.width;

        //if checked, start from right. else, start from left
        var translate = ngModel.$viewValue ?  1 + percent : percent;
        // Make sure the switch stays inside its bounds, 0-1%
        translate = Math.max(0, Math.min(1, translate));

        thumbContainer.css($mdConstant.CSS.TRANSFORM, 'translate3d(' + (100*translate) + '%,0,0)');
        drag.translate = translate;
      }

      function onDragEnd(ev) {
        if (!drag) return;
        ev.stopPropagation();

        element.removeClass('md-dragging');
        thumbContainer.css($mdConstant.CSS.TRANSFORM, '');

        // We changed if there is no distance (this is a click a click),
        // or if the drag distance is >50% of the total.
        var isChanged = ngModel.$viewValue ? drag.translate < 0.5 : drag.translate > 0.5;
        if (isChanged) {
          applyModelValue(!ngModel.$viewValue);
        }
        drag = null;
      }

      function applyModelValue(newValue) {
        scope.$apply(function() {
          ngModel.$setViewValue(newValue);
          ngModel.$render();
        });
      }

    };
  }


}
MdSwitch.$inject = ["mdCheckboxDirective", "$mdTheming", "$mdUtil", "$document", "$mdConstant", "$parse", "$$rAF", "$mdGesture"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.tabs
 * @description
 *
 *  Tabs, created with the `<md-tabs>` directive provide *tabbed* navigation with different styles.
 *  The Tabs component consists of clickable tabs that are aligned horizontally side-by-side.
 *
 *  Features include support for:
 *
 *  - static or dynamic tabs,
 *  - responsive designs,
 *  - accessibility support (ARIA),
 *  - tab pagination,
 *  - external or internal tab content,
 *  - focus indicators and arrow-key navigations,
 *  - programmatic lookup and access to tab controllers, and
 *  - dynamic transitions through different tab contents.
 *
 */
/*
 * @see js folder for tabs implementation
 */
angular.module('material.components.tabs', [
  'material.core',
  'material.components.icon'
]);

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.toast
 * @description
 * Toast
 */
angular.module('material.components.toast', [
  'material.core',
  'material.components.button'
])
  .directive('mdToast', MdToastDirective)
  .provider('$mdToast', MdToastProvider);

function MdToastDirective() {
  return {
    restrict: 'E'
  };
}

/**
 * @ngdoc service
 * @name $mdToast
 * @module material.components.toast
 *
 * @description
 * `$mdToast` is a service to build a toast notification on any position
 * on the screen with an optional duration, and provides a simple promise API.
 *
 *
 * ## Restrictions on custom toasts
 * - The toast's template must have an outer `<md-toast>` element.
 * - For a toast action, use element with class `md-action`.
 * - Add the class `md-capsule` for curved corners.
 *
 * @usage
 * <hljs lang="html">
 * <div ng-controller="MyController">
 *   <md-button ng-click="openToast()">
 *     Open a Toast!
 *   </md-button>
 * </div>
 * </hljs>
 *
 * <hljs lang="js">
 * var app = angular.module('app', ['ngMaterial']);
 * app.controller('MyController', function($scope, $mdToast) {
 *   $scope.openToast = function($event) {
 *     $mdToast.show($mdToast.simple().content('Hello!'));
 *     // Could also do $mdToast.showSimple('Hello');
 *   };
 * });
 * </hljs>
 */

/**
 * @ngdoc method
 * @name $mdToast#showSimple
 * 
 * @description
 * Convenience method which builds and shows a simple toast.
 *
 * @returns {promise} A promise that can be resolved with `$mdToast.hide()` or
 * rejected with `$mdToast.cancel()`.
 *
 */

 /**
 * @ngdoc method
 * @name $mdToast#simple
 *
 * @description
 * Builds a preconfigured toast.
 *
 * @returns {obj} a `$mdToastPreset` with the chainable configuration methods:
 *
 * - $mdToastPreset#content(string) - sets toast content to string
 * - $mdToastPreset#action(string) - adds an action button, which resolves the promise returned from `show()` if clicked.
 * - $mdToastPreset#highlightAction(boolean) - sets action button to be highlighted
 * - $mdToastPreset#capsule(boolean) - adds 'md-capsule' class to the toast (curved corners)
 * - $mdToastPreset#theme(string) - sets the theme on the toast to theme (default is `$mdThemingProvider`'s default theme)
 */

/**
 * @ngdoc method
 * @name $mdToast#updateContent
 * 
 * @description
 * Updates the content of an existing toast. Useful for updating things like counts, etc.
 *
 */

 /**
 * @ngdoc method
 * @name $mdToast#build
 *
 * @description
 * Creates a custom `$mdToastPreset` that you can configure.
 *
 * @returns {obj} a `$mdToastPreset` with the chainable configuration methods for shows' options (see below).
 */

 /**
 * @ngdoc method
 * @name $mdToast#show
 *
 * @description Shows the toast.
 *
 * @param {object} optionsOrPreset Either provide an `$mdToastPreset` returned from `simple()`
 * and `build()`, or an options object with the following properties:
 *
 *   - `templateUrl` - `{string=}`: The url of an html template file that will
 *     be used as the content of the toast. Restrictions: the template must
 *     have an outer `md-toast` element.
 *   - `template` - `{string=}`: Same as templateUrl, except this is an actual
 *     template string.
 *   - `scope` - `{object=}`: the scope to link the template / controller to. If none is specified, it will create a new child scope.
 *     This scope will be destroyed when the toast is removed unless `preserveScope` is set to true.
 *   - `preserveScope` - `{boolean=}`: whether to preserve the scope when the element is removed. Default is false
 *   - `hideDelay` - `{number=}`: How many milliseconds the toast should stay
 *     active before automatically closing.  Set to 0 or false to have the toast stay open until
 *     closed manually. Default: 3000.
 *   - `position` - `{string=}`: Where to place the toast. Available: any combination
 *     of 'bottom', 'left', 'top', 'right', 'fit'. Default: 'bottom left'.
 *   - `controller` - `{string=}`: The controller to associate with this toast.
 *     The controller will be injected the local `$hideToast`, which is a function
 *     used to hide the toast.
 *   - `locals` - `{string=}`: An object containing key/value pairs. The keys will
 *     be used as names of values to inject into the controller. For example,
 *     `locals: {three: 3}` would inject `three` into the controller with the value
 *     of 3.
 *   - `bindToController` - `bool`: bind the locals to the controller, instead of passing them in. These values will not be available until after initialization.
 *   - `resolve` - `{object=}`: Similar to locals, except it takes promises as values
 *     and the toast will not open until the promises resolve.
 *   - `controllerAs` - `{string=}`: An alias to assign the controller to on the scope.
 *   - `parent` - `{element=}`: The element to append the toast to. Defaults to appending
 *     to the root element of the application.
 *
 * @returns {promise} A promise that can be resolved with `$mdToast.hide()` or
 * rejected with `$mdToast.cancel()`.
 */

/**
 * @ngdoc method
 * @name $mdToast#hide
 *
 * @description
 * Hide an existing toast and resolve the promise returned from `$mdToast.show()`.
 *
 * @param {*=} response An argument for the resolved promise.
 *
 * @returns {promise} a promise that is called when the existing element is removed from the DOM
 *
 */

/**
 * @ngdoc method
 * @name $mdToast#cancel
 *
 * @description
 * Hide the existing toast and reject the promise returned from
 * `$mdToast.show()`.
 *
 * @param {*=} response An argument for the rejected promise.
 *
 * @returns {promise} a promise that is called when the existing element is removed from the DOM
 *
 */

function MdToastProvider($$interimElementProvider) {
  var activeToastContent;
  var $mdToast = $$interimElementProvider('$mdToast')
    .setDefaults({
      methods: ['position', 'hideDelay', 'capsule' ],
      options: toastDefaultOptions
    })
    .addPreset('simple', {
      argOption: 'content',
      methods: ['content', 'action', 'highlightAction', 'theme', 'parent'],
      options: /* @ngInject */ ["$mdToast", "$mdTheming", function($mdToast, $mdTheming) {
        var opts = {
          template: [
            '<md-toast md-theme="{{ toast.theme }}" ng-class="{\'md-capsule\': toast.capsule}">',
              '<span flex>{{ toast.content }}</span>',
              '<md-button class="md-action" ng-if="toast.action" ng-click="toast.resolve()" ng-class="{\'md-highlight\': toast.highlightAction}">',
                '{{ toast.action }}',
              '</md-button>',
            '</md-toast>'
          ].join(''),
          controller: /* @ngInject */ ["$scope", function mdToastCtrl($scope) {
            var self = this;
            $scope.$watch(function() { return activeToastContent; }, function() {
              self.content = activeToastContent;
            });
            this.resolve = function() {
              $mdToast.hide();
            };
          }],
          theme: $mdTheming.defaultTheme(),
          controllerAs: 'toast',
          bindToController: true
        };
        return opts;
      }]
    })
    .addMethod('updateContent', function(newContent) {
      activeToastContent = newContent;
    });

  toastDefaultOptions.$inject = ["$timeout", "$animate", "$mdToast", "$mdUtil"];
    return $mdToast;

  /* @ngInject */
  function toastDefaultOptions($timeout, $animate, $mdToast, $mdUtil) {
    return {
      onShow: onShow,
      onRemove: onRemove,
      position: 'bottom left',
      themable: true,
      hideDelay: 3000
    };

    function onShow(scope, element, options) {
      element = $mdUtil.extractElementByName(element, 'md-toast');

      // 'top left' -> 'md-top md-left'
      activeToastContent = options.content;
      element.addClass(options.position.split(' ').map(function(pos) {
        return 'md-' + pos;
      }).join(' '));
      options.parent.addClass(toastOpenClass(options.position));

      options.onSwipe = function(ev, gesture) {
        //Add swipeleft/swiperight class to element so it can animate correctly
        element.addClass('md-' + ev.type.replace('$md.',''));
        $timeout($mdToast.cancel);
      };
      element.on('$md.swipeleft $md.swiperight', options.onSwipe);
      return $animate.enter(element, options.parent);
    }

    function onRemove(scope, element, options) {
      element.off('$md.swipeleft $md.swiperight', options.onSwipe);
      options.parent.removeClass(toastOpenClass(options.position));
      return $animate.leave(element);
    }

    function toastOpenClass(position) {
      return 'md-toast-open-' +
        (position.indexOf('top') > -1 ? 'top' : 'bottom');
    }
  }

}
MdToastProvider.$inject = ["$$interimElementProvider"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.toolbar
 */
angular.module('material.components.toolbar', [
  'material.core',
  'material.components.content'
])
  .directive('mdToolbar', mdToolbarDirective);

/**
 * @ngdoc directive
 * @name mdToolbar
 * @module material.components.toolbar
 * @restrict E
 * @description
 * `md-toolbar` is used to place a toolbar in your app.
 *
 * Toolbars are usually used above a content area to display the title of the
 * current page, and show relevant action buttons for that page.
 *
 * You can change the height of the toolbar by adding either the
 * `md-medium-tall` or `md-tall` class to the toolbar.
 *
 * @usage
 * <hljs lang="html">
 * <div layout="column" layout-fill>
 *   <md-toolbar>
 *
 *     <div class="md-toolbar-tools">
 *       <span>My App's Title</span>
 *
 *       <!-- fill up the space between left and right area -->
 *       <span flex></span>
 *
 *       <md-button>
 *         Right Bar Button
 *       </md-button>
 *     </div>
 *
 *   </md-toolbar>
 *   <md-content>
 *     Hello!
 *   </md-content>
 * </div>
 * </hljs>
 *
 * @param {boolean=} md-scroll-shrink Whether the header should shrink away as
 * the user scrolls down, and reveal itself as the user scrolls up.
 * Note: for scrollShrink to work, the toolbar must be a sibling of a
 * `md-content` element, placed before it. See the scroll shrink demo.
 *
 *
 * @param {number=} md-shrink-speed-factor How much to change the speed of the toolbar's
 * shrinking by. For example, if 0.25 is given then the toolbar will shrink
 * at one fourth the rate at which the user scrolls down. Default 0.5.
 */
function mdToolbarDirective($$rAF, $mdConstant, $mdUtil, $mdTheming, $animate, $timeout) {

  return {
    restrict: 'E',
    controller: angular.noop,
    link: function(scope, element, attr) {
      $mdTheming(element);

      if (angular.isDefined(attr.mdScrollShrink)) {
        setupScrollShrink();
      }

      function setupScrollShrink() {
        // Current "y" position of scroll
        var y = 0;
        // Store the last scroll top position
        var prevScrollTop = 0;

        var shrinkSpeedFactor = attr.mdShrinkSpeedFactor || 0.5;

        var toolbarHeight;
        var contentElement;

        var debouncedContentScroll = $$rAF.throttle(onContentScroll);
        var debouncedUpdateHeight = $mdUtil.debounce(updateToolbarHeight, 5 * 1000);

        // Wait for $mdContentLoaded event from mdContent directive.
        // If the mdContent element is a sibling of our toolbar, hook it up
        // to scroll events.
        scope.$on('$mdContentLoaded', onMdContentLoad);

        function onMdContentLoad($event, newContentEl) {
          // Toolbar and content must be siblings
          if (element.parent()[0] === newContentEl.parent()[0]) {
            // unhook old content event listener if exists
            if (contentElement) {
              contentElement.off('scroll', debouncedContentScroll);
            }

            newContentEl.on('scroll', debouncedContentScroll);
            newContentEl.attr('scroll-shrink', 'true');

            contentElement = newContentEl;
            $$rAF(updateToolbarHeight);
          }
        }

        function updateToolbarHeight() {
          toolbarHeight = element.prop('offsetHeight');
          // Add a negative margin-top the size of the toolbar to the content el.
          // The content will start transformed down the toolbarHeight amount,
          // so everything looks normal.
          //
          // As the user scrolls down, the content will be transformed up slowly
          // to put the content underneath where the toolbar was.
          var margin =  (-toolbarHeight * shrinkSpeedFactor) + 'px';
          contentElement.css('margin-top', margin);
          contentElement.css('margin-bottom', margin);

          onContentScroll();
        }

        function onContentScroll(e) {
          var scrollTop = e ? e.target.scrollTop : prevScrollTop;

          debouncedUpdateHeight();

          y = Math.min(
            toolbarHeight / shrinkSpeedFactor,
            Math.max(0, y + scrollTop - prevScrollTop)
          );

          element.css(
            $mdConstant.CSS.TRANSFORM,
            'translate3d(0,' + (-y * shrinkSpeedFactor) + 'px,0)'
          );
          contentElement.css(
            $mdConstant.CSS.TRANSFORM,
            'translate3d(0,' + ((toolbarHeight - y) * shrinkSpeedFactor) + 'px,0)'
          );

          prevScrollTop = scrollTop;

            if (element.hasClass('md-whiteframe-z1')) {
              if (!y) {
                $timeout(function () { $animate.removeClass(element, 'md-whiteframe-z1'); });
              }
            } else {
              if (y) {
                $timeout(function () { $animate.addClass(element, 'md-whiteframe-z1'); });
              }
            }
        }

      }

    }
  };

}
mdToolbarDirective.$inject = ["$$rAF", "$mdConstant", "$mdUtil", "$mdTheming", "$animate", "$timeout"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.tooltip
 */
angular
    .module('material.components.tooltip', [ 'material.core' ])
    .directive('mdTooltip', MdTooltipDirective);

/**
 * @ngdoc directive
 * @name mdTooltip
 * @module material.components.tooltip
 * @description
 * Tooltips are used to describe elements that are interactive and primarily graphical (not textual).
 *
 * Place a `<md-tooltip>` as a child of the element it describes.
 *
 * A tooltip will activate when the user focuses, hovers over, or touches the parent.
 *
 * @usage
 * <hljs lang="html">
 * <md-button class="md-fab md-accent" aria-label="Play">
 *   <md-tooltip>
 *     Play Music
 *   </md-tooltip>
 *   <md-icon icon="img/icons/ic_play_arrow_24px.svg"></md-icon>
 * </md-button>
 * </hljs>
 *
 * @param {expression=} md-visible Boolean bound to whether the tooltip is
 * currently visible.
 * @param {number=} md-delay How many milliseconds to wait to show the tooltip after the user focuses, hovers, or touches the parent. Defaults to 400ms.
 * @param {string=} md-direction Which direction would you like the tooltip to go?  Supports left, right, top, and bottom.  Defaults to bottom.
 * @param {boolean=} md-autohide If present or provided with a boolean value, the tooltip will hide on mouse leave, regardless of focus
 */
function MdTooltipDirective($timeout, $window, $$rAF, $document, $mdUtil, $mdTheming, $rootElement,
                            $animate, $q) {

  var TOOLTIP_SHOW_DELAY = 300;
  var TOOLTIP_WINDOW_EDGE_SPACE = 8;

  return {
    restrict: 'E',
    transclude: true,
    priority:210, // Before ngAria
    template: '\
        <div class="md-background"></div>\
        <div class="md-content" ng-transclude></div>',
    scope: {
      visible: '=?mdVisible',
      delay: '=?mdDelay',
      autohide: '=?mdAutohide'
    },
    link: postLink
  };

  function postLink(scope, element, attr) {

    $mdTheming(element);

    var parent        = getParentWithPointerEvents(),
        background    = angular.element(element[0].getElementsByClassName('md-background')[0]),
        content       = angular.element(element[0].getElementsByClassName('md-content')[0]),
        direction     = attr.mdDirection,
        current       = getNearestContentElement(),
        tooltipParent = angular.element(current || document.body),
        debouncedOnResize = $$rAF.throttle(function () { if (scope.visible) positionTooltip(); });

    return init();

    function init () {
      setDefaults();
      manipulateElement();
      bindEvents();
      configureWatchers();
      addAriaLabel();
    }

    function setDefaults () {
      if (!angular.isDefined(attr.mdDelay)) scope.delay = TOOLTIP_SHOW_DELAY;
    }

    function configureWatchers () {
      scope.$on('$destroy', function() {
        scope.visible = false;
        element.remove();
        angular.element($window).off('resize', debouncedOnResize);
      });
      scope.$watch('visible', function (isVisible) {
        if (isVisible) showTooltip();
        else hideTooltip();
      });
    }

    function addAriaLabel () {
      if (!parent.attr('aria-label') && !parent.text().trim()) {
        parent.attr('aria-label', element.text().trim());
      }
    }

    function manipulateElement () {
      element.detach();
      element.attr('role', 'tooltip');
    }

    function getParentWithPointerEvents () {
      var parent = element.parent();
      while (parent && $window.getComputedStyle(parent[0])['pointer-events'] == 'none') {
        parent = parent.parent();
      }
      return parent;
    }

     function getNearestContentElement () {
       var current = element.parent()[0];
       // Look for the nearest parent md-content, stopping at the rootElement.
       while (current && current !== $rootElement[0] && current !== document.body) {
         current = current.parentNode;
       }
       return current;
     }

    function hasComputedStyleValue(key, value) {
        // Check if we should show it or not...
        var computedStyles = $window.getComputedStyle(element[0]);
        return angular.isDefined(computedStyles[key]) && (computedStyles[key] == value);
    }

    function bindEvents () {
      var mouseActive = false;
      var enterHandler = function() {
        if (!hasComputedStyleValue('pointer-events','none')) {
          setVisible(true);
        }
      };
      var leaveHandler = function () {
        var autohide = scope.hasOwnProperty('autohide') ? scope.autohide : attr.hasOwnProperty('mdAutohide');
        if (autohide || mouseActive || ($document[0].activeElement !== parent[0]) ) {
          setVisible(false);
        }
        mouseActive = false;
      };

      // to avoid `synthetic clicks` we listen to mousedown instead of `click`
      parent.on('mousedown', function() { mouseActive = true; });
      parent.on('focus mouseenter touchstart', enterHandler );
      parent.on('blur mouseleave touchend touchcancel', leaveHandler );


      angular.element($window).on('resize', debouncedOnResize);
    }

    function setVisible (value) {
      setVisible.value = !!value;
      if (!setVisible.queued) {
        if (value) {
          setVisible.queued = true;
          $timeout(function() {
            scope.visible = setVisible.value;
            setVisible.queued = false;
          }, scope.delay);
        } else {
          $timeout(function() { scope.visible = false; });
        }
      }
    }

    function showTooltip() {
      // Insert the element before positioning it, so we can get the position
      // and check if we should display it
      tooltipParent.append(element);

      // Check if we should display it or not.
      // This handles hide-* and show-* along with any user defined css
      if ( hasComputedStyleValue('display','none') ) {
        scope.visible = false;
        element.detach();
        return;
      }

      positionTooltip();
      angular.forEach([element, background, content], function (element) {
        $animate.addClass(element, 'md-show');
      });
    }

    function hideTooltip() {
      $q.all([
        $animate.removeClass(content, 'md-show'),
        $animate.removeClass(background, 'md-show'),
        $animate.removeClass(element, 'md-show')
      ]).then(function () {
        if (!scope.visible) element.detach();
      });
    }

    function positionTooltip() {
      var tipRect = $mdUtil.offsetRect(element, tooltipParent);
      var parentRect = $mdUtil.offsetRect(parent, tooltipParent);
      var newPosition = getPosition(direction);

      // If the user provided a direction, just nudge the tooltip onto the screen
      // Otherwise, recalculate based on 'top' since default is 'bottom'
      if (direction) {
        newPosition = fitInParent(newPosition);
      } else if (newPosition.top > element.prop('offsetParent').scrollHeight - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE) {
        newPosition = fitInParent(getPosition('top'));
      }

      element.css({top: newPosition.top + 'px', left: newPosition.left + 'px'});

      positionBackground();

      function positionBackground () {
        var size = direction === 'left' || direction === 'right'
              ? Math.sqrt(Math.pow(tipRect.width, 2) + Math.pow(tipRect.height / 2, 2)) * 2
              : Math.sqrt(Math.pow(tipRect.width / 2, 2) + Math.pow(tipRect.height, 2)) * 2,
            position = direction === 'left' ? { left: 100, top: 50 }
              : direction === 'right' ? { left: 0, top: 50 }
              : direction === 'top' ? { left: 50, top: 100 }
              : { left: 50, top: 0 };
        background.css({
          width: size + 'px',
          height: size + 'px',
          left: position.left + '%',
          top: position.top + '%'
        });
      }

      function fitInParent (pos) {
        var newPosition = { left: pos.left, top: pos.top };
        newPosition.left = Math.min( newPosition.left, tooltipParent.prop('scrollWidth') - tipRect.width - TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.left = Math.max( newPosition.left, TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.top  = Math.min( newPosition.top,  tooltipParent.prop('scrollHeight') - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE );
        newPosition.top  = Math.max( newPosition.top,  TOOLTIP_WINDOW_EDGE_SPACE );
        return newPosition;
      }

      function getPosition (dir) {
        return dir === 'left'
          ? { left: parentRect.left - tipRect.width - TOOLTIP_WINDOW_EDGE_SPACE,
              top: parentRect.top + parentRect.height / 2 - tipRect.height / 2 }
          : dir === 'right'
          ? { left: parentRect.left + parentRect.width + TOOLTIP_WINDOW_EDGE_SPACE,
              top: parentRect.top + parentRect.height / 2 - tipRect.height / 2 }
          : dir === 'top'
          ? { left: parentRect.left + parentRect.width / 2 - tipRect.width / 2,
              top: parentRect.top - tipRect.height - TOOLTIP_WINDOW_EDGE_SPACE }
          : { left: parentRect.left + parentRect.width / 2 - tipRect.width / 2,
              top: parentRect.top + parentRect.height + TOOLTIP_WINDOW_EDGE_SPACE };
      }
    }

  }

}
MdTooltipDirective.$inject = ["$timeout", "$window", "$$rAF", "$document", "$mdUtil", "$mdTheming", "$rootElement", "$animate", "$q"];

})();
(function(){
"use strict";

/**
 * @ngdoc module
 * @name material.components.whiteframe
 */
angular.module('material.components.whiteframe', []);

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .controller('MdAutocompleteCtrl', MdAutocompleteCtrl);

var ITEM_HEIGHT = 41,
    MAX_HEIGHT = 5.5 * ITEM_HEIGHT,
    MENU_PADDING = 8;

function MdAutocompleteCtrl ($scope, $element, $mdUtil, $mdConstant, $timeout, $mdTheming, $window,
                             $animate, $rootElement, $attrs) {
  //-- private variables
  var ctrl      = this,
      itemParts = $scope.itemsExpr.split(/ in /i),
      itemExpr  = itemParts[1],
      elements  = null,
      promise   = null,
      cache     = {},
      noBlur    = false,
      selectedItemWatchers = [],
      hasFocus  = false,
      lastCount = 0;

  //-- public variables with handlers
  defineProperty('hidden', handleHiddenChange, true);

  //-- public variables
  ctrl.scope      = $scope;
  ctrl.parent     = $scope.$parent;
  ctrl.itemName   = itemParts[0];
  ctrl.matches    = [];
  ctrl.loading    = false;
  ctrl.hidden     = true;
  ctrl.index      = null;
  ctrl.messages   = [];
  ctrl.id         = $mdUtil.nextUid();
  ctrl.isDisabled = null;
  ctrl.isRequired = null;

  //-- public methods
  ctrl.keydown    = keydown;
  ctrl.blur       = blur;
  ctrl.focus      = focus;
  ctrl.clear      = clearValue;
  ctrl.select     = select;
  ctrl.listEnter  = onListEnter;
  ctrl.listLeave  = onListLeave;
  ctrl.mouseUp    = onMouseup;
  ctrl.getCurrentDisplayValue         = getCurrentDisplayValue;
  ctrl.registerSelectedItemWatcher    = registerSelectedItemWatcher;
  ctrl.unregisterSelectedItemWatcher  = unregisterSelectedItemWatcher;

  return init();

  //-- initialization methods

  /**
   * Initialize the controller, setup watchers, gather elements
   */
  function init () {
    $mdUtil.initOptionalProperties($scope, $attrs, { searchText: null, selectedItem: null } );
    $mdTheming($element);
    configureWatchers();
    $timeout(function () {
      gatherElements();
      focusElement();
      moveDropdown();
    });
  }

  /**
   * Calculates the dropdown's position and applies the new styles to the menu element
   * @returns {*}
   */
  function positionDropdown () {
    if (!elements) return $timeout(positionDropdown, 0, false);
    var hrect  = elements.wrap.getBoundingClientRect(),
        vrect  = elements.snap.getBoundingClientRect(),
        root   = elements.root.getBoundingClientRect(),
        top    = vrect.bottom - root.top,
        bot    = root.bottom - vrect.top,
        left   = hrect.left - root.left,
        width  = hrect.width,
        styles = {
          left:     left + 'px',
          minWidth: width + 'px',
          maxWidth: Math.max(hrect.right - root.left, root.right - hrect.left) - MENU_PADDING + 'px'
        };
    if (top > bot && root.height - hrect.bottom - MENU_PADDING < MAX_HEIGHT) {
      styles.top = 'auto';
      styles.bottom = bot + 'px';
      styles.maxHeight = Math.min(MAX_HEIGHT, hrect.top - root.top - MENU_PADDING) + 'px';
    } else {
      styles.top = top + 'px';
      styles.bottom = 'auto';
      styles.maxHeight = Math.min(MAX_HEIGHT, root.bottom - hrect.bottom - MENU_PADDING) + 'px';
    }
    elements.$.ul.css(styles);
    $timeout(correctHorizontalAlignment, 0, false);

    /**
     * Makes sure that the menu doesn't go off of the screen on either side.
     */
    function correctHorizontalAlignment () {
      var dropdown = elements.ul.getBoundingClientRect(),
          styles   = {};
      if (dropdown.right > root.right - MENU_PADDING) {
        styles.left = (hrect.right - dropdown.width) + 'px';
      }
      elements.$.ul.css(styles);
    }
  }

  /**
   * Moves the dropdown menu to the body tag in order to avoid z-index and overflow issues.
   */
  function moveDropdown () {
    if (!elements.$.root.length) return;
    $mdTheming(elements.$.ul);
    elements.$.ul.detach();
    elements.$.root.append(elements.$.ul);
    if ($animate.pin) $animate.pin(elements.$.ul, $rootElement);
  }

  /**
   * Sends focus to the input element.
   */
  function focusElement () {
    if ($scope.autofocus) elements.input.focus();
  }

  /**
   * Sets up any watchers used by autocomplete
   */
  function configureWatchers () {
    var wait = parseInt($scope.delay, 10) || 0;
    $attrs.$observe('disabled', function (value) { ctrl.isDisabled = value; });
    $attrs.$observe('required', function (value) { ctrl.isRequired = value !== null; });
    $scope.$watch('searchText', wait ? $mdUtil.debounce(handleSearchText, wait) : handleSearchText);
    registerSelectedItemWatcher(selectedItemChange);
    $scope.$watch('selectedItem', handleSelectedItemChange);
    angular.element($window).on('resize', positionDropdown);
    $scope.$on('$destroy', cleanup);
  }

  /**
   * Removes any events or leftover elements created by this controller
   */
  function cleanup () {
    angular.element($window).off('resize', positionDropdown);
    elements.$.ul.remove();
  }

  /**
   * Gathers all of the elements needed for this controller
   */
  function gatherElements () {
    elements = {
      main:  $element[0],
      ul:    $element.find('ul')[0],
      input: $element.find('input')[0],
      wrap:  $element.find('md-autocomplete-wrap')[0],
      root:  document.body
    };
    elements.li = elements.ul.getElementsByTagName('li');
    elements.snap = getSnapTarget();
    elements.$ = getAngularElements(elements);
  }

  /**
   * Finds the element that the menu will base its position on
   * @returns {*}
   */
  function getSnapTarget () {
    for (var element = $element; element.length; element = element.parent()) {
      if (angular.isDefined(element.attr('md-autocomplete-snap'))) return element[0];
    }
    return elements.wrap;
  }

  /**
   * Gathers angular-wrapped versions of each element
   * @param elements
   * @returns {{}}
   */
  function getAngularElements (elements) {
    var obj = {};
    for (var key in elements) {
      obj[key] = angular.element(elements[key]);
    }
    return obj;
  }

  //-- event/change handlers

  /**
   * Handles changes to the `hidden` property.
   * @param hidden
   * @param oldHidden
   */
  function handleHiddenChange (hidden, oldHidden) {
    if (!hidden && oldHidden) positionDropdown();
    if (!hidden) {
      if (elements) $timeout(function () { $mdUtil.disableScrollAround(elements.ul); }, 0, false);
    } else {
      $mdUtil.enableScrolling();
    }
  }

  /**
   * When the user mouses over the dropdown menu, ignore blur events.
   */
  function onListEnter () {
    noBlur = true;
  }

  /**
   * When the user's mouse leaves the menu, blur events may hide the menu again.
   */
  function onListLeave () {
    noBlur = false;
    if (!hasFocus) ctrl.hidden = true;
  }

  /**
   * When the mouse button is released, send focus back to the input field.
   */
  function onMouseup () {
    elements.input.focus();
  }

  /**
   * Handles changes to the selected item.
   * @param selectedItem
   * @param previousSelectedItem
   */
  function selectedItemChange (selectedItem, previousSelectedItem) {
    if (selectedItem) {
      $scope.searchText = getDisplayValue(selectedItem);
    }
    if (angular.isFunction($scope.itemChange) && selectedItem !== previousSelectedItem)
      $scope.itemChange(getItemScope(selectedItem));
  }

  /**
   * Calls any external watchers listening for the selected item.  Used in conjunction with
   * `registerSelectedItemWatcher`.
   * @param selectedItem
   * @param previousSelectedItem
   */
  function handleSelectedItemChange(selectedItem, previousSelectedItem) {
    for (var i = 0; i < selectedItemWatchers.length; ++i) {
      selectedItemWatchers[i](selectedItem, previousSelectedItem);
    }
  }

  /**
   * Register a function to be called when the selected item changes.
   * @param cb
   */
  function registerSelectedItemWatcher(cb) {
    if (selectedItemWatchers.indexOf(cb) == -1) {
      selectedItemWatchers.push(cb);
    }
  }

  /**
   * Unregister a function previously registered for selected item changes.
   * @param cb
   */
  function unregisterSelectedItemWatcher(cb) {
    var i = selectedItemWatchers.indexOf(cb);
    if (i != -1) {
      selectedItemWatchers.splice(i, 1);
    }
  }

  /**
   * Handles changes to the searchText property.
   * @param searchText
   * @param previousSearchText
   */
  function handleSearchText (searchText, previousSearchText) {
    ctrl.index = getDefaultIndex();
    //-- do nothing on init
    if (searchText === previousSearchText) return;
    //-- clear selected item if search text no longer matches it
    if (searchText !== getDisplayValue($scope.selectedItem)) $scope.selectedItem = null;
    else return;
    //-- trigger change event if available
    if (angular.isFunction($scope.textChange) && searchText !== previousSearchText)
      $scope.textChange(getItemScope($scope.selectedItem));
    //-- cancel results if search text is not long enough
    if (!isMinLengthMet()) {
      ctrl.loading = false;
      ctrl.matches = [];
      ctrl.hidden = shouldHide();
      updateMessages();
    } else {
      handleQuery();
    }
  }

  /**
   * Handles input blur event, determines if the dropdown should hide.
   */
  function blur () {
    hasFocus = false;
    if (!noBlur) ctrl.hidden = true;
  }

  /**
   * Handles input focus event, determines if the dropdown should show.
   */
  function focus () {
    hasFocus = true;
    //-- if searchText is null, let's force it to be a string
    if (!angular.isString($scope.searchText)) $scope.searchText = '';
    if ($scope.minLength > 0) return;
    ctrl.hidden = shouldHide();
    if (!ctrl.hidden) handleQuery();
  }

  /**
   * Handles keyboard input.
   * @param event
   */
  function keydown (event) {
    switch (event.keyCode) {
      case $mdConstant.KEY_CODE.DOWN_ARROW:
        if (ctrl.loading) return;
        event.preventDefault();
        ctrl.index = Math.min(ctrl.index + 1, ctrl.matches.length - 1);
        updateScroll();
        updateMessages();
        break;
      case $mdConstant.KEY_CODE.UP_ARROW:
        if (ctrl.loading) return;
        event.preventDefault();
        ctrl.index = ctrl.index < 0 ? ctrl.matches.length - 1 : Math.max(0, ctrl.index - 1);
        updateScroll();
        updateMessages();
        break;
      case $mdConstant.KEY_CODE.TAB:
      case $mdConstant.KEY_CODE.ENTER:
        if (ctrl.hidden || ctrl.loading || ctrl.index < 0 || ctrl.matches.length < 1) return;
        event.preventDefault();
        select(ctrl.index);
        break;
      case $mdConstant.KEY_CODE.ESCAPE:
        ctrl.matches = [];
        ctrl.hidden = true;
        ctrl.index = getDefaultIndex();
        break;
      default:
    }
  }

  //-- getters

  /**
   * Returns the minimum length needed to display the dropdown.
   * @returns {*}
   */
  function getMinLength () {
    return angular.isNumber($scope.minLength) ? $scope.minLength : 1;
  }

  /**
   * Returns the display value for an item.
   * @param item
   * @returns {*}
   */
  function getDisplayValue (item) {
    return (item && $scope.itemText) ? $scope.itemText(getItemScope(item)) : item;
  }

  /**
   * Returns the locals object for compiling item templates.
   * @param item
   * @returns {{}}
   */
  function getItemScope (item) {
    if (!item) return;
    var locals = {};
    if (ctrl.itemName) locals[ctrl.itemName] = item;
    return locals;
  }

  /**
   * Returns the default index based on whether or not autoselect is enabled.
   * @returns {number}
   */
  function getDefaultIndex () {
    return $scope.autoselect ? 0 : -1;
  }

  /**
   * Determines if the menu should be hidden.
   * @returns {boolean}
   */
  function shouldHide () {
    if (!isMinLengthMet()) return true;
  }

  /**
   * Returns the display value of the current item.
   * @returns {*}
   */
  function getCurrentDisplayValue () {
    return getDisplayValue(ctrl.matches[ctrl.index]);
  }

  /**
   * Determines if the minimum length is met by the search text.
   * @returns {*}
   */
  function isMinLengthMet () {
    return angular.isDefined($scope.searchText) && $scope.searchText.length >= getMinLength();
  }

  //-- actions

  /**
   * Defines a public property with a handler and a default value.
   * @param key
   * @param handler
   * @param value
   */
  function defineProperty (key, handler, value) {
    Object.defineProperty(ctrl, key, {
      get: function () { return value; },
      set: function (newValue) {
        var oldValue = value;
        value = newValue;
        handler(newValue, oldValue);
      }
    });
  }

  /**
   * Selects the item at the given index.
   * @param index
   */
  function select (index) {
    $scope.selectedItem = ctrl.matches[index];
    ctrl.hidden = true;
    ctrl.index = 0;
    ctrl.matches = [];
    //-- force form to update state for validation
    $timeout(function () {
      elements.$.input.controller('ngModel').$setViewValue(getDisplayValue($scope.selectedItem) ||
          $scope.searchText);
      ctrl.hidden = true;
    });
  }

  /**
   * Clears the searchText value and selected item.
   */
  function clearValue () {
    $scope.searchText = '';
    select(-1);

    // Per http://www.w3schools.com/jsref/event_oninput.asp
    var eventObj = document.createEvent('CustomEvent');
    eventObj.initCustomEvent('input', true, true, {value: $scope.searchText});
    elements.input.dispatchEvent(eventObj);

    elements.input.focus();
  }

  /**
   * Fetches the results for the provided search text.
   * @param searchText
   */
  function fetchResults (searchText) {
    var items = $scope.$parent.$eval(itemExpr),
        term = searchText.toLowerCase();
    if (angular.isArray(items)) {
      handleResults(items);
    } else if (items) {
      ctrl.loading = true;
      if (items.success) items.success(handleResults);
      if (items.then)    items.then(handleResults);
      if (items.error)   items.error(function () { ctrl.loading = false; });
    }
    function handleResults (matches) {
      cache[term] = matches;
      if (searchText !== $scope.searchText) return; //-- just cache the results if old request
      ctrl.loading = false;
      promise = null;
      ctrl.matches = matches;
      ctrl.hidden = shouldHide();
      updateMessages();
      positionDropdown();
    }
  }

  /**
   * Updates the ARIA messages
   */
  function updateMessages () {
    ctrl.messages = [ getCountMessage(), getCurrentDisplayValue() ];
  }

  /**
   * Returns the ARIA message for how many results match the current query.
   * @returns {*}
   */
  function getCountMessage () {
    if (lastCount === ctrl.matches.length) return '';
    lastCount = ctrl.matches.length;
    switch (ctrl.matches.length) {
      case 0:  return 'There are no matches available.';
      case 1:  return 'There is 1 match available.';
      default: return 'There are ' + ctrl.matches.length + ' matches available.';
    }
  }

  /**
   * Makes sure that the focused element is within view.
   */
  function updateScroll () {
    if (!elements.li[ctrl.index]) return;
    var li  = elements.li[ctrl.index],
        top = li.offsetTop,
        bot = top + li.offsetHeight,
        hgt = elements.ul.clientHeight;
    if (top < elements.ul.scrollTop) {
      elements.ul.scrollTop = top;
    } else if (bot > elements.ul.scrollTop + hgt) {
      elements.ul.scrollTop = bot - hgt;
    }
  }

  /**
   * Starts the query to gather the results for the current searchText.  Attempts to return cached
   * results first, then forwards the process to `fetchResults` if necessary.
   */
  function handleQuery () {
    var searchText = $scope.searchText,
        term = searchText.toLowerCase();
    //-- cancel promise if a promise is in progress
    if (promise && promise.cancel) {
      promise.cancel();
      promise = null;
    }
    //-- if results are cached, pull in cached results
    if (!$scope.noCache && cache[term]) {
      ctrl.matches = cache[term];
      updateMessages();
    } else {
      fetchResults(searchText);
    }
    if (hasFocus) ctrl.hidden = shouldHide();
  }

}
MdAutocompleteCtrl.$inject = ["$scope", "$element", "$mdUtil", "$mdConstant", "$timeout", "$mdTheming", "$window", "$animate", "$rootElement", "$attrs"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocomplete', MdAutocomplete);

/**
 * @ngdoc directive
 * @name mdAutocomplete
 * @module material.components.autocomplete
 *
 * @description
 * `<md-autocomplete>` is a special input component with a drop-down of all possible matches to a custom query.
 * This component allows you to provide real-time suggestions as the user types in the input area.
 *
 * To start, you will need to specify the required parameters and provide a template for your results.
 * The content inside `md-autocomplete` will be treated as a template.
 *
 * In more complex cases, you may want to include other content such as a message to display when
 * no matches were found.  You can do this by wrapping your template in `md-item-template` and adding
 * a tag for `md-not-found`.  An example of this is shown below.
 * ### Validation
 *
 * You can use `ng-messages` to include validation the same way that you would normally validate;
 * however, if you want to replicate a standard input with a floating label, you will have to do the
 * following:
 *
 * - Make sure that your template is wrapped in `md-item-template`
 * - Add your `ng-messages` code inside of `md-autocomplete`
 * - Add your validation properties to `md-autocomplete` (ie. `required`)
 * - Add a `name` to `md-autocomplete` (to be used on the generated `input`)
 *
 * There is an example below of how this should look.
 *
 *
 * @param {expression} md-items An expression in the format of `item in items` to iterate over matches for your search.
 * @param {expression=} md-selected-item-change An expression to be run each time a new item is selected
 * @param {expression=} md-search-text-change An expression to be run each time the search text updates
 * @param {string=} md-search-text A model to bind the search query text to
 * @param {object=} md-selected-item A model to bind the selected item to
 * @param {string=} md-item-text An expression that will convert your object to a single string.
 * @param {string=} placeholder Placeholder text that will be forwarded to the input.
 * @param {boolean=} md-no-cache Disables the internal caching that happens in autocomplete
 * @param {boolean=} ng-disabled Determines whether or not to disable the input field
 * @param {number=} md-min-length Specifies the minimum length of text before autocomplete will make suggestions
 * @param {number=} md-delay Specifies the amount of time (in milliseconds) to wait before looking for results
 * @param {boolean=} md-autofocus If true, will immediately focus the input element
 * @param {boolean=} md-autoselect If true, the first item will be selected by default
 * @param {string=} md-menu-class This will be applied to the dropdown menu for styling
 * @param {string=} md-floating-label This will add a floating label to autocomplete and wrap it in `md-input-container`
 *
 * @usage
 * ###Basic Example
 * <hljs lang="html">
 *   <md-autocomplete
 *       md-selected-item="selectedItem"
 *       md-search-text="searchText"
 *       md-items="item in getMatches(searchText)"
 *       md-item-text="item.display">
 *     <span md-highlight-text="searchText">{{item.display}}</span>
 *   </md-autocomplete>
 * </hljs>
 *
 * ###Example with "not found" message
 * <hljs lang="html">
 * <md-autocomplete
 *     md-selected-item="selectedItem"
 *     md-search-text="searchText"
 *     md-items="item in getMatches(searchText)"
 *     md-item-text="item.display">
 *   <md-item-template>
 *     <span md-highlight-text="searchText">{{item.display}}</span>
 *   </md-item-template>
 *   <md-not-found>
 *     No matches found.
 *   </md-not-found>
 * </md-autocomplete>
 * </hljs>
 *
 * In this example, our code utilizes `md-item-template` and `md-not-found` to specify the different
 * parts that make up our component.
 *
 * ### Example with validation
 * <hljs lang="html">
 * <form name="autocompleteForm">
 *   <md-autocomplete
 *       required
 *       input-name="autocomplete"
 *       md-selected-item="selectedItem"
 *       md-search-text="searchText"
 *       md-items="item in getMatches(searchText)"
 *       md-item-text="item.display">
 *     <md-item-template>
 *       <span md-highlight-text="searchText">{{item.display}}</span>
 *     </md-item-template>
 *     <div ng-messages="autocompleteForm.autocomplete.$error">
 *       <div ng-message="required">This field is required</div>
 *     </div>
 *   </md-autocomplete>
 * </form>
 * </hljs>
 *
 * In this example, our code utilizes `md-item-template` and `md-not-found` to specify the different
 * parts that make up our component.
 */

function MdAutocomplete ($mdTheming, $mdUtil) {
  return {
    controller:   'MdAutocompleteCtrl',
    controllerAs: '$mdAutocompleteCtrl',
    scope:        {
      inputName:      '@mdInputName',
      inputMinlength: '@mdInputMinlength',
      inputMaxlength: '@mdInputMaxlength',
      searchText:     '=?mdSearchText',
      selectedItem:   '=?mdSelectedItem',
      itemsExpr:      '@mdItems',
      itemText:       '&mdItemText',
      placeholder:    '@placeholder',
      noCache:        '=?mdNoCache',
      itemChange:     '&?mdSelectedItemChange',
      textChange:     '&?mdSearchTextChange',
      minLength:      '=?mdMinLength',
      delay:          '=?mdDelay',
      autofocus:      '=?mdAutofocus',
      floatingLabel:  '@?mdFloatingLabel',
      autoselect:     '=?mdAutoselect',
      menuClass:      '@?mdMenuClass'
    },
    template: function (element, attr) {
      var noItemsTemplate = getNoItemsTemplate(),
          itemTemplate = getItemTemplate(),
          leftover = element.html();
      return '\
        <md-autocomplete-wrap\
            layout="row"\
            ng-class="{ \'md-whiteframe-z1\': !floatingLabel }"\
            role="listbox">\
          ' + getInputElement() + '\
          <md-progress-linear\
              ng-if="$mdAutocompleteCtrl.loading"\
              md-mode="indeterminate"></md-progress-linear>\
          <ul role="presentation"\
              class="md-autocomplete-suggestions md-whiteframe-z1 {{menuClass || \'\'}}"\
              id="ul-{{$mdAutocompleteCtrl.id}}"\
              ng-hide="$mdAutocompleteCtrl.hidden"\
              ng-mouseenter="$mdAutocompleteCtrl.listEnter()"\
              ng-mouseleave="$mdAutocompleteCtrl.listLeave()"\
              ng-mouseup="$mdAutocompleteCtrl.mouseUp()">\
            <li ng-repeat="(index, item) in $mdAutocompleteCtrl.matches"\
                ng-class="{ selected: index === $mdAutocompleteCtrl.index }"\
                ng-click="$mdAutocompleteCtrl.select(index)"\
                md-autocomplete-list-item="$mdAutocompleteCtrl.itemName">\
                ' + itemTemplate + '\
            </li>\
            ' + noItemsTemplate + '\
          </ul>\
        </md-autocomplete-wrap>\
        <aria-status\
            class="md-visually-hidden"\
            role="status"\
            aria-live="assertive">\
          <p ng-repeat="message in $mdAutocompleteCtrl.messages" ng-if="message">{{message}}</p>\
        </aria-status>';

      function getItemTemplate() {
        var templateTag = element.find('md-item-template').remove(),
            html = templateTag.length ? templateTag.html() : element.html();
        if (!templateTag.length) element.empty();
        return html;
      }

      function getNoItemsTemplate() {
        var templateTag = element.find('md-not-found').remove(),
            template = templateTag.length ? templateTag.html() : '';
        return template
            ? '<li ng-if="!$mdAutocompleteCtrl.matches.length && !$mdAutocompleteCtrl.loading\
                         && !$mdAutocompleteCtrl.hidden"\
                         ng-hide="$mdAutocompleteCtrl.hidden"\
                         md-autocomplete-parent-scope>' + template + '</li>'
            : '';

      }

      function getInputElement() {
        if (attr.mdFloatingLabel) {
          return '\
            <md-input-container flex ng-if="floatingLabel">\
              <label>{{floatingLabel}}</label>\
              <input type="search"\
                  id="fl-input-{{$mdAutocompleteCtrl.id}}"\
                  name="{{inputName}}"\
                  autocomplete="off"\
                  ng-required="isRequired"\
                  ng-minlength="inputMinlength"\
                  ng-maxlength="inputMaxlength"\
                  ng-disabled="$mdAutocompleteCtrl.isDisabled"\
                  ng-model="$mdAutocompleteCtrl.scope.searchText"\
                  ng-keydown="$mdAutocompleteCtrl.keydown($event)"\
                  ng-blur="$mdAutocompleteCtrl.blur()"\
                  ng-focus="$mdAutocompleteCtrl.focus()"\
                  aria-owns="ul-{{$mdAutocompleteCtrl.id}}"\
                  aria-label="{{floatingLabel}}"\
                  aria-autocomplete="list"\
                  aria-haspopup="true"\
                  aria-activedescendant=""\
                  aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>\
              <div md-autocomplete-parent-scope md-autocomplete-replace>' + leftover + '</div>\
            </md-input-container>';
        } else {
          return '\
            <input flex type="search"\
                id="input-{{$mdAutocompleteCtrl.id}}"\
                name="{{inputName}}"\
                ng-if="!floatingLabel"\
                autocomplete="off"\
                ng-required="isRequired"\
                ng-disabled="$mdAutocompleteCtrl.isDisabled"\
                ng-model="$mdAutocompleteCtrl.scope.searchText"\
                ng-keydown="$mdAutocompleteCtrl.keydown($event)"\
                ng-blur="$mdAutocompleteCtrl.blur()"\
                ng-focus="$mdAutocompleteCtrl.focus()"\
                placeholder="{{placeholder}}"\
                aria-owns="ul-{{$mdAutocompleteCtrl.id}}"\
                aria-label="{{placeholder}}"\
                aria-autocomplete="list"\
                aria-haspopup="true"\
                aria-activedescendant=""\
                aria-expanded="{{!$mdAutocompleteCtrl.hidden}}"/>\
            <button\
                type="button"\
                tabindex="-1"\
                ng-if="$mdAutocompleteCtrl.scope.searchText && !$mdAutocompleteCtrl.isDisabled"\
                ng-click="$mdAutocompleteCtrl.clear()">\
              <md-icon md-svg-icon="md-close"></md-icon>\
              <span class="md-visually-hidden">Clear</span>\
            </button>\
                ';
        }
      }
    }
  };
}
MdAutocomplete.$inject = ["$mdTheming", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .controller('MdHighlightCtrl', MdHighlightCtrl);

function MdHighlightCtrl ($scope, $element, $interpolate) {
  this.init = init;

  return init();

  function init (term) {
    var unsafeText = $interpolate($element.html())($scope),
        text = angular.element('<div>').text(unsafeText).html(),
        flags = $element.attr('md-highlight-flags') || '',
        watcher = $scope.$watch(term, function (term) {
          var regex = getRegExp(term, flags),
              html = text.replace(regex, '<span class="highlight">$&</span>');
          $element.html(html);
        });
    $element.on('$destroy', function () { watcher(); });
  }

  function sanitize (term) {
    if (!term) return term;
    return term.replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/g, '\\$&');
  }

  function getRegExp (text, flags) {
    var str = '';
    if (flags.indexOf('^') >= 1) str += '^';
    str += text;
    if (flags.indexOf('$') >= 1) str += '$';
    return new RegExp(sanitize(str), flags.replace(/[\$\^]/g, ''));
  }
}
MdHighlightCtrl.$inject = ["$scope", "$element", "$interpolate"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdHighlightText', MdHighlight);

/**
 * @ngdoc directive
 * @name mdHighlightText
 * @module material.components.autocomplete
 *
 * @description
 * The `md-highlight-text` directive allows you to specify text that should be highlighted within
 * an element.  Highlighted text will be wrapped in `<span class="highlight"></span>` which can
 * be styled through CSS.  Please note that child elements may not be used with this directive.
 *
 * @param {string} md-highlight-text A model to be searched for
 * @param {string=} md-highlight-flags A list of flags (loosely based on JavaScript RexExp flags).
 *    #### **Supported flags**:
 *    - `g`: Find all matches within the provided text
 *    - `i`: Ignore case when searching for matches
 *    - `$`: Only match if the text ends with the search term
 *    - `^`: Only match if the text begins with the search term
 *
 * @usage
 * <hljs lang="html">
 * <input placeholder="Enter a search term..." ng-model="searchTerm" type="text" />
 * <ul>
 *   <li ng-repeat="result in results" md-highlight-text="searchTerm">
 *     {{result.text}}
 *   </li>
 * </ul>
 * </hljs>
 */

function MdHighlight () {
  return {
    terminal: true,
    scope: false,
    controller: 'MdHighlightCtrl',
    link: function (scope, element, attr, ctrl) {
      ctrl.init(attr.mdHighlightText);
    }
  };
}

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocompleteListItem', MdAutocompleteListItem);

function MdAutocompleteListItem ($compile, $mdUtil) {
  return {
    terminal: true,
    link: postLink,
    scope: false
  };
  function postLink (scope, element, attr) {
    var ctrl     = scope.$parent.$mdAutocompleteCtrl,
        newScope = ctrl.parent.$new(false, ctrl.parent),
        itemName = ctrl.scope.$eval(attr.mdAutocompleteListItem);
    newScope[itemName] = scope.item;
    $compile(element.contents())(newScope);
    element.attr({
      role: 'option',
      id: 'item_' + $mdUtil.nextUid()
    });
  }
}
MdAutocompleteListItem.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.autocomplete')
    .directive('mdAutocompleteParentScope', MdAutocompleteParentScope);

function MdAutocompleteParentScope ($compile, $mdUtil) {
  return {
    restrict: 'A',
    terminal: true,
    link: postLink,
    scope: false
  };
  function postLink (scope, element, attr) {
    var ctrl     = scope.$parent.$mdAutocompleteCtrl;
    $compile(element.contents())(ctrl.parent);
    if (attr.hasOwnProperty('mdAutocompleteReplace')) {
      element.after(element.contents());
      element.remove();
    }
  }
}
MdAutocompleteParentScope.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChip', MdChip);

/**
 * @ngdoc directive
 * @name mdChip
 * @module material.components.chips
 *
 * @description
 * `<md-chip>` is a component used within `<md-chips>` and is responsible for rendering individual
 * chips.
 *
 *
 * @usage
 * <hljs lang="html">
 *   <md-chip>{{$chip}}</md-chip>
 * </hljs>
 *
 */

// This hint text is hidden within a chip but used by screen readers to
// inform the user how they can interact with a chip.
var DELETE_HINT_TEMPLATE = '\
    <span ng-if="!$mdChipsCtrl.readonly" class="md-visually-hidden">\
      {{$mdChipsCtrl.deleteHint}}\
    </span>';

/**
 * MDChip Directive Definition
 *
 * @param $mdTheming
 * @param $mdInkRipple
 * @ngInject
 */
function MdChip($mdTheming) {
  return {
    restrict: 'E',
    require: '^?mdChips',
    compile:  compile
  };

  function compile(element, attr) {
    element.append(DELETE_HINT_TEMPLATE);
    return function postLink(scope, element, attr, ctrl) {
      element.addClass('md-chip');
      $mdTheming(element);

      if (ctrl) angular.element(element[0].querySelector('.md-chip-content'))
          .on('blur', function () {
            ctrl.selectedChip = -1;
          });
    };
  }
}
MdChip.$inject = ["$mdTheming"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChipRemove', MdChipRemove);

/**
 * @ngdoc directive
 * @name mdChipRemove
 * @module material.components.chips
 *
 * @description
 * `<md-chip-remove>`
 * Designates an element to be used as the delete button for a chip. This
 * element is passed as a child of the `md-chips` element.
 *
 * @usage
 * <hljs lang="html">
 *   <md-chips><button md-chip-remove>DEL</button></md-chips>
 * </hljs>
 */


/**
 * MdChipRemove Directive Definition.
 * 
 * @param $compile
 * @param $timeout
 * @returns {{restrict: string, require: string[], link: Function, scope: boolean}}
 * @constructor
 */
function MdChipRemove ($timeout) {
  return {
    restrict: 'A',
    require: '^mdChips',
    scope: false,
    link: postLink
  };

  function postLink(scope, element, attr, ctrl) {
    element.on('click', function(event) {
      scope.$apply(function() {
        ctrl.removeChip(scope.$$replacedScope.$index);
      });
    });

    // Child elements aren't available until after a $timeout tick as they are hidden by an
    // `ng-if`. see http://goo.gl/zIWfuw
    $timeout(function() {
      element.attr({ tabindex: -1, ariaHidden: true });
      element.find('button').attr('tabindex', '-1');
    });
  }
}
MdChipRemove.$inject = ["$timeout"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .directive('mdChipTransclude', MdChipTransclude);

function MdChipTransclude ($compile, $mdUtil) {
  return {
    restrict: 'EA',
    terminal: true,
    link: link,
    scope: false
  };
  function link (scope, element, attr) {
    var ctrl = scope.$parent.$mdChipsCtrl,
        newScope = ctrl.parent.$new(false, ctrl.parent);
    newScope.$$replacedScope = scope;
    newScope.$chip = scope.$chip;
    newScope.$mdChipsCtrl = ctrl;
    element.html(ctrl.$scope.$eval(attr.mdChipTransclude));
    $compile(element.contents())(newScope);
  }
}
MdChipTransclude.$inject = ["$compile", "$mdUtil"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .controller('MdChipsCtrl', MdChipsCtrl);

/**
 * Controller for the MdChips component. Responsible for adding to and
 * removing from the list of chips, marking chips as selected, and binding to
 * the models of various input components.
 *
 * @param $scope
 * @param $mdConstant
 * @param $log
 * @param $element
 * @constructor
 */
function MdChipsCtrl ($scope, $mdConstant, $log, $element, $timeout) {
  /** @type {$timeout} **/
  this.$timeout = $timeout;

  /** @type {Object} */
  this.$mdConstant = $mdConstant;

  /** @type {angular.$scope} */
  this.$scope = $scope;

  /** @type {angular.$scope} */
  this.parent = $scope.$parent;

  /** @type {$log} */
  this.$log = $log;

  /** @type {$element} */
  this.$element = $element;

  /** @type {angular.NgModelController} */
  this.ngModelCtrl = null;

  /** @type {angular.NgModelController} */
  this.userInputNgModelCtrl = null;

  /** @type {Element} */
  this.userInputElement = null;

  /** @type {Array.<Object>} */
  this.items = [];

  /** @type {number} */
  this.selectedChip = -1;


  /**
   * Hidden hint text for how to delete a chip. Used to give context to screen readers.
   * @type {string}
   */
  this.deleteHint = 'Press delete to remove this chip.';

  /**
   * Hidden label for the delete button. Used to give context to screen readers.
   * @type {string}
   */
  this.deleteButtonLabel = 'Remove';

  /**
   * Model used by the input element.
   * @type {string}
   */
  this.chipBuffer = '';

  /**
   * Whether to use the mdOnAppend expression to transform the chip buffer
   * before appending it to the list.
   * @type {boolean}
   */
  this.useMdOnAppend = false;
}
MdChipsCtrl.$inject = ["$scope", "$mdConstant", "$log", "$element", "$timeout"];

/**
 * Handles the keydown event on the input element: <enter> appends the
 * buffer to the chip list, while backspace removes the last chip in the list
 * if the current buffer is empty.
 * @param event
 */
MdChipsCtrl.prototype.inputKeydown = function(event) {
  var chipBuffer = this.getChipBuffer();
  switch (event.keyCode) {
    case this.$mdConstant.KEY_CODE.ENTER:
      if (this.$scope.requireMatch || !chipBuffer) break;
      event.preventDefault();
      this.appendChip(chipBuffer);
      this.resetChipBuffer();
      break;
    case this.$mdConstant.KEY_CODE.BACKSPACE:
      if (chipBuffer) break;
      event.stopPropagation();
      if (this.items.length) this.selectAndFocusChipSafe(this.items.length - 1);
      break;
  }
};

/**
 * Handles the keydown event on the chip elements: backspace removes the selected chip, arrow
 * keys switch which chips is active
 * @param event
 */
MdChipsCtrl.prototype.chipKeydown = function (event) {
  if (this.getChipBuffer()) return;
  switch (event.keyCode) {
    case this.$mdConstant.KEY_CODE.BACKSPACE:
    case this.$mdConstant.KEY_CODE.DELETE:
      if (this.selectedChip < 0) return;
      event.preventDefault();
      this.removeAndSelectAdjacentChip(this.selectedChip);
      break;
    case this.$mdConstant.KEY_CODE.LEFT_ARROW:
      event.preventDefault();
      if (this.selectedChip < 0) this.selectedChip = this.items.length;
      if (this.items.length) this.selectAndFocusChipSafe(this.selectedChip - 1);
      break;
    case this.$mdConstant.KEY_CODE.RIGHT_ARROW:
      event.preventDefault();
      this.selectAndFocusChipSafe(this.selectedChip + 1);
      break;
    case this.$mdConstant.KEY_CODE.ESCAPE:
    case this.$mdConstant.KEY_CODE.TAB:
      if (this.selectedChip < 0) return;
      event.preventDefault();
      this.onFocus();
      break;
  }
};

/**
 * Get the input's placeholder - uses `placeholder` when list is empty and `secondary-placeholder`
 * when the list is non-empty. If `secondary-placeholder` is not provided, `placeholder` is used
 * always.
 */
MdChipsCtrl.prototype.getPlaceholder = function() {
  // Allow `secondary-placeholder` to be blank.
  var useSecondary = (this.items.length &&
      (this.secondaryPlaceholder == '' || this.secondaryPlaceholder));
  return useSecondary ? this.placeholder : this.secondaryPlaceholder;
};

/**
 * Removes chip at {@code index} and selects the adjacent chip.
 * @param index
 */
MdChipsCtrl.prototype.removeAndSelectAdjacentChip = function(index) {
  var selIndex = this.getAdjacentChipIndex(index);
  this.removeChip(index);
  this.$timeout(angular.bind(this, function () {
      this.selectAndFocusChipSafe(selIndex);
  }));
};

/**
 * Sets the selected chip index to -1.
 */
MdChipsCtrl.prototype.resetSelectedChip = function() {
  this.selectedChip = -1;
};

/**
 * Gets the index of an adjacent chip to select after deletion. Adjacency is
 * determined as the next chip in the list, unless the target chip is the
 * last in the list, then it is the chip immediately preceding the target. If
 * there is only one item in the list, -1 is returned (select none).
 * The number returned is the index to select AFTER the target has been
 * removed.
 * If the current chip is not selected, then -1 is returned to select none.
 */
MdChipsCtrl.prototype.getAdjacentChipIndex = function(index) {
  var len = this.items.length - 1;
  return (len == 0) ? -1 :
      (index == len) ? index -1 : index;
};

/**
 * Append the contents of the buffer to the chip list. This method will first
 * call out to the md-on-append method, if provided
 * @param newChip
 */
MdChipsCtrl.prototype.appendChip = function(newChip) {
  if (this.items.indexOf(newChip) + 1) return;
  if (this.useMdOnAppend && this.mdOnAppend) {
    newChip = this.mdOnAppend({'$chip': newChip});
  }
  this.items.push(newChip);
};

/**
 * Sets whether to use the md-on-append expression. This expression is
 * bound to scope and controller in {@code MdChipsDirective} as
 * {@code mdOnAppend}. Due to the nature of directive scope bindings, the
 * controller cannot know on its own/from the scope whether an expression was
 * actually provided.
 */
MdChipsCtrl.prototype.useMdOnAppendExpression = function() {
  this.useMdOnAppend = true;
};

/**
 * Gets the input buffer. The input buffer can be the model bound to the
 * default input item {@code this.chipBuffer}, the {@code selectedItem}
 * model of an {@code md-autocomplete}, or, through some magic, the model
 * bound to any inpput or text area element found within a
 * {@code md-input-container} element.
 * @return {Object|string}
 */
MdChipsCtrl.prototype.getChipBuffer = function() {
  return !this.userInputElement ? this.chipBuffer :
      this.userInputNgModelCtrl ? this.userInputNgModelCtrl.$viewValue :
          this.userInputElement[0].value;
};

/**
 * Resets the input buffer for either the internal input or user provided input element.
 */
MdChipsCtrl.prototype.resetChipBuffer = function() {
  if (this.userInputElement) {
    if (this.userInputNgModelCtrl) {
      this.userInputNgModelCtrl.$setViewValue('');
      this.userInputNgModelCtrl.$render();
    } else {
      this.userInputElement[0].value = '';
    }
  } else {
    this.chipBuffer = '';
  }
};

/**
 * Removes the chip at the given index.
 * @param index
 */
MdChipsCtrl.prototype.removeChip = function(index) {
  this.items.splice(index, 1);
};

MdChipsCtrl.prototype.removeChipAndFocusInput = function (index) {
  this.removeChip(index);
  this.onFocus();
};
/**
 * Selects the chip at `index`,
 * @param index
 */
MdChipsCtrl.prototype.selectAndFocusChipSafe = function(index) {
  if (!this.items.length) {
    this.selectChip(-1);
    this.onFocus();
    return;
  }
  if (index === this.items.length) return this.onFocus();
  index = Math.max(index, 0);
  index = Math.min(index, this.items.length - 1);
  this.selectChip(index);
  this.focusChip(index);
};

/**
 * Marks the chip at the given index as selected.
 * @param index
 */
MdChipsCtrl.prototype.selectChip = function(index) {
  if (index >= -1 && index <= this.items.length) {
    this.selectedChip = index;
  } else {
    this.$log.warn('Selected Chip index out of bounds; ignoring.');
  }
};

/**
 * Selects the chip at `index` and gives it focus.
 * @param index
 */
MdChipsCtrl.prototype.selectAndFocusChip = function(index) {
  this.selectChip(index);
  if (index != -1) {
    this.focusChip(index);
  }
};

/**
 * Call `focus()` on the chip at `index`
 */
MdChipsCtrl.prototype.focusChip = function(index) {
  this.$element[0].querySelector('md-chip[index="' + index + '"] .md-chip-content').focus();
};

/**
 * Configures the required interactions with the ngModel Controller.
 * Specifically, set {@code this.items} to the {@code NgModelCtrl#$viewVale}.
 * @param ngModelCtrl
 */
MdChipsCtrl.prototype.configureNgModel = function(ngModelCtrl) {
  this.ngModelCtrl = ngModelCtrl;

  var self = this;
  ngModelCtrl.$render = function() {
    // model is updated. do something.
    self.items = self.ngModelCtrl.$viewValue;
  };
};

MdChipsCtrl.prototype.onFocus = function () {
  var input = this.$element[0].querySelector('input');
  input && input.focus();
  this.resetSelectedChip();
};

MdChipsCtrl.prototype.onInputFocus = function () {
  this.inputHasFocus = true;
  this.resetSelectedChip();
};

MdChipsCtrl.prototype.onInputBlur = function () {
  this.inputHasFocus = false;
};

/**
 * Configure event bindings on a user-provided input element.
 * @param inputElement
 */
MdChipsCtrl.prototype.configureUserInput = function(inputElement) {
  this.userInputElement = inputElement;

  // Find the NgModelCtrl for the input element
  var ngModelCtrl = inputElement.controller('ngModel');
  // `.controller` will look in the parent as well.
  if (ngModelCtrl != this.ngModelCtrl) {
    this.userInputNgModelCtrl = ngModelCtrl;
  }

  // Bind to keydown and focus events of input
  var scope = this.$scope;
  var ctrl = this;
  inputElement
      .attr({ tabindex: 0 })
      .on('keydown', function(event) { scope.$apply( angular.bind(ctrl, function() { ctrl.inputKeydown(event); })) })
      .on('focus', angular.bind(ctrl, ctrl.onInputFocus))
      .on('blur', angular.bind(ctrl, ctrl.onInputBlur));
};

MdChipsCtrl.prototype.configureAutocomplete = function(ctrl) {

  ctrl.registerSelectedItemWatcher(angular.bind(this, function (item) {
    if (item) {
      this.appendChip(item);
      this.resetChipBuffer();
    }
  }));

  this.$element.find('input')
      .on('focus',angular.bind(this, this.onInputFocus) )
      .on('blur', angular.bind(this, this.onInputBlur) );
};

MdChipsCtrl.prototype.hasFocus = function () {
  return this.inputHasFocus || this.selectedChip >= 0;
};

})();
(function(){
"use strict";

  angular
      .module('material.components.chips')
      .directive('mdChips', MdChips);

  /**
   * @ngdoc directive
   * @name mdChips
   * @module material.components.chips
   *
   * @description
   * `<md-chips>` is an input component for building lists of strings or objects. The list items are
   * displayed as 'chips'. This component can make use of an `<input>` element or an
   * `<md-autocomplete>` element.
   *
   * <strong>Custom `<md-chip-template>` template</strong>
   * A custom template may be provided to render the content of each chip. This is achieved by
   * specifying an `<md-chip-template>` element as a child of `<md-chips>`. Note: Any attributes on
   * `<md-chip-template>` will be dropped as only the innerHTML is used for the chip template. The
   * variables `$chip` and `$index` are available in the scope of `<md-chip-template>`, representing
   * the chip object and its index in the list of chips, respectively.
   * To override the chip delete control, include an element (ideally a button) with the attribute
   * `md-chip-remove`. A click listener to remove the chip will be added automatically. The element
   * is also placed as a sibling to the chip content (on which there are also click listeners) to
   * avoid a nested ng-click situation.
   *
   * <h3> Pending Features </h3>
   * <ul style="padding-left:20px;">
   *
   *   <ul>Style
   *     <li>Colours for hover, press states (ripple?).</li>
   *   </ul>
   *
   *   <ul>List Manipulation
   *     <li>delete item via DEL or backspace keys when selected</li>
   *   </ul>
   *
   *   <ul>Validation
   *     <li>de-dupe values (or support duplicates, but fix the ng-repeat duplicate key issue)</li>
   *     <li>allow a validation callback</li>
   *     <li>hilighting style for invalid chips</li>
   *   </ul>
   *
   *   <ul>Item mutation
   *     <li>Support `
   *       <md-chip-edit>` template, show/hide the edit element on tap/click? double tap/double
   *       click?
   *     </li>
   *   </ul>
   *
   *   <ul>Truncation and Disambiguation (?)
   *     <li>Truncate chip text where possible, but do not truncate entries such that two are
   *     indistinguishable.</li>
   *   </ul>
   *
   *   <ul>Drag and Drop
   *     <li>Drag and drop chips between related `<md-chips>` elements.
   *     </li>
   *   </ul>
   * </ul>
   *
   *  <span style="font-size:.8em;text-align:center">
   *    Warning: This component is a WORK IN PROGRESS. If you use it now,
   *    it will probably break on you in the future.
   *  </span>
   *
   * @param {string=|object=} ng-model A model to bind the list of items to
   * @param {string=} placeholder Placeholder text that will be forwarded to the input.
   * @param {string=} secondary-placeholder Placeholder text that will be forwarded to the input,
   *    displayed when there is at least on item in the list
   * @param {boolean=} readonly Disables list manipulation (deleting or adding list items), hiding
   *    the input and delete buttons
   * @param {expression} md-on-append An expression expected to convert the input string into an
   *    object when adding a chip.
   * @param {string=} delete-hint A string read by screen readers instructing users that pressing
   *    the delete key will remove the chip.
   * @param {string=} delete-button-label A label for the delete button. Also hidden and read by
   *    screen readers.
   *
   * @usage
   * <hljs lang="html">
   *   <md-chips
   *       ng-model="myItems"
   *       placeholder="Add an item"
   *       readonly="isReadOnly">
   *   </md-chips>
   * </hljs>
   *
   */


  var MD_CHIPS_TEMPLATE = '\
      <md-chips-wrap\
          ng-if="!$mdChipsCtrl.readonly || $mdChipsCtrl.items.length > 0"\
          ng-keydown="$mdChipsCtrl.chipKeydown($event)"\
          ng-class="{ \'md-focused\': $mdChipsCtrl.hasFocus() }"\
          class="md-chips">\
        <md-chip ng-repeat="$chip in $mdChipsCtrl.items"\
            index="{{$index}}"\
            ng-class="{\'md-focused\': $mdChipsCtrl.selectedChip == $index}">\
          <div class="md-chip-content"\
              tabindex="-1"\
              aria-hidden="true"\
              ng-focus="!$mdChipsCtrl.readonly && $mdChipsCtrl.selectChip($index)"\
              md-chip-transclude="$mdChipsCtrl.chipContentsTemplate"></div>\
          <div class="md-chip-remove-container"\
              md-chip-transclude="$mdChipsCtrl.chipRemoveTemplate"></div>\
        </md-chip>\
        <div ng-if="!$mdChipsCtrl.readonly && $mdChipsCtrl.ngModelCtrl"\
            class="md-chip-input-container"\
            md-chip-transclude="$mdChipsCtrl.chipInputTemplate"></div>\
        </div>\
      </md-chips-wrap>';

  var CHIP_INPUT_TEMPLATE = '\
        <input\
            tabindex="0"\
            placeholder="{{$mdChipsCtrl.getPlaceholder()}}"\
            aria-label="{{$mdChipsCtrl.getPlaceholder()}}"\
            ng-model="$mdChipsCtrl.chipBuffer"\
            ng-focus="$mdChipsCtrl.onInputFocus()"\
            ng-blur="$mdChipsCtrl.onInputBlur()"\
            ng-keydown="$mdChipsCtrl.inputKeydown($event)">';

  var CHIP_DEFAULT_TEMPLATE = '\
      <span>{{$chip}}</span>';

  var CHIP_REMOVE_TEMPLATE = '\
      <button\
          class="md-chip-remove"\
          ng-if="!$mdChipsCtrl.readonly"\
          ng-click="$mdChipsCtrl.removeChipAndFocusInput($$replacedScope.$index)"\
          type="button"\
          aria-hidden="true"\
          tabindex="-1">\
        <md-icon md-svg-icon="md-close"></md-icon>\
        <span class="md-visually-hidden">\
          {{$mdChipsCtrl.deleteButtonLabel}}\
        </span>\
      </button>';

  /**
   * MDChips Directive Definition
   */
  function MdChips ($mdTheming, $mdUtil, $compile, $log, $timeout) {
    return {
      template: function(element, attrs) {
        // Clone the element into an attribute. By prepending the attribute
        // name with '$', Angular won't write it into the DOM. The cloned
        // element propagates to the link function via the attrs argument,
        // where various contained-elements can be consumed.
        var content = attrs['$mdUserTemplate'] = element.clone();
        return MD_CHIPS_TEMPLATE;
      },
      require: ['mdChips'],
      restrict: 'E',
      controller: 'MdChipsCtrl',
      controllerAs: '$mdChipsCtrl',
      bindToController: true,
      compile: compile,
      scope: {
        readonly: '=readonly',
        placeholder: '@',
        secondaryPlaceholder: '@',
        mdOnAppend: '&',
        deleteHint: '@',
        deleteButtonLabel: '@',
        requireMatch: '=?mdRequireMatch'
      }
    };

    /**
     * Builds the final template for `md-chips` and returns the postLink function.
     *
     * Building the template involves 3 key components:
     * static chips
     * chip template
     * input control
     *
     * If no `ng-model` is provided, only the static chip work needs to be done.
     *
     * If no user-passed `md-chip-template` exists, the default template is used. This resulting
     * template is appended to the chip content element.
     *
     * The remove button may be overridden by passing an element with an md-chip-remove attribute.
     *
     * If an `input` or `md-autocomplete` element is provided by the caller, it is set aside for
     * transclusion later. The transclusion happens in `postLink` as the parent scope is required.
     * If no user input is provided, a default one is appended to the input container node in the
     * template.
     *
     * Static Chips (i.e. `md-chip` elements passed from the caller) are gathered and set aside for
     * transclusion in the `postLink` function.
     *
     *
     * @param element
     * @param attr
     * @returns {Function}
     */
    function compile(element, attr) {
      // Grab the user template from attr and reset the attribute to null.
      var userTemplate = attr['$mdUserTemplate'];
      attr['$mdUserTemplate'] = null;

      // Set the chip remove, chip contents and chip input templates. The link function will put
      // them on the scope for transclusion later.
      var chipRemoveTemplate   = getTemplateByQuery('md-chips>*[md-chip-remove]') || CHIP_REMOVE_TEMPLATE,
          chipContentsTemplate = getTemplateByQuery('md-chips>md-chip-template') || CHIP_DEFAULT_TEMPLATE,
          chipInputTemplate    = getTemplateByQuery('md-chips>md-autocomplete')
              || getTemplateByQuery('md-chips>input')
              || CHIP_INPUT_TEMPLATE,
          staticChips = userTemplate.find('md-chip');

      // Warn of malformed template. See #2545
      if (userTemplate[0].querySelector('md-chip-template>*[md-chip-remove]')) {
        $log.warn('invalid placement of md-chip-remove within md-chip-template.');
      }

      function getTemplateByQuery (query) {
        if (!attr.ngModel) return;
        var element = userTemplate[0].querySelector(query);
        return element && element.outerHTML;
      }

      /**
       * Configures controller and transcludes.
       */
      return function postLink(scope, element, attrs, controllers) {

        $mdUtil.initOptionalProperties(scope, attr);

        $mdTheming(element);
        var mdChipsCtrl = controllers[0];
        mdChipsCtrl.chipContentsTemplate = chipContentsTemplate;
        mdChipsCtrl.chipRemoveTemplate   = chipRemoveTemplate;
        mdChipsCtrl.chipInputTemplate    = chipInputTemplate;

        element
            .attr({ ariaHidden: true, tabindex: -1 })
            .on('focus', function () { mdChipsCtrl.onFocus(); });

        if (attr.ngModel) {
          mdChipsCtrl.configureNgModel(element.controller('ngModel'));

          // If an `md-on-append` attribute was set, tell the controller to use the expression
          // when appending chips.
          if (attrs.mdOnAppend) mdChipsCtrl.useMdOnAppendExpression();

          // The md-autocomplete and input elements won't be compiled until after this directive
          // is complete (due to their nested nature). Wait a tick before looking for them to
          // configure the controller.
          if (chipInputTemplate != CHIP_INPUT_TEMPLATE) {
            $timeout(function() {
              if (chipInputTemplate.indexOf('<md-autocomplete') === 0)
                mdChipsCtrl
                    .configureAutocomplete(element.find('md-autocomplete')
                        .controller('mdAutocomplete'));
              mdChipsCtrl.configureUserInput(element.find('input'));
            });
          }
        }

        // Compile with the parent's scope and prepend any static chips to the wrapper.
        if (staticChips.length > 0) {
          var compiledStaticChips = $compile(staticChips)(scope.$parent);
          $timeout(function() { element.find('md-chips-wrap').prepend(compiledStaticChips); });
        }
      };
    }
  }
  MdChips.$inject = ["$mdTheming", "$mdUtil", "$compile", "$log", "$timeout"];

})();
(function(){
"use strict";

angular
    .module('material.components.chips')
    .controller('MdContactChipsCtrl', MdContactChipsCtrl);



/**
 * Controller for the MdContactChips component
 * @constructor
 */
function MdContactChipsCtrl () {
  /** @type {Object} */
  this.selectedItem = null;

  /** @type {string} */
  this.searchText = '';
}


MdContactChipsCtrl.prototype.queryContact = function(searchText) {
  var results = this.contactQuery({'$query': searchText});
  return this.filterSelected ?
      results.filter(angular.bind(this, this.filterSelectedContacts)) : results;
};


MdContactChipsCtrl.prototype.filterSelectedContacts = function(contact) {
  return this.contacts.indexOf(contact) == -1;
};

})();
(function(){
"use strict";

  angular
      .module('material.components.chips')
      .directive('mdContactChips', MdContactChips);

  /**
   * @ngdoc directive
   * @name mdContactChips
   * @module material.components.chips
   *
   * @description
   * `<md-contact-chips>` is an input component based on `md-chips` and makes use of an
   *    `md-autocomplete` element. The component allows the caller to supply a query expression
   *    which returns  a list of possible contacts. The user can select one of these and add it to
   *    the list of chips.
   *
   * @param {string=|object=} ng-model A model to bind the list of items to
   * @param {string=} placeholder Placeholder text that will be forwarded to the input.
   * @param {string=} secondary-placeholder Placeholder text that will be forwarded to the input,
   *    displayed when there is at least on item in the list
   * @param {expression} md-contacts An expression expected to return contacts matching the search
   *    test, `$query`.
   * @param {string} md-contact-name The field name of the contact object representing the
   *    contact's name.
   * @param {string} md-contact-email The field name of the contact object representing the
   *    contact's email address.
   * @param {string} md-contact-image The field name of the contact object representing the
   *    contact's image.
   *
   *
   * // The following attribute has been removed but may come back.
   * @param {expression=} filter-selected Whether to filter selected contacts from the list of
   *    suggestions shown in the autocomplete.
   *
   *
   *
   * @usage
   * <hljs lang="html">
   *   <md-contact-chips
   *       ng-model="ctrl.contacts"
   *       md-contacts="ctrl.querySearch($query)"
   *       md-contact-name="name"
   *       md-contact-image="image"
   *       md-contact-email="email"
   *       placeholder="To">
   *   </md-contact-chips>
   * </hljs>
   *
   */


  var MD_CONTACT_CHIPS_TEMPLATE = '\
      <md-chips class="md-contact-chips"\
          ng-model="$mdContactChipsCtrl.contacts"\
          md-require-match="$mdContactChipsCtrl.requireMatch"\
          md-autocomplete-snap>\
          <md-autocomplete\
              md-menu-class="md-contact-chips-suggestions"\
              md-selected-item="$mdContactChipsCtrl.selectedItem"\
              md-search-text="$mdContactChipsCtrl.searchText"\
              md-items="item in $mdContactChipsCtrl.queryContact($mdContactChipsCtrl.searchText)"\
              md-item-text="$mdContactChipsCtrl.mdContactName"\
              md-no-cache="true"\
              md-autoselect\
              placeholder="{{$mdContactChipsCtrl.contacts.length == 0 ?\
                  $mdContactChipsCtrl.placeholder : $mdContactChipsCtrl.secondaryPlaceholder}}">\
            <div class="md-contact-suggestion">\
              <img \
                  ng-src="{{item[$mdContactChipsCtrl.contactImage]}}"\
                  alt="{{item[$mdContactChipsCtrl.contactName]}}" />\
              <span class="md-contact-name" md-highlight-text="$mdContactChipsCtrl.searchText">\
                {{item[$mdContactChipsCtrl.contactName]}}\
              </span>\
              <span class="md-contact-email" >{{item[$mdContactChipsCtrl.contactEmail]}}</span>\
            </div>\
          </md-autocomplete>\
          <md-chip-template>\
            <div class="md-contact-avatar">\
              <img \
                  ng-src="{{$chip[$mdContactChipsCtrl.contactImage]}}"\
                  alt="{{$chip[$mdContactChipsCtrl.contactName]}}" />\
            </div>\
            <div class="md-contact-name">\
              {{$chip[$mdContactChipsCtrl.contactName]}}\
            </div>\
          </md-chip-template>\
      </md-chips>';


  /**
   * MDContactChips Directive Definition
   *
   * @param $mdTheming
   * @returns {*}
   * @ngInject
   */
  function MdContactChips ($mdTheming, $mdUtil) {
    return {
      template: function(element, attrs) {
        return MD_CONTACT_CHIPS_TEMPLATE;
      },
      restrict: 'E',
      controller: 'MdContactChipsCtrl',
      controllerAs: '$mdContactChipsCtrl',
      bindToController: true,
      compile: compile,
      scope: {
        contactQuery: '&mdContacts',
        placeholder: '@',
        secondaryPlaceholder: '@',
        contactName: '@mdContactName',
        contactImage: '@mdContactImage',
        contactEmail: '@mdContactEmail',
        contacts: '=ngModel',
        requireMatch: '=?mdRequireMatch'
      }
    };

    function compile(element, attr) {
      return function postLink(scope, element, attrs, controllers) {

        $mdUtil.initOptionalProperties(scope, attr);
        $mdTheming(element);

        element.attr('tabindex', '-1');
      };
    }
  }
  MdContactChips.$inject = ["$mdTheming", "$mdUtil"];

})();
(function(){
"use strict";

/**
 * @ngdoc directive
 * @name mdTab
 * @module material.components.tabs
 *
 * @restrict E
 *
 * @description
 * Use the `<md-tab>` a nested directive used within `<md-tabs>` to specify a tab with a **label** and optional *view content*.
 *
 * If the `label` attribute is not specified, then an optional `<md-tab-label>` tag can be used to specify more
 * complex tab header markup. If neither the **label** nor the **md-tab-label** are specified, then the nested
 * markup of the `<md-tab>` is used as the tab header markup.
 *
 * Please note that if you use `<md-tab-label>`, your content **MUST** be wrapped in the `<md-tab-body>` tag.  This
 * is to define a clear separation between the tab content and the tab label.
 *
 * If a tab **label** has been identified, then any **non-**`<md-tab-label>` markup
 * will be considered tab content and will be transcluded to the internal `<div class="md-tabs-content">` container.
 *
 * This container is used by the TabsController to show/hide the active tab's content view. This synchronization is
 * automatically managed by the internal TabsController whenever the tab selection changes. Selection changes can
 * be initiated via data binding changes, programmatic invocation, or user gestures.
 *
 * @param {string=} label Optional attribute to specify a simple string as the tab label
 * @param {boolean=} disabled If present, disabled tab selection.
 * @param {expression=} md-on-deselect Expression to be evaluated after the tab has been de-selected.
 * @param {expression=} md-on-select Expression to be evaluated after the tab has been selected.
 *
 *
 * @usage
 *
 * <hljs lang="html">
 * <md-tab label="" disabled="" md-on-select="" md-on-deselect="" >
 *   <h3>My Tab content</h3>
 * </md-tab>
 *
 * <md-tab >
 *   <md-tab-label>
 *     <h3>My Tab content</h3>
 *   </md-tab-label>
 *   <md-tab-body>
 *     <p>
 *       Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium,
 *       totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae
 *       dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit,
 *       sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.
 *     </p>
 *   </md-tab-body>
 * </md-tab>
 * </hljs>
 *
 */
angular
    .module('material.components.tabs')
    .directive('mdTab', MdTab);

function MdTab () {
  return {
    require: '^?mdTabs',
    terminal: true,
    template: function (element, attr) {
      var label = getLabel(),
          body  = getTemplate();
      return '' +
          '<md-tab-label>' + label + '</md-tab-label>' +
          '<md-tab-body>' + body + '</md-tab-body>';
      function getLabel () {
        return getLabelElement() || getLabelAttribute() || getElementContents();
        function getLabelAttribute () { return attr.label; }
        function getLabelElement () {
          var label = element.find('md-tab-label').eq(0);
          if (label.length) return label.remove().html();
        }
        function getElementContents () {
          var html = element.html();
          element.empty();
          return html;
        }
      }
      function getTemplate () {
        var content = element.find('md-tab-body').eq(0),
            template = content.length ? content.html() : attr.label ? element.html() : '';
        if (content.length) content.remove();
        else if (attr.label) element.empty();
        return template;
      }
    },
    scope: {
      active:   '=?mdActive',
      disabled: '=?ngDisabled',
      select:   '&?mdOnSelect',
      deselect: '&?mdOnDeselect'
    },
    link: postLink
  };

  function postLink (scope, element, attr, ctrl) {
    if (!ctrl) return;
    var tabs = element.parent()[0].getElementsByTagName('md-tab'),
        index = Array.prototype.indexOf.call(tabs, element[0]),
        body = element.find('md-tab-body').eq(0).remove(),
        label = element.find('md-tab-label').eq(0).remove(),
        data = ctrl.insertTab({
          scope:    scope,
          parent:   scope.$parent,
          index:    index,
          element:  element,
          template: body.html(),
          label:    label.html()
        }, index);

    scope.select   = scope.select   || angular.noop;
    scope.deselect = scope.deselect || angular.noop;

    scope.$watch('active', function (active) { if (active) ctrl.select(data.getIndex()); });
    scope.$watch('disabled', function () { ctrl.refreshIndex(); });
    scope.$watch(
        function () {
          return Array.prototype.indexOf.call(tabs, element[0]);
        },
        function (newIndex) {
          data.index = newIndex;
          ctrl.updateTabOrder();
        }
    );
    scope.$on('$destroy', function () { ctrl.removeTab(data); });

  }
}

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTabItem', MdTabItem);

function MdTabItem () {
  return {
    require: '^?mdTabs',
    link: function link (scope, element, attr, ctrl) {
      if (!ctrl) return;
      ctrl.attachRipple(scope, element);
    }
  };
}

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTabLabel', MdTabLabel);

function MdTabLabel () {
  return { terminal: true };
}


})();
(function(){
"use strict";

angular.module('material.components.tabs')
    .directive('mdTabScroll', MdTabScroll);

function MdTabScroll ($parse) {
  return {
    restrict: 'A',
    compile: function ($element, attr) {
      var fn = $parse(attr.mdTabScroll, null, true);
      return function ngEventHandler (scope, element) {
        element.on('mousewheel', function (event) {
          scope.$apply(function () { fn(scope, { $event: event }); });
        });
      };
    }
  }
}
MdTabScroll.$inject = ["$parse"];

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .controller('MdTabsController', MdTabsController);

/**
 * @ngInject
 */
function MdTabsController ($scope, $element, $window, $timeout, $mdConstant, $mdTabInkRipple,
                           $mdUtil, $animate, $attrs, $compile, $mdTheming) {
  //-- define private properties
  var ctrl       = this,
      locked     = false,
      elements   = getElements(),
      queue      = [],
      destroyed  = false,
      loaded     = false;

  //-- define public properties with change handlers
  defineProperty('focusIndex', handleFocusIndexChange, $scope.selectedIndex || 0);
  defineProperty('offsetLeft', handleOffsetChange, 0);
  defineProperty('hasContent', handleHasContent, false);

  //-- define public properties
  ctrl.scope = $scope;
  ctrl.parent = $scope.$parent;
  ctrl.tabs = [];
  ctrl.lastSelectedIndex = null;
  ctrl.hasFocus = false;
  ctrl.lastClick = true;
  ctrl.shouldPaginate = false;
  ctrl.shouldCenterTabs = shouldCenterTabs();

  //-- define public methods
  ctrl.redirectFocus = redirectFocus;
  ctrl.attachRipple = attachRipple;
  ctrl.shouldStretchTabs = shouldStretchTabs;
  ctrl.insertTab = insertTab;
  ctrl.removeTab = removeTab;
  ctrl.select = select;
  ctrl.scroll = scroll;
  ctrl.nextPage = nextPage;
  ctrl.previousPage = previousPage;
  ctrl.keydown = keydown;
  ctrl.canPageForward = canPageForward;
  ctrl.canPageBack = canPageBack;
  ctrl.refreshIndex = refreshIndex;
  ctrl.incrementSelectedIndex = incrementSelectedIndex;
  ctrl.updateInkBarStyles = $mdUtil.debounce(updateInkBarStyles, 100);
  ctrl.updateTabOrder = $mdUtil.debounce(updateTabOrder, 100);

  init();

  /**
   * Perform initialization for the controller, setup events and watcher(s)
   */
  function init () {
    $scope.selectedIndex = $scope.selectedIndex || 0;
    compileTemplate();
    configureWatchers();
    bindEvents();
    $mdTheming($element);
    $timeout(function () {
      updateHeightFromContent();
      adjustOffset();
      updatePagination();
      ctrl.tabs[$scope.selectedIndex] && ctrl.tabs[$scope.selectedIndex].scope.select();
      loaded = true;
    });
  }

  function compileTemplate () {
    var template = $attrs.$mdTabsTemplate,
        element  = angular.element(elements.data);
    element.html(template);
    $compile(element.contents())(ctrl.parent);
    delete $attrs.$mdTabsTemplate;
  }

  function bindEvents () {
    angular.element($window).on('resize', handleWindowResize);
    angular.element(elements.paging).on('DOMSubtreeModified', ctrl.updateInkBarStyles);
    angular.element(elements.paging).on('DOMSubtreeModified', updatePagination);
  }

  function configureWatchers () {
    $mdUtil.initOptionalProperties($scope, $attrs);
    $attrs.$observe('mdNoBar', function (value) { $scope.noInkBar = angular.isDefined(value); });
    $scope.$watch('selectedIndex', handleSelectedIndexChange);
    $scope.$watch('dynamicHeight', function (value) {
      if (value) $element.addClass('md-dynamic-height');
      else $element.removeClass('md-dynamic-height');
    });
    $scope.$on('$destroy', cleanup);
  }

  /**
   * Remove any events defined by this controller
   */
  function cleanup () {
    destroyed = true;
    angular.element($window).off('resize', handleWindowResize);
    angular.element(elements.paging).off('DOMSubtreeModified', ctrl.updateInkBarStyles);
    angular.element(elements.paging).off('DOMSubtreeModified', updatePagination);
  }

  //-- Change handlers

  /**
   * Add/remove the `md-no-tab-content` class depending on `ctrl.hasContent`
   * @param hasContent
   */
  function handleHasContent (hasContent) {
    $element[hasContent ? 'removeClass' : 'addClass']('md-no-tab-content');
  }

  /**
   * Apply ctrl.offsetLeft to the paging element when it changes
   * @param left
   */
  function handleOffsetChange (left) {
    var newValue = ctrl.shouldCenterTabs ? '' : '-' + left + 'px';
    angular.element(elements.paging).css($mdConstant.CSS.TRANSFORM, 'translate3d(' + newValue + ', 0, 0)');
    $scope.$broadcast('$mdTabsPaginationChanged');
  }

  /**
   * Update the UI whenever `ctrl.focusIndex` is updated
   * @param newIndex
   * @param oldIndex
   */
  function handleFocusIndexChange (newIndex, oldIndex) {
    if (newIndex === oldIndex) return;
    if (!elements.tabs[newIndex]) return;
    adjustOffset();
    redirectFocus();
  }

  /**
   * Update the UI whenever the selected index changes. Calls user-defined select/deselect methods.
   * @param newValue
   * @param oldValue
   */
  function handleSelectedIndexChange (newValue, oldValue) {
    if (newValue === oldValue) return;

    $scope.selectedIndex = getNearestSafeIndex(newValue);
    ctrl.lastSelectedIndex = oldValue;
    ctrl.updateInkBarStyles();
    updateHeightFromContent();
    adjustOffset(newValue);
    $scope.$broadcast('$mdTabsChanged');
    ctrl.tabs[oldValue] && ctrl.tabs[oldValue].scope.deselect();
    ctrl.tabs[newValue] && ctrl.tabs[newValue].scope.select();
  }

  /**
   * Queues up a call to `handleWindowResize` when a resize occurs while the tabs component is
   * hidden.
   */
  function handleResizeWhenVisible () {
    //-- if there is already a watcher waiting for resize, do nothing
    if (handleResizeWhenVisible.watcher) return;
    //-- otherwise, we will abuse the $watch function to check for visible
    handleResizeWhenVisible.watcher = $scope.$watch(function () {
      //-- since we are checking for DOM size, we use $timeout to wait for after the DOM updates
      $timeout(function () {
        //-- if the watcher has already run (ie. multiple digests in one cycle), do nothing
        if (!handleResizeWhenVisible.watcher) return;

        if ($element.prop('offsetParent')) {
          handleResizeWhenVisible.watcher();
          handleResizeWhenVisible.watcher = null;

          //-- we have to trigger our own $apply so that the DOM bindings will update
          handleWindowResize();
        }
      }, 0, false);
    });
  }

  //-- Event handlers / actions

  /**
   * Handle user keyboard interactions
   * @param event
   */
  function keydown (event) {
    switch (event.keyCode) {
      case $mdConstant.KEY_CODE.LEFT_ARROW:
        event.preventDefault();
        incrementSelectedIndex(-1, true);
        break;
      case $mdConstant.KEY_CODE.RIGHT_ARROW:
        event.preventDefault();
        incrementSelectedIndex(1, true);
        break;
      case $mdConstant.KEY_CODE.SPACE:
      case $mdConstant.KEY_CODE.ENTER:
        event.preventDefault();
        if (!locked) $scope.selectedIndex = ctrl.focusIndex;
        break;
    }
    ctrl.lastClick = false;
  }

  /**
   * Update the selected index and trigger a click event on the original `md-tab` element in order
   * to fire user-added click events.
   * @param index
   */
  function select (index) {
    if (!locked) ctrl.focusIndex = $scope.selectedIndex = index;
    ctrl.lastClick = true;
    ctrl.tabs[index].element.triggerHandler('click');
  }

  /**
   * When pagination is on, this makes sure the selected index is in view.
   * @param event
   */
  function scroll (event) {
    if (!ctrl.shouldPaginate) return;
    event.preventDefault();
    ctrl.offsetLeft = fixOffset(ctrl.offsetLeft - event.wheelDelta);
  }

  /**
   * Slides the tabs over approximately one page forward.
   */
  function nextPage () {
    var viewportWidth = elements.canvas.clientWidth,
        totalWidth = viewportWidth + ctrl.offsetLeft,
        i, tab;
    for (i = 0; i < elements.tabs.length; i++) {
      tab = elements.tabs[i];
      if (tab.offsetLeft + tab.offsetWidth > totalWidth) break;
    }
    ctrl.offsetLeft = fixOffset(tab.offsetLeft);
  }

  /**
   * Slides the tabs over approximately one page backward.
   */
  function previousPage () {
    var i, tab;
    for (i = 0; i < elements.tabs.length; i++) {
      tab = elements.tabs[i];
      if (tab.offsetLeft + tab.offsetWidth >= ctrl.offsetLeft) break;
    }
    ctrl.offsetLeft = fixOffset(tab.offsetLeft + tab.offsetWidth - elements.canvas.clientWidth);
  }

  /**
   * Update size calculations when the window is resized.
   */
  function handleWindowResize () {
    $scope.$apply(function () {
      ctrl.lastSelectedIndex = $scope.selectedIndex;
      ctrl.offsetLeft = fixOffset(ctrl.offsetLeft);
      $timeout(ctrl.updateInkBarStyles, 0, false);
      $timeout(updatePagination);
    });
  }

  /**
   * Remove a tab from the data and select the nearest valid tab.
   * @param tabData
   */
  function removeTab (tabData) {
    var selectedIndex = $scope.selectedIndex,
        tab = ctrl.tabs.splice(tabData.getIndex(), 1)[0];
    refreshIndex();
    //-- when removing a tab, if the selected index did not change, we have to manually trigger the
    //   tab select/deselect events
    if ($scope.selectedIndex === selectedIndex && !destroyed) {
      tab.scope.deselect();
      ctrl.tabs[$scope.selectedIndex] && ctrl.tabs[$scope.selectedIndex].scope.select();
    }
    $timeout(function () {
      updatePagination();
      ctrl.offsetLeft = fixOffset(ctrl.offsetLeft);
    });
  }

  /**
   * Create an entry in the tabs array for a new tab at the specified index.
   * @param tabData
   * @param index
   * @returns {*}
   */
  function insertTab (tabData, index) {
    var proto = {
          getIndex: function () { return ctrl.tabs.indexOf(tab); },
          isActive: function () { return this.getIndex() === $scope.selectedIndex; },
          isLeft:   function () { return this.getIndex() < $scope.selectedIndex; },
          isRight:  function () { return this.getIndex() > $scope.selectedIndex; },
          shouldRender: function () { return !$scope.noDisconnect || this.isActive(); },
          hasFocus: function () { return !ctrl.lastClick
              && ctrl.hasFocus && this.getIndex() === ctrl.focusIndex; },
          id:       $mdUtil.nextUid()
        },
        tab = angular.extend(proto, tabData);
    if (angular.isDefined(index)) {
      ctrl.tabs.splice(index, 0, tab);
    } else {
      ctrl.tabs.push(tab);
    }
    processQueue();
    updateHasContent();
    //-- if autoselect is enabled, select the newly added tab
    if (loaded && $scope.autoselect) $timeout(function () { select(ctrl.tabs.indexOf(tab)); });
    $timeout(updatePagination);
    return tab;
  }

  //-- Getter methods

  /**
   * Gathers references to all of the DOM elements used by this controller.
   * @returns {{}}
   */
  function getElements () {
    var elements      = {};

    //-- gather tab bar elements
    elements.wrapper  = $element[0].getElementsByTagName('md-tabs-wrapper')[0];
    elements.data     = $element[0].getElementsByTagName('md-tab-data')[0];
    elements.canvas   = elements.wrapper.getElementsByTagName('md-tabs-canvas')[0];
    elements.paging   = elements.canvas.getElementsByTagName('md-pagination-wrapper')[0];
    elements.tabs     = elements.paging.getElementsByTagName('md-tab-item');
    elements.dummies  = elements.canvas.getElementsByTagName('md-dummy-tab');
    elements.inkBar   = elements.paging.getElementsByTagName('md-ink-bar')[0];

    //-- gather tab content elements
    elements.contentsWrapper = $element[0].getElementsByTagName('md-tabs-content-wrapper')[0];
    elements.contents = elements.contentsWrapper.getElementsByTagName('md-tab-content');

    return elements;
  }

  /**
   * Determines whether or not the left pagination arrow should be enabled.
   * @returns {boolean}
   */
  function canPageBack () {
    return ctrl.offsetLeft > 0;
  }

  /**
   * Determines whether or not the right pagination arrow should be enabled.
   * @returns {*|boolean}
   */
  function canPageForward () {
    var lastTab = elements.tabs[elements.tabs.length - 1];
    return lastTab && lastTab.offsetLeft + lastTab.offsetWidth > elements.canvas.clientWidth +
        ctrl.offsetLeft;
  }

  /**
   * Determines if the UI should stretch the tabs to fill the available space.
   * @returns {*}
   */
  function shouldStretchTabs () {
    switch ($scope.stretchTabs) {
      case 'always': return true;
      case 'never':  return false;
      default:       return !ctrl.shouldPaginate
          && $window.matchMedia('(max-width: 600px)').matches;
    }
  }

  /**
   * Determines if the tabs should appear centered.
   * @returns {string|boolean}
   */
  function shouldCenterTabs () {
    return $scope.centerTabs && !ctrl.shouldPaginate;
  }

  /**
   * Determines if pagination is necessary to display the tabs within the available space.
   * @returns {boolean}
   */
  function shouldPaginate () {
    if ($scope.noPagination || !loaded) return false;
    var canvasWidth = $element.prop('clientWidth');
    angular.forEach(elements.dummies, function (tab) { canvasWidth -= tab.offsetWidth; });
    return canvasWidth < 0;
  }

  /**
   * Finds the nearest tab index that is available.  This is primarily used for when the active
   * tab is removed.
   * @param newIndex
   * @returns {*}
   */
  function getNearestSafeIndex(newIndex) {
    var maxOffset = Math.max(ctrl.tabs.length - newIndex, newIndex),
        i, tab;
    for (i = 0; i <= maxOffset; i++) {
      tab = ctrl.tabs[newIndex + i];
      if (tab && (tab.scope.disabled !== true)) return tab.getIndex();
      tab = ctrl.tabs[newIndex - i];
      if (tab && (tab.scope.disabled !== true)) return tab.getIndex();
    }
    return newIndex;
  }

  //-- Utility methods

  /**
   * Defines a property using a getter and setter in order to trigger a change handler without
   * using `$watch` to observe changes.
   * @param key
   * @param handler
   * @param value
   */
  function defineProperty (key, handler, value) {
    Object.defineProperty(ctrl, key, {
      get: function () { return value; },
      set: function (newValue) {
        var oldValue = value;
        value = newValue;
        handler(newValue, oldValue);
      }
    });
  }

  /**
   * Updates whether or not pagination should be displayed.
   */
  function updatePagination () {
    ctrl.shouldPaginate = shouldPaginate();
    ctrl.shouldCenterTabs = shouldCenterTabs();
    $timeout(function () {
      adjustOffset($scope.selectedIndex);
    });
  }

  /**
   * Re-orders the tabs and updates the selected and focus indexes to their new positions.
   * This is triggered by `tabDirective.js` when the user's tabs have been re-ordered.
   */
  function updateTabOrder () {
    var selectedItem = ctrl.tabs[$scope.selectedIndex],
        focusItem = ctrl.tabs[ctrl.focusIndex];
    ctrl.tabs = ctrl.tabs.sort(function (a, b) {
      return a.index - b.index;
    });
    $scope.selectedIndex = ctrl.tabs.indexOf(selectedItem);
    ctrl.focusIndex = ctrl.tabs.indexOf(focusItem);
  }

  /**
   * This moves the selected or focus index left or right.  This is used by the keydown handler.
   * @param inc
   */
  function incrementSelectedIndex (inc) {
    var newIndex,
        index = ctrl.focusIndex;
    for (newIndex = index + inc;
         ctrl.tabs[newIndex] && ctrl.tabs[newIndex].scope.disabled;
         newIndex += inc) {}
    if (ctrl.tabs[newIndex]) {
      ctrl.focusIndex = newIndex;
    }
  }

  /**
   * This is used to forward focus to dummy elements.  This method is necessary to avoid aniation
   * issues when attempting to focus an item that is out of view.
   */
  function redirectFocus () {
    elements.dummies[ctrl.focusIndex].focus();
  }

  /**
   * Forces the pagination to move the focused tab into view.
   */
  function adjustOffset (index) {
    if (!elements.tabs[index]) return;
    if (ctrl.shouldCenterTabs) return;
    if (index == null) index = ctrl.focusIndex;
    var tab = elements.tabs[index],
        left = tab.offsetLeft,
        right = tab.offsetWidth + left;
    ctrl.offsetLeft = Math.max(ctrl.offsetLeft, fixOffset(right - elements.canvas.clientWidth));
    ctrl.offsetLeft = Math.min(ctrl.offsetLeft, fixOffset(left));
  }

  /**
   * Iterates through all queued functions and clears the queue.  This is used for functions that
   * are called before the UI is ready, such as size calculations.
   */
  function processQueue () {
    queue.forEach(function (func) { $timeout(func); });
    queue = [];
  }

  /**
   * Determines if the tab content area is needed.
   */
  function updateHasContent () {
    var hasContent = false;
    angular.forEach(ctrl.tabs, function (tab) {
      if (tab.template) hasContent = true;
    });
    ctrl.hasContent = hasContent;
  }

  /**
   * Moves the indexes to their nearest valid values.
   */
  function refreshIndex () {
    $scope.selectedIndex = getNearestSafeIndex($scope.selectedIndex);
    ctrl.focusIndex = getNearestSafeIndex(ctrl.focusIndex);
  }

  /**
   * Calculates the content height of the current tab.
   * @returns {*}
   */
  function updateHeightFromContent () {
    if (!$scope.dynamicHeight) return $element.css('height', '');
    if (!ctrl.tabs.length) return queue.push(updateHeightFromContent);
    var tabContent    = elements.contents[$scope.selectedIndex],
        contentHeight = tabContent ? tabContent.offsetHeight : 0,
        tabsHeight    = elements.wrapper.offsetHeight,
        newHeight     = contentHeight + tabsHeight,
        currentHeight = $element.prop('clientHeight');
    if (currentHeight === newHeight) return;
    locked = true;
    $animate
        .animate(
          $element,
          { height: currentHeight + 'px' },
          { height: newHeight + 'px'}
        )
        .then(function () {
          $element.css('height', '');
          locked = false;
        });
  }

  /**
   * Repositions the ink bar to the selected tab.
   * @returns {*}
   */
  function updateInkBarStyles () {
    if (!elements.tabs[$scope.selectedIndex]) return;
    if (!ctrl.tabs.length) return queue.push(ctrl.updateInkBarStyles);
    //-- if the element is not visible, we will not be able to calculate sizes until it is
    //-- we should treat that as a resize event rather than just updating the ink bar
    if (!$element.prop('offsetParent')) return handleResizeWhenVisible();
    var index = $scope.selectedIndex,
        totalWidth = elements.paging.offsetWidth,
        tab = elements.tabs[index],
        left = tab.offsetLeft,
        right = totalWidth - left - tab.offsetWidth;
    updateInkBarClassName();
    angular.element(elements.inkBar).css({ left: left + 'px', right: right + 'px' });
  }

  /**
   * Adds left/right classes so that the ink bar will animate properly.
   */
  function updateInkBarClassName () {
    var newIndex = $scope.selectedIndex,
        oldIndex = ctrl.lastSelectedIndex,
        ink = angular.element(elements.inkBar);
    if (!angular.isNumber(oldIndex)) return;
    if (newIndex < oldIndex) {
      ink.addClass('md-left').removeClass('md-right');
    } else if (newIndex > oldIndex) {
      ink.addClass('md-right').removeClass('md-left');
    }
  }

  /**
   * Takes an offset value and makes sure that it is within the min/max allowed values.
   * @param value
   * @returns {*}
   */
  function fixOffset (value) {
    if (!elements.tabs.length || !ctrl.shouldPaginate) return 0;
    var lastTab = elements.tabs[elements.tabs.length - 1],
        totalWidth = lastTab.offsetLeft + lastTab.offsetWidth;
    value = Math.max(0, value);
    value = Math.min(totalWidth - elements.canvas.clientWidth, value);
    return value;
  }

  /**
   * Attaches a ripple to the tab item element.
   * @param scope
   * @param element
   */
  function attachRipple (scope, element) {
    var options = { colorElement: angular.element(elements.inkBar) };
    $mdTabInkRipple.attach(scope, element, options);
  }
}
MdTabsController.$inject = ["$scope", "$element", "$window", "$timeout", "$mdConstant", "$mdTabInkRipple", "$mdUtil", "$animate", "$attrs", "$compile", "$mdTheming"];

})();
(function(){
"use strict";

/**
 * @ngdoc directive
 * @name mdTabs
 * @module material.components.tabs
 *
 * @restrict E
 *
 * @description
 * The `<md-tabs>` directive serves as the container for 1..n `<md-tab>` child directives to produces a Tabs components.
 * In turn, the nested `<md-tab>` directive is used to specify a tab label for the **header button** and a [optional] tab view
 * content that will be associated with each tab button.
 *
 * Below is the markup for its simplest usage:
 *
 *  <hljs lang="html">
 *  <md-tabs>
 *    <md-tab label="Tab #1"></md-tab>
 *    <md-tab label="Tab #2"></md-tab>
 *    <md-tab label="Tab #3"></md-tab>
 *  </md-tabs>
 *  </hljs>
 *
 * Tabs supports three (3) usage scenarios:
 *
 *  1. Tabs (buttons only)
 *  2. Tabs with internal view content
 *  3. Tabs with external view content
 *
 * **Tab-only** support is useful when tab buttons are used for custom navigation regardless of any other components, content, or views.
 * **Tabs with internal views** are the traditional usages where each tab has associated view content and the view switching is managed internally by the Tabs component.
 * **Tabs with external view content** is often useful when content associated with each tab is independently managed and data-binding notifications announce tab selection changes.
 *
 * Additional features also include:
 *
 * *  Content can include any markup.
 * *  If a tab is disabled while active/selected, then the next tab will be auto-selected.
 *
 * ### Explanation of tab stretching
 *
 * Initially, tabs will have an inherent size.  This size will either be defined by how much space is needed to accommodate their text or set by the user through CSS.  Calculations will be based on this size.
 *
 * On mobile devices, tabs will be expanded to fill the available horizontal space.  When this happens, all tabs will become the same size.
 *
 * On desktops, by default, stretching will never occur.
 *
 * This default behavior can be overridden through the `md-stretch-tabs` attribute.  Here is a table showing when stretching will occur:
 *
 * `md-stretch-tabs` | mobile    | desktop
 * ------------------|-----------|--------
 * `auto`            | stretched | ---
 * `always`          | stretched | stretched
 * `never`           | ---       | ---
 *
 * @param {integer=} md-selected Index of the active/selected tab
 * @param {boolean=} md-no-ink If present, disables ink ripple effects.
 * @param {boolean=} md-no-bar If present, disables the selection ink bar.
 * @param {string=}  md-align-tabs Attribute to indicate position of tab buttons: `bottom` or `top`; default is `top`
 * @param {string=} md-stretch-tabs Attribute to indicate whether or not to stretch tabs: `auto`, `always`, or `never`; default is `auto`
 * @param {boolean=} md-dynamic-height When enabled, the tab wrapper will resize based on the contents of the selected tab
 * @param {boolean=} md-center-tabs When enabled, tabs will be centered provided there is no need for pagination
 * @param {boolean=} md-no-pagination When enabled, pagination will remain off
 * @param {boolean=} md-swipe-content When enabled, swipe gestures will be enabled for the content area to jump between tabs
 * @param {boolean=} md-no-disconnect If your tab content has background tasks (ie. event listeners), you will want to include this to prevent the scope from being disconnected
 * @param {boolean=} md-autoselect When present, any tabs added after the initial load will be automatically selected
 *
 * @usage
 * <hljs lang="html">
 * <md-tabs md-selected="selectedIndex" >
 *   <img ng-src="img/angular.png" class="centered">
 *   <md-tab
 *       ng-repeat="tab in tabs | orderBy:predicate:reversed"
 *       md-on-select="onTabSelected(tab)"
 *       md-on-deselect="announceDeselected(tab)"
 *       ng-disabled="tab.disabled">
 *     <md-tab-label>
 *       {{tab.title}}
 *       <img src="img/removeTab.png" ng-click="removeTab(tab)" class="delete">
 *     </md-tab-label>
 *     <md-tab-body>
 *       {{tab.content}}
 *     </md-tab-body>
 *   </md-tab>
 * </md-tabs>
 * </hljs>
 *
 */
angular
    .module('material.components.tabs')
    .directive('mdTabs', MdTabs);

function MdTabs ($mdTheming, $mdUtil, $compile) {
  return {
    scope: {
      noPagination:  '=?mdNoPagination',
      dynamicHeight: '=?mdDynamicHeight',
      centerTabs:    '=?mdCenterTabs',
      selectedIndex: '=?mdSelected',
      stretchTabs:   '@?mdStretchTabs',
      swipeContent:  '=?mdSwipeContent',
      noDisconnect:  '=?mdNoDisconnect',
      autoselect:    '=?mdAutoselect'
    },
    template: function (element, attr) {
      attr["$mdTabsTemplate"] = element.html();
      return '\
        <md-tabs-wrapper ng-class="{ \'md-stretch-tabs\': $mdTabsCtrl.shouldStretchTabs() }">\
          <md-tab-data></md-tab-data>\
          <md-prev-button\
              tabindex="-1"\
              role="button"\
              aria-label="Previous Page"\
              aria-disabled="{{!$mdTabsCtrl.canPageBack()}}"\
              ng-class="{ \'md-disabled\': !$mdTabsCtrl.canPageBack() }"\
              ng-if="$mdTabsCtrl.shouldPaginate"\
              ng-click="$mdTabsCtrl.previousPage()">\
            <md-icon md-svg-icon="md-tabs-arrow"></md-icon>\
          </md-prev-button>\
          <md-next-button\
              tabindex="-1"\
              role="button"\
              aria-label="Next Page"\
              aria-disabled="{{!$mdTabsCtrl.canPageForward()}}"\
              ng-class="{ \'md-disabled\': !$mdTabsCtrl.canPageForward() }"\
              ng-if="$mdTabsCtrl.shouldPaginate"\
              ng-click="$mdTabsCtrl.nextPage()">\
            <md-icon md-svg-icon="md-tabs-arrow"></md-icon>\
          </md-next-button>\
          <md-tabs-canvas\
              tabindex="0"\
              aria-activedescendant="tab-item-{{$mdTabsCtrl.tabs[$mdTabsCtrl.focusIndex].id}}"\
              ng-focus="$mdTabsCtrl.redirectFocus()"\
              ng-class="{\
                  \'md-paginated\': $mdTabsCtrl.shouldPaginate,\
                  \'md-center-tabs\': $mdTabsCtrl.shouldCenterTabs\
              }"\
              ng-keydown="$mdTabsCtrl.keydown($event)"\
              role="tablist">\
            <md-pagination-wrapper\
                ng-class="{ \'md-center-tabs\': $mdTabsCtrl.shouldCenterTabs }"\
                md-tab-scroll="$mdTabsCtrl.scroll($event)">\
              <md-tab-item\
                  tabindex="-1"\
                  class="md-tab"\
                  style="max-width: {{ tabWidth ? tabWidth + \'px\' : \'none\' }}"\
                  ng-repeat="tab in $mdTabsCtrl.tabs"\
                  role="tab"\
                  aria-controls="tab-content-{{tab.id}}"\
                  aria-selected="{{tab.isActive()}}"\
                  aria-disabled="{{tab.scope.disabled || \'false\'}}"\
                  ng-click="$mdTabsCtrl.select(tab.getIndex())"\
                  ng-class="{\
                      \'md-active\':    tab.isActive(),\
                      \'md-focused\':   tab.hasFocus(),\
                      \'md-disabled\':  tab.scope.disabled\
                  }"\
                  ng-disabled="tab.scope.disabled"\
                  md-swipe-left="$mdTabsCtrl.nextPage()"\
                  md-swipe-right="$mdTabsCtrl.previousPage()"\
                  md-template="tab.label"\
                  md-scope="tab.parent"></md-tab-item>\
              <md-ink-bar ng-hide="noInkBar"></md-ink-bar>\
            </md-pagination-wrapper>\
            <div class="md-visually-hidden md-dummy-wrapper">\
              <md-dummy-tab\
                  class="md-tab"\
                  tabindex="-1"\
                  id="tab-item-{{tab.id}}"\
                  role="tab"\
                  aria-controls="tab-content-{{tab.id}}"\
                  aria-selected="{{tab.isActive()}}"\
                  aria-disabled="{{tab.scope.disabled || \'false\'}}"\
                  ng-focus="$mdTabsCtrl.hasFocus = true"\
                  ng-blur="$mdTabsCtrl.hasFocus = false"\
                  ng-repeat="tab in $mdTabsCtrl.tabs"\
                  md-template="tab.label"\
                  md-scope="tab.parent"></md-dummy-tab>\
            </div>\
          </md-tabs-canvas>\
        </md-tabs-wrapper>\
        <md-tabs-content-wrapper ng-show="$mdTabsCtrl.hasContent">\
          <md-tab-content\
              id="tab-content-{{tab.id}}"\
              role="tabpanel"\
              aria-labelledby="tab-item-{{tab.id}}"\
              md-swipe-left="swipeContent && $mdTabsCtrl.incrementSelectedIndex(1)"\
              md-swipe-right="swipeContent && $mdTabsCtrl.incrementSelectedIndex(-1)"\
              ng-if="$mdTabsCtrl.hasContent"\
              ng-repeat="(index, tab) in $mdTabsCtrl.tabs"\
              md-connected-if="tab.isActive()"\
              ng-class="{\
                \'md-no-transition\': $mdTabsCtrl.lastSelectedIndex == null,\
                \'md-active\':        tab.isActive(),\
                \'md-left\':          tab.isLeft(),\
                \'md-right\':         tab.isRight(),\
                \'md-no-scroll\':     dynamicHeight\
              }">\
            <div\
                md-template="tab.template"\
                md-scope="tab.parent"\
                ng-if="tab.shouldRender()"></div>\
          </md-tab-content>\
        </md-tabs-content-wrapper>\
      ';
    },
    controller: 'MdTabsController',
    controllerAs: '$mdTabsCtrl'
  };
}
MdTabs.$inject = ["$mdTheming", "$mdUtil", "$compile"];

})();
(function(){
"use strict";

angular
    .module('material.components.tabs')
    .directive('mdTemplate', MdTemplate);

function MdTemplate ($compile, $mdUtil, $timeout) {
  return {
    restrict: 'A',
    link: link,
    scope: {
      template: '=mdTemplate',
      compileScope: '=mdScope',
      connected: '=?mdConnectedIf'
    },
    require: '^?mdTabs'
  };
  function link (scope, element, attr, ctrl) {
    if (!ctrl) return;
    var compileScope = scope.compileScope.$new();
    element.html(scope.template);
    $compile(element.contents())(compileScope);
    return $timeout(handleScope);
    function handleScope () {
      scope.$watch('connected', function (value) { value === false ? disconnect() : reconnect(); });
      scope.$on('$destroy', reconnect);
    }
    function disconnect () {
      if (ctrl.scope.noDisconnect) return;
      $mdUtil.disconnectScope(compileScope);
    }
    function reconnect () {
      if (ctrl.scope.noDisconnect) return;
      $mdUtil.reconnectScope(compileScope);
    }
  }
}
MdTemplate.$inject = ["$compile", "$mdUtil", "$timeout"];

})();
(function(){ 
angular.module("material.core").constant("$MD_THEME_CSS", "/* mixin definition ; sets LTR and RTL within the same style call */md-autocomplete.md-THEME_NAME-theme {  background: '{{background-50}}'; }  md-autocomplete.md-THEME_NAME-theme[disabled] {    background: '{{background-100}}'; }  md-autocomplete.md-THEME_NAME-theme button md-icon path {    fill: '{{background-600}}'; }  md-autocomplete.md-THEME_NAME-theme button:after {    background: '{{background-600-0.3}}'; }.md-autocomplete-suggestions.md-THEME_NAME-theme {  background: '{{background-50}}'; }  .md-autocomplete-suggestions.md-THEME_NAME-theme li {    color: '{{background-900}}'; }    .md-autocomplete-suggestions.md-THEME_NAME-theme li .highlight {      color: '{{background-600}}'; }    .md-autocomplete-suggestions.md-THEME_NAME-theme li:hover, .md-autocomplete-suggestions.md-THEME_NAME-theme li.selected {      background: '{{background-200}}'; }md-backdrop.md-opaque.md-THEME_NAME-theme {  background-color: '{{foreground-4-0.5}}'; }md-bottom-sheet.md-THEME_NAME-theme {  background-color: '{{background-50}}';  border-top-color: '{{background-300}}'; }  md-bottom-sheet.md-THEME_NAME-theme.md-list md-list-item {    color: '{{foreground-1}}'; }  md-bottom-sheet.md-THEME_NAME-theme .md-subheader {    background-color: '{{background-50}}'; }  md-bottom-sheet.md-THEME_NAME-theme .md-subheader {    color: '{{foreground-1}}'; }a.md-button.md-THEME_NAME-theme, .md-button.md-THEME_NAME-theme {  border-radius: 3px; }  a.md-button.md-THEME_NAME-theme:not([disabled]):hover, .md-button.md-THEME_NAME-theme:not([disabled]):hover {    background-color: '{{background-500-0.2}}'; }  a.md-button.md-THEME_NAME-theme:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme:not([disabled]).md-focused {    background-color: '{{background-500-0.2}}'; }  a.md-button.md-THEME_NAME-theme:not([disabled]).md-icon-button:hover, .md-button.md-THEME_NAME-theme:not([disabled]).md-icon-button:hover {    background-color: transparent; }  a.md-button.md-THEME_NAME-theme.md-fab, .md-button.md-THEME_NAME-theme.md-fab {    border-radius: 50%;    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab md-icon, .md-button.md-THEME_NAME-theme.md-fab md-icon {      color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover {      background-color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused {      background-color: '{{accent-A700}}'; }  a.md-button.md-THEME_NAME-theme.md-icon-button, .md-button.md-THEME_NAME-theme.md-icon-button {    border-radius: 50%; }  a.md-button.md-THEME_NAME-theme.md-primary, .md-button.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }    a.md-button.md-THEME_NAME-theme.md-primary.md-raised, a.md-button.md-THEME_NAME-theme.md-primary.md-fab, .md-button.md-THEME_NAME-theme.md-primary.md-raised, .md-button.md-THEME_NAME-theme.md-primary.md-fab {      color: '{{primary-contrast}}';      background-color: '{{primary-color}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]) md-icon {        color: '{{primary-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]):hover {        background-color: '{{primary-color}}'; }      a.md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-primary.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-primary.md-fab:not([disabled]).md-focused {        background-color: '{{primary-600}}'; }    a.md-button.md-THEME_NAME-theme.md-primary:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-primary:not([disabled]) md-icon {      color: '{{primary-color}}'; }  a.md-button.md-THEME_NAME-theme.md-fab, .md-button.md-THEME_NAME-theme.md-fab {    border-radius: 50%;    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]) .md-icon, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]) .md-icon {      color: '{{accent-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]):hover {      background-color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-fab:not([disabled]).md-focused {      background-color: '{{accent-A700}}'; }  a.md-button.md-THEME_NAME-theme.md-raised, .md-button.md-THEME_NAME-theme.md-raised {    color: '{{background-contrast}}';    background-color: '{{background-50}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]) .md-icon, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]) .md-icon {      color: '{{background-contrast}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]):hover {      background-color: '{{background-50}}'; }    a.md-button.md-THEME_NAME-theme.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-raised:not([disabled]).md-focused {      background-color: '{{background-200}}'; }  a.md-button.md-THEME_NAME-theme.md-warn, .md-button.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }    a.md-button.md-THEME_NAME-theme.md-warn.md-raised, a.md-button.md-THEME_NAME-theme.md-warn.md-fab, .md-button.md-THEME_NAME-theme.md-warn.md-raised, .md-button.md-THEME_NAME-theme.md-warn.md-fab {      color: '{{warn-contrast}}';      background-color: '{{warn-color}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]) md-icon {        color: '{{warn-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]):hover {        background-color: '{{warn-color}}'; }      a.md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-warn.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-warn.md-fab:not([disabled]).md-focused {        background-color: '{{warn-700}}'; }    a.md-button.md-THEME_NAME-theme.md-warn:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-warn:not([disabled]) md-icon {      color: '{{warn-color}}'; }  a.md-button.md-THEME_NAME-theme.md-accent, .md-button.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }    a.md-button.md-THEME_NAME-theme.md-accent.md-raised, a.md-button.md-THEME_NAME-theme.md-accent.md-fab, .md-button.md-THEME_NAME-theme.md-accent.md-raised, .md-button.md-THEME_NAME-theme.md-accent.md-fab {      color: '{{accent-contrast}}';      background-color: '{{accent-color}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]) md-icon, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]) md-icon {        color: '{{accent-contrast}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]):hover, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]):hover, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]):hover {        background-color: '{{accent-color}}'; }      a.md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]).md-focused, a.md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-accent.md-raised:not([disabled]).md-focused, .md-button.md-THEME_NAME-theme.md-accent.md-fab:not([disabled]).md-focused {        background-color: '{{accent-700}}'; }    a.md-button.md-THEME_NAME-theme.md-accent:not([disabled]) md-icon, .md-button.md-THEME_NAME-theme.md-accent:not([disabled]) md-icon {      color: '{{accent-color}}'; }  a.md-button.md-THEME_NAME-theme[disabled], a.md-button.md-THEME_NAME-theme.md-raised[disabled], a.md-button.md-THEME_NAME-theme.md-fab[disabled], a.md-button.md-THEME_NAME-theme.md-accent[disabled], a.md-button.md-THEME_NAME-theme.md-warn[disabled], .md-button.md-THEME_NAME-theme[disabled], .md-button.md-THEME_NAME-theme.md-raised[disabled], .md-button.md-THEME_NAME-theme.md-fab[disabled], .md-button.md-THEME_NAME-theme.md-accent[disabled], .md-button.md-THEME_NAME-theme.md-warn[disabled] {    color: '{{foreground-3}}';    cursor: not-allowed; }    a.md-button.md-THEME_NAME-theme[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-raised[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-fab[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-accent[disabled] md-icon, a.md-button.md-THEME_NAME-theme.md-warn[disabled] md-icon, .md-button.md-THEME_NAME-theme[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-raised[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-fab[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-accent[disabled] md-icon, .md-button.md-THEME_NAME-theme.md-warn[disabled] md-icon {      color: '{{foreground-3}}'; }  a.md-button.md-THEME_NAME-theme.md-raised[disabled], a.md-button.md-THEME_NAME-theme.md-fab[disabled], .md-button.md-THEME_NAME-theme.md-raised[disabled], .md-button.md-THEME_NAME-theme.md-fab[disabled] {    background-color: '{{foreground-4}}'; }  a.md-button.md-THEME_NAME-theme[disabled], .md-button.md-THEME_NAME-theme[disabled] {    background-color: transparent; }md-card.md-THEME_NAME-theme {  background-color: '{{background-color}}';  border-radius: 2px; }  md-card.md-THEME_NAME-theme .md-card-image {    border-radius: 2px 2px 0 0; }md-checkbox.md-THEME_NAME-theme .md-ripple {  color: '{{accent-600}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-ripple {  color: '{{background-600}}'; }md-checkbox.md-THEME_NAME-theme.md-checked.md-focused .md-container:before {  background-color: '{{accent-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-icon {  background-color: '{{accent-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary .md-ripple {  color: '{{primary-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ripple {  color: '{{background-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-icon {  background-color: '{{primary-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked.md-focused .md-container:before {  background-color: '{{primary-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn .md-ripple {  color: '{{warn-600}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn .md-icon {  border-color: '{{foreground-2}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-icon {  background-color: '{{warn-color-0.87}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked.md-focused:not([disabled]) .md-container:before {  background-color: '{{warn-color-0.26}}'; }md-checkbox.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-icon:after {  border-color: '{{background-200}}'; }md-checkbox.md-THEME_NAME-theme[disabled] .md-icon {  border-color: '{{foreground-3}}'; }md-checkbox.md-THEME_NAME-theme[disabled].md-checked .md-icon {  background-color: '{{foreground-3}}'; }md-checkbox.md-THEME_NAME-theme[disabled] .md-label {  color: '{{foreground-3}}'; }md-chips.md-THEME_NAME-theme .md-chips {  box-shadow: 0 1px '{{background-300}}'; }  md-chips.md-THEME_NAME-theme .md-chips.md-focused {    box-shadow: 0 2px '{{primary-color}}'; }md-chips.md-THEME_NAME-theme .md-chip {  background: '{{background-300}}';  color: '{{background-800}}'; }  md-chips.md-THEME_NAME-theme .md-chip.md-focused {    background: '{{primary-color}}';    color: '{{primary-contrast}}'; }    md-chips.md-THEME_NAME-theme .md-chip.md-focused md-icon {      color: '{{primary-contrast}}'; }md-chips.md-THEME_NAME-theme md-chip-remove .md-button md-icon path {  fill: '{{background-500}}'; }.md-contact-suggestion span.md-contact-email {  color: '{{background-400}}'; }md-content.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }md-dialog.md-THEME_NAME-theme {  border-radius: 4px;  background-color: '{{background-color}}'; }  md-dialog.md-THEME_NAME-theme.md-content-overflow .md-actions {    border-top-color: '{{foreground-4}}'; }md-divider.md-THEME_NAME-theme {  border-top-color: '{{foreground-4}}'; }md-icon.md-THEME_NAME-theme {  color: '{{foreground-2}}'; }  md-icon.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }  md-icon.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }  md-icon.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }md-input-container.md-THEME_NAME-theme .md-input {  color: '{{foreground-1}}';  border-color: '{{foreground-4}}';  text-shadow: '{{foreground-shadow}}'; }  md-input-container.md-THEME_NAME-theme .md-input::-webkit-input-placeholder, md-input-container.md-THEME_NAME-theme .md-input::-moz-placeholder, md-input-container.md-THEME_NAME-theme .md-input:-moz-placeholder, md-input-container.md-THEME_NAME-theme .md-input:-ms-input-placeholder {    color: '{{foreground-3}}'; }md-input-container.md-THEME_NAME-theme > md-icon {  color: '{{foreground-1}}'; }md-input-container.md-THEME_NAME-theme label, md-input-container.md-THEME_NAME-theme .md-placeholder {  text-shadow: '{{foreground-shadow}}';  color: '{{foreground-3}}'; }md-input-container.md-THEME_NAME-theme ng-messages, md-input-container.md-THEME_NAME-theme [ng-message], md-input-container.md-THEME_NAME-theme [data-ng-message], md-input-container.md-THEME_NAME-theme [x-ng-message] {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-has-value label {  color: '{{foreground-2}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused .md-input {  border-color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused label {  color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused md-icon {  color: '{{primary-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-accent .md-input {  border-color: '{{accent-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-accent label {  color: '{{accent-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-warn .md-input {  border-color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme:not(.md-input-invalid).md-input-focused.md-warn label {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid .md-input {  border-color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid.md-input-focused label {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme.md-input-invalid ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid data-ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid x-ng-message, md-input-container.md-THEME_NAME-theme.md-input-invalid [ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid [data-ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid [x-ng-message], md-input-container.md-THEME_NAME-theme.md-input-invalid .md-char-counter {  color: '{{warn-500}}'; }md-input-container.md-THEME_NAME-theme .md-input[disabled], [disabled] md-input-container.md-THEME_NAME-theme .md-input {  border-bottom-color: transparent;  color: '{{foreground-3}}';  background-image: linear-gradient(to right, '{{foreground-3}}' 0%, '{{foreground-3}}' 33%, transparent 0%);  background-image: -ms-linear-gradient(left, transparent 0%, '{{foreground-3}}' 100%); }md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text h3, md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text h4, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text h3, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text h4 {  color: '{{foreground-1}}'; }md-list.md-THEME_NAME-theme md-list-item.md-2-line .md-list-item-text p, md-list.md-THEME_NAME-theme md-list-item.md-3-line .md-list-item-text p {  color: '{{foreground-2}}'; }md-list.md-THEME_NAME-theme .md-proxy-focus.md-focused div.md-no-style {  background-color: '{{background-100}}'; }md-list.md-THEME_NAME-theme md-list-item > md-icon {  color: '{{foreground-2}}'; }  md-list.md-THEME_NAME-theme md-list-item > md-icon.md-highlight {    color: '{{primary-color}}'; }    md-list.md-THEME_NAME-theme md-list-item > md-icon.md-highlight.md-accent {      color: '{{accent-color}}'; }md-list.md-THEME_NAME-theme md-list-item button {  background-color: '{{background-color}}'; }  md-list.md-THEME_NAME-theme md-list-item button.md-button:not([disabled]):hover {    background-color: '{{background-color}}'; }md-menu-content.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }  md-menu-content.md-THEME_NAME-theme md-menu-divider {    background-color: '{{foreground-4}}'; }md-progress-circular.md-THEME_NAME-theme {  background-color: transparent; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-gap {    border-top-color: '{{primary-color}}';    border-bottom-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme .md-inner .md-right .md-half-circle {    border-top-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-right .md-half-circle {    border-right-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme .md-inner .md-left .md-half-circle {    border-left-color: '{{primary-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-gap {    border-top-color: '{{warn-color}}';    border-bottom-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-right .md-half-circle {    border-top-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-right .md-half-circle {    border-right-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-warn .md-inner .md-left .md-half-circle {    border-left-color: '{{warn-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-gap {    border-top-color: '{{accent-color}}';    border-bottom-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-left .md-half-circle, md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-right .md-half-circle {    border-top-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-right .md-half-circle {    border-right-color: '{{accent-color}}'; }  md-progress-circular.md-THEME_NAME-theme.md-accent .md-inner .md-left .md-half-circle {    border-left-color: '{{accent-color}}'; }md-progress-linear.md-THEME_NAME-theme .md-container {  background-color: '{{primary-100}}'; }md-progress-linear.md-THEME_NAME-theme .md-bar {  background-color: '{{primary-color}}'; }md-progress-linear.md-THEME_NAME-theme.md-warn .md-container {  background-color: '{{warn-100}}'; }md-progress-linear.md-THEME_NAME-theme.md-warn .md-bar {  background-color: '{{warn-color}}'; }md-progress-linear.md-THEME_NAME-theme.md-accent .md-container {  background-color: '{{accent-100}}'; }md-progress-linear.md-THEME_NAME-theme.md-accent .md-bar {  background-color: '{{accent-color}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-warn .md-bar1 {  background-color: '{{warn-100}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-warn .md-dashed:before {  background: radial-gradient('{{warn-100}}' 0%, '{{warn-100}}' 16%, transparent 42%); }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-accent .md-bar1 {  background-color: '{{accent-100}}'; }md-progress-linear.md-THEME_NAME-theme[md-mode=buffer].md-accent .md-dashed:before {  background: radial-gradient('{{accent-100}}' 0%, '{{accent-100}}' 16%, transparent 42%); }md-radio-button.md-THEME_NAME-theme .md-off {  border-color: '{{foreground-2}}'; }md-radio-button.md-THEME_NAME-theme .md-on {  background-color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme.md-checked .md-off {  border-color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme.md-checked .md-ink-ripple {  color: '{{accent-color-0.87}}'; }md-radio-button.md-THEME_NAME-theme .md-container .md-ripple {  color: '{{accent-600}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-on, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-on {  background-color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-off {  border-color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary.md-checked .md-ink-ripple {  color: '{{primary-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-primary .md-container .md-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-primary .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-primary .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-primary .md-container .md-ripple {  color: '{{primary-600}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-on, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-on, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-on {  background-color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-off, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-off, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-off {  border-color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-ink-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn.md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-checked .md-ink-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn.md-checked .md-ink-ripple {  color: '{{warn-color-0.87}}'; }md-radio-group.md-THEME_NAME-theme:not([disabled]) .md-warn .md-container .md-ripple, md-radio-group.md-THEME_NAME-theme:not([disabled]).md-warn .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]) .md-warn .md-container .md-ripple, md-radio-button.md-THEME_NAME-theme:not([disabled]).md-warn .md-container .md-ripple {  color: '{{warn-600}}'; }md-radio-group.md-THEME_NAME-theme[disabled], md-radio-button.md-THEME_NAME-theme[disabled] {  color: '{{foreground-3}}'; }  md-radio-group.md-THEME_NAME-theme[disabled] .md-container .md-off, md-radio-button.md-THEME_NAME-theme[disabled] .md-container .md-off {    border-color: '{{foreground-3}}'; }  md-radio-group.md-THEME_NAME-theme[disabled] .md-container .md-on, md-radio-button.md-THEME_NAME-theme[disabled] .md-container .md-on {    border-color: '{{foreground-3}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked .md-container:before {  background-color: '{{accent-color-0.26}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked:not([disabled]).md-primary .md-container:before {  background-color: '{{primary-color-0.26}}'; }md-radio-group.md-THEME_NAME-theme.md-focused:not(:empty) .md-checked.md-primary .md-container:before {  background-color: '{{warn-color-0.26}}'; }md-select.md-THEME_NAME-theme.ng-invalid.ng-dirty .md-select-label {  color: '{{warn-500}}' !important;  border-bottom-color: '{{warn-500}}' !important; }md-select.md-THEME_NAME-theme:not([disabled]):focus .md-select-label {  border-bottom-color: '{{primary-color}}';  color: '{{ foreground-1 }}'; }  md-select.md-THEME_NAME-theme:not([disabled]):focus .md-select-label.md-placeholder {    color: '{{ foreground-1 }}'; }md-select.md-THEME_NAME-theme:not([disabled]):focus.md-accent .md-select-label {  border-bottom-color: '{{accent-color}}'; }md-select.md-THEME_NAME-theme:not([disabled]):focus.md-warn .md-select-label {  border-bottom-color: '{{warn-color}}'; }md-select.md-THEME_NAME-theme[disabled] .md-select-label {  color: '{{foreground-3}}'; }  md-select.md-THEME_NAME-theme[disabled] .md-select-label.md-placeholder {    color: '{{foreground-3}}'; }md-select.md-THEME_NAME-theme .md-select-label {  border-bottom-color: '{{foreground-4}}'; }  md-select.md-THEME_NAME-theme .md-select-label.md-placeholder {    color: '{{foreground-2}}'; }md-select-menu.md-THEME_NAME-theme md-optgroup {  color: '{{foreground-2}}'; }  md-select-menu.md-THEME_NAME-theme md-optgroup md-option {    color: '{{foreground-1}}'; }md-select-menu.md-THEME_NAME-theme md-option[selected] {  color: '{{primary-500}}'; }  md-select-menu.md-THEME_NAME-theme md-option[selected]:focus {    color: '{{primary-600}}'; }  md-select-menu.md-THEME_NAME-theme md-option[selected].md-accent {    color: '{{accent-500}}'; }    md-select-menu.md-THEME_NAME-theme md-option[selected].md-accent:focus {      color: '{{accent-600}}'; }md-select-menu.md-THEME_NAME-theme md-option:focus:not([selected]) {  background: '{{background-200}}'; }md-sidenav.md-THEME_NAME-theme {  background-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme .md-track {  background-color: '{{foreground-3}}'; }md-slider.md-THEME_NAME-theme .md-track-ticks {  background-color: '{{foreground-4}}'; }md-slider.md-THEME_NAME-theme .md-focus-thumb {  background-color: '{{foreground-2}}'; }md-slider.md-THEME_NAME-theme .md-focus-ring {  border-color: '{{foreground-4}}'; }md-slider.md-THEME_NAME-theme .md-disabled-thumb {  border-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme.md-min .md-thumb:after {  background-color: '{{background-color}}'; }md-slider.md-THEME_NAME-theme .md-track.md-track-fill {  background-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-thumb:after {  border-color: '{{accent-color}}';  background-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-sign {  background-color: '{{accent-color}}'; }  md-slider.md-THEME_NAME-theme .md-sign:after {    border-top-color: '{{accent-color}}'; }md-slider.md-THEME_NAME-theme .md-thumb-text {  color: '{{accent-contrast}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-track.md-track-fill {  background-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-thumb:after {  border-color: '{{warn-color}}';  background-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-sign {  background-color: '{{warn-color}}'; }  md-slider.md-THEME_NAME-theme.md-warn .md-sign:after {    border-top-color: '{{warn-color}}'; }md-slider.md-THEME_NAME-theme.md-warn .md-thumb-text {  color: '{{warn-contrast}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-track.md-track-fill {  background-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-thumb:after {  border-color: '{{primary-color}}';  background-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-sign {  background-color: '{{primary-color}}'; }  md-slider.md-THEME_NAME-theme.md-primary .md-sign:after {    border-top-color: '{{primary-color}}'; }md-slider.md-THEME_NAME-theme.md-primary .md-thumb-text {  color: '{{primary-contrast}}'; }md-slider.md-THEME_NAME-theme[disabled] .md-thumb:after {  border-color: '{{foreground-3}}'; }md-slider.md-THEME_NAME-theme[disabled]:not(.md-min) .md-thumb:after {  background-color: '{{foreground-3}}'; }.md-subheader.md-THEME_NAME-theme {  color: '{{ foreground-2-0.23 }}';  background-color: '{{background-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-primary {    color: '{{primary-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-accent {    color: '{{accent-color}}'; }  .md-subheader.md-THEME_NAME-theme.md-warn {    color: '{{warn-color}}'; }md-switch.md-THEME_NAME-theme .md-thumb {  background-color: '{{background-50}}'; }md-switch.md-THEME_NAME-theme .md-bar {  background-color: '{{background-500}}'; }md-switch.md-THEME_NAME-theme.md-checked .md-thumb {  background-color: '{{accent-color}}'; }md-switch.md-THEME_NAME-theme.md-checked .md-bar {  background-color: '{{accent-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-focused .md-thumb:before {  background-color: '{{accent-color-0.26}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary .md-thumb {  background-color: '{{primary-color}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary .md-bar {  background-color: '{{primary-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-primary.md-focused .md-thumb:before {  background-color: '{{primary-color-0.26}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn .md-thumb {  background-color: '{{warn-color}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn .md-bar {  background-color: '{{warn-color-0.5}}'; }md-switch.md-THEME_NAME-theme.md-checked.md-warn.md-focused .md-thumb:before {  background-color: '{{warn-color-0.26}}'; }md-switch.md-THEME_NAME-theme[disabled] .md-thumb {  background-color: '{{background-400}}'; }md-switch.md-THEME_NAME-theme[disabled] .md-bar {  background-color: '{{foreground-4}}'; }md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: transparent;  border-color: '{{foreground-4}}'; }md-tabs.md-THEME_NAME-theme .md-paginator md-icon {  color: '{{primary-color}}'; }md-tabs.md-THEME_NAME-theme md-ink-bar {  color: '{{accent-color}}';  background: '{{accent-color}}'; }md-tabs.md-THEME_NAME-theme .md-tab {  color: '{{foreground-2}}'; }  md-tabs.md-THEME_NAME-theme .md-tab[disabled] {    color: '{{foreground-3}}'; }  md-tabs.md-THEME_NAME-theme .md-tab.md-active, md-tabs.md-THEME_NAME-theme .md-tab.md-focused {    color: '{{primary-color}}'; }  md-tabs.md-THEME_NAME-theme .md-tab.md-focused {    background: '{{primary-color-0.1}}'; }  md-tabs.md-THEME_NAME-theme .md-tab .md-ripple-container {    color: '{{accent-100}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-tabs-wrapper {  background-color: '{{accent-color}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]) {  color: '{{accent-100}}'; }  md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-focused {    color: '{{accent-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-accent md-tab-item:not([disabled]).md-focused {    background: '{{accent-contrast-0.1}}'; }md-tabs.md-THEME_NAME-theme.md-accent md-ink-bar {  color: '{{primary-600-1}}';  background: '{{primary-600-1}}'; }md-tabs.md-THEME_NAME-theme.md-primary md-tabs-wrapper {  background-color: '{{primary-color}}'; }md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]) {  color: '{{primary-100}}'; }  md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-focused {    color: '{{primary-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-primary md-tab-item:not([disabled]).md-focused {    background: '{{primary-contrast-0.1}}'; }md-tabs.md-THEME_NAME-theme.md-warn md-tabs-wrapper {  background-color: '{{warn-color}}'; }md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]) {  color: '{{warn-100}}'; }  md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-active, md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-focused {    color: '{{warn-contrast}}'; }  md-tabs.md-THEME_NAME-theme.md-warn md-tab-item:not([disabled]).md-focused {    background: '{{warn-contrast-0.1}}'; }md-toolbar > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{primary-color}}'; }md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{primary-100}}'; }  md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{primary-contrast}}'; }  md-toolbar > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{primary-contrast-0.1}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{accent-color}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{accent-100}}'; }  md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{accent-contrast}}'; }  md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{accent-contrast-0.1}}'; }md-toolbar.md-accent > md-tabs.md-THEME_NAME-theme md-ink-bar {  color: '{{primary-600-1}}';  background: '{{primary-600-1}}'; }md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tabs-wrapper {  background-color: '{{warn-color}}'; }md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]) {  color: '{{warn-100}}'; }  md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-active, md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    color: '{{warn-contrast}}'; }  md-toolbar.md-warn > md-tabs.md-THEME_NAME-theme md-tab-item:not([disabled]).md-focused {    background: '{{warn-contrast-0.1}}'; }md-toast.md-THEME_NAME-theme {  background-color: #323232;  color: '{{background-50}}'; }  md-toast.md-THEME_NAME-theme .md-button {    color: '{{background-50}}'; }    md-toast.md-THEME_NAME-theme .md-button.md-highlight {      color: '{{primary-A200}}'; }      md-toast.md-THEME_NAME-theme .md-button.md-highlight.md-accent {        color: '{{accent-A200}}'; }      md-toast.md-THEME_NAME-theme .md-button.md-highlight.md-warn {        color: '{{warn-A200}}'; }md-toolbar.md-THEME_NAME-theme {  background-color: '{{primary-color}}';  color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme md-icon {    color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme .md-button {    color: '{{primary-contrast}}'; }  md-toolbar.md-THEME_NAME-theme.md-accent {    background-color: '{{accent-color}}';    color: '{{accent-contrast}}'; }  md-toolbar.md-THEME_NAME-theme.md-warn {    background-color: '{{warn-color}}';    color: '{{warn-contrast}}'; }md-tooltip.md-THEME_NAME-theme {  color: '{{background-A100}}'; }  md-tooltip.md-THEME_NAME-theme .md-background {    background-color: '{{foreground-2}}'; }"); 
})();


})(window, window.angular);
/*
 jQuery UI Sortable plugin wrapper

 @param [ui-sortable] {object} Options to pass to $.fn.sortable() merged onto ui.config
 */
angular.module('ui.sortable', [])
  .value('uiSortableConfig',{})
  .directive('uiSortable', [
    'uiSortableConfig', '$timeout', '$log',
    function(uiSortableConfig, $timeout, $log) {
      return {
        require: '?ngModel',
        scope: {
          ngModel: '=',
          uiSortable: '='
        },
        link: function(scope, element, attrs, ngModel) {
          var savedNodes;

          function combineCallbacks(first,second){
            if(second && (typeof second === 'function')) {
              return function() {
                first.apply(this, arguments);
                second.apply(this, arguments);
              };
            }
            return first;
          }

          function getSortableWidgetInstance(element) {
            // this is a fix to support jquery-ui prior to v1.11.x
            // otherwise we should be using `element.sortable('instance')`
            var data = element.data('ui-sortable');
            if (data && typeof data === 'object' && data.widgetFullName === 'ui-sortable') {
              return data;
            }
            return null;
          }

          function hasSortingHelper (element, ui) {
            var helperOption = element.sortable('option','helper');
            return helperOption === 'clone' || (typeof helperOption === 'function' && ui.item.sortable.isCustomHelperUsed());
          }

          // thanks jquery-ui
          function isFloating (item) {
            return (/left|right/).test(item.css('float')) || (/inline|table-cell/).test(item.css('display'));
          }

          function getElementScope(elementScopes, element) {
            var result = null;
            for (var i = 0; i < elementScopes.length; i++) {
              var x = elementScopes[i];
              if (x.element[0] === element[0]) {
                result = x.scope;
                break;
              }
            }
            return result;
          }

          function afterStop(e, ui) {
            ui.item.sortable._destroy();
          }

          var opts = {};

          // directive specific options
          var directiveOpts = {
            'ui-floating': undefined
          };

          var callbacks = {
            receive: null,
            remove:null,
            start:null,
            stop:null,
            update:null
          };

          var wrappers = {
            helper: null
          };

          angular.extend(opts, directiveOpts, uiSortableConfig, scope.uiSortable);

          if (!angular.element.fn || !angular.element.fn.jquery) {
            $log.error('ui.sortable: jQuery should be included before AngularJS!');
            return;
          }

          if (ngModel) {

            // When we add or remove elements, we need the sortable to 'refresh'
            // so it can find the new/removed elements.
            scope.$watch('ngModel.length', function() {
              // Timeout to let ng-repeat modify the DOM
              $timeout(function() {
                // ensure that the jquery-ui-sortable widget instance
                // is still bound to the directive's element
                if (!!getSortableWidgetInstance(element)) {
                  element.sortable('refresh');
                }
              }, 0, false);
            });

            callbacks.start = function(e, ui) {
              if (opts['ui-floating'] === 'auto') {
                // since the drag has started, the element will be
                // absolutely positioned, so we check its siblings
                var siblings = ui.item.siblings();
                var sortableWidgetInstance = getSortableWidgetInstance(angular.element(e.target));
                sortableWidgetInstance.floating = isFloating(siblings);
              }

              // Save the starting position of dragged item
              ui.item.sortable = {
                model: ngModel.$modelValue[ui.item.index()],
                index: ui.item.index(),
                source: ui.item.parent(),
                sourceModel: ngModel.$modelValue,
                cancel: function () {
                  ui.item.sortable._isCanceled = true;
                },
                isCanceled: function () {
                  return ui.item.sortable._isCanceled;
                },
                isCustomHelperUsed: function () {
                  return !!ui.item.sortable._isCustomHelperUsed;
                },
                _isCanceled: false,
                _isCustomHelperUsed: ui.item.sortable._isCustomHelperUsed,
                _destroy: function () {
                  angular.forEach(ui.item.sortable, function(value, key) {
                    ui.item.sortable[key] = undefined;
                  });
                }
              };
            };

            callbacks.activate = function(e, ui) {
              // We need to make a copy of the current element's contents so
              // we can restore it after sortable has messed it up.
              // This is inside activate (instead of start) in order to save
              // both lists when dragging between connected lists.
              savedNodes = element.contents();

              // If this list has a placeholder (the connected lists won't),
              // don't inlcude it in saved nodes.
              var placeholder = element.sortable('option','placeholder');

              // placeholder.element will be a function if the placeholder, has
              // been created (placeholder will be an object).  If it hasn't
              // been created, either placeholder will be false if no
              // placeholder class was given or placeholder.element will be
              // undefined if a class was given (placeholder will be a string)
              if (placeholder && placeholder.element && typeof placeholder.element === 'function') {
                var phElement = placeholder.element();
                // workaround for jquery ui 1.9.x,
                // not returning jquery collection
                phElement = angular.element(phElement);

                // exact match with the placeholder's class attribute to handle
                // the case that multiple connected sortables exist and
                // the placehoilder option equals the class of sortable items
                var excludes = element.find('[class="' + phElement.attr('class') + '"]:not([ng-repeat], [data-ng-repeat])');

                savedNodes = savedNodes.not(excludes);
              }

              // save the directive's scope so that it is accessible from ui.item.sortable
              var connectedSortables = ui.item.sortable._connectedSortables || [];

              connectedSortables.push({
                element: element,
                scope: scope
              });

              ui.item.sortable._connectedSortables = connectedSortables;
            };

            callbacks.update = function(e, ui) {
              // Save current drop position but only if this is not a second
              // update that happens when moving between lists because then
              // the value will be overwritten with the old value
              if(!ui.item.sortable.received) {
                ui.item.sortable.dropindex = ui.item.index();
                var droptarget = ui.item.parent();
                ui.item.sortable.droptarget = droptarget;

                var droptargetScope = getElementScope(ui.item.sortable._connectedSortables, droptarget);
                ui.item.sortable.droptargetModel = droptargetScope.ngModel;

                // Cancel the sort (let ng-repeat do the sort for us)
                // Don't cancel if this is the received list because it has
                // already been canceled in the other list, and trying to cancel
                // here will mess up the DOM.
                element.sortable('cancel');
              }

              // Put the nodes back exactly the way they started (this is very
              // important because ng-repeat uses comment elements to delineate
              // the start and stop of repeat sections and sortable doesn't
              // respect their order (even if we cancel, the order of the
              // comments are still messed up).
              if (hasSortingHelper(element, ui) && !ui.item.sortable.received &&
                  element.sortable( 'option', 'appendTo' ) === 'parent') {
                // restore all the savedNodes except .ui-sortable-helper element
                // (which is placed last). That way it will be garbage collected.
                savedNodes = savedNodes.not(savedNodes.last());
              }
              savedNodes.appendTo(element);

              // If this is the target connected list then
              // it's safe to clear the restored nodes since:
              // update is currently running and
              // stop is not called for the target list.
              if(ui.item.sortable.received) {
                savedNodes = null;
              }

              // If received is true (an item was dropped in from another list)
              // then we add the new item to this list otherwise wait until the
              // stop event where we will know if it was a sort or item was
              // moved here from another list
              if(ui.item.sortable.received && !ui.item.sortable.isCanceled()) {
                scope.$apply(function () {
                  ngModel.$modelValue.splice(ui.item.sortable.dropindex, 0,
                                             ui.item.sortable.moved);
                });
              }
            };

            callbacks.stop = function(e, ui) {
              // If the received flag hasn't be set on the item, this is a
              // normal sort, if dropindex is set, the item was moved, so move
              // the items in the list.
              if(!ui.item.sortable.received &&
                 ('dropindex' in ui.item.sortable) &&
                 !ui.item.sortable.isCanceled()) {

                scope.$apply(function () {
                  ngModel.$modelValue.splice(
                    ui.item.sortable.dropindex, 0,
                    ngModel.$modelValue.splice(ui.item.sortable.index, 1)[0]);
                });
              } else {
                // if the item was not moved, then restore the elements
                // so that the ngRepeat's comment are correct.
                if ((!('dropindex' in ui.item.sortable) || ui.item.sortable.isCanceled()) &&
                    !hasSortingHelper(element, ui)) {
                  savedNodes.appendTo(element);
                }
              }

              // It's now safe to clear the savedNodes
              // since stop is the last callback.
              savedNodes = null;
            };

            callbacks.receive = function(e, ui) {
              // An item was dropped here from another list, set a flag on the
              // item.
              ui.item.sortable.received = true;
            };

            callbacks.remove = function(e, ui) {
              // Workaround for a problem observed in nested connected lists.
              // There should be an 'update' event before 'remove' when moving
              // elements. If the event did not fire, cancel sorting.
              if (!('dropindex' in ui.item.sortable)) {
                element.sortable('cancel');
                ui.item.sortable.cancel();
              }

              // Remove the item from this list's model and copy data into item,
              // so the next list can retrive it
              if (!ui.item.sortable.isCanceled()) {
                scope.$apply(function () {
                  ui.item.sortable.moved = ngModel.$modelValue.splice(
                    ui.item.sortable.index, 1)[0];
                });
              }
            };

            wrappers.helper = function (inner) {
              if (inner && typeof inner === 'function') {
                return function (e, item) {
                  var innerResult = inner.apply(this, arguments);
                  item.sortable._isCustomHelperUsed = item !== innerResult;
                  return innerResult;
                };
              }
              return inner;
            };

            scope.$watch('uiSortable', function(newVal /*, oldVal*/) {
              // ensure that the jquery-ui-sortable widget instance
              // is still bound to the directive's element
              var sortableWidgetInstance = getSortableWidgetInstance(element);
              if (!!sortableWidgetInstance) {
                angular.forEach(newVal, function(value, key) {
                  // if it's a custom option of the directive,
                  // handle it approprietly
                  if (key in directiveOpts) {
                    if (key === 'ui-floating' && (value === false || value === true)) {
                      sortableWidgetInstance.floating = value;
                    }

                    opts[key] = value;
                    return;
                  }

                  if (callbacks[key]) {
                    if( key === 'stop' ){
                      // call apply after stop
                      value = combineCallbacks(
                        value, function() { scope.$apply(); });

                      value = combineCallbacks(value, afterStop);
                    }
                    // wrap the callback
                    value = combineCallbacks(callbacks[key], value);
                  } else if (wrappers[key]) {
                    value = wrappers[key](value);
                  }

                  opts[key] = value;
                  element.sortable('option', key, value);
                });
              }
            }, true);

            angular.forEach(callbacks, function(value, key) {
              opts[key] = combineCallbacks(value, opts[key]);
              if( key === 'stop' ){
                opts[key] = combineCallbacks(opts[key], afterStop);
              }
            });

          } else {
            $log.info('ui.sortable: ngModel not provided!', element);
          }

          // Create sortable
          element.sortable(opts);
        }
      };
    }
  ]);

var fabric=fabric||{version:"1.5.0"};"undefined"!=typeof exports&&(exports.fabric=fabric),"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window,window.fabric=fabric):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.document.createWindow?fabric.window=fabric.document.createWindow():fabric.window=fabric.document.parentWindow),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width"],fabric.DPI=96,fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",function(){function t(t,e){this.__eventListeners[t]&&(e?fabric.util.removeFromArray(this.__eventListeners[t],e):this.__eventListeners[t].length=0)}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"==typeof arguments[0])for(var r in e)t.call(this,r,e[r]);else t.call(this,e,i);return this}}function r(t,e){if(this.__eventListeners){var i=this.__eventListeners[t];if(i){for(var r=0,s=i.length;s>r;r++)i[r].call(this,e||{});return this}}}fabric.Observable={observe:e,stopObserving:i,fire:r,on:e,off:i,trigger:r}}(),fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var t=0,e=arguments.length;e>t;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(t,e,i){var r=this.getObjects();return i?r[e]=t:r.splice(e,0,t),this._onObjectAdded(t),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var t,e=this.getObjects(),i=0,r=arguments.length;r>i;i++)t=e.indexOf(arguments[i]),-1!==t&&(e.splice(t,1),this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&this.renderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),r=i.length;r--;)t.call(e,i[r],r,i);return this},getObjects:function(t){return"undefined"==typeof t?this._objects:this._objects.filter(function(e){return e.type===t})},item:function(t){return this.getObjects()[t]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(t){return this.getObjects().indexOf(t)>-1},complexity:function(){return this.getObjects().reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},function(t){var e=Math.sqrt,i=Math.atan2,r=Math.PI/180;fabric.util={removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*r},radiansToDegrees:function(t){return t/r},rotatePoint:function(t,e,i){var r=Math.sin(i),s=Math.cos(i);t.subtractEquals(e);var n=t.x*s-t.y*r,o=t.x*r+t.y*s;return new fabric.Point(n,o).addEquals(e)},transformPoint:function(t,e,i){return i?new fabric.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new fabric.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},invertTransform:function(t){var e=t.slice(),i=1/(t[0]*t[3]-t[1]*t[2]);e=[i*t[3],-i*t[1],-i*t[2],i*t[0],0,0];var r=fabric.util.transformPoint({x:t[4],y:t[5]},e);return e[4]=-r.x,e[5]=-r.y,e},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),r=parseFloat(t);switch(e||(e=fabric.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return r*fabric.DPI/25.4;case"cm":return r*fabric.DPI/2.54;case"in":return r*fabric.DPI;case"pt":return r*fabric.DPI/72;case"pc":return r*fabric.DPI/72*12;case"em":return r*e;default:return r}},falseFunction:function(){return!1},getKlass:function(t,e){return t=fabric.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),fabric.util.resolveNamespace(e)[t]},resolveNamespace:function(e){if(!e)return fabric;for(var i=e.split("."),r=i.length,s=t||fabric.window,n=0;r>n;++n)s=s[i[n]];return s},loadImage:function(t,e,i,r){if(!t)return void(e&&e.call(i,t));var s=fabric.util.createImage();s.onload=function(){e&&e.call(i,s),s=s.onload=s.onerror=null},s.onerror=function(){fabric.log("Error loading "+s.src),e&&e.call(i,null,!0),s=s.onload=s.onerror=null},0!==t.indexOf("data")&&"undefined"!=typeof r&&(s.crossOrigin=r),s.src=t},enlivenObjects:function(t,e,i,r){function s(){++o===a&&e&&e(n)}t=t||[];var n=[],o=0,a=t.length;return a?void t.forEach(function(t,e){if(!t||!t.type)return void s();var o=fabric.util.getKlass(t.type,i);o.async?o.fromObject(t,function(i,o){o||(n[e]=i,r&&r(t,n[e])),s()}):(n[e]=o.fromObject(t),r&&r(t,n[e]),s())}):void(e&&e(n))},groupSVGElements:function(t,e,i){var r;return r=new fabric.PathGroup(t,e),"undefined"!=typeof i&&r.setSourcePath(i),r},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var r=0,s=i.length;s>r;r++)i[r]in t&&(e[i[r]]=t[i[r]])},drawDashedLine:function(t,r,s,n,o,a){var h=n-r,c=o-s,l=e(h*h+c*c),u=i(c,h),f=a.length,d=0,g=!0;for(t.save(),t.translate(r,s),t.moveTo(0,0),t.rotate(u),r=0;l>r;)r+=a[d++%f],r>l&&(r=l),t[g?"lineTo":"moveTo"](r,0),g=!g;t.restore()},createCanvasElement:function(t){return t||(t=fabric.document.createElement("canvas")),t.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(t),t},createImage:function(){return fabric.isLikelyNode?new(require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(t){for(var e=t.prototype,i=e.stateProperties.length;i--;){var r=e.stateProperties[i],s=r.charAt(0).toUpperCase()+r.slice(1),n="set"+s,o="get"+s;e[o]||(e[o]=function(t){return new Function('return this.get("'+t+'")')}(r)),e[n]||(e[n]=function(t){return new Function("value",'return this.set("'+t+'", value)')}(r))}},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,r){r>0&&(e>r?e-=r:e=0,i>r?i-=r:i=0);for(var s=!0,n=t.getImageData(e,i,2*r||1,2*r||1),o=3,a=n.data.length;a>o;o+=4){var h=n.data[o];if(s=0>=h,s===!1)break}return n=null,s}}}("undefined"!=typeof exports?exports:this),function(){function t(t,r,n,o,h,c,l){var u=a.call(arguments);if(s[u])return s[u];var f=Math.PI,d=l*f/180,g=Math.sin(d),p=Math.cos(d),v=0,b=0;n=Math.abs(n),o=Math.abs(o);var m=-p*t*.5-g*r*.5,y=-p*r*.5+g*t*.5,_=n*n,x=o*o,C=y*y,S=m*m,w=_*x-_*C-x*S,O=0;if(0>w){var T=Math.sqrt(1-w/(_*x));n*=T,o*=T}else O=(h===c?-1:1)*Math.sqrt(w/(_*C+x*S));var k=O*n*y/o,j=-O*o*m/n,A=p*k-g*j+.5*t,P=g*k+p*j+.5*r,E=i(1,0,(m-k)/n,(y-j)/o),M=i((m-k)/n,(y-j)/o,(-m-k)/n,(-y-j)/o);0===c&&M>0?M-=2*f:1===c&&0>M&&(M+=2*f);for(var I=Math.ceil(Math.abs(M/f*2)),D=[],L=M/I,F=8/3*Math.sin(L/4)*Math.sin(L/4)/Math.sin(L/2),R=E+L,B=0;I>B;B++)D[B]=e(E,R,p,g,n,o,A,P,F,v,b),v=D[B][4],b=D[B][5],E=R,R+=L;return s[u]=D,D}function e(t,e,i,r,s,o,h,c,l,u,f){var d=a.call(arguments);if(n[d])return n[d];var g=Math.cos(t),p=Math.sin(t),v=Math.cos(e),b=Math.sin(e),m=i*s*v-r*o*b+h,y=r*s*v+i*o*b+c,_=u+l*(-i*s*p-r*o*g),x=f+l*(-r*s*p+i*o*g),C=m+l*(i*s*b+r*o*v),S=y+l*(r*s*b-i*o*v);return n[d]=[_,x,C,S,m,y],n[d]}function i(t,e,i,r){var s=Math.atan2(e,t),n=Math.atan2(r,i);return n>=s?n-s:2*Math.PI-(s-n)}function r(t,e,i,r,s,n,h,c){var l=a.call(arguments);if(o[l])return o[l];var u,f,d,g,p,v,b,m,y=Math.sqrt,_=Math.min,x=Math.max,C=Math.abs,S=[],w=[[],[]];f=6*t-12*i+6*s,u=-3*t+9*i-9*s+3*h,d=3*i-3*t;for(var O=0;2>O;++O)if(O>0&&(f=6*e-12*r+6*n,u=-3*e+9*r-9*n+3*c,d=3*r-3*e),C(u)<1e-12){if(C(f)<1e-12)continue;g=-d/f,g>0&&1>g&&S.push(g)}else b=f*f-4*d*u,0>b||(m=y(b),p=(-f+m)/(2*u),p>0&&1>p&&S.push(p),v=(-f-m)/(2*u),v>0&&1>v&&S.push(v));for(var T,k,j,A=S.length,P=A;A--;)g=S[A],j=1-g,T=j*j*j*t+3*j*j*g*i+3*j*g*g*s+g*g*g*h,w[0][A]=T,k=j*j*j*e+3*j*j*g*r+3*j*g*g*n+g*g*g*c,w[1][A]=k;w[0][P]=t,w[1][P]=e,w[0][P+1]=h,w[1][P+1]=c;var E=[{x:_.apply(null,w[0]),y:_.apply(null,w[1])},{x:x.apply(null,w[0]),y:x.apply(null,w[1])}];return o[l]=E,E}var s={},n={},o={},a=Array.prototype.join;fabric.util.drawArc=function(e,i,r,s){for(var n=s[0],o=s[1],a=s[2],h=s[3],c=s[4],l=s[5],u=s[6],f=[[],[],[],[]],d=t(l-i,u-r,n,o,h,c,a),g=0,p=d.length;p>g;g++)f[g][0]=d[g][0]+i,f[g][1]=d[g][1]+r,f[g][2]=d[g][2]+i,f[g][3]=d[g][3]+r,f[g][4]=d[g][4]+i,f[g][5]=d[g][5]+r,e.bezierCurveTo.apply(e,f[g])},fabric.util.getBoundsOfArc=function(e,i,s,n,o,a,h,c,l){for(var u=0,f=0,d=[],g=[],p=t(c-e,l-i,s,n,a,h,o),v=[[],[]],b=0,m=p.length;m>b;b++)d=r(u,f,p[b][0],p[b][1],p[b][2],p[b][3],p[b][4],p[b][5]),v[0].x=d[0].x+e,v[0].y=d[0].y+i,v[1].x=d[1].x+e,v[1].y=d[1].y+i,g.push(v[0]),g.push(v[1]),u=p[b][4],f=p[b][5];return g},fabric.util.getBoundsOfCurve=r}(),function(){function t(t,e){for(var i=s.call(arguments,2),r=[],n=0,o=t.length;o>n;n++)r[n]=i.length?t[n][e].apply(t[n],i):t[n][e].call(t[n]);return r}function e(t,e){return r(t,e,function(t,e){return t>=e})}function i(t,e){return r(t,e,function(t,e){return e>t})}function r(t,e,i){if(t&&0!==t.length){var r=t.length-1,s=e?t[r][e]:t[r];if(e)for(;r--;)i(t[r][e],s)&&(s=t[r][e]);else for(;r--;)i(t[r],s)&&(s=t[r]);return s}}var s=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var r=0;if(arguments.length>0&&(r=Number(arguments[1]),r!==r?r=0:0!==r&&r!==Number.POSITIVE_INFINITY&&r!==Number.NEGATIVE_INFINITY&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=i)return-1;for(var s=r>=0?r:Math.max(i-Math.abs(r),0);i>s;s++)if(s in e&&e[s]===t)return s;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)i in this&&t.call(e,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){for(var i=[],r=0,s=this.length>>>0;s>r;r++)r in this&&(i[r]=t.call(e,this[r],r,this));return i}),Array.prototype.every||(Array.prototype.every=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&t.call(e,this[i],i,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){for(var i,r=[],s=0,n=this.length>>>0;n>s;s++)s in this&&(i=this[s],t.call(e,i,s,this)&&r.push(i));return r}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e,i=this.length>>>0,r=0;if(arguments.length>1)e=arguments[1];else for(;;){if(r in this){e=this[r++];break}if(++r>=i)throw new TypeError}for(;i>r;r++)r in this&&(e=t.call(null,e,this[r],r,this));return e}),fabric.util.array={invoke:t,min:i,max:e}}(),function(){function t(t,e){for(var i in e)t[i]=e[i];return t}function e(e){return t({},e)}fabric.util.object={extend:t,clone:e}}(),function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function i(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:t,capitalize:e,escapeXml:i}}(),function(){var t=Array.prototype.slice,e=Function.prototype.apply,i=function(){};Function.prototype.bind||(Function.prototype.bind=function(r){var s,n=this,o=t.call(arguments,1);return s=o.length?function(){return e.call(n,this instanceof i?this:r,o.concat(t.call(arguments)))}:function(){return e.call(n,this instanceof i?this:r,arguments)},i.prototype=this.prototype,s.prototype=new i,s})}(),function(){function t(){}function e(t){var e=this.constructor.superclass.prototype[t];return arguments.length>1?e.apply(this,r.call(arguments,1)):e.call(this)}function i(){function i(){this.initialize.apply(this,arguments)}var n=null,a=r.call(arguments,0);"function"==typeof a[0]&&(n=a.shift()),i.superclass=n,i.subclasses=[],n&&(t.prototype=n.prototype,i.prototype=new t,n.subclasses.push(i));for(var h=0,c=a.length;c>h;h++)o(i,a[h],n);return i.prototype.initialize||(i.prototype.initialize=s),i.prototype.constructor=i,i.prototype.callSuper=e,i}var r=Array.prototype.slice,s=function(){},n=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),o=function(t,e,i){for(var r in e)r in t.prototype&&"function"==typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?t.prototype[r]=function(t){return function(){var r=this.constructor.superclass;this.constructor.superclass=i;var s=e[t].apply(this,arguments);return this.constructor.superclass=r,"initialize"!==t?s:void 0}}(r):t.prototype[r]=e[r],n&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};fabric.util.createClass=i}(),function(){function t(t){var e,i,r=Array.prototype.slice.call(arguments,1),s=r.length;for(i=0;s>i;i++)if(e=typeof t[r[i]],!/^(?:function|object|unknown)$/.test(e))return!1;return!0}function e(t,e){return{handler:e,wrappedHandler:i(t,e)}}function i(t,e){return function(i){e.call(o(t),i||fabric.window.event)}}function r(t,e){return function(i){if(p[t]&&p[t][e])for(var r=p[t][e],s=0,n=r.length;n>s;s++)r[s].call(this,i||fabric.window.event)}}function s(t,e){t||(t=fabric.window.event);var i=t.target||(typeof t.srcElement!==h?t.srcElement:null),r=fabric.util.getScrollLeftTop(i,e);return{x:v(t)+r.left,y:b(t)+r.top}}function n(t,e,i){var r="touchend"===t.type?"changedTouches":"touches";return t[r]&&t[r][0]?t[r][0][e]-(t[r][0][e]-t[r][0][i])||t[i]:t[i]}var o,a,h="unknown",c=function(){var t=0;return function(e){return e.__uniqueID||(e.__uniqueID="uniqueID__"+t++)}}();!function(){var t={};o=function(e){return t[e]},a=function(e,i){t[e]=i}}();var l,u,f=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),d=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),g={},p={};f?(l=function(t,e,i){t.addEventListener(e,i,!1)},u=function(t,e,i){t.removeEventListener(e,i,!1)}):d?(l=function(t,i,r){var s=c(t);a(s,t),g[s]||(g[s]={}),g[s][i]||(g[s][i]=[]);var n=e(s,r);g[s][i].push(n),t.attachEvent("on"+i,n.wrappedHandler)},u=function(t,e,i){var r,s=c(t);if(g[s]&&g[s][e])for(var n=0,o=g[s][e].length;o>n;n++)r=g[s][e][n],r&&r.handler===i&&(t.detachEvent("on"+e,r.wrappedHandler),g[s][e][n]=null)}):(l=function(t,e,i){var s=c(t);if(p[s]||(p[s]={}),!p[s][e]){p[s][e]=[];var n=t["on"+e];n&&p[s][e].push(n),t["on"+e]=r(s,e)}p[s][e].push(i)},u=function(t,e,i){var r=c(t);if(p[r]&&p[r][e])for(var s=p[r][e],n=0,o=s.length;o>n;n++)s[n]===i&&s.splice(n,1)}),fabric.util.addListener=l,fabric.util.removeListener=u;var v=function(t){return typeof t.clientX!==h?t.clientX:0},b=function(t){return typeof t.clientY!==h?t.clientY:0};fabric.isTouchSupported&&(v=function(t){return n(t,"pageX","clientX")},b=function(t){return n(t,"pageY","clientY")}),fabric.util.getPointer=s,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function t(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?n(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)if("opacity"===r)n(t,e[r]);else{var s="float"===r||"cssFloat"===r?"undefined"==typeof i.styleFloat?"cssFloat":"styleFloat":r;i[s]=e[r]}return t}var e=fabric.document.createElement("div"),i="string"==typeof e.style.opacity,r="string"==typeof e.style.filter,s=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,n=function(t){return t};i?n=function(t,e){return t.style.opacity=e,t}:r&&(n=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),s.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(s,e)):i.filter+=" alpha(opacity="+100*e+")",t}),fabric.util.setStyle=t}(),function(){function t(t){return"string"==typeof t?fabric.document.getElementById(t):t}function e(t,e){var i=fabric.document.createElement(t);for(var r in e)"class"===r?i.className=e[r]:"for"===r?i.htmlFor=e[r]:i.setAttribute(r,e[r]);return i}function i(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)}function r(t,i,r){return"string"==typeof i&&(i=e(i,r)),t.parentNode&&t.parentNode.replaceChild(i,t),i.appendChild(t),i}function s(t,e){var i,r,s=0,n=0,o=fabric.document.documentElement,a=fabric.document.body||{scrollLeft:0,scrollTop:0};for(r=t;t&&t.parentNode&&!i;)t=t.parentNode,1===t.nodeType&&"fixed"===fabric.util.getElementStyle(t,"position")&&(i=t),1===t.nodeType&&r!==e&&"absolute"===fabric.util.getElementStyle(t,"position")?(s=0,n=0):t===fabric.document?(s=a.scrollLeft||o.scrollLeft||0,n=a.scrollTop||o.scrollTop||0):(s+=t.scrollLeft||0,n+=t.scrollTop||0);return{left:s,top:n}}function n(t){var e,i,r=t&&t.ownerDocument,s={left:0,top:0},n={left:0,top:0},o={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return{left:0,top:0};for(var a in o)n[o[a]]+=parseInt(l(t,a),10)||0;return e=r.documentElement,"undefined"!=typeof t.getBoundingClientRect&&(s=t.getBoundingClientRect()),i=fabric.util.getScrollLeftTop(t,null),{left:s.left+i.left-(e.clientLeft||0)+n.left,top:s.top+i.top-(e.clientTop||0)+n.top}}var o,a=Array.prototype.slice,h=function(t){return a.call(t,0)};try{o=h(fabric.document.childNodes)instanceof Array}catch(c){}o||(h=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e});var l;l=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(t,e){var i=fabric.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},function(){function t(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=fabric.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t}function e(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}var i=fabric.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=t,fabric.util.makeElementSelectable=e}(),function(){function t(t,e){var i=fabric.document.getElementsByTagName("head")[0],r=fabric.document.createElement("script"),s=!0;r.onload=r.onreadystatechange=function(t){if(s){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;s=!1,e(t||fabric.window.event),r=r.onload=r.onreadystatechange=null}},r.src=t,i.appendChild(r)}fabric.util.getScript=t}(),fabric.util.getById=t,fabric.util.toArray=h,fabric.util.makeElement=e,fabric.util.addClass=i,fabric.util.wrapElement=r,fabric.util.getScrollLeftTop=s,fabric.util.getElementOffset=n,fabric.util.getElementStyle=l}(),function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function i(i,s){s||(s={});var n,o=s.method?s.method.toUpperCase():"GET",a=s.onComplete||function(){},h=r();return h.onreadystatechange=function(){4===h.readyState&&(a(h),h.onreadystatechange=e)},"GET"===o&&(n=null,"string"==typeof s.parameters&&(i=t(i,s.parameters))),h.open(o,i,!0),("POST"===o||"PUT"===o)&&h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.send(n),h}var r=function(){for(var t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],e=t.length;e--;)try{var i=t[e]();if(i)return t[e]}catch(r){}}();fabric.util.request=i}(),fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){"undefined"!=typeof console[t]&&"function"==typeof console[t].apply&&(fabric[t]=function(){return console[t].apply(console,arguments)})}),function(){function t(t){e(function(i){t||(t={});var r,s=i||+new Date,n=t.duration||500,o=s+n,a=t.onChange||function(){},h=t.abort||function(){return!1},c=t.easing||function(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e},l="startValue"in t?t.startValue:0,u="endValue"in t?t.endValue:100,f=t.byValue||u-l;t.onStart&&t.onStart(),function d(i){r=i||+new Date;var u=r>o?n:r-s;return h()?void(t.onComplete&&t.onComplete()):(a(c(u,l,f,n)),r>o?void(t.onComplete&&t.onComplete()):void e(d))}(s)})}function e(){return i.apply(fabric.window,arguments)}var i=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(t){fabric.window.setTimeout(t,1e3/60)};fabric.util.animate=t,fabric.util.requestAnimFrame=e}(),function(){function t(t,e,i,r){return t<Math.abs(e)?(t=e,r=i/4):r=i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:r}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-t.s)*Math.PI/t.p)}function i(t,e,i,r){return i*((t=t/r-1)*t*t+1)+e}function r(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}function s(t,e,i,r){return i*(t/=r)*t*t*t+e}function n(t,e,i,r){return-i*((t=t/r-1)*t*t*t-1)+e}function o(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}function a(t,e,i,r){return i*(t/=r)*t*t*t*t+e}function h(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e}function c(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}function l(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e}function u(t,e,i,r){return i*Math.sin(t/r*(Math.PI/2))+e}function f(t,e,i,r){return-i/2*(Math.cos(Math.PI*t/r)-1)+e}function d(t,e,i,r){return 0===t?e:i*Math.pow(2,10*(t/r-1))+e}function g(t,e,i,r){return t===r?e+i:i*(-Math.pow(2,-10*t/r)+1)+e}function p(t,e,i,r){return 0===t?e:t===r?e+i:(t/=r/2,1>t?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e)}function v(t,e,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+e}function b(t,e,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+e}function m(t,e,i,r){return t/=r/2,1>t?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function y(i,r,s,n){var o=1.70158,a=0,h=s;if(0===i)return r;if(i/=n,1===i)return r+s;a||(a=.3*n);var c=t(h,s,a,o);return-e(c,i,n)+r}function _(e,i,r,s){var n=1.70158,o=0,a=r;if(0===e)return i;if(e/=s,1===e)return i+r;o||(o=.3*s);var h=t(a,r,o,n);return h.a*Math.pow(2,-10*e)*Math.sin(2*(e*s-h.s)*Math.PI/h.p)+h.c+i}function x(i,r,s,n){var o=1.70158,a=0,h=s;if(0===i)return r;if(i/=n/2,2===i)return r+s;a||(a=.3*n*1.5);var c=t(h,s,a,o);return 1>i?-.5*e(c,i,n)+r:c.a*Math.pow(2,-10*(i-=1))*Math.sin(2*(i*n-c.s)*Math.PI/c.p)*.5+c.c+r}function C(t,e,i,r,s){return void 0===s&&(s=1.70158),i*(t/=r)*t*((s+1)*t-s)+e}function S(t,e,i,r,s){return void 0===s&&(s=1.70158),i*((t=t/r-1)*t*((s+1)*t+s)+1)+e}function w(t,e,i,r,s){return void 0===s&&(s=1.70158),t/=r/2,1>t?i/2*t*t*(((s*=1.525)+1)*t-s)+e:i/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+e}function O(t,e,i,r){return i-T(r-t,0,i,r)+e}function T(t,e,i,r){return(t/=r)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function k(t,e,i,r){return r/2>t?.5*O(2*t,0,i,r)+e:.5*T(2*t-r,0,i,r)+.5*i+e}fabric.util.ease={easeInQuad:function(t,e,i,r){return i*(t/=r)*t+e},easeOutQuad:function(t,e,i,r){return-i*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,i,r){return t/=r/2,1>t?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,r){return i*(t/=r)*t*t+e},easeOutCubic:i,easeInOutCubic:r,easeInQuart:s,easeOutQuart:n,easeInOutQuart:o,easeInQuint:a,easeOutQuint:h,easeInOutQuint:c,easeInSine:l,easeOutSine:u,easeInOutSine:f,easeInExpo:d,easeOutExpo:g,easeInOutExpo:p,easeInCirc:v,easeOutCirc:b,easeInOutCirc:m,easeInElastic:y,easeOutElastic:_,easeInOutElastic:x,easeInBack:C,easeOutBack:S,easeInOutBack:w,easeInBounce:O,easeOutBounce:T,easeInOutBounce:k}}(),function(t){"use strict";function e(t){return t in C?C[t]:t}function i(t,e,i,r){var s,n="[object Array]"===Object.prototype.toString.call(e);return"fill"!==t&&"stroke"!==t||"none"!==e?"strokeDashArray"===t?e=e.replace(/,/g," ").split(/\s+/).map(function(t){return parseFloat(t)}):"transformMatrix"===t?e=i&&i.transformMatrix?x(i.transformMatrix,p.parseTransformAttribute(e)):p.parseTransformAttribute(e):"visible"===t?(e="none"===e||"hidden"===e?!1:!0,i&&i.visible===!1&&(e=!1)):"originX"===t?e="start"===e?"left":"end"===e?"right":"center":s=n?e.map(_):_(e,r):e="",!n&&isNaN(s)?e:s}function r(t){for(var e in S)if(t[e]&&"undefined"!=typeof t[S[e]]&&0!==t[e].indexOf("url(")){var i=new p.Color(t[e]);t[e]=i.setAlpha(y(i.getAlpha()*t[S[e]],2)).toRgba()}return t}function s(t,r){var s,n;t.replace(/;$/,"").split(";").forEach(function(t){var o=t.split(":");s=e(o[0].trim().toLowerCase()),n=i(s,o[1].trim()),r[s]=n})}function n(t,r){var s,n;for(var o in t)"undefined"!=typeof t[o]&&(s=e(o.toLowerCase()),n=i(s,t[o]),r[s]=n)}function o(t,e){var i={};for(var r in p.cssRules[e])if(a(t,r.split(" ")))for(var s in p.cssRules[e][r])i[s]=p.cssRules[e][r][s];return i}function a(t,e){var i,r=!0;return i=c(t,e.pop()),i&&e.length&&(r=h(t,e)),i&&r&&0===e.length}function h(t,e){for(var i,r=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(i=e.pop()),t=t.parentNode,r=c(t,i);return 0===e.length}function c(t,e){var i,r=t.nodeName,s=t.getAttribute("class"),n=t.getAttribute("id");if(i=new RegExp("^"+r,"i"),e=e.replace(i,""),n&&e.length&&(i=new RegExp("#"+n+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),s&&e.length){s=s.split(" ");for(var o=s.length;o--;)i=new RegExp("\\."+s[o]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")}return 0===e.length}function l(t,e){var i;if(t.getElementById&&(i=t.getElementById(e)),i)return i;var r,s,n,o=t.getElementsByTagName("*");for(s=0;s<o.length;s++)if(r=o[s],n===r.getAttribute("id"))return r}function u(t){for(var e=t.getElementsByTagName("use"),i=0;e.length&&i<e.length;){for(var r,s=e[i],n=s.getAttribute("xlink:href").substr(1),o=s.getAttribute("x")||0,a=s.getAttribute("y")||0,h=l(t,n).cloneNode(!0),c=(h.getAttribute("transform")||"")+" translate("+o+", "+a+")",u=e.length,f=0,d=s.attributes,g=d.length;g>f;f++){var p=d.item(f);"x"!==p.nodeName&&"y"!==p.nodeName&&"xlink:href"!==p.nodeName&&("transform"===p.nodeName?c=p.nodeValue+" "+c:h.setAttribute(p.nodeName,p.nodeValue))}h.setAttribute("transform",c),h.setAttribute("instantiated_by_use","1"),h.removeAttribute("id"),r=s.parentNode,r.replaceChild(h,s),e.length===u&&i++}}function f(t,e,i){var r,s,n,o,a=t.getAttribute("viewBox"),h=1,c=1,l=0,u=0;if(a&&(a=a.match(w))&&(l=-parseFloat(a[1]),u=-parseFloat(a[2]),r=parseFloat(a[3]),s=parseFloat(a[4]),e&&e!==r&&(h=e/r),i&&i!==s&&(c=i/s),c=h=h>c?c:h,1!==h||1!==c||0!==l||0!==u)){if(n=" matrix("+h+" 0 0 "+c+" "+l*h+" "+u*c+") ","svg"===t.tagName){for(o=t.ownerDocument.createElement("g");null!=t.firstChild;)o.appendChild(t.firstChild);t.appendChild(o)}else o=t,n=o.getAttribute("transform")+n;o.setAttribute("transform",n)}}function d(t){var e=t.objects,i=t.options;return e=e.map(function(t){return p[b(t.type)].fromObject(t)}),{objects:e,options:i}}function g(t,e,i){e[i]&&e[i].toSVG&&t.push('<pattern x="0" y="0" id="',i,'Pattern" ','width="',e[i].source.width,'" height="',e[i].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',e[i].source.width,'" height="',e[i].source.height,'" xlink:href="',e[i].source.src,'"></image></pattern>')}var p=t.fabric||(t.fabric={}),v=p.util.object.extend,b=p.util.string.capitalize,m=p.util.object.clone,y=p.util.toFixed,_=p.util.parseUnit,x=p.util.multiplyTransformMatrices,C={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},S={stroke:"strokeOpacity",fill:"fillOpacity"};p.cssRules={},p.gradientDefs={},p.parseTransformAttribute=function(){function t(t,e){var i=e[0];t[0]=Math.cos(i),t[1]=Math.sin(i),t[2]=-Math.sin(i),t[3]=Math.cos(i)}function e(t,e){var i=e[0],r=2===e.length?e[1]:e[0];t[0]=i,t[3]=r}function i(t,e){t[2]=Math.tan(p.util.degreesToRadians(e[0]))}function r(t,e){t[1]=Math.tan(p.util.degreesToRadians(e[0]))}function s(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var n=[1,0,0,1,0,0],o=p.reNum,a="(?:\\s+,?\\s*|,\\s*)",h="(?:(skewX)\\s*\\(\\s*("+o+")\\s*\\))",c="(?:(skewY)\\s*\\(\\s*("+o+")\\s*\\))",l="(?:(rotate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+")"+a+"("+o+"))?\\s*\\))",u="(?:(scale)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",f="(?:(translate)\\s*\\(\\s*("+o+")(?:"+a+"("+o+"))?\\s*\\))",d="(?:(matrix)\\s*\\(\\s*("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")"+a+"("+o+")\\s*\\))",g="(?:"+d+"|"+f+"|"+u+"|"+l+"|"+h+"|"+c+")",v="(?:"+g+"(?:"+a+g+")*)",b="^\\s*(?:"+v+"?)\\s*$",m=new RegExp(b),y=new RegExp(g,"g");return function(o){var a=n.concat(),h=[];if(!o||o&&!m.test(o))return a;o.replace(y,function(o){var c=new RegExp(g).exec(o).filter(function(t){return""!==t&&null!=t}),l=c[1],u=c.slice(2).map(parseFloat);switch(l){case"translate":s(a,u);break;case"rotate":u[0]=p.util.degreesToRadians(u[0]),t(a,u);break;case"scale":e(a,u);break;case"skewX":i(a,u);break;case"skewY":r(a,u);break;case"matrix":a=u}h.push(a.concat()),a=n.concat()});for(var c=h[0];h.length>1;)h.shift(),c=p.util.multiplyTransformMatrices(c,h[0]);return c}}();var w=new RegExp("^\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*$");p.parseSVGDocument=function(){function t(t,e){for(;t&&(t=t.parentNode);)if(e.test(t.nodeName)&&!t.getAttribute("instantiated_by_use"))return!0;return!1}var e=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,i=/^(symbol|image|marker|pattern|view)$/;return function(r,s,n){if(r){u(r);var o,a,h=new Date,c=p.Object.__uid++,l=!1;if(r.getAttribute("width")&&"100%"!==r.getAttribute("width")&&(o=_(r.getAttribute("width"))),r.getAttribute("height")&&"100%"!==r.getAttribute("height")&&(a=_(r.getAttribute("height"))),!o||!a){var d=r.getAttribute("viewBox");d&&(d=d.match(w))?(o=parseFloat(d[3]),a=parseFloat(d[4])):l=!0}f(r,o,a);var g=p.util.toArray(r.getElementsByTagName("*"));if(0===g.length&&p.isLikelyNode){g=r.selectNodes('//*[name(.)!="svg"]');for(var v=[],b=0,y=g.length;y>b;b++)v[b]=g[b];g=v}var x=g.filter(function(r){return i.test(r.tagName)&&f(r,0,0),e.test(r.tagName)&&!t(r,/^(?:pattern|defs|symbol|metadata)$/)});if(!x||x&&!x.length)return void(s&&s([],{}));var C={width:o,height:a,svgUid:c,toBeParsed:l};p.gradientDefs[c]=p.getGradientDefs(r),p.cssRules[c]=p.getCSSRules(r),p.parseElements(x,function(t){p.documentParsingTime=new Date-h,s&&s(t,C)},m(C),n)}}}();var O={has:function(t,e){e(!1)},get:function(){},set:function(){}},T=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+p.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+p.reNum+"))?\\s+(.*)");v(p,{parseFontDeclaration:function(t,e){var i=t.match(T);if(i){var r=i[1],s=i[3],n=i[4],o=i[5],a=i[6];r&&(e.fontStyle=r),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),n&&(e.fontSize=_(n)),
a&&(e.fontFamily=a),o&&(e.lineHeight="normal"===o?1:o)}},getGradientDefs:function(t){var e,i,r,s,n=t.getElementsByTagName("linearGradient"),o=t.getElementsByTagName("radialGradient"),a=0,h=[],c={},l={};for(h.length=n.length+o.length,i=n.length;i--;)h[a++]=n[i];for(i=o.length;i--;)h[a++]=o[i];for(;a--;)e=h[a],s=e.getAttribute("xlink:href"),r=e.getAttribute("id"),s&&(l[r]=s.substr(1)),c[r]=e;for(r in l){var u=c[l[r]].cloneNode(!0);for(e=c[r];u.firstChild;)e.appendChild(u.firstChild)}return c},parseAttributes:function(t,s,n){if(t){var a,h,c={};"undefined"==typeof n&&(n=t.getAttribute("svgUid")),t.parentNode&&/^symbol|[g|a]$/i.test(t.parentNode.nodeName)&&(c=p.parseAttributes(t.parentNode,s,n)),h=c&&c.fontSize||t.getAttribute("font-size")||p.Text.DEFAULT_SVG_FONT_SIZE;var l=s.reduce(function(r,s){return a=t.getAttribute(s),a&&(s=e(s),a=i(s,a,c,h),r[s]=a),r},{});return l=v(l,v(o(t,n),p.parseStyleAttribute(t))),l.font&&p.parseFontDeclaration(l.font,l),r(v(c,l))}},parseElements:function(t,e,i,r){new p.ElementsParser(t,e,i,r).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?s(i,e):n(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,i,r=[];for(e=0,i=t.length;i>e;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){for(var r,s=t.getElementsByTagName("style"),n={},o=0,a=s.length;a>o;o++){var h=s[o].textContent;h=h.replace(/\/\*[\s\S]*?\*\//g,""),""!==h.trim()&&(r=h.match(/[^{]*\{[\s\S]*?\}/g),r=r.map(function(t){return t.trim()}),r.forEach(function(t){for(var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),s={},o=r[2].trim(),a=o.replace(/;$/,"").split(/\s*;\s*/),h=0,c=a.length;c>h;h++){var l=a[h].split(/\s*:\s*/),u=e(l[0]),f=i(u,l[1],l[0]);s[u]=f}t=r[1],t.split(",").forEach(function(t){t=t.replace(/^svg/i,"").trim(),""!==t&&(n[t]=p.util.object.clone(s))})}))}return n},loadSVGFromURL:function(t,e,i){function r(r){var s=r.responseXML;s&&!s.documentElement&&p.window.ActiveXObject&&r.responseText&&(s=new ActiveXObject("Microsoft.XMLDOM"),s.async="false",s.loadXML(r.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),s&&s.documentElement&&p.parseSVGDocument(s.documentElement,function(i,r){O.set(t,{objects:p.util.array.invoke(i,"toObject"),options:r}),e(i,r)},i)}t=t.replace(/^\n\s*/,"").trim(),O.has(t,function(i){i?O.get(t,function(t){var i=d(t);e(i.objects,i.options)}):new p.util.request(t,{method:"get",onComplete:r})})},loadSVGFromString:function(t,e,i){t=t.trim();var r;if("undefined"!=typeof DOMParser){var s=new DOMParser;s&&s.parseFromString&&(r=s.parseFromString(t,"text/xml"))}else p.window.ActiveXObject&&(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));p.parseSVGDocument(r.documentElement,function(t,i){e(t,i)},i)},createSVGFontFacesMarkup:function(t){for(var e="",i=0,r=t.length;r>i;i++)"text"===t[i].type&&t[i].path&&(e+=["@font-face {","font-family: ",t[i].fontFamily,"; ","src: url('",t[i].path,"')","}"].join(""));return e&&(e=['<style type="text/css">',"<![CDATA[",e,"]]>","</style>"].join("")),e},createSVGRefElementsMarkup:function(t){var e=[];return g(e,t,"backgroundColor"),g(e,t,"overlayColor"),e.join("")}})}("undefined"!=typeof exports?exports:this),fabric.ElementsParser=function(t,e,i,r){this.elements=t,this.callback=e,this.options=i,this.reviver=r,this.svgUid=i&&i.svgUid||0},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;e>t;t++)this.elements[t].setAttribute("svgUid",this.svgUid),function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},fabric.ElementsParser.prototype.createObject=function(t,e){var i=fabric[fabric.util.string.capitalize(t.tagName)];if(i&&i.fromElement)try{this._createObject(i,t,e)}catch(r){fabric.log(r)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(t,e,i){if(t.async)t.fromElement(e,this.createCallback(i,e),this.options);else{var r=t.fromElement(e,this.options);this.resolveGradient(r,"fill"),this.resolveGradient(r,"stroke"),this.reviver&&this.reviver(e,r),this.instances[i]=r,this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(t,e){var i=this;return function(r){i.resolveGradient(r,"fill"),i.resolveGradient(r,"stroke"),i.reviver&&i.reviver(e,r),i.instances[t]=r,i.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(t,e){var i=t.get(e);if(/^url\(/.test(i)){var r=i.slice(5,i.length-1);fabric.gradientDefs[this.svgUid][r]&&t.set(e,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],t))}},fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances))},function(t){"use strict";function e(t,e){this.x=t,this.y=e}var i=t.fabric||(t.fabric={});return i.Point?void i.warn("fabric.Point is already defined"):(i.Point=e,void(e.prototype={constructor:e,add:function(t){return new e(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new e(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new e(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new e(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new e(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new e(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,i){return new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return new e(this.x+(t.x-this.x)/2,this.y+(t.y-this.y)/2)},min:function(t){return new e(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new e(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){this.x=t,this.y=e},setFromPoint:function(t){this.x=t.x,this.y=t.y},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){this.status=t,this.points=[]}var i=t.fabric||(t.fabric={});return i.Intersection?void i.warn("fabric.Intersection is already defined"):(i.Intersection=e,i.Intersection.prototype={appendPoint:function(t){this.points.push(t)},appendPoints:function(t){this.points=this.points.concat(t)}},i.Intersection.intersectLineLine=function(t,r,s,n){var o,a=(n.x-s.x)*(t.y-s.y)-(n.y-s.y)*(t.x-s.x),h=(r.x-t.x)*(t.y-s.y)-(r.y-t.y)*(t.x-s.x),c=(n.y-s.y)*(r.x-t.x)-(n.x-s.x)*(r.y-t.y);if(0!==c){var l=a/c,u=h/c;l>=0&&1>=l&&u>=0&&1>=u?(o=new e("Intersection"),o.points.push(new i.Point(t.x+l*(r.x-t.x),t.y+l*(r.y-t.y)))):o=new e}else o=new e(0===a||0===h?"Coincident":"Parallel");return o},i.Intersection.intersectLinePolygon=function(t,i,r){for(var s=new e,n=r.length,o=0;n>o;o++){var a=r[o],h=r[(o+1)%n],c=e.intersectLineLine(t,i,a,h);s.appendPoints(c.points)}return s.points.length>0&&(s.status="Intersection"),s},i.Intersection.intersectPolygonPolygon=function(t,i){for(var r=new e,s=t.length,n=0;s>n;n++){var o=t[n],a=t[(n+1)%s],h=e.intersectLinePolygon(o,a,i);r.appendPoints(h.points)}return r.points.length>0&&(r.status="Intersection"),r},void(i.Intersection.intersectPolygonRectangle=function(t,r,s){var n=r.min(s),o=r.max(s),a=new i.Point(o.x,n.y),h=new i.Point(n.x,o.y),c=e.intersectLinePolygon(n,a,t),l=e.intersectLinePolygon(a,o,t),u=e.intersectLinePolygon(o,h,t),f=e.intersectLinePolygon(h,n,t),d=new e;return d.appendPoints(c.points),d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var r=t.fabric||(t.fabric={});return r.Color?void r.warn("fabric.Color is already defined."):(r.Color=e,r.Color.prototype={_tryParsingColor:function(t){var i;return t in e.colorNameMap&&(t=e.colorNameMap[t]),"transparent"===t?void this.setSource([255,255,255,0]):(i=e.sourceFromHex(t),i||(i=e.sourceFromRgb(t)),i||(i=e.sourceFromHsl(t)),void(i&&this.setSource(i)))},_rgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var s,n,o,a=r.util.array.max([t,e,i]),h=r.util.array.min([t,e,i]);if(o=(a+h)/2,a===h)s=n=0;else{var c=a-h;switch(n=o>.5?c/(2-a-h):c/(a+h),a){case t:s=(e-i)/c+(i>e?6:0);break;case e:s=(i-t)/c+2;break;case i:s=(t-e)/c+4}s/=6}return[Math.round(360*s),Math.round(100*n),Math.round(100*o)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,r=this.getSource();return t=r[0].toString(16),t=1===t.length?"0"+t:t,e=r[1].toString(16),e=1===e.length?"0"+e:e,i=r[2].toString(16),i=1===i.length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,r]),this},overlayWith:function(t){t instanceof e||(t=new e(t));for(var i=[],r=this.getAlpha(),s=.5,n=this.getSource(),o=t.getSource(),a=0;3>a;a++)i.push(Math.round(n[a]*(1-s)+o[a]*s));return i[3]=r,this.setSource(i),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},r.Color.fromRgb=function(t){return e.fromSource(e.sourceFromRgb(t))},r.Color.sourceFromRgb=function(t){var i=t.match(e.reRGBa);if(i){var r=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),s=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),n=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(r,10),parseInt(s,10),parseInt(n,10),i[4]?parseFloat(i[4]):1]}},r.Color.fromRgba=e.fromRgb,r.Color.fromHsl=function(t){return e.fromSource(e.sourceFromHsl(t))},r.Color.sourceFromHsl=function(t){var r=t.match(e.reHSLa);if(r){var s,n,o,a=(parseFloat(r[1])%360+360)%360/360,h=parseFloat(r[2])/(/%$/.test(r[2])?100:1),c=parseFloat(r[3])/(/%$/.test(r[3])?100:1);if(0===h)s=n=o=c;else{var l=.5>=c?c*(h+1):c+h-c*h,u=2*c-l;s=i(u,l,a+1/3),n=i(u,l,a),o=i(u,l,a-1/3)}return[Math.round(255*s),Math.round(255*n),Math.round(255*o),r[4]?parseFloat(r[4]):1]}},r.Color.fromHsla=e.fromHsl,r.Color.fromHex=function(t){return e.fromSource(e.sourceFromHex(t))},r.Color.sourceFromHex=function(t){if(t.match(e.reHex)){var i=t.slice(t.indexOf("#")+1),r=3===i.length,s=r?i.charAt(0)+i.charAt(0):i.substring(0,2),n=r?i.charAt(1)+i.charAt(1):i.substring(2,4),o=r?i.charAt(2)+i.charAt(2):i.substring(4,6);return[parseInt(s,16),parseInt(n,16),parseInt(o,16),1]}},void(r.Color.fromSource=function(t){var i=new e;return i.setSource(t),i}))}("undefined"!=typeof exports?exports:this),function(){function t(t){var e,i,r,s=t.getAttribute("style"),n=t.getAttribute("offset");if(n=parseFloat(n)/(/%$/.test(n)?100:1),n=0>n?0:n>1?1:n,s){var o=s.split(/\s*;\s*/);""===o[o.length-1]&&o.pop();for(var a=o.length;a--;){var h=o[a].split(/\s*:\s*/),c=h[0].trim(),l=h[1].trim();"stop-color"===c?e=l:"stop-opacity"===c&&(r=l)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=t.getAttribute("stop-opacity")),e=new fabric.Color(e),i=e.getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=i,{offset:n,color:e.toRgb(),opacity:r}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function i(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}function r(t,e,i){var r,s=0,n=1,o="";for(var a in e)r=parseFloat(e[a],10),n="string"==typeof e[a]&&/^\d+%$/.test(e[a])?.01:1,"x1"===a||"x2"===a||"r2"===a?(n*="objectBoundingBox"===i?t.width:1,s="objectBoundingBox"===i?t.left||0:0):("y1"===a||"y2"===a)&&(n*="objectBoundingBox"===i?t.height:1,s="objectBoundingBox"===i?t.top||0:0),e[a]=r*n+s;if("ellipse"===t.type&&null!==e.r2&&"objectBoundingBox"===i&&t.rx!==t.ry){var h=t.ry/t.rx;o=" scale(1, "+h+")",e.y1&&(e.y1/=h),e.y2&&(e.y2/=h)}return o}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(t){t||(t={});var e={};this.id=fabric.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.offsetX=t.offsetX||this.offsetX,this.offsetY=t.offsetY||this.offsetY},addColorStop:function(t){for(var e in t){var i=new fabric.Color(t[e]);this.colorStops.push({offset:e,color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e,i,r=fabric.util.object.clone(this.coords);if(this.colorStops.sort(function(t,e){return t.offset-e.offset}),!t.group||"path-group"!==t.group.type)for(var s in r)"x1"===s||"x2"===s||"r2"===s?r[s]+=this.offsetX-t.width/2:("y1"===s||"y2"===s)&&(r[s]+=this.offsetY-t.height/2);i='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(i+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?e=["<linearGradient ",i,' x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,'">\n']:"radial"===this.type&&(e=["<radialGradient ",i,' cx="',r.x2,'" cy="',r.y2,'" r="',r.r2,'" fx="',r.x1,'" fy="',r.y1,'">\n']);for(var n=0;n<this.colorStops.length;n++)e.push("<stop ",'offset="',100*this.colorStops[n].offset+"%",'" style="stop-color:',this.colorStops[n].color,null!=this.colorStops[n].opacity?";stop-opacity: "+this.colorStops[n].opacity:";",'"/>\n');return e.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),e.join("")},toLive:function(t,e){var i,r,s=fabric.util.object.clone(this.coords);if(this.type){if(e.group&&"path-group"===e.group.type)for(r in s)"x1"===r||"x2"===r?s[r]+=-this.offsetX+e.width/2:("y1"===r||"y2"===r)&&(s[r]+=-this.offsetY+e.height/2);"linear"===this.type?i=t.createLinearGradient(s.x1,s.y1,s.x2,s.y2):"radial"===this.type&&(i=t.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2));for(var n=0,o=this.colorStops.length;o>n;n++){var a=this.colorStops[n].color,h=this.colorStops[n].opacity,c=this.colorStops[n].offset;"undefined"!=typeof h&&(a=new fabric.Color(a).setAlpha(h).toRgba()),i.addColorStop(parseFloat(c),a)}return i}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(s,n){var o,a=s.getElementsByTagName("stop"),h="linearGradient"===s.nodeName?"linear":"radial",c=s.getAttribute("gradientUnits")||"objectBoundingBox",l=s.getAttribute("gradientTransform"),u=[],f={};"linear"===h?f=e(s):"radial"===h&&(f=i(s));for(var d=a.length;d--;)u.push(t(a[d]));o=r(n,f,c);var g=new fabric.Gradient({type:h,coords:f,colorStops:u,offsetX:-n.left,offsetY:-n.top});return(l||""!==o)&&(g.gradientTransform=fabric.parseTransformAttribute((l||"")+o)),g},forObject:function(t,e){return e||(e={}),r(t,e.coords,"userSpaceOnUse"),new fabric.Gradient(e)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t){if(t||(t={}),this.id=fabric.Object.__uid++,t.source)if("string"==typeof t.source)if("undefined"!=typeof fabric.util.getFunctionBody(t.source))this.source=new Function(fabric.util.getFunctionBody(t.source));else{var e=this;this.source=fabric.util.createImage(),fabric.util.loadImage(t.source,function(t){e.source=t})}else this.source=t.source;t.repeat&&(this.repeat=t.repeat),t.offsetX&&(this.offsetX=t.offsetX),t.offsetY&&(this.offsetY=t.offsetY)},toObject:function(){var t;return"function"==typeof this.source?t=String(this.source):"string"==typeof this.source.src&&(t=this.source.src),{source:t,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.getWidth(),r=e.height/t.getHeight(),s=this.offsetX/t.getWidth(),n=this.offsetY/t.getHeight(),o="";return("repeat-x"===this.repeat||"no-repeat"===this.repeat)&&(r=1),("repeat-y"===this.repeat||"no-repeat"===this.repeat)&&(i=1),e.src?o=e.src:e.toDataURL&&(o=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+n+'" width="'+i+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+o+'"></image>\n</pattern>\n'},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if("undefined"!=typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;return e.Shadow?void e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){"string"==typeof t&&(t=this._parseShadow(t));for(var i in t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(i)||[],s=i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:s.trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var e="SourceAlpha",r=40,s=40;return!t||t.fill!==this.color&&t.stroke!==this.color||(e="SourceGraphic"),t.width&&t.height&&(r=100*i(Math.abs(this.offsetX/t.getWidth()),2)+20,s=100*i(Math.abs(this.offsetY/t.getHeight()),2)+20),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n	<feGaussianBlur in="'+e+'" stdDeviation="'+i(this.blur?this.blur/2:0,3)+'" result="blurOut"></feGaussianBlur>\n	<feColorMatrix result="matrixOut" in="blurOut" type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.30 0" ></feColorMatrix >\n	<feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset>\n	<feMerge>\n		<feMergeNode></feMergeNode>\n		<feMergeNode in="SourceGraphic"></feMergeNode>\n	</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var t={},i=e.Shadow.prototype;return this.color!==i.color&&(t.color=this.color),this.blur!==i.blur&&(t.blur=this.blur),this.offsetX!==i.offsetX&&(t.offsetX=this.offsetX),this.offsetY!==i.offsetY&&(t.offsetY=this.offsetY),t}}),void(e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))}("undefined"!=typeof exports?exports:this),function(){"use strict";if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var t=fabric.util.object.extend,e=fabric.util.getElementOffset,i=fabric.util.removeFromArray,r=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(t,e){e||(e={}),this._initStatic(t,e),fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(t,e){this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),e.overlayImage&&this.setOverlayImage(e.overlayImage,this.renderAll.bind(this)),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,this.renderAll.bind(this)),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,this.renderAll.bind(this)),e.overlayColor&&this.setOverlayColor(e.overlayColor,this.renderAll.bind(this)),this.calcOffset()},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.webkitImageSmoothingEnabled=this.imageSmoothingEnabled,t.mozImageSmoothingEnabled=this.imageSmoothingEnabled,t.msImageSmoothingEnabled=this.imageSmoothingEnabled,t.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,r){return"string"==typeof e?fabric.util.loadImage(e,function(e){this[t]=new fabric.Image(e,r),i&&i()},this,r&&r.crossOrigin):(r&&e.setOptions(r),this[t]=e,i&&i()),this},__setBgOverlayColor:function(t,e,i){if(e&&e.source){var r=this;fabric.util.loadImage(e.source,function(s){r[t]=new fabric.Pattern({source:s,repeat:e.repeat,offsetX:e.offsetX,offsetY:e.offsetY}),i&&i()})}else this[t]=e,i&&i();return this},_createCanvasElement:function(){var t=fabric.document.createElement("canvas");if(t.style||(t.style={}),!t)throw r;return this._initCanvasElement(t),t},_initCanvasElement:function(t){if(fabric.util.createCanvasElement(t),"undefined"==typeof t.getContext)throw r},_initOptions:function(t){for(var e in t)this[e]=t[e];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){this.lowerCanvasEl=fabric.util.getById(t)||this._createCanvasElement(),this._initCanvasElement(this.lowerCanvasEl),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;e=e||{};for(var r in t)i=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),i+="px"),e.backstoreOnly||this._setCssDimension(r,i);return e.cssOnly||this.renderAll(),this.calcOffset(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(t){var e=this.getActiveGroup();this.viewportTransform=t,this.renderAll();for(var i=0,r=this._objects.length;r>i;i++)this._objects[i].setCoords();return e&&e.setCoords(),this},zoomToPoint:function(t,e){var i=t;t=fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform)),this.viewportTransform[0]=e,this.viewportTransform[3]=e;var r=fabric.util.transformPoint(t,this.viewportTransform);this.viewportTransform[4]+=i.x-r.x,this.viewportTransform[5]+=i.y-r.y,this.renderAll();for(var s=0,n=this._objects.length;n>s;s++)this._objects[s].setCoords();return this},setZoom:function(t){return this.zoomToPoint(new fabric.Point(0,0),t),this},absolutePan:function(t){this.viewportTransform[4]=-t.x,this.viewportTransform[5]=-t.y,this.renderAll();for(var e=0,i=this._objects.length;i>e;e++)this._objects[e].setCoords();return this},relativePan:function(t){return this.absolutePan(new fabric.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(t,e){if(e){t.save();var i=this.viewportTransform;t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._shouldRenderObject(e)&&e.render(t),t.restore(),this.controlsAboveOverlay||e._renderControls(t)}},_shouldRenderObject:function(t){return t?t!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.getActiveObject()===t&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared")),this.fire("object:removed",{target:t}),t.fire("removed")},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.discardActiveGroup&&this.discardActiveGroup(),this.discardActiveObject&&this.discardActiveObject(),this.clearContext(this.contextContainer),this.contextTop&&this.clearContext(this.contextTop),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(t){var e=this[t===!0&&this.interactive?"contextTop":"contextContainer"],i=this.getActiveGroup();return this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop),t||this.clearContext(e),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,e),this._renderBackground(e),this._renderObjects(e,i),this._renderActiveGroup(e,i),this.clipTo&&e.restore(),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render"),this},_renderObjects:function(t,e){var i,r;if(!e||this.preserveObjectStacking)for(i=0,r=this._objects.length;r>i;++i)this._draw(t,this._objects[i]);else for(i=0,r=this._objects.length;r>i;++i)this._objects[i]&&!e.contains(this._objects[i])&&this._draw(t,this._objects[i])},_renderActiveGroup:function(t,e){if(e){var i=[];this.forEachObject(function(t){e.contains(t)&&i.push(t)}),e._set("_objects",i.reverse()),this._draw(t,e)}},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(t):this.backgroundColor,t.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height)),this.backgroundImage&&this._draw(t,this.backgroundImage)},_renderOverlay:function(t){this.overlayColor&&(t.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(t):this.overlayColor,t.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height)),this.overlayImage&&this._draw(t,this.overlayImage)},renderTop:function(){var t=this.contextTop||this.contextContainer;this.clearContext(t),this.selection&&this._groupSelector&&this._drawSelection();var e=this.getActiveGroup();return e&&e.render(t),this._renderOverlay(t),this.fire("after:render"),this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(t){return this._centerObject(t,new fabric.Point(this.getCenter().left,t.getCenterPoint().y)),this.renderAll(),this},centerObjectV:function(t){return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,this.getCenter().top)),this.renderAll(),this},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new fabric.Point(e.left,e.top)),this.renderAll(),this},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var r={objects:this._toObjects(e,i)};return t(r,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,r,i),r},_toObjects:function(t,e){return this.getObjects().map(function(i){return this._toObject(i,t,e)},this)},_toObject:function(t,e,i){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var s=this._realizeGroupTransformOnObject(t),n=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=r),this._unwindGroupTransformOnObject(t,s),n},_realizeGroupTransformOnObject:function(t){var e=["angle","flipX","flipY","height","left","scaleX","scaleY","top","width"];if(t.group&&t.group===this.getActiveGroup()){var i={};return e.forEach(function(e){i[e]=t[e]}),this.getActiveGroup().realizeTransform(t),i}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},__serializeBgOverlay:function(){var t={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(t.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(t.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(t.overlayImage=this.overlayImage.toObject()),t},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={});var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this._setSVGBgOverlayColor(i,"backgroundColor"),this._setSVGBgOverlayImage(i,"backgroundImage"),this._setSVGObjects(i,e),this._setSVGBgOverlayColor(i,"overlayColor"),this._setSVGBgOverlayImage(i,"overlayImage"),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,r,s;e.viewBox?(i=e.viewBox.width,r=e.viewBox.height):(i=this.width,r=this.height,this.svgViewportTransformation||(s=this.viewportTransform,i/=s[0],r/=s[3])),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',r,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,e.viewBox?'viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>");

},_setSVGObjects:function(t,e){for(var i=0,r=this.getObjects(),s=r.length;s>i;i++){var n=r[i],o=this._realizeGroupTransformOnObject(n);t.push(n.toSVG(e)),this._unwindGroupTransformOnObject(n,o)}},_setSVGBgOverlayImage:function(t,e){this[e]&&this[e].toSVG&&t.push(this[e].toSVG())},_setSVGBgOverlayColor:function(t,e){this[e]&&this[e].source?t.push('<rect x="',this[e].offsetX,'" y="',this[e].offsetY,'" ','width="',"repeat-y"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.width:this.width,'" height="',"repeat-x"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.height:this.height,'" fill="url(#'+e+'Pattern)"',"></rect>"):this[e]&&"overlayColor"===e&&t.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[e],'"',"></rect>")},sendToBack:function(t){return i(this._objects,t),this._objects.unshift(t),this.renderAll&&this.renderAll()},bringToFront:function(t){return i(this._objects,t),this._objects.push(t),this.renderAll&&this.renderAll()},sendBackwards:function(t,e){var r=this._objects.indexOf(t);if(0!==r){var s=this._findNewLowerIndex(t,r,e);i(this._objects,t),this._objects.splice(s,0,t),this.renderAll&&this.renderAll()}return this},_findNewLowerIndex:function(t,e,i){var r;if(i){r=e;for(var s=e-1;s>=0;--s){var n=t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t);if(n){r=s;break}}}else r=e-1;return r},bringForward:function(t,e){var r=this._objects.indexOf(t);if(r!==this._objects.length-1){var s=this._findNewUpperIndex(t,r,e);i(this._objects,t),this._objects.splice(s,0,t),this.renderAll&&this.renderAll()}return this},_findNewUpperIndex:function(t,e,i){var r;if(i){r=e;for(var s=e+1;s<this._objects.length;++s){var n=t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t);if(n){r=s;break}}}else r=e+1;return r},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this.interactive&&this.removeListeners(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),t(fabric.StaticCanvas.prototype,fabric.Observable),t(fabric.StaticCanvas.prototype,fabric.Collection),t(fabric.StaticCanvas.prototype,fabric.DataURLExporter),t(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=fabric.util.createCanvasElement();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"getImageData":return"undefined"!=typeof i.getImageData;case"setLineDash":return"undefined"!=typeof i.setLineDash;case"toDataURL":return"undefined"!=typeof e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(r){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeDashArray:null,setShadow:function(t){return this.shadow=new fabric.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){this._captureDrawingPath(t),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new fabric.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){this._points.push(t)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new fabric.Point(t.x,t.y);this._addPoint(e)},_render:function(){var t=this.canvas.contextTop,e=this.canvas.viewportTransform,i=this._points[0],r=this._points[1];t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.beginPath(),2===this._points.length&&i.x===r.x&&i.y===r.y&&(i.x-=.5,r.x+=.5),t.moveTo(i.x,i.y);for(var s=1,n=this._points.length;n>s;s++){var o=i.midPointFrom(r);t.quadraticCurveTo(i.x,i.y,o.x,o.y),i=this._points[s],r=this._points[s+1]}t.lineTo(i.x,i.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=[],i=new fabric.Point(t[0].x,t[0].y),r=new fabric.Point(t[1].x,t[1].y);e.push("M ",t[0].x," ",t[0].y," ");for(var s=1,n=t.length;n>s;s++){var o=i.midPointFrom(r);e.push("Q ",i.x," ",i.y," ",o.x," ",o.y," "),i=new fabric.Point(t[s].x,t[s].y),s+1<t.length&&(r=new fabric.Point(t[s+1].x,t[s+1].y))}return e.push("L ",i.x," ",i.y," "),e},createPath:function(t){var e=new fabric.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray,originX:"center",originY:"center"});return this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath();var e=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"===e)return void this.canvas.renderAll();var i=this.createPath(e);this.canvas.add(i),i.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:i})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop,r=this.canvas.viewportTransform;i.save(),i.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.fillStyle=e.fill,i.beginPath(),i.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.points.length;r>i;i++){var s=this.points[i],n=new fabric.Circle({radius:s.radius,left:s.x,top:s.y,originX:"center",originY:"center",fill:s.fill});this.shadow&&n.setShadow(this.shadow),e.push(n)}var o=new fabric.Group(e,{originX:"center",originY:"center"});o.canvas=this.canvas,this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},addPoint:function(t){var e=new fabric.Point(t.x,t.y),i=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=r,this.points.push(e),e}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render()},onMouseMove:function(t){this.addSprayChunk(t),this.render()},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.sprayChunks.length;r>i;i++)for(var s=this.sprayChunks[i],n=0,o=s.length;o>n;n++){var a=new fabric.Rect({width:s[n].width,height:s[n].width,left:s[n].x+1,top:s[n].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&a.setShadow(this.shadow),e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var h=new fabric.Group(e,{originX:"center",originY:"center"});h.canvas=this.canvas,this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},_getOptimizedRects:function(t){for(var e,i={},r=0,s=t.length;s>r;r++)e=t[r].left+""+t[r].top,i[e]||(i[e]=t[r]);var n=[];for(e in i)n.push(i[e]);return n},render:function(){var t=this.canvas.contextTop;t.fillStyle=this.color;var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]);for(var i=0,r=this.sprayChunkPoints.length;r>i;i++){var s=this.sprayChunkPoints[i];"undefined"!=typeof s.opacity&&(t.globalAlpha=s.opacity),t.fillRect(s.x,s.y,s.width,s.width)}t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];for(var e,i,r,s=this.width/2,n=0;n<this.density;n++){e=fabric.util.getRandomInt(t.x-s,t.x+s),i=fabric.util.getRandomInt(t.y-s,t.y+s),r=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var o=new fabric.Point(e,i);o.width=r,this.randomOpacity&&(o.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(o)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var t=20,e=5,i=fabric.document.createElement("canvas"),r=i.getContext("2d");return i.width=i.height=t+e,r.fillStyle=this.color,r.beginPath(),r.arc(t/2,t/2,t/2,0,2*Math.PI,!1),r.closePath(),r.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t);return e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()}),e}}),function(){var t=fabric.util.getPointer,e=fabric.util.degreesToRadians,i=fabric.util.radiansToDegrees,r=Math.atan2,s=Math.abs,n=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(t,e){e||(e={}),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas(),fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_resetCurrentTransform:function(t){var e=this._currentTransform;e.target.set({scaleX:e.original.scaleX,scaleY:e.original.scaleY,left:e.original.left,top:e.original.top}),this._shouldCenterTransform(t,e.target)?"rotate"===e.action?this._setOriginToCenter(e.target):("center"!==e.originX&&("right"===e.originX?e.mouseXSign=-1:e.mouseXSign=1),"center"!==e.originY&&("bottom"===e.originY?e.mouseYSign=-1:e.mouseYSign=1),e.originX="center",e.originY="center"):(e.originX=e.original.originX,e.originY=e.original.originY)},containsPoint:function(t,e){var i=this.getPointer(t,!0),r=this._normalizePointer(e,i);return e.containsPoint(r)||e._findTargetCorner(i)},_normalizePointer:function(t,e){var i,r=this.getActiveGroup(),s=e.x,n=e.y,o=r&&"group"!==t.type&&r.contains(t);return o&&(i=new fabric.Point(r.left,r.top),i=fabric.util.transformPoint(i,this.viewportTransform,!0),s-=i.x,n-=i.y),{x:s,y:n}},isTargetTransparent:function(t,e,i){var r=t.hasBorders,s=t.transparentCorners;t.hasBorders=t.transparentCorners=!1,this._draw(this.contextCache,t),t.hasBorders=r,t.transparentCorners=s;var n=fabric.util.isTransparent(this.contextCache,e,i,this.targetFindTolerance);return this.clearContext(this.contextCache),n},_shouldClearSelection:function(t,e){var i=this.getActiveGroup(),r=this.getActiveObject();return!e||e&&i&&!i.contains(e)&&i!==e&&!t.shiftKey||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t,e){if(e){var i,r=this._currentTransform;return"scale"===r.action||"scaleX"===r.action||"scaleY"===r.action?i=this.centeredScaling||e.centeredScaling:"rotate"===r.action&&(i=this.centeredRotation||e.centeredRotation),i?!t.altKey:t.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":("mr"===e||"tr"===e||"br"===e)&&(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":("bl"===e||"mb"===e||"br"===e)&&(i.y="top"),i},_getActionFromCorner:function(t,e){var i="drag";return e&&(i="ml"===e||"mr"===e?"scaleX":"mt"===e||"mb"===e?"scaleY":"mtr"===e?"rotate":"scale"),i},_setupCurrentTransform:function(t,i){if(i){var r=this.getPointer(t),s=i._findTargetCorner(this.getPointer(t,!0)),n=this._getActionFromCorner(i,s),o=this._getOriginFromCorner(i,s);this._currentTransform={target:i,action:n,scaleX:i.scaleX,scaleY:i.scaleY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:o.x,originY:o.y,ex:r.x,ey:r.y,left:i.left,top:i.top,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1},this._currentTransform.original={left:i.left,top:i.top,scaleX:i.scaleX,scaleY:i.scaleY,originX:o.x,originY:o.y},this._resetCurrentTransform(t)}},_translateObject:function(t,e){var i=this._currentTransform.target;i.get("lockMovementX")||i.set("left",t-this._currentTransform.offsetX),i.get("lockMovementY")||i.set("top",e-this._currentTransform.offsetY)},_scaleObject:function(t,e,i){var r=this._currentTransform,s=r.target,n=s.get("lockScalingX"),o=s.get("lockScalingY"),a=s.get("lockScalingFlip");if(!n||!o){var h=s.translateToOriginPoint(s.getCenterPoint(),r.originX,r.originY),c=s.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY);this._setLocalMouse(c,r),this._setObjectScale(c,r,n,o,i,a),s.setPositionByOrigin(h,r.originX,r.originY)}},_setObjectScale:function(t,e,i,r,s,n){var o=e.target,a=!1,h=!1,c="line"===o.type&&0===o.width,l="line"===o.type&&0===o.height,u=l?0:o.strokeWidth,f=c?0:o.strokeWidth;e.newScaleX=t.x/(o.width+u),e.newScaleY=t.y/(o.height+f),n&&e.newScaleX<=0&&e.newScaleX<o.scaleX&&(a=!0),n&&e.newScaleY<=0&&e.newScaleY<o.scaleY&&(h=!0),"equally"!==s||i||r?s?"x"!==s||o.get("lockUniScaling")?"y"!==s||o.get("lockUniScaling")||h||r||o.set("scaleY",e.newScaleY):a||i||o.set("scaleX",e.newScaleX):(a||i||o.set("scaleX",e.newScaleX),h||r||o.set("scaleY",e.newScaleY)):a||h||this._scaleObjectEqually(t,o,e),a||h||this._flipObject(e,s)},_scaleObjectEqually:function(t,e,i){var r=t.y+t.x,s="line"===e.type&&0===e.width,n="line"===e.type&&0===e.height,o=n?0:e.strokeWidth,a=s?0:e.strokeWidth,h=(e.height+a)*i.original.scaleY+(e.width+o)*i.original.scaleX;i.newScaleX=i.original.scaleX*r/h,i.newScaleY=i.original.scaleY*r/h,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY)},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),s(t.x)>i.padding?t.x<0?t.x+=i.padding:t.x-=i.padding:t.x=0,s(t.y)>i.padding?t.y<0?t.y+=i.padding:t.y-=i.padding:t.y=0},_rotateObject:function(t,e){var s=this._currentTransform;if(!s.target.get("lockRotation")){var n=r(s.ey-s.top,s.ex-s.left),o=r(e-s.top,t-s.left),a=i(o-n+s.theta);0>a&&(a=360+a),s.target.angle=a%360}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.setAngle(0)},_drawSelection:function(){var t=this.contextTop,e=this._groupSelector,i=e.left,r=e.top,o=s(i),a=s(r);if(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(r>0?0:-r),o,a),t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1){var h=e.ex+n-(i>0?0:o),c=e.ey+n-(r>0?0:a);t.beginPath(),fabric.util.drawDashedLine(t,h,c,h+o,c,this.selectionDashArray),fabric.util.drawDashedLine(t,h,c+a-1,h+o,c+a-1,this.selectionDashArray),fabric.util.drawDashedLine(t,h,c,h,c+a,this.selectionDashArray),fabric.util.drawDashedLine(t,h+o-1,c,h+o-1,c+a,this.selectionDashArray),t.closePath(),t.stroke()}else t.strokeRect(e.ex+n-(i>0?0:o),e.ey+n-(r>0?0:a),o,a)},_isLastRenderedObject:function(t){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(t,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(t,!0))},findTarget:function(t,e){if(!this.skipTargetFind){if(this._isLastRenderedObject(t))return this.lastRenderedObjectWithControlsAboveOverlay;var i=this.getActiveGroup();if(i&&!e&&this.containsPoint(t,i))return i;var r=this._searchPossibleTargets(t);return this._fireOverOutEvents(r,t),r}},_fireOverOutEvents:function(t,e){t?this._hoveredTarget!==t&&(this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout")),this.fire("mouse:over",{target:t,e:e}),t.fire("mouseover"),this._hoveredTarget=t):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget,e:e}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&this.containsPoint(t,e)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;var r=this.isTargetTransparent(e,i.x,i.y);if(!r)return!0}},_searchPossibleTargets:function(t){for(var e,i=this.getPointer(t,!0),r=this._objects.length;r--;)if(!this._objects[r].group&&this._checkTarget(t,this._objects[r],i)){this.relatedTarget=this._objects[r],e=this._objects[r];break}return e},getPointer:function(e,i,r){r||(r=this.upperCanvasEl);var s,n=t(e,r),o=r.getBoundingClientRect(),a=o.width||0,h=o.height||0;return a&&h||("top"in o&&"bottom"in o&&(h=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(a=Math.abs(o.right-o.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,i||(n=fabric.util.transformPoint(n,fabric.util.invertTransform(this.viewportTransform))),s=0===a||0===h?{width:1,height:1}:{width:r.width/a,height:r.height/h},{x:n.x*s.width,y:n.y*s.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.getWidth()||t.width,i=this.getHeight()||t.height;fabric.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0}),t.width=e,t.height=i,fabric.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(t){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=t,t.set("active",!0)},setActiveObject:function(t,e){return this._setActiveObject(t),this.renderAll(),this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e}),this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(t){return this._discardActiveObject(),this.renderAll(),this.fire("selection:cleared",{e:t}),this},_setActiveGroup:function(t){this._activeGroup=t,t&&t.set("active",!0)},setActiveGroup:function(t,e){return this._setActiveGroup(t),t&&(this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var t=this.getActiveGroup();t&&t.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(t){return this._discardActiveGroup(),this.fire("selection:cleared",{e:t}),this},deactivateAll:function(){for(var t=this.getObjects(),e=0,i=t.length;i>e;e++)t[e].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(t){var e=this.getActiveGroup()||this.getActiveObject();return e&&this.fire("before:selection:cleared",{target:e,e:t}),this.deactivateAll(),e&&this.fire("selection:cleared",{e:t}),this},drawControls:function(t){var e=this.getActiveGroup();e?this._drawGroupControls(t,e):this._drawObjectsControls(t)},_drawGroupControls:function(t,e){e._renderControls(t)},_drawObjectsControls:function(t){for(var e=0,i=this._objects.length;i>e;++e)this._objects[e]&&this._objects[e].active&&(this._objects[e]._renderControls(t),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[e])}});for(var o in fabric.StaticCanvas)"prototype"!==o&&(fabric.Canvas[o]=fabric.StaticCanvas[o]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=fabric.util.addListener,i=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),e(fabric.window,"resize",this._onResize),e(this.upperCanvasEl,"mousedown",this._onMouseDown),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"mousewheel",this._onMouseWheel),e(this.upperCanvasEl,"touchstart",this._onMouseDown),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){i(fabric.window,"resize",this._onResize),i(this.upperCanvasEl,"mousedown",this._onMouseDown),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"mousewheel",this._onMouseWheel),i(this.upperCanvasEl,"touchstart",this._onMouseDown),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t,e){this.__onMouseWheel&&this.__onMouseWheel(t,e)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onMouseDown:function(t){this.__onMouseDown(t),e(fabric.document,"touchend",this._onMouseUp),e(fabric.document,"touchmove",this._onMouseMove),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===t.type?i(this.upperCanvasEl,"mousedown",this._onMouseDown):(e(fabric.document,"mouseup",this._onMouseUp),e(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(t){if(this.__onMouseUp(t),i(fabric.document,"mouseup",this._onMouseUp),i(fabric.document,"touchend",this._onMouseUp),i(fabric.document,"mousemove",this._onMouseMove),i(fabric.document,"touchmove",this._onMouseMove),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchend"===t.type){var r=this;setTimeout(function(){e(r.upperCanvasEl,"mousedown",r._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this.getActiveGroup()||this.getActiveObject();return!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(t){var e;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);this._currentTransform?(this._finalizeCurrentTransform(),e=this._currentTransform.target):e=this.findTarget(t,!0);var i=this._shouldRender(e,this.getPointer(t));this._maybeGroupObjects(t),e&&(e.isMoving=!1),i&&this.renderAll(),this._handleCursorAndEvent(t,e)},_handleCursorAndEvent:function(t,e){this._setCursorFromEvent(t,e);var i=this;setTimeout(function(){i._setCursorFromEvent(t,e)},50),this.fire("mouse:up",{target:e,e:t}),e&&e.fire("mouseup",{e:t})},_finalizeCurrentTransform:function(){var t=this._currentTransform,e=t.target;e._scaling&&(e._scaling=!1),e.setCoords(),this.stateful&&e.hasStateChanged()&&(this.fire("object:modified",{target:e}),e.fire("modified")),this._restoreOriginXY(e)},_restoreOriginXY:function(t){if(this._previousOriginX&&this._previousOriginY){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.discardActiveObject(t).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseDown(i),this.fire("mouse:down",{e:t});var r=this.findTarget(t);"undefined"!=typeof r&&r.fire("mousedown",{e:t,target:r})},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseMove(i)}this.setCursor(this.freeDrawingCursor),this.fire("mouse:move",{e:t});var r=this.findTarget(t);"undefined"!=typeof r&&r.fire("mousemove",{e:t,target:r})},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this.fire("mouse:up",{e:t});var e=this.findTarget(t);"undefined"!=typeof e&&e.fire("mouseup",{e:t,target:e})},__onMouseDown:function(t){var e="which"in t?1===t.which:1===t.button;if(e||fabric.isTouchSupported){if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._currentTransform){var i=this.findTarget(t),r=this.getPointer(t,!0);this._previousPointer=r;var s=this._shouldRender(i,r),n=this._shouldGroup(t,i);this._shouldClearSelection(t,i)?this._clearSelection(t,i,r):n&&(this._handleGrouping(t,i),i=this.getActiveGroup()),i&&i.selectable&&!n&&(this._beforeTransform(t,i),this._setupCurrentTransform(t,i)),s&&this.renderAll(),this.fire("mouse:down",{target:i,e:t}),i&&i.fire("mousedown",{e:t})}}},_beforeTransform:function(t,e){this.stateful&&e.saveState(),e._findTargetCorner(this.getPointer(t))&&this.onBeforeScaleRotate(e),e!==this.getActiveGroup()&&e!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(e,t))},_clearSelection:function(t,e,i){this.deactivateAllWithDispatch(t),e&&e.selectable?this.setActiveObject(e,t):this.selection&&(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0})},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_setCenterToOrigin:function(t){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(t){var e,i;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!("undefined"!=typeof t.touches&&t.touches.length>1)){var r=this._groupSelector;r?(i=this.getPointer(t,!0),r.left=i.x-r.ex,r.top=i.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t),!e||e&&!e.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(t,e)),this.fire("mouse:move",{target:e,e:t}),e&&e.fire("mousemove",{e:t})}},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),this.renderAll()},_performTransformAction:function(t,e,i){var r=i.x,s=i.y,n=e.target,o=e.action;"rotate"===o?(this._rotateObject(r,s),this._fire("rotating",n,t)):"scale"===o?(this._onScale(t,e,r,s),this._fire("scaling",n,t)):"scaleX"===o?(this._scaleObject(r,s,"x"),this._fire("scaling",n,t)):"scaleY"===o?(this._scaleObject(r,s,"y"),this._fire("scaling",n,t)):(this._translateObject(r,s),this._fire("moving",n,t),this.setCursor(this.moveCursor))},_fire:function(t,e,i){this.fire("object:"+t,{target:e,e:i}),e.fire(t,{e:i})},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(t,e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(t),e.reset=!0)}},_onScale:function(t,e,i,r){!t.shiftKey&&!this.uniScaleTransform||e.target.get("lockUniScaling")?(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(t,e.target),e.currentAction="scaleEqually",this._scaleObject(i,r,"equally")):(e.currentAction="scale",this._scaleObject(i,r));

},_setCursorFromEvent:function(t,e){if(!e||!e.selectable)return this.setCursor(this.defaultCursor),!1;var i=this.getActiveGroup(),r=e._findTargetCorner&&(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));return r?this._setCornerCursor(r,e):this.setCursor(e.hoverCursor||this.hoverCursor),!0},_setCornerCursor:function(e,i){if(e in t)this.setCursor(this._getRotatedCornerCursor(e,i));else{if("mtr"!==e||!i.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(e,i){var r=Math.round(i.getAngle()%360/45);return 0>r&&(r+=8),r+=t[e],r%=8,this.cursorMap[r]}})}(),function(){var t=Math.min,e=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(t,e){var i=this.getActiveObject();return t.shiftKey&&(this.getActiveGroup()||i&&i!==e)&&this.selection},_handleGrouping:function(t,e){(e!==this.getActiveGroup()||(e=this.findTarget(t,!0),e&&!e.isType("group")))&&(this.getActiveGroup()?this._updateActiveGroup(e,t):this._createActiveGroup(e,t),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(t,e){var i=this.getActiveGroup();if(i.contains(t)){if(i.removeWithUpdate(t),this._resetObjectTransform(i),t.set("active",!1),1===i.size())return this.discardActiveGroup(e),void this.setActiveObject(i.item(0))}else i.addWithUpdate(t),this._resetObjectTransform(i);this.fire("selection:created",{target:i,e:e}),i.set("active",!0)},_createActiveGroup:function(t,e){if(this._activeObject&&t!==this._activeObject){var i=this._createGroup(t);i.addWithUpdate(),this.setActiveGroup(i),this._activeObject=null,this.fire("selection:created",{target:i,e:e})}t.set("active",!0)},_createGroup:function(t){var e=this.getObjects(),i=e.indexOf(this._activeObject)<e.indexOf(t),r=i?[this._activeObject,t]:[t,this._activeObject];return new fabric.Group(r,{canvas:this})},_groupSelectedObjects:function(t){var e=this._collectObjects();1===e.length?this.setActiveObject(e[0],t):e.length>1&&(e=new fabric.Group(e.reverse(),{canvas:this}),e.addWithUpdate(),this.setActiveGroup(e,t),e.saveCoords(),this.fire("selection:created",{target:e}),this.renderAll())},_collectObjects:function(){for(var i,r=[],s=this._groupSelector.ex,n=this._groupSelector.ey,o=s+this._groupSelector.left,a=n+this._groupSelector.top,h=new fabric.Point(t(s,o),t(n,a)),c=new fabric.Point(e(s,o),e(n,a)),l=s===o&&n===a,u=this._objects.length;u--&&(i=this._objects[u],!(i&&i.selectable&&i.visible&&(i.intersectsWithRect(h,c)||i.isContainedWithinRect(h,c)||i.containsPoint(h)||i.containsPoint(c))&&(i.set("active",!0),r.push(i),l))););return r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t);var e=this.getActiveGroup();e&&(e.setObjectsCoords().setCoords(),e.isMoving=!1,this.setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,r=t.multiplier||1,s={left:t.left,top:t.top,width:t.width,height:t.height};return 1!==r?this.__toDataURLWithMultiplier(e,i,s,r):this.__toDataURL(e,i,s)},__toDataURL:function(t,e,i){this.renderAll(!0);var r=this.upperCanvasEl||this.lowerCanvasEl,s=this.__getCroppedCanvas(r,i);"jpg"===t&&(t="jpeg");var n=fabric.StaticCanvas.supports("toDataURLWithQuality")?(s||r).toDataURL("image/"+t,e):(s||r).toDataURL("image/"+t);return this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),s&&(s=null),n},__getCroppedCanvas:function(t,e){var i,r,s="left"in e||"top"in e||"width"in e||"height"in e;return s&&(i=fabric.util.createCanvasElement(),r=i.getContext("2d"),i.width=e.width||this.width,i.height=e.height||this.height,r.drawImage(t,-e.left||0,-e.top||0)),i},__toDataURLWithMultiplier:function(t,e,i,r){var s=this.getWidth(),n=this.getHeight(),o=s*r,a=n*r,h=this.getActiveObject(),c=this.getActiveGroup(),l=this.contextTop||this.contextContainer;r>1&&this.setWidth(o).setHeight(a),l.scale(r,r),i.left&&(i.left*=r),i.top&&(i.top*=r),i.width?i.width*=r:1>r&&(i.width=o),i.height?i.height*=r:1>r&&(i.height=a),c?this._tempRemoveBordersControlsFromGroup(c):h&&this.deactivateAll&&this.deactivateAll(),this.renderAll(!0);var u=this.__toDataURL(t,e,i);return this.width=s,this.height=n,l.scale(1/r,1/r),this.setWidth(s).setHeight(n),c?this._restoreBordersControlsOnGroup(c):h&&this.setActiveObject&&this.setActiveObject(h),this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),u},toDataURLWithMultiplier:function(t,e,i){return this.toDataURL({format:t,multiplier:e,quality:i})},_tempRemoveBordersControlsFromGroup:function(t){t.origHasControls=t.hasControls,t.origBorderColor=t.borderColor,t.hasControls=!0,t.borderColor="rgba(0,0,0,0)",t.forEachObject(function(t){t.origBorderColor=t.borderColor,t.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(t){t.hideControls=t.origHideControls,t.borderColor=t.origBorderColor,t.forEachObject(function(t){t.borderColor=t.origBorderColor,delete t.origBorderColor})}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var r="string"==typeof t?JSON.parse(t):t;this.clear();var s=this;return this._enlivenObjects(r.objects,function(){s._setBgOverlay(r,e)},i),this}},_setBgOverlay:function(t,e){var i=this,r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(t.backgroundImage||t.overlayImage||t.background||t.overlay))return void(e&&e());var s=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&(i.renderAll(),e&&e())};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,s),this.__setBgOverlay("overlayImage",t.overlayImage,r,s),this.__setBgOverlay("backgroundColor",t.background,r,s),this.__setBgOverlay("overlayColor",t.overlay,r,s),s()},__setBgOverlay:function(t,e,i,r){var s=this;return e?void("backgroundImage"===t||"overlayImage"===t?fabric.Image.fromObject(e,function(e){s[t]=e,i[t]=!0,r&&r()}):this["set"+fabric.util.string.capitalize(t,!0)](e,function(){i[t]=!0,r&&r()})):void(i[t]=!0)},_enlivenObjects:function(t,e,i){var r=this;if(!t||0===t.length)return void(e&&e());var s=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(t,function(t){t.forEach(function(t,e){r.insertAt(t,e,!0)}),r.renderOnAddRemove=s,e&&e()},null,i)},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(r){i(r.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=fabric.document.createElement("canvas");e.width=this.getWidth(),e.height=this.getHeight();var i=new fabric.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.toFixed,s=e.util.string.capitalize,n=e.util.degreesToRadians,o=e.StaticCanvas.supports("setLineDash");e.Object||(e.Object=e.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(t){t&&this.setOptions(t)},_initGradient:function(t){!t.fill||!t.fill.colorStops||t.fill instanceof e.Gradient||this.set("fill",new e.Gradient(t.fill)),!t.stroke||!t.stroke.colorStops||t.stroke instanceof e.Gradient||this.set("stroke",new e.Gradient(t.stroke))},_initPattern:function(t){!t.fill||!t.fill.source||t.fill instanceof e.Pattern||this.set("fill",new e.Pattern(t.fill)),!t.stroke||!t.stroke.source||t.stroke instanceof e.Pattern||this.set("stroke",new e.Pattern(t.stroke))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var i=e.util.getFunctionBody(t.clipTo);"undefined"!=typeof i&&(this.clipTo=new Function("ctx",i))}},setOptions:function(t){for(var e in t)this.set(e,t[e]);this._initGradient(t),this._initPattern(t),this._initClipping(t)},transform:function(t,e){this.group&&this.canvas.preserveObjectStacking&&this.group===this.canvas._activeGroup&&this.group.transform(t);var i=e?this._getLeftTopCoords():this.getCenterPoint();t.translate(i.x,i.y),t.rotate(n(this.angle)),t.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,s={type:this.type,originX:this.originX,originY:this.originY,left:r(this.left,i),top:r(this.top,i),width:r(this.width,i),height:r(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,i),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,i),scaleX:r(this.scaleX,i),scaleY:r(this.scaleY,i),angle:r(this.getAngle(),i),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};return this.includeDefaultValues||(s=this._removeDefaultValues(s)),e.util.populateWithProperties(this,s,t),s},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype,r=i.stateProperties;return r.forEach(function(e){t[e]===i[e]&&delete t[e]}),t},toString:function(){return"#<fabric."+s(this.type)+">"},get:function(t){return this[t]},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,i){var s="scaleX"===t||"scaleY"===t;return s&&(i=this._constrainScale(i)),"scaleX"===t&&0>i?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&0>i?(this.flipY=!this.flipY,i*=-1):"width"===t||"height"===t?this.minScaleLimit=r(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==t||!i||i instanceof e.Shadow||(i=new e.Shadow(i)),this[t]=i,this},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},setSourcePath:function(t){return this.sourcePath=t,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(t,i){0===this.width&&0===this.height||!this.visible||(t.save(),this._setupCompositeOperation(t),i||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._setOpacity(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),this._render(t,i),this.clipTo&&t.restore(),t.restore())},_setOpacity:function(t){this.group&&this.group._setOpacity(t),t.globalAlpha*=this.opacity},_setStrokeStyles:function(t){this.stroke&&(t.lineWidth=this.strokeWidth,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,t.strokeStyle=this.stroke.toLive?this.stroke.toLive(t,this):this.stroke)},_setFillStyles:function(t){this.fill&&(t.fillStyle=this.fill.toLive?this.fill.toLive(t,this):this.fill)},_renderControls:function(t,i){if(this.active&&!i){var r=this.getViewportTransform();t.save();var s;this.group&&(s=e.util.transformPoint(this.group.getCenterPoint(),r),t.translate(s.x,s.y),t.rotate(n(this.group.angle))),s=e.util.transformPoint(this.getCenterPoint(),r,null!=this.group),this.group&&(s.x*=this.group.scaleX,s.y*=this.group.scaleY),t.translate(s.x,s.y),t.rotate(n(this.angle)),this.drawBorders(t),this.drawControls(t),t.restore()}},_setShadow:function(t){if(this.shadow){var e=this.canvas&&this.canvas.viewportTransform[0]||1,i=this.canvas&&this.canvas.viewportTransform[3]||1;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*(e+i)*(this.scaleX+this.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*e*this.scaleX,t.shadowOffsetY=this.shadow.offsetY*i*this.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_renderFill:function(t){if(this.fill){if(t.save(),this.fill.gradientTransform){var e=this.fill.gradientTransform;t.transform.apply(t,e)}this.fill.toLive&&t.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore()}},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeDashArray)1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),o?(t.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(t)):this._renderDashedStroke&&this._renderDashedStroke(t),t.stroke();else{if(this.stroke.gradientTransform){var e=this.stroke.gradientTransform;t.transform.apply(t,e)}this._stroke?this._stroke(t):t.stroke()}t.restore()}},clone:function(t,i){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(i),t):new e.Object(this.toObject(i))},cloneAsImage:function(t){var i=this.toDataURL();return e.util.loadImage(i,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.createCanvasElement(),r=this.getBoundingRect();i.width=r.width,i.height=r.height,e.util.wrapElement(i,"div");var s=new e.StaticCanvas(i);"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(s.backgroundColor="#fff");var n={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new e.Point(i.width/2,i.height/2),"center","center");var o=this.canvas;s.add(this);var a=s.toDataURL(t);return this.set(n).setCoords(),this.canvas=o,s.dispose(),s=null,a},isType:function(t){return this.type===t},complexity:function(){return 0},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var r={colorStops:[]};r.type=i.type||(i.r1||i.r2?"radial":"linear"),r.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(r.coords.r1=i.r1,r.coords.r2=i.r2);for(var s in i.colorStops){var n=new e.Color(i.colorStops[s]);r.colorStops.push({offset:s,color:n.toRgb(),opacity:n.getAlpha()})}return this.set(t,e.Gradient.forObject(this,r))},setPatternFill:function(t){return this.set("fill",new e.Pattern(t))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},setAngle:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas.centerObjectH(this),this},centerV:function(){return this.canvas.centerObjectV(this),this},center:function(){return this.canvas.centerObject(this),this},remove:function(){return this.canvas.remove(this),this},getLocalPointer:function(t,e){e=e||this.canvas.getPointer(t);var i=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:e.x-i.x,y:e.y-i.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors(e.Object),e.Object.prototype.rotate=e.Object.prototype.setAngle,i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.__uid=0)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(e,i,r){var s=e.x,n=e.y;return"left"===i?s=e.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i&&(s=e.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2),"top"===r?n=e.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r&&(n=e.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(s,n),e,t(this.angle))},translateToOriginPoint:function(e,i,r){var s=e.x,n=e.y;return"left"===i?s=e.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i&&(s=e.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2),"top"===r?n=e.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r&&(n=e.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(s,n),e,t(this.angle))},getCenterPoint:function(){var t=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,r){var s,n,o=this.getCenterPoint();return i&&r?(s="left"===i?o.x-(this.getWidth()+this.strokeWidth*this.scaleX)/2:"right"===i?o.x+(this.getWidth()+this.strokeWidth*this.scaleX)/2:o.x,n="top"===r?o.y-(this.getHeight()+this.strokeWidth*this.scaleY)/2:"bottom"===r?o.y+(this.getHeight()+this.strokeWidth*this.scaleY)/2:o.y):(s=this.left,n=this.top),fabric.util.rotatePoint(new fabric.Point(e.x,e.y),o,-t(this.angle)).subtractEquals(new fabric.Point(s,n))},setPositionByOrigin:function(t,e,i){var r=this.translateToCenterPoint(t,e,i),s=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(e){var i=t(this.angle),r=this.getWidth()/2,s=Math.cos(i)*r,n=Math.sin(i)*r,o=this.getWidth(),a=Math.cos(i)*o,h=Math.sin(i)*o;"center"===this.originX&&"left"===e||"right"===this.originX&&"center"===e?(this.left-=s,this.top-=n):"left"===this.originX&&"center"===e||"center"===this.originX&&"right"===e?(this.left+=s,this.top+=n):"left"===this.originX&&"right"===e?(this.left+=a,this.top+=h):"right"===this.originX&&"left"===e&&(this.left-=a,this.top-=h),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(t,e){var i=this.oCoords,r=new fabric.Point(i.tl.x,i.tl.y),s=new fabric.Point(i.tr.x,i.tr.y),n=new fabric.Point(i.bl.x,i.bl.y),o=new fabric.Point(i.br.x,i.br.y),a=fabric.Intersection.intersectPolygonRectangle([r,s,o,n],t,e);return"Intersection"===a.status},intersectsWithObject:function(t){function e(t){return{tl:new fabric.Point(t.tl.x,t.tl.y),tr:new fabric.Point(t.tr.x,t.tr.y),bl:new fabric.Point(t.bl.x,t.bl.y),br:new fabric.Point(t.br.x,t.br.y)}}var i=e(this.oCoords),r=e(t.oCoords),s=fabric.Intersection.intersectPolygonPolygon([i.tl,i.tr,i.br,i.bl],[r.tl,r.tr,r.br,r.bl]);return"Intersection"===s.status},isContainedWithinObject:function(t){var e=t.getBoundingRect(),i=new fabric.Point(e.left,e.top),r=new fabric.Point(e.left+e.width,e.top+e.height);return this.isContainedWithinRect(i,r)},isContainedWithinRect:function(t,e){var i=this.getBoundingRect();return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t){var e=this._getImageLines(this.oCoords),i=this._findCrossPoints(t,e);return 0!==i&&i%2===1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,r,s,n,o,a,h,c=0;for(var l in e)if(h=e[l],!(h.o.y<t.y&&h.d.y<t.y||h.o.y>=t.y&&h.d.y>=t.y||(h.o.x===h.d.x&&h.o.x>=t.x?(o=h.o.x,a=t.y):(i=0,r=(h.d.y-h.o.y)/(h.d.x-h.o.x),s=t.y-i*t.x,n=h.o.y-r*h.o.x,o=-(s-n)/(i-r),a=s+i*o),o>=t.x&&(c+=1),2!==c)))break;return c},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var t=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],e=fabric.util.array.min(t),i=fabric.util.array.max(t),r=Math.abs(e-i),s=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],n=fabric.util.array.min(s),o=fabric.util.array.max(s),a=Math.abs(n-o);return{left:e,top:n,width:r,height:a}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?0>t?-this.minScaleLimit:this.minScaleLimit:t},scale:function(t){return t=this._constrainScale(t),0>t&&(this.flipX=!this.flipX,this.flipY=!this.flipY,t*=-1),this.scaleX=t,this.scaleY=t,this.setCoords(),this},scaleToWidth:function(t){var e=this.getBoundingRectWidth()/this.getWidth();return this.scale(t/this.width/e)},scaleToHeight:function(t){var e=this.getBoundingRectHeight()/this.getHeight();return this.scale(t/this.height/e)},setCoords:function(){var e=t(this.angle),i=this.getViewportTransform(),r=function(t){return fabric.util.transformPoint(t,i)},s=this._calculateCurrentDimensions(!1),n=s.x,o=s.y;0>n&&(n=Math.abs(n));var a=Math.sqrt(Math.pow(n/2,2)+Math.pow(o/2,2)),h=Math.atan(isFinite(o/n)?o/n:0),c=Math.cos(h+e)*a,l=Math.sin(h+e)*a,u=Math.sin(e),f=Math.cos(e),d=this.getCenterPoint(),g=new fabric.Point(n,o),p=new fabric.Point(d.x-c,d.y-l),v=new fabric.Point(p.x+g.x*f,p.y+g.x*u),b=r(new fabric.Point(p.x-g.y*u,p.y+g.y*f)),m=r(new fabric.Point(v.x-g.y*u,v.y+g.y*f)),y=r(p),_=r(v),x=new fabric.Point((y.x+b.x)/2,(y.y+b.y)/2),C=new fabric.Point((_.x+y.x)/2,(_.y+y.y)/2),S=new fabric.Point((m.x+_.x)/2,(m.y+_.y)/2),w=new fabric.Point((m.x+b.x)/2,(m.y+b.y)/2),O=new fabric.Point(C.x+u*this.rotatingPointOffset,C.y-f*this.rotatingPointOffset);return this.oCoords={tl:y,tr:_,br:m,bl:b,ml:x,mt:C,mr:S,mb:w,mtr:O},this._setCornerCoords&&this._setCornerCoords(),this}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var t=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",e=this.fillRule,i=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",r=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"",n=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",h="undefined"!=typeof this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",l=this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":"";return["stroke: ",i,"; ","stroke-width: ",r,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",n,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ","fill: ",t,"; ","fill-rule: ",e,"; ","opacity: ",h,";",l,c].join("")},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var t=fabric.util.toFixed,e=this.getAngle(),i=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],r=fabric.util.transformPoint(this.getCenterPoint(),i),s=fabric.Object.NUM_FRACTION_DIGITS,n="path-group"===this.type?"":"translate("+t(r.x,s)+" "+t(r.y,s)+")",o=0!==e?" rotate("+t(e,s)+")":"",a=1===this.scaleX&&1===this.scaleY&&1===i[0]&&1===i[3]?"":" scale("+t(this.scaleX*i[0],s)+" "+t(this.scaleY*i[3],s)+")",h="path-group"===this.type?this.width*i[0]:0,c=this.flipX?" matrix(-1 0 0 1 "+h+" 0) ":"",l="path-group"===this.type?this.height*i[3]:0,u=this.flipY?" matrix(1 0 0 -1 0 "+l+")":"";return[n,o,a,c,u].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t}}),fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(t){return this.get(t)!==this.originalState[t]},this)},saveState:function(t){return this.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),t&&t.stateProperties&&t.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}}),function(){var t=fabric.util.degreesToRadians,e=function(){return"undefined"!=typeof G_vmlCanvasManager};fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||!this.active)return!1;var e,i,r=t.x,s=t.y;for(var n in this.oCoords)if(this.isControlVisible(n)&&("mtr"!==n||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==n&&"mr"!==n&&"mb"!==n&&"ml"!==n)&&(i=this._getImageLines(this.oCoords[n].corner),e=this._findCrossPoints({x:r,y:s},i),0!==e&&e%2===1))return this.__corner=n,n;return!1},_setCornerCoords:function(){var e,i,r=this.oCoords,s=t(45-this.angle),n=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,o=n*Math.cos(s),a=n*Math.sin(s);for(var h in r)e=r[h].x,i=r[h].y,r[h].corner={tl:{x:e-a,y:i-o},tr:{x:e+o,y:i-a},bl:{x:e-o,y:i+a},br:{x:e+a,y:i+o}}},_calculateCurrentDimensions:function(t){var e=this.getViewportTransform(),i=this.strokeWidth,r=this.width,s=this.height,n="round"===this.strokeLineCap||"square"===this.strokeLineCap,o="line"===this.type&&0===this.width,a="line"===this.type&&0===this.height,h=o||a,c=n&&a||!h,l=n&&o||!h;return o?r=i:a&&(s=i),c&&(r+=0>r?-i:i),l&&(s+=0>s?-i:i),r=r*this.scaleX+2*this.padding,s=s*this.scaleY+2*this.padding,t?fabric.util.transformPoint(new fabric.Point(r,s),e,!0):{x:r,y:s}},drawBorders:function(t){if(!this.hasBorders)return this;t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=this.borderColor,t.lineWidth=1/this.borderScaleFactor;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y;if(this.group&&(i*=this.group.scaleX,r*=this.group.scaleY),t.strokeRect(~~-(i/2)-.5,~~-(r/2)-.5,~~i+1,~~r+1),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var s=-r/2;t.beginPath(),t.moveTo(0,s),t.lineTo(0,s-this.rotatingPointOffset),t.closePath(),t.stroke()}return t.restore(),this},drawControls:function(t){if(!this.hasControls)return this;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y,s=-(i/2),n=-(r/2),o=this.cornerSize/2,a=this.transparentCorners?"strokeRect":"fillRect";return t.save(),t.lineWidth=1,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=t.fillStyle=this.cornerColor,this._drawControl("tl",t,a,s-o,n-o),this._drawControl("tr",t,a,s+i-o,n-o),this._drawControl("bl",t,a,s-o,n+r-o),this._drawControl("br",t,a,s+i-o,n+r-o),this.get("lockUniScaling")||(this._drawControl("mt",t,a,s+i/2-o,n-o),this._drawControl("mb",t,a,s+i/2-o,n+r-o),this._drawControl("mr",t,a,s+i-o,n+r/2-o),this._drawControl("ml",t,a,s-o,n+r/2-o)),this.hasRotatingPoint&&this._drawControl("mtr",t,a,s+i/2-o,n-this.rotatingPointOffset-o),t.restore(),this},_drawControl:function(t,i,r,s,n){if(this.isControlVisible(t)){var o=this.cornerSize;e()||this.transparentCorners||i.clearRect(s,n,o,o),i[r](s,n,o,o)}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),n.renderAll(),s()},onComplete:function(){t.setCoords(),r()}}),this},fxCenterObjectV:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),n.renderAll(),s()},onComplete:function(){t.setCoords(),r()}}),this},fxRemove:function(t,e){e=e||{};var i=function(){},r=e.onComplete||i,s=e.onChange||i,n=this;return fabric.util.animate({startValue:t.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){t.set("active",!1)},onChange:function(e){t.set("opacity",e),n.renderAll(),s()},onComplete:function(){n.remove(t),r()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var r=0,s=i.length;s>r;r++)t=i[r],e=r!==s-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,r){var s,n=this;e=e.toString(),i=i?fabric.util.object.clone(i):{},~t.indexOf(".")&&(s=t.split("."));var o=s?this.get(s[0])[s[1]]:this.get(t);"from"in i||(i.from=o),e=~e.indexOf("=")?o+parseFloat(e.replace("=","")):parseFloat(e),fabric.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(n)},onChange:function(e){s?n[s[0]][s[1]]=e:n.set(t,e),r||i.onChange&&i.onChange()},onComplete:function(){r||(n.setCoords(),i.onComplete&&i.onComplete())}})}}),function(t){"use strict";function e(t,e){var i=t.origin,r=t.axis1,s=t.axis2,n=t.dimension,o=e.nearest,a=e.center,h=e.farthest;return function(){switch(this.get(i)){case o:return Math.min(this.get(r),this.get(s));case a:return Math.min(this.get(r),this.get(s))+.5*this.get(n);case h:return Math.max(this.get(r),this.get(s));

}}}var i=t.fabric||(t.fabric={}),r=i.util.object.extend,s={x1:1,x2:1,y1:1,y2:1},n=i.StaticCanvas.supports("setLineDash");return i.Line?void i.warn("fabric.Line is already defined"):(i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(t,e){e=e||{},t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),"undefined"!=typeof s[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t,e){if(t.beginPath(),e){var i=this.getCenterPoint();t.translate(i.x-this.strokeWidth/2,i.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&n){var r=this.calcLinePoints();t.moveTo(r.x1,r.y1),t.lineTo(r.x2,r.y2)}t.lineWidth=this.strokeWidth;var s=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=s},_renderDashedStroke:function(t){var e=this.calcLinePoints();t.beginPath(),i.util.drawDashedLine(t,e.x1,e.y1,e.x2,e.y2,this.strokeDashArray),t.closePath()},toObject:function(t){return r(this.callSuper("toObject",t),this.calcLinePoints())},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,r=e*this.height*.5,s=t*this.width*-.5,n=e*this.height*-.5;return{x1:i,x2:s,y1:r,y2:n}},toSVG:function(t){var e=this._createBaseSVGMarkup(),i={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};return this.group&&"path-group"===this.group.type||(i=this.calcLinePoints()),e.push("<line ",'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(t,e){var s=i.parseAttributes(t,i.Line.ATTRIBUTE_NAMES),n=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];return new i.Line(n,r(s,e))},void(i.Line.fromObject=function(t){var e=[t.x1,t.y1,t.x2,t.y2];return new i.Line(e,t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){return"radius"in t&&t.radius>=0}var i=t.fabric||(t.fabric={}),r=Math.PI,s=i.util.object.extend;return i.Circle?void i.warn("fabric.Circle is already defined."):(i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*r,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("radius",t.radius||0),this.startAngle=t.startAngle||this.startAngle,this.endAngle=t.endAngle||this.endAngle},_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return s(this.callSuper("toObject",t),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,s=0,n=(this.endAngle-this.startAngle)%(2*r);if(0===n)this.group&&"path-group"===this.group.type&&(i=this.left+this.radius,s=this.top+this.radius),e.push("<circle ",'cx="'+i+'" cy="'+s+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');else{var o=Math.cos(this.startAngle)*this.radius,a=Math.sin(this.startAngle)*this.radius,h=Math.cos(this.endAngle)*this.radius,c=Math.sin(this.endAngle)*this.radius,l=n>r?"1":"0";e.push('<path d="M '+o+" "+a," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+h+" "+c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')}return t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.arc(e?this.left+this.radius:0,e?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1),this._renderFill(t),this._renderStroke(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){this.radius=t,this.set("width",2*t).set("height",2*t)},complexity:function(){return 1}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(t,r){r||(r={});var n=i.parseAttributes(t,i.Circle.ATTRIBUTE_NAMES);if(!e(n))throw new Error("value of `r` attribute is required and can not be negative");n.left=n.left||0,n.top=n.top||0;var o=new i.Circle(s(n,r));return o.left-=o.radius,o.top-=o.radius,o},void(i.Circle.fromObject=function(t){return new i.Circle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Triangle?void e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("width",t.width||100).set("height",t.height||100)},_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,i,r,this.strokeDashArray),e.util.drawDashedLine(t,i,r,-i,r,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,r=this.height/2,s=[-i+" "+r,"0 "+-r,i+" "+r].join(",");return e.push("<polygon ",'points="',s,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),void(e.Triangle.fromObject=function(t){return new e.Triangle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI,r=e.util.object.extend;return e.Ellipse?void e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("rx",t.rx||0),this.set("ry",t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return r(this.callSuper("toObject",t),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,r=0;return this.group&&"path-group"===this.group.type&&(i=this.left+this.rx,r=this.top+this.ry),e.push("<ellipse ",'cx="',i,'" cy="',r,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(e?this.left+this.rx:0,e?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,i,!1),t.restore(),this._renderFill(t),this._renderStroke(t)},complexity:function(){return 1}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){i||(i={});var s=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var n=new e.Ellipse(r(s,i));return n.top-=n.ry,n.left-=n.rx,n},void(e.Ellipse.fromObject=function(t){return new e.Ellipse(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;if(e.Rect)return void console.warn("fabric.Rect is already defined");var r=e.Object.prototype.stateProperties.concat();r.push("rx","ry","x","y"),e.Rect=e.util.createClass(e.Object,{stateProperties:r,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1===this.width&&1===this.height)return void t.fillRect(0,0,1,1);var i=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,s=this.width,n=this.height,o=e?this.left:-this.width/2,a=e?this.top:-this.height/2,h=0!==i||0!==r,c=.4477152502;t.beginPath(),t.moveTo(o+i,a),t.lineTo(o+s-i,a),h&&t.bezierCurveTo(o+s-c*i,a,o+s,a+c*r,o+s,a+r),t.lineTo(o+s,a+n-r),h&&t.bezierCurveTo(o+s,a+n-c*r,o+s-c*i,a+n,o+s-i,a+n),t.lineTo(o+i,a+n),h&&t.bezierCurveTo(o+c*i,a+n,o,a+n-c*r,o,a+n-r),t.lineTo(o,a+r),h&&t.bezierCurveTo(o,a+c*r,o+c*i,a,o+i,a),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=-this.width/2,r=-this.height/2,s=this.width,n=this.height;t.beginPath(),e.util.drawDashedLine(t,i,r,i+s,r,this.strokeDashArray),e.util.drawDashedLine(t,i+s,r,i+s,r+n,this.strokeDashArray),e.util.drawDashedLine(t,i+s,r+n,i,r+n,this.strokeDashArray),e.util.drawDashedLine(t,i,r+n,i,r,this.strokeDashArray),t.closePath()},toObject:function(t){var e=i(this.callSuper("toObject",t),{rx:this.get("rx")||0,ry:this.get("ry")||0});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.left,r=this.top;return this.group&&"path-group"===this.group.type||(i=-this.width/2,r=-this.height/2),e.push("<rect ",'x="',i,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r){if(!t)return null;r=r||{};var s=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var n=new e.Rect(i(r?e.util.object.clone(r):{},s));return n.visible=n.width>0&&n.height>0,n},e.Rect.fromObject=function(t){return new e.Rect(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Polyline?void e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(t,i){return e.Polygon.prototype.initialize.call(this,t,i)},_calcDimensions:function(){return e.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return e.Polygon.prototype._applyPointOffset.call(this)},toObject:function(t){return e.Polygon.prototype.toObject.call(this,t)},toSVG:function(t){return e.Polygon.prototype.toSVG.call(this,t)},_render:function(t){e.Polygon.prototype.commonRender.call(this,t)&&(this._renderFill(t),this._renderStroke(t))},_renderDashedStroke:function(t){var i,r;t.beginPath();for(var s=0,n=this.points.length;n>s;s++)i=this.points[s],r=this.points[s+1]||i,e.util.drawDashedLine(t,i.x,i.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i){if(!t)return null;i||(i={});var r=e.parsePointsAttribute(t.getAttribute("points")),s=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);return new e.Polyline(r,e.util.object.extend(s,i))},void(e.Polyline.fromObject=function(t){var i=t.points;return new e.Polyline(i,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,s=e.util.array.max,n=e.util.toFixed;return e.Polygon?void e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._calcDimensions(),"top"in e||(this.top=this.minY),"left"in e||(this.left=this.minX)},_calcDimensions:function(){var t=this.points,e=r(t,"x"),i=r(t,"y"),n=s(t,"x"),o=s(t,"y");this.width=n-e||0,this.height=o-i||0,this.minX=e||0,this.minY=i||0},_applyPointOffset:function(){this.points.forEach(function(t){t.x-=this.minX+this.width/2,t.y-=this.minY+this.height/2},this)},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r=0,s=this.points.length;s>r;r++)e.push(n(this.points[r].x,2),",",n(this.points[r].y,2)," ");return i.push("<",this.type," ",'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(i.join("")):i.join("")},_render:function(t){this.commonRender(t)&&(this._renderFill(t),(this.stroke||this.strokeDashArray)&&(t.closePath(),this._renderStroke(t)))},commonRender:function(t){var e,i=this.points.length;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=null),t.moveTo(this.points[0].x,this.points[0].y);for(var r=0;i>r;r++)e=this.points[r],t.lineTo(e.x,e.y);return!0},_renderDashedStroke:function(t){e.Polyline.prototype._renderDashedStroke.call(this,t),t.closePath()},complexity:function(){return this.points.length}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,r){if(!t)return null;r||(r={});var s=e.parsePointsAttribute(t.getAttribute("points")),n=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);return new e.Polygon(s,i(n,r))},void(e.Polygon.fromObject=function(t){return new e.Polygon(t.points,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max,s=e.util.object.extend,n=Object.prototype.toString,o=e.util.drawArc,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};return e.Path?void e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(t,e){if(e=e||{},this.setOptions(e),!t)throw new Error("`path` argument is required");var i="[object Array]"===n.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),this._setPositionDimensions(e),e.sourcePath&&this.setSourcePath(e.sourcePath))},_setPositionDimensions:function(t){var e=this._parseDimensions();this.minX=e.left,this.minY=e.top,this.width=e.width,this.height=e.height,"undefined"==typeof t.left&&(this.left=e.left+("center"===this.originX?this.width/2:"right"===this.originX?this.width:0)),"undefined"==typeof t.top&&(this.top=e.top+("center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0)),this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_render:function(t){var e,i,r,s=null,n=0,a=0,h=0,c=0,l=0,u=0,f=-this.pathOffset.x,d=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(f=0,d=0),t.beginPath();for(var g=0,p=this.path.length;p>g;++g){switch(e=this.path[g],e[0]){case"l":h+=e[1],c+=e[2],t.lineTo(h+f,c+d);break;case"L":h=e[1],c=e[2],t.lineTo(h+f,c+d);break;case"h":h+=e[1],t.lineTo(h+f,c+d);break;case"H":h=e[1],t.lineTo(h+f,c+d);break;case"v":c+=e[1],t.lineTo(h+f,c+d);break;case"V":c=e[1],t.lineTo(h+f,c+d);break;case"m":h+=e[1],c+=e[2],n=h,a=c,t.moveTo(h+f,c+d);break;case"M":h=e[1],c=e[2],n=h,a=c,t.moveTo(h+f,c+d);break;case"c":i=h+e[5],r=c+e[6],l=h+e[3],u=c+e[4],t.bezierCurveTo(h+e[1]+f,c+e[2]+d,l+f,u+d,i+f,r+d),h=i,c=r;break;case"C":h=e[5],c=e[6],l=e[3],u=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,l+f,u+d,h+f,c+d);break;case"s":i=h+e[3],r=c+e[4],null===s[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,h+e[1]+f,c+e[2]+d,i+f,r+d),l=h+e[1],u=c+e[2],h=i,c=r;break;case"S":i=e[3],r=e[4],null===s[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"q":i=h+e[3],r=c+e[4],l=h+e[1],u=c+e[2],t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"Q":i=e[3],r=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"t":i=h+e[1],r=c+e[2],null===s[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"T":i=e[1],r=e[2],null===s[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"a":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+h+f,e[7]+c+d]),h+=e[6],c+=e[7];break;case"A":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),h=e[6],c=e[7];break;case"z":case"Z":h=n,c=a,t.closePath()}s=e}this._renderFill(t),this._renderStroke(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){var e=s(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(e.sourcePath=this.sourcePath),this.transformMatrix&&(e.transformMatrix=this.transformMatrix),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.path=this.sourcePath),delete e.sourcePath,e},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r="",s=0,n=this.path.length;n>s;s++)e.push(this.path[s].join(" "));var o=e.join(" ");return this.group&&"path-group"===this.group.type||(r=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") "),i.push("<path ",'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),r,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),t?t(i.join("")):i.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,r,s,n=[],o=[],c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l=0,u=this.path.length;u>l;l++){for(t=this.path[l],r=t.slice(1).trim(),o.length=0;i=c.exec(r);)o.push(i[0]);s=[t.charAt(0)];for(var f=0,d=o.length;d>f;f++)e=parseFloat(o[f]),isNaN(e)||s.push(e);var g=s[0],p=a[g.toLowerCase()],v=h[g]||g;if(s.length-1>p)for(var b=1,m=s.length;m>b;b+=p)n.push([g].concat(s.slice(b,b+p))),g=v;else n.push(s)}return n},_parseDimensions:function(){for(var t,s,n,o,a=[],h=[],c=null,l=0,u=0,f=0,d=0,g=0,p=0,v=0,b=this.path.length;b>v;++v){switch(t=this.path[v],t[0]){case"l":f+=t[1],d+=t[2],o=[];break;case"L":f=t[1],d=t[2],o=[];break;case"h":f+=t[1],o=[];break;case"H":f=t[1],o=[];break;case"v":d+=t[1],o=[];break;case"V":d=t[1],o=[];break;case"m":f+=t[1],d+=t[2],l=f,u=d,o=[];break;case"M":f=t[1],d=t[2],l=f,u=d,o=[];break;case"c":s=f+t[5],n=d+t[6],g=f+t[3],p=d+t[4],o=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],g,p,s,n),f=s,d=n;break;case"C":f=t[5],d=t[6],g=t[3],p=t[4],o=e.util.getBoundsOfCurve(f,d,t[1],t[2],g,p,f,d);break;case"s":s=f+t[3],n=d+t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,f+t[1],d+t[2],s,n),g=f+t[1],p=d+t[2],f=s,d=n;break;case"S":s=t[3],n=t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,t[1],t[2],s,n),f=s,d=n,g=t[1],p=t[2];break;case"q":s=f+t[3],n=d+t[4],g=f+t[1],p=d+t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"Q":g=t[1],p=t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,t[3],t[4]),f=t[3],d=t[4];break;case"t":s=f+t[1],n=d+t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"T":s=t[1],n=t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,s,n),f=s,d=n;break;case"a":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=l,d=u}c=t,o.forEach(function(t){a.push(t.x),h.push(t.y)}),a.push(f),h.push(d)}var m=i(a),y=i(h),_=r(a),x=r(h),C=_-m,S=x-y,w={left:m,top:y,width:C,height:S};return w}}),e.Path.fromObject=function(t,i){"string"==typeof t.path?e.loadSVGFromURL(t.path,function(r){var s=r[0],n=t.path;delete t.path,e.util.object.extend(s,t),s.setSourcePath(n),i(s)}):i(new e.Path(t.path,t))},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,r){var n=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);i&&i(new e.Path(n.d,s(n,r)))},void(e.Path.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.invoke,s=e.Object.prototype.toObject;return e.PathGroup?void e.warn("fabric.PathGroup is already defined"):(e.PathGroup=e.util.createClass(e.Path,{type:"path-group",fill:"",initialize:function(t,e){e=e||{},this.paths=t||[];for(var i=this.paths.length;i--;)this.paths[i].group=this;e.toBeParsed&&(this.parseDimensionsFromPaths(e),delete e.toBeParsed),this.setOptions(e),this.setCoords(),e.sourcePath&&this.setSourcePath(e.sourcePath)},parseDimensionsFromPaths:function(t){for(var i,r,s,n,o,a=[],h=[],c=this.transformMatrix,l=this.paths.length;l--;){s=this.paths[l],n=s.height+s.strokeWidth,o=s.width+s.strokeWidth,i=[{x:s.left,y:s.top},{x:s.left+o,y:s.top},{x:s.left,y:s.top+n},{x:s.left+o,y:s.top+n}];for(var u=0;u<i.length;u++)r=i[u],c&&(r=e.util.transformPoint(r,c,!1)),a.push(r.x),h.push(r.y)}t.width=Math.max.apply(null,a),t.height=Math.max.apply(null,h)},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),t.translate(-this.width/2,-this.height/2);for(var i=0,r=this.paths.length;r>i;++i)this.paths[i].render(t,!0);this.clipTo&&t.restore(),t.restore()}},_set:function(t,e){if("fill"===t&&e&&this.isSameColor())for(var i=this.paths.length;i--;)this.paths[i]._set(t,e);return this.callSuper("_set",t,e)},toObject:function(t){var e=i(s.call(this,t),{paths:r(this.getObjects(),"toObject",t)});return this.sourcePath&&(e.sourcePath=this.sourcePath),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.paths=this.sourcePath),e},toSVG:function(t){for(var e=this.getObjects(),i=this.getPointByOrigin("left","top"),r="translate("+i.x+" "+i.y+")",s=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),r,this.getSvgTransform(),'" ',">\n"],n=0,o=e.length;o>n;n++)s.push(e[n].toSVG(t));return s.push("</g>\n"),t?t(s.join("")):s.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var t=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(e){return(e.get("fill")||"").toLowerCase()===t})},complexity:function(){return this.paths.reduce(function(t,e){return t+(e&&e.complexity?e.complexity():0)},0)},getObjects:function(){return this.paths}}),e.PathGroup.fromObject=function(t,i){"string"==typeof t.paths?e.loadSVGFromURL(t.paths,function(r){var s=t.paths;delete t.paths;var n=e.util.groupSVGElements(r,t,s);i(n)}):e.util.enlivenObjects(t.paths,function(r){delete t.paths,i(new e.PathGroup(r,t))})},void(e.PathGroup.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,s=e.util.array.max,n=e.util.array.invoke;if(!e.Group){var o={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,initialize:function(t,e){e=e||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;this.originalState={},e.originX&&(this.originX=e.originX),e.originY&&(this.originY=e.originY),this._calcBounds(),this._updateObjectsCoords(),this.callSuper("initialize",e),this.setCoords(),this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(t){var e=t.getLeft(),i=t.getTop(),r=this.getCenterPoint();t.set({originalLeft:e,originalTop:i,left:e-r.x,top:i-r.y}),t.setCoords(),t.__origHasControls=t.hasControls,t.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(t){t.set("active",!0),t.group=this},removeWithUpdate:function(t){return this._moveFlippedObject(t),this._restoreObjectsState(),this.forEachObject(this._setObjectActive,this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(t){t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){delete t.group,t.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(t,e){if(t in this.delegatedProperties||"canvas"===t)for(var i=this._objects.length;i--;)this._objects[i].set(t,e);this.callSuper("_set",t,e)},toObject:function(t){return i(this.callSuper("toObject",t),{objects:n(this._objects,"toObject",t)})},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this.clipTo&&e.util.clipContext(this,t);for(var i=0,r=this._objects.length;r>i;i++)this._renderObject(this._objects[i],t);this.clipTo&&t.restore(),t.restore()}},_renderControls:function(t,e){this.callSuper("_renderControls",t,e);for(var i=0,r=this._objects.length;r>i;i++)this._objects[i]._renderControls(t)},_renderObject:function(t,e){if(t.visible){var i=t.hasRotatingPoint;t.hasRotatingPoint=!1,t.render(e),t.hasRotatingPoint=i}},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){return this._moveFlippedObject(t),this._setObjectPosition(t),t},_moveFlippedObject:function(t){var e=t.get("originX"),i=t.get("originY"),r=t.getCenterPoint();t.set({originX:"center",originY:"center",left:r.x,top:r.y}),this._toggleFlipping(t);var s=t.getPointByOrigin(e,i);return t.set({originX:e,originY:i,left:s.x,top:s.y}),this},_toggleFlipping:function(t){this.flipX&&(t.toggle("flipX"),t.set("left",-t.get("left")),t.setAngle(-t.getAngle())),this.flipY&&(t.toggle("flipY"),t.set("top",-t.get("top")),t.setAngle(-t.getAngle()))},_restoreObjectState:function(t){return this._setObjectPosition(t),t.setCoords(),t.hasControls=t.__origHasControls,delete t.__origHasControls,t.set("active",!1),t.setCoords(),delete t.group,this},_setObjectPosition:function(t){var e=this.getCenterPoint(),i=this._getRotatedLeftTop(t);t.set({angle:t.getAngle()+this.getAngle(),left:e.x+i.left,top:e.y+i.top,scaleX:t.get("scaleX")*this.get("scaleX"),scaleY:t.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(t){var e=this.getAngle()*(Math.PI/180);return{left:-Math.sin(e)*t.getTop()*this.get("scaleY")+Math.cos(e)*t.getLeft()*this.get("scaleX"),top:Math.cos(e)*t.getTop()*this.get("scaleY")+Math.sin(e)*t.getLeft()*this.get("scaleX")}},destroy:function(){return this._objects.forEach(this._moveFlippedObject,this),this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords()}),this},_calcBounds:function(t){for(var e,i,r=[],s=[],n=["tr","br","bl","tl"],o=0,a=this._objects.length;a>o;++o){e=this._objects[o],e.setCoords();for(var h=0;h<n.length;h++)i=n[h],r.push(e.oCoords[i].x),s.push(e.oCoords[i].y)}this.set(this._getBounds(r,s,t))},_getBounds:function(t,i,n){var o=e.util.invertTransform(this.getViewportTransform()),a=e.util.transformPoint(new e.Point(r(t),r(i)),o),h=e.util.transformPoint(new e.Point(s(t),s(i)),o),c={width:h.x-a.x||0,height:h.y-a.y||0};return n||(c.left=a.x||0,c.top=a.y||0,"center"===this.originX&&(c.left+=c.width/2),"right"===this.originX&&(c.left+=c.width),"center"===this.originY&&(c.top+=c.height/2),"bottom"===this.originY&&(c.top+=c.height)),c},toSVG:function(t){for(var e=["<g ",'transform="',this.getSvgTransform(),'">\n'],i=0,r=this._objects.length;r>i;i++)e.push(this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")},get:function(t){if(t in o){if(this[t])return this[t];for(var e=0,i=this._objects.length;i>e;e++)if(this._objects[e][t])return!0;return!1}return t in this.delegatedProperties?this._objects[0]&&this._objects[0].get(t):this[t]}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){delete t.objects,i&&i(new e.Group(r,t))})},e.Group.async=!0}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=fabric.util.object.extend;return t.fabric||(t.fabric={}),t.fabric.Image?void fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(t,e){e||(e={}),this.filters=[],this.resizeFilters=[],this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element},setElement:function(t,e,i){return this._element=t,this._originalElement=t,this._initConfig(i),0!==this.filters.length?this.applyFilters(e):e&&e(),this},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.width,height:t.height}},_stroke:function(t){t.save(),this._setStrokeStyles(t),t.beginPath(),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.closePath(),t.restore()},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,r=this.width,s=this.height;t.save(),this._setStrokeStyles(t),t.beginPath(),fabric.util.drawDashedLine(t,e,i,e+r,i,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i,e+r,i+s,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i+s,e,i+s,this.strokeDashArray),fabric.util.drawDashedLine(t,e,i+s,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var i=e(this.callSuper("toObject",t),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(t){return t&&t.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice});return this.resizeFilters.length>0&&(i.resizeFilters=this.resizeFilters.map(function(t){return t&&t.toObject()})),i},toSVG:function(t){var e=[],i=-this.width/2,r=-this.height/2,s="none";if(this.group&&"path-group"===this.group.type&&(i=this.left,r=this.top),"none"!==this.alignX&&"none"!==this.alignY&&(s="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice),e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',i,'" y="',r,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',s,'"',"></image>\n"),this.stroke||this.strokeDashArray){var n=this.fill;this.fill=null,e.push("<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=n}return e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(){return this.getElement()?this.getElement().src||this.getElement()._src:void 0},setSrc:function(t,e,i){fabric.util.loadImage(t,function(t){return this.setElement(t,e,i)},this,i&&i.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(t,e){this.constructor.fromObject(this.toObject(e),t)},applyFilters:function(t,e,i,r){if(e=e||this.filters,
i=i||this._originalElement){var s=i,n=fabric.util.createCanvasElement(),o=fabric.util.createImage(),a=this;return n.width=s.width,n.height=s.height,n.getContext("2d").drawImage(s,0,0,s.width,s.height),0===e.length?(this._element=i,t&&t(),n):(e.forEach(function(t){t&&t.applyTo(n,t.scaleX||a.scaleX,t.scaleY||a.scaleY),!r&&t&&"Resize"===t.type&&(a.width*=t.scaleX,a.height*=t.scaleY)}),o.width=n.width,o.height=n.height,fabric.isLikelyNode?(o.src=n.toBuffer(void 0,fabric.Image.pngCompression),a._element=o,!r&&(a._filteredEl=o),t&&t()):(o.onload=function(){a._element=o,!r&&(a._filteredEl=o),t&&t(),o.onload=n=s=null},o.src=n.toDataURL("image/png")),n)}},_render:function(t,e){var i,r,s,n=this._findMargins();i=e?this.left:-this.width/2,r=e?this.top:-this.height/2,"slice"===this.meetOrSlice&&(t.beginPath(),t.rect(i,r,this.width,this.height),t.clip()),this.isMoving===!1&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,s=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):s=this._element,s&&t.drawImage(s,i+n.marginX,r+n.marginY,n.width,n.height),this._renderStroke(t)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var t,e,i=this.width,r=this.height,s=0,n=0;return("none"!==this.alignX||"none"!==this.alignY)&&(t=[this.width/this._element.width,this.height/this._element.height],e="meet"===this.meetOrSlice?Math.min.apply(null,t):Math.max.apply(null,t),i=this._element.width*e,r=this._element.height*e,"Mid"===this.alignX&&(s=(this.width-i)/2),"Max"===this.alignX&&(s=this.width-i),"Mid"===this.alignY&&(n=(this.height-r)/2),"Max"===this.alignY&&(n=this.height-r)),{width:i,height:r,marginX:s,marginY:n}},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},_initElement:function(t){this.setElement(fabric.util.getById(t)),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?fabric.util.enlivenObjects(t,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()?this.getElement().width||0:0,this.height="height"in t?t.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){fabric.Image.prototype._initFilters.call(t,t.filters,function(r){t.filters=r||[],fabric.Image.prototype._initFilters.call(t,t.resizeFilters,function(r){t.resizeFilters=r||[];var s=new fabric.Image(i,t);e&&e(s)})})},null,t.crossOrigin)},fabric.Image.fromURL=function(t,e,i){fabric.util.loadImage(t,function(t){e&&e(new fabric.Image(t,i))},null,i&&i.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(t,i,r){var s,n,o,a=fabric.parseAttributes(t,fabric.Image.ATTRIBUTE_NAMES),h="xMidYMid",c="meet";a.preserveAspectRatio&&(o=a.preserveAspectRatio.split(" ")),o&&o.length&&(c=o.pop(),"meet"!==c&&"slice"!==c?(h=c,c="meet"):o.length&&(h=o.pop())),s="none"!==h?h.slice(1,4):"none",n="none"!==h?h.slice(5,8):"none",a.alignX=s,a.alignY=n,a.meetOrSlice=c,fabric.Image.fromURL(a["xlink:href"],i,e(r?fabric.util.object.clone(r):{},a))},fabric.Image.async=!0,void(fabric.Image.pngCompression=1))}("undefined"!=typeof exports?exports:this),fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.getAngle()%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(t){t=t||{};var e=function(){},i=t.onComplete||e,r=t.onChange||e,s=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){s.setAngle(t),r()},onComplete:function(){s.setCoords(),i()},onStart:function(){s.set("active",!1)}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.renderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.renderAll.bind(this)}),this}}),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Brightness=e.util.createClass(e.Image.filters.BaseFilter,{type:"Brightness",initialize:function(t){t=t||{},this.brightness=t.brightness||0},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,s=this.brightness,n=0,o=r.length;o>n;n+=4)r[n]+=s,r[n+1]+=s,r[n+2]+=s;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{brightness:this.brightness})}}),e.Image.filters.Brightness.fromObject=function(t){return new e.Image.filters.Brightness(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Convolute=e.util.createClass(e.Image.filters.BaseFilter,{type:"Convolute",initialize:function(t){t=t||{},this.opaque=t.opaque,this.matrix=t.matrix||[0,0,0,0,1,0,0,0,0];var i=e.util.createCanvasElement();this.tmpCtx=i.getContext("2d")},_createImageData:function(t,e){return this.tmpCtx.createImageData(t,e)},applyTo:function(t){for(var e=this.matrix,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=Math.round(Math.sqrt(e.length)),n=Math.floor(s/2),o=r.data,a=r.width,h=r.height,c=a,l=h,u=this._createImageData(c,l),f=u.data,d=this.opaque?1:0,g=0;l>g;g++)for(var p=0;c>p;p++){for(var v=g,b=p,m=4*(g*c+p),y=0,_=0,x=0,C=0,S=0;s>S;S++)for(var w=0;s>w;w++){var O=v+S-n,T=b+w-n;if(!(0>O||O>h||0>T||T>a)){var k=4*(O*a+T),j=e[S*s+w];y+=o[k]*j,_+=o[k+1]*j,x+=o[k+2]*j,C+=o[k+3]*j}}f[m]=y,f[m+1]=_,f[m+2]=x,f[m+3]=C+d*(255-C)}i.putImageData(u,0,0)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=function(t){return new e.Image.filters.Convolute(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.GradientTransparency=e.util.createClass(e.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(t){t=t||{},this.threshold=t.threshold||100},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,s=this.threshold,n=r.length,o=0,a=r.length;a>o;o+=4)r[o+3]=s+255*(n-o)/n;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold})}}),e.Image.filters.GradientTransparency.fromObject=function(t){return new e.Image.filters.GradientTransparency(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Grayscale=e.util.createClass(e.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=r.width*r.height*4,o=0;n>o;)e=(s[o]+s[o+1]+s[o+2])/3,s[o]=e,s[o+1]=e,s[o+2]=e,o+=4;i.putImageData(r,0,0)}}),e.Image.filters.Grayscale.fromObject=function(){return new e.Image.filters.Grayscale}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Invert=e.util.createClass(e.Image.filters.BaseFilter,{type:"Invert",applyTo:function(t){var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=s.length;for(e=0;n>e;e+=4)s[e]=255-s[e],s[e+1]=255-s[e+1],s[e+2]=255-s[e+2];i.putImageData(r,0,0)}}),e.Image.filters.Invert.fromObject=function(){return new e.Image.filters.Invert}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Mask=e.util.createClass(e.Image.filters.BaseFilter,{type:"Mask",initialize:function(t){t=t||{},this.mask=t.mask,this.channel=[0,1,2,3].indexOf(t.channel)>-1?t.channel:0},applyTo:function(t){if(this.mask){var i,r=t.getContext("2d"),s=r.getImageData(0,0,t.width,t.height),n=s.data,o=this.mask.getElement(),a=e.util.createCanvasElement(),h=this.channel,c=s.width*s.height*4;a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0,o.width,o.height);var l=a.getContext("2d").getImageData(0,0,o.width,o.height),u=l.data;for(i=0;c>i;i+=4)n[i+3]=u[i+h];r.putImageData(s,0,0)}},toObject:function(){return i(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),e.Image.filters.Mask.fromObject=function(t,i){e.util.loadImage(t.mask.src,function(r){t.mask=new e.Image(r,t.mask),i&&i(new e.Image.filters.Mask(t))})},e.Image.filters.Mask.async=!0}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Noise=e.util.createClass(e.Image.filters.BaseFilter,{type:"Noise",initialize:function(t){t=t||{},this.noise=t.noise||0},applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),s=r.data,n=this.noise,o=0,a=s.length;a>o;o+=4)e=(.5-Math.random())*n,s[o]+=e,s[o+1]+=e,s[o+2]+=e;i.putImageData(r,0,0)},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=function(t){return new e.Image.filters.Noise(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Pixelate=e.util.createClass(e.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(t){t=t||{},this.blocksize=t.blocksize||4},applyTo:function(t){var e,i,r,s,n,o,a,h=t.getContext("2d"),c=h.getImageData(0,0,t.width,t.height),l=c.data,u=c.height,f=c.width;for(i=0;u>i;i+=this.blocksize)for(r=0;f>r;r+=this.blocksize){e=4*i*f+4*r,s=l[e],n=l[e+1],o=l[e+2],a=l[e+3];for(var d=i,g=i+this.blocksize;g>d;d++)for(var p=r,v=r+this.blocksize;v>p;p++)e=4*d*f+4*p,l[e]=s,l[e+1]=n,l[e+2]=o,l[e+3]=a}h.putImageData(c,0,0)},toObject:function(){return i(this.callSuper("toObject"),{blocksize:this.blocksize})}}),e.Image.filters.Pixelate.fromObject=function(t){return new e.Image.filters.Pixelate(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.RemoveWhite=e.util.createClass(e.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(t){t=t||{},this.threshold=t.threshold||30,this.distance=t.distance||20},applyTo:function(t){for(var e,i,r,s=t.getContext("2d"),n=s.getImageData(0,0,t.width,t.height),o=n.data,a=this.threshold,h=this.distance,c=255-a,l=Math.abs,u=0,f=o.length;f>u;u+=4)e=o[u],i=o[u+1],r=o[u+2],e>c&&i>c&&r>c&&l(e-i)<h&&l(e-r)<h&&l(i-r)<h&&(o[u+3]=1);s.putImageData(n,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),e.Image.filters.RemoveWhite.fromObject=function(t){return new e.Image.filters.RemoveWhite(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(t){var e,i,r=t.getContext("2d"),s=r.getImageData(0,0,t.width,t.height),n=s.data,o=n.length;for(e=0;o>e;e+=4)i=.3*n[e]+.59*n[e+1]+.11*n[e+2],n[e]=i+100,n[e+1]=i+50,n[e+2]=i+255;r.putImageData(s,0,0)}}),e.Image.filters.Sepia.fromObject=function(){return new e.Image.filters.Sepia}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia2=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(t){var e,i,r,s,n=t.getContext("2d"),o=n.getImageData(0,0,t.width,t.height),a=o.data,h=a.length;for(e=0;h>e;e+=4)i=a[e],r=a[e+1],s=a[e+2],a[e]=(.393*i+.769*r+.189*s)/1.351,a[e+1]=(.349*i+.686*r+.168*s)/1.203,a[e+2]=(.272*i+.534*r+.131*s)/2.14;n.putImageData(o,0,0)}}),e.Image.filters.Sepia2.fromObject=function(){return new e.Image.filters.Sepia2}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Tint=e.util.createClass(e.Image.filters.BaseFilter,{type:"Tint",initialize:function(t){t=t||{},this.color=t.color||"#000000",this.opacity="undefined"!=typeof t.opacity?t.opacity:new e.Color(this.color).getAlpha()},applyTo:function(t){var i,r,s,n,o,a,h,c,l,u=t.getContext("2d"),f=u.getImageData(0,0,t.width,t.height),d=f.data,g=d.length;for(l=new e.Color(this.color).getSource(),r=l[0]*this.opacity,s=l[1]*this.opacity,n=l[2]*this.opacity,c=1-this.opacity,i=0;g>i;i+=4)o=d[i],a=d[i+1],h=d[i+2],d[i]=r+o*c,d[i+1]=s+a*c,d[i+2]=n+h*c;u.putImageData(f,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),e.Image.filters.Tint.fromObject=function(t){return new e.Image.filters.Tint(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Multiply=e.util.createClass(e.Image.filters.BaseFilter,{type:"Multiply",initialize:function(t){t=t||{},this.color=t.color||"#000000"},applyTo:function(t){var i,r,s=t.getContext("2d"),n=s.getImageData(0,0,t.width,t.height),o=n.data,a=o.length;for(r=new e.Color(this.color).getSource(),i=0;a>i;i+=4)o[i]*=r[0]/255,o[i+1]*=r[1]/255,o[i+2]*=r[2]/255;s.putImageData(n,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color})}}),e.Image.filters.Multiply.fromObject=function(t){return new e.Image.filters.Multiply(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric;e.Image.filters.Blend=e.util.createClass({type:"Blend",initialize:function(t){t=t||{},this.color=t.color||"#000",this.image=t.image||!1,this.mode=t.mode||"multiply",this.alpha=t.alpha||1},applyTo:function(t){var i,r,s,n,o,a,h,c,l,u,f=t.getContext("2d"),d=f.getImageData(0,0,t.width,t.height),g=d.data,p=!1;if(this.image){p=!0;var v=e.util.createCanvasElement();v.width=this.image.width,v.height=this.image.height;var b=new e.StaticCanvas(v);b.add(this.image);var m=b.getContext("2d");u=m.getImageData(0,0,b.width,b.height).data}else u=new e.Color(this.color).getSource(),i=u[0]*this.alpha,r=u[1]*this.alpha,s=u[2]*this.alpha;for(var y=0,_=g.length;_>y;y+=4)switch(n=g[y],o=g[y+1],a=g[y+2],p&&(i=u[y]*this.alpha,r=u[y+1]*this.alpha,s=u[y+2]*this.alpha),this.mode){case"multiply":g[y]=n*i/255,g[y+1]=o*r/255,g[y+2]=a*s/255;break;case"screen":g[y]=1-(1-n)*(1-i),g[y+1]=1-(1-o)*(1-r),g[y+2]=1-(1-a)*(1-s);break;case"add":g[y]=Math.min(255,n+i),g[y+1]=Math.min(255,o+r),g[y+2]=Math.min(255,a+s);break;case"diff":case"difference":g[y]=Math.abs(n-i),g[y+1]=Math.abs(o-r),g[y+2]=Math.abs(a-s);break;case"subtract":h=n-i,c=o-r,l=a-s,g[y]=0>h?0:h,g[y+1]=0>c?0:c,g[y+2]=0>l?0:l;break;case"darken":g[y]=Math.min(n,i),g[y+1]=Math.min(o,r),g[y+2]=Math.min(a,s);break;case"lighten":g[y]=Math.max(n,i),g[y+1]=Math.max(o,r),g[y+2]=Math.max(a,s)}f.putImageData(d,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.Blend.fromObject=function(t){return new e.Image.filters.Blend(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,r=Math.floor,s=Math.sqrt,n=Math.abs,o=Math.max,a=Math.round,h=Math.sin,c=Math.ceil;e.Image.filters.Resize=e.util.createClass(e.Image.filters.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(t,e,i){this.rcpScaleX=1/e,this.rcpScaleY=1/i;var r,s=t.width,n=t.height,o=a(s*e),h=a(n*i);"sliceHack"===this.resizeType&&(r=this.sliceByTwo(t,s,n,o,h)),"hermite"===this.resizeType&&(r=this.hermiteFastResize(t,s,n,o,h)),"bilinear"===this.resizeType&&(r=this.bilinearFiltering(t,s,n,o,h)),"lanczos"===this.resizeType&&(r=this.lanczosResize(t,s,n,o,h)),t.width=o,t.height=h,t.getContext("2d").putImageData(r,0,0)},sliceByTwo:function(t,i,s,n,a){var h,c=t.getContext("2d"),l=.5,u=.5,f=1,d=1,g=!1,p=!1,v=i,b=s,m=e.util.createCanvasElement(),y=m.getContext("2d");for(n=r(n),a=r(a),m.width=o(n,i),m.height=o(a,s),n>i&&(l=2,f=-1),a>s&&(u=2,d=-1),h=c.getImageData(0,0,i,s),t.width=o(n,i),t.height=o(a,s),c.putImageData(h,0,0);!g||!p;)i=v,s=b,n*f<r(v*l*f)?v=r(v*l):(v=n,g=!0),a*d<r(b*u*d)?b=r(b*u):(b=a,p=!0),h=c.getImageData(0,0,i,s),y.putImageData(h,0,0),c.clearRect(0,0,v,b),c.drawImage(m,0,0,i,s,0,0,v,b);return c.getImageData(0,0,n,a)},lanczosResize:function(t,e,o,a,l){function u(t){return function(e){if(e>t)return 0;if(e*=Math.PI,n(e)<1e-16)return 1;var i=e/t;return h(e)*h(i)/e/i}}function f(t){var h,c,u,d,g,j,A,P,E,M,I;for(T.x=(t+.5)*y,k.x=r(T.x),h=0;l>h;h++){for(T.y=(h+.5)*_,k.y=r(T.y),g=0,j=0,A=0,P=0,E=0,c=k.x-S;c<=k.x+S;c++)if(!(0>c||c>=e)){M=r(1e3*n(c-T.x)),O[M]||(O[M]={});for(var D=k.y-w;D<=k.y+w;D++)0>D||D>=o||(I=r(1e3*n(D-T.y)),O[M][I]||(O[M][I]=m(s(i(M*x,2)+i(I*C,2))/1e3)),u=O[M][I],u>0&&(d=4*(D*e+c),g+=u,j+=u*v[d],A+=u*v[d+1],P+=u*v[d+2],E+=u*v[d+3]))}d=4*(h*a+t),b[d]=j/g,b[d+1]=A/g,b[d+2]=P/g,b[d+3]=E/g}return++t<a?f(t):p}var d=t.getContext("2d"),g=d.getImageData(0,0,e,o),p=d.getImageData(0,0,a,l),v=g.data,b=p.data,m=u(this.lanczosLobes),y=this.rcpScaleX,_=this.rcpScaleY,x=2/this.rcpScaleX,C=2/this.rcpScaleY,S=c(y*this.lanczosLobes/2),w=c(_*this.lanczosLobes/2),O={},T={},k={};return f(0)},bilinearFiltering:function(t,e,i,s,n){var o,a,h,c,l,u,f,d,g,p,v,b,m,y=0,_=this.rcpScaleX,x=this.rcpScaleY,C=t.getContext("2d"),S=4*(e-1),w=C.getImageData(0,0,e,i),O=w.data,T=C.getImageData(0,0,s,n),k=T.data;for(f=0;n>f;f++)for(d=0;s>d;d++)for(l=r(_*d),u=r(x*f),g=_*d-l,p=x*f-u,m=4*(u*e+l),v=0;4>v;v++)o=O[m+v],a=O[m+4+v],h=O[m+S+v],c=O[m+S+4+v],b=o*(1-g)*(1-p)+a*g*(1-p)+h*p*(1-g)+c*g*p,k[y++]=b;return T},hermiteFastResize:function(t,e,i,o,a){for(var h=this.rcpScaleX,l=this.rcpScaleY,u=c(h/2),f=c(l/2),d=t.getContext("2d"),g=d.getImageData(0,0,e,i),p=g.data,v=d.getImageData(0,0,o,a),b=v.data,m=0;a>m;m++)for(var y=0;o>y;y++){for(var _=4*(y+m*o),x=0,C=0,S=0,w=0,O=0,T=0,k=0,j=(m+.5)*l,A=r(m*l);(m+1)*l>A;A++)for(var P=n(j-(A+.5))/f,E=(y+.5)*h,M=P*P,I=r(y*h);(y+1)*h>I;I++){var D=n(E-(I+.5))/u,L=s(M+D*D);L>1&&-1>L||(x=2*L*L*L-3*L*L+1,x>0&&(D=4*(I+A*e),k+=x*p[D+3],S+=x,p[D+3]<255&&(x=x*p[D+3]/250),w+=x*p[D],O+=x*p[D+1],T+=x*p[D+2],C+=x))}b[_]=w/C,b[_+1]=O/C,b[_+2]=T/C,b[_+3]=k/S}return v},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=function(t){return new e.Image.filters.Resize(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,s=e.util.toFixed,n=e.StaticCanvas.supports("setLineDash"),o=e.Object.NUM_FRACTION_DIGITS;if(e.Text)return void e.warn("fabric.Text is already defined");var a=e.Object.prototype.stateProperties.concat();a.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:a,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(t,e){e=e||{},this.text=t,this.__skipDimension=!0,this.setOptions(e),this.__skipDimension=!1,this._initDimensions()},_initDimensions:function(t){if(!this.__skipDimension){t||(t=e.util.createCanvasElement().getContext("2d"),this._setTextStyles(t)),this._textLines=this.text.split(this._reNewline),this._clearCache();var i=this.textAlign;this.textAlign="left",this.width=this._getTextWidth(t),this.textAlign=i,this.height=this._getTextHeight(t)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(t){this.clipTo&&e.util.clipContext(this,t),this._renderTextBackground(t),this._renderText(t),this._renderTextDecoration(t),this.clipTo&&t.restore()},_renderText:function(t){t.save(),this._translateForTextAlign(t),this._setOpacity(t),this._setShadow(t),this._setupCompositeOperation(t),this._renderTextFill(t),this._renderTextStroke(t),t.restore()},_translateForTextAlign:function(t){"left"!==this.textAlign&&"justify"!==this.textAlign&&t.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(t){t.textBaseline="alphabetic",this.skipTextAlign||(t.textAlign=this.textAlign),t.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*this._getHeightOfLine()},_getTextWidth:function(t){for(var e=this._getLineWidth(t,0),i=1,r=this._textLines.length;r>i;i++){var s=this._getLineWidth(t,i);s>e&&(e=s)}return e},_renderChars:function(t,e,i,r,s){var n=t.slice(0,-4);if(this[n].toLive){var o=-this.width/2+this[n].offsetX||0,a=-this.height/2+this[n].offsetY||0;e.save(),e.translate(o,a),r-=o,s-=a}console.log(e.strokeStyle),e[t](i,r,s),this[n].toLive&&e.restore()},_renderTextLine:function(t,e,i,r,s,n){if(s-=this.fontSize*this._fontSizeFraction,"justify"!==this.textAlign)return void this._renderChars(t,e,i,r,s,n);var o=this._getLineWidth(e,n),a=this.width;if(a>=o)for(var h=i.split(/\s+/),c=this._getWidthOfWords(e,i,n),l=a-c,u=h.length-1,f=l/u,d=0,g=0,p=h.length;p>g;g++)this._renderChars(t,e,h[g],r+d,s,n),d+=e.measureText(h[g]).width+f;else this._renderChars(t,e,i,r,s,n)},_getWidthOfWords:function(t,e){return t.measureText(e.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(t){if(this.fill||this._skipFillStrokeCheck)for(var e=0,i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i),n=s/this.lineHeight;this._renderTextLine("fillText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+n,i),e+=s}},_renderTextStroke:function(t){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var e=0;this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),n&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i),o=s/this.lineHeight;this._renderTextLine("strokeText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+o,i),e+=s}t.closePath(),t.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(t){this._renderTextBoxBackground(t),this._renderTextLinesBackground(t)},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},_renderTextLinesBackground:function(t){var e=0,i=this._getHeightOfLine();if(this.textBackgroundColor){t.save(),t.fillStyle=this.textBackgroundColor;for(var r=0,s=this._textLines.length;s>r;r++){if(""!==this._textLines[r]){var n=this._getLineWidth(t,r),o=this._getLineLeftOffset(n);t.fillRect(this._getLeftOffset()+o,this._getTopOffset()+e,n,this.fontSize*this._fontSizeMult)}e+=i}t.restore()}},_getLineLeftOffset:function(t){return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__lineOffsets=[]},_shouldClearCache:function(){var t=!1;for(var e in this._dimensionAffectingProps)this["__"+e]!==this[e]&&(this["__"+e]=this[e],t=!0);return t},_getLineWidth:function(t,e){return this.__lineWidths[e]?this.__lineWidths[e]:(this.__lineWidths[e]=t.measureText(this._textLines[e]).width,this.__lineWidths[e])},_renderTextDecoration:function(t){function e(e){var s,n,o,a,h=0;for(s=0,n=r._textLines.length;n>s;s++){var c=r._getLineWidth(t,s),l=r._getLineLeftOffset(c),u=r._getHeightOfLine(t,s);for(o=0,a=e.length;a>o;o++)t.fillRect(r._getLeftOffset()+l,h+(r._fontSizeMult-1+e[o])*r.fontSize-i,c,r.fontSize/15);h+=u}}if(this.textDecoration){var i=this.height/2,r=this,s=[];this.textDecoration.indexOf("underline")>-1&&s.push(.85),this.textDecoration.indexOf("line-through")>-1&&s.push(.43),this.textDecoration.indexOf("overline")>-1&&s.push(-.12),s.length>0&&e(s)}},_getFontDeclaration:function(){return[e.isLikelyNode?this.fontWeight:this.fontStyle,e.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",e.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(t,e){this.visible&&(t.save(),this._setTextStyles(t),this._shouldClearCache()&&this._initDimensions(t),e||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.group&&"path-group"===this.group.type&&t.translate(this.left,this.top),this._render(t),t.restore())},toObject:function(t){var e=i(this.callSuper("toObject",t),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this._getSVGLeftTopOffsets(this.ctx),r=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e,r),t?t(e.join("")):e.join("")},_getSVGLeftTopOffsets:function(t){var e=this._getHeightOfLine(t,0),i=-this.width/2,r=0;return{textLeft:i+(this.group&&"path-group"===this.group.type?this.left:0),textTop:r+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:e}},_wrapSVGTextAndBg:function(t,e){t.push('	<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',e.textBgRects.join(""),"		<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',e.textSpans.join(""),"</text>\n","	</g>\n")},_getSVGTextAndBg:function(t,e){var i=[],r=[],s=0;this._setSVGBg(r);for(var n=0,o=this._textLines.length;o>n;n++)this.textBackgroundColor&&this._setSVGTextLineBg(r,n,e,t,s),this._setSVGTextLineText(n,i,s,e,t,r),s+=this._getHeightOfLine(this.ctx,n);return{textSpans:i,textBgRects:r}},_setSVGTextLineText:function(t,i,r,n,a){var h=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-a+r-this.height/2;i.push('<tspan x="',s(n+this._getLineLeftOffset(this.__lineWidths[t]),o),'" ','y="',s(h,o),'" ',this._getFillAttributes(this.fill),">",e.util.string.escapeXml(this._textLines[t]),"</tspan>")},_setSVGTextLineBg:function(t,e,i,r,n){t.push("		<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',s(i+this._getLineLeftOffset(this.__lineWidths[e]),o),'" y="',s(n-this.height/2,o),'" width="',s(this.__lineWidths[e],o),'" height="',s(this._getHeightOfLine(this.ctx,e)/this.lineHeight,o),'"></rect>\n')},_setSVGBg:function(t){this.backgroundColor&&t.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',s(-this.width/2,o),'" y="',s(-this.height/2,o),'" width="',s(this.width,o),'" height="',s(this.height,o),'"></rect>\n')},_getFillAttributes:function(t){var i=t&&"string"==typeof t?new e.Color(t):"";return i&&i.getSource()&&1!==i.getAlpha()?'opacity="'+i.getAlpha()+'" fill="'+i.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_set:function(t,e){this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i){if(!t)return null;var r=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES);i=e.util.object.extend(i?e.util.object.clone(i):{},r),i.top=i.top||0,i.left=i.left||0,"dx"in r&&(i.left+=r.dx),"dy"in r&&(i.top+=r.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE),i.originX||(i.originX="left");var s=t.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),n=new e.Text(s,i),o=0;return"left"===n.originX&&(o=n.getWidth()/2),"right"===n.originX&&(o=-n.getWidth()/2),n.set({left:n.getLeft()+o,top:n.getTop()-n.getHeight()/2+n.fontSize*(.18+n._fontSizeFraction)}),n},e.Text.fromObject=function(t){return new e.Text(t.text,r(t))},e.util.createAccessors(e.Text)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!1,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(t,e){this.styles=e?e.styles||{}:{},this.callSuper("initialize",t,e),this.initBehavior()},_clearCache:function(){this.callSuper("_clearCache"),this.__maxFontHeights=[],this.__widthOfSpace=[]},isEmptyStyles:function(){if(!this.styles)return!0;var t=this.styles;for(var e in t)for(var i in t[e])for(var r in t[e][i])return!1;return!0},setSelectionStart:function(t){t=Math.max(t,0),this.selectionStart!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionStart=t),this._updateTextarea()},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this.selectionEnd!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionEnd=t),this._updateTextarea()},getSelectionStyles:function(t,e){if(2===arguments.length){for(var i=[],r=t;e>r;r++)i.push(this.getSelectionStyles(r));return i}var s=this.get2DCursorLocation(t);return this.styles[s.lineIndex]?this.styles[s.lineIndex][s.charIndex]||{}:{}},setSelectionStyles:function(t){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,t);else for(var e=this.selectionStart;e<this.selectionEnd;e++)this._extendStyles(e,t);return this._clearCache(),this},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this.styles[i.lineIndex]||(this.styles[i.lineIndex]={}),this.styles[i.lineIndex][i.charIndex]||(this.styles[i.lineIndex][i.charIndex]={}),fabric.util.object.extend(this.styles[i.lineIndex][i.charIndex],e)},_render:function(t){this.callSuper("_render",t),this.ctx=t,this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active){var t,e,i=this.text.split("");this.canvas.contextTop?(e=this.canvas.contextTop,e.save(),e.transform.apply(e,this.canvas.viewportTransform),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix)):(e=this.ctx,e.save()),this.selectionStart===this.selectionEnd?(t=this._getCursorBoundaries(i,"cursor"),this.renderCursor(t,e)):(t=this._getCursorBoundaries(i,"selection"),this.renderSelection(i,t,e)),
e.restore()}},get2DCursorLocation:function(t){"undefined"==typeof t&&(t=this.selectionStart);for(var e=this._textLines.length,i=0;e>i;i++){if(t<=this._textLines[i].length)return{lineIndex:i,charIndex:t};t-=this._textLines[i].length+1}return{lineIndex:i-1,charIndex:this._textLines[i-1].length<t?this._textLines[i-1].length:t}},getCurrentCharStyle:function(t,e){var i=this.styles[t]&&this.styles[t][0===e?0:e-1];return{fontSize:i&&i.fontSize||this.fontSize,fill:i&&i.fill||this.fill,textBackgroundColor:i&&i.textBackgroundColor||this.textBackgroundColor,textDecoration:i&&i.textDecoration||this.textDecoration,fontFamily:i&&i.fontFamily||this.fontFamily,fontWeight:i&&i.fontWeight||this.fontWeight,fontStyle:i&&i.fontStyle||this.fontStyle,stroke:i&&i.stroke||this.stroke,strokeWidth:i&&i.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fontSize||this.fontSize},getCurrentCharColor:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fill||this.cursorColor},_getCursorBoundaries:function(t,e){var i=Math.round(this._getLeftOffset()),r=this._getTopOffset(),s=this._getCursorBoundariesOffsets(t,e);return{left:i,top:r,leftOffset:s.left+s.lineLeft,topOffset:s.top}},_getCursorBoundariesOffsets:function(t,e){for(var i=0,r=0,s=0,n=0,o=0,a=0;a<this.selectionStart;a++)"\n"===t[a]?(o=0,n+=this._getHeightOfLine(this.ctx,r),r++,s=0):(o+=this._getWidthOfChar(this.ctx,t[a],r,s),s++),i=this._getCachedLineOffset(r);return"cursor"===e&&(n+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,r)/this.lineHeight-this.getCurrentCharFontSize(r,s)*(1-this._fontSizeFraction)),{top:n,left:o,lineLeft:i}},_getCachedLineOffset:function(t){var e=this._getLineWidth(this.ctx,t);return this.__lineOffsets[t]||(this.__lineOffsets[t]=this._getLineLeftOffset(e))},renderCursor:function(t,e){var i=this.get2DCursorLocation(),r=i.lineIndex,s=i.charIndex,n=this.getCurrentCharFontSize(r,s),o=0===r&&0===s?this._getCachedLineOffset(r):t.leftOffset;e.fillStyle=this.getCurrentCharColor(r,s),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+o,t.top+t.topOffset,this.cursorWidth/this.scaleX,n)},renderSelection:function(t,e,i){i.fillStyle=this.selectionColor;for(var r=this.get2DCursorLocation(this.selectionStart),s=this.get2DCursorLocation(this.selectionEnd),n=r.lineIndex,o=s.lineIndex,a=n;o>=a;a++){var h=this._getCachedLineOffset(a)||0,c=this._getHeightOfLine(this.ctx,a),l=0,u=this._textLines[a];if(a===n)for(var f=0,d=u.length;d>f;f++)f>=r.charIndex&&(a!==o||f<s.charIndex)&&(l+=this._getWidthOfChar(i,u[f],a,f)),f<r.charIndex&&(h+=this._getWidthOfChar(i,u[f],a,f));else if(a>n&&o>a)l+=this._getLineWidth(i,a)||5;else if(a===o)for(var g=0,p=s.charIndex;p>g;g++)l+=this._getWidthOfChar(i,u[g],a,g);i.fillRect(e.left+h,e.top+e.topOffset,l,c),e.topOffset+=c}},_renderChars:function(t,e,i,r,s,n){if(this.isEmptyStyles())return this._renderCharsFast(t,e,i,r,s);this.skipTextAlign=!0,r-="center"===this.textAlign?this.width/2:"right"===this.textAlign?this.width:0;var o,a=this._getHeightOfLine(e,n),h=this._getCachedLineOffset(n),c="";r+=h||0,e.save(),s-=a/this.lineHeight*this._fontSizeFraction;for(var l=0,u=i.length;u>=l;l++){o=o||this.getCurrentCharStyle(n,l);var f=this.getCurrentCharStyle(n,l+1);(this._hasStyleChanged(o,f)||l===u)&&(this._renderChar(t,e,n,l-1,c,r,s,a),c="",o=f),c+=i[l]}e.restore()},_renderCharsFast:function(t,e,i,r,s){this.skipTextAlign=!1,"fillText"===t&&this.fill&&this.callSuper("_renderChars",t,e,i,r,s),"strokeText"===t&&(this.stroke&&this.strokeWidth>0||this.skipFillStrokeCheck)&&this.callSuper("_renderChars",t,e,i,r,s)},_renderChar:function(t,e,i,r,s,n,o,a){var h,c,l,u=this._fontSizeFraction*a/this.lineHeight;if(this.styles&&this.styles[i]&&(h=this.styles[i][r])){var f=h.stroke||this.stroke,d=h.fill||this.fill;e.save(),c=this._applyCharStylesGetWidth(e,s,i,r,h),l=this._getHeightOfChar(e,s,i,r),d&&e.fillText(s,n,o),f&&e.strokeText(s,n,o),this._renderCharDecoration(e,h,n,o,u,c,l),e.restore(),e.translate(c,0)}else"strokeText"===t&&this.stroke&&e[t](s,n,o),"fillText"===t&&this.fill&&e[t](s,n,o),c=this._applyCharStylesGetWidth(e,s,i,r),this._renderCharDecoration(e,null,n,o,u,c,this.fontSize),e.translate(e.measureText(s).width,0)},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.fontSize!==e.fontSize||t.textBackgroundColor!==e.textBackgroundColor||t.textDecoration!==e.textDecoration||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth},_renderCharDecoration:function(t,e,i,r,s,n,o){var a=e?e.textDecoration||this.textDecoration:this.textDecoration;a&&(a.indexOf("underline")>-1&&t.fillRect(i,r+o/10,n,o/15),a.indexOf("line-through")>-1&&t.fillRect(i,r-o*(this._fontSizeFraction+this._fontSizeMult-1)+o/15,n,o/15),a.indexOf("overline")>-1&&t.fillRect(i,r-(this._fontSizeMult-this._fontSizeFraction)*o,n,o/15))},_renderTextLine:function(t,e,i,r,s,n){this.isEmptyStyles()||(s+=this.fontSize*(this._fontSizeFraction+.03)),this.callSuper("_renderTextLine",t,e,i,r,s,n)},_renderTextDecoration:function(t){return this.isEmptyStyles()?this.callSuper("_renderTextDecoration",t):void 0},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styles){t.save(),this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor);for(var e=0,i=0,r=this._textLines.length;r>i;i++){var s=this._getHeightOfLine(t,i);if(""!==this._textLines[i]){var n=this._getLineWidth(t,i),o=this._getCachedLineOffset(i);if(this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor,t.fillRect(this._getLeftOffset()+o,this._getTopOffset()+e,n,s/this.lineHeight)),this.styles[i])for(var a=0,h=this._textLines[i].length;h>a;a++)if(this.styles[i]&&this.styles[i][a]&&this.styles[i][a].textBackgroundColor){var c=this._textLines[i][a];t.fillStyle=this.styles[i][a].textBackgroundColor,t.fillRect(this._getLeftOffset()+o+this._getWidthOfCharsAt(t,i,a),this._getTopOffset()+e,this._getWidthOfChar(t,c,i,a)+1,s/this.lineHeight)}e+=s}else e+=s}t.restore()}},_getCacheProp:function(t,e){return t+e.fontFamily+e.fontSize+e.fontWeight+e.fontStyle+e.shadow},_applyCharStylesGetWidth:function(e,i,r,s,n){var o=n||this.styles[r]&&this.styles[r][s];o=o?t(o):{},this._applyFontStyles(o);var a=this._getCacheProp(i,o);if(this.isEmptyStyles()&&this._charWidthsCache[a]&&this.caching)return this._charWidthsCache[a];"string"==typeof o.shadow&&(o.shadow=new fabric.Shadow(o.shadow));var h=o.fill||this.fill;return e.fillStyle=h.toLive?h.toLive(e,this):h,o.stroke&&(e.strokeStyle=o.stroke&&o.stroke.toLive?o.stroke.toLive(e,this):o.stroke),e.lineWidth=o.strokeWidth||this.strokeWidth,e.font=this._getFontDeclaration.call(o),this._setShadow.call(o,e),this.caching?(this._charWidthsCache[a]||(this._charWidthsCache[a]=e.measureText(i).width),this._charWidthsCache[a]):e.measureText(i).width},_applyFontStyles:function(t){t.fontFamily||(t.fontFamily=this.fontFamily),t.fontSize||(t.fontSize=this.fontSize),t.fontWeight||(t.fontWeight=this.fontWeight),t.fontStyle||(t.fontStyle=this.fontStyle)},_getStyleDeclaration:function(e,i){return this.styles[e]&&this.styles[e][i]?t(this.styles[e][i]):{}},_getWidthOfChar:function(t,e,i,r){if("justify"===this.textAlign&&/\s/.test(e))return this._getWidthOfSpace(t,i);var s=this._getStyleDeclaration(i,r);this._applyFontStyles(s);var n=this._getCacheProp(e,s);if(this._charWidthsCache[n]&&this.caching)return this._charWidthsCache[n];if(t){t.save();var o=this._applyCharStylesGetWidth(t,e,i,r);return t.restore(),o}},_getHeightOfChar:function(t,e,i,r){return this.styles[i]&&this.styles[i][r]?this.styles[i][r].fontSize||this.fontSize:this.fontSize},_getHeightOfCharAt:function(t,e,i){var r=this._textLines[e][i];return this._getHeightOfChar(t,r,e,i)},_getWidthOfCharsAt:function(t,e,i){var r,s,n=0;for(r=0;i>r;r++)s=this._textLines[e][r],n+=this._getWidthOfChar(t,s,e,r);return n},_getLineWidth:function(t,e){return this.__lineWidths[e]?this.__lineWidths[e]:(this.__lineWidths[e]=this._getWidthOfCharsAt(t,e,this._textLines[e].length),this.__lineWidths[e])},_getWidthOfSpace:function(t,e){if(this.__widthOfSpace[e])return this.__widthOfSpace[e];var i=this._textLines[e],r=this._getWidthOfWords(t,i,e),s=this.width-r,n=i.length-i.replace(/\s+/g,"").length,o=s/n;return this.__widthOfSpace[e]=o,o},_getWidthOfWords:function(t,e,i){for(var r=0,s=0;s<e.length;s++){var n=e[s];n.match(/\s/)||(r+=this._getWidthOfChar(t,n,i,s))}return r},_getHeightOfLine:function(t,e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var i=this._textLines[e],r=this._getHeightOfChar(t,i[0],e,0),s=1,n=i.length;n>s;s++){var o=this._getHeightOfChar(t,i[s],e,s);o>r&&(r=o)}return this.__maxFontHeights[e]=r,this.__lineHeights[e]=r*this.lineHeight*this._fontSizeMult,this.__lineHeights[e]},_getTextHeight:function(t){for(var e=0,i=0,r=this._textLines.length;r>i;i++)e+=this._getHeightOfLine(t,i);return e},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},toObject:function(e){return fabric.util.object.extend(this.callSuper("toObject",e),{styles:t(this.styles)})}}),fabric.IText.fromObject=function(e){return new fabric.IText(e.text,t(e))}}(),function(){var t=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var t=this;setTimeout(function(){t.selected=!0},100)})},initAddedHandler:function(){var t=this;this.on("added",function(){this.canvas&&!this.canvas._hasITextHandlers&&(this.canvas._hasITextHandlers=!0,this._initCanvasHandlers()),t.canvas&&(t.canvas._iTextInstances=t.canvas._iTextInstances||[],t.canvas._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){t.canvas&&(t.canvas._iTextInstances=t.canvas._iTextInstances||[],fabric.util.removeFromArray(t.canvas._iTextInstances,t))})},_initCanvasHandlers:function(){var t=this;this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers(t.canvas)}),this.canvas.on("mouse:up",function(){t.canvas._iTextInstances&&t.canvas._iTextInstances.forEach(function(t){t.__isMousedown=!1})}),this.canvas.on("object:selected",function(){fabric.IText.prototype.exitEditingOnOthers(t.canvas)})},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,r){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){s.isAborted||t[r]()},onChange:function(){t.canvas&&(t.canvas.clearContext(t.canvas.contextTop||t.ctx),t.renderCursorOrSelection())},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),this._currentCursorOpacity=1,this.canvas&&(this.canvas.clearContext(this.canvas.contextTop||this.ctx),this.renderCursorOrSelection()),this._cursorTimeout2&&clearTimeout(this._cursorTimeout2),this._cursorTimeout2=setTimeout(function(){e._tick()},i)},abortCursorAnimation:function(){this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,this.canvas&&this.canvas.clearContext(this.canvas.contextTop||this.ctx)},selectAll:function(){this.setSelectionStart(0),this.setSelectionEnd(this.text.length)},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i--;for(;/\S/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i++;for(;/\S/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},getNumNewLinesInSelectedText:function(){for(var t=this.getSelectedText(),e=0,i=0,r=t.length;r>i;i++)"\n"===t[i]&&e++;return e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this.text.charAt(t))?t-1:t,r=this.text.charAt(i),s=/[ \n\.,;!\?\-]/;!s.test(r)&&i>0&&i<this.text.length;)i+=e,r=this.text.charAt(i);return s.test(r)&&"\n"!==r&&(i+=1===e?0:1),i},selectWord:function(t){var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.setSelectionStart(e),this.setSelectionEnd(i)},selectLine:function(t){var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);this.setSelectionStart(e),this.setSelectionEnd(i)},enterEditing:function(){return!this.isEditing&&this.editable?(this.canvas&&this.exitEditingOnOthers(this.canvas),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._tick(),this.fire("editing:entered"),this.canvas?(this.canvas.renderAll(),this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this):this):void 0},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()})},initMouseMoveHandler:function(){var t=this;this.canvas.on("mouse:move",function(e){if(t.__isMousedown&&t.isEditing){var i=t.getSelectionStartFromPointer(e.e);i>=t.__selectionStartOnMouseDown?(t.setSelectionStart(t.__selectionStartOnMouseDown),t.setSelectionEnd(i)):(t.setSelectionStart(i),t.setSelectionEnd(t.__selectionStartOnMouseDown))}})},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){this.hiddenTextarea&&(this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart,this.hiddenTextarea.selectionEnd=this.selectionEnd)},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),this.canvas&&this.canvas.fire("text:editing:exited",{target:this}),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},_removeCharsFromTo:function(t,e){for(;e!==t;)this._removeSingleCharAndStyle(t+1),e--;this.setSelectionStart(t)},_removeSingleCharAndStyle:function(t){var e="\n"===this.text[t-1],i=e?t:t-1;this.removeStyleObject(e,i),this.text=this.text.slice(0,t-1)+this.text.slice(t),this._textLines=this.text.split(this._reNewline)},insertChars:function(t,e){this.selectionEnd-this.selectionStart>1&&(this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.setSelectionEnd(this.selectionStart));var i="\n"===this.text[this.selectionStart];this.text=this.text.slice(0,this.selectionStart)+t+this.text.slice(this.selectionEnd),this.insertStyleObjects(t,i,e),this.setSelectionStart(this.selectionStart+t.length),this.setSelectionEnd(this.selectionStart),this.canvas&&this.canvas.renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(e,i,r){this.shiftLineStyles(e,1),this.styles[e+1]||(this.styles[e+1]={});var s={},n={};if(this.styles[e]&&this.styles[e][i-1]&&(s=this.styles[e][i-1]),r)n[0]=t(s),this.styles[e+1]=n;else{for(var o in this.styles[e])parseInt(o,10)>=i&&(n[parseInt(o,10)-i]=this.styles[e][o],delete this.styles[e][o]);this.styles[e+1]=n}this._clearCache()},insertCharStyleObject:function(e,i,r){var s=this.styles[e],n=t(s);0!==i||r||(i=1);for(var o in n){var a=parseInt(o,10);a>=i&&(s[a+1]=n[a])}this.styles[e][i]=r||t(s[i-1]),this._clearCache()},insertStyleObjects:function(t,e,i){var r=this.get2DCursorLocation(),s=r.lineIndex,n=r.charIndex;this.styles[s]||(this.styles[s]={}),"\n"===t?this.insertNewlineStyleObject(s,n,e):i?this._insertStyles(this.copiedStyles):this.insertCharStyleObject(s,n)},_insertStyles:function(t){for(var e=0,i=t.length;i>e;e++){var r=this.get2DCursorLocation(this.selectionStart+e),s=r.lineIndex,n=r.charIndex;this.insertCharStyleObject(s,n,t[e])}},shiftLineStyles:function(e,i){var r=t(this.styles);for(var s in this.styles){var n=parseInt(s,10);n>e&&(this.styles[n+i]=r[n],r[n-i]||delete this.styles[n])}},removeStyleObject:function(e,i){var r=this.get2DCursorLocation(i),s=r.lineIndex,n=r.charIndex;if(e){var o=this._textLines[s-1],a=o?o.length:0;this.styles[s-1]||(this.styles[s-1]={});for(n in this.styles[s])this.styles[s-1][parseInt(n,10)+a]=this.styles[s][n];this.shiftLineStyles(s,-1)}else{var h=this.styles[s];h&&delete h[n];var c=t(h);for(var l in c){var u=parseInt(l,10);u>=n&&0!==u&&(h[u-1]=c[u],delete h[u])}}},insertNewline:function(){this.insertChars("\n")}})}(),fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(t){this.__newClickTime=+new Date;var e=this.canvas.getPointer(t.e);this.isTripleClick(e)?(this.fire("tripleclick",t),this._stopEvent(t.e)):this.isDoubleClick(e)&&(this.fire("dblclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected},isDoubleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y&&this.__lastIsEditing},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler(),this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("dblclick",function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))}),this.on("tripleclick",function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))})},initMousedownHandler:function(){this.on("mousedown",function(t){var e=this.canvas.getPointer(t.e);this.__mousedownX=e.x,this.__mousedownY=e.y,this.__isMousedown=!0,this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea),this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0))})},_isObjectMoved:function(t){var e=this.canvas.getPointer(t);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(t){this.__isMousedown=!1,this._isObjectMoved(t.e)||(this.__lastSelected&&(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0)})},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t);t.shiftKey?e<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(e)):this.setSelectionEnd(e):(this.setSelectionStart(e),this.setSelectionEnd(e))},_getLocalRotatedPointer:function(t){var e=this.canvas.getPointer(t),i=new fabric.Point(e.x,e.y),r=new fabric.Point(this.left,this.top),s=fabric.util.rotatePoint(i,r,fabric.util.degreesToRadians(-this.angle));return this.getLocalPointer(t,s)},getSelectionStartFromPointer:function(t){for(var e,i,r=this._getLocalRotatedPointer(t),s=0,n=0,o=0,a=0,h=0,c=this._textLines.length;c>h;h++){i=this._textLines[h],o+=this._getHeightOfLine(this.ctx,h)*this.scaleY;var l=this._getLineWidth(this.ctx,h),u=this._getLineLeftOffset(l);n=u*this.scaleX,this.flipX&&(this._textLines[h]=i.reverse().join(""));for(var f=0,d=i.length;d>f;f++){if(s=n,n+=this._getWidthOfChar(this.ctx,i[f],h,this.flipX?d-f:f)*this.scaleX,!(o<=r.y||n<=r.x))return this._getNewSelectionStartFromOffset(r,s,n,a+h,d);a++}if(r.y<o)return this._getNewSelectionStartFromOffset(r,s,n,a+h,d)}return"undefined"==typeof e?this.text.length:void 0},_getNewSelectionStartFromOffset:function(t,e,i,r,s){var n=t.x-e,o=i-t.x,a=o>n?0:1,h=r+a;return this.flipX&&(h=s-h),h>this.text.length&&(h=this.text.length),h}}),fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.style.cssText="position: fixed; bottom: 20px; left: 0px; opacity: 0; width: 0px; height: 0px; z-index: -999;",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){if(t.keyCode in this._keysMap)this[this._keysMap[t.keyCode]](t);else{if(!(t.keyCode in this._ctrlKeysMap&&(t.ctrlKey||t.metaKey)))return;this[this._ctrlKeysMap[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.renderAll()}},forwardDelete:function(t){this.selectionStart===this.selectionEnd&&this.moveCursorRight(t),this.removeChars(t)},copy:function(t){var e=this.getSelectedText(),i=this._getClipboardData(t);i&&i.setData("text",e),this.copiedText=e,this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},paste:function(t){var e=null,i=this._getClipboardData(t);e=i?i.getData("text"):this.copiedText,e&&this.insertChars(e,!0)},cut:function(t){this.selectionStart!==this.selectionEnd&&(this.copy(),this.removeChars(t))},_getClipboardData:function(t){return t&&(t.clipboardData||fabric.window.clipboardData)},onKeyPress:function(t){!this.isEditing||t.metaKey||t.ctrlKey||(0!==t.which&&this.insertChars(String.fromCharCode(t.which)),t.stopPropagation())},getDownCursorOffset:function(t,e){var i,r,s=e?this.selectionEnd:this.selectionStart,n=this.get2DCursorLocation(s),o=n.lineIndex,a=this._textLines[o].slice(0,n.charIndex),h=this._textLines[o].slice(n.charIndex),c=this._textLines[o+1]||"";if(o===this._textLines.length-1||t.metaKey||34===t.keyCode)return this.text.length-s;var l=this._getLineWidth(this.ctx,o);r=this._getLineLeftOffset(l);for(var u=r,f=0,d=a.length;d>f;f++)i=a[f],u+=this._getWidthOfChar(this.ctx,i,o,f);var g=this._getIndexOnNextLine(n,c,u);return h.length+1+g},_getIndexOnNextLine:function(t,e,i){for(var r,s=t.lineIndex+1,n=this._getLineWidth(this.ctx,s),o=this._getLineLeftOffset(n),a=o,h=0,c=0,l=e.length;l>c;c++){var u=e[c],f=this._getWidthOfChar(this.ctx,u,s,c);if(a+=f,a>i){r=!0;var d=a-f,g=a,p=Math.abs(d-i),v=Math.abs(g-i);h=p>v?c+1:c;break}}return r||(h=e.length),h},moveCursorDown:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getDownCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorDownWithShift(e):this.moveCursorDownWithoutShift(e),this.initDelayedCursor()},moveCursorDownWithoutShift:function(t){this._selectionDirection="right",this.setSelectionStart(this.selectionStart+t),this.setSelectionEnd(this.selectionStart)},swapSelectionPoints:function(){var t=this.selectionEnd;this.setSelectionEnd(this.selectionStart),this.setSelectionStart(t)},moveCursorDownWithShift:function(t){this.selectionEnd===this.selectionStart&&(this._selectionDirection="right"),"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd+t):this.setSelectionStart(this.selectionStart+t),this.selectionEnd<this.selectionStart&&"left"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="right"),this.selectionEnd>this.text.length&&this.setSelectionEnd(this.text.length)},getUpCursorOffset:function(t,e){var i=e?this.selectionEnd:this.selectionStart,r=this.get2DCursorLocation(i),s=r.lineIndex;if(0===s||t.metaKey||33===t.keyCode)return i;for(var n,o=this._textLines[s].slice(0,r.charIndex),a=this._textLines[s-1]||"",h=this._getLineWidth(this.ctx,r.lineIndex),c=this._getLineLeftOffset(h),l=c,u=0,f=o.length;f>u;u++)n=o[u],l+=this._getWidthOfChar(this.ctx,n,s,u);var d=this._getIndexOnPrevLine(r,a,l);return a.length-d+o.length},_getIndexOnPrevLine:function(t,e,i){for(var r,s=t.lineIndex-1,n=this._getLineWidth(this.ctx,s),o=this._getLineLeftOffset(n),a=o,h=0,c=0,l=e.length;l>c;c++){var u=e[c],f=this._getWidthOfChar(this.ctx,u,s,c);if(a+=f,a>i){r=!0;var d=a-f,g=a,p=Math.abs(d-i),v=Math.abs(g-i);h=p>v?c:c-1;break}}return r||(h=e.length-1),h},moveCursorUp:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getUpCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorUpWithShift(e):this.moveCursorUpWithoutShift(e),this.initDelayedCursor()},moveCursorUpWithShift:function(t){this.selectionEnd===this.selectionStart&&(this._selectionDirection="left"),"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd-t):this.setSelectionStart(this.selectionStart-t),this.selectionEnd<this.selectionStart&&"right"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="left")},moveCursorUpWithoutShift:function(t){this.selectionStart===this.selectionEnd&&this.setSelectionStart(this.selectionStart-t),this.setSelectionEnd(this.selectionStart),this._selectionDirection="left"},moveCursorLeft:function(t){(0!==this.selectionStart||0!==this.selectionEnd)&&(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorLeftWithShift(t):this.moveCursorLeftWithoutShift(t),this.initDelayedCursor())},_move:function(t,e,i){var r="selectionStart"===e?"setSelectionStart":"setSelectionEnd";this[r](t.altKey?this["findWordBoundary"+i](this[e]):t.metaKey||35===t.keyCode||36===t.keyCode?this["findLineBoundary"+i](this[e]):this[e]+("Left"===i?-1:1))},_moveLeft:function(t,e){this._move(t,e,"Left")},_moveRight:function(t,e){this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this._moveLeft(t,"selectionStart"),this.setSelectionEnd(this.selectionStart)},moveCursorLeftWithShift:function(t){"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):(this._selectionDirection="left",this._moveLeft(t,"selectionStart"))},moveCursorRight:function(t){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorRightWithShift(t):this.moveCursorRightWithoutShift(t),this.initDelayedCursor())},moveCursorRightWithShift:function(t){"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):(this._selectionDirection="right",this._moveRight(t,"selectionEnd"))},moveCursorRightWithoutShift:function(t){this._selectionDirection="right",this.selectionStart===this.selectionEnd?(this._moveRight(t,"selectionStart"),this.setSelectionEnd(this.selectionStart)):(this.setSelectionEnd(this.selectionEnd+this.getNumNewLinesInSelectedText()),this.setSelectionStart(this.selectionEnd))},removeChars:function(t){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(t):this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.setSelectionEnd(this.selectionStart),this._removeExtraneousStyles(),this._clearCache(),this.canvas&&this.canvas.renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(t){if(0!==this.selectionStart)if(t.metaKey){var e=this.findLineBoundaryLeft(this.selectionStart);this._removeCharsFromTo(e,this.selectionStart),this.setSelectionStart(e)}else if(t.altKey){var i=this.findWordBoundaryLeft(this.selectionStart);this._removeCharsFromTo(i,this.selectionStart),this.setSelectionStart(i)}else this._removeSingleCharAndStyle(this.selectionStart),this.setSelectionStart(this.selectionStart-1)}}),function(){var t=fabric.util.toFixed,e=fabric.Object.NUM_FRACTION_DIGITS;fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(t,e,i,r,s,n){this.styles[t]?this._setSVGTextLineChars(t,e,i,r,n):this.callSuper("_setSVGTextLineText",t,e,i,r,s)},_setSVGTextLineChars:function(t,e,i,r,s){for(var n=this._textLines[t],o=0,a=this._getSVGLineLeftOffset(t)-this.width/2,h=this._getSVGLineTopOffset(t),c=this._getHeightOfLine(this.ctx,t),l=0,u=n.length;u>l;l++){var f=this.styles[t][l]||{};e.push(this._createTextCharSpan(n[l],f,a,h.lineTop+h.offset,o));var d=this._getWidthOfChar(this.ctx,n[l],t,l);f.textBackgroundColor&&s.push(this._createTextCharBg(f,a,h.lineTop,c,d,o)),o+=d}},_getSVGLineLeftOffset:function(t){return fabric.util.toFixed(this._getLineLeftOffset(this.__lineWidths[t]),2)},_getSVGLineTopOffset:function(t){for(var e=0,i=0,r=0;t>r;r++)e+=this._getHeightOfLine(this.ctx,r);return i=this._getHeightOfLine(this.ctx,r),{lineTop:e,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},_createTextCharBg:function(i,r,s,n,o,a){return['<rect fill="',i.textBackgroundColor,'" x="',t(r+a,e),'" y="',t(s-this.height/2,e),'" width="',t(o,e),'" height="',t(n/this.lineHeight,e),'"></rect>'].join("")},_createTextCharSpan:function(t,e,i,r,s){var n=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},e));return['<tspan x="',i+s,'" y="',r-this.height/2,'" ',e.fontFamily?'font-family="'+e.fontFamily.replace(/"/g,"'")+'" ':"",e.fontSize?'font-size="'+e.fontSize+'" ':"",e.fontStyle?'font-style="'+e.fontStyle+'" ':"",e.fontWeight?'font-weight="'+e.fontWeight+'" ':"",e.textDecoration?'text-decoration="'+e.textDecoration+'" ':"",'style="',n,'">',fabric.util.string.escapeXml(t),"</tspan>"].join("");

}})}(),function(){function request(t,e,i){var r=URL.parse(t);r.port||(r.port=0===r.protocol.indexOf("https:")?443:80);var s=0===r.protocol.indexOf("https:")?HTTPS:HTTP,n=s.request({hostname:r.hostname,port:r.port,path:r.path,method:"GET"},function(t){var r="";e&&t.setEncoding(e),t.on("end",function(){i(r)}),t.on("data",function(e){200===t.statusCode&&(r+=e)})});n.on("error",function(t){fabric.log(t.errno===process.ECONNREFUSED?"ECONNREFUSED: connection refused to "+r.hostname+":"+r.port:t.message),i(null)}),n.end()}function requestFs(t,e){var i=require("fs");i.readFile(t,function(t,i){if(t)throw fabric.log(t),t;e(i)})}if("undefined"==typeof document||"undefined"==typeof window){var DOMParser=require("xmldom").DOMParser,URL=require("url"),HTTP=require("http"),HTTPS=require("https"),Canvas=require("canvas"),Image=require("canvas").Image;fabric.util.loadImage=function(t,e,i){function r(r){r?(s.src=new Buffer(r,"binary"),s._src=t,e&&e.call(i,s)):(s=null,e&&e.call(i,null,!0))}var s=new Image;t&&(t instanceof Buffer||0===t.indexOf("data"))?(s.src=s._src=t,e&&e.call(i,s)):t&&0!==t.indexOf("http")?requestFs(t,r):t?request(t,"binary",r):e&&e.call(i,t)},fabric.loadSVGFromURL=function(t,e,i){t=t.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim(),0!==t.indexOf("http")?requestFs(t,function(t){fabric.loadSVGFromString(t.toString(),e,i)}):request(t,"",function(t){fabric.loadSVGFromString(t,e,i)})},fabric.loadSVGFromString=function(t,e,i){var r=(new DOMParser).parseFromString(t);fabric.parseSVGDocument(r.documentElement,function(t,i){e&&e(t,i)},i)},fabric.util.getScript=function(url,callback){request(url,"",function(body){eval(body),callback&&callback()})},fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){var r=new fabric.Image(i);r._initConfig(t),r._initFilters(t.filters,function(i){r.filters=i||[],r._initFilters(t.resizeFilters,function(t){r.resizeFilters=t||[],e&&e(r)})})})},fabric.createCanvasForNode=function(t,e,i,r){r=r||i;var s=fabric.document.createElement("canvas"),n=new Canvas(t||600,e||600,r);s.style={},s.width=n.width,s.height=n.height;var o=fabric.Canvas||fabric.StaticCanvas,a=new o(s,i);return a.contextContainer=n.getContext("2d"),a.nodeCanvas=n,a.Font=Canvas.Font,a},fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(t){return this.nodeCanvas.createJPEGStream(t)};var origSetWidth=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(t,e){return origSetWidth.call(this,t,e),this.nodeCanvas.width=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var origSetHeight=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(t,e){return origSetHeight.call(this,t,e),this.nodeCanvas.height=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}}();
'use strict';

angular.module('ImageEditor', ['ngMaterial', 'ngAnimate', 'ui.sortable', 'image.crop', 'image.text', 'image.drawing', 'image.filters', 'image.shapes', 'image.directives', 'image.basics'])

.config(['$mdThemingProvider', function($mdThemingProvider) {
    $mdThemingProvider.theme('default')
        .primaryPalette('deep-orange')
        .accentPalette('brown'); 
}])

.controller('MainController', ['$rootScope', '$scope', '$timeout', '$$rAF', '$mdBottomSheet', 'canvas', 'history', 'simpleShapes', 'filters', function($rootScope, $scope, $timeout, $$rAF, $mdBottomSheet, canvas, history, simpleShapes, filters) {

    //true after user uploads an image or create a new canvas
    $rootScope.started = false;

    //check if we're on a demo site
    $rootScope.isDemo = document.URL.indexOf('pixie.vebto.com') > -1;

    $rootScope.isIntegrationMode = false; 

    //check if we're running in integration mode
    try {
        if (window.self !== window.top) { 
            $('script', window.parent.document).each(function(i, node) {
                if (node.src.indexOf('pixie-integrate') > -1) {
                    $rootScope.isIntegrationMode = true;
                    return false;
                }
            });
        }
    } catch (e) {
        $rootScope.isIntegrationMode = false;
    }

    //get a reference to top window if we're inside iframe
    if ($rootScope.isIntegrationMode) {
        $rootScope.pixie = window.parent.Pixie;
    }

    $rootScope.getParam = function(name) {
        if ($rootScope.pixie) {
            return $rootScope.pixie.getParams()[name];
        } else if (window.PixieParams) {
            return window.PixieParams[name];
        }
    };

    canvas.start();

    //make actions panels draggable
    $('.actions-menu').draggable({
        handle: '.menu-header',
        containment: 'body'
    });

	$rootScope.canvas = canvas;
	$rootScope.history = history;
    $rootScope.shapes = simpleShapes;
	$rootScope.loading = false;
    $rootScope.animationEndEvent = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';
    $rootScope.transitionEndEvent = 'webkitTransitionEnd mozTransitionEnd MSTransitionEnd oatransitionend atransitionend transitionend';

    $rootScope.maxPanelHeight = $(window).height() - 120;

    $rootScope.openPanel = function(name, e) {
        if ($rootScope.activePanel === name) return;

        $rootScope.activePanel = name;

        var panel = $('[data-name="'+name+'"]');

        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.removeClass('transition-in').css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );

        $$rAF(function() {
            $(panel).addClass('transition-in').css('transform', '');
        });
    };

	$rootScope.isLoading = function() {
		$timeout(function() {
			$rootScope.loading = true;
		});
	};

	$rootScope.isNotLoading = function() {
		$timeout(function() {
			$rootScope.loading = false;
		});
	};

	$rootScope.activePanel = false;
    $rootScope.activeTab   = false;

	$rootScope.keys = {
		google_fonts: 'AIzaSyDhc_8NKxXjtv69htFcUPe6A7oGSQ4om2o',
	};

	$rootScope.$watch('activePanel', function() {
		setTimeout(function () {
			$(window).resize(); 
		}, 100);
	});
    
    $rootScope.resetUI = function() {
        $timeout(function() {
            $rootScope.activePanel = null;
            $rootScope.activeTab   = 'basics';
            simpleShapes.selected  = null;
            filters.appliedFilters = [];
            $rootScope.history.all = [];
        });
    };

    //open corresponding tab in left panel when user selects an object
    canvas.fabric.on('object:selected', function(e) {
        if (e.target.name == 'text') {
            $rootScope.activeTab = 'text';
        } else if (e.target.name == 'sticker' && $rootScope.activeTab !== 'stickers') {
            $rootScope.activeTab = 'stickers';
        } else if (e.target.name && $rootScope.activeTab !== 'simple-shapes') {
            for (var i = 0; i < simpleShapes.available.length; i++) {
                var shape = simpleShapes.available[i];

                if (shape.name === e.target.name && $rootScope.activeTab !== 'simple-shapes') {
                    simpleShapes.selected = shape;
                    $rootScope.activeTab = 'simple-shapes';
                }
            }
        }

        $timeout(angular.noop);
    });

    //Close object panel when object is de-selected
    canvas.fabric.on('selection:cleared', function() {
        $timeout(angular.noop);
    });

    //deselect all objects when clicking outside canvas
    $('#viewport').on('click', function(e) {
        if (e.target.id === 'viewport') {
            $timeout(function() {
                canvas.fabric.deactivateAll().renderAll();
            });
        }
    });

    $scope.openBottomSheet = function(name) {
        $mdBottomSheet.show({
            template: $('#'+name+'-sheet-template').html(),
            controller: 'BottomSheetController'
        });
    }; 

    //cleanup. remove color picker containers on scope destroy.
    $scope.$on('$destroy', function() {
        $('.sp-container').remove();
    });

     $rootScope.spacify = function(text) {
        if (text) {
            var temp = text.replace( /([A-Z])/g, " $1" );
            return temp.charAt(0).toUpperCase() + temp.slice(1);
        }
     };
}])

.controller('BottomSheetController', ['$rootScope', '$scope', '$mdBottomSheet', '$mdDialog', 'simpleShapes', function($rootScope, $scope, $mdBottomSheet, $mdDialog, simpleShapes) {
    $scope.shapes = simpleShapes;

    $scope.showDialog = function($event) {
        $mdDialog.show({
            template: $('#texture-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'BottomSheetController'
        });
    }
}]);
angular.module('ImageEditor')

.factory('localStorage', function() {
	var storage = {

		/**
		 * How long (days) data will be cached in local storage.
		 * 
		 * @type {Number}
		 */
		expireAfter: 2,

		/**
		 * Retrieve value under given key from local storage.
		 * 
		 * @param  string key
		 * @return mixed
		 */
		get: function(key) {
			var value = JSON.parse(localStorage.getItem(key));
			
			if ( ! value || ! storage.isValid(value.time)) {
				return false;
			}

			return value.value;
		},

		/**
		 * Store value into browser local storage.
		 * 
		 * @param string key
		 * @param mixed value
		 */
		set: function(key, value) {
			var data = { value: value, time: new Date().getTime() };

			return localStorage.setItem(key, JSON.stringify(data));
		},

		/**
		 * Whether or not cache with given time is considered expired.
		 * 
		 * @param  string  time
		 * @return {Boolean}
		 */
		isValid: function(time) {
			var days = (new Date().getTime() - new Date(time).getTime())/(1000*60*60*24);

			return days < storage.expireAfter;
		}
	};

	return storage;
});
'use strict';

angular.module('ImageEditor').factory('settings', ['$rootScope', '$http', function($rootScope, $http) {

	var settings = {
        all: {},

        get: function(name) {
            return this.all[name];
        }
	}

    $http.get('config.json').success(function(data) {
        settings.all = data;

        $rootScope.$emit('settings.ready');
    });

	return settings;
}]);
'use strict';

angular.module('ImageEditor')

.factory('keybinds', ['$rootScope', function($rootScope) {

    var keybinds = {

        fabric: false,

        init: function(fabric) {
            this.fabric = fabric;
            init();
        },

        destroy: function() {
            $('.canvas-container').off("keydown", processKeys, false);
        }
    };

    function init() {
        $(document).on('keydown', handleKeyDown);
    }

    function handleKeyDown(e) {
        e = e || window.event;

        if ([37, 38, 39, 40].indexOf(e.keyCode) > -1) moveObject(e);
        if (e.keyCode === 46) deleteObject();

    }

    function deleteObject() {
        var activeObject = keybinds.fabric.getActiveObject();

        if (activeObject) {
            keybinds.fabric.remove(activeObject);
            keybinds.fabric.renderAll();
        }
    }

    function moveObject(e) {
        var movementDelta = 2;

        var activeObject = keybinds.fabric.getActiveObject();
        var activeGroup = keybinds.fabric.getActiveGroup();

        if (e.keyCode === 37) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('left') - movementDelta;
                activeObject.set('left', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('left') - movementDelta;
                activeGroup.set('left', a);
            }

        } else if (e.keyCode === 39) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('left') + movementDelta;
                activeObject.set('left', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('left') + movementDelta;
                activeGroup.set('left', a);
            }

        } else if (e.keyCode === 38) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('top') - movementDelta;
                activeObject.set('top', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('top') - movementDelta;
                activeGroup.set('top', a);
            }

        } else if (e.keyCode === 40) {
            e.preventDefault();
            if (activeObject) {
                var a = activeObject.get('top') + movementDelta;
                activeObject.set('top', a);
            }
            else if (activeGroup) {
                var a = activeGroup.get('top') + movementDelta;
                activeGroup.set('top', a);
            }
        }

        if (activeObject) {
            activeObject.setCoords();
            keybinds.fabric.renderAll();
        } else if (activeGroup) {
            activeGroup.setCoords();
            keybinds.fabric.renderAll();
        }
    }

    return keybinds;
}]);
angular.module('ImageEditor')

.service('canvas', ['$rootScope', '$mdDialog', 'keybinds', function($rootScope, $mdDialog, keybinds) {

	var canvas = {

        original: {},

        //store window width and height so we don't execute
        //functions unnecessarily on resize event if they didn't change
        oldWindowDimensions: {
            width: window.innerWidth,
            height: window.innerHeight
        },

		mainImage: false,
		fabric: false,
		ctx: false,
		container: false,
		viewport: false,
		offset: false,
		element: false,

        minWidth: 50,
        minHeight: 50,

		imageStatic: {
            locked: true,
			selectable: false,
	      	evented: false,
	      	lockMovementX: true,
	      	lockMovementY: true,
	      	lockRotation: true,
	      	lockScalingX: true,
	      	lockScalingY: true,
	      	lockUniScaling: true,
	      	hasControls: false,
	      	hasBorders: false
		},

        destroy: function() {
            this.fabric.dispose();
            this.mainImage = false;
            this.fabric = false;
            this.ctx = false;
            this.container = false;
            this.viewport = false;
            this.offset = false;
            this.element = false;
            this.original = {};
            this.currentZoom = 1;
            $rootScope.editorCustomActions = {};
            $(window).off('resize');
            keybinds.destroy();
        },

		start: function(url) {
            this.element = document.getElementById('canvas');
            this.fabric = new fabric.Canvas('canvas');
            this.ctx = this.fabric.getContext('2d');
            this.container = $('.canvas-container');
            this.viewport = document.getElementById('viewport');
            $rootScope.editorCustomActions = {};

            this.fabric.selection = false; 
            this.fabric.renderOnAddRemove = false;

            fabric.Object.prototype.borderColor = '#2196F3';
            fabric.Object.prototype.cornerColor = '#2196F3';
            fabric.Object.prototype.transparentCorners = false;

            if ( ! url) url = $rootScope.getParam('url');

            if (url) {
                this.loadMainImage(url);
                $rootScope.started = true;
            } else if ($rootScope.getParam('blankCanvasSize')) {
                var size = $rootScope.getParam('blankCanvasSize');
                this.openNew(size.width, size.height, 'newCanvas');
                $rootScope.started = true;
            }

            if ( ! $rootScope.started && ! $rootScope.isIntegrationMode && ! $rootScope.delayEditorStart) {
                /*$mdDialog.show({
                    template: $('#main-image-upload-dialog-template').html(),
                    controller: 'TopPanelController',
                    clickOutsideToClose: false
                });*/

                //$scope.createNewCanvas(500, 500)
                //canvas.openNew(500,500,"Unnamed");

                canvas.openNew(1172, 1182);
                $rootScope.started = true;
            }

            $(window).off('resize').on('resize', function(e) {
                if (canvas.oldWindowDimensions.height !== e.target.innerHeight ||
                    canvas.oldWindowDimensions.width !== e.target.innerWidth) {
                    canvas.fitToScreen();
                }

                canvas.oldWindowDimensions.width = e.target.innerWidth;
                canvas.oldWindowDimensions.height = e.target.innerHeight;
            });

            $rootScope.$emit('canvas.init');

            keybinds.init(this.fabric);

            if ($rootScope.getParam('onLoad')) {
                $rootScope.getParam('onLoad')(this.viewport, $rootScope, window); 
            }
        },

        hideModals: function() {
            $mdDialog.hide();
        },

        mergeObjects: function() {
            canvas.zoom(1);
            this.fabric.deactivateAll();
            var data = this.fabric.toDataURL();
            this.fabric.clear();
            this.loadMainImage(data);
        },

        loadFromJSON: function(design, callback) {
            canvas.fabric.loadFromJSON(design.serialized_editor_state || design.state, function() {
                canvas.fabric.forEachObject(function(obj) {

                    //reapply any filters object used to have
                    if (obj.applyFilters && obj.filters.length) {
                        obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                    }

                    //assign new reference to mainImage property
                    if (obj.name == 'mainImage') {
                        canvas.mainImage = obj;
                    }
                });

                if (design.width && design.height) {
                    canvas.fabric.setWidth(design.width);
                    canvas.fabric.setHeight(design.height);
                    canvas.original.height = design.height;
                    canvas.original.width = design.width;
                }

                canvas.fabric.renderAll();
                canvas.fabric.calcOffset();
                canvas.fitToScreen();
                $rootScope.$emit('history.loaded');

                callback && callback(design);
            });
        },

        /**
         * Create a new image with given dimensions.
         *
         * @param {int|string} width
         * @param {int|string} height
         * @param {string|undefined} name
         */
        openNew: function(width, height, name) {
            width = width < this.minWidth ? this.minWidth : width;
            height = height < this.minHeight ? this.minHeight : height;

            this.fabric.clear();
            this.fabric.setWidth(width);
            this.fabric.setHeight(height);
            this.fabric.renderAll();
            canvas.fitToScreen();

            //save the dimensions so we can scale images opened later to them
            $rootScope.userPreset = {
                width: width,
                height: height,
                name: name
            };

            canvas.original.height = height;
            canvas.original.width = width;

            $rootScope.$emit('canvas.openedNew');
        },

        center: function(obj) {
            obj.center();

            if (canvas.zoom > 100) {
                obj.setLeft(10);
                obj.setTop(35);
            }

            obj.setCoords();
        },

        serialize: function() {
            return this.fabric.toJSON(['selectable', 'name']);
        },

		loadMainImage: function(url, height, width, dontFit, callback) {
			var object;

			fabric.util.loadImage(url, function (img) {
                //img.crossOrigin = 'anonymous';

			    object = new fabric.Image(img, canvas.imageStatic);
			    object.name = 'mainImage';

                if (width && height) {
                    object.width = width;
                    object.height = height;
                }

			    canvas.mainImage = object;

                canvas.fabric.forEachObject(function(obj) {
                    if (obj.name == 'mainImage') {
                        canvas.fabric.remove(obj);
                    }
                });
			    canvas.fabric.add(object);
			   	object.top = -0.5;
			   	object.left = -0.5;
			    object.moveTo(0);

			    canvas.fabric.setHeight(object.height);
			    canvas.fabric.setWidth(object.width);

                canvas.original.height = object.height;
                canvas.original.width = object.width;

				if ( ! dontFit) {
                    canvas.fitToScreen();
                }

				$rootScope.$apply(function() {
					$rootScope.$emit('editor.mainImage.loaded');
				});

                if (callback) {
                    callback();
                }
			});
		},

        /**
         * Open image at given url in canvas.
         *
         * @param {string} url
         */
        openImage: function(url) {
            canvas.zoom(1);
            fabric.util.loadImage(url, function(image) {
                if ( ! image) return;

                var object = new fabric.Image(image);
                object.name = 'image';

                //use either main image or canvas dimensions as outter boundaries for scaling new image
                var maxWidth  = canvas.mainImage ? canvas.mainImage.getWidth() : canvas.fabric.getWidth(),
                    maxHeight = canvas.mainImage ? canvas.mainImage.getHeight() : canvas.fabric.getHeight();

                //if image is wider or heigher then the current canvas, we'll scale id down
                if (object.width >= maxWidth || object.height >= maxHeight) {

                    //calc new image dimensions (main image height - 10% and width - 10%)
                    var newWidth  = maxWidth - (0.1 * maxWidth),
                        newHeight = maxHeight - (0.1 * maxHeight),
                        scale     = 1 / (Math.min(newHeight / object.getHeight(), newWidth / object.getWidth()));

                    //scale newly uploaded image to the above dimesnsions
                    object.scaleX = object.scaleX * (1 / scale);
                    object.scaleY = object.scaleY * (1 / scale);
                }

                //center and render newly uploaded image on the canvas
                canvas.fabric.add(object);
                object.left = (canvas.fabric.getWidth() - object.getWidth()) / 2;
                object.top = (canvas.fabric.getHeight() - object.getHeight()) / 2;
                object.setCoords();
                canvas.fabric.setActiveObject(object);
                canvas.fabric.renderAll();

                canvas.fitToScreen();
            });
        },

        getDataURL: function(options) {
            if ( ! options) options = {};

            //ignore zoom when getting data url
            options.multiplier = 1 / canvas.currentZoom;

            return this.fabric.toDataURL(options);
        },

        currentZoom: 1,

        zoom: function(scaleFactor) {
            this.fabric.setZoom(scaleFactor);
            this.fabric.setHeight(this.original.height * scaleFactor);
            this.fabric.setWidth(this.original.width * scaleFactor);

            this.currentZoom = scaleFactor;
        },

        fitToScreen: function () {
            var maxWidth  = canvas.viewport.offsetWidth - 40,
                maxHeight = canvas.viewport.offsetHeight - 120,
                outter    = canvas.mainImage || canvas.fabric,
            	scale     = Math.min(maxHeight / outter.getHeight(), maxWidth / outter.getWidth());

            if (outter.getHeight() > maxHeight || outter.getWidth() > maxWidth) {
                canvas.zoom(scale); 
            }
        }
	};

	return canvas;

}]);
angular.module('image.crop', [])

.service('cropper', ['$rootScope', 'cropzone', 'canvas', 'history', function($rootScope, cropzone, canvas, history) {
	
	var cropper = {

		start: function(e) {
			if (cropzone.initiated) return;
			
			cropzone.add();
			$rootScope.openPanel('crop', e);
		},

		stop: function(e) {
			cropzone.remove();
			$rootScope.activePanel = false;
		},

		crop: function() {
			if ( ! cropzone.initiated) return false;

			cropzone.hide();
		    var image = new Image();

		    image.onload = function() {
		        var fabricImage = new fabric.Image(this, canvas.imageStatic);
                fabricImage.name = 'mainImage';

		        canvas.mainImage && canvas.mainImage.remove();
                canvas.fabric.clear();
		        canvas.fabric.setWidth(Math.ceil(cropzone.rect.getWidth()));
		        canvas.fabric.setHeight(Math.ceil(cropzone.rect.getHeight()));

        		canvas.fabric.add(fabricImage);
                fabricImage.moveTo(0);
                fabricImage.center();
        		canvas.mainImage = fabricImage;
        		cropzone.remove();

                history.add('crop', 'crop');

				$rootScope.$apply(function() {
					$rootScope.activePanel = false;
				});
		    };

            canvas.zoom(1);

            $rootScope.editorCustomActions.crop = {
                left: cropzone.rect.getLeft(),
                top: cropzone.rect.getTop(),
                width: Math.ceil(cropzone.rect.getWidth()),
                height: Math.ceil(cropzone.rect.getHeight())
            };

		    image.src = canvas.fabric.toDataURL({
		        left: cropzone.rect.getLeft(),
		        top: cropzone.rect.getTop(),
		        width: Math.ceil(cropzone.rect.getWidth()),
		        height: Math.ceil(cropzone.rect.getHeight())
		    });

            canvas.original.width = Math.ceil(cropzone.rect.getWidth());
            canvas.original.height = Math.ceil(cropzone.rect.getHeight());
		}

	};

	return cropper;

}]);
angular.module('image.crop')

.service('cropzone', ['$rootScope', 'canvas', function($rootScope, canvas) {

	var cropzone = {

		rect: {},

		dragging: false,

		initiated: false,

		minHeight: 25,

		minWidth: 25,

		setWidth: function(width) {
            if ( ! width) return;

            width = parseInt(width);

			if (width < this.minWidth) {
				width = this.minWidth;
			}

			if (width > canvas.original.width) {
				width = canvas.original.width - 25;
			}

            this.rect.width = width;
			this.rect.setTop((canvas.original.height - this.rect.getHeight()) / 2);
			this.rect.setLeft((canvas.original.width - this.rect.getWidth()) / 2);
			this.rect.setCoords();
			this.drawGrid();
			this.drawOverlay();
			canvas.fabric.renderAll();
		},

		setHeight: function(height) {
            if ( ! height) return;

            height = parseInt(height);

			if (height < this.minHeight) {
				height = this.minHeight;
			}

            if (height > canvas.original.height) {
                height = canvas.original.height - 25;
            }

            this.rect.height = height;
			this.rect.setTop((canvas.original.height - this.rect.getHeight()) / 2);
			this.rect.setLeft((canvas.original.width - this.rect.getWidth()) / 2);
			this.rect.setCoords();
			this.drawGrid();
			this.drawOverlay();
			canvas.fabric.renderAll();
		},

		add: function() {
			this.drawMainZone();
			this.drawOverlay();
			this.drawGrid();
			this.attachEvents();

			canvas.fabric.renderAll();

			this.initiated = true;

			$rootScope.$emit('cropzone.added');
		},

		constrainWithinCanvas: function(object) {
		    var x = object.getLeft(), y = object.getTop();
		    var w = object.getWidth(), h = object.getHeight();
		    var maxX = canvas.original.width - w;
		    var maxY = canvas.original.height - h;

		    if (x < 0) {
		    	object.set('left', 0);
		    }
		    if (y < 0) {
		        object.set('top', 0);
			}
		    if (x > maxX) {
		        object.set('left', maxX);
		    }
		    if (y > maxY) {
		    	object.set('top', maxY);
		    }
		},

		constrainWithinCanvasOnScaling: function(object) {

		    var minX = object.getLeft();
		    var minY = object.getTop();
		    var maxX = object.getLeft() + object.getWidth();
		    var maxY = object.getTop() + object.getHeight();

		    if (minX < 0 || maxX > canvas.original.width) {
		        var lastScaleX = this.lastScaleX|| 1;
		        object.setScaleX(lastScaleX);
		    }

		    if (minX < 0) {
		        object.setLeft(0);
		    }

		    if (minY < 0 || maxY > canvas.original.height) {
		        var lastScaleY = this.lastScaleY|| 1;
		        object.setScaleY(lastScaleY);
		    }

		    if (minY < 0) {
		        object.setTop(0);
		    }

		    if (object.getWidth() < this.minWidth) {
		        object.width = this.minWidth;
		        object.setScaleX(1);
		    }

		    if (object.getHeight() < this.minHeight) {
		       object.height = this.minHeight;
		       object.setScaleY(1);
		    }

		    this.lastScaleX = object.getScaleX();
		    this.lastScaleY = object.getScaleY();
		},

		onMouseDown: function(event) {
			if (event.target && (event.target.name === 'cropzone' || event.target.name === 'crop.grid')) return;

			cropzone.dragging = true;

			//hide cropzone on single click on overlay
			cropzone.overlay.visible = false;
			cropzone.grid.visible = false;
			cropzone.rect.visible = false;

			//start position for drawing a cropzone
		    cropzone.rect.left = event.e.pageX - canvas.fabric._offset.left;
		    cropzone.rect.top = event.e.pageY - canvas.fabric._offset.top;

		    //make sure cropzone scale is 1 for accurate coordinates
		    cropzone.rect.scale(1);
            cropzone.overlay.scale(1);
            cropzone.grid.scale(1);
		    cropzone.mousex = event.e.pageX;
		    cropzone.mousey = event.e.pageY;

		    //prevent selection of objects while dragging
		    canvas.fabric.selection = false;

		    cropzone.drawOverlay();
		},

		onMouseMove: function(event) {
			if ( ! cropzone.dragging) return;

			var width  = event.e.pageX - cropzone.mousex,
				height = event.e.pageY - cropzone.mousey;

			//prevent cropzone going over the right edge
			if (canvas.offset.left + canvas.original.width < event.e.pageX) {
				width = (canvas.offset.left + canvas.original.width) - cropzone.mousex;
			}

			//left edge
			if (canvas.offset.left > event.e.pageX) {
				width = canvas.offset.left - cropzone.mousex;
			}

			//bottom edge
			if (canvas.offset.top + canvas.original.height < event.e.pageY) {
				height = (canvas.offset.top + canvas.original.height) - cropzone.mousey;
			}

			//top edge
			if (canvas.offset.top > event.e.pageY) {
				height = canvas.offset.top - cropzone.mousey;
			}

			cropzone.rect.width = width;
        	cropzone.rect.height = height;
        	cropzone.rect.moveTo(3);
            cropzone.rect.setCoords();
        	cropzone.drawOverlay();
	        cropzone.drawGrid();

			if ( ! cropzone.rect.visible) {
				cropzone.rect.visible = true;
				cropzone.overlay.visible = true;
				cropzone.grid.visible = true;
			}
		},

		onMouseUp: function() {
		   	cropzone.dragging = false;
		    canvas.fabric.selection = true;
		    cropzone.rect.setCoords();
            cropzone.grid.setCoords();
            cropzone.overlay.setCoords();

		    if (cropzone.rect.visible) {
		    	canvas.fabric.setActiveObject(cropzone.rect);
			}
		},

		attachEvents: function() {

			//redraw cropzone grid and overlay when cropzone is resized
			this.rect.on('moving', function() {
				cropzone.constrainWithinCanvas(cropzone.rect);
				cropzone.drawOverlay();
				cropzone.drawGrid();
			});

			this.rect.on('scaling', function(e) {
				cropzone.constrainWithinCanvasOnScaling(cropzone.rect, e);
				cropzone.drawOverlay();
				cropzone.drawGrid();
			});

			canvas.fabric.on("mouse:down", cropzone.onMouseDown);
			canvas.fabric.on("mouse:move", cropzone.onMouseMove);
			canvas.fabric.on("mouse:up", cropzone.onMouseUp);
		},

		remove: function() {
			canvas.fabric.off("mouse:down", cropzone.onMouseDown);
			canvas.fabric.off("mouse:move", cropzone.onMouseMove);
			canvas.fabric.off("mouse:up", cropzone.onMouseUp);

			canvas.fabric.remove(this.rect);
			canvas.fabric.remove(this.grid);
			canvas.fabric.remove(this.overlay);
            canvas.fabric.renderAll();
			this.initiated = false;
		},

		hide: function() {
			this.rect.visible = false;
			this.rect.hasControls = false;
			this.grid.visible = false;
			this.overlay.visible = false;
		},

		getOptimalDimensions: function () {
            var width = canvas.original.width / 2,
                height = canvas.original.height / 2,
                left = canvas.original.width / 4,
                top = canvas.original.height / 4;

			if (canvas.viewport.offsetWidth < canvas.original.width) {
				width = canvas.viewport.offsetWidth / 2;
				left = canvas.viewport.offsetWidth / 4;

			}

            if (canvas.viewport.offsetHeight < canvas.original.height) {
                height = canvas.viewport.offsetHeight / 2;
                top = canvas.viewport.offsetHeight / 4;
            }

			return {width: width, height: height, left: left, top: top};
		},

		drawMainZone: function() {
			var dimensions = this.getOptimalDimensions();

			this.rect = new fabric.Rect({
			    fill: 'transparent',
			    stroke: 'rgba(255, 255, 255, 0.6)',
			    hasBorders: false,
			    width: dimensions.width,
			    height: dimensions.height,
			    left: dimensions.left,
			    top: dimensions.top,
			    hasRotatingPoint: false,
			    name: 'cropzone',
			    cornerColor: 'rgba(255, 255, 255, 0.6)',
			    transparentCorners: false,
                ignore: true
			});

			canvas.fabric.add(this.rect);
			this.rect.moveTo(3);
			canvas.fabric.setActiveObject(cropzone.rect);
		},

		drawGrid: function() {

			if ( ! this.initiated) {
				this.line1 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line2 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line3 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.line4 = new fabric.Line([], { stroke: 'rgba(255, 255, 255, 0.6)', strokeWidth: 1, selectable: false, evented: false });
				this.grid = new fabric.Group([this.line1, this.line2, this.line3, this.line4]);
				this.grid.originY = 'left';
				this.grid.originX = 'top';
                this.grid.ignore = true;
                this.grid.selectable = false;
				canvas.fabric.add(this.grid);
		    	this.grid.moveTo(10);
			}

			this.grid.width = this.rect.getWidth();
			this.grid.height = this.rect.getHeight();
			this.grid.left = this.rect.getLeft();
			this.grid.top = this.rect.getTop();

			var width  = cropzone.rect.getWidth() / 3,
				height = cropzone.rect.getHeight() / 3;

			this.line1.set({
				x1: width,
				y1: 0,
				x2: width,
				y2: cropzone.grid.getHeight(),
			});

			this.line2.set({
				x1: width * 2,
				y1: 0,
				x2: width * 2,
				y2: cropzone.grid.getHeight()
			});

			this.line3.set({
				x1: 0,
				y1: height,
				x2: cropzone.grid.getWidth(),
				y2: height
			});

			this.line4.set({
				x1: 0,
				y1: height * 2,
				x2: cropzone.grid.getWidth(),
				y2: height * 2
			});

			this.constrainWithinCanvas(this.grid);
		},

		drawOverlay: function() {

	    	if ( ! this.initiated) {
	    		this.topRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.rightRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.bottomRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.leftRect = new fabric.Rect({fill: 'rgba(0,0,0,0.7)', selectable: true, evented: false});
	    		this.overlay = new fabric.Group([this.topRect, this.rightRect, this.bottomRect, this.leftRect]);
                this.overlay.ignore = true;
                this.overlay.name = 'grid.overlay';
				canvas.fabric.add(this.overlay);
				this.overlay.moveTo(1);
	    	}

    		this.topRect.set({
	    		left: 0,
				top: 0,
				width: canvas.original.width,
				height: this.rect.getHeight() < 0 ? this.rect.getTop() - Math.abs(this.rect.getHeight()) : this.rect.getTop(),
	    	});

	    	this.rightRect.set({
	    		left: this.rect.getWidth() < 0 ? this.rect.getLeft() : this.rect.getLeft() + this.rect.getWidth(),
				top: this.rect.getTop(),
				width: this.rect.getWidth() < 0 ? canvas.original.width - (this.rect.getLeft() + this.rect.getWidth()) - Math.abs(this.rect.getWidth()) : canvas.original.width - (this.rect.getLeft() + this.rect.getWidth()),
				height: this.rect.getHeight(),
	    	});

	    	this.bottomRect.set({
	    		left: 0,
				top: this.rect.getHeight() < 0 ? this.rect.getTop() : this.rect.getTop() + this.rect.getHeight(),
				width: canvas.original.width,
				height: this.rect.getHeight() < 0 ? canvas.original.height - (this.rect.getTop()) : canvas.original.height - (this.rect.getTop() + this.rect.getHeight()),
	    	});

	    	this.leftRect.set({
	    		left: 0,
				top: this.rect.getTop(),
				width: this.rect.getWidth() > 0 ? this.rect.getLeft() : this.rect.getLeft() - Math.abs(this.rect.getWidth()),
				height: this.rect.getHeight(),
	    	});


	    }
	};

	return cropzone;

}]);
angular.module('image.crop')

.controller('CropController', ['$scope', '$rootScope', 'cropper', 'cropzone', function($scope, $rootScope, cropper, cropzone) {

	$scope.cropper = cropper;
	$scope.cropzone = cropzone;

    $rootScope.$on('tab.changed', function(e, newTab, oldTab) {
       if (oldTab === 'basics' && newTab !== 'basics') {
           cropper.stop();
       }
    });

    $rootScope.$watch('activePanel', function(newPanel, oldPanel) {
        if (newPanel !== 'crop' && oldPanel === 'crop') {
            cropzone.remove();
        }
    });

	$rootScope.$on('cropzone.added', function() {
		$scope.width = Math.round(cropzone.rect.width);
		$scope.height = Math.round(cropzone.rect.height);
	});
}]);
angular.module('image.basics', [])

.controller('RotateController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

        $scope.angle = 0;

        $scope.startRotator = function($event) {
            history.add('rotate-original-state', 'backup', true);
            $scope.openPanel('rotate', $event);
        };

        $scope.applyRotation = function() {
            $rootScope.activePanel = false;
            history.add('rotation', 'rotate-right');
        };

        $scope.cancel = function() {
            history.load('rotate-original-state');
            $rootScope.activePanel = false;
            $scope.angle = 0;
        };

        //rotate properly by scaling canvas to new height after rotating main image by 90 degrees
        $scope.rotateProper = function(originalAngle) {
            canvas.zoom(1);
            var angle = (canvas.mainImage.getAngle() + originalAngle) % 360;

            var height = Math.abs(canvas.mainImage.getWidth()*(Math.sin(angle*Math.PI/180)))+Math.abs(canvas.mainImage.getHeight()*(Math.cos(angle*Math.PI/180))),
                width = Math.abs(canvas.mainImage.getHeight()*(Math.sin(angle*Math.PI/180)))+Math.abs(canvas.mainImage.getWidth()*(Math.cos(angle*Math.PI/180)));

            canvas.fabric.setWidth(width * canvas.currentZoom);
            canvas.fabric.setHeight(height * canvas.currentZoom);
            canvas.original.height = height;
            canvas.original.width  = width;
            canvas.mainImage.center();

            canvas.fabric.forEachObject(function(obj) {
                obj.rotate((obj.getAngle() + originalAngle) % 360);
                obj.setCoords();
            });

            $rootScope.editorCustomActions.rotate = originalAngle;
            canvas.fabric.renderAll();
            canvas.fitToScreen();
        };

        //only rotate the objects of canvas while leaving canvas width/height intact
        $scope.rotate = function(angle, direction) {
            if (angle > 360 || angle < 0) return;
            var resetOrigin = false;

            canvas.fabric.forEachObject(function(obj) {

                if (direction && direction === 'left') {
                    angle = obj.getAngle() - 90;
                } else if (direction && direction === 'right') {
                    angle = obj.getAngle() + 90;
                }

                if ((obj.originX !== 'center' || obj.originY !== 'center') && obj.centeredRotation) {
                    $scope.setOriginToCenter && $scope.setOriginToCenter(obj);
                    resetOrigin = true;
                }

                angle = angle > 360 ? 90 : angle < 0 ? 270 : angle;

                obj.setAngle(angle).setCoords();

                if (resetOrigin) {
                    $scope.setCenterToOrigin && $scope.setCenterToOrigin(obj);
                }
            });

            canvas.fitToScreen();
            canvas.fabric.renderAll();
        };

        $scope.setOriginToCenter = function (obj) {
            obj._originalOriginX = obj.originX;
            obj._originalOriginY = obj.originY;

            var center = obj.getCenterPoint();

            obj.set({
                originX: 'center',
                originY: 'center',
                left: center.x,
                top: center.y
            });
        };

        $scope.setCenterToOrigin = function (obj) {
            var originPoint = obj.translateToOriginPoint(
                obj.getCenterPoint(),
                obj._originalOriginX,
                obj._originalOriginY);

            obj.set({
                originX: obj._originalOriginX,
                originY: obj._originalOriginY,
                left: originPoint.x,
                top: originPoint.y
            });
        };
}]);
angular.module('image.basics')

.controller('CanvasBackgroundController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    $scope.setBackground = function(color) {
        canvas.fabric.setBackgroundColor(color);
        canvas.fabric.renderAll();
    };

    $scope.apply = function() {
        $rootScope.activePanel = false;
        history.add('Canvas Color', 'format-color-fill');
    };

    $scope.cancel = function() {
        $rootScope.activePanel = false;
        canvas.fabric.setBackgroundColor('');
        canvas.fabric.renderAll();
    };
}]);
angular.module('image.basics')

.controller('ResizeController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    $scope.constrainProportions = true;

    $scope.percent = 100;

    $scope.startResizer = function($event) {
        $scope.width  = $scope.usePercentages ? 100 : Math.ceil(canvas.original.width);
        $scope.height = $scope.usePercentages ? 100 : Math.ceil(canvas.original.height);
        history.add('beforeResize', false, true);
        canvas.zoom(1);
        $scope.openPanel('resize', $event);
    };

    /**
     * Toggle resizing mode between percentages and pixles.
     *
     * @param {boolean} usePercentages
     */
    $scope.togglePercentages = function(usePercentages) {
        if (usePercentages) {
            $scope.width = ($scope.width / canvas.original.width) * 100;
            $scope.height = ($scope.height / canvas.original.height) * 100;
        } else {
            $scope.width = ($scope.width * canvas.original.width) / 100;
            $scope.height = ($scope.height * canvas.original.height) / 100;
        }
    };

    $scope.apply = function() {
        var currentWidth  = Math.ceil(canvas.original.width),
            currentHeight = Math.ceil(canvas.original.height),
            newWidth      = Math.ceil($scope.width),
            newHeight     = Math.ceil($scope.height);

        if ($scope.usePercentages) {
            var widthScale    = $scope.width / 100;
            var heightScale   = $scope.height / 100;
        } else {
            var widthScale    = $scope.width / canvas.original.width;
            var heightScale   = $scope.height / canvas.original.height;
        }

        if (currentWidth === newWidth && currentHeight === newHeight) return;

        resize(widthScale, heightScale);

        $rootScope.activePanel = false;
        history.add('resize', 'open-width');
        canvas.fitToScreen();
    };

    $scope.close = function() {
        $rootScope.activePanel = false;
        canvas.fitToScreen();
    };

    $scope.aspectToHeight = function(newWidth) {
        if ( ! $scope.constrainProportions) return;

        if ($scope.usePercentages) {
            $scope.height = newWidth;
        } else {
            var wRatio = parseFloat((canvas.original.width / newWidth).toPrecision(3));
            $scope.height = Math.ceil(canvas.original.height / wRatio);
        }
    };

    $scope.aspectToWidth = function(newHeight) {
        if ( ! $scope.constrainProportions) return;

        if ($scope.usePercentages) {
            $scope.width = newHeight;
        } else {
            var hRatio = parseFloat((canvas.original.height / newHeight).toPrecision(3));
            $scope.width = Math.floor(canvas.original.width / hRatio);
        }
    };

    function resize(widthScale, heightScale) {
        var newHeight = Math.round(canvas.original.height * heightScale),
            newWidth  = Math.round(canvas.original.width * widthScale);

        canvas.fabric.setHeight(newHeight);
        canvas.fabric.setWidth(newWidth);
        canvas.original.width = newWidth;
        canvas.original.height = newHeight;

        var objects = canvas.fabric.getObjects();
        for (var i in objects) {
            var scaleX = objects[i].scaleX;
            var scaleY = objects[i].scaleY;
            var left = objects[i].left;
            var top = objects[i].top;

            var tempScaleX = scaleX * widthScale;
            var tempScaleY = scaleY * heightScale;
            var tempLeft = left * widthScale;
            var tempTop = top * heightScale;

            objects[i].scaleX = tempScaleX;
            objects[i].scaleY = tempScaleY;
            objects[i].left = tempLeft;
            objects[i].top = tempTop;

            objects[i].setCoords();
        }

        canvas.fabric.renderAll();
    }
}]);
angular.module('image.basics')

.controller('RoundedCornersController', ['$scope', '$rootScope', 'canvas', 'history', function($scope, $rootScope, canvas, history) {

    $scope.radius = 50;

    $scope.startRoundedCorners = function(e) {
        if ($rootScope.activePanel === 'round') return;

        $rootScope.openPanel('round', e);

        $scope.rect = new fabric.Rect({
            width: canvas.original.width,
            height: canvas.original.height,
            rx: $scope.radius,
            ry: $scope.radius,
            opacity: 1,
            fill: 'transparent',
            name: 'rounding-rect',
            stroke: '#fff',
            strokeDashArray: [5, 5],
            selectable: false,
            evented: false,
            ignore: true
        });

        canvas.fabric.add($scope.rect);
        canvas.fabric.renderAll();
    };

    $scope.adjustPreview = function() {
        if ( ! $scope.rect) return;

        $scope.rect.set({
            rx: $scope.radius, ry: $scope.radius
        });
        canvas.fabric.renderAll();
    };

    $scope.cancel = function(leavePanel) {
        canvas.fabric.remove($scope.rect);
        $scope.rect  = false;
        $scope.radius = 50;
        canvas.fabric.renderAll();

        if ( !leavePanel) {
            $rootScope.activePanel = false;
        }
    };

    $scope.apply = function() {
        $rootScope.editorCustomActions.roundCorners = angular.copy($scope.radius);

        canvas.fabric.remove($scope.rect);
        canvas.zoom(1);

        canvas.fabric.clipTo = function(ctx) {
            $scope.rect.render(ctx);
            canvas.fabric.clipTo = false;
        };
        var data = canvas.fabric.toDataURL(); //canvas.getDataURL();
        canvas.fabric.clear();
        $scope.cancel();

        canvas.loadMainImage(data, false, false, false, function() {
            $rootScope.$apply(function() {
                history.add('Round Corners', 'panorama-wide-angle');
            });
        });
    };

    $rootScope.$on('tab.changed', function(e, newTab, oldTab) {
        if (oldTab === 'basics' && $scope.rect && newTab !== 'basics') {
            $scope.cancel();
        }
    });

    $rootScope.$watch('activePanel', function(newPanel, oldPanel) {
        if (newPanel !== 'round' && oldPanel === 'round') {
            $scope.cancel(true);
        }
    });
}]);
'use strict';

angular.module('ImageEditor')

.controller('ZoomController', ['$rootScope', '$scope', 'canvas', function($rootScope, $scope, canvas) {

    $scope.canvas = canvas;
    $scope.zoom = 1;
    $scope.maxScale = 200;
    $scope.minScale = 30;

    $rootScope.$on('editor.mainImage.loaded', function() { $scope.fitToScreen() });
    $rootScope.$on('canvas.openedNew', function() { $scope.fitToScreen() });

    $scope.$watch('canvas.currentZoom', function(newValue) {
        var canvasZoom = newValue * 100;

        if (canvasZoom !== $scope.zoom) {
            $scope.zoom = canvasZoom;
        }
    });

    $scope.fitToScreen = function () {
        $scope.zoom = canvas.currentZoom * 100;
            
        if (canvas.mainImage) {
            var oWidth = canvas.mainImage.originalState.width,
                oHeight = canvas.mainImage.originalState.height;
        } else {
            var oWidth = canvas.original.width,
                oHeight = canvas.original.height;
        }

        var maxScale = Math.min(3582 / oHeight, 5731 / oWidth) * 100,
            minScale = Math.min(141 / oHeight, 211 / oWidth) * 100;

        $scope.maxScale = Math.ceil(maxScale);
        $scope.minScale = Math.ceil(minScale);

        canvas.zoom(canvas.currentZoom);
    };

    //make sure we adjust zoom slider properly on history change
    $rootScope.$on('history.loaded', function() {
        $scope.zoom = canvas.currentScale * 100;
    });

    $scope.doZoom = function () {
        canvas.zoom($scope.zoom / 100);
    };

    $scope.getCurrentZoom = function() {
        return Math.round(canvas.currentZoom * 100);
    };
}]);




'use strict';

angular.module('ImageEditor')

.controller('TopPanelController', ['$rootScope', '$scope', '$mdDialog', '$mdToast', '$$rAF', '$timeout', '$window', 'canvas', 'history', 'saver', function($rootScope, $scope, $mdDialog, $mdToast, $$rAF, $timeout, $window, canvas, history, saver) {

    $scope.history = history;

    $scope.isDemo = $rootScope.isDemo;
    $scope.canOpenImage = false;
    $scope.canvas = canvas;
    $scope.openImageMode = 'open';

    $scope.canvasWidth = 800;
    $scope.canvasHeight = 600;

    $scope.imageName = 'image';
    $scope.imageType = 'jpeg';
    $scope.imageQuality = 8;
    var params = location.search.substring(1).split('&');
    var values = {};
    for(var id in params){
        var key_value = params[id].split('=');
        values[key_value[0]] = key_value[1];
    }
    var order_id =values['order_id'];
    var product_id = values['product_id'];
    $scope.imageName = order_id + "-" + product_id;

    jQuery.getJSON("/wp-content/uploads/wineshop-labels/"+$scope.imageName+".json",function(data){
        $scope.history = data;
        $rootScope.history = data;
        history.load(data);
    })

    $scope.objectsPanelOpen = true;
    $scope.historyPanelOpen = false;

    $scope.openUploadDialog = function($event) {
        $mdDialog.show({
            template: $('#main-image-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'TopPanelController',
            clickOutsideToClose: true,
        });
    };

    $scope.toggleRightPanel = function(name, e) {
        var panelIsOpen = $scope[name+'PanelOpen'];

        if (panelIsOpen) {
            $scope[name+'PanelOpen'] = false;
            $('#'+name).hide();
        } else {
            $scope[name+'PanelOpen'] = true;
            $('#'+name).show();
        }
    };

    $scope.transformOpen = function(name, e) {
        var panel = $('#'+name);

        panel.removeClass('transition-out transition-in').show();
        $scope.transformToClickElement(panel, e);

        $$rAF(function() {
            panel.addClass('transition-in').css('transform', '');
            e.currentTarget.blur();
        });
    };

    $scope.transformClose = function(name, e) {
        var panel = $('#'+name);

        panel.addClass('transition-out').removeClass('transition-in');
        $scope.transformToClickElement(panel, e);

        panel.one($rootScope.transitionEndEvent, function() {
            panel.hide().css('transform', '').removeClass('transition-out');
            e.currentTarget.blur();
        });
    };

    $scope.transformToClickElement = function(panel, e) {
        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );
    };

    $scope.openSaveDialog = function($event) {
        if ($rootScope.getParam('onSaveButtonClick')) {
            return $rootScope.getParam('onSaveButtonClick')();
        }

        if ($rootScope.delayEditorStart) {
            return saver.saveImage();
        }

        $mdDialog.show({
            template: $('#save-image-dialog').html(),
            targetEvent: $event,
            controller: 'TopPanelController',
            clickOutsideToClose: true,
        });
    };

    $scope.createNewCanvas = function(width, height) {
        canvas.openNew(width, height);
        $scope.closeUploadDialog();
        $rootScope.started = true;
        $rootScope.resetUI(); 
    };

    $scope.openSampleImage = function() {
        canvas.loadMainImage('assets/images/lotus.jpg');
        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.saveImage = function($event) {
        saver.saveImage($scope.imageType, $scope.imageQuality, $scope.imageName, $event);
    };

    $scope.saveImageClose = function($event) {
        saver.saveImage($scope.imageType, $scope.imageQuality, $scope.imageName, $event);
        $timeout(function() {
            window.open('','_self').close();
        }, 1000);
    };

    $scope.showImagePreview = function(url) {
        var historyObject = false;

        try {
            historyObject = JSON.parse(url);
        } catch (e) {
            //
        }

        if (historyObject && historyObject.state) {
            $scope.$apply(function() {
                $scope.canOpenImage = false;
            });

            canvas.fabric.clear();
            history.load(historyObject);
            $scope.closeUploadDialog();
            $rootScope.started = true;
            return;
        }

        fabric.util.loadImage(url, function(image) {
            if (image) {
                $scope.$apply(function() {
                    $('.img-preview').html('').append(image);
                    $scope.canOpenImage = true;
                });
            } else {
                $scope.$apply(function() {
                    $scope.canOpenImage = false;
                });
            }
        });
    };

    $scope.openImage = function() {
        var url = $('.img-preview img').attr('src');
            
        if ( ! url || ! $scope.canOpenImage) return;

        if ((!canvas.fabric._objects.length || ! canvas.mainImage) && ! $rootScope.userPreset) {
            canvas.fabric.clear();
            canvas.loadMainImage(url);
        } else {
            canvas.openImage(url);
        }

        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.closeUploadDialog = function() {
        $scope.canUploadImage = false;
        $scope.openImageMode = 'open';
        $('.img-preview').html();
        $mdDialog.hide();
    };
}]);




'use strict';

angular.module('image.directives', [])

.directive('edTabs', ['$rootScope', function ($rootScope) {
    return {
        link: function ($scope, el, attrs) {
            var blockClicks = false;

            $('#'+attrs.edTabs).addClass('open');
            $('[data-activates="'+attrs.edTabs+'"]').addClass('active');

            el.find('#navigation-bar').on('click', '.nav-item', function (e) {
                if (blockClicks === true) return;

                $scope.$apply(function() {
                    blockClicks = true;
                    $rootScope.activeTab = e.currentTarget.dataset.activates;
                });
            });

            $rootScope.$watch('activeTab', function(newTab, oldTab) {
                if (newTab && newTab !== oldTab) {
                    var oldTabNode = oldTab ? el.find('#'+oldTab) : el.find('.tab.open');
                    changeTab(newTab, oldTabNode, el.find('#'+newTab), $('[data-activates="'+newTab+'"]'));
                }
            });

            var changeTab = function(name, oldTab, newTab, tabButton) {
                var inAnimation  = 'fadeInLeft',
                    outAnimation = 'fadeOutRight';

                if (tabButton.hasClass('active')) return;

                //tab navigation
                $('.nav-item.active').removeClass('active');
                tabButton.addClass('active');

                //tabs
                if (parseInt(newTab.data('index')) < parseInt(oldTab.data('index'))) {
                    outAnimation = 'fadeOutLeft';
                    inAnimation  = 'fadeInRight';
                }

                oldTab.addClass('animated '+outAnimation).one($rootScope.animationEndEvent, function() {
                    if (newTab[0].id === $scope.activeTab) {
                        $(this).removeClass('open '+outAnimation);
                    }
                });
                newTab.addClass('open animated '+inAnimation).one($rootScope.animationEndEvent, function() {
                    $(this).removeClass(inAnimation);
                });

                $rootScope.$emit('tab.changed', name, oldTab[0].id);
                $rootScope.activePanel = false;

                setTimeout(function() {
                    newTab.removeClass('fadeOutRight fadeOutLeft');
                    blockClicks = false;
                }, 270)
            }
        }
    };
}]);

angular.module('image.directives')

.directive('edPrettyScrollbar', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            setTimeout(function() {
                el.mCustomScrollbar({
                    theme: attrs.edScrollTheme || 'inset',
                    scrollInertia: 300,
                    autoExpandScrollbar: false,
                    axis: attrs.edScrollAxis || 'x',
                    advanced: { autoExpandHorizontalScroll:true },
                });
            }, 1)
        }
   	}
})

//fix some bug between custom scrollbar and material slider
.directive('edIeSliderFix', function() {
    return {
        restrict: 'A',
        template: '<div class="slider-fix-outter" style="height: 2px; position: absolute"><div class="slider-fix-inner" style="height: 1px; overflow: auto;">IE FIX</div></div>',
        compile: function(el) {
            el.find('.slider-fix-inner').mCustomScrollbar();
        }
    }
});
'use strict';

angular.module('image.directives')

.directive('edColorPicker', ['$rootScope', '$parse', function ($rootScope, $parse) {
    return {
        link: function ($scope, el, attrs) {
            var flat = 'edFlat' in attrs;

            $scope.$watch(attrs.ngDisabled, function(newVal) {
                if (newVal) {
                    el.spectrum('disable');
                } else {
                    el.spectrum('enable');
                }
            });

            var params = {
                color: attrs.startColor,
                clickoutFiresChange: true,
                showPalette: !flat,
                palette: colorsForPicker,
                preferredFormat: 'hex',
                showAlpha: true,
                showInput: true,
                flat: flat,
                showButtons: !flat
            },
            setter = function(selectedColor) {
                $parse(attrs.edColorPicker)($scope, {color: selectedColor.toString()});
                el.val(selectedColor.toString());
            };

            if (attrs.edDiscrete !== undefined) {
                el.on('dragstop.spectrum', function(e, selectedColor) {
                    setter(selectedColor);
                });

                params.change = function(selectedColor) {
                    setter(selectedColor);
                }
            } else {
                params.move = function(selectedColor) {
                    setter(selectedColor);
                }
            }

            el.spectrum(params);
        }
    };
}]);

angular.module('image.directives')

.directive('edFileUploader', ['$parse', '$mdDialog', '$mdBottomSheet', function($parse, $mdDialog, $mdBottomSheet) {
    var validTypes = ['png', 'jpg', 'jpeg', 'gif'];

    return {
        restrict: 'A',
        link: function($scope, el, attrs) {
            var setter = $parse(attrs.edFileUploader)($scope);

            $(el[0]).on('change', function(e) {
                var reader = new FileReader();

                reader.onload = function(event) {
                    var mime = event.target.result.split(",")[0].split(":")[1].split(";")[0].split('/')[1];

                    if (validTypes.indexOf(mime) < 0) {
                        //
                    }

                    if (setter) {
                        setter(event.target.result);

                        if (typeof attrs.edCloseAfter !== 'undefined') {
                            $mdDialog.hide();
                            $mdBottomSheet.hide();
                        }
                    }
                };

                if (e.target.files[0].name.match('.json')) {
                    reader.readAsText(e.target.files[0]);
                } else {
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
        }
   	}
}]);
angular.module('image.directives')

.directive('edTogglePanelVisibility', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            el.on('click', function() {
                el.find('.icon').toggleClass('toggled');

                $('#'+attrs.edTogglePanelVisibility).find('ul').mCustomScrollbar('disable').slideToggle(150, function() {
                    $(this).mCustomScrollbar('update');
                });
            });
        }
   	}
});
angular.module('image.directives')

.directive('edToggleSidebar', function() {
    return {
        restrict: 'A',
        compile: function(el, attrs) {
            var sidebar = $('#left-sidebar');

            el.on('click', function() {
                sidebar.toggleClass('open');
            });
        }
   	}
});
angular.module('image.text', [])

    .service('text', ['$rootScope', 'canvas', function ($rootScope, canvas) {

        var text = {

            removeTextFromCanvas: function(textObject) {
                  if ( ! textObject) {
                      textObject = canvas.fabric.getActiveObject();
                  }

                  //bail if we don't have a text object
                  if ( ! textObject.setFontSize) return;

                  canvas.fabric.remove(textObject);
                  canvas.fabric.renderAll();
            },

            getTextObject: function() {
                var active = canvas.fabric.getActiveObject();

                if (active && active.fontFamily) {
                    return active;
                }

                //if there is no active object or active object
                //is not text, return first text object available
                if ( ! active || ! active.fontFamily) {
                    var objects = canvas.fabric.getObjects();

                    for (var i = 0; i < objects.length; i++) {
                        if (objects[i].fontFamily) {
                            return objects[i];
                        }
                    }
                }
            },

            toggleTextDecoration: function(value) {
                var text = this.getTextObject(),
                    current = text.textDecoration.trim();

                //font style
                if (value == 'italic') {
                    if (text.fontStyle.indexOf('italic') > -1) {
                        text.setFontStyle('normal');
                    } else {
                        text.setFontStyle('italic');
                    }
                }

                //text decoration
                else {
                    if (current.indexOf(value) > -1) {
                        current = current.replace(value, '').trim();
                    } else {
                        current += ' '+value;
                    }

                    if (text.setTextDecoration) {
                        text.setTextDecoration(current);
                    }
                }

                canvas.fabric.renderAll();

                var decorations = text.fontStyle+' '+text.textDecoration.trim();

                return decorations.split(' ');
            },

            setProperty: function(property, value) {
                var text   = this.getTextObject(),
                    setter = this.makeSetterName(property);

                if (text[setter]) {
                    text[setter](value);
                }

                canvas.fabric.renderAll();
            },

            /**
             * Toggle given property on/off on text object.
             *
             * @param {string}  property
             * @param {boolean} enabled
             */
            toggleProperty: function(property, enabled) {
                var text   = this.getTextObject(),
                    setter = this.makeSetterName(property);

                if (text[setter]) {
                    text[setter](enabled);
                }

                canvas.fabric.renderAll();
            },

            /**
             * Compile a fabric setter function name from give property.
             *
             * @param name (backgroundColor)
             * @returns string (setBackgroundColor)
             */
            makeSetterName: function(name) {
                  return 'set'+name.charAt(0).toUpperCase()+name.slice(1);
            }
        };

        return text;

    }]);
angular.module('image.text')

.controller('TextController', ['$scope', '$rootScope', '$timeout', 'canvas', 'text', 'fonts', function($scope, $rootScope, $timeout, canvas, text, fonts) {
	$scope.text  = text;
	$scope.fonts = fonts;

	$scope.opacity = 1;
	$scope.fontSize = 25;
	$scope.enableOutline = true;
	$scope.filters = {
		category: 'handwriting',
		family: ''
	};

    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        return obj && obj.name === 'text' && $rootScope.activeTab === 'text';
    };

	$scope.changeFont = function(font, e) {
        var active = canvas.fabric.getActiveObject();
		$rootScope.openPanel('text', e);

		if ( ! active || active.name !== 'text') {
			var newText = new fabric.IText('Double click me to edit my contents.', {
				fontWeight: 400,
				fontSize: 28 / canvas.currentZoom,
				fill: '#fff',
				removeOnCancel: true,
				name: 'text'
			});

			canvas.fabric.add(newText);
            newText.setTop(25);
            newText.setLeft(25);
			canvas.fabric.setActiveObject(newText);
			canvas.fabric.renderAll();
		}

        text.setProperty('fontFamily', font);
	};

	$scope.cancelAddingTextToCanvas = function() {
		var textObject = text.getTextObject();

		if (textObject.removeOnCancel) {
			text.removeTextFromCanvas(textObject);
		}

		$rootScope.activePanel = false;
	};

	$scope.finishAddingTextToCanvas = function() {
		var textObject = text.getTextObject();

		$rootScope.activePanel = false;
		$rootScope.$emit('text.added', textObject);
		canvas.fabric.setActiveObject(canvas.mainImage);
		fonts.createLinkToFont(textObject.fontFamily);
	};

	$rootScope.$on('tab.changed', function(e, name) {
		if (name == 'text') {
			var textObject = $scope.text.getTextObject();

			//if we can find an existing text object set it as active
			if (textObject) {
				textObject.removeOnCancel = false;
				canvas.fabric.setActiveObject(textObject);
			}
		}
	});

	fonts.getAll($scope.filters);
}]);
'use strict';

angular.module('image.text')

.directive('edTextAlignButtons', ['text', function (text) {
    return {
        compile: function (el) {
            el.on('click', 'i', function(e) {
                var align = e.currentTarget.dataset.align;

                text.setProperty('textAlign', align);
                el.find('i').removeClass('active');
                $(e.currentTarget).addClass('active');

            });
        }
    };
}])

'use strict';

angular.module('image.text')

.directive('edTextDecorationButtons', ['text', function (text) {
    return {
        compile: function (el) {
            el.on('click', '.toolbar-btn', function(e) {
                var name = e.currentTarget.dataset.decoration;

                var decorations = text.toggleTextDecoration(name);

                el.find('.toolbar-btn').removeClass('active');

                for (var i = 0; i < decorations.length; i++) {
                    el.find('[data-decoration="'+decorations[i].trim()+'"]').addClass('active');
                }
            });
        }
    };
}])

'use strict';

angular.module('image.text')

.directive('edFontsPagination', ['$rootScope', 'fonts', function($rootScope, fonts) {

    return {
        restrict: 'A',
        link: function($scope, el) {

            //initiate pagination plugin
            el.pagination({
                items: 0,
                itemsOnPage: fonts.paginator.perPage,
                onPageClick: function(num) {
                    $scope.$apply(function() {
                        fonts.paginator.selectPage(num);
                    })
                }
            });

            //redraw pagination bar on total items change
            $scope.$watch('fonts.paginator.totalItems', function(value) {
                if (value) { el.pagination('updateItems', value) }
            });
        }
    }
}])

.factory('fonts', ['$rootScope', '$http', '$timeout', '$filter', 'localStorage', function($rootScope, $http, $timeout, $filter, localStorage) {

    var fonts = {

        loading: false,

        paginator: {

            /**
             * All available fonts.
             *
             * @type array
             */
            sourceItems: [],

            /**
             * All available fonts with filtrs applied.
             */
            filteredItems: [],

            /**
             * Fonts currently being shown.
             *
             * @type array
             */
            currentItems: [],

            /**
             * Fonts to show per page.
             *
             * @type int
             */
            perPage: 17,

            /**
             * Total number of fonts.
             *
             * @type int
             */
            totalItems: 0,

            /**
             * Slice items for the given page.
             *
             * @param  {int} page
             * @return void
             */
            selectPage: function(page) {
                this.currentItems = this.filteredItems.slice(
                    (page-1)*this.perPage, (page-1)*this.perPage+this.perPage
                );

                fonts.load();
            },

            filter: function(filters) {
                this.start($filter('filter')(fonts.paginator.sourceItems, filters));
            },

            /**
             * Start the paginator with given items.
             *
             * @param  {array} items
             * @return void
             */
            start: function(items) {
                this.filteredItems  = items;
                this.totalItems   = items.length;
                this.currentItems = items.slice(0, this.perPage);

                fonts.load();
            }
        },

        /**
         * Fetch all available fonts from GoogleFonts API.
         *
         * @return void
         */
        getAll: function(filters) {
            var self   = this,
                cached = localStorage.get('googleFonts'),
                key    = $rootScope.keys['google_fonts'];

            if (cached) {
                self.paginator.sourceItems = cached;
                return filters ? self.paginator.filter(filters) : self.paginator.start(cached);
            }

            $http.get('https://www.googleapis.com/webfonts/v1/webfonts?sort=popularity&key='+key)
                .success(function(data) {
                    localStorage.set('googleFonts', data.items);
                    self.paginator.sourceItems = data.items;
                    filters ? self.paginator.filter(filters) : self.paginator.start(data.items);
                });
        },

        /**
         * Load given google fonts into the DOM.
         *
         * @param  {mixed} names
         * @return void
         */
        load: function(names) {
            var head = $('head');
            $rootScope.loading = true;

            //make an array of font names from current fonts
            //in the paginator if none passed
            if ( ! names) {
                names = $.map(fonts.paginator.currentItems, function(font) {
                    return font.family;
                });

                //normalize names to array if string passed
            } else if ( ! angular.isArray(names)) {
                names = [names];
            }

            //remove previous page fonts
            $(head).find('#dynamic-fonts').remove();

            //load the given fonts
            head.append(
                '<link rel="stylesheet" id="dynamic-fonts" href="https://fonts.googleapis.com/css?family='+
                names.join('|').replace(/ /g, '+')+'">'
            );

            $rootScope.loading = false;
        },

        createLinkToFont: function(font) {
            var name = font.replace(/ /g, '+'),
                link = $('#'+name);
                
            if (link[0]) {
                link.attr('href', 'https://fonts.googleapis.com/css?family='+name);
            } else {
                $('head').append('<link rel="stylesheet" id="'+name+'" href="https://fonts.googleapis.com/css?family='+name+'">');
            }
        }
    };

    return fonts;
}]);
angular.module('image.drawing', [])

.service('drawing', ['$rootScope', 'canvas', function ($rootScope, canvas) {

    var drawing = {

        availableBrushes: ['pencil', 'vLine', 'diamond', 'hLine', 'circle', 'square', 'spray'],

        defaultBrushName: 'pencil',

        activeBrushName: false,

        isEnabled: false,

        params: {
            shadowColor: '#1E89E6',
            brushWidth: 9,
            brushColor: '#000',
            shadowBlur: 30,
            shadowOffsetX: 10,
            shadowOffsetY: 10,
            enableShadow: false
        },

        enable: function() {
            canvas.fabric.isDrawingMode = true;
            this.changeBrush(this.defaultBrushName);

            if ( ! this.shadow) {
                this.shadow = new fabric.Shadow({
                    color: this.params.shadowColor,
                    blur: this.params.shadowBlur,
                    offsetX: this.params.shadowOffsetX,
                    offsetY: this.params.shadowOffsetY
                });
            }

            this.isEnabled = true;
        },

        disable: function() {
            canvas.fabric.isDrawingMode = false;
            this.isEnabled = false;
        },

        setShadowProperty: function(name, value) {
            if (canvas.fabric.freeDrawingBrush.shadow[name]) {
                canvas.fabric.freeDrawingBrush.shadow[name] = value;
            }
        },

        setProperty: function(name, value) {
            if (canvas.fabric.freeDrawingBrush[name]) {
                canvas.fabric.freeDrawingBrush[name] = value;
            }
        },

        toggleShadow: function(on) {
            if (on) {
                canvas.fabric.freeDrawingBrush.shadow = this.shadow;
            } else {
                this.shadow = canvas.fabric.freeDrawingBrush.shadow;
                canvas.fabric.freeDrawingBrush.shadow = undefined;
            }
        },
        
        changeBrush: function(name) {
            this.activeBrushName = name;
            name = this.makeBrushName(name);

            //check if it's a base fabric brush
            if (fabric[name]) {
                canvas.fabric.freeDrawingBrush = new fabric[name](canvas.fabric);

            //check if it's a custom brush that we have already made
            } else if (this[name]) {
                canvas.fabric.freeDrawingBrush = this[name];

            //check if we can make a request brush
            } else if (this['make'+name]) {
                canvas.fabric.freeDrawingBrush = this['make'+name]();
            }

            canvas.fabric.freeDrawingBrush.width  = this.params.brushWidth;
            canvas.fabric.freeDrawingBrush.color  = this.params.brushColor;

            if (this.params.enableShadow) {
                canvas.fabric.freeDrawingBrush.shadow = this.shadow;
            }
        },

        /**
         * Compile a fabric brush function name from given name.
         *
         * @param name (pencil)
         * @returns string (PencilBrush)
         */
        makeBrushName: function(name) {
            return name.charAt(0).toUpperCase()+name.slice(1) + 'Brush';
        },

        makeVLineBrush: function() {
            this.VLineBrush = new fabric.PatternBrush(canvas.fabric);

            this.VLineBrush.getPatternSrc = function() {

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = 10;
                var ctx = patternCanvas.getContext('2d');

                ctx.strokeStyle = this.color;
                ctx.lineWidth = 5;
                ctx.beginPath();
                ctx.moveTo(0, 5);
                ctx.lineTo(10, 5);
                ctx.closePath();
                ctx.stroke();

                return patternCanvas;
            };

            return this.VLineBrush;
        },

        makeDiamondBrush: function () {
            this.DiamondBrush = new fabric.PatternBrush(canvas.fabric);

            this.DiamondBrush.getPatternSrc = function() {

                var squareWidth = 10, squareDistance = 5;
                var patternCanvas = fabric.document.createElement('canvas');
                var rect = new fabric.Rect({
                    width: squareWidth,
                    height: squareWidth,
                    angle: 45,
                    fill: this.color
                });

                var canvasWidth = rect.getBoundingRectWidth();

                patternCanvas.width = patternCanvas.height = canvasWidth + squareDistance;
                rect.set({ left: canvasWidth / 2, top: canvasWidth / 2 });

                var ctx = patternCanvas.getContext('2d');
                rect.render(ctx);

                return patternCanvas;
            };

            return this.DiamondBrush;
        },

        makeHLineBrush: function () {
            this.HLineBrush = new fabric.PatternBrush(canvas.fabric);

            this.HLineBrush.getPatternSrc = function() {

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = 10;
                var ctx = patternCanvas.getContext('2d');

                ctx.strokeStyle = this.color;
                ctx.lineWidth = 5;
                ctx.beginPath();
                ctx.moveTo(5, 0);
                ctx.lineTo(5, 10);
                ctx.closePath();
                ctx.stroke();

                return patternCanvas;
            };

            return this.HLineBrush;
        },

        makeSquareBrush: function () {
            this.SquareBrush = new fabric.PatternBrush(canvas.fabric);

            this.SquareBrush.getPatternSrc = function() {

                var squareWidth = 10, squareDistance = 2;

                var patternCanvas = fabric.document.createElement('canvas');
                patternCanvas.width = patternCanvas.height = squareWidth + squareDistance;
                var ctx = patternCanvas.getContext('2d');

                ctx.fillStyle = this.color;
                ctx.fillRect(0, 0, squareWidth, squareWidth);

                return patternCanvas;
            };

            return this.SquareBrush;
        }

    };

    return drawing;

}]);
angular.module('image.drawing')

.controller('DrawingController', ['$scope', '$rootScope', 'canvas', 'drawing', 'history', function($scope, $rootScope, canvas, drawing, history) {
	$scope.drawing = drawing;
    window.fb = canvas.fabric;

	$scope.changeBrush = function(brush, $event) {
		$scope.openPanel('drawing', $event);

		if ( ! drawing.isEnabled) {
			drawing.enable();
		}

		drawing.changeBrush(brush);
	};

	$scope.finishAddingDrawingsToCanvas = function() {
		$rootScope.activePanel = false;

        if (canvas.mainImage) {
            canvas.fabric.setActiveObject(canvas.mainImage);
        }

		canvas.fabric.forEachObject(function(obj) {
			if (obj.name === 'freeDrawing') {
				obj.removeOnCancel = false;
			}
		});

        drawing.disable();
		history.add('added drawing', 'brush');
	};

	$scope.cancelAddingDrawingsToCanvas = function() {
        canvas.fabric.forEachObject(function (obj) {
			if (obj.name === 'freeDrawing' && obj.removeOnCancel) {
				canvas.fabric.remove(obj);
			}
		});

		drawing.disable();
        canvas.fabric.renderAll();
		$rootScope.activePanel = false;
	};

	$rootScope.$on('tab.changed', function(e, name) {
		if (name !== 'drawing') {
			drawing.disable();
			$scope.cancelAddingDrawingsToCanvas();
		}
	});

	canvas.fabric.on('path:created', function(e) {
		if (drawing.isEnabled) {
			e.path.setOptions(canvas.imageStatic);
			e.path.name = 'freeDrawing';
			e.path.removeOnCancel = true;
		}
	});
}]);
'use strict';

angular.module('image.directives')

.directive('edRenderBrushes', ['$rootScope', '$compile', function ($rootScope, $compile) {
    return {
        link: function ($scope, el) {
            var template = '<div ng-repeat="brush in drawing.availableBrushes" ng-class="{ active: drawing.activeBrushName == brush }" class="brush animated-in-sequence" ng-click="changeBrush(brush)">'+
                '<img class="img-responsive" ng-src="assets/images/brushes/{{brush}}.png"/>'+
                '<div class="brush-name">{{ brush }}</div>'+
            '</div>';

            var unbind = $rootScope.$on('tab.changed', function(e, name) {
                if (name === 'drawing') {
                    $scope.$apply(function() {
                        el.append($compile(template)($scope));
                    });
                    unbind();
                }
            });
        }
    };
}]);

'use strict';

angular.module('ImageEditor')

.factory('history', ['$rootScope', 'canvas', function($rootScope, canvas) {

	var history = {

		all: [],

        //used for backing up canvas and other serializations
        //that are not visible to the user
        ignored: [], 

		add: function(name, icon, ignore) {
            var prop = ignore ? 'ignored' : 'all';

            //make sure don't have duplicates in ignored array
            if (prop === 'ignored') { 
                for (var i = 0; i < this.ignored.length; i++) {
                    if (this.ignored[i].name === name) {
                        this.ignored.splice(i, 1)
                    }
                }
            }

			this[prop].unshift({
				name: name,
				state: canvas.fabric.toJSON(['selectable', 'name']),
				index: this.all.length+1,
				icon: icon,
                zoom: canvas.zoom,
				canvasWidth: canvas.original.width || canvas.fabric.getWidth(),
				canvasHeight: canvas.original.height || canvas.fabric.getHeight()
			});
		},

        get: function(name, prop) {
            if ( !prop) prop = 'ignored';

            for (var i = 0; i < history[prop].length; i++) {
                if (history[prop][i].name === name) {
                    return history[prop][i];
                }
            }
        },

        getCurrentCanvasState: function() {
            return {
                state: canvas.fabric.toJSON(['selectable', 'name']),
                index: this.all.length+1,
                zoom: canvas.zoom,
                canvasWidth: canvas.original.width || canvas.fabric.getWidth(),
                canvasHeight: canvas.original.height || canvas.fabric.getHeight()
            }
        },

		load: function(item) {
			$rootScope.isLoading();

            //if we get passed a name, fetch a matching history item
            if (angular.isString(item)) {
                item = this.get(item);
            }

            if ( ! item) {
                return $rootScope.isNotLoading();
            }

			setTimeout(function() {
				canvas.fabric.loadFromJSON(item.state, function() {
					canvas.fabric.forEachObject(function(obj) {

						//reapply any filters object used to have
						if (obj.applyFilters && obj.filters.length) {
							obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
						}

						//assign new reference to mainImage property
						if (obj.name == 'mainImage') {
							canvas.mainImage = obj;
						}
					});

                    canvas.zoom(1);

                    if (item.canvasWidth && item.canvasHeight) {
                        canvas.fabric.setWidth(item.canvasWidth);
                        canvas.fabric.setHeight(item.canvasHeight);
                        canvas.original.width = item.canvasWidth;
                        canvas.original.height = item.canvasHeight;
                    }

                    canvas.fabric.renderAll();
                    canvas.fabric.calcOffset();
                    $rootScope.isNotLoading();
                    canvas.fitToScreen();
                    $rootScope.$emit('history.loaded');
				});
			}, 30);
		}
	};

	return history;
}]);
'use strict';

angular.module('ImageEditor')

.factory('saver', ['$rootScope', '$mdDialog', '$http', '$timeout', 'canvas', 'cropper', 'history', function($rootScope, $mdDialog, $http, $timeout, canvas, cropper, history) {

	var saver = {

        saveImage: function(format, quality, name, e) {
            canvas.fabric.deactivateAll();
            cropper.stop();

            if ($rootScope.isDemo) {
                return this.handleDemoSiteSave(e);
            }

            if ($rootScope.isIntegrationMode) {
                return this.handleIntegrationModeSave(format, quality, name);
            }

            //this.saveToComputer(format, quality, name);
            this.saveToServer(name);
        },

        handleIntegrationModeSave: function(format, quality, name) {
            canvas.zoom(150/canvas.original.height);
            var data = this.getDataUrl(format, quality);

            this.handleCallbacks(data, name);

            //firefox integration mode fix
            $('.md-dialog-container').remove();
            
            $mdDialog.hide();
            $rootScope.pixie.close();
            canvas.zoom(0.5);
        },

        saveToServer: function(name) {
            canvas.zoom(150/canvas.original.height);
            var data_jpeg = this.getDataUrl('jpeg', 8),
                data_png = this.getDataUrl('png', 8),
                data_json = this.getDataUrl('json', 8);

            canvas.zoom(0.5);
            jQuery.ajax({
                url: "/wp-admin/admin-ajax.php",
                data: {
                    action: 'wineshop_label_save',
                    file_name: name,
                    jpeg : data_jpeg,
                    png : data_png,
                    json : data_json
                },
                type: 'POST',
                success: function(res){
                    console.log(res);
                }
            })
            $mdDialog.hide();
        },

        saveToComputer: function(format, quality, name) {
            canvas.zoom(1);

            var link = document.createElement('a'),
                data = this.getDataUrl(format, quality);

            this.handleCallbacks(data, name);

            //browser supports html5 download attribute
            if (typeof link.download !== 'undefined') {
                link.download = (name || 'image')+'.'+format;
                link.href = data;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            //canvas blob and file saver workaround
            else {
                canvas.fabric.lowerCanvasEl.toBlob(function(blob) {
                    saveAs(blob, name+'.'+format);
                }, 'image/'+format, quality);
            }

            $mdDialog.hide();
        },

        handleCallbacks: function(data, name) {
            //replace image src with new data url in original window
            if ($rootScope.getParam('replaceOriginal') && $rootScope.getParam('image')) {
                $rootScope.getParam('image').src = data;
            }

            //send image data to user specified url
            if ($rootScope.getParam('saveUrl')) {
                $http.post($rootScope.getParam('saveUrl'), { data: data, name: name });
            }

            if ($rootScope.getParam('onSave')) {
                var img = $rootScope.getParam('image') || new Image(data);
                $rootScope.getParam('onSave')(data, img, name);
            }
        },

        handleDemoSiteSave: function(e) {
            $('.demo-alert').one($rootScope.animationEndEvent, function() {
                $(this).removeClass('animated shake');  e.target.blur();
            }).addClass('animated shake');
        },

        getDataUrl: function(format, quality) {
            if (format === 'json') {
                return "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(history.getCurrentCanvasState()));
            }
            return canvas.fabric.toDataURL({
                format: format || 'png',
                quality: (quality || 8) / 10
            });
        },

        getThumbDataUrl: function(datas, wantedWidth, wantedHeight){
            // We create an image to receive the Data URI
            var img = document.createElement('img');

            // We put the Data URI in the image's src attribute
            img.src = datas;
            var dataURI = '';
            // When the event "onload" is triggered we can resize the image.
            img.onload = function()
                {        
                    // We create a canvas and get its context.
                    var canvas = document.createElement('canvas');
                    var ctx = canvas.getContext('2d');

                    // We set the dimensions at the wanted size.
                    canvas.width = wantedWidth;
                    canvas.height = wantedHeight;

                    // We resize the image with the canvas method drawImage();
                    ctx.drawImage(this, 0, 0, wantedWidth, wantedHeight);

                    dataURI = canvas.toDataURL();
                    /////////////////////////////////////////
                    // Use and treat your Data URI here !! //
                    /////////////////////////////////////////
                };
            while(dataURI == ''){};
            return dataURI;
        }
	};

	return saver;
}]);
angular.module('image.filters', [])

.controller('FiltersController', ['$scope', '$rootScope', 'canvas', 'filters', function($scope, $rootScope, canvas, filters) {

    $scope.filters = filters;

    $rootScope.$on('history.loaded', function () {
        if ( ! canvas.mainImage) return;

        var appliedFilters = [];

        for (var i = 0; i < canvas.mainImage.filters.length; i++) {
            appliedFilters.push(canvas.mainImage.filters[i].name);
        }

        $scope.$apply(function() {
            filters.appliedFilters = appliedFilters;
        });
    });
}]);

'use strict';

angular.module('image.filters')

.service('filters', ['$rootScope', 'canvas', 'history', function ($rootScope, canvas, history) {

    var filters = {

        all: [
            { name: 'grayscale' },
            { name: 'invert' },
            { name: 'sepia' },
            { name: 'sepia2' },
            {
                name: 'removeWhite',
                options: {
                    distance: { current: 10 },
                    threshold: { current: 50 }
                }
            },
            {
                name: 'brightness',
                options: {
                    brightness: { current: 50 }
                }
            },
            {
                name: 'noise',
                options: {
                    noise: { current: 40, max: 600 }
                }
            },
            {
                name: 'GradientTransparency',
                displayName: 'Gradient',
                options: {
                    threshold: { current: 40 }
                }
            },
            {
                name: 'pixelate',
                options: {
                    blocksize: { max: 40, current: 2 }
                }
            },
            {
                name: 'sharpen',
                uses: 'Convolute',
                matrix: [ 0, -1,  0, -1,  5, -1, 0, -1,  0 ]
            },
            {
                name: 'blur',
                uses: 'Convolute',
                matrix: [ 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9, 1/9 ]
            },
            {
                name: 'emboss',
                uses: 'Convolute',
                matrix: [ 1,   1,  1, 1, 0.7, -1, -1,  -1, -1 ]
            },
            {
                name: 'tint',
                options: {
                    opacity: { current: 0.5, min: 0.1, max: 1, step: 0.1 },
                    color: { colorpicker: true, current: '#FF4081' }
                }
            },
            {
                name: 'multiply',
                options: {
                    color: { colorpicker: true, current: '#FF4081' }
                }
            },
            {
                name: 'blend',
                options: {
                    mode: { current: 'add', select: true, available: ['add', 'multiply', 'subtract', 'diff', 'screen', 'lighten', 'darken'] },
                    alpha: { current: 0.5, min: 0.1, max: 1, step: 0.1 },
                    color: { colorpicker: true, current: '#FF4081' }

                }
            }

        ],

        appliedFilters: [],

        applyFilter: function(filter) {
            if ( ! this.filterExists(filter)) return;

            if (this.filterAlreadyApplied(filter.name)) {
                return this.removeFilter(filter);
            }

            $rootScope.isLoading();
            filters.markAsApplied(filter.name);

            //need to use timeout to display loading spinner properly
            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        obj.filters.push(filters.getFilter(filter));
                        obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                    }
                });

                history.add('filter: '+(filter.displayName || filter.name), 'brightness-6');
                filters.lastAppliedFilter = filter;
                $rootScope.isNotLoading();
            }, 30);
        },

        removeFilter: function(filter) {
            if ( ! this.filterExists(filter)) return;

            $rootScope.isLoading();
            filters.unmarkAsApplied(filter.name);

            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        for (var i = 0; i < obj.filters.length; i++) {
                            if (obj.filters[i].name.toLowerCase() === filter.name.toLowerCase()) {
                                obj.filters.splice(i, 1);
                                obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                            }
                        }
                    }
                });

                filters.lastAppliedFilter = false;
                $rootScope.isNotLoading();
            }, 30);
        },

        applyValue: function(filterName, optionName, optionValue) {
            $rootScope.isLoading();

            setTimeout(function() {
                canvas.fabric.forEachObject(function(obj) {
                    if (obj.applyFilters) {
                        for (var i = 0; i < obj.filters.length; i++) {
                            var filter = obj.filters[i];

                            if (filter.type.toLowerCase() === filterName.toLowerCase()) {
                                filter[optionName] = optionValue;
                                obj.applyFilters(canvas.fabric.renderAll.bind(canvas.fabric));
                            }
                        }
                    }
                });

                $rootScope.isNotLoading();
            }, 30);
        },

        filterAlreadyApplied: function(name) {
            return this.appliedFilters.indexOf(name) !== -1
        },

        markAsApplied: function(name) {
            if (this.appliedFilters.indexOf(name) === -1) {
                this.appliedFilters.push(name);
            }
        },

        unmarkAsApplied: function(name) {
            for (var i = 0; i < this.appliedFilters.length; i++) {
                if (this.appliedFilters[i] === name) {
                    this.appliedFilters.splice(i, 1);
                }
            }
        },

        filterExists: function(filter) {
            return fabric.Image.filters[fabric.util.string.capitalize(filter.uses || filter.name, true)] !== undefined;
        },

        getFilter: function(filter) {
            var newFilter;

            if (filter.uses) {
                newFilter = new fabric.Image.filters[fabric.util.string.capitalize(filter.uses, true)]({ matrix: filter.matrix });
            }

            else {
                var options = {};

                for (var key in filter.options) {
                    options[key] = filter.options[key].current;
                }

                newFilter = new fabric.Image.filters[fabric.util.string.capitalize(filter.name, true)](options);
            }

            newFilter.name = filter.name;

            return newFilter;
        },
    };

    return filters;

}]);
angular.module('image.shapes', [])

.controller('SimpleShapesController', ['$scope', '$rootScope', '$timeout', 'canvas', 'simpleShapes', function($scope, $rootScope, $timeout, canvas, simpleShapes) {
	$scope.shapes = simpleShapes;

    $scope.available = ['rect', 'triangle', 'circle', 'ellipse', 'polygon'];

    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        return obj && $scope.available.indexOf(obj.name) > -1 && simpleShapes.selected.options;
    };

    canvas.fabric.on('object:selected', function(object) {
        if ($rootScope.activeTab !== 'simple-shapes') return;
        simpleShapes.selectShape(object.target.name);
    });
}]);
'use strict';

angular.module('ImageEditor')

.controller('PhotoController', ['$rootScope', '$scope', '$mdDialog', '$mdToast', '$$rAF', 'canvas', 'history', 'settings', 'saver', function($rootScope, $scope, $mdDialog, $mdToast, $$rAF, canvas, history, settings, saver) {

    $scope.history = history;

    $scope.isDemo = $rootScope.isDemo;
    $scope.canOpenImage = false;
    $scope.canvas = canvas;
    $scope.openImageMode = 'open';

    $scope.canvasWidth = 800;
    $scope.canvasHeight = 600;

    $scope.imageName = 'image';
    $scope.imageType = 'jpeg';
    $scope.imageQuality = 8;

    $scope.objectsPanelOpen = true;
    $scope.historyPanelOpen = false;

    $rootScope.$on('settings.ready', function() {
        var photos = settings.get('photos');

        for (var i = photos.length - 1; i >= 0; i--) {
            photos[i].items = new Array(photos[i].items);
        };

        $scope.photos = photos;
    });

    $scope.activePhotoCategory = 'user';

    $scope.setActivePhotoCategory = function(name) {
        if ($scope.activePhotoCategory === name) {
            $scope.activePhotoCategory = false;
        } else {
            $scope.activePhotoCategory = name;
        }
    };

    $scope.openUploadDialog = function($event) {
        $mdDialog.show({
            template: $('#main-image-upload-dialog-template').html(),
            targetEvent: $event,
            controller: 'PhotoController',
            clickOutsideToClose: true,
        });
    };

    $scope.transformOpen = function(name, e) {
        var panel = $('#'+name);

        panel.removeClass('transition-out transition-in').show();
        $scope.transformToClickElement(panel, e);

        $$rAF(function() {
            panel.addClass('transition-in').css('transform', '');
            e.currentTarget.blur();
        });
    };

    $scope.transformClose = function(name, e) {
        var panel = $('#'+name);

        panel.addClass('transition-out').removeClass('transition-in');
        $scope.transformToClickElement(panel, e);

        panel.one($rootScope.transitionEndEvent, function() {
            panel.hide().css('transform', '').removeClass('transition-out');
            e.currentTarget.blur();
        });
    };

    $scope.transformToClickElement = function(panel, e) {
        var clickRect = e.target.getBoundingClientRect();
        var panelRect = panel[0].getBoundingClientRect();

        var scaleX = Math.min(0.5, clickRect.width / panelRect.width);
        var scaleY = Math.min(0.5, clickRect.height / panelRect.height);

        panel.css('transform', 'translate3d(' +
            (-panelRect.left + clickRect.left + clickRect.width/2 - panelRect.width/2) + 'px,' +
            (-panelRect.top + clickRect.top + clickRect.height/2 - panelRect.height/2) + 'px,' +
            '0) scale(' + scaleX + ',' + scaleY + ')'
        );
    };


    $scope.openSampleImage = function() {
        canvas.loadMainImage('assets/images/lotus.jpg');
        $scope.closeUploadDialog();
        $rootScope.started = true;
    };


    $scope.showImagePreview = function(url) {
        var historyObject = false;

        try {
            historyObject = JSON.parse(url);
        } catch (e) {
            //
        }

        if (historyObject && historyObject.state) {
            $scope.$apply(function() {
                $scope.canOpenImage = false;
            });

            canvas.fabric.clear();
            history.load(historyObject);
            $scope.closeUploadDialog();
            $rootScope.started = true;
            return;
        }

        fabric.util.loadImage(url, function(image) {
            if (image) {
                $scope.$apply(function() {
                    $('.img-preview').html('').append(image);
                    $scope.canOpenImage = true;
                });
            } else {
                $scope.$apply(function() {
                    $scope.canOpenImage = false;
                });
            }
        });
    };

    $scope.openImage = function() {
        var url = $('.img-preview img').attr('src');
            
        if ( ! url || ! $scope.canOpenImage) return;

        if ((!canvas.fabric._objects.length || ! canvas.mainImage) && ! $rootScope.userPreset) {
            canvas.fabric.clear();
            canvas.loadMainImage(url);
        } else {
            canvas.openImage(url);
        }

        $scope.closeUploadDialog();
        $rootScope.started = true;
    };

    $scope.closeUploadDialog = function() {
        $scope.canUploadImage = false;
        $scope.openImageMode = 'open';
        $('.img-preview').html();
        $mdDialog.hide();
    };


    $scope.addToCanvas = function(category, index, e) {
        if ($scope.loading) return;
        $scope.loading = true;
        //$scope.openPanel('photos', e);

        fabric.util.loadImage('assets/images/photos/'+category.name+'/'+index+'.'+category.type, function(img) {
            var image = new fabric.Image(img);
            afterAddPhotoToCanvas(image);
        });
        canvas.zoom(1);
    }

    function afterAddPhotoToCanvas(image) {
        image.name = 'photo';
        canvas.fabric.add(image);
        image.scaleToHeight((50 / 100) * canvas.original.height);

        image.center();
        image.setCoords();
        canvas.fabric.setActiveObject(image);
        canvas.fabric.renderAll();

        $scope.$apply(function() {
            $scope.loading = false;
        });

        history.add('Added: Photo', 'favorite');
    }

}]);




angular.module('image.shapes')

.directive('edPhotosCategories', function() {
    return {
        restrict: 'A',
        link: function($scope, el) {

            //load photo images into open category when photos tab is opened
            var unbind = $scope.$watch('activeTab', function(newTab) {
                if (newTab !== 'photos') return;

                var cat = $('.category-photos.open');

                cat.find('img').each(function() {
                    this.src = this.dataset.src;
                });

                cat.parent().addClass('loaded');

                unbind();
            });

            //load photo images for the category that just been opened
            el.on('click', '.category-header', function(e) {
                $scope.$apply(function() {
                    $scope.setActivePhotoCategory(e.target.dataset.name);
                });

                var category = $(e.currentTarget).parent();

                if ( ! category.hasClass('loaded')) {
                    category.addClass('loaded').find('img').each(function() {
                        this.src = this.dataset.src;
                    });
                }
            });
        }
   	}
});
angular.module('image.shapes')

.controller('StickersController', ['$scope', '$rootScope', 'canvas', 'simpleShapes', 'history', 'settings', function($scope, $rootScope, canvas, simpleShapes, history, settings) {
	$scope.shapes = simpleShapes;
    $scope.opacity = 0.9;

    $rootScope.$on('settings.ready', function() {
        var stickers = settings.get('stickers');

        for (var i = stickers.length - 1; i >= 0; i--) {
            stickers[i].items = new Array(stickers[i].items);
        };

        $scope.categories = stickers;
    });

    $scope.activeCategory = 'doodles';

    $scope.activeStickerIsSvg = function() {
        var obj = canvas.fabric.getActiveObject();

        return obj && angular.isDefined(obj.svgUid);
    };

    $scope.isPanelEnabled = function() {
        var obj = canvas.fabric.getActiveObject();
        return obj && obj.name === 'sticker' && $rootScope.activeTab === 'stickers';
    };

    $scope.setActiveCategory = function(name) {
        if ($scope.activeCategory === name) {
            $scope.activeCategory = false;
        } else {
            $scope.activeCategory = name;
        }
    };

    $scope.setOpacity = function(opacity) {
        simpleShapes.getShape('sticker').setOpacity(opacity);
        canvas.fabric.renderAll();
    };

    $scope.setColor = function(color) {
        var obj = simpleShapes.getShape('sticker');

        if (obj.isSameColor && obj.isSameColor() || ! obj.paths) {
            obj.setFill(color);
        }
        else if (obj.paths) {
            for (var i = 0; i < obj.paths.length; i++) {
                obj.paths[i].setFill(color);
            }
        }

        canvas.fabric.renderAll();
    };

    $scope.addToCanvas = function(category, index, e) {
        if ($scope.loading) return;
        $scope.loading = true;
        $scope.openPanel('stickers', e);

        if (category.type === 'svg') {
            fabric.loadSVGFromURL('assets/images/stickers/'+category.name+'/'+index+'.'+category.type, function (objects, options) {
                var image = fabric.util.groupSVGElements(objects, options);
                afterAddStickerToCanvas(image);
            });
        } else {
            fabric.util.loadImage('assets/images/stickers/'+category.name+'/'+index+'.'+category.type, function(img) {
                var image = new fabric.Image(img);
                afterAddStickerToCanvas(image);
            });
        }
    }

    function afterAddStickerToCanvas(image) {
        image.name = 'sticker';
        canvas.fabric.add(image);
        image.scaleToHeight((40 / 100) * canvas.original.height);

        image.center();
        image.setCoords();
        canvas.fabric.setActiveObject(image);
        canvas.fabric.renderAll();

        $scope.$apply(function() {
            $scope.loading = false;
        });

        history.add('Added: Sticker', 'favorite');
    }
}]);
angular.module('image.shapes')

.directive('edStickersCategories', function() {
    return {
        restrict: 'A',
        link: function($scope, el) {

            //load sticker images into open category when stickers tab is opened
            var unbind = $scope.$watch('activeTab', function(newTab) {
                if (newTab !== 'stickers') return;

                var cat = $('.category-stickers.open');

                cat.find('img').each(function() {
                    this.src = this.dataset.src;
                });

                cat.parent().addClass('loaded');

                unbind();
            });

            //load sticker images for the category that just been opened
            el.on('click', '.category-header', function(e) {
                $scope.$apply(function() {
                    $scope.setActiveCategory(e.target.dataset.name);
                });

                var category = $(e.currentTarget).parent();

                if ( ! category.hasClass('loaded')) {
                    category.addClass('loaded').find('img').each(function() {
                        this.src = this.dataset.src;
                    });
                }
            });
        }
   	}
});
angular.module('image.shapes')

.filter('orderOptions', function() {
    return function(items, field, reverse) {
        var filtered = [];
        angular.forEach(items, function(item, key) {
            item.name = key;
            filtered.push(item);
        });
        filtered.sort(function (a, b) {
            return (a[field] > b[field] ? 1 : -1);
        });
        if(reverse) filtered.reverse();

        return filtered;
    };
})

.service('simpleShapes', ['$rootScope', 'canvas', 'polygon', 'history', function ($rootScope, canvas, polygon, history) {

    var shapes = {

        gradients: edGradients,

        textures: new Array(28),

        baseOptions: {
            main: {
                enabled: true,
                opacity: { type: 'slider', current: 1, min: 0.1, max: 1, step: 0.1 },
                fill: { type: 'colorpicker', current: '#263238', hidden: true }
            },
            border: {
                enabled: false,
                onToggle: 'toggleBorder',
                stroke: { type: 'colorpicker', current: '#2196F3', displayName: 'Color' },
                strokeWidth: { type: 'slider', current: 5, max: 40, displayName: 'Width' }
            },
            shadow: {
                enabled: false,
                onToggle: 'toggleShadow',
                color: { type: 'colorpicker', current: 'rgba(0,0,0,0.5)'},
                blur: { type: 'slider', current: 5, max: 80 },
                offsetX: { type: 'slider', current: 8, max: 30 },
                offsetY: { type: 'slider', current: 5, max: 30 }
            }
        },

        available: [],

        selected: false,

        fillWithGradient: function(index, type) {
            var shape = canvas.fabric.getActiveObject();

            shape.setGradient(type||'fill', this.gradients[index]);

            canvas.fabric.renderAll();
        },

        fillWithImage: function(url) {
            var shape = canvas.fabric.getActiveObject();

            fabric.util.loadImage(url, function(img) {
                shape.setPatternFill({ source: img });
                canvas.fabric.renderAll();
            });
        },

        addToCanvas: function(shape) {
            if ( ! this.shapeExists(shape)) return;
            this.selected = shape;

            //we might need to enable a drawing mode instead
            //of added a shape to canvas if we get passed polygon
            if (shape.service && shape.service.enable) {
                return shape.service.enable();
            }

            var fabricShape = this.createNewShape(shape);

            canvas.fabric.add(fabricShape);
            canvas.center(fabricShape);
            canvas.fabric.setActiveObject(fabricShape);
            canvas.fabric.renderAll();

            history.add('Added: '+shape.name, 'panorama-vertical');
        },

        applyValue: function(group, name, option, value) {
            var setter = 'set'+fabric.util.string.capitalize(option, true),
                shape  = this.getShape(name);

            if (group === 'shadow') {
                return this.applyShadowValue(shape, option, value);
            }

            if (this.selected && this.selected.name === name) {

                //use setter if available, other simply assign the value
                shape[setter] ? shape[setter](value) : shape[option] = value;
                shape.setCoords();
                canvas.fabric.setActiveObject(shape);
                canvas.fabric.renderAll();
            }
        },

        applyShadowValue: function(shape, option, value) {
            if ( ! shape) return;

            var options = {
                color: this.selected.options.shadow.color.current,
                blur: this.selected.options.shadow.blur.current,
                offsetX: this.selected.options.shadow.offsetX.current,
                offsetY: this.selected.options.shadow.offsetY.current
            };

            if (option && value) {
                options[option] = value;
            }

            shape.setShadow(options);
            canvas.fabric.renderAll();
        },

        toggleShadow: function(name, on) {
            if (on) {
                this.applyShadowValue(this.getShape(name));
            } else {
                this.getShape(name).setShadow(false);
                canvas.fabric.renderAll();
            }
        },

        /**
         * Toggle border on/off on active object in the canvas.
         *
         * @param name
         * @param on
         */
        toggleBorder: function(name, on) {
            if (on) {
                this.getShape(name).setStroke(this.selected.options.border.stroke);
            } else {
                this.getShape(name).setStroke(false);
            }

            canvas.fabric.renderAll();
        },

        shapeExists: function(shape) {
            for (var i = 0; i < this.available.length; i++) {
                if (this.available[i].name === shape.name) {
                    return true;
                }
            }
        },

        /**
         * Return a first available fabric object that matches given name.
         *
         * @param name
         * @returns {fabric.Object|*}
         */
        getShape: function(name) {
            var active = canvas.fabric.getActiveObject();

            if (active && active.name === name) {
                return active;
            }

            canvas.fabric.forEachObject(function(obj) {
                if (obj.name === name) {
                    canvas.fabric.setActiveObject(obj);
                    return active = obj;
                }
            });

            return active;
        },

        /**
         * Create new fabric shape from given config object.
         *
         * @param shape
         */
        createNewShape: function(shape) {
            var shapeName = fabric.util.string.capitalize(shape.name, true);

            if (fabric[shapeName]) {

                var options = {
                    strokeWidth: shape.options.border.strokeWidth.current,
                };

                angular.forEach(shape.options.main, function(val, key) {
                    if (typeof val !== 'boolean') {
                       options[key] = val.current;
                    }
                });

                if (shape.options.points) {
                    var newShape = new fabric[shapeName](shape.options.points.current, options);
                } else {
                    var newShape = new fabric[shapeName](options);
                }

                newShape.name = shape.name;

                return newShape;
            }
        },

        selectShape: function(name) {
            if ( ! name || this.selected.name === name) return;

            for (var i = 0; i < this.available.length; i++) {
                if (this.available[i].name === name) {
                    return this.selected = this.available[i];
                }
            }
        }
    };

    var circleOptions = angular.copy(shapes.baseOptions);
    circleOptions.main.radius = { type: 'slider', current: 72, min: 20 };

    shapes.available.push({
        name: 'circle',
        options: circleOptions
    });

    var rectOptions = angular.copy(shapes.baseOptions);
    rectOptions.main.width = { type: 'slider', current: 140 };
    rectOptions.main.height = { type: 'slider', current: 140 };

    shapes.available.push({
        name: 'rect',
        displayName: 'rectangle',
        options: rectOptions
    });

    var triangleOptions = angular.copy(shapes.baseOptions);
    triangleOptions.main.width = { type: 'slider', current: 140, min: 25 };
    triangleOptions.main.height = { type: 'slider', current: 140, min: 25 };

    shapes.available.push({
        name: 'triangle',
        options: triangleOptions
    });

    var ellipse = angular.copy(shapes.baseOptions);
    ellipse.main.rx = { type: 'slider', current: 80, displayName: 'horizontal radius' };
    ellipse.main.ry = { type: 'slider', current: 30, displayName: 'vertical radius' };

    shapes.available.push({
        name: 'ellipse',
        options: ellipse
    });

    shapes.available.push({
        name: 'polygon',  options: angular.copy(shapes.baseOptions), service: polygon
    });

    return shapes;
}]);
angular.module('image.shapes')

.service('polygon', ['$rootScope', '$mdDialog', 'canvas', function ($rootScope, $mdDialog, canvas) {

    var self = {

        mode: 'add',
        currentShape: false,

        onMouseMove: function(event) {
            var pos = canvas.fabric.getPointer(event.e);
            if (self.mode === "edit" && self.currentShape) {
                var points = self.currentShape.get("points");
                points[points.length - 1].x = pos.x - self.currentShape.get("left");
                points[points.length - 1].y = pos.y - self.currentShape.get("top");
                self.currentShape.set({
                    points: points
                });
                canvas.fabric.renderAll();
            }
        },

        onMouseDown: function(event) {
            var pos = canvas.fabric.getPointer(event.e);

            if (self.mode === "add") {
                var poly = new fabric.Polygon([{
                    x: pos.x,
                    y: pos.y
                }, {
                    x: pos.x + 0.5,
                    y: pos.y + 0.5
                }], {
                    fill: 'black',
                    opacity: 1,
                    selectable: false
                });
                self.currentShape = poly;
                self.currentShape.name = 'polygon';
                canvas.fabric.add(self.currentShape);
                self.mode = "edit";
            } else if (self.mode === "edit" && self.currentShape && self.currentShape.type === "polygon") {
                var points = self.currentShape.get("points");
                points.push({
                    x: pos.x - self.currentShape.get("left"),
                    y: pos.y - self.currentShape.get("top")
                });
                self.currentShape.set({
                    points: points
                });
                canvas.fabric.renderAll();
            }
        },

        onEscape: function(e) {
            if ((!e && self.currentShape) || e && e.keyCode === 27) {
                if (self.mode === 'edit' || self.mode === 'add') {
                    self.mode = 'normal';
                    self.currentShape.set({
                        selectable: true
                    });

                    self.currentShape._calcDimensions();
                    self.currentShape.setCoords();

                    canvas.fabric.setActiveObject(self.currentShape);
                    canvas.fabric.renderAll();
                } else {
                    self.mode = 'add';
                }

                self.currentShape = null;
            }
        },

        onClick: function(e) {
            var clickedInModal = $(e.target).closest('.md-dialog-container')[0];

            if (e.target.nodeName !== 'CANVAS' && $(e.target).closest('.shape').data('name') !== 'polygon' && !clickedInModal) {
                self.disable();
            }
        },

        enable: function() {
            if (this.enabled) return;

            this.enabled = true;
            canvas.fabric.on('mouse:move', self.onMouseMove);
            canvas.fabric.on('mouse:down', self.onMouseDown);
            fabric.util.addListener(window, 'keyup', self.onEscape);

            setTimeout(function() {
                fabric.util.addListener(window, 'click', self.onClick);
            }, 20);

            $mdDialog.show({
                templateUrl: 'modals/polygon.html',
                clickOutsideToClose: true,
                controller: ['$scope', '$mdDialog', function($scope, $mdDialog) {
                    $scope.closeModal = $mdDialog.hide;
                }]
            });
        },

        disable: function() {
            this.enabled = false;
            canvas.fabric.off('mouse:move', self.onMouseMove);
            canvas.fabric.off('mouse:down', self.onMouseDown);
            fabric.util.removeListener(window, 'keyup', self.onEscape);
            fabric.util.removeListener(window, 'click', self.onClick);
            self.onEscape();
        }
    };

    return self;

}]);
angular.module('ImageEditor')

.controller('ObjectsPanelController', ['$scope', '$rootScope', '$timeout', 'canvas', function($scope, $rootScope, $timeout, canvas) {
	$scope.objects = canvas.fabric._objects || [];

    $scope.sortableOptions = {
        items: '.object:visible',
        scroll: false,
        containment: 'parent',
        start: function(e, ui) {
            console.log("Start");
            console.log(ui.item.index());
            ui.item.data('start', ui.item.index());
        },
        stop: function(e, ui) {
            console.log("Stop");
            console.log(ui.item.index());



        },
        update: function(e, ui) {
            console.log("Update");
            console.log(ui.item.index());

            var start = ui.item.data('start'),
                end   = ui.item.index();


            obj = canvas.fabric.getObjects()[start];

            if ( ! obj) return;

            if (end > start) {
                //send object forwards by the amount of objects it passed
                for (var i = 0; i < (end - start); i++) {
                    canvas.fabric.bringForward(obj);
                    //canvas.fabric.sendBackwards(obj);
                }
            } else {
                //send object backwards by the amount of objects it passed
                for (var i = 0; i < (start - end); i++) {
                    canvas.fabric.sendBackwards(obj);
                    //canvas.fabric.bringForward(obj);
                }
            }

            $timeout(function() {
                canvas.fabric.renderAll();
                start = false; end = false;
            });
        }
    }

    $scope.setAsActive = function(object) {
        if (object) {
            canvas.fabric.setActiveObject(object);
        }
    };

    $scope.toggleVisibility = function(object) {
        if ( ! object) return;

        if (object.visible) {
            object.set({ visible: false, evented: false, selectable: false, hasBorders: false, hasCorners: false });
        } else {
            object.set({ visible: true, evented: true, selectable: true, hasBorders: true, hasCorners: true });
            canvas.fabric.setActiveObject(object);
        }

        canvas.fabric.renderAll();
    };

    $scope.deleteObject = function(object) {
        if (object) {
            canvas.fabric.remove(object);
            canvas.fabric.renderAll();
        }
    };

    $scope.toggleLock = function(object) {
        if ( ! object) return;

        if (object.locked) {
            object.set({
                locked: false,
                selectable: true,
                evented: true,
                lockMovementX: false,
                lockMovementY: false,
                lockRotation: false,
                lockScalingX: false,
                lockScalingY: false,
                lockUniScaling: false,
                hasControls: true,
                hasBorders: true
            });

            canvas.fabric.setActiveObject(object);
        } else {
            object.set({
                locked: true,
                selectable: false,
                evented: false,
                lockMovementX: true,
                lockMovementY: true,
                lockRotation: true,
                lockScalingX: true,
                lockScalingY: true,
                lockUniScaling: true,
                hasControls: false,
                hasBorders: false
            });
        }

        canvas.fabric.renderAll();
    }
}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbG9ycy5qcyIsImdyYWRpZW50cy5qcyIsImpxdWVyeS5qcyIsImpxdWVyeS11aS5qcyIsImZpbGUtc2F2ZXIuanMiLCJwYWdpbmF0aW9uLmpzIiwic3BlY3RydW0uanMiLCJoYW1tZXIuanMiLCJzY3JvbGxiYXIuanMiLCJhbmd1bGFyLm1pbi5qcyIsImFuZ3VsYXItYW5pbWF0ZS5qcyIsImFuZ3VsYXItYXJpYS5qcyIsImFuZ3VsYXItbWF0ZXJpYWwuanMiLCJhbmd1bGFyLXNvcnRhYmxlLmpzIiwiZmFicmljLmpzIiwiQXBwLmpzIiwiTG9jYWxTdG9yYWdlLmpzIiwiU2V0dGluZ3MuanMiLCJLZXliaW5kcy5qcyIsIkNhbnZhcy5qcyIsImNyb3BwZXIuanMiLCJjcm9wem9uZS5qcyIsImNyb3BDb250cm9sbGVyLmpzIiwiUm90YXRlQ29udHJvbGxlci5qcyIsIkNhbnZhc0JhY2tncm91bmRDb250cm9sbGVyLmpzIiwiUmVzaXplQ29udHJvbGxlci5qcyIsIlJvdW5kZWRDb3JuZXJzQ29udHJvbGxlci5qcyIsInpvb21Db250cm9sbGVyLmpzIiwiVG9wUGFuZWxDb250cm9sbGVyLmpzIiwiVGFicy5qcyIsIlByZXR0eVNjcm9sbGJhci5qcyIsIkNvbG9yUGlja2VyLmpzIiwiRmlsZVVwbG9hZGVyLmpzIiwiVG9nZ2xlUGFuZWxWaXNpYmlsaXR5LmpzIiwiVG9nZ2xlU2lkZWJhci5qcyIsIlRleHQuanMiLCJUZXh0Q29udHJvbGxlci5qcyIsIlRleHRBbGlnbkJ1dHRvbnMuanMiLCJUZXh0RGVjb3JhdGlvbkJ1dHRvbnMuanMiLCJGb250cy5qcyIsIkRyYXdpbmcuanMiLCJEcmF3aW5nQ29udHJvbGxlci5qcyIsIlJlbmRlckJydXNoZXNEaXJlY3RpdmUuanMiLCJIaXN0b3J5LmpzIiwiU2F2ZXIuanMiLCJGaWx0ZXJzQ29udHJvbGxlci5qcyIsIkZpbHRlcnMuanMiLCJTaW1wbGVTaGFwZXNDb250cm9sbGVyLmpzIiwiUGhvdG9Db250cm9sbGVyLmpzIiwiUGhvdG9DYXRlZ29yaWVzLmpzIiwiU3RpY2tlcnNDb250cm9sbGVyLmpzIiwiU3RpY2tlcnNDYXRlZ29yaWVzLmpzIiwiU2ltcGxlU2hhcGVzLmpzIiwiUG9seWdvbi5qcyIsIk9iamVjdHNQYW5lbENvbnRyb2xsZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdDRHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDclhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvdUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMWxFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25WQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xrZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOVZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdk1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0tBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzFKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM01BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzlMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29sb3JzRm9yUGlja2VyID0gWycjRDI0RDU3JywgJyNGMjI2MTMnLCAnI0Q5MUUxOCcsICcjOTYyODFCJywgJyNFRjQ4MzYnLCAnI0Q2NDU0MScsICcjQzAzOTJCJywgJyNDRjAwMEYnLCAnI0U3NEMzQycsICcjREIwQTVCJywgJyNGNjQ3NDcnLCAnI0YxQTlBMCcsICcjRDI1MjdGJywgJyNFMDgyODMnLCAnI0Y2MjQ1OScsICcjRTI2QTZBJywgJyNEQ0M2RTAnLCAnIzY2MzM5OScsICcjNjc0MTcyJywgJyNBRUE4RDMnLCAnIzkxM0Q4OCcsICcjOUExMkIzJywgJyNCRjU1RUMnLCAnI0JFOTBENCcsICcjOEU0NEFEJywgJyM5QjU5QjYnLCAnIzQ0NkNCMycsICcjRTRGMUZFJywgJyM0MTgzRDcnLCAnIzU5QUJFMycsICcjODFDRkUwJywgJyM1MkIzRDknLCAnI0M1RUZGNycsICcjMjJBN0YwJywgJyMzNDk4REInLCAnIzJDM0U1MCcsICcjMTlCNUZFJywgJyMzMzZFN0InLCAnIzIyMzEzRicsICcjNkJCOUYwJywgJyMxRThCQzMnLCAnIzNBNTM5QicsICcjMzQ0OTVFJywgJyM2NzgwOUYnLCAnIzI1NzRBOScsICcjMUYzQTkzJywgJyM4OUM0RjQnLCAnIzRCNzdCRScsICcjNUM5N0JGJywgJyM0RUNEQzQnLCAnI0EyREVEMCcsICcjODdEMzdDJywgJyM5MEM2OTUnLCAnIzI2QTY1QicsICcjMDNDOUE5JywgJyM2OEMzQTMnLCAnIzY1QzZCQicsICcjMUJCQzlCJywgJyMxQkEzOUMnLCAnIzY2Q0M5OScsICcjMzZEN0I3JywgJyNDOEY3QzUnLCAnIzg2RTJENScsICcjMkVDQzcxJywgJyMxNmEwODUnLCAnIzNGQzM4MCcsICcjMDE5ODc1JywgJyMwM0E2NzgnLCAnIzREQUY3QycsICcjMkFCQjlCJywgJyMwMEIxNkEnLCAnIzFFODI0QycsICcjMDQ5MzcyJywgJyMyNkMyODEnLCAnI0ZERTNBNycsICcjRjg5NDA2JywgJyNFQjk1MzInLCAnI0U4N0UwNCcsICcjRjRCMzUwJywgJyNGMjc4NEInLCAnI0VCOTc0RScsICcjRjVBQjM1JywgJyNEMzU0MDAnLCAnI0YzOUMxMicsICcjRjk2OTBFJywgJyNGOUJGM0InLCAnI0YyNzkzNScsICcjRTY3RTIyJywgJyNlY2VjZWMnLCAnIzZDN0E4OScsICcjRDJEN0QzJywgJyNFRUVFRUUnLCAnI0JEQzNDNycsICcjRUNGMEYxJywgJyM5NUE1QTYnLCAnI0RBREZFMScsICcjQUJCN0I3JywgJyNGMkYxRUYnLCAnI0JGQkZCRicsICcjRTZFMkFGJywgJyNBN0EzN0UnLCAnI0VGRUNDQScsICcjMDQ2MzgwJywgJyMwMDJGMkYnLCAnIzQ2ODk2NicsICcjRkZGMEE1JywgJyNGRkIwM0InLCAnI0I2NDkyNicsICcjOEUyODAwJywgJyMxRTFFMjAnXTsiLCJ2YXIgZWRHcmFkaWVudHMgPSB7XHJcbiAgICAxOiB7XHJcbiAgICAgICAgdHlwZTogJ2xpbmVhcicsXHJcbiAgICAgICAgeDE6IC04MCxcclxuICAgICAgICB5MTogMCxcclxuICAgICAgICB4MjogODAsXHJcbiAgICAgICAgeTI6IDAsXHJcbiAgICAgICAgY29sb3JTdG9wczoge1xyXG4gICAgICAgICAgICAwOiAnI2ZmZTQ3YicsXHJcbiAgICAgICAgICAgIDE6ICdyZ2IoMTExLDE1NCwyMTEpJ1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgMjogIHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogMCxcclxuICAgICAgICB5MTogLTEyMCxcclxuICAgICAgICB4MjogMCxcclxuICAgICAgICB5MjogMTIwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJyNmZjQwNDAnLFxyXG4gICAgICAgICAgICAxOiAnI2U2Mzk5YidcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIDM6IHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogLTkwLFxyXG4gICAgICAgIHkxOiAtOTAsXHJcbiAgICAgICAgeDI6IDkwLFxyXG4gICAgICAgIHkyOiA5MCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICdyZ2IoMTY2LDExMSwyMTMpJyxcclxuICAgICAgICAgICAgMC41OiAncmdiYSgxMDYsIDcyLCAyMTUsIDAuNSknLFxyXG4gICAgICAgICAgICAxOiAnIzIwMDc3MidcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIDQ6IHtcclxuICAgICAgICB0eXBlOiAncmFkaWFsJyxcclxuICAgICAgICByMTogMTAwLFxyXG4gICAgICAgIHIyOiAxMCxcclxuICAgICAgICB4MTogMCxcclxuICAgICAgICB5MTogMCxcclxuICAgICAgICB4MjogMCxcclxuICAgICAgICB5MjogMCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjRkY0RjRGJyxcclxuICAgICAgICAgICAgMTogJ3JnYigyNTUsIDIzOSwgNjQpJ1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgNToge1xyXG4gICAgICAgIHR5cGU6ICdyYWRpYWwnLFxyXG4gICAgICAgIHIxOiAxMDAsXHJcbiAgICAgICAgcjI6IDEwLFxyXG4gICAgICAgIHgxOiAwLFxyXG4gICAgICAgIHkxOiAwLFxyXG4gICAgICAgIHgyOiAyMCxcclxuICAgICAgICB5MjogMjAsXHJcbiAgICAgICAgY29sb3JTdG9wczoge1xyXG4gICAgICAgICAgICAwOiAnI2ZmZTQ3YicsXHJcbiAgICAgICAgICAgIDAuNTogJ3JnYigxMTEsMTU0LDIxMSknLFxyXG4gICAgICAgICAgICAxOiAncmdiKDE2NiwxMTEsMjEzKSdcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIDY6IHtcclxuICAgICAgICB0eXBlOiAncmFkaWFsJyxcclxuICAgICAgICByMTogNTAsXHJcbiAgICAgICAgcjI6IDgwLFxyXG4gICAgICAgIHgxOiA0NSxcclxuICAgICAgICB5MTogNDUsXHJcbiAgICAgICAgeDI6IDUyLFxyXG4gICAgICAgIHkyOiA1MCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICdyZ2IoMTU1LCAyMzcsIDApJyxcclxuICAgICAgICAgICAgMTogJ3JnYmEoMCwgMTY0LCAxMjgsMC40KSdcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIDc6IHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogLTkwLFxyXG4gICAgICAgIHkxOiAtOTAsXHJcbiAgICAgICAgeDI6IDkwLFxyXG4gICAgICAgIHkyOiA5MCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjOWVjYjJkJyxcclxuICAgICAgICAgICAgMC41OiAnIzcyYWEwMCcsXHJcbiAgICAgICAgICAgIDE6ICcjYmZkMjU1J1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgODoge1xyXG4gICAgICAgIHR5cGU6ICdyYWRpYWwnLFxyXG4gICAgICAgIHIxOiAxMDAsXHJcbiAgICAgICAgcjI6IDUwLFxyXG4gICAgICAgIHgxOiAzMCxcclxuICAgICAgICB5MTogMCxcclxuICAgICAgICB4MjogMCxcclxuICAgICAgICB5MjogMCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjYWViY2JmJyxcclxuICAgICAgICAgICAgMTogJyMwYTA4MDknXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICA5OiB7XHJcbiAgICAgICAgdHlwZTogJ2xpbmVhcicsXHJcbiAgICAgICAgeDE6IC04MCxcclxuICAgICAgICB5MTogMCxcclxuICAgICAgICB4MjogODAsXHJcbiAgICAgICAgeTI6IDAsXHJcbiAgICAgICAgY29sb3JTdG9wczoge1xyXG4gICAgICAgICAgICAwOiAnI2ZmZmZmZicsXHJcbiAgICAgICAgICAgIDE6ICcjZjZmNmY2J1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICAxMDogIHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogMCxcclxuICAgICAgICB5MTogLTEyMCxcclxuICAgICAgICB4MjogMCxcclxuICAgICAgICB5MjogMTIwLFxyXG4gICAgICAgIGNvbG9yU3RvcHM6IHtcclxuICAgICAgICAgICAgMDogJyNmZWZjZWEnLFxyXG4gICAgICAgICAgICAxOiAnI2YxZGEzNidcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgMTE6IHtcclxuICAgICAgICB0eXBlOiAnbGluZWFyJyxcclxuICAgICAgICB4MTogLTkwLFxyXG4gICAgICAgIHkxOiAtOTAsXHJcbiAgICAgICAgeDI6IDkwLFxyXG4gICAgICAgIHkyOiA5MCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICdyZ2IoMTY2LDExMSwyMTMpJyxcclxuICAgICAgICAgICAgMC41OiAncmdiYSgxMDYsIDcyLCAyMTUsIDAuNSknLFxyXG4gICAgICAgICAgICAxOiAnI2ZmMWEwMCdcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgMTI6ICB7XHJcbiAgICAgICAgdHlwZTogJ2xpbmVhcicsXHJcbiAgICAgICAgeDE6IDAsXHJcbiAgICAgICAgeTE6IC0xMjAsXHJcbiAgICAgICAgeDI6IDAsXHJcbiAgICAgICAgeTI6IDEyMCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjYjdkZWVkJyxcclxuICAgICAgICAgICAgMTogJyMyMWI0ZTInXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIDEzOiB7XHJcbiAgICAgICAgdHlwZTogJ2xpbmVhcicsXHJcbiAgICAgICAgeDE6IC04MCxcclxuICAgICAgICB5MTogMTAwLFxyXG4gICAgICAgIHgyOiA4MCxcclxuICAgICAgICB5MjogLTEwMCxcclxuICAgICAgICBjb2xvclN0b3BzOiB7XHJcbiAgICAgICAgICAgIDA6ICcjZmZlNDdiJyxcclxuICAgICAgICAgICAgMTogJ3JnYigxMTEsMTU0LDIxMSknXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufTsiLCIvKiEgalF1ZXJ5IHYyLjEuMyB8IChjKSAyMDA1LCAyMDE0IGpRdWVyeSBGb3VuZGF0aW9uLCBJbmMuIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovXHJcbiFmdW5jdGlvbihhLGIpe1wib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1hLmRvY3VtZW50P2IoYSwhMCk6ZnVuY3Rpb24oYSl7aWYoIWEuZG9jdW1lbnQpdGhyb3cgbmV3IEVycm9yKFwialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudFwiKTtyZXR1cm4gYihhKX06YihhKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihhLGIpe3ZhciBjPVtdLGQ9Yy5zbGljZSxlPWMuY29uY2F0LGY9Yy5wdXNoLGc9Yy5pbmRleE9mLGg9e30saT1oLnRvU3RyaW5nLGo9aC5oYXNPd25Qcm9wZXJ0eSxrPXt9LGw9YS5kb2N1bWVudCxtPVwiMi4xLjNcIixuPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBuLmZuLmluaXQoYSxiKX0sbz0vXltcXHNcXHVGRUZGXFx4QTBdK3xbXFxzXFx1RkVGRlxceEEwXSskL2cscD0vXi1tcy0vLHE9Ly0oW1xcZGEtel0pL2dpLHI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50b1VwcGVyQ2FzZSgpfTtuLmZuPW4ucHJvdG90eXBlPXtqcXVlcnk6bSxjb25zdHJ1Y3RvcjpuLHNlbGVjdG9yOlwiXCIsbGVuZ3RoOjAsdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBkLmNhbGwodGhpcyl9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YT8wPmE/dGhpc1thK3RoaXMubGVuZ3RoXTp0aGlzW2FdOmQuY2FsbCh0aGlzKX0scHVzaFN0YWNrOmZ1bmN0aW9uKGEpe3ZhciBiPW4ubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLGEpO3JldHVybiBiLnByZXZPYmplY3Q9dGhpcyxiLmNvbnRleHQ9dGhpcy5jb250ZXh0LGJ9LGVhY2g6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbi5lYWNoKHRoaXMsYSxiKX0sbWFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhuLm1hcCh0aGlzLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEuY2FsbChiLGMsYil9KSl9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGQuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5sZW5ndGgsYz0rYSsoMD5hP2I6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGM+PTAmJmI+Yz9bdGhpc1tjXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKG51bGwpfSxwdXNoOmYsc29ydDpjLnNvcnQsc3BsaWNlOmMuc3BsaWNlfSxuLmV4dGVuZD1uLmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBhLGIsYyxkLGUsZixnPWFyZ3VtZW50c1swXXx8e30saD0xLGk9YXJndW1lbnRzLmxlbmd0aCxqPSExO2ZvcihcImJvb2xlYW5cIj09dHlwZW9mIGcmJihqPWcsZz1hcmd1bWVudHNbaF18fHt9LGgrKyksXCJvYmplY3RcIj09dHlwZW9mIGd8fG4uaXNGdW5jdGlvbihnKXx8KGc9e30pLGg9PT1pJiYoZz10aGlzLGgtLSk7aT5oO2grKylpZihudWxsIT0oYT1hcmd1bWVudHNbaF0pKWZvcihiIGluIGEpYz1nW2JdLGQ9YVtiXSxnIT09ZCYmKGomJmQmJihuLmlzUGxhaW5PYmplY3QoZCl8fChlPW4uaXNBcnJheShkKSkpPyhlPyhlPSExLGY9YyYmbi5pc0FycmF5KGMpP2M6W10pOmY9YyYmbi5pc1BsYWluT2JqZWN0KGMpP2M6e30sZ1tiXT1uLmV4dGVuZChqLGYsZCkpOnZvaWQgMCE9PWQmJihnW2JdPWQpKTtyZXR1cm4gZ30sbi5leHRlbmQoe2V4cGFuZG86XCJqUXVlcnlcIisobStNYXRoLnJhbmRvbSgpKS5yZXBsYWNlKC9cXEQvZyxcIlwiKSxpc1JlYWR5OiEwLGVycm9yOmZ1bmN0aW9uKGEpe3Rocm93IG5ldyBFcnJvcihhKX0sbm9vcDpmdW5jdGlvbigpe30saXNGdW5jdGlvbjpmdW5jdGlvbihhKXtyZXR1cm5cImZ1bmN0aW9uXCI9PT1uLnR5cGUoYSl9LGlzQXJyYXk6QXJyYXkuaXNBcnJheSxpc1dpbmRvdzpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YSYmYT09PWEud2luZG93fSxpc051bWVyaWM6ZnVuY3Rpb24oYSl7cmV0dXJuIW4uaXNBcnJheShhKSYmYS1wYXJzZUZsb2F0KGEpKzE+PTB9LGlzUGxhaW5PYmplY3Q6ZnVuY3Rpb24oYSl7cmV0dXJuXCJvYmplY3RcIiE9PW4udHlwZShhKXx8YS5ub2RlVHlwZXx8bi5pc1dpbmRvdyhhKT8hMTphLmNvbnN0cnVjdG9yJiYhai5jYWxsKGEuY29uc3RydWN0b3IucHJvdG90eXBlLFwiaXNQcm90b3R5cGVPZlwiKT8hMTohMH0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihhKXt2YXIgYjtmb3IoYiBpbiBhKXJldHVybiExO3JldHVybiEwfSx0eXBlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hP2ErXCJcIjpcIm9iamVjdFwiPT10eXBlb2YgYXx8XCJmdW5jdGlvblwiPT10eXBlb2YgYT9oW2kuY2FsbChhKV18fFwib2JqZWN0XCI6dHlwZW9mIGF9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oYSl7dmFyIGIsYz1ldmFsO2E9bi50cmltKGEpLGEmJigxPT09YS5pbmRleE9mKFwidXNlIHN0cmljdFwiKT8oYj1sLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIiksYi50ZXh0PWEsbC5oZWFkLmFwcGVuZENoaWxkKGIpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYikpOmMoYSkpfSxjYW1lbENhc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZShwLFwibXMtXCIpLnJlcGxhY2UocSxyKX0sbm9kZU5hbWU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5ub2RlTmFtZSYmYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Yi50b0xvd2VyQ2FzZSgpfSxlYWNoOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPTAsZj1hLmxlbmd0aCxnPXMoYSk7aWYoYyl7aWYoZyl7Zm9yKDtmPmU7ZSsrKWlmKGQ9Yi5hcHBseShhW2VdLGMpLGQ9PT0hMSlicmVha31lbHNlIGZvcihlIGluIGEpaWYoZD1iLmFwcGx5KGFbZV0sYyksZD09PSExKWJyZWFrfWVsc2UgaWYoZyl7Zm9yKDtmPmU7ZSsrKWlmKGQ9Yi5jYWxsKGFbZV0sZSxhW2VdKSxkPT09ITEpYnJlYWt9ZWxzZSBmb3IoZSBpbiBhKWlmKGQ9Yi5jYWxsKGFbZV0sZSxhW2VdKSxkPT09ITEpYnJlYWs7cmV0dXJuIGF9LHRyaW06ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/XCJcIjooYStcIlwiKS5yZXBsYWNlKG8sXCJcIil9LG1ha2VBcnJheTpmdW5jdGlvbihhLGIpe3ZhciBjPWJ8fFtdO3JldHVybiBudWxsIT1hJiYocyhPYmplY3QoYSkpP24ubWVyZ2UoYyxcInN0cmluZ1wiPT10eXBlb2YgYT9bYV06YSk6Zi5jYWxsKGMsYSkpLGN9LGluQXJyYXk6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBudWxsPT1iPy0xOmcuY2FsbChiLGEsYyl9LG1lcmdlOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPStiLmxlbmd0aCxkPTAsZT1hLmxlbmd0aDtjPmQ7ZCsrKWFbZSsrXT1iW2RdO3JldHVybiBhLmxlbmd0aD1lLGF9LGdyZXA6ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZCxlPVtdLGY9MCxnPWEubGVuZ3RoLGg9IWM7Zz5mO2YrKylkPSFiKGFbZl0sZiksZCE9PWgmJmUucHVzaChhW2ZdKTtyZXR1cm4gZX0sbWFwOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxmPTAsZz1hLmxlbmd0aCxoPXMoYSksaT1bXTtpZihoKWZvcig7Zz5mO2YrKylkPWIoYVtmXSxmLGMpLG51bGwhPWQmJmkucHVzaChkKTtlbHNlIGZvcihmIGluIGEpZD1iKGFbZl0sZixjKSxudWxsIT1kJiZpLnB1c2goZCk7cmV0dXJuIGUuYXBwbHkoW10saSl9LGd1aWQ6MSxwcm94eTpmdW5jdGlvbihhLGIpe3ZhciBjLGUsZjtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgYiYmKGM9YVtiXSxiPWEsYT1jKSxuLmlzRnVuY3Rpb24oYSk/KGU9ZC5jYWxsKGFyZ3VtZW50cywyKSxmPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYnx8dGhpcyxlLmNvbmNhdChkLmNhbGwoYXJndW1lbnRzKSkpfSxmLmd1aWQ9YS5ndWlkPWEuZ3VpZHx8bi5ndWlkKyssZik6dm9pZCAwfSxub3c6RGF0ZS5ub3csc3VwcG9ydDprfSksbi5lYWNoKFwiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvclwiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhLGIpe2hbXCJbb2JqZWN0IFwiK2IrXCJdXCJdPWIudG9Mb3dlckNhc2UoKX0pO2Z1bmN0aW9uIHMoYSl7dmFyIGI9YS5sZW5ndGgsYz1uLnR5cGUoYSk7cmV0dXJuXCJmdW5jdGlvblwiPT09Y3x8bi5pc1dpbmRvdyhhKT8hMToxPT09YS5ub2RlVHlwZSYmYj8hMDpcImFycmF5XCI9PT1jfHwwPT09Ynx8XCJudW1iZXJcIj09dHlwZW9mIGImJmI+MCYmYi0xIGluIGF9dmFyIHQ9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaSxqLGssbCxtLG4sbyxwLHEscixzLHQsdT1cInNpenpsZVwiKzEqbmV3IERhdGUsdj1hLmRvY3VtZW50LHc9MCx4PTAseT1oYigpLHo9aGIoKSxBPWhiKCksQj1mdW5jdGlvbihhLGIpe3JldHVybiBhPT09YiYmKGw9ITApLDB9LEM9MTw8MzEsRD17fS5oYXNPd25Qcm9wZXJ0eSxFPVtdLEY9RS5wb3AsRz1FLnB1c2gsSD1FLnB1c2gsST1FLnNsaWNlLEo9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2Q+YztjKyspaWYoYVtjXT09PWIpcmV0dXJuIGM7cmV0dXJuLTF9LEs9XCJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZFwiLEw9XCJbXFxcXHgyMFxcXFx0XFxcXHJcXFxcblxcXFxmXVwiLE09XCIoPzpcXFxcXFxcXC58W1xcXFx3LV18W15cXFxceDAwLVxcXFx4YTBdKStcIixOPU0ucmVwbGFjZShcIndcIixcIncjXCIpLE89XCJcXFxcW1wiK0wrXCIqKFwiK00rXCIpKD86XCIrTCtcIiooWypeJHwhfl0/PSlcIitMK1wiKig/OicoKD86XFxcXFxcXFwufFteXFxcXFxcXFwnXSkqKSd8XFxcIigoPzpcXFxcXFxcXC58W15cXFxcXFxcXFxcXCJdKSopXFxcInwoXCIrTitcIikpfClcIitMK1wiKlxcXFxdXCIsUD1cIjooXCIrTStcIikoPzpcXFxcKCgoJygoPzpcXFxcXFxcXC58W15cXFxcXFxcXCddKSopJ3xcXFwiKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcXFxcIl0pKilcXFwiKXwoKD86XFxcXFxcXFwufFteXFxcXFxcXFwoKVtcXFxcXV18XCIrTytcIikqKXwuKilcXFxcKXwpXCIsUT1uZXcgUmVnRXhwKEwrXCIrXCIsXCJnXCIpLFI9bmV3IFJlZ0V4cChcIl5cIitMK1wiK3woKD86XnxbXlxcXFxcXFxcXSkoPzpcXFxcXFxcXC4pKilcIitMK1wiKyRcIixcImdcIiksUz1uZXcgUmVnRXhwKFwiXlwiK0wrXCIqLFwiK0wrXCIqXCIpLFQ9bmV3IFJlZ0V4cChcIl5cIitMK1wiKihbPit+XXxcIitMK1wiKVwiK0wrXCIqXCIpLFU9bmV3IFJlZ0V4cChcIj1cIitMK1wiKihbXlxcXFxdJ1xcXCJdKj8pXCIrTCtcIipcXFxcXVwiLFwiZ1wiKSxWPW5ldyBSZWdFeHAoUCksVz1uZXcgUmVnRXhwKFwiXlwiK04rXCIkXCIpLFg9e0lEOm5ldyBSZWdFeHAoXCJeIyhcIitNK1wiKVwiKSxDTEFTUzpuZXcgUmVnRXhwKFwiXlxcXFwuKFwiK00rXCIpXCIpLFRBRzpuZXcgUmVnRXhwKFwiXihcIitNLnJlcGxhY2UoXCJ3XCIsXCJ3KlwiKStcIilcIiksQVRUUjpuZXcgUmVnRXhwKFwiXlwiK08pLFBTRVVETzpuZXcgUmVnRXhwKFwiXlwiK1ApLENISUxEOm5ldyBSZWdFeHAoXCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXFxcKFwiK0wrXCIqKGV2ZW58b2RkfCgoWystXXwpKFxcXFxkKilufClcIitMK1wiKig/OihbKy1dfClcIitMK1wiKihcXFxcZCspfCkpXCIrTCtcIipcXFxcKXwpXCIsXCJpXCIpLGJvb2w6bmV3IFJlZ0V4cChcIl4oPzpcIitLK1wiKSRcIixcImlcIiksbmVlZHNDb250ZXh0Om5ldyBSZWdFeHAoXCJeXCIrTCtcIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcXFwoXCIrTCtcIiooKD86LVxcXFxkKT9cXFxcZCopXCIrTCtcIipcXFxcKXwpKD89W14tXXwkKVwiLFwiaVwiKX0sWT0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLFo9L15oXFxkJC9pLCQ9L15bXntdK1xce1xccypcXFtuYXRpdmUgXFx3LyxfPS9eKD86IyhbXFx3LV0rKXwoXFx3Kyl8XFwuKFtcXHctXSspKSQvLGFiPS9bK35dLyxiYj0vJ3xcXFxcL2csY2I9bmV3IFJlZ0V4cChcIlxcXFxcXFxcKFtcXFxcZGEtZl17MSw2fVwiK0wrXCI/fChcIitMK1wiKXwuKVwiLFwiaWdcIiksZGI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVwiMHhcIitiLTY1NTM2O3JldHVybiBkIT09ZHx8Yz9iOjA+ZD9TdHJpbmcuZnJvbUNoYXJDb2RlKGQrNjU1MzYpOlN0cmluZy5mcm9tQ2hhckNvZGUoZD4+MTB8NTUyOTYsMTAyMyZkfDU2MzIwKX0sZWI9ZnVuY3Rpb24oKXttKCl9O3RyeXtILmFwcGx5KEU9SS5jYWxsKHYuY2hpbGROb2Rlcyksdi5jaGlsZE5vZGVzKSxFW3YuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlfWNhdGNoKGZiKXtIPXthcHBseTpFLmxlbmd0aD9mdW5jdGlvbihhLGIpe0cuYXBwbHkoYSxJLmNhbGwoYikpfTpmdW5jdGlvbihhLGIpe3ZhciBjPWEubGVuZ3RoLGQ9MDt3aGlsZShhW2MrK109YltkKytdKTthLmxlbmd0aD1jLTF9fX1mdW5jdGlvbiBnYihhLGIsZCxlKXt2YXIgZixoLGosayxsLG8scixzLHcseDtpZigoYj9iLm93bmVyRG9jdW1lbnR8fGI6dikhPT1uJiZtKGIpLGI9Ynx8bixkPWR8fFtdLGs9Yi5ub2RlVHlwZSxcInN0cmluZ1wiIT10eXBlb2YgYXx8IWF8fDEhPT1rJiY5IT09ayYmMTEhPT1rKXJldHVybiBkO2lmKCFlJiZwKXtpZigxMSE9PWsmJihmPV8uZXhlYyhhKSkpaWYoaj1mWzFdKXtpZig5PT09ayl7aWYoaD1iLmdldEVsZW1lbnRCeUlkKGopLCFofHwhaC5wYXJlbnROb2RlKXJldHVybiBkO2lmKGguaWQ9PT1qKXJldHVybiBkLnB1c2goaCksZH1lbHNlIGlmKGIub3duZXJEb2N1bWVudCYmKGg9Yi5vd25lckRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGopKSYmdChiLGgpJiZoLmlkPT09ailyZXR1cm4gZC5wdXNoKGgpLGR9ZWxzZXtpZihmWzJdKXJldHVybiBILmFwcGx5KGQsYi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKSksZDtpZigoaj1mWzNdKSYmYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBILmFwcGx5KGQsYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGopKSxkfWlmKGMucXNhJiYoIXF8fCFxLnRlc3QoYSkpKXtpZihzPXI9dSx3PWIseD0xIT09ayYmYSwxPT09ayYmXCJvYmplY3RcIiE9PWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl7bz1nKGEpLChyPWIuZ2V0QXR0cmlidXRlKFwiaWRcIikpP3M9ci5yZXBsYWNlKGJiLFwiXFxcXCQmXCIpOmIuc2V0QXR0cmlidXRlKFwiaWRcIixzKSxzPVwiW2lkPSdcIitzK1wiJ10gXCIsbD1vLmxlbmd0aDt3aGlsZShsLS0pb1tsXT1zK3JiKG9bbF0pO3c9YWIudGVzdChhKSYmcGIoYi5wYXJlbnROb2RlKXx8Yix4PW8uam9pbihcIixcIil9aWYoeCl0cnl7cmV0dXJuIEguYXBwbHkoZCx3LnF1ZXJ5U2VsZWN0b3JBbGwoeCkpLGR9Y2F0Y2goeSl7fWZpbmFsbHl7cnx8Yi5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKX19fXJldHVybiBpKGEucmVwbGFjZShSLFwiJDFcIiksYixkLGUpfWZ1bmN0aW9uIGhiKCl7dmFyIGE9W107ZnVuY3Rpb24gYihjLGUpe3JldHVybiBhLnB1c2goYytcIiBcIik+ZC5jYWNoZUxlbmd0aCYmZGVsZXRlIGJbYS5zaGlmdCgpXSxiW2MrXCIgXCJdPWV9cmV0dXJuIGJ9ZnVuY3Rpb24gaWIoYSl7cmV0dXJuIGFbdV09ITAsYX1mdW5jdGlvbiBqYihhKXt2YXIgYj1uLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dHJ5e3JldHVybiEhYShiKX1jYXRjaChjKXtyZXR1cm4hMX1maW5hbGx5e2IucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpLGI9bnVsbH19ZnVuY3Rpb24ga2IoYSxiKXt2YXIgYz1hLnNwbGl0KFwifFwiKSxlPWEubGVuZ3RoO3doaWxlKGUtLSlkLmF0dHJIYW5kbGVbY1tlXV09Yn1mdW5jdGlvbiBsYihhLGIpe3ZhciBjPWImJmEsZD1jJiYxPT09YS5ub2RlVHlwZSYmMT09PWIubm9kZVR5cGUmJih+Yi5zb3VyY2VJbmRleHx8QyktKH5hLnNvdXJjZUluZGV4fHxDKTtpZihkKXJldHVybiBkO2lmKGMpd2hpbGUoYz1jLm5leHRTaWJsaW5nKWlmKGM9PT1iKXJldHVybi0xO3JldHVybiBhPzE6LTF9ZnVuY3Rpb24gbWIoYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3ZhciBjPWIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm5cImlucHV0XCI9PT1jJiZiLnR5cGU9PT1hfX1mdW5jdGlvbiBuYihhKXtyZXR1cm4gZnVuY3Rpb24oYil7dmFyIGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybihcImlucHV0XCI9PT1jfHxcImJ1dHRvblwiPT09YykmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG9iKGEpe3JldHVybiBpYihmdW5jdGlvbihiKXtyZXR1cm4gYj0rYixpYihmdW5jdGlvbihjLGQpe3ZhciBlLGY9YShbXSxjLmxlbmd0aCxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSljW2U9ZltnXV0mJihjW2VdPSEoZFtlXT1jW2VdKSl9KX0pfWZ1bmN0aW9uIHBiKGEpe3JldHVybiBhJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5nZXRFbGVtZW50c0J5VGFnTmFtZSYmYX1jPWdiLnN1cHBvcnQ9e30sZj1nYi5pc1hNTD1mdW5jdGlvbihhKXt2YXIgYj1hJiYoYS5vd25lckRvY3VtZW50fHxhKS5kb2N1bWVudEVsZW1lbnQ7cmV0dXJuIGI/XCJIVE1MXCIhPT1iLm5vZGVOYW1lOiExfSxtPWdiLnNldERvY3VtZW50PWZ1bmN0aW9uKGEpe3ZhciBiLGUsZz1hP2Eub3duZXJEb2N1bWVudHx8YTp2O3JldHVybiBnIT09biYmOT09PWcubm9kZVR5cGUmJmcuZG9jdW1lbnRFbGVtZW50PyhuPWcsbz1nLmRvY3VtZW50RWxlbWVudCxlPWcuZGVmYXVsdFZpZXcsZSYmZSE9PWUudG9wJiYoZS5hZGRFdmVudExpc3RlbmVyP2UuYWRkRXZlbnRMaXN0ZW5lcihcInVubG9hZFwiLGViLCExKTplLmF0dGFjaEV2ZW50JiZlLmF0dGFjaEV2ZW50KFwib251bmxvYWRcIixlYikpLHA9IWYoZyksYy5hdHRyaWJ1dGVzPWpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmNsYXNzTmFtZT1cImlcIiwhYS5nZXRBdHRyaWJ1dGUoXCJjbGFzc05hbWVcIil9KSxjLmdldEVsZW1lbnRzQnlUYWdOYW1lPWpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmFwcGVuZENoaWxkKGcuY3JlYXRlQ29tbWVudChcIlwiKSksIWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpLmxlbmd0aH0pLGMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT0kLnRlc3QoZy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKSxjLmdldEJ5SWQ9amIoZnVuY3Rpb24oYSl7cmV0dXJuIG8uYXBwZW5kQ2hpbGQoYSkuaWQ9dSwhZy5nZXRFbGVtZW50c0J5TmFtZXx8IWcuZ2V0RWxlbWVudHNCeU5hbWUodSkubGVuZ3RofSksYy5nZXRCeUlkPyhkLmZpbmQuSUQ9ZnVuY3Rpb24oYSxiKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgYi5nZXRFbGVtZW50QnlJZCYmcCl7dmFyIGM9Yi5nZXRFbGVtZW50QnlJZChhKTtyZXR1cm4gYyYmYy5wYXJlbnROb2RlP1tjXTpbXX19LGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShjYixkYik7cmV0dXJuIGZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZShcImlkXCIpPT09Yn19KTooZGVsZXRlIGQuZmluZC5JRCxkLmZpbHRlci5JRD1mdW5jdGlvbihhKXt2YXIgYj1hLnJlcGxhY2UoY2IsZGIpO3JldHVybiBmdW5jdGlvbihhKXt2YXIgYz1cInVuZGVmaW5lZFwiIT10eXBlb2YgYS5nZXRBdHRyaWJ1dGVOb2RlJiZhLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKTtyZXR1cm4gYyYmYy52YWx1ZT09PWJ9fSksZC5maW5kLlRBRz1jLmdldEVsZW1lbnRzQnlUYWdOYW1lP2Z1bmN0aW9uKGEsYil7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGIuZ2V0RWxlbWVudHNCeVRhZ05hbWU/Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTpjLnFzYT9iLnF1ZXJ5U2VsZWN0b3JBbGwoYSk6dm9pZCAwfTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT0wLGY9Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKTtpZihcIipcIj09PWEpe3doaWxlKGM9ZltlKytdKTE9PT1jLm5vZGVUeXBlJiZkLnB1c2goYyk7cmV0dXJuIGR9cmV0dXJuIGZ9LGQuZmluZC5DTEFTUz1jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmZ1bmN0aW9uKGEsYil7cmV0dXJuIHA/Yi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGEpOnZvaWQgMH0scj1bXSxxPVtdLChjLnFzYT0kLnRlc3QoZy5xdWVyeVNlbGVjdG9yQWxsKSkmJihqYihmdW5jdGlvbihhKXtvLmFwcGVuZENoaWxkKGEpLmlubmVySFRNTD1cIjxhIGlkPSdcIit1K1wiJz48L2E+PHNlbGVjdCBpZD0nXCIrdStcIi1cXGZdJyBtc2FsbG93Y2FwdHVyZT0nJz48b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PlwiLGEucXVlcnlTZWxlY3RvckFsbChcIlttc2FsbG93Y2FwdHVyZV49JyddXCIpLmxlbmd0aCYmcS5wdXNoKFwiWypeJF09XCIrTCtcIiooPzonJ3xcXFwiXFxcIilcIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiW3NlbGVjdGVkXVwiKS5sZW5ndGh8fHEucHVzaChcIlxcXFxbXCIrTCtcIiooPzp2YWx1ZXxcIitLK1wiKVwiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbaWR+PVwiK3UrXCItXVwiKS5sZW5ndGh8fHEucHVzaChcIn49XCIpLGEucXVlcnlTZWxlY3RvckFsbChcIjpjaGVja2VkXCIpLmxlbmd0aHx8cS5wdXNoKFwiOmNoZWNrZWRcIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiYSNcIit1K1wiKypcIikubGVuZ3RofHxxLnB1c2goXCIuIy4rWyt+XVwiKX0pLGpiKGZ1bmN0aW9uKGEpe3ZhciBiPWcuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO2Iuc2V0QXR0cmlidXRlKFwidHlwZVwiLFwiaGlkZGVuXCIpLGEuYXBwZW5kQ2hpbGQoYikuc2V0QXR0cmlidXRlKFwibmFtZVwiLFwiRFwiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbbmFtZT1kXVwiKS5sZW5ndGgmJnEucHVzaChcIm5hbWVcIitMK1wiKlsqXiR8IX5dPz1cIiksYS5xdWVyeVNlbGVjdG9yQWxsKFwiOmVuYWJsZWRcIikubGVuZ3RofHxxLnB1c2goXCI6ZW5hYmxlZFwiLFwiOmRpc2FibGVkXCIpLGEucXVlcnlTZWxlY3RvckFsbChcIiosOnhcIikscS5wdXNoKFwiLC4qOlwiKX0pKSwoYy5tYXRjaGVzU2VsZWN0b3I9JC50ZXN0KHM9by5tYXRjaGVzfHxvLndlYmtpdE1hdGNoZXNTZWxlY3Rvcnx8by5tb3pNYXRjaGVzU2VsZWN0b3J8fG8ub01hdGNoZXNTZWxlY3Rvcnx8by5tc01hdGNoZXNTZWxlY3RvcikpJiZqYihmdW5jdGlvbihhKXtjLmRpc2Nvbm5lY3RlZE1hdGNoPXMuY2FsbChhLFwiZGl2XCIpLHMuY2FsbChhLFwiW3MhPScnXTp4XCIpLHIucHVzaChcIiE9XCIsUCl9KSxxPXEubGVuZ3RoJiZuZXcgUmVnRXhwKHEuam9pbihcInxcIikpLHI9ci5sZW5ndGgmJm5ldyBSZWdFeHAoci5qb2luKFwifFwiKSksYj0kLnRlc3Qoby5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiksdD1ifHwkLnRlc3Qoby5jb250YWlucyk/ZnVuY3Rpb24oYSxiKXt2YXIgYz05PT09YS5ub2RlVHlwZT9hLmRvY3VtZW50RWxlbWVudDphLGQ9YiYmYi5wYXJlbnROb2RlO3JldHVybiBhPT09ZHx8ISghZHx8MSE9PWQubm9kZVR5cGV8fCEoYy5jb250YWlucz9jLmNvbnRhaW5zKGQpOmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24mJjE2JmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZCkpKX06ZnVuY3Rpb24oYSxiKXtpZihiKXdoaWxlKGI9Yi5wYXJlbnROb2RlKWlmKGI9PT1hKXJldHVybiEwO3JldHVybiExfSxCPWI/ZnVuY3Rpb24oYSxiKXtpZihhPT09YilyZXR1cm4gbD0hMCwwO3ZhciBkPSFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uLSFiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO3JldHVybiBkP2Q6KGQ9KGEub3duZXJEb2N1bWVudHx8YSk9PT0oYi5vd25lckRvY3VtZW50fHxiKT9hLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpOjEsMSZkfHwhYy5zb3J0RGV0YWNoZWQmJmIuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYSk9PT1kP2E9PT1nfHxhLm93bmVyRG9jdW1lbnQ9PT12JiZ0KHYsYSk/LTE6Yj09PWd8fGIub3duZXJEb2N1bWVudD09PXYmJnQodixiKT8xOms/SihrLGEpLUooayxiKTowOjQmZD8tMToxKX06ZnVuY3Rpb24oYSxiKXtpZihhPT09YilyZXR1cm4gbD0hMCwwO3ZhciBjLGQ9MCxlPWEucGFyZW50Tm9kZSxmPWIucGFyZW50Tm9kZSxoPVthXSxpPVtiXTtpZighZXx8IWYpcmV0dXJuIGE9PT1nPy0xOmI9PT1nPzE6ZT8tMTpmPzE6az9KKGssYSktSihrLGIpOjA7aWYoZT09PWYpcmV0dXJuIGxiKGEsYik7Yz1hO3doaWxlKGM9Yy5wYXJlbnROb2RlKWgudW5zaGlmdChjKTtjPWI7d2hpbGUoYz1jLnBhcmVudE5vZGUpaS51bnNoaWZ0KGMpO3doaWxlKGhbZF09PT1pW2RdKWQrKztyZXR1cm4gZD9sYihoW2RdLGlbZF0pOmhbZF09PT12Py0xOmlbZF09PT12PzE6MH0sZyk6bn0sZ2IubWF0Y2hlcz1mdW5jdGlvbihhLGIpe3JldHVybiBnYihhLG51bGwsbnVsbCxiKX0sZ2IubWF0Y2hlc1NlbGVjdG9yPWZ1bmN0aW9uKGEsYil7aWYoKGEub3duZXJEb2N1bWVudHx8YSkhPT1uJiZtKGEpLGI9Yi5yZXBsYWNlKFUsXCI9JyQxJ11cIiksISghYy5tYXRjaGVzU2VsZWN0b3J8fCFwfHxyJiZyLnRlc3QoYil8fHEmJnEudGVzdChiKSkpdHJ5e3ZhciBkPXMuY2FsbChhLGIpO2lmKGR8fGMuZGlzY29ubmVjdGVkTWF0Y2h8fGEuZG9jdW1lbnQmJjExIT09YS5kb2N1bWVudC5ub2RlVHlwZSlyZXR1cm4gZH1jYXRjaChlKXt9cmV0dXJuIGdiKGIsbixudWxsLFthXSkubGVuZ3RoPjB9LGdiLmNvbnRhaW5zPWZ1bmN0aW9uKGEsYil7cmV0dXJuKGEub3duZXJEb2N1bWVudHx8YSkhPT1uJiZtKGEpLHQoYSxiKX0sZ2IuYXR0cj1mdW5jdGlvbihhLGIpeyhhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKTt2YXIgZT1kLmF0dHJIYW5kbGVbYi50b0xvd2VyQ2FzZSgpXSxmPWUmJkQuY2FsbChkLmF0dHJIYW5kbGUsYi50b0xvd2VyQ2FzZSgpKT9lKGEsYiwhcCk6dm9pZCAwO3JldHVybiB2b2lkIDAhPT1mP2Y6Yy5hdHRyaWJ1dGVzfHwhcD9hLmdldEF0dHJpYnV0ZShiKTooZj1hLmdldEF0dHJpYnV0ZU5vZGUoYikpJiZmLnNwZWNpZmllZD9mLnZhbHVlOm51bGx9LGdiLmVycm9yPWZ1bmN0aW9uKGEpe3Rocm93IG5ldyBFcnJvcihcIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246IFwiK2EpfSxnYi51bmlxdWVTb3J0PWZ1bmN0aW9uKGEpe3ZhciBiLGQ9W10sZT0wLGY9MDtpZihsPSFjLmRldGVjdER1cGxpY2F0ZXMsaz0hYy5zb3J0U3RhYmxlJiZhLnNsaWNlKDApLGEuc29ydChCKSxsKXt3aGlsZShiPWFbZisrXSliPT09YVtmXSYmKGU9ZC5wdXNoKGYpKTt3aGlsZShlLS0pYS5zcGxpY2UoZFtlXSwxKX1yZXR1cm4gaz1udWxsLGF9LGU9Z2IuZ2V0VGV4dD1mdW5jdGlvbihhKXt2YXIgYixjPVwiXCIsZD0wLGY9YS5ub2RlVHlwZTtpZihmKXtpZigxPT09Znx8OT09PWZ8fDExPT09Zil7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGEudGV4dENvbnRlbnQpcmV0dXJuIGEudGV4dENvbnRlbnQ7Zm9yKGE9YS5maXJzdENoaWxkO2E7YT1hLm5leHRTaWJsaW5nKWMrPWUoYSl9ZWxzZSBpZigzPT09Znx8ND09PWYpcmV0dXJuIGEubm9kZVZhbHVlfWVsc2Ugd2hpbGUoYj1hW2QrK10pYys9ZShiKTtyZXR1cm4gY30sZD1nYi5zZWxlY3RvcnM9e2NhY2hlTGVuZ3RoOjUwLGNyZWF0ZVBzZXVkbzppYixtYXRjaDpYLGF0dHJIYW5kbGU6e30sZmluZDp7fSxyZWxhdGl2ZTp7XCI+XCI6e2RpcjpcInBhcmVudE5vZGVcIixmaXJzdDohMH0sXCIgXCI6e2RpcjpcInBhcmVudE5vZGVcIn0sXCIrXCI6e2RpcjpcInByZXZpb3VzU2libGluZ1wiLGZpcnN0OiEwfSxcIn5cIjp7ZGlyOlwicHJldmlvdXNTaWJsaW5nXCJ9fSxwcmVGaWx0ZXI6e0FUVFI6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS5yZXBsYWNlKGNiLGRiKSxhWzNdPShhWzNdfHxhWzRdfHxhWzVdfHxcIlwiKS5yZXBsYWNlKGNiLGRiKSxcIn49XCI9PT1hWzJdJiYoYVszXT1cIiBcIithWzNdK1wiIFwiKSxhLnNsaWNlKDAsNCl9LENISUxEOmZ1bmN0aW9uKGEpe3JldHVybiBhWzFdPWFbMV0udG9Mb3dlckNhc2UoKSxcIm50aFwiPT09YVsxXS5zbGljZSgwLDMpPyhhWzNdfHxnYi5lcnJvcihhWzBdKSxhWzRdPSsoYVs0XT9hWzVdKyhhWzZdfHwxKToyKihcImV2ZW5cIj09PWFbM118fFwib2RkXCI9PT1hWzNdKSksYVs1XT0rKGFbN10rYVs4XXx8XCJvZGRcIj09PWFbM10pKTphWzNdJiZnYi5lcnJvcihhWzBdKSxhfSxQU0VVRE86ZnVuY3Rpb24oYSl7dmFyIGIsYz0hYVs2XSYmYVsyXTtyZXR1cm4gWC5DSElMRC50ZXN0KGFbMF0pP251bGw6KGFbM10/YVsyXT1hWzRdfHxhWzVdfHxcIlwiOmMmJlYudGVzdChjKSYmKGI9ZyhjLCEwKSkmJihiPWMuaW5kZXhPZihcIilcIixjLmxlbmd0aC1iKS1jLmxlbmd0aCkmJihhWzBdPWFbMF0uc2xpY2UoMCxiKSxhWzJdPWMuc2xpY2UoMCxiKSksYS5zbGljZSgwLDMpKX19LGZpbHRlcjp7VEFHOmZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShjYixkYikudG9Mb3dlckNhc2UoKTtyZXR1cm5cIipcIj09PWE/ZnVuY3Rpb24oKXtyZXR1cm4hMH06ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWJ9fSxDTEFTUzpmdW5jdGlvbihhKXt2YXIgYj15W2ErXCIgXCJdO3JldHVybiBifHwoYj1uZXcgUmVnRXhwKFwiKF58XCIrTCtcIilcIithK1wiKFwiK0wrXCJ8JClcIikpJiZ5KGEsZnVuY3Rpb24oYSl7cmV0dXJuIGIudGVzdChcInN0cmluZ1wiPT10eXBlb2YgYS5jbGFzc05hbWUmJmEuY2xhc3NOYW1lfHxcInVuZGVmaW5lZFwiIT10eXBlb2YgYS5nZXRBdHRyaWJ1dGUmJmEuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIil8fFwiXCIpfSl9LEFUVFI6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmdW5jdGlvbihkKXt2YXIgZT1nYi5hdHRyKGQsYSk7cmV0dXJuIG51bGw9PWU/XCIhPVwiPT09YjpiPyhlKz1cIlwiLFwiPVwiPT09Yj9lPT09YzpcIiE9XCI9PT1iP2UhPT1jOlwiXj1cIj09PWI/YyYmMD09PWUuaW5kZXhPZihjKTpcIio9XCI9PT1iP2MmJmUuaW5kZXhPZihjKT4tMTpcIiQ9XCI9PT1iP2MmJmUuc2xpY2UoLWMubGVuZ3RoKT09PWM6XCJ+PVwiPT09Yj8oXCIgXCIrZS5yZXBsYWNlKFEsXCIgXCIpK1wiIFwiKS5pbmRleE9mKGMpPi0xOlwifD1cIj09PWI/ZT09PWN8fGUuc2xpY2UoMCxjLmxlbmd0aCsxKT09PWMrXCItXCI6ITEpOiEwfX0sQ0hJTEQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZj1cIm50aFwiIT09YS5zbGljZSgwLDMpLGc9XCJsYXN0XCIhPT1hLnNsaWNlKC00KSxoPVwib2YtdHlwZVwiPT09YjtyZXR1cm4gMT09PWQmJjA9PT1lP2Z1bmN0aW9uKGEpe3JldHVybiEhYS5wYXJlbnROb2RlfTpmdW5jdGlvbihiLGMsaSl7dmFyIGosayxsLG0sbixvLHA9ZiE9PWc/XCJuZXh0U2libGluZ1wiOlwicHJldmlvdXNTaWJsaW5nXCIscT1iLnBhcmVudE5vZGUscj1oJiZiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkscz0haSYmIWg7aWYocSl7aWYoZil7d2hpbGUocCl7bD1iO3doaWxlKGw9bFtwXSlpZihoP2wubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PWwubm9kZVR5cGUpcmV0dXJuITE7bz1wPVwib25seVwiPT09YSYmIW8mJlwibmV4dFNpYmxpbmdcIn1yZXR1cm4hMH1pZihvPVtnP3EuZmlyc3RDaGlsZDpxLmxhc3RDaGlsZF0sZyYmcyl7az1xW3VdfHwocVt1XT17fSksaj1rW2FdfHxbXSxuPWpbMF09PT13JiZqWzFdLG09alswXT09PXcmJmpbMl0sbD1uJiZxLmNoaWxkTm9kZXNbbl07d2hpbGUobD0rK24mJmwmJmxbcF18fChtPW49MCl8fG8ucG9wKCkpaWYoMT09PWwubm9kZVR5cGUmJisrbSYmbD09PWIpe2tbYV09W3csbixtXTticmVha319ZWxzZSBpZihzJiYoaj0oYlt1XXx8KGJbdV09e30pKVthXSkmJmpbMF09PT13KW09alsxXTtlbHNlIHdoaWxlKGw9KytuJiZsJiZsW3BdfHwobT1uPTApfHxvLnBvcCgpKWlmKChoP2wubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PWwubm9kZVR5cGUpJiYrK20mJihzJiYoKGxbdV18fChsW3VdPXt9KSlbYV09W3csbV0pLGw9PT1iKSlicmVhaztyZXR1cm4gbS09ZSxtPT09ZHx8bSVkPT09MCYmbS9kPj0wfX19LFBTRVVETzpmdW5jdGlvbihhLGIpe3ZhciBjLGU9ZC5wc2V1ZG9zW2FdfHxkLnNldEZpbHRlcnNbYS50b0xvd2VyQ2FzZSgpXXx8Z2IuZXJyb3IoXCJ1bnN1cHBvcnRlZCBwc2V1ZG86IFwiK2EpO3JldHVybiBlW3VdP2UoYik6ZS5sZW5ndGg+MT8oYz1bYSxhLFwiXCIsYl0sZC5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KGEudG9Mb3dlckNhc2UoKSk/aWIoZnVuY3Rpb24oYSxjKXt2YXIgZCxmPWUoYSxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSlkPUooYSxmW2ddKSxhW2RdPSEoY1tkXT1mW2ddKX0pOmZ1bmN0aW9uKGEpe3JldHVybiBlKGEsMCxjKX0pOmV9fSxwc2V1ZG9zOntub3Q6aWIoZnVuY3Rpb24oYSl7dmFyIGI9W10sYz1bXSxkPWgoYS5yZXBsYWNlKFIsXCIkMVwiKSk7cmV0dXJuIGRbdV0/aWIoZnVuY3Rpb24oYSxiLGMsZSl7dmFyIGYsZz1kKGEsbnVsbCxlLFtdKSxoPWEubGVuZ3RoO3doaWxlKGgtLSkoZj1nW2hdKSYmKGFbaF09IShiW2hdPWYpKX0pOmZ1bmN0aW9uKGEsZSxmKXtyZXR1cm4gYlswXT1hLGQoYixudWxsLGYsYyksYlswXT1udWxsLCFjLnBvcCgpfX0pLGhhczppYihmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuIGdiKGEsYikubGVuZ3RoPjB9fSksY29udGFpbnM6aWIoZnVuY3Rpb24oYSl7cmV0dXJuIGE9YS5yZXBsYWNlKGNiLGRiKSxmdW5jdGlvbihiKXtyZXR1cm4oYi50ZXh0Q29udGVudHx8Yi5pbm5lclRleHR8fGUoYikpLmluZGV4T2YoYSk+LTF9fSksbGFuZzppYihmdW5jdGlvbihhKXtyZXR1cm4gVy50ZXN0KGF8fFwiXCIpfHxnYi5lcnJvcihcInVuc3VwcG9ydGVkIGxhbmc6IFwiK2EpLGE9YS5yZXBsYWNlKGNiLGRiKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKGIpe3ZhciBjO2RvIGlmKGM9cD9iLmxhbmc6Yi5nZXRBdHRyaWJ1dGUoXCJ4bWw6bGFuZ1wiKXx8Yi5nZXRBdHRyaWJ1dGUoXCJsYW5nXCIpKXJldHVybiBjPWMudG9Mb3dlckNhc2UoKSxjPT09YXx8MD09PWMuaW5kZXhPZihhK1wiLVwiKTt3aGlsZSgoYj1iLnBhcmVudE5vZGUpJiYxPT09Yi5ub2RlVHlwZSk7cmV0dXJuITF9fSksdGFyZ2V0OmZ1bmN0aW9uKGIpe3ZhciBjPWEubG9jYXRpb24mJmEubG9jYXRpb24uaGFzaDtyZXR1cm4gYyYmYy5zbGljZSgxKT09PWIuaWR9LHJvb3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1vfSxmb2N1czpmdW5jdGlvbihhKXtyZXR1cm4gYT09PW4uYWN0aXZlRWxlbWVudCYmKCFuLmhhc0ZvY3VzfHxuLmhhc0ZvY3VzKCkpJiYhIShhLnR5cGV8fGEuaHJlZnx8fmEudGFiSW5kZXgpfSxlbmFibGVkOmZ1bmN0aW9uKGEpe3JldHVybiBhLmRpc2FibGVkPT09ITF9LGRpc2FibGVkOmZ1bmN0aW9uKGEpe3JldHVybiBhLmRpc2FibGVkPT09ITB9LGNoZWNrZWQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVyblwiaW5wdXRcIj09PWImJiEhYS5jaGVja2VkfHxcIm9wdGlvblwiPT09YiYmISFhLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5wYXJlbnROb2RlJiZhLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxhLnNlbGVjdGVkPT09ITB9LGVtcHR5OmZ1bmN0aW9uKGEpe2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZylpZihhLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihhKXtyZXR1cm4hZC5wc2V1ZG9zLmVtcHR5KGEpfSxoZWFkZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIFoudGVzdChhLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIFkudGVzdChhLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm5cImlucHV0XCI9PT1iJiZcImJ1dHRvblwiPT09YS50eXBlfHxcImJ1dHRvblwiPT09Yn0sdGV4dDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm5cImlucHV0XCI9PT1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkmJlwidGV4dFwiPT09YS50eXBlJiYobnVsbD09KGI9YS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpKXx8XCJ0ZXh0XCI9PT1iLnRvTG93ZXJDYXNlKCkpfSxmaXJzdDpvYihmdW5jdGlvbigpe3JldHVyblswXX0pLGxhc3Q6b2IoZnVuY3Rpb24oYSxiKXtyZXR1cm5bYi0xXX0pLGVxOm9iKGZ1bmN0aW9uKGEsYixjKXtyZXR1cm5bMD5jP2MrYjpjXX0pLGV2ZW46b2IoZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MDtiPmM7Yys9MilhLnB1c2goYyk7cmV0dXJuIGF9KSxvZGQ6b2IoZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9MTtiPmM7Yys9MilhLnB1c2goYyk7cmV0dXJuIGF9KSxsdDpvYihmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPTA+Yz9jK2I6YzstLWQ+PTA7KWEucHVzaChkKTtyZXR1cm4gYX0pLGd0Om9iKGZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9MD5jP2MrYjpjOysrZDxiOylhLnB1c2goZCk7cmV0dXJuIGF9KX19LGQucHNldWRvcy5udGg9ZC5wc2V1ZG9zLmVxO2ZvcihiIGlue3JhZGlvOiEwLGNoZWNrYm94OiEwLGZpbGU6ITAscGFzc3dvcmQ6ITAsaW1hZ2U6ITB9KWQucHNldWRvc1tiXT1tYihiKTtmb3IoYiBpbntzdWJtaXQ6ITAscmVzZXQ6ITB9KWQucHNldWRvc1tiXT1uYihiKTtmdW5jdGlvbiBxYigpe31xYi5wcm90b3R5cGU9ZC5maWx0ZXJzPWQucHNldWRvcyxkLnNldEZpbHRlcnM9bmV3IHFiLGc9Z2IudG9rZW5pemU9ZnVuY3Rpb24oYSxiKXt2YXIgYyxlLGYsZyxoLGksaixrPXpbYStcIiBcIl07aWYoaylyZXR1cm4gYj8wOmsuc2xpY2UoMCk7aD1hLGk9W10saj1kLnByZUZpbHRlcjt3aGlsZShoKXsoIWN8fChlPVMuZXhlYyhoKSkpJiYoZSYmKGg9aC5zbGljZShlWzBdLmxlbmd0aCl8fGgpLGkucHVzaChmPVtdKSksYz0hMSwoZT1ULmV4ZWMoaCkpJiYoYz1lLnNoaWZ0KCksZi5wdXNoKHt2YWx1ZTpjLHR5cGU6ZVswXS5yZXBsYWNlKFIsXCIgXCIpfSksaD1oLnNsaWNlKGMubGVuZ3RoKSk7Zm9yKGcgaW4gZC5maWx0ZXIpIShlPVhbZ10uZXhlYyhoKSl8fGpbZ10mJiEoZT1qW2ddKGUpKXx8KGM9ZS5zaGlmdCgpLGYucHVzaCh7dmFsdWU6Yyx0eXBlOmcsbWF0Y2hlczplfSksaD1oLnNsaWNlKGMubGVuZ3RoKSk7aWYoIWMpYnJlYWt9cmV0dXJuIGI/aC5sZW5ndGg6aD9nYi5lcnJvcihhKTp6KGEsaSkuc2xpY2UoMCl9O2Z1bmN0aW9uIHJiKGEpe2Zvcih2YXIgYj0wLGM9YS5sZW5ndGgsZD1cIlwiO2M+YjtiKyspZCs9YVtiXS52YWx1ZTtyZXR1cm4gZH1mdW5jdGlvbiBzYihhLGIsYyl7dmFyIGQ9Yi5kaXIsZT1jJiZcInBhcmVudE5vZGVcIj09PWQsZj14Kys7cmV0dXJuIGIuZmlyc3Q/ZnVuY3Rpb24oYixjLGYpe3doaWxlKGI9YltkXSlpZigxPT09Yi5ub2RlVHlwZXx8ZSlyZXR1cm4gYShiLGMsZil9OmZ1bmN0aW9uKGIsYyxnKXt2YXIgaCxpLGo9W3csZl07aWYoZyl7d2hpbGUoYj1iW2RdKWlmKCgxPT09Yi5ub2RlVHlwZXx8ZSkmJmEoYixjLGcpKXJldHVybiEwfWVsc2Ugd2hpbGUoYj1iW2RdKWlmKDE9PT1iLm5vZGVUeXBlfHxlKXtpZihpPWJbdV18fChiW3VdPXt9KSwoaD1pW2RdKSYmaFswXT09PXcmJmhbMV09PT1mKXJldHVybiBqWzJdPWhbMl07aWYoaVtkXT1qLGpbMl09YShiLGMsZykpcmV0dXJuITB9fX1mdW5jdGlvbiB0YihhKXtyZXR1cm4gYS5sZW5ndGg+MT9mdW5jdGlvbihiLGMsZCl7dmFyIGU9YS5sZW5ndGg7d2hpbGUoZS0tKWlmKCFhW2VdKGIsYyxkKSlyZXR1cm4hMTtyZXR1cm4hMH06YVswXX1mdW5jdGlvbiB1YihhLGIsYyl7Zm9yKHZhciBkPTAsZT1iLmxlbmd0aDtlPmQ7ZCsrKWdiKGEsYltkXSxjKTtyZXR1cm4gY31mdW5jdGlvbiB2YihhLGIsYyxkLGUpe2Zvcih2YXIgZixnPVtdLGg9MCxpPWEubGVuZ3RoLGo9bnVsbCE9YjtpPmg7aCsrKShmPWFbaF0pJiYoIWN8fGMoZixkLGUpKSYmKGcucHVzaChmKSxqJiZiLnB1c2goaCkpO3JldHVybiBnfWZ1bmN0aW9uIHdiKGEsYixjLGQsZSxmKXtyZXR1cm4gZCYmIWRbdV0mJihkPXdiKGQpKSxlJiYhZVt1XSYmKGU9d2IoZSxmKSksaWIoZnVuY3Rpb24oZixnLGgsaSl7dmFyIGosayxsLG09W10sbj1bXSxvPWcubGVuZ3RoLHA9Znx8dWIoYnx8XCIqXCIsaC5ub2RlVHlwZT9baF06aCxbXSkscT0hYXx8IWYmJmI/cDp2YihwLG0sYSxoLGkpLHI9Yz9lfHwoZj9hOm98fGQpP1tdOmc6cTtpZihjJiZjKHEscixoLGkpLGQpe2o9dmIocixuKSxkKGosW10saCxpKSxrPWoubGVuZ3RoO3doaWxlKGstLSkobD1qW2tdKSYmKHJbbltrXV09IShxW25ba11dPWwpKX1pZihmKXtpZihlfHxhKXtpZihlKXtqPVtdLGs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiZqLnB1c2gocVtrXT1sKTtlKG51bGwscj1bXSxqLGkpfWs9ci5sZW5ndGg7d2hpbGUoay0tKShsPXJba10pJiYoaj1lP0ooZixsKTptW2tdKT4tMSYmKGZbal09IShnW2pdPWwpKX19ZWxzZSByPXZiKHI9PT1nP3Iuc3BsaWNlKG8sci5sZW5ndGgpOnIpLGU/ZShudWxsLGcscixpKTpILmFwcGx5KGcscil9KX1mdW5jdGlvbiB4YihhKXtmb3IodmFyIGIsYyxlLGY9YS5sZW5ndGgsZz1kLnJlbGF0aXZlW2FbMF0udHlwZV0saD1nfHxkLnJlbGF0aXZlW1wiIFwiXSxpPWc/MTowLGs9c2IoZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1ifSxoLCEwKSxsPXNiKGZ1bmN0aW9uKGEpe3JldHVybiBKKGIsYSk+LTF9LGgsITApLG09W2Z1bmN0aW9uKGEsYyxkKXt2YXIgZT0hZyYmKGR8fGMhPT1qKXx8KChiPWMpLm5vZGVUeXBlP2soYSxjLGQpOmwoYSxjLGQpKTtyZXR1cm4gYj1udWxsLGV9XTtmPmk7aSsrKWlmKGM9ZC5yZWxhdGl2ZVthW2ldLnR5cGVdKW09W3NiKHRiKG0pLGMpXTtlbHNle2lmKGM9ZC5maWx0ZXJbYVtpXS50eXBlXS5hcHBseShudWxsLGFbaV0ubWF0Y2hlcyksY1t1XSl7Zm9yKGU9KytpO2Y+ZTtlKyspaWYoZC5yZWxhdGl2ZVthW2VdLnR5cGVdKWJyZWFrO3JldHVybiB3YihpPjEmJnRiKG0pLGk+MSYmcmIoYS5zbGljZSgwLGktMSkuY29uY2F0KHt2YWx1ZTpcIiBcIj09PWFbaS0yXS50eXBlP1wiKlwiOlwiXCJ9KSkucmVwbGFjZShSLFwiJDFcIiksYyxlPmkmJnhiKGEuc2xpY2UoaSxlKSksZj5lJiZ4YihhPWEuc2xpY2UoZSkpLGY+ZSYmcmIoYSkpfW0ucHVzaChjKX1yZXR1cm4gdGIobSl9ZnVuY3Rpb24geWIoYSxiKXt2YXIgYz1iLmxlbmd0aD4wLGU9YS5sZW5ndGg+MCxmPWZ1bmN0aW9uKGYsZyxoLGksayl7dmFyIGwsbSxvLHA9MCxxPVwiMFwiLHI9ZiYmW10scz1bXSx0PWosdT1mfHxlJiZkLmZpbmQuVEFHKFwiKlwiLGspLHY9dys9bnVsbD09dD8xOk1hdGgucmFuZG9tKCl8fC4xLHg9dS5sZW5ndGg7Zm9yKGsmJihqPWchPT1uJiZnKTtxIT09eCYmbnVsbCE9KGw9dVtxXSk7cSsrKXtpZihlJiZsKXttPTA7d2hpbGUobz1hW20rK10paWYobyhsLGcsaCkpe2kucHVzaChsKTticmVha31rJiYodz12KX1jJiYoKGw9IW8mJmwpJiZwLS0sZiYmci5wdXNoKGwpKX1pZihwKz1xLGMmJnEhPT1wKXttPTA7d2hpbGUobz1iW20rK10pbyhyLHMsZyxoKTtpZihmKXtpZihwPjApd2hpbGUocS0tKXJbcV18fHNbcV18fChzW3FdPUYuY2FsbChpKSk7cz12YihzKX1ILmFwcGx5KGkscyksayYmIWYmJnMubGVuZ3RoPjAmJnArYi5sZW5ndGg+MSYmZ2IudW5pcXVlU29ydChpKX1yZXR1cm4gayYmKHc9dixqPXQpLHJ9O3JldHVybiBjP2liKGYpOmZ9cmV0dXJuIGg9Z2IuY29tcGlsZT1mdW5jdGlvbihhLGIpe3ZhciBjLGQ9W10sZT1bXSxmPUFbYStcIiBcIl07aWYoIWYpe2J8fChiPWcoYSkpLGM9Yi5sZW5ndGg7d2hpbGUoYy0tKWY9eGIoYltjXSksZlt1XT9kLnB1c2goZik6ZS5wdXNoKGYpO2Y9QShhLHliKGUsZCkpLGYuc2VsZWN0b3I9YX1yZXR1cm4gZn0saT1nYi5zZWxlY3Q9ZnVuY3Rpb24oYSxiLGUsZil7dmFyIGksaixrLGwsbSxuPVwiZnVuY3Rpb25cIj09dHlwZW9mIGEmJmEsbz0hZiYmZyhhPW4uc2VsZWN0b3J8fGEpO2lmKGU9ZXx8W10sMT09PW8ubGVuZ3RoKXtpZihqPW9bMF09b1swXS5zbGljZSgwKSxqLmxlbmd0aD4yJiZcIklEXCI9PT0oaz1qWzBdKS50eXBlJiZjLmdldEJ5SWQmJjk9PT1iLm5vZGVUeXBlJiZwJiZkLnJlbGF0aXZlW2pbMV0udHlwZV0pe2lmKGI9KGQuZmluZC5JRChrLm1hdGNoZXNbMF0ucmVwbGFjZShjYixkYiksYil8fFtdKVswXSwhYilyZXR1cm4gZTtuJiYoYj1iLnBhcmVudE5vZGUpLGE9YS5zbGljZShqLnNoaWZ0KCkudmFsdWUubGVuZ3RoKX1pPVgubmVlZHNDb250ZXh0LnRlc3QoYSk/MDpqLmxlbmd0aDt3aGlsZShpLS0pe2lmKGs9altpXSxkLnJlbGF0aXZlW2w9ay50eXBlXSlicmVhaztpZigobT1kLmZpbmRbbF0pJiYoZj1tKGsubWF0Y2hlc1swXS5yZXBsYWNlKGNiLGRiKSxhYi50ZXN0KGpbMF0udHlwZSkmJnBiKGIucGFyZW50Tm9kZSl8fGIpKSl7aWYoai5zcGxpY2UoaSwxKSxhPWYubGVuZ3RoJiZyYihqKSwhYSlyZXR1cm4gSC5hcHBseShlLGYpLGU7YnJlYWt9fX1yZXR1cm4obnx8aChhLG8pKShmLGIsIXAsZSxhYi50ZXN0KGEpJiZwYihiLnBhcmVudE5vZGUpfHxiKSxlfSxjLnNvcnRTdGFibGU9dS5zcGxpdChcIlwiKS5zb3J0KEIpLmpvaW4oXCJcIik9PT11LGMuZGV0ZWN0RHVwbGljYXRlcz0hIWwsbSgpLGMuc29ydERldGFjaGVkPWpiKGZ1bmN0aW9uKGEpe3JldHVybiAxJmEuY29tcGFyZURvY3VtZW50UG9zaXRpb24obi5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKX0pLGpiKGZ1bmN0aW9uKGEpe3JldHVybiBhLmlubmVySFRNTD1cIjxhIGhyZWY9JyMnPjwvYT5cIixcIiNcIj09PWEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpfSl8fGtiKFwidHlwZXxocmVmfGhlaWdodHx3aWR0aFwiLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYz92b2lkIDA6YS5nZXRBdHRyaWJ1dGUoYixcInR5cGVcIj09PWIudG9Mb3dlckNhc2UoKT8xOjIpfSksYy5hdHRyaWJ1dGVzJiZqYihmdW5jdGlvbihhKXtyZXR1cm4gYS5pbm5lckhUTUw9XCI8aW5wdXQvPlwiLGEuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLFwiXCIpLFwiXCI9PT1hLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIil9KXx8a2IoXCJ2YWx1ZVwiLGZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gY3x8XCJpbnB1dFwiIT09YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpP3ZvaWQgMDphLmRlZmF1bHRWYWx1ZX0pLGpiKGZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hLmdldEF0dHJpYnV0ZShcImRpc2FibGVkXCIpfSl8fGtiKEssZnVuY3Rpb24oYSxiLGMpe3ZhciBkO3JldHVybiBjP3ZvaWQgMDphW2JdPT09ITA/Yi50b0xvd2VyQ2FzZSgpOihkPWEuZ2V0QXR0cmlidXRlTm9kZShiKSkmJmQuc3BlY2lmaWVkP2QudmFsdWU6bnVsbH0pLGdifShhKTtuLmZpbmQ9dCxuLmV4cHI9dC5zZWxlY3RvcnMsbi5leHByW1wiOlwiXT1uLmV4cHIucHNldWRvcyxuLnVuaXF1ZT10LnVuaXF1ZVNvcnQsbi50ZXh0PXQuZ2V0VGV4dCxuLmlzWE1MRG9jPXQuaXNYTUwsbi5jb250YWlucz10LmNvbnRhaW5zO3ZhciB1PW4uZXhwci5tYXRjaC5uZWVkc0NvbnRleHQsdj0vXjwoXFx3KylcXHMqXFwvPz4oPzo8XFwvXFwxPnwpJC8sdz0vXi5bXjojXFxbXFwuLF0qJC87ZnVuY3Rpb24geChhLGIsYyl7aWYobi5pc0Z1bmN0aW9uKGIpKXJldHVybiBuLmdyZXAoYSxmdW5jdGlvbihhLGQpe3JldHVybiEhYi5jYWxsKGEsZCxhKSE9PWN9KTtpZihiLm5vZGVUeXBlKXJldHVybiBuLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gYT09PWIhPT1jfSk7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGIpe2lmKHcudGVzdChiKSlyZXR1cm4gbi5maWx0ZXIoYixhLGMpO2I9bi5maWx0ZXIoYixhKX1yZXR1cm4gbi5ncmVwKGEsZnVuY3Rpb24oYSl7cmV0dXJuIGcuY2FsbChiLGEpPj0wIT09Y30pfW4uZmlsdGVyPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iWzBdO3JldHVybiBjJiYoYT1cIjpub3QoXCIrYStcIilcIiksMT09PWIubGVuZ3RoJiYxPT09ZC5ub2RlVHlwZT9uLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGQsYSk/W2RdOltdOm4uZmluZC5tYXRjaGVzKGEsbi5ncmVwKGIsZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfSkpfSxuLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXt2YXIgYixjPXRoaXMubGVuZ3RoLGQ9W10sZT10aGlzO2lmKFwic3RyaW5nXCIhPXR5cGVvZiBhKXJldHVybiB0aGlzLnB1c2hTdGFjayhuKGEpLmZpbHRlcihmdW5jdGlvbigpe2ZvcihiPTA7Yz5iO2IrKylpZihuLmNvbnRhaW5zKGVbYl0sdGhpcykpcmV0dXJuITB9KSk7Zm9yKGI9MDtjPmI7YisrKW4uZmluZChhLGVbYl0sZCk7cmV0dXJuIGQ9dGhpcy5wdXNoU3RhY2soYz4xP24udW5pcXVlKGQpOmQpLGQuc2VsZWN0b3I9dGhpcy5zZWxlY3Rvcj90aGlzLnNlbGVjdG9yK1wiIFwiK2E6YSxkfSxmaWx0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHgodGhpcyxhfHxbXSwhMSkpfSxub3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHgodGhpcyxhfHxbXSwhMCkpfSxpczpmdW5jdGlvbihhKXtyZXR1cm4hIXgodGhpcyxcInN0cmluZ1wiPT10eXBlb2YgYSYmdS50ZXN0KGEpP24oYSk6YXx8W10sITEpLmxlbmd0aH19KTt2YXIgeSx6PS9eKD86XFxzKig8W1xcd1xcV10rPilbXj5dKnwjKFtcXHctXSopKSQvLEE9bi5mbi5pbml0PWZ1bmN0aW9uKGEsYil7dmFyIGMsZDtpZighYSlyZXR1cm4gdGhpcztpZihcInN0cmluZ1wiPT10eXBlb2YgYSl7aWYoYz1cIjxcIj09PWFbMF0mJlwiPlwiPT09YVthLmxlbmd0aC0xXSYmYS5sZW5ndGg+PTM/W251bGwsYSxudWxsXTp6LmV4ZWMoYSksIWN8fCFjWzFdJiZiKXJldHVybiFifHxiLmpxdWVyeT8oYnx8eSkuZmluZChhKTp0aGlzLmNvbnN0cnVjdG9yKGIpLmZpbmQoYSk7aWYoY1sxXSl7aWYoYj1iIGluc3RhbmNlb2Ygbj9iWzBdOmIsbi5tZXJnZSh0aGlzLG4ucGFyc2VIVE1MKGNbMV0sYiYmYi5ub2RlVHlwZT9iLm93bmVyRG9jdW1lbnR8fGI6bCwhMCkpLHYudGVzdChjWzFdKSYmbi5pc1BsYWluT2JqZWN0KGIpKWZvcihjIGluIGIpbi5pc0Z1bmN0aW9uKHRoaXNbY10pP3RoaXNbY10oYltjXSk6dGhpcy5hdHRyKGMsYltjXSk7cmV0dXJuIHRoaXN9cmV0dXJuIGQ9bC5nZXRFbGVtZW50QnlJZChjWzJdKSxkJiZkLnBhcmVudE5vZGUmJih0aGlzLmxlbmd0aD0xLHRoaXNbMF09ZCksdGhpcy5jb250ZXh0PWwsdGhpcy5zZWxlY3Rvcj1hLHRoaXN9cmV0dXJuIGEubm9kZVR5cGU/KHRoaXMuY29udGV4dD10aGlzWzBdPWEsdGhpcy5sZW5ndGg9MSx0aGlzKTpuLmlzRnVuY3Rpb24oYSk/XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHkucmVhZHk/eS5yZWFkeShhKTphKG4pOih2b2lkIDAhPT1hLnNlbGVjdG9yJiYodGhpcy5zZWxlY3Rvcj1hLnNlbGVjdG9yLHRoaXMuY29udGV4dD1hLmNvbnRleHQpLG4ubWFrZUFycmF5KGEsdGhpcykpfTtBLnByb3RvdHlwZT1uLmZuLHk9bihsKTt2YXIgQj0vXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLyxDPXtjaGlsZHJlbjohMCxjb250ZW50czohMCxuZXh0OiEwLHByZXY6ITB9O24uZXh0ZW5kKHtkaXI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGU9dm9pZCAwIT09Yzt3aGlsZSgoYT1hW2JdKSYmOSE9PWEubm9kZVR5cGUpaWYoMT09PWEubm9kZVR5cGUpe2lmKGUmJm4oYSkuaXMoYykpYnJlYWs7ZC5wdXNoKGEpfXJldHVybiBkfSxzaWJsaW5nOmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPVtdO2E7YT1hLm5leHRTaWJsaW5nKTE9PT1hLm5vZGVUeXBlJiZhIT09YiYmYy5wdXNoKGEpO3JldHVybiBjfX0pLG4uZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24oYSl7dmFyIGI9bihhLHRoaXMpLGM9Yi5sZW5ndGg7cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCl7Zm9yKHZhciBhPTA7Yz5hO2ErKylpZihuLmNvbnRhaW5zKHRoaXMsYlthXSkpcmV0dXJuITB9KX0sY2xvc2VzdDpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYyxkPTAsZT10aGlzLmxlbmd0aCxmPVtdLGc9dS50ZXN0KGEpfHxcInN0cmluZ1wiIT10eXBlb2YgYT9uKGEsYnx8dGhpcy5jb250ZXh0KTowO2U+ZDtkKyspZm9yKGM9dGhpc1tkXTtjJiZjIT09YjtjPWMucGFyZW50Tm9kZSlpZihjLm5vZGVUeXBlPDExJiYoZz9nLmluZGV4KGMpPi0xOjE9PT1jLm5vZGVUeXBlJiZuLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGMsYSkpKXtmLnB1c2goYyk7YnJlYWt9cmV0dXJuIHRoaXMucHVzaFN0YWNrKGYubGVuZ3RoPjE/bi51bmlxdWUoZik6Zil9LGluZGV4OmZ1bmN0aW9uKGEpe3JldHVybiBhP1wic3RyaW5nXCI9PXR5cGVvZiBhP2cuY2FsbChuKGEpLHRoaXNbMF0pOmcuY2FsbCh0aGlzLGEuanF1ZXJ5P2FbMF06YSk6dGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlP3RoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoOi0xfSxhZGQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sobi51bmlxdWUobi5tZXJnZSh0aGlzLmdldCgpLG4oYSxiKSkpKX0sYWRkQmFjazpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5hZGQobnVsbD09YT90aGlzLnByZXZPYmplY3Q6dGhpcy5wcmV2T2JqZWN0LmZpbHRlcihhKSl9fSk7ZnVuY3Rpb24gRChhLGIpe3doaWxlKChhPWFbYl0pJiYxIT09YS5ub2RlVHlwZSk7cmV0dXJuIGF9bi5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnROb2RlO3JldHVybiBiJiYxMSE9PWIubm9kZVR5cGU/YjpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBuLmRpcihhLFwicGFyZW50Tm9kZVwiKX0scGFyZW50c1VudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbi5kaXIoYSxcInBhcmVudE5vZGVcIixjKX0sbmV4dDpmdW5jdGlvbihhKXtyZXR1cm4gRChhLFwibmV4dFNpYmxpbmdcIil9LHByZXY6ZnVuY3Rpb24oYSl7cmV0dXJuIEQoYSxcInByZXZpb3VzU2libGluZ1wiKX0sbmV4dEFsbDpmdW5jdGlvbihhKXtyZXR1cm4gbi5kaXIoYSxcIm5leHRTaWJsaW5nXCIpfSxwcmV2QWxsOmZ1bmN0aW9uKGEpe3JldHVybiBuLmRpcihhLFwicHJldmlvdXNTaWJsaW5nXCIpfSxuZXh0VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBuLmRpcihhLFwibmV4dFNpYmxpbmdcIixjKX0scHJldlVudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbi5kaXIoYSxcInByZXZpb3VzU2libGluZ1wiLGMpfSxzaWJsaW5nczpmdW5jdGlvbihhKXtyZXR1cm4gbi5zaWJsaW5nKChhLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGEpfSxjaGlsZHJlbjpmdW5jdGlvbihhKXtyZXR1cm4gbi5zaWJsaW5nKGEuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBhLmNvbnRlbnREb2N1bWVudHx8bi5tZXJnZShbXSxhLmNoaWxkTm9kZXMpfX0sZnVuY3Rpb24oYSxiKXtuLmZuW2FdPWZ1bmN0aW9uKGMsZCl7dmFyIGU9bi5tYXAodGhpcyxiLGMpO3JldHVyblwiVW50aWxcIiE9PWEuc2xpY2UoLTUpJiYoZD1jKSxkJiZcInN0cmluZ1wiPT10eXBlb2YgZCYmKGU9bi5maWx0ZXIoZCxlKSksdGhpcy5sZW5ndGg+MSYmKENbYV18fG4udW5pcXVlKGUpLEIudGVzdChhKSYmZS5yZXZlcnNlKCkpLHRoaXMucHVzaFN0YWNrKGUpfX0pO3ZhciBFPS9cXFMrL2csRj17fTtmdW5jdGlvbiBHKGEpe3ZhciBiPUZbYV09e307cmV0dXJuIG4uZWFjaChhLm1hdGNoKEUpfHxbXSxmdW5jdGlvbihhLGMpe2JbY109ITB9KSxifW4uQ2FsbGJhY2tzPWZ1bmN0aW9uKGEpe2E9XCJzdHJpbmdcIj09dHlwZW9mIGE/RlthXXx8RyhhKTpuLmV4dGVuZCh7fSxhKTt2YXIgYixjLGQsZSxmLGcsaD1bXSxpPSFhLm9uY2UmJltdLGo9ZnVuY3Rpb24obCl7Zm9yKGI9YS5tZW1vcnkmJmwsYz0hMCxnPWV8fDAsZT0wLGY9aC5sZW5ndGgsZD0hMDtoJiZmPmc7ZysrKWlmKGhbZ10uYXBwbHkobFswXSxsWzFdKT09PSExJiZhLnN0b3BPbkZhbHNlKXtiPSExO2JyZWFrfWQ9ITEsaCYmKGk/aS5sZW5ndGgmJmooaS5zaGlmdCgpKTpiP2g9W106ay5kaXNhYmxlKCkpfSxrPXthZGQ6ZnVuY3Rpb24oKXtpZihoKXt2YXIgYz1oLmxlbmd0aDshZnVuY3Rpb24gZyhiKXtuLmVhY2goYixmdW5jdGlvbihiLGMpe3ZhciBkPW4udHlwZShjKTtcImZ1bmN0aW9uXCI9PT1kP2EudW5pcXVlJiZrLmhhcyhjKXx8aC5wdXNoKGMpOmMmJmMubGVuZ3RoJiZcInN0cmluZ1wiIT09ZCYmZyhjKX0pfShhcmd1bWVudHMpLGQ/Zj1oLmxlbmd0aDpiJiYoZT1jLGooYikpfXJldHVybiB0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gaCYmbi5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihhLGIpe3ZhciBjO3doaWxlKChjPW4uaW5BcnJheShiLGgsYykpPi0xKWguc3BsaWNlKGMsMSksZCYmKGY+PWMmJmYtLSxnPj1jJiZnLS0pfSksdGhpc30saGFzOmZ1bmN0aW9uKGEpe3JldHVybiBhP24uaW5BcnJheShhLGgpPi0xOiEoIWh8fCFoLmxlbmd0aCl9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIGg9W10sZj0wLHRoaXN9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gaD1pPWI9dm9pZCAwLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIWh9LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gaT12b2lkIDAsYnx8ay5kaXNhYmxlKCksdGhpc30sbG9ja2VkOmZ1bmN0aW9uKCl7cmV0dXJuIWl9LGZpcmVXaXRoOmZ1bmN0aW9uKGEsYil7cmV0dXJuIWh8fGMmJiFpfHwoYj1ifHxbXSxiPVthLGIuc2xpY2U/Yi5zbGljZSgpOmJdLGQ/aS5wdXNoKGIpOmooYikpLHRoaXN9LGZpcmU6ZnVuY3Rpb24oKXtyZXR1cm4gay5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyksdGhpc30sZmlyZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIWN9fTtyZXR1cm4ga30sbi5leHRlbmQoe0RlZmVycmVkOmZ1bmN0aW9uKGEpe3ZhciBiPVtbXCJyZXNvbHZlXCIsXCJkb25lXCIsbi5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxcInJlc29sdmVkXCJdLFtcInJlamVjdFwiLFwiZmFpbFwiLG4uQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIiksXCJyZWplY3RlZFwiXSxbXCJub3RpZnlcIixcInByb2dyZXNzXCIsbi5DYWxsYmFja3MoXCJtZW1vcnlcIildXSxjPVwicGVuZGluZ1wiLGQ9e3N0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGN9LGFsd2F5czpmdW5jdGlvbigpe3JldHVybiBlLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksdGhpc30sdGhlbjpmdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50cztyZXR1cm4gbi5EZWZlcnJlZChmdW5jdGlvbihjKXtuLmVhY2goYixmdW5jdGlvbihiLGYpe3ZhciBnPW4uaXNGdW5jdGlvbihhW2JdKSYmYVtiXTtlW2ZbMV1dKGZ1bmN0aW9uKCl7dmFyIGE9ZyYmZy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7YSYmbi5pc0Z1bmN0aW9uKGEucHJvbWlzZSk/YS5wcm9taXNlKCkuZG9uZShjLnJlc29sdmUpLmZhaWwoYy5yZWplY3QpLnByb2dyZXNzKGMubm90aWZ5KTpjW2ZbMF0rXCJXaXRoXCJdKHRoaXM9PT1kP2MucHJvbWlzZSgpOnRoaXMsZz9bYV06YXJndW1lbnRzKX0pfSksYT1udWxsfSkucHJvbWlzZSgpfSxwcm9taXNlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hP24uZXh0ZW5kKGEsZCk6ZH19LGU9e307cmV0dXJuIGQucGlwZT1kLnRoZW4sbi5lYWNoKGIsZnVuY3Rpb24oYSxmKXt2YXIgZz1mWzJdLGg9ZlszXTtkW2ZbMV1dPWcuYWRkLGgmJmcuYWRkKGZ1bmN0aW9uKCl7Yz1ofSxiWzFeYV1bMl0uZGlzYWJsZSxiWzJdWzJdLmxvY2spLGVbZlswXV09ZnVuY3Rpb24oKXtyZXR1cm4gZVtmWzBdK1wiV2l0aFwiXSh0aGlzPT09ZT9kOnRoaXMsYXJndW1lbnRzKSx0aGlzfSxlW2ZbMF0rXCJXaXRoXCJdPWcuZmlyZVdpdGh9KSxkLnByb21pc2UoZSksYSYmYS5jYWxsKGUsZSksZX0sd2hlbjpmdW5jdGlvbihhKXt2YXIgYj0wLGM9ZC5jYWxsKGFyZ3VtZW50cyksZT1jLmxlbmd0aCxmPTEhPT1lfHxhJiZuLmlzRnVuY3Rpb24oYS5wcm9taXNlKT9lOjAsZz0xPT09Zj9hOm4uRGVmZXJyZWQoKSxoPWZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oZSl7YlthXT10aGlzLGNbYV09YXJndW1lbnRzLmxlbmd0aD4xP2QuY2FsbChhcmd1bWVudHMpOmUsYz09PWk/Zy5ub3RpZnlXaXRoKGIsYyk6LS1mfHxnLnJlc29sdmVXaXRoKGIsYyl9fSxpLGosaztpZihlPjEpZm9yKGk9bmV3IEFycmF5KGUpLGo9bmV3IEFycmF5KGUpLGs9bmV3IEFycmF5KGUpO2U+YjtiKyspY1tiXSYmbi5pc0Z1bmN0aW9uKGNbYl0ucHJvbWlzZSk/Y1tiXS5wcm9taXNlKCkuZG9uZShoKGIsayxjKSkuZmFpbChnLnJlamVjdCkucHJvZ3Jlc3MoaChiLGosaSkpOi0tZjtyZXR1cm4gZnx8Zy5yZXNvbHZlV2l0aChrLGMpLGcucHJvbWlzZSgpfX0pO3ZhciBIO24uZm4ucmVhZHk9ZnVuY3Rpb24oYSl7cmV0dXJuIG4ucmVhZHkucHJvbWlzZSgpLmRvbmUoYSksdGhpc30sbi5leHRlbmQoe2lzUmVhZHk6ITEscmVhZHlXYWl0OjEsaG9sZFJlYWR5OmZ1bmN0aW9uKGEpe2E/bi5yZWFkeVdhaXQrKzpuLnJlYWR5KCEwKX0scmVhZHk6ZnVuY3Rpb24oYSl7KGE9PT0hMD8tLW4ucmVhZHlXYWl0Om4uaXNSZWFkeSl8fChuLmlzUmVhZHk9ITAsYSE9PSEwJiYtLW4ucmVhZHlXYWl0PjB8fChILnJlc29sdmVXaXRoKGwsW25dKSxuLmZuLnRyaWdnZXJIYW5kbGVyJiYobihsKS50cmlnZ2VySGFuZGxlcihcInJlYWR5XCIpLG4obCkub2ZmKFwicmVhZHlcIikpKSl9fSk7ZnVuY3Rpb24gSSgpe2wucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixJLCExKSxhLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsSSwhMSksbi5yZWFkeSgpfW4ucmVhZHkucHJvbWlzZT1mdW5jdGlvbihiKXtyZXR1cm4gSHx8KEg9bi5EZWZlcnJlZCgpLFwiY29tcGxldGVcIj09PWwucmVhZHlTdGF0ZT9zZXRUaW1lb3V0KG4ucmVhZHkpOihsLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsSSwhMSksYS5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLEksITEpKSksSC5wcm9taXNlKGIpfSxuLnJlYWR5LnByb21pc2UoKTt2YXIgSj1uLmFjY2Vzcz1mdW5jdGlvbihhLGIsYyxkLGUsZixnKXt2YXIgaD0wLGk9YS5sZW5ndGgsaj1udWxsPT1jO2lmKFwib2JqZWN0XCI9PT1uLnR5cGUoYykpe2U9ITA7Zm9yKGggaW4gYyluLmFjY2VzcyhhLGIsaCxjW2hdLCEwLGYsZyl9ZWxzZSBpZih2b2lkIDAhPT1kJiYoZT0hMCxuLmlzRnVuY3Rpb24oZCl8fChnPSEwKSxqJiYoZz8oYi5jYWxsKGEsZCksYj1udWxsKTooaj1iLGI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBqLmNhbGwobihhKSxjKX0pKSxiKSlmb3IoO2k+aDtoKyspYihhW2hdLGMsZz9kOmQuY2FsbChhW2hdLGgsYihhW2hdLGMpKSk7cmV0dXJuIGU/YTpqP2IuY2FsbChhKTppP2IoYVswXSxjKTpmfTtuLmFjY2VwdERhdGE9ZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfHw5PT09YS5ub2RlVHlwZXx8ISthLm5vZGVUeXBlfTtmdW5jdGlvbiBLKCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuY2FjaGU9e30sMCx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJue319fSksdGhpcy5leHBhbmRvPW4uZXhwYW5kbytLLnVpZCsrfUsudWlkPTEsSy5hY2NlcHRzPW4uYWNjZXB0RGF0YSxLLnByb3RvdHlwZT17a2V5OmZ1bmN0aW9uKGEpe2lmKCFLLmFjY2VwdHMoYSkpcmV0dXJuIDA7dmFyIGI9e30sYz1hW3RoaXMuZXhwYW5kb107aWYoIWMpe2M9Sy51aWQrKzt0cnl7Ylt0aGlzLmV4cGFuZG9dPXt2YWx1ZTpjfSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhLGIpfWNhdGNoKGQpe2JbdGhpcy5leHBhbmRvXT1jLG4uZXh0ZW5kKGEsYil9fXJldHVybiB0aGlzLmNhY2hlW2NdfHwodGhpcy5jYWNoZVtjXT17fSksY30sc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPXRoaXMua2V5KGEpLGY9dGhpcy5jYWNoZVtlXTtpZihcInN0cmluZ1wiPT10eXBlb2YgYilmW2JdPWM7ZWxzZSBpZihuLmlzRW1wdHlPYmplY3QoZikpbi5leHRlbmQodGhpcy5jYWNoZVtlXSxiKTtlbHNlIGZvcihkIGluIGIpZltkXT1iW2RdO3JldHVybiBmfSxnZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNhY2hlW3RoaXMua2V5KGEpXTtyZXR1cm4gdm9pZCAwPT09Yj9jOmNbYl19LGFjY2VzczpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7cmV0dXJuIHZvaWQgMD09PWJ8fGImJlwic3RyaW5nXCI9PXR5cGVvZiBiJiZ2b2lkIDA9PT1jPyhkPXRoaXMuZ2V0KGEsYiksdm9pZCAwIT09ZD9kOnRoaXMuZ2V0KGEsbi5jYW1lbENhc2UoYikpKToodGhpcy5zZXQoYSxiLGMpLHZvaWQgMCE9PWM/YzpiKX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpcy5rZXkoYSksZz10aGlzLmNhY2hlW2ZdO2lmKHZvaWQgMD09PWIpdGhpcy5jYWNoZVtmXT17fTtlbHNle24uaXNBcnJheShiKT9kPWIuY29uY2F0KGIubWFwKG4uY2FtZWxDYXNlKSk6KGU9bi5jYW1lbENhc2UoYiksYiBpbiBnP2Q9W2IsZV06KGQ9ZSxkPWQgaW4gZz9bZF06ZC5tYXRjaChFKXx8W10pKSxjPWQubGVuZ3RoO3doaWxlKGMtLSlkZWxldGUgZ1tkW2NdXX19LGhhc0RhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIW4uaXNFbXB0eU9iamVjdCh0aGlzLmNhY2hlW2FbdGhpcy5leHBhbmRvXV18fHt9KX0sZGlzY2FyZDpmdW5jdGlvbihhKXthW3RoaXMuZXhwYW5kb10mJmRlbGV0ZSB0aGlzLmNhY2hlW2FbdGhpcy5leHBhbmRvXV19fTt2YXIgTD1uZXcgSyxNPW5ldyBLLE49L14oPzpcXHtbXFx3XFxXXSpcXH18XFxbW1xcd1xcV10qXFxdKSQvLE89LyhbQS1aXSkvZztmdW5jdGlvbiBQKGEsYixjKXt2YXIgZDtpZih2b2lkIDA9PT1jJiYxPT09YS5ub2RlVHlwZSlpZihkPVwiZGF0YS1cIitiLnJlcGxhY2UoTyxcIi0kMVwiKS50b0xvd2VyQ2FzZSgpLGM9YS5nZXRBdHRyaWJ1dGUoZCksXCJzdHJpbmdcIj09dHlwZW9mIGMpe3RyeXtjPVwidHJ1ZVwiPT09Yz8hMDpcImZhbHNlXCI9PT1jPyExOlwibnVsbFwiPT09Yz9udWxsOitjK1wiXCI9PT1jPytjOk4udGVzdChjKT9uLnBhcnNlSlNPTihjKTpjfWNhdGNoKGUpe31NLnNldChhLGIsYyl9ZWxzZSBjPXZvaWQgMDtyZXR1cm4gY31uLmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gTS5oYXNEYXRhKGEpfHxMLmhhc0RhdGEoYSl9LGRhdGE6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBNLmFjY2VzcyhhLGIsYylcclxufSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEsYil7TS5yZW1vdmUoYSxiKX0sX2RhdGE6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBMLmFjY2VzcyhhLGIsYyl9LF9yZW1vdmVEYXRhOmZ1bmN0aW9uKGEsYil7TC5yZW1vdmUoYSxiKX19KSxuLmZuLmV4dGVuZCh7ZGF0YTpmdW5jdGlvbihhLGIpe3ZhciBjLGQsZSxmPXRoaXNbMF0sZz1mJiZmLmF0dHJpYnV0ZXM7aWYodm9pZCAwPT09YSl7aWYodGhpcy5sZW5ndGgmJihlPU0uZ2V0KGYpLDE9PT1mLm5vZGVUeXBlJiYhTC5nZXQoZixcImhhc0RhdGFBdHRyc1wiKSkpe2M9Zy5sZW5ndGg7d2hpbGUoYy0tKWdbY10mJihkPWdbY10ubmFtZSwwPT09ZC5pbmRleE9mKFwiZGF0YS1cIikmJihkPW4uY2FtZWxDYXNlKGQuc2xpY2UoNSkpLFAoZixkLGVbZF0pKSk7TC5zZXQoZixcImhhc0RhdGFBdHRyc1wiLCEwKX1yZXR1cm4gZX1yZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgYT90aGlzLmVhY2goZnVuY3Rpb24oKXtNLnNldCh0aGlzLGEpfSk6Sih0aGlzLGZ1bmN0aW9uKGIpe3ZhciBjLGQ9bi5jYW1lbENhc2UoYSk7aWYoZiYmdm9pZCAwPT09Yil7aWYoYz1NLmdldChmLGEpLHZvaWQgMCE9PWMpcmV0dXJuIGM7aWYoYz1NLmdldChmLGQpLHZvaWQgMCE9PWMpcmV0dXJuIGM7aWYoYz1QKGYsZCx2b2lkIDApLHZvaWQgMCE9PWMpcmV0dXJuIGN9ZWxzZSB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYz1NLmdldCh0aGlzLGQpO00uc2V0KHRoaXMsZCxiKSwtMSE9PWEuaW5kZXhPZihcIi1cIikmJnZvaWQgMCE9PWMmJk0uc2V0KHRoaXMsYSxiKX0pfSxudWxsLGIsYXJndW1lbnRzLmxlbmd0aD4xLG51bGwsITApfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtNLnJlbW92ZSh0aGlzLGEpfSl9fSksbi5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZDtyZXR1cm4gYT8oYj0oYnx8XCJmeFwiKStcInF1ZXVlXCIsZD1MLmdldChhLGIpLGMmJighZHx8bi5pc0FycmF5KGMpP2Q9TC5hY2Nlc3MoYSxiLG4ubWFrZUFycmF5KGMpKTpkLnB1c2goYykpLGR8fFtdKTp2b2lkIDB9LGRlcXVldWU6ZnVuY3Rpb24oYSxiKXtiPWJ8fFwiZnhcIjt2YXIgYz1uLnF1ZXVlKGEsYiksZD1jLmxlbmd0aCxlPWMuc2hpZnQoKSxmPW4uX3F1ZXVlSG9va3MoYSxiKSxnPWZ1bmN0aW9uKCl7bi5kZXF1ZXVlKGEsYil9O1wiaW5wcm9ncmVzc1wiPT09ZSYmKGU9Yy5zaGlmdCgpLGQtLSksZSYmKFwiZnhcIj09PWImJmMudW5zaGlmdChcImlucHJvZ3Jlc3NcIiksZGVsZXRlIGYuc3RvcCxlLmNhbGwoYSxnLGYpKSwhZCYmZiYmZi5lbXB0eS5maXJlKCl9LF9xdWV1ZUhvb2tzOmZ1bmN0aW9uKGEsYil7dmFyIGM9YitcInF1ZXVlSG9va3NcIjtyZXR1cm4gTC5nZXQoYSxjKXx8TC5hY2Nlc3MoYSxjLHtlbXB0eTpuLkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLmFkZChmdW5jdGlvbigpe0wucmVtb3ZlKGEsW2IrXCJxdWV1ZVwiLGNdKX0pfSl9fSksbi5mbi5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYil7dmFyIGM9MjtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2YgYSYmKGI9YSxhPVwiZnhcIixjLS0pLGFyZ3VtZW50cy5sZW5ndGg8Yz9uLnF1ZXVlKHRoaXNbMF0sYSk6dm9pZCAwPT09Yj90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPW4ucXVldWUodGhpcyxhLGIpO24uX3F1ZXVlSG9va3ModGhpcyxhKSxcImZ4XCI9PT1hJiZcImlucHJvZ3Jlc3NcIiE9PWNbMF0mJm4uZGVxdWV1ZSh0aGlzLGEpfSl9LGRlcXVldWU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe24uZGVxdWV1ZSh0aGlzLGEpfSl9LGNsZWFyUXVldWU6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucXVldWUoYXx8XCJmeFwiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MSxlPW4uRGVmZXJyZWQoKSxmPXRoaXMsZz10aGlzLmxlbmd0aCxoPWZ1bmN0aW9uKCl7LS1kfHxlLnJlc29sdmVXaXRoKGYsW2ZdKX07XCJzdHJpbmdcIiE9dHlwZW9mIGEmJihiPWEsYT12b2lkIDApLGE9YXx8XCJmeFwiO3doaWxlKGctLSljPUwuZ2V0KGZbZ10sYStcInF1ZXVlSG9va3NcIiksYyYmYy5lbXB0eSYmKGQrKyxjLmVtcHR5LmFkZChoKSk7cmV0dXJuIGgoKSxlLnByb21pc2UoYil9fSk7dmFyIFE9L1srLV0/KD86XFxkKlxcLnwpXFxkKyg/OltlRV1bKy1dP1xcZCt8KS8uc291cmNlLFI9W1wiVG9wXCIsXCJSaWdodFwiLFwiQm90dG9tXCIsXCJMZWZ0XCJdLFM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1ifHxhLFwibm9uZVwiPT09bi5jc3MoYSxcImRpc3BsYXlcIil8fCFuLmNvbnRhaW5zKGEub3duZXJEb2N1bWVudCxhKX0sVD0vXig/OmNoZWNrYm94fHJhZGlvKSQvaTshZnVuY3Rpb24oKXt2YXIgYT1sLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxiPWEuYXBwZW5kQ2hpbGQobC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKSxjPWwuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO2Muc2V0QXR0cmlidXRlKFwidHlwZVwiLFwicmFkaW9cIiksYy5zZXRBdHRyaWJ1dGUoXCJjaGVja2VkXCIsXCJjaGVja2VkXCIpLGMuc2V0QXR0cmlidXRlKFwibmFtZVwiLFwidFwiKSxiLmFwcGVuZENoaWxkKGMpLGsuY2hlY2tDbG9uZT1iLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxiLmlubmVySFRNTD1cIjx0ZXh0YXJlYT54PC90ZXh0YXJlYT5cIixrLm5vQ2xvbmVDaGVja2VkPSEhYi5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWV9KCk7dmFyIFU9XCJ1bmRlZmluZWRcIjtrLmZvY3VzaW5CdWJibGVzPVwib25mb2N1c2luXCJpbiBhO3ZhciBWPS9ea2V5LyxXPS9eKD86bW91c2V8cG9pbnRlcnxjb250ZXh0bWVudSl8Y2xpY2svLFg9L14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLFk9L14oW14uXSopKD86XFwuKC4rKXwpJC87ZnVuY3Rpb24gWigpe3JldHVybiEwfWZ1bmN0aW9uICQoKXtyZXR1cm4hMX1mdW5jdGlvbiBfKCl7dHJ5e3JldHVybiBsLmFjdGl2ZUVsZW1lbnR9Y2F0Y2goYSl7fX1uLmV2ZW50PXtnbG9iYWw6e30sYWRkOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGYsZyxoLGksaixrLGwsbSxvLHAscSxyPUwuZ2V0KGEpO2lmKHIpe2MuaGFuZGxlciYmKGY9YyxjPWYuaGFuZGxlcixlPWYuc2VsZWN0b3IpLGMuZ3VpZHx8KGMuZ3VpZD1uLmd1aWQrKyksKGk9ci5ldmVudHMpfHwoaT1yLmV2ZW50cz17fSksKGc9ci5oYW5kbGUpfHwoZz1yLmhhbmRsZT1mdW5jdGlvbihiKXtyZXR1cm4gdHlwZW9mIG4hPT1VJiZuLmV2ZW50LnRyaWdnZXJlZCE9PWIudHlwZT9uLmV2ZW50LmRpc3BhdGNoLmFwcGx5KGEsYXJndW1lbnRzKTp2b2lkIDB9KSxiPShifHxcIlwiKS5tYXRjaChFKXx8W1wiXCJdLGo9Yi5sZW5ndGg7d2hpbGUoai0tKWg9WS5leGVjKGJbal0pfHxbXSxvPXE9aFsxXSxwPShoWzJdfHxcIlwiKS5zcGxpdChcIi5cIikuc29ydCgpLG8mJihsPW4uZXZlbnQuc3BlY2lhbFtvXXx8e30sbz0oZT9sLmRlbGVnYXRlVHlwZTpsLmJpbmRUeXBlKXx8byxsPW4uZXZlbnQuc3BlY2lhbFtvXXx8e30saz1uLmV4dGVuZCh7dHlwZTpvLG9yaWdUeXBlOnEsZGF0YTpkLGhhbmRsZXI6YyxndWlkOmMuZ3VpZCxzZWxlY3RvcjplLG5lZWRzQ29udGV4dDplJiZuLmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoZSksbmFtZXNwYWNlOnAuam9pbihcIi5cIil9LGYpLChtPWlbb10pfHwobT1pW29dPVtdLG0uZGVsZWdhdGVDb3VudD0wLGwuc2V0dXAmJmwuc2V0dXAuY2FsbChhLGQscCxnKSE9PSExfHxhLmFkZEV2ZW50TGlzdGVuZXImJmEuYWRkRXZlbnRMaXN0ZW5lcihvLGcsITEpKSxsLmFkZCYmKGwuYWRkLmNhbGwoYSxrKSxrLmhhbmRsZXIuZ3VpZHx8KGsuaGFuZGxlci5ndWlkPWMuZ3VpZCkpLGU/bS5zcGxpY2UobS5kZWxlZ2F0ZUNvdW50KyssMCxrKTptLnB1c2goayksbi5ldmVudC5nbG9iYWxbb109ITApfX0scmVtb3ZlOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGYsZyxoLGksaixrLGwsbSxvLHAscSxyPUwuaGFzRGF0YShhKSYmTC5nZXQoYSk7aWYociYmKGk9ci5ldmVudHMpKXtiPShifHxcIlwiKS5tYXRjaChFKXx8W1wiXCJdLGo9Yi5sZW5ndGg7d2hpbGUoai0tKWlmKGg9WS5leGVjKGJbal0pfHxbXSxvPXE9aFsxXSxwPShoWzJdfHxcIlwiKS5zcGxpdChcIi5cIikuc29ydCgpLG8pe2w9bi5ldmVudC5zcGVjaWFsW29dfHx7fSxvPShkP2wuZGVsZWdhdGVUeXBlOmwuYmluZFR5cGUpfHxvLG09aVtvXXx8W10saD1oWzJdJiZuZXcgUmVnRXhwKFwiKF58XFxcXC4pXCIrcC5qb2luKFwiXFxcXC4oPzouKlxcXFwufClcIikrXCIoXFxcXC58JClcIiksZz1mPW0ubGVuZ3RoO3doaWxlKGYtLSlrPW1bZl0sIWUmJnEhPT1rLm9yaWdUeXBlfHxjJiZjLmd1aWQhPT1rLmd1aWR8fGgmJiFoLnRlc3Qoay5uYW1lc3BhY2UpfHxkJiZkIT09ay5zZWxlY3RvciYmKFwiKipcIiE9PWR8fCFrLnNlbGVjdG9yKXx8KG0uc3BsaWNlKGYsMSksay5zZWxlY3RvciYmbS5kZWxlZ2F0ZUNvdW50LS0sbC5yZW1vdmUmJmwucmVtb3ZlLmNhbGwoYSxrKSk7ZyYmIW0ubGVuZ3RoJiYobC50ZWFyZG93biYmbC50ZWFyZG93bi5jYWxsKGEscCxyLmhhbmRsZSkhPT0hMXx8bi5yZW1vdmVFdmVudChhLG8sci5oYW5kbGUpLGRlbGV0ZSBpW29dKX1lbHNlIGZvcihvIGluIGkpbi5ldmVudC5yZW1vdmUoYSxvK2Jbal0sYyxkLCEwKTtuLmlzRW1wdHlPYmplY3QoaSkmJihkZWxldGUgci5oYW5kbGUsTC5yZW1vdmUoYSxcImV2ZW50c1wiKSl9fSx0cmlnZ2VyOmZ1bmN0aW9uKGIsYyxkLGUpe3ZhciBmLGcsaCxpLGssbSxvLHA9W2R8fGxdLHE9ai5jYWxsKGIsXCJ0eXBlXCIpP2IudHlwZTpiLHI9ai5jYWxsKGIsXCJuYW1lc3BhY2VcIik/Yi5uYW1lc3BhY2Uuc3BsaXQoXCIuXCIpOltdO2lmKGc9aD1kPWR8fGwsMyE9PWQubm9kZVR5cGUmJjghPT1kLm5vZGVUeXBlJiYhWC50ZXN0KHErbi5ldmVudC50cmlnZ2VyZWQpJiYocS5pbmRleE9mKFwiLlwiKT49MCYmKHI9cS5zcGxpdChcIi5cIikscT1yLnNoaWZ0KCksci5zb3J0KCkpLGs9cS5pbmRleE9mKFwiOlwiKTwwJiZcIm9uXCIrcSxiPWJbbi5leHBhbmRvXT9iOm5ldyBuLkV2ZW50KHEsXCJvYmplY3RcIj09dHlwZW9mIGImJmIpLGIuaXNUcmlnZ2VyPWU/MjozLGIubmFtZXNwYWNlPXIuam9pbihcIi5cIiksYi5uYW1lc3BhY2VfcmU9Yi5uYW1lc3BhY2U/bmV3IFJlZ0V4cChcIihefFxcXFwuKVwiK3Iuam9pbihcIlxcXFwuKD86LipcXFxcLnwpXCIpK1wiKFxcXFwufCQpXCIpOm51bGwsYi5yZXN1bHQ9dm9pZCAwLGIudGFyZ2V0fHwoYi50YXJnZXQ9ZCksYz1udWxsPT1jP1tiXTpuLm1ha2VBcnJheShjLFtiXSksbz1uLmV2ZW50LnNwZWNpYWxbcV18fHt9LGV8fCFvLnRyaWdnZXJ8fG8udHJpZ2dlci5hcHBseShkLGMpIT09ITEpKXtpZighZSYmIW8ubm9CdWJibGUmJiFuLmlzV2luZG93KGQpKXtmb3IoaT1vLmRlbGVnYXRlVHlwZXx8cSxYLnRlc3QoaStxKXx8KGc9Zy5wYXJlbnROb2RlKTtnO2c9Zy5wYXJlbnROb2RlKXAucHVzaChnKSxoPWc7aD09PShkLm93bmVyRG9jdW1lbnR8fGwpJiZwLnB1c2goaC5kZWZhdWx0Vmlld3x8aC5wYXJlbnRXaW5kb3d8fGEpfWY9MDt3aGlsZSgoZz1wW2YrK10pJiYhYi5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWIudHlwZT1mPjE/aTpvLmJpbmRUeXBlfHxxLG09KEwuZ2V0KGcsXCJldmVudHNcIil8fHt9KVtiLnR5cGVdJiZMLmdldChnLFwiaGFuZGxlXCIpLG0mJm0uYXBwbHkoZyxjKSxtPWsmJmdba10sbSYmbS5hcHBseSYmbi5hY2NlcHREYXRhKGcpJiYoYi5yZXN1bHQ9bS5hcHBseShnLGMpLGIucmVzdWx0PT09ITEmJmIucHJldmVudERlZmF1bHQoKSk7cmV0dXJuIGIudHlwZT1xLGV8fGIuaXNEZWZhdWx0UHJldmVudGVkKCl8fG8uX2RlZmF1bHQmJm8uX2RlZmF1bHQuYXBwbHkocC5wb3AoKSxjKSE9PSExfHwhbi5hY2NlcHREYXRhKGQpfHxrJiZuLmlzRnVuY3Rpb24oZFtxXSkmJiFuLmlzV2luZG93KGQpJiYoaD1kW2tdLGgmJihkW2tdPW51bGwpLG4uZXZlbnQudHJpZ2dlcmVkPXEsZFtxXSgpLG4uZXZlbnQudHJpZ2dlcmVkPXZvaWQgMCxoJiYoZFtrXT1oKSksYi5yZXN1bHR9fSxkaXNwYXRjaDpmdW5jdGlvbihhKXthPW4uZXZlbnQuZml4KGEpO3ZhciBiLGMsZSxmLGcsaD1bXSxpPWQuY2FsbChhcmd1bWVudHMpLGo9KEwuZ2V0KHRoaXMsXCJldmVudHNcIil8fHt9KVthLnR5cGVdfHxbXSxrPW4uZXZlbnQuc3BlY2lhbFthLnR5cGVdfHx7fTtpZihpWzBdPWEsYS5kZWxlZ2F0ZVRhcmdldD10aGlzLCFrLnByZURpc3BhdGNofHxrLnByZURpc3BhdGNoLmNhbGwodGhpcyxhKSE9PSExKXtoPW4uZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLGEsaiksYj0wO3doaWxlKChmPWhbYisrXSkmJiFhLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe2EuY3VycmVudFRhcmdldD1mLmVsZW0sYz0wO3doaWxlKChnPWYuaGFuZGxlcnNbYysrXSkmJiFhLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpKCFhLm5hbWVzcGFjZV9yZXx8YS5uYW1lc3BhY2VfcmUudGVzdChnLm5hbWVzcGFjZSkpJiYoYS5oYW5kbGVPYmo9ZyxhLmRhdGE9Zy5kYXRhLGU9KChuLmV2ZW50LnNwZWNpYWxbZy5vcmlnVHlwZV18fHt9KS5oYW5kbGV8fGcuaGFuZGxlcikuYXBwbHkoZi5lbGVtLGkpLHZvaWQgMCE9PWUmJihhLnJlc3VsdD1lKT09PSExJiYoYS5wcmV2ZW50RGVmYXVsdCgpLGEuc3RvcFByb3BhZ2F0aW9uKCkpKX1yZXR1cm4gay5wb3N0RGlzcGF0Y2gmJmsucG9zdERpc3BhdGNoLmNhbGwodGhpcyxhKSxhLnJlc3VsdH19LGhhbmRsZXJzOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGYsZz1bXSxoPWIuZGVsZWdhdGVDb3VudCxpPWEudGFyZ2V0O2lmKGgmJmkubm9kZVR5cGUmJighYS5idXR0b258fFwiY2xpY2tcIiE9PWEudHlwZSkpZm9yKDtpIT09dGhpcztpPWkucGFyZW50Tm9kZXx8dGhpcylpZihpLmRpc2FibGVkIT09ITB8fFwiY2xpY2tcIiE9PWEudHlwZSl7Zm9yKGQ9W10sYz0wO2g+YztjKyspZj1iW2NdLGU9Zi5zZWxlY3RvcitcIiBcIix2b2lkIDA9PT1kW2VdJiYoZFtlXT1mLm5lZWRzQ29udGV4dD9uKGUsdGhpcykuaW5kZXgoaSk+PTA6bi5maW5kKGUsdGhpcyxudWxsLFtpXSkubGVuZ3RoKSxkW2VdJiZkLnB1c2goZik7ZC5sZW5ndGgmJmcucHVzaCh7ZWxlbTppLGhhbmRsZXJzOmR9KX1yZXR1cm4gaDxiLmxlbmd0aCYmZy5wdXNoKHtlbGVtOnRoaXMsaGFuZGxlcnM6Yi5zbGljZShoKX0pLGd9LHByb3BzOlwiYWx0S2V5IGJ1YmJsZXMgY2FuY2VsYWJsZSBjdHJsS2V5IGN1cnJlbnRUYXJnZXQgZXZlbnRQaGFzZSBtZXRhS2V5IHJlbGF0ZWRUYXJnZXQgc2hpZnRLZXkgdGFyZ2V0IHRpbWVTdGFtcCB2aWV3IHdoaWNoXCIuc3BsaXQoXCIgXCIpLGZpeEhvb2tzOnt9LGtleUhvb2tzOntwcm9wczpcImNoYXIgY2hhckNvZGUga2V5IGtleUNvZGVcIi5zcGxpdChcIiBcIiksZmlsdGVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGw9PWEud2hpY2gmJihhLndoaWNoPW51bGwhPWIuY2hhckNvZGU/Yi5jaGFyQ29kZTpiLmtleUNvZGUpLGF9fSxtb3VzZUhvb2tzOntwcm9wczpcImJ1dHRvbiBidXR0b25zIGNsaWVudFggY2xpZW50WSBvZmZzZXRYIG9mZnNldFkgcGFnZVggcGFnZVkgc2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudFwiLnNwbGl0KFwiIFwiKSxmaWx0ZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZj1iLmJ1dHRvbjtyZXR1cm4gbnVsbD09YS5wYWdlWCYmbnVsbCE9Yi5jbGllbnRYJiYoYz1hLnRhcmdldC5vd25lckRvY3VtZW50fHxsLGQ9Yy5kb2N1bWVudEVsZW1lbnQsZT1jLmJvZHksYS5wYWdlWD1iLmNsaWVudFgrKGQmJmQuc2Nyb2xsTGVmdHx8ZSYmZS5zY3JvbGxMZWZ0fHwwKS0oZCYmZC5jbGllbnRMZWZ0fHxlJiZlLmNsaWVudExlZnR8fDApLGEucGFnZVk9Yi5jbGllbnRZKyhkJiZkLnNjcm9sbFRvcHx8ZSYmZS5zY3JvbGxUb3B8fDApLShkJiZkLmNsaWVudFRvcHx8ZSYmZS5jbGllbnRUb3B8fDApKSxhLndoaWNofHx2b2lkIDA9PT1mfHwoYS53aGljaD0xJmY/MToyJmY/Mzo0JmY/MjowKSxhfX0sZml4OmZ1bmN0aW9uKGEpe2lmKGFbbi5leHBhbmRvXSlyZXR1cm4gYTt2YXIgYixjLGQsZT1hLnR5cGUsZj1hLGc9dGhpcy5maXhIb29rc1tlXTtnfHwodGhpcy5maXhIb29rc1tlXT1nPVcudGVzdChlKT90aGlzLm1vdXNlSG9va3M6Vi50ZXN0KGUpP3RoaXMua2V5SG9va3M6e30pLGQ9Zy5wcm9wcz90aGlzLnByb3BzLmNvbmNhdChnLnByb3BzKTp0aGlzLnByb3BzLGE9bmV3IG4uRXZlbnQoZiksYj1kLmxlbmd0aDt3aGlsZShiLS0pYz1kW2JdLGFbY109ZltjXTtyZXR1cm4gYS50YXJnZXR8fChhLnRhcmdldD1sKSwzPT09YS50YXJnZXQubm9kZVR5cGUmJihhLnRhcmdldD1hLnRhcmdldC5wYXJlbnROb2RlKSxnLmZpbHRlcj9nLmZpbHRlcihhLGYpOmF9LHNwZWNpYWw6e2xvYWQ6e25vQnViYmxlOiEwfSxmb2N1czp7dHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzIT09XygpJiZ0aGlzLmZvY3VzPyh0aGlzLmZvY3VzKCksITEpOnZvaWQgMH0sZGVsZWdhdGVUeXBlOlwiZm9jdXNpblwifSxibHVyOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXM9PT1fKCkmJnRoaXMuYmx1cj8odGhpcy5ibHVyKCksITEpOnZvaWQgMH0sZGVsZWdhdGVUeXBlOlwiZm9jdXNvdXRcIn0sY2xpY2s6e3RyaWdnZXI6ZnVuY3Rpb24oKXtyZXR1cm5cImNoZWNrYm94XCI9PT10aGlzLnR5cGUmJnRoaXMuY2xpY2smJm4ubm9kZU5hbWUodGhpcyxcImlucHV0XCIpPyh0aGlzLmNsaWNrKCksITEpOnZvaWQgMH0sX2RlZmF1bHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIG4ubm9kZU5hbWUoYS50YXJnZXQsXCJhXCIpfX0sYmVmb3JldW5sb2FkOntwb3N0RGlzcGF0Y2g6ZnVuY3Rpb24oYSl7dm9pZCAwIT09YS5yZXN1bHQmJmEub3JpZ2luYWxFdmVudCYmKGEub3JpZ2luYWxFdmVudC5yZXR1cm5WYWx1ZT1hLnJlc3VsdCl9fX0sc2ltdWxhdGU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9bi5leHRlbmQobmV3IG4uRXZlbnQsYyx7dHlwZTphLGlzU2ltdWxhdGVkOiEwLG9yaWdpbmFsRXZlbnQ6e319KTtkP24uZXZlbnQudHJpZ2dlcihlLG51bGwsYik6bi5ldmVudC5kaXNwYXRjaC5jYWxsKGIsZSksZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSYmYy5wcmV2ZW50RGVmYXVsdCgpfX0sbi5yZW1vdmVFdmVudD1mdW5jdGlvbihhLGIsYyl7YS5yZW1vdmVFdmVudExpc3RlbmVyJiZhLnJlbW92ZUV2ZW50TGlzdGVuZXIoYixjLCExKX0sbi5FdmVudD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzIGluc3RhbmNlb2Ygbi5FdmVudD8oYSYmYS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9YSx0aGlzLnR5cGU9YS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWEuZGVmYXVsdFByZXZlbnRlZHx8dm9pZCAwPT09YS5kZWZhdWx0UHJldmVudGVkJiZhLnJldHVyblZhbHVlPT09ITE/WjokKTp0aGlzLnR5cGU9YSxiJiZuLmV4dGVuZCh0aGlzLGIpLHRoaXMudGltZVN0YW1wPWEmJmEudGltZVN0YW1wfHxuLm5vdygpLHZvaWQodGhpc1tuLmV4cGFuZG9dPSEwKSk6bmV3IG4uRXZlbnQoYSxiKX0sbi5FdmVudC5wcm90b3R5cGU9e2lzRGVmYXVsdFByZXZlbnRlZDokLGlzUHJvcGFnYXRpb25TdG9wcGVkOiQsaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6JCxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1aLGEmJmEucHJldmVudERlZmF1bHQmJmEucHJldmVudERlZmF1bHQoKX0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQ9WixhJiZhLnN0b3BQcm9wYWdhdGlvbiYmYS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9WixhJiZhLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiYmYS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0aGlzLnN0b3BQcm9wYWdhdGlvbigpfX0sbi5lYWNoKHttb3VzZWVudGVyOlwibW91c2VvdmVyXCIsbW91c2VsZWF2ZTpcIm1vdXNlb3V0XCIscG9pbnRlcmVudGVyOlwicG9pbnRlcm92ZXJcIixwb2ludGVybGVhdmU6XCJwb2ludGVyb3V0XCJ9LGZ1bmN0aW9uKGEsYil7bi5ldmVudC5zcGVjaWFsW2FdPXtkZWxlZ2F0ZVR5cGU6YixiaW5kVHlwZTpiLGhhbmRsZTpmdW5jdGlvbihhKXt2YXIgYyxkPXRoaXMsZT1hLnJlbGF0ZWRUYXJnZXQsZj1hLmhhbmRsZU9iajtyZXR1cm4oIWV8fGUhPT1kJiYhbi5jb250YWlucyhkLGUpKSYmKGEudHlwZT1mLm9yaWdUeXBlLGM9Zi5oYW5kbGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxhLnR5cGU9YiksY319fSksay5mb2N1c2luQnViYmxlc3x8bi5lYWNoKHtmb2N1czpcImZvY3VzaW5cIixibHVyOlwiZm9jdXNvdXRcIn0sZnVuY3Rpb24oYSxiKXt2YXIgYz1mdW5jdGlvbihhKXtuLmV2ZW50LnNpbXVsYXRlKGIsYS50YXJnZXQsbi5ldmVudC5maXgoYSksITApfTtuLmV2ZW50LnNwZWNpYWxbYl09e3NldHVwOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGU9TC5hY2Nlc3MoZCxiKTtlfHxkLmFkZEV2ZW50TGlzdGVuZXIoYSxjLCEwKSxMLmFjY2VzcyhkLGIsKGV8fDApKzEpfSx0ZWFyZG93bjpmdW5jdGlvbigpe3ZhciBkPXRoaXMub3duZXJEb2N1bWVudHx8dGhpcyxlPUwuYWNjZXNzKGQsYiktMTtlP0wuYWNjZXNzKGQsYixlKTooZC5yZW1vdmVFdmVudExpc3RlbmVyKGEsYywhMCksTC5yZW1vdmUoZCxiKSl9fX0pLG4uZm4uZXh0ZW5kKHtvbjpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmLGc7aWYoXCJvYmplY3RcIj09dHlwZW9mIGEpe1wic3RyaW5nXCIhPXR5cGVvZiBiJiYoYz1jfHxiLGI9dm9pZCAwKTtmb3IoZyBpbiBhKXRoaXMub24oZyxiLGMsYVtnXSxlKTtyZXR1cm4gdGhpc31pZihudWxsPT1jJiZudWxsPT1kPyhkPWIsYz1iPXZvaWQgMCk6bnVsbD09ZCYmKFwic3RyaW5nXCI9PXR5cGVvZiBiPyhkPWMsYz12b2lkIDApOihkPWMsYz1iLGI9dm9pZCAwKSksZD09PSExKWQ9JDtlbHNlIGlmKCFkKXJldHVybiB0aGlzO3JldHVybiAxPT09ZSYmKGY9ZCxkPWZ1bmN0aW9uKGEpe3JldHVybiBuKCkub2ZmKGEpLGYuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxkLmd1aWQ9Zi5ndWlkfHwoZi5ndWlkPW4uZ3VpZCsrKSksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7bi5ldmVudC5hZGQodGhpcyxhLGQsYyxiKX0pfSxvbmU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMub24oYSxiLGMsZCwxKX0sb2ZmOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlO2lmKGEmJmEucHJldmVudERlZmF1bHQmJmEuaGFuZGxlT2JqKXJldHVybiBkPWEuaGFuZGxlT2JqLG4oYS5kZWxlZ2F0ZVRhcmdldCkub2ZmKGQubmFtZXNwYWNlP2Qub3JpZ1R5cGUrXCIuXCIrZC5uYW1lc3BhY2U6ZC5vcmlnVHlwZSxkLnNlbGVjdG9yLGQuaGFuZGxlciksdGhpcztpZihcIm9iamVjdFwiPT10eXBlb2YgYSl7Zm9yKGUgaW4gYSl0aGlzLm9mZihlLGIsYVtlXSk7cmV0dXJuIHRoaXN9cmV0dXJuKGI9PT0hMXx8XCJmdW5jdGlvblwiPT10eXBlb2YgYikmJihjPWIsYj12b2lkIDApLGM9PT0hMSYmKGM9JCksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7bi5ldmVudC5yZW1vdmUodGhpcyxhLGMsYil9KX0sdHJpZ2dlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtuLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpc1swXTtyZXR1cm4gYz9uLmV2ZW50LnRyaWdnZXIoYSxiLGMsITApOnZvaWQgMH19KTt2YXIgYWI9LzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2dpLGJiPS88KFtcXHc6XSspLyxjYj0vPHwmIz9cXHcrOy8sZGI9LzwoPzpzY3JpcHR8c3R5bGV8bGluaykvaSxlYj0vY2hlY2tlZFxccyooPzpbXj1dfD1cXHMqLmNoZWNrZWQuKS9pLGZiPS9eJHxcXC8oPzpqYXZhfGVjbWEpc2NyaXB0L2ksZ2I9L150cnVlXFwvKC4qKS8saGI9L15cXHMqPCEoPzpcXFtDREFUQVxcW3wtLSl8KD86XFxdXFxdfC0tKT5cXHMqJC9nLGliPXtvcHRpb246WzEsXCI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+XCIsXCI8L3NlbGVjdD5cIl0sdGhlYWQ6WzEsXCI8dGFibGU+XCIsXCI8L3RhYmxlPlwiXSxjb2w6WzIsXCI8dGFibGU+PGNvbGdyb3VwPlwiLFwiPC9jb2xncm91cD48L3RhYmxlPlwiXSx0cjpbMixcIjx0YWJsZT48dGJvZHk+XCIsXCI8L3Rib2R5PjwvdGFibGU+XCJdLHRkOlszLFwiPHRhYmxlPjx0Ym9keT48dHI+XCIsXCI8L3RyPjwvdGJvZHk+PC90YWJsZT5cIl0sX2RlZmF1bHQ6WzAsXCJcIixcIlwiXX07aWIub3B0Z3JvdXA9aWIub3B0aW9uLGliLnRib2R5PWliLnRmb290PWliLmNvbGdyb3VwPWliLmNhcHRpb249aWIudGhlYWQsaWIudGg9aWIudGQ7ZnVuY3Rpb24gamIoYSxiKXtyZXR1cm4gbi5ub2RlTmFtZShhLFwidGFibGVcIikmJm4ubm9kZU5hbWUoMTEhPT1iLm5vZGVUeXBlP2I6Yi5maXJzdENoaWxkLFwidHJcIik/YS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRib2R5XCIpWzBdfHxhLmFwcGVuZENoaWxkKGEub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGJvZHlcIikpOmF9ZnVuY3Rpb24ga2IoYSl7cmV0dXJuIGEudHlwZT0obnVsbCE9PWEuZ2V0QXR0cmlidXRlKFwidHlwZVwiKSkrXCIvXCIrYS50eXBlLGF9ZnVuY3Rpb24gbGIoYSl7dmFyIGI9Z2IuZXhlYyhhLnR5cGUpO3JldHVybiBiP2EudHlwZT1iWzFdOmEucmVtb3ZlQXR0cmlidXRlKFwidHlwZVwiKSxhfWZ1bmN0aW9uIG1iKGEsYil7Zm9yKHZhciBjPTAsZD1hLmxlbmd0aDtkPmM7YysrKUwuc2V0KGFbY10sXCJnbG9iYWxFdmFsXCIsIWJ8fEwuZ2V0KGJbY10sXCJnbG9iYWxFdmFsXCIpKX1mdW5jdGlvbiBuYihhLGIpe3ZhciBjLGQsZSxmLGcsaCxpLGo7aWYoMT09PWIubm9kZVR5cGUpe2lmKEwuaGFzRGF0YShhKSYmKGY9TC5hY2Nlc3MoYSksZz1MLnNldChiLGYpLGo9Zi5ldmVudHMpKXtkZWxldGUgZy5oYW5kbGUsZy5ldmVudHM9e307Zm9yKGUgaW4gailmb3IoYz0wLGQ9altlXS5sZW5ndGg7ZD5jO2MrKyluLmV2ZW50LmFkZChiLGUsaltlXVtjXSl9TS5oYXNEYXRhKGEpJiYoaD1NLmFjY2VzcyhhKSxpPW4uZXh0ZW5kKHt9LGgpLE0uc2V0KGIsaSkpfX1mdW5jdGlvbiBvYihhLGIpe3ZhciBjPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWU/YS5nZXRFbGVtZW50c0J5VGFnTmFtZShifHxcIipcIik6YS5xdWVyeVNlbGVjdG9yQWxsP2EucXVlcnlTZWxlY3RvckFsbChifHxcIipcIik6W107cmV0dXJuIHZvaWQgMD09PWJ8fGImJm4ubm9kZU5hbWUoYSxiKT9uLm1lcmdlKFthXSxjKTpjfWZ1bmN0aW9uIHBiKGEsYil7dmFyIGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1wiaW5wdXRcIj09PWMmJlQudGVzdChhLnR5cGUpP2IuY2hlY2tlZD1hLmNoZWNrZWQ6KFwiaW5wdXRcIj09PWN8fFwidGV4dGFyZWFcIj09PWMpJiYoYi5kZWZhdWx0VmFsdWU9YS5kZWZhdWx0VmFsdWUpfW4uZXh0ZW5kKHtjbG9uZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLmNsb25lTm9kZSghMCksaT1uLmNvbnRhaW5zKGEub3duZXJEb2N1bWVudCxhKTtpZighKGsubm9DbG9uZUNoZWNrZWR8fDEhPT1hLm5vZGVUeXBlJiYxMSE9PWEubm9kZVR5cGV8fG4uaXNYTUxEb2MoYSkpKWZvcihnPW9iKGgpLGY9b2IoYSksZD0wLGU9Zi5sZW5ndGg7ZT5kO2QrKylwYihmW2RdLGdbZF0pO2lmKGIpaWYoYylmb3IoZj1mfHxvYihhKSxnPWd8fG9iKGgpLGQ9MCxlPWYubGVuZ3RoO2U+ZDtkKyspbmIoZltkXSxnW2RdKTtlbHNlIG5iKGEsaCk7cmV0dXJuIGc9b2IoaCxcInNjcmlwdFwiKSxnLmxlbmd0aD4wJiZtYihnLCFpJiZvYihhLFwic2NyaXB0XCIpKSxofSxidWlsZEZyYWdtZW50OmZ1bmN0aW9uKGEsYixjLGQpe2Zvcih2YXIgZSxmLGcsaCxpLGosaz1iLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxsPVtdLG09MCxvPWEubGVuZ3RoO28+bTttKyspaWYoZT1hW21dLGV8fDA9PT1lKWlmKFwib2JqZWN0XCI9PT1uLnR5cGUoZSkpbi5tZXJnZShsLGUubm9kZVR5cGU/W2VdOmUpO2Vsc2UgaWYoY2IudGVzdChlKSl7Zj1mfHxrLmFwcGVuZENoaWxkKGIuY3JlYXRlRWxlbWVudChcImRpdlwiKSksZz0oYmIuZXhlYyhlKXx8W1wiXCIsXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCksaD1pYltnXXx8aWIuX2RlZmF1bHQsZi5pbm5lckhUTUw9aFsxXStlLnJlcGxhY2UoYWIsXCI8JDE+PC8kMj5cIikraFsyXSxqPWhbMF07d2hpbGUoai0tKWY9Zi5sYXN0Q2hpbGQ7bi5tZXJnZShsLGYuY2hpbGROb2RlcyksZj1rLmZpcnN0Q2hpbGQsZi50ZXh0Q29udGVudD1cIlwifWVsc2UgbC5wdXNoKGIuY3JlYXRlVGV4dE5vZGUoZSkpO2sudGV4dENvbnRlbnQ9XCJcIixtPTA7d2hpbGUoZT1sW20rK10paWYoKCFkfHwtMT09PW4uaW5BcnJheShlLGQpKSYmKGk9bi5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsZSksZj1vYihrLmFwcGVuZENoaWxkKGUpLFwic2NyaXB0XCIpLGkmJm1iKGYpLGMpKXtqPTA7d2hpbGUoZT1mW2orK10pZmIudGVzdChlLnR5cGV8fFwiXCIpJiZjLnB1c2goZSl9cmV0dXJuIGt9LGNsZWFuRGF0YTpmdW5jdGlvbihhKXtmb3IodmFyIGIsYyxkLGUsZj1uLmV2ZW50LnNwZWNpYWwsZz0wO3ZvaWQgMCE9PShjPWFbZ10pO2crKyl7aWYobi5hY2NlcHREYXRhKGMpJiYoZT1jW0wuZXhwYW5kb10sZSYmKGI9TC5jYWNoZVtlXSkpKXtpZihiLmV2ZW50cylmb3IoZCBpbiBiLmV2ZW50cylmW2RdP24uZXZlbnQucmVtb3ZlKGMsZCk6bi5yZW1vdmVFdmVudChjLGQsYi5oYW5kbGUpO0wuY2FjaGVbZV0mJmRlbGV0ZSBMLmNhY2hlW2VdfWRlbGV0ZSBNLmNhY2hlW2NbTS5leHBhbmRvXV19fX0pLG4uZm4uZXh0ZW5kKHt0ZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBKKHRoaXMsZnVuY3Rpb24oYSl7cmV0dXJuIHZvaWQgMD09PWE/bi50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCl7KDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKSYmKHRoaXMudGV4dENvbnRlbnQ9YSl9KX0sbnVsbCxhLGFyZ3VtZW50cy5sZW5ndGgpfSxhcHBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsZnVuY3Rpb24oYSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciBiPWpiKHRoaXMsYSk7Yi5hcHBlbmRDaGlsZChhKX19KX0scHJlcGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmdW5jdGlvbihhKXtpZigxPT09dGhpcy5ub2RlVHlwZXx8MTE9PT10aGlzLm5vZGVUeXBlfHw5PT09dGhpcy5ub2RlVHlwZSl7dmFyIGI9amIodGhpcyxhKTtiLmluc2VydEJlZm9yZShhLGIuZmlyc3RDaGlsZCl9fSl9LGJlZm9yZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmdW5jdGlvbihhKXt0aGlzLnBhcmVudE5vZGUmJnRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSx0aGlzKX0pfSxhZnRlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmdW5jdGlvbihhKXt0aGlzLnBhcmVudE5vZGUmJnRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSx0aGlzLm5leHRTaWJsaW5nKX0pfSxyZW1vdmU6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGMsZD1hP24uZmlsdGVyKGEsdGhpcyk6dGhpcyxlPTA7bnVsbCE9KGM9ZFtlXSk7ZSsrKWJ8fDEhPT1jLm5vZGVUeXBlfHxuLmNsZWFuRGF0YShvYihjKSksYy5wYXJlbnROb2RlJiYoYiYmbi5jb250YWlucyhjLm93bmVyRG9jdW1lbnQsYykmJm1iKG9iKGMsXCJzY3JpcHRcIikpLGMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjKSk7cmV0dXJuIHRoaXN9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBhLGI9MDtudWxsIT0oYT10aGlzW2JdKTtiKyspMT09PWEubm9kZVR5cGUmJihuLmNsZWFuRGF0YShvYihhLCExKSksYS50ZXh0Q29udGVudD1cIlwiKTtyZXR1cm4gdGhpc30sY2xvbmU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1udWxsPT1hPyExOmEsYj1udWxsPT1iP2E6Yix0aGlzLm1hcChmdW5jdGlvbigpe3JldHVybiBuLmNsb25lKHRoaXMsYSxiKX0pfSxodG1sOmZ1bmN0aW9uKGEpe3JldHVybiBKKHRoaXMsZnVuY3Rpb24oYSl7dmFyIGI9dGhpc1swXXx8e30sYz0wLGQ9dGhpcy5sZW5ndGg7aWYodm9pZCAwPT09YSYmMT09PWIubm9kZVR5cGUpcmV0dXJuIGIuaW5uZXJIVE1MO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBhJiYhZGIudGVzdChhKSYmIWliWyhiYi5leGVjKGEpfHxbXCJcIixcIlwiXSlbMV0udG9Mb3dlckNhc2UoKV0pe2E9YS5yZXBsYWNlKGFiLFwiPCQxPjwvJDI+XCIpO3RyeXtmb3IoO2Q+YztjKyspYj10aGlzW2NdfHx7fSwxPT09Yi5ub2RlVHlwZSYmKG4uY2xlYW5EYXRhKG9iKGIsITEpKSxiLmlubmVySFRNTD1hKTtiPTB9Y2F0Y2goZSl7fX1iJiZ0aGlzLmVtcHR5KCkuYXBwZW5kKGEpfSxudWxsLGEsYXJndW1lbnRzLmxlbmd0aCl9LHJlcGxhY2VXaXRoOmZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdO3JldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cyxmdW5jdGlvbihiKXthPXRoaXMucGFyZW50Tm9kZSxuLmNsZWFuRGF0YShvYih0aGlzKSksYSYmYS5yZXBsYWNlQ2hpbGQoYix0aGlzKX0pLGEmJihhLmxlbmd0aHx8YS5ub2RlVHlwZSk/dGhpczp0aGlzLnJlbW92ZSgpfSxkZXRhY2g6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucmVtb3ZlKGEsITApfSxkb21NYW5pcDpmdW5jdGlvbihhLGIpe2E9ZS5hcHBseShbXSxhKTt2YXIgYyxkLGYsZyxoLGksaj0wLGw9dGhpcy5sZW5ndGgsbT10aGlzLG89bC0xLHA9YVswXSxxPW4uaXNGdW5jdGlvbihwKTtpZihxfHxsPjEmJlwic3RyaW5nXCI9PXR5cGVvZiBwJiYhay5jaGVja0Nsb25lJiZlYi50ZXN0KHApKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYyl7dmFyIGQ9bS5lcShjKTtxJiYoYVswXT1wLmNhbGwodGhpcyxjLGQuaHRtbCgpKSksZC5kb21NYW5pcChhLGIpfSk7aWYobCYmKGM9bi5idWlsZEZyYWdtZW50KGEsdGhpc1swXS5vd25lckRvY3VtZW50LCExLHRoaXMpLGQ9Yy5maXJzdENoaWxkLDE9PT1jLmNoaWxkTm9kZXMubGVuZ3RoJiYoYz1kKSxkKSl7Zm9yKGY9bi5tYXAob2IoYyxcInNjcmlwdFwiKSxrYiksZz1mLmxlbmd0aDtsPmo7aisrKWg9YyxqIT09byYmKGg9bi5jbG9uZShoLCEwLCEwKSxnJiZuLm1lcmdlKGYsb2IoaCxcInNjcmlwdFwiKSkpLGIuY2FsbCh0aGlzW2pdLGgsaik7aWYoZylmb3IoaT1mW2YubGVuZ3RoLTFdLm93bmVyRG9jdW1lbnQsbi5tYXAoZixsYiksaj0wO2c+ajtqKyspaD1mW2pdLGZiLnRlc3QoaC50eXBlfHxcIlwiKSYmIUwuYWNjZXNzKGgsXCJnbG9iYWxFdmFsXCIpJiZuLmNvbnRhaW5zKGksaCkmJihoLnNyYz9uLl9ldmFsVXJsJiZuLl9ldmFsVXJsKGguc3JjKTpuLmdsb2JhbEV2YWwoaC50ZXh0Q29udGVudC5yZXBsYWNlKGhiLFwiXCIpKSl9cmV0dXJuIHRoaXN9fSksbi5lYWNoKHthcHBlbmRUbzpcImFwcGVuZFwiLHByZXBlbmRUbzpcInByZXBlbmRcIixpbnNlcnRCZWZvcmU6XCJiZWZvcmVcIixpbnNlcnRBZnRlcjpcImFmdGVyXCIscmVwbGFjZUFsbDpcInJlcGxhY2VXaXRoXCJ9LGZ1bmN0aW9uKGEsYil7bi5mblthXT1mdW5jdGlvbihhKXtmb3IodmFyIGMsZD1bXSxlPW4oYSksZz1lLmxlbmd0aC0xLGg9MDtnPj1oO2grKyljPWg9PT1nP3RoaXM6dGhpcy5jbG9uZSghMCksbihlW2hdKVtiXShjKSxmLmFwcGx5KGQsYy5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGQpfX0pO3ZhciBxYixyYj17fTtmdW5jdGlvbiBzYihiLGMpe3ZhciBkLGU9bihjLmNyZWF0ZUVsZW1lbnQoYikpLmFwcGVuZFRvKGMuYm9keSksZj1hLmdldERlZmF1bHRDb21wdXRlZFN0eWxlJiYoZD1hLmdldERlZmF1bHRDb21wdXRlZFN0eWxlKGVbMF0pKT9kLmRpc3BsYXk6bi5jc3MoZVswXSxcImRpc3BsYXlcIik7cmV0dXJuIGUuZGV0YWNoKCksZn1mdW5jdGlvbiB0YihhKXt2YXIgYj1sLGM9cmJbYV07cmV0dXJuIGN8fChjPXNiKGEsYiksXCJub25lXCIhPT1jJiZjfHwocWI9KHFifHxuKFwiPGlmcmFtZSBmcmFtZWJvcmRlcj0nMCcgd2lkdGg9JzAnIGhlaWdodD0nMCcvPlwiKSkuYXBwZW5kVG8oYi5kb2N1bWVudEVsZW1lbnQpLGI9cWJbMF0uY29udGVudERvY3VtZW50LGIud3JpdGUoKSxiLmNsb3NlKCksYz1zYihhLGIpLHFiLmRldGFjaCgpKSxyYlthXT1jKSxjfXZhciB1Yj0vXm1hcmdpbi8sdmI9bmV3IFJlZ0V4cChcIl4oXCIrUStcIikoPyFweClbYS16JV0rJFwiLFwiaVwiKSx3Yj1mdW5jdGlvbihiKXtyZXR1cm4gYi5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3Lm9wZW5lcj9iLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpOmEuZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpfTtmdW5jdGlvbiB4YihhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLnN0eWxlO3JldHVybiBjPWN8fHdiKGEpLGMmJihnPWMuZ2V0UHJvcGVydHlWYWx1ZShiKXx8Y1tiXSksYyYmKFwiXCIhPT1nfHxuLmNvbnRhaW5zKGEub3duZXJEb2N1bWVudCxhKXx8KGc9bi5zdHlsZShhLGIpKSx2Yi50ZXN0KGcpJiZ1Yi50ZXN0KGIpJiYoZD1oLndpZHRoLGU9aC5taW5XaWR0aCxmPWgubWF4V2lkdGgsaC5taW5XaWR0aD1oLm1heFdpZHRoPWgud2lkdGg9ZyxnPWMud2lkdGgsaC53aWR0aD1kLGgubWluV2lkdGg9ZSxoLm1heFdpZHRoPWYpKSx2b2lkIDAhPT1nP2crXCJcIjpnfWZ1bmN0aW9uIHliKGEsYil7cmV0dXJue2dldDpmdW5jdGlvbigpe3JldHVybiBhKCk/dm9pZCBkZWxldGUgdGhpcy5nZXQ6KHRoaXMuZ2V0PWIpLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19fSFmdW5jdGlvbigpe3ZhciBiLGMsZD1sLmRvY3VtZW50RWxlbWVudCxlPWwuY3JlYXRlRWxlbWVudChcImRpdlwiKSxmPWwuY3JlYXRlRWxlbWVudChcImRpdlwiKTtpZihmLnN0eWxlKXtmLnN0eWxlLmJhY2tncm91bmRDbGlwPVwiY29udGVudC1ib3hcIixmLmNsb25lTm9kZSghMCkuc3R5bGUuYmFja2dyb3VuZENsaXA9XCJcIixrLmNsZWFyQ2xvbmVTdHlsZT1cImNvbnRlbnQtYm94XCI9PT1mLnN0eWxlLmJhY2tncm91bmRDbGlwLGUuc3R5bGUuY3NzVGV4dD1cImJvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4O21hcmdpbi10b3A6MXB4O3Bvc2l0aW9uOmFic29sdXRlXCIsZS5hcHBlbmRDaGlsZChmKTtmdW5jdGlvbiBnKCl7Zi5zdHlsZS5jc3NUZXh0PVwiLXdlYmtpdC1ib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3g7Ym94LXNpemluZzpib3JkZXItYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luLXRvcDoxJTt0b3A6MSU7Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt3aWR0aDo0cHg7cG9zaXRpb246YWJzb2x1dGVcIixmLmlubmVySFRNTD1cIlwiLGQuYXBwZW5kQ2hpbGQoZSk7dmFyIGc9YS5nZXRDb21wdXRlZFN0eWxlKGYsbnVsbCk7Yj1cIjElXCIhPT1nLnRvcCxjPVwiNHB4XCI9PT1nLndpZHRoLGQucmVtb3ZlQ2hpbGQoZSl9YS5nZXRDb21wdXRlZFN0eWxlJiZuLmV4dGVuZChrLHtwaXhlbFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGcoKSxifSxib3hTaXppbmdSZWxpYWJsZTpmdW5jdGlvbigpe3JldHVybiBudWxsPT1jJiZnKCksY30scmVsaWFibGVNYXJnaW5SaWdodDpmdW5jdGlvbigpe3ZhciBiLGM9Zi5hcHBlbmRDaGlsZChsLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO3JldHVybiBjLnN0eWxlLmNzc1RleHQ9Zi5zdHlsZS5jc3NUZXh0PVwiLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDtib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowXCIsYy5zdHlsZS5tYXJnaW5SaWdodD1jLnN0eWxlLndpZHRoPVwiMFwiLGYuc3R5bGUud2lkdGg9XCIxcHhcIixkLmFwcGVuZENoaWxkKGUpLGI9IXBhcnNlRmxvYXQoYS5nZXRDb21wdXRlZFN0eWxlKGMsbnVsbCkubWFyZ2luUmlnaHQpLGQucmVtb3ZlQ2hpbGQoZSksZi5yZW1vdmVDaGlsZChjKSxifX0pfX0oKSxuLnN3YXA9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnPXt9O2ZvcihmIGluIGIpZ1tmXT1hLnN0eWxlW2ZdLGEuc3R5bGVbZl09YltmXTtlPWMuYXBwbHkoYSxkfHxbXSk7Zm9yKGYgaW4gYilhLnN0eWxlW2ZdPWdbZl07cmV0dXJuIGV9O3ZhciB6Yj0vXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sQWI9bmV3IFJlZ0V4cChcIl4oXCIrUStcIikoLiopJFwiLFwiaVwiKSxCYj1uZXcgUmVnRXhwKFwiXihbKy1dKT0oXCIrUStcIilcIixcImlcIiksQ2I9e3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix2aXNpYmlsaXR5OlwiaGlkZGVuXCIsZGlzcGxheTpcImJsb2NrXCJ9LERiPXtsZXR0ZXJTcGFjaW5nOlwiMFwiLGZvbnRXZWlnaHQ6XCI0MDBcIn0sRWI9W1wiV2Via2l0XCIsXCJPXCIsXCJNb3pcIixcIm1zXCJdO2Z1bmN0aW9uIEZiKGEsYil7aWYoYiBpbiBhKXJldHVybiBiO3ZhciBjPWJbMF0udG9VcHBlckNhc2UoKStiLnNsaWNlKDEpLGQ9YixlPUViLmxlbmd0aDt3aGlsZShlLS0paWYoYj1FYltlXStjLGIgaW4gYSlyZXR1cm4gYjtyZXR1cm4gZH1mdW5jdGlvbiBHYihhLGIsYyl7dmFyIGQ9QWIuZXhlYyhiKTtyZXR1cm4gZD9NYXRoLm1heCgwLGRbMV0tKGN8fDApKSsoZFsyXXx8XCJweFwiKTpifWZ1bmN0aW9uIEhiKGEsYixjLGQsZSl7Zm9yKHZhciBmPWM9PT0oZD9cImJvcmRlclwiOlwiY29udGVudFwiKT80Olwid2lkdGhcIj09PWI/MTowLGc9MDs0PmY7Zis9MilcIm1hcmdpblwiPT09YyYmKGcrPW4uY3NzKGEsYytSW2ZdLCEwLGUpKSxkPyhcImNvbnRlbnRcIj09PWMmJihnLT1uLmNzcyhhLFwicGFkZGluZ1wiK1JbZl0sITAsZSkpLFwibWFyZ2luXCIhPT1jJiYoZy09bi5jc3MoYSxcImJvcmRlclwiK1JbZl0rXCJXaWR0aFwiLCEwLGUpKSk6KGcrPW4uY3NzKGEsXCJwYWRkaW5nXCIrUltmXSwhMCxlKSxcInBhZGRpbmdcIiE9PWMmJihnKz1uLmNzcyhhLFwiYm9yZGVyXCIrUltmXStcIldpZHRoXCIsITAsZSkpKTtyZXR1cm4gZ31mdW5jdGlvbiBJYihhLGIsYyl7dmFyIGQ9ITAsZT1cIndpZHRoXCI9PT1iP2Eub2Zmc2V0V2lkdGg6YS5vZmZzZXRIZWlnaHQsZj13YihhKSxnPVwiYm9yZGVyLWJveFwiPT09bi5jc3MoYSxcImJveFNpemluZ1wiLCExLGYpO2lmKDA+PWV8fG51bGw9PWUpe2lmKGU9eGIoYSxiLGYpLCgwPmV8fG51bGw9PWUpJiYoZT1hLnN0eWxlW2JdKSx2Yi50ZXN0KGUpKXJldHVybiBlO2Q9ZyYmKGsuYm94U2l6aW5nUmVsaWFibGUoKXx8ZT09PWEuc3R5bGVbYl0pLGU9cGFyc2VGbG9hdChlKXx8MH1yZXR1cm4gZStIYihhLGIsY3x8KGc/XCJib3JkZXJcIjpcImNvbnRlbnRcIiksZCxmKStcInB4XCJ9ZnVuY3Rpb24gSmIoYSxiKXtmb3IodmFyIGMsZCxlLGY9W10sZz0wLGg9YS5sZW5ndGg7aD5nO2crKylkPWFbZ10sZC5zdHlsZSYmKGZbZ109TC5nZXQoZCxcIm9sZGRpc3BsYXlcIiksYz1kLnN0eWxlLmRpc3BsYXksYj8oZltnXXx8XCJub25lXCIhPT1jfHwoZC5zdHlsZS5kaXNwbGF5PVwiXCIpLFwiXCI9PT1kLnN0eWxlLmRpc3BsYXkmJlMoZCkmJihmW2ddPUwuYWNjZXNzKGQsXCJvbGRkaXNwbGF5XCIsdGIoZC5ub2RlTmFtZSkpKSk6KGU9UyhkKSxcIm5vbmVcIj09PWMmJmV8fEwuc2V0KGQsXCJvbGRkaXNwbGF5XCIsZT9jOm4uY3NzKGQsXCJkaXNwbGF5XCIpKSkpO2ZvcihnPTA7aD5nO2crKylkPWFbZ10sZC5zdHlsZSYmKGImJlwibm9uZVwiIT09ZC5zdHlsZS5kaXNwbGF5JiZcIlwiIT09ZC5zdHlsZS5kaXNwbGF5fHwoZC5zdHlsZS5kaXNwbGF5PWI/ZltnXXx8XCJcIjpcIm5vbmVcIikpO3JldHVybiBhfW4uZXh0ZW5kKHtjc3NIb29rczp7b3BhY2l0eTp7Z2V0OmZ1bmN0aW9uKGEsYil7aWYoYil7dmFyIGM9eGIoYSxcIm9wYWNpdHlcIik7cmV0dXJuXCJcIj09PWM/XCIxXCI6Y319fX0sY3NzTnVtYmVyOntjb2x1bW5Db3VudDohMCxmaWxsT3BhY2l0eTohMCxmbGV4R3JvdzohMCxmbGV4U2hyaW5rOiEwLGZvbnRXZWlnaHQ6ITAsbGluZUhlaWdodDohMCxvcGFjaXR5OiEwLG9yZGVyOiEwLG9ycGhhbnM6ITAsd2lkb3dzOiEwLHpJbmRleDohMCx6b29tOiEwfSxjc3NQcm9wczp7XCJmbG9hdFwiOlwiY3NzRmxvYXRcIn0sc3R5bGU6ZnVuY3Rpb24oYSxiLGMsZCl7aWYoYSYmMyE9PWEubm9kZVR5cGUmJjghPT1hLm5vZGVUeXBlJiZhLnN0eWxlKXt2YXIgZSxmLGcsaD1uLmNhbWVsQ2FzZShiKSxpPWEuc3R5bGU7cmV0dXJuIGI9bi5jc3NQcm9wc1toXXx8KG4uY3NzUHJvcHNbaF09RmIoaSxoKSksZz1uLmNzc0hvb2tzW2JdfHxuLmNzc0hvb2tzW2hdLHZvaWQgMD09PWM/ZyYmXCJnZXRcImluIGcmJnZvaWQgMCE9PShlPWcuZ2V0KGEsITEsZCkpP2U6aVtiXTooZj10eXBlb2YgYyxcInN0cmluZ1wiPT09ZiYmKGU9QmIuZXhlYyhjKSkmJihjPShlWzFdKzEpKmVbMl0rcGFyc2VGbG9hdChuLmNzcyhhLGIpKSxmPVwibnVtYmVyXCIpLG51bGwhPWMmJmM9PT1jJiYoXCJudW1iZXJcIiE9PWZ8fG4uY3NzTnVtYmVyW2hdfHwoYys9XCJweFwiKSxrLmNsZWFyQ2xvbmVTdHlsZXx8XCJcIiE9PWN8fDAhPT1iLmluZGV4T2YoXCJiYWNrZ3JvdW5kXCIpfHwoaVtiXT1cImluaGVyaXRcIiksZyYmXCJzZXRcImluIGcmJnZvaWQgMD09PShjPWcuc2V0KGEsYyxkKSl8fChpW2JdPWMpKSx2b2lkIDApfX0sY3NzOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlLGYsZyxoPW4uY2FtZWxDYXNlKGIpO3JldHVybiBiPW4uY3NzUHJvcHNbaF18fChuLmNzc1Byb3BzW2hdPUZiKGEuc3R5bGUsaCkpLGc9bi5jc3NIb29rc1tiXXx8bi5jc3NIb29rc1toXSxnJiZcImdldFwiaW4gZyYmKGU9Zy5nZXQoYSwhMCxjKSksdm9pZCAwPT09ZSYmKGU9eGIoYSxiLGQpKSxcIm5vcm1hbFwiPT09ZSYmYiBpbiBEYiYmKGU9RGJbYl0pLFwiXCI9PT1jfHxjPyhmPXBhcnNlRmxvYXQoZSksYz09PSEwfHxuLmlzTnVtZXJpYyhmKT9mfHwwOmUpOmV9fSksbi5lYWNoKFtcImhlaWdodFwiLFwid2lkdGhcIl0sZnVuY3Rpb24oYSxiKXtuLmNzc0hvb2tzW2JdPXtnZXQ6ZnVuY3Rpb24oYSxjLGQpe3JldHVybiBjP3piLnRlc3Qobi5jc3MoYSxcImRpc3BsYXlcIikpJiYwPT09YS5vZmZzZXRXaWR0aD9uLnN3YXAoYSxDYixmdW5jdGlvbigpe3JldHVybiBJYihhLGIsZCl9KTpJYihhLGIsZCk6dm9pZCAwfSxzZXQ6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlPWQmJndiKGEpO3JldHVybiBHYihhLGMsZD9IYihhLGIsZCxcImJvcmRlci1ib3hcIj09PW4uY3NzKGEsXCJib3hTaXppbmdcIiwhMSxlKSxlKTowKX19fSksbi5jc3NIb29rcy5tYXJnaW5SaWdodD15YihrLnJlbGlhYmxlTWFyZ2luUmlnaHQsZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9uLnN3YXAoYSx7ZGlzcGxheTpcImlubGluZS1ibG9ja1wifSx4YixbYSxcIm1hcmdpblJpZ2h0XCJdKTp2b2lkIDB9KSxuLmVhY2goe21hcmdpbjpcIlwiLHBhZGRpbmc6XCJcIixib3JkZXI6XCJXaWR0aFwifSxmdW5jdGlvbihhLGIpe24uY3NzSG9va3NbYStiXT17ZXhwYW5kOmZ1bmN0aW9uKGMpe2Zvcih2YXIgZD0wLGU9e30sZj1cInN0cmluZ1wiPT10eXBlb2YgYz9jLnNwbGl0KFwiIFwiKTpbY107ND5kO2QrKyllW2ErUltkXStiXT1mW2RdfHxmW2QtMl18fGZbMF07cmV0dXJuIGV9fSx1Yi50ZXN0KGEpfHwobi5jc3NIb29rc1thK2JdLnNldD1HYil9KSxuLmZuLmV4dGVuZCh7Y3NzOmZ1bmN0aW9uKGEsYil7cmV0dXJuIEoodGhpcyxmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmPXt9LGc9MDtpZihuLmlzQXJyYXkoYikpe2ZvcihkPXdiKGEpLGU9Yi5sZW5ndGg7ZT5nO2crKylmW2JbZ11dPW4uY3NzKGEsYltnXSwhMSxkKTtyZXR1cm4gZn1yZXR1cm4gdm9pZCAwIT09Yz9uLnN0eWxlKGEsYixjKTpuLmNzcyhhLGIpfSxhLGIsYXJndW1lbnRzLmxlbmd0aD4xKX0sc2hvdzpmdW5jdGlvbigpe3JldHVybiBKYih0aGlzLCEwKX0saGlkZTpmdW5jdGlvbigpe3JldHVybiBKYih0aGlzKX0sdG9nZ2xlOmZ1bmN0aW9uKGEpe3JldHVyblwiYm9vbGVhblwiPT10eXBlb2YgYT9hP3RoaXMuc2hvdygpOnRoaXMuaGlkZSgpOnRoaXMuZWFjaChmdW5jdGlvbigpe1ModGhpcyk/bih0aGlzKS5zaG93KCk6bih0aGlzKS5oaWRlKCl9KX19KTtmdW5jdGlvbiBLYihhLGIsYyxkLGUpe3JldHVybiBuZXcgS2IucHJvdG90eXBlLmluaXQoYSxiLGMsZCxlKX1uLlR3ZWVuPUtiLEtiLnByb3RvdHlwZT17Y29uc3RydWN0b3I6S2IsaW5pdDpmdW5jdGlvbihhLGIsYyxkLGUsZil7dGhpcy5lbGVtPWEsdGhpcy5wcm9wPWMsdGhpcy5lYXNpbmc9ZXx8XCJzd2luZ1wiLHRoaXMub3B0aW9ucz1iLHRoaXMuc3RhcnQ9dGhpcy5ub3c9dGhpcy5jdXIoKSx0aGlzLmVuZD1kLHRoaXMudW5pdD1mfHwobi5jc3NOdW1iZXJbY10/XCJcIjpcInB4XCIpfSxjdXI6ZnVuY3Rpb24oKXt2YXIgYT1LYi5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gYSYmYS5nZXQ/YS5nZXQodGhpcyk6S2IucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKX0scnVuOmZ1bmN0aW9uKGEpe3ZhciBiLGM9S2IucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIHRoaXMucG9zPWI9dGhpcy5vcHRpb25zLmR1cmF0aW9uP24uZWFzaW5nW3RoaXMuZWFzaW5nXShhLHRoaXMub3B0aW9ucy5kdXJhdGlvbiphLDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pOmEsdGhpcy5ub3c9KHRoaXMuZW5kLXRoaXMuc3RhcnQpKmIrdGhpcy5zdGFydCx0aGlzLm9wdGlvbnMuc3RlcCYmdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyksYyYmYy5zZXQ/Yy5zZXQodGhpcyk6S2IucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKSx0aGlzfX0sS2IucHJvdG90eXBlLmluaXQucHJvdG90eXBlPUtiLnByb3RvdHlwZSxLYi5wcm9wSG9va3M9e19kZWZhdWx0OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI7cmV0dXJuIG51bGw9PWEuZWxlbVthLnByb3BdfHxhLmVsZW0uc3R5bGUmJm51bGwhPWEuZWxlbS5zdHlsZVthLnByb3BdPyhiPW4uY3NzKGEuZWxlbSxhLnByb3AsXCJcIiksYiYmXCJhdXRvXCIhPT1iP2I6MCk6YS5lbGVtW2EucHJvcF19LHNldDpmdW5jdGlvbihhKXtuLmZ4LnN0ZXBbYS5wcm9wXT9uLmZ4LnN0ZXBbYS5wcm9wXShhKTphLmVsZW0uc3R5bGUmJihudWxsIT1hLmVsZW0uc3R5bGVbbi5jc3NQcm9wc1thLnByb3BdXXx8bi5jc3NIb29rc1thLnByb3BdKT9uLnN0eWxlKGEuZWxlbSxhLnByb3AsYS5ub3crYS51bml0KTphLmVsZW1bYS5wcm9wXT1hLm5vd319fSxLYi5wcm9wSG9va3Muc2Nyb2xsVG9wPUtiLnByb3BIb29rcy5zY3JvbGxMZWZ0PXtzZXQ6ZnVuY3Rpb24oYSl7YS5lbGVtLm5vZGVUeXBlJiZhLmVsZW0ucGFyZW50Tm9kZSYmKGEuZWxlbVthLnByb3BdPWEubm93KX19LG4uZWFzaW5nPXtsaW5lYXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGF9LHN3aW5nOmZ1bmN0aW9uKGEpe3JldHVybi41LU1hdGguY29zKGEqTWF0aC5QSSkvMn19LG4uZng9S2IucHJvdG90eXBlLmluaXQsbi5meC5zdGVwPXt9O3ZhciBMYixNYixOYj0vXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sT2I9bmV3IFJlZ0V4cChcIl4oPzooWystXSk9fCkoXCIrUStcIikoW2EteiVdKikkXCIsXCJpXCIpLFBiPS9xdWV1ZUhvb2tzJC8sUWI9W1ZiXSxSYj17XCIqXCI6W2Z1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5jcmVhdGVUd2VlbihhLGIpLGQ9Yy5jdXIoKSxlPU9iLmV4ZWMoYiksZj1lJiZlWzNdfHwobi5jc3NOdW1iZXJbYV0/XCJcIjpcInB4XCIpLGc9KG4uY3NzTnVtYmVyW2FdfHxcInB4XCIhPT1mJiYrZCkmJk9iLmV4ZWMobi5jc3MoYy5lbGVtLGEpKSxoPTEsaT0yMDtpZihnJiZnWzNdIT09Zil7Zj1mfHxnWzNdLGU9ZXx8W10sZz0rZHx8MTtkbyBoPWh8fFwiLjVcIixnLz1oLG4uc3R5bGUoYy5lbGVtLGEsZytmKTt3aGlsZShoIT09KGg9Yy5jdXIoKS9kKSYmMSE9PWgmJi0taSl9cmV0dXJuIGUmJihnPWMuc3RhcnQ9K2d8fCtkfHwwLGMudW5pdD1mLGMuZW5kPWVbMV0/ZysoZVsxXSsxKSplWzJdOitlWzJdKSxjfV19O2Z1bmN0aW9uIFNiKCl7cmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtMYj12b2lkIDB9KSxMYj1uLm5vdygpfWZ1bmN0aW9uIFRiKGEsYil7dmFyIGMsZD0wLGU9e2hlaWdodDphfTtmb3IoYj1iPzE6MDs0PmQ7ZCs9Mi1iKWM9UltkXSxlW1wibWFyZ2luXCIrY109ZVtcInBhZGRpbmdcIitjXT1hO3JldHVybiBiJiYoZS5vcGFjaXR5PWUud2lkdGg9YSksZX1mdW5jdGlvbiBVYihhLGIsYyl7Zm9yKHZhciBkLGU9KFJiW2JdfHxbXSkuY29uY2F0KFJiW1wiKlwiXSksZj0wLGc9ZS5sZW5ndGg7Zz5mO2YrKylpZihkPWVbZl0uY2FsbChjLGIsYSkpcmV0dXJuIGR9ZnVuY3Rpb24gVmIoYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGssbD10aGlzLG09e30sbz1hLnN0eWxlLHA9YS5ub2RlVHlwZSYmUyhhKSxxPUwuZ2V0KGEsXCJmeHNob3dcIik7Yy5xdWV1ZXx8KGg9bi5fcXVldWVIb29rcyhhLFwiZnhcIiksbnVsbD09aC51bnF1ZXVlZCYmKGgudW5xdWV1ZWQ9MCxpPWguZW1wdHkuZmlyZSxoLmVtcHR5LmZpcmU9ZnVuY3Rpb24oKXtoLnVucXVldWVkfHxpKCl9KSxoLnVucXVldWVkKyssbC5hbHdheXMoZnVuY3Rpb24oKXtsLmFsd2F5cyhmdW5jdGlvbigpe2gudW5xdWV1ZWQtLSxuLnF1ZXVlKGEsXCJmeFwiKS5sZW5ndGh8fGguZW1wdHkuZmlyZSgpfSl9KSksMT09PWEubm9kZVR5cGUmJihcImhlaWdodFwiaW4gYnx8XCJ3aWR0aFwiaW4gYikmJihjLm92ZXJmbG93PVtvLm92ZXJmbG93LG8ub3ZlcmZsb3dYLG8ub3ZlcmZsb3dZXSxqPW4uY3NzKGEsXCJkaXNwbGF5XCIpLGs9XCJub25lXCI9PT1qP0wuZ2V0KGEsXCJvbGRkaXNwbGF5XCIpfHx0YihhLm5vZGVOYW1lKTpqLFwiaW5saW5lXCI9PT1rJiZcIm5vbmVcIj09PW4uY3NzKGEsXCJmbG9hdFwiKSYmKG8uZGlzcGxheT1cImlubGluZS1ibG9ja1wiKSksYy5vdmVyZmxvdyYmKG8ub3ZlcmZsb3c9XCJoaWRkZW5cIixsLmFsd2F5cyhmdW5jdGlvbigpe28ub3ZlcmZsb3c9Yy5vdmVyZmxvd1swXSxvLm92ZXJmbG93WD1jLm92ZXJmbG93WzFdLG8ub3ZlcmZsb3dZPWMub3ZlcmZsb3dbMl19KSk7Zm9yKGQgaW4gYilpZihlPWJbZF0sTmIuZXhlYyhlKSl7aWYoZGVsZXRlIGJbZF0sZj1mfHxcInRvZ2dsZVwiPT09ZSxlPT09KHA/XCJoaWRlXCI6XCJzaG93XCIpKXtpZihcInNob3dcIiE9PWV8fCFxfHx2b2lkIDA9PT1xW2RdKWNvbnRpbnVlO3A9ITB9bVtkXT1xJiZxW2RdfHxuLnN0eWxlKGEsZCl9ZWxzZSBqPXZvaWQgMDtpZihuLmlzRW1wdHlPYmplY3QobSkpXCJpbmxpbmVcIj09PShcIm5vbmVcIj09PWo/dGIoYS5ub2RlTmFtZSk6aikmJihvLmRpc3BsYXk9aik7ZWxzZXtxP1wiaGlkZGVuXCJpbiBxJiYocD1xLmhpZGRlbik6cT1MLmFjY2VzcyhhLFwiZnhzaG93XCIse30pLGYmJihxLmhpZGRlbj0hcCkscD9uKGEpLnNob3coKTpsLmRvbmUoZnVuY3Rpb24oKXtuKGEpLmhpZGUoKX0pLGwuZG9uZShmdW5jdGlvbigpe3ZhciBiO0wucmVtb3ZlKGEsXCJmeHNob3dcIik7Zm9yKGIgaW4gbSluLnN0eWxlKGEsYixtW2JdKX0pO2ZvcihkIGluIG0pZz1VYihwP3FbZF06MCxkLGwpLGQgaW4gcXx8KHFbZF09Zy5zdGFydCxwJiYoZy5lbmQ9Zy5zdGFydCxnLnN0YXJ0PVwid2lkdGhcIj09PWR8fFwiaGVpZ2h0XCI9PT1kPzE6MCkpfX1mdW5jdGlvbiBXYihhLGIpe3ZhciBjLGQsZSxmLGc7Zm9yKGMgaW4gYSlpZihkPW4uY2FtZWxDYXNlKGMpLGU9YltkXSxmPWFbY10sbi5pc0FycmF5KGYpJiYoZT1mWzFdLGY9YVtjXT1mWzBdKSxjIT09ZCYmKGFbZF09ZixkZWxldGUgYVtjXSksZz1uLmNzc0hvb2tzW2RdLGcmJlwiZXhwYW5kXCJpbiBnKXtmPWcuZXhwYW5kKGYpLGRlbGV0ZSBhW2RdO2ZvcihjIGluIGYpYyBpbiBhfHwoYVtjXT1mW2NdLGJbY109ZSl9ZWxzZSBiW2RdPWV9ZnVuY3Rpb24gWGIoYSxiLGMpe3ZhciBkLGUsZj0wLGc9UWIubGVuZ3RoLGg9bi5EZWZlcnJlZCgpLmFsd2F5cyhmdW5jdGlvbigpe2RlbGV0ZSBpLmVsZW19KSxpPWZ1bmN0aW9uKCl7aWYoZSlyZXR1cm4hMTtmb3IodmFyIGI9TGJ8fFNiKCksYz1NYXRoLm1heCgwLGouc3RhcnRUaW1lK2ouZHVyYXRpb24tYiksZD1jL2ouZHVyYXRpb258fDAsZj0xLWQsZz0wLGk9ai50d2VlbnMubGVuZ3RoO2k+ZztnKyspai50d2VlbnNbZ10ucnVuKGYpO3JldHVybiBoLm5vdGlmeVdpdGgoYSxbaixmLGNdKSwxPmYmJmk/YzooaC5yZXNvbHZlV2l0aChhLFtqXSksITEpfSxqPWgucHJvbWlzZSh7ZWxlbTphLHByb3BzOm4uZXh0ZW5kKHt9LGIpLG9wdHM6bi5leHRlbmQoITAse3NwZWNpYWxFYXNpbmc6e319LGMpLG9yaWdpbmFsUHJvcGVydGllczpiLG9yaWdpbmFsT3B0aW9uczpjLHN0YXJ0VGltZTpMYnx8U2IoKSxkdXJhdGlvbjpjLmR1cmF0aW9uLHR3ZWVuczpbXSxjcmVhdGVUd2VlbjpmdW5jdGlvbihiLGMpe3ZhciBkPW4uVHdlZW4oYSxqLm9wdHMsYixjLGoub3B0cy5zcGVjaWFsRWFzaW5nW2JdfHxqLm9wdHMuZWFzaW5nKTtyZXR1cm4gai50d2VlbnMucHVzaChkKSxkfSxzdG9wOmZ1bmN0aW9uKGIpe3ZhciBjPTAsZD1iP2oudHdlZW5zLmxlbmd0aDowO2lmKGUpcmV0dXJuIHRoaXM7Zm9yKGU9ITA7ZD5jO2MrKylqLnR3ZWVuc1tjXS5ydW4oMSk7cmV0dXJuIGI/aC5yZXNvbHZlV2l0aChhLFtqLGJdKTpoLnJlamVjdFdpdGgoYSxbaixiXSksdGhpc319KSxrPWoucHJvcHM7Zm9yKFdiKGssai5vcHRzLnNwZWNpYWxFYXNpbmcpO2c+ZjtmKyspaWYoZD1RYltmXS5jYWxsKGosYSxrLGoub3B0cykpcmV0dXJuIGQ7cmV0dXJuIG4ubWFwKGssVWIsaiksbi5pc0Z1bmN0aW9uKGoub3B0cy5zdGFydCkmJmoub3B0cy5zdGFydC5jYWxsKGEsaiksbi5meC50aW1lcihuLmV4dGVuZChpLHtlbGVtOmEsYW5pbTpqLHF1ZXVlOmoub3B0cy5xdWV1ZX0pKSxqLnByb2dyZXNzKGoub3B0cy5wcm9ncmVzcykuZG9uZShqLm9wdHMuZG9uZSxqLm9wdHMuY29tcGxldGUpLmZhaWwoai5vcHRzLmZhaWwpLmFsd2F5cyhqLm9wdHMuYWx3YXlzKX1uLkFuaW1hdGlvbj1uLmV4dGVuZChYYix7dHdlZW5lcjpmdW5jdGlvbihhLGIpe24uaXNGdW5jdGlvbihhKT8oYj1hLGE9W1wiKlwiXSk6YT1hLnNwbGl0KFwiIFwiKTtmb3IodmFyIGMsZD0wLGU9YS5sZW5ndGg7ZT5kO2QrKyljPWFbZF0sUmJbY109UmJbY118fFtdLFJiW2NdLnVuc2hpZnQoYil9LHByZWZpbHRlcjpmdW5jdGlvbihhLGIpe2I/UWIudW5zaGlmdChhKTpRYi5wdXNoKGEpfX0pLG4uc3BlZWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEmJlwib2JqZWN0XCI9PXR5cGVvZiBhP24uZXh0ZW5kKHt9LGEpOntjb21wbGV0ZTpjfHwhYyYmYnx8bi5pc0Z1bmN0aW9uKGEpJiZhLGR1cmF0aW9uOmEsZWFzaW5nOmMmJmJ8fGImJiFuLmlzRnVuY3Rpb24oYikmJmJ9O3JldHVybiBkLmR1cmF0aW9uPW4uZngub2ZmPzA6XCJudW1iZXJcIj09dHlwZW9mIGQuZHVyYXRpb24/ZC5kdXJhdGlvbjpkLmR1cmF0aW9uIGluIG4uZnguc3BlZWRzP24uZnguc3BlZWRzW2QuZHVyYXRpb25dOm4uZnguc3BlZWRzLl9kZWZhdWx0LChudWxsPT1kLnF1ZXVlfHxkLnF1ZXVlPT09ITApJiYoZC5xdWV1ZT1cImZ4XCIpLGQub2xkPWQuY29tcGxldGUsZC5jb21wbGV0ZT1mdW5jdGlvbigpe24uaXNGdW5jdGlvbihkLm9sZCkmJmQub2xkLmNhbGwodGhpcyksZC5xdWV1ZSYmbi5kZXF1ZXVlKHRoaXMsZC5xdWV1ZSl9LGR9LG4uZm4uZXh0ZW5kKHtmYWRlVG86ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuZmlsdGVyKFMpLmNzcyhcIm9wYWNpdHlcIiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTpifSxhLGMsZCl9LGFuaW1hdGU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9bi5pc0VtcHR5T2JqZWN0KGEpLGY9bi5zcGVlZChiLGMsZCksZz1mdW5jdGlvbigpe3ZhciBiPVhiKHRoaXMsbi5leHRlbmQoe30sYSksZik7KGV8fEwuZ2V0KHRoaXMsXCJmaW5pc2hcIikpJiZiLnN0b3AoITApfTtyZXR1cm4gZy5maW5pc2g9ZyxlfHxmLnF1ZXVlPT09ITE/dGhpcy5lYWNoKGcpOnRoaXMucXVldWUoZi5xdWV1ZSxnKX0sc3RvcDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9ZnVuY3Rpb24oYSl7dmFyIGI9YS5zdG9wO2RlbGV0ZSBhLnN0b3AsYihjKX07cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGEmJihjPWIsYj1hLGE9dm9pZCAwKSxiJiZhIT09ITEmJnRoaXMucXVldWUoYXx8XCJmeFwiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj0hMCxlPW51bGwhPWEmJmErXCJxdWV1ZUhvb2tzXCIsZj1uLnRpbWVycyxnPUwuZ2V0KHRoaXMpO2lmKGUpZ1tlXSYmZ1tlXS5zdG9wJiZkKGdbZV0pO2Vsc2UgZm9yKGUgaW4gZylnW2VdJiZnW2VdLnN0b3AmJlBiLnRlc3QoZSkmJmQoZ1tlXSk7Zm9yKGU9Zi5sZW5ndGg7ZS0tOylmW2VdLmVsZW0hPT10aGlzfHxudWxsIT1hJiZmW2VdLnF1ZXVlIT09YXx8KGZbZV0uYW5pbS5zdG9wKGMpLGI9ITEsZi5zcGxpY2UoZSwxKSk7KGJ8fCFjKSYmbi5kZXF1ZXVlKHRoaXMsYSl9KX0sZmluaXNoOmZ1bmN0aW9uKGEpe3JldHVybiBhIT09ITEmJihhPWF8fFwiZnhcIiksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGIsYz1MLmdldCh0aGlzKSxkPWNbYStcInF1ZXVlXCJdLGU9Y1thK1wicXVldWVIb29rc1wiXSxmPW4udGltZXJzLGc9ZD9kLmxlbmd0aDowO2ZvcihjLmZpbmlzaD0hMCxuLnF1ZXVlKHRoaXMsYSxbXSksZSYmZS5zdG9wJiZlLnN0b3AuY2FsbCh0aGlzLCEwKSxiPWYubGVuZ3RoO2ItLTspZltiXS5lbGVtPT09dGhpcyYmZltiXS5xdWV1ZT09PWEmJihmW2JdLmFuaW0uc3RvcCghMCksZi5zcGxpY2UoYiwxKSk7Zm9yKGI9MDtnPmI7YisrKWRbYl0mJmRbYl0uZmluaXNoJiZkW2JdLmZpbmlzaC5jYWxsKHRoaXMpO2RlbGV0ZSBjLmZpbmlzaH0pfX0pLG4uZWFjaChbXCJ0b2dnbGVcIixcInNob3dcIixcImhpZGVcIl0sZnVuY3Rpb24oYSxiKXt2YXIgYz1uLmZuW2JdO24uZm5bYl09ZnVuY3Rpb24oYSxkLGUpe3JldHVybiBudWxsPT1hfHxcImJvb2xlYW5cIj09dHlwZW9mIGE/Yy5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpcy5hbmltYXRlKFRiKGIsITApLGEsZCxlKX19KSxuLmVhY2goe3NsaWRlRG93bjpUYihcInNob3dcIiksc2xpZGVVcDpUYihcImhpZGVcIiksc2xpZGVUb2dnbGU6VGIoXCJ0b2dnbGVcIiksZmFkZUluOntvcGFjaXR5Olwic2hvd1wifSxmYWRlT3V0OntvcGFjaXR5OlwiaGlkZVwifSxmYWRlVG9nZ2xlOntvcGFjaXR5OlwidG9nZ2xlXCJ9fSxmdW5jdGlvbihhLGIpe24uZm5bYV09ZnVuY3Rpb24oYSxjLGQpe3JldHVybiB0aGlzLmFuaW1hdGUoYixhLGMsZCl9fSksbi50aW1lcnM9W10sbi5meC50aWNrPWZ1bmN0aW9uKCl7dmFyIGEsYj0wLGM9bi50aW1lcnM7Zm9yKExiPW4ubm93KCk7YjxjLmxlbmd0aDtiKyspYT1jW2JdLGEoKXx8Y1tiXSE9PWF8fGMuc3BsaWNlKGItLSwxKTtjLmxlbmd0aHx8bi5meC5zdG9wKCksTGI9dm9pZCAwfSxuLmZ4LnRpbWVyPWZ1bmN0aW9uKGEpe24udGltZXJzLnB1c2goYSksYSgpP24uZnguc3RhcnQoKTpuLnRpbWVycy5wb3AoKX0sbi5meC5pbnRlcnZhbD0xMyxuLmZ4LnN0YXJ0PWZ1bmN0aW9uKCl7TWJ8fChNYj1zZXRJbnRlcnZhbChuLmZ4LnRpY2ssbi5meC5pbnRlcnZhbCkpfSxuLmZ4LnN0b3A9ZnVuY3Rpb24oKXtjbGVhckludGVydmFsKE1iKSxNYj1udWxsfSxuLmZ4LnNwZWVkcz17c2xvdzo2MDAsZmFzdDoyMDAsX2RlZmF1bHQ6NDAwfSxuLmZuLmRlbGF5PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9bi5meD9uLmZ4LnNwZWVkc1thXXx8YTphLGI9Ynx8XCJmeFwiLHRoaXMucXVldWUoYixmdW5jdGlvbihiLGMpe3ZhciBkPXNldFRpbWVvdXQoYixhKTtjLnN0b3A9ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoZCl9fSl9LGZ1bmN0aW9uKCl7dmFyIGE9bC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksYj1sLmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIiksYz1iLmFwcGVuZENoaWxkKGwuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKSk7YS50eXBlPVwiY2hlY2tib3hcIixrLmNoZWNrT249XCJcIiE9PWEudmFsdWUsay5vcHRTZWxlY3RlZD1jLnNlbGVjdGVkLGIuZGlzYWJsZWQ9ITAsay5vcHREaXNhYmxlZD0hYy5kaXNhYmxlZCxhPWwuY3JlYXRlRWxlbWVudChcImlucHV0XCIpLGEudmFsdWU9XCJ0XCIsYS50eXBlPVwicmFkaW9cIixrLnJhZGlvVmFsdWU9XCJ0XCI9PT1hLnZhbHVlfSgpO3ZhciBZYixaYiwkYj1uLmV4cHIuYXR0ckhhbmRsZTtuLmZuLmV4dGVuZCh7YXR0cjpmdW5jdGlvbihhLGIpe3JldHVybiBKKHRoaXMsbi5hdHRyLGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtuLnJlbW92ZUF0dHIodGhpcyxhKX0pfX0pLG4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGY9YS5ub2RlVHlwZTtpZihhJiYzIT09ZiYmOCE9PWYmJjIhPT1mKXJldHVybiB0eXBlb2YgYS5nZXRBdHRyaWJ1dGU9PT1VP24ucHJvcChhLGIsYyk6KDE9PT1mJiZuLmlzWE1MRG9jKGEpfHwoYj1iLnRvTG93ZXJDYXNlKCksZD1uLmF0dHJIb29rc1tiXXx8KG4uZXhwci5tYXRjaC5ib29sLnRlc3QoYik/WmI6WWIpKSx2b2lkIDA9PT1jP2QmJlwiZ2V0XCJpbiBkJiZudWxsIT09KGU9ZC5nZXQoYSxiKSk/ZTooZT1uLmZpbmQuYXR0cihhLGIpLG51bGw9PWU/dm9pZCAwOmUpOm51bGwhPT1jP2QmJlwic2V0XCJpbiBkJiZ2b2lkIDAhPT0oZT1kLnNldChhLGMsYikpP2U6KGEuc2V0QXR0cmlidXRlKGIsYytcIlwiKSxjKTp2b2lkIG4ucmVtb3ZlQXR0cihhLGIpKVxyXG59LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGU9MCxmPWImJmIubWF0Y2goRSk7aWYoZiYmMT09PWEubm9kZVR5cGUpd2hpbGUoYz1mW2UrK10pZD1uLnByb3BGaXhbY118fGMsbi5leHByLm1hdGNoLmJvb2wudGVzdChjKSYmKGFbZF09ITEpLGEucmVtb3ZlQXR0cmlidXRlKGMpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihhLGIpe2lmKCFrLnJhZGlvVmFsdWUmJlwicmFkaW9cIj09PWImJm4ubm9kZU5hbWUoYSxcImlucHV0XCIpKXt2YXIgYz1hLnZhbHVlO3JldHVybiBhLnNldEF0dHJpYnV0ZShcInR5cGVcIixiKSxjJiYoYS52YWx1ZT1jKSxifX19fX0pLFpiPXtzZXQ6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBiPT09ITE/bi5yZW1vdmVBdHRyKGEsYyk6YS5zZXRBdHRyaWJ1dGUoYyxjKSxjfX0sbi5lYWNoKG4uZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCgvXFx3Ky9nKSxmdW5jdGlvbihhLGIpe3ZhciBjPSRiW2JdfHxuLmZpbmQuYXR0cjskYltiXT1mdW5jdGlvbihhLGIsZCl7dmFyIGUsZjtyZXR1cm4gZHx8KGY9JGJbYl0sJGJbYl09ZSxlPW51bGwhPWMoYSxiLGQpP2IudG9Mb3dlckNhc2UoKTpudWxsLCRiW2JdPWYpLGV9fSk7dmFyIF9iPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2k7bi5mbi5leHRlbmQoe3Byb3A6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gSih0aGlzLG4ucHJvcCxhLGIsYXJndW1lbnRzLmxlbmd0aD4xKX0scmVtb3ZlUHJvcDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXNbbi5wcm9wRml4W2FdfHxhXX0pfX0pLG4uZXh0ZW5kKHtwcm9wRml4OntcImZvclwiOlwiaHRtbEZvclwiLFwiY2xhc3NcIjpcImNsYXNzTmFtZVwifSxwcm9wOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZz1hLm5vZGVUeXBlO2lmKGEmJjMhPT1nJiY4IT09ZyYmMiE9PWcpcmV0dXJuIGY9MSE9PWd8fCFuLmlzWE1MRG9jKGEpLGYmJihiPW4ucHJvcEZpeFtiXXx8YixlPW4ucHJvcEhvb2tzW2JdKSx2b2lkIDAhPT1jP2UmJlwic2V0XCJpbiBlJiZ2b2lkIDAhPT0oZD1lLnNldChhLGMsYikpP2Q6YVtiXT1jOmUmJlwiZ2V0XCJpbiBlJiZudWxsIT09KGQ9ZS5nZXQoYSxiKSk/ZDphW2JdfSxwcm9wSG9va3M6e3RhYkluZGV4OntnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuaGFzQXR0cmlidXRlKFwidGFiaW5kZXhcIil8fF9iLnRlc3QoYS5ub2RlTmFtZSl8fGEuaHJlZj9hLnRhYkluZGV4Oi0xfX19fSksay5vcHRTZWxlY3RlZHx8KG4ucHJvcEhvb2tzLnNlbGVjdGVkPXtnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnROb2RlO3JldHVybiBiJiZiLnBhcmVudE5vZGUmJmIucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4LG51bGx9fSksbi5lYWNoKFtcInRhYkluZGV4XCIsXCJyZWFkT25seVwiLFwibWF4TGVuZ3RoXCIsXCJjZWxsU3BhY2luZ1wiLFwiY2VsbFBhZGRpbmdcIixcInJvd1NwYW5cIixcImNvbFNwYW5cIixcInVzZU1hcFwiLFwiZnJhbWVCb3JkZXJcIixcImNvbnRlbnRFZGl0YWJsZVwiXSxmdW5jdGlvbigpe24ucHJvcEZpeFt0aGlzLnRvTG93ZXJDYXNlKCldPXRoaXN9KTt2YXIgYWM9L1tcXHRcXHJcXG5cXGZdL2c7bi5mbi5leHRlbmQoe2FkZENsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGYsZyxoPVwic3RyaW5nXCI9PXR5cGVvZiBhJiZhLGk9MCxqPXRoaXMubGVuZ3RoO2lmKG4uaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe24odGhpcykuYWRkQ2xhc3MoYS5jYWxsKHRoaXMsYix0aGlzLmNsYXNzTmFtZSkpfSk7aWYoaClmb3IoYj0oYXx8XCJcIikubWF0Y2goRSl8fFtdO2o+aTtpKyspaWYoYz10aGlzW2ldLGQ9MT09PWMubm9kZVR5cGUmJihjLmNsYXNzTmFtZT8oXCIgXCIrYy5jbGFzc05hbWUrXCIgXCIpLnJlcGxhY2UoYWMsXCIgXCIpOlwiIFwiKSl7Zj0wO3doaWxlKGU9YltmKytdKWQuaW5kZXhPZihcIiBcIitlK1wiIFwiKTwwJiYoZCs9ZStcIiBcIik7Zz1uLnRyaW0oZCksYy5jbGFzc05hbWUhPT1nJiYoYy5jbGFzc05hbWU9Zyl9cmV0dXJuIHRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGYsZyxoPTA9PT1hcmd1bWVudHMubGVuZ3RofHxcInN0cmluZ1wiPT10eXBlb2YgYSYmYSxpPTAsaj10aGlzLmxlbmd0aDtpZihuLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtuKHRoaXMpLnJlbW92ZUNsYXNzKGEuY2FsbCh0aGlzLGIsdGhpcy5jbGFzc05hbWUpKX0pO2lmKGgpZm9yKGI9KGF8fFwiXCIpLm1hdGNoKEUpfHxbXTtqPmk7aSsrKWlmKGM9dGhpc1tpXSxkPTE9PT1jLm5vZGVUeXBlJiYoYy5jbGFzc05hbWU/KFwiIFwiK2MuY2xhc3NOYW1lK1wiIFwiKS5yZXBsYWNlKGFjLFwiIFwiKTpcIlwiKSl7Zj0wO3doaWxlKGU9YltmKytdKXdoaWxlKGQuaW5kZXhPZihcIiBcIitlK1wiIFwiKT49MClkPWQucmVwbGFjZShcIiBcIitlK1wiIFwiLFwiIFwiKTtnPWE/bi50cmltKGQpOlwiXCIsYy5jbGFzc05hbWUhPT1nJiYoYy5jbGFzc05hbWU9Zyl9cmV0dXJuIHRoaXN9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dHlwZW9mIGE7cmV0dXJuXCJib29sZWFuXCI9PXR5cGVvZiBiJiZcInN0cmluZ1wiPT09Yz9iP3RoaXMuYWRkQ2xhc3MoYSk6dGhpcy5yZW1vdmVDbGFzcyhhKTp0aGlzLmVhY2gobi5pc0Z1bmN0aW9uKGEpP2Z1bmN0aW9uKGMpe24odGhpcykudG9nZ2xlQ2xhc3MoYS5jYWxsKHRoaXMsYyx0aGlzLmNsYXNzTmFtZSxiKSxiKX06ZnVuY3Rpb24oKXtpZihcInN0cmluZ1wiPT09Yyl7dmFyIGIsZD0wLGU9bih0aGlzKSxmPWEubWF0Y2goRSl8fFtdO3doaWxlKGI9ZltkKytdKWUuaGFzQ2xhc3MoYik/ZS5yZW1vdmVDbGFzcyhiKTplLmFkZENsYXNzKGIpfWVsc2UoYz09PVV8fFwiYm9vbGVhblwiPT09YykmJih0aGlzLmNsYXNzTmFtZSYmTC5zZXQodGhpcyxcIl9fY2xhc3NOYW1lX19cIix0aGlzLmNsYXNzTmFtZSksdGhpcy5jbGFzc05hbWU9dGhpcy5jbGFzc05hbWV8fGE9PT0hMT9cIlwiOkwuZ2V0KHRoaXMsXCJfX2NsYXNzTmFtZV9fXCIpfHxcIlwiKX0pfSxoYXNDbGFzczpmdW5jdGlvbihhKXtmb3IodmFyIGI9XCIgXCIrYStcIiBcIixjPTAsZD10aGlzLmxlbmd0aDtkPmM7YysrKWlmKDE9PT10aGlzW2NdLm5vZGVUeXBlJiYoXCIgXCIrdGhpc1tjXS5jbGFzc05hbWUrXCIgXCIpLnJlcGxhY2UoYWMsXCIgXCIpLmluZGV4T2YoYik+PTApcmV0dXJuITA7cmV0dXJuITF9fSk7dmFyIGJjPS9cXHIvZztuLmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlPXRoaXNbMF07e2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGQ9bi5pc0Z1bmN0aW9uKGEpLHRoaXMuZWFjaChmdW5jdGlvbihjKXt2YXIgZTsxPT09dGhpcy5ub2RlVHlwZSYmKGU9ZD9hLmNhbGwodGhpcyxjLG4odGhpcykudmFsKCkpOmEsbnVsbD09ZT9lPVwiXCI6XCJudW1iZXJcIj09dHlwZW9mIGU/ZSs9XCJcIjpuLmlzQXJyYXkoZSkmJihlPW4ubWFwKGUsZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/XCJcIjphK1wiXCJ9KSksYj1uLnZhbEhvb2tzW3RoaXMudHlwZV18fG4udmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSxiJiZcInNldFwiaW4gYiYmdm9pZCAwIT09Yi5zZXQodGhpcyxlLFwidmFsdWVcIil8fCh0aGlzLnZhbHVlPWUpKX0pO2lmKGUpcmV0dXJuIGI9bi52YWxIb29rc1tlLnR5cGVdfHxuLnZhbEhvb2tzW2Uubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0sYiYmXCJnZXRcImluIGImJnZvaWQgMCE9PShjPWIuZ2V0KGUsXCJ2YWx1ZVwiKSk/YzooYz1lLnZhbHVlLFwic3RyaW5nXCI9PXR5cGVvZiBjP2MucmVwbGFjZShiYyxcIlwiKTpudWxsPT1jP1wiXCI6Yyl9fX0pLG4uZXh0ZW5kKHt2YWxIb29rczp7b3B0aW9uOntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9bi5maW5kLmF0dHIoYSxcInZhbHVlXCIpO3JldHVybiBudWxsIT1iP2I6bi50cmltKG4udGV4dChhKSl9fSxzZWxlY3Q6e2dldDpmdW5jdGlvbihhKXtmb3IodmFyIGIsYyxkPWEub3B0aW9ucyxlPWEuc2VsZWN0ZWRJbmRleCxmPVwic2VsZWN0LW9uZVwiPT09YS50eXBlfHwwPmUsZz1mP251bGw6W10saD1mP2UrMTpkLmxlbmd0aCxpPTA+ZT9oOmY/ZTowO2g+aTtpKyspaWYoYz1kW2ldLCEoIWMuc2VsZWN0ZWQmJmkhPT1lfHwoay5vcHREaXNhYmxlZD9jLmRpc2FibGVkOm51bGwhPT1jLmdldEF0dHJpYnV0ZShcImRpc2FibGVkXCIpKXx8Yy5wYXJlbnROb2RlLmRpc2FibGVkJiZuLm5vZGVOYW1lKGMucGFyZW50Tm9kZSxcIm9wdGdyb3VwXCIpKSl7aWYoYj1uKGMpLnZhbCgpLGYpcmV0dXJuIGI7Zy5wdXNoKGIpfXJldHVybiBnfSxzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGU9YS5vcHRpb25zLGY9bi5tYWtlQXJyYXkoYiksZz1lLmxlbmd0aDt3aGlsZShnLS0pZD1lW2ddLChkLnNlbGVjdGVkPW4uaW5BcnJheShkLnZhbHVlLGYpPj0wKSYmKGM9ITApO3JldHVybiBjfHwoYS5zZWxlY3RlZEluZGV4PS0xKSxmfX19fSksbi5lYWNoKFtcInJhZGlvXCIsXCJjaGVja2JveFwiXSxmdW5jdGlvbigpe24udmFsSG9va3NbdGhpc109e3NldDpmdW5jdGlvbihhLGIpe3JldHVybiBuLmlzQXJyYXkoYik/YS5jaGVja2VkPW4uaW5BcnJheShuKGEpLnZhbCgpLGIpPj0wOnZvaWQgMH19LGsuY2hlY2tPbnx8KG4udmFsSG9va3NbdGhpc10uZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT09YS5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKT9cIm9uXCI6YS52YWx1ZX0pfSksbi5lYWNoKFwiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IGxvYWQgcmVzaXplIHNjcm9sbCB1bmxvYWQgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBlcnJvciBjb250ZXh0bWVudVwiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhLGIpe24uZm5bYl09ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMub24oYixudWxsLGEsYyk6dGhpcy50cmlnZ2VyKGIpfX0pLG4uZm4uZXh0ZW5kKHtob3ZlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLm1vdXNlZW50ZXIoYSkubW91c2VsZWF2ZShifHxhKX0sYmluZDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMub24oYSxudWxsLGIsYyl9LHVuYmluZDpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLm9mZihhLG51bGwsYil9LGRlbGVnYXRlOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLm9uKGIsYSxjLGQpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoYSxcIioqXCIpOnRoaXMub2ZmKGIsYXx8XCIqKlwiLGMpfX0pO3ZhciBjYz1uLm5vdygpLGRjPS9cXD8vO24ucGFyc2VKU09OPWZ1bmN0aW9uKGEpe3JldHVybiBKU09OLnBhcnNlKGErXCJcIil9LG4ucGFyc2VYTUw9ZnVuY3Rpb24oYSl7dmFyIGIsYztpZighYXx8XCJzdHJpbmdcIiE9dHlwZW9mIGEpcmV0dXJuIG51bGw7dHJ5e2M9bmV3IERPTVBhcnNlcixiPWMucGFyc2VGcm9tU3RyaW5nKGEsXCJ0ZXh0L3htbFwiKX1jYXRjaChkKXtiPXZvaWQgMH1yZXR1cm4oIWJ8fGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJwYXJzZXJlcnJvclwiKS5sZW5ndGgpJiZuLmVycm9yKFwiSW52YWxpZCBYTUw6IFwiK2EpLGJ9O3ZhciBlYz0vIy4qJC8sZmM9LyhbPyZdKV89W14mXSovLGdjPS9eKC4qPyk6WyBcXHRdKihbXlxcclxcbl0qKSQvZ20saGM9L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8saWM9L14oPzpHRVR8SEVBRCkkLyxqYz0vXlxcL1xcLy8sa2M9L14oW1xcdy4rLV0rOikoPzpcXC9cXC8oPzpbXlxcLz8jXSpAfCkoW15cXC8/IzpdKikoPzo6KFxcZCspfCl8KS8sbGM9e30sbWM9e30sbmM9XCIqL1wiLmNvbmNhdChcIipcIiksb2M9YS5sb2NhdGlvbi5ocmVmLHBjPWtjLmV4ZWMob2MudG9Mb3dlckNhc2UoKSl8fFtdO2Z1bmN0aW9uIHFjKGEpe3JldHVybiBmdW5jdGlvbihiLGMpe1wic3RyaW5nXCIhPXR5cGVvZiBiJiYoYz1iLGI9XCIqXCIpO3ZhciBkLGU9MCxmPWIudG9Mb3dlckNhc2UoKS5tYXRjaChFKXx8W107aWYobi5pc0Z1bmN0aW9uKGMpKXdoaWxlKGQ9ZltlKytdKVwiK1wiPT09ZFswXT8oZD1kLnNsaWNlKDEpfHxcIipcIiwoYVtkXT1hW2RdfHxbXSkudW5zaGlmdChjKSk6KGFbZF09YVtkXXx8W10pLnB1c2goYyl9fWZ1bmN0aW9uIHJjKGEsYixjLGQpe3ZhciBlPXt9LGY9YT09PW1jO2Z1bmN0aW9uIGcoaCl7dmFyIGk7cmV0dXJuIGVbaF09ITAsbi5lYWNoKGFbaF18fFtdLGZ1bmN0aW9uKGEsaCl7dmFyIGo9aChiLGMsZCk7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGp8fGZ8fGVbal0/Zj8hKGk9aik6dm9pZCAwOihiLmRhdGFUeXBlcy51bnNoaWZ0KGopLGcoaiksITEpfSksaX1yZXR1cm4gZyhiLmRhdGFUeXBlc1swXSl8fCFlW1wiKlwiXSYmZyhcIipcIil9ZnVuY3Rpb24gc2MoYSxiKXt2YXIgYyxkLGU9bi5hamF4U2V0dGluZ3MuZmxhdE9wdGlvbnN8fHt9O2ZvcihjIGluIGIpdm9pZCAwIT09YltjXSYmKChlW2NdP2E6ZHx8KGQ9e30pKVtjXT1iW2NdKTtyZXR1cm4gZCYmbi5leHRlbmQoITAsYSxkKSxhfWZ1bmN0aW9uIHRjKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuY29udGVudHMsaT1hLmRhdGFUeXBlczt3aGlsZShcIipcIj09PWlbMF0paS5zaGlmdCgpLHZvaWQgMD09PWQmJihkPWEubWltZVR5cGV8fGIuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIikpO2lmKGQpZm9yKGUgaW4gaClpZihoW2VdJiZoW2VdLnRlc3QoZCkpe2kudW5zaGlmdChlKTticmVha31pZihpWzBdaW4gYylmPWlbMF07ZWxzZXtmb3IoZSBpbiBjKXtpZighaVswXXx8YS5jb252ZXJ0ZXJzW2UrXCIgXCIraVswXV0pe2Y9ZTticmVha31nfHwoZz1lKX1mPWZ8fGd9cmV0dXJuIGY/KGYhPT1pWzBdJiZpLnVuc2hpZnQoZiksY1tmXSk6dm9pZCAwfWZ1bmN0aW9uIHVjKGEsYixjLGQpe3ZhciBlLGYsZyxoLGksaj17fSxrPWEuZGF0YVR5cGVzLnNsaWNlKCk7aWYoa1sxXSlmb3IoZyBpbiBhLmNvbnZlcnRlcnMpaltnLnRvTG93ZXJDYXNlKCldPWEuY29udmVydGVyc1tnXTtmPWsuc2hpZnQoKTt3aGlsZShmKWlmKGEucmVzcG9uc2VGaWVsZHNbZl0mJihjW2EucmVzcG9uc2VGaWVsZHNbZl1dPWIpLCFpJiZkJiZhLmRhdGFGaWx0ZXImJihiPWEuZGF0YUZpbHRlcihiLGEuZGF0YVR5cGUpKSxpPWYsZj1rLnNoaWZ0KCkpaWYoXCIqXCI9PT1mKWY9aTtlbHNlIGlmKFwiKlwiIT09aSYmaSE9PWYpe2lmKGc9altpK1wiIFwiK2ZdfHxqW1wiKiBcIitmXSwhZylmb3IoZSBpbiBqKWlmKGg9ZS5zcGxpdChcIiBcIiksaFsxXT09PWYmJihnPWpbaStcIiBcIitoWzBdXXx8altcIiogXCIraFswXV0pKXtnPT09ITA/Zz1qW2VdOmpbZV0hPT0hMCYmKGY9aFswXSxrLnVuc2hpZnQoaFsxXSkpO2JyZWFrfWlmKGchPT0hMClpZihnJiZhW1widGhyb3dzXCJdKWI9ZyhiKTtlbHNlIHRyeXtiPWcoYil9Y2F0Y2gobCl7cmV0dXJue3N0YXRlOlwicGFyc2VyZXJyb3JcIixlcnJvcjpnP2w6XCJObyBjb252ZXJzaW9uIGZyb20gXCIraStcIiB0byBcIitmfX19cmV0dXJue3N0YXRlOlwic3VjY2Vzc1wiLGRhdGE6Yn19bi5leHRlbmQoe2FjdGl2ZTowLGxhc3RNb2RpZmllZDp7fSxldGFnOnt9LGFqYXhTZXR0aW5nczp7dXJsOm9jLHR5cGU6XCJHRVRcIixpc0xvY2FsOmhjLnRlc3QocGNbMV0pLGdsb2JhbDohMCxwcm9jZXNzRGF0YTohMCxhc3luYzohMCxjb250ZW50VHlwZTpcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOFwiLGFjY2VwdHM6e1wiKlwiOm5jLHRleHQ6XCJ0ZXh0L3BsYWluXCIsaHRtbDpcInRleHQvaHRtbFwiLHhtbDpcImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWxcIixqc29uOlwiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0XCJ9LGNvbnRlbnRzOnt4bWw6L3htbC8saHRtbDovaHRtbC8sanNvbjovanNvbi99LHJlc3BvbnNlRmllbGRzOnt4bWw6XCJyZXNwb25zZVhNTFwiLHRleHQ6XCJyZXNwb25zZVRleHRcIixqc29uOlwicmVzcG9uc2VKU09OXCJ9LGNvbnZlcnRlcnM6e1wiKiB0ZXh0XCI6U3RyaW5nLFwidGV4dCBodG1sXCI6ITAsXCJ0ZXh0IGpzb25cIjpuLnBhcnNlSlNPTixcInRleHQgeG1sXCI6bi5wYXJzZVhNTH0sZmxhdE9wdGlvbnM6e3VybDohMCxjb250ZXh0OiEwfX0sYWpheFNldHVwOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGI/c2Moc2MoYSxuLmFqYXhTZXR0aW5ncyksYik6c2Mobi5hamF4U2V0dGluZ3MsYSl9LGFqYXhQcmVmaWx0ZXI6cWMobGMpLGFqYXhUcmFuc3BvcnQ6cWMobWMpLGFqYXg6ZnVuY3Rpb24oYSxiKXtcIm9iamVjdFwiPT10eXBlb2YgYSYmKGI9YSxhPXZvaWQgMCksYj1ifHx7fTt2YXIgYyxkLGUsZixnLGgsaSxqLGs9bi5hamF4U2V0dXAoe30sYiksbD1rLmNvbnRleHR8fGssbT1rLmNvbnRleHQmJihsLm5vZGVUeXBlfHxsLmpxdWVyeSk/bihsKTpuLmV2ZW50LG89bi5EZWZlcnJlZCgpLHA9bi5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKSxxPWsuc3RhdHVzQ29kZXx8e30scj17fSxzPXt9LHQ9MCx1PVwiY2FuY2VsZWRcIix2PXtyZWFkeVN0YXRlOjAsZ2V0UmVzcG9uc2VIZWFkZXI6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoMj09PXQpe2lmKCFmKXtmPXt9O3doaWxlKGI9Z2MuZXhlYyhlKSlmW2JbMV0udG9Mb3dlckNhc2UoKV09YlsyXX1iPWZbYS50b0xvd2VyQ2FzZSgpXX1yZXR1cm4gbnVsbD09Yj9udWxsOmJ9LGdldEFsbFJlc3BvbnNlSGVhZGVyczpmdW5jdGlvbigpe3JldHVybiAyPT09dD9lOm51bGx9LHNldFJlcXVlc3RIZWFkZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLnRvTG93ZXJDYXNlKCk7cmV0dXJuIHR8fChhPXNbY109c1tjXXx8YSxyW2FdPWIpLHRoaXN9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24oYSl7cmV0dXJuIHR8fChrLm1pbWVUeXBlPWEpLHRoaXN9LHN0YXR1c0NvZGU6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoYSlpZigyPnQpZm9yKGIgaW4gYSlxW2JdPVtxW2JdLGFbYl1dO2Vsc2Ugdi5hbHdheXMoYVt2LnN0YXR1c10pO3JldHVybiB0aGlzfSxhYm9ydDpmdW5jdGlvbihhKXt2YXIgYj1hfHx1O3JldHVybiBjJiZjLmFib3J0KGIpLHgoMCxiKSx0aGlzfX07aWYoby5wcm9taXNlKHYpLmNvbXBsZXRlPXAuYWRkLHYuc3VjY2Vzcz12LmRvbmUsdi5lcnJvcj12LmZhaWwsay51cmw9KChhfHxrLnVybHx8b2MpK1wiXCIpLnJlcGxhY2UoZWMsXCJcIikucmVwbGFjZShqYyxwY1sxXStcIi8vXCIpLGsudHlwZT1iLm1ldGhvZHx8Yi50eXBlfHxrLm1ldGhvZHx8ay50eXBlLGsuZGF0YVR5cGVzPW4udHJpbShrLmRhdGFUeXBlfHxcIipcIikudG9Mb3dlckNhc2UoKS5tYXRjaChFKXx8W1wiXCJdLG51bGw9PWsuY3Jvc3NEb21haW4mJihoPWtjLmV4ZWMoay51cmwudG9Mb3dlckNhc2UoKSksay5jcm9zc0RvbWFpbj0hKCFofHxoWzFdPT09cGNbMV0mJmhbMl09PT1wY1syXSYmKGhbM118fChcImh0dHA6XCI9PT1oWzFdP1wiODBcIjpcIjQ0M1wiKSk9PT0ocGNbM118fChcImh0dHA6XCI9PT1wY1sxXT9cIjgwXCI6XCI0NDNcIikpKSksay5kYXRhJiZrLnByb2Nlc3NEYXRhJiZcInN0cmluZ1wiIT10eXBlb2Ygay5kYXRhJiYoay5kYXRhPW4ucGFyYW0oay5kYXRhLGsudHJhZGl0aW9uYWwpKSxyYyhsYyxrLGIsdiksMj09PXQpcmV0dXJuIHY7aT1uLmV2ZW50JiZrLmdsb2JhbCxpJiYwPT09bi5hY3RpdmUrKyYmbi5ldmVudC50cmlnZ2VyKFwiYWpheFN0YXJ0XCIpLGsudHlwZT1rLnR5cGUudG9VcHBlckNhc2UoKSxrLmhhc0NvbnRlbnQ9IWljLnRlc3Qoay50eXBlKSxkPWsudXJsLGsuaGFzQ29udGVudHx8KGsuZGF0YSYmKGQ9ay51cmwrPShkYy50ZXN0KGQpP1wiJlwiOlwiP1wiKStrLmRhdGEsZGVsZXRlIGsuZGF0YSksay5jYWNoZT09PSExJiYoay51cmw9ZmMudGVzdChkKT9kLnJlcGxhY2UoZmMsXCIkMV89XCIrY2MrKyk6ZCsoZGMudGVzdChkKT9cIiZcIjpcIj9cIikrXCJfPVwiK2NjKyspKSxrLmlmTW9kaWZpZWQmJihuLmxhc3RNb2RpZmllZFtkXSYmdi5zZXRSZXF1ZXN0SGVhZGVyKFwiSWYtTW9kaWZpZWQtU2luY2VcIixuLmxhc3RNb2RpZmllZFtkXSksbi5ldGFnW2RdJiZ2LnNldFJlcXVlc3RIZWFkZXIoXCJJZi1Ob25lLU1hdGNoXCIsbi5ldGFnW2RdKSksKGsuZGF0YSYmay5oYXNDb250ZW50JiZrLmNvbnRlbnRUeXBlIT09ITF8fGIuY29udGVudFR5cGUpJiZ2LnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIixrLmNvbnRlbnRUeXBlKSx2LnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIixrLmRhdGFUeXBlc1swXSYmay5hY2NlcHRzW2suZGF0YVR5cGVzWzBdXT9rLmFjY2VwdHNbay5kYXRhVHlwZXNbMF1dKyhcIipcIiE9PWsuZGF0YVR5cGVzWzBdP1wiLCBcIituYytcIjsgcT0wLjAxXCI6XCJcIik6ay5hY2NlcHRzW1wiKlwiXSk7Zm9yKGogaW4gay5oZWFkZXJzKXYuc2V0UmVxdWVzdEhlYWRlcihqLGsuaGVhZGVyc1tqXSk7aWYoay5iZWZvcmVTZW5kJiYoay5iZWZvcmVTZW5kLmNhbGwobCx2LGspPT09ITF8fDI9PT10KSlyZXR1cm4gdi5hYm9ydCgpO3U9XCJhYm9ydFwiO2ZvcihqIGlue3N1Y2Nlc3M6MSxlcnJvcjoxLGNvbXBsZXRlOjF9KXZbal0oa1tqXSk7aWYoYz1yYyhtYyxrLGIsdikpe3YucmVhZHlTdGF0ZT0xLGkmJm0udHJpZ2dlcihcImFqYXhTZW5kXCIsW3Ysa10pLGsuYXN5bmMmJmsudGltZW91dD4wJiYoZz1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7di5hYm9ydChcInRpbWVvdXRcIil9LGsudGltZW91dCkpO3RyeXt0PTEsYy5zZW5kKHIseCl9Y2F0Y2godyl7aWYoISgyPnQpKXRocm93IHc7eCgtMSx3KX19ZWxzZSB4KC0xLFwiTm8gVHJhbnNwb3J0XCIpO2Z1bmN0aW9uIHgoYSxiLGYsaCl7dmFyIGoscixzLHUsdyx4PWI7MiE9PXQmJih0PTIsZyYmY2xlYXJUaW1lb3V0KGcpLGM9dm9pZCAwLGU9aHx8XCJcIix2LnJlYWR5U3RhdGU9YT4wPzQ6MCxqPWE+PTIwMCYmMzAwPmF8fDMwND09PWEsZiYmKHU9dGMoayx2LGYpKSx1PXVjKGssdSx2LGopLGo/KGsuaWZNb2RpZmllZCYmKHc9di5nZXRSZXNwb25zZUhlYWRlcihcIkxhc3QtTW9kaWZpZWRcIiksdyYmKG4ubGFzdE1vZGlmaWVkW2RdPXcpLHc9di5nZXRSZXNwb25zZUhlYWRlcihcImV0YWdcIiksdyYmKG4uZXRhZ1tkXT13KSksMjA0PT09YXx8XCJIRUFEXCI9PT1rLnR5cGU/eD1cIm5vY29udGVudFwiOjMwND09PWE/eD1cIm5vdG1vZGlmaWVkXCI6KHg9dS5zdGF0ZSxyPXUuZGF0YSxzPXUuZXJyb3Isaj0hcykpOihzPXgsKGF8fCF4KSYmKHg9XCJlcnJvclwiLDA+YSYmKGE9MCkpKSx2LnN0YXR1cz1hLHYuc3RhdHVzVGV4dD0oYnx8eCkrXCJcIixqP28ucmVzb2x2ZVdpdGgobCxbcix4LHZdKTpvLnJlamVjdFdpdGgobCxbdix4LHNdKSx2LnN0YXR1c0NvZGUocSkscT12b2lkIDAsaSYmbS50cmlnZ2VyKGo/XCJhamF4U3VjY2Vzc1wiOlwiYWpheEVycm9yXCIsW3YsayxqP3I6c10pLHAuZmlyZVdpdGgobCxbdix4XSksaSYmKG0udHJpZ2dlcihcImFqYXhDb21wbGV0ZVwiLFt2LGtdKSwtLW4uYWN0aXZlfHxuLmV2ZW50LnRyaWdnZXIoXCJhamF4U3RvcFwiKSkpfXJldHVybiB2fSxnZXRKU09OOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gbi5nZXQoYSxiLGMsXCJqc29uXCIpfSxnZXRTY3JpcHQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbi5nZXQoYSx2b2lkIDAsYixcInNjcmlwdFwiKX19KSxuLmVhY2goW1wiZ2V0XCIsXCJwb3N0XCJdLGZ1bmN0aW9uKGEsYil7bltiXT1mdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gbi5pc0Z1bmN0aW9uKGMpJiYoZT1lfHxkLGQ9YyxjPXZvaWQgMCksbi5hamF4KHt1cmw6YSx0eXBlOmIsZGF0YVR5cGU6ZSxkYXRhOmMsc3VjY2VzczpkfSl9fSksbi5fZXZhbFVybD1mdW5jdGlvbihhKXtyZXR1cm4gbi5hamF4KHt1cmw6YSx0eXBlOlwiR0VUXCIsZGF0YVR5cGU6XCJzY3JpcHRcIixhc3luYzohMSxnbG9iYWw6ITEsXCJ0aHJvd3NcIjohMH0pfSxuLmZuLmV4dGVuZCh7d3JhcEFsbDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gbi5pc0Z1bmN0aW9uKGEpP3RoaXMuZWFjaChmdW5jdGlvbihiKXtuKHRoaXMpLndyYXBBbGwoYS5jYWxsKHRoaXMsYikpfSk6KHRoaXNbMF0mJihiPW4oYSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJmIuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLGIubWFwKGZ1bmN0aW9uKCl7dmFyIGE9dGhpczt3aGlsZShhLmZpcnN0RWxlbWVudENoaWxkKWE9YS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gYX0pLmFwcGVuZCh0aGlzKSksdGhpcyl9LHdyYXBJbm5lcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKG4uaXNGdW5jdGlvbihhKT9mdW5jdGlvbihiKXtuKHRoaXMpLndyYXBJbm5lcihhLmNhbGwodGhpcyxiKSl9OmZ1bmN0aW9uKCl7dmFyIGI9bih0aGlzKSxjPWIuY29udGVudHMoKTtjLmxlbmd0aD9jLndyYXBBbGwoYSk6Yi5hcHBlbmQoYSl9KX0sd3JhcDpmdW5jdGlvbihhKXt2YXIgYj1uLmlzRnVuY3Rpb24oYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihjKXtuKHRoaXMpLndyYXBBbGwoYj9hLmNhbGwodGhpcyxjKTphKX0pfSx1bndyYXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJlbnQoKS5lYWNoKGZ1bmN0aW9uKCl7bi5ub2RlTmFtZSh0aGlzLFwiYm9keVwiKXx8bih0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpfSkuZW5kKCl9fSksbi5leHByLmZpbHRlcnMuaGlkZGVuPWZ1bmN0aW9uKGEpe3JldHVybiBhLm9mZnNldFdpZHRoPD0wJiZhLm9mZnNldEhlaWdodDw9MH0sbi5leHByLmZpbHRlcnMudmlzaWJsZT1mdW5jdGlvbihhKXtyZXR1cm4hbi5leHByLmZpbHRlcnMuaGlkZGVuKGEpfTt2YXIgdmM9LyUyMC9nLHdjPS9cXFtcXF0kLyx4Yz0vXFxyP1xcbi9nLHljPS9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSx6Yz0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7ZnVuY3Rpb24gQWMoYSxiLGMsZCl7dmFyIGU7aWYobi5pc0FycmF5KGIpKW4uZWFjaChiLGZ1bmN0aW9uKGIsZSl7Y3x8d2MudGVzdChhKT9kKGEsZSk6QWMoYStcIltcIisoXCJvYmplY3RcIj09dHlwZW9mIGU/YjpcIlwiKStcIl1cIixlLGMsZCl9KTtlbHNlIGlmKGN8fFwib2JqZWN0XCIhPT1uLnR5cGUoYikpZChhLGIpO2Vsc2UgZm9yKGUgaW4gYilBYyhhK1wiW1wiK2UrXCJdXCIsYltlXSxjLGQpfW4ucGFyYW09ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVtdLGU9ZnVuY3Rpb24oYSxiKXtiPW4uaXNGdW5jdGlvbihiKT9iKCk6bnVsbD09Yj9cIlwiOmIsZFtkLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGEpK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChiKX07aWYodm9pZCAwPT09YiYmKGI9bi5hamF4U2V0dGluZ3MmJm4uYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsKSxuLmlzQXJyYXkoYSl8fGEuanF1ZXJ5JiYhbi5pc1BsYWluT2JqZWN0KGEpKW4uZWFjaChhLGZ1bmN0aW9uKCl7ZSh0aGlzLm5hbWUsdGhpcy52YWx1ZSl9KTtlbHNlIGZvcihjIGluIGEpQWMoYyxhW2NdLGIsZSk7cmV0dXJuIGQuam9pbihcIiZcIikucmVwbGFjZSh2YyxcIitcIil9LG4uZm4uZXh0ZW5kKHtzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gbi5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpfSxzZXJpYWxpemVBcnJheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPW4ucHJvcCh0aGlzLFwiZWxlbWVudHNcIik7cmV0dXJuIGE/bi5tYWtlQXJyYXkoYSk6dGhpc30pLmZpbHRlcihmdW5jdGlvbigpe3ZhciBhPXRoaXMudHlwZTtyZXR1cm4gdGhpcy5uYW1lJiYhbih0aGlzKS5pcyhcIjpkaXNhYmxlZFwiKSYmemMudGVzdCh0aGlzLm5vZGVOYW1lKSYmIXljLnRlc3QoYSkmJih0aGlzLmNoZWNrZWR8fCFULnRlc3QoYSkpfSkubWFwKGZ1bmN0aW9uKGEsYil7dmFyIGM9bih0aGlzKS52YWwoKTtyZXR1cm4gbnVsbD09Yz9udWxsOm4uaXNBcnJheShjKT9uLm1hcChjLGZ1bmN0aW9uKGEpe3JldHVybntuYW1lOmIubmFtZSx2YWx1ZTphLnJlcGxhY2UoeGMsXCJcXHJcXG5cIil9fSk6e25hbWU6Yi5uYW1lLHZhbHVlOmMucmVwbGFjZSh4YyxcIlxcclxcblwiKX19KS5nZXQoKX19KSxuLmFqYXhTZXR0aW5ncy54aHI9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIG5ldyBYTUxIdHRwUmVxdWVzdH1jYXRjaChhKXt9fTt2YXIgQmM9MCxDYz17fSxEYz17MDoyMDAsMTIyMzoyMDR9LEVjPW4uYWpheFNldHRpbmdzLnhocigpO2EuYXR0YWNoRXZlbnQmJmEuYXR0YWNoRXZlbnQoXCJvbnVubG9hZFwiLGZ1bmN0aW9uKCl7Zm9yKHZhciBhIGluIENjKUNjW2FdKCl9KSxrLmNvcnM9ISFFYyYmXCJ3aXRoQ3JlZGVudGlhbHNcImluIEVjLGsuYWpheD1FYz0hIUVjLG4uYWpheFRyYW5zcG9ydChmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gay5jb3JzfHxFYyYmIWEuY3Jvc3NEb21haW4/e3NlbmQ6ZnVuY3Rpb24oYyxkKXt2YXIgZSxmPWEueGhyKCksZz0rK0JjO2lmKGYub3BlbihhLnR5cGUsYS51cmwsYS5hc3luYyxhLnVzZXJuYW1lLGEucGFzc3dvcmQpLGEueGhyRmllbGRzKWZvcihlIGluIGEueGhyRmllbGRzKWZbZV09YS54aHJGaWVsZHNbZV07YS5taW1lVHlwZSYmZi5vdmVycmlkZU1pbWVUeXBlJiZmLm92ZXJyaWRlTWltZVR5cGUoYS5taW1lVHlwZSksYS5jcm9zc0RvbWFpbnx8Y1tcIlgtUmVxdWVzdGVkLVdpdGhcIl18fChjW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXT1cIlhNTEh0dHBSZXF1ZXN0XCIpO2ZvcihlIGluIGMpZi5zZXRSZXF1ZXN0SGVhZGVyKGUsY1tlXSk7Yj1mdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtiJiYoZGVsZXRlIENjW2ddLGI9Zi5vbmxvYWQ9Zi5vbmVycm9yPW51bGwsXCJhYm9ydFwiPT09YT9mLmFib3J0KCk6XCJlcnJvclwiPT09YT9kKGYuc3RhdHVzLGYuc3RhdHVzVGV4dCk6ZChEY1tmLnN0YXR1c118fGYuc3RhdHVzLGYuc3RhdHVzVGV4dCxcInN0cmluZ1wiPT10eXBlb2YgZi5yZXNwb25zZVRleHQ/e3RleHQ6Zi5yZXNwb25zZVRleHR9OnZvaWQgMCxmLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSl9fSxmLm9ubG9hZD1iKCksZi5vbmVycm9yPWIoXCJlcnJvclwiKSxiPUNjW2ddPWIoXCJhYm9ydFwiKTt0cnl7Zi5zZW5kKGEuaGFzQ29udGVudCYmYS5kYXRhfHxudWxsKX1jYXRjaChoKXtpZihiKXRocm93IGh9fSxhYm9ydDpmdW5jdGlvbigpe2ImJmIoKX19OnZvaWQgMH0pLG4uYWpheFNldHVwKHthY2NlcHRzOntzY3JpcHQ6XCJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdFwifSxjb250ZW50czp7c2NyaXB0Oi8oPzpqYXZhfGVjbWEpc2NyaXB0L30sY29udmVydGVyczp7XCJ0ZXh0IHNjcmlwdFwiOmZ1bmN0aW9uKGEpe3JldHVybiBuLmdsb2JhbEV2YWwoYSksYX19fSksbi5hamF4UHJlZmlsdGVyKFwic2NyaXB0XCIsZnVuY3Rpb24oYSl7dm9pZCAwPT09YS5jYWNoZSYmKGEuY2FjaGU9ITEpLGEuY3Jvc3NEb21haW4mJihhLnR5cGU9XCJHRVRcIil9KSxuLmFqYXhUcmFuc3BvcnQoXCJzY3JpcHRcIixmdW5jdGlvbihhKXtpZihhLmNyb3NzRG9tYWluKXt2YXIgYixjO3JldHVybntzZW5kOmZ1bmN0aW9uKGQsZSl7Yj1uKFwiPHNjcmlwdD5cIikucHJvcCh7YXN5bmM6ITAsY2hhcnNldDphLnNjcmlwdENoYXJzZXQsc3JjOmEudXJsfSkub24oXCJsb2FkIGVycm9yXCIsYz1mdW5jdGlvbihhKXtiLnJlbW92ZSgpLGM9bnVsbCxhJiZlKFwiZXJyb3JcIj09PWEudHlwZT80MDQ6MjAwLGEudHlwZSl9KSxsLmhlYWQuYXBwZW5kQ2hpbGQoYlswXSl9LGFib3J0OmZ1bmN0aW9uKCl7YyYmYygpfX19fSk7dmFyIEZjPVtdLEdjPS8oPSlcXD8oPz0mfCQpfFxcP1xcPy87bi5hamF4U2V0dXAoe2pzb25wOlwiY2FsbGJhY2tcIixqc29ucENhbGxiYWNrOmZ1bmN0aW9uKCl7dmFyIGE9RmMucG9wKCl8fG4uZXhwYW5kbytcIl9cIitjYysrO3JldHVybiB0aGlzW2FdPSEwLGF9fSksbi5hamF4UHJlZmlsdGVyKFwianNvbiBqc29ucFwiLGZ1bmN0aW9uKGIsYyxkKXt2YXIgZSxmLGcsaD1iLmpzb25wIT09ITEmJihHYy50ZXN0KGIudXJsKT9cInVybFwiOlwic3RyaW5nXCI9PXR5cGVvZiBiLmRhdGEmJiEoYi5jb250ZW50VHlwZXx8XCJcIikuaW5kZXhPZihcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKSYmR2MudGVzdChiLmRhdGEpJiZcImRhdGFcIik7cmV0dXJuIGh8fFwianNvbnBcIj09PWIuZGF0YVR5cGVzWzBdPyhlPWIuanNvbnBDYWxsYmFjaz1uLmlzRnVuY3Rpb24oYi5qc29ucENhbGxiYWNrKT9iLmpzb25wQ2FsbGJhY2soKTpiLmpzb25wQ2FsbGJhY2ssaD9iW2hdPWJbaF0ucmVwbGFjZShHYyxcIiQxXCIrZSk6Yi5qc29ucCE9PSExJiYoYi51cmwrPShkYy50ZXN0KGIudXJsKT9cIiZcIjpcIj9cIikrYi5qc29ucCtcIj1cIitlKSxiLmNvbnZlcnRlcnNbXCJzY3JpcHQganNvblwiXT1mdW5jdGlvbigpe3JldHVybiBnfHxuLmVycm9yKGUrXCIgd2FzIG5vdCBjYWxsZWRcIiksZ1swXX0sYi5kYXRhVHlwZXNbMF09XCJqc29uXCIsZj1hW2VdLGFbZV09ZnVuY3Rpb24oKXtnPWFyZ3VtZW50c30sZC5hbHdheXMoZnVuY3Rpb24oKXthW2VdPWYsYltlXSYmKGIuanNvbnBDYWxsYmFjaz1jLmpzb25wQ2FsbGJhY2ssRmMucHVzaChlKSksZyYmbi5pc0Z1bmN0aW9uKGYpJiZmKGdbMF0pLGc9Zj12b2lkIDB9KSxcInNjcmlwdFwiKTp2b2lkIDB9KSxuLnBhcnNlSFRNTD1mdW5jdGlvbihhLGIsYyl7aWYoIWF8fFwic3RyaW5nXCIhPXR5cGVvZiBhKXJldHVybiBudWxsO1wiYm9vbGVhblwiPT10eXBlb2YgYiYmKGM9YixiPSExKSxiPWJ8fGw7dmFyIGQ9di5leGVjKGEpLGU9IWMmJltdO3JldHVybiBkP1tiLmNyZWF0ZUVsZW1lbnQoZFsxXSldOihkPW4uYnVpbGRGcmFnbWVudChbYV0sYixlKSxlJiZlLmxlbmd0aCYmbihlKS5yZW1vdmUoKSxuLm1lcmdlKFtdLGQuY2hpbGROb2RlcykpfTt2YXIgSGM9bi5mbi5sb2FkO24uZm4ubG9hZD1mdW5jdGlvbihhLGIsYyl7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIGEmJkhjKXJldHVybiBIYy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGQsZSxmLGc9dGhpcyxoPWEuaW5kZXhPZihcIiBcIik7cmV0dXJuIGg+PTAmJihkPW4udHJpbShhLnNsaWNlKGgpKSxhPWEuc2xpY2UoMCxoKSksbi5pc0Z1bmN0aW9uKGIpPyhjPWIsYj12b2lkIDApOmImJlwib2JqZWN0XCI9PXR5cGVvZiBiJiYoZT1cIlBPU1RcIiksZy5sZW5ndGg+MCYmbi5hamF4KHt1cmw6YSx0eXBlOmUsZGF0YVR5cGU6XCJodG1sXCIsZGF0YTpifSkuZG9uZShmdW5jdGlvbihhKXtmPWFyZ3VtZW50cyxnLmh0bWwoZD9uKFwiPGRpdj5cIikuYXBwZW5kKG4ucGFyc2VIVE1MKGEpKS5maW5kKGQpOmEpfSkuY29tcGxldGUoYyYmZnVuY3Rpb24oYSxiKXtnLmVhY2goYyxmfHxbYS5yZXNwb25zZVRleHQsYixhXSl9KSx0aGlzfSxuLmVhY2goW1wiYWpheFN0YXJ0XCIsXCJhamF4U3RvcFwiLFwiYWpheENvbXBsZXRlXCIsXCJhamF4RXJyb3JcIixcImFqYXhTdWNjZXNzXCIsXCJhamF4U2VuZFwiXSxmdW5jdGlvbihhLGIpe24uZm5bYl09ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMub24oYixhKX19KSxuLmV4cHIuZmlsdGVycy5hbmltYXRlZD1mdW5jdGlvbihhKXtyZXR1cm4gbi5ncmVwKG4udGltZXJzLGZ1bmN0aW9uKGIpe3JldHVybiBhPT09Yi5lbGVtfSkubGVuZ3RofTt2YXIgSWM9YS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7ZnVuY3Rpb24gSmMoYSl7cmV0dXJuIG4uaXNXaW5kb3coYSk/YTo5PT09YS5ub2RlVHlwZSYmYS5kZWZhdWx0Vmlld31uLm9mZnNldD17c2V0T2Zmc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoLGksaixrPW4uY3NzKGEsXCJwb3NpdGlvblwiKSxsPW4oYSksbT17fTtcInN0YXRpY1wiPT09ayYmKGEuc3R5bGUucG9zaXRpb249XCJyZWxhdGl2ZVwiKSxoPWwub2Zmc2V0KCksZj1uLmNzcyhhLFwidG9wXCIpLGk9bi5jc3MoYSxcImxlZnRcIiksaj0oXCJhYnNvbHV0ZVwiPT09a3x8XCJmaXhlZFwiPT09aykmJihmK2kpLmluZGV4T2YoXCJhdXRvXCIpPi0xLGo/KGQ9bC5wb3NpdGlvbigpLGc9ZC50b3AsZT1kLmxlZnQpOihnPXBhcnNlRmxvYXQoZil8fDAsZT1wYXJzZUZsb2F0KGkpfHwwKSxuLmlzRnVuY3Rpb24oYikmJihiPWIuY2FsbChhLGMsaCkpLG51bGwhPWIudG9wJiYobS50b3A9Yi50b3AtaC50b3ArZyksbnVsbCE9Yi5sZWZ0JiYobS5sZWZ0PWIubGVmdC1oLmxlZnQrZSksXCJ1c2luZ1wiaW4gYj9iLnVzaW5nLmNhbGwoYSxtKTpsLmNzcyhtKX19LG4uZm4uZXh0ZW5kKHtvZmZzZXQ6ZnVuY3Rpb24oYSl7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdm9pZCAwPT09YT90aGlzOnRoaXMuZWFjaChmdW5jdGlvbihiKXtuLm9mZnNldC5zZXRPZmZzZXQodGhpcyxhLGIpfSk7dmFyIGIsYyxkPXRoaXNbMF0sZT17dG9wOjAsbGVmdDowfSxmPWQmJmQub3duZXJEb2N1bWVudDtpZihmKXJldHVybiBiPWYuZG9jdW1lbnRFbGVtZW50LG4uY29udGFpbnMoYixkKT8odHlwZW9mIGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0IT09VSYmKGU9ZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSksYz1KYyhmKSx7dG9wOmUudG9wK2MucGFnZVlPZmZzZXQtYi5jbGllbnRUb3AsbGVmdDplLmxlZnQrYy5wYWdlWE9mZnNldC1iLmNsaWVudExlZnR9KTplfSxwb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXNbMF0pe3ZhciBhLGIsYz10aGlzWzBdLGQ9e3RvcDowLGxlZnQ6MH07cmV0dXJuXCJmaXhlZFwiPT09bi5jc3MoYyxcInBvc2l0aW9uXCIpP2I9Yy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTooYT10aGlzLm9mZnNldFBhcmVudCgpLGI9dGhpcy5vZmZzZXQoKSxuLm5vZGVOYW1lKGFbMF0sXCJodG1sXCIpfHwoZD1hLm9mZnNldCgpKSxkLnRvcCs9bi5jc3MoYVswXSxcImJvcmRlclRvcFdpZHRoXCIsITApLGQubGVmdCs9bi5jc3MoYVswXSxcImJvcmRlckxlZnRXaWR0aFwiLCEwKSkse3RvcDpiLnRvcC1kLnRvcC1uLmNzcyhjLFwibWFyZ2luVG9wXCIsITApLGxlZnQ6Yi5sZWZ0LWQubGVmdC1uLmNzcyhjLFwibWFyZ2luTGVmdFwiLCEwKX19fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9mZnNldFBhcmVudHx8SWM7d2hpbGUoYSYmIW4ubm9kZU5hbWUoYSxcImh0bWxcIikmJlwic3RhdGljXCI9PT1uLmNzcyhhLFwicG9zaXRpb25cIikpYT1hLm9mZnNldFBhcmVudDtyZXR1cm4gYXx8SWN9KX19KSxuLmVhY2goe3Njcm9sbExlZnQ6XCJwYWdlWE9mZnNldFwiLHNjcm9sbFRvcDpcInBhZ2VZT2Zmc2V0XCJ9LGZ1bmN0aW9uKGIsYyl7dmFyIGQ9XCJwYWdlWU9mZnNldFwiPT09YztuLmZuW2JdPWZ1bmN0aW9uKGUpe3JldHVybiBKKHRoaXMsZnVuY3Rpb24oYixlLGYpe3ZhciBnPUpjKGIpO3JldHVybiB2b2lkIDA9PT1mP2c/Z1tjXTpiW2VdOnZvaWQoZz9nLnNjcm9sbFRvKGQ/YS5wYWdlWE9mZnNldDpmLGQ/ZjphLnBhZ2VZT2Zmc2V0KTpiW2VdPWYpfSxiLGUsYXJndW1lbnRzLmxlbmd0aCxudWxsKX19KSxuLmVhY2goW1widG9wXCIsXCJsZWZ0XCJdLGZ1bmN0aW9uKGEsYil7bi5jc3NIb29rc1tiXT15YihrLnBpeGVsUG9zaXRpb24sZnVuY3Rpb24oYSxjKXtyZXR1cm4gYz8oYz14YihhLGIpLHZiLnRlc3QoYyk/bihhKS5wb3NpdGlvbigpW2JdK1wicHhcIjpjKTp2b2lkIDB9KX0pLG4uZWFjaCh7SGVpZ2h0OlwiaGVpZ2h0XCIsV2lkdGg6XCJ3aWR0aFwifSxmdW5jdGlvbihhLGIpe24uZWFjaCh7cGFkZGluZzpcImlubmVyXCIrYSxjb250ZW50OmIsXCJcIjpcIm91dGVyXCIrYX0sZnVuY3Rpb24oYyxkKXtuLmZuW2RdPWZ1bmN0aW9uKGQsZSl7dmFyIGY9YXJndW1lbnRzLmxlbmd0aCYmKGN8fFwiYm9vbGVhblwiIT10eXBlb2YgZCksZz1jfHwoZD09PSEwfHxlPT09ITA/XCJtYXJnaW5cIjpcImJvcmRlclwiKTtyZXR1cm4gSih0aGlzLGZ1bmN0aW9uKGIsYyxkKXt2YXIgZTtyZXR1cm4gbi5pc1dpbmRvdyhiKT9iLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFtcImNsaWVudFwiK2FdOjk9PT1iLm5vZGVUeXBlPyhlPWIuZG9jdW1lbnRFbGVtZW50LE1hdGgubWF4KGIuYm9keVtcInNjcm9sbFwiK2FdLGVbXCJzY3JvbGxcIithXSxiLmJvZHlbXCJvZmZzZXRcIithXSxlW1wib2Zmc2V0XCIrYV0sZVtcImNsaWVudFwiK2FdKSk6dm9pZCAwPT09ZD9uLmNzcyhiLGMsZyk6bi5zdHlsZShiLGMsZCxnKX0sYixmP2Q6dm9pZCAwLGYsbnVsbCl9fSl9KSxuLmZuLnNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sZW5ndGh9LG4uZm4uYW5kU2VsZj1uLmZuLmFkZEJhY2ssXCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kJiZkZWZpbmUoXCJqcXVlcnlcIixbXSxmdW5jdGlvbigpe3JldHVybiBufSk7dmFyIEtjPWEualF1ZXJ5LExjPWEuJDtyZXR1cm4gbi5ub0NvbmZsaWN0PWZ1bmN0aW9uKGIpe3JldHVybiBhLiQ9PT1uJiYoYS4kPUxjKSxiJiZhLmpRdWVyeT09PW4mJihhLmpRdWVyeT1LYyksbn0sdHlwZW9mIGI9PT1VJiYoYS5qUXVlcnk9YS4kPW4pLG59KTtcclxuIiwiLyohIGpRdWVyeSBVSSAtIHYxLjExLjQgLSAyMDE1LTAzLTE5XHJcbiogaHR0cDovL2pxdWVyeXVpLmNvbVxyXG4qIEluY2x1ZGVzOiBjb3JlLmpzLCB3aWRnZXQuanMsIG1vdXNlLmpzLCBkcmFnZ2FibGUuanMsIHNvcnRhYmxlLmpzXHJcbiogQ29weXJpZ2h0IDIwMTUgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yczsgTGljZW5zZWQgTUlUICovXHJcblxyXG4oZnVuY3Rpb24oIGZhY3RvcnkgKSB7XHJcblx0aWYgKCB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApIHtcclxuXHJcblx0XHQvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXHJcblx0XHRkZWZpbmUoWyBcImpxdWVyeVwiIF0sIGZhY3RvcnkgKTtcclxuXHR9IGVsc2Uge1xyXG5cclxuXHRcdC8vIEJyb3dzZXIgZ2xvYmFsc1xyXG5cdFx0ZmFjdG9yeSggalF1ZXJ5ICk7XHJcblx0fVxyXG59KGZ1bmN0aW9uKCAkICkge1xyXG4vKiFcclxuICogalF1ZXJ5IFVJIENvcmUgMS4xMS40XHJcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cclxuICpcclxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxyXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXHJcbiAqXHJcbiAqIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2NhdGVnb3J5L3VpLWNvcmUvXHJcbiAqL1xyXG5cclxuXHJcbi8vICQudWkgbWlnaHQgZXhpc3QgZnJvbSBjb21wb25lbnRzIHdpdGggbm8gZGVwZW5kZW5jaWVzLCBlLmcuLCAkLnVpLnBvc2l0aW9uXHJcbiQudWkgPSAkLnVpIHx8IHt9O1xyXG5cclxuJC5leHRlbmQoICQudWksIHtcclxuXHR2ZXJzaW9uOiBcIjEuMTEuNFwiLFxyXG5cclxuXHRrZXlDb2RlOiB7XHJcblx0XHRCQUNLU1BBQ0U6IDgsXHJcblx0XHRDT01NQTogMTg4LFxyXG5cdFx0REVMRVRFOiA0NixcclxuXHRcdERPV046IDQwLFxyXG5cdFx0RU5EOiAzNSxcclxuXHRcdEVOVEVSOiAxMyxcclxuXHRcdEVTQ0FQRTogMjcsXHJcblx0XHRIT01FOiAzNixcclxuXHRcdExFRlQ6IDM3LFxyXG5cdFx0UEFHRV9ET1dOOiAzNCxcclxuXHRcdFBBR0VfVVA6IDMzLFxyXG5cdFx0UEVSSU9EOiAxOTAsXHJcblx0XHRSSUdIVDogMzksXHJcblx0XHRTUEFDRTogMzIsXHJcblx0XHRUQUI6IDksXHJcblx0XHRVUDogMzhcclxuXHR9XHJcbn0pO1xyXG5cclxuLy8gcGx1Z2luc1xyXG4kLmZuLmV4dGVuZCh7XHJcblx0c2Nyb2xsUGFyZW50OiBmdW5jdGlvbiggaW5jbHVkZUhpZGRlbiApIHtcclxuXHRcdHZhciBwb3NpdGlvbiA9IHRoaXMuY3NzKCBcInBvc2l0aW9uXCIgKSxcclxuXHRcdFx0ZXhjbHVkZVN0YXRpY1BhcmVudCA9IHBvc2l0aW9uID09PSBcImFic29sdXRlXCIsXHJcblx0XHRcdG92ZXJmbG93UmVnZXggPSBpbmNsdWRlSGlkZGVuID8gLyhhdXRvfHNjcm9sbHxoaWRkZW4pLyA6IC8oYXV0b3xzY3JvbGwpLyxcclxuXHRcdFx0c2Nyb2xsUGFyZW50ID0gdGhpcy5wYXJlbnRzKCkuZmlsdGVyKCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgcGFyZW50ID0gJCggdGhpcyApO1xyXG5cdFx0XHRcdGlmICggZXhjbHVkZVN0YXRpY1BhcmVudCAmJiBwYXJlbnQuY3NzKCBcInBvc2l0aW9uXCIgKSA9PT0gXCJzdGF0aWNcIiApIHtcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIG92ZXJmbG93UmVnZXgudGVzdCggcGFyZW50LmNzcyggXCJvdmVyZmxvd1wiICkgKyBwYXJlbnQuY3NzKCBcIm92ZXJmbG93LXlcIiApICsgcGFyZW50LmNzcyggXCJvdmVyZmxvdy14XCIgKSApO1xyXG5cdFx0XHR9KS5lcSggMCApO1xyXG5cclxuXHRcdHJldHVybiBwb3NpdGlvbiA9PT0gXCJmaXhlZFwiIHx8ICFzY3JvbGxQYXJlbnQubGVuZ3RoID8gJCggdGhpc1sgMCBdLm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQgKSA6IHNjcm9sbFBhcmVudDtcclxuXHR9LFxyXG5cclxuXHR1bmlxdWVJZDogKGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHV1aWQgPSAwO1xyXG5cclxuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAoICF0aGlzLmlkICkge1xyXG5cdFx0XHRcdFx0dGhpcy5pZCA9IFwidWktaWQtXCIgKyAoICsrdXVpZCApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH0pKCksXHJcblxyXG5cdHJlbW92ZVVuaXF1ZUlkOiBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICggL151aS1pZC1cXGQrJC8udGVzdCggdGhpcy5pZCApICkge1xyXG5cdFx0XHRcdCQoIHRoaXMgKS5yZW1vdmVBdHRyKCBcImlkXCIgKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59KTtcclxuXHJcbi8vIHNlbGVjdG9yc1xyXG5mdW5jdGlvbiBmb2N1c2FibGUoIGVsZW1lbnQsIGlzVGFiSW5kZXhOb3ROYU4gKSB7XHJcblx0dmFyIG1hcCwgbWFwTmFtZSwgaW1nLFxyXG5cdFx0bm9kZU5hbWUgPSBlbGVtZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XHJcblx0aWYgKCBcImFyZWFcIiA9PT0gbm9kZU5hbWUgKSB7XHJcblx0XHRtYXAgPSBlbGVtZW50LnBhcmVudE5vZGU7XHJcblx0XHRtYXBOYW1lID0gbWFwLm5hbWU7XHJcblx0XHRpZiAoICFlbGVtZW50LmhyZWYgfHwgIW1hcE5hbWUgfHwgbWFwLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09IFwibWFwXCIgKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHRcdGltZyA9ICQoIFwiaW1nW3VzZW1hcD0nI1wiICsgbWFwTmFtZSArIFwiJ11cIiApWyAwIF07XHJcblx0XHRyZXR1cm4gISFpbWcgJiYgdmlzaWJsZSggaW1nICk7XHJcblx0fVxyXG5cdHJldHVybiAoIC9eKGlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvLnRlc3QoIG5vZGVOYW1lICkgP1xyXG5cdFx0IWVsZW1lbnQuZGlzYWJsZWQgOlxyXG5cdFx0XCJhXCIgPT09IG5vZGVOYW1lID9cclxuXHRcdFx0ZWxlbWVudC5ocmVmIHx8IGlzVGFiSW5kZXhOb3ROYU4gOlxyXG5cdFx0XHRpc1RhYkluZGV4Tm90TmFOKSAmJlxyXG5cdFx0Ly8gdGhlIGVsZW1lbnQgYW5kIGFsbCBvZiBpdHMgYW5jZXN0b3JzIG11c3QgYmUgdmlzaWJsZVxyXG5cdFx0dmlzaWJsZSggZWxlbWVudCApO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2aXNpYmxlKCBlbGVtZW50ICkge1xyXG5cdHJldHVybiAkLmV4cHIuZmlsdGVycy52aXNpYmxlKCBlbGVtZW50ICkgJiZcclxuXHRcdCEkKCBlbGVtZW50ICkucGFyZW50cygpLmFkZEJhY2soKS5maWx0ZXIoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiAkLmNzcyggdGhpcywgXCJ2aXNpYmlsaXR5XCIgKSA9PT0gXCJoaWRkZW5cIjtcclxuXHRcdH0pLmxlbmd0aDtcclxufVxyXG5cclxuJC5leHRlbmQoICQuZXhwclsgXCI6XCIgXSwge1xyXG5cdGRhdGE6ICQuZXhwci5jcmVhdGVQc2V1ZG8gP1xyXG5cdFx0JC5leHByLmNyZWF0ZVBzZXVkbyhmdW5jdGlvbiggZGF0YU5hbWUgKSB7XHJcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZWxlbSApIHtcclxuXHRcdFx0XHRyZXR1cm4gISEkLmRhdGEoIGVsZW0sIGRhdGFOYW1lICk7XHJcblx0XHRcdH07XHJcblx0XHR9KSA6XHJcblx0XHQvLyBzdXBwb3J0OiBqUXVlcnkgPDEuOFxyXG5cdFx0ZnVuY3Rpb24oIGVsZW0sIGksIG1hdGNoICkge1xyXG5cdFx0XHRyZXR1cm4gISEkLmRhdGEoIGVsZW0sIG1hdGNoWyAzIF0gKTtcclxuXHRcdH0sXHJcblxyXG5cdGZvY3VzYWJsZTogZnVuY3Rpb24oIGVsZW1lbnQgKSB7XHJcblx0XHRyZXR1cm4gZm9jdXNhYmxlKCBlbGVtZW50LCAhaXNOYU4oICQuYXR0ciggZWxlbWVudCwgXCJ0YWJpbmRleFwiICkgKSApO1xyXG5cdH0sXHJcblxyXG5cdHRhYmJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcclxuXHRcdHZhciB0YWJJbmRleCA9ICQuYXR0ciggZWxlbWVudCwgXCJ0YWJpbmRleFwiICksXHJcblx0XHRcdGlzVGFiSW5kZXhOYU4gPSBpc05hTiggdGFiSW5kZXggKTtcclxuXHRcdHJldHVybiAoIGlzVGFiSW5kZXhOYU4gfHwgdGFiSW5kZXggPj0gMCApICYmIGZvY3VzYWJsZSggZWxlbWVudCwgIWlzVGFiSW5kZXhOYU4gKTtcclxuXHR9XHJcbn0pO1xyXG5cclxuLy8gc3VwcG9ydDogalF1ZXJ5IDwxLjhcclxuaWYgKCAhJCggXCI8YT5cIiApLm91dGVyV2lkdGgoIDEgKS5qcXVlcnkgKSB7XHJcblx0JC5lYWNoKCBbIFwiV2lkdGhcIiwgXCJIZWlnaHRcIiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHtcclxuXHRcdHZhciBzaWRlID0gbmFtZSA9PT0gXCJXaWR0aFwiID8gWyBcIkxlZnRcIiwgXCJSaWdodFwiIF0gOiBbIFwiVG9wXCIsIFwiQm90dG9tXCIgXSxcclxuXHRcdFx0dHlwZSA9IG5hbWUudG9Mb3dlckNhc2UoKSxcclxuXHRcdFx0b3JpZyA9IHtcclxuXHRcdFx0XHRpbm5lcldpZHRoOiAkLmZuLmlubmVyV2lkdGgsXHJcblx0XHRcdFx0aW5uZXJIZWlnaHQ6ICQuZm4uaW5uZXJIZWlnaHQsXHJcblx0XHRcdFx0b3V0ZXJXaWR0aDogJC5mbi5vdXRlcldpZHRoLFxyXG5cdFx0XHRcdG91dGVySGVpZ2h0OiAkLmZuLm91dGVySGVpZ2h0XHJcblx0XHRcdH07XHJcblxyXG5cdFx0ZnVuY3Rpb24gcmVkdWNlKCBlbGVtLCBzaXplLCBib3JkZXIsIG1hcmdpbiApIHtcclxuXHRcdFx0JC5lYWNoKCBzaWRlLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRzaXplIC09IHBhcnNlRmxvYXQoICQuY3NzKCBlbGVtLCBcInBhZGRpbmdcIiArIHRoaXMgKSApIHx8IDA7XHJcblx0XHRcdFx0aWYgKCBib3JkZXIgKSB7XHJcblx0XHRcdFx0XHRzaXplIC09IHBhcnNlRmxvYXQoICQuY3NzKCBlbGVtLCBcImJvcmRlclwiICsgdGhpcyArIFwiV2lkdGhcIiApICkgfHwgMDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKCBtYXJnaW4gKSB7XHJcblx0XHRcdFx0XHRzaXplIC09IHBhcnNlRmxvYXQoICQuY3NzKCBlbGVtLCBcIm1hcmdpblwiICsgdGhpcyApICkgfHwgMDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm4gc2l6ZTtcclxuXHRcdH1cclxuXHJcblx0XHQkLmZuWyBcImlubmVyXCIgKyBuYW1lIF0gPSBmdW5jdGlvbiggc2l6ZSApIHtcclxuXHRcdFx0aWYgKCBzaXplID09PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdFx0cmV0dXJuIG9yaWdbIFwiaW5uZXJcIiArIG5hbWUgXS5jYWxsKCB0aGlzICk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0JCggdGhpcyApLmNzcyggdHlwZSwgcmVkdWNlKCB0aGlzLCBzaXplICkgKyBcInB4XCIgKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdCQuZm5bIFwib3V0ZXJcIiArIG5hbWVdID0gZnVuY3Rpb24oIHNpemUsIG1hcmdpbiApIHtcclxuXHRcdFx0aWYgKCB0eXBlb2Ygc2l6ZSAhPT0gXCJudW1iZXJcIiApIHtcclxuXHRcdFx0XHRyZXR1cm4gb3JpZ1sgXCJvdXRlclwiICsgbmFtZSBdLmNhbGwoIHRoaXMsIHNpemUgKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHQkKCB0aGlzKS5jc3MoIHR5cGUsIHJlZHVjZSggdGhpcywgc2l6ZSwgdHJ1ZSwgbWFyZ2luICkgKyBcInB4XCIgKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH0pO1xyXG59XHJcblxyXG4vLyBzdXBwb3J0OiBqUXVlcnkgPDEuOFxyXG5pZiAoICEkLmZuLmFkZEJhY2sgKSB7XHJcblx0JC5mbi5hZGRCYWNrID0gZnVuY3Rpb24oIHNlbGVjdG9yICkge1xyXG5cdFx0cmV0dXJuIHRoaXMuYWRkKCBzZWxlY3RvciA9PSBudWxsID9cclxuXHRcdFx0dGhpcy5wcmV2T2JqZWN0IDogdGhpcy5wcmV2T2JqZWN0LmZpbHRlciggc2VsZWN0b3IgKVxyXG5cdFx0KTtcclxuXHR9O1xyXG59XHJcblxyXG4vLyBzdXBwb3J0OiBqUXVlcnkgMS42LjEsIDEuNi4yIChodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC85NDEzKVxyXG5pZiAoICQoIFwiPGE+XCIgKS5kYXRhKCBcImEtYlwiLCBcImFcIiApLnJlbW92ZURhdGEoIFwiYS1iXCIgKS5kYXRhKCBcImEtYlwiICkgKSB7XHJcblx0JC5mbi5yZW1vdmVEYXRhID0gKGZ1bmN0aW9uKCByZW1vdmVEYXRhICkge1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCBrZXkgKSB7XHJcblx0XHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCApIHtcclxuXHRcdFx0XHRyZXR1cm4gcmVtb3ZlRGF0YS5jYWxsKCB0aGlzLCAkLmNhbWVsQ2FzZSgga2V5ICkgKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRyZXR1cm4gcmVtb3ZlRGF0YS5jYWxsKCB0aGlzICk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fSkoICQuZm4ucmVtb3ZlRGF0YSApO1xyXG59XHJcblxyXG4vLyBkZXByZWNhdGVkXHJcbiQudWkuaWUgPSAhIS9tc2llIFtcXHcuXSsvLmV4ZWMoIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSApO1xyXG5cclxuJC5mbi5leHRlbmQoe1xyXG5cdGZvY3VzOiAoZnVuY3Rpb24oIG9yaWcgKSB7XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24oIGRlbGF5LCBmbiApIHtcclxuXHRcdFx0cmV0dXJuIHR5cGVvZiBkZWxheSA9PT0gXCJudW1iZXJcIiA/XHJcblx0XHRcdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0dmFyIGVsZW0gPSB0aGlzO1xyXG5cdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0JCggZWxlbSApLmZvY3VzKCk7XHJcblx0XHRcdFx0XHRcdGlmICggZm4gKSB7XHJcblx0XHRcdFx0XHRcdFx0Zm4uY2FsbCggZWxlbSApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9LCBkZWxheSApO1xyXG5cdFx0XHRcdH0pIDpcclxuXHRcdFx0XHRvcmlnLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcclxuXHRcdH07XHJcblx0fSkoICQuZm4uZm9jdXMgKSxcclxuXHJcblx0ZGlzYWJsZVNlbGVjdGlvbjogKGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGV2ZW50VHlwZSA9IFwib25zZWxlY3RzdGFydFwiIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwiZGl2XCIgKSA/XHJcblx0XHRcdFwic2VsZWN0c3RhcnRcIiA6XHJcblx0XHRcdFwibW91c2Vkb3duXCI7XHJcblxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5iaW5kKCBldmVudFR5cGUgKyBcIi51aS1kaXNhYmxlU2VsZWN0aW9uXCIsIGZ1bmN0aW9uKCBldmVudCApIHtcclxuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSkoKSxcclxuXHJcblx0ZW5hYmxlU2VsZWN0aW9uOiBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiB0aGlzLnVuYmluZCggXCIudWktZGlzYWJsZVNlbGVjdGlvblwiICk7XHJcblx0fSxcclxuXHJcblx0ekluZGV4OiBmdW5jdGlvbiggekluZGV4ICkge1xyXG5cdFx0aWYgKCB6SW5kZXggIT09IHVuZGVmaW5lZCApIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuY3NzKCBcInpJbmRleFwiLCB6SW5kZXggKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIHRoaXMubGVuZ3RoICkge1xyXG5cdFx0XHR2YXIgZWxlbSA9ICQoIHRoaXNbIDAgXSApLCBwb3NpdGlvbiwgdmFsdWU7XHJcblx0XHRcdHdoaWxlICggZWxlbS5sZW5ndGggJiYgZWxlbVsgMCBdICE9PSBkb2N1bWVudCApIHtcclxuXHRcdFx0XHQvLyBJZ25vcmUgei1pbmRleCBpZiBwb3NpdGlvbiBpcyBzZXQgdG8gYSB2YWx1ZSB3aGVyZSB6LWluZGV4IGlzIGlnbm9yZWQgYnkgdGhlIGJyb3dzZXJcclxuXHRcdFx0XHQvLyBUaGlzIG1ha2VzIGJlaGF2aW9yIG9mIHRoaXMgZnVuY3Rpb24gY29uc2lzdGVudCBhY3Jvc3MgYnJvd3NlcnNcclxuXHRcdFx0XHQvLyBXZWJLaXQgYWx3YXlzIHJldHVybnMgYXV0byBpZiB0aGUgZWxlbWVudCBpcyBwb3NpdGlvbmVkXHJcblx0XHRcdFx0cG9zaXRpb24gPSBlbGVtLmNzcyggXCJwb3NpdGlvblwiICk7XHJcblx0XHRcdFx0aWYgKCBwb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiIHx8IHBvc2l0aW9uID09PSBcInJlbGF0aXZlXCIgfHwgcG9zaXRpb24gPT09IFwiZml4ZWRcIiApIHtcclxuXHRcdFx0XHRcdC8vIElFIHJldHVybnMgMCB3aGVuIHpJbmRleCBpcyBub3Qgc3BlY2lmaWVkXHJcblx0XHRcdFx0XHQvLyBvdGhlciBicm93c2VycyByZXR1cm4gYSBzdHJpbmdcclxuXHRcdFx0XHRcdC8vIHdlIGlnbm9yZSB0aGUgY2FzZSBvZiBuZXN0ZWQgZWxlbWVudHMgd2l0aCBhbiBleHBsaWNpdCB2YWx1ZSBvZiAwXHJcblx0XHRcdFx0XHQvLyA8ZGl2IHN0eWxlPVwiei1pbmRleDogLTEwO1wiPjxkaXYgc3R5bGU9XCJ6LWluZGV4OiAwO1wiPjwvZGl2PjwvZGl2PlxyXG5cdFx0XHRcdFx0dmFsdWUgPSBwYXJzZUludCggZWxlbS5jc3MoIFwiekluZGV4XCIgKSwgMTAgKTtcclxuXHRcdFx0XHRcdGlmICggIWlzTmFOKCB2YWx1ZSApICYmIHZhbHVlICE9PSAwICkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsZW0gPSBlbGVtLnBhcmVudCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIDA7XHJcblx0fVxyXG59KTtcclxuXHJcbi8vICQudWkucGx1Z2luIGlzIGRlcHJlY2F0ZWQuIFVzZSAkLndpZGdldCgpIGV4dGVuc2lvbnMgaW5zdGVhZC5cclxuJC51aS5wbHVnaW4gPSB7XHJcblx0YWRkOiBmdW5jdGlvbiggbW9kdWxlLCBvcHRpb24sIHNldCApIHtcclxuXHRcdHZhciBpLFxyXG5cdFx0XHRwcm90byA9ICQudWlbIG1vZHVsZSBdLnByb3RvdHlwZTtcclxuXHRcdGZvciAoIGkgaW4gc2V0ICkge1xyXG5cdFx0XHRwcm90by5wbHVnaW5zWyBpIF0gPSBwcm90by5wbHVnaW5zWyBpIF0gfHwgW107XHJcblx0XHRcdHByb3RvLnBsdWdpbnNbIGkgXS5wdXNoKCBbIG9wdGlvbiwgc2V0WyBpIF0gXSApO1xyXG5cdFx0fVxyXG5cdH0sXHJcblx0Y2FsbDogZnVuY3Rpb24oIGluc3RhbmNlLCBuYW1lLCBhcmdzLCBhbGxvd0Rpc2Nvbm5lY3RlZCApIHtcclxuXHRcdHZhciBpLFxyXG5cdFx0XHRzZXQgPSBpbnN0YW5jZS5wbHVnaW5zWyBuYW1lIF07XHJcblxyXG5cdFx0aWYgKCAhc2V0ICkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCAhYWxsb3dEaXNjb25uZWN0ZWQgJiYgKCAhaW5zdGFuY2UuZWxlbWVudFsgMCBdLnBhcmVudE5vZGUgfHwgaW5zdGFuY2UuZWxlbWVudFsgMCBdLnBhcmVudE5vZGUubm9kZVR5cGUgPT09IDExICkgKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKCBpID0gMDsgaSA8IHNldC5sZW5ndGg7IGkrKyApIHtcclxuXHRcdFx0aWYgKCBpbnN0YW5jZS5vcHRpb25zWyBzZXRbIGkgXVsgMCBdIF0gKSB7XHJcblx0XHRcdFx0c2V0WyBpIF1bIDEgXS5hcHBseSggaW5zdGFuY2UuZWxlbWVudCwgYXJncyApO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuXHJcbi8qIVxyXG4gKiBqUXVlcnkgVUkgV2lkZ2V0IDEuMTEuNFxyXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXHJcbiAqXHJcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cclxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxyXG4gKlxyXG4gKiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9qUXVlcnkud2lkZ2V0L1xyXG4gKi9cclxuXHJcblxyXG52YXIgd2lkZ2V0X3V1aWQgPSAwLFxyXG5cdHdpZGdldF9zbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcclxuXHJcbiQuY2xlYW5EYXRhID0gKGZ1bmN0aW9uKCBvcmlnICkge1xyXG5cdHJldHVybiBmdW5jdGlvbiggZWxlbXMgKSB7XHJcblx0XHR2YXIgZXZlbnRzLCBlbGVtLCBpO1xyXG5cdFx0Zm9yICggaSA9IDA7IChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKyApIHtcclxuXHRcdFx0dHJ5IHtcclxuXHJcblx0XHRcdFx0Ly8gT25seSB0cmlnZ2VyIHJlbW92ZSB3aGVuIG5lY2Vzc2FyeSB0byBzYXZlIHRpbWVcclxuXHRcdFx0XHRldmVudHMgPSAkLl9kYXRhKCBlbGVtLCBcImV2ZW50c1wiICk7XHJcblx0XHRcdFx0aWYgKCBldmVudHMgJiYgZXZlbnRzLnJlbW92ZSApIHtcclxuXHRcdFx0XHRcdCQoIGVsZW0gKS50cmlnZ2VySGFuZGxlciggXCJyZW1vdmVcIiApO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdC8vIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzgyMzVcclxuXHRcdFx0fSBjYXRjaCAoIGUgKSB7fVxyXG5cdFx0fVxyXG5cdFx0b3JpZyggZWxlbXMgKTtcclxuXHR9O1xyXG59KSggJC5jbGVhbkRhdGEgKTtcclxuXHJcbiQud2lkZ2V0ID0gZnVuY3Rpb24oIG5hbWUsIGJhc2UsIHByb3RvdHlwZSApIHtcclxuXHR2YXIgZnVsbE5hbWUsIGV4aXN0aW5nQ29uc3RydWN0b3IsIGNvbnN0cnVjdG9yLCBiYXNlUHJvdG90eXBlLFxyXG5cdFx0Ly8gcHJveGllZFByb3RvdHlwZSBhbGxvd3MgdGhlIHByb3ZpZGVkIHByb3RvdHlwZSB0byByZW1haW4gdW5tb2RpZmllZFxyXG5cdFx0Ly8gc28gdGhhdCBpdCBjYW4gYmUgdXNlZCBhcyBhIG1peGluIGZvciBtdWx0aXBsZSB3aWRnZXRzICgjODg3NilcclxuXHRcdHByb3hpZWRQcm90b3R5cGUgPSB7fSxcclxuXHRcdG5hbWVzcGFjZSA9IG5hbWUuc3BsaXQoIFwiLlwiIClbIDAgXTtcclxuXHJcblx0bmFtZSA9IG5hbWUuc3BsaXQoIFwiLlwiIClbIDEgXTtcclxuXHRmdWxsTmFtZSA9IG5hbWVzcGFjZSArIFwiLVwiICsgbmFtZTtcclxuXHJcblx0aWYgKCAhcHJvdG90eXBlICkge1xyXG5cdFx0cHJvdG90eXBlID0gYmFzZTtcclxuXHRcdGJhc2UgPSAkLldpZGdldDtcclxuXHR9XHJcblxyXG5cdC8vIGNyZWF0ZSBzZWxlY3RvciBmb3IgcGx1Z2luXHJcblx0JC5leHByWyBcIjpcIiBdWyBmdWxsTmFtZS50b0xvd2VyQ2FzZSgpIF0gPSBmdW5jdGlvbiggZWxlbSApIHtcclxuXHRcdHJldHVybiAhISQuZGF0YSggZWxlbSwgZnVsbE5hbWUgKTtcclxuXHR9O1xyXG5cclxuXHQkWyBuYW1lc3BhY2UgXSA9ICRbIG5hbWVzcGFjZSBdIHx8IHt9O1xyXG5cdGV4aXN0aW5nQ29uc3RydWN0b3IgPSAkWyBuYW1lc3BhY2UgXVsgbmFtZSBdO1xyXG5cdGNvbnN0cnVjdG9yID0gJFsgbmFtZXNwYWNlIF1bIG5hbWUgXSA9IGZ1bmN0aW9uKCBvcHRpb25zLCBlbGVtZW50ICkge1xyXG5cdFx0Ly8gYWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IFwibmV3XCIga2V5d29yZFxyXG5cdFx0aWYgKCAhdGhpcy5fY3JlYXRlV2lkZ2V0ICkge1xyXG5cdFx0XHRyZXR1cm4gbmV3IGNvbnN0cnVjdG9yKCBvcHRpb25zLCBlbGVtZW50ICk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gYWxsb3cgaW5zdGFudGlhdGlvbiB3aXRob3V0IGluaXRpYWxpemluZyBmb3Igc2ltcGxlIGluaGVyaXRhbmNlXHJcblx0XHQvLyBtdXN0IHVzZSBcIm5ld1wiIGtleXdvcmQgKHRoZSBjb2RlIGFib3ZlIGFsd2F5cyBwYXNzZXMgYXJncylcclxuXHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCApIHtcclxuXHRcdFx0dGhpcy5fY3JlYXRlV2lkZ2V0KCBvcHRpb25zLCBlbGVtZW50ICk7XHJcblx0XHR9XHJcblx0fTtcclxuXHQvLyBleHRlbmQgd2l0aCB0aGUgZXhpc3RpbmcgY29uc3RydWN0b3IgdG8gY2Fycnkgb3ZlciBhbnkgc3RhdGljIHByb3BlcnRpZXNcclxuXHQkLmV4dGVuZCggY29uc3RydWN0b3IsIGV4aXN0aW5nQ29uc3RydWN0b3IsIHtcclxuXHRcdHZlcnNpb246IHByb3RvdHlwZS52ZXJzaW9uLFxyXG5cdFx0Ly8gY29weSB0aGUgb2JqZWN0IHVzZWQgdG8gY3JlYXRlIHRoZSBwcm90b3R5cGUgaW4gY2FzZSB3ZSBuZWVkIHRvXHJcblx0XHQvLyByZWRlZmluZSB0aGUgd2lkZ2V0IGxhdGVyXHJcblx0XHRfcHJvdG86ICQuZXh0ZW5kKCB7fSwgcHJvdG90eXBlICksXHJcblx0XHQvLyB0cmFjayB3aWRnZXRzIHRoYXQgaW5oZXJpdCBmcm9tIHRoaXMgd2lkZ2V0IGluIGNhc2UgdGhpcyB3aWRnZXQgaXNcclxuXHRcdC8vIHJlZGVmaW5lZCBhZnRlciBhIHdpZGdldCBpbmhlcml0cyBmcm9tIGl0XHJcblx0XHRfY2hpbGRDb25zdHJ1Y3RvcnM6IFtdXHJcblx0fSk7XHJcblxyXG5cdGJhc2VQcm90b3R5cGUgPSBuZXcgYmFzZSgpO1xyXG5cdC8vIHdlIG5lZWQgdG8gbWFrZSB0aGUgb3B0aW9ucyBoYXNoIGEgcHJvcGVydHkgZGlyZWN0bHkgb24gdGhlIG5ldyBpbnN0YW5jZVxyXG5cdC8vIG90aGVyd2lzZSB3ZSdsbCBtb2RpZnkgdGhlIG9wdGlvbnMgaGFzaCBvbiB0aGUgcHJvdG90eXBlIHRoYXQgd2UncmVcclxuXHQvLyBpbmhlcml0aW5nIGZyb21cclxuXHRiYXNlUHJvdG90eXBlLm9wdGlvbnMgPSAkLndpZGdldC5leHRlbmQoIHt9LCBiYXNlUHJvdG90eXBlLm9wdGlvbnMgKTtcclxuXHQkLmVhY2goIHByb3RvdHlwZSwgZnVuY3Rpb24oIHByb3AsIHZhbHVlICkge1xyXG5cdFx0aWYgKCAhJC5pc0Z1bmN0aW9uKCB2YWx1ZSApICkge1xyXG5cdFx0XHRwcm94aWVkUHJvdG90eXBlWyBwcm9wIF0gPSB2YWx1ZTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0cHJveGllZFByb3RvdHlwZVsgcHJvcCBdID0gKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgX3N1cGVyID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gYmFzZS5wcm90b3R5cGVbIHByb3AgXS5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRfc3VwZXJBcHBseSA9IGZ1bmN0aW9uKCBhcmdzICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGJhc2UucHJvdG90eXBlWyBwcm9wIF0uYXBwbHkoIHRoaXMsIGFyZ3MgKTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dmFyIF9fc3VwZXIgPSB0aGlzLl9zdXBlcixcclxuXHRcdFx0XHRcdF9fc3VwZXJBcHBseSA9IHRoaXMuX3N1cGVyQXBwbHksXHJcblx0XHRcdFx0XHRyZXR1cm5WYWx1ZTtcclxuXHJcblx0XHRcdFx0dGhpcy5fc3VwZXIgPSBfc3VwZXI7XHJcblx0XHRcdFx0dGhpcy5fc3VwZXJBcHBseSA9IF9zdXBlckFwcGx5O1xyXG5cclxuXHRcdFx0XHRyZXR1cm5WYWx1ZSA9IHZhbHVlLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcclxuXHJcblx0XHRcdFx0dGhpcy5fc3VwZXIgPSBfX3N1cGVyO1xyXG5cdFx0XHRcdHRoaXMuX3N1cGVyQXBwbHkgPSBfX3N1cGVyQXBwbHk7XHJcblxyXG5cdFx0XHRcdHJldHVybiByZXR1cm5WYWx1ZTtcclxuXHRcdFx0fTtcclxuXHRcdH0pKCk7XHJcblx0fSk7XHJcblx0Y29uc3RydWN0b3IucHJvdG90eXBlID0gJC53aWRnZXQuZXh0ZW5kKCBiYXNlUHJvdG90eXBlLCB7XHJcblx0XHQvLyBUT0RPOiByZW1vdmUgc3VwcG9ydCBmb3Igd2lkZ2V0RXZlbnRQcmVmaXhcclxuXHRcdC8vIGFsd2F5cyB1c2UgdGhlIG5hbWUgKyBhIGNvbG9uIGFzIHRoZSBwcmVmaXgsIGUuZy4sIGRyYWdnYWJsZTpzdGFydFxyXG5cdFx0Ly8gZG9uJ3QgcHJlZml4IGZvciB3aWRnZXRzIHRoYXQgYXJlbid0IERPTS1iYXNlZFxyXG5cdFx0d2lkZ2V0RXZlbnRQcmVmaXg6IGV4aXN0aW5nQ29uc3RydWN0b3IgPyAoYmFzZVByb3RvdHlwZS53aWRnZXRFdmVudFByZWZpeCB8fCBuYW1lKSA6IG5hbWVcclxuXHR9LCBwcm94aWVkUHJvdG90eXBlLCB7XHJcblx0XHRjb25zdHJ1Y3RvcjogY29uc3RydWN0b3IsXHJcblx0XHRuYW1lc3BhY2U6IG5hbWVzcGFjZSxcclxuXHRcdHdpZGdldE5hbWU6IG5hbWUsXHJcblx0XHR3aWRnZXRGdWxsTmFtZTogZnVsbE5hbWVcclxuXHR9KTtcclxuXHJcblx0Ly8gSWYgdGhpcyB3aWRnZXQgaXMgYmVpbmcgcmVkZWZpbmVkIHRoZW4gd2UgbmVlZCB0byBmaW5kIGFsbCB3aWRnZXRzIHRoYXRcclxuXHQvLyBhcmUgaW5oZXJpdGluZyBmcm9tIGl0IGFuZCByZWRlZmluZSBhbGwgb2YgdGhlbSBzbyB0aGF0IHRoZXkgaW5oZXJpdCBmcm9tXHJcblx0Ly8gdGhlIG5ldyB2ZXJzaW9uIG9mIHRoaXMgd2lkZ2V0LiBXZSdyZSBlc3NlbnRpYWxseSB0cnlpbmcgdG8gcmVwbGFjZSBvbmVcclxuXHQvLyBsZXZlbCBpbiB0aGUgcHJvdG90eXBlIGNoYWluLlxyXG5cdGlmICggZXhpc3RpbmdDb25zdHJ1Y3RvciApIHtcclxuXHRcdCQuZWFjaCggZXhpc3RpbmdDb25zdHJ1Y3Rvci5fY2hpbGRDb25zdHJ1Y3RvcnMsIGZ1bmN0aW9uKCBpLCBjaGlsZCApIHtcclxuXHRcdFx0dmFyIGNoaWxkUHJvdG90eXBlID0gY2hpbGQucHJvdG90eXBlO1xyXG5cclxuXHRcdFx0Ly8gcmVkZWZpbmUgdGhlIGNoaWxkIHdpZGdldCB1c2luZyB0aGUgc2FtZSBwcm90b3R5cGUgdGhhdCB3YXNcclxuXHRcdFx0Ly8gb3JpZ2luYWxseSB1c2VkLCBidXQgaW5oZXJpdCBmcm9tIHRoZSBuZXcgdmVyc2lvbiBvZiB0aGUgYmFzZVxyXG5cdFx0XHQkLndpZGdldCggY2hpbGRQcm90b3R5cGUubmFtZXNwYWNlICsgXCIuXCIgKyBjaGlsZFByb3RvdHlwZS53aWRnZXROYW1lLCBjb25zdHJ1Y3RvciwgY2hpbGQuX3Byb3RvICk7XHJcblx0XHR9KTtcclxuXHRcdC8vIHJlbW92ZSB0aGUgbGlzdCBvZiBleGlzdGluZyBjaGlsZCBjb25zdHJ1Y3RvcnMgZnJvbSB0aGUgb2xkIGNvbnN0cnVjdG9yXHJcblx0XHQvLyBzbyB0aGUgb2xkIGNoaWxkIGNvbnN0cnVjdG9ycyBjYW4gYmUgZ2FyYmFnZSBjb2xsZWN0ZWRcclxuXHRcdGRlbGV0ZSBleGlzdGluZ0NvbnN0cnVjdG9yLl9jaGlsZENvbnN0cnVjdG9ycztcclxuXHR9IGVsc2Uge1xyXG5cdFx0YmFzZS5fY2hpbGRDb25zdHJ1Y3RvcnMucHVzaCggY29uc3RydWN0b3IgKTtcclxuXHR9XHJcblxyXG5cdCQud2lkZ2V0LmJyaWRnZSggbmFtZSwgY29uc3RydWN0b3IgKTtcclxuXHJcblx0cmV0dXJuIGNvbnN0cnVjdG9yO1xyXG59O1xyXG5cclxuJC53aWRnZXQuZXh0ZW5kID0gZnVuY3Rpb24oIHRhcmdldCApIHtcclxuXHR2YXIgaW5wdXQgPSB3aWRnZXRfc2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICksXHJcblx0XHRpbnB1dEluZGV4ID0gMCxcclxuXHRcdGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLFxyXG5cdFx0a2V5LFxyXG5cdFx0dmFsdWU7XHJcblx0Zm9yICggOyBpbnB1dEluZGV4IDwgaW5wdXRMZW5ndGg7IGlucHV0SW5kZXgrKyApIHtcclxuXHRcdGZvciAoIGtleSBpbiBpbnB1dFsgaW5wdXRJbmRleCBdICkge1xyXG5cdFx0XHR2YWx1ZSA9IGlucHV0WyBpbnB1dEluZGV4IF1bIGtleSBdO1xyXG5cdFx0XHRpZiAoIGlucHV0WyBpbnB1dEluZGV4IF0uaGFzT3duUHJvcGVydHkoIGtleSApICYmIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdFx0Ly8gQ2xvbmUgb2JqZWN0c1xyXG5cdFx0XHRcdGlmICggJC5pc1BsYWluT2JqZWN0KCB2YWx1ZSApICkge1xyXG5cdFx0XHRcdFx0dGFyZ2V0WyBrZXkgXSA9ICQuaXNQbGFpbk9iamVjdCggdGFyZ2V0WyBrZXkgXSApID9cclxuXHRcdFx0XHRcdFx0JC53aWRnZXQuZXh0ZW5kKCB7fSwgdGFyZ2V0WyBrZXkgXSwgdmFsdWUgKSA6XHJcblx0XHRcdFx0XHRcdC8vIERvbid0IGV4dGVuZCBzdHJpbmdzLCBhcnJheXMsIGV0Yy4gd2l0aCBvYmplY3RzXHJcblx0XHRcdFx0XHRcdCQud2lkZ2V0LmV4dGVuZCgge30sIHZhbHVlICk7XHJcblx0XHRcdFx0Ly8gQ29weSBldmVyeXRoaW5nIGVsc2UgYnkgcmVmZXJlbmNlXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRhcmdldFsga2V5IF0gPSB2YWx1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIHRhcmdldDtcclxufTtcclxuXHJcbiQud2lkZ2V0LmJyaWRnZSA9IGZ1bmN0aW9uKCBuYW1lLCBvYmplY3QgKSB7XHJcblx0dmFyIGZ1bGxOYW1lID0gb2JqZWN0LnByb3RvdHlwZS53aWRnZXRGdWxsTmFtZSB8fCBuYW1lO1xyXG5cdCQuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBvcHRpb25zICkge1xyXG5cdFx0dmFyIGlzTWV0aG9kQ2FsbCA9IHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiLFxyXG5cdFx0XHRhcmdzID0gd2lkZ2V0X3NsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApLFxyXG5cdFx0XHRyZXR1cm5WYWx1ZSA9IHRoaXM7XHJcblxyXG5cdFx0aWYgKCBpc01ldGhvZENhbGwgKSB7XHJcblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgbWV0aG9kVmFsdWUsXHJcblx0XHRcdFx0XHRpbnN0YW5jZSA9ICQuZGF0YSggdGhpcywgZnVsbE5hbWUgKTtcclxuXHRcdFx0XHRpZiAoIG9wdGlvbnMgPT09IFwiaW5zdGFuY2VcIiApIHtcclxuXHRcdFx0XHRcdHJldHVyblZhbHVlID0gaW5zdGFuY2U7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmICggIWluc3RhbmNlICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuICQuZXJyb3IoIFwiY2Fubm90IGNhbGwgbWV0aG9kcyBvbiBcIiArIG5hbWUgKyBcIiBwcmlvciB0byBpbml0aWFsaXphdGlvbjsgXCIgK1xyXG5cdFx0XHRcdFx0XHRcImF0dGVtcHRlZCB0byBjYWxsIG1ldGhvZCAnXCIgKyBvcHRpb25zICsgXCInXCIgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKCAhJC5pc0Z1bmN0aW9uKCBpbnN0YW5jZVtvcHRpb25zXSApIHx8IG9wdGlvbnMuY2hhckF0KCAwICkgPT09IFwiX1wiICkge1xyXG5cdFx0XHRcdFx0cmV0dXJuICQuZXJyb3IoIFwibm8gc3VjaCBtZXRob2QgJ1wiICsgb3B0aW9ucyArIFwiJyBmb3IgXCIgKyBuYW1lICsgXCIgd2lkZ2V0IGluc3RhbmNlXCIgKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0bWV0aG9kVmFsdWUgPSBpbnN0YW5jZVsgb3B0aW9ucyBdLmFwcGx5KCBpbnN0YW5jZSwgYXJncyApO1xyXG5cdFx0XHRcdGlmICggbWV0aG9kVmFsdWUgIT09IGluc3RhbmNlICYmIG1ldGhvZFZhbHVlICE9PSB1bmRlZmluZWQgKSB7XHJcblx0XHRcdFx0XHRyZXR1cm5WYWx1ZSA9IG1ldGhvZFZhbHVlICYmIG1ldGhvZFZhbHVlLmpxdWVyeSA/XHJcblx0XHRcdFx0XHRcdHJldHVyblZhbHVlLnB1c2hTdGFjayggbWV0aG9kVmFsdWUuZ2V0KCkgKSA6XHJcblx0XHRcdFx0XHRcdG1ldGhvZFZhbHVlO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0Ly8gQWxsb3cgbXVsdGlwbGUgaGFzaGVzIHRvIGJlIHBhc3NlZCBvbiBpbml0XHJcblx0XHRcdGlmICggYXJncy5sZW5ndGggKSB7XHJcblx0XHRcdFx0b3B0aW9ucyA9ICQud2lkZ2V0LmV4dGVuZC5hcHBseSggbnVsbCwgWyBvcHRpb25zIF0uY29uY2F0KGFyZ3MpICk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgaW5zdGFuY2UgPSAkLmRhdGEoIHRoaXMsIGZ1bGxOYW1lICk7XHJcblx0XHRcdFx0aWYgKCBpbnN0YW5jZSApIHtcclxuXHRcdFx0XHRcdGluc3RhbmNlLm9wdGlvbiggb3B0aW9ucyB8fCB7fSApO1xyXG5cdFx0XHRcdFx0aWYgKCBpbnN0YW5jZS5faW5pdCApIHtcclxuXHRcdFx0XHRcdFx0aW5zdGFuY2UuX2luaXQoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JC5kYXRhKCB0aGlzLCBmdWxsTmFtZSwgbmV3IG9iamVjdCggb3B0aW9ucywgdGhpcyApICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gcmV0dXJuVmFsdWU7XHJcblx0fTtcclxufTtcclxuXHJcbiQuV2lkZ2V0ID0gZnVuY3Rpb24oIC8qIG9wdGlvbnMsIGVsZW1lbnQgKi8gKSB7fTtcclxuJC5XaWRnZXQuX2NoaWxkQ29uc3RydWN0b3JzID0gW107XHJcblxyXG4kLldpZGdldC5wcm90b3R5cGUgPSB7XHJcblx0d2lkZ2V0TmFtZTogXCJ3aWRnZXRcIixcclxuXHR3aWRnZXRFdmVudFByZWZpeDogXCJcIixcclxuXHRkZWZhdWx0RWxlbWVudDogXCI8ZGl2PlwiLFxyXG5cdG9wdGlvbnM6IHtcclxuXHRcdGRpc2FibGVkOiBmYWxzZSxcclxuXHJcblx0XHQvLyBjYWxsYmFja3NcclxuXHRcdGNyZWF0ZTogbnVsbFxyXG5cdH0sXHJcblx0X2NyZWF0ZVdpZGdldDogZnVuY3Rpb24oIG9wdGlvbnMsIGVsZW1lbnQgKSB7XHJcblx0XHRlbGVtZW50ID0gJCggZWxlbWVudCB8fCB0aGlzLmRlZmF1bHRFbGVtZW50IHx8IHRoaXMgKVsgMCBdO1xyXG5cdFx0dGhpcy5lbGVtZW50ID0gJCggZWxlbWVudCApO1xyXG5cdFx0dGhpcy51dWlkID0gd2lkZ2V0X3V1aWQrKztcclxuXHRcdHRoaXMuZXZlbnROYW1lc3BhY2UgPSBcIi5cIiArIHRoaXMud2lkZ2V0TmFtZSArIHRoaXMudXVpZDtcclxuXHJcblx0XHR0aGlzLmJpbmRpbmdzID0gJCgpO1xyXG5cdFx0dGhpcy5ob3ZlcmFibGUgPSAkKCk7XHJcblx0XHR0aGlzLmZvY3VzYWJsZSA9ICQoKTtcclxuXHJcblx0XHRpZiAoIGVsZW1lbnQgIT09IHRoaXMgKSB7XHJcblx0XHRcdCQuZGF0YSggZWxlbWVudCwgdGhpcy53aWRnZXRGdWxsTmFtZSwgdGhpcyApO1xyXG5cdFx0XHR0aGlzLl9vbiggdHJ1ZSwgdGhpcy5lbGVtZW50LCB7XHJcblx0XHRcdFx0cmVtb3ZlOiBmdW5jdGlvbiggZXZlbnQgKSB7XHJcblx0XHRcdFx0XHRpZiAoIGV2ZW50LnRhcmdldCA9PT0gZWxlbWVudCApIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5kZXN0cm95KCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0dGhpcy5kb2N1bWVudCA9ICQoIGVsZW1lbnQuc3R5bGUgP1xyXG5cdFx0XHRcdC8vIGVsZW1lbnQgd2l0aGluIHRoZSBkb2N1bWVudFxyXG5cdFx0XHRcdGVsZW1lbnQub3duZXJEb2N1bWVudCA6XHJcblx0XHRcdFx0Ly8gZWxlbWVudCBpcyB3aW5kb3cgb3IgZG9jdW1lbnRcclxuXHRcdFx0XHRlbGVtZW50LmRvY3VtZW50IHx8IGVsZW1lbnQgKTtcclxuXHRcdFx0dGhpcy53aW5kb3cgPSAkKCB0aGlzLmRvY3VtZW50WzBdLmRlZmF1bHRWaWV3IHx8IHRoaXMuZG9jdW1lbnRbMF0ucGFyZW50V2luZG93ICk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5vcHRpb25zID0gJC53aWRnZXQuZXh0ZW5kKCB7fSxcclxuXHRcdFx0dGhpcy5vcHRpb25zLFxyXG5cdFx0XHR0aGlzLl9nZXRDcmVhdGVPcHRpb25zKCksXHJcblx0XHRcdG9wdGlvbnMgKTtcclxuXHJcblx0XHR0aGlzLl9jcmVhdGUoKTtcclxuXHRcdHRoaXMuX3RyaWdnZXIoIFwiY3JlYXRlXCIsIG51bGwsIHRoaXMuX2dldENyZWF0ZUV2ZW50RGF0YSgpICk7XHJcblx0XHR0aGlzLl9pbml0KCk7XHJcblx0fSxcclxuXHRfZ2V0Q3JlYXRlT3B0aW9uczogJC5ub29wLFxyXG5cdF9nZXRDcmVhdGVFdmVudERhdGE6ICQubm9vcCxcclxuXHRfY3JlYXRlOiAkLm5vb3AsXHJcblx0X2luaXQ6ICQubm9vcCxcclxuXHJcblx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLl9kZXN0cm95KCk7XHJcblx0XHQvLyB3ZSBjYW4gcHJvYmFibHkgcmVtb3ZlIHRoZSB1bmJpbmQgY2FsbHMgaW4gMi4wXHJcblx0XHQvLyBhbGwgZXZlbnQgYmluZGluZ3Mgc2hvdWxkIGdvIHRocm91Z2ggdGhpcy5fb24oKVxyXG5cdFx0dGhpcy5lbGVtZW50XHJcblx0XHRcdC51bmJpbmQoIHRoaXMuZXZlbnROYW1lc3BhY2UgKVxyXG5cdFx0XHQucmVtb3ZlRGF0YSggdGhpcy53aWRnZXRGdWxsTmFtZSApXHJcblx0XHRcdC8vIHN1cHBvcnQ6IGpxdWVyeSA8MS42LjNcclxuXHRcdFx0Ly8gaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvOTQxM1xyXG5cdFx0XHQucmVtb3ZlRGF0YSggJC5jYW1lbENhc2UoIHRoaXMud2lkZ2V0RnVsbE5hbWUgKSApO1xyXG5cdFx0dGhpcy53aWRnZXQoKVxyXG5cdFx0XHQudW5iaW5kKCB0aGlzLmV2ZW50TmFtZXNwYWNlIClcclxuXHRcdFx0LnJlbW92ZUF0dHIoIFwiYXJpYS1kaXNhYmxlZFwiIClcclxuXHRcdFx0LnJlbW92ZUNsYXNzKFxyXG5cdFx0XHRcdHRoaXMud2lkZ2V0RnVsbE5hbWUgKyBcIi1kaXNhYmxlZCBcIiArXHJcblx0XHRcdFx0XCJ1aS1zdGF0ZS1kaXNhYmxlZFwiICk7XHJcblxyXG5cdFx0Ly8gY2xlYW4gdXAgZXZlbnRzIGFuZCBzdGF0ZXNcclxuXHRcdHRoaXMuYmluZGluZ3MudW5iaW5kKCB0aGlzLmV2ZW50TmFtZXNwYWNlICk7XHJcblx0XHR0aGlzLmhvdmVyYWJsZS5yZW1vdmVDbGFzcyggXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XHJcblx0XHR0aGlzLmZvY3VzYWJsZS5yZW1vdmVDbGFzcyggXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XHJcblx0fSxcclxuXHRfZGVzdHJveTogJC5ub29wLFxyXG5cclxuXHR3aWRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudDtcclxuXHR9LFxyXG5cclxuXHRvcHRpb246IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkge1xyXG5cdFx0dmFyIG9wdGlvbnMgPSBrZXksXHJcblx0XHRcdHBhcnRzLFxyXG5cdFx0XHRjdXJPcHRpb24sXHJcblx0XHRcdGk7XHJcblxyXG5cdFx0aWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAwICkge1xyXG5cdFx0XHQvLyBkb24ndCByZXR1cm4gYSByZWZlcmVuY2UgdG8gdGhlIGludGVybmFsIGhhc2hcclxuXHRcdFx0cmV0dXJuICQud2lkZ2V0LmV4dGVuZCgge30sIHRoaXMub3B0aW9ucyApO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggdHlwZW9mIGtleSA9PT0gXCJzdHJpbmdcIiApIHtcclxuXHRcdFx0Ly8gaGFuZGxlIG5lc3RlZCBrZXlzLCBlLmcuLCBcImZvby5iYXJcIiA9PiB7IGZvbzogeyBiYXI6IF9fXyB9IH1cclxuXHRcdFx0b3B0aW9ucyA9IHt9O1xyXG5cdFx0XHRwYXJ0cyA9IGtleS5zcGxpdCggXCIuXCIgKTtcclxuXHRcdFx0a2V5ID0gcGFydHMuc2hpZnQoKTtcclxuXHRcdFx0aWYgKCBwYXJ0cy5sZW5ndGggKSB7XHJcblx0XHRcdFx0Y3VyT3B0aW9uID0gb3B0aW9uc1sga2V5IF0gPSAkLndpZGdldC5leHRlbmQoIHt9LCB0aGlzLm9wdGlvbnNbIGtleSBdICk7XHJcblx0XHRcdFx0Zm9yICggaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGggLSAxOyBpKysgKSB7XHJcblx0XHRcdFx0XHRjdXJPcHRpb25bIHBhcnRzWyBpIF0gXSA9IGN1ck9wdGlvblsgcGFydHNbIGkgXSBdIHx8IHt9O1xyXG5cdFx0XHRcdFx0Y3VyT3B0aW9uID0gY3VyT3B0aW9uWyBwYXJ0c1sgaSBdIF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGtleSA9IHBhcnRzLnBvcCgpO1xyXG5cdFx0XHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCA9PT0gMSApIHtcclxuXHRcdFx0XHRcdHJldHVybiBjdXJPcHRpb25bIGtleSBdID09PSB1bmRlZmluZWQgPyBudWxsIDogY3VyT3B0aW9uWyBrZXkgXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y3VyT3B0aW9uWyBrZXkgXSA9IHZhbHVlO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmICggYXJndW1lbnRzLmxlbmd0aCA9PT0gMSApIHtcclxuXHRcdFx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnNbIGtleSBdID09PSB1bmRlZmluZWQgPyBudWxsIDogdGhpcy5vcHRpb25zWyBrZXkgXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0b3B0aW9uc1sga2V5IF0gPSB2YWx1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3NldE9wdGlvbnMoIG9wdGlvbnMgKTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cdF9zZXRPcHRpb25zOiBmdW5jdGlvbiggb3B0aW9ucyApIHtcclxuXHRcdHZhciBrZXk7XHJcblxyXG5cdFx0Zm9yICgga2V5IGluIG9wdGlvbnMgKSB7XHJcblx0XHRcdHRoaXMuX3NldE9wdGlvbigga2V5LCBvcHRpb25zWyBrZXkgXSApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XHJcblx0XHR0aGlzLm9wdGlvbnNbIGtleSBdID0gdmFsdWU7XHJcblxyXG5cdFx0aWYgKCBrZXkgPT09IFwiZGlzYWJsZWRcIiApIHtcclxuXHRcdFx0dGhpcy53aWRnZXQoKVxyXG5cdFx0XHRcdC50b2dnbGVDbGFzcyggdGhpcy53aWRnZXRGdWxsTmFtZSArIFwiLWRpc2FibGVkXCIsICEhdmFsdWUgKTtcclxuXHJcblx0XHRcdC8vIElmIHRoZSB3aWRnZXQgaXMgYmVjb21pbmcgZGlzYWJsZWQsIHRoZW4gbm90aGluZyBpcyBpbnRlcmFjdGl2ZVxyXG5cdFx0XHRpZiAoIHZhbHVlICkge1xyXG5cdFx0XHRcdHRoaXMuaG92ZXJhYmxlLnJlbW92ZUNsYXNzKCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcclxuXHRcdFx0XHR0aGlzLmZvY3VzYWJsZS5yZW1vdmVDbGFzcyggXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRlbmFibGU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoeyBkaXNhYmxlZDogZmFsc2UgfSk7XHJcblx0fSxcclxuXHRkaXNhYmxlOiBmdW5jdGlvbigpIHtcclxuXHRcdHJldHVybiB0aGlzLl9zZXRPcHRpb25zKHsgZGlzYWJsZWQ6IHRydWUgfSk7XHJcblx0fSxcclxuXHJcblx0X29uOiBmdW5jdGlvbiggc3VwcHJlc3NEaXNhYmxlZENoZWNrLCBlbGVtZW50LCBoYW5kbGVycyApIHtcclxuXHRcdHZhciBkZWxlZ2F0ZUVsZW1lbnQsXHJcblx0XHRcdGluc3RhbmNlID0gdGhpcztcclxuXHJcblx0XHQvLyBubyBzdXBwcmVzc0Rpc2FibGVkQ2hlY2sgZmxhZywgc2h1ZmZsZSBhcmd1bWVudHNcclxuXHRcdGlmICggdHlwZW9mIHN1cHByZXNzRGlzYWJsZWRDaGVjayAhPT0gXCJib29sZWFuXCIgKSB7XHJcblx0XHRcdGhhbmRsZXJzID0gZWxlbWVudDtcclxuXHRcdFx0ZWxlbWVudCA9IHN1cHByZXNzRGlzYWJsZWRDaGVjaztcclxuXHRcdFx0c3VwcHJlc3NEaXNhYmxlZENoZWNrID0gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gbm8gZWxlbWVudCBhcmd1bWVudCwgc2h1ZmZsZSBhbmQgdXNlIHRoaXMuZWxlbWVudFxyXG5cdFx0aWYgKCAhaGFuZGxlcnMgKSB7XHJcblx0XHRcdGhhbmRsZXJzID0gZWxlbWVudDtcclxuXHRcdFx0ZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcclxuXHRcdFx0ZGVsZWdhdGVFbGVtZW50ID0gdGhpcy53aWRnZXQoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGVsZW1lbnQgPSBkZWxlZ2F0ZUVsZW1lbnQgPSAkKCBlbGVtZW50ICk7XHJcblx0XHRcdHRoaXMuYmluZGluZ3MgPSB0aGlzLmJpbmRpbmdzLmFkZCggZWxlbWVudCApO1xyXG5cdFx0fVxyXG5cclxuXHRcdCQuZWFjaCggaGFuZGxlcnMsIGZ1bmN0aW9uKCBldmVudCwgaGFuZGxlciApIHtcclxuXHRcdFx0ZnVuY3Rpb24gaGFuZGxlclByb3h5KCkge1xyXG5cdFx0XHRcdC8vIGFsbG93IHdpZGdldHMgdG8gY3VzdG9taXplIHRoZSBkaXNhYmxlZCBoYW5kbGluZ1xyXG5cdFx0XHRcdC8vIC0gZGlzYWJsZWQgYXMgYW4gYXJyYXkgaW5zdGVhZCBvZiBib29sZWFuXHJcblx0XHRcdFx0Ly8gLSBkaXNhYmxlZCBjbGFzcyBhcyBtZXRob2QgZm9yIGRpc2FibGluZyBpbmRpdmlkdWFsIHBhcnRzXHJcblx0XHRcdFx0aWYgKCAhc3VwcHJlc3NEaXNhYmxlZENoZWNrICYmXHJcblx0XHRcdFx0XHRcdCggaW5zdGFuY2Uub3B0aW9ucy5kaXNhYmxlZCA9PT0gdHJ1ZSB8fFxyXG5cdFx0XHRcdFx0XHRcdCQoIHRoaXMgKS5oYXNDbGFzcyggXCJ1aS1zdGF0ZS1kaXNhYmxlZFwiICkgKSApIHtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuICggdHlwZW9mIGhhbmRsZXIgPT09IFwic3RyaW5nXCIgPyBpbnN0YW5jZVsgaGFuZGxlciBdIDogaGFuZGxlciApXHJcblx0XHRcdFx0XHQuYXBwbHkoIGluc3RhbmNlLCBhcmd1bWVudHMgKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gY29weSB0aGUgZ3VpZCBzbyBkaXJlY3QgdW5iaW5kaW5nIHdvcmtzXHJcblx0XHRcdGlmICggdHlwZW9mIGhhbmRsZXIgIT09IFwic3RyaW5nXCIgKSB7XHJcblx0XHRcdFx0aGFuZGxlclByb3h5Lmd1aWQgPSBoYW5kbGVyLmd1aWQgPVxyXG5cdFx0XHRcdFx0aGFuZGxlci5ndWlkIHx8IGhhbmRsZXJQcm94eS5ndWlkIHx8ICQuZ3VpZCsrO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgbWF0Y2ggPSBldmVudC5tYXRjaCggL14oW1xcdzotXSopXFxzKiguKikkLyApLFxyXG5cdFx0XHRcdGV2ZW50TmFtZSA9IG1hdGNoWzFdICsgaW5zdGFuY2UuZXZlbnROYW1lc3BhY2UsXHJcblx0XHRcdFx0c2VsZWN0b3IgPSBtYXRjaFsyXTtcclxuXHRcdFx0aWYgKCBzZWxlY3RvciApIHtcclxuXHRcdFx0XHRkZWxlZ2F0ZUVsZW1lbnQuZGVsZWdhdGUoIHNlbGVjdG9yLCBldmVudE5hbWUsIGhhbmRsZXJQcm94eSApO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGVsZW1lbnQuYmluZCggZXZlbnROYW1lLCBoYW5kbGVyUHJveHkgKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0X29mZjogZnVuY3Rpb24oIGVsZW1lbnQsIGV2ZW50TmFtZSApIHtcclxuXHRcdGV2ZW50TmFtZSA9IChldmVudE5hbWUgfHwgXCJcIikuc3BsaXQoIFwiIFwiICkuam9pbiggdGhpcy5ldmVudE5hbWVzcGFjZSArIFwiIFwiICkgK1xyXG5cdFx0XHR0aGlzLmV2ZW50TmFtZXNwYWNlO1xyXG5cdFx0ZWxlbWVudC51bmJpbmQoIGV2ZW50TmFtZSApLnVuZGVsZWdhdGUoIGV2ZW50TmFtZSApO1xyXG5cclxuXHRcdC8vIENsZWFyIHRoZSBzdGFjayB0byBhdm9pZCBtZW1vcnkgbGVha3MgKCMxMDA1NilcclxuXHRcdHRoaXMuYmluZGluZ3MgPSAkKCB0aGlzLmJpbmRpbmdzLm5vdCggZWxlbWVudCApLmdldCgpICk7XHJcblx0XHR0aGlzLmZvY3VzYWJsZSA9ICQoIHRoaXMuZm9jdXNhYmxlLm5vdCggZWxlbWVudCApLmdldCgpICk7XHJcblx0XHR0aGlzLmhvdmVyYWJsZSA9ICQoIHRoaXMuaG92ZXJhYmxlLm5vdCggZWxlbWVudCApLmdldCgpICk7XHJcblx0fSxcclxuXHJcblx0X2RlbGF5OiBmdW5jdGlvbiggaGFuZGxlciwgZGVsYXkgKSB7XHJcblx0XHRmdW5jdGlvbiBoYW5kbGVyUHJveHkoKSB7XHJcblx0XHRcdHJldHVybiAoIHR5cGVvZiBoYW5kbGVyID09PSBcInN0cmluZ1wiID8gaW5zdGFuY2VbIGhhbmRsZXIgXSA6IGhhbmRsZXIgKVxyXG5cdFx0XHRcdC5hcHBseSggaW5zdGFuY2UsIGFyZ3VtZW50cyApO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGluc3RhbmNlID0gdGhpcztcclxuXHRcdHJldHVybiBzZXRUaW1lb3V0KCBoYW5kbGVyUHJveHksIGRlbGF5IHx8IDAgKTtcclxuXHR9LFxyXG5cclxuXHRfaG92ZXJhYmxlOiBmdW5jdGlvbiggZWxlbWVudCApIHtcclxuXHRcdHRoaXMuaG92ZXJhYmxlID0gdGhpcy5ob3ZlcmFibGUuYWRkKCBlbGVtZW50ICk7XHJcblx0XHR0aGlzLl9vbiggZWxlbWVudCwge1xyXG5cdFx0XHRtb3VzZWVudGVyOiBmdW5jdGlvbiggZXZlbnQgKSB7XHJcblx0XHRcdFx0JCggZXZlbnQuY3VycmVudFRhcmdldCApLmFkZENsYXNzKCBcInVpLXN0YXRlLWhvdmVyXCIgKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0bW91c2VsZWF2ZTogZnVuY3Rpb24oIGV2ZW50ICkge1xyXG5cdFx0XHRcdCQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKS5yZW1vdmVDbGFzcyggXCJ1aS1zdGF0ZS1ob3ZlclwiICk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdF9mb2N1c2FibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xyXG5cdFx0dGhpcy5mb2N1c2FibGUgPSB0aGlzLmZvY3VzYWJsZS5hZGQoIGVsZW1lbnQgKTtcclxuXHRcdHRoaXMuX29uKCBlbGVtZW50LCB7XHJcblx0XHRcdGZvY3VzaW46IGZ1bmN0aW9uKCBldmVudCApIHtcclxuXHRcdFx0XHQkKCBldmVudC5jdXJyZW50VGFyZ2V0ICkuYWRkQ2xhc3MoIFwidWktc3RhdGUtZm9jdXNcIiApO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRmb2N1c291dDogZnVuY3Rpb24oIGV2ZW50ICkge1xyXG5cdFx0XHRcdCQoIGV2ZW50LmN1cnJlbnRUYXJnZXQgKS5yZW1vdmVDbGFzcyggXCJ1aS1zdGF0ZS1mb2N1c1wiICk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdF90cmlnZ2VyOiBmdW5jdGlvbiggdHlwZSwgZXZlbnQsIGRhdGEgKSB7XHJcblx0XHR2YXIgcHJvcCwgb3JpZyxcclxuXHRcdFx0Y2FsbGJhY2sgPSB0aGlzLm9wdGlvbnNbIHR5cGUgXTtcclxuXHJcblx0XHRkYXRhID0gZGF0YSB8fCB7fTtcclxuXHRcdGV2ZW50ID0gJC5FdmVudCggZXZlbnQgKTtcclxuXHRcdGV2ZW50LnR5cGUgPSAoIHR5cGUgPT09IHRoaXMud2lkZ2V0RXZlbnRQcmVmaXggP1xyXG5cdFx0XHR0eXBlIDpcclxuXHRcdFx0dGhpcy53aWRnZXRFdmVudFByZWZpeCArIHR5cGUgKS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0Ly8gdGhlIG9yaWdpbmFsIGV2ZW50IG1heSBjb21lIGZyb20gYW55IGVsZW1lbnRcclxuXHRcdC8vIHNvIHdlIG5lZWQgdG8gcmVzZXQgdGhlIHRhcmdldCBvbiB0aGUgbmV3IGV2ZW50XHJcblx0XHRldmVudC50YXJnZXQgPSB0aGlzLmVsZW1lbnRbIDAgXTtcclxuXHJcblx0XHQvLyBjb3B5IG9yaWdpbmFsIGV2ZW50IHByb3BlcnRpZXMgb3ZlciB0byB0aGUgbmV3IGV2ZW50XHJcblx0XHRvcmlnID0gZXZlbnQub3JpZ2luYWxFdmVudDtcclxuXHRcdGlmICggb3JpZyApIHtcclxuXHRcdFx0Zm9yICggcHJvcCBpbiBvcmlnICkge1xyXG5cdFx0XHRcdGlmICggISggcHJvcCBpbiBldmVudCApICkge1xyXG5cdFx0XHRcdFx0ZXZlbnRbIHByb3AgXSA9IG9yaWdbIHByb3AgXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmVsZW1lbnQudHJpZ2dlciggZXZlbnQsIGRhdGEgKTtcclxuXHRcdHJldHVybiAhKCAkLmlzRnVuY3Rpb24oIGNhbGxiYWNrICkgJiZcclxuXHRcdFx0Y2FsbGJhY2suYXBwbHkoIHRoaXMuZWxlbWVudFswXSwgWyBldmVudCBdLmNvbmNhdCggZGF0YSApICkgPT09IGZhbHNlIHx8XHJcblx0XHRcdGV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpICk7XHJcblx0fVxyXG59O1xyXG5cclxuJC5lYWNoKCB7IHNob3c6IFwiZmFkZUluXCIsIGhpZGU6IFwiZmFkZU91dFwiIH0sIGZ1bmN0aW9uKCBtZXRob2QsIGRlZmF1bHRFZmZlY3QgKSB7XHJcblx0JC5XaWRnZXQucHJvdG90eXBlWyBcIl9cIiArIG1ldGhvZCBdID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMsIGNhbGxiYWNrICkge1xyXG5cdFx0aWYgKCB0eXBlb2Ygb3B0aW9ucyA9PT0gXCJzdHJpbmdcIiApIHtcclxuXHRcdFx0b3B0aW9ucyA9IHsgZWZmZWN0OiBvcHRpb25zIH07XHJcblx0XHR9XHJcblx0XHR2YXIgaGFzT3B0aW9ucyxcclxuXHRcdFx0ZWZmZWN0TmFtZSA9ICFvcHRpb25zID9cclxuXHRcdFx0XHRtZXRob2QgOlxyXG5cdFx0XHRcdG9wdGlvbnMgPT09IHRydWUgfHwgdHlwZW9mIG9wdGlvbnMgPT09IFwibnVtYmVyXCIgP1xyXG5cdFx0XHRcdFx0ZGVmYXVsdEVmZmVjdCA6XHJcblx0XHRcdFx0XHRvcHRpb25zLmVmZmVjdCB8fCBkZWZhdWx0RWZmZWN0O1xyXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblx0XHRpZiAoIHR5cGVvZiBvcHRpb25zID09PSBcIm51bWJlclwiICkge1xyXG5cdFx0XHRvcHRpb25zID0geyBkdXJhdGlvbjogb3B0aW9ucyB9O1xyXG5cdFx0fVxyXG5cdFx0aGFzT3B0aW9ucyA9ICEkLmlzRW1wdHlPYmplY3QoIG9wdGlvbnMgKTtcclxuXHRcdG9wdGlvbnMuY29tcGxldGUgPSBjYWxsYmFjaztcclxuXHRcdGlmICggb3B0aW9ucy5kZWxheSApIHtcclxuXHRcdFx0ZWxlbWVudC5kZWxheSggb3B0aW9ucy5kZWxheSApO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCBoYXNPcHRpb25zICYmICQuZWZmZWN0cyAmJiAkLmVmZmVjdHMuZWZmZWN0WyBlZmZlY3ROYW1lIF0gKSB7XHJcblx0XHRcdGVsZW1lbnRbIG1ldGhvZCBdKCBvcHRpb25zICk7XHJcblx0XHR9IGVsc2UgaWYgKCBlZmZlY3ROYW1lICE9PSBtZXRob2QgJiYgZWxlbWVudFsgZWZmZWN0TmFtZSBdICkge1xyXG5cdFx0XHRlbGVtZW50WyBlZmZlY3ROYW1lIF0oIG9wdGlvbnMuZHVyYXRpb24sIG9wdGlvbnMuZWFzaW5nLCBjYWxsYmFjayApO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ZWxlbWVudC5xdWV1ZShmdW5jdGlvbiggbmV4dCApIHtcclxuXHRcdFx0XHQkKCB0aGlzIClbIG1ldGhvZCBdKCk7XHJcblx0XHRcdFx0aWYgKCBjYWxsYmFjayApIHtcclxuXHRcdFx0XHRcdGNhbGxiYWNrLmNhbGwoIGVsZW1lbnRbIDAgXSApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRuZXh0KCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH07XHJcbn0pO1xyXG5cclxudmFyIHdpZGdldCA9ICQud2lkZ2V0O1xyXG5cclxuXHJcbi8qIVxyXG4gKiBqUXVlcnkgVUkgTW91c2UgMS4xMS40XHJcbiAqIGh0dHA6Ly9qcXVlcnl1aS5jb21cclxuICpcclxuICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcclxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxyXG4gKiBodHRwOi8vanF1ZXJ5Lm9yZy9saWNlbnNlXHJcbiAqXHJcbiAqIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL21vdXNlL1xyXG4gKi9cclxuXHJcblxyXG52YXIgbW91c2VIYW5kbGVkID0gZmFsc2U7XHJcbiQoIGRvY3VtZW50ICkubW91c2V1cCggZnVuY3Rpb24oKSB7XHJcblx0bW91c2VIYW5kbGVkID0gZmFsc2U7XHJcbn0pO1xyXG5cclxudmFyIG1vdXNlID0gJC53aWRnZXQoXCJ1aS5tb3VzZVwiLCB7XHJcblx0dmVyc2lvbjogXCIxLjExLjRcIixcclxuXHRvcHRpb25zOiB7XHJcblx0XHRjYW5jZWw6IFwiaW5wdXQsdGV4dGFyZWEsYnV0dG9uLHNlbGVjdCxvcHRpb25cIixcclxuXHRcdGRpc3RhbmNlOiAxLFxyXG5cdFx0ZGVsYXk6IDBcclxuXHR9LFxyXG5cdF9tb3VzZUluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xyXG5cclxuXHRcdHRoaXMuZWxlbWVudFxyXG5cdFx0XHQuYmluZChcIm1vdXNlZG93bi5cIiArIHRoaXMud2lkZ2V0TmFtZSwgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhhdC5fbW91c2VEb3duKGV2ZW50KTtcclxuXHRcdFx0fSlcclxuXHRcdFx0LmJpbmQoXCJjbGljay5cIiArIHRoaXMud2lkZ2V0TmFtZSwgZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0XHRpZiAodHJ1ZSA9PT0gJC5kYXRhKGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIikpIHtcclxuXHRcdFx0XHRcdCQucmVtb3ZlRGF0YShldmVudC50YXJnZXQsIHRoYXQud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIpO1xyXG5cdFx0XHRcdFx0ZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHR0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHQvLyBUT0RPOiBtYWtlIHN1cmUgZGVzdHJveWluZyBvbmUgaW5zdGFuY2Ugb2YgbW91c2UgZG9lc24ndCBtZXNzIHdpdGhcclxuXHQvLyBvdGhlciBpbnN0YW5jZXMgb2YgbW91c2VcclxuXHRfbW91c2VEZXN0cm95OiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuZWxlbWVudC51bmJpbmQoXCIuXCIgKyB0aGlzLndpZGdldE5hbWUpO1xyXG5cdFx0aWYgKCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApIHtcclxuXHRcdFx0dGhpcy5kb2N1bWVudFxyXG5cdFx0XHRcdC51bmJpbmQoXCJtb3VzZW1vdmUuXCIgKyB0aGlzLndpZGdldE5hbWUsIHRoaXMuX21vdXNlTW92ZURlbGVnYXRlKVxyXG5cdFx0XHRcdC51bmJpbmQoXCJtb3VzZXVwLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZVVwRGVsZWdhdGUpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9tb3VzZURvd246IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHQvLyBkb24ndCBsZXQgbW9yZSB0aGFuIG9uZSB3aWRnZXQgaGFuZGxlIG1vdXNlU3RhcnRcclxuXHRcdGlmICggbW91c2VIYW5kbGVkICkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fbW91c2VNb3ZlZCA9IGZhbHNlO1xyXG5cclxuXHRcdC8vIHdlIG1heSBoYXZlIG1pc3NlZCBtb3VzZXVwIChvdXQgb2Ygd2luZG93KVxyXG5cdFx0KHRoaXMuX21vdXNlU3RhcnRlZCAmJiB0aGlzLl9tb3VzZVVwKGV2ZW50KSk7XHJcblxyXG5cdFx0dGhpcy5fbW91c2VEb3duRXZlbnQgPSBldmVudDtcclxuXHJcblx0XHR2YXIgdGhhdCA9IHRoaXMsXHJcblx0XHRcdGJ0bklzTGVmdCA9IChldmVudC53aGljaCA9PT0gMSksXHJcblx0XHRcdC8vIGV2ZW50LnRhcmdldC5ub2RlTmFtZSB3b3JrcyBhcm91bmQgYSBidWcgaW4gSUUgOCB3aXRoXHJcblx0XHRcdC8vIGRpc2FibGVkIGlucHV0cyAoIzc2MjApXHJcblx0XHRcdGVsSXNDYW5jZWwgPSAodHlwZW9mIHRoaXMub3B0aW9ucy5jYW5jZWwgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudGFyZ2V0Lm5vZGVOYW1lID8gJChldmVudC50YXJnZXQpLmNsb3Nlc3QodGhpcy5vcHRpb25zLmNhbmNlbCkubGVuZ3RoIDogZmFsc2UpO1xyXG5cdFx0aWYgKCFidG5Jc0xlZnQgfHwgZWxJc0NhbmNlbCB8fCAhdGhpcy5fbW91c2VDYXB0dXJlKGV2ZW50KSkge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLm1vdXNlRGVsYXlNZXQgPSAhdGhpcy5vcHRpb25zLmRlbGF5O1xyXG5cdFx0aWYgKCF0aGlzLm1vdXNlRGVsYXlNZXQpIHtcclxuXHRcdFx0dGhpcy5fbW91c2VEZWxheVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR0aGF0Lm1vdXNlRGVsYXlNZXQgPSB0cnVlO1xyXG5cdFx0XHR9LCB0aGlzLm9wdGlvbnMuZGVsYXkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGV2ZW50KSAmJiB0aGlzLl9tb3VzZURlbGF5TWV0KGV2ZW50KSkge1xyXG5cdFx0XHR0aGlzLl9tb3VzZVN0YXJ0ZWQgPSAodGhpcy5fbW91c2VTdGFydChldmVudCkgIT09IGZhbHNlKTtcclxuXHRcdFx0aWYgKCF0aGlzLl9tb3VzZVN0YXJ0ZWQpIHtcclxuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ2xpY2sgZXZlbnQgbWF5IG5ldmVyIGhhdmUgZmlyZWQgKEdlY2tvICYgT3BlcmEpXHJcblx0XHRpZiAodHJ1ZSA9PT0gJC5kYXRhKGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIikpIHtcclxuXHRcdFx0JC5yZW1vdmVEYXRhKGV2ZW50LnRhcmdldCwgdGhpcy53aWRnZXROYW1lICsgXCIucHJldmVudENsaWNrRXZlbnRcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gdGhlc2UgZGVsZWdhdGVzIGFyZSByZXF1aXJlZCB0byBrZWVwIGNvbnRleHRcclxuXHRcdHRoaXMuX21vdXNlTW92ZURlbGVnYXRlID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0cmV0dXJuIHRoYXQuX21vdXNlTW92ZShldmVudCk7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5fbW91c2VVcERlbGVnYXRlID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0cmV0dXJuIHRoYXQuX21vdXNlVXAoZXZlbnQpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmRvY3VtZW50XHJcblx0XHRcdC5iaW5kKCBcIm1vdXNlbW92ZS5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUgKVxyXG5cdFx0XHQuYmluZCggXCJtb3VzZXVwLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZVVwRGVsZWdhdGUgKTtcclxuXHJcblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuXHRcdG1vdXNlSGFuZGxlZCA9IHRydWU7XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHRfbW91c2VNb3ZlOiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0Ly8gT25seSBjaGVjayBmb3IgbW91c2V1cHMgb3V0c2lkZSB0aGUgZG9jdW1lbnQgaWYgeW91J3ZlIG1vdmVkIGluc2lkZSB0aGUgZG9jdW1lbnRcclxuXHRcdC8vIGF0IGxlYXN0IG9uY2UuIFRoaXMgcHJldmVudHMgdGhlIGZpcmluZyBvZiBtb3VzZXVwIGluIHRoZSBjYXNlIG9mIElFPDksIHdoaWNoIHdpbGxcclxuXHRcdC8vIGZpcmUgYSBtb3VzZW1vdmUgZXZlbnQgaWYgY29udGVudCBpcyBwbGFjZWQgdW5kZXIgdGhlIGN1cnNvci4gU2VlICM3Nzc4XHJcblx0XHQvLyBTdXBwb3J0OiBJRSA8OVxyXG5cdFx0aWYgKCB0aGlzLl9tb3VzZU1vdmVkICkge1xyXG5cdFx0XHQvLyBJRSBtb3VzZXVwIGNoZWNrIC0gbW91c2V1cCBoYXBwZW5lZCB3aGVuIG1vdXNlIHdhcyBvdXQgb2Ygd2luZG93XHJcblx0XHRcdGlmICgkLnVpLmllICYmICggIWRvY3VtZW50LmRvY3VtZW50TW9kZSB8fCBkb2N1bWVudC5kb2N1bWVudE1vZGUgPCA5ICkgJiYgIWV2ZW50LmJ1dHRvbikge1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLl9tb3VzZVVwKGV2ZW50KTtcclxuXHJcblx0XHRcdC8vIElmcmFtZSBtb3VzZXVwIGNoZWNrIC0gbW91c2V1cCBvY2N1cnJlZCBpbiBhbm90aGVyIGRvY3VtZW50XHJcblx0XHRcdH0gZWxzZSBpZiAoICFldmVudC53aGljaCApIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fbW91c2VVcCggZXZlbnQgKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggZXZlbnQud2hpY2ggfHwgZXZlbnQuYnV0dG9uICkge1xyXG5cdFx0XHR0aGlzLl9tb3VzZU1vdmVkID0gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fbW91c2VTdGFydGVkKSB7XHJcblx0XHRcdHRoaXMuX21vdXNlRHJhZyhldmVudCk7XHJcblx0XHRcdHJldHVybiBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGV2ZW50KSAmJiB0aGlzLl9tb3VzZURlbGF5TWV0KGV2ZW50KSkge1xyXG5cdFx0XHR0aGlzLl9tb3VzZVN0YXJ0ZWQgPVxyXG5cdFx0XHRcdCh0aGlzLl9tb3VzZVN0YXJ0KHRoaXMuX21vdXNlRG93bkV2ZW50LCBldmVudCkgIT09IGZhbHNlKTtcclxuXHRcdFx0KHRoaXMuX21vdXNlU3RhcnRlZCA/IHRoaXMuX21vdXNlRHJhZyhldmVudCkgOiB0aGlzLl9tb3VzZVVwKGV2ZW50KSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuICF0aGlzLl9tb3VzZVN0YXJ0ZWQ7XHJcblx0fSxcclxuXHJcblx0X21vdXNlVXA6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHR0aGlzLmRvY3VtZW50XHJcblx0XHRcdC51bmJpbmQoIFwibW91c2Vtb3ZlLlwiICsgdGhpcy53aWRnZXROYW1lLCB0aGlzLl9tb3VzZU1vdmVEZWxlZ2F0ZSApXHJcblx0XHRcdC51bmJpbmQoIFwibW91c2V1cC5cIiArIHRoaXMud2lkZ2V0TmFtZSwgdGhpcy5fbW91c2VVcERlbGVnYXRlICk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX21vdXNlU3RhcnRlZCkge1xyXG5cdFx0XHR0aGlzLl9tb3VzZVN0YXJ0ZWQgPSBmYWxzZTtcclxuXHJcblx0XHRcdGlmIChldmVudC50YXJnZXQgPT09IHRoaXMuX21vdXNlRG93bkV2ZW50LnRhcmdldCkge1xyXG5cdFx0XHRcdCQuZGF0YShldmVudC50YXJnZXQsIHRoaXMud2lkZ2V0TmFtZSArIFwiLnByZXZlbnRDbGlja0V2ZW50XCIsIHRydWUpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLl9tb3VzZVN0b3AoZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdG1vdXNlSGFuZGxlZCA9IGZhbHNlO1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblxyXG5cdF9tb3VzZURpc3RhbmNlTWV0OiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0cmV0dXJuIChNYXRoLm1heChcclxuXHRcdFx0XHRNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWCAtIGV2ZW50LnBhZ2VYKSxcclxuXHRcdFx0XHRNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWSAtIGV2ZW50LnBhZ2VZKVxyXG5cdFx0XHQpID49IHRoaXMub3B0aW9ucy5kaXN0YW5jZVxyXG5cdFx0KTtcclxuXHR9LFxyXG5cclxuXHRfbW91c2VEZWxheU1ldDogZnVuY3Rpb24oLyogZXZlbnQgKi8pIHtcclxuXHRcdHJldHVybiB0aGlzLm1vdXNlRGVsYXlNZXQ7XHJcblx0fSxcclxuXHJcblx0Ly8gVGhlc2UgYXJlIHBsYWNlaG9sZGVyIG1ldGhvZHMsIHRvIGJlIG92ZXJyaWRlbiBieSBleHRlbmRpbmcgcGx1Z2luXHJcblx0X21vdXNlU3RhcnQ6IGZ1bmN0aW9uKC8qIGV2ZW50ICovKSB7fSxcclxuXHRfbW91c2VEcmFnOiBmdW5jdGlvbigvKiBldmVudCAqLykge30sXHJcblx0X21vdXNlU3RvcDogZnVuY3Rpb24oLyogZXZlbnQgKi8pIHt9LFxyXG5cdF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKC8qIGV2ZW50ICovKSB7IHJldHVybiB0cnVlOyB9XHJcbn0pO1xyXG5cclxuXHJcbi8qIVxyXG4gKiBqUXVlcnkgVUkgRHJhZ2dhYmxlIDEuMTEuNFxyXG4gKiBodHRwOi8vanF1ZXJ5dWkuY29tXHJcbiAqXHJcbiAqIENvcHlyaWdodCBqUXVlcnkgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzXHJcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cclxuICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZVxyXG4gKlxyXG4gKiBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9kcmFnZ2FibGUvXHJcbiAqL1xyXG5cclxuXHJcbiQud2lkZ2V0KFwidWkuZHJhZ2dhYmxlXCIsICQudWkubW91c2UsIHtcclxuXHR2ZXJzaW9uOiBcIjEuMTEuNFwiLFxyXG5cdHdpZGdldEV2ZW50UHJlZml4OiBcImRyYWdcIixcclxuXHRvcHRpb25zOiB7XHJcblx0XHRhZGRDbGFzc2VzOiB0cnVlLFxyXG5cdFx0YXBwZW5kVG86IFwicGFyZW50XCIsXHJcblx0XHRheGlzOiBmYWxzZSxcclxuXHRcdGNvbm5lY3RUb1NvcnRhYmxlOiBmYWxzZSxcclxuXHRcdGNvbnRhaW5tZW50OiBmYWxzZSxcclxuXHRcdGN1cnNvcjogXCJhdXRvXCIsXHJcblx0XHRjdXJzb3JBdDogZmFsc2UsXHJcblx0XHRncmlkOiBmYWxzZSxcclxuXHRcdGhhbmRsZTogZmFsc2UsXHJcblx0XHRoZWxwZXI6IFwib3JpZ2luYWxcIixcclxuXHRcdGlmcmFtZUZpeDogZmFsc2UsXHJcblx0XHRvcGFjaXR5OiBmYWxzZSxcclxuXHRcdHJlZnJlc2hQb3NpdGlvbnM6IGZhbHNlLFxyXG5cdFx0cmV2ZXJ0OiBmYWxzZSxcclxuXHRcdHJldmVydER1cmF0aW9uOiA1MDAsXHJcblx0XHRzY29wZTogXCJkZWZhdWx0XCIsXHJcblx0XHRzY3JvbGw6IHRydWUsXHJcblx0XHRzY3JvbGxTZW5zaXRpdml0eTogMjAsXHJcblx0XHRzY3JvbGxTcGVlZDogMjAsXHJcblx0XHRzbmFwOiBmYWxzZSxcclxuXHRcdHNuYXBNb2RlOiBcImJvdGhcIixcclxuXHRcdHNuYXBUb2xlcmFuY2U6IDIwLFxyXG5cdFx0c3RhY2s6IGZhbHNlLFxyXG5cdFx0ekluZGV4OiBmYWxzZSxcclxuXHJcblx0XHQvLyBjYWxsYmFja3NcclxuXHRcdGRyYWc6IG51bGwsXHJcblx0XHRzdGFydDogbnVsbCxcclxuXHRcdHN0b3A6IG51bGxcclxuXHR9LFxyXG5cdF9jcmVhdGU6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdGlmICggdGhpcy5vcHRpb25zLmhlbHBlciA9PT0gXCJvcmlnaW5hbFwiICkge1xyXG5cdFx0XHR0aGlzLl9zZXRQb3NpdGlvblJlbGF0aXZlKCk7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5vcHRpb25zLmFkZENsYXNzZXMpe1xyXG5cdFx0XHR0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJ1aS1kcmFnZ2FibGVcIik7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5vcHRpb25zLmRpc2FibGVkKXtcclxuXHRcdFx0dGhpcy5lbGVtZW50LmFkZENsYXNzKFwidWktZHJhZ2dhYmxlLWRpc2FibGVkXCIpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCk7XHJcblxyXG5cdFx0dGhpcy5fbW91c2VJbml0KCk7XHJcblx0fSxcclxuXHJcblx0X3NldE9wdGlvbjogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7XHJcblx0XHR0aGlzLl9zdXBlcigga2V5LCB2YWx1ZSApO1xyXG5cdFx0aWYgKCBrZXkgPT09IFwiaGFuZGxlXCIgKSB7XHJcblx0XHRcdHRoaXMuX3JlbW92ZUhhbmRsZUNsYXNzTmFtZSgpO1xyXG5cdFx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoICggdGhpcy5oZWxwZXIgfHwgdGhpcy5lbGVtZW50ICkuaXMoIFwiLnVpLWRyYWdnYWJsZS1kcmFnZ2luZ1wiICkgKSB7XHJcblx0XHRcdHRoaXMuZGVzdHJveU9uQ2xlYXIgPSB0cnVlO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoIFwidWktZHJhZ2dhYmxlIHVpLWRyYWdnYWJsZS1kcmFnZ2luZyB1aS1kcmFnZ2FibGUtZGlzYWJsZWRcIiApO1xyXG5cdFx0dGhpcy5fcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lKCk7XHJcblx0XHR0aGlzLl9tb3VzZURlc3Ryb3koKTtcclxuXHR9LFxyXG5cclxuXHRfbW91c2VDYXB0dXJlOiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0dmFyIG8gPSB0aGlzLm9wdGlvbnM7XHJcblxyXG5cdFx0dGhpcy5fYmx1ckFjdGl2ZUVsZW1lbnQoIGV2ZW50ICk7XHJcblxyXG5cdFx0Ly8gYW1vbmcgb3RoZXJzLCBwcmV2ZW50IGEgZHJhZyBvbiBhIHJlc2l6YWJsZS1oYW5kbGVcclxuXHRcdGlmICh0aGlzLmhlbHBlciB8fCBvLmRpc2FibGVkIHx8ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KFwiLnVpLXJlc2l6YWJsZS1oYW5kbGVcIikubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9RdWl0IGlmIHdlJ3JlIG5vdCBvbiBhIHZhbGlkIGhhbmRsZVxyXG5cdFx0dGhpcy5oYW5kbGUgPSB0aGlzLl9nZXRIYW5kbGUoZXZlbnQpO1xyXG5cdFx0aWYgKCF0aGlzLmhhbmRsZSkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fYmxvY2tGcmFtZXMoIG8uaWZyYW1lRml4ID09PSB0cnVlID8gXCJpZnJhbWVcIiA6IG8uaWZyYW1lRml4ICk7XHJcblxyXG5cdFx0cmV0dXJuIHRydWU7XHJcblxyXG5cdH0sXHJcblxyXG5cdF9ibG9ja0ZyYW1lczogZnVuY3Rpb24oIHNlbGVjdG9yICkge1xyXG5cdFx0dGhpcy5pZnJhbWVCbG9ja3MgPSB0aGlzLmRvY3VtZW50LmZpbmQoIHNlbGVjdG9yICkubWFwKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgaWZyYW1lID0gJCggdGhpcyApO1xyXG5cclxuXHRcdFx0cmV0dXJuICQoIFwiPGRpdj5cIiApXHJcblx0XHRcdFx0LmNzcyggXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIgKVxyXG5cdFx0XHRcdC5hcHBlbmRUbyggaWZyYW1lLnBhcmVudCgpIClcclxuXHRcdFx0XHQub3V0ZXJXaWR0aCggaWZyYW1lLm91dGVyV2lkdGgoKSApXHJcblx0XHRcdFx0Lm91dGVySGVpZ2h0KCBpZnJhbWUub3V0ZXJIZWlnaHQoKSApXHJcblx0XHRcdFx0Lm9mZnNldCggaWZyYW1lLm9mZnNldCgpIClbIDAgXTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdF91bmJsb2NrRnJhbWVzOiBmdW5jdGlvbigpIHtcclxuXHRcdGlmICggdGhpcy5pZnJhbWVCbG9ja3MgKSB7XHJcblx0XHRcdHRoaXMuaWZyYW1lQmxvY2tzLnJlbW92ZSgpO1xyXG5cdFx0XHRkZWxldGUgdGhpcy5pZnJhbWVCbG9ja3M7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2JsdXJBY3RpdmVFbGVtZW50OiBmdW5jdGlvbiggZXZlbnQgKSB7XHJcblx0XHR2YXIgZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF07XHJcblxyXG5cdFx0Ly8gT25seSBuZWVkIHRvIGJsdXIgaWYgdGhlIGV2ZW50IG9jY3VycmVkIG9uIHRoZSBkcmFnZ2FibGUgaXRzZWxmLCBzZWUgIzEwNTI3XHJcblx0XHRpZiAoICF0aGlzLmhhbmRsZUVsZW1lbnQuaXMoIGV2ZW50LnRhcmdldCApICkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gc3VwcG9ydDogSUU5XHJcblx0XHQvLyBJRTkgdGhyb3dzIGFuIFwiVW5zcGVjaWZpZWQgZXJyb3JcIiBhY2Nlc3NpbmcgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBmcm9tIGFuIDxpZnJhbWU+XHJcblx0XHR0cnkge1xyXG5cclxuXHRcdFx0Ly8gU3VwcG9ydDogSUU5LCBJRTEwXHJcblx0XHRcdC8vIElmIHRoZSA8Ym9keT4gaXMgYmx1cnJlZCwgSUUgd2lsbCBzd2l0Y2ggd2luZG93cywgc2VlICM5NTIwXHJcblx0XHRcdGlmICggZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09IFwiYm9keVwiICkge1xyXG5cclxuXHRcdFx0XHQvLyBCbHVyIGFueSBlbGVtZW50IHRoYXQgY3VycmVudGx5IGhhcyBmb2N1cywgc2VlICM0MjYxXHJcblx0XHRcdFx0JCggZG9jdW1lbnQuYWN0aXZlRWxlbWVudCApLmJsdXIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCAoIGVycm9yICkge31cclxuXHR9LFxyXG5cclxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHR2YXIgbyA9IHRoaXMub3B0aW9ucztcclxuXHJcblx0XHQvL0NyZWF0ZSBhbmQgYXBwZW5kIHRoZSB2aXNpYmxlIGhlbHBlclxyXG5cdFx0dGhpcy5oZWxwZXIgPSB0aGlzLl9jcmVhdGVIZWxwZXIoZXZlbnQpO1xyXG5cclxuXHRcdHRoaXMuaGVscGVyLmFkZENsYXNzKFwidWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIpO1xyXG5cclxuXHRcdC8vQ2FjaGUgdGhlIGhlbHBlciBzaXplXHJcblx0XHR0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XHJcblxyXG5cdFx0Ly9JZiBkZG1hbmFnZXIgaXMgdXNlZCBmb3IgZHJvcHBhYmxlcywgc2V0IHRoZSBnbG9iYWwgZHJhZ2dhYmxlXHJcblx0XHRpZiAoJC51aS5kZG1hbmFnZXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIuY3VycmVudCA9IHRoaXM7XHJcblx0XHR9XHJcblxyXG5cdFx0LypcclxuXHRcdCAqIC0gUG9zaXRpb24gZ2VuZXJhdGlvbiAtXHJcblx0XHQgKiBUaGlzIGJsb2NrIGdlbmVyYXRlcyBldmVyeXRoaW5nIHBvc2l0aW9uIHJlbGF0ZWQgLSBpdCdzIHRoZSBjb3JlIG9mIGRyYWdnYWJsZXMuXHJcblx0XHQgKi9cclxuXHJcblx0XHQvL0NhY2hlIHRoZSBtYXJnaW5zIG9mIHRoZSBvcmlnaW5hbCBlbGVtZW50XHJcblx0XHR0aGlzLl9jYWNoZU1hcmdpbnMoKTtcclxuXHJcblx0XHQvL1N0b3JlIHRoZSBoZWxwZXIncyBjc3MgcG9zaXRpb25cclxuXHRcdHRoaXMuY3NzUG9zaXRpb24gPSB0aGlzLmhlbHBlci5jc3MoIFwicG9zaXRpb25cIiApO1xyXG5cdFx0dGhpcy5zY3JvbGxQYXJlbnQgPSB0aGlzLmhlbHBlci5zY3JvbGxQYXJlbnQoIHRydWUgKTtcclxuXHRcdHRoaXMub2Zmc2V0UGFyZW50ID0gdGhpcy5oZWxwZXIub2Zmc2V0UGFyZW50KCk7XHJcblx0XHR0aGlzLmhhc0ZpeGVkQW5jZXN0b3IgPSB0aGlzLmhlbHBlci5wYXJlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiAkKCB0aGlzICkuY3NzKCBcInBvc2l0aW9uXCIgKSA9PT0gXCJmaXhlZFwiO1xyXG5cdFx0XHR9KS5sZW5ndGggPiAwO1xyXG5cclxuXHRcdC8vVGhlIGVsZW1lbnQncyBhYnNvbHV0ZSBwb3NpdGlvbiBvbiB0aGUgcGFnZSBtaW51cyBtYXJnaW5zXHJcblx0XHR0aGlzLnBvc2l0aW9uQWJzID0gdGhpcy5lbGVtZW50Lm9mZnNldCgpO1xyXG5cdFx0dGhpcy5fcmVmcmVzaE9mZnNldHMoIGV2ZW50ICk7XHJcblxyXG5cdFx0Ly9HZW5lcmF0ZSB0aGUgb3JpZ2luYWwgcG9zaXRpb25cclxuXHRcdHRoaXMub3JpZ2luYWxQb3NpdGlvbiA9IHRoaXMucG9zaXRpb24gPSB0aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKCBldmVudCwgZmFsc2UgKTtcclxuXHRcdHRoaXMub3JpZ2luYWxQYWdlWCA9IGV2ZW50LnBhZ2VYO1xyXG5cdFx0dGhpcy5vcmlnaW5hbFBhZ2VZID0gZXZlbnQucGFnZVk7XHJcblxyXG5cdFx0Ly9BZGp1c3QgdGhlIG1vdXNlIG9mZnNldCByZWxhdGl2ZSB0byB0aGUgaGVscGVyIGlmIFwiY3Vyc29yQXRcIiBpcyBzdXBwbGllZFxyXG5cdFx0KG8uY3Vyc29yQXQgJiYgdGhpcy5fYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcihvLmN1cnNvckF0KSk7XHJcblxyXG5cdFx0Ly9TZXQgYSBjb250YWlubWVudCBpZiBnaXZlbiBpbiB0aGUgb3B0aW9uc1xyXG5cdFx0dGhpcy5fc2V0Q29udGFpbm1lbnQoKTtcclxuXHJcblx0XHQvL1RyaWdnZXIgZXZlbnQgKyBjYWxsYmFja3NcclxuXHRcdGlmICh0aGlzLl90cmlnZ2VyKFwic3RhcnRcIiwgZXZlbnQpID09PSBmYWxzZSkge1xyXG5cdFx0XHR0aGlzLl9jbGVhcigpO1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9SZWNhY2hlIHRoZSBoZWxwZXIgc2l6ZVxyXG5cdFx0dGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpO1xyXG5cclxuXHRcdC8vUHJlcGFyZSB0aGUgZHJvcHBhYmxlIG9mZnNldHNcclxuXHRcdGlmICgkLnVpLmRkbWFuYWdlciAmJiAhby5kcm9wQmVoYXZpb3VyKSB7XHJcblx0XHRcdCQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKHRoaXMsIGV2ZW50KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBSZXNldCBoZWxwZXIncyByaWdodC9ib3R0b20gY3NzIGlmIHRoZXkncmUgc2V0IGFuZCBzZXQgZXhwbGljaXQgd2lkdGgvaGVpZ2h0IGluc3RlYWRcclxuXHRcdC8vIGFzIHRoaXMgcHJldmVudHMgcmVzaXppbmcgb2YgZWxlbWVudHMgd2l0aCByaWdodC9ib3R0b20gc2V0IChzZWUgIzc3NzIpXHJcblx0XHR0aGlzLl9ub3JtYWxpemVSaWdodEJvdHRvbSgpO1xyXG5cclxuXHRcdHRoaXMuX21vdXNlRHJhZyhldmVudCwgdHJ1ZSk7IC8vRXhlY3V0ZSB0aGUgZHJhZyBvbmNlIC0gdGhpcyBjYXVzZXMgdGhlIGhlbHBlciBub3QgdG8gYmUgdmlzaWJsZSBiZWZvcmUgZ2V0dGluZyBpdHMgY29ycmVjdCBwb3NpdGlvblxyXG5cclxuXHRcdC8vSWYgdGhlIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgdGhhdCBkcmFnZ2luZyBoYXMgc3RhcnRlZCAoc2VlICM1MDAzKVxyXG5cdFx0aWYgKCAkLnVpLmRkbWFuYWdlciApIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJhZ1N0YXJ0KHRoaXMsIGV2ZW50KTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9LFxyXG5cclxuXHRfcmVmcmVzaE9mZnNldHM6IGZ1bmN0aW9uKCBldmVudCApIHtcclxuXHRcdHRoaXMub2Zmc2V0ID0ge1xyXG5cdFx0XHR0b3A6IHRoaXMucG9zaXRpb25BYnMudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCxcclxuXHRcdFx0bGVmdDogdGhpcy5wb3NpdGlvbkFicy5sZWZ0IC0gdGhpcy5tYXJnaW5zLmxlZnQsXHJcblx0XHRcdHNjcm9sbDogZmFsc2UsXHJcblx0XHRcdHBhcmVudDogdGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCksXHJcblx0XHRcdHJlbGF0aXZlOiB0aGlzLl9nZXRSZWxhdGl2ZU9mZnNldCgpXHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMub2Zmc2V0LmNsaWNrID0ge1xyXG5cdFx0XHRsZWZ0OiBldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmxlZnQsXHJcblx0XHRcdHRvcDogZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC50b3BcclxuXHRcdH07XHJcblx0fSxcclxuXHJcblx0X21vdXNlRHJhZzogZnVuY3Rpb24oZXZlbnQsIG5vUHJvcGFnYXRpb24pIHtcclxuXHRcdC8vIHJlc2V0IGFueSBuZWNlc3NhcnkgY2FjaGVkIHByb3BlcnRpZXMgKHNlZSAjNTAwOSlcclxuXHRcdGlmICggdGhpcy5oYXNGaXhlZEFuY2VzdG9yICkge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQgPSB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvL0NvbXB1dGUgdGhlIGhlbHBlcnMgcG9zaXRpb25cclxuXHRcdHRoaXMucG9zaXRpb24gPSB0aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKCBldmVudCwgdHJ1ZSApO1xyXG5cdFx0dGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKFwiYWJzb2x1dGVcIik7XHJcblxyXG5cdFx0Ly9DYWxsIHBsdWdpbnMgYW5kIGNhbGxiYWNrcyBhbmQgdXNlIHRoZSByZXN1bHRpbmcgcG9zaXRpb24gaWYgc29tZXRoaW5nIGlzIHJldHVybmVkXHJcblx0XHRpZiAoIW5vUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0dmFyIHVpID0gdGhpcy5fdWlIYXNoKCk7XHJcblx0XHRcdGlmICh0aGlzLl90cmlnZ2VyKFwiZHJhZ1wiLCBldmVudCwgdWkpID09PSBmYWxzZSkge1xyXG5cdFx0XHRcdHRoaXMuX21vdXNlVXAoe30pO1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLnBvc2l0aW9uID0gdWkucG9zaXRpb247XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5oZWxwZXJbIDAgXS5zdHlsZS5sZWZ0ID0gdGhpcy5wb3NpdGlvbi5sZWZ0ICsgXCJweFwiO1xyXG5cdFx0dGhpcy5oZWxwZXJbIDAgXS5zdHlsZS50b3AgPSB0aGlzLnBvc2l0aW9uLnRvcCArIFwicHhcIjtcclxuXHJcblx0XHRpZiAoJC51aS5kZG1hbmFnZXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJhZyh0aGlzLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblxyXG5cdF9tb3VzZVN0b3A6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0Ly9JZiB3ZSBhcmUgdXNpbmcgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIGFib3V0IHRoZSBkcm9wXHJcblx0XHR2YXIgdGhhdCA9IHRoaXMsXHJcblx0XHRcdGRyb3BwZWQgPSBmYWxzZTtcclxuXHRcdGlmICgkLnVpLmRkbWFuYWdlciAmJiAhdGhpcy5vcHRpb25zLmRyb3BCZWhhdmlvdXIpIHtcclxuXHRcdFx0ZHJvcHBlZCA9ICQudWkuZGRtYW5hZ2VyLmRyb3AodGhpcywgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vaWYgYSBkcm9wIGNvbWVzIGZyb20gb3V0c2lkZSAoYSBzb3J0YWJsZSlcclxuXHRcdGlmICh0aGlzLmRyb3BwZWQpIHtcclxuXHRcdFx0ZHJvcHBlZCA9IHRoaXMuZHJvcHBlZDtcclxuXHRcdFx0dGhpcy5kcm9wcGVkID0gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCh0aGlzLm9wdGlvbnMucmV2ZXJ0ID09PSBcImludmFsaWRcIiAmJiAhZHJvcHBlZCkgfHwgKHRoaXMub3B0aW9ucy5yZXZlcnQgPT09IFwidmFsaWRcIiAmJiBkcm9wcGVkKSB8fCB0aGlzLm9wdGlvbnMucmV2ZXJ0ID09PSB0cnVlIHx8ICgkLmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLnJldmVydCkgJiYgdGhpcy5vcHRpb25zLnJldmVydC5jYWxsKHRoaXMuZWxlbWVudCwgZHJvcHBlZCkpKSB7XHJcblx0XHRcdCQodGhpcy5oZWxwZXIpLmFuaW1hdGUodGhpcy5vcmlnaW5hbFBvc2l0aW9uLCBwYXJzZUludCh0aGlzLm9wdGlvbnMucmV2ZXJ0RHVyYXRpb24sIDEwKSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYgKHRoYXQuX3RyaWdnZXIoXCJzdG9wXCIsIGV2ZW50KSAhPT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdHRoYXQuX2NsZWFyKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmICh0aGlzLl90cmlnZ2VyKFwic3RvcFwiLCBldmVudCkgIT09IGZhbHNlKSB7XHJcblx0XHRcdFx0dGhpcy5fY2xlYXIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9LFxyXG5cclxuXHRfbW91c2VVcDogZnVuY3Rpb24oIGV2ZW50ICkge1xyXG5cdFx0dGhpcy5fdW5ibG9ja0ZyYW1lcygpO1xyXG5cclxuXHRcdC8vSWYgdGhlIGRkbWFuYWdlciBpcyB1c2VkIGZvciBkcm9wcGFibGVzLCBpbmZvcm0gdGhlIG1hbmFnZXIgdGhhdCBkcmFnZ2luZyBoYXMgc3RvcHBlZCAoc2VlICM1MDAzKVxyXG5cdFx0aWYgKCAkLnVpLmRkbWFuYWdlciApIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIuZHJhZ1N0b3AodGhpcywgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIE9ubHkgbmVlZCB0byBmb2N1cyBpZiB0aGUgZXZlbnQgb2NjdXJyZWQgb24gdGhlIGRyYWdnYWJsZSBpdHNlbGYsIHNlZSAjMTA1MjdcclxuXHRcdGlmICggdGhpcy5oYW5kbGVFbGVtZW50LmlzKCBldmVudC50YXJnZXQgKSApIHtcclxuXHRcdFx0Ly8gVGhlIGludGVyYWN0aW9uIGlzIG92ZXI7IHdoZXRoZXIgb3Igbm90IHRoZSBjbGljayByZXN1bHRlZCBpbiBhIGRyYWcsIGZvY3VzIHRoZSBlbGVtZW50XHJcblx0XHRcdHRoaXMuZWxlbWVudC5mb2N1cygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiAkLnVpLm1vdXNlLnByb3RvdHlwZS5fbW91c2VVcC5jYWxsKHRoaXMsIGV2ZW50KTtcclxuXHR9LFxyXG5cclxuXHRjYW5jZWw6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdGlmICh0aGlzLmhlbHBlci5pcyhcIi51aS1kcmFnZ2FibGUtZHJhZ2dpbmdcIikpIHtcclxuXHRcdFx0dGhpcy5fbW91c2VVcCh7fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLl9jbGVhcigpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfZ2V0SGFuZGxlOiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0cmV0dXJuIHRoaXMub3B0aW9ucy5oYW5kbGUgP1xyXG5cdFx0XHQhISQoIGV2ZW50LnRhcmdldCApLmNsb3Nlc3QoIHRoaXMuZWxlbWVudC5maW5kKCB0aGlzLm9wdGlvbnMuaGFuZGxlICkgKS5sZW5ndGggOlxyXG5cdFx0XHR0cnVlO1xyXG5cdH0sXHJcblxyXG5cdF9zZXRIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5oYW5kbGVFbGVtZW50ID0gdGhpcy5vcHRpb25zLmhhbmRsZSA/XHJcblx0XHRcdHRoaXMuZWxlbWVudC5maW5kKCB0aGlzLm9wdGlvbnMuaGFuZGxlICkgOiB0aGlzLmVsZW1lbnQ7XHJcblx0XHR0aGlzLmhhbmRsZUVsZW1lbnQuYWRkQ2xhc3MoIFwidWktZHJhZ2dhYmxlLWhhbmRsZVwiICk7XHJcblx0fSxcclxuXHJcblx0X3JlbW92ZUhhbmRsZUNsYXNzTmFtZTogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmhhbmRsZUVsZW1lbnQucmVtb3ZlQ2xhc3MoIFwidWktZHJhZ2dhYmxlLWhhbmRsZVwiICk7XHJcblx0fSxcclxuXHJcblx0X2NyZWF0ZUhlbHBlcjogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHR2YXIgbyA9IHRoaXMub3B0aW9ucyxcclxuXHRcdFx0aGVscGVySXNGdW5jdGlvbiA9ICQuaXNGdW5jdGlvbiggby5oZWxwZXIgKSxcclxuXHRcdFx0aGVscGVyID0gaGVscGVySXNGdW5jdGlvbiA/XHJcblx0XHRcdFx0JCggby5oZWxwZXIuYXBwbHkoIHRoaXMuZWxlbWVudFsgMCBdLCBbIGV2ZW50IF0gKSApIDpcclxuXHRcdFx0XHQoIG8uaGVscGVyID09PSBcImNsb25lXCIgP1xyXG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LmNsb25lKCkucmVtb3ZlQXR0ciggXCJpZFwiICkgOlxyXG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50ICk7XHJcblxyXG5cdFx0aWYgKCFoZWxwZXIucGFyZW50cyhcImJvZHlcIikubGVuZ3RoKSB7XHJcblx0XHRcdGhlbHBlci5hcHBlbmRUbygoby5hcHBlbmRUbyA9PT0gXCJwYXJlbnRcIiA/IHRoaXMuZWxlbWVudFswXS5wYXJlbnROb2RlIDogby5hcHBlbmRUbykpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGh0dHA6Ly9idWdzLmpxdWVyeXVpLmNvbS90aWNrZXQvOTQ0NlxyXG5cdFx0Ly8gYSBoZWxwZXIgZnVuY3Rpb24gY2FuIHJldHVybiB0aGUgb3JpZ2luYWwgZWxlbWVudFxyXG5cdFx0Ly8gd2hpY2ggd291bGRuJ3QgaGF2ZSBiZWVuIHNldCB0byByZWxhdGl2ZSBpbiBfY3JlYXRlXHJcblx0XHRpZiAoIGhlbHBlcklzRnVuY3Rpb24gJiYgaGVscGVyWyAwIF0gPT09IHRoaXMuZWxlbWVudFsgMCBdICkge1xyXG5cdFx0XHR0aGlzLl9zZXRQb3NpdGlvblJlbGF0aXZlKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGhlbHBlclswXSAhPT0gdGhpcy5lbGVtZW50WzBdICYmICEoLyhmaXhlZHxhYnNvbHV0ZSkvKS50ZXN0KGhlbHBlci5jc3MoXCJwb3NpdGlvblwiKSkpIHtcclxuXHRcdFx0aGVscGVyLmNzcyhcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGhlbHBlcjtcclxuXHJcblx0fSxcclxuXHJcblx0X3NldFBvc2l0aW9uUmVsYXRpdmU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKCAhKCAvXig/OnJ8YXxmKS8gKS50ZXN0KCB0aGlzLmVsZW1lbnQuY3NzKCBcInBvc2l0aW9uXCIgKSApICkge1xyXG5cdFx0XHR0aGlzLmVsZW1lbnRbIDAgXS5zdHlsZS5wb3NpdGlvbiA9IFwicmVsYXRpdmVcIjtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcjogZnVuY3Rpb24ob2JqKSB7XHJcblx0XHRpZiAodHlwZW9mIG9iaiA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHRvYmogPSBvYmouc3BsaXQoXCIgXCIpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCQuaXNBcnJheShvYmopKSB7XHJcblx0XHRcdG9iaiA9IHsgbGVmdDogK29ialswXSwgdG9wOiArb2JqWzFdIHx8IDAgfTtcclxuXHRcdH1cclxuXHRcdGlmIChcImxlZnRcIiBpbiBvYmopIHtcclxuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2subGVmdCA9IG9iai5sZWZ0ICsgdGhpcy5tYXJnaW5zLmxlZnQ7XHJcblx0XHR9XHJcblx0XHRpZiAoXCJyaWdodFwiIGluIG9iaikge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay5sZWZ0ID0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIG9iai5yaWdodCArIHRoaXMubWFyZ2lucy5sZWZ0O1xyXG5cdFx0fVxyXG5cdFx0aWYgKFwidG9wXCIgaW4gb2JqKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IG9iai50b3AgKyB0aGlzLm1hcmdpbnMudG9wO1xyXG5cdFx0fVxyXG5cdFx0aWYgKFwiYm90dG9tXCIgaW4gb2JqKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA9IHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gb2JqLmJvdHRvbSArIHRoaXMubWFyZ2lucy50b3A7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcblx0X2lzUm9vdE5vZGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xyXG5cdFx0cmV0dXJuICggLyhodG1sfGJvZHkpL2kgKS50ZXN0KCBlbGVtZW50LnRhZ05hbWUgKSB8fCBlbGVtZW50ID09PSB0aGlzLmRvY3VtZW50WyAwIF07XHJcblx0fSxcclxuXHJcblx0X2dldFBhcmVudE9mZnNldDogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0Ly9HZXQgdGhlIG9mZnNldFBhcmVudCBhbmQgY2FjaGUgaXRzIHBvc2l0aW9uXHJcblx0XHR2YXIgcG8gPSB0aGlzLm9mZnNldFBhcmVudC5vZmZzZXQoKSxcclxuXHRcdFx0ZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50WyAwIF07XHJcblxyXG5cdFx0Ly8gVGhpcyBpcyBhIHNwZWNpYWwgY2FzZSB3aGVyZSB3ZSBuZWVkIHRvIG1vZGlmeSBhIG9mZnNldCBjYWxjdWxhdGVkIG9uIHN0YXJ0LCBzaW5jZSB0aGUgZm9sbG93aW5nIGhhcHBlbmVkOlxyXG5cdFx0Ly8gMS4gVGhlIHBvc2l0aW9uIG9mIHRoZSBoZWxwZXIgaXMgYWJzb2x1dGUsIHNvIGl0J3MgcG9zaXRpb24gaXMgY2FsY3VsYXRlZCBiYXNlZCBvbiB0aGUgbmV4dCBwb3NpdGlvbmVkIHBhcmVudFxyXG5cdFx0Ly8gMi4gVGhlIGFjdHVhbCBvZmZzZXQgcGFyZW50IGlzIGEgY2hpbGQgb2YgdGhlIHNjcm9sbCBwYXJlbnQsIGFuZCB0aGUgc2Nyb2xsIHBhcmVudCBpc24ndCB0aGUgZG9jdW1lbnQsIHdoaWNoIG1lYW5zIHRoYXRcclxuXHRcdC8vICAgIHRoZSBzY3JvbGwgaXMgaW5jbHVkZWQgaW4gdGhlIGluaXRpYWwgY2FsY3VsYXRpb24gb2YgdGhlIG9mZnNldCBvZiB0aGUgcGFyZW50LCBhbmQgbmV2ZXIgcmVjYWxjdWxhdGVkIHVwb24gZHJhZ1xyXG5cdFx0aWYgKHRoaXMuY3NzUG9zaXRpb24gPT09IFwiYWJzb2x1dGVcIiAmJiB0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gZG9jdW1lbnQgJiYgJC5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSwgdGhpcy5vZmZzZXRQYXJlbnRbMF0pKSB7XHJcblx0XHRcdHBvLmxlZnQgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpO1xyXG5cdFx0XHRwby50b3AgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCB0aGlzLl9pc1Jvb3ROb2RlKCB0aGlzLm9mZnNldFBhcmVudFsgMCBdICkgKSB7XHJcblx0XHRcdHBvID0geyB0b3A6IDAsIGxlZnQ6IDAgfTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHR0b3A6IHBvLnRvcCArIChwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoXCJib3JkZXJUb3BXaWR0aFwiKSwgMTApIHx8IDApLFxyXG5cdFx0XHRsZWZ0OiBwby5sZWZ0ICsgKHBhcnNlSW50KHRoaXMub2Zmc2V0UGFyZW50LmNzcyhcImJvcmRlckxlZnRXaWR0aFwiKSwgMTApIHx8IDApXHJcblx0XHR9O1xyXG5cclxuXHR9LFxyXG5cclxuXHRfZ2V0UmVsYXRpdmVPZmZzZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKCB0aGlzLmNzc1Bvc2l0aW9uICE9PSBcInJlbGF0aXZlXCIgKSB7XHJcblx0XHRcdHJldHVybiB7IHRvcDogMCwgbGVmdDogMCB9O1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBwID0gdGhpcy5lbGVtZW50LnBvc2l0aW9uKCksXHJcblx0XHRcdHNjcm9sbElzUm9vdE5vZGUgPSB0aGlzLl9pc1Jvb3ROb2RlKCB0aGlzLnNjcm9sbFBhcmVudFsgMCBdICk7XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0dG9wOiBwLnRvcCAtICggcGFyc2VJbnQodGhpcy5oZWxwZXIuY3NzKCBcInRvcFwiICksIDEwKSB8fCAwICkgKyAoICFzY3JvbGxJc1Jvb3ROb2RlID8gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCkgOiAwICksXHJcblx0XHRcdGxlZnQ6IHAubGVmdCAtICggcGFyc2VJbnQodGhpcy5oZWxwZXIuY3NzKCBcImxlZnRcIiApLCAxMCkgfHwgMCApICsgKCAhc2Nyb2xsSXNSb290Tm9kZSA/IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKSA6IDAgKVxyXG5cdFx0fTtcclxuXHJcblx0fSxcclxuXHJcblx0X2NhY2hlTWFyZ2luczogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLm1hcmdpbnMgPSB7XHJcblx0XHRcdGxlZnQ6IChwYXJzZUludCh0aGlzLmVsZW1lbnQuY3NzKFwibWFyZ2luTGVmdFwiKSwgMTApIHx8IDApLFxyXG5cdFx0XHR0b3A6IChwYXJzZUludCh0aGlzLmVsZW1lbnQuY3NzKFwibWFyZ2luVG9wXCIpLCAxMCkgfHwgMCksXHJcblx0XHRcdHJpZ2h0OiAocGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcyhcIm1hcmdpblJpZ2h0XCIpLCAxMCkgfHwgMCksXHJcblx0XHRcdGJvdHRvbTogKHBhcnNlSW50KHRoaXMuZWxlbWVudC5jc3MoXCJtYXJnaW5Cb3R0b21cIiksIDEwKSB8fCAwKVxyXG5cdFx0fTtcclxuXHR9LFxyXG5cclxuXHRfY2FjaGVIZWxwZXJQcm9wb3J0aW9uczogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zID0ge1xyXG5cdFx0XHR3aWR0aDogdGhpcy5oZWxwZXIub3V0ZXJXaWR0aCgpLFxyXG5cdFx0XHRoZWlnaHQ6IHRoaXMuaGVscGVyLm91dGVySGVpZ2h0KClcclxuXHRcdH07XHJcblx0fSxcclxuXHJcblx0X3NldENvbnRhaW5tZW50OiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHR2YXIgaXNVc2VyU2Nyb2xsYWJsZSwgYywgY2UsXHJcblx0XHRcdG8gPSB0aGlzLm9wdGlvbnMsXHJcblx0XHRcdGRvY3VtZW50ID0gdGhpcy5kb2N1bWVudFsgMCBdO1xyXG5cclxuXHRcdHRoaXMucmVsYXRpdmVDb250YWluZXIgPSBudWxsO1xyXG5cclxuXHRcdGlmICggIW8uY29udGFpbm1lbnQgKSB7XHJcblx0XHRcdHRoaXMuY29udGFpbm1lbnQgPSBudWxsO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50ID09PSBcIndpbmRvd1wiICkge1xyXG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gW1xyXG5cdFx0XHRcdCQoIHdpbmRvdyApLnNjcm9sbExlZnQoKSAtIHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgLSB0aGlzLm9mZnNldC5wYXJlbnQubGVmdCxcclxuXHRcdFx0XHQkKCB3aW5kb3cgKS5zY3JvbGxUb3AoKSAtIHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCAtIHRoaXMub2Zmc2V0LnBhcmVudC50b3AsXHJcblx0XHRcdFx0JCggd2luZG93ICkuc2Nyb2xsTGVmdCgpICsgJCggd2luZG93ICkud2lkdGgoKSAtIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSB0aGlzLm1hcmdpbnMubGVmdCxcclxuXHRcdFx0XHQkKCB3aW5kb3cgKS5zY3JvbGxUb3AoKSArICggJCggd2luZG93ICkuaGVpZ2h0KCkgfHwgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCApIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wXHJcblx0XHRcdF07XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIG8uY29udGFpbm1lbnQgPT09IFwiZG9jdW1lbnRcIikge1xyXG5cdFx0XHR0aGlzLmNvbnRhaW5tZW50ID0gW1xyXG5cdFx0XHRcdDAsXHJcblx0XHRcdFx0MCxcclxuXHRcdFx0XHQkKCBkb2N1bWVudCApLndpZHRoKCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC0gdGhpcy5tYXJnaW5zLmxlZnQsXHJcblx0XHRcdFx0KCAkKCBkb2N1bWVudCApLmhlaWdodCgpIHx8IGRvY3VtZW50LmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHQgKSAtIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC0gdGhpcy5tYXJnaW5zLnRvcFxyXG5cdFx0XHRdO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCBvLmNvbnRhaW5tZW50LmNvbnN0cnVjdG9yID09PSBBcnJheSApIHtcclxuXHRcdFx0dGhpcy5jb250YWlubWVudCA9IG8uY29udGFpbm1lbnQ7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIG8uY29udGFpbm1lbnQgPT09IFwicGFyZW50XCIgKSB7XHJcblx0XHRcdG8uY29udGFpbm1lbnQgPSB0aGlzLmhlbHBlclsgMCBdLnBhcmVudE5vZGU7XHJcblx0XHR9XHJcblxyXG5cdFx0YyA9ICQoIG8uY29udGFpbm1lbnQgKTtcclxuXHRcdGNlID0gY1sgMCBdO1xyXG5cclxuXHRcdGlmICggIWNlICkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0aXNVc2VyU2Nyb2xsYWJsZSA9IC8oc2Nyb2xsfGF1dG8pLy50ZXN0KCBjLmNzcyggXCJvdmVyZmxvd1wiICkgKTtcclxuXHJcblx0XHR0aGlzLmNvbnRhaW5tZW50ID0gW1xyXG5cdFx0XHQoIHBhcnNlSW50KCBjLmNzcyggXCJib3JkZXJMZWZ0V2lkdGhcIiApLCAxMCApIHx8IDAgKSArICggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdMZWZ0XCIgKSwgMTAgKSB8fCAwICksXHJcblx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlclRvcFdpZHRoXCIgKSwgMTAgKSB8fCAwICkgKyAoIHBhcnNlSW50KCBjLmNzcyggXCJwYWRkaW5nVG9wXCIgKSwgMTAgKSB8fCAwICksXHJcblx0XHRcdCggaXNVc2VyU2Nyb2xsYWJsZSA/IE1hdGgubWF4KCBjZS5zY3JvbGxXaWR0aCwgY2Uub2Zmc2V0V2lkdGggKSA6IGNlLm9mZnNldFdpZHRoICkgLVxyXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlclJpZ2h0V2lkdGhcIiApLCAxMCApIHx8IDAgKSAtXHJcblx0XHRcdFx0KCBwYXJzZUludCggYy5jc3MoIFwicGFkZGluZ1JpZ2h0XCIgKSwgMTAgKSB8fCAwICkgLVxyXG5cdFx0XHRcdHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLVxyXG5cdFx0XHRcdHRoaXMubWFyZ2lucy5sZWZ0IC1cclxuXHRcdFx0XHR0aGlzLm1hcmdpbnMucmlnaHQsXHJcblx0XHRcdCggaXNVc2VyU2Nyb2xsYWJsZSA/IE1hdGgubWF4KCBjZS5zY3JvbGxIZWlnaHQsIGNlLm9mZnNldEhlaWdodCApIDogY2Uub2Zmc2V0SGVpZ2h0ICkgLVxyXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcImJvcmRlckJvdHRvbVdpZHRoXCIgKSwgMTAgKSB8fCAwICkgLVxyXG5cdFx0XHRcdCggcGFyc2VJbnQoIGMuY3NzKCBcInBhZGRpbmdCb3R0b21cIiApLCAxMCApIHx8IDAgKSAtXHJcblx0XHRcdFx0dGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLVxyXG5cdFx0XHRcdHRoaXMubWFyZ2lucy50b3AgLVxyXG5cdFx0XHRcdHRoaXMubWFyZ2lucy5ib3R0b21cclxuXHRcdF07XHJcblx0XHR0aGlzLnJlbGF0aXZlQ29udGFpbmVyID0gYztcclxuXHR9LFxyXG5cclxuXHRfY29udmVydFBvc2l0aW9uVG86IGZ1bmN0aW9uKGQsIHBvcykge1xyXG5cclxuXHRcdGlmICghcG9zKSB7XHJcblx0XHRcdHBvcyA9IHRoaXMucG9zaXRpb247XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIG1vZCA9IGQgPT09IFwiYWJzb2x1dGVcIiA/IDEgOiAtMSxcclxuXHRcdFx0c2Nyb2xsSXNSb290Tm9kZSA9IHRoaXMuX2lzUm9vdE5vZGUoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gKTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHR0b3A6IChcclxuXHRcdFx0XHRwb3MudG9wXHQrXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgYWJzb2x1dGUgbW91c2UgcG9zaXRpb25cclxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AgKiBtb2QgK1x0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LnRvcCAqIG1vZCAtXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxyXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCA6ICggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwudG9wICkgKSAqIG1vZClcclxuXHRcdFx0KSxcclxuXHRcdFx0bGVmdDogKFxyXG5cdFx0XHRcdHBvcy5sZWZ0ICtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgKiBtb2QgK1x0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LmxlZnQgKiBtb2RcdC1cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXHJcblx0XHRcdFx0KCAoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLm9mZnNldC5zY3JvbGwubGVmdCA6ICggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwubGVmdCApICkgKiBtb2QpXHJcblx0XHRcdClcclxuXHRcdH07XHJcblxyXG5cdH0sXHJcblxyXG5cdF9nZW5lcmF0ZVBvc2l0aW9uOiBmdW5jdGlvbiggZXZlbnQsIGNvbnN0cmFpblBvc2l0aW9uICkge1xyXG5cclxuXHRcdHZhciBjb250YWlubWVudCwgY28sIHRvcCwgbGVmdCxcclxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcclxuXHRcdFx0c2Nyb2xsSXNSb290Tm9kZSA9IHRoaXMuX2lzUm9vdE5vZGUoIHRoaXMuc2Nyb2xsUGFyZW50WyAwIF0gKSxcclxuXHRcdFx0cGFnZVggPSBldmVudC5wYWdlWCxcclxuXHRcdFx0cGFnZVkgPSBldmVudC5wYWdlWTtcclxuXHJcblx0XHQvLyBDYWNoZSB0aGUgc2Nyb2xsXHJcblx0XHRpZiAoICFzY3JvbGxJc1Jvb3ROb2RlIHx8ICF0aGlzLm9mZnNldC5zY3JvbGwgKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LnNjcm9sbCA9IHtcclxuXHRcdFx0XHR0b3A6IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpLFxyXG5cdFx0XHRcdGxlZnQ6IHRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKVxyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cclxuXHRcdC8qXHJcblx0XHQgKiAtIFBvc2l0aW9uIGNvbnN0cmFpbmluZyAtXHJcblx0XHQgKiBDb25zdHJhaW4gdGhlIHBvc2l0aW9uIHRvIGEgbWl4IG9mIGdyaWQsIGNvbnRhaW5tZW50LlxyXG5cdFx0ICovXHJcblxyXG5cdFx0Ly8gSWYgd2UgYXJlIG5vdCBkcmFnZ2luZyB5ZXQsIHdlIHdvbid0IGNoZWNrIGZvciBvcHRpb25zXHJcblx0XHRpZiAoIGNvbnN0cmFpblBvc2l0aW9uICkge1xyXG5cdFx0XHRpZiAoIHRoaXMuY29udGFpbm1lbnQgKSB7XHJcblx0XHRcdFx0aWYgKCB0aGlzLnJlbGF0aXZlQ29udGFpbmVyICl7XHJcblx0XHRcdFx0XHRjbyA9IHRoaXMucmVsYXRpdmVDb250YWluZXIub2Zmc2V0KCk7XHJcblx0XHRcdFx0XHRjb250YWlubWVudCA9IFtcclxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWlubWVudFsgMCBdICsgY28ubGVmdCxcclxuXHRcdFx0XHRcdFx0dGhpcy5jb250YWlubWVudFsgMSBdICsgY28udG9wLFxyXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAyIF0gKyBjby5sZWZ0LFxyXG5cdFx0XHRcdFx0XHR0aGlzLmNvbnRhaW5tZW50WyAzIF0gKyBjby50b3BcclxuXHRcdFx0XHRcdF07XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGNvbnRhaW5tZW50ID0gdGhpcy5jb250YWlubWVudDtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPCBjb250YWlubWVudFswXSkge1xyXG5cdFx0XHRcdFx0cGFnZVggPSBjb250YWlubWVudFswXSArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8IGNvbnRhaW5tZW50WzFdKSB7XHJcblx0XHRcdFx0XHRwYWdlWSA9IGNvbnRhaW5tZW50WzFdICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID4gY29udGFpbm1lbnRbMl0pIHtcclxuXHRcdFx0XHRcdHBhZ2VYID0gY29udGFpbm1lbnRbMl0gKyB0aGlzLm9mZnNldC5jbGljay5sZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPiBjb250YWlubWVudFszXSkge1xyXG5cdFx0XHRcdFx0cGFnZVkgPSBjb250YWlubWVudFszXSArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChvLmdyaWQpIHtcclxuXHRcdFx0XHQvL0NoZWNrIGZvciBncmlkIGVsZW1lbnRzIHNldCB0byAwIHRvIHByZXZlbnQgZGl2aWRlIGJ5IDAgZXJyb3IgY2F1c2luZyBpbnZhbGlkIGFyZ3VtZW50IGVycm9ycyBpbiBJRSAoc2VlIHRpY2tldCAjNjk1MClcclxuXHRcdFx0XHR0b3AgPSBvLmdyaWRbMV0gPyB0aGlzLm9yaWdpbmFsUGFnZVkgKyBNYXRoLnJvdW5kKChwYWdlWSAtIHRoaXMub3JpZ2luYWxQYWdlWSkgLyBvLmdyaWRbMV0pICogby5ncmlkWzFdIDogdGhpcy5vcmlnaW5hbFBhZ2VZO1xyXG5cdFx0XHRcdHBhZ2VZID0gY29udGFpbm1lbnQgPyAoKHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSBjb250YWlubWVudFsxXSB8fCB0b3AgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPiBjb250YWlubWVudFszXSkgPyB0b3AgOiAoKHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSBjb250YWlubWVudFsxXSkgPyB0b3AgLSBvLmdyaWRbMV0gOiB0b3AgKyBvLmdyaWRbMV0pKSA6IHRvcDtcclxuXHJcblx0XHRcdFx0bGVmdCA9IG8uZ3JpZFswXSA/IHRoaXMub3JpZ2luYWxQYWdlWCArIE1hdGgucm91bmQoKHBhZ2VYIC0gdGhpcy5vcmlnaW5hbFBhZ2VYKSAvIG8uZ3JpZFswXSkgKiBvLmdyaWRbMF0gOiB0aGlzLm9yaWdpbmFsUGFnZVg7XHJcblx0XHRcdFx0cGFnZVggPSBjb250YWlubWVudCA/ICgobGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPj0gY29udGFpbm1lbnRbMF0gfHwgbGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPiBjb250YWlubWVudFsyXSkgPyBsZWZ0IDogKChsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+PSBjb250YWlubWVudFswXSkgPyBsZWZ0IC0gby5ncmlkWzBdIDogbGVmdCArIG8uZ3JpZFswXSkpIDogbGVmdDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCBvLmF4aXMgPT09IFwieVwiICkge1xyXG5cdFx0XHRcdHBhZ2VYID0gdGhpcy5vcmlnaW5hbFBhZ2VYO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIG8uYXhpcyA9PT0gXCJ4XCIgKSB7XHJcblx0XHRcdFx0cGFnZVkgPSB0aGlzLm9yaWdpbmFsUGFnZVk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHR0b3A6IChcclxuXHRcdFx0XHRwYWdlWSAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcFx0LVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENsaWNrIG9mZnNldCAocmVsYXRpdmUgdG8gdGhlIGVsZW1lbnQpXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUudG9wIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQudG9wICtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxyXG5cdFx0XHRcdCggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID8gLXRoaXMub2Zmc2V0LnNjcm9sbC50b3AgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCApIClcclxuXHRcdFx0KSxcclxuXHRcdFx0bGVmdDogKFxyXG5cdFx0XHRcdHBhZ2VYIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2subGVmdCAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gQ2xpY2sgb2Zmc2V0IChyZWxhdGl2ZSB0byB0aGUgZWxlbWVudClcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0IC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCArXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcclxuXHRcdFx0XHQoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLm9mZnNldC5zY3JvbGwubGVmdCA6ICggc2Nyb2xsSXNSb290Tm9kZSA/IDAgOiB0aGlzLm9mZnNldC5zY3JvbGwubGVmdCApIClcclxuXHRcdFx0KVxyXG5cdFx0fTtcclxuXHJcblx0fSxcclxuXHJcblx0X2NsZWFyOiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuaGVscGVyLnJlbW92ZUNsYXNzKFwidWktZHJhZ2dhYmxlLWRyYWdnaW5nXCIpO1xyXG5cdFx0aWYgKHRoaXMuaGVscGVyWzBdICE9PSB0aGlzLmVsZW1lbnRbMF0gJiYgIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCkge1xyXG5cdFx0XHR0aGlzLmhlbHBlci5yZW1vdmUoKTtcclxuXHRcdH1cclxuXHRcdHRoaXMuaGVscGVyID0gbnVsbDtcclxuXHRcdHRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCA9IGZhbHNlO1xyXG5cdFx0aWYgKCB0aGlzLmRlc3Ryb3lPbkNsZWFyICkge1xyXG5cdFx0XHR0aGlzLmRlc3Ryb3koKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfbm9ybWFsaXplUmlnaHRCb3R0b206IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuYXhpcyAhPT0gXCJ5XCIgJiYgdGhpcy5oZWxwZXIuY3NzKCBcInJpZ2h0XCIgKSAhPT0gXCJhdXRvXCIgKSB7XHJcblx0XHRcdHRoaXMuaGVscGVyLndpZHRoKCB0aGlzLmhlbHBlci53aWR0aCgpICk7XHJcblx0XHRcdHRoaXMuaGVscGVyLmNzcyggXCJyaWdodFwiLCBcImF1dG9cIiApO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMuYXhpcyAhPT0gXCJ4XCIgJiYgdGhpcy5oZWxwZXIuY3NzKCBcImJvdHRvbVwiICkgIT09IFwiYXV0b1wiICkge1xyXG5cdFx0XHR0aGlzLmhlbHBlci5oZWlnaHQoIHRoaXMuaGVscGVyLmhlaWdodCgpICk7XHJcblx0XHRcdHRoaXMuaGVscGVyLmNzcyggXCJib3R0b21cIiwgXCJhdXRvXCIgKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHQvLyBGcm9tIG5vdyBvbiBidWxrIHN0dWZmIC0gbWFpbmx5IGhlbHBlcnNcclxuXHJcblx0X3RyaWdnZXI6IGZ1bmN0aW9uKCB0eXBlLCBldmVudCwgdWkgKSB7XHJcblx0XHR1aSA9IHVpIHx8IHRoaXMuX3VpSGFzaCgpO1xyXG5cdFx0JC51aS5wbHVnaW4uY2FsbCggdGhpcywgdHlwZSwgWyBldmVudCwgdWksIHRoaXMgXSwgdHJ1ZSApO1xyXG5cclxuXHRcdC8vIEFic29sdXRlIHBvc2l0aW9uIGFuZCBvZmZzZXQgKHNlZSAjNjg4NCApIGhhdmUgdG8gYmUgcmVjYWxjdWxhdGVkIGFmdGVyIHBsdWdpbnNcclxuXHRcdGlmICggL14oZHJhZ3xzdGFydHxzdG9wKS8udGVzdCggdHlwZSApICkge1xyXG5cdFx0XHR0aGlzLnBvc2l0aW9uQWJzID0gdGhpcy5fY29udmVydFBvc2l0aW9uVG8oIFwiYWJzb2x1dGVcIiApO1xyXG5cdFx0XHR1aS5vZmZzZXQgPSB0aGlzLnBvc2l0aW9uQWJzO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICQuV2lkZ2V0LnByb3RvdHlwZS5fdHJpZ2dlci5jYWxsKCB0aGlzLCB0eXBlLCBldmVudCwgdWkgKTtcclxuXHR9LFxyXG5cclxuXHRwbHVnaW5zOiB7fSxcclxuXHJcblx0X3VpSGFzaDogZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRoZWxwZXI6IHRoaXMuaGVscGVyLFxyXG5cdFx0XHRwb3NpdGlvbjogdGhpcy5wb3NpdGlvbixcclxuXHRcdFx0b3JpZ2luYWxQb3NpdGlvbjogdGhpcy5vcmlnaW5hbFBvc2l0aW9uLFxyXG5cdFx0XHRvZmZzZXQ6IHRoaXMucG9zaXRpb25BYnNcclxuXHRcdH07XHJcblx0fVxyXG5cclxufSk7XHJcblxyXG4kLnVpLnBsdWdpbi5hZGQoIFwiZHJhZ2dhYmxlXCIsIFwiY29ubmVjdFRvU29ydGFibGVcIiwge1xyXG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBkcmFnZ2FibGUgKSB7XHJcblx0XHR2YXIgdWlTb3J0YWJsZSA9ICQuZXh0ZW5kKCB7fSwgdWksIHtcclxuXHRcdFx0aXRlbTogZHJhZ2dhYmxlLmVsZW1lbnRcclxuXHRcdH0pO1xyXG5cclxuXHRcdGRyYWdnYWJsZS5zb3J0YWJsZXMgPSBbXTtcclxuXHRcdCQoIGRyYWdnYWJsZS5vcHRpb25zLmNvbm5lY3RUb1NvcnRhYmxlICkuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIHNvcnRhYmxlID0gJCggdGhpcyApLnNvcnRhYmxlKCBcImluc3RhbmNlXCIgKTtcclxuXHJcblx0XHRcdGlmICggc29ydGFibGUgJiYgIXNvcnRhYmxlLm9wdGlvbnMuZGlzYWJsZWQgKSB7XHJcblx0XHRcdFx0ZHJhZ2dhYmxlLnNvcnRhYmxlcy5wdXNoKCBzb3J0YWJsZSApO1xyXG5cclxuXHRcdFx0XHQvLyByZWZyZXNoUG9zaXRpb25zIGlzIGNhbGxlZCBhdCBkcmFnIHN0YXJ0IHRvIHJlZnJlc2ggdGhlIGNvbnRhaW5lckNhY2hlXHJcblx0XHRcdFx0Ly8gd2hpY2ggaXMgdXNlZCBpbiBkcmFnLiBUaGlzIGVuc3VyZXMgaXQncyBpbml0aWFsaXplZCBhbmQgc3luY2hyb25pemVkXHJcblx0XHRcdFx0Ly8gd2l0aCBhbnkgY2hhbmdlcyB0aGF0IG1pZ2h0IGhhdmUgaGFwcGVuZWQgb24gdGhlIHBhZ2Ugc2luY2UgaW5pdGlhbGl6YXRpb24uXHJcblx0XHRcdFx0c29ydGFibGUucmVmcmVzaFBvc2l0aW9ucygpO1xyXG5cdFx0XHRcdHNvcnRhYmxlLl90cmlnZ2VyKFwiYWN0aXZhdGVcIiwgZXZlbnQsIHVpU29ydGFibGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcclxuXHRcdHZhciB1aVNvcnRhYmxlID0gJC5leHRlbmQoIHt9LCB1aSwge1xyXG5cdFx0XHRpdGVtOiBkcmFnZ2FibGUuZWxlbWVudFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0ZHJhZ2dhYmxlLmNhbmNlbEhlbHBlclJlbW92YWwgPSBmYWxzZTtcclxuXHJcblx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgc29ydGFibGUgPSB0aGlzO1xyXG5cclxuXHRcdFx0aWYgKCBzb3J0YWJsZS5pc092ZXIgKSB7XHJcblx0XHRcdFx0c29ydGFibGUuaXNPdmVyID0gMDtcclxuXHJcblx0XHRcdFx0Ly8gQWxsb3cgdGhpcyBzb3J0YWJsZSB0byBoYW5kbGUgcmVtb3ZpbmcgdGhlIGhlbHBlclxyXG5cdFx0XHRcdGRyYWdnYWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gdHJ1ZTtcclxuXHRcdFx0XHRzb3J0YWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gZmFsc2U7XHJcblxyXG5cdFx0XHRcdC8vIFVzZSBfc3RvcmVkQ1NTIFRvIHJlc3RvcmUgcHJvcGVydGllcyBpbiB0aGUgc29ydGFibGUsXHJcblx0XHRcdFx0Ly8gYXMgdGhpcyBhbHNvIGhhbmRsZXMgcmV2ZXJ0ICgjOTY3NSkgc2luY2UgdGhlIGRyYWdnYWJsZVxyXG5cdFx0XHRcdC8vIG1heSBoYXZlIG1vZGlmaWVkIHRoZW0gaW4gdW5leHBlY3RlZCB3YXlzICgjODgwOSlcclxuXHRcdFx0XHRzb3J0YWJsZS5fc3RvcmVkQ1NTID0ge1xyXG5cdFx0XHRcdFx0cG9zaXRpb246IHNvcnRhYmxlLnBsYWNlaG9sZGVyLmNzcyggXCJwb3NpdGlvblwiICksXHJcblx0XHRcdFx0XHR0b3A6IHNvcnRhYmxlLnBsYWNlaG9sZGVyLmNzcyggXCJ0b3BcIiApLFxyXG5cdFx0XHRcdFx0bGVmdDogc29ydGFibGUucGxhY2Vob2xkZXIuY3NzKCBcImxlZnRcIiApXHJcblx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0c29ydGFibGUuX21vdXNlU3RvcChldmVudCk7XHJcblxyXG5cdFx0XHRcdC8vIE9uY2UgZHJhZyBoYXMgZW5kZWQsIHRoZSBzb3J0YWJsZSBzaG91bGQgcmV0dXJuIHRvIHVzaW5nXHJcblx0XHRcdFx0Ly8gaXRzIG9yaWdpbmFsIGhlbHBlciwgbm90IHRoZSBzaGFyZWQgaGVscGVyIGZyb20gZHJhZ2dhYmxlXHJcblx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5oZWxwZXIgPSBzb3J0YWJsZS5vcHRpb25zLl9oZWxwZXI7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gUHJldmVudCB0aGlzIFNvcnRhYmxlIGZyb20gcmVtb3ZpbmcgdGhlIGhlbHBlci5cclxuXHRcdFx0XHQvLyBIb3dldmVyLCBkb24ndCBzZXQgdGhlIGRyYWdnYWJsZSB0byByZW1vdmUgdGhlIGhlbHBlclxyXG5cdFx0XHRcdC8vIGVpdGhlciBhcyBhbm90aGVyIGNvbm5lY3RlZCBTb3J0YWJsZSBtYXkgeWV0IGhhbmRsZSB0aGUgcmVtb3ZhbC5cclxuXHRcdFx0XHRzb3J0YWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0c29ydGFibGUuX3RyaWdnZXIoIFwiZGVhY3RpdmF0ZVwiLCBldmVudCwgdWlTb3J0YWJsZSApO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGRyYWc6IGZ1bmN0aW9uKCBldmVudCwgdWksIGRyYWdnYWJsZSApIHtcclxuXHRcdCQuZWFjaCggZHJhZ2dhYmxlLnNvcnRhYmxlcywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBpbm5lcm1vc3RJbnRlcnNlY3RpbmcgPSBmYWxzZSxcclxuXHRcdFx0XHRzb3J0YWJsZSA9IHRoaXM7XHJcblxyXG5cdFx0XHQvLyBDb3B5IG92ZXIgdmFyaWFibGVzIHRoYXQgc29ydGFibGUncyBfaW50ZXJzZWN0c1dpdGggdXNlc1xyXG5cdFx0XHRzb3J0YWJsZS5wb3NpdGlvbkFicyA9IGRyYWdnYWJsZS5wb3NpdGlvbkFicztcclxuXHRcdFx0c29ydGFibGUuaGVscGVyUHJvcG9ydGlvbnMgPSBkcmFnZ2FibGUuaGVscGVyUHJvcG9ydGlvbnM7XHJcblx0XHRcdHNvcnRhYmxlLm9mZnNldC5jbGljayA9IGRyYWdnYWJsZS5vZmZzZXQuY2xpY2s7XHJcblxyXG5cdFx0XHRpZiAoIHNvcnRhYmxlLl9pbnRlcnNlY3RzV2l0aCggc29ydGFibGUuY29udGFpbmVyQ2FjaGUgKSApIHtcclxuXHRcdFx0XHRpbm5lcm1vc3RJbnRlcnNlY3RpbmcgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHQkLmVhY2goIGRyYWdnYWJsZS5zb3J0YWJsZXMsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQ29weSBvdmVyIHZhcmlhYmxlcyB0aGF0IHNvcnRhYmxlJ3MgX2ludGVyc2VjdHNXaXRoIHVzZXNcclxuXHRcdFx0XHRcdHRoaXMucG9zaXRpb25BYnMgPSBkcmFnZ2FibGUucG9zaXRpb25BYnM7XHJcblx0XHRcdFx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zID0gZHJhZ2dhYmxlLmhlbHBlclByb3BvcnRpb25zO1xyXG5cdFx0XHRcdFx0dGhpcy5vZmZzZXQuY2xpY2sgPSBkcmFnZ2FibGUub2Zmc2V0LmNsaWNrO1xyXG5cclxuXHRcdFx0XHRcdGlmICggdGhpcyAhPT0gc29ydGFibGUgJiZcclxuXHRcdFx0XHRcdFx0XHR0aGlzLl9pbnRlcnNlY3RzV2l0aCggdGhpcy5jb250YWluZXJDYWNoZSApICYmXHJcblx0XHRcdFx0XHRcdFx0JC5jb250YWlucyggc29ydGFibGUuZWxlbWVudFsgMCBdLCB0aGlzLmVsZW1lbnRbIDAgXSApICkge1xyXG5cdFx0XHRcdFx0XHRpbm5lcm1vc3RJbnRlcnNlY3RpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRyZXR1cm4gaW5uZXJtb3N0SW50ZXJzZWN0aW5nO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIGlubmVybW9zdEludGVyc2VjdGluZyApIHtcclxuXHRcdFx0XHQvLyBJZiBpdCBpbnRlcnNlY3RzLCB3ZSB1c2UgYSBsaXR0bGUgaXNPdmVyIHZhcmlhYmxlIGFuZCBzZXQgaXQgb25jZSxcclxuXHRcdFx0XHQvLyBzbyB0aGF0IHRoZSBtb3ZlLWluIHN0dWZmIGdldHMgZmlyZWQgb25seSBvbmNlLlxyXG5cdFx0XHRcdGlmICggIXNvcnRhYmxlLmlzT3ZlciApIHtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLmlzT3ZlciA9IDE7XHJcblxyXG5cdFx0XHRcdFx0Ly8gU3RvcmUgZHJhZ2dhYmxlJ3MgcGFyZW50IGluIGNhc2Ugd2UgbmVlZCB0byByZWFwcGVuZCB0byBpdCBsYXRlci5cclxuXHRcdFx0XHRcdGRyYWdnYWJsZS5fcGFyZW50ID0gdWkuaGVscGVyLnBhcmVudCgpO1xyXG5cclxuXHRcdFx0XHRcdHNvcnRhYmxlLmN1cnJlbnRJdGVtID0gdWkuaGVscGVyXHJcblx0XHRcdFx0XHRcdC5hcHBlbmRUbyggc29ydGFibGUuZWxlbWVudCApXHJcblx0XHRcdFx0XHRcdC5kYXRhKCBcInVpLXNvcnRhYmxlLWl0ZW1cIiwgdHJ1ZSApO1xyXG5cclxuXHRcdFx0XHRcdC8vIFN0b3JlIGhlbHBlciBvcHRpb24gdG8gbGF0ZXIgcmVzdG9yZSBpdFxyXG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5faGVscGVyID0gc29ydGFibGUub3B0aW9ucy5oZWxwZXI7XHJcblxyXG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5oZWxwZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHVpLmhlbHBlclsgMCBdO1xyXG5cdFx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0XHQvLyBGaXJlIHRoZSBzdGFydCBldmVudHMgb2YgdGhlIHNvcnRhYmxlIHdpdGggb3VyIHBhc3NlZCBicm93c2VyIGV2ZW50LFxyXG5cdFx0XHRcdFx0Ly8gYW5kIG91ciBvd24gaGVscGVyIChzbyBpdCBkb2Vzbid0IGNyZWF0ZSBhIG5ldyBvbmUpXHJcblx0XHRcdFx0XHRldmVudC50YXJnZXQgPSBzb3J0YWJsZS5jdXJyZW50SXRlbVsgMCBdO1xyXG5cdFx0XHRcdFx0c29ydGFibGUuX21vdXNlQ2FwdHVyZSggZXZlbnQsIHRydWUgKTtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZVN0YXJ0KCBldmVudCwgdHJ1ZSwgdHJ1ZSApO1xyXG5cclxuXHRcdFx0XHRcdC8vIEJlY2F1c2UgdGhlIGJyb3dzZXIgZXZlbnQgaXMgd2F5IG9mZiB0aGUgbmV3IGFwcGVuZGVkIHBvcnRsZXQsXHJcblx0XHRcdFx0XHQvLyBtb2RpZnkgbmVjZXNzYXJ5IHZhcmlhYmxlcyB0byByZWZsZWN0IHRoZSBjaGFuZ2VzXHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQuY2xpY2sudG9wID0gZHJhZ2dhYmxlLm9mZnNldC5jbGljay50b3A7XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vZmZzZXQuY2xpY2subGVmdCA9IGRyYWdnYWJsZS5vZmZzZXQuY2xpY2subGVmdDtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLm9mZnNldC5wYXJlbnQubGVmdCAtPSBkcmFnZ2FibGUub2Zmc2V0LnBhcmVudC5sZWZ0IC1cclxuXHRcdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LnBhcmVudC5sZWZ0O1xyXG5cdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LnBhcmVudC50b3AgLT0gZHJhZ2dhYmxlLm9mZnNldC5wYXJlbnQudG9wIC1cclxuXHRcdFx0XHRcdFx0c29ydGFibGUub2Zmc2V0LnBhcmVudC50b3A7XHJcblxyXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl90cmlnZ2VyKCBcInRvU29ydGFibGVcIiwgZXZlbnQgKTtcclxuXHJcblx0XHRcdFx0XHQvLyBJbmZvcm0gZHJhZ2dhYmxlIHRoYXQgdGhlIGhlbHBlciBpcyBpbiBhIHZhbGlkIGRyb3Agem9uZSxcclxuXHRcdFx0XHRcdC8vIHVzZWQgc29sZWx5IGluIHRoZSByZXZlcnQgb3B0aW9uIHRvIGhhbmRsZSBcInZhbGlkL2ludmFsaWRcIi5cclxuXHRcdFx0XHRcdGRyYWdnYWJsZS5kcm9wcGVkID0gc29ydGFibGUuZWxlbWVudDtcclxuXHJcblx0XHRcdFx0XHQvLyBOZWVkIHRvIHJlZnJlc2hQb3NpdGlvbnMgb2YgYWxsIHNvcnRhYmxlcyBpbiB0aGUgY2FzZSB0aGF0XHJcblx0XHRcdFx0XHQvLyBhZGRpbmcgdG8gb25lIHNvcnRhYmxlIGNoYW5nZXMgdGhlIGxvY2F0aW9uIG9mIHRoZSBvdGhlciBzb3J0YWJsZXMgKCM5Njc1KVxyXG5cdFx0XHRcdFx0JC5lYWNoKCBkcmFnZ2FibGUuc29ydGFibGVzLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHQvLyBoYWNrIHNvIHJlY2VpdmUvdXBkYXRlIGNhbGxiYWNrcyB3b3JrIChtb3N0bHkpXHJcblx0XHRcdFx0XHRkcmFnZ2FibGUuY3VycmVudEl0ZW0gPSBkcmFnZ2FibGUuZWxlbWVudDtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLmZyb21PdXRzaWRlID0gZHJhZ2dhYmxlO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKCBzb3J0YWJsZS5jdXJyZW50SXRlbSApIHtcclxuXHRcdFx0XHRcdHNvcnRhYmxlLl9tb3VzZURyYWcoIGV2ZW50ICk7XHJcblx0XHRcdFx0XHQvLyBDb3B5IHRoZSBzb3J0YWJsZSdzIHBvc2l0aW9uIGJlY2F1c2UgdGhlIGRyYWdnYWJsZSdzIGNhbiBwb3RlbnRpYWxseSByZWZsZWN0XHJcblx0XHRcdFx0XHQvLyBhIHJlbGF0aXZlIHBvc2l0aW9uLCB3aGlsZSBzb3J0YWJsZSBpcyBhbHdheXMgYWJzb2x1dGUsIHdoaWNoIHRoZSBkcmFnZ2VkXHJcblx0XHRcdFx0XHQvLyBlbGVtZW50IGhhcyBub3cgYmVjb21lLiAoIzg4MDkpXHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbiA9IHNvcnRhYmxlLnBvc2l0aW9uO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBJZiBpdCBkb2Vzbid0IGludGVyc2VjdCB3aXRoIHRoZSBzb3J0YWJsZSwgYW5kIGl0IGludGVyc2VjdGVkIGJlZm9yZSxcclxuXHRcdFx0XHQvLyB3ZSBmYWtlIHRoZSBkcmFnIHN0b3Agb2YgdGhlIHNvcnRhYmxlLCBidXQgbWFrZSBzdXJlIGl0IGRvZXNuJ3QgcmVtb3ZlXHJcblx0XHRcdFx0Ly8gdGhlIGhlbHBlciBieSB1c2luZyBjYW5jZWxIZWxwZXJSZW1vdmFsLlxyXG5cdFx0XHRcdGlmICggc29ydGFibGUuaXNPdmVyICkge1xyXG5cclxuXHRcdFx0XHRcdHNvcnRhYmxlLmlzT3ZlciA9IDA7XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5jYW5jZWxIZWxwZXJSZW1vdmFsID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0XHQvLyBDYWxsaW5nIHNvcnRhYmxlJ3MgbW91c2VTdG9wIHdvdWxkIHRyaWdnZXIgYSByZXZlcnQsXHJcblx0XHRcdFx0XHQvLyBzbyByZXZlcnQgbXVzdCBiZSB0ZW1wb3JhcmlseSBmYWxzZSB1bnRpbCBhZnRlciBtb3VzZVN0b3AgaXMgY2FsbGVkLlxyXG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5fcmV2ZXJ0ID0gc29ydGFibGUub3B0aW9ucy5yZXZlcnQ7XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLnJldmVydCA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHRcdHNvcnRhYmxlLl90cmlnZ2VyKCBcIm91dFwiLCBldmVudCwgc29ydGFibGUuX3VpSGFzaCggc29ydGFibGUgKSApO1xyXG5cdFx0XHRcdFx0c29ydGFibGUuX21vdXNlU3RvcCggZXZlbnQsIHRydWUgKTtcclxuXHJcblx0XHRcdFx0XHQvLyByZXN0b3JlIHNvcnRhYmxlIGJlaGF2aW9ycyB0aGF0IHdlcmUgbW9kZmllZFxyXG5cdFx0XHRcdFx0Ly8gd2hlbiB0aGUgZHJhZ2dhYmxlIGVudGVyZWQgdGhlIHNvcnRhYmxlIGFyZWEgKCM5NDgxKVxyXG5cdFx0XHRcdFx0c29ydGFibGUub3B0aW9ucy5yZXZlcnQgPSBzb3J0YWJsZS5vcHRpb25zLl9yZXZlcnQ7XHJcblx0XHRcdFx0XHRzb3J0YWJsZS5vcHRpb25zLmhlbHBlciA9IHNvcnRhYmxlLm9wdGlvbnMuX2hlbHBlcjtcclxuXHJcblx0XHRcdFx0XHRpZiAoIHNvcnRhYmxlLnBsYWNlaG9sZGVyICkge1xyXG5cdFx0XHRcdFx0XHRzb3J0YWJsZS5wbGFjZWhvbGRlci5yZW1vdmUoKTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBSZXN0b3JlIGFuZCByZWNhbGN1bGF0ZSB0aGUgZHJhZ2dhYmxlJ3Mgb2Zmc2V0IGNvbnNpZGVyaW5nIHRoZSBzb3J0YWJsZVxyXG5cdFx0XHRcdFx0Ly8gbWF5IGhhdmUgbW9kaWZpZWQgdGhlbSBpbiB1bmV4cGVjdGVkIHdheXMuICgjODgwOSwgIzEwNjY5KVxyXG5cdFx0XHRcdFx0dWkuaGVscGVyLmFwcGVuZFRvKCBkcmFnZ2FibGUuX3BhcmVudCApO1xyXG5cdFx0XHRcdFx0ZHJhZ2dhYmxlLl9yZWZyZXNoT2Zmc2V0cyggZXZlbnQgKTtcclxuXHRcdFx0XHRcdHVpLnBvc2l0aW9uID0gZHJhZ2dhYmxlLl9nZW5lcmF0ZVBvc2l0aW9uKCBldmVudCwgdHJ1ZSApO1xyXG5cclxuXHRcdFx0XHRcdGRyYWdnYWJsZS5fdHJpZ2dlciggXCJmcm9tU29ydGFibGVcIiwgZXZlbnQgKTtcclxuXHJcblx0XHRcdFx0XHQvLyBJbmZvcm0gZHJhZ2dhYmxlIHRoYXQgdGhlIGhlbHBlciBpcyBubyBsb25nZXIgaW4gYSB2YWxpZCBkcm9wIHpvbmVcclxuXHRcdFx0XHRcdGRyYWdnYWJsZS5kcm9wcGVkID0gZmFsc2U7XHJcblxyXG5cdFx0XHRcdFx0Ly8gTmVlZCB0byByZWZyZXNoUG9zaXRpb25zIG9mIGFsbCBzb3J0YWJsZXMganVzdCBpbiBjYXNlIHJlbW92aW5nXHJcblx0XHRcdFx0XHQvLyBmcm9tIG9uZSBzb3J0YWJsZSBjaGFuZ2VzIHRoZSBsb2NhdGlvbiBvZiBvdGhlciBzb3J0YWJsZXMgKCM5Njc1KVxyXG5cdFx0XHRcdFx0JC5lYWNoKCBkcmFnZ2FibGUuc29ydGFibGVzLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufSk7XHJcblxyXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJjdXJzb3JcIiwge1xyXG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcclxuXHRcdHZhciB0ID0gJCggXCJib2R5XCIgKSxcclxuXHRcdFx0byA9IGluc3RhbmNlLm9wdGlvbnM7XHJcblxyXG5cdFx0aWYgKHQuY3NzKFwiY3Vyc29yXCIpKSB7XHJcblx0XHRcdG8uX2N1cnNvciA9IHQuY3NzKFwiY3Vyc29yXCIpO1xyXG5cdFx0fVxyXG5cdFx0dC5jc3MoXCJjdXJzb3JcIiwgby5jdXJzb3IpO1xyXG5cdH0sXHJcblx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XHJcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XHJcblx0XHRpZiAoby5fY3Vyc29yKSB7XHJcblx0XHRcdCQoXCJib2R5XCIpLmNzcyhcImN1cnNvclwiLCBvLl9jdXJzb3IpO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcblxyXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJvcGFjaXR5XCIsIHtcclxuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XHJcblx0XHR2YXIgdCA9ICQoIHVpLmhlbHBlciApLFxyXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucztcclxuXHRcdGlmICh0LmNzcyhcIm9wYWNpdHlcIikpIHtcclxuXHRcdFx0by5fb3BhY2l0eSA9IHQuY3NzKFwib3BhY2l0eVwiKTtcclxuXHRcdH1cclxuXHRcdHQuY3NzKFwib3BhY2l0eVwiLCBvLm9wYWNpdHkpO1xyXG5cdH0sXHJcblx0c3RvcDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XHJcblx0XHR2YXIgbyA9IGluc3RhbmNlLm9wdGlvbnM7XHJcblx0XHRpZiAoby5fb3BhY2l0eSkge1xyXG5cdFx0XHQkKHVpLmhlbHBlcikuY3NzKFwib3BhY2l0eVwiLCBvLl9vcGFjaXR5KTtcclxuXHRcdH1cclxuXHR9XHJcbn0pO1xyXG5cclxuJC51aS5wbHVnaW4uYWRkKFwiZHJhZ2dhYmxlXCIsIFwic2Nyb2xsXCIsIHtcclxuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaSApIHtcclxuXHRcdGlmICggIWkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuICkge1xyXG5cdFx0XHRpLnNjcm9sbFBhcmVudE5vdEhpZGRlbiA9IGkuaGVscGVyLnNjcm9sbFBhcmVudCggZmFsc2UgKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIGkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuWyAwIF0gIT09IGkuZG9jdW1lbnRbIDAgXSAmJiBpLnNjcm9sbFBhcmVudE5vdEhpZGRlblsgMCBdLnRhZ05hbWUgIT09IFwiSFRNTFwiICkge1xyXG5cdFx0XHRpLm92ZXJmbG93T2Zmc2V0ID0gaS5zY3JvbGxQYXJlbnROb3RIaWRkZW4ub2Zmc2V0KCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHRkcmFnOiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpICApIHtcclxuXHJcblx0XHR2YXIgbyA9IGkub3B0aW9ucyxcclxuXHRcdFx0c2Nyb2xsZWQgPSBmYWxzZSxcclxuXHRcdFx0c2Nyb2xsUGFyZW50ID0gaS5zY3JvbGxQYXJlbnROb3RIaWRkZW5bIDAgXSxcclxuXHRcdFx0ZG9jdW1lbnQgPSBpLmRvY3VtZW50WyAwIF07XHJcblxyXG5cdFx0aWYgKCBzY3JvbGxQYXJlbnQgIT09IGRvY3VtZW50ICYmIHNjcm9sbFBhcmVudC50YWdOYW1lICE9PSBcIkhUTUxcIiApIHtcclxuXHRcdFx0aWYgKCAhby5heGlzIHx8IG8uYXhpcyAhPT0gXCJ4XCIgKSB7XHJcblx0XHRcdFx0aWYgKCAoIGkub3ZlcmZsb3dPZmZzZXQudG9wICsgc2Nyb2xsUGFyZW50Lm9mZnNldEhlaWdodCApIC0gZXZlbnQucGFnZVkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsUGFyZW50LnNjcm9sbFRvcCA9IHNjcm9sbGVkID0gc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCArIG8uc2Nyb2xsU3BlZWQ7XHJcblx0XHRcdFx0fSBlbHNlIGlmICggZXZlbnQucGFnZVkgLSBpLm92ZXJmbG93T2Zmc2V0LnRvcCA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkgKSB7XHJcblx0XHRcdFx0XHRzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsVG9wIC0gby5zY3JvbGxTcGVlZDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICggIW8uYXhpcyB8fCBvLmF4aXMgIT09IFwieVwiICkge1xyXG5cdFx0XHRcdGlmICggKCBpLm92ZXJmbG93T2Zmc2V0LmxlZnQgKyBzY3JvbGxQYXJlbnQub2Zmc2V0V2lkdGggKSAtIGV2ZW50LnBhZ2VYIDwgby5zY3JvbGxTZW5zaXRpdml0eSApIHtcclxuXHRcdFx0XHRcdHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsZWQgPSBzY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCArIG8uc2Nyb2xsU3BlZWQ7XHJcblx0XHRcdFx0fSBlbHNlIGlmICggZXZlbnQucGFnZVggLSBpLm92ZXJmbG93T2Zmc2V0LmxlZnQgPCBvLnNjcm9sbFNlbnNpdGl2aXR5ICkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsUGFyZW50LnNjcm9sbExlZnQgPSBzY3JvbGxlZCA9IHNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0IC0gby5zY3JvbGxTcGVlZDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0aWYgKCFvLmF4aXMgfHwgby5heGlzICE9PSBcInhcIikge1xyXG5cdFx0XHRcdGlmIChldmVudC5wYWdlWSAtICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSAkKGRvY3VtZW50KS5zY3JvbGxUb3AoJChkb2N1bWVudCkuc2Nyb2xsVG9wKCkgLSBvLnNjcm9sbFNwZWVkKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKCQod2luZG93KS5oZWlnaHQoKSAtIChldmVudC5wYWdlWSAtICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpKSA8IG8uc2Nyb2xsU2Vuc2l0aXZpdHkpIHtcclxuXHRcdFx0XHRcdHNjcm9sbGVkID0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpICsgby5zY3JvbGxTcGVlZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoIW8uYXhpcyB8fCBvLmF4aXMgIT09IFwieVwiKSB7XHJcblx0XHRcdFx0aWYgKGV2ZW50LnBhZ2VYIC0gJChkb2N1bWVudCkuc2Nyb2xsTGVmdCgpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSAtIG8uc2Nyb2xsU3BlZWQpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoJCh3aW5kb3cpLndpZHRoKCkgLSAoZXZlbnQucGFnZVggLSAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSArIG8uc2Nyb2xsU3BlZWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoc2Nyb2xsZWQgIT09IGZhbHNlICYmICQudWkuZGRtYW5hZ2VyICYmICFvLmRyb3BCZWhhdmlvdXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoaSwgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHR9XHJcbn0pO1xyXG5cclxuJC51aS5wbHVnaW4uYWRkKFwiZHJhZ2dhYmxlXCIsIFwic25hcFwiLCB7XHJcblx0c3RhcnQ6IGZ1bmN0aW9uKCBldmVudCwgdWksIGkgKSB7XHJcblxyXG5cdFx0dmFyIG8gPSBpLm9wdGlvbnM7XHJcblxyXG5cdFx0aS5zbmFwRWxlbWVudHMgPSBbXTtcclxuXHJcblx0XHQkKG8uc25hcC5jb25zdHJ1Y3RvciAhPT0gU3RyaW5nID8gKCBvLnNuYXAuaXRlbXMgfHwgXCI6ZGF0YSh1aS1kcmFnZ2FibGUpXCIgKSA6IG8uc25hcCkuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyICR0ID0gJCh0aGlzKSxcclxuXHRcdFx0XHQkbyA9ICR0Lm9mZnNldCgpO1xyXG5cdFx0XHRpZiAodGhpcyAhPT0gaS5lbGVtZW50WzBdKSB7XHJcblx0XHRcdFx0aS5zbmFwRWxlbWVudHMucHVzaCh7XHJcblx0XHRcdFx0XHRpdGVtOiB0aGlzLFxyXG5cdFx0XHRcdFx0d2lkdGg6ICR0Lm91dGVyV2lkdGgoKSwgaGVpZ2h0OiAkdC5vdXRlckhlaWdodCgpLFxyXG5cdFx0XHRcdFx0dG9wOiAkby50b3AsIGxlZnQ6ICRvLmxlZnRcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdH0sXHJcblx0ZHJhZzogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdCApIHtcclxuXHJcblx0XHR2YXIgdHMsIGJzLCBscywgcnMsIGwsIHIsIHQsIGIsIGksIGZpcnN0LFxyXG5cdFx0XHRvID0gaW5zdC5vcHRpb25zLFxyXG5cdFx0XHRkID0gby5zbmFwVG9sZXJhbmNlLFxyXG5cdFx0XHR4MSA9IHVpLm9mZnNldC5sZWZ0LCB4MiA9IHgxICsgaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCxcclxuXHRcdFx0eTEgPSB1aS5vZmZzZXQudG9wLCB5MiA9IHkxICsgaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQ7XHJcblxyXG5cdFx0Zm9yIChpID0gaW5zdC5zbmFwRWxlbWVudHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xyXG5cclxuXHRcdFx0bCA9IGluc3Quc25hcEVsZW1lbnRzW2ldLmxlZnQgLSBpbnN0Lm1hcmdpbnMubGVmdDtcclxuXHRcdFx0ciA9IGwgKyBpbnN0LnNuYXBFbGVtZW50c1tpXS53aWR0aDtcclxuXHRcdFx0dCA9IGluc3Quc25hcEVsZW1lbnRzW2ldLnRvcCAtIGluc3QubWFyZ2lucy50b3A7XHJcblx0XHRcdGIgPSB0ICsgaW5zdC5zbmFwRWxlbWVudHNbaV0uaGVpZ2h0O1xyXG5cclxuXHRcdFx0aWYgKCB4MiA8IGwgLSBkIHx8IHgxID4gciArIGQgfHwgeTIgPCB0IC0gZCB8fCB5MSA+IGIgKyBkIHx8ICEkLmNvbnRhaW5zKCBpbnN0LnNuYXBFbGVtZW50c1sgaSBdLml0ZW0ub3duZXJEb2N1bWVudCwgaW5zdC5zbmFwRWxlbWVudHNbIGkgXS5pdGVtICkgKSB7XHJcblx0XHRcdFx0aWYgKGluc3Quc25hcEVsZW1lbnRzW2ldLnNuYXBwaW5nKSB7XHJcblx0XHRcdFx0XHQoaW5zdC5vcHRpb25zLnNuYXAucmVsZWFzZSAmJiBpbnN0Lm9wdGlvbnMuc25hcC5yZWxlYXNlLmNhbGwoaW5zdC5lbGVtZW50LCBldmVudCwgJC5leHRlbmQoaW5zdC5fdWlIYXNoKCksIHsgc25hcEl0ZW06IGluc3Quc25hcEVsZW1lbnRzW2ldLml0ZW0gfSkpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aW5zdC5zbmFwRWxlbWVudHNbaV0uc25hcHBpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKG8uc25hcE1vZGUgIT09IFwiaW5uZXJcIikge1xyXG5cdFx0XHRcdHRzID0gTWF0aC5hYnModCAtIHkyKSA8PSBkO1xyXG5cdFx0XHRcdGJzID0gTWF0aC5hYnMoYiAtIHkxKSA8PSBkO1xyXG5cdFx0XHRcdGxzID0gTWF0aC5hYnMobCAtIHgyKSA8PSBkO1xyXG5cdFx0XHRcdHJzID0gTWF0aC5hYnMociAtIHgxKSA8PSBkO1xyXG5cdFx0XHRcdGlmICh0cykge1xyXG5cdFx0XHRcdFx0dWkucG9zaXRpb24udG9wID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogdCAtIGluc3QuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LCBsZWZ0OiAwIH0pLnRvcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGJzKSB7XHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi50b3AgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiBiLCBsZWZ0OiAwIH0pLnRvcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGxzKSB7XHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogMCwgbGVmdDogbCAtIGluc3QuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggfSkubGVmdDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHJzKSB7XHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogMCwgbGVmdDogciB9KS5sZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Zmlyc3QgPSAodHMgfHwgYnMgfHwgbHMgfHwgcnMpO1xyXG5cclxuXHRcdFx0aWYgKG8uc25hcE1vZGUgIT09IFwib3V0ZXJcIikge1xyXG5cdFx0XHRcdHRzID0gTWF0aC5hYnModCAtIHkxKSA8PSBkO1xyXG5cdFx0XHRcdGJzID0gTWF0aC5hYnMoYiAtIHkyKSA8PSBkO1xyXG5cdFx0XHRcdGxzID0gTWF0aC5hYnMobCAtIHgxKSA8PSBkO1xyXG5cdFx0XHRcdHJzID0gTWF0aC5hYnMociAtIHgyKSA8PSBkO1xyXG5cdFx0XHRcdGlmICh0cykge1xyXG5cdFx0XHRcdFx0dWkucG9zaXRpb24udG9wID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogdCwgbGVmdDogMCB9KS50b3A7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmIChicykge1xyXG5cdFx0XHRcdFx0dWkucG9zaXRpb24udG9wID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogYiAtIGluc3QuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LCBsZWZ0OiAwIH0pLnRvcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGxzKSB7XHJcblx0XHRcdFx0XHR1aS5wb3NpdGlvbi5sZWZ0ID0gaW5zdC5fY29udmVydFBvc2l0aW9uVG8oXCJyZWxhdGl2ZVwiLCB7IHRvcDogMCwgbGVmdDogbCB9KS5sZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAocnMpIHtcclxuXHRcdFx0XHRcdHVpLnBvc2l0aW9uLmxlZnQgPSBpbnN0Ll9jb252ZXJ0UG9zaXRpb25UbyhcInJlbGF0aXZlXCIsIHsgdG9wOiAwLCBsZWZ0OiByIC0gaW5zdC5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCB9KS5sZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCFpbnN0LnNuYXBFbGVtZW50c1tpXS5zbmFwcGluZyAmJiAodHMgfHwgYnMgfHwgbHMgfHwgcnMgfHwgZmlyc3QpKSB7XHJcblx0XHRcdFx0KGluc3Qub3B0aW9ucy5zbmFwLnNuYXAgJiYgaW5zdC5vcHRpb25zLnNuYXAuc25hcC5jYWxsKGluc3QuZWxlbWVudCwgZXZlbnQsICQuZXh0ZW5kKGluc3QuX3VpSGFzaCgpLCB7IHNuYXBJdGVtOiBpbnN0LnNuYXBFbGVtZW50c1tpXS5pdGVtIH0pKSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aW5zdC5zbmFwRWxlbWVudHNbaV0uc25hcHBpbmcgPSAodHMgfHwgYnMgfHwgbHMgfHwgcnMgfHwgZmlyc3QpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG59KTtcclxuXHJcbiQudWkucGx1Z2luLmFkZChcImRyYWdnYWJsZVwiLCBcInN0YWNrXCIsIHtcclxuXHRzdGFydDogZnVuY3Rpb24oIGV2ZW50LCB1aSwgaW5zdGFuY2UgKSB7XHJcblx0XHR2YXIgbWluLFxyXG5cdFx0XHRvID0gaW5zdGFuY2Uub3B0aW9ucyxcclxuXHRcdFx0Z3JvdXAgPSAkLm1ha2VBcnJheSgkKG8uc3RhY2spKS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuXHRcdFx0XHRyZXR1cm4gKHBhcnNlSW50KCQoYSkuY3NzKFwiekluZGV4XCIpLCAxMCkgfHwgMCkgLSAocGFyc2VJbnQoJChiKS5jc3MoXCJ6SW5kZXhcIiksIDEwKSB8fCAwKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0aWYgKCFncm91cC5sZW5ndGgpIHsgcmV0dXJuOyB9XHJcblxyXG5cdFx0bWluID0gcGFyc2VJbnQoJChncm91cFswXSkuY3NzKFwiekluZGV4XCIpLCAxMCkgfHwgMDtcclxuXHRcdCQoZ3JvdXApLmVhY2goZnVuY3Rpb24oaSkge1xyXG5cdFx0XHQkKHRoaXMpLmNzcyhcInpJbmRleFwiLCBtaW4gKyBpKTtcclxuXHRcdH0pO1xyXG5cdFx0dGhpcy5jc3MoXCJ6SW5kZXhcIiwgKG1pbiArIGdyb3VwLmxlbmd0aCkpO1xyXG5cdH1cclxufSk7XHJcblxyXG4kLnVpLnBsdWdpbi5hZGQoXCJkcmFnZ2FibGVcIiwgXCJ6SW5kZXhcIiwge1xyXG5cdHN0YXJ0OiBmdW5jdGlvbiggZXZlbnQsIHVpLCBpbnN0YW5jZSApIHtcclxuXHRcdHZhciB0ID0gJCggdWkuaGVscGVyICksXHJcblx0XHRcdG8gPSBpbnN0YW5jZS5vcHRpb25zO1xyXG5cclxuXHRcdGlmICh0LmNzcyhcInpJbmRleFwiKSkge1xyXG5cdFx0XHRvLl96SW5kZXggPSB0LmNzcyhcInpJbmRleFwiKTtcclxuXHRcdH1cclxuXHRcdHQuY3NzKFwiekluZGV4XCIsIG8uekluZGV4KTtcclxuXHR9LFxyXG5cdHN0b3A6IGZ1bmN0aW9uKCBldmVudCwgdWksIGluc3RhbmNlICkge1xyXG5cdFx0dmFyIG8gPSBpbnN0YW5jZS5vcHRpb25zO1xyXG5cclxuXHRcdGlmIChvLl96SW5kZXgpIHtcclxuXHRcdFx0JCh1aS5oZWxwZXIpLmNzcyhcInpJbmRleFwiLCBvLl96SW5kZXgpO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcblxyXG52YXIgZHJhZ2dhYmxlID0gJC51aS5kcmFnZ2FibGU7XHJcblxyXG5cclxuLyohXHJcbiAqIGpRdWVyeSBVSSBTb3J0YWJsZSAxLjExLjRcclxuICogaHR0cDovL2pxdWVyeXVpLmNvbVxyXG4gKlxyXG4gKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xyXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXHJcbiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcclxuICpcclxuICogaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vc29ydGFibGUvXHJcbiAqL1xyXG5cclxuXHJcbnZhciBzb3J0YWJsZSA9ICQud2lkZ2V0KFwidWkuc29ydGFibGVcIiwgJC51aS5tb3VzZSwge1xyXG5cdHZlcnNpb246IFwiMS4xMS40XCIsXHJcblx0d2lkZ2V0RXZlbnRQcmVmaXg6IFwic29ydFwiLFxyXG5cdHJlYWR5OiBmYWxzZSxcclxuXHRvcHRpb25zOiB7XHJcblx0XHRhcHBlbmRUbzogXCJwYXJlbnRcIixcclxuXHRcdGF4aXM6IGZhbHNlLFxyXG5cdFx0Y29ubmVjdFdpdGg6IGZhbHNlLFxyXG5cdFx0Y29udGFpbm1lbnQ6IGZhbHNlLFxyXG5cdFx0Y3Vyc29yOiBcImF1dG9cIixcclxuXHRcdGN1cnNvckF0OiBmYWxzZSxcclxuXHRcdGRyb3BPbkVtcHR5OiB0cnVlLFxyXG5cdFx0Zm9yY2VQbGFjZWhvbGRlclNpemU6IGZhbHNlLFxyXG5cdFx0Zm9yY2VIZWxwZXJTaXplOiBmYWxzZSxcclxuXHRcdGdyaWQ6IGZhbHNlLFxyXG5cdFx0aGFuZGxlOiBmYWxzZSxcclxuXHRcdGhlbHBlcjogXCJvcmlnaW5hbFwiLFxyXG5cdFx0aXRlbXM6IFwiPiAqXCIsXHJcblx0XHRvcGFjaXR5OiBmYWxzZSxcclxuXHRcdHBsYWNlaG9sZGVyOiBmYWxzZSxcclxuXHRcdHJldmVydDogZmFsc2UsXHJcblx0XHRzY3JvbGw6IHRydWUsXHJcblx0XHRzY3JvbGxTZW5zaXRpdml0eTogMjAsXHJcblx0XHRzY3JvbGxTcGVlZDogMjAsXHJcblx0XHRzY29wZTogXCJkZWZhdWx0XCIsXHJcblx0XHR0b2xlcmFuY2U6IFwiaW50ZXJzZWN0XCIsXHJcblx0XHR6SW5kZXg6IDEwMDAsXHJcblxyXG5cdFx0Ly8gY2FsbGJhY2tzXHJcblx0XHRhY3RpdmF0ZTogbnVsbCxcclxuXHRcdGJlZm9yZVN0b3A6IG51bGwsXHJcblx0XHRjaGFuZ2U6IG51bGwsXHJcblx0XHRkZWFjdGl2YXRlOiBudWxsLFxyXG5cdFx0b3V0OiBudWxsLFxyXG5cdFx0b3ZlcjogbnVsbCxcclxuXHRcdHJlY2VpdmU6IG51bGwsXHJcblx0XHRyZW1vdmU6IG51bGwsXHJcblx0XHRzb3J0OiBudWxsLFxyXG5cdFx0c3RhcnQ6IG51bGwsXHJcblx0XHRzdG9wOiBudWxsLFxyXG5cdFx0dXBkYXRlOiBudWxsXHJcblx0fSxcclxuXHJcblx0X2lzT3ZlckF4aXM6IGZ1bmN0aW9uKCB4LCByZWZlcmVuY2UsIHNpemUgKSB7XHJcblx0XHRyZXR1cm4gKCB4ID49IHJlZmVyZW5jZSApICYmICggeCA8ICggcmVmZXJlbmNlICsgc2l6ZSApICk7XHJcblx0fSxcclxuXHJcblx0X2lzRmxvYXRpbmc6IGZ1bmN0aW9uKCBpdGVtICkge1xyXG5cdFx0cmV0dXJuICgvbGVmdHxyaWdodC8pLnRlc3QoaXRlbS5jc3MoXCJmbG9hdFwiKSkgfHwgKC9pbmxpbmV8dGFibGUtY2VsbC8pLnRlc3QoaXRlbS5jc3MoXCJkaXNwbGF5XCIpKTtcclxuXHR9LFxyXG5cclxuXHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuY29udGFpbmVyQ2FjaGUgPSB7fTtcclxuXHRcdHRoaXMuZWxlbWVudC5hZGRDbGFzcyhcInVpLXNvcnRhYmxlXCIpO1xyXG5cclxuXHRcdC8vR2V0IHRoZSBpdGVtc1xyXG5cdFx0dGhpcy5yZWZyZXNoKCk7XHJcblxyXG5cdFx0Ly9MZXQncyBkZXRlcm1pbmUgdGhlIHBhcmVudCdzIG9mZnNldFxyXG5cdFx0dGhpcy5vZmZzZXQgPSB0aGlzLmVsZW1lbnQub2Zmc2V0KCk7XHJcblxyXG5cdFx0Ly9Jbml0aWFsaXplIG1vdXNlIGV2ZW50cyBmb3IgaW50ZXJhY3Rpb25cclxuXHRcdHRoaXMuX21vdXNlSW5pdCgpO1xyXG5cclxuXHRcdHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpO1xyXG5cclxuXHRcdC8vV2UncmUgcmVhZHkgdG8gZ29cclxuXHRcdHRoaXMucmVhZHkgPSB0cnVlO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfc2V0T3B0aW9uOiBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHtcclxuXHRcdHRoaXMuX3N1cGVyKCBrZXksIHZhbHVlICk7XHJcblxyXG5cdFx0aWYgKCBrZXkgPT09IFwiaGFuZGxlXCIgKSB7XHJcblx0XHRcdHRoaXMuX3NldEhhbmRsZUNsYXNzTmFtZSgpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9zZXRIYW5kbGVDbGFzc05hbWU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5lbGVtZW50LmZpbmQoIFwiLnVpLXNvcnRhYmxlLWhhbmRsZVwiICkucmVtb3ZlQ2xhc3MoIFwidWktc29ydGFibGUtaGFuZGxlXCIgKTtcclxuXHRcdCQuZWFjaCggdGhpcy5pdGVtcywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdCggdGhpcy5pbnN0YW5jZS5vcHRpb25zLmhhbmRsZSA/XHJcblx0XHRcdFx0dGhpcy5pdGVtLmZpbmQoIHRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oYW5kbGUgKSA6IHRoaXMuaXRlbSApXHJcblx0XHRcdFx0LmFkZENsYXNzKCBcInVpLXNvcnRhYmxlLWhhbmRsZVwiICk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cclxuXHRfZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmVsZW1lbnRcclxuXHRcdFx0LnJlbW92ZUNsYXNzKCBcInVpLXNvcnRhYmxlIHVpLXNvcnRhYmxlLWRpc2FibGVkXCIgKVxyXG5cdFx0XHQuZmluZCggXCIudWktc29ydGFibGUtaGFuZGxlXCIgKVxyXG5cdFx0XHRcdC5yZW1vdmVDbGFzcyggXCJ1aS1zb3J0YWJsZS1oYW5kbGVcIiApO1xyXG5cdFx0dGhpcy5fbW91c2VEZXN0cm95KCk7XHJcblxyXG5cdFx0Zm9yICggdmFyIGkgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tICkge1xyXG5cdFx0XHR0aGlzLml0ZW1zW2ldLml0ZW0ucmVtb3ZlRGF0YSh0aGlzLndpZGdldE5hbWUgKyBcIi1pdGVtXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdF9tb3VzZUNhcHR1cmU6IGZ1bmN0aW9uKGV2ZW50LCBvdmVycmlkZUhhbmRsZSkge1xyXG5cdFx0dmFyIGN1cnJlbnRJdGVtID0gbnVsbCxcclxuXHRcdFx0dmFsaWRIYW5kbGUgPSBmYWxzZSxcclxuXHRcdFx0dGhhdCA9IHRoaXM7XHJcblxyXG5cdFx0aWYgKHRoaXMucmV2ZXJ0aW5nKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRpZih0aGlzLm9wdGlvbnMuZGlzYWJsZWQgfHwgdGhpcy5vcHRpb25zLnR5cGUgPT09IFwic3RhdGljXCIpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vV2UgaGF2ZSB0byByZWZyZXNoIHRoZSBpdGVtcyBkYXRhIG9uY2UgZmlyc3RcclxuXHRcdHRoaXMuX3JlZnJlc2hJdGVtcyhldmVudCk7XHJcblxyXG5cdFx0Ly9GaW5kIG91dCBpZiB0aGUgY2xpY2tlZCBub2RlIChvciBvbmUgb2YgaXRzIHBhcmVudHMpIGlzIGEgYWN0dWFsIGl0ZW0gaW4gdGhpcy5pdGVtc1xyXG5cdFx0JChldmVudC50YXJnZXQpLnBhcmVudHMoKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZigkLmRhdGEodGhpcywgdGhhdC53aWRnZXROYW1lICsgXCItaXRlbVwiKSA9PT0gdGhhdCkge1xyXG5cdFx0XHRcdGN1cnJlbnRJdGVtID0gJCh0aGlzKTtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0aWYoJC5kYXRhKGV2ZW50LnRhcmdldCwgdGhhdC53aWRnZXROYW1lICsgXCItaXRlbVwiKSA9PT0gdGhhdCkge1xyXG5cdFx0XHRjdXJyZW50SXRlbSA9ICQoZXZlbnQudGFyZ2V0KTtcclxuXHRcdH1cclxuXHJcblx0XHRpZighY3VycmVudEl0ZW0pIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0aWYodGhpcy5vcHRpb25zLmhhbmRsZSAmJiAhb3ZlcnJpZGVIYW5kbGUpIHtcclxuXHRcdFx0JCh0aGlzLm9wdGlvbnMuaGFuZGxlLCBjdXJyZW50SXRlbSkuZmluZChcIipcIikuYWRkQmFjaygpLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0aWYodGhpcyA9PT0gZXZlbnQudGFyZ2V0KSB7XHJcblx0XHRcdFx0XHR2YWxpZEhhbmRsZSA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0aWYoIXZhbGlkSGFuZGxlKSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jdXJyZW50SXRlbSA9IGN1cnJlbnRJdGVtO1xyXG5cdFx0dGhpcy5fcmVtb3ZlQ3VycmVudHNGcm9tSXRlbXMoKTtcclxuXHRcdHJldHVybiB0cnVlO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfbW91c2VTdGFydDogZnVuY3Rpb24oZXZlbnQsIG92ZXJyaWRlSGFuZGxlLCBub0FjdGl2YXRpb24pIHtcclxuXHJcblx0XHR2YXIgaSwgYm9keSxcclxuXHRcdFx0byA9IHRoaXMub3B0aW9ucztcclxuXHJcblx0XHR0aGlzLmN1cnJlbnRDb250YWluZXIgPSB0aGlzO1xyXG5cclxuXHRcdC8vV2Ugb25seSBuZWVkIHRvIGNhbGwgcmVmcmVzaFBvc2l0aW9ucywgYmVjYXVzZSB0aGUgcmVmcmVzaEl0ZW1zIGNhbGwgaGFzIGJlZW4gbW92ZWQgdG8gbW91c2VDYXB0dXJlXHJcblx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKTtcclxuXHJcblx0XHQvL0NyZWF0ZSBhbmQgYXBwZW5kIHRoZSB2aXNpYmxlIGhlbHBlclxyXG5cdFx0dGhpcy5oZWxwZXIgPSB0aGlzLl9jcmVhdGVIZWxwZXIoZXZlbnQpO1xyXG5cclxuXHRcdC8vQ2FjaGUgdGhlIGhlbHBlciBzaXplXHJcblx0XHR0aGlzLl9jYWNoZUhlbHBlclByb3BvcnRpb25zKCk7XHJcblxyXG5cdFx0LypcclxuXHRcdCAqIC0gUG9zaXRpb24gZ2VuZXJhdGlvbiAtXHJcblx0XHQgKiBUaGlzIGJsb2NrIGdlbmVyYXRlcyBldmVyeXRoaW5nIHBvc2l0aW9uIHJlbGF0ZWQgLSBpdCdzIHRoZSBjb3JlIG9mIGRyYWdnYWJsZXMuXHJcblx0XHQgKi9cclxuXHJcblx0XHQvL0NhY2hlIHRoZSBtYXJnaW5zIG9mIHRoZSBvcmlnaW5hbCBlbGVtZW50XHJcblx0XHR0aGlzLl9jYWNoZU1hcmdpbnMoKTtcclxuXHJcblx0XHQvL0dldCB0aGUgbmV4dCBzY3JvbGxpbmcgcGFyZW50XHJcblx0XHR0aGlzLnNjcm9sbFBhcmVudCA9IHRoaXMuaGVscGVyLnNjcm9sbFBhcmVudCgpO1xyXG5cclxuXHRcdC8vVGhlIGVsZW1lbnQncyBhYnNvbHV0ZSBwb3NpdGlvbiBvbiB0aGUgcGFnZSBtaW51cyBtYXJnaW5zXHJcblx0XHR0aGlzLm9mZnNldCA9IHRoaXMuY3VycmVudEl0ZW0ub2Zmc2V0KCk7XHJcblx0XHR0aGlzLm9mZnNldCA9IHtcclxuXHRcdFx0dG9wOiB0aGlzLm9mZnNldC50b3AgLSB0aGlzLm1hcmdpbnMudG9wLFxyXG5cdFx0XHRsZWZ0OiB0aGlzLm9mZnNldC5sZWZ0IC0gdGhpcy5tYXJnaW5zLmxlZnRcclxuXHRcdH07XHJcblxyXG5cdFx0JC5leHRlbmQodGhpcy5vZmZzZXQsIHtcclxuXHRcdFx0Y2xpY2s6IHsgLy9XaGVyZSB0aGUgY2xpY2sgaGFwcGVuZWQsIHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50XHJcblx0XHRcdFx0bGVmdDogZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5sZWZ0LFxyXG5cdFx0XHRcdHRvcDogZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC50b3BcclxuXHRcdFx0fSxcclxuXHRcdFx0cGFyZW50OiB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSxcclxuXHRcdFx0cmVsYXRpdmU6IHRoaXMuX2dldFJlbGF0aXZlT2Zmc2V0KCkgLy9UaGlzIGlzIGEgcmVsYXRpdmUgdG8gYWJzb2x1dGUgcG9zaXRpb24gbWludXMgdGhlIGFjdHVhbCBwb3NpdGlvbiBjYWxjdWxhdGlvbiAtIG9ubHkgdXNlZCBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBoZWxwZXJcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIE9ubHkgYWZ0ZXIgd2UgZ290IHRoZSBvZmZzZXQsIHdlIGNhbiBjaGFuZ2UgdGhlIGhlbHBlcidzIHBvc2l0aW9uIHRvIGFic29sdXRlXHJcblx0XHQvLyBUT0RPOiBTdGlsbCBuZWVkIHRvIGZpZ3VyZSBvdXQgYSB3YXkgdG8gbWFrZSByZWxhdGl2ZSBzb3J0aW5nIHBvc3NpYmxlXHJcblx0XHR0aGlzLmhlbHBlci5jc3MoXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIpO1xyXG5cdFx0dGhpcy5jc3NQb3NpdGlvbiA9IHRoaXMuaGVscGVyLmNzcyhcInBvc2l0aW9uXCIpO1xyXG5cclxuXHRcdC8vR2VuZXJhdGUgdGhlIG9yaWdpbmFsIHBvc2l0aW9uXHJcblx0XHR0aGlzLm9yaWdpbmFsUG9zaXRpb24gPSB0aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKGV2ZW50KTtcclxuXHRcdHRoaXMub3JpZ2luYWxQYWdlWCA9IGV2ZW50LnBhZ2VYO1xyXG5cdFx0dGhpcy5vcmlnaW5hbFBhZ2VZID0gZXZlbnQucGFnZVk7XHJcblxyXG5cdFx0Ly9BZGp1c3QgdGhlIG1vdXNlIG9mZnNldCByZWxhdGl2ZSB0byB0aGUgaGVscGVyIGlmIFwiY3Vyc29yQXRcIiBpcyBzdXBwbGllZFxyXG5cdFx0KG8uY3Vyc29yQXQgJiYgdGhpcy5fYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcihvLmN1cnNvckF0KSk7XHJcblxyXG5cdFx0Ly9DYWNoZSB0aGUgZm9ybWVyIERPTSBwb3NpdGlvblxyXG5cdFx0dGhpcy5kb21Qb3NpdGlvbiA9IHsgcHJldjogdGhpcy5jdXJyZW50SXRlbS5wcmV2KClbMF0sIHBhcmVudDogdGhpcy5jdXJyZW50SXRlbS5wYXJlbnQoKVswXSB9O1xyXG5cclxuXHRcdC8vSWYgdGhlIGhlbHBlciBpcyBub3QgdGhlIG9yaWdpbmFsLCBoaWRlIHRoZSBvcmlnaW5hbCBzbyBpdCdzIG5vdCBwbGF5aW5nIGFueSByb2xlIGR1cmluZyB0aGUgZHJhZywgd29uJ3QgY2F1c2UgYW55dGhpbmcgYmFkIHRoaXMgd2F5XHJcblx0XHRpZih0aGlzLmhlbHBlclswXSAhPT0gdGhpcy5jdXJyZW50SXRlbVswXSkge1xyXG5cdFx0XHR0aGlzLmN1cnJlbnRJdGVtLmhpZGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvL0NyZWF0ZSB0aGUgcGxhY2Vob2xkZXJcclxuXHRcdHRoaXMuX2NyZWF0ZVBsYWNlaG9sZGVyKCk7XHJcblxyXG5cdFx0Ly9TZXQgYSBjb250YWlubWVudCBpZiBnaXZlbiBpbiB0aGUgb3B0aW9uc1xyXG5cdFx0aWYoby5jb250YWlubWVudCkge1xyXG5cdFx0XHR0aGlzLl9zZXRDb250YWlubWVudCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCBvLmN1cnNvciAmJiBvLmN1cnNvciAhPT0gXCJhdXRvXCIgKSB7IC8vIGN1cnNvciBvcHRpb25cclxuXHRcdFx0Ym9keSA9IHRoaXMuZG9jdW1lbnQuZmluZCggXCJib2R5XCIgKTtcclxuXHJcblx0XHRcdC8vIHN1cHBvcnQ6IElFXHJcblx0XHRcdHRoaXMuc3RvcmVkQ3Vyc29yID0gYm9keS5jc3MoIFwiY3Vyc29yXCIgKTtcclxuXHRcdFx0Ym9keS5jc3MoIFwiY3Vyc29yXCIsIG8uY3Vyc29yICk7XHJcblxyXG5cdFx0XHR0aGlzLnN0b3JlZFN0eWxlc2hlZXQgPSAkKCBcIjxzdHlsZT4qeyBjdXJzb3I6IFwiK28uY3Vyc29yK1wiICFpbXBvcnRhbnQ7IH08L3N0eWxlPlwiICkuYXBwZW5kVG8oIGJvZHkgKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihvLm9wYWNpdHkpIHsgLy8gb3BhY2l0eSBvcHRpb25cclxuXHRcdFx0aWYgKHRoaXMuaGVscGVyLmNzcyhcIm9wYWNpdHlcIikpIHtcclxuXHRcdFx0XHR0aGlzLl9zdG9yZWRPcGFjaXR5ID0gdGhpcy5oZWxwZXIuY3NzKFwib3BhY2l0eVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmhlbHBlci5jc3MoXCJvcGFjaXR5XCIsIG8ub3BhY2l0eSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoby56SW5kZXgpIHsgLy8gekluZGV4IG9wdGlvblxyXG5cdFx0XHRpZiAodGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIpKSB7XHJcblx0XHRcdFx0dGhpcy5fc3RvcmVkWkluZGV4ID0gdGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuaGVscGVyLmNzcyhcInpJbmRleFwiLCBvLnpJbmRleCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9QcmVwYXJlIHNjcm9sbGluZ1xyXG5cdFx0aWYodGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgdGhpcy5zY3JvbGxQYXJlbnRbMF0udGFnTmFtZSAhPT0gXCJIVE1MXCIpIHtcclxuXHRcdFx0dGhpcy5vdmVyZmxvd09mZnNldCA9IHRoaXMuc2Nyb2xsUGFyZW50Lm9mZnNldCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vQ2FsbCBjYWxsYmFja3NcclxuXHRcdHRoaXMuX3RyaWdnZXIoXCJzdGFydFwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkpO1xyXG5cclxuXHRcdC8vUmVjYWNoZSB0aGUgaGVscGVyIHNpemVcclxuXHRcdGlmKCF0aGlzLl9wcmVzZXJ2ZUhlbHBlclByb3BvcnRpb25zKSB7XHJcblx0XHRcdHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0Ly9Qb3N0IFwiYWN0aXZhdGVcIiBldmVudHMgdG8gcG9zc2libGUgY29udGFpbmVyc1xyXG5cdFx0aWYoICFub0FjdGl2YXRpb24gKSB7XHJcblx0XHRcdGZvciAoIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0gKSB7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJzWyBpIF0uX3RyaWdnZXIoIFwiYWN0aXZhdGVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCggdGhpcyApICk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvL1ByZXBhcmUgcG9zc2libGUgZHJvcHBhYmxlc1xyXG5cdFx0aWYoJC51aS5kZG1hbmFnZXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIuY3VycmVudCA9IHRoaXM7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCQudWkuZGRtYW5hZ2VyICYmICFvLmRyb3BCZWhhdmlvdXIpIHtcclxuXHRcdFx0JC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHModGhpcywgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZHJhZ2dpbmcgPSB0cnVlO1xyXG5cclxuXHRcdHRoaXMuaGVscGVyLmFkZENsYXNzKFwidWktc29ydGFibGUtaGVscGVyXCIpO1xyXG5cdFx0dGhpcy5fbW91c2VEcmFnKGV2ZW50KTsgLy9FeGVjdXRlIHRoZSBkcmFnIG9uY2UgLSB0aGlzIGNhdXNlcyB0aGUgaGVscGVyIG5vdCB0byBiZSB2aXNpYmxlIGJlZm9yZSBnZXR0aW5nIGl0cyBjb3JyZWN0IHBvc2l0aW9uXHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHJcblx0fSxcclxuXHJcblx0X21vdXNlRHJhZzogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdHZhciBpLCBpdGVtLCBpdGVtRWxlbWVudCwgaW50ZXJzZWN0aW9uLFxyXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zLFxyXG5cdFx0XHRzY3JvbGxlZCA9IGZhbHNlO1xyXG5cclxuXHRcdC8vQ29tcHV0ZSB0aGUgaGVscGVycyBwb3NpdGlvblxyXG5cdFx0dGhpcy5wb3NpdGlvbiA9IHRoaXMuX2dlbmVyYXRlUG9zaXRpb24oZXZlbnQpO1xyXG5cdFx0dGhpcy5wb3NpdGlvbkFicyA9IHRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKFwiYWJzb2x1dGVcIik7XHJcblxyXG5cdFx0aWYgKCF0aGlzLmxhc3RQb3NpdGlvbkFicykge1xyXG5cdFx0XHR0aGlzLmxhc3RQb3NpdGlvbkFicyA9IHRoaXMucG9zaXRpb25BYnM7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9EbyBzY3JvbGxpbmdcclxuXHRcdGlmKHRoaXMub3B0aW9ucy5zY3JvbGwpIHtcclxuXHRcdFx0aWYodGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgdGhpcy5zY3JvbGxQYXJlbnRbMF0udGFnTmFtZSAhPT0gXCJIVE1MXCIpIHtcclxuXHJcblx0XHRcdFx0aWYoKHRoaXMub3ZlcmZsb3dPZmZzZXQudG9wICsgdGhpcy5zY3JvbGxQYXJlbnRbMF0ub2Zmc2V0SGVpZ2h0KSAtIGV2ZW50LnBhZ2VZIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0dGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wID0gc2Nyb2xsZWQgPSB0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AgKyBvLnNjcm9sbFNwZWVkO1xyXG5cdFx0XHRcdH0gZWxzZSBpZihldmVudC5wYWdlWSAtIHRoaXMub3ZlcmZsb3dPZmZzZXQudG9wIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0dGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsVG9wID0gc2Nyb2xsZWQgPSB0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AgLSBvLnNjcm9sbFNwZWVkO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYoKHRoaXMub3ZlcmZsb3dPZmZzZXQubGVmdCArIHRoaXMuc2Nyb2xsUGFyZW50WzBdLm9mZnNldFdpZHRoKSAtIGV2ZW50LnBhZ2VYIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0dGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID0gdGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdCArIG8uc2Nyb2xsU3BlZWQ7XHJcblx0XHRcdFx0fSBlbHNlIGlmKGV2ZW50LnBhZ2VYIC0gdGhpcy5vdmVyZmxvd09mZnNldC5sZWZ0IDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0dGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdCA9IHNjcm9sbGVkID0gdGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdCAtIG8uc2Nyb2xsU3BlZWQ7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdFx0aWYoZXZlbnQucGFnZVkgLSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCh0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpIC0gby5zY3JvbGxTcGVlZCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKHRoaXMud2luZG93LmhlaWdodCgpIC0gKGV2ZW50LnBhZ2VZIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKSkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHRzY3JvbGxlZCA9IHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKHRoaXMuZG9jdW1lbnQuc2Nyb2xsVG9wKCkgKyBvLnNjcm9sbFNwZWVkKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmKGV2ZW50LnBhZ2VYIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkgPCBvLnNjcm9sbFNlbnNpdGl2aXR5KSB7XHJcblx0XHRcdFx0XHRzY3JvbGxlZCA9IHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCh0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSAtIG8uc2Nyb2xsU3BlZWQpO1xyXG5cdFx0XHRcdH0gZWxzZSBpZih0aGlzLndpbmRvdy53aWR0aCgpIC0gKGV2ZW50LnBhZ2VYIC0gdGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkpIDwgby5zY3JvbGxTZW5zaXRpdml0eSkge1xyXG5cdFx0XHRcdFx0c2Nyb2xsZWQgPSB0aGlzLmRvY3VtZW50LnNjcm9sbExlZnQodGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCkgKyBvLnNjcm9sbFNwZWVkKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZihzY3JvbGxlZCAhPT0gZmFsc2UgJiYgJC51aS5kZG1hbmFnZXIgJiYgIW8uZHJvcEJlaGF2aW91cikge1xyXG5cdFx0XHRcdCQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKHRoaXMsIGV2ZW50KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vUmVnZW5lcmF0ZSB0aGUgYWJzb2x1dGUgcG9zaXRpb24gdXNlZCBmb3IgcG9zaXRpb24gY2hlY2tzXHJcblx0XHR0aGlzLnBvc2l0aW9uQWJzID0gdGhpcy5fY29udmVydFBvc2l0aW9uVG8oXCJhYnNvbHV0ZVwiKTtcclxuXHJcblx0XHQvL1NldCB0aGUgaGVscGVyIHBvc2l0aW9uXHJcblx0XHRpZighdGhpcy5vcHRpb25zLmF4aXMgfHwgdGhpcy5vcHRpb25zLmF4aXMgIT09IFwieVwiKSB7XHJcblx0XHRcdHRoaXMuaGVscGVyWzBdLnN0eWxlLmxlZnQgPSB0aGlzLnBvc2l0aW9uLmxlZnQrXCJweFwiO1xyXG5cdFx0fVxyXG5cdFx0aWYoIXRoaXMub3B0aW9ucy5heGlzIHx8IHRoaXMub3B0aW9ucy5heGlzICE9PSBcInhcIikge1xyXG5cdFx0XHR0aGlzLmhlbHBlclswXS5zdHlsZS50b3AgPSB0aGlzLnBvc2l0aW9uLnRvcCtcInB4XCI7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9SZWFycmFuZ2VcclxuXHRcdGZvciAoaSA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuXHJcblx0XHRcdC8vQ2FjaGUgdmFyaWFibGVzIGFuZCBpbnRlcnNlY3Rpb24sIGNvbnRpbnVlIGlmIG5vIGludGVyc2VjdGlvblxyXG5cdFx0XHRpdGVtID0gdGhpcy5pdGVtc1tpXTtcclxuXHRcdFx0aXRlbUVsZW1lbnQgPSBpdGVtLml0ZW1bMF07XHJcblx0XHRcdGludGVyc2VjdGlvbiA9IHRoaXMuX2ludGVyc2VjdHNXaXRoUG9pbnRlcihpdGVtKTtcclxuXHRcdFx0aWYgKCFpbnRlcnNlY3Rpb24pIHtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gT25seSBwdXQgdGhlIHBsYWNlaG9sZGVyIGluc2lkZSB0aGUgY3VycmVudCBDb250YWluZXIsIHNraXAgYWxsXHJcblx0XHRcdC8vIGl0ZW1zIGZyb20gb3RoZXIgY29udGFpbmVycy4gVGhpcyB3b3JrcyBiZWNhdXNlIHdoZW4gbW92aW5nXHJcblx0XHRcdC8vIGFuIGl0ZW0gZnJvbSBvbmUgY29udGFpbmVyIHRvIGFub3RoZXIgdGhlXHJcblx0XHRcdC8vIGN1cnJlbnRDb250YWluZXIgaXMgc3dpdGNoZWQgYmVmb3JlIHRoZSBwbGFjZWhvbGRlciBpcyBtb3ZlZC5cclxuXHRcdFx0Ly9cclxuXHRcdFx0Ly8gV2l0aG91dCB0aGlzLCBtb3ZpbmcgaXRlbXMgaW4gXCJzdWItc29ydGFibGVzXCIgY2FuIGNhdXNlXHJcblx0XHRcdC8vIHRoZSBwbGFjZWhvbGRlciB0byBqaXR0ZXIgYmV0d2VlbiB0aGUgb3V0ZXIgYW5kIGlubmVyIGNvbnRhaW5lci5cclxuXHRcdFx0aWYgKGl0ZW0uaW5zdGFuY2UgIT09IHRoaXMuY3VycmVudENvbnRhaW5lcikge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBjYW5ub3QgaW50ZXJzZWN0IHdpdGggaXRzZWxmXHJcblx0XHRcdC8vIG5vIHVzZWxlc3MgYWN0aW9ucyB0aGF0IGhhdmUgYmVlbiBkb25lIGJlZm9yZVxyXG5cdFx0XHQvLyBubyBhY3Rpb24gaWYgdGhlIGl0ZW0gbW92ZWQgaXMgdGhlIHBhcmVudCBvZiB0aGUgaXRlbSBjaGVja2VkXHJcblx0XHRcdGlmIChpdGVtRWxlbWVudCAhPT0gdGhpcy5jdXJyZW50SXRlbVswXSAmJlxyXG5cdFx0XHRcdHRoaXMucGxhY2Vob2xkZXJbaW50ZXJzZWN0aW9uID09PSAxID8gXCJuZXh0XCIgOiBcInByZXZcIl0oKVswXSAhPT0gaXRlbUVsZW1lbnQgJiZcclxuXHRcdFx0XHQhJC5jb250YWlucyh0aGlzLnBsYWNlaG9sZGVyWzBdLCBpdGVtRWxlbWVudCkgJiZcclxuXHRcdFx0XHQodGhpcy5vcHRpb25zLnR5cGUgPT09IFwic2VtaS1keW5hbWljXCIgPyAhJC5jb250YWlucyh0aGlzLmVsZW1lbnRbMF0sIGl0ZW1FbGVtZW50KSA6IHRydWUpXHJcblx0XHRcdCkge1xyXG5cclxuXHRcdFx0XHR0aGlzLmRpcmVjdGlvbiA9IGludGVyc2VjdGlvbiA9PT0gMSA/IFwiZG93blwiIDogXCJ1cFwiO1xyXG5cclxuXHRcdFx0XHRpZiAodGhpcy5vcHRpb25zLnRvbGVyYW5jZSA9PT0gXCJwb2ludGVyXCIgfHwgdGhpcy5faW50ZXJzZWN0c1dpdGhTaWRlcyhpdGVtKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fcmVhcnJhbmdlKGV2ZW50LCBpdGVtKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0aGlzLl90cmlnZ2VyKFwiY2hhbmdlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvL1Bvc3QgZXZlbnRzIHRvIGNvbnRhaW5lcnNcclxuXHRcdHRoaXMuX2NvbnRhY3RDb250YWluZXJzKGV2ZW50KTtcclxuXHJcblx0XHQvL0ludGVyY29ubmVjdCB3aXRoIGRyb3BwYWJsZXNcclxuXHRcdGlmKCQudWkuZGRtYW5hZ2VyKSB7XHJcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyYWcodGhpcywgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vQ2FsbCBjYWxsYmFja3NcclxuXHRcdHRoaXMuX3RyaWdnZXIoXCJzb3J0XCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSk7XHJcblxyXG5cdFx0dGhpcy5sYXN0UG9zaXRpb25BYnMgPSB0aGlzLnBvc2l0aW9uQWJzO1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfbW91c2VTdG9wOiBmdW5jdGlvbihldmVudCwgbm9Qcm9wYWdhdGlvbikge1xyXG5cclxuXHRcdGlmKCFldmVudCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9JZiB3ZSBhcmUgdXNpbmcgZHJvcHBhYmxlcywgaW5mb3JtIHRoZSBtYW5hZ2VyIGFib3V0IHRoZSBkcm9wXHJcblx0XHRpZiAoJC51aS5kZG1hbmFnZXIgJiYgIXRoaXMub3B0aW9ucy5kcm9wQmVoYXZpb3VyKSB7XHJcblx0XHRcdCQudWkuZGRtYW5hZ2VyLmRyb3AodGhpcywgZXZlbnQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMub3B0aW9ucy5yZXZlcnQpIHtcclxuXHRcdFx0dmFyIHRoYXQgPSB0aGlzLFxyXG5cdFx0XHRcdGN1ciA9IHRoaXMucGxhY2Vob2xkZXIub2Zmc2V0KCksXHJcblx0XHRcdFx0YXhpcyA9IHRoaXMub3B0aW9ucy5heGlzLFxyXG5cdFx0XHRcdGFuaW1hdGlvbiA9IHt9O1xyXG5cclxuXHRcdFx0aWYgKCAhYXhpcyB8fCBheGlzID09PSBcInhcIiApIHtcclxuXHRcdFx0XHRhbmltYXRpb24ubGVmdCA9IGN1ci5sZWZ0IC0gdGhpcy5vZmZzZXQucGFyZW50LmxlZnQgLSB0aGlzLm1hcmdpbnMubGVmdCArICh0aGlzLm9mZnNldFBhcmVudFswXSA9PT0gdGhpcy5kb2N1bWVudFswXS5ib2R5ID8gMCA6IHRoaXMub2Zmc2V0UGFyZW50WzBdLnNjcm9sbExlZnQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICggIWF4aXMgfHwgYXhpcyA9PT0gXCJ5XCIgKSB7XHJcblx0XHRcdFx0YW5pbWF0aW9uLnRvcCA9IGN1ci50b3AgLSB0aGlzLm9mZnNldC5wYXJlbnQudG9wIC0gdGhpcy5tYXJnaW5zLnRvcCArICh0aGlzLm9mZnNldFBhcmVudFswXSA9PT0gdGhpcy5kb2N1bWVudFswXS5ib2R5ID8gMCA6IHRoaXMub2Zmc2V0UGFyZW50WzBdLnNjcm9sbFRvcCk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5yZXZlcnRpbmcgPSB0cnVlO1xyXG5cdFx0XHQkKHRoaXMuaGVscGVyKS5hbmltYXRlKCBhbmltYXRpb24sIHBhcnNlSW50KHRoaXMub3B0aW9ucy5yZXZlcnQsIDEwKSB8fCA1MDAsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRoYXQuX2NsZWFyKGV2ZW50KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLl9jbGVhcihldmVudCwgbm9Qcm9wYWdhdGlvbik7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cclxuXHR9LFxyXG5cclxuXHRjYW5jZWw6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdGlmKHRoaXMuZHJhZ2dpbmcpIHtcclxuXHJcblx0XHRcdHRoaXMuX21vdXNlVXAoeyB0YXJnZXQ6IG51bGwgfSk7XHJcblxyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMuaGVscGVyID09PSBcIm9yaWdpbmFsXCIpIHtcclxuXHRcdFx0XHR0aGlzLmN1cnJlbnRJdGVtLmNzcyh0aGlzLl9zdG9yZWRDU1MpLnJlbW92ZUNsYXNzKFwidWktc29ydGFibGUtaGVscGVyXCIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuY3VycmVudEl0ZW0uc2hvdygpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvL1Bvc3QgZGVhY3RpdmF0aW5nIGV2ZW50cyB0byBjb250YWluZXJzXHJcblx0XHRcdGZvciAodmFyIGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5fdHJpZ2dlcihcImRlYWN0aXZhdGVcIiwgbnVsbCwgdGhpcy5fdWlIYXNoKHRoaXMpKTtcclxuXHRcdFx0XHRpZih0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUub3Zlcikge1xyXG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLl90cmlnZ2VyKFwib3V0XCIsIG51bGwsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XHJcblx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUub3ZlciA9IDA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnBsYWNlaG9sZGVyKSB7XHJcblx0XHRcdC8vJCh0aGlzLnBsYWNlaG9sZGVyWzBdKS5yZW1vdmUoKTsgd291bGQgaGF2ZSBiZWVuIHRoZSBqUXVlcnkgd2F5IC0gdW5mb3J0dW5hdGVseSwgaXQgdW5iaW5kcyBBTEwgZXZlbnRzIGZyb20gdGhlIG9yaWdpbmFsIG5vZGUhXHJcblx0XHRcdGlmKHRoaXMucGxhY2Vob2xkZXJbMF0ucGFyZW50Tm9kZSkge1xyXG5cdFx0XHRcdHRoaXMucGxhY2Vob2xkZXJbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnBsYWNlaG9sZGVyWzBdKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih0aGlzLm9wdGlvbnMuaGVscGVyICE9PSBcIm9yaWdpbmFsXCIgJiYgdGhpcy5oZWxwZXIgJiYgdGhpcy5oZWxwZXJbMF0ucGFyZW50Tm9kZSkge1xyXG5cdFx0XHRcdHRoaXMuaGVscGVyLnJlbW92ZSgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQkLmV4dGVuZCh0aGlzLCB7XHJcblx0XHRcdFx0aGVscGVyOiBudWxsLFxyXG5cdFx0XHRcdGRyYWdnaW5nOiBmYWxzZSxcclxuXHRcdFx0XHRyZXZlcnRpbmc6IGZhbHNlLFxyXG5cdFx0XHRcdF9ub0ZpbmFsU29ydDogbnVsbFxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGlmKHRoaXMuZG9tUG9zaXRpb24ucHJldikge1xyXG5cdFx0XHRcdCQodGhpcy5kb21Qb3NpdGlvbi5wcmV2KS5hZnRlcih0aGlzLmN1cnJlbnRJdGVtKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkKHRoaXMuZG9tUG9zaXRpb24ucGFyZW50KS5wcmVwZW5kKHRoaXMuY3VycmVudEl0ZW0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblxyXG5cdH0sXHJcblxyXG5cdHNlcmlhbGl6ZTogZnVuY3Rpb24obykge1xyXG5cclxuXHRcdHZhciBpdGVtcyA9IHRoaXMuX2dldEl0ZW1zQXNqUXVlcnkobyAmJiBvLmNvbm5lY3RlZCksXHJcblx0XHRcdHN0ciA9IFtdO1xyXG5cdFx0byA9IG8gfHwge307XHJcblxyXG5cdFx0JChpdGVtcykuZWFjaChmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIHJlcyA9ICgkKG8uaXRlbSB8fCB0aGlzKS5hdHRyKG8uYXR0cmlidXRlIHx8IFwiaWRcIikgfHwgXCJcIikubWF0Y2goby5leHByZXNzaW9uIHx8ICgvKC4rKVtcXC09X10oLispLykpO1xyXG5cdFx0XHRpZiAocmVzKSB7XHJcblx0XHRcdFx0c3RyLnB1c2goKG8ua2V5IHx8IHJlc1sxXStcIltdXCIpK1wiPVwiKyhvLmtleSAmJiBvLmV4cHJlc3Npb24gPyByZXNbMV0gOiByZXNbMl0pKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0aWYoIXN0ci5sZW5ndGggJiYgby5rZXkpIHtcclxuXHRcdFx0c3RyLnB1c2goby5rZXkgKyBcIj1cIik7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHN0ci5qb2luKFwiJlwiKTtcclxuXHJcblx0fSxcclxuXHJcblx0dG9BcnJheTogZnVuY3Rpb24obykge1xyXG5cclxuXHRcdHZhciBpdGVtcyA9IHRoaXMuX2dldEl0ZW1zQXNqUXVlcnkobyAmJiBvLmNvbm5lY3RlZCksXHJcblx0XHRcdHJldCA9IFtdO1xyXG5cclxuXHRcdG8gPSBvIHx8IHt9O1xyXG5cclxuXHRcdGl0ZW1zLmVhY2goZnVuY3Rpb24oKSB7IHJldC5wdXNoKCQoby5pdGVtIHx8IHRoaXMpLmF0dHIoby5hdHRyaWJ1dGUgfHwgXCJpZFwiKSB8fCBcIlwiKTsgfSk7XHJcblx0XHRyZXR1cm4gcmV0O1xyXG5cclxuXHR9LFxyXG5cclxuXHQvKiBCZSBjYXJlZnVsIHdpdGggdGhlIGZvbGxvd2luZyBjb3JlIGZ1bmN0aW9ucyAqL1xyXG5cdF9pbnRlcnNlY3RzV2l0aDogZnVuY3Rpb24oaXRlbSkge1xyXG5cclxuXHRcdHZhciB4MSA9IHRoaXMucG9zaXRpb25BYnMubGVmdCxcclxuXHRcdFx0eDIgPSB4MSArIHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgsXHJcblx0XHRcdHkxID0gdGhpcy5wb3NpdGlvbkFicy50b3AsXHJcblx0XHRcdHkyID0geTEgKyB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxcclxuXHRcdFx0bCA9IGl0ZW0ubGVmdCxcclxuXHRcdFx0ciA9IGwgKyBpdGVtLndpZHRoLFxyXG5cdFx0XHR0ID0gaXRlbS50b3AsXHJcblx0XHRcdGIgPSB0ICsgaXRlbS5oZWlnaHQsXHJcblx0XHRcdGR5Q2xpY2sgPSB0aGlzLm9mZnNldC5jbGljay50b3AsXHJcblx0XHRcdGR4Q2xpY2sgPSB0aGlzLm9mZnNldC5jbGljay5sZWZ0LFxyXG5cdFx0XHRpc092ZXJFbGVtZW50SGVpZ2h0ID0gKCB0aGlzLm9wdGlvbnMuYXhpcyA9PT0gXCJ4XCIgKSB8fCAoICggeTEgKyBkeUNsaWNrICkgPiB0ICYmICggeTEgKyBkeUNsaWNrICkgPCBiICksXHJcblx0XHRcdGlzT3ZlckVsZW1lbnRXaWR0aCA9ICggdGhpcy5vcHRpb25zLmF4aXMgPT09IFwieVwiICkgfHwgKCAoIHgxICsgZHhDbGljayApID4gbCAmJiAoIHgxICsgZHhDbGljayApIDwgciApLFxyXG5cdFx0XHRpc092ZXJFbGVtZW50ID0gaXNPdmVyRWxlbWVudEhlaWdodCAmJiBpc092ZXJFbGVtZW50V2lkdGg7XHJcblxyXG5cdFx0aWYgKCB0aGlzLm9wdGlvbnMudG9sZXJhbmNlID09PSBcInBvaW50ZXJcIiB8fFxyXG5cdFx0XHR0aGlzLm9wdGlvbnMuZm9yY2VQb2ludGVyRm9yQ29udGFpbmVycyB8fFxyXG5cdFx0XHQodGhpcy5vcHRpb25zLnRvbGVyYW5jZSAhPT0gXCJwb2ludGVyXCIgJiYgdGhpcy5oZWxwZXJQcm9wb3J0aW9uc1t0aGlzLmZsb2F0aW5nID8gXCJ3aWR0aFwiIDogXCJoZWlnaHRcIl0gPiBpdGVtW3RoaXMuZmxvYXRpbmcgPyBcIndpZHRoXCIgOiBcImhlaWdodFwiXSlcclxuXHRcdCkge1xyXG5cdFx0XHRyZXR1cm4gaXNPdmVyRWxlbWVudDtcclxuXHRcdH0gZWxzZSB7XHJcblxyXG5cdFx0XHRyZXR1cm4gKGwgPCB4MSArICh0aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoIC8gMikgJiYgLy8gUmlnaHQgSGFsZlxyXG5cdFx0XHRcdHgyIC0gKHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLyAyKSA8IHIgJiYgLy8gTGVmdCBIYWxmXHJcblx0XHRcdFx0dCA8IHkxICsgKHRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0IC8gMikgJiYgLy8gQm90dG9tIEhhbGZcclxuXHRcdFx0XHR5MiAtICh0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAvIDIpIDwgYiApOyAvLyBUb3AgSGFsZlxyXG5cclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHRfaW50ZXJzZWN0c1dpdGhQb2ludGVyOiBmdW5jdGlvbihpdGVtKSB7XHJcblxyXG5cdFx0dmFyIGlzT3ZlckVsZW1lbnRIZWlnaHQgPSAodGhpcy5vcHRpb25zLmF4aXMgPT09IFwieFwiKSB8fCB0aGlzLl9pc092ZXJBeGlzKHRoaXMucG9zaXRpb25BYnMudG9wICsgdGhpcy5vZmZzZXQuY2xpY2sudG9wLCBpdGVtLnRvcCwgaXRlbS5oZWlnaHQpLFxyXG5cdFx0XHRpc092ZXJFbGVtZW50V2lkdGggPSAodGhpcy5vcHRpb25zLmF4aXMgPT09IFwieVwiKSB8fCB0aGlzLl9pc092ZXJBeGlzKHRoaXMucG9zaXRpb25BYnMubGVmdCArIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQsIGl0ZW0ubGVmdCwgaXRlbS53aWR0aCksXHJcblx0XHRcdGlzT3ZlckVsZW1lbnQgPSBpc092ZXJFbGVtZW50SGVpZ2h0ICYmIGlzT3ZlckVsZW1lbnRXaWR0aCxcclxuXHRcdFx0dmVydGljYWxEaXJlY3Rpb24gPSB0aGlzLl9nZXREcmFnVmVydGljYWxEaXJlY3Rpb24oKSxcclxuXHRcdFx0aG9yaXpvbnRhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uKCk7XHJcblxyXG5cdFx0aWYgKCFpc092ZXJFbGVtZW50KSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5mbG9hdGluZyA/XHJcblx0XHRcdCggKChob3Jpem9udGFsRGlyZWN0aW9uICYmIGhvcml6b250YWxEaXJlY3Rpb24gPT09IFwicmlnaHRcIikgfHwgdmVydGljYWxEaXJlY3Rpb24gPT09IFwiZG93blwiKSA/IDIgOiAxIClcclxuXHRcdFx0OiAoIHZlcnRpY2FsRGlyZWN0aW9uICYmICh2ZXJ0aWNhbERpcmVjdGlvbiA9PT0gXCJkb3duXCIgPyAyIDogMSkgKTtcclxuXHJcblx0fSxcclxuXHJcblx0X2ludGVyc2VjdHNXaXRoU2lkZXM6IGZ1bmN0aW9uKGl0ZW0pIHtcclxuXHJcblx0XHR2YXIgaXNPdmVyQm90dG9tSGFsZiA9IHRoaXMuX2lzT3ZlckF4aXModGhpcy5wb3NpdGlvbkFicy50b3AgKyB0aGlzLm9mZnNldC5jbGljay50b3AsIGl0ZW0udG9wICsgKGl0ZW0uaGVpZ2h0LzIpLCBpdGVtLmhlaWdodCksXHJcblx0XHRcdGlzT3ZlclJpZ2h0SGFsZiA9IHRoaXMuX2lzT3ZlckF4aXModGhpcy5wb3NpdGlvbkFicy5sZWZ0ICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdCwgaXRlbS5sZWZ0ICsgKGl0ZW0ud2lkdGgvMiksIGl0ZW0ud2lkdGgpLFxyXG5cdFx0XHR2ZXJ0aWNhbERpcmVjdGlvbiA9IHRoaXMuX2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbigpLFxyXG5cdFx0XHRob3Jpem9udGFsRGlyZWN0aW9uID0gdGhpcy5fZ2V0RHJhZ0hvcml6b250YWxEaXJlY3Rpb24oKTtcclxuXHJcblx0XHRpZiAodGhpcy5mbG9hdGluZyAmJiBob3Jpem9udGFsRGlyZWN0aW9uKSB7XHJcblx0XHRcdHJldHVybiAoKGhvcml6b250YWxEaXJlY3Rpb24gPT09IFwicmlnaHRcIiAmJiBpc092ZXJSaWdodEhhbGYpIHx8IChob3Jpem9udGFsRGlyZWN0aW9uID09PSBcImxlZnRcIiAmJiAhaXNPdmVyUmlnaHRIYWxmKSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZXR1cm4gdmVydGljYWxEaXJlY3Rpb24gJiYgKCh2ZXJ0aWNhbERpcmVjdGlvbiA9PT0gXCJkb3duXCIgJiYgaXNPdmVyQm90dG9tSGFsZikgfHwgKHZlcnRpY2FsRGlyZWN0aW9uID09PSBcInVwXCIgJiYgIWlzT3ZlckJvdHRvbUhhbGYpKTtcclxuXHRcdH1cclxuXHJcblx0fSxcclxuXHJcblx0X2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbjogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZGVsdGEgPSB0aGlzLnBvc2l0aW9uQWJzLnRvcCAtIHRoaXMubGFzdFBvc2l0aW9uQWJzLnRvcDtcclxuXHRcdHJldHVybiBkZWx0YSAhPT0gMCAmJiAoZGVsdGEgPiAwID8gXCJkb3duXCIgOiBcInVwXCIpO1xyXG5cdH0sXHJcblxyXG5cdF9nZXREcmFnSG9yaXpvbnRhbERpcmVjdGlvbjogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZGVsdGEgPSB0aGlzLnBvc2l0aW9uQWJzLmxlZnQgLSB0aGlzLmxhc3RQb3NpdGlvbkFicy5sZWZ0O1xyXG5cdFx0cmV0dXJuIGRlbHRhICE9PSAwICYmIChkZWx0YSA+IDAgPyBcInJpZ2h0XCIgOiBcImxlZnRcIik7XHJcblx0fSxcclxuXHJcblx0cmVmcmVzaDogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdHRoaXMuX3JlZnJlc2hJdGVtcyhldmVudCk7XHJcblx0XHR0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKTtcclxuXHRcdHRoaXMucmVmcmVzaFBvc2l0aW9ucygpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X2Nvbm5lY3RXaXRoOiBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xyXG5cdFx0cmV0dXJuIG9wdGlvbnMuY29ubmVjdFdpdGguY29uc3RydWN0b3IgPT09IFN0cmluZyA/IFtvcHRpb25zLmNvbm5lY3RXaXRoXSA6IG9wdGlvbnMuY29ubmVjdFdpdGg7XHJcblx0fSxcclxuXHJcblx0X2dldEl0ZW1zQXNqUXVlcnk6IGZ1bmN0aW9uKGNvbm5lY3RlZCkge1xyXG5cclxuXHRcdHZhciBpLCBqLCBjdXIsIGluc3QsXHJcblx0XHRcdGl0ZW1zID0gW10sXHJcblx0XHRcdHF1ZXJpZXMgPSBbXSxcclxuXHRcdFx0Y29ubmVjdFdpdGggPSB0aGlzLl9jb25uZWN0V2l0aCgpO1xyXG5cclxuXHRcdGlmKGNvbm5lY3RXaXRoICYmIGNvbm5lY3RlZCkge1xyXG5cdFx0XHRmb3IgKGkgPSBjb25uZWN0V2l0aC5sZW5ndGggLSAxOyBpID49IDA7IGktLSl7XHJcblx0XHRcdFx0Y3VyID0gJChjb25uZWN0V2l0aFtpXSwgdGhpcy5kb2N1bWVudFswXSk7XHJcblx0XHRcdFx0Zm9yICggaiA9IGN1ci5sZW5ndGggLSAxOyBqID49IDA7IGotLSl7XHJcblx0XHRcdFx0XHRpbnN0ID0gJC5kYXRhKGN1cltqXSwgdGhpcy53aWRnZXRGdWxsTmFtZSk7XHJcblx0XHRcdFx0XHRpZihpbnN0ICYmIGluc3QgIT09IHRoaXMgJiYgIWluc3Qub3B0aW9ucy5kaXNhYmxlZCkge1xyXG5cdFx0XHRcdFx0XHRxdWVyaWVzLnB1c2goWyQuaXNGdW5jdGlvbihpbnN0Lm9wdGlvbnMuaXRlbXMpID8gaW5zdC5vcHRpb25zLml0ZW1zLmNhbGwoaW5zdC5lbGVtZW50KSA6ICQoaW5zdC5vcHRpb25zLml0ZW1zLCBpbnN0LmVsZW1lbnQpLm5vdChcIi51aS1zb3J0YWJsZS1oZWxwZXJcIikubm90KFwiLnVpLXNvcnRhYmxlLXBsYWNlaG9sZGVyXCIpLCBpbnN0XSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cXVlcmllcy5wdXNoKFskLmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLml0ZW1zKSA/IHRoaXMub3B0aW9ucy5pdGVtcy5jYWxsKHRoaXMuZWxlbWVudCwgbnVsbCwgeyBvcHRpb25zOiB0aGlzLm9wdGlvbnMsIGl0ZW06IHRoaXMuY3VycmVudEl0ZW0gfSkgOiAkKHRoaXMub3B0aW9ucy5pdGVtcywgdGhpcy5lbGVtZW50KS5ub3QoXCIudWktc29ydGFibGUtaGVscGVyXCIpLm5vdChcIi51aS1zb3J0YWJsZS1wbGFjZWhvbGRlclwiKSwgdGhpc10pO1xyXG5cclxuXHRcdGZ1bmN0aW9uIGFkZEl0ZW1zKCkge1xyXG5cdFx0XHRpdGVtcy5wdXNoKCB0aGlzICk7XHJcblx0XHR9XHJcblx0XHRmb3IgKGkgPSBxdWVyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcclxuXHRcdFx0cXVlcmllc1tpXVswXS5lYWNoKCBhZGRJdGVtcyApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiAkKGl0ZW1zKTtcclxuXHJcblx0fSxcclxuXHJcblx0X3JlbW92ZUN1cnJlbnRzRnJvbUl0ZW1zOiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHR2YXIgbGlzdCA9IHRoaXMuY3VycmVudEl0ZW0uZmluZChcIjpkYXRhKFwiICsgdGhpcy53aWRnZXROYW1lICsgXCItaXRlbSlcIik7XHJcblxyXG5cdFx0dGhpcy5pdGVtcyA9ICQuZ3JlcCh0aGlzLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xyXG5cdFx0XHRmb3IgKHZhciBqPTA7IGogPCBsaXN0Lmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0aWYobGlzdFtqXSA9PT0gaXRlbS5pdGVtWzBdKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fSk7XHJcblxyXG5cdH0sXHJcblxyXG5cdF9yZWZyZXNoSXRlbXM6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0dGhpcy5pdGVtcyA9IFtdO1xyXG5cdFx0dGhpcy5jb250YWluZXJzID0gW3RoaXNdO1xyXG5cclxuXHRcdHZhciBpLCBqLCBjdXIsIGluc3QsIHRhcmdldERhdGEsIF9xdWVyaWVzLCBpdGVtLCBxdWVyaWVzTGVuZ3RoLFxyXG5cdFx0XHRpdGVtcyA9IHRoaXMuaXRlbXMsXHJcblx0XHRcdHF1ZXJpZXMgPSBbWyQuaXNGdW5jdGlvbih0aGlzLm9wdGlvbnMuaXRlbXMpID8gdGhpcy5vcHRpb25zLml0ZW1zLmNhbGwodGhpcy5lbGVtZW50WzBdLCBldmVudCwgeyBpdGVtOiB0aGlzLmN1cnJlbnRJdGVtIH0pIDogJCh0aGlzLm9wdGlvbnMuaXRlbXMsIHRoaXMuZWxlbWVudCksIHRoaXNdXSxcclxuXHRcdFx0Y29ubmVjdFdpdGggPSB0aGlzLl9jb25uZWN0V2l0aCgpO1xyXG5cclxuXHRcdGlmKGNvbm5lY3RXaXRoICYmIHRoaXMucmVhZHkpIHsgLy9TaG91bGRuJ3QgYmUgcnVuIHRoZSBmaXJzdCB0aW1lIHRocm91Z2ggZHVlIHRvIG1hc3NpdmUgc2xvdy1kb3duXHJcblx0XHRcdGZvciAoaSA9IGNvbm5lY3RXaXRoLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcclxuXHRcdFx0XHRjdXIgPSAkKGNvbm5lY3RXaXRoW2ldLCB0aGlzLmRvY3VtZW50WzBdKTtcclxuXHRcdFx0XHRmb3IgKGogPSBjdXIubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pe1xyXG5cdFx0XHRcdFx0aW5zdCA9ICQuZGF0YShjdXJbal0sIHRoaXMud2lkZ2V0RnVsbE5hbWUpO1xyXG5cdFx0XHRcdFx0aWYoaW5zdCAmJiBpbnN0ICE9PSB0aGlzICYmICFpbnN0Lm9wdGlvbnMuZGlzYWJsZWQpIHtcclxuXHRcdFx0XHRcdFx0cXVlcmllcy5wdXNoKFskLmlzRnVuY3Rpb24oaW5zdC5vcHRpb25zLml0ZW1zKSA/IGluc3Qub3B0aW9ucy5pdGVtcy5jYWxsKGluc3QuZWxlbWVudFswXSwgZXZlbnQsIHsgaXRlbTogdGhpcy5jdXJyZW50SXRlbSB9KSA6ICQoaW5zdC5vcHRpb25zLml0ZW1zLCBpbnN0LmVsZW1lbnQpLCBpbnN0XSk7XHJcblx0XHRcdFx0XHRcdHRoaXMuY29udGFpbmVycy5wdXNoKGluc3QpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAoaSA9IHF1ZXJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuXHRcdFx0dGFyZ2V0RGF0YSA9IHF1ZXJpZXNbaV1bMV07XHJcblx0XHRcdF9xdWVyaWVzID0gcXVlcmllc1tpXVswXTtcclxuXHJcblx0XHRcdGZvciAoaj0wLCBxdWVyaWVzTGVuZ3RoID0gX3F1ZXJpZXMubGVuZ3RoOyBqIDwgcXVlcmllc0xlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0aXRlbSA9ICQoX3F1ZXJpZXNbal0pO1xyXG5cclxuXHRcdFx0XHRpdGVtLmRhdGEodGhpcy53aWRnZXROYW1lICsgXCItaXRlbVwiLCB0YXJnZXREYXRhKTsgLy8gRGF0YSBmb3IgdGFyZ2V0IGNoZWNraW5nIChtb3VzZSBtYW5hZ2VyKVxyXG5cclxuXHRcdFx0XHRpdGVtcy5wdXNoKHtcclxuXHRcdFx0XHRcdGl0ZW06IGl0ZW0sXHJcblx0XHRcdFx0XHRpbnN0YW5jZTogdGFyZ2V0RGF0YSxcclxuXHRcdFx0XHRcdHdpZHRoOiAwLCBoZWlnaHQ6IDAsXHJcblx0XHRcdFx0XHRsZWZ0OiAwLCB0b3A6IDBcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHR9LFxyXG5cclxuXHRyZWZyZXNoUG9zaXRpb25zOiBmdW5jdGlvbihmYXN0KSB7XHJcblxyXG5cdFx0Ly8gRGV0ZXJtaW5lIHdoZXRoZXIgaXRlbXMgYXJlIGJlaW5nIGRpc3BsYXllZCBob3Jpem9udGFsbHlcclxuXHRcdHRoaXMuZmxvYXRpbmcgPSB0aGlzLml0ZW1zLmxlbmd0aCA/XHJcblx0XHRcdHRoaXMub3B0aW9ucy5heGlzID09PSBcInhcIiB8fCB0aGlzLl9pc0Zsb2F0aW5nKCB0aGlzLml0ZW1zWyAwIF0uaXRlbSApIDpcclxuXHRcdFx0ZmFsc2U7XHJcblxyXG5cdFx0Ly9UaGlzIGhhcyB0byBiZSByZWRvbmUgYmVjYXVzZSBkdWUgdG8gdGhlIGl0ZW0gYmVpbmcgbW92ZWQgb3V0L2ludG8gdGhlIG9mZnNldFBhcmVudCwgdGhlIG9mZnNldFBhcmVudCdzIHBvc2l0aW9uIHdpbGwgY2hhbmdlXHJcblx0XHRpZih0aGlzLm9mZnNldFBhcmVudCAmJiB0aGlzLmhlbHBlcikge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQgPSB0aGlzLl9nZXRQYXJlbnRPZmZzZXQoKTtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgaSwgaXRlbSwgdCwgcDtcclxuXHJcblx0XHRmb3IgKGkgPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcclxuXHRcdFx0aXRlbSA9IHRoaXMuaXRlbXNbaV07XHJcblxyXG5cdFx0XHQvL1dlIGlnbm9yZSBjYWxjdWxhdGluZyBwb3NpdGlvbnMgb2YgYWxsIGNvbm5lY3RlZCBjb250YWluZXJzIHdoZW4gd2UncmUgbm90IG92ZXIgdGhlbVxyXG5cdFx0XHRpZihpdGVtLmluc3RhbmNlICE9PSB0aGlzLmN1cnJlbnRDb250YWluZXIgJiYgdGhpcy5jdXJyZW50Q29udGFpbmVyICYmIGl0ZW0uaXRlbVswXSAhPT0gdGhpcy5jdXJyZW50SXRlbVswXSkge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0ID0gdGhpcy5vcHRpb25zLnRvbGVyYW5jZUVsZW1lbnQgPyAkKHRoaXMub3B0aW9ucy50b2xlcmFuY2VFbGVtZW50LCBpdGVtLml0ZW0pIDogaXRlbS5pdGVtO1xyXG5cclxuXHRcdFx0aWYgKCFmYXN0KSB7XHJcblx0XHRcdFx0aXRlbS53aWR0aCA9IHQub3V0ZXJXaWR0aCgpO1xyXG5cdFx0XHRcdGl0ZW0uaGVpZ2h0ID0gdC5vdXRlckhlaWdodCgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRwID0gdC5vZmZzZXQoKTtcclxuXHRcdFx0aXRlbS5sZWZ0ID0gcC5sZWZ0O1xyXG5cdFx0XHRpdGVtLnRvcCA9IHAudG9wO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMub3B0aW9ucy5jdXN0b20gJiYgdGhpcy5vcHRpb25zLmN1c3RvbS5yZWZyZXNoQ29udGFpbmVycykge1xyXG5cdFx0XHR0aGlzLm9wdGlvbnMuY3VzdG9tLnJlZnJlc2hDb250YWluZXJzLmNhbGwodGhpcyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRmb3IgKGkgPSB0aGlzLmNvbnRhaW5lcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pe1xyXG5cdFx0XHRcdHAgPSB0aGlzLmNvbnRhaW5lcnNbaV0uZWxlbWVudC5vZmZzZXQoKTtcclxuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUubGVmdCA9IHAubGVmdDtcclxuXHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUudG9wID0gcC50b3A7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLndpZHRoID0gdGhpcy5jb250YWluZXJzW2ldLmVsZW1lbnQub3V0ZXJXaWR0aCgpO1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5oZWlnaHQgPSB0aGlzLmNvbnRhaW5lcnNbaV0uZWxlbWVudC5vdXRlckhlaWdodCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0X2NyZWF0ZVBsYWNlaG9sZGVyOiBmdW5jdGlvbih0aGF0KSB7XHJcblx0XHR0aGF0ID0gdGhhdCB8fCB0aGlzO1xyXG5cdFx0dmFyIGNsYXNzTmFtZSxcclxuXHRcdFx0byA9IHRoYXQub3B0aW9ucztcclxuXHJcblx0XHRpZighby5wbGFjZWhvbGRlciB8fCBvLnBsYWNlaG9sZGVyLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcclxuXHRcdFx0Y2xhc3NOYW1lID0gby5wbGFjZWhvbGRlcjtcclxuXHRcdFx0by5wbGFjZWhvbGRlciA9IHtcclxuXHRcdFx0XHRlbGVtZW50OiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdFx0XHR2YXIgbm9kZU5hbWUgPSB0aGF0LmN1cnJlbnRJdGVtWzBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksXHJcblx0XHRcdFx0XHRcdGVsZW1lbnQgPSAkKCBcIjxcIiArIG5vZGVOYW1lICsgXCI+XCIsIHRoYXQuZG9jdW1lbnRbMF0gKVxyXG5cdFx0XHRcdFx0XHRcdC5hZGRDbGFzcyhjbGFzc05hbWUgfHwgdGhhdC5jdXJyZW50SXRlbVswXS5jbGFzc05hbWUrXCIgdWktc29ydGFibGUtcGxhY2Vob2xkZXJcIilcclxuXHRcdFx0XHRcdFx0XHQucmVtb3ZlQ2xhc3MoXCJ1aS1zb3J0YWJsZS1oZWxwZXJcIik7XHJcblxyXG5cdFx0XHRcdFx0aWYgKCBub2RlTmFtZSA9PT0gXCJ0Ym9keVwiICkge1xyXG5cdFx0XHRcdFx0XHR0aGF0Ll9jcmVhdGVUclBsYWNlaG9sZGVyKFxyXG5cdFx0XHRcdFx0XHRcdHRoYXQuY3VycmVudEl0ZW0uZmluZCggXCJ0clwiICkuZXEoIDAgKSxcclxuXHRcdFx0XHRcdFx0XHQkKCBcIjx0cj5cIiwgdGhhdC5kb2N1bWVudFsgMCBdICkuYXBwZW5kVG8oIGVsZW1lbnQgKVxyXG5cdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmICggbm9kZU5hbWUgPT09IFwidHJcIiApIHtcclxuXHRcdFx0XHRcdFx0dGhhdC5fY3JlYXRlVHJQbGFjZWhvbGRlciggdGhhdC5jdXJyZW50SXRlbSwgZWxlbWVudCApO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmICggbm9kZU5hbWUgPT09IFwiaW1nXCIgKSB7XHJcblx0XHRcdFx0XHRcdGVsZW1lbnQuYXR0ciggXCJzcmNcIiwgdGhhdC5jdXJyZW50SXRlbS5hdHRyKCBcInNyY1wiICkgKTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRpZiAoICFjbGFzc05hbWUgKSB7XHJcblx0XHRcdFx0XHRcdGVsZW1lbnQuY3NzKCBcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIiApO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdHJldHVybiBlbGVtZW50O1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0dXBkYXRlOiBmdW5jdGlvbihjb250YWluZXIsIHApIHtcclxuXHJcblx0XHRcdFx0XHQvLyAxLiBJZiBhIGNsYXNzTmFtZSBpcyBzZXQgYXMgJ3BsYWNlaG9sZGVyIG9wdGlvbiwgd2UgZG9uJ3QgZm9yY2Ugc2l6ZXMgLSB0aGUgY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIHRoYXRcclxuXHRcdFx0XHRcdC8vIDIuIFRoZSBvcHRpb24gJ2ZvcmNlUGxhY2Vob2xkZXJTaXplIGNhbiBiZSBlbmFibGVkIHRvIGZvcmNlIGl0IGV2ZW4gaWYgYSBjbGFzcyBuYW1lIGlzIHNwZWNpZmllZFxyXG5cdFx0XHRcdFx0aWYoY2xhc3NOYW1lICYmICFvLmZvcmNlUGxhY2Vob2xkZXJTaXplKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvL0lmIHRoZSBlbGVtZW50IGRvZXNuJ3QgaGF2ZSBhIGFjdHVhbCBoZWlnaHQgYnkgaXRzZWxmICh3aXRob3V0IHN0eWxlcyBjb21pbmcgZnJvbSBhIHN0eWxlc2hlZXQpLCBpdCByZWNlaXZlcyB0aGUgaW5saW5lIGhlaWdodCBmcm9tIHRoZSBkcmFnZ2VkIGl0ZW1cclxuXHRcdFx0XHRcdGlmKCFwLmhlaWdodCgpKSB7IHAuaGVpZ2h0KHRoYXQuY3VycmVudEl0ZW0uaW5uZXJIZWlnaHQoKSAtIHBhcnNlSW50KHRoYXQuY3VycmVudEl0ZW0uY3NzKFwicGFkZGluZ1RvcFwiKXx8MCwgMTApIC0gcGFyc2VJbnQodGhhdC5jdXJyZW50SXRlbS5jc3MoXCJwYWRkaW5nQm90dG9tXCIpfHwwLCAxMCkpOyB9XHJcblx0XHRcdFx0XHRpZighcC53aWR0aCgpKSB7IHAud2lkdGgodGhhdC5jdXJyZW50SXRlbS5pbm5lcldpZHRoKCkgLSBwYXJzZUludCh0aGF0LmN1cnJlbnRJdGVtLmNzcyhcInBhZGRpbmdMZWZ0XCIpfHwwLCAxMCkgLSBwYXJzZUludCh0aGF0LmN1cnJlbnRJdGVtLmNzcyhcInBhZGRpbmdSaWdodFwiKXx8MCwgMTApKTsgfVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHJcblx0XHQvL0NyZWF0ZSB0aGUgcGxhY2Vob2xkZXJcclxuXHRcdHRoYXQucGxhY2Vob2xkZXIgPSAkKG8ucGxhY2Vob2xkZXIuZWxlbWVudC5jYWxsKHRoYXQuZWxlbWVudCwgdGhhdC5jdXJyZW50SXRlbSkpO1xyXG5cclxuXHRcdC8vQXBwZW5kIGl0IGFmdGVyIHRoZSBhY3R1YWwgY3VycmVudCBpdGVtXHJcblx0XHR0aGF0LmN1cnJlbnRJdGVtLmFmdGVyKHRoYXQucGxhY2Vob2xkZXIpO1xyXG5cclxuXHRcdC8vVXBkYXRlIHRoZSBzaXplIG9mIHRoZSBwbGFjZWhvbGRlciAoVE9ETzogTG9naWMgdG8gZnV6enksIHNlZSBsaW5lIDMxNi8zMTcpXHJcblx0XHRvLnBsYWNlaG9sZGVyLnVwZGF0ZSh0aGF0LCB0aGF0LnBsYWNlaG9sZGVyKTtcclxuXHJcblx0fSxcclxuXHJcblx0X2NyZWF0ZVRyUGxhY2Vob2xkZXI6IGZ1bmN0aW9uKCBzb3VyY2VUciwgdGFyZ2V0VHIgKSB7XHJcblx0XHR2YXIgdGhhdCA9IHRoaXM7XHJcblxyXG5cdFx0c291cmNlVHIuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKCBcIjx0ZD4mIzE2MDs8L3RkPlwiLCB0aGF0LmRvY3VtZW50WyAwIF0gKVxyXG5cdFx0XHRcdC5hdHRyKCBcImNvbHNwYW5cIiwgJCggdGhpcyApLmF0dHIoIFwiY29sc3BhblwiICkgfHwgMSApXHJcblx0XHRcdFx0LmFwcGVuZFRvKCB0YXJnZXRUciApO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0X2NvbnRhY3RDb250YWluZXJzOiBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0dmFyIGksIGosIGRpc3QsIGl0ZW1XaXRoTGVhc3REaXN0YW5jZSwgcG9zUHJvcGVydHksIHNpemVQcm9wZXJ0eSwgY3VyLCBuZWFyQm90dG9tLCBmbG9hdGluZywgYXhpcyxcclxuXHRcdFx0aW5uZXJtb3N0Q29udGFpbmVyID0gbnVsbCxcclxuXHRcdFx0aW5uZXJtb3N0SW5kZXggPSBudWxsO1xyXG5cclxuXHRcdC8vIGdldCBpbm5lcm1vc3QgY29udGFpbmVyIHRoYXQgaW50ZXJzZWN0cyB3aXRoIGl0ZW1cclxuXHRcdGZvciAoaSA9IHRoaXMuY29udGFpbmVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG5cclxuXHRcdFx0Ly8gbmV2ZXIgY29uc2lkZXIgYSBjb250YWluZXIgdGhhdCdzIGxvY2F0ZWQgd2l0aGluIHRoZSBpdGVtIGl0c2VsZlxyXG5cdFx0XHRpZigkLmNvbnRhaW5zKHRoaXMuY3VycmVudEl0ZW1bMF0sIHRoaXMuY29udGFpbmVyc1tpXS5lbGVtZW50WzBdKSkge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZih0aGlzLl9pbnRlcnNlY3RzV2l0aCh0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUpKSB7XHJcblxyXG5cdFx0XHRcdC8vIGlmIHdlJ3ZlIGFscmVhZHkgZm91bmQgYSBjb250YWluZXIgYW5kIGl0J3MgbW9yZSBcImlubmVyXCIgdGhhbiB0aGlzLCB0aGVuIGNvbnRpbnVlXHJcblx0XHRcdFx0aWYoaW5uZXJtb3N0Q29udGFpbmVyICYmICQuY29udGFpbnModGhpcy5jb250YWluZXJzW2ldLmVsZW1lbnRbMF0sIGlubmVybW9zdENvbnRhaW5lci5lbGVtZW50WzBdKSkge1xyXG5cdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpbm5lcm1vc3RDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcnNbaV07XHJcblx0XHRcdFx0aW5uZXJtb3N0SW5kZXggPSBpO1xyXG5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBjb250YWluZXIgZG9lc24ndCBpbnRlcnNlY3QuIHRyaWdnZXIgXCJvdXRcIiBldmVudCBpZiBuZWNlc3NhcnlcclxuXHRcdFx0XHRpZih0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUub3Zlcikge1xyXG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLl90cmlnZ2VyKFwib3V0XCIsIGV2ZW50LCB0aGlzLl91aUhhc2godGhpcykpO1xyXG5cdFx0XHRcdFx0dGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLm92ZXIgPSAwO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdH1cclxuXHJcblx0XHQvLyBpZiBubyBpbnRlcnNlY3RpbmcgY29udGFpbmVycyBmb3VuZCwgcmV0dXJuXHJcblx0XHRpZighaW5uZXJtb3N0Q29udGFpbmVyKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBtb3ZlIHRoZSBpdGVtIGludG8gdGhlIGNvbnRhaW5lciBpZiBpdCdzIG5vdCB0aGVyZSBhbHJlYWR5XHJcblx0XHRpZih0aGlzLmNvbnRhaW5lcnMubGVuZ3RoID09PSAxKSB7XHJcblx0XHRcdGlmICghdGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5jb250YWluZXJDYWNoZS5vdmVyKSB7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5fdHJpZ2dlcihcIm92ZXJcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzKSk7XHJcblx0XHRcdFx0dGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5jb250YWluZXJDYWNoZS5vdmVyID0gMTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdC8vV2hlbiBlbnRlcmluZyBhIG5ldyBjb250YWluZXIsIHdlIHdpbGwgZmluZCB0aGUgaXRlbSB3aXRoIHRoZSBsZWFzdCBkaXN0YW5jZSBhbmQgYXBwZW5kIG91ciBpdGVtIG5lYXIgaXRcclxuXHRcdFx0ZGlzdCA9IDEwMDAwO1xyXG5cdFx0XHRpdGVtV2l0aExlYXN0RGlzdGFuY2UgPSBudWxsO1xyXG5cdFx0XHRmbG9hdGluZyA9IGlubmVybW9zdENvbnRhaW5lci5mbG9hdGluZyB8fCB0aGlzLl9pc0Zsb2F0aW5nKHRoaXMuY3VycmVudEl0ZW0pO1xyXG5cdFx0XHRwb3NQcm9wZXJ0eSA9IGZsb2F0aW5nID8gXCJsZWZ0XCIgOiBcInRvcFwiO1xyXG5cdFx0XHRzaXplUHJvcGVydHkgPSBmbG9hdGluZyA/IFwid2lkdGhcIiA6IFwiaGVpZ2h0XCI7XHJcblx0XHRcdGF4aXMgPSBmbG9hdGluZyA/IFwiY2xpZW50WFwiIDogXCJjbGllbnRZXCI7XHJcblxyXG5cdFx0XHRmb3IgKGogPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XHJcblx0XHRcdFx0aWYoISQuY29udGFpbnModGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5lbGVtZW50WzBdLCB0aGlzLml0ZW1zW2pdLml0ZW1bMF0pKSB7XHJcblx0XHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYodGhpcy5pdGVtc1tqXS5pdGVtWzBdID09PSB0aGlzLmN1cnJlbnRJdGVtWzBdKSB7XHJcblx0XHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGN1ciA9IHRoaXMuaXRlbXNbal0uaXRlbS5vZmZzZXQoKVtwb3NQcm9wZXJ0eV07XHJcblx0XHRcdFx0bmVhckJvdHRvbSA9IGZhbHNlO1xyXG5cdFx0XHRcdGlmICggZXZlbnRbIGF4aXMgXSAtIGN1ciA+IHRoaXMuaXRlbXNbIGogXVsgc2l6ZVByb3BlcnR5IF0gLyAyICkge1xyXG5cdFx0XHRcdFx0bmVhckJvdHRvbSA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoIE1hdGguYWJzKCBldmVudFsgYXhpcyBdIC0gY3VyICkgPCBkaXN0ICkge1xyXG5cdFx0XHRcdFx0ZGlzdCA9IE1hdGguYWJzKCBldmVudFsgYXhpcyBdIC0gY3VyICk7XHJcblx0XHRcdFx0XHRpdGVtV2l0aExlYXN0RGlzdGFuY2UgPSB0aGlzLml0ZW1zWyBqIF07XHJcblx0XHRcdFx0XHR0aGlzLmRpcmVjdGlvbiA9IG5lYXJCb3R0b20gPyBcInVwXCI6IFwiZG93blwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly9DaGVjayBpZiBkcm9wT25FbXB0eSBpcyBlbmFibGVkXHJcblx0XHRcdGlmKCFpdGVtV2l0aExlYXN0RGlzdGFuY2UgJiYgIXRoaXMub3B0aW9ucy5kcm9wT25FbXB0eSkge1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYodGhpcy5jdXJyZW50Q29udGFpbmVyID09PSB0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdKSB7XHJcblx0XHRcdFx0aWYgKCAhdGhpcy5jdXJyZW50Q29udGFpbmVyLmNvbnRhaW5lckNhY2hlLm92ZXIgKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNvbnRhaW5lcnNbIGlubmVybW9zdEluZGV4IF0uX3RyaWdnZXIoIFwib3ZlclwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkgKTtcclxuXHRcdFx0XHRcdHRoaXMuY3VycmVudENvbnRhaW5lci5jb250YWluZXJDYWNoZS5vdmVyID0gMTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpdGVtV2l0aExlYXN0RGlzdGFuY2UgPyB0aGlzLl9yZWFycmFuZ2UoZXZlbnQsIGl0ZW1XaXRoTGVhc3REaXN0YW5jZSwgbnVsbCwgdHJ1ZSkgOiB0aGlzLl9yZWFycmFuZ2UoZXZlbnQsIG51bGwsIHRoaXMuY29udGFpbmVyc1tpbm5lcm1vc3RJbmRleF0uZWxlbWVudCwgdHJ1ZSk7XHJcblx0XHRcdHRoaXMuX3RyaWdnZXIoXCJjaGFuZ2VcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcclxuXHRcdFx0dGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5fdHJpZ2dlcihcImNoYW5nZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKHRoaXMpKTtcclxuXHRcdFx0dGhpcy5jdXJyZW50Q29udGFpbmVyID0gdGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XTtcclxuXHJcblx0XHRcdC8vVXBkYXRlIHRoZSBwbGFjZWhvbGRlclxyXG5cdFx0XHR0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXIudXBkYXRlKHRoaXMuY3VycmVudENvbnRhaW5lciwgdGhpcy5wbGFjZWhvbGRlcik7XHJcblxyXG5cdFx0XHR0aGlzLmNvbnRhaW5lcnNbaW5uZXJtb3N0SW5kZXhdLl90cmlnZ2VyKFwib3ZlclwiLCBldmVudCwgdGhpcy5fdWlIYXNoKHRoaXMpKTtcclxuXHRcdFx0dGhpcy5jb250YWluZXJzW2lubmVybW9zdEluZGV4XS5jb250YWluZXJDYWNoZS5vdmVyID0gMTtcclxuXHRcdH1cclxuXHJcblxyXG5cdH0sXHJcblxyXG5cdF9jcmVhdGVIZWxwZXI6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0dmFyIG8gPSB0aGlzLm9wdGlvbnMsXHJcblx0XHRcdGhlbHBlciA9ICQuaXNGdW5jdGlvbihvLmhlbHBlcikgPyAkKG8uaGVscGVyLmFwcGx5KHRoaXMuZWxlbWVudFswXSwgW2V2ZW50LCB0aGlzLmN1cnJlbnRJdGVtXSkpIDogKG8uaGVscGVyID09PSBcImNsb25lXCIgPyB0aGlzLmN1cnJlbnRJdGVtLmNsb25lKCkgOiB0aGlzLmN1cnJlbnRJdGVtKTtcclxuXHJcblx0XHQvL0FkZCB0aGUgaGVscGVyIHRvIHRoZSBET00gaWYgdGhhdCBkaWRuJ3QgaGFwcGVuIGFscmVhZHlcclxuXHRcdGlmKCFoZWxwZXIucGFyZW50cyhcImJvZHlcIikubGVuZ3RoKSB7XHJcblx0XHRcdCQoby5hcHBlbmRUbyAhPT0gXCJwYXJlbnRcIiA/IG8uYXBwZW5kVG8gOiB0aGlzLmN1cnJlbnRJdGVtWzBdLnBhcmVudE5vZGUpWzBdLmFwcGVuZENoaWxkKGhlbHBlclswXSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoaGVscGVyWzBdID09PSB0aGlzLmN1cnJlbnRJdGVtWzBdKSB7XHJcblx0XHRcdHRoaXMuX3N0b3JlZENTUyA9IHsgd2lkdGg6IHRoaXMuY3VycmVudEl0ZW1bMF0uc3R5bGUud2lkdGgsIGhlaWdodDogdGhpcy5jdXJyZW50SXRlbVswXS5zdHlsZS5oZWlnaHQsIHBvc2l0aW9uOiB0aGlzLmN1cnJlbnRJdGVtLmNzcyhcInBvc2l0aW9uXCIpLCB0b3A6IHRoaXMuY3VycmVudEl0ZW0uY3NzKFwidG9wXCIpLCBsZWZ0OiB0aGlzLmN1cnJlbnRJdGVtLmNzcyhcImxlZnRcIikgfTtcclxuXHRcdH1cclxuXHJcblx0XHRpZighaGVscGVyWzBdLnN0eWxlLndpZHRoIHx8IG8uZm9yY2VIZWxwZXJTaXplKSB7XHJcblx0XHRcdGhlbHBlci53aWR0aCh0aGlzLmN1cnJlbnRJdGVtLndpZHRoKCkpO1xyXG5cdFx0fVxyXG5cdFx0aWYoIWhlbHBlclswXS5zdHlsZS5oZWlnaHQgfHwgby5mb3JjZUhlbHBlclNpemUpIHtcclxuXHRcdFx0aGVscGVyLmhlaWdodCh0aGlzLmN1cnJlbnRJdGVtLmhlaWdodCgpKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gaGVscGVyO1xyXG5cclxuXHR9LFxyXG5cclxuXHRfYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcjogZnVuY3Rpb24ob2JqKSB7XHJcblx0XHRpZiAodHlwZW9mIG9iaiA9PT0gXCJzdHJpbmdcIikge1xyXG5cdFx0XHRvYmogPSBvYmouc3BsaXQoXCIgXCIpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCQuaXNBcnJheShvYmopKSB7XHJcblx0XHRcdG9iaiA9IHtsZWZ0OiArb2JqWzBdLCB0b3A6ICtvYmpbMV0gfHwgMH07XHJcblx0XHR9XHJcblx0XHRpZiAoXCJsZWZ0XCIgaW4gb2JqKSB7XHJcblx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPSBvYmoubGVmdCArIHRoaXMubWFyZ2lucy5sZWZ0O1xyXG5cdFx0fVxyXG5cdFx0aWYgKFwicmlnaHRcIiBpbiBvYmopIHtcclxuXHRcdFx0dGhpcy5vZmZzZXQuY2xpY2subGVmdCA9IHRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGggLSBvYmoucmlnaHQgKyB0aGlzLm1hcmdpbnMubGVmdDtcclxuXHRcdH1cclxuXHRcdGlmIChcInRvcFwiIGluIG9iaikge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay50b3AgPSBvYmoudG9wICsgdGhpcy5tYXJnaW5zLnRvcDtcclxuXHRcdH1cclxuXHRcdGlmIChcImJvdHRvbVwiIGluIG9iaikge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5jbGljay50b3AgPSB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIG9iai5ib3R0b20gKyB0aGlzLm1hcmdpbnMudG9wO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF9nZXRQYXJlbnRPZmZzZXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHJcblx0XHQvL0dldCB0aGUgb2Zmc2V0UGFyZW50IGFuZCBjYWNoZSBpdHMgcG9zaXRpb25cclxuXHRcdHRoaXMub2Zmc2V0UGFyZW50ID0gdGhpcy5oZWxwZXIub2Zmc2V0UGFyZW50KCk7XHJcblx0XHR2YXIgcG8gPSB0aGlzLm9mZnNldFBhcmVudC5vZmZzZXQoKTtcclxuXHJcblx0XHQvLyBUaGlzIGlzIGEgc3BlY2lhbCBjYXNlIHdoZXJlIHdlIG5lZWQgdG8gbW9kaWZ5IGEgb2Zmc2V0IGNhbGN1bGF0ZWQgb24gc3RhcnQsIHNpbmNlIHRoZSBmb2xsb3dpbmcgaGFwcGVuZWQ6XHJcblx0XHQvLyAxLiBUaGUgcG9zaXRpb24gb2YgdGhlIGhlbHBlciBpcyBhYnNvbHV0ZSwgc28gaXQncyBwb3NpdGlvbiBpcyBjYWxjdWxhdGVkIGJhc2VkIG9uIHRoZSBuZXh0IHBvc2l0aW9uZWQgcGFyZW50XHJcblx0XHQvLyAyLiBUaGUgYWN0dWFsIG9mZnNldCBwYXJlbnQgaXMgYSBjaGlsZCBvZiB0aGUgc2Nyb2xsIHBhcmVudCwgYW5kIHRoZSBzY3JvbGwgcGFyZW50IGlzbid0IHRoZSBkb2N1bWVudCwgd2hpY2ggbWVhbnMgdGhhdFxyXG5cdFx0Ly8gICAgdGhlIHNjcm9sbCBpcyBpbmNsdWRlZCBpbiB0aGUgaW5pdGlhbCBjYWxjdWxhdGlvbiBvZiB0aGUgb2Zmc2V0IG9mIHRoZSBwYXJlbnQsIGFuZCBuZXZlciByZWNhbGN1bGF0ZWQgdXBvbiBkcmFnXHJcblx0XHRpZih0aGlzLmNzc1Bvc2l0aW9uID09PSBcImFic29sdXRlXCIgJiYgdGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgJC5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSwgdGhpcy5vZmZzZXRQYXJlbnRbMF0pKSB7XHJcblx0XHRcdHBvLmxlZnQgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpO1xyXG5cdFx0XHRwby50b3AgKz0gdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVGhpcyBuZWVkcyB0byBiZSBhY3R1YWxseSBkb25lIGZvciBhbGwgYnJvd3NlcnMsIHNpbmNlIHBhZ2VYL3BhZ2VZIGluY2x1ZGVzIHRoaXMgaW5mb3JtYXRpb25cclxuXHRcdC8vIHdpdGggYW4gdWdseSBJRSBmaXhcclxuXHRcdGlmKCB0aGlzLm9mZnNldFBhcmVudFswXSA9PT0gdGhpcy5kb2N1bWVudFswXS5ib2R5IHx8ICh0aGlzLm9mZnNldFBhcmVudFswXS50YWdOYW1lICYmIHRoaXMub2Zmc2V0UGFyZW50WzBdLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJodG1sXCIgJiYgJC51aS5pZSkpIHtcclxuXHRcdFx0cG8gPSB7IHRvcDogMCwgbGVmdDogMCB9O1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHRvcDogcG8udG9wICsgKHBhcnNlSW50KHRoaXMub2Zmc2V0UGFyZW50LmNzcyhcImJvcmRlclRvcFdpZHRoXCIpLDEwKSB8fCAwKSxcclxuXHRcdFx0bGVmdDogcG8ubGVmdCArIChwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIiksMTApIHx8IDApXHJcblx0XHR9O1xyXG5cclxuXHR9LFxyXG5cclxuXHRfZ2V0UmVsYXRpdmVPZmZzZXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdGlmKHRoaXMuY3NzUG9zaXRpb24gPT09IFwicmVsYXRpdmVcIikge1xyXG5cdFx0XHR2YXIgcCA9IHRoaXMuY3VycmVudEl0ZW0ucG9zaXRpb24oKTtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHR0b3A6IHAudG9wIC0gKHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcyhcInRvcFwiKSwxMCkgfHwgMCkgKyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSxcclxuXHRcdFx0XHRsZWZ0OiBwLmxlZnQgLSAocGFyc2VJbnQodGhpcy5oZWxwZXIuY3NzKFwibGVmdFwiKSwxMCkgfHwgMCkgKyB0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KClcclxuXHRcdFx0fTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJldHVybiB7IHRvcDogMCwgbGVmdDogMCB9O1xyXG5cdFx0fVxyXG5cclxuXHR9LFxyXG5cclxuXHRfY2FjaGVNYXJnaW5zOiBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMubWFyZ2lucyA9IHtcclxuXHRcdFx0bGVmdDogKHBhcnNlSW50KHRoaXMuY3VycmVudEl0ZW0uY3NzKFwibWFyZ2luTGVmdFwiKSwxMCkgfHwgMCksXHJcblx0XHRcdHRvcDogKHBhcnNlSW50KHRoaXMuY3VycmVudEl0ZW0uY3NzKFwibWFyZ2luVG9wXCIpLDEwKSB8fCAwKVxyXG5cdFx0fTtcclxuXHR9LFxyXG5cclxuXHRfY2FjaGVIZWxwZXJQcm9wb3J0aW9uczogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmhlbHBlclByb3BvcnRpb25zID0ge1xyXG5cdFx0XHR3aWR0aDogdGhpcy5oZWxwZXIub3V0ZXJXaWR0aCgpLFxyXG5cdFx0XHRoZWlnaHQ6IHRoaXMuaGVscGVyLm91dGVySGVpZ2h0KClcclxuXHRcdH07XHJcblx0fSxcclxuXHJcblx0X3NldENvbnRhaW5tZW50OiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHR2YXIgY2UsIGNvLCBvdmVyLFxyXG5cdFx0XHRvID0gdGhpcy5vcHRpb25zO1xyXG5cdFx0aWYoby5jb250YWlubWVudCA9PT0gXCJwYXJlbnRcIikge1xyXG5cdFx0XHRvLmNvbnRhaW5tZW50ID0gdGhpcy5oZWxwZXJbMF0ucGFyZW50Tm9kZTtcclxuXHRcdH1cclxuXHRcdGlmKG8uY29udGFpbm1lbnQgPT09IFwiZG9jdW1lbnRcIiB8fCBvLmNvbnRhaW5tZW50ID09PSBcIndpbmRvd1wiKSB7XHJcblx0XHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXHJcblx0XHRcdFx0MCAtIHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgLSB0aGlzLm9mZnNldC5wYXJlbnQubGVmdCxcclxuXHRcdFx0XHQwIC0gdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wIC0gdGhpcy5vZmZzZXQucGFyZW50LnRvcCxcclxuXHRcdFx0XHRvLmNvbnRhaW5tZW50ID09PSBcImRvY3VtZW50XCIgPyB0aGlzLmRvY3VtZW50LndpZHRoKCkgOiB0aGlzLndpbmRvdy53aWR0aCgpIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxyXG5cdFx0XHRcdChvLmNvbnRhaW5tZW50ID09PSBcImRvY3VtZW50XCIgPyB0aGlzLmRvY3VtZW50LndpZHRoKCkgOiB0aGlzLndpbmRvdy5oZWlnaHQoKSB8fCB0aGlzLmRvY3VtZW50WzBdLmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHQpIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQgLSB0aGlzLm1hcmdpbnMudG9wXHJcblx0XHRcdF07XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoISgvXihkb2N1bWVudHx3aW5kb3d8cGFyZW50KSQvKS50ZXN0KG8uY29udGFpbm1lbnQpKSB7XHJcblx0XHRcdGNlID0gJChvLmNvbnRhaW5tZW50KVswXTtcclxuXHRcdFx0Y28gPSAkKG8uY29udGFpbm1lbnQpLm9mZnNldCgpO1xyXG5cdFx0XHRvdmVyID0gKCQoY2UpLmNzcyhcIm92ZXJmbG93XCIpICE9PSBcImhpZGRlblwiKTtcclxuXHJcblx0XHRcdHRoaXMuY29udGFpbm1lbnQgPSBbXHJcblx0XHRcdFx0Y28ubGVmdCArIChwYXJzZUludCgkKGNlKS5jc3MoXCJib3JkZXJMZWZ0V2lkdGhcIiksMTApIHx8IDApICsgKHBhcnNlSW50KCQoY2UpLmNzcyhcInBhZGRpbmdMZWZ0XCIpLDEwKSB8fCAwKSAtIHRoaXMubWFyZ2lucy5sZWZ0LFxyXG5cdFx0XHRcdGNvLnRvcCArIChwYXJzZUludCgkKGNlKS5jc3MoXCJib3JkZXJUb3BXaWR0aFwiKSwxMCkgfHwgMCkgKyAocGFyc2VJbnQoJChjZSkuY3NzKFwicGFkZGluZ1RvcFwiKSwxMCkgfHwgMCkgLSB0aGlzLm1hcmdpbnMudG9wLFxyXG5cdFx0XHRcdGNvLmxlZnQrKG92ZXIgPyBNYXRoLm1heChjZS5zY3JvbGxXaWR0aCxjZS5vZmZzZXRXaWR0aCkgOiBjZS5vZmZzZXRXaWR0aCkgLSAocGFyc2VJbnQoJChjZSkuY3NzKFwiYm9yZGVyTGVmdFdpZHRoXCIpLDEwKSB8fCAwKSAtIChwYXJzZUludCgkKGNlKS5jc3MoXCJwYWRkaW5nUmlnaHRcIiksMTApIHx8IDApIC0gdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCAtIHRoaXMubWFyZ2lucy5sZWZ0LFxyXG5cdFx0XHRcdGNvLnRvcCsob3ZlciA/IE1hdGgubWF4KGNlLnNjcm9sbEhlaWdodCxjZS5vZmZzZXRIZWlnaHQpIDogY2Uub2Zmc2V0SGVpZ2h0KSAtIChwYXJzZUludCgkKGNlKS5jc3MoXCJib3JkZXJUb3BXaWR0aFwiKSwxMCkgfHwgMCkgLSAocGFyc2VJbnQoJChjZSkuY3NzKFwicGFkZGluZ0JvdHRvbVwiKSwxMCkgfHwgMCkgLSB0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCAtIHRoaXMubWFyZ2lucy50b3BcclxuXHRcdFx0XTtcclxuXHRcdH1cclxuXHJcblx0fSxcclxuXHJcblx0X2NvbnZlcnRQb3NpdGlvblRvOiBmdW5jdGlvbihkLCBwb3MpIHtcclxuXHJcblx0XHRpZighcG9zKSB7XHJcblx0XHRcdHBvcyA9IHRoaXMucG9zaXRpb247XHJcblx0XHR9XHJcblx0XHR2YXIgbW9kID0gZCA9PT0gXCJhYnNvbHV0ZVwiID8gMSA6IC0xLFxyXG5cdFx0XHRzY3JvbGwgPSB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImFic29sdXRlXCIgJiYgISh0aGlzLnNjcm9sbFBhcmVudFswXSAhPT0gdGhpcy5kb2N1bWVudFswXSAmJiAkLmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLCB0aGlzLm9mZnNldFBhcmVudFswXSkpID8gdGhpcy5vZmZzZXRQYXJlbnQgOiB0aGlzLnNjcm9sbFBhcmVudCxcclxuXHRcdFx0c2Nyb2xsSXNSb290Tm9kZSA9ICgvKGh0bWx8Ym9keSkvaSkudGVzdChzY3JvbGxbMF0udGFnTmFtZSk7XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0dG9wOiAoXHJcblx0XHRcdFx0cG9zLnRvcFx0K1x0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIGFic29sdXRlIG1vdXNlIHBvc2l0aW9uXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUudG9wICogbW9kICtcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE9ubHkgZm9yIHJlbGF0aXZlIHBvc2l0aW9uZWQgbm9kZXM6IFJlbGF0aXZlIG9mZnNldCBmcm9tIGVsZW1lbnQgdG8gb2Zmc2V0IHBhcmVudFxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnBhcmVudC50b3AgKiBtb2QgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxyXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCkgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogc2Nyb2xsLnNjcm9sbFRvcCgpICkgKSAqIG1vZClcclxuXHRcdFx0KSxcclxuXHRcdFx0bGVmdDogKFxyXG5cdFx0XHRcdHBvcy5sZWZ0ICtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQgKiBtb2QgK1x0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gT25seSBmb3IgcmVsYXRpdmUgcG9zaXRpb25lZCBub2RlczogUmVsYXRpdmUgb2Zmc2V0IGZyb20gZWxlbWVudCB0byBvZmZzZXQgcGFyZW50XHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucGFyZW50LmxlZnQgKiBtb2RcdC1cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBvZmZzZXRQYXJlbnQncyBvZmZzZXQgd2l0aG91dCBib3JkZXJzIChvZmZzZXQgKyBib3JkZXIpXHJcblx0XHRcdFx0KCAoIHRoaXMuY3NzUG9zaXRpb24gPT09IFwiZml4ZWRcIiA/IC10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCkgOiBzY3JvbGxJc1Jvb3ROb2RlID8gMCA6IHNjcm9sbC5zY3JvbGxMZWZ0KCkgKSAqIG1vZClcclxuXHRcdFx0KVxyXG5cdFx0fTtcclxuXHJcblx0fSxcclxuXHJcblx0X2dlbmVyYXRlUG9zaXRpb246IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblxyXG5cdFx0dmFyIHRvcCwgbGVmdCxcclxuXHRcdFx0byA9IHRoaXMub3B0aW9ucyxcclxuXHRcdFx0cGFnZVggPSBldmVudC5wYWdlWCxcclxuXHRcdFx0cGFnZVkgPSBldmVudC5wYWdlWSxcclxuXHRcdFx0c2Nyb2xsID0gdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJhYnNvbHV0ZVwiICYmICEodGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgJC5jb250YWlucyh0aGlzLnNjcm9sbFBhcmVudFswXSwgdGhpcy5vZmZzZXRQYXJlbnRbMF0pKSA/IHRoaXMub2Zmc2V0UGFyZW50IDogdGhpcy5zY3JvbGxQYXJlbnQsIHNjcm9sbElzUm9vdE5vZGUgPSAoLyhodG1sfGJvZHkpL2kpLnRlc3Qoc2Nyb2xsWzBdLnRhZ05hbWUpO1xyXG5cclxuXHRcdC8vIFRoaXMgaXMgYW5vdGhlciB2ZXJ5IHdlaXJkIHNwZWNpYWwgY2FzZSB0aGF0IG9ubHkgaGFwcGVucyBmb3IgcmVsYXRpdmUgZWxlbWVudHM6XHJcblx0XHQvLyAxLiBJZiB0aGUgY3NzIHBvc2l0aW9uIGlzIHJlbGF0aXZlXHJcblx0XHQvLyAyLiBhbmQgdGhlIHNjcm9sbCBwYXJlbnQgaXMgdGhlIGRvY3VtZW50IG9yIHNpbWlsYXIgdG8gdGhlIG9mZnNldCBwYXJlbnRcclxuXHRcdC8vIHdlIGhhdmUgdG8gcmVmcmVzaCB0aGUgcmVsYXRpdmUgb2Zmc2V0IGR1cmluZyB0aGUgc2Nyb2xsIHNvIHRoZXJlIGFyZSBubyBqdW1wc1xyXG5cdFx0aWYodGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJyZWxhdGl2ZVwiICYmICEodGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMuZG9jdW1lbnRbMF0gJiYgdGhpcy5zY3JvbGxQYXJlbnRbMF0gIT09IHRoaXMub2Zmc2V0UGFyZW50WzBdKSkge1xyXG5cdFx0XHR0aGlzLm9mZnNldC5yZWxhdGl2ZSA9IHRoaXMuX2dldFJlbGF0aXZlT2Zmc2V0KCk7XHJcblx0XHR9XHJcblxyXG5cdFx0LypcclxuXHRcdCAqIC0gUG9zaXRpb24gY29uc3RyYWluaW5nIC1cclxuXHRcdCAqIENvbnN0cmFpbiB0aGUgcG9zaXRpb24gdG8gYSBtaXggb2YgZ3JpZCwgY29udGFpbm1lbnQuXHJcblx0XHQgKi9cclxuXHJcblx0XHRpZih0aGlzLm9yaWdpbmFsUG9zaXRpb24pIHsgLy9JZiB3ZSBhcmUgbm90IGRyYWdnaW5nIHlldCwgd2Ugd29uJ3QgY2hlY2sgZm9yIG9wdGlvbnNcclxuXHJcblx0XHRcdGlmKHRoaXMuY29udGFpbm1lbnQpIHtcclxuXHRcdFx0XHRpZihldmVudC5wYWdlWCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPCB0aGlzLmNvbnRhaW5tZW50WzBdKSB7XHJcblx0XHRcdFx0XHRwYWdlWCA9IHRoaXMuY29udGFpbm1lbnRbMF0gKyB0aGlzLm9mZnNldC5jbGljay5sZWZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihldmVudC5wYWdlWSAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8IHRoaXMuY29udGFpbm1lbnRbMV0pIHtcclxuXHRcdFx0XHRcdHBhZ2VZID0gdGhpcy5jb250YWlubWVudFsxXSArIHRoaXMub2Zmc2V0LmNsaWNrLnRvcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoZXZlbnQucGFnZVggLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID4gdGhpcy5jb250YWlubWVudFsyXSkge1xyXG5cdFx0XHRcdFx0cGFnZVggPSB0aGlzLmNvbnRhaW5tZW50WzJdICsgdGhpcy5vZmZzZXQuY2xpY2subGVmdDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoZXZlbnQucGFnZVkgLSB0aGlzLm9mZnNldC5jbGljay50b3AgPiB0aGlzLmNvbnRhaW5tZW50WzNdKSB7XHJcblx0XHRcdFx0XHRwYWdlWSA9IHRoaXMuY29udGFpbm1lbnRbM10gKyB0aGlzLm9mZnNldC5jbGljay50b3A7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZihvLmdyaWQpIHtcclxuXHRcdFx0XHR0b3AgPSB0aGlzLm9yaWdpbmFsUGFnZVkgKyBNYXRoLnJvdW5kKChwYWdlWSAtIHRoaXMub3JpZ2luYWxQYWdlWSkgLyBvLmdyaWRbMV0pICogby5ncmlkWzFdO1xyXG5cdFx0XHRcdHBhZ2VZID0gdGhpcy5jb250YWlubWVudCA/ICggKHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA+PSB0aGlzLmNvbnRhaW5tZW50WzFdICYmIHRvcCAtIHRoaXMub2Zmc2V0LmNsaWNrLnRvcCA8PSB0aGlzLmNvbnRhaW5tZW50WzNdKSA/IHRvcCA6ICgodG9wIC0gdGhpcy5vZmZzZXQuY2xpY2sudG9wID49IHRoaXMuY29udGFpbm1lbnRbMV0pID8gdG9wIC0gby5ncmlkWzFdIDogdG9wICsgby5ncmlkWzFdKSkgOiB0b3A7XHJcblxyXG5cdFx0XHRcdGxlZnQgPSB0aGlzLm9yaWdpbmFsUGFnZVggKyBNYXRoLnJvdW5kKChwYWdlWCAtIHRoaXMub3JpZ2luYWxQYWdlWCkgLyBvLmdyaWRbMF0pICogby5ncmlkWzBdO1xyXG5cdFx0XHRcdHBhZ2VYID0gdGhpcy5jb250YWlubWVudCA/ICggKGxlZnQgLSB0aGlzLm9mZnNldC5jbGljay5sZWZ0ID49IHRoaXMuY29udGFpbm1lbnRbMF0gJiYgbGVmdCAtIHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgPD0gdGhpcy5jb250YWlubWVudFsyXSkgPyBsZWZ0IDogKChsZWZ0IC0gdGhpcy5vZmZzZXQuY2xpY2subGVmdCA+PSB0aGlzLmNvbnRhaW5tZW50WzBdKSA/IGxlZnQgLSBvLmdyaWRbMF0gOiBsZWZ0ICsgby5ncmlkWzBdKSkgOiBsZWZ0O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHRvcDogKFxyXG5cdFx0XHRcdHBhZ2VZIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLnRvcCAtXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDbGljayBvZmZzZXQgKHJlbGF0aXZlIHRvIHRoZSBlbGVtZW50KVxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcFx0LVx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQudG9wICtcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgb2Zmc2V0UGFyZW50J3Mgb2Zmc2V0IHdpdGhvdXQgYm9yZGVycyAob2Zmc2V0ICsgYm9yZGVyKVxyXG5cdFx0XHRcdCggKCB0aGlzLmNzc1Bvc2l0aW9uID09PSBcImZpeGVkXCIgPyAtdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCkgOiAoIHNjcm9sbElzUm9vdE5vZGUgPyAwIDogc2Nyb2xsLnNjcm9sbFRvcCgpICkgKSlcclxuXHRcdFx0KSxcclxuXHRcdFx0bGVmdDogKFxyXG5cdFx0XHRcdHBhZ2VYIC1cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRoZSBhYnNvbHV0ZSBtb3VzZSBwb3NpdGlvblxyXG5cdFx0XHRcdHRoaXMub2Zmc2V0LmNsaWNrLmxlZnQgLVx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIENsaWNrIG9mZnNldCAocmVsYXRpdmUgdG8gdGhlIGVsZW1lbnQpXHJcblx0XHRcdFx0dGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdFx0LVx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGZvciByZWxhdGl2ZSBwb3NpdGlvbmVkIG5vZGVzOiBSZWxhdGl2ZSBvZmZzZXQgZnJvbSBlbGVtZW50IHRvIG9mZnNldCBwYXJlbnRcclxuXHRcdFx0XHR0aGlzLm9mZnNldC5wYXJlbnQubGVmdCArXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVGhlIG9mZnNldFBhcmVudCdzIG9mZnNldCB3aXRob3V0IGJvcmRlcnMgKG9mZnNldCArIGJvcmRlcilcclxuXHRcdFx0XHQoICggdGhpcy5jc3NQb3NpdGlvbiA9PT0gXCJmaXhlZFwiID8gLXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKSA6IHNjcm9sbElzUm9vdE5vZGUgPyAwIDogc2Nyb2xsLnNjcm9sbExlZnQoKSApKVxyXG5cdFx0XHQpXHJcblx0XHR9O1xyXG5cclxuXHR9LFxyXG5cclxuXHRfcmVhcnJhbmdlOiBmdW5jdGlvbihldmVudCwgaSwgYSwgaGFyZFJlZnJlc2gpIHtcclxuXHJcblx0XHRhID8gYVswXS5hcHBlbmRDaGlsZCh0aGlzLnBsYWNlaG9sZGVyWzBdKSA6IGkuaXRlbVswXS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLnBsYWNlaG9sZGVyWzBdLCAodGhpcy5kaXJlY3Rpb24gPT09IFwiZG93blwiID8gaS5pdGVtWzBdIDogaS5pdGVtWzBdLm5leHRTaWJsaW5nKSk7XHJcblxyXG5cdFx0Ly9WYXJpb3VzIHRoaW5ncyBkb25lIGhlcmUgdG8gaW1wcm92ZSB0aGUgcGVyZm9ybWFuY2U6XHJcblx0XHQvLyAxLiB3ZSBjcmVhdGUgYSBzZXRUaW1lb3V0LCB0aGF0IGNhbGxzIHJlZnJlc2hQb3NpdGlvbnNcclxuXHRcdC8vIDIuIG9uIHRoZSBpbnN0YW5jZSwgd2UgaGF2ZSBhIGNvdW50ZXIgdmFyaWFibGUsIHRoYXQgZ2V0J3MgaGlnaGVyIGFmdGVyIGV2ZXJ5IGFwcGVuZFxyXG5cdFx0Ly8gMy4gb24gdGhlIGxvY2FsIHNjb3BlLCB3ZSBjb3B5IHRoZSBjb3VudGVyIHZhcmlhYmxlLCBhbmQgY2hlY2sgaW4gdGhlIHRpbWVvdXQsIGlmIGl0J3Mgc3RpbGwgdGhlIHNhbWVcclxuXHRcdC8vIDQuIHRoaXMgbGV0cyBvbmx5IHRoZSBsYXN0IGFkZGl0aW9uIHRvIHRoZSB0aW1lb3V0IHN0YWNrIHRocm91Z2hcclxuXHRcdHRoaXMuY291bnRlciA9IHRoaXMuY291bnRlciA/ICsrdGhpcy5jb3VudGVyIDogMTtcclxuXHRcdHZhciBjb3VudGVyID0gdGhpcy5jb3VudGVyO1xyXG5cclxuXHRcdHRoaXMuX2RlbGF5KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZihjb3VudGVyID09PSB0aGlzLmNvdW50ZXIpIHtcclxuXHRcdFx0XHR0aGlzLnJlZnJlc2hQb3NpdGlvbnMoIWhhcmRSZWZyZXNoKTsgLy9QcmVjb21wdXRlIGFmdGVyIGVhY2ggRE9NIGluc2VydGlvbiwgTk9UIG9uIG1vdXNlbW92ZVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0fSxcclxuXHJcblx0X2NsZWFyOiBmdW5jdGlvbihldmVudCwgbm9Qcm9wYWdhdGlvbikge1xyXG5cclxuXHRcdHRoaXMucmV2ZXJ0aW5nID0gZmFsc2U7XHJcblx0XHQvLyBXZSBkZWxheSBhbGwgZXZlbnRzIHRoYXQgaGF2ZSB0byBiZSB0cmlnZ2VyZWQgdG8gYWZ0ZXIgdGhlIHBvaW50IHdoZXJlIHRoZSBwbGFjZWhvbGRlciBoYXMgYmVlbiByZW1vdmVkIGFuZFxyXG5cdFx0Ly8gZXZlcnl0aGluZyBlbHNlIG5vcm1hbGl6ZWQgYWdhaW5cclxuXHRcdHZhciBpLFxyXG5cdFx0XHRkZWxheWVkVHJpZ2dlcnMgPSBbXTtcclxuXHJcblx0XHQvLyBXZSBmaXJzdCBoYXZlIHRvIHVwZGF0ZSB0aGUgZG9tIHBvc2l0aW9uIG9mIHRoZSBhY3R1YWwgY3VycmVudEl0ZW1cclxuXHRcdC8vIE5vdGU6IGRvbid0IGRvIGl0IGlmIHRoZSBjdXJyZW50IGl0ZW0gaXMgYWxyZWFkeSByZW1vdmVkIChieSBhIHVzZXIpLCBvciBpdCBnZXRzIHJlYXBwZW5kZWQgKHNlZSAjNDA4OClcclxuXHRcdGlmKCF0aGlzLl9ub0ZpbmFsU29ydCAmJiB0aGlzLmN1cnJlbnRJdGVtLnBhcmVudCgpLmxlbmd0aCkge1xyXG5cdFx0XHR0aGlzLnBsYWNlaG9sZGVyLmJlZm9yZSh0aGlzLmN1cnJlbnRJdGVtKTtcclxuXHRcdH1cclxuXHRcdHRoaXMuX25vRmluYWxTb3J0ID0gbnVsbDtcclxuXHJcblx0XHRpZih0aGlzLmhlbHBlclswXSA9PT0gdGhpcy5jdXJyZW50SXRlbVswXSkge1xyXG5cdFx0XHRmb3IoaSBpbiB0aGlzLl9zdG9yZWRDU1MpIHtcclxuXHRcdFx0XHRpZih0aGlzLl9zdG9yZWRDU1NbaV0gPT09IFwiYXV0b1wiIHx8IHRoaXMuX3N0b3JlZENTU1tpXSA9PT0gXCJzdGF0aWNcIikge1xyXG5cdFx0XHRcdFx0dGhpcy5fc3RvcmVkQ1NTW2ldID0gXCJcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5jdXJyZW50SXRlbS5jc3ModGhpcy5fc3RvcmVkQ1NTKS5yZW1vdmVDbGFzcyhcInVpLXNvcnRhYmxlLWhlbHBlclwiKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuY3VycmVudEl0ZW0uc2hvdygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKHRoaXMuZnJvbU91dHNpZGUgJiYgIW5vUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0ZGVsYXllZFRyaWdnZXJzLnB1c2goZnVuY3Rpb24oZXZlbnQpIHsgdGhpcy5fdHJpZ2dlcihcInJlY2VpdmVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzLmZyb21PdXRzaWRlKSk7IH0pO1xyXG5cdFx0fVxyXG5cdFx0aWYoKHRoaXMuZnJvbU91dHNpZGUgfHwgdGhpcy5kb21Qb3NpdGlvbi5wcmV2ICE9PSB0aGlzLmN1cnJlbnRJdGVtLnByZXYoKS5ub3QoXCIudWktc29ydGFibGUtaGVscGVyXCIpWzBdIHx8IHRoaXMuZG9tUG9zaXRpb24ucGFyZW50ICE9PSB0aGlzLmN1cnJlbnRJdGVtLnBhcmVudCgpWzBdKSAmJiAhbm9Qcm9wYWdhdGlvbikge1xyXG5cdFx0XHRkZWxheWVkVHJpZ2dlcnMucHVzaChmdW5jdGlvbihldmVudCkgeyB0aGlzLl90cmlnZ2VyKFwidXBkYXRlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2goKSk7IH0pOyAvL1RyaWdnZXIgdXBkYXRlIGNhbGxiYWNrIGlmIHRoZSBET00gcG9zaXRpb24gaGFzIGNoYW5nZWRcclxuXHRcdH1cclxuXHJcblx0XHQvLyBDaGVjayBpZiB0aGUgaXRlbXMgQ29udGFpbmVyIGhhcyBDaGFuZ2VkIGFuZCB0cmlnZ2VyIGFwcHJvcHJpYXRlXHJcblx0XHQvLyBldmVudHMuXHJcblx0XHRpZiAodGhpcyAhPT0gdGhpcy5jdXJyZW50Q29udGFpbmVyKSB7XHJcblx0XHRcdGlmKCFub1Byb3BhZ2F0aW9uKSB7XHJcblx0XHRcdFx0ZGVsYXllZFRyaWdnZXJzLnB1c2goZnVuY3Rpb24oZXZlbnQpIHsgdGhpcy5fdHJpZ2dlcihcInJlbW92ZVwiLCBldmVudCwgdGhpcy5fdWlIYXNoKCkpOyB9KTtcclxuXHRcdFx0XHRkZWxheWVkVHJpZ2dlcnMucHVzaCgoZnVuY3Rpb24oYykgeyByZXR1cm4gZnVuY3Rpb24oZXZlbnQpIHsgYy5fdHJpZ2dlcihcInJlY2VpdmVcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCh0aGlzKSk7IH07ICB9KS5jYWxsKHRoaXMsIHRoaXMuY3VycmVudENvbnRhaW5lcikpO1xyXG5cdFx0XHRcdGRlbGF5ZWRUcmlnZ2Vycy5wdXNoKChmdW5jdGlvbihjKSB7IHJldHVybiBmdW5jdGlvbihldmVudCkgeyBjLl90cmlnZ2VyKFwidXBkYXRlXCIsIGV2ZW50LCB0aGlzLl91aUhhc2godGhpcykpOyAgfTsgfSkuY2FsbCh0aGlzLCB0aGlzLmN1cnJlbnRDb250YWluZXIpKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQvL1Bvc3QgZXZlbnRzIHRvIGNvbnRhaW5lcnNcclxuXHRcdGZ1bmN0aW9uIGRlbGF5RXZlbnQoIHR5cGUsIGluc3RhbmNlLCBjb250YWluZXIgKSB7XHJcblx0XHRcdHJldHVybiBmdW5jdGlvbiggZXZlbnQgKSB7XHJcblx0XHRcdFx0Y29udGFpbmVyLl90cmlnZ2VyKCB0eXBlLCBldmVudCwgaW5zdGFuY2UuX3VpSGFzaCggaW5zdGFuY2UgKSApO1xyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChpID0gdGhpcy5jb250YWluZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKXtcclxuXHRcdFx0aWYgKCFub1Byb3BhZ2F0aW9uKSB7XHJcblx0XHRcdFx0ZGVsYXllZFRyaWdnZXJzLnB1c2goIGRlbGF5RXZlbnQoIFwiZGVhY3RpdmF0ZVwiLCB0aGlzLCB0aGlzLmNvbnRhaW5lcnNbIGkgXSApICk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYodGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLm92ZXIpIHtcclxuXHRcdFx0XHRkZWxheWVkVHJpZ2dlcnMucHVzaCggZGVsYXlFdmVudCggXCJvdXRcIiwgdGhpcywgdGhpcy5jb250YWluZXJzWyBpIF0gKSApO1xyXG5cdFx0XHRcdHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyID0gMDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vRG8gd2hhdCB3YXMgb3JpZ2luYWxseSBpbiBwbHVnaW5zXHJcblx0XHRpZiAoIHRoaXMuc3RvcmVkQ3Vyc29yICkge1xyXG5cdFx0XHR0aGlzLmRvY3VtZW50LmZpbmQoIFwiYm9keVwiICkuY3NzKCBcImN1cnNvclwiLCB0aGlzLnN0b3JlZEN1cnNvciApO1xyXG5cdFx0XHR0aGlzLnN0b3JlZFN0eWxlc2hlZXQucmVtb3ZlKCk7XHJcblx0XHR9XHJcblx0XHRpZih0aGlzLl9zdG9yZWRPcGFjaXR5KSB7XHJcblx0XHRcdHRoaXMuaGVscGVyLmNzcyhcIm9wYWNpdHlcIiwgdGhpcy5fc3RvcmVkT3BhY2l0eSk7XHJcblx0XHR9XHJcblx0XHRpZih0aGlzLl9zdG9yZWRaSW5kZXgpIHtcclxuXHRcdFx0dGhpcy5oZWxwZXIuY3NzKFwiekluZGV4XCIsIHRoaXMuX3N0b3JlZFpJbmRleCA9PT0gXCJhdXRvXCIgPyBcIlwiIDogdGhpcy5fc3RvcmVkWkluZGV4KTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmRyYWdnaW5nID0gZmFsc2U7XHJcblxyXG5cdFx0aWYoIW5vUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0dGhpcy5fdHJpZ2dlcihcImJlZm9yZVN0b3BcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyQodGhpcy5wbGFjZWhvbGRlclswXSkucmVtb3ZlKCk7IHdvdWxkIGhhdmUgYmVlbiB0aGUgalF1ZXJ5IHdheSAtIHVuZm9ydHVuYXRlbHksIGl0IHVuYmluZHMgQUxMIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCBub2RlIVxyXG5cdFx0dGhpcy5wbGFjZWhvbGRlclswXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucGxhY2Vob2xkZXJbMF0pO1xyXG5cclxuXHRcdGlmICggIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbCApIHtcclxuXHRcdFx0aWYgKCB0aGlzLmhlbHBlclsgMCBdICE9PSB0aGlzLmN1cnJlbnRJdGVtWyAwIF0gKSB7XHJcblx0XHRcdFx0dGhpcy5oZWxwZXIucmVtb3ZlKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5oZWxwZXIgPSBudWxsO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCFub1Byb3BhZ2F0aW9uKSB7XHJcblx0XHRcdGZvciAoaT0wOyBpIDwgZGVsYXllZFRyaWdnZXJzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0ZGVsYXllZFRyaWdnZXJzW2ldLmNhbGwodGhpcywgZXZlbnQpO1xyXG5cdFx0XHR9IC8vVHJpZ2dlciBhbGwgZGVsYXllZCBldmVudHNcclxuXHRcdFx0dGhpcy5fdHJpZ2dlcihcInN0b3BcIiwgZXZlbnQsIHRoaXMuX3VpSGFzaCgpKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmZyb21PdXRzaWRlID0gZmFsc2U7XHJcblx0XHRyZXR1cm4gIXRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbDtcclxuXHJcblx0fSxcclxuXHJcblx0X3RyaWdnZXI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKCQuV2lkZ2V0LnByb3RvdHlwZS5fdHJpZ2dlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpID09PSBmYWxzZSkge1xyXG5cdFx0XHR0aGlzLmNhbmNlbCgpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdF91aUhhc2g6IGZ1bmN0aW9uKF9pbnN0KSB7XHJcblx0XHR2YXIgaW5zdCA9IF9pbnN0IHx8IHRoaXM7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRoZWxwZXI6IGluc3QuaGVscGVyLFxyXG5cdFx0XHRwbGFjZWhvbGRlcjogaW5zdC5wbGFjZWhvbGRlciB8fCAkKFtdKSxcclxuXHRcdFx0cG9zaXRpb246IGluc3QucG9zaXRpb24sXHJcblx0XHRcdG9yaWdpbmFsUG9zaXRpb246IGluc3Qub3JpZ2luYWxQb3NpdGlvbixcclxuXHRcdFx0b2Zmc2V0OiBpbnN0LnBvc2l0aW9uQWJzLFxyXG5cdFx0XHRpdGVtOiBpbnN0LmN1cnJlbnRJdGVtLFxyXG5cdFx0XHRzZW5kZXI6IF9pbnN0ID8gX2luc3QuZWxlbWVudCA6IG51bGxcclxuXHRcdH07XHJcblx0fVxyXG5cclxufSk7XHJcblxyXG5cclxuXHJcbn0pKTsiLCIvKiBjYW52YXMtdG9CbG9iLmpzXHJcbiAqIEEgY2FudmFzLnRvQmxvYigpIGltcGxlbWVudGF0aW9uLlxyXG4gKiAyMDEzLTEyLTI3XHJcbiAqIFxyXG4gKiBCeSBFbGkgR3JleSwgaHR0cDovL2VsaWdyZXkuY29tIGFuZCBEZXZpbiBTYW1hcmluLCBodHRwczovL2dpdGh1Yi5jb20vZWJveWpyXHJcbiAqIExpY2Vuc2U6IFgxMS9NSVRcclxuICogICBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsaWdyZXkvY2FudmFzLXRvQmxvYi5qcy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kXHJcbiAqL1xyXG5cclxuLypnbG9iYWwgc2VsZiAqL1xyXG4vKmpzbGludCBiaXR3aXNlOiB0cnVlLCByZWdleHA6IHRydWUsIGNvbmZ1c2lvbjogdHJ1ZSwgZXM1OiB0cnVlLCB2YXJzOiB0cnVlLCB3aGl0ZTogdHJ1ZSxcclxuICBwbHVzcGx1czogdHJ1ZSAqL1xyXG5cclxuLyohIEBzb3VyY2UgaHR0cDovL3B1cmwuZWxpZ3JleS5jb20vZ2l0aHViL2NhbnZhcy10b0Jsb2IuanMvYmxvYi9tYXN0ZXIvY2FudmFzLXRvQmxvYi5qcyAqL1xyXG5cclxuKGZ1bmN0aW9uKHZpZXcpIHtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhclxyXG5cdCAgVWludDhBcnJheSA9IHZpZXcuVWludDhBcnJheVxyXG5cdCwgSFRNTENhbnZhc0VsZW1lbnQgPSB2aWV3LkhUTUxDYW52YXNFbGVtZW50XHJcblx0LCBjYW52YXNfcHJvdG8gPSBIVE1MQ2FudmFzRWxlbWVudCAmJiBIVE1MQ2FudmFzRWxlbWVudC5wcm90b3R5cGVcclxuXHQsIGlzX2Jhc2U2NF9yZWdleCA9IC9cXHMqO1xccypiYXNlNjRcXHMqKD86O3wkKS9pXHJcblx0LCB0b19kYXRhX3VybCA9IFwidG9EYXRhVVJMXCJcclxuXHQsIGJhc2U2NF9yYW5rc1xyXG5cdCwgZGVjb2RlX2Jhc2U2NCA9IGZ1bmN0aW9uKGJhc2U2NCkge1xyXG5cdFx0dmFyXHJcblx0XHRcdCAgbGVuID0gYmFzZTY0Lmxlbmd0aFxyXG5cdFx0XHQsIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGxlbiAvIDQgKiAzIHwgMClcclxuXHRcdFx0LCBpID0gMFxyXG5cdFx0XHQsIG91dHB0ciA9IDBcclxuXHRcdFx0LCBsYXN0ID0gWzAsIDBdXHJcblx0XHRcdCwgc3RhdGUgPSAwXHJcblx0XHRcdCwgc2F2ZSA9IDBcclxuXHRcdFx0LCByYW5rXHJcblx0XHRcdCwgY29kZVxyXG5cdFx0XHQsIHVuZGVmXHJcblx0XHQ7XHJcblx0XHR3aGlsZSAobGVuLS0pIHtcclxuXHRcdFx0Y29kZSA9IGJhc2U2NC5jaGFyQ29kZUF0KGkrKyk7XHJcblx0XHRcdHJhbmsgPSBiYXNlNjRfcmFua3NbY29kZS00M107XHJcblx0XHRcdGlmIChyYW5rICE9PSAyNTUgJiYgcmFuayAhPT0gdW5kZWYpIHtcclxuXHRcdFx0XHRsYXN0WzFdID0gbGFzdFswXTtcclxuXHRcdFx0XHRsYXN0WzBdID0gY29kZTtcclxuXHRcdFx0XHRzYXZlID0gKHNhdmUgPDwgNikgfCByYW5rO1xyXG5cdFx0XHRcdHN0YXRlKys7XHJcblx0XHRcdFx0aWYgKHN0YXRlID09PSA0KSB7XHJcblx0XHRcdFx0XHRidWZmZXJbb3V0cHRyKytdID0gc2F2ZSA+Pj4gMTY7XHJcblx0XHRcdFx0XHRpZiAobGFzdFsxXSAhPT0gNjEgLyogcGFkZGluZyBjaGFyYWN0ZXIgKi8pIHtcclxuXHRcdFx0XHRcdFx0YnVmZmVyW291dHB0cisrXSA9IHNhdmUgPj4+IDg7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAobGFzdFswXSAhPT0gNjEgLyogcGFkZGluZyBjaGFyYWN0ZXIgKi8pIHtcclxuXHRcdFx0XHRcdFx0YnVmZmVyW291dHB0cisrXSA9IHNhdmU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRzdGF0ZSA9IDA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQvLyAyLzMgY2hhbmNlIHRoZXJlJ3MgZ29pbmcgdG8gYmUgc29tZSBudWxsIGJ5dGVzIGF0IHRoZSBlbmQsIGJ1dCB0aGF0XHJcblx0XHQvLyBkb2Vzbid0IHJlYWxseSBtYXR0ZXIgd2l0aCBtb3N0IGltYWdlIGZvcm1hdHMuXHJcblx0XHQvLyBJZiBpdCBzb21laG93IG1hdHRlcnMgZm9yIHlvdSwgdHJ1bmNhdGUgdGhlIGJ1ZmZlciB1cCBvdXRwdHIuXHJcblx0XHRyZXR1cm4gYnVmZmVyO1xyXG5cdH1cclxuO1xyXG5pZiAoVWludDhBcnJheSkge1xyXG5cdGJhc2U2NF9yYW5rcyA9IG5ldyBVaW50OEFycmF5KFtcclxuXHRcdCAgNjIsIC0xLCAtMSwgLTEsIDYzLCA1MiwgNTMsIDU0LCA1NSwgNTYsIDU3LCA1OCwgNTksIDYwLCA2MSwgLTFcclxuXHRcdCwgLTEsIC0xLCAgMCwgLTEsIC0xLCAtMSwgIDAsICAxLCAgMiwgIDMsICA0LCAgNSwgIDYsICA3LCAgOCwgIDlcclxuXHRcdCwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgMjVcclxuXHRcdCwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgMjYsIDI3LCAyOCwgMjksIDMwLCAzMSwgMzIsIDMzLCAzNCwgMzVcclxuXHRcdCwgMzYsIDM3LCAzOCwgMzksIDQwLCA0MSwgNDIsIDQzLCA0NCwgNDUsIDQ2LCA0NywgNDgsIDQ5LCA1MCwgNTFcclxuXHRdKTtcclxufVxyXG5pZiAoSFRNTENhbnZhc0VsZW1lbnQgJiYgIWNhbnZhc19wcm90by50b0Jsb2IpIHtcclxuXHRjYW52YXNfcHJvdG8udG9CbG9iID0gZnVuY3Rpb24oY2FsbGJhY2ssIHR5cGUgLyosIC4uLmFyZ3MqLykge1xyXG5cdFx0ICBpZiAoIXR5cGUpIHtcclxuXHRcdFx0dHlwZSA9IFwiaW1hZ2UvcG5nXCI7XHJcblx0XHR9IGlmICh0aGlzLm1vekdldEFzRmlsZSkge1xyXG5cdFx0XHRjYWxsYmFjayh0aGlzLm1vekdldEFzRmlsZShcImNhbnZhc1wiLCB0eXBlKSk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH0gaWYgKHRoaXMubXNUb0Jsb2IgJiYgL15cXHMqaW1hZ2VcXC9wbmdcXHMqKD86JHw7KS9pLnRlc3QodHlwZSkpIHtcclxuXHRcdFx0Y2FsbGJhY2sodGhpcy5tc1RvQmxvYigpKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHZhclxyXG5cdFx0XHQgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpXHJcblx0XHRcdCwgZGF0YVVSSSA9IHRoaXNbdG9fZGF0YV91cmxdLmFwcGx5KHRoaXMsIGFyZ3MpXHJcblx0XHRcdCwgaGVhZGVyX2VuZCA9IGRhdGFVUkkuaW5kZXhPZihcIixcIilcclxuXHRcdFx0LCBkYXRhID0gZGF0YVVSSS5zdWJzdHJpbmcoaGVhZGVyX2VuZCArIDEpXHJcblx0XHRcdCwgaXNfYmFzZTY0ID0gaXNfYmFzZTY0X3JlZ2V4LnRlc3QoZGF0YVVSSS5zdWJzdHJpbmcoMCwgaGVhZGVyX2VuZCkpXHJcblx0XHRcdCwgYmxvYlxyXG5cdFx0O1xyXG5cdFx0aWYgKEJsb2IuZmFrZSkge1xyXG5cdFx0XHQvLyBubyByZWFzb24gdG8gZGVjb2RlIGEgZGF0YTogVVJJIHRoYXQncyBqdXN0IGdvaW5nIHRvIGJlY29tZSBhIGRhdGEgVVJJIGFnYWluXHJcblx0XHRcdGJsb2IgPSBuZXcgQmxvYlxyXG5cdFx0XHRpZiAoaXNfYmFzZTY0KSB7XHJcblx0XHRcdFx0YmxvYi5lbmNvZGluZyA9IFwiYmFzZTY0XCI7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0YmxvYi5lbmNvZGluZyA9IFwiVVJJXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0YmxvYi5kYXRhID0gZGF0YTtcclxuXHRcdFx0YmxvYi5zaXplID0gZGF0YS5sZW5ndGg7XHJcblx0XHR9IGVsc2UgaWYgKFVpbnQ4QXJyYXkpIHtcclxuXHRcdFx0aWYgKGlzX2Jhc2U2NCkge1xyXG5cdFx0XHRcdGJsb2IgPSBuZXcgQmxvYihbZGVjb2RlX2Jhc2U2NChkYXRhKV0sIHt0eXBlOiB0eXBlfSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0YmxvYiA9IG5ldyBCbG9iKFtkZWNvZGVVUklDb21wb25lbnQoZGF0YSldLCB7dHlwZTogdHlwZX0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYWxsYmFjayhibG9iKTtcclxuXHR9O1xyXG5cclxuXHRpZiAoY2FudmFzX3Byb3RvLnRvRGF0YVVSTEhEKSB7XHJcblx0XHRjYW52YXNfcHJvdG8udG9CbG9iSEQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0dG9fZGF0YV91cmwgPSBcInRvRGF0YVVSTEhEXCI7XHJcblx0XHRcdHZhciBibG9iID0gdGhpcy50b0Jsb2IoKTtcclxuXHRcdFx0dG9fZGF0YV91cmwgPSBcInRvRGF0YVVSTFwiO1xyXG5cdFx0XHRyZXR1cm4gYmxvYjtcclxuXHRcdH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0Y2FudmFzX3Byb3RvLnRvQmxvYkhEID0gY2FudmFzX3Byb3RvLnRvQmxvYjtcclxuXHR9XHJcbn1cclxufSh0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmIHx8IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93IHx8IHRoaXMuY29udGVudCB8fCB0aGlzKSk7XHJcblxyXG4vKiBGaWxlU2F2ZXIuanNcclxuICogQSBzYXZlQXMoKSBGaWxlU2F2ZXIgaW1wbGVtZW50YXRpb24uXHJcbiAqIDIwMTUtMDMtMDRcclxuICpcclxuICogQnkgRWxpIEdyZXksIGh0dHA6Ly9lbGlncmV5LmNvbVxyXG4gKiBMaWNlbnNlOiBYMTEvTUlUXHJcbiAqICAgU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9lbGlncmV5L0ZpbGVTYXZlci5qcy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kXHJcbiAqL1xyXG5cclxuLypnbG9iYWwgc2VsZiAqL1xyXG4vKmpzbGludCBiaXR3aXNlOiB0cnVlLCBpbmRlbnQ6IDQsIGxheGJyZWFrOiB0cnVlLCBsYXhjb21tYTogdHJ1ZSwgc21hcnR0YWJzOiB0cnVlLCBwbHVzcGx1czogdHJ1ZSAqL1xyXG5cclxuLyohIEBzb3VyY2UgaHR0cDovL3B1cmwuZWxpZ3JleS5jb20vZ2l0aHViL0ZpbGVTYXZlci5qcy9ibG9iL21hc3Rlci9GaWxlU2F2ZXIuanMgKi9cclxuXHJcbnZhciBzYXZlQXMgPSBzYXZlQXNcclxuICAvLyBJRSAxMCsgKG5hdGl2ZSBzYXZlQXMpXHJcbiAgfHwgKHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCIgJiZcclxuICAgICAgbmF2aWdhdG9yLm1zU2F2ZU9yT3BlbkJsb2IgJiYgbmF2aWdhdG9yLm1zU2F2ZU9yT3BlbkJsb2IuYmluZChuYXZpZ2F0b3IpKVxyXG4gIC8vIEV2ZXJ5b25lIGVsc2VcclxuICB8fCAoZnVuY3Rpb24odmlldykge1xyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdC8vIElFIDwxMCBpcyBleHBsaWNpdGx5IHVuc3VwcG9ydGVkXHJcblx0aWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCIgJiZcclxuXHQgICAgL01TSUUgWzEtOV1cXC4vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0dmFyXHJcblx0XHQgIGRvYyA9IHZpZXcuZG9jdW1lbnRcclxuXHRcdCAgLy8gb25seSBnZXQgVVJMIHdoZW4gbmVjZXNzYXJ5IGluIGNhc2UgQmxvYi5qcyBoYXNuJ3Qgb3ZlcnJpZGRlbiBpdCB5ZXRcclxuXHRcdCwgZ2V0X1VSTCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gdmlldy5VUkwgfHwgdmlldy53ZWJraXRVUkwgfHwgdmlldztcclxuXHRcdH1cclxuXHRcdCwgc2F2ZV9saW5rID0gZG9jLmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIiwgXCJhXCIpXHJcblx0XHQsIGNhbl91c2Vfc2F2ZV9saW5rID0gXCJkb3dubG9hZFwiIGluIHNhdmVfbGlua1xyXG5cdFx0LCBjbGljayA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuXHRcdFx0dmFyIGV2ZW50ID0gZG9jLmNyZWF0ZUV2ZW50KFwiTW91c2VFdmVudHNcIik7XHJcblx0XHRcdGV2ZW50LmluaXRNb3VzZUV2ZW50KFxyXG5cdFx0XHRcdFwiY2xpY2tcIiwgdHJ1ZSwgZmFsc2UsIHZpZXcsIDAsIDAsIDAsIDAsIDBcclxuXHRcdFx0XHQsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCBudWxsXHJcblx0XHRcdCk7XHJcblx0XHRcdG5vZGUuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcblx0XHR9XHJcblx0XHQsIHdlYmtpdF9yZXFfZnMgPSB2aWV3LndlYmtpdFJlcXVlc3RGaWxlU3lzdGVtXHJcblx0XHQsIHJlcV9mcyA9IHZpZXcucmVxdWVzdEZpbGVTeXN0ZW0gfHwgd2Via2l0X3JlcV9mcyB8fCB2aWV3Lm1velJlcXVlc3RGaWxlU3lzdGVtXHJcblx0XHQsIHRocm93X291dHNpZGUgPSBmdW5jdGlvbihleCkge1xyXG5cdFx0XHQodmlldy5zZXRJbW1lZGlhdGUgfHwgdmlldy5zZXRUaW1lb3V0KShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR0aHJvdyBleDtcclxuXHRcdFx0fSwgMCk7XHJcblx0XHR9XHJcblx0XHQsIGZvcmNlX3NhdmVhYmxlX3R5cGUgPSBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiXHJcblx0XHQsIGZzX21pbl9zaXplID0gMFxyXG5cdFx0Ly8gU2VlIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0zNzUyOTcjYzcgYW5kXHJcblx0XHQvLyBodHRwczovL2dpdGh1Yi5jb20vZWxpZ3JleS9GaWxlU2F2ZXIuanMvY29tbWl0LzQ4NTkzMGEjY29tbWl0Y29tbWVudC04NzY4MDQ3XHJcblx0XHQvLyBmb3IgdGhlIHJlYXNvbmluZyBiZWhpbmQgdGhlIHRpbWVvdXQgYW5kIHJldm9jYXRpb24gZmxvd1xyXG5cdFx0LCBhcmJpdHJhcnlfcmV2b2tlX3RpbWVvdXQgPSA1MDAgLy8gaW4gbXNcclxuXHRcdCwgcmV2b2tlID0gZnVuY3Rpb24oZmlsZSkge1xyXG5cdFx0XHR2YXIgcmV2b2tlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmICh0eXBlb2YgZmlsZSA9PT0gXCJzdHJpbmdcIikgeyAvLyBmaWxlIGlzIGFuIG9iamVjdCBVUkxcclxuXHRcdFx0XHRcdGdldF9VUkwoKS5yZXZva2VPYmplY3RVUkwoZmlsZSk7XHJcblx0XHRcdFx0fSBlbHNlIHsgLy8gZmlsZSBpcyBhIEZpbGVcclxuXHRcdFx0XHRcdGZpbGUucmVtb3ZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cdFx0XHRpZiAodmlldy5jaHJvbWUpIHtcclxuXHRcdFx0XHRyZXZva2VyKCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0c2V0VGltZW91dChyZXZva2VyLCBhcmJpdHJhcnlfcmV2b2tlX3RpbWVvdXQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQsIGRpc3BhdGNoID0gZnVuY3Rpb24oZmlsZXNhdmVyLCBldmVudF90eXBlcywgZXZlbnQpIHtcclxuXHRcdFx0ZXZlbnRfdHlwZXMgPSBbXS5jb25jYXQoZXZlbnRfdHlwZXMpO1xyXG5cdFx0XHR2YXIgaSA9IGV2ZW50X3R5cGVzLmxlbmd0aDtcclxuXHRcdFx0d2hpbGUgKGktLSkge1xyXG5cdFx0XHRcdHZhciBsaXN0ZW5lciA9IGZpbGVzYXZlcltcIm9uXCIgKyBldmVudF90eXBlc1tpXV07XHJcblx0XHRcdFx0aWYgKHR5cGVvZiBsaXN0ZW5lciA9PT0gXCJmdW5jdGlvblwiKSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRsaXN0ZW5lci5jYWxsKGZpbGVzYXZlciwgZXZlbnQgfHwgZmlsZXNhdmVyKTtcclxuXHRcdFx0XHRcdH0gY2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0XHRcdHRocm93X291dHNpZGUoZXgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0LCBGaWxlU2F2ZXIgPSBmdW5jdGlvbihibG9iLCBuYW1lKSB7XHJcblx0XHRcdC8vIEZpcnN0IHRyeSBhLmRvd25sb2FkLCB0aGVuIHdlYiBmaWxlc3lzdGVtLCB0aGVuIG9iamVjdCBVUkxzXHJcblx0XHRcdHZhclxyXG5cdFx0XHRcdCAgZmlsZXNhdmVyID0gdGhpc1xyXG5cdFx0XHRcdCwgdHlwZSA9IGJsb2IudHlwZVxyXG5cdFx0XHRcdCwgYmxvYl9jaGFuZ2VkID0gZmFsc2VcclxuXHRcdFx0XHQsIG9iamVjdF91cmxcclxuXHRcdFx0XHQsIHRhcmdldF92aWV3XHJcblx0XHRcdFx0LCBkaXNwYXRjaF9hbGwgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGRpc3BhdGNoKGZpbGVzYXZlciwgXCJ3cml0ZXN0YXJ0IHByb2dyZXNzIHdyaXRlIHdyaXRlZW5kXCIuc3BsaXQoXCIgXCIpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gb24gYW55IGZpbGVzeXMgZXJyb3JzIHJldmVydCB0byBzYXZpbmcgd2l0aCBvYmplY3QgVVJMc1xyXG5cdFx0XHRcdCwgZnNfZXJyb3IgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdC8vIGRvbid0IGNyZWF0ZSBtb3JlIG9iamVjdCBVUkxzIHRoYW4gbmVlZGVkXHJcblx0XHRcdFx0XHRpZiAoYmxvYl9jaGFuZ2VkIHx8ICFvYmplY3RfdXJsKSB7XHJcblx0XHRcdFx0XHRcdG9iamVjdF91cmwgPSBnZXRfVVJMKCkuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKHRhcmdldF92aWV3KSB7XHJcblx0XHRcdFx0XHRcdHRhcmdldF92aWV3LmxvY2F0aW9uLmhyZWYgPSBvYmplY3RfdXJsO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0dmFyIG5ld190YWIgPSB2aWV3Lm9wZW4ob2JqZWN0X3VybCwgXCJfYmxhbmtcIik7XHJcblx0XHRcdFx0XHRcdGlmIChuZXdfdGFiID09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygc2FmYXJpICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly9BcHBsZSBkbyBub3QgYWxsb3cgd2luZG93Lm9wZW4sIHNlZSBodHRwOi8vYml0Lmx5LzFrWmZmUklcclxuXHRcdFx0XHRcdFx0XHR2aWV3LmxvY2F0aW9uLmhyZWYgPSBvYmplY3RfdXJsXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLkRPTkU7XHJcblx0XHRcdFx0XHRkaXNwYXRjaF9hbGwoKTtcclxuXHRcdFx0XHRcdHJldm9rZShvYmplY3RfdXJsKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0LCBhYm9ydGFibGUgPSBmdW5jdGlvbihmdW5jKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdGlmIChmaWxlc2F2ZXIucmVhZHlTdGF0ZSAhPT0gZmlsZXNhdmVyLkRPTkUpIHtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQsIGNyZWF0ZV9pZl9ub3RfZm91bmQgPSB7Y3JlYXRlOiB0cnVlLCBleGNsdXNpdmU6IGZhbHNlfVxyXG5cdFx0XHRcdCwgc2xpY2VcclxuXHRcdFx0O1xyXG5cdFx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5JTklUO1xyXG5cdFx0XHRpZiAoIW5hbWUpIHtcclxuXHRcdFx0XHRuYW1lID0gXCJkb3dubG9hZFwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChjYW5fdXNlX3NhdmVfbGluaykge1xyXG5cdFx0XHRcdG9iamVjdF91cmwgPSBnZXRfVVJMKCkuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG5cdFx0XHRcdHNhdmVfbGluay5ocmVmID0gb2JqZWN0X3VybDtcclxuXHRcdFx0XHRzYXZlX2xpbmsuZG93bmxvYWQgPSBuYW1lO1xyXG5cdFx0XHRcdGNsaWNrKHNhdmVfbGluayk7XHJcblx0XHRcdFx0ZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuRE9ORTtcclxuXHRcdFx0XHRkaXNwYXRjaF9hbGwoKTtcclxuXHRcdFx0XHRyZXZva2Uob2JqZWN0X3VybCk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIHByZXBlbmQgQk9NIGZvciBVVEYtOCBYTUwgYW5kIHRleHQvcGxhaW4gdHlwZXNcclxuXHRcdFx0aWYgKC9eXFxzKig/OnRleHRcXC8oPzpwbGFpbnx4bWwpfGFwcGxpY2F0aW9uXFwveG1sfFxcUypcXC9cXFMqXFwreG1sKVxccyo7LipjaGFyc2V0XFxzKj1cXHMqdXRmLTgvaS50ZXN0KGJsb2IudHlwZSkpIHtcclxuXHRcdFx0XHRibG9iID0gbmV3IEJsb2IoW1wiXFx1ZmVmZlwiLCBibG9iXSwge3R5cGU6IGJsb2IudHlwZX0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIE9iamVjdCBhbmQgd2ViIGZpbGVzeXN0ZW0gVVJMcyBoYXZlIGEgcHJvYmxlbSBzYXZpbmcgaW4gR29vZ2xlIENocm9tZSB3aGVuXHJcblx0XHRcdC8vIHZpZXdlZCBpbiBhIHRhYiwgc28gSSBmb3JjZSBzYXZlIHdpdGggYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXHJcblx0XHRcdC8vIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTkxMTU4XHJcblx0XHRcdC8vIFVwZGF0ZTogR29vZ2xlIGVycmFudGx5IGNsb3NlZCA5MTE1OCwgSSBzdWJtaXR0ZWQgaXQgYWdhaW46XHJcblx0XHRcdC8vIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0zODk2NDJcclxuXHRcdFx0aWYgKHZpZXcuY2hyb21lICYmIHR5cGUgJiYgdHlwZSAhPT0gZm9yY2Vfc2F2ZWFibGVfdHlwZSkge1xyXG5cdFx0XHRcdHNsaWNlID0gYmxvYi5zbGljZSB8fCBibG9iLndlYmtpdFNsaWNlO1xyXG5cdFx0XHRcdGJsb2IgPSBzbGljZS5jYWxsKGJsb2IsIDAsIGJsb2Iuc2l6ZSwgZm9yY2Vfc2F2ZWFibGVfdHlwZSk7XHJcblx0XHRcdFx0YmxvYl9jaGFuZ2VkID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBTaW5jZSBJIGNhbid0IGJlIHN1cmUgdGhhdCB0aGUgZ3Vlc3NlZCBtZWRpYSB0eXBlIHdpbGwgdHJpZ2dlciBhIGRvd25sb2FkXHJcblx0XHRcdC8vIGluIFdlYktpdCwgSSBhcHBlbmQgLmRvd25sb2FkIHRvIHRoZSBmaWxlbmFtZS5cclxuXHRcdFx0Ly8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTY1NDQwXHJcblx0XHRcdGlmICh3ZWJraXRfcmVxX2ZzICYmIG5hbWUgIT09IFwiZG93bmxvYWRcIikge1xyXG5cdFx0XHRcdG5hbWUgKz0gXCIuZG93bmxvYWRcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodHlwZSA9PT0gZm9yY2Vfc2F2ZWFibGVfdHlwZSB8fCB3ZWJraXRfcmVxX2ZzKSB7XHJcblx0XHRcdFx0dGFyZ2V0X3ZpZXcgPSB2aWV3O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICghcmVxX2ZzKSB7XHJcblx0XHRcdFx0ZnNfZXJyb3IoKTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0ZnNfbWluX3NpemUgKz0gYmxvYi5zaXplO1xyXG5cdFx0XHRyZXFfZnModmlldy5URU1QT1JBUlksIGZzX21pbl9zaXplLCBhYm9ydGFibGUoZnVuY3Rpb24oZnMpIHtcclxuXHRcdFx0XHRmcy5yb290LmdldERpcmVjdG9yeShcInNhdmVkXCIsIGNyZWF0ZV9pZl9ub3RfZm91bmQsIGFib3J0YWJsZShmdW5jdGlvbihkaXIpIHtcclxuXHRcdFx0XHRcdHZhciBzYXZlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdGRpci5nZXRGaWxlKG5hbWUsIGNyZWF0ZV9pZl9ub3RfZm91bmQsIGFib3J0YWJsZShmdW5jdGlvbihmaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0ZmlsZS5jcmVhdGVXcml0ZXIoYWJvcnRhYmxlKGZ1bmN0aW9uKHdyaXRlcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0d3JpdGVyLm9ud3JpdGVlbmQgPSBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0YXJnZXRfdmlldy5sb2NhdGlvbi5ocmVmID0gZmlsZS50b1VSTCgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRmaWxlc2F2ZXIucmVhZHlTdGF0ZSA9IGZpbGVzYXZlci5ET05FO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkaXNwYXRjaChmaWxlc2F2ZXIsIFwid3JpdGVlbmRcIiwgZXZlbnQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXZva2UoZmlsZSk7XHJcblx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHRcdFx0d3JpdGVyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGVycm9yID0gd3JpdGVyLmVycm9yO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoZXJyb3IuY29kZSAhPT0gZXJyb3IuQUJPUlRfRVJSKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZnNfZXJyb3IoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHRcdFwid3JpdGVzdGFydCBwcm9ncmVzcyB3cml0ZSBhYm9ydFwiLnNwbGl0KFwiIFwiKS5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHdyaXRlcltcIm9uXCIgKyBldmVudF0gPSBmaWxlc2F2ZXJbXCJvblwiICsgZXZlbnRdO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHR3cml0ZXIud3JpdGUoYmxvYik7XHJcblx0XHRcdFx0XHRcdFx0XHRmaWxlc2F2ZXIuYWJvcnQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0d3JpdGVyLmFib3J0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLkRPTkU7XHJcblx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHRcdFx0ZmlsZXNhdmVyLnJlYWR5U3RhdGUgPSBmaWxlc2F2ZXIuV1JJVElORztcclxuXHRcdFx0XHRcdFx0XHR9KSwgZnNfZXJyb3IpO1xyXG5cdFx0XHRcdFx0XHR9KSwgZnNfZXJyb3IpO1xyXG5cdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdGRpci5nZXRGaWxlKG5hbWUsIHtjcmVhdGU6IGZhbHNlfSwgYWJvcnRhYmxlKGZ1bmN0aW9uKGZpbGUpIHtcclxuXHRcdFx0XHRcdFx0Ly8gZGVsZXRlIGZpbGUgaWYgaXQgYWxyZWFkeSBleGlzdHNcclxuXHRcdFx0XHRcdFx0ZmlsZS5yZW1vdmUoKTtcclxuXHRcdFx0XHRcdFx0c2F2ZSgpO1xyXG5cdFx0XHRcdFx0fSksIGFib3J0YWJsZShmdW5jdGlvbihleCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZXguY29kZSA9PT0gZXguTk9UX0ZPVU5EX0VSUikge1xyXG5cdFx0XHRcdFx0XHRcdHNhdmUoKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRmc19lcnJvcigpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KSk7XHJcblx0XHRcdFx0fSksIGZzX2Vycm9yKTtcclxuXHRcdFx0fSksIGZzX2Vycm9yKTtcclxuXHRcdH1cclxuXHRcdCwgRlNfcHJvdG8gPSBGaWxlU2F2ZXIucHJvdG90eXBlXHJcblx0XHQsIHNhdmVBcyA9IGZ1bmN0aW9uKGJsb2IsIG5hbWUpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBGaWxlU2F2ZXIoYmxvYiwgbmFtZSk7XHJcblx0XHR9XHJcblx0O1xyXG5cdEZTX3Byb3RvLmFib3J0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZmlsZXNhdmVyID0gdGhpcztcclxuXHRcdGZpbGVzYXZlci5yZWFkeVN0YXRlID0gZmlsZXNhdmVyLkRPTkU7XHJcblx0XHRkaXNwYXRjaChmaWxlc2F2ZXIsIFwiYWJvcnRcIik7XHJcblx0fTtcclxuXHRGU19wcm90by5yZWFkeVN0YXRlID0gRlNfcHJvdG8uSU5JVCA9IDA7XHJcblx0RlNfcHJvdG8uV1JJVElORyA9IDE7XHJcblx0RlNfcHJvdG8uRE9ORSA9IDI7XHJcblxyXG5cdEZTX3Byb3RvLmVycm9yID1cclxuXHRGU19wcm90by5vbndyaXRlc3RhcnQgPVxyXG5cdEZTX3Byb3RvLm9ucHJvZ3Jlc3MgPVxyXG5cdEZTX3Byb3RvLm9ud3JpdGUgPVxyXG5cdEZTX3Byb3RvLm9uYWJvcnQgPVxyXG5cdEZTX3Byb3RvLm9uZXJyb3IgPVxyXG5cdEZTX3Byb3RvLm9ud3JpdGVlbmQgPVxyXG5cdFx0bnVsbDtcclxuXHJcblx0cmV0dXJuIHNhdmVBcztcclxufShcclxuXHQgICB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzZWxmXHJcblx0fHwgdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3dcclxuXHR8fCB0aGlzLmNvbnRlbnRcclxuKSk7XHJcbi8vIGBzZWxmYCBpcyB1bmRlZmluZWQgaW4gRmlyZWZveCBmb3IgQW5kcm9pZCBjb250ZW50IHNjcmlwdCBjb250ZXh0XHJcbi8vIHdoaWxlIGB0aGlzYCBpcyBuc0lDb250ZW50RnJhbWVNZXNzYWdlTWFuYWdlclxyXG4vLyB3aXRoIGFuIGF0dHJpYnV0ZSBgY29udGVudGAgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgd2luZG93XHJcblxyXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUuZXhwb3J0cykge1xyXG4gIG1vZHVsZS5leHBvcnRzLnNhdmVBcyA9IHNhdmVBcztcclxufSBlbHNlIGlmICgodHlwZW9mIGRlZmluZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBkZWZpbmUgIT09IG51bGwpICYmIChkZWZpbmUuYW1kICE9IG51bGwpKSB7XHJcbiAgZGVmaW5lKFtdLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBzYXZlQXM7XHJcbiAgfSk7XHJcbn1cclxuIiwiLyoqXHJcbiogc2ltcGxlUGFnaW5hdGlvbi5qcyB2MS42XHJcbiogQSBzaW1wbGUgalF1ZXJ5IHBhZ2luYXRpb24gcGx1Z2luLlxyXG4qIGh0dHA6Ly9mbGF2aXVzbWF0aXMuZ2l0aHViLmNvbS9zaW1wbGVQYWdpbmF0aW9uLmpzL1xyXG4qXHJcbiogQ29weXJpZ2h0IDIwMTIsIEZsYXZpdXMgTWF0aXNcclxuKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXHJcbiogaHR0cDovL2ZsYXZpdXNtYXRpcy5naXRodWIuY29tL2xpY2Vuc2UuaHRtbFxyXG4qL1xyXG5cclxuKGZ1bmN0aW9uKCQpe1xyXG5cclxuXHR2YXIgbWV0aG9kcyA9IHtcclxuXHRcdGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuXHRcdFx0dmFyIG8gPSAkLmV4dGVuZCh7XHJcblx0XHRcdFx0aXRlbXM6IDEsXHJcblx0XHRcdFx0aXRlbXNPblBhZ2U6IDEsXHJcblx0XHRcdFx0cGFnZXM6IDAsXHJcblx0XHRcdFx0ZGlzcGxheWVkUGFnZXM6IDUsXHJcblx0XHRcdFx0ZWRnZXM6IDIsXHJcblx0XHRcdFx0Y3VycmVudFBhZ2U6IDAsXHJcblx0XHRcdFx0aHJlZlRleHRQcmVmaXg6ICcjcGFnZS0nLFxyXG5cdFx0XHRcdGhyZWZUZXh0U3VmZml4OiAnJyxcclxuXHRcdFx0XHRwcmV2VGV4dDogJ1ByZXYnLFxyXG5cdFx0XHRcdG5leHRUZXh0OiAnTmV4dCcsXHJcblx0XHRcdFx0ZWxsaXBzZVRleHQ6ICcmaGVsbGlwOycsXHJcblx0XHRcdFx0Y3NzU3R5bGU6ICdsaWdodC10aGVtZScsXHJcblx0XHRcdFx0bGFiZWxNYXA6IFtdLFxyXG5cdFx0XHRcdHNlbGVjdE9uQ2xpY2s6IHRydWUsXHJcblx0XHRcdFx0bmV4dEF0RnJvbnQ6IGZhbHNlLFxyXG5cdFx0XHRcdGludmVydFBhZ2VPcmRlcjogZmFsc2UsXHJcblx0XHRcdFx0b25QYWdlQ2xpY2s6IGZ1bmN0aW9uKHBhZ2VOdW1iZXIsIGV2ZW50KSB7XHJcblx0XHRcdFx0XHQvLyBDYWxsYmFjayB0cmlnZ2VyZWQgd2hlbiBhIHBhZ2UgaXMgY2xpY2tlZFxyXG5cdFx0XHRcdFx0Ly8gUGFnZSBudW1iZXIgaXMgZ2l2ZW4gYXMgYW4gb3B0aW9uYWwgcGFyYW1ldGVyXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRvbkluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly8gQ2FsbGJhY2sgdHJpZ2dlcmVkIGltbWVkaWF0ZWx5IGFmdGVyIGluaXRpYWxpemF0aW9uXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCBvcHRpb25zIHx8IHt9KTtcclxuXHJcblx0XHRcdHZhciBzZWxmID0gdGhpcztcclxuXHJcblx0XHRcdG8ucGFnZXMgPSBvLnBhZ2VzID8gby5wYWdlcyA6IE1hdGguY2VpbChvLml0ZW1zIC8gby5pdGVtc09uUGFnZSkgPyBNYXRoLmNlaWwoby5pdGVtcyAvIG8uaXRlbXNPblBhZ2UpIDogMTtcclxuXHRcdFx0aWYgKG8uY3VycmVudFBhZ2UpXHJcblx0XHRcdFx0by5jdXJyZW50UGFnZSA9IG8uY3VycmVudFBhZ2UgLSAxO1xyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0by5jdXJyZW50UGFnZSA9ICFvLmludmVydFBhZ2VPcmRlciA/IDAgOiBvLnBhZ2VzIC0gMTtcclxuXHRcdFx0by5oYWxmRGlzcGxheWVkID0gby5kaXNwbGF5ZWRQYWdlcyAvIDI7XHJcblxyXG5cdFx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0c2VsZi5hZGRDbGFzcyhvLmNzc1N0eWxlICsgJyBzaW1wbGUtcGFnaW5hdGlvbicpLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcclxuXHRcdFx0XHRtZXRob2RzLl9kcmF3LmNhbGwoc2VsZik7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0by5vbkluaXQoKTtcclxuXHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRzZWxlY3RQYWdlOiBmdW5jdGlvbihwYWdlKSB7XHJcblx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBwYWdlIC0gMSk7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRwcmV2UGFnZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyk7XHJcblx0XHRcdGlmICghby5pbnZlcnRQYWdlT3JkZXIpIHtcclxuXHRcdFx0XHRpZiAoby5jdXJyZW50UGFnZSA+IDApIHtcclxuXHRcdFx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBvLmN1cnJlbnRQYWdlIC0gMSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmIChvLmN1cnJlbnRQYWdlIDwgby5wYWdlcyAtIDEpIHtcclxuXHRcdFx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBvLmN1cnJlbnRQYWdlICsgMSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRuZXh0UGFnZTogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHZhciBvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyk7XHJcblx0XHRcdGlmICghby5pbnZlcnRQYWdlT3JkZXIpIHtcclxuXHRcdFx0XHRpZiAoby5jdXJyZW50UGFnZSA8IG8ucGFnZXMgLSAxKSB7XHJcblx0XHRcdFx0XHRtZXRob2RzLl9zZWxlY3RQYWdlLmNhbGwodGhpcywgby5jdXJyZW50UGFnZSArIDEpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoby5jdXJyZW50UGFnZSA+IDApIHtcclxuXHRcdFx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCBvLmN1cnJlbnRQYWdlIC0gMSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRnZXRQYWdlc0NvdW50OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZGF0YSgncGFnaW5hdGlvbicpLnBhZ2VzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRnZXRDdXJyZW50UGFnZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJykuY3VycmVudFBhZ2UgKyAxO1xyXG5cdFx0fSxcclxuXHJcblx0XHRkZXN0cm95OiBmdW5jdGlvbigpe1xyXG5cdFx0XHR0aGlzLmVtcHR5KCk7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRkcmF3UGFnZTogZnVuY3Rpb24gKHBhZ2UpIHtcclxuXHRcdFx0dmFyIG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKTtcclxuXHRcdFx0by5jdXJyZW50UGFnZSA9IHBhZ2UgLSAxO1xyXG5cdFx0XHR0aGlzLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcclxuXHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHRoaXMpO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblxyXG5cdFx0cmVkcmF3OiBmdW5jdGlvbigpe1xyXG5cdFx0XHRtZXRob2RzLl9kcmF3LmNhbGwodGhpcyk7XHJcblx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0fSxcclxuXHJcblx0XHRkaXNhYmxlOiBmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xyXG5cdFx0XHRvLmRpc2FibGVkID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5kYXRhKCdwYWdpbmF0aW9uJywgbyk7XHJcblx0XHRcdG1ldGhvZHMuX2RyYXcuY2FsbCh0aGlzKTtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdGVuYWJsZTogZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKTtcclxuXHRcdFx0by5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmRhdGEoJ3BhZ2luYXRpb24nLCBvKTtcclxuXHRcdFx0bWV0aG9kcy5fZHJhdy5jYWxsKHRoaXMpO1xyXG5cdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdH0sXHJcblxyXG5cdFx0dXBkYXRlSXRlbXM6IGZ1bmN0aW9uIChuZXdJdGVtcykge1xyXG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xyXG5cdFx0XHRvLml0ZW1zID0gbmV3SXRlbXM7XHJcblx0XHRcdG8ucGFnZXMgPSBtZXRob2RzLl9nZXRQYWdlcyhvKTtcclxuXHRcdFx0dGhpcy5kYXRhKCdwYWdpbmF0aW9uJywgbyk7XHJcblx0XHRcdG1ldGhvZHMuX2RyYXcuY2FsbCh0aGlzKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0dXBkYXRlSXRlbXNPblBhZ2U6IGZ1bmN0aW9uIChpdGVtc09uUGFnZSkge1xyXG5cdFx0XHR2YXIgbyA9IHRoaXMuZGF0YSgncGFnaW5hdGlvbicpO1xyXG5cdFx0XHRvLml0ZW1zT25QYWdlID0gaXRlbXNPblBhZ2U7XHJcblx0XHRcdG8ucGFnZXMgPSBtZXRob2RzLl9nZXRQYWdlcyhvKTtcclxuXHRcdFx0dGhpcy5kYXRhKCdwYWdpbmF0aW9uJywgbyk7XHJcblx0XHRcdG1ldGhvZHMuX3NlbGVjdFBhZ2UuY2FsbCh0aGlzLCAwKTtcclxuXHRcdFx0cmV0dXJuIHRoaXM7XHJcblx0XHR9LFxyXG5cclxuXHRcdF9kcmF3OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyXHRvID0gdGhpcy5kYXRhKCdwYWdpbmF0aW9uJyksXHJcblx0XHRcdFx0aW50ZXJ2YWwgPSBtZXRob2RzLl9nZXRJbnRlcnZhbChvKSxcclxuXHRcdFx0XHRpLFxyXG5cdFx0XHRcdHRhZ05hbWU7XHJcblxyXG5cdFx0XHRtZXRob2RzLmRlc3Ryb3kuY2FsbCh0aGlzKTtcclxuXHRcdFx0XHJcblx0XHRcdHRhZ05hbWUgPSAodHlwZW9mIHRoaXMucHJvcCA9PT0gJ2Z1bmN0aW9uJykgPyB0aGlzLnByb3AoJ3RhZ05hbWUnKSA6IHRoaXMuYXR0cigndGFnTmFtZScpO1xyXG5cclxuXHRcdFx0dmFyICRwYW5lbCA9IHRhZ05hbWUgPT09ICdVTCcgPyB0aGlzIDogJCgnPHVsPjwvdWw+JykuYXBwZW5kVG8odGhpcyk7XHJcblxyXG5cdFx0XHQvLyBHZW5lcmF0ZSBQcmV2IGxpbmtcclxuXHRcdFx0aWYgKG8ucHJldlRleHQpIHtcclxuXHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgIW8uaW52ZXJ0UGFnZU9yZGVyID8gby5jdXJyZW50UGFnZSAtIDEgOiBvLmN1cnJlbnRQYWdlICsgMSwge3RleHQ6IG8ucHJldlRleHQsIGNsYXNzZXM6ICdwcmV2J30pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBHZW5lcmF0ZSBOZXh0IGxpbmsgKGlmIG9wdGlvbiBzZXQgZm9yIGF0IGZyb250KVxyXG5cdFx0XHRpZiAoby5uZXh0VGV4dCAmJiBvLm5leHRBdEZyb250KSB7XHJcblx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsICFvLmludmVydFBhZ2VPcmRlciA/IG8uY3VycmVudFBhZ2UgKyAxIDogby5jdXJyZW50UGFnZSAtIDEsIHt0ZXh0OiBvLm5leHRUZXh0LCBjbGFzc2VzOiAnbmV4dCd9KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gR2VuZXJhdGUgc3RhcnQgZWRnZXNcclxuXHRcdFx0aWYgKCFvLmludmVydFBhZ2VPcmRlcikge1xyXG5cdFx0XHRcdGlmIChpbnRlcnZhbC5zdGFydCA+IDAgJiYgby5lZGdlcyA+IDApIHtcclxuXHRcdFx0XHRcdHZhciBlbmQgPSBNYXRoLm1pbihvLmVkZ2VzLCBpbnRlcnZhbC5zdGFydCk7XHJcblx0XHRcdFx0XHRmb3IgKGkgPSAwOyBpIDwgZW5kOyBpKyspIHtcclxuXHRcdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYgKG8uZWRnZXMgPCBpbnRlcnZhbC5zdGFydCAmJiAoaW50ZXJ2YWwuc3RhcnQgLSBvLmVkZ2VzICE9IDEpKSB7XHJcblx0XHRcdFx0XHRcdCRwYW5lbC5hcHBlbmQoJzxsaSBjbGFzcz1cImRpc2FibGVkXCI+PHNwYW4gY2xhc3M9XCJlbGxpcHNlXCI+JyArIG8uZWxsaXBzZVRleHQgKyAnPC9zcGFuPjwvbGk+Jyk7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGludGVydmFsLnN0YXJ0IC0gby5lZGdlcyA9PSAxKSB7XHJcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBvLmVkZ2VzKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKGludGVydmFsLmVuZCA8IG8ucGFnZXMgJiYgby5lZGdlcyA+IDApIHtcclxuXHRcdFx0XHRcdHZhciBiZWdpbiA9IE1hdGgubWF4KG8ucGFnZXMgLSBvLmVkZ2VzLCBpbnRlcnZhbC5lbmQpO1xyXG5cdFx0XHRcdFx0Zm9yIChpID0gby5wYWdlcyAtIDE7IGkgPj0gYmVnaW47IGktLSkge1xyXG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAoby5wYWdlcyAtIG8uZWRnZXMgPiBpbnRlcnZhbC5lbmQgJiYgKG8ucGFnZXMgLSBvLmVkZ2VzIC0gaW50ZXJ2YWwuZW5kICE9IDEpKSB7XHJcblx0XHRcdFx0XHRcdCRwYW5lbC5hcHBlbmQoJzxsaSBjbGFzcz1cImRpc2FibGVkXCI+PHNwYW4gY2xhc3M9XCJlbGxpcHNlXCI+JyArIG8uZWxsaXBzZVRleHQgKyAnPC9zcGFuPjwvbGk+Jyk7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKG8ucGFnZXMgLSBvLmVkZ2VzIC0gaW50ZXJ2YWwuZW5kID09IDEpIHtcclxuXHRcdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGludGVydmFsLmVuZCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBHZW5lcmF0ZSBpbnRlcnZhbCBsaW5rc1xyXG5cdFx0XHRpZiAoIW8uaW52ZXJ0UGFnZU9yZGVyKSB7XHJcblx0XHRcdFx0Zm9yIChpID0gaW50ZXJ2YWwuc3RhcnQ7IGkgPCBpbnRlcnZhbC5lbmQ7IGkrKykge1xyXG5cdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRmb3IgKGkgPSBpbnRlcnZhbC5lbmQgLSAxOyBpID49IGludGVydmFsLnN0YXJ0OyBpLS0pIHtcclxuXHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEdlbmVyYXRlIGVuZCBlZGdlc1xyXG5cdFx0XHRpZiAoIW8uaW52ZXJ0UGFnZU9yZGVyKSB7XHJcblx0XHRcdFx0aWYgKGludGVydmFsLmVuZCA8IG8ucGFnZXMgJiYgby5lZGdlcyA+IDApIHtcclxuXHRcdFx0XHRcdGlmIChvLnBhZ2VzIC0gby5lZGdlcyA+IGludGVydmFsLmVuZCAmJiAoby5wYWdlcyAtIG8uZWRnZXMgLSBpbnRlcnZhbC5lbmQgIT0gMSkpIHtcclxuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoby5wYWdlcyAtIG8uZWRnZXMgLSBpbnRlcnZhbC5lbmQgPT0gMSkge1xyXG5cdFx0XHRcdFx0XHRtZXRob2RzLl9hcHBlbmRJdGVtLmNhbGwodGhpcywgaW50ZXJ2YWwuZW5kKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHZhciBiZWdpbiA9IE1hdGgubWF4KG8ucGFnZXMgLSBvLmVkZ2VzLCBpbnRlcnZhbC5lbmQpO1xyXG5cdFx0XHRcdFx0Zm9yIChpID0gYmVnaW47IGkgPCBvLnBhZ2VzOyBpKyspIHtcclxuXHRcdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIGkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoaW50ZXJ2YWwuc3RhcnQgPiAwICYmIG8uZWRnZXMgPiAwKSB7XHJcblx0XHRcdFx0XHRpZiAoby5lZGdlcyA8IGludGVydmFsLnN0YXJ0ICYmIChpbnRlcnZhbC5zdGFydCAtIG8uZWRnZXMgIT0gMSkpIHtcclxuXHRcdFx0XHRcdFx0JHBhbmVsLmFwcGVuZCgnPGxpIGNsYXNzPVwiZGlzYWJsZWRcIj48c3BhbiBjbGFzcz1cImVsbGlwc2VcIj4nICsgby5lbGxpcHNlVGV4dCArICc8L3NwYW4+PC9saT4nKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaW50ZXJ2YWwuc3RhcnQgLSBvLmVkZ2VzID09IDEpIHtcclxuXHRcdFx0XHRcdFx0bWV0aG9kcy5fYXBwZW5kSXRlbS5jYWxsKHRoaXMsIG8uZWRnZXMpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dmFyIGVuZCA9IE1hdGgubWluKG8uZWRnZXMsIGludGVydmFsLnN0YXJ0KTtcclxuXHRcdFx0XHRcdGZvciAoaSA9IGVuZCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcblx0XHRcdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCBpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEdlbmVyYXRlIE5leHQgbGluayAodW5sZXNzIG9wdGlvbiBpcyBzZXQgZm9yIGF0IGZyb250KVxyXG5cdFx0XHRpZiAoby5uZXh0VGV4dCAmJiAhby5uZXh0QXRGcm9udCkge1xyXG5cdFx0XHRcdG1ldGhvZHMuX2FwcGVuZEl0ZW0uY2FsbCh0aGlzLCAhby5pbnZlcnRQYWdlT3JkZXIgPyBvLmN1cnJlbnRQYWdlICsgMSA6IG8uY3VycmVudFBhZ2UgLSAxLCB7dGV4dDogby5uZXh0VGV4dCwgY2xhc3NlczogJ25leHQnfSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblxyXG5cdFx0X2dldFBhZ2VzOiBmdW5jdGlvbihvKSB7XHJcblx0XHRcdHZhciBwYWdlcyA9IE1hdGguY2VpbChvLml0ZW1zIC8gby5pdGVtc09uUGFnZSk7XHJcblx0XHRcdHJldHVybiBwYWdlcyB8fCAxO1xyXG5cdFx0fSxcclxuXHJcblx0XHRfZ2V0SW50ZXJ2YWw6IGZ1bmN0aW9uKG8pIHtcclxuXHRcdFx0cmV0dXJuIHtcclxuXHRcdFx0XHRzdGFydDogTWF0aC5jZWlsKG8uY3VycmVudFBhZ2UgPiBvLmhhbGZEaXNwbGF5ZWQgPyBNYXRoLm1heChNYXRoLm1pbihvLmN1cnJlbnRQYWdlIC0gby5oYWxmRGlzcGxheWVkLCAoby5wYWdlcyAtIG8uZGlzcGxheWVkUGFnZXMpKSwgMCkgOiAwKSxcclxuXHRcdFx0XHRlbmQ6IE1hdGguY2VpbChvLmN1cnJlbnRQYWdlID4gby5oYWxmRGlzcGxheWVkID8gTWF0aC5taW4oby5jdXJyZW50UGFnZSArIG8uaGFsZkRpc3BsYXllZCwgby5wYWdlcykgOiBNYXRoLm1pbihvLmRpc3BsYXllZFBhZ2VzLCBvLnBhZ2VzKSlcclxuXHRcdFx0fTtcclxuXHRcdH0sXHJcblxyXG5cdFx0X2FwcGVuZEl0ZW06IGZ1bmN0aW9uKHBhZ2VJbmRleCwgb3B0cykge1xyXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsIG9wdGlvbnMsICRsaW5rLCBvID0gc2VsZi5kYXRhKCdwYWdpbmF0aW9uJyksICRsaW5rV3JhcHBlciA9ICQoJzxsaT48L2xpPicpLCAkdWwgPSBzZWxmLmZpbmQoJ3VsJyk7XHJcblxyXG5cdFx0XHRwYWdlSW5kZXggPSBwYWdlSW5kZXggPCAwID8gMCA6IChwYWdlSW5kZXggPCBvLnBhZ2VzID8gcGFnZUluZGV4IDogby5wYWdlcyAtIDEpO1xyXG5cclxuXHRcdFx0b3B0aW9ucyA9IHtcclxuXHRcdFx0XHR0ZXh0OiBwYWdlSW5kZXggKyAxLFxyXG5cdFx0XHRcdGNsYXNzZXM6ICcnXHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHRpZiAoby5sYWJlbE1hcC5sZW5ndGggJiYgby5sYWJlbE1hcFtwYWdlSW5kZXhdKSB7XHJcblx0XHRcdFx0b3B0aW9ucy50ZXh0ID0gby5sYWJlbE1hcFtwYWdlSW5kZXhdO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRvcHRpb25zID0gJC5leHRlbmQob3B0aW9ucywgb3B0cyB8fCB7fSk7XHJcblxyXG5cdFx0XHRpZiAocGFnZUluZGV4ID09IG8uY3VycmVudFBhZ2UgfHwgby5kaXNhYmxlZCkge1xyXG5cdFx0XHRcdGlmIChvLmRpc2FibGVkKSB7XHJcblx0XHRcdFx0XHQkbGlua1dyYXBwZXIuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCRsaW5rV3JhcHBlci5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCRsaW5rID0gJCgnPHNwYW4gY2xhc3M9XCJjdXJyZW50XCI+JyArIChvcHRpb25zLnRleHQpICsgJzwvc3Bhbj4nKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQkbGluayA9ICQoJzxhIGhyZWY9XCInICsgby5ocmVmVGV4dFByZWZpeCArIChwYWdlSW5kZXggKyAxKSArIG8uaHJlZlRleHRTdWZmaXggKyAnXCIgY2xhc3M9XCJwYWdlLWxpbmtcIj4nICsgKG9wdGlvbnMudGV4dCkgKyAnPC9hPicpO1xyXG5cdFx0XHRcdCRsaW5rLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KXtcclxuXHRcdFx0XHRcdHJldHVybiBtZXRob2RzLl9zZWxlY3RQYWdlLmNhbGwoc2VsZiwgcGFnZUluZGV4LCBldmVudCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChvcHRpb25zLmNsYXNzZXMpIHtcclxuXHRcdFx0XHQkbGluay5hZGRDbGFzcyhvcHRpb25zLmNsYXNzZXMpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQkbGlua1dyYXBwZXIuYXBwZW5kKCRsaW5rKTtcclxuXHJcblx0XHRcdGlmICgkdWwubGVuZ3RoKSB7XHJcblx0XHRcdFx0JHVsLmFwcGVuZCgkbGlua1dyYXBwZXIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHNlbGYuYXBwZW5kKCRsaW5rV3JhcHBlcik7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblxyXG5cdFx0X3NlbGVjdFBhZ2U6IGZ1bmN0aW9uKHBhZ2VJbmRleCwgZXZlbnQpIHtcclxuXHRcdFx0dmFyIG8gPSB0aGlzLmRhdGEoJ3BhZ2luYXRpb24nKTtcclxuXHRcdFx0by5jdXJyZW50UGFnZSA9IHBhZ2VJbmRleDtcclxuXHRcdFx0aWYgKG8uc2VsZWN0T25DbGljaykge1xyXG5cdFx0XHRcdG1ldGhvZHMuX2RyYXcuY2FsbCh0aGlzKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gby5vblBhZ2VDbGljayhwYWdlSW5kZXggKyAxLCBldmVudCk7XHJcblx0XHR9XHJcblxyXG5cdH07XHJcblxyXG5cdCQuZm4ucGFnaW5hdGlvbiA9IGZ1bmN0aW9uKG1ldGhvZCkge1xyXG5cclxuXHRcdC8vIE1ldGhvZCBjYWxsaW5nIGxvZ2ljXHJcblx0XHRpZiAobWV0aG9kc1ttZXRob2RdICYmIG1ldGhvZC5jaGFyQXQoMCkgIT0gJ18nKSB7XHJcblx0XHRcdHJldHVybiBtZXRob2RzW21ldGhvZF0uYXBwbHkodGhpcywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7XHJcblx0XHR9IGVsc2UgaWYgKHR5cGVvZiBtZXRob2QgPT09ICdvYmplY3QnIHx8ICFtZXRob2QpIHtcclxuXHRcdFx0cmV0dXJuIG1ldGhvZHMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0JC5lcnJvcignTWV0aG9kICcgKyAgbWV0aG9kICsgJyBkb2VzIG5vdCBleGlzdCBvbiBqUXVlcnkucGFnaW5hdGlvbicpO1xyXG5cdFx0fVxyXG5cclxuXHR9O1xyXG5cclxufSkoalF1ZXJ5KTtcclxuIiwiLy8gU3BlY3RydW0gQ29sb3JwaWNrZXIgdjEuNi4wXHJcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9iZ3JpbnMvc3BlY3RydW1cclxuLy8gQXV0aG9yOiBCcmlhbiBHcmluc3RlYWRcclxuLy8gTGljZW5zZTogTUlUXHJcblxyXG4oZnVuY3Rpb24gKGZhY3RvcnkpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsgLy8gQU1EXHJcbiAgICAgICAgZGVmaW5lKFsnanF1ZXJ5J10sIGZhY3RvcnkpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlID09IFwib2JqZWN0XCIpIHsgLy8gQ29tbW9uSlNcclxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3Rvcnk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHsgLy8gQnJvd3NlclxyXG4gICAgICAgIGZhY3RvcnkoalF1ZXJ5KTtcclxuICAgIH1cclxufSkoZnVuY3Rpb24oJCwgdW5kZWZpbmVkKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgICB2YXIgZGVmYXVsdE9wdHMgPSB7XHJcblxyXG4gICAgICAgIC8vIENhbGxiYWNrc1xyXG4gICAgICAgIGJlZm9yZVNob3c6IG5vb3AsXHJcbiAgICAgICAgbW92ZTogbm9vcCxcclxuICAgICAgICBjaGFuZ2U6IG5vb3AsXHJcbiAgICAgICAgc2hvdzogbm9vcCxcclxuICAgICAgICBoaWRlOiBub29wLFxyXG5cclxuICAgICAgICAvLyBPcHRpb25zXHJcbiAgICAgICAgY29sb3I6IGZhbHNlLFxyXG4gICAgICAgIGZsYXQ6IGZhbHNlLFxyXG4gICAgICAgIHNob3dJbnB1dDogZmFsc2UsXHJcbiAgICAgICAgYWxsb3dFbXB0eTogZmFsc2UsXHJcbiAgICAgICAgc2hvd0J1dHRvbnM6IHRydWUsXHJcbiAgICAgICAgY2xpY2tvdXRGaXJlc0NoYW5nZTogZmFsc2UsXHJcbiAgICAgICAgc2hvd0luaXRpYWw6IGZhbHNlLFxyXG4gICAgICAgIHNob3dQYWxldHRlOiBmYWxzZSxcclxuICAgICAgICBzaG93UGFsZXR0ZU9ubHk6IGZhbHNlLFxyXG4gICAgICAgIGhpZGVBZnRlclBhbGV0dGVTZWxlY3Q6IGZhbHNlLFxyXG4gICAgICAgIHRvZ2dsZVBhbGV0dGVPbmx5OiBmYWxzZSxcclxuICAgICAgICBzaG93U2VsZWN0aW9uUGFsZXR0ZTogdHJ1ZSxcclxuICAgICAgICBsb2NhbFN0b3JhZ2VLZXk6IGZhbHNlLFxyXG4gICAgICAgIGFwcGVuZFRvOiBcImJvZHlcIixcclxuICAgICAgICBtYXhTZWxlY3Rpb25TaXplOiA3LFxyXG4gICAgICAgIGNhbmNlbFRleHQ6IFwiY2FuY2VsXCIsXHJcbiAgICAgICAgY2hvb3NlVGV4dDogXCJjaG9vc2VcIixcclxuICAgICAgICB0b2dnbGVQYWxldHRlTW9yZVRleHQ6IFwibW9yZVwiLFxyXG4gICAgICAgIHRvZ2dsZVBhbGV0dGVMZXNzVGV4dDogXCJsZXNzXCIsXHJcbiAgICAgICAgY2xlYXJUZXh0OiBcIkNsZWFyIENvbG9yIFNlbGVjdGlvblwiLFxyXG4gICAgICAgIG5vQ29sb3JTZWxlY3RlZFRleHQ6IFwiTm8gQ29sb3IgU2VsZWN0ZWRcIixcclxuICAgICAgICBwcmVmZXJyZWRGb3JtYXQ6IGZhbHNlLFxyXG4gICAgICAgIGNsYXNzTmFtZTogXCJcIiwgLy8gRGVwcmVjYXRlZCAtIHVzZSBjb250YWluZXJDbGFzc05hbWUgYW5kIHJlcGxhY2VyQ2xhc3NOYW1lIGluc3RlYWQuXHJcbiAgICAgICAgY29udGFpbmVyQ2xhc3NOYW1lOiBcIlwiLFxyXG4gICAgICAgIHJlcGxhY2VyQ2xhc3NOYW1lOiBcIlwiLFxyXG4gICAgICAgIHNob3dBbHBoYTogZmFsc2UsXHJcbiAgICAgICAgdGhlbWU6IFwic3AtbGlnaHRcIixcclxuICAgICAgICBwYWxldHRlOiBbW1wiI2ZmZmZmZlwiLCBcIiMwMDAwMDBcIiwgXCIjZmYwMDAwXCIsIFwiI2ZmODAwMFwiLCBcIiNmZmZmMDBcIiwgXCIjMDA4MDAwXCIsIFwiIzAwMDBmZlwiLCBcIiM0YjAwODJcIiwgXCIjOTQwMGQzXCJdXSxcclxuICAgICAgICBzZWxlY3Rpb25QYWxldHRlOiBbXSxcclxuICAgICAgICBkaXNhYmxlZDogZmFsc2UsXHJcbiAgICAgICAgb2Zmc2V0OiBudWxsXHJcbiAgICB9LFxyXG4gICAgc3BlY3RydW1zID0gW10sXHJcbiAgICBJRSA9ICEhL21zaWUvaS5leGVjKCB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCApLFxyXG4gICAgcmdiYVN1cHBvcnQgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gY29udGFpbnMoIHN0ciwgc3Vic3RyICkge1xyXG4gICAgICAgICAgICByZXR1cm4gISF+KCcnICsgc3RyKS5pbmRleE9mKHN1YnN0cik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHZhciBzdHlsZSA9IGVsZW0uc3R5bGU7XHJcbiAgICAgICAgc3R5bGUuY3NzVGV4dCA9ICdiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjUpJztcclxuICAgICAgICByZXR1cm4gY29udGFpbnMoc3R5bGUuYmFja2dyb3VuZENvbG9yLCAncmdiYScpIHx8IGNvbnRhaW5zKHN0eWxlLmJhY2tncm91bmRDb2xvciwgJ2hzbGEnKTtcclxuICAgIH0pKCksXHJcbiAgICBpbnB1dFR5cGVDb2xvclN1cHBvcnQgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvbG9ySW5wdXQgPSAkKFwiPGlucHV0IHR5cGU9J2NvbG9yJyB2YWx1ZT0nIScgLz5cIilbMF07XHJcbiAgICAgICAgcmV0dXJuIGNvbG9ySW5wdXQudHlwZSA9PT0gXCJjb2xvclwiICYmIGNvbG9ySW5wdXQudmFsdWUgIT09IFwiIVwiO1xyXG4gICAgfSkoKSxcclxuICAgIHJlcGxhY2VJbnB1dCA9IFtcclxuICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXJlcGxhY2VyJz5cIixcclxuICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1wcmV2aWV3Jz48ZGl2IGNsYXNzPSdzcC1wcmV2aWV3LWlubmVyJz48L2Rpdj48L2Rpdj5cIixcclxuICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC1kZCc+JiM5NjYwOzwvZGl2PlwiLFxyXG4gICAgICAgIFwiPC9kaXY+XCJcclxuICAgIF0uam9pbignJyksXHJcbiAgICBtYXJrdXAgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAvLyBJRSBkb2VzIG5vdCBzdXBwb3J0IGdyYWRpZW50cyB3aXRoIG11bHRpcGxlIHN0b3BzLCBzbyB3ZSBuZWVkIHRvIHNpbXVsYXRlXHJcbiAgICAgICAgLy8gIHRoYXQgZm9yIHRoZSByYWluYm93IHNsaWRlciB3aXRoIDggZGl2cyB0aGF0IGVhY2ggaGF2ZSBhIHNpbmdsZSBncmFkaWVudFxyXG4gICAgICAgIHZhciBncmFkaWVudEZpeCA9IFwiXCI7XHJcbiAgICAgICAgaWYgKElFKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IDY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgZ3JhZGllbnRGaXggKz0gXCI8ZGl2IGNsYXNzPSdzcC1cIiArIGkgKyBcIic+PC9kaXY+XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtY29udGFpbmVyIHNwLWhpZGRlbic+XCIsXHJcbiAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXBhbGV0dGUtY29udGFpbmVyJz5cIixcclxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXBhbGV0dGUgc3AtdGh1bWIgc3AtY2YnPjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtcGFsZXR0ZS1idXR0b24tY29udGFpbmVyIHNwLWNmJz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8YnV0dG9uIHR5cGU9J2J1dHRvbicgY2xhc3M9J3NwLXBhbGV0dGUtdG9nZ2xlJz48L2J1dHRvbj5cIixcclxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtcGlja2VyLWNvbnRhaW5lcic+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCI8ZGl2IGNsYXNzPSdzcC10b3Agc3AtY2YnPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWZpbGwnPjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXRvcC1pbm5lcic+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWNvbG9yJz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXNhdCc+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtdmFsJz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtZHJhZ2dlcic+PC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWNsZWFyIHNwLWNsZWFyLWRpc3BsYXknPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtaHVlJz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLXNsaWRlcic+PC9kaXY+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnRGaXgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWFscGhhJz48ZGl2IGNsYXNzPSdzcC1hbHBoYS1pbm5lcic+PGRpdiBjbGFzcz0nc3AtYWxwaGEtaGFuZGxlJz48L2Rpdj48L2Rpdj48L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtaW5wdXQtY29udGFpbmVyIHNwLWNmJz5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8aW5wdXQgY2xhc3M9J3NwLWlucHV0JyB0eXBlPSd0ZXh0JyBzcGVsbGNoZWNrPSdmYWxzZScgIC8+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcclxuICAgICAgICAgICAgICAgICAgICBcIjxkaXYgY2xhc3M9J3NwLWluaXRpYWwgc3AtdGh1bWIgc3AtY2YnPjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiPGRpdiBjbGFzcz0nc3AtYnV0dG9uLWNvbnRhaW5lciBzcC1jZic+XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiPGEgY2xhc3M9J3NwLWNhbmNlbCcgaHJlZj0nIyc+PC9hPlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjxidXR0b24gdHlwZT0nYnV0dG9uJyBjbGFzcz0nc3AtY2hvb3NlJz48L2J1dHRvbj5cIixcclxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxyXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcclxuICAgICAgICAgICAgXCI8L2Rpdj5cIlxyXG4gICAgICAgIF0uam9pbihcIlwiKTtcclxuICAgIH0pKCk7XHJcblxyXG4gICAgZnVuY3Rpb24gcGFsZXR0ZVRlbXBsYXRlIChwLCBjb2xvciwgY2xhc3NOYW1lLCBvcHRzKSB7XHJcbiAgICAgICAgdmFyIGh0bWwgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSBwW2ldO1xyXG4gICAgICAgICAgICBpZihjdXJyZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGlueSA9IHRpbnljb2xvcihjdXJyZW50KTtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gdGlueS50b0hzbCgpLmwgPCAwLjUgPyBcInNwLXRodW1iLWVsIHNwLXRodW1iLWRhcmtcIiA6IFwic3AtdGh1bWItZWwgc3AtdGh1bWItbGlnaHRcIjtcclxuICAgICAgICAgICAgICAgIGMgKz0gKHRpbnljb2xvci5lcXVhbHMoY29sb3IsIGN1cnJlbnQpKSA/IFwiIHNwLXRodW1iLWFjdGl2ZVwiIDogXCJcIjtcclxuICAgICAgICAgICAgICAgIHZhciBmb3JtYXR0ZWRTdHJpbmcgPSB0aW55LnRvU3RyaW5nKG9wdHMucHJlZmVycmVkRm9ybWF0IHx8IFwicmdiXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHN3YXRjaFN0eWxlID0gcmdiYVN1cHBvcnQgPyAoXCJiYWNrZ3JvdW5kLWNvbG9yOlwiICsgdGlueS50b1JnYlN0cmluZygpKSA6IFwiZmlsdGVyOlwiICsgdGlueS50b0ZpbHRlcigpO1xyXG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8c3BhbiB0aXRsZT1cIicgKyBmb3JtYXR0ZWRTdHJpbmcgKyAnXCIgZGF0YS1jb2xvcj1cIicgKyB0aW55LnRvUmdiU3RyaW5nKCkgKyAnXCIgY2xhc3M9XCInICsgYyArICdcIj48c3BhbiBjbGFzcz1cInNwLXRodW1iLWlubmVyXCIgc3R5bGU9XCInICsgc3dhdGNoU3R5bGUgKyAnO1wiIC8+PC9zcGFuPicpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNscyA9ICdzcC1jbGVhci1kaXNwbGF5JztcclxuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgkKCc8ZGl2IC8+JylcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxzcGFuIGRhdGEtY29sb3I9XCJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7XCIgY2xhc3M9XCInICsgY2xzICsgJ1wiPjwvc3Bhbj4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndGl0bGUnLCBvcHRzLm5vQ29sb3JTZWxlY3RlZFRleHQpXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFwiPGRpdiBjbGFzcz0nc3AtY2YgXCIgKyBjbGFzc05hbWUgKyBcIic+XCIgKyBodG1sLmpvaW4oJycpICsgXCI8L2Rpdj5cIjtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoaWRlQWxsKCkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BlY3RydW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChzcGVjdHJ1bXNbaV0pIHtcclxuICAgICAgICAgICAgICAgIHNwZWN0cnVtc1tpXS5oaWRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW5zdGFuY2VPcHRpb25zKG8sIGNhbGxiYWNrQ29udGV4dCkge1xyXG4gICAgICAgIHZhciBvcHRzID0gJC5leHRlbmQoe30sIGRlZmF1bHRPcHRzLCBvKTtcclxuICAgICAgICBvcHRzLmNhbGxiYWNrcyA9IHtcclxuICAgICAgICAgICAgJ21vdmUnOiBiaW5kKG9wdHMubW92ZSwgY2FsbGJhY2tDb250ZXh0KSxcclxuICAgICAgICAgICAgJ2NoYW5nZSc6IGJpbmQob3B0cy5jaGFuZ2UsIGNhbGxiYWNrQ29udGV4dCksXHJcbiAgICAgICAgICAgICdzaG93JzogYmluZChvcHRzLnNob3csIGNhbGxiYWNrQ29udGV4dCksXHJcbiAgICAgICAgICAgICdoaWRlJzogYmluZChvcHRzLmhpZGUsIGNhbGxiYWNrQ29udGV4dCksXHJcbiAgICAgICAgICAgICdiZWZvcmVTaG93JzogYmluZChvcHRzLmJlZm9yZVNob3csIGNhbGxiYWNrQ29udGV4dClcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gb3B0cztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzcGVjdHJ1bShlbGVtZW50LCBvKSB7XHJcblxyXG4gICAgICAgIHZhciBvcHRzID0gaW5zdGFuY2VPcHRpb25zKG8sIGVsZW1lbnQpLFxyXG4gICAgICAgICAgICBmbGF0ID0gb3B0cy5mbGF0LFxyXG4gICAgICAgICAgICBzaG93U2VsZWN0aW9uUGFsZXR0ZSA9IG9wdHMuc2hvd1NlbGVjdGlvblBhbGV0dGUsXHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZUtleSA9IG9wdHMubG9jYWxTdG9yYWdlS2V5LFxyXG4gICAgICAgICAgICB0aGVtZSA9IG9wdHMudGhlbWUsXHJcbiAgICAgICAgICAgIGNhbGxiYWNrcyA9IG9wdHMuY2FsbGJhY2tzLFxyXG4gICAgICAgICAgICByZXNpemUgPSB0aHJvdHRsZShyZWZsb3csIDEwKSxcclxuICAgICAgICAgICAgdmlzaWJsZSA9IGZhbHNlLFxyXG4gICAgICAgICAgICBkcmFnV2lkdGggPSAwLFxyXG4gICAgICAgICAgICBkcmFnSGVpZ2h0ID0gMCxcclxuICAgICAgICAgICAgZHJhZ0hlbHBlckhlaWdodCA9IDAsXHJcbiAgICAgICAgICAgIHNsaWRlSGVpZ2h0ID0gMCxcclxuICAgICAgICAgICAgc2xpZGVXaWR0aCA9IDAsXHJcbiAgICAgICAgICAgIGFscGhhV2lkdGggPSAwLFxyXG4gICAgICAgICAgICBhbHBoYVNsaWRlSGVscGVyV2lkdGggPSAwLFxyXG4gICAgICAgICAgICBzbGlkZUhlbHBlckhlaWdodCA9IDAsXHJcbiAgICAgICAgICAgIGN1cnJlbnRIdWUgPSAwLFxyXG4gICAgICAgICAgICBjdXJyZW50U2F0dXJhdGlvbiA9IDAsXHJcbiAgICAgICAgICAgIGN1cnJlbnRWYWx1ZSA9IDAsXHJcbiAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IDEsXHJcbiAgICAgICAgICAgIHBhbGV0dGUgPSBbXSxcclxuICAgICAgICAgICAgcGFsZXR0ZUFycmF5ID0gW10sXHJcbiAgICAgICAgICAgIHBhbGV0dGVMb29rdXAgPSB7fSxcclxuICAgICAgICAgICAgc2VsZWN0aW9uUGFsZXR0ZSA9IG9wdHMuc2VsZWN0aW9uUGFsZXR0ZS5zbGljZSgwKSxcclxuICAgICAgICAgICAgbWF4U2VsZWN0aW9uU2l6ZSA9IG9wdHMubWF4U2VsZWN0aW9uU2l6ZSxcclxuICAgICAgICAgICAgZHJhZ2dpbmdDbGFzcyA9IFwic3AtZHJhZ2dpbmdcIixcclxuICAgICAgICAgICAgc2hpZnRNb3ZlbWVudERpcmVjdGlvbiA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBkb2MgPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQsXHJcbiAgICAgICAgICAgIGJvZHkgPSBkb2MuYm9keSxcclxuICAgICAgICAgICAgYm91bmRFbGVtZW50ID0gJChlbGVtZW50KSxcclxuICAgICAgICAgICAgZGlzYWJsZWQgPSBmYWxzZSxcclxuICAgICAgICAgICAgY29udGFpbmVyID0gJChtYXJrdXAsIGRvYykuYWRkQ2xhc3ModGhlbWUpLFxyXG4gICAgICAgICAgICBwaWNrZXJDb250YWluZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1waWNrZXItY29udGFpbmVyXCIpLFxyXG4gICAgICAgICAgICBkcmFnZ2VyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtY29sb3JcIiksXHJcbiAgICAgICAgICAgIGRyYWdIZWxwZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1kcmFnZ2VyXCIpLFxyXG4gICAgICAgICAgICBzbGlkZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1odWVcIiksXHJcbiAgICAgICAgICAgIHNsaWRlSGVscGVyID0gY29udGFpbmVyLmZpbmQoXCIuc3Atc2xpZGVyXCIpLFxyXG4gICAgICAgICAgICBhbHBoYVNsaWRlcklubmVyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtYWxwaGEtaW5uZXJcIiksXHJcbiAgICAgICAgICAgIGFscGhhU2xpZGVyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtYWxwaGFcIiksXHJcbiAgICAgICAgICAgIGFscGhhU2xpZGVIZWxwZXIgPSBjb250YWluZXIuZmluZChcIi5zcC1hbHBoYS1oYW5kbGVcIiksXHJcbiAgICAgICAgICAgIHRleHRJbnB1dCA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWlucHV0XCIpLFxyXG4gICAgICAgICAgICBwYWxldHRlQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtcGFsZXR0ZVwiKSxcclxuICAgICAgICAgICAgaW5pdGlhbENvbG9yQ29udGFpbmVyID0gY29udGFpbmVyLmZpbmQoXCIuc3AtaW5pdGlhbFwiKSxcclxuICAgICAgICAgICAgY2FuY2VsQnV0dG9uID0gY29udGFpbmVyLmZpbmQoXCIuc3AtY2FuY2VsXCIpLFxyXG4gICAgICAgICAgICBjbGVhckJ1dHRvbiA9IGNvbnRhaW5lci5maW5kKFwiLnNwLWNsZWFyXCIpLFxyXG4gICAgICAgICAgICBjaG9vc2VCdXR0b24gPSBjb250YWluZXIuZmluZChcIi5zcC1jaG9vc2VcIiksXHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbiA9IGNvbnRhaW5lci5maW5kKFwiLnNwLXBhbGV0dGUtdG9nZ2xlXCIpLFxyXG4gICAgICAgICAgICBpc0lucHV0ID0gYm91bmRFbGVtZW50LmlzKFwiaW5wdXRcIiksXHJcbiAgICAgICAgICAgIGlzSW5wdXRUeXBlQ29sb3IgPSBpc0lucHV0ICYmIGlucHV0VHlwZUNvbG9yU3VwcG9ydCAmJiBib3VuZEVsZW1lbnQuYXR0cihcInR5cGVcIikgPT09IFwiY29sb3JcIixcclxuICAgICAgICAgICAgc2hvdWxkUmVwbGFjZSA9IGlzSW5wdXQgJiYgIWZsYXQsXHJcbiAgICAgICAgICAgIHJlcGxhY2VyID0gKHNob3VsZFJlcGxhY2UpID8gJChyZXBsYWNlSW5wdXQpLmFkZENsYXNzKHRoZW1lKS5hZGRDbGFzcyhvcHRzLmNsYXNzTmFtZSkuYWRkQ2xhc3Mob3B0cy5yZXBsYWNlckNsYXNzTmFtZSkgOiAkKFtdKSxcclxuICAgICAgICAgICAgb2Zmc2V0RWxlbWVudCA9IChzaG91bGRSZXBsYWNlKSA/IHJlcGxhY2VyIDogYm91bmRFbGVtZW50LFxyXG4gICAgICAgICAgICBwcmV2aWV3RWxlbWVudCA9IHJlcGxhY2VyLmZpbmQoXCIuc3AtcHJldmlldy1pbm5lclwiKSxcclxuICAgICAgICAgICAgaW5pdGlhbENvbG9yID0gb3B0cy5jb2xvciB8fCAoaXNJbnB1dCAmJiBib3VuZEVsZW1lbnQudmFsKCkpLFxyXG4gICAgICAgICAgICBjb2xvck9uU2hvdyA9IGZhbHNlLFxyXG4gICAgICAgICAgICBwcmVmZXJyZWRGb3JtYXQgPSBvcHRzLnByZWZlcnJlZEZvcm1hdCxcclxuICAgICAgICAgICAgY3VycmVudFByZWZlcnJlZEZvcm1hdCA9IHByZWZlcnJlZEZvcm1hdCxcclxuICAgICAgICAgICAgY2xpY2tvdXRGaXJlc0NoYW5nZSA9ICFvcHRzLnNob3dCdXR0b25zIHx8IG9wdHMuY2xpY2tvdXRGaXJlc0NoYW5nZSxcclxuICAgICAgICAgICAgaXNFbXB0eSA9ICFpbml0aWFsQ29sb3IsXHJcbiAgICAgICAgICAgIGFsbG93RW1wdHkgPSBvcHRzLmFsbG93RW1wdHkgJiYgIWlzSW5wdXRUeXBlQ29sb3I7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFwcGx5T3B0aW9ucygpIHtcclxuXHJcbiAgICAgICAgICAgIGlmIChvcHRzLnNob3dQYWxldHRlT25seSkge1xyXG4gICAgICAgICAgICAgICAgb3B0cy5zaG93UGFsZXR0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvbi50ZXh0KG9wdHMuc2hvd1BhbGV0dGVPbmx5ID8gb3B0cy50b2dnbGVQYWxldHRlTW9yZVRleHQgOiBvcHRzLnRvZ2dsZVBhbGV0dGVMZXNzVGV4dCk7XHJcblxyXG4gICAgICAgICAgICBpZiAob3B0cy5wYWxldHRlKSB7XHJcbiAgICAgICAgICAgICAgICBwYWxldHRlID0gb3B0cy5wYWxldHRlLnNsaWNlKDApO1xyXG4gICAgICAgICAgICAgICAgcGFsZXR0ZUFycmF5ID0gJC5pc0FycmF5KHBhbGV0dGVbMF0pID8gcGFsZXR0ZSA6IFtwYWxldHRlXTtcclxuICAgICAgICAgICAgICAgIHBhbGV0dGVMb29rdXAgPSB7fTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFsZXR0ZUFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwYWxldHRlQXJyYXlbaV0ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJnYiA9IHRpbnljb2xvcihwYWxldHRlQXJyYXlbaV1bal0pLnRvUmdiU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbGV0dGVMb29rdXBbcmdiXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1mbGF0XCIsIGZsYXQpO1xyXG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1pbnB1dC1kaXNhYmxlZFwiLCAhb3B0cy5zaG93SW5wdXQpO1xyXG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1hbHBoYS1lbmFibGVkXCIsIG9wdHMuc2hvd0FscGhhKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtY2xlYXItZW5hYmxlZFwiLCBhbGxvd0VtcHR5KTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnRvZ2dsZUNsYXNzKFwic3AtYnV0dG9ucy1kaXNhYmxlZFwiLCAhb3B0cy5zaG93QnV0dG9ucyk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLXBhbGV0dGUtYnV0dG9ucy1kaXNhYmxlZFwiLCAhb3B0cy50b2dnbGVQYWxldHRlT25seSk7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci50b2dnbGVDbGFzcyhcInNwLXBhbGV0dGUtZGlzYWJsZWRcIiwgIW9wdHMuc2hvd1BhbGV0dGUpO1xyXG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1wYWxldHRlLW9ubHlcIiwgb3B0cy5zaG93UGFsZXR0ZU9ubHkpO1xyXG4gICAgICAgICAgICBjb250YWluZXIudG9nZ2xlQ2xhc3MoXCJzcC1pbml0aWFsLWRpc2FibGVkXCIsICFvcHRzLnNob3dJbml0aWFsKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLmFkZENsYXNzKG9wdHMuY2xhc3NOYW1lKS5hZGRDbGFzcyhvcHRzLmNvbnRhaW5lckNsYXNzTmFtZSk7XHJcblxyXG4gICAgICAgICAgICByZWZsb3coKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAoSUUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5maW5kKFwiKjpub3QoaW5wdXQpXCIpLmF0dHIoXCJ1bnNlbGVjdGFibGVcIiwgXCJvblwiKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXBwbHlPcHRpb25zKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvdWxkUmVwbGFjZSkge1xyXG4gICAgICAgICAgICAgICAgYm91bmRFbGVtZW50LmFmdGVyKHJlcGxhY2VyKS5oaWRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghYWxsb3dFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJCdXR0b24uaGlkZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZmxhdCkge1xyXG4gICAgICAgICAgICAgICAgYm91bmRFbGVtZW50LmFmdGVyKGNvbnRhaW5lcikuaGlkZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBhcHBlbmRUbyA9IG9wdHMuYXBwZW5kVG8gPT09IFwicGFyZW50XCIgPyBib3VuZEVsZW1lbnQucGFyZW50KCkgOiAkKG9wdHMuYXBwZW5kVG8pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFwcGVuZFRvLmxlbmd0aCAhPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcGVuZFRvID0gJChcImJvZHlcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYXBwZW5kVG8uYXBwZW5kKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZVNlbGVjdGlvblBhbGV0dGVGcm9tU3RvcmFnZSgpO1xyXG5cclxuICAgICAgICAgICAgb2Zmc2V0RWxlbWVudC5iaW5kKFwiY2xpY2suc3BlY3RydW0gdG91Y2hzdGFydC5zcGVjdHJ1bVwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFkaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCEkKGUudGFyZ2V0KS5pcyhcImlucHV0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmKGJvdW5kRWxlbWVudC5pcyhcIjpkaXNhYmxlZFwiKSB8fCAob3B0cy5kaXNhYmxlZCA9PT0gdHJ1ZSkpIHtcclxuICAgICAgICAgICAgICAgIGRpc2FibGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gUHJldmVudCBjbGlja3MgZnJvbSBidWJibGluZyB1cCB0byBkb2N1bWVudC4gIFRoaXMgd291bGQgY2F1c2UgaXQgdG8gYmUgaGlkZGVuLlxyXG4gICAgICAgICAgICBjb250YWluZXIuY2xpY2soc3RvcFByb3BhZ2F0aW9uKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEhhbmRsZSB1c2VyIHR5cGVkIGlucHV0XHJcbiAgICAgICAgICAgIHRleHRJbnB1dC5jaGFuZ2Uoc2V0RnJvbVRleHRJbnB1dCk7XHJcbiAgICAgICAgICAgIHRleHRJbnB1dC5iaW5kKFwicGFzdGVcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChzZXRGcm9tVGV4dElucHV0LCAxKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRleHRJbnB1dC5rZXlkb3duKGZ1bmN0aW9uIChlKSB7IGlmIChlLmtleUNvZGUgPT0gMTMpIHsgc2V0RnJvbVRleHRJbnB1dCgpOyB9IH0pO1xyXG5cclxuICAgICAgICAgICAgY2FuY2VsQnV0dG9uLnRleHQob3B0cy5jYW5jZWxUZXh0KTtcclxuICAgICAgICAgICAgY2FuY2VsQnV0dG9uLmJpbmQoXCJjbGljay5zcGVjdHJ1bVwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHJldmVydCgpO1xyXG4gICAgICAgICAgICAgICAgaGlkZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNsZWFyQnV0dG9uLmF0dHIoXCJ0aXRsZVwiLCBvcHRzLmNsZWFyVGV4dCk7XHJcbiAgICAgICAgICAgIGNsZWFyQnV0dG9uLmJpbmQoXCJjbGljay5zcGVjdHJ1bVwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIGlzRW1wdHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGZsYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL2ZvciB0aGUgZmxhdCBzdHlsZSwgdGhpcyBpcyBhIGNoYW5nZSBldmVudFxyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2hvb3NlQnV0dG9uLnRleHQob3B0cy5jaG9vc2VUZXh0KTtcclxuICAgICAgICAgICAgY2hvb3NlQnV0dG9uLmJpbmQoXCJjbGljay5zcGVjdHJ1bVwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uLnRleHQob3B0cy5zaG93UGFsZXR0ZU9ubHkgPyBvcHRzLnRvZ2dsZVBhbGV0dGVNb3JlVGV4dCA6IG9wdHMudG9nZ2xlUGFsZXR0ZUxlc3NUZXh0KTtcclxuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uLmJpbmQoXCJjbGljay5zcGVjdHJ1bVwiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBvcHRzLnNob3dQYWxldHRlT25seSA9ICFvcHRzLnNob3dQYWxldHRlT25seTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBUbyBtYWtlIHN1cmUgdGhlIFBpY2tlciBhcmVhIGlzIGRyYXduIG9uIHRoZSByaWdodCwgbmV4dCB0byB0aGVcclxuICAgICAgICAgICAgICAgIC8vIFBhbGV0dGUgYXJlYSAoYW5kIG5vdCBiZWxvdyB0aGUgcGFsZXR0ZSksIGZpcnN0IG1vdmUgdGhlIFBhbGV0dGVcclxuICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBsZWZ0IHRvIG1ha2Ugc3BhY2UgZm9yIHRoZSBwaWNrZXIsIHBsdXMgNXB4IGV4dHJhLlxyXG4gICAgICAgICAgICAgICAgLy8gVGhlICdhcHBseU9wdGlvbnMnIGZ1bmN0aW9uIHB1dHMgdGhlIHdob2xlIGNvbnRhaW5lciBiYWNrIGludG8gcGxhY2VcclxuICAgICAgICAgICAgICAgIC8vIGFuZCB0YWtlcyBjYXJlIG9mIHRoZSBidXR0b24tdGV4dCBhbmQgdGhlIHNwLXBhbGV0dGUtb25seSBDU1MgY2xhc3MuXHJcbiAgICAgICAgICAgICAgICBpZiAoIW9wdHMuc2hvd1BhbGV0dGVPbmx5ICYmICFmbGF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNzcygnbGVmdCcsICctPScgKyAocGlja2VyQ29udGFpbmVyLm91dGVyV2lkdGgodHJ1ZSkgKyA1KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhcHBseU9wdGlvbnMoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBkcmFnZ2FibGUoYWxwaGFTbGlkZXIsIGZ1bmN0aW9uIChkcmFnWCwgZHJhZ1ksIGUpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IChkcmFnWCAvIGFscGhhV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgaXNFbXB0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWxwaGEgPSBNYXRoLnJvdW5kKGN1cnJlbnRBbHBoYSAqIDEwKSAvIDEwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG1vdmUoKTtcclxuICAgICAgICAgICAgfSwgZHJhZ1N0YXJ0LCBkcmFnU3RvcCk7XHJcblxyXG4gICAgICAgICAgICBkcmFnZ2FibGUoc2xpZGVyLCBmdW5jdGlvbiAoZHJhZ1gsIGRyYWdZKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50SHVlID0gcGFyc2VGbG9hdChkcmFnWSAvIHNsaWRlSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIGlzRW1wdHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmICghb3B0cy5zaG93QWxwaGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWxwaGEgPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbW92ZSgpO1xyXG4gICAgICAgICAgICB9LCBkcmFnU3RhcnQsIGRyYWdTdG9wKTtcclxuXHJcbiAgICAgICAgICAgIGRyYWdnYWJsZShkcmFnZ2VyLCBmdW5jdGlvbiAoZHJhZ1gsIGRyYWdZLCBlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2hpZnQrZHJhZyBzaG91bGQgc25hcCB0aGUgbW92ZW1lbnQgdG8gZWl0aGVyIHRoZSB4IG9yIHkgYXhpcy5cclxuICAgICAgICAgICAgICAgIGlmICghZS5zaGlmdEtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXNoaWZ0TW92ZW1lbnREaXJlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkRHJhZ1ggPSBjdXJyZW50U2F0dXJhdGlvbiAqIGRyYWdXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkRHJhZ1kgPSBkcmFnSGVpZ2h0IC0gKGN1cnJlbnRWYWx1ZSAqIGRyYWdIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmdXJ0aGVyRnJvbVggPSBNYXRoLmFicyhkcmFnWCAtIG9sZERyYWdYKSA+IE1hdGguYWJzKGRyYWdZIC0gb2xkRHJhZ1kpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzaGlmdE1vdmVtZW50RGlyZWN0aW9uID0gZnVydGhlckZyb21YID8gXCJ4XCIgOiBcInlcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgc2V0U2F0dXJhdGlvbiA9ICFzaGlmdE1vdmVtZW50RGlyZWN0aW9uIHx8IHNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gPT09IFwieFwiO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNldFZhbHVlID0gIXNoaWZ0TW92ZW1lbnREaXJlY3Rpb24gfHwgc2hpZnRNb3ZlbWVudERpcmVjdGlvbiA9PT0gXCJ5XCI7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNldFNhdHVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50U2F0dXJhdGlvbiA9IHBhcnNlRmxvYXQoZHJhZ1ggLyBkcmFnV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNldFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhbHVlID0gcGFyc2VGbG9hdCgoZHJhZ0hlaWdodCAtIGRyYWdZKSAvIGRyYWdIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlzRW1wdHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGlmICghb3B0cy5zaG93QWxwaGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWxwaGEgPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG1vdmUoKTtcclxuXHJcbiAgICAgICAgICAgIH0sIGRyYWdTdGFydCwgZHJhZ1N0b3ApO1xyXG5cclxuICAgICAgICAgICAgaWYgKCEhaW5pdGlhbENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICBzZXQoaW5pdGlhbENvbG9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBJbiBjYXNlIGNvbG9yIHdhcyBibGFjayAtIHVwZGF0ZSB0aGUgcHJldmlldyBVSSBhbmQgc2V0IHRoZSBmb3JtYXRcclxuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBzZXQgZnVuY3Rpb24gd2lsbCBub3QgcnVuIChkZWZhdWx0IGNvbG9yIGlzIGJsYWNrKS5cclxuICAgICAgICAgICAgICAgIHVwZGF0ZVVJKCk7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50UHJlZmVycmVkRm9ybWF0ID0gcHJlZmVycmVkRm9ybWF0IHx8IHRpbnljb2xvcihpbml0aWFsQ29sb3IpLmZvcm1hdDtcclxuXHJcbiAgICAgICAgICAgICAgICBhZGRDb2xvclRvU2VsZWN0aW9uUGFsZXR0ZShpbml0aWFsQ29sb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVUkoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGZsYXQpIHtcclxuICAgICAgICAgICAgICAgIHNob3coKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gcGFsZXR0ZUVsZW1lbnRDbGljayhlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5kYXRhICYmIGUuZGF0YS5pZ25vcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXQoJChlLnRhcmdldCkuY2xvc2VzdChcIi5zcC10aHVtYi1lbFwiKS5kYXRhKFwiY29sb3JcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldCgkKGUudGFyZ2V0KS5jbG9zZXN0KFwiLnNwLXRodW1iLWVsXCIpLmRhdGEoXCJjb2xvclwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMuaGlkZUFmdGVyUGFsZXR0ZVNlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBwYWxldHRlRXZlbnQgPSBJRSA/IFwibW91c2Vkb3duLnNwZWN0cnVtXCIgOiBcImNsaWNrLnNwZWN0cnVtIHRvdWNoc3RhcnQuc3BlY3RydW1cIjtcclxuICAgICAgICAgICAgcGFsZXR0ZUNvbnRhaW5lci5kZWxlZ2F0ZShcIi5zcC10aHVtYi1lbFwiLCBwYWxldHRlRXZlbnQsIHBhbGV0dGVFbGVtZW50Q2xpY2spO1xyXG4gICAgICAgICAgICBpbml0aWFsQ29sb3JDb250YWluZXIuZGVsZWdhdGUoXCIuc3AtdGh1bWItZWw6bnRoLWNoaWxkKDEpXCIsIHBhbGV0dGVFdmVudCwgeyBpZ25vcmU6IHRydWUgfSwgcGFsZXR0ZUVsZW1lbnRDbGljayk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVTZWxlY3Rpb25QYWxldHRlRnJvbVN0b3JhZ2UoKSB7XHJcblxyXG4gICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlS2V5ICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBNaWdyYXRlIG9sZCBwYWxldHRlcyBvdmVyIHRvIG5ldyBmb3JtYXQuICBNYXkgd2FudCB0byByZW1vdmUgdGhpcyBldmVudHVhbGx5LlxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2xkUGFsZXR0ZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlS2V5XS5zcGxpdChcIiwjXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvbGRQYWxldHRlLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdpbmRvdy5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlS2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKG9sZFBhbGV0dGUsIGZ1bmN0aW9uKGksIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRDb2xvclRvU2VsZWN0aW9uUGFsZXR0ZShjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2goZSkgeyB9XHJcblxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb25QYWxldHRlID0gd2luZG93LmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VLZXldLnNwbGl0KFwiO1wiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWRkQ29sb3JUb1NlbGVjdGlvblBhbGV0dGUoY29sb3IpIHtcclxuICAgICAgICAgICAgaWYgKHNob3dTZWxlY3Rpb25QYWxldHRlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmdiID0gdGlueWNvbG9yKGNvbG9yKS50b1JnYlN0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwYWxldHRlTG9va3VwW3JnYl0gJiYgJC5pbkFycmF5KHJnYiwgc2VsZWN0aW9uUGFsZXR0ZSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uUGFsZXR0ZS5wdXNoKHJnYik7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUoc2VsZWN0aW9uUGFsZXR0ZS5sZW5ndGggPiBtYXhTZWxlY3Rpb25TaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvblBhbGV0dGUuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZUtleSAmJiB3aW5kb3cubG9jYWxTdG9yYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZVtsb2NhbFN0b3JhZ2VLZXldID0gc2VsZWN0aW9uUGFsZXR0ZS5qb2luKFwiO1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2goZSkgeyB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFVuaXF1ZVNlbGVjdGlvblBhbGV0dGUoKSB7XHJcbiAgICAgICAgICAgIHZhciB1bmlxdWUgPSBbXTtcclxuICAgICAgICAgICAgaWYgKG9wdHMuc2hvd1BhbGV0dGUpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0aW9uUGFsZXR0ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZ2IgPSB0aW55Y29sb3Ioc2VsZWN0aW9uUGFsZXR0ZVtpXSkudG9SZ2JTdHJpbmcoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYWxldHRlTG9va3VwW3JnYl0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pcXVlLnB1c2goc2VsZWN0aW9uUGFsZXR0ZVtpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdW5pcXVlLnJldmVyc2UoKS5zbGljZSgwLCBvcHRzLm1heFNlbGVjdGlvblNpemUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZHJhd1BhbGV0dGUoKSB7XHJcblxyXG4gICAgICAgICAgICB2YXIgY3VycmVudENvbG9yID0gZ2V0KCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgaHRtbCA9ICQubWFwKHBhbGV0dGVBcnJheSwgZnVuY3Rpb24gKHBhbGV0dGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwYWxldHRlVGVtcGxhdGUocGFsZXR0ZSwgY3VycmVudENvbG9yLCBcInNwLXBhbGV0dGUtcm93IHNwLXBhbGV0dGUtcm93LVwiICsgaSwgb3B0cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdXBkYXRlU2VsZWN0aW9uUGFsZXR0ZUZyb21TdG9yYWdlKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uUGFsZXR0ZSkge1xyXG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKHBhbGV0dGVUZW1wbGF0ZShnZXRVbmlxdWVTZWxlY3Rpb25QYWxldHRlKCksIGN1cnJlbnRDb2xvciwgXCJzcC1wYWxldHRlLXJvdyBzcC1wYWxldHRlLXJvdy1zZWxlY3Rpb25cIiwgb3B0cykpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwYWxldHRlQ29udGFpbmVyLmh0bWwoaHRtbC5qb2luKFwiXCIpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRyYXdJbml0aWFsKCkge1xyXG4gICAgICAgICAgICBpZiAob3B0cy5zaG93SW5pdGlhbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluaXRpYWwgPSBjb2xvck9uU2hvdztcclxuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gZ2V0KCk7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsQ29sb3JDb250YWluZXIuaHRtbChwYWxldHRlVGVtcGxhdGUoW2luaXRpYWwsIGN1cnJlbnRdLCBjdXJyZW50LCBcInNwLXBhbGV0dGUtcm93LWluaXRpYWxcIiwgb3B0cykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkcmFnU3RhcnQoKSB7XHJcbiAgICAgICAgICAgIGlmIChkcmFnSGVpZ2h0IDw9IDAgfHwgZHJhZ1dpZHRoIDw9IDAgfHwgc2xpZGVIZWlnaHQgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmVmbG93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29udGFpbmVyLmFkZENsYXNzKGRyYWdnaW5nQ2xhc3MpO1xyXG4gICAgICAgICAgICBzaGlmdE1vdmVtZW50RGlyZWN0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgYm91bmRFbGVtZW50LnRyaWdnZXIoJ2RyYWdzdGFydC5zcGVjdHJ1bScsIFsgZ2V0KCkgXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkcmFnU3RvcCgpIHtcclxuICAgICAgICAgICAgY29udGFpbmVyLnJlbW92ZUNsYXNzKGRyYWdnaW5nQ2xhc3MpO1xyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcignZHJhZ3N0b3Auc3BlY3RydW0nLCBbIGdldCgpIF0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0RnJvbVRleHRJbnB1dCgpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRleHRJbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IFwiXCIpICYmIGFsbG93RW1wdHkpIHtcclxuICAgICAgICAgICAgICAgIHNldChudWxsKTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGlueSA9IHRpbnljb2xvcih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGlueS5pc1ZhbGlkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXQodGlueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCh0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRJbnB1dC5hZGRDbGFzcyhcInNwLXZhbGlkYXRpb24tZXJyb3JcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZSgpIHtcclxuICAgICAgICAgICAgaWYgKHZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgIGhpZGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNob3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2hvdygpIHtcclxuICAgICAgICAgICAgdmFyIGV2ZW50ID0gJC5FdmVudCgnYmVmb3JlU2hvdy5zcGVjdHJ1bScpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgIHJlZmxvdygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcihldmVudCwgWyBnZXQoKSBdKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjYWxsYmFja3MuYmVmb3JlU2hvdyhnZXQoKSkgPT09IGZhbHNlIHx8IGV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhpZGVBbGwoKTtcclxuICAgICAgICAgICAgdmlzaWJsZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAkKGRvYykuYmluZChcImNsaWNrLnNwZWN0cnVtXCIsIGNsaWNrb3V0KTtcclxuICAgICAgICAgICAgJCh3aW5kb3cpLmJpbmQoXCJyZXNpemUuc3BlY3RydW1cIiwgcmVzaXplKTtcclxuICAgICAgICAgICAgcmVwbGFjZXIuYWRkQ2xhc3MoXCJzcC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5yZW1vdmVDbGFzcyhcInNwLWhpZGRlblwiKTtcclxuXHJcbiAgICAgICAgICAgIHJlZmxvdygpO1xyXG4gICAgICAgICAgICB1cGRhdGVVSSgpO1xyXG5cclxuICAgICAgICAgICAgY29sb3JPblNob3cgPSBnZXQoKTtcclxuXHJcbiAgICAgICAgICAgIGRyYXdJbml0aWFsKCk7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zaG93KGNvbG9yT25TaG93KTtcclxuICAgICAgICAgICAgYm91bmRFbGVtZW50LnRyaWdnZXIoJ3Nob3cuc3BlY3RydW0nLCBbIGNvbG9yT25TaG93IF0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xpY2tvdXQoZSkge1xyXG4gICAgICAgICAgICAvLyBSZXR1cm4gb24gcmlnaHQgY2xpY2suXHJcbiAgICAgICAgICAgIGlmIChlLmJ1dHRvbiA9PSAyKSB7IHJldHVybjsgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGNsaWNrb3V0RmlyZXNDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU9yaWdpbmFsSW5wdXQodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXZlcnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoaWRlKCkge1xyXG4gICAgICAgICAgICAvLyBSZXR1cm4gaWYgaGlkaW5nIGlzIHVubmVjZXNzYXJ5XHJcbiAgICAgICAgICAgIGlmICghdmlzaWJsZSB8fCBmbGF0KSB7IHJldHVybjsgfVxyXG4gICAgICAgICAgICB2aXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAkKGRvYykudW5iaW5kKFwiY2xpY2suc3BlY3RydW1cIiwgY2xpY2tvdXQpO1xyXG4gICAgICAgICAgICAkKHdpbmRvdykudW5iaW5kKFwicmVzaXplLnNwZWN0cnVtXCIsIHJlc2l6ZSk7XHJcblxyXG4gICAgICAgICAgICByZXBsYWNlci5yZW1vdmVDbGFzcyhcInNwLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLmFkZENsYXNzKFwic3AtaGlkZGVuXCIpO1xyXG5cclxuICAgICAgICAgICAgY2FsbGJhY2tzLmhpZGUoZ2V0KCkpO1xyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcignaGlkZS5zcGVjdHJ1bScsIFsgZ2V0KCkgXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByZXZlcnQoKSB7XHJcbiAgICAgICAgICAgIHNldChjb2xvck9uU2hvdywgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXQoY29sb3IsIGlnbm9yZUZvcm1hdENoYW5nZSkge1xyXG4gICAgICAgICAgICBpZiAodGlueWNvbG9yLmVxdWFscyhjb2xvciwgZ2V0KCkpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgVUkganVzdCBpbiBjYXNlIGEgdmFsaWRhdGlvbiBlcnJvciBuZWVkc1xyXG4gICAgICAgICAgICAgICAgLy8gdG8gYmUgY2xlYXJlZC5cclxuICAgICAgICAgICAgICAgIHVwZGF0ZVVJKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBuZXdDb2xvciwgbmV3SHN2O1xyXG4gICAgICAgICAgICBpZiAoIWNvbG9yICYmIGFsbG93RW1wdHkpIHtcclxuICAgICAgICAgICAgICAgIGlzRW1wdHkgPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaXNFbXB0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgbmV3Q29sb3IgPSB0aW55Y29sb3IoY29sb3IpO1xyXG4gICAgICAgICAgICAgICAgbmV3SHN2ID0gbmV3Q29sb3IudG9Ic3YoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50SHVlID0gKG5ld0hzdi5oICUgMzYwKSAvIDM2MDtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTYXR1cmF0aW9uID0gbmV3SHN2LnM7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWUgPSBuZXdIc3YudjtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRBbHBoYSA9IG5ld0hzdi5hO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHVwZGF0ZVVJKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAobmV3Q29sb3IgJiYgbmV3Q29sb3IuaXNWYWxpZCgpICYmICFpZ25vcmVGb3JtYXRDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQgPSBwcmVmZXJyZWRGb3JtYXQgfHwgbmV3Q29sb3IuZ2V0Rm9ybWF0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldChvcHRzKSB7XHJcbiAgICAgICAgICAgIG9wdHMgPSBvcHRzIHx8IHsgfTtcclxuXHJcbiAgICAgICAgICAgIGlmIChhbGxvd0VtcHR5ICYmIGlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGlueWNvbG9yLmZyb21SYXRpbyh7XHJcbiAgICAgICAgICAgICAgICBoOiBjdXJyZW50SHVlLFxyXG4gICAgICAgICAgICAgICAgczogY3VycmVudFNhdHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICB2OiBjdXJyZW50VmFsdWUsXHJcbiAgICAgICAgICAgICAgICBhOiBNYXRoLnJvdW5kKGN1cnJlbnRBbHBoYSAqIDEwMCkgLyAxMDBcclxuICAgICAgICAgICAgfSwgeyBmb3JtYXQ6IG9wdHMuZm9ybWF0IHx8IGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpc1ZhbGlkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIXRleHRJbnB1dC5oYXNDbGFzcyhcInNwLXZhbGlkYXRpb24tZXJyb3JcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtb3ZlKCkge1xyXG4gICAgICAgICAgICB1cGRhdGVVSSgpO1xyXG5cclxuICAgICAgICAgICAgY2FsbGJhY2tzLm1vdmUoZ2V0KCkpO1xyXG4gICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcignbW92ZS5zcGVjdHJ1bScsIFsgZ2V0KCkgXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVVSSgpIHtcclxuXHJcbiAgICAgICAgICAgIHRleHRJbnB1dC5yZW1vdmVDbGFzcyhcInNwLXZhbGlkYXRpb24tZXJyb3JcIik7XHJcblxyXG4gICAgICAgICAgICB1cGRhdGVIZWxwZXJMb2NhdGlvbnMoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBkcmFnZ2VyIGJhY2tncm91bmQgY29sb3IgKGdyYWRpZW50cyB0YWtlIGNhcmUgb2Ygc2F0dXJhdGlvbiBhbmQgdmFsdWUpLlxyXG4gICAgICAgICAgICB2YXIgZmxhdENvbG9yID0gdGlueWNvbG9yLmZyb21SYXRpbyh7IGg6IGN1cnJlbnRIdWUsIHM6IDEsIHY6IDEgfSk7XHJcbiAgICAgICAgICAgIGRyYWdnZXIuY3NzKFwiYmFja2dyb3VuZC1jb2xvclwiLCBmbGF0Q29sb3IudG9IZXhTdHJpbmcoKSk7XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgYSBmb3JtYXQgdGhhdCBhbHBoYSB3aWxsIGJlIGluY2x1ZGVkIGluIChoZXggYW5kIG5hbWVzIGlnbm9yZSBhbHBoYSlcclxuICAgICAgICAgICAgdmFyIGZvcm1hdCA9IGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQ7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50QWxwaGEgPCAxICYmICEoY3VycmVudEFscGhhID09PSAwICYmIGZvcm1hdCA9PT0gXCJuYW1lXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZm9ybWF0ID09PSBcImhleFwiIHx8IGZvcm1hdCA9PT0gXCJoZXgzXCIgfHwgZm9ybWF0ID09PSBcImhleDZcIiB8fCBmb3JtYXQgPT09IFwibmFtZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0ID0gXCJyZ2JcIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIHJlYWxDb2xvciA9IGdldCh7IGZvcm1hdDogZm9ybWF0IH0pLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbG9yID0gJyc7XHJcblxyXG4gICAgICAgICAgICAgLy9yZXNldCBiYWNrZ3JvdW5kIGluZm8gZm9yIHByZXZpZXcgZWxlbWVudFxyXG4gICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5yZW1vdmVDbGFzcyhcInNwLWNsZWFyLWRpc3BsYXlcIik7XHJcbiAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LmNzcygnYmFja2dyb3VuZC1jb2xvcicsICd0cmFuc3BhcmVudCcpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFyZWFsQ29sb3IgJiYgYWxsb3dFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSByZXBsYWNlZCBlbGVtZW50cyBiYWNrZ3JvdW5kIHdpdGggaWNvbiBpbmRpY2F0aW5nIG5vIGNvbG9yIHNlbGVjdGlvblxyXG4gICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuYWRkQ2xhc3MoXCJzcC1jbGVhci1kaXNwbGF5XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlYWxIZXggPSByZWFsQ29sb3IudG9IZXhTdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgICAgICByZWFsUmdiID0gcmVhbENvbG9yLnRvUmdiU3RyaW5nKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSByZXBsYWNlZCBlbGVtZW50cyBiYWNrZ3JvdW5kIGNvbG9yICh3aXRoIGFjdHVhbCBzZWxlY3RlZCBjb2xvcilcclxuICAgICAgICAgICAgICAgIGlmIChyZ2JhU3VwcG9ydCB8fCByZWFsQ29sb3IuYWxwaGEgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3RWxlbWVudC5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIHJlYWxSZ2IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0VsZW1lbnQuY3NzKFwiYmFja2dyb3VuZC1jb2xvclwiLCBcInRyYW5zcGFyZW50XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdFbGVtZW50LmNzcyhcImZpbHRlclwiLCByZWFsQ29sb3IudG9GaWx0ZXIoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG9wdHMuc2hvd0FscGhhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJnYiA9IHJlYWxDb2xvci50b1JnYigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJnYi5hID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVhbEFscGhhID0gdGlueWNvbG9yKHJnYikudG9SZ2JTdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JhZGllbnQgPSBcImxpbmVhci1ncmFkaWVudChsZWZ0LCBcIiArIHJlYWxBbHBoYSArIFwiLCBcIiArIHJlYWxIZXggKyBcIilcIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKElFKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIuY3NzKFwiZmlsdGVyXCIsIHRpbnljb2xvcihyZWFsQWxwaGEpLnRvRmlsdGVyKHsgZ3JhZGllbnRUeXBlOiAxIH0sIHJlYWxIZXgpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIuY3NzKFwiYmFja2dyb3VuZFwiLCBcIi13ZWJraXQtXCIgKyBncmFkaWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIuY3NzKFwiYmFja2dyb3VuZFwiLCBcIi1tb3otXCIgKyBncmFkaWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIuY3NzKFwiYmFja2dyb3VuZFwiLCBcIi1tcy1cIiArIGdyYWRpZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlIGN1cnJlbnQgc3ludGF4IGdyYWRpZW50IG9uIHVucHJlZml4ZWQgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhU2xpZGVySW5uZXIuY3NzKFwiYmFja2dyb3VuZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsIFwiICsgcmVhbEFscGhhICsgXCIsIFwiICsgcmVhbEhleCArIFwiKVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZGlzcGxheUNvbG9yID0gcmVhbENvbG9yLnRvU3RyaW5nKGZvcm1hdCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgdGV4dCBlbnRyeSBpbnB1dCBhcyBpdCBjaGFuZ2VzIGhhcHBlblxyXG4gICAgICAgICAgICBpZiAob3B0cy5zaG93SW5wdXQpIHtcclxuICAgICAgICAgICAgICAgIHRleHRJbnB1dC52YWwoZGlzcGxheUNvbG9yKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKG9wdHMuc2hvd1BhbGV0dGUpIHtcclxuICAgICAgICAgICAgICAgIGRyYXdQYWxldHRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRyYXdJbml0aWFsKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVIZWxwZXJMb2NhdGlvbnMoKSB7XHJcbiAgICAgICAgICAgIHZhciBzID0gY3VycmVudFNhdHVyYXRpb247XHJcbiAgICAgICAgICAgIHZhciB2ID0gY3VycmVudFZhbHVlO1xyXG5cclxuICAgICAgICAgICAgaWYoYWxsb3dFbXB0eSAmJiBpc0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAvL2lmIHNlbGVjdGVkIGNvbG9yIGlzIGVtcHR5LCBoaWRlIHRoZSBoZWxwZXJzXHJcbiAgICAgICAgICAgICAgICBhbHBoYVNsaWRlSGVscGVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIHNsaWRlSGVscGVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGRyYWdIZWxwZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy9tYWtlIHN1cmUgaGVscGVycyBhcmUgdmlzaWJsZVxyXG4gICAgICAgICAgICAgICAgYWxwaGFTbGlkZUhlbHBlci5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBzbGlkZUhlbHBlci5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBkcmFnSGVscGVyLnNob3coKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBXaGVyZSB0byBzaG93IHRoZSBsaXR0bGUgY2lyY2xlIGluIHRoYXQgZGlzcGxheXMgeW91ciBjdXJyZW50IHNlbGVjdGVkIGNvbG9yXHJcbiAgICAgICAgICAgICAgICB2YXIgZHJhZ1ggPSBzICogZHJhZ1dpZHRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRyYWdZID0gZHJhZ0hlaWdodCAtICh2ICogZHJhZ0hlaWdodCk7XHJcbiAgICAgICAgICAgICAgICBkcmFnWCA9IE1hdGgubWF4KFxyXG4gICAgICAgICAgICAgICAgICAgIC1kcmFnSGVscGVySGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGRyYWdXaWR0aCAtIGRyYWdIZWxwZXJIZWlnaHQsIGRyYWdYIC0gZHJhZ0hlbHBlckhlaWdodClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBkcmFnWSA9IE1hdGgubWF4KFxyXG4gICAgICAgICAgICAgICAgICAgIC1kcmFnSGVscGVySGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGRyYWdIZWlnaHQgLSBkcmFnSGVscGVySGVpZ2h0LCBkcmFnWSAtIGRyYWdIZWxwZXJIZWlnaHQpXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgZHJhZ0hlbHBlci5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IGRyYWdZICsgXCJweFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwibGVmdFwiOiBkcmFnWCArIFwicHhcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGFscGhhWCA9IGN1cnJlbnRBbHBoYSAqIGFscGhhV2lkdGg7XHJcbiAgICAgICAgICAgICAgICBhbHBoYVNsaWRlSGVscGVyLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJsZWZ0XCI6IChhbHBoYVggLSAoYWxwaGFTbGlkZUhlbHBlcldpZHRoIC8gMikpICsgXCJweFwiXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBXaGVyZSB0byBzaG93IHRoZSBiYXIgdGhhdCBkaXNwbGF5cyB5b3VyIGN1cnJlbnQgc2VsZWN0ZWQgaHVlXHJcbiAgICAgICAgICAgICAgICB2YXIgc2xpZGVZID0gKGN1cnJlbnRIdWUpICogc2xpZGVIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBzbGlkZUhlbHBlci5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IChzbGlkZVkgLSBzbGlkZUhlbHBlckhlaWdodCkgKyBcInB4XCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVPcmlnaW5hbElucHV0KGZpcmVDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB2YXIgY29sb3IgPSBnZXQoKSxcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlDb2xvciA9ICcnLFxyXG4gICAgICAgICAgICAgICAgaGFzQ2hhbmdlZCA9ICF0aW55Y29sb3IuZXF1YWxzKGNvbG9yLCBjb2xvck9uU2hvdyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoY29sb3IpIHtcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlDb2xvciA9IGNvbG9yLnRvU3RyaW5nKGN1cnJlbnRQcmVmZXJyZWRGb3JtYXQpO1xyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBzZWxlY3Rpb24gcGFsZXR0ZSB3aXRoIHRoZSBjdXJyZW50IGNvbG9yXHJcbiAgICAgICAgICAgICAgICBhZGRDb2xvclRvU2VsZWN0aW9uUGFsZXR0ZShjb2xvcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChpc0lucHV0KSB7XHJcbiAgICAgICAgICAgICAgICBib3VuZEVsZW1lbnQudmFsKGRpc3BsYXlDb2xvcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChmaXJlQ2FsbGJhY2sgJiYgaGFzQ2hhbmdlZCkge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzLmNoYW5nZShjb2xvcik7XHJcbiAgICAgICAgICAgICAgICBib3VuZEVsZW1lbnQudHJpZ2dlcignY2hhbmdlJywgWyBjb2xvciBdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVmbG93KCkge1xyXG4gICAgICAgICAgICBkcmFnV2lkdGggPSBkcmFnZ2VyLndpZHRoKCk7XHJcbiAgICAgICAgICAgIGRyYWdIZWlnaHQgPSBkcmFnZ2VyLmhlaWdodCgpO1xyXG4gICAgICAgICAgICBkcmFnSGVscGVySGVpZ2h0ID0gZHJhZ0hlbHBlci5oZWlnaHQoKTtcclxuICAgICAgICAgICAgc2xpZGVXaWR0aCA9IHNsaWRlci53aWR0aCgpO1xyXG4gICAgICAgICAgICBzbGlkZUhlaWdodCA9IHNsaWRlci5oZWlnaHQoKTtcclxuICAgICAgICAgICAgc2xpZGVIZWxwZXJIZWlnaHQgPSBzbGlkZUhlbHBlci5oZWlnaHQoKTtcclxuICAgICAgICAgICAgYWxwaGFXaWR0aCA9IGFscGhhU2xpZGVyLndpZHRoKCk7XHJcbiAgICAgICAgICAgIGFscGhhU2xpZGVIZWxwZXJXaWR0aCA9IGFscGhhU2xpZGVIZWxwZXIud2lkdGgoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghZmxhdCkge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmNzcyhcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0cy5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIub2Zmc2V0KG9wdHMub2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLm9mZnNldChnZXRPZmZzZXQoY29udGFpbmVyLCBvZmZzZXRFbGVtZW50KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZUhlbHBlckxvY2F0aW9ucygpO1xyXG5cclxuICAgICAgICAgICAgaWYgKG9wdHMuc2hvd1BhbGV0dGUpIHtcclxuICAgICAgICAgICAgICAgIGRyYXdQYWxldHRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC50cmlnZ2VyKCdyZWZsb3cuc3BlY3RydW0nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC5zaG93KCk7XHJcbiAgICAgICAgICAgIG9mZnNldEVsZW1lbnQudW5iaW5kKFwiY2xpY2suc3BlY3RydW0gdG91Y2hzdGFydC5zcGVjdHJ1bVwiKTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICByZXBsYWNlci5yZW1vdmUoKTtcclxuICAgICAgICAgICAgc3BlY3RydW1zW3NwZWN0LmlkXSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvcHRpb24ob3B0aW9uTmFtZSwgb3B0aW9uVmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbk5hbWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICQuZXh0ZW5kKHt9LCBvcHRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9uVmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdHNbb3B0aW9uTmFtZV07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9wdHNbb3B0aW9uTmFtZV0gPSBvcHRpb25WYWx1ZTtcclxuICAgICAgICAgICAgYXBwbHlPcHRpb25zKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlbmFibGUoKSB7XHJcbiAgICAgICAgICAgIGRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGJvdW5kRWxlbWVudC5hdHRyKFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICBvZmZzZXRFbGVtZW50LnJlbW92ZUNsYXNzKFwic3AtZGlzYWJsZWRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkaXNhYmxlKCkge1xyXG4gICAgICAgICAgICBoaWRlKCk7XHJcbiAgICAgICAgICAgIGRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgYm91bmRFbGVtZW50LmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgICAgICAgICAgb2Zmc2V0RWxlbWVudC5hZGRDbGFzcyhcInNwLWRpc2FibGVkXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0T2Zmc2V0KGNvb3JkKSB7XHJcbiAgICAgICAgICAgIG9wdHMub2Zmc2V0ID0gY29vcmQ7XHJcbiAgICAgICAgICAgIHJlZmxvdygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaW5pdGlhbGl6ZSgpO1xyXG5cclxuICAgICAgICB2YXIgc3BlY3QgPSB7XHJcbiAgICAgICAgICAgIHNob3c6IHNob3csXHJcbiAgICAgICAgICAgIGhpZGU6IGhpZGUsXHJcbiAgICAgICAgICAgIHRvZ2dsZTogdG9nZ2xlLFxyXG4gICAgICAgICAgICByZWZsb3c6IHJlZmxvdyxcclxuICAgICAgICAgICAgb3B0aW9uOiBvcHRpb24sXHJcbiAgICAgICAgICAgIGVuYWJsZTogZW5hYmxlLFxyXG4gICAgICAgICAgICBkaXNhYmxlOiBkaXNhYmxlLFxyXG4gICAgICAgICAgICBvZmZzZXQ6IHNldE9mZnNldCxcclxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgc2V0KGMpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3JpZ2luYWxJbnB1dCgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXQ6IGdldCxcclxuICAgICAgICAgICAgZGVzdHJveTogZGVzdHJveSxcclxuICAgICAgICAgICAgY29udGFpbmVyOiBjb250YWluZXJcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBzcGVjdC5pZCA9IHNwZWN0cnVtcy5wdXNoKHNwZWN0KSAtIDE7XHJcblxyXG4gICAgICAgIHJldHVybiBzcGVjdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICogY2hlY2tPZmZzZXQgLSBnZXQgdGhlIG9mZnNldCBiZWxvdy9hYm92ZSBhbmQgbGVmdC9yaWdodCBlbGVtZW50IGRlcGVuZGluZyBvbiBzY3JlZW4gcG9zaXRpb25cclxuICAgICogVGhhbmtzIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5LXVpL2Jsb2IvbWFzdGVyL3VpL2pxdWVyeS51aS5kYXRlcGlja2VyLmpzXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0T2Zmc2V0KHBpY2tlciwgaW5wdXQpIHtcclxuICAgICAgICB2YXIgZXh0cmFZID0gMDtcclxuICAgICAgICB2YXIgZHBXaWR0aCA9IHBpY2tlci5vdXRlcldpZHRoKCk7XHJcbiAgICAgICAgdmFyIGRwSGVpZ2h0ID0gcGlja2VyLm91dGVySGVpZ2h0KCk7XHJcbiAgICAgICAgdmFyIGlucHV0SGVpZ2h0ID0gaW5wdXQub3V0ZXJIZWlnaHQoKTtcclxuICAgICAgICB2YXIgZG9jID0gcGlja2VyWzBdLm93bmVyRG9jdW1lbnQ7XHJcbiAgICAgICAgdmFyIGRvY0VsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xyXG4gICAgICAgIHZhciB2aWV3V2lkdGggPSBkb2NFbGVtLmNsaWVudFdpZHRoICsgJChkb2MpLnNjcm9sbExlZnQoKTtcclxuICAgICAgICB2YXIgdmlld0hlaWdodCA9IGRvY0VsZW0uY2xpZW50SGVpZ2h0ICsgJChkb2MpLnNjcm9sbFRvcCgpO1xyXG4gICAgICAgIHZhciBvZmZzZXQgPSBpbnB1dC5vZmZzZXQoKTtcclxuICAgICAgICBvZmZzZXQudG9wICs9IGlucHV0SGVpZ2h0O1xyXG5cclxuICAgICAgICBvZmZzZXQubGVmdCAtPVxyXG4gICAgICAgICAgICBNYXRoLm1pbihvZmZzZXQubGVmdCwgKG9mZnNldC5sZWZ0ICsgZHBXaWR0aCA+IHZpZXdXaWR0aCAmJiB2aWV3V2lkdGggPiBkcFdpZHRoKSA/XHJcbiAgICAgICAgICAgIE1hdGguYWJzKG9mZnNldC5sZWZ0ICsgZHBXaWR0aCAtIHZpZXdXaWR0aCkgOiAwKTtcclxuXHJcbiAgICAgICAgb2Zmc2V0LnRvcCAtPVxyXG4gICAgICAgICAgICBNYXRoLm1pbihvZmZzZXQudG9wLCAoKG9mZnNldC50b3AgKyBkcEhlaWdodCA+IHZpZXdIZWlnaHQgJiYgdmlld0hlaWdodCA+IGRwSGVpZ2h0KSA/XHJcbiAgICAgICAgICAgIE1hdGguYWJzKGRwSGVpZ2h0ICsgaW5wdXRIZWlnaHQgLSBleHRyYVkpIDogZXh0cmFZKSk7XHJcblxyXG4gICAgICAgIHJldHVybiBvZmZzZXQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIG5vb3AgLSBkbyBub3RoaW5nXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gbm9vcCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAqIHN0b3BQcm9wYWdhdGlvbiAtIG1ha2VzIHRoZSBjb2RlIG9ubHkgZG9pbmcgdGhpcyBhIGxpdHRsZSBlYXNpZXIgdG8gcmVhZCBpbiBsaW5lXHJcbiAgICAqL1xyXG4gICAgZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uKGUpIHtcclxuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiBDcmVhdGUgYSBmdW5jdGlvbiBib3VuZCB0byBhIGdpdmVuIG9iamVjdFxyXG4gICAgKiBUaGFua3MgdG8gdW5kZXJzY29yZS5qc1xyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIGJpbmQoZnVuYywgb2JqKSB7XHJcbiAgICAgICAgdmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xyXG4gICAgICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jLmFwcGx5KG9iaiwgYXJncy5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICogTGlnaHR3ZWlnaHQgZHJhZyBoZWxwZXIuICBIYW5kbGVzIGNvbnRhaW5tZW50IHdpdGhpbiB0aGUgZWxlbWVudCwgc28gdGhhdFxyXG4gICAgKiB3aGVuIGRyYWdnaW5nLCB0aGUgeCBpcyB3aXRoaW4gWzAsZWxlbWVudC53aWR0aF0gYW5kIHkgaXMgd2l0aGluIFswLGVsZW1lbnQuaGVpZ2h0XVxyXG4gICAgKi9cclxuICAgIGZ1bmN0aW9uIGRyYWdnYWJsZShlbGVtZW50LCBvbm1vdmUsIG9uc3RhcnQsIG9uc3RvcCkge1xyXG4gICAgICAgIG9ubW92ZSA9IG9ubW92ZSB8fCBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICAgICAgb25zdGFydCA9IG9uc3RhcnQgfHwgZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgICAgIG9uc3RvcCA9IG9uc3RvcCB8fCBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICAgICAgdmFyIGRvYyA9IGRvY3VtZW50O1xyXG4gICAgICAgIHZhciBkcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBvZmZzZXQgPSB7fTtcclxuICAgICAgICB2YXIgbWF4SGVpZ2h0ID0gMDtcclxuICAgICAgICB2YXIgbWF4V2lkdGggPSAwO1xyXG4gICAgICAgIHZhciBoYXNUb3VjaCA9ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpO1xyXG5cclxuICAgICAgICB2YXIgZHVyaW5nRHJhZ0V2ZW50cyA9IHt9O1xyXG4gICAgICAgIGR1cmluZ0RyYWdFdmVudHNbXCJzZWxlY3RzdGFydFwiXSA9IHByZXZlbnQ7XHJcbiAgICAgICAgZHVyaW5nRHJhZ0V2ZW50c1tcImRyYWdzdGFydFwiXSA9IHByZXZlbnQ7XHJcbiAgICAgICAgZHVyaW5nRHJhZ0V2ZW50c1tcInRvdWNobW92ZSBtb3VzZW1vdmVcIl0gPSBtb3ZlO1xyXG4gICAgICAgIGR1cmluZ0RyYWdFdmVudHNbXCJ0b3VjaGVuZCBtb3VzZXVwXCJdID0gc3RvcDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcHJldmVudChlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLnN0b3BQcm9wYWdhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1vdmUoZSkge1xyXG4gICAgICAgICAgICBpZiAoZHJhZ2dpbmcpIHtcclxuICAgICAgICAgICAgICAgIC8vIE1vdXNldXAgaGFwcGVuZWQgb3V0c2lkZSBvZiB3aW5kb3dcclxuICAgICAgICAgICAgICAgIGlmIChJRSAmJiBkb2MuZG9jdW1lbnRNb2RlIDwgOSAmJiAhZS5idXR0b24pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0b3VjaGVzID0gZS5vcmlnaW5hbEV2ZW50ICYmIGUub3JpZ2luYWxFdmVudC50b3VjaGVzO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhZ2VYID0gdG91Y2hlcyA/IHRvdWNoZXNbMF0ucGFnZVggOiBlLnBhZ2VYO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhZ2VZID0gdG91Y2hlcyA/IHRvdWNoZXNbMF0ucGFnZVkgOiBlLnBhZ2VZO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBkcmFnWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKHBhZ2VYIC0gb2Zmc2V0LmxlZnQsIG1heFdpZHRoKSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZHJhZ1kgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihwYWdlWSAtIG9mZnNldC50b3AsIG1heEhlaWdodCkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChoYXNUb3VjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFN0b3Agc2Nyb2xsaW5nIGluIGlPU1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgb25tb3ZlLmFwcGx5KGVsZW1lbnQsIFtkcmFnWCwgZHJhZ1ksIGVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc3RhcnQoZSkge1xyXG4gICAgICAgICAgICB2YXIgcmlnaHRjbGljayA9IChlLndoaWNoKSA/IChlLndoaWNoID09IDMpIDogKGUuYnV0dG9uID09IDIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFyaWdodGNsaWNrICYmICFkcmFnZ2luZykge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9uc3RhcnQuYXBwbHkoZWxlbWVudCwgYXJndW1lbnRzKSAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBkcmFnZ2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gJChlbGVtZW50KS5oZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBtYXhXaWR0aCA9ICQoZWxlbWVudCkud2lkdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAkKGVsZW1lbnQpLm9mZnNldCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkKGRvYykuYmluZChkdXJpbmdEcmFnRXZlbnRzKTtcclxuICAgICAgICAgICAgICAgICAgICAkKGRvYy5ib2R5KS5hZGRDbGFzcyhcInNwLWRyYWdnaW5nXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc1RvdWNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBwcmV2ZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzdG9wKCkge1xyXG4gICAgICAgICAgICBpZiAoZHJhZ2dpbmcpIHtcclxuICAgICAgICAgICAgICAgICQoZG9jKS51bmJpbmQoZHVyaW5nRHJhZ0V2ZW50cyk7XHJcbiAgICAgICAgICAgICAgICAkKGRvYy5ib2R5KS5yZW1vdmVDbGFzcyhcInNwLWRyYWdnaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgb25zdG9wLmFwcGx5KGVsZW1lbnQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQoZWxlbWVudCkuYmluZChcInRvdWNoc3RhcnQgbW91c2Vkb3duXCIsIHN0YXJ0KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0aHJvdHRsZShmdW5jLCB3YWl0LCBkZWJvdW5jZSkge1xyXG4gICAgICAgIHZhciB0aW1lb3V0O1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcywgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgdmFyIHRocm90dGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaWYgKGRlYm91bmNlKSBjbGVhclRpbWVvdXQodGltZW91dCk7XHJcbiAgICAgICAgICAgIGlmIChkZWJvdW5jZSB8fCAhdGltZW91dCkgdGltZW91dCA9IHNldFRpbWVvdXQodGhyb3R0bGVyLCB3YWl0KTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiBEZWZpbmUgYSBqUXVlcnkgcGx1Z2luXHJcbiAgICAqL1xyXG4gICAgdmFyIGRhdGFJRCA9IFwic3BlY3RydW0uaWRcIjtcclxuICAgICQuZm4uc3BlY3RydW0gPSBmdW5jdGlvbiAob3B0cywgZXh0cmEpIHtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRzID09IFwic3RyaW5nXCIpIHtcclxuXHJcbiAgICAgICAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzcGVjdCA9IHNwZWN0cnVtc1skKHRoaXMpLmRhdGEoZGF0YUlEKV07XHJcbiAgICAgICAgICAgICAgICBpZiAoc3BlY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gc3BlY3Rbb3B0c107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtZXRob2QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCBcIlNwZWN0cnVtOiBubyBzdWNoIG1ldGhvZDogJ1wiICsgb3B0cyArIFwiJ1wiICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cyA9PSBcImdldFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblZhbHVlID0gc3BlY3QuZ2V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdHMgPT0gXCJjb250YWluZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHNwZWN0LmNvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0cyA9PSBcIm9wdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblZhbHVlID0gc3BlY3Qub3B0aW9uLmFwcGx5KHNwZWN0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0cyA9PSBcImRlc3Ryb3lcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGVjdC5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlRGF0YShkYXRhSUQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kLmFwcGx5KHNwZWN0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6aW5nIGEgbmV3IGluc3RhbmNlIG9mIHNwZWN0cnVtXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3BlY3RydW0oXCJkZXN0cm95XCIpLmVhY2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBvcHRzLCAkKHRoaXMpLmRhdGEoKSk7XHJcbiAgICAgICAgICAgIHZhciBzcGVjdCA9IHNwZWN0cnVtKHRoaXMsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAkKHRoaXMpLmRhdGEoZGF0YUlELCBzcGVjdC5pZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICQuZm4uc3BlY3RydW0ubG9hZCA9IHRydWU7XHJcbiAgICAkLmZuLnNwZWN0cnVtLmxvYWRPcHRzID0ge307XHJcbiAgICAkLmZuLnNwZWN0cnVtLmRyYWdnYWJsZSA9IGRyYWdnYWJsZTtcclxuICAgICQuZm4uc3BlY3RydW0uZGVmYXVsdHMgPSBkZWZhdWx0T3B0cztcclxuXHJcbiAgICAkLnNwZWN0cnVtID0geyB9O1xyXG4gICAgJC5zcGVjdHJ1bS5sb2NhbGl6YXRpb24gPSB7IH07XHJcbiAgICAkLnNwZWN0cnVtLnBhbGV0dGVzID0geyB9O1xyXG5cclxuICAgICQuZm4uc3BlY3RydW0ucHJvY2Vzc05hdGl2ZUNvbG9ySW5wdXRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghaW5wdXRUeXBlQ29sb3JTdXBwb3J0KSB7XHJcbiAgICAgICAgICAgICQoXCJpbnB1dFt0eXBlPWNvbG9yXVwiKS5zcGVjdHJ1bSh7XHJcbiAgICAgICAgICAgICAgICBwcmVmZXJyZWRGb3JtYXQ6IFwiaGV4NlwiXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gVGlueUNvbG9yIHYxLjEuMVxyXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2Jncmlucy9UaW55Q29sb3JcclxuICAgIC8vIEJyaWFuIEdyaW5zdGVhZCwgTUlUIExpY2Vuc2VcclxuXHJcbiAgICAoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdmFyIHRyaW1MZWZ0ID0gL15bXFxzLCNdKy8sXHJcbiAgICAgICAgdHJpbVJpZ2h0ID0gL1xccyskLyxcclxuICAgICAgICB0aW55Q291bnRlciA9IDAsXHJcbiAgICAgICAgbWF0aCA9IE1hdGgsXHJcbiAgICAgICAgbWF0aFJvdW5kID0gbWF0aC5yb3VuZCxcclxuICAgICAgICBtYXRoTWluID0gbWF0aC5taW4sXHJcbiAgICAgICAgbWF0aE1heCA9IG1hdGgubWF4LFxyXG4gICAgICAgIG1hdGhSYW5kb20gPSBtYXRoLnJhbmRvbTtcclxuXHJcbiAgICB2YXIgdGlueWNvbG9yID0gZnVuY3Rpb24gdGlueWNvbG9yIChjb2xvciwgb3B0cykge1xyXG5cclxuICAgICAgICBjb2xvciA9IChjb2xvcikgPyBjb2xvciA6ICcnO1xyXG4gICAgICAgIG9wdHMgPSBvcHRzIHx8IHsgfTtcclxuXHJcbiAgICAgICAgLy8gSWYgaW5wdXQgaXMgYWxyZWFkeSBhIHRpbnljb2xvciwgcmV0dXJuIGl0c2VsZlxyXG4gICAgICAgIGlmIChjb2xvciBpbnN0YW5jZW9mIHRpbnljb2xvcikge1xyXG4gICAgICAgICAgIHJldHVybiBjb2xvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgd2UgYXJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLCBjYWxsIHVzaW5nIG5ldyBpbnN0ZWFkXHJcbiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIHRpbnljb2xvcikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyB0aW55Y29sb3IoY29sb3IsIG9wdHMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHJnYiA9IGlucHV0VG9SR0IoY29sb3IpO1xyXG4gICAgICAgIHRoaXMuX29yaWdpbmFsSW5wdXQgPSBjb2xvcixcclxuICAgICAgICB0aGlzLl9yID0gcmdiLnIsXHJcbiAgICAgICAgdGhpcy5fZyA9IHJnYi5nLFxyXG4gICAgICAgIHRoaXMuX2IgPSByZ2IuYixcclxuICAgICAgICB0aGlzLl9hID0gcmdiLmEsXHJcbiAgICAgICAgdGhpcy5fcm91bmRBID0gbWF0aFJvdW5kKDEwMCp0aGlzLl9hKSAvIDEwMCxcclxuICAgICAgICB0aGlzLl9mb3JtYXQgPSBvcHRzLmZvcm1hdCB8fCByZ2IuZm9ybWF0O1xyXG4gICAgICAgIHRoaXMuX2dyYWRpZW50VHlwZSA9IG9wdHMuZ3JhZGllbnRUeXBlO1xyXG5cclxuICAgICAgICAvLyBEb24ndCBsZXQgdGhlIHJhbmdlIG9mIFswLDI1NV0gY29tZSBiYWNrIGluIFswLDFdLlxyXG4gICAgICAgIC8vIFBvdGVudGlhbGx5IGxvc2UgYSBsaXR0bGUgYml0IG9mIHByZWNpc2lvbiBoZXJlLCBidXQgd2lsbCBmaXggaXNzdWVzIHdoZXJlXHJcbiAgICAgICAgLy8gLjUgZ2V0cyBpbnRlcnByZXRlZCBhcyBoYWxmIG9mIHRoZSB0b3RhbCwgaW5zdGVhZCBvZiBoYWxmIG9mIDFcclxuICAgICAgICAvLyBJZiBpdCB3YXMgc3VwcG9zZWQgdG8gYmUgMTI4LCB0aGlzIHdhcyBhbHJlYWR5IHRha2VuIGNhcmUgb2YgYnkgYGlucHV0VG9SZ2JgXHJcbiAgICAgICAgaWYgKHRoaXMuX3IgPCAxKSB7IHRoaXMuX3IgPSBtYXRoUm91bmQodGhpcy5fcik7IH1cclxuICAgICAgICBpZiAodGhpcy5fZyA8IDEpIHsgdGhpcy5fZyA9IG1hdGhSb3VuZCh0aGlzLl9nKTsgfVxyXG4gICAgICAgIGlmICh0aGlzLl9iIDwgMSkgeyB0aGlzLl9iID0gbWF0aFJvdW5kKHRoaXMuX2IpOyB9XHJcblxyXG4gICAgICAgIHRoaXMuX29rID0gcmdiLm9rO1xyXG4gICAgICAgIHRoaXMuX3RjX2lkID0gdGlueUNvdW50ZXIrKztcclxuICAgIH07XHJcblxyXG4gICAgdGlueWNvbG9yLnByb3RvdHlwZSA9IHtcclxuICAgICAgICBpc0Rhcms6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCcmlnaHRuZXNzKCkgPCAxMjg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpc0xpZ2h0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlzRGFyaygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaXNWYWxpZDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vaztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldE9yaWdpbmFsSW5wdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuX29yaWdpbmFsSW5wdXQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRGb3JtYXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0QWxwaGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldEJyaWdodG5lc3M6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcmdiID0gdGhpcy50b1JnYigpO1xyXG4gICAgICAgICAgICByZXR1cm4gKHJnYi5yICogMjk5ICsgcmdiLmcgKiA1ODcgKyByZ2IuYiAqIDExNCkgLyAxMDAwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0QWxwaGE6IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2EgPSBib3VuZEFscGhhKHZhbHVlKTtcclxuICAgICAgICAgICAgdGhpcy5fcm91bmRBID0gbWF0aFJvdW5kKDEwMCp0aGlzLl9hKSAvIDEwMDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0hzdjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBoc3YgPSByZ2JUb0hzdih0aGlzLl9yLCB0aGlzLl9nLCB0aGlzLl9iKTtcclxuICAgICAgICAgICAgcmV0dXJuIHsgaDogaHN2LmggKiAzNjAsIHM6IGhzdi5zLCB2OiBoc3YudiwgYTogdGhpcy5fYSB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9Ic3ZTdHJpbmc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgaHN2ID0gcmdiVG9Ic3YodGhpcy5fciwgdGhpcy5fZywgdGhpcy5fYik7XHJcbiAgICAgICAgICAgIHZhciBoID0gbWF0aFJvdW5kKGhzdi5oICogMzYwKSwgcyA9IG1hdGhSb3VuZChoc3YucyAqIDEwMCksIHYgPSBtYXRoUm91bmQoaHN2LnYgKiAxMDApO1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX2EgPT0gMSkgP1xyXG4gICAgICAgICAgICAgIFwiaHN2KFwiICArIGggKyBcIiwgXCIgKyBzICsgXCIlLCBcIiArIHYgKyBcIiUpXCIgOlxyXG4gICAgICAgICAgICAgIFwiaHN2YShcIiArIGggKyBcIiwgXCIgKyBzICsgXCIlLCBcIiArIHYgKyBcIiUsIFwiKyB0aGlzLl9yb3VuZEEgKyBcIilcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvSHNsOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGhzbCA9IHJnYlRvSHNsKHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IpO1xyXG4gICAgICAgICAgICByZXR1cm4geyBoOiBoc2wuaCAqIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sLCBhOiB0aGlzLl9hIH07XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0hzbFN0cmluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBoc2wgPSByZ2JUb0hzbCh0aGlzLl9yLCB0aGlzLl9nLCB0aGlzLl9iKTtcclxuICAgICAgICAgICAgdmFyIGggPSBtYXRoUm91bmQoaHNsLmggKiAzNjApLCBzID0gbWF0aFJvdW5kKGhzbC5zICogMTAwKSwgbCA9IG1hdGhSb3VuZChoc2wubCAqIDEwMCk7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5fYSA9PSAxKSA/XHJcbiAgICAgICAgICAgICAgXCJoc2woXCIgICsgaCArIFwiLCBcIiArIHMgKyBcIiUsIFwiICsgbCArIFwiJSlcIiA6XHJcbiAgICAgICAgICAgICAgXCJoc2xhKFwiICsgaCArIFwiLCBcIiArIHMgKyBcIiUsIFwiICsgbCArIFwiJSwgXCIrIHRoaXMuX3JvdW5kQSArIFwiKVwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9IZXg6IGZ1bmN0aW9uKGFsbG93M0NoYXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJnYlRvSGV4KHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IsIGFsbG93M0NoYXIpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9IZXhTdHJpbmc6IGZ1bmN0aW9uKGFsbG93M0NoYXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcjJyArIHRoaXMudG9IZXgoYWxsb3czQ2hhcik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b0hleDg6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmdiYVRvSGV4KHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IsIHRoaXMuX2EpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdG9IZXg4U3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcjJyArIHRoaXMudG9IZXg4KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b1JnYjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHI6IG1hdGhSb3VuZCh0aGlzLl9yKSwgZzogbWF0aFJvdW5kKHRoaXMuX2cpLCBiOiBtYXRoUm91bmQodGhpcy5fYiksIGE6IHRoaXMuX2EgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvUmdiU3RyaW5nOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9hID09IDEpID9cclxuICAgICAgICAgICAgICBcInJnYihcIiAgKyBtYXRoUm91bmQodGhpcy5fcikgKyBcIiwgXCIgKyBtYXRoUm91bmQodGhpcy5fZykgKyBcIiwgXCIgKyBtYXRoUm91bmQodGhpcy5fYikgKyBcIilcIiA6XHJcbiAgICAgICAgICAgICAgXCJyZ2JhKFwiICsgbWF0aFJvdW5kKHRoaXMuX3IpICsgXCIsIFwiICsgbWF0aFJvdW5kKHRoaXMuX2cpICsgXCIsIFwiICsgbWF0aFJvdW5kKHRoaXMuX2IpICsgXCIsIFwiICsgdGhpcy5fcm91bmRBICsgXCIpXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b1BlcmNlbnRhZ2VSZ2I6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4geyByOiBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9yLCAyNTUpICogMTAwKSArIFwiJVwiLCBnOiBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9nLCAyNTUpICogMTAwKSArIFwiJVwiLCBiOiBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9iLCAyNTUpICogMTAwKSArIFwiJVwiLCBhOiB0aGlzLl9hIH07XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b1BlcmNlbnRhZ2VSZ2JTdHJpbmc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX2EgPT0gMSkgP1xyXG4gICAgICAgICAgICAgIFwicmdiKFwiICArIG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX3IsIDI1NSkgKiAxMDApICsgXCIlLCBcIiArIG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX2csIDI1NSkgKiAxMDApICsgXCIlLCBcIiArIG1hdGhSb3VuZChib3VuZDAxKHRoaXMuX2IsIDI1NSkgKiAxMDApICsgXCIlKVwiIDpcclxuICAgICAgICAgICAgICBcInJnYmEoXCIgKyBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9yLCAyNTUpICogMTAwKSArIFwiJSwgXCIgKyBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9nLCAyNTUpICogMTAwKSArIFwiJSwgXCIgKyBtYXRoUm91bmQoYm91bmQwMSh0aGlzLl9iLCAyNTUpICogMTAwKSArIFwiJSwgXCIgKyB0aGlzLl9yb3VuZEEgKyBcIilcIjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvTmFtZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9hID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ0cmFuc3BhcmVudFwiO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5fYSA8IDEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGhleE5hbWVzW3JnYlRvSGV4KHRoaXMuX3IsIHRoaXMuX2csIHRoaXMuX2IsIHRydWUpXSB8fCBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRvRmlsdGVyOiBmdW5jdGlvbihzZWNvbmRDb2xvcikge1xyXG4gICAgICAgICAgICB2YXIgaGV4OFN0cmluZyA9ICcjJyArIHJnYmFUb0hleCh0aGlzLl9yLCB0aGlzLl9nLCB0aGlzLl9iLCB0aGlzLl9hKTtcclxuICAgICAgICAgICAgdmFyIHNlY29uZEhleDhTdHJpbmcgPSBoZXg4U3RyaW5nO1xyXG4gICAgICAgICAgICB2YXIgZ3JhZGllbnRUeXBlID0gdGhpcy5fZ3JhZGllbnRUeXBlID8gXCJHcmFkaWVudFR5cGUgPSAxLCBcIiA6IFwiXCI7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2Vjb25kQ29sb3IpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gdGlueWNvbG9yKHNlY29uZENvbG9yKTtcclxuICAgICAgICAgICAgICAgIHNlY29uZEhleDhTdHJpbmcgPSBzLnRvSGV4OFN0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gXCJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoXCIrZ3JhZGllbnRUeXBlK1wic3RhcnRDb2xvcnN0cj1cIitoZXg4U3RyaW5nK1wiLGVuZENvbG9yc3RyPVwiK3NlY29uZEhleDhTdHJpbmcrXCIpXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oZm9ybWF0KSB7XHJcbiAgICAgICAgICAgIHZhciBmb3JtYXRTZXQgPSAhIWZvcm1hdDtcclxuICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0IHx8IHRoaXMuX2Zvcm1hdDtcclxuXHJcbiAgICAgICAgICAgIHZhciBmb3JtYXR0ZWRTdHJpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdmFyIGhhc0FscGhhID0gdGhpcy5fYSA8IDEgJiYgdGhpcy5fYSA+PSAwO1xyXG4gICAgICAgICAgICB2YXIgbmVlZHNBbHBoYUZvcm1hdCA9ICFmb3JtYXRTZXQgJiYgaGFzQWxwaGEgJiYgKGZvcm1hdCA9PT0gXCJoZXhcIiB8fCBmb3JtYXQgPT09IFwiaGV4NlwiIHx8IGZvcm1hdCA9PT0gXCJoZXgzXCIgfHwgZm9ybWF0ID09PSBcIm5hbWVcIik7XHJcblxyXG4gICAgICAgICAgICBpZiAobmVlZHNBbHBoYUZvcm1hdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gU3BlY2lhbCBjYXNlIGZvciBcInRyYW5zcGFyZW50XCIsIGFsbCBvdGhlciBub24tYWxwaGEgZm9ybWF0c1xyXG4gICAgICAgICAgICAgICAgLy8gd2lsbCByZXR1cm4gcmdiYSB3aGVuIHRoZXJlIGlzIHRyYW5zcGFyZW5jeS5cclxuICAgICAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwibmFtZVwiICYmIHRoaXMuX2EgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50b05hbWUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvUmdiU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gXCJyZ2JcIikge1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b1JnYlN0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwicHJnYlwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvUGVyY2VudGFnZVJnYlN0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwiaGV4XCIgfHwgZm9ybWF0ID09PSBcImhleDZcIikge1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b0hleFN0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwiaGV4M1wiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSGV4U3RyaW5nKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwiaGV4OFwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSGV4OFN0cmluZygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwibmFtZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvTmFtZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09IFwiaHNsXCIpIHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFN0cmluZyA9IHRoaXMudG9Ic2xTdHJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZm9ybWF0ID09PSBcImhzdlwiKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSHN2U3RyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZWRTdHJpbmcgfHwgdGhpcy50b0hleFN0cmluZygpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9hcHBseU1vZGlmaWNhdGlvbjogZnVuY3Rpb24oZm4sIGFyZ3MpIHtcclxuICAgICAgICAgICAgdmFyIGNvbG9yID0gZm4uYXBwbHkobnVsbCwgW3RoaXNdLmNvbmNhdChbXS5zbGljZS5jYWxsKGFyZ3MpKSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3IgPSBjb2xvci5fcjtcclxuICAgICAgICAgICAgdGhpcy5fZyA9IGNvbG9yLl9nO1xyXG4gICAgICAgICAgICB0aGlzLl9iID0gY29sb3IuX2I7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QWxwaGEoY29sb3IuX2EpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxpZ2h0ZW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24obGlnaHRlbiwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJyaWdodGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKGJyaWdodGVuLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGFya2VuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKGRhcmtlbiwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRlc2F0dXJhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oZGVzYXR1cmF0ZSwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNhdHVyYXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKHNhdHVyYXRlLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ3JleXNjYWxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5TW9kaWZpY2F0aW9uKGdyZXlzY2FsZSwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNwaW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlNb2RpZmljYXRpb24oc3BpbiwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfYXBwbHlDb21iaW5hdGlvbjogZnVuY3Rpb24oZm4sIGFyZ3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KG51bGwsIFt0aGlzXS5jb25jYXQoW10uc2xpY2UuY2FsbChhcmdzKSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYW5hbG9nb3VzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5Q29tYmluYXRpb24oYW5hbG9nb3VzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29tcGxlbWVudDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseUNvbWJpbmF0aW9uKGNvbXBsZW1lbnQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBtb25vY2hyb21hdGljOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5Q29tYmluYXRpb24obW9ub2Nocm9tYXRpYywgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNwbGl0Y29tcGxlbWVudDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcHBseUNvbWJpbmF0aW9uKHNwbGl0Y29tcGxlbWVudCwgYXJndW1lbnRzKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRyaWFkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGx5Q29tYmluYXRpb24odHJpYWQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0ZXRyYWQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXBwbHlDb21iaW5hdGlvbih0ZXRyYWQsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBJZiBpbnB1dCBpcyBhbiBvYmplY3QsIGZvcmNlIDEgaW50byBcIjEuMFwiIHRvIGhhbmRsZSByYXRpb3MgcHJvcGVybHlcclxuICAgIC8vIFN0cmluZyBpbnB1dCByZXF1aXJlcyBcIjEuMFwiIGFzIGlucHV0LCBzbyAxIHdpbGwgYmUgdHJlYXRlZCBhcyAxXHJcbiAgICB0aW55Y29sb3IuZnJvbVJhdGlvID0gZnVuY3Rpb24oY29sb3IsIG9wdHMpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGNvbG9yID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgdmFyIG5ld0NvbG9yID0ge307XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gY29sb3IpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb2xvci5oYXNPd25Qcm9wZXJ0eShpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSBcImFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb2xvcltpXSA9IGNvbG9yW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29sb3JbaV0gPSBjb252ZXJ0VG9QZXJjZW50YWdlKGNvbG9yW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29sb3IgPSBuZXdDb2xvcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoY29sb3IsIG9wdHMpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBHaXZlbiBhIHN0cmluZyBvciBvYmplY3QsIGNvbnZlcnQgdGhhdCBpbnB1dCB0byBSR0JcclxuICAgIC8vIFBvc3NpYmxlIHN0cmluZyBpbnB1dHM6XHJcbiAgICAvL1xyXG4gICAgLy8gICAgIFwicmVkXCJcclxuICAgIC8vICAgICBcIiNmMDBcIiBvciBcImYwMFwiXHJcbiAgICAvLyAgICAgXCIjZmYwMDAwXCIgb3IgXCJmZjAwMDBcIlxyXG4gICAgLy8gICAgIFwiI2ZmMDAwMDAwXCIgb3IgXCJmZjAwMDAwMFwiXHJcbiAgICAvLyAgICAgXCJyZ2IgMjU1IDAgMFwiIG9yIFwicmdiICgyNTUsIDAsIDApXCJcclxuICAgIC8vICAgICBcInJnYiAxLjAgMCAwXCIgb3IgXCJyZ2IgKDEsIDAsIDApXCJcclxuICAgIC8vICAgICBcInJnYmEgKDI1NSwgMCwgMCwgMSlcIiBvciBcInJnYmEgMjU1LCAwLCAwLCAxXCJcclxuICAgIC8vICAgICBcInJnYmEgKDEuMCwgMCwgMCwgMSlcIiBvciBcInJnYmEgMS4wLCAwLCAwLCAxXCJcclxuICAgIC8vICAgICBcImhzbCgwLCAxMDAlLCA1MCUpXCIgb3IgXCJoc2wgMCAxMDAlIDUwJVwiXHJcbiAgICAvLyAgICAgXCJoc2xhKDAsIDEwMCUsIDUwJSwgMSlcIiBvciBcImhzbGEgMCAxMDAlIDUwJSwgMVwiXHJcbiAgICAvLyAgICAgXCJoc3YoMCwgMTAwJSwgMTAwJSlcIiBvciBcImhzdiAwIDEwMCUgMTAwJVwiXHJcbiAgICAvL1xyXG4gICAgZnVuY3Rpb24gaW5wdXRUb1JHQihjb2xvcikge1xyXG5cclxuICAgICAgICB2YXIgcmdiID0geyByOiAwLCBnOiAwLCBiOiAwIH07XHJcbiAgICAgICAgdmFyIGEgPSAxO1xyXG4gICAgICAgIHZhciBvayA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBmb3JtYXQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiBjb2xvciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIGNvbG9yID0gc3RyaW5nSW5wdXRUb09iamVjdChjb2xvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodHlwZW9mIGNvbG9yID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KFwiclwiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcImdcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJiXCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZ2IgPSByZ2JUb1JnYihjb2xvci5yLCBjb2xvci5nLCBjb2xvci5iKTtcclxuICAgICAgICAgICAgICAgIG9rID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGZvcm1hdCA9IFN0cmluZyhjb2xvci5yKS5zdWJzdHIoLTEpID09PSBcIiVcIiA/IFwicHJnYlwiIDogXCJyZ2JcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjb2xvci5oYXNPd25Qcm9wZXJ0eShcImhcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJzXCIpICYmIGNvbG9yLmhhc093blByb3BlcnR5KFwidlwiKSkge1xyXG4gICAgICAgICAgICAgICAgY29sb3IucyA9IGNvbnZlcnRUb1BlcmNlbnRhZ2UoY29sb3Iucyk7XHJcbiAgICAgICAgICAgICAgICBjb2xvci52ID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci52KTtcclxuICAgICAgICAgICAgICAgIHJnYiA9IGhzdlRvUmdiKGNvbG9yLmgsIGNvbG9yLnMsIGNvbG9yLnYpO1xyXG4gICAgICAgICAgICAgICAgb2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gXCJoc3ZcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjb2xvci5oYXNPd25Qcm9wZXJ0eShcImhcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJzXCIpICYmIGNvbG9yLmhhc093blByb3BlcnR5KFwibFwiKSkge1xyXG4gICAgICAgICAgICAgICAgY29sb3IucyA9IGNvbnZlcnRUb1BlcmNlbnRhZ2UoY29sb3Iucyk7XHJcbiAgICAgICAgICAgICAgICBjb2xvci5sID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci5sKTtcclxuICAgICAgICAgICAgICAgIHJnYiA9IGhzbFRvUmdiKGNvbG9yLmgsIGNvbG9yLnMsIGNvbG9yLmwpO1xyXG4gICAgICAgICAgICAgICAgb2sgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gXCJoc2xcIjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KFwiYVwiKSkge1xyXG4gICAgICAgICAgICAgICAgYSA9IGNvbG9yLmE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGEgPSBib3VuZEFscGhhKGEpO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBvazogb2ssXHJcbiAgICAgICAgICAgIGZvcm1hdDogY29sb3IuZm9ybWF0IHx8IGZvcm1hdCxcclxuICAgICAgICAgICAgcjogbWF0aE1pbigyNTUsIG1hdGhNYXgocmdiLnIsIDApKSxcclxuICAgICAgICAgICAgZzogbWF0aE1pbigyNTUsIG1hdGhNYXgocmdiLmcsIDApKSxcclxuICAgICAgICAgICAgYjogbWF0aE1pbigyNTUsIG1hdGhNYXgocmdiLmIsIDApKSxcclxuICAgICAgICAgICAgYTogYVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIENvbnZlcnNpb24gRnVuY3Rpb25zXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8vIGByZ2JUb0hzbGAsIGByZ2JUb0hzdmAsIGBoc2xUb1JnYmAsIGBoc3ZUb1JnYmAgbW9kaWZpZWQgZnJvbTpcclxuICAgIC8vIDxodHRwOi8vbWppamFja3Nvbi5jb20vMjAwOC8wMi9yZ2ItdG8taHNsLWFuZC1yZ2ItdG8taHN2LWNvbG9yLW1vZGVsLWNvbnZlcnNpb24tYWxnb3JpdGhtcy1pbi1qYXZhc2NyaXB0PlxyXG5cclxuICAgIC8vIGByZ2JUb1JnYmBcclxuICAgIC8vIEhhbmRsZSBib3VuZHMgLyBwZXJjZW50YWdlIGNoZWNraW5nIHRvIGNvbmZvcm0gdG8gQ1NTIGNvbG9yIHNwZWNcclxuICAgIC8vIDxodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLWNvbG9yLz5cclxuICAgIC8vICpBc3N1bWVzOiogciwgZywgYiBpbiBbMCwgMjU1XSBvciBbMCwgMV1cclxuICAgIC8vICpSZXR1cm5zOiogeyByLCBnLCBiIH0gaW4gWzAsIDI1NV1cclxuICAgIGZ1bmN0aW9uIHJnYlRvUmdiKHIsIGcsIGIpe1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHI6IGJvdW5kMDEociwgMjU1KSAqIDI1NSxcclxuICAgICAgICAgICAgZzogYm91bmQwMShnLCAyNTUpICogMjU1LFxyXG4gICAgICAgICAgICBiOiBib3VuZDAxKGIsIDI1NSkgKiAyNTVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGByZ2JUb0hzbGBcclxuICAgIC8vIENvbnZlcnRzIGFuIFJHQiBjb2xvciB2YWx1ZSB0byBIU0wuXHJcbiAgICAvLyAqQXNzdW1lczoqIHIsIGcsIGFuZCBiIGFyZSBjb250YWluZWQgaW4gWzAsIDI1NV0gb3IgWzAsIDFdXHJcbiAgICAvLyAqUmV0dXJuczoqIHsgaCwgcywgbCB9IGluIFswLDFdXHJcbiAgICBmdW5jdGlvbiByZ2JUb0hzbChyLCBnLCBiKSB7XHJcblxyXG4gICAgICAgIHIgPSBib3VuZDAxKHIsIDI1NSk7XHJcbiAgICAgICAgZyA9IGJvdW5kMDEoZywgMjU1KTtcclxuICAgICAgICBiID0gYm91bmQwMShiLCAyNTUpO1xyXG5cclxuICAgICAgICB2YXIgbWF4ID0gbWF0aE1heChyLCBnLCBiKSwgbWluID0gbWF0aE1pbihyLCBnLCBiKTtcclxuICAgICAgICB2YXIgaCwgcywgbCA9IChtYXggKyBtaW4pIC8gMjtcclxuXHJcbiAgICAgICAgaWYobWF4ID09IG1pbikge1xyXG4gICAgICAgICAgICBoID0gcyA9IDA7IC8vIGFjaHJvbWF0aWNcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBkID0gbWF4IC0gbWluO1xyXG4gICAgICAgICAgICBzID0gbCA+IDAuNSA/IGQgLyAoMiAtIG1heCAtIG1pbikgOiBkIC8gKG1heCArIG1pbik7XHJcbiAgICAgICAgICAgIHN3aXRjaChtYXgpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgcjogaCA9IChnIC0gYikgLyBkICsgKGcgPCBiID8gNiA6IDApOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgZzogaCA9IChiIC0gcikgLyBkICsgMjsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIGI6IGggPSAociAtIGcpIC8gZCArIDQ7IGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoIC89IDY7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4geyBoOiBoLCBzOiBzLCBsOiBsIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYGhzbFRvUmdiYFxyXG4gICAgLy8gQ29udmVydHMgYW4gSFNMIGNvbG9yIHZhbHVlIHRvIFJHQi5cclxuICAgIC8vICpBc3N1bWVzOiogaCBpcyBjb250YWluZWQgaW4gWzAsIDFdIG9yIFswLCAzNjBdIGFuZCBzIGFuZCBsIGFyZSBjb250YWluZWQgWzAsIDFdIG9yIFswLCAxMDBdXHJcbiAgICAvLyAqUmV0dXJuczoqIHsgciwgZywgYiB9IGluIHRoZSBzZXQgWzAsIDI1NV1cclxuICAgIGZ1bmN0aW9uIGhzbFRvUmdiKGgsIHMsIGwpIHtcclxuICAgICAgICB2YXIgciwgZywgYjtcclxuXHJcbiAgICAgICAgaCA9IGJvdW5kMDEoaCwgMzYwKTtcclxuICAgICAgICBzID0gYm91bmQwMShzLCAxMDApO1xyXG4gICAgICAgIGwgPSBib3VuZDAxKGwsIDEwMCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGh1ZTJyZ2IocCwgcSwgdCkge1xyXG4gICAgICAgICAgICBpZih0IDwgMCkgdCArPSAxO1xyXG4gICAgICAgICAgICBpZih0ID4gMSkgdCAtPSAxO1xyXG4gICAgICAgICAgICBpZih0IDwgMS82KSByZXR1cm4gcCArIChxIC0gcCkgKiA2ICogdDtcclxuICAgICAgICAgICAgaWYodCA8IDEvMikgcmV0dXJuIHE7XHJcbiAgICAgICAgICAgIGlmKHQgPCAyLzMpIHJldHVybiBwICsgKHEgLSBwKSAqICgyLzMgLSB0KSAqIDY7XHJcbiAgICAgICAgICAgIHJldHVybiBwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYocyA9PT0gMCkge1xyXG4gICAgICAgICAgICByID0gZyA9IGIgPSBsOyAvLyBhY2hyb21hdGljXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgcSA9IGwgPCAwLjUgPyBsICogKDEgKyBzKSA6IGwgKyBzIC0gbCAqIHM7XHJcbiAgICAgICAgICAgIHZhciBwID0gMiAqIGwgLSBxO1xyXG4gICAgICAgICAgICByID0gaHVlMnJnYihwLCBxLCBoICsgMS8zKTtcclxuICAgICAgICAgICAgZyA9IGh1ZTJyZ2IocCwgcSwgaCk7XHJcbiAgICAgICAgICAgIGIgPSBodWUycmdiKHAsIHEsIGggLSAxLzMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgcjogciAqIDI1NSwgZzogZyAqIDI1NSwgYjogYiAqIDI1NSB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGByZ2JUb0hzdmBcclxuICAgIC8vIENvbnZlcnRzIGFuIFJHQiBjb2xvciB2YWx1ZSB0byBIU1ZcclxuICAgIC8vICpBc3N1bWVzOiogciwgZywgYW5kIGIgYXJlIGNvbnRhaW5lZCBpbiB0aGUgc2V0IFswLCAyNTVdIG9yIFswLCAxXVxyXG4gICAgLy8gKlJldHVybnM6KiB7IGgsIHMsIHYgfSBpbiBbMCwxXVxyXG4gICAgZnVuY3Rpb24gcmdiVG9Ic3YociwgZywgYikge1xyXG5cclxuICAgICAgICByID0gYm91bmQwMShyLCAyNTUpO1xyXG4gICAgICAgIGcgPSBib3VuZDAxKGcsIDI1NSk7XHJcbiAgICAgICAgYiA9IGJvdW5kMDEoYiwgMjU1KTtcclxuXHJcbiAgICAgICAgdmFyIG1heCA9IG1hdGhNYXgociwgZywgYiksIG1pbiA9IG1hdGhNaW4ociwgZywgYik7XHJcbiAgICAgICAgdmFyIGgsIHMsIHYgPSBtYXg7XHJcblxyXG4gICAgICAgIHZhciBkID0gbWF4IC0gbWluO1xyXG4gICAgICAgIHMgPSBtYXggPT09IDAgPyAwIDogZCAvIG1heDtcclxuXHJcbiAgICAgICAgaWYobWF4ID09IG1pbikge1xyXG4gICAgICAgICAgICBoID0gMDsgLy8gYWNocm9tYXRpY1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc3dpdGNoKG1heCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSByOiBoID0gKGcgLSBiKSAvIGQgKyAoZyA8IGIgPyA2IDogMCk7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBnOiBoID0gKGIgLSByKSAvIGQgKyAyOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgYjogaCA9IChyIC0gZykgLyBkICsgNDsgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaCAvPSA2O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyBoOiBoLCBzOiBzLCB2OiB2IH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gYGhzdlRvUmdiYFxyXG4gICAgLy8gQ29udmVydHMgYW4gSFNWIGNvbG9yIHZhbHVlIHRvIFJHQi5cclxuICAgIC8vICpBc3N1bWVzOiogaCBpcyBjb250YWluZWQgaW4gWzAsIDFdIG9yIFswLCAzNjBdIGFuZCBzIGFuZCB2IGFyZSBjb250YWluZWQgaW4gWzAsIDFdIG9yIFswLCAxMDBdXHJcbiAgICAvLyAqUmV0dXJuczoqIHsgciwgZywgYiB9IGluIHRoZSBzZXQgWzAsIDI1NV1cclxuICAgICBmdW5jdGlvbiBoc3ZUb1JnYihoLCBzLCB2KSB7XHJcblxyXG4gICAgICAgIGggPSBib3VuZDAxKGgsIDM2MCkgKiA2O1xyXG4gICAgICAgIHMgPSBib3VuZDAxKHMsIDEwMCk7XHJcbiAgICAgICAgdiA9IGJvdW5kMDEodiwgMTAwKTtcclxuXHJcbiAgICAgICAgdmFyIGkgPSBtYXRoLmZsb29yKGgpLFxyXG4gICAgICAgICAgICBmID0gaCAtIGksXHJcbiAgICAgICAgICAgIHAgPSB2ICogKDEgLSBzKSxcclxuICAgICAgICAgICAgcSA9IHYgKiAoMSAtIGYgKiBzKSxcclxuICAgICAgICAgICAgdCA9IHYgKiAoMSAtICgxIC0gZikgKiBzKSxcclxuICAgICAgICAgICAgbW9kID0gaSAlIDYsXHJcbiAgICAgICAgICAgIHIgPSBbdiwgcSwgcCwgcCwgdCwgdl1bbW9kXSxcclxuICAgICAgICAgICAgZyA9IFt0LCB2LCB2LCBxLCBwLCBwXVttb2RdLFxyXG4gICAgICAgICAgICBiID0gW3AsIHAsIHQsIHYsIHYsIHFdW21vZF07XHJcblxyXG4gICAgICAgIHJldHVybiB7IHI6IHIgKiAyNTUsIGc6IGcgKiAyNTUsIGI6IGIgKiAyNTUgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBgcmdiVG9IZXhgXHJcbiAgICAvLyBDb252ZXJ0cyBhbiBSR0IgY29sb3IgdG8gaGV4XHJcbiAgICAvLyBBc3N1bWVzIHIsIGcsIGFuZCBiIGFyZSBjb250YWluZWQgaW4gdGhlIHNldCBbMCwgMjU1XVxyXG4gICAgLy8gUmV0dXJucyBhIDMgb3IgNiBjaGFyYWN0ZXIgaGV4XHJcbiAgICBmdW5jdGlvbiByZ2JUb0hleChyLCBnLCBiLCBhbGxvdzNDaGFyKSB7XHJcblxyXG4gICAgICAgIHZhciBoZXggPSBbXHJcbiAgICAgICAgICAgIHBhZDIobWF0aFJvdW5kKHIpLnRvU3RyaW5nKDE2KSksXHJcbiAgICAgICAgICAgIHBhZDIobWF0aFJvdW5kKGcpLnRvU3RyaW5nKDE2KSksXHJcbiAgICAgICAgICAgIHBhZDIobWF0aFJvdW5kKGIpLnRvU3RyaW5nKDE2KSlcclxuICAgICAgICBdO1xyXG5cclxuICAgICAgICAvLyBSZXR1cm4gYSAzIGNoYXJhY3RlciBoZXggaWYgcG9zc2libGVcclxuICAgICAgICBpZiAoYWxsb3czQ2hhciAmJiBoZXhbMF0uY2hhckF0KDApID09IGhleFswXS5jaGFyQXQoMSkgJiYgaGV4WzFdLmNoYXJBdCgwKSA9PSBoZXhbMV0uY2hhckF0KDEpICYmIGhleFsyXS5jaGFyQXQoMCkgPT0gaGV4WzJdLmNoYXJBdCgxKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaGV4WzBdLmNoYXJBdCgwKSArIGhleFsxXS5jaGFyQXQoMCkgKyBoZXhbMl0uY2hhckF0KDApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGhleC5qb2luKFwiXCIpO1xyXG4gICAgfVxyXG4gICAgICAgIC8vIGByZ2JhVG9IZXhgXHJcbiAgICAgICAgLy8gQ29udmVydHMgYW4gUkdCQSBjb2xvciBwbHVzIGFscGhhIHRyYW5zcGFyZW5jeSB0byBoZXhcclxuICAgICAgICAvLyBBc3N1bWVzIHIsIGcsIGIgYW5kIGEgYXJlIGNvbnRhaW5lZCBpbiB0aGUgc2V0IFswLCAyNTVdXHJcbiAgICAgICAgLy8gUmV0dXJucyBhbiA4IGNoYXJhY3RlciBoZXhcclxuICAgICAgICBmdW5jdGlvbiByZ2JhVG9IZXgociwgZywgYiwgYSkge1xyXG5cclxuICAgICAgICAgICAgdmFyIGhleCA9IFtcclxuICAgICAgICAgICAgICAgIHBhZDIoY29udmVydERlY2ltYWxUb0hleChhKSksXHJcbiAgICAgICAgICAgICAgICBwYWQyKG1hdGhSb3VuZChyKS50b1N0cmluZygxNikpLFxyXG4gICAgICAgICAgICAgICAgcGFkMihtYXRoUm91bmQoZykudG9TdHJpbmcoMTYpKSxcclxuICAgICAgICAgICAgICAgIHBhZDIobWF0aFJvdW5kKGIpLnRvU3RyaW5nKDE2KSlcclxuICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBoZXguam9pbihcIlwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgLy8gYGVxdWFsc2BcclxuICAgIC8vIENhbiBiZSBjYWxsZWQgd2l0aCBhbnkgdGlueWNvbG9yIGlucHV0XHJcbiAgICB0aW55Y29sb3IuZXF1YWxzID0gZnVuY3Rpb24gKGNvbG9yMSwgY29sb3IyKSB7XHJcbiAgICAgICAgaWYgKCFjb2xvcjEgfHwgIWNvbG9yMikgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGNvbG9yMSkudG9SZ2JTdHJpbmcoKSA9PSB0aW55Y29sb3IoY29sb3IyKS50b1JnYlN0cmluZygpO1xyXG4gICAgfTtcclxuICAgIHRpbnljb2xvci5yYW5kb20gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yLmZyb21SYXRpbyh7XHJcbiAgICAgICAgICAgIHI6IG1hdGhSYW5kb20oKSxcclxuICAgICAgICAgICAgZzogbWF0aFJhbmRvbSgpLFxyXG4gICAgICAgICAgICBiOiBtYXRoUmFuZG9tKClcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG5cclxuICAgIC8vIE1vZGlmaWNhdGlvbiBGdW5jdGlvbnNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFRoYW5rcyB0byBsZXNzLmpzIGZvciBzb21lIG9mIHRoZSBiYXNpY3MgaGVyZVxyXG4gICAgLy8gPGh0dHBzOi8vZ2l0aHViLmNvbS9jbG91ZGhlYWQvbGVzcy5qcy9ibG9iL21hc3Rlci9saWIvbGVzcy9mdW5jdGlvbnMuanM+XHJcblxyXG4gICAgZnVuY3Rpb24gZGVzYXR1cmF0ZShjb2xvciwgYW1vdW50KSB7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA9PT0gMCkgPyAwIDogKGFtb3VudCB8fCAxMCk7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICBoc2wucyAtPSBhbW91bnQgLyAxMDA7XHJcbiAgICAgICAgaHNsLnMgPSBjbGFtcDAxKGhzbC5zKTtcclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGhzbCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2F0dXJhdGUoY29sb3IsIGFtb3VudCkge1xyXG4gICAgICAgIGFtb3VudCA9IChhbW91bnQgPT09IDApID8gMCA6IChhbW91bnQgfHwgMTApO1xyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgaHNsLnMgKz0gYW1vdW50IC8gMTAwO1xyXG4gICAgICAgIGhzbC5zID0gY2xhbXAwMShoc2wucyk7XHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihoc2wpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdyZXlzY2FsZShjb2xvcikge1xyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoY29sb3IpLmRlc2F0dXJhdGUoMTAwKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBsaWdodGVuIChjb2xvciwgYW1vdW50KSB7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA9PT0gMCkgPyAwIDogKGFtb3VudCB8fCAxMCk7XHJcbiAgICAgICAgdmFyIGhzbCA9IHRpbnljb2xvcihjb2xvcikudG9Ic2woKTtcclxuICAgICAgICBoc2wubCArPSBhbW91bnQgLyAxMDA7XHJcbiAgICAgICAgaHNsLmwgPSBjbGFtcDAxKGhzbC5sKTtcclxuICAgICAgICByZXR1cm4gdGlueWNvbG9yKGhzbCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYnJpZ2h0ZW4oY29sb3IsIGFtb3VudCkge1xyXG4gICAgICAgIGFtb3VudCA9IChhbW91bnQgPT09IDApID8gMCA6IChhbW91bnQgfHwgMTApO1xyXG4gICAgICAgIHZhciByZ2IgPSB0aW55Y29sb3IoY29sb3IpLnRvUmdiKCk7XHJcbiAgICAgICAgcmdiLnIgPSBtYXRoTWF4KDAsIG1hdGhNaW4oMjU1LCByZ2IuciAtIG1hdGhSb3VuZCgyNTUgKiAtIChhbW91bnQgLyAxMDApKSkpO1xyXG4gICAgICAgIHJnYi5nID0gbWF0aE1heCgwLCBtYXRoTWluKDI1NSwgcmdiLmcgLSBtYXRoUm91bmQoMjU1ICogLSAoYW1vdW50IC8gMTAwKSkpKTtcclxuICAgICAgICByZ2IuYiA9IG1hdGhNYXgoMCwgbWF0aE1pbigyNTUsIHJnYi5iIC0gbWF0aFJvdW5kKDI1NSAqIC0gKGFtb3VudCAvIDEwMCkpKSk7XHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihyZ2IpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRhcmtlbiAoY29sb3IsIGFtb3VudCkge1xyXG4gICAgICAgIGFtb3VudCA9IChhbW91bnQgPT09IDApID8gMCA6IChhbW91bnQgfHwgMTApO1xyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgaHNsLmwgLT0gYW1vdW50IC8gMTAwO1xyXG4gICAgICAgIGhzbC5sID0gY2xhbXAwMShoc2wubCk7XHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihoc2wpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNwaW4gdGFrZXMgYSBwb3NpdGl2ZSBvciBuZWdhdGl2ZSBhbW91bnQgd2l0aGluIFstMzYwLCAzNjBdIGluZGljYXRpbmcgdGhlIGNoYW5nZSBvZiBodWUuXHJcbiAgICAvLyBWYWx1ZXMgb3V0c2lkZSBvZiB0aGlzIHJhbmdlIHdpbGwgYmUgd3JhcHBlZCBpbnRvIHRoaXMgcmFuZ2UuXHJcbiAgICBmdW5jdGlvbiBzcGluKGNvbG9yLCBhbW91bnQpIHtcclxuICAgICAgICB2YXIgaHNsID0gdGlueWNvbG9yKGNvbG9yKS50b0hzbCgpO1xyXG4gICAgICAgIHZhciBodWUgPSAobWF0aFJvdW5kKGhzbC5oKSArIGFtb3VudCkgJSAzNjA7XHJcbiAgICAgICAgaHNsLmggPSBodWUgPCAwID8gMzYwICsgaHVlIDogaHVlO1xyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoaHNsKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDb21iaW5hdGlvbiBGdW5jdGlvbnNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gVGhhbmtzIHRvIGpRdWVyeSB4Q29sb3IgZm9yIHNvbWUgb2YgdGhlIGlkZWFzIGJlaGluZCB0aGVzZVxyXG4gICAgLy8gPGh0dHBzOi8vZ2l0aHViLmNvbS9pbmZ1c2lvbi9qUXVlcnkteGNvbG9yL2Jsb2IvbWFzdGVyL2pxdWVyeS54Y29sb3IuanM+XHJcblxyXG4gICAgZnVuY3Rpb24gY29tcGxlbWVudChjb2xvcikge1xyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgaHNsLmggPSAoaHNsLmggKyAxODApICUgMzYwO1xyXG4gICAgICAgIHJldHVybiB0aW55Y29sb3IoaHNsKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0cmlhZChjb2xvcikge1xyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgdmFyIGggPSBoc2wuaDtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB0aW55Y29sb3IoY29sb3IpLFxyXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDEyMCkgJSAzNjAsIHM6IGhzbC5zLCBsOiBoc2wubCB9KSxcclxuICAgICAgICAgICAgdGlueWNvbG9yKHsgaDogKGggKyAyNDApICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmwgfSlcclxuICAgICAgICBdO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRldHJhZChjb2xvcikge1xyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgdmFyIGggPSBoc2wuaDtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB0aW55Y29sb3IoY29sb3IpLFxyXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDkwKSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sIH0pLFxyXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDE4MCkgJSAzNjAsIHM6IGhzbC5zLCBsOiBoc2wubCB9KSxcclxuICAgICAgICAgICAgdGlueWNvbG9yKHsgaDogKGggKyAyNzApICUgMzYwLCBzOiBoc2wucywgbDogaHNsLmwgfSlcclxuICAgICAgICBdO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNwbGl0Y29tcGxlbWVudChjb2xvcikge1xyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgdmFyIGggPSBoc2wuaDtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB0aW55Y29sb3IoY29sb3IpLFxyXG4gICAgICAgICAgICB0aW55Y29sb3IoeyBoOiAoaCArIDcyKSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sfSksXHJcbiAgICAgICAgICAgIHRpbnljb2xvcih7IGg6IChoICsgMjE2KSAlIDM2MCwgczogaHNsLnMsIGw6IGhzbC5sfSlcclxuICAgICAgICBdO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFuYWxvZ291cyhjb2xvciwgcmVzdWx0cywgc2xpY2VzKSB7XHJcbiAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMgfHwgNjtcclxuICAgICAgICBzbGljZXMgPSBzbGljZXMgfHwgMzA7XHJcblxyXG4gICAgICAgIHZhciBoc2wgPSB0aW55Y29sb3IoY29sb3IpLnRvSHNsKCk7XHJcbiAgICAgICAgdmFyIHBhcnQgPSAzNjAgLyBzbGljZXM7XHJcbiAgICAgICAgdmFyIHJldCA9IFt0aW55Y29sb3IoY29sb3IpXTtcclxuXHJcbiAgICAgICAgZm9yIChoc2wuaCA9ICgoaHNsLmggLSAocGFydCAqIHJlc3VsdHMgPj4gMSkpICsgNzIwKSAlIDM2MDsgLS1yZXN1bHRzOyApIHtcclxuICAgICAgICAgICAgaHNsLmggPSAoaHNsLmggKyBwYXJ0KSAlIDM2MDtcclxuICAgICAgICAgICAgcmV0LnB1c2godGlueWNvbG9yKGhzbCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmV0O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1vbm9jaHJvbWF0aWMoY29sb3IsIHJlc3VsdHMpIHtcclxuICAgICAgICByZXN1bHRzID0gcmVzdWx0cyB8fCA2O1xyXG4gICAgICAgIHZhciBoc3YgPSB0aW55Y29sb3IoY29sb3IpLnRvSHN2KCk7XHJcbiAgICAgICAgdmFyIGggPSBoc3YuaCwgcyA9IGhzdi5zLCB2ID0gaHN2LnY7XHJcbiAgICAgICAgdmFyIHJldCA9IFtdO1xyXG4gICAgICAgIHZhciBtb2RpZmljYXRpb24gPSAxIC8gcmVzdWx0cztcclxuXHJcbiAgICAgICAgd2hpbGUgKHJlc3VsdHMtLSkge1xyXG4gICAgICAgICAgICByZXQucHVzaCh0aW55Y29sb3IoeyBoOiBoLCBzOiBzLCB2OiB2fSkpO1xyXG4gICAgICAgICAgICB2ID0gKHYgKyBtb2RpZmljYXRpb24pICUgMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXRpbGl0eSBGdW5jdGlvbnNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHRpbnljb2xvci5taXggPSBmdW5jdGlvbihjb2xvcjEsIGNvbG9yMiwgYW1vdW50KSB7XHJcbiAgICAgICAgYW1vdW50ID0gKGFtb3VudCA9PT0gMCkgPyAwIDogKGFtb3VudCB8fCA1MCk7XHJcblxyXG4gICAgICAgIHZhciByZ2IxID0gdGlueWNvbG9yKGNvbG9yMSkudG9SZ2IoKTtcclxuICAgICAgICB2YXIgcmdiMiA9IHRpbnljb2xvcihjb2xvcjIpLnRvUmdiKCk7XHJcblxyXG4gICAgICAgIHZhciBwID0gYW1vdW50IC8gMTAwO1xyXG4gICAgICAgIHZhciB3ID0gcCAqIDIgLSAxO1xyXG4gICAgICAgIHZhciBhID0gcmdiMi5hIC0gcmdiMS5hO1xyXG5cclxuICAgICAgICB2YXIgdzE7XHJcblxyXG4gICAgICAgIGlmICh3ICogYSA9PSAtMSkge1xyXG4gICAgICAgICAgICB3MSA9IHc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdzEgPSAodyArIGEpIC8gKDEgKyB3ICogYSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3MSA9ICh3MSArIDEpIC8gMjtcclxuXHJcbiAgICAgICAgdmFyIHcyID0gMSAtIHcxO1xyXG5cclxuICAgICAgICB2YXIgcmdiYSA9IHtcclxuICAgICAgICAgICAgcjogcmdiMi5yICogdzEgKyByZ2IxLnIgKiB3MixcclxuICAgICAgICAgICAgZzogcmdiMi5nICogdzEgKyByZ2IxLmcgKiB3MixcclxuICAgICAgICAgICAgYjogcmdiMi5iICogdzEgKyByZ2IxLmIgKiB3MixcclxuICAgICAgICAgICAgYTogcmdiMi5hICogcCAgKyByZ2IxLmEgKiAoMSAtIHApXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRpbnljb2xvcihyZ2JhKTtcclxuICAgIH07XHJcblxyXG5cclxuICAgIC8vIFJlYWRhYmlsaXR5IEZ1bmN0aW9uc1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyA8aHR0cDovL3d3dy53My5vcmcvVFIvQUVSVCNjb2xvci1jb250cmFzdD5cclxuXHJcbiAgICAvLyBgcmVhZGFiaWxpdHlgXHJcbiAgICAvLyBBbmFseXplIHRoZSAyIGNvbG9ycyBhbmQgcmV0dXJucyBhbiBvYmplY3Qgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XHJcbiAgICAvLyAgICBgYnJpZ2h0bmVzc2A6IGRpZmZlcmVuY2UgaW4gYnJpZ2h0bmVzcyBiZXR3ZWVuIHRoZSB0d28gY29sb3JzXHJcbiAgICAvLyAgICBgY29sb3JgOiBkaWZmZXJlbmNlIGluIGNvbG9yL2h1ZSBiZXR3ZWVuIHRoZSB0d28gY29sb3JzXHJcbiAgICB0aW55Y29sb3IucmVhZGFiaWxpdHkgPSBmdW5jdGlvbihjb2xvcjEsIGNvbG9yMikge1xyXG4gICAgICAgIHZhciBjMSA9IHRpbnljb2xvcihjb2xvcjEpO1xyXG4gICAgICAgIHZhciBjMiA9IHRpbnljb2xvcihjb2xvcjIpO1xyXG4gICAgICAgIHZhciByZ2IxID0gYzEudG9SZ2IoKTtcclxuICAgICAgICB2YXIgcmdiMiA9IGMyLnRvUmdiKCk7XHJcbiAgICAgICAgdmFyIGJyaWdodG5lc3NBID0gYzEuZ2V0QnJpZ2h0bmVzcygpO1xyXG4gICAgICAgIHZhciBicmlnaHRuZXNzQiA9IGMyLmdldEJyaWdodG5lc3MoKTtcclxuICAgICAgICB2YXIgY29sb3JEaWZmID0gKFxyXG4gICAgICAgICAgICBNYXRoLm1heChyZ2IxLnIsIHJnYjIucikgLSBNYXRoLm1pbihyZ2IxLnIsIHJnYjIucikgK1xyXG4gICAgICAgICAgICBNYXRoLm1heChyZ2IxLmcsIHJnYjIuZykgLSBNYXRoLm1pbihyZ2IxLmcsIHJnYjIuZykgK1xyXG4gICAgICAgICAgICBNYXRoLm1heChyZ2IxLmIsIHJnYjIuYikgLSBNYXRoLm1pbihyZ2IxLmIsIHJnYjIuYilcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBicmlnaHRuZXNzOiBNYXRoLmFicyhicmlnaHRuZXNzQSAtIGJyaWdodG5lc3NCKSxcclxuICAgICAgICAgICAgY29sb3I6IGNvbG9yRGlmZlxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGByZWFkYWJsZWBcclxuICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL0FFUlQjY29sb3ItY29udHJhc3RcclxuICAgIC8vIEVuc3VyZSB0aGF0IGZvcmVncm91bmQgYW5kIGJhY2tncm91bmQgY29sb3IgY29tYmluYXRpb25zIHByb3ZpZGUgc3VmZmljaWVudCBjb250cmFzdC5cclxuICAgIC8vICpFeGFtcGxlKlxyXG4gICAgLy8gICAgdGlueWNvbG9yLmlzUmVhZGFibGUoXCIjMDAwXCIsIFwiIzExMVwiKSA9PiBmYWxzZVxyXG4gICAgdGlueWNvbG9yLmlzUmVhZGFibGUgPSBmdW5jdGlvbihjb2xvcjEsIGNvbG9yMikge1xyXG4gICAgICAgIHZhciByZWFkYWJpbGl0eSA9IHRpbnljb2xvci5yZWFkYWJpbGl0eShjb2xvcjEsIGNvbG9yMik7XHJcbiAgICAgICAgcmV0dXJuIHJlYWRhYmlsaXR5LmJyaWdodG5lc3MgPiAxMjUgJiYgcmVhZGFiaWxpdHkuY29sb3IgPiA1MDA7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIGBtb3N0UmVhZGFibGVgXHJcbiAgICAvLyBHaXZlbiBhIGJhc2UgY29sb3IgYW5kIGEgbGlzdCBvZiBwb3NzaWJsZSBmb3JlZ3JvdW5kIG9yIGJhY2tncm91bmRcclxuICAgIC8vIGNvbG9ycyBmb3IgdGhhdCBiYXNlLCByZXR1cm5zIHRoZSBtb3N0IHJlYWRhYmxlIGNvbG9yLlxyXG4gICAgLy8gKkV4YW1wbGUqXHJcbiAgICAvLyAgICB0aW55Y29sb3IubW9zdFJlYWRhYmxlKFwiIzEyM1wiLCBbXCIjZmZmXCIsIFwiIzAwMFwiXSkgPT4gXCIjMDAwXCJcclxuICAgIHRpbnljb2xvci5tb3N0UmVhZGFibGUgPSBmdW5jdGlvbihiYXNlQ29sb3IsIGNvbG9yTGlzdCkge1xyXG4gICAgICAgIHZhciBiZXN0Q29sb3IgPSBudWxsO1xyXG4gICAgICAgIHZhciBiZXN0U2NvcmUgPSAwO1xyXG4gICAgICAgIHZhciBiZXN0SXNSZWFkYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAodmFyIGk9MDsgaSA8IGNvbG9yTGlzdC5sZW5ndGg7IGkrKykge1xyXG5cclxuICAgICAgICAgICAgLy8gV2Ugbm9ybWFsaXplIGJvdGggYXJvdW5kIHRoZSBcImFjY2VwdGFibGVcIiBicmVha2luZyBwb2ludCxcclxuICAgICAgICAgICAgLy8gYnV0IHJhbmsgYnJpZ2h0bmVzcyBjb25zdHJhc3QgaGlnaGVyIHRoYW4gaHVlLlxyXG5cclxuICAgICAgICAgICAgdmFyIHJlYWRhYmlsaXR5ID0gdGlueWNvbG9yLnJlYWRhYmlsaXR5KGJhc2VDb2xvciwgY29sb3JMaXN0W2ldKTtcclxuICAgICAgICAgICAgdmFyIHJlYWRhYmxlID0gcmVhZGFiaWxpdHkuYnJpZ2h0bmVzcyA+IDEyNSAmJiByZWFkYWJpbGl0eS5jb2xvciA+IDUwMDtcclxuICAgICAgICAgICAgdmFyIHNjb3JlID0gMyAqIChyZWFkYWJpbGl0eS5icmlnaHRuZXNzIC8gMTI1KSArIChyZWFkYWJpbGl0eS5jb2xvciAvIDUwMCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoKHJlYWRhYmxlICYmICEgYmVzdElzUmVhZGFibGUpIHx8XHJcbiAgICAgICAgICAgICAgICAocmVhZGFibGUgJiYgYmVzdElzUmVhZGFibGUgJiYgc2NvcmUgPiBiZXN0U2NvcmUpIHx8XHJcbiAgICAgICAgICAgICAgICAoKCEgcmVhZGFibGUpICYmICghIGJlc3RJc1JlYWRhYmxlKSAmJiBzY29yZSA+IGJlc3RTY29yZSkpIHtcclxuICAgICAgICAgICAgICAgIGJlc3RJc1JlYWRhYmxlID0gcmVhZGFibGU7XHJcbiAgICAgICAgICAgICAgICBiZXN0U2NvcmUgPSBzY29yZTtcclxuICAgICAgICAgICAgICAgIGJlc3RDb2xvciA9IHRpbnljb2xvcihjb2xvckxpc3RbaV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiZXN0Q29sb3I7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAvLyBCaWcgTGlzdCBvZiBDb2xvcnNcclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gPGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtY29sb3IvI3N2Zy1jb2xvcj5cclxuICAgIHZhciBuYW1lcyA9IHRpbnljb2xvci5uYW1lcyA9IHtcclxuICAgICAgICBhbGljZWJsdWU6IFwiZjBmOGZmXCIsXHJcbiAgICAgICAgYW50aXF1ZXdoaXRlOiBcImZhZWJkN1wiLFxyXG4gICAgICAgIGFxdWE6IFwiMGZmXCIsXHJcbiAgICAgICAgYXF1YW1hcmluZTogXCI3ZmZmZDRcIixcclxuICAgICAgICBhenVyZTogXCJmMGZmZmZcIixcclxuICAgICAgICBiZWlnZTogXCJmNWY1ZGNcIixcclxuICAgICAgICBiaXNxdWU6IFwiZmZlNGM0XCIsXHJcbiAgICAgICAgYmxhY2s6IFwiMDAwXCIsXHJcbiAgICAgICAgYmxhbmNoZWRhbG1vbmQ6IFwiZmZlYmNkXCIsXHJcbiAgICAgICAgYmx1ZTogXCIwMGZcIixcclxuICAgICAgICBibHVldmlvbGV0OiBcIjhhMmJlMlwiLFxyXG4gICAgICAgIGJyb3duOiBcImE1MmEyYVwiLFxyXG4gICAgICAgIGJ1cmx5d29vZDogXCJkZWI4ODdcIixcclxuICAgICAgICBidXJudHNpZW5uYTogXCJlYTdlNWRcIixcclxuICAgICAgICBjYWRldGJsdWU6IFwiNWY5ZWEwXCIsXHJcbiAgICAgICAgY2hhcnRyZXVzZTogXCI3ZmZmMDBcIixcclxuICAgICAgICBjaG9jb2xhdGU6IFwiZDI2OTFlXCIsXHJcbiAgICAgICAgY29yYWw6IFwiZmY3ZjUwXCIsXHJcbiAgICAgICAgY29ybmZsb3dlcmJsdWU6IFwiNjQ5NWVkXCIsXHJcbiAgICAgICAgY29ybnNpbGs6IFwiZmZmOGRjXCIsXHJcbiAgICAgICAgY3JpbXNvbjogXCJkYzE0M2NcIixcclxuICAgICAgICBjeWFuOiBcIjBmZlwiLFxyXG4gICAgICAgIGRhcmtibHVlOiBcIjAwMDA4YlwiLFxyXG4gICAgICAgIGRhcmtjeWFuOiBcIjAwOGI4YlwiLFxyXG4gICAgICAgIGRhcmtnb2xkZW5yb2Q6IFwiYjg4NjBiXCIsXHJcbiAgICAgICAgZGFya2dyYXk6IFwiYTlhOWE5XCIsXHJcbiAgICAgICAgZGFya2dyZWVuOiBcIjAwNjQwMFwiLFxyXG4gICAgICAgIGRhcmtncmV5OiBcImE5YTlhOVwiLFxyXG4gICAgICAgIGRhcmtraGFraTogXCJiZGI3NmJcIixcclxuICAgICAgICBkYXJrbWFnZW50YTogXCI4YjAwOGJcIixcclxuICAgICAgICBkYXJrb2xpdmVncmVlbjogXCI1NTZiMmZcIixcclxuICAgICAgICBkYXJrb3JhbmdlOiBcImZmOGMwMFwiLFxyXG4gICAgICAgIGRhcmtvcmNoaWQ6IFwiOTkzMmNjXCIsXHJcbiAgICAgICAgZGFya3JlZDogXCI4YjAwMDBcIixcclxuICAgICAgICBkYXJrc2FsbW9uOiBcImU5OTY3YVwiLFxyXG4gICAgICAgIGRhcmtzZWFncmVlbjogXCI4ZmJjOGZcIixcclxuICAgICAgICBkYXJrc2xhdGVibHVlOiBcIjQ4M2Q4YlwiLFxyXG4gICAgICAgIGRhcmtzbGF0ZWdyYXk6IFwiMmY0ZjRmXCIsXHJcbiAgICAgICAgZGFya3NsYXRlZ3JleTogXCIyZjRmNGZcIixcclxuICAgICAgICBkYXJrdHVycXVvaXNlOiBcIjAwY2VkMVwiLFxyXG4gICAgICAgIGRhcmt2aW9sZXQ6IFwiOTQwMGQzXCIsXHJcbiAgICAgICAgZGVlcHBpbms6IFwiZmYxNDkzXCIsXHJcbiAgICAgICAgZGVlcHNreWJsdWU6IFwiMDBiZmZmXCIsXHJcbiAgICAgICAgZGltZ3JheTogXCI2OTY5NjlcIixcclxuICAgICAgICBkaW1ncmV5OiBcIjY5Njk2OVwiLFxyXG4gICAgICAgIGRvZGdlcmJsdWU6IFwiMWU5MGZmXCIsXHJcbiAgICAgICAgZmlyZWJyaWNrOiBcImIyMjIyMlwiLFxyXG4gICAgICAgIGZsb3JhbHdoaXRlOiBcImZmZmFmMFwiLFxyXG4gICAgICAgIGZvcmVzdGdyZWVuOiBcIjIyOGIyMlwiLFxyXG4gICAgICAgIGZ1Y2hzaWE6IFwiZjBmXCIsXHJcbiAgICAgICAgZ2FpbnNib3JvOiBcImRjZGNkY1wiLFxyXG4gICAgICAgIGdob3N0d2hpdGU6IFwiZjhmOGZmXCIsXHJcbiAgICAgICAgZ29sZDogXCJmZmQ3MDBcIixcclxuICAgICAgICBnb2xkZW5yb2Q6IFwiZGFhNTIwXCIsXHJcbiAgICAgICAgZ3JheTogXCI4MDgwODBcIixcclxuICAgICAgICBncmVlbjogXCIwMDgwMDBcIixcclxuICAgICAgICBncmVlbnllbGxvdzogXCJhZGZmMmZcIixcclxuICAgICAgICBncmV5OiBcIjgwODA4MFwiLFxyXG4gICAgICAgIGhvbmV5ZGV3OiBcImYwZmZmMFwiLFxyXG4gICAgICAgIGhvdHBpbms6IFwiZmY2OWI0XCIsXHJcbiAgICAgICAgaW5kaWFucmVkOiBcImNkNWM1Y1wiLFxyXG4gICAgICAgIGluZGlnbzogXCI0YjAwODJcIixcclxuICAgICAgICBpdm9yeTogXCJmZmZmZjBcIixcclxuICAgICAgICBraGFraTogXCJmMGU2OGNcIixcclxuICAgICAgICBsYXZlbmRlcjogXCJlNmU2ZmFcIixcclxuICAgICAgICBsYXZlbmRlcmJsdXNoOiBcImZmZjBmNVwiLFxyXG4gICAgICAgIGxhd25ncmVlbjogXCI3Y2ZjMDBcIixcclxuICAgICAgICBsZW1vbmNoaWZmb246IFwiZmZmYWNkXCIsXHJcbiAgICAgICAgbGlnaHRibHVlOiBcImFkZDhlNlwiLFxyXG4gICAgICAgIGxpZ2h0Y29yYWw6IFwiZjA4MDgwXCIsXHJcbiAgICAgICAgbGlnaHRjeWFuOiBcImUwZmZmZlwiLFxyXG4gICAgICAgIGxpZ2h0Z29sZGVucm9keWVsbG93OiBcImZhZmFkMlwiLFxyXG4gICAgICAgIGxpZ2h0Z3JheTogXCJkM2QzZDNcIixcclxuICAgICAgICBsaWdodGdyZWVuOiBcIjkwZWU5MFwiLFxyXG4gICAgICAgIGxpZ2h0Z3JleTogXCJkM2QzZDNcIixcclxuICAgICAgICBsaWdodHBpbms6IFwiZmZiNmMxXCIsXHJcbiAgICAgICAgbGlnaHRzYWxtb246IFwiZmZhMDdhXCIsXHJcbiAgICAgICAgbGlnaHRzZWFncmVlbjogXCIyMGIyYWFcIixcclxuICAgICAgICBsaWdodHNreWJsdWU6IFwiODdjZWZhXCIsXHJcbiAgICAgICAgbGlnaHRzbGF0ZWdyYXk6IFwiNzg5XCIsXHJcbiAgICAgICAgbGlnaHRzbGF0ZWdyZXk6IFwiNzg5XCIsXHJcbiAgICAgICAgbGlnaHRzdGVlbGJsdWU6IFwiYjBjNGRlXCIsXHJcbiAgICAgICAgbGlnaHR5ZWxsb3c6IFwiZmZmZmUwXCIsXHJcbiAgICAgICAgbGltZTogXCIwZjBcIixcclxuICAgICAgICBsaW1lZ3JlZW46IFwiMzJjZDMyXCIsXHJcbiAgICAgICAgbGluZW46IFwiZmFmMGU2XCIsXHJcbiAgICAgICAgbWFnZW50YTogXCJmMGZcIixcclxuICAgICAgICBtYXJvb246IFwiODAwMDAwXCIsXHJcbiAgICAgICAgbWVkaXVtYXF1YW1hcmluZTogXCI2NmNkYWFcIixcclxuICAgICAgICBtZWRpdW1ibHVlOiBcIjAwMDBjZFwiLFxyXG4gICAgICAgIG1lZGl1bW9yY2hpZDogXCJiYTU1ZDNcIixcclxuICAgICAgICBtZWRpdW1wdXJwbGU6IFwiOTM3MGRiXCIsXHJcbiAgICAgICAgbWVkaXVtc2VhZ3JlZW46IFwiM2NiMzcxXCIsXHJcbiAgICAgICAgbWVkaXVtc2xhdGVibHVlOiBcIjdiNjhlZVwiLFxyXG4gICAgICAgIG1lZGl1bXNwcmluZ2dyZWVuOiBcIjAwZmE5YVwiLFxyXG4gICAgICAgIG1lZGl1bXR1cnF1b2lzZTogXCI0OGQxY2NcIixcclxuICAgICAgICBtZWRpdW12aW9sZXRyZWQ6IFwiYzcxNTg1XCIsXHJcbiAgICAgICAgbWlkbmlnaHRibHVlOiBcIjE5MTk3MFwiLFxyXG4gICAgICAgIG1pbnRjcmVhbTogXCJmNWZmZmFcIixcclxuICAgICAgICBtaXN0eXJvc2U6IFwiZmZlNGUxXCIsXHJcbiAgICAgICAgbW9jY2FzaW46IFwiZmZlNGI1XCIsXHJcbiAgICAgICAgbmF2YWpvd2hpdGU6IFwiZmZkZWFkXCIsXHJcbiAgICAgICAgbmF2eTogXCIwMDAwODBcIixcclxuICAgICAgICBvbGRsYWNlOiBcImZkZjVlNlwiLFxyXG4gICAgICAgIG9saXZlOiBcIjgwODAwMFwiLFxyXG4gICAgICAgIG9saXZlZHJhYjogXCI2YjhlMjNcIixcclxuICAgICAgICBvcmFuZ2U6IFwiZmZhNTAwXCIsXHJcbiAgICAgICAgb3JhbmdlcmVkOiBcImZmNDUwMFwiLFxyXG4gICAgICAgIG9yY2hpZDogXCJkYTcwZDZcIixcclxuICAgICAgICBwYWxlZ29sZGVucm9kOiBcImVlZThhYVwiLFxyXG4gICAgICAgIHBhbGVncmVlbjogXCI5OGZiOThcIixcclxuICAgICAgICBwYWxldHVycXVvaXNlOiBcImFmZWVlZVwiLFxyXG4gICAgICAgIHBhbGV2aW9sZXRyZWQ6IFwiZGI3MDkzXCIsXHJcbiAgICAgICAgcGFwYXlhd2hpcDogXCJmZmVmZDVcIixcclxuICAgICAgICBwZWFjaHB1ZmY6IFwiZmZkYWI5XCIsXHJcbiAgICAgICAgcGVydTogXCJjZDg1M2ZcIixcclxuICAgICAgICBwaW5rOiBcImZmYzBjYlwiLFxyXG4gICAgICAgIHBsdW06IFwiZGRhMGRkXCIsXHJcbiAgICAgICAgcG93ZGVyYmx1ZTogXCJiMGUwZTZcIixcclxuICAgICAgICBwdXJwbGU6IFwiODAwMDgwXCIsXHJcbiAgICAgICAgcmViZWNjYXB1cnBsZTogXCI2NjMzOTlcIixcclxuICAgICAgICByZWQ6IFwiZjAwXCIsXHJcbiAgICAgICAgcm9zeWJyb3duOiBcImJjOGY4ZlwiLFxyXG4gICAgICAgIHJveWFsYmx1ZTogXCI0MTY5ZTFcIixcclxuICAgICAgICBzYWRkbGVicm93bjogXCI4YjQ1MTNcIixcclxuICAgICAgICBzYWxtb246IFwiZmE4MDcyXCIsXHJcbiAgICAgICAgc2FuZHlicm93bjogXCJmNGE0NjBcIixcclxuICAgICAgICBzZWFncmVlbjogXCIyZThiNTdcIixcclxuICAgICAgICBzZWFzaGVsbDogXCJmZmY1ZWVcIixcclxuICAgICAgICBzaWVubmE6IFwiYTA1MjJkXCIsXHJcbiAgICAgICAgc2lsdmVyOiBcImMwYzBjMFwiLFxyXG4gICAgICAgIHNreWJsdWU6IFwiODdjZWViXCIsXHJcbiAgICAgICAgc2xhdGVibHVlOiBcIjZhNWFjZFwiLFxyXG4gICAgICAgIHNsYXRlZ3JheTogXCI3MDgwOTBcIixcclxuICAgICAgICBzbGF0ZWdyZXk6IFwiNzA4MDkwXCIsXHJcbiAgICAgICAgc25vdzogXCJmZmZhZmFcIixcclxuICAgICAgICBzcHJpbmdncmVlbjogXCIwMGZmN2ZcIixcclxuICAgICAgICBzdGVlbGJsdWU6IFwiNDY4MmI0XCIsXHJcbiAgICAgICAgdGFuOiBcImQyYjQ4Y1wiLFxyXG4gICAgICAgIHRlYWw6IFwiMDA4MDgwXCIsXHJcbiAgICAgICAgdGhpc3RsZTogXCJkOGJmZDhcIixcclxuICAgICAgICB0b21hdG86IFwiZmY2MzQ3XCIsXHJcbiAgICAgICAgdHVycXVvaXNlOiBcIjQwZTBkMFwiLFxyXG4gICAgICAgIHZpb2xldDogXCJlZTgyZWVcIixcclxuICAgICAgICB3aGVhdDogXCJmNWRlYjNcIixcclxuICAgICAgICB3aGl0ZTogXCJmZmZcIixcclxuICAgICAgICB3aGl0ZXNtb2tlOiBcImY1ZjVmNVwiLFxyXG4gICAgICAgIHllbGxvdzogXCJmZjBcIixcclxuICAgICAgICB5ZWxsb3dncmVlbjogXCI5YWNkMzJcIlxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBNYWtlIGl0IGVhc3kgdG8gYWNjZXNzIGNvbG9ycyB2aWEgYGhleE5hbWVzW2hleF1gXHJcbiAgICB2YXIgaGV4TmFtZXMgPSB0aW55Y29sb3IuaGV4TmFtZXMgPSBmbGlwKG5hbWVzKTtcclxuXHJcblxyXG4gICAgLy8gVXRpbGl0aWVzXHJcbiAgICAvLyAtLS0tLS0tLS1cclxuXHJcbiAgICAvLyBgeyAnbmFtZTEnOiAndmFsMScgfWAgYmVjb21lcyBgeyAndmFsMSc6ICduYW1lMScgfWBcclxuICAgIGZ1bmN0aW9uIGZsaXAobykge1xyXG4gICAgICAgIHZhciBmbGlwcGVkID0geyB9O1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gbykge1xyXG4gICAgICAgICAgICBpZiAoby5oYXNPd25Qcm9wZXJ0eShpKSkge1xyXG4gICAgICAgICAgICAgICAgZmxpcHBlZFtvW2ldXSA9IGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZsaXBwZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIGEgdmFsaWQgYWxwaGEgdmFsdWUgWzAsMV0gd2l0aCBhbGwgaW52YWxpZCB2YWx1ZXMgYmVpbmcgc2V0IHRvIDFcclxuICAgIGZ1bmN0aW9uIGJvdW5kQWxwaGEoYSkge1xyXG4gICAgICAgIGEgPSBwYXJzZUZsb2F0KGEpO1xyXG5cclxuICAgICAgICBpZiAoaXNOYU4oYSkgfHwgYSA8IDAgfHwgYSA+IDEpIHtcclxuICAgICAgICAgICAgYSA9IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUYWtlIGlucHV0IGZyb20gWzAsIG5dIGFuZCByZXR1cm4gaXQgYXMgWzAsIDFdXHJcbiAgICBmdW5jdGlvbiBib3VuZDAxKG4sIG1heCkge1xyXG4gICAgICAgIGlmIChpc09uZVBvaW50WmVybyhuKSkgeyBuID0gXCIxMDAlXCI7IH1cclxuXHJcbiAgICAgICAgdmFyIHByb2Nlc3NQZXJjZW50ID0gaXNQZXJjZW50YWdlKG4pO1xyXG4gICAgICAgIG4gPSBtYXRoTWluKG1heCwgbWF0aE1heCgwLCBwYXJzZUZsb2F0KG4pKSk7XHJcblxyXG4gICAgICAgIC8vIEF1dG9tYXRpY2FsbHkgY29udmVydCBwZXJjZW50YWdlIGludG8gbnVtYmVyXHJcbiAgICAgICAgaWYgKHByb2Nlc3NQZXJjZW50KSB7XHJcbiAgICAgICAgICAgIG4gPSBwYXJzZUludChuICogbWF4LCAxMCkgLyAxMDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBIYW5kbGUgZmxvYXRpbmcgcG9pbnQgcm91bmRpbmcgZXJyb3JzXHJcbiAgICAgICAgaWYgKChtYXRoLmFicyhuIC0gbWF4KSA8IDAuMDAwMDAxKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENvbnZlcnQgaW50byBbMCwgMV0gcmFuZ2UgaWYgaXQgaXNuJ3QgYWxyZWFkeVxyXG4gICAgICAgIHJldHVybiAobiAlIG1heCkgLyBwYXJzZUZsb2F0KG1heCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRm9yY2UgYSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxXHJcbiAgICBmdW5jdGlvbiBjbGFtcDAxKHZhbCkge1xyXG4gICAgICAgIHJldHVybiBtYXRoTWluKDEsIG1hdGhNYXgoMCwgdmFsKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUGFyc2UgYSBiYXNlLTE2IGhleCB2YWx1ZSBpbnRvIGEgYmFzZS0xMCBpbnRlZ2VyXHJcbiAgICBmdW5jdGlvbiBwYXJzZUludEZyb21IZXgodmFsKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbCwgMTYpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIE5lZWQgdG8gaGFuZGxlIDEuMCBhcyAxMDAlLCBzaW5jZSBvbmNlIGl0IGlzIGEgbnVtYmVyLCB0aGVyZSBpcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaXQgYW5kIDFcclxuICAgIC8vIDxodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzc0MjIwNzIvamF2YXNjcmlwdC1ob3ctdG8tZGV0ZWN0LW51bWJlci1hcy1hLWRlY2ltYWwtaW5jbHVkaW5nLTEtMD5cclxuICAgIGZ1bmN0aW9uIGlzT25lUG9pbnRaZXJvKG4pIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIG4gPT0gXCJzdHJpbmdcIiAmJiBuLmluZGV4T2YoJy4nKSAhPSAtMSAmJiBwYXJzZUZsb2F0KG4pID09PSAxO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIHRvIHNlZSBpZiBzdHJpbmcgcGFzc2VkIGluIGlzIGEgcGVyY2VudGFnZVxyXG4gICAgZnVuY3Rpb24gaXNQZXJjZW50YWdlKG4pIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIG4gPT09IFwic3RyaW5nXCIgJiYgbi5pbmRleE9mKCclJykgIT0gLTE7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRm9yY2UgYSBoZXggdmFsdWUgdG8gaGF2ZSAyIGNoYXJhY3RlcnNcclxuICAgIGZ1bmN0aW9uIHBhZDIoYykge1xyXG4gICAgICAgIHJldHVybiBjLmxlbmd0aCA9PSAxID8gJzAnICsgYyA6ICcnICsgYztcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXBsYWNlIGEgZGVjaW1hbCB3aXRoIGl0J3MgcGVyY2VudGFnZSB2YWx1ZVxyXG4gICAgZnVuY3Rpb24gY29udmVydFRvUGVyY2VudGFnZShuKSB7XHJcbiAgICAgICAgaWYgKG4gPD0gMSkge1xyXG4gICAgICAgICAgICBuID0gKG4gKiAxMDApICsgXCIlXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDb252ZXJ0cyBhIGRlY2ltYWwgdG8gYSBoZXggdmFsdWVcclxuICAgIGZ1bmN0aW9uIGNvbnZlcnREZWNpbWFsVG9IZXgoZCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHBhcnNlRmxvYXQoZCkgKiAyNTUpLnRvU3RyaW5nKDE2KTtcclxuICAgIH1cclxuICAgIC8vIENvbnZlcnRzIGEgaGV4IHZhbHVlIHRvIGEgZGVjaW1hbFxyXG4gICAgZnVuY3Rpb24gY29udmVydEhleFRvRGVjaW1hbChoKSB7XHJcbiAgICAgICAgcmV0dXJuIChwYXJzZUludEZyb21IZXgoaCkgLyAyNTUpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBtYXRjaGVycyA9IChmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgLy8gPGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtdmFsdWVzLyNpbnRlZ2Vycz5cclxuICAgICAgICB2YXIgQ1NTX0lOVEVHRVIgPSBcIlstXFxcXCtdP1xcXFxkKyU/XCI7XHJcblxyXG4gICAgICAgIC8vIDxodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLXZhbHVlcy8jbnVtYmVyLXZhbHVlPlxyXG4gICAgICAgIHZhciBDU1NfTlVNQkVSID0gXCJbLVxcXFwrXT9cXFxcZCpcXFxcLlxcXFxkKyU/XCI7XHJcblxyXG4gICAgICAgIC8vIEFsbG93IHBvc2l0aXZlL25lZ2F0aXZlIGludGVnZXIvbnVtYmVyLiAgRG9uJ3QgY2FwdHVyZSB0aGUgZWl0aGVyL29yLCBqdXN0IHRoZSBlbnRpcmUgb3V0Y29tZS5cclxuICAgICAgICB2YXIgQ1NTX1VOSVQgPSBcIig/OlwiICsgQ1NTX05VTUJFUiArIFwiKXwoPzpcIiArIENTU19JTlRFR0VSICsgXCIpXCI7XHJcblxyXG4gICAgICAgIC8vIEFjdHVhbCBtYXRjaGluZy5cclxuICAgICAgICAvLyBQYXJlbnRoZXNlcyBhbmQgY29tbWFzIGFyZSBvcHRpb25hbCwgYnV0IG5vdCByZXF1aXJlZC5cclxuICAgICAgICAvLyBXaGl0ZXNwYWNlIGNhbiB0YWtlIHRoZSBwbGFjZSBvZiBjb21tYXMgb3Igb3BlbmluZyBwYXJlblxyXG4gICAgICAgIHZhciBQRVJNSVNTSVZFX01BVENIMyA9IFwiW1xcXFxzfFxcXFwoXSsoXCIgKyBDU1NfVU5JVCArIFwiKVssfFxcXFxzXSsoXCIgKyBDU1NfVU5JVCArIFwiKVssfFxcXFxzXSsoXCIgKyBDU1NfVU5JVCArIFwiKVxcXFxzKlxcXFwpP1wiO1xyXG4gICAgICAgIHZhciBQRVJNSVNTSVZFX01BVENINCA9IFwiW1xcXFxzfFxcXFwoXSsoXCIgKyBDU1NfVU5JVCArIFwiKVssfFxcXFxzXSsoXCIgKyBDU1NfVU5JVCArIFwiKVssfFxcXFxzXSsoXCIgKyBDU1NfVU5JVCArIFwiKVssfFxcXFxzXSsoXCIgKyBDU1NfVU5JVCArIFwiKVxcXFxzKlxcXFwpP1wiO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZ2I6IG5ldyBSZWdFeHAoXCJyZ2JcIiArIFBFUk1JU1NJVkVfTUFUQ0gzKSxcclxuICAgICAgICAgICAgcmdiYTogbmV3IFJlZ0V4cChcInJnYmFcIiArIFBFUk1JU1NJVkVfTUFUQ0g0KSxcclxuICAgICAgICAgICAgaHNsOiBuZXcgUmVnRXhwKFwiaHNsXCIgKyBQRVJNSVNTSVZFX01BVENIMyksXHJcbiAgICAgICAgICAgIGhzbGE6IG5ldyBSZWdFeHAoXCJoc2xhXCIgKyBQRVJNSVNTSVZFX01BVENINCksXHJcbiAgICAgICAgICAgIGhzdjogbmV3IFJlZ0V4cChcImhzdlwiICsgUEVSTUlTU0lWRV9NQVRDSDMpLFxyXG4gICAgICAgICAgICBoc3ZhOiBuZXcgUmVnRXhwKFwiaHN2YVwiICsgUEVSTUlTU0lWRV9NQVRDSDQpLFxyXG4gICAgICAgICAgICBoZXgzOiAvXihbMC05YS1mQS1GXXsxfSkoWzAtOWEtZkEtRl17MX0pKFswLTlhLWZBLUZdezF9KSQvLFxyXG4gICAgICAgICAgICBoZXg2OiAvXihbMC05YS1mQS1GXXsyfSkoWzAtOWEtZkEtRl17Mn0pKFswLTlhLWZBLUZdezJ9KSQvLFxyXG4gICAgICAgICAgICBoZXg4OiAvXihbMC05YS1mQS1GXXsyfSkoWzAtOWEtZkEtRl17Mn0pKFswLTlhLWZBLUZdezJ9KShbMC05YS1mQS1GXXsyfSkkL1xyXG4gICAgICAgIH07XHJcbiAgICB9KSgpO1xyXG5cclxuICAgIC8vIGBzdHJpbmdJbnB1dFRvT2JqZWN0YFxyXG4gICAgLy8gUGVybWlzc2l2ZSBzdHJpbmcgcGFyc2luZy4gIFRha2UgaW4gYSBudW1iZXIgb2YgZm9ybWF0cywgYW5kIG91dHB1dCBhbiBvYmplY3RcclxuICAgIC8vIGJhc2VkIG9uIGRldGVjdGVkIGZvcm1hdC4gIFJldHVybnMgYHsgciwgZywgYiB9YCBvciBgeyBoLCBzLCBsIH1gIG9yIGB7IGgsIHMsIHZ9YFxyXG4gICAgZnVuY3Rpb24gc3RyaW5nSW5wdXRUb09iamVjdChjb2xvcikge1xyXG5cclxuICAgICAgICBjb2xvciA9IGNvbG9yLnJlcGxhY2UodHJpbUxlZnQsJycpLnJlcGxhY2UodHJpbVJpZ2h0LCAnJykudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICB2YXIgbmFtZWQgPSBmYWxzZTtcclxuICAgICAgICBpZiAobmFtZXNbY29sb3JdKSB7XHJcbiAgICAgICAgICAgIGNvbG9yID0gbmFtZXNbY29sb3JdO1xyXG4gICAgICAgICAgICBuYW1lZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNvbG9yID09ICd0cmFuc3BhcmVudCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgcjogMCwgZzogMCwgYjogMCwgYTogMCwgZm9ybWF0OiBcIm5hbWVcIiB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVHJ5IHRvIG1hdGNoIHN0cmluZyBpbnB1dCB1c2luZyByZWd1bGFyIGV4cHJlc3Npb25zLlxyXG4gICAgICAgIC8vIEtlZXAgbW9zdCBvZiB0aGUgbnVtYmVyIGJvdW5kaW5nIG91dCBvZiB0aGlzIGZ1bmN0aW9uIC0gZG9uJ3Qgd29ycnkgYWJvdXQgWzAsMV0gb3IgWzAsMTAwXSBvciBbMCwzNjBdXHJcbiAgICAgICAgLy8gSnVzdCByZXR1cm4gYW4gb2JqZWN0IGFuZCBsZXQgdGhlIGNvbnZlcnNpb24gZnVuY3Rpb25zIGhhbmRsZSB0aGF0LlxyXG4gICAgICAgIC8vIFRoaXMgd2F5IHRoZSByZXN1bHQgd2lsbCBiZSB0aGUgc2FtZSB3aGV0aGVyIHRoZSB0aW55Y29sb3IgaXMgaW5pdGlhbGl6ZWQgd2l0aCBzdHJpbmcgb3Igb2JqZWN0LlxyXG4gICAgICAgIHZhciBtYXRjaDtcclxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMucmdiLmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyByOiBtYXRjaFsxXSwgZzogbWF0Y2hbMl0sIGI6IG1hdGNoWzNdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5yZ2JhLmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyByOiBtYXRjaFsxXSwgZzogbWF0Y2hbMl0sIGI6IG1hdGNoWzNdLCBhOiBtYXRjaFs0XSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMuaHNsLmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBoOiBtYXRjaFsxXSwgczogbWF0Y2hbMl0sIGw6IG1hdGNoWzNdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oc2xhLmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBoOiBtYXRjaFsxXSwgczogbWF0Y2hbMl0sIGw6IG1hdGNoWzNdLCBhOiBtYXRjaFs0XSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMuaHN2LmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBoOiBtYXRjaFsxXSwgczogbWF0Y2hbMl0sIHY6IG1hdGNoWzNdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oc3ZhLmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBoOiBtYXRjaFsxXSwgczogbWF0Y2hbMl0sIHY6IG1hdGNoWzNdLCBhOiBtYXRjaFs0XSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKG1hdGNoID0gbWF0Y2hlcnMuaGV4OC5leGVjKGNvbG9yKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGE6IGNvbnZlcnRIZXhUb0RlY2ltYWwobWF0Y2hbMV0pLFxyXG4gICAgICAgICAgICAgICAgcjogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzJdKSxcclxuICAgICAgICAgICAgICAgIGc6IHBhcnNlSW50RnJvbUhleChtYXRjaFszXSksXHJcbiAgICAgICAgICAgICAgICBiOiBwYXJzZUludEZyb21IZXgobWF0Y2hbNF0pLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBuYW1lZCA/IFwibmFtZVwiIDogXCJoZXg4XCJcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKChtYXRjaCA9IG1hdGNoZXJzLmhleDYuZXhlYyhjb2xvcikpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICByOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMV0pLFxyXG4gICAgICAgICAgICAgICAgZzogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzJdKSxcclxuICAgICAgICAgICAgICAgIGI6IHBhcnNlSW50RnJvbUhleChtYXRjaFszXSksXHJcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IG5hbWVkID8gXCJuYW1lXCIgOiBcImhleFwiXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgobWF0Y2ggPSBtYXRjaGVycy5oZXgzLmV4ZWMoY29sb3IpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcjogcGFyc2VJbnRGcm9tSGV4KG1hdGNoWzFdICsgJycgKyBtYXRjaFsxXSksXHJcbiAgICAgICAgICAgICAgICBnOiBwYXJzZUludEZyb21IZXgobWF0Y2hbMl0gKyAnJyArIG1hdGNoWzJdKSxcclxuICAgICAgICAgICAgICAgIGI6IHBhcnNlSW50RnJvbUhleChtYXRjaFszXSArICcnICsgbWF0Y2hbM10pLFxyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiBuYW1lZCA/IFwibmFtZVwiIDogXCJoZXhcIlxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHdpbmRvdy50aW55Y29sb3IgPSB0aW55Y29sb3I7XHJcbiAgICB9KSgpO1xyXG5cclxuXHJcbiAgICAkKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoJC5mbi5zcGVjdHJ1bS5sb2FkKSB7XHJcbiAgICAgICAgICAgICQuZm4uc3BlY3RydW0ucHJvY2Vzc05hdGl2ZUNvbG9ySW5wdXRzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG59KTtcclxuIiwiLyohIEhhbW1lci5KUyAtIHYyLjAuNCAtIDIwMTQtMDktMjhcclxuICogaHR0cDovL2hhbW1lcmpzLmdpdGh1Yi5pby9cclxuICpcclxuICogQ29weXJpZ2h0IChjKSAyMDE0IEpvcmlrIFRhbmdlbGRlcjtcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlICovXHJcbiFmdW5jdGlvbihhLGIsYyxkKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKGEsYixjKXtyZXR1cm4gc2V0VGltZW91dChrKGEsYyksYil9ZnVuY3Rpb24gZihhLGIsYyl7cmV0dXJuIEFycmF5LmlzQXJyYXkoYSk/KGcoYSxjW2JdLGMpLCEwKTohMX1mdW5jdGlvbiBnKGEsYixjKXt2YXIgZTtpZihhKWlmKGEuZm9yRWFjaClhLmZvckVhY2goYixjKTtlbHNlIGlmKGEubGVuZ3RoIT09ZClmb3IoZT0wO2U8YS5sZW5ndGg7KWIuY2FsbChjLGFbZV0sZSxhKSxlKys7ZWxzZSBmb3IoZSBpbiBhKWEuaGFzT3duUHJvcGVydHkoZSkmJmIuY2FsbChjLGFbZV0sZSxhKX1mdW5jdGlvbiBoKGEsYixjKXtmb3IodmFyIGU9T2JqZWN0LmtleXMoYiksZj0wO2Y8ZS5sZW5ndGg7KSghY3x8YyYmYVtlW2ZdXT09PWQpJiYoYVtlW2ZdXT1iW2VbZl1dKSxmKys7cmV0dXJuIGF9ZnVuY3Rpb24gaShhLGIpe3JldHVybiBoKGEsYiwhMCl9ZnVuY3Rpb24gaihhLGIsYyl7dmFyIGQsZT1iLnByb3RvdHlwZTtkPWEucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoZSksZC5jb25zdHJ1Y3Rvcj1hLGQuX3N1cGVyPWUsYyYmaChkLGMpfWZ1bmN0aW9uIGsoYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShiLGFyZ3VtZW50cyl9fWZ1bmN0aW9uIGwoYSxiKXtyZXR1cm4gdHlwZW9mIGE9PWtiP2EuYXBwbHkoYj9iWzBdfHxkOmQsYik6YX1mdW5jdGlvbiBtKGEsYil7cmV0dXJuIGE9PT1kP2I6YX1mdW5jdGlvbiBuKGEsYixjKXtnKHIoYiksZnVuY3Rpb24oYil7YS5hZGRFdmVudExpc3RlbmVyKGIsYywhMSl9KX1mdW5jdGlvbiBvKGEsYixjKXtnKHIoYiksZnVuY3Rpb24oYil7YS5yZW1vdmVFdmVudExpc3RlbmVyKGIsYywhMSl9KX1mdW5jdGlvbiBwKGEsYil7Zm9yKDthOyl7aWYoYT09YilyZXR1cm4hMDthPWEucGFyZW50Tm9kZX1yZXR1cm4hMX1mdW5jdGlvbiBxKGEsYil7cmV0dXJuIGEuaW5kZXhPZihiKT4tMX1mdW5jdGlvbiByKGEpe3JldHVybiBhLnRyaW0oKS5zcGxpdCgvXFxzKy9nKX1mdW5jdGlvbiBzKGEsYixjKXtpZihhLmluZGV4T2YmJiFjKXJldHVybiBhLmluZGV4T2YoYik7Zm9yKHZhciBkPTA7ZDxhLmxlbmd0aDspe2lmKGMmJmFbZF1bY109PWJ8fCFjJiZhW2RdPT09YilyZXR1cm4gZDtkKyt9cmV0dXJuLTF9ZnVuY3Rpb24gdChhKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYSwwKX1mdW5jdGlvbiB1KGEsYixjKXtmb3IodmFyIGQ9W10sZT1bXSxmPTA7ZjxhLmxlbmd0aDspe3ZhciBnPWI/YVtmXVtiXTphW2ZdO3MoZSxnKTwwJiZkLnB1c2goYVtmXSksZVtmXT1nLGYrK31yZXR1cm4gYyYmKGQ9Yj9kLnNvcnQoZnVuY3Rpb24oYSxjKXtyZXR1cm4gYVtiXT5jW2JdfSk6ZC5zb3J0KCkpLGR9ZnVuY3Rpb24gdihhLGIpe2Zvcih2YXIgYyxlLGY9YlswXS50b1VwcGVyQ2FzZSgpK2Iuc2xpY2UoMSksZz0wO2c8aWIubGVuZ3RoOyl7aWYoYz1pYltnXSxlPWM/YytmOmIsZSBpbiBhKXJldHVybiBlO2crK31yZXR1cm4gZH1mdW5jdGlvbiB3KCl7cmV0dXJuIG9iKyt9ZnVuY3Rpb24geChhKXt2YXIgYj1hLm93bmVyRG9jdW1lbnQ7cmV0dXJuIGIuZGVmYXVsdFZpZXd8fGIucGFyZW50V2luZG93fWZ1bmN0aW9uIHkoYSxiKXt2YXIgYz10aGlzO3RoaXMubWFuYWdlcj1hLHRoaXMuY2FsbGJhY2s9Yix0aGlzLmVsZW1lbnQ9YS5lbGVtZW50LHRoaXMudGFyZ2V0PWEub3B0aW9ucy5pbnB1dFRhcmdldCx0aGlzLmRvbUhhbmRsZXI9ZnVuY3Rpb24oYil7bChhLm9wdGlvbnMuZW5hYmxlLFthXSkmJmMuaGFuZGxlcihiKX0sdGhpcy5pbml0KCl9ZnVuY3Rpb24geihhKXt2YXIgYixjPWEub3B0aW9ucy5pbnB1dENsYXNzO3JldHVybiBuZXcoYj1jP2M6cmI/TjpzYj9ROnFiP1M6TSkoYSxBKX1mdW5jdGlvbiBBKGEsYixjKXt2YXIgZD1jLnBvaW50ZXJzLmxlbmd0aCxlPWMuY2hhbmdlZFBvaW50ZXJzLmxlbmd0aCxmPWImeWImJmQtZT09PTAsZz1iJihBYnxCYikmJmQtZT09PTA7Yy5pc0ZpcnN0PSEhZixjLmlzRmluYWw9ISFnLGYmJihhLnNlc3Npb249e30pLGMuZXZlbnRUeXBlPWIsQihhLGMpLGEuZW1pdChcImhhbW1lci5pbnB1dFwiLGMpLGEucmVjb2duaXplKGMpLGEuc2Vzc2lvbi5wcmV2SW5wdXQ9Y31mdW5jdGlvbiBCKGEsYil7dmFyIGM9YS5zZXNzaW9uLGQ9Yi5wb2ludGVycyxlPWQubGVuZ3RoO2MuZmlyc3RJbnB1dHx8KGMuZmlyc3RJbnB1dD1FKGIpKSxlPjEmJiFjLmZpcnN0TXVsdGlwbGU/Yy5maXJzdE11bHRpcGxlPUUoYik6MT09PWUmJihjLmZpcnN0TXVsdGlwbGU9ITEpO3ZhciBmPWMuZmlyc3RJbnB1dCxnPWMuZmlyc3RNdWx0aXBsZSxoPWc/Zy5jZW50ZXI6Zi5jZW50ZXIsaT1iLmNlbnRlcj1GKGQpO2IudGltZVN0YW1wPW5iKCksYi5kZWx0YVRpbWU9Yi50aW1lU3RhbXAtZi50aW1lU3RhbXAsYi5hbmdsZT1KKGgsaSksYi5kaXN0YW5jZT1JKGgsaSksQyhjLGIpLGIub2Zmc2V0RGlyZWN0aW9uPUgoYi5kZWx0YVgsYi5kZWx0YVkpLGIuc2NhbGU9Zz9MKGcucG9pbnRlcnMsZCk6MSxiLnJvdGF0aW9uPWc/SyhnLnBvaW50ZXJzLGQpOjAsRChjLGIpO3ZhciBqPWEuZWxlbWVudDtwKGIuc3JjRXZlbnQudGFyZ2V0LGopJiYoaj1iLnNyY0V2ZW50LnRhcmdldCksYi50YXJnZXQ9an1mdW5jdGlvbiBDKGEsYil7dmFyIGM9Yi5jZW50ZXIsZD1hLm9mZnNldERlbHRhfHx7fSxlPWEucHJldkRlbHRhfHx7fSxmPWEucHJldklucHV0fHx7fTsoYi5ldmVudFR5cGU9PT15Ynx8Zi5ldmVudFR5cGU9PT1BYikmJihlPWEucHJldkRlbHRhPXt4OmYuZGVsdGFYfHwwLHk6Zi5kZWx0YVl8fDB9LGQ9YS5vZmZzZXREZWx0YT17eDpjLngseTpjLnl9KSxiLmRlbHRhWD1lLngrKGMueC1kLngpLGIuZGVsdGFZPWUueSsoYy55LWQueSl9ZnVuY3Rpb24gRChhLGIpe3ZhciBjLGUsZixnLGg9YS5sYXN0SW50ZXJ2YWx8fGIsaT1iLnRpbWVTdGFtcC1oLnRpbWVTdGFtcDtpZihiLmV2ZW50VHlwZSE9QmImJihpPnhifHxoLnZlbG9jaXR5PT09ZCkpe3ZhciBqPWguZGVsdGFYLWIuZGVsdGFYLGs9aC5kZWx0YVktYi5kZWx0YVksbD1HKGksaixrKTtlPWwueCxmPWwueSxjPW1iKGwueCk+bWIobC55KT9sLng6bC55LGc9SChqLGspLGEubGFzdEludGVydmFsPWJ9ZWxzZSBjPWgudmVsb2NpdHksZT1oLnZlbG9jaXR5WCxmPWgudmVsb2NpdHlZLGc9aC5kaXJlY3Rpb247Yi52ZWxvY2l0eT1jLGIudmVsb2NpdHlYPWUsYi52ZWxvY2l0eVk9ZixiLmRpcmVjdGlvbj1nfWZ1bmN0aW9uIEUoYSl7Zm9yKHZhciBiPVtdLGM9MDtjPGEucG9pbnRlcnMubGVuZ3RoOyliW2NdPXtjbGllbnRYOmxiKGEucG9pbnRlcnNbY10uY2xpZW50WCksY2xpZW50WTpsYihhLnBvaW50ZXJzW2NdLmNsaWVudFkpfSxjKys7cmV0dXJue3RpbWVTdGFtcDpuYigpLHBvaW50ZXJzOmIsY2VudGVyOkYoYiksZGVsdGFYOmEuZGVsdGFYLGRlbHRhWTphLmRlbHRhWX19ZnVuY3Rpb24gRihhKXt2YXIgYj1hLmxlbmd0aDtpZigxPT09YilyZXR1cm57eDpsYihhWzBdLmNsaWVudFgpLHk6bGIoYVswXS5jbGllbnRZKX07Zm9yKHZhciBjPTAsZD0wLGU9MDtiPmU7KWMrPWFbZV0uY2xpZW50WCxkKz1hW2VdLmNsaWVudFksZSsrO3JldHVybnt4OmxiKGMvYikseTpsYihkL2IpfX1mdW5jdGlvbiBHKGEsYixjKXtyZXR1cm57eDpiL2F8fDAseTpjL2F8fDB9fWZ1bmN0aW9uIEgoYSxiKXtyZXR1cm4gYT09PWI/Q2I6bWIoYSk+PW1iKGIpP2E+MD9EYjpFYjpiPjA/RmI6R2J9ZnVuY3Rpb24gSShhLGIsYyl7Y3x8KGM9S2IpO3ZhciBkPWJbY1swXV0tYVtjWzBdXSxlPWJbY1sxXV0tYVtjWzFdXTtyZXR1cm4gTWF0aC5zcXJ0KGQqZCtlKmUpfWZ1bmN0aW9uIEooYSxiLGMpe2N8fChjPUtiKTt2YXIgZD1iW2NbMF1dLWFbY1swXV0sZT1iW2NbMV1dLWFbY1sxXV07cmV0dXJuIDE4MCpNYXRoLmF0YW4yKGUsZCkvTWF0aC5QSX1mdW5jdGlvbiBLKGEsYil7cmV0dXJuIEooYlsxXSxiWzBdLExiKS1KKGFbMV0sYVswXSxMYil9ZnVuY3Rpb24gTChhLGIpe3JldHVybiBJKGJbMF0sYlsxXSxMYikvSShhWzBdLGFbMV0sTGIpfWZ1bmN0aW9uIE0oKXt0aGlzLmV2RWw9TmIsdGhpcy5ldldpbj1PYix0aGlzLmFsbG93PSEwLHRoaXMucHJlc3NlZD0hMSx5LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBOKCl7dGhpcy5ldkVsPVJiLHRoaXMuZXZXaW49U2IseS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5zdG9yZT10aGlzLm1hbmFnZXIuc2Vzc2lvbi5wb2ludGVyRXZlbnRzPVtdfWZ1bmN0aW9uIE8oKXt0aGlzLmV2VGFyZ2V0PVViLHRoaXMuZXZXaW49VmIsdGhpcy5zdGFydGVkPSExLHkuYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIFAoYSxiKXt2YXIgYz10KGEudG91Y2hlcyksZD10KGEuY2hhbmdlZFRvdWNoZXMpO3JldHVybiBiJihBYnxCYikmJihjPXUoYy5jb25jYXQoZCksXCJpZGVudGlmaWVyXCIsITApKSxbYyxkXX1mdW5jdGlvbiBRKCl7dGhpcy5ldlRhcmdldD1YYix0aGlzLnRhcmdldElkcz17fSx5LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBSKGEsYil7dmFyIGM9dChhLnRvdWNoZXMpLGQ9dGhpcy50YXJnZXRJZHM7aWYoYiYoeWJ8emIpJiYxPT09Yy5sZW5ndGgpcmV0dXJuIGRbY1swXS5pZGVudGlmaWVyXT0hMCxbYyxjXTt2YXIgZSxmLGc9dChhLmNoYW5nZWRUb3VjaGVzKSxoPVtdLGk9dGhpcy50YXJnZXQ7aWYoZj1jLmZpbHRlcihmdW5jdGlvbihhKXtyZXR1cm4gcChhLnRhcmdldCxpKX0pLGI9PT15Yilmb3IoZT0wO2U8Zi5sZW5ndGg7KWRbZltlXS5pZGVudGlmaWVyXT0hMCxlKys7Zm9yKGU9MDtlPGcubGVuZ3RoOylkW2dbZV0uaWRlbnRpZmllcl0mJmgucHVzaChnW2VdKSxiJihBYnxCYikmJmRlbGV0ZSBkW2dbZV0uaWRlbnRpZmllcl0sZSsrO3JldHVybiBoLmxlbmd0aD9bdShmLmNvbmNhdChoKSxcImlkZW50aWZpZXJcIiwhMCksaF06dm9pZCAwfWZ1bmN0aW9uIFMoKXt5LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgYT1rKHRoaXMuaGFuZGxlcix0aGlzKTt0aGlzLnRvdWNoPW5ldyBRKHRoaXMubWFuYWdlcixhKSx0aGlzLm1vdXNlPW5ldyBNKHRoaXMubWFuYWdlcixhKX1mdW5jdGlvbiBUKGEsYil7dGhpcy5tYW5hZ2VyPWEsdGhpcy5zZXQoYil9ZnVuY3Rpb24gVShhKXtpZihxKGEsYmMpKXJldHVybiBiYzt2YXIgYj1xKGEsY2MpLGM9cShhLGRjKTtyZXR1cm4gYiYmYz9jYytcIiBcIitkYzpifHxjP2I/Y2M6ZGM6cShhLGFjKT9hYzpfYn1mdW5jdGlvbiBWKGEpe3RoaXMuaWQ9dygpLHRoaXMubWFuYWdlcj1udWxsLHRoaXMub3B0aW9ucz1pKGF8fHt9LHRoaXMuZGVmYXVsdHMpLHRoaXMub3B0aW9ucy5lbmFibGU9bSh0aGlzLm9wdGlvbnMuZW5hYmxlLCEwKSx0aGlzLnN0YXRlPWVjLHRoaXMuc2ltdWx0YW5lb3VzPXt9LHRoaXMucmVxdWlyZUZhaWw9W119ZnVuY3Rpb24gVyhhKXtyZXR1cm4gYSZqYz9cImNhbmNlbFwiOmEmaGM/XCJlbmRcIjphJmdjP1wibW92ZVwiOmEmZmM/XCJzdGFydFwiOlwiXCJ9ZnVuY3Rpb24gWChhKXtyZXR1cm4gYT09R2I/XCJkb3duXCI6YT09RmI/XCJ1cFwiOmE9PURiP1wibGVmdFwiOmE9PUViP1wicmlnaHRcIjpcIlwifWZ1bmN0aW9uIFkoYSxiKXt2YXIgYz1iLm1hbmFnZXI7cmV0dXJuIGM/Yy5nZXQoYSk6YX1mdW5jdGlvbiBaKCl7Vi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gJCgpe1ouYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMucFg9bnVsbCx0aGlzLnBZPW51bGx9ZnVuY3Rpb24gXygpe1ouYXBwbHkodGhpcyxhcmd1bWVudHMpfWZ1bmN0aW9uIGFiKCl7Vi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fdGltZXI9bnVsbCx0aGlzLl9pbnB1dD1udWxsfWZ1bmN0aW9uIGJiKCl7Wi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gY2IoKXtaLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBkYigpe1YuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMucFRpbWU9ITEsdGhpcy5wQ2VudGVyPSExLHRoaXMuX3RpbWVyPW51bGwsdGhpcy5faW5wdXQ9bnVsbCx0aGlzLmNvdW50PTB9ZnVuY3Rpb24gZWIoYSxiKXtyZXR1cm4gYj1ifHx7fSxiLnJlY29nbml6ZXJzPW0oYi5yZWNvZ25pemVycyxlYi5kZWZhdWx0cy5wcmVzZXQpLG5ldyBmYihhLGIpfWZ1bmN0aW9uIGZiKGEsYil7Yj1ifHx7fSx0aGlzLm9wdGlvbnM9aShiLGViLmRlZmF1bHRzKSx0aGlzLm9wdGlvbnMuaW5wdXRUYXJnZXQ9dGhpcy5vcHRpb25zLmlucHV0VGFyZ2V0fHxhLHRoaXMuaGFuZGxlcnM9e30sdGhpcy5zZXNzaW9uPXt9LHRoaXMucmVjb2duaXplcnM9W10sdGhpcy5lbGVtZW50PWEsdGhpcy5pbnB1dD16KHRoaXMpLHRoaXMudG91Y2hBY3Rpb249bmV3IFQodGhpcyx0aGlzLm9wdGlvbnMudG91Y2hBY3Rpb24pLGdiKHRoaXMsITApLGcoYi5yZWNvZ25pemVycyxmdW5jdGlvbihhKXt2YXIgYj10aGlzLmFkZChuZXcgYVswXShhWzFdKSk7YVsyXSYmYi5yZWNvZ25pemVXaXRoKGFbMl0pLGFbM10mJmIucmVxdWlyZUZhaWx1cmUoYVszXSl9LHRoaXMpfWZ1bmN0aW9uIGdiKGEsYil7dmFyIGM9YS5lbGVtZW50O2coYS5vcHRpb25zLmNzc1Byb3BzLGZ1bmN0aW9uKGEsZCl7Yy5zdHlsZVt2KGMuc3R5bGUsZCldPWI/YTpcIlwifSl9ZnVuY3Rpb24gaGIoYSxjKXt2YXIgZD1iLmNyZWF0ZUV2ZW50KFwiRXZlbnRcIik7ZC5pbml0RXZlbnQoYSwhMCwhMCksZC5nZXN0dXJlPWMsYy50YXJnZXQuZGlzcGF0Y2hFdmVudChkKX12YXIgaWI9W1wiXCIsXCJ3ZWJraXRcIixcIm1velwiLFwiTVNcIixcIm1zXCIsXCJvXCJdLGpiPWIuY3JlYXRlRWxlbWVudChcImRpdlwiKSxrYj1cImZ1bmN0aW9uXCIsbGI9TWF0aC5yb3VuZCxtYj1NYXRoLmFicyxuYj1EYXRlLm5vdyxvYj0xLHBiPS9tb2JpbGV8dGFibGV0fGlwKGFkfGhvbmV8b2QpfGFuZHJvaWQvaSxxYj1cIm9udG91Y2hzdGFydFwiaW4gYSxyYj12KGEsXCJQb2ludGVyRXZlbnRcIikhPT1kLHNiPXFiJiZwYi50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLHRiPVwidG91Y2hcIix1Yj1cInBlblwiLHZiPVwibW91c2VcIix3Yj1cImtpbmVjdFwiLHhiPTI1LHliPTEsemI9MixBYj00LEJiPTgsQ2I9MSxEYj0yLEViPTQsRmI9OCxHYj0xNixIYj1EYnxFYixJYj1GYnxHYixKYj1IYnxJYixLYj1bXCJ4XCIsXCJ5XCJdLExiPVtcImNsaWVudFhcIixcImNsaWVudFlcIl07eS5wcm90b3R5cGU9e2hhbmRsZXI6ZnVuY3Rpb24oKXt9LGluaXQ6ZnVuY3Rpb24oKXt0aGlzLmV2RWwmJm4odGhpcy5lbGVtZW50LHRoaXMuZXZFbCx0aGlzLmRvbUhhbmRsZXIpLHRoaXMuZXZUYXJnZXQmJm4odGhpcy50YXJnZXQsdGhpcy5ldlRhcmdldCx0aGlzLmRvbUhhbmRsZXIpLHRoaXMuZXZXaW4mJm4oeCh0aGlzLmVsZW1lbnQpLHRoaXMuZXZXaW4sdGhpcy5kb21IYW5kbGVyKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZXZFbCYmbyh0aGlzLmVsZW1lbnQsdGhpcy5ldkVsLHRoaXMuZG9tSGFuZGxlciksdGhpcy5ldlRhcmdldCYmbyh0aGlzLnRhcmdldCx0aGlzLmV2VGFyZ2V0LHRoaXMuZG9tSGFuZGxlciksdGhpcy5ldldpbiYmbyh4KHRoaXMuZWxlbWVudCksdGhpcy5ldldpbix0aGlzLmRvbUhhbmRsZXIpfX07dmFyIE1iPXttb3VzZWRvd246eWIsbW91c2Vtb3ZlOnpiLG1vdXNldXA6QWJ9LE5iPVwibW91c2Vkb3duXCIsT2I9XCJtb3VzZW1vdmUgbW91c2V1cFwiO2ooTSx5LHtoYW5kbGVyOmZ1bmN0aW9uKGEpe3ZhciBiPU1iW2EudHlwZV07YiZ5YiYmMD09PWEuYnV0dG9uJiYodGhpcy5wcmVzc2VkPSEwKSxiJnpiJiYxIT09YS53aGljaCYmKGI9QWIpLHRoaXMucHJlc3NlZCYmdGhpcy5hbGxvdyYmKGImQWImJih0aGlzLnByZXNzZWQ9ITEpLHRoaXMuY2FsbGJhY2sodGhpcy5tYW5hZ2VyLGIse3BvaW50ZXJzOlthXSxjaGFuZ2VkUG9pbnRlcnM6W2FdLHBvaW50ZXJUeXBlOnZiLHNyY0V2ZW50OmF9KSl9fSk7dmFyIFBiPXtwb2ludGVyZG93bjp5Yixwb2ludGVybW92ZTp6Yixwb2ludGVydXA6QWIscG9pbnRlcmNhbmNlbDpCYixwb2ludGVyb3V0OkJifSxRYj17Mjp0YiwzOnViLDQ6dmIsNTp3Yn0sUmI9XCJwb2ludGVyZG93blwiLFNiPVwicG9pbnRlcm1vdmUgcG9pbnRlcnVwIHBvaW50ZXJjYW5jZWxcIjthLk1TUG9pbnRlckV2ZW50JiYoUmI9XCJNU1BvaW50ZXJEb3duXCIsU2I9XCJNU1BvaW50ZXJNb3ZlIE1TUG9pbnRlclVwIE1TUG9pbnRlckNhbmNlbFwiKSxqKE4seSx7aGFuZGxlcjpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnN0b3JlLGM9ITEsZD1hLnR5cGUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKFwibXNcIixcIlwiKSxlPVBiW2RdLGY9UWJbYS5wb2ludGVyVHlwZV18fGEucG9pbnRlclR5cGUsZz1mPT10YixoPXMoYixhLnBvaW50ZXJJZCxcInBvaW50ZXJJZFwiKTtlJnliJiYoMD09PWEuYnV0dG9ufHxnKT8wPmgmJihiLnB1c2goYSksaD1iLmxlbmd0aC0xKTplJihBYnxCYikmJihjPSEwKSwwPmh8fChiW2hdPWEsdGhpcy5jYWxsYmFjayh0aGlzLm1hbmFnZXIsZSx7cG9pbnRlcnM6YixjaGFuZ2VkUG9pbnRlcnM6W2FdLHBvaW50ZXJUeXBlOmYsc3JjRXZlbnQ6YX0pLGMmJmIuc3BsaWNlKGgsMSkpfX0pO3ZhciBUYj17dG91Y2hzdGFydDp5Yix0b3VjaG1vdmU6emIsdG91Y2hlbmQ6QWIsdG91Y2hjYW5jZWw6QmJ9LFViPVwidG91Y2hzdGFydFwiLFZiPVwidG91Y2hzdGFydCB0b3VjaG1vdmUgdG91Y2hlbmQgdG91Y2hjYW5jZWxcIjtqKE8seSx7aGFuZGxlcjpmdW5jdGlvbihhKXt2YXIgYj1UYlthLnR5cGVdO2lmKGI9PT15YiYmKHRoaXMuc3RhcnRlZD0hMCksdGhpcy5zdGFydGVkKXt2YXIgYz1QLmNhbGwodGhpcyxhLGIpO2ImKEFifEJiKSYmY1swXS5sZW5ndGgtY1sxXS5sZW5ndGg9PT0wJiYodGhpcy5zdGFydGVkPSExKSx0aGlzLmNhbGxiYWNrKHRoaXMubWFuYWdlcixiLHtwb2ludGVyczpjWzBdLGNoYW5nZWRQb2ludGVyczpjWzFdLHBvaW50ZXJUeXBlOnRiLHNyY0V2ZW50OmF9KX19fSk7dmFyIFdiPXt0b3VjaHN0YXJ0OnliLHRvdWNobW92ZTp6Yix0b3VjaGVuZDpBYix0b3VjaGNhbmNlbDpCYn0sWGI9XCJ0b3VjaHN0YXJ0IHRvdWNobW92ZSB0b3VjaGVuZCB0b3VjaGNhbmNlbFwiO2ooUSx5LHtoYW5kbGVyOmZ1bmN0aW9uKGEpe3ZhciBiPVdiW2EudHlwZV0sYz1SLmNhbGwodGhpcyxhLGIpO2MmJnRoaXMuY2FsbGJhY2sodGhpcy5tYW5hZ2VyLGIse3BvaW50ZXJzOmNbMF0sY2hhbmdlZFBvaW50ZXJzOmNbMV0scG9pbnRlclR5cGU6dGIsc3JjRXZlbnQ6YX0pfX0pLGooUyx5LHtoYW5kbGVyOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1jLnBvaW50ZXJUeXBlPT10YixlPWMucG9pbnRlclR5cGU9PXZiO2lmKGQpdGhpcy5tb3VzZS5hbGxvdz0hMTtlbHNlIGlmKGUmJiF0aGlzLm1vdXNlLmFsbG93KXJldHVybjtiJihBYnxCYikmJih0aGlzLm1vdXNlLmFsbG93PSEwKSx0aGlzLmNhbGxiYWNrKGEsYixjKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMudG91Y2guZGVzdHJveSgpLHRoaXMubW91c2UuZGVzdHJveSgpfX0pO3ZhciBZYj12KGpiLnN0eWxlLFwidG91Y2hBY3Rpb25cIiksWmI9WWIhPT1kLCRiPVwiY29tcHV0ZVwiLF9iPVwiYXV0b1wiLGFjPVwibWFuaXB1bGF0aW9uXCIsYmM9XCJub25lXCIsY2M9XCJwYW4teFwiLGRjPVwicGFuLXlcIjtULnByb3RvdHlwZT17c2V0OmZ1bmN0aW9uKGEpe2E9PSRiJiYoYT10aGlzLmNvbXB1dGUoKSksWmImJih0aGlzLm1hbmFnZXIuZWxlbWVudC5zdHlsZVtZYl09YSksdGhpcy5hY3Rpb25zPWEudG9Mb3dlckNhc2UoKS50cmltKCl9LHVwZGF0ZTpmdW5jdGlvbigpe3RoaXMuc2V0KHRoaXMubWFuYWdlci5vcHRpb25zLnRvdWNoQWN0aW9uKX0sY29tcHV0ZTpmdW5jdGlvbigpe3ZhciBhPVtdO3JldHVybiBnKHRoaXMubWFuYWdlci5yZWNvZ25pemVycyxmdW5jdGlvbihiKXtsKGIub3B0aW9ucy5lbmFibGUsW2JdKSYmKGE9YS5jb25jYXQoYi5nZXRUb3VjaEFjdGlvbigpKSl9KSxVKGEuam9pbihcIiBcIikpfSxwcmV2ZW50RGVmYXVsdHM6ZnVuY3Rpb24oYSl7aWYoIVpiKXt2YXIgYj1hLnNyY0V2ZW50LGM9YS5vZmZzZXREaXJlY3Rpb247aWYodGhpcy5tYW5hZ2VyLnNlc3Npb24ucHJldmVudGVkKXJldHVybiB2b2lkIGIucHJldmVudERlZmF1bHQoKTt2YXIgZD10aGlzLmFjdGlvbnMsZT1xKGQsYmMpLGY9cShkLGRjKSxnPXEoZCxjYyk7cmV0dXJuIGV8fGYmJmMmSGJ8fGcmJmMmSWI/dGhpcy5wcmV2ZW50U3JjKGIpOnZvaWQgMH19LHByZXZlbnRTcmM6ZnVuY3Rpb24oYSl7dGhpcy5tYW5hZ2VyLnNlc3Npb24ucHJldmVudGVkPSEwLGEucHJldmVudERlZmF1bHQoKX19O3ZhciBlYz0xLGZjPTIsZ2M9NCxoYz04LGljPWhjLGpjPTE2LGtjPTMyO1YucHJvdG90eXBlPXtkZWZhdWx0czp7fSxzZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGgodGhpcy5vcHRpb25zLGEpLHRoaXMubWFuYWdlciYmdGhpcy5tYW5hZ2VyLnRvdWNoQWN0aW9uLnVwZGF0ZSgpLHRoaXN9LHJlY29nbml6ZVdpdGg6ZnVuY3Rpb24oYSl7aWYoZihhLFwicmVjb2duaXplV2l0aFwiLHRoaXMpKXJldHVybiB0aGlzO3ZhciBiPXRoaXMuc2ltdWx0YW5lb3VzO3JldHVybiBhPVkoYSx0aGlzKSxiW2EuaWRdfHwoYlthLmlkXT1hLGEucmVjb2duaXplV2l0aCh0aGlzKSksdGhpc30sZHJvcFJlY29nbml6ZVdpdGg6ZnVuY3Rpb24oYSl7cmV0dXJuIGYoYSxcImRyb3BSZWNvZ25pemVXaXRoXCIsdGhpcyk/dGhpczooYT1ZKGEsdGhpcyksZGVsZXRlIHRoaXMuc2ltdWx0YW5lb3VzW2EuaWRdLHRoaXMpfSxyZXF1aXJlRmFpbHVyZTpmdW5jdGlvbihhKXtpZihmKGEsXCJyZXF1aXJlRmFpbHVyZVwiLHRoaXMpKXJldHVybiB0aGlzO3ZhciBiPXRoaXMucmVxdWlyZUZhaWw7cmV0dXJuIGE9WShhLHRoaXMpLC0xPT09cyhiLGEpJiYoYi5wdXNoKGEpLGEucmVxdWlyZUZhaWx1cmUodGhpcykpLHRoaXN9LGRyb3BSZXF1aXJlRmFpbHVyZTpmdW5jdGlvbihhKXtpZihmKGEsXCJkcm9wUmVxdWlyZUZhaWx1cmVcIix0aGlzKSlyZXR1cm4gdGhpczthPVkoYSx0aGlzKTt2YXIgYj1zKHRoaXMucmVxdWlyZUZhaWwsYSk7cmV0dXJuIGI+LTEmJnRoaXMucmVxdWlyZUZhaWwuc3BsaWNlKGIsMSksdGhpc30saGFzUmVxdWlyZUZhaWx1cmVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVxdWlyZUZhaWwubGVuZ3RoPjB9LGNhblJlY29nbml6ZVdpdGg6ZnVuY3Rpb24oYSl7cmV0dXJuISF0aGlzLnNpbXVsdGFuZW91c1thLmlkXX0sZW1pdDpmdW5jdGlvbihhKXtmdW5jdGlvbiBiKGIpe2MubWFuYWdlci5lbWl0KGMub3B0aW9ucy5ldmVudCsoYj9XKGQpOlwiXCIpLGEpfXZhciBjPXRoaXMsZD10aGlzLnN0YXRlO2hjPmQmJmIoITApLGIoKSxkPj1oYyYmYighMCl9LHRyeUVtaXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuY2FuRW1pdCgpP3RoaXMuZW1pdChhKTp2b2lkKHRoaXMuc3RhdGU9a2MpfSxjYW5FbWl0OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTA7YTx0aGlzLnJlcXVpcmVGYWlsLmxlbmd0aDspe2lmKCEodGhpcy5yZXF1aXJlRmFpbFthXS5zdGF0ZSYoa2N8ZWMpKSlyZXR1cm4hMTthKyt9cmV0dXJuITB9LHJlY29nbml6ZTpmdW5jdGlvbihhKXt2YXIgYj1oKHt9LGEpO3JldHVybiBsKHRoaXMub3B0aW9ucy5lbmFibGUsW3RoaXMsYl0pPyh0aGlzLnN0YXRlJihpY3xqY3xrYykmJih0aGlzLnN0YXRlPWVjKSx0aGlzLnN0YXRlPXRoaXMucHJvY2VzcyhiKSx2b2lkKHRoaXMuc3RhdGUmKGZjfGdjfGhjfGpjKSYmdGhpcy50cnlFbWl0KGIpKSk6KHRoaXMucmVzZXQoKSx2b2lkKHRoaXMuc3RhdGU9a2MpKX0scHJvY2VzczpmdW5jdGlvbigpe30sZ2V0VG91Y2hBY3Rpb246ZnVuY3Rpb24oKXt9LHJlc2V0OmZ1bmN0aW9uKCl7fX0saihaLFYse2RlZmF1bHRzOntwb2ludGVyczoxfSxhdHRyVGVzdDpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMucG9pbnRlcnM7cmV0dXJuIDA9PT1ifHxhLnBvaW50ZXJzLmxlbmd0aD09PWJ9LHByb2Nlc3M6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zdGF0ZSxjPWEuZXZlbnRUeXBlLGQ9YiYoZmN8Z2MpLGU9dGhpcy5hdHRyVGVzdChhKTtyZXR1cm4gZCYmKGMmQmJ8fCFlKT9ifGpjOmR8fGU/YyZBYj9ifGhjOmImZmM/YnxnYzpmYzprY319KSxqKCQsWix7ZGVmYXVsdHM6e2V2ZW50OlwicGFuXCIsdGhyZXNob2xkOjEwLHBvaW50ZXJzOjEsZGlyZWN0aW9uOkpifSxnZXRUb3VjaEFjdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3B0aW9ucy5kaXJlY3Rpb24sYj1bXTtyZXR1cm4gYSZIYiYmYi5wdXNoKGRjKSxhJkliJiZiLnB1c2goY2MpLGJ9LGRpcmVjdGlvblRlc3Q6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5vcHRpb25zLGM9ITAsZD1hLmRpc3RhbmNlLGU9YS5kaXJlY3Rpb24sZj1hLmRlbHRhWCxnPWEuZGVsdGFZO3JldHVybiBlJmIuZGlyZWN0aW9ufHwoYi5kaXJlY3Rpb24mSGI/KGU9MD09PWY/Q2I6MD5mP0RiOkViLGM9ZiE9dGhpcy5wWCxkPU1hdGguYWJzKGEuZGVsdGFYKSk6KGU9MD09PWc/Q2I6MD5nP0ZiOkdiLGM9ZyE9dGhpcy5wWSxkPU1hdGguYWJzKGEuZGVsdGFZKSkpLGEuZGlyZWN0aW9uPWUsYyYmZD5iLnRocmVzaG9sZCYmZSZiLmRpcmVjdGlvbn0sYXR0clRlc3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIFoucHJvdG90eXBlLmF0dHJUZXN0LmNhbGwodGhpcyxhKSYmKHRoaXMuc3RhdGUmZmN8fCEodGhpcy5zdGF0ZSZmYykmJnRoaXMuZGlyZWN0aW9uVGVzdChhKSl9LGVtaXQ6ZnVuY3Rpb24oYSl7dGhpcy5wWD1hLmRlbHRhWCx0aGlzLnBZPWEuZGVsdGFZO3ZhciBiPVgoYS5kaXJlY3Rpb24pO2ImJnRoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCtiLGEpLHRoaXMuX3N1cGVyLmVtaXQuY2FsbCh0aGlzLGEpfX0pLGooXyxaLHtkZWZhdWx0czp7ZXZlbnQ6XCJwaW5jaFwiLHRocmVzaG9sZDowLHBvaW50ZXJzOjJ9LGdldFRvdWNoQWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuW2JjXX0sYXR0clRlc3Q6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuX3N1cGVyLmF0dHJUZXN0LmNhbGwodGhpcyxhKSYmKE1hdGguYWJzKGEuc2NhbGUtMSk+dGhpcy5vcHRpb25zLnRocmVzaG9sZHx8dGhpcy5zdGF0ZSZmYyl9LGVtaXQ6ZnVuY3Rpb24oYSl7aWYodGhpcy5fc3VwZXIuZW1pdC5jYWxsKHRoaXMsYSksMSE9PWEuc2NhbGUpe3ZhciBiPWEuc2NhbGU8MT9cImluXCI6XCJvdXRcIjt0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQrYixhKX19fSksaihhYixWLHtkZWZhdWx0czp7ZXZlbnQ6XCJwcmVzc1wiLHBvaW50ZXJzOjEsdGltZTo1MDAsdGhyZXNob2xkOjV9LGdldFRvdWNoQWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuW19iXX0scHJvY2VzczpmdW5jdGlvbihhKXt2YXIgYj10aGlzLm9wdGlvbnMsYz1hLnBvaW50ZXJzLmxlbmd0aD09PWIucG9pbnRlcnMsZD1hLmRpc3RhbmNlPGIudGhyZXNob2xkLGY9YS5kZWx0YVRpbWU+Yi50aW1lO2lmKHRoaXMuX2lucHV0PWEsIWR8fCFjfHxhLmV2ZW50VHlwZSYoQWJ8QmIpJiYhZil0aGlzLnJlc2V0KCk7ZWxzZSBpZihhLmV2ZW50VHlwZSZ5Yil0aGlzLnJlc2V0KCksdGhpcy5fdGltZXI9ZShmdW5jdGlvbigpe3RoaXMuc3RhdGU9aWMsdGhpcy50cnlFbWl0KCl9LGIudGltZSx0aGlzKTtlbHNlIGlmKGEuZXZlbnRUeXBlJkFiKXJldHVybiBpYztyZXR1cm4ga2N9LHJlc2V0OmZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVyKX0sZW1pdDpmdW5jdGlvbihhKXt0aGlzLnN0YXRlPT09aWMmJihhJiZhLmV2ZW50VHlwZSZBYj90aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQrXCJ1cFwiLGEpOih0aGlzLl9pbnB1dC50aW1lU3RhbXA9bmIoKSx0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQsdGhpcy5faW5wdXQpKSl9fSksaihiYixaLHtkZWZhdWx0czp7ZXZlbnQ6XCJyb3RhdGVcIix0aHJlc2hvbGQ6MCxwb2ludGVyczoyfSxnZXRUb3VjaEFjdGlvbjpmdW5jdGlvbigpe3JldHVybltiY119LGF0dHJUZXN0OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLl9zdXBlci5hdHRyVGVzdC5jYWxsKHRoaXMsYSkmJihNYXRoLmFicyhhLnJvdGF0aW9uKT50aGlzLm9wdGlvbnMudGhyZXNob2xkfHx0aGlzLnN0YXRlJmZjKX19KSxqKGNiLFose2RlZmF1bHRzOntldmVudDpcInN3aXBlXCIsdGhyZXNob2xkOjEwLHZlbG9jaXR5Oi42NSxkaXJlY3Rpb246SGJ8SWIscG9pbnRlcnM6MX0sZ2V0VG91Y2hBY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gJC5wcm90b3R5cGUuZ2V0VG91Y2hBY3Rpb24uY2FsbCh0aGlzKX0sYXR0clRlc3Q6ZnVuY3Rpb24oYSl7dmFyIGIsYz10aGlzLm9wdGlvbnMuZGlyZWN0aW9uO3JldHVybiBjJihIYnxJYik/Yj1hLnZlbG9jaXR5OmMmSGI/Yj1hLnZlbG9jaXR5WDpjJkliJiYoYj1hLnZlbG9jaXR5WSksdGhpcy5fc3VwZXIuYXR0clRlc3QuY2FsbCh0aGlzLGEpJiZjJmEuZGlyZWN0aW9uJiZhLmRpc3RhbmNlPnRoaXMub3B0aW9ucy50aHJlc2hvbGQmJm1iKGIpPnRoaXMub3B0aW9ucy52ZWxvY2l0eSYmYS5ldmVudFR5cGUmQWJ9LGVtaXQ6ZnVuY3Rpb24oYSl7dmFyIGI9WChhLmRpcmVjdGlvbik7YiYmdGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50K2IsYSksdGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50LGEpfX0pLGooZGIsVix7ZGVmYXVsdHM6e2V2ZW50OlwidGFwXCIscG9pbnRlcnM6MSx0YXBzOjEsaW50ZXJ2YWw6MzAwLHRpbWU6MjUwLHRocmVzaG9sZDoyLHBvc1RocmVzaG9sZDoxMH0sZ2V0VG91Y2hBY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm5bYWNdfSxwcm9jZXNzOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMub3B0aW9ucyxjPWEucG9pbnRlcnMubGVuZ3RoPT09Yi5wb2ludGVycyxkPWEuZGlzdGFuY2U8Yi50aHJlc2hvbGQsZj1hLmRlbHRhVGltZTxiLnRpbWU7aWYodGhpcy5yZXNldCgpLGEuZXZlbnRUeXBlJnliJiYwPT09dGhpcy5jb3VudClyZXR1cm4gdGhpcy5mYWlsVGltZW91dCgpO2lmKGQmJmYmJmMpe2lmKGEuZXZlbnRUeXBlIT1BYilyZXR1cm4gdGhpcy5mYWlsVGltZW91dCgpO3ZhciBnPXRoaXMucFRpbWU/YS50aW1lU3RhbXAtdGhpcy5wVGltZTxiLmludGVydmFsOiEwLGg9IXRoaXMucENlbnRlcnx8SSh0aGlzLnBDZW50ZXIsYS5jZW50ZXIpPGIucG9zVGhyZXNob2xkO3RoaXMucFRpbWU9YS50aW1lU3RhbXAsdGhpcy5wQ2VudGVyPWEuY2VudGVyLGgmJmc/dGhpcy5jb3VudCs9MTp0aGlzLmNvdW50PTEsdGhpcy5faW5wdXQ9YTt2YXIgaT10aGlzLmNvdW50JWIudGFwcztpZigwPT09aSlyZXR1cm4gdGhpcy5oYXNSZXF1aXJlRmFpbHVyZXMoKT8odGhpcy5fdGltZXI9ZShmdW5jdGlvbigpe3RoaXMuc3RhdGU9aWMsdGhpcy50cnlFbWl0KCl9LGIuaW50ZXJ2YWwsdGhpcyksZmMpOmljfXJldHVybiBrY30sZmFpbFRpbWVvdXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGltZXI9ZShmdW5jdGlvbigpe3RoaXMuc3RhdGU9a2N9LHRoaXMub3B0aW9ucy5pbnRlcnZhbCx0aGlzKSxrY30scmVzZXQ6ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQodGhpcy5fdGltZXIpfSxlbWl0OmZ1bmN0aW9uKCl7dGhpcy5zdGF0ZT09aWMmJih0aGlzLl9pbnB1dC50YXBDb3VudD10aGlzLmNvdW50LHRoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCx0aGlzLl9pbnB1dCkpfX0pLGViLlZFUlNJT049XCIyLjAuNFwiLGViLmRlZmF1bHRzPXtkb21FdmVudHM6ITEsdG91Y2hBY3Rpb246JGIsZW5hYmxlOiEwLGlucHV0VGFyZ2V0Om51bGwsaW5wdXRDbGFzczpudWxsLHByZXNldDpbW2JiLHtlbmFibGU6ITF9XSxbXyx7ZW5hYmxlOiExfSxbXCJyb3RhdGVcIl1dLFtjYix7ZGlyZWN0aW9uOkhifV0sWyQse2RpcmVjdGlvbjpIYn0sW1wic3dpcGVcIl1dLFtkYl0sW2RiLHtldmVudDpcImRvdWJsZXRhcFwiLHRhcHM6Mn0sW1widGFwXCJdXSxbYWJdXSxjc3NQcm9wczp7dXNlclNlbGVjdDpcIm5vbmVcIix0b3VjaFNlbGVjdDpcIm5vbmVcIix0b3VjaENhbGxvdXQ6XCJub25lXCIsY29udGVudFpvb21pbmc6XCJub25lXCIsdXNlckRyYWc6XCJub25lXCIsdGFwSGlnaGxpZ2h0Q29sb3I6XCJyZ2JhKDAsMCwwLDApXCJ9fTt2YXIgbGM9MSxtYz0yO2ZiLnByb3RvdHlwZT17c2V0OmZ1bmN0aW9uKGEpe3JldHVybiBoKHRoaXMub3B0aW9ucyxhKSxhLnRvdWNoQWN0aW9uJiZ0aGlzLnRvdWNoQWN0aW9uLnVwZGF0ZSgpLGEuaW5wdXRUYXJnZXQmJih0aGlzLmlucHV0LmRlc3Ryb3koKSx0aGlzLmlucHV0LnRhcmdldD1hLmlucHV0VGFyZ2V0LHRoaXMuaW5wdXQuaW5pdCgpKSx0aGlzfSxzdG9wOmZ1bmN0aW9uKGEpe3RoaXMuc2Vzc2lvbi5zdG9wcGVkPWE/bWM6bGN9LHJlY29nbml6ZTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLnNlc3Npb247aWYoIWIuc3RvcHBlZCl7dGhpcy50b3VjaEFjdGlvbi5wcmV2ZW50RGVmYXVsdHMoYSk7dmFyIGMsZD10aGlzLnJlY29nbml6ZXJzLGU9Yi5jdXJSZWNvZ25pemVyOyghZXx8ZSYmZS5zdGF0ZSZpYykmJihlPWIuY3VyUmVjb2duaXplcj1udWxsKTtmb3IodmFyIGY9MDtmPGQubGVuZ3RoOyljPWRbZl0sYi5zdG9wcGVkPT09bWN8fGUmJmMhPWUmJiFjLmNhblJlY29nbml6ZVdpdGgoZSk/Yy5yZXNldCgpOmMucmVjb2duaXplKGEpLCFlJiZjLnN0YXRlJihmY3xnY3xoYykmJihlPWIuY3VyUmVjb2duaXplcj1jKSxmKyt9fSxnZXQ6ZnVuY3Rpb24oYSl7aWYoYSBpbnN0YW5jZW9mIFYpcmV0dXJuIGE7Zm9yKHZhciBiPXRoaXMucmVjb2duaXplcnMsYz0wO2M8Yi5sZW5ndGg7YysrKWlmKGJbY10ub3B0aW9ucy5ldmVudD09YSlyZXR1cm4gYltjXTtyZXR1cm4gbnVsbH0sYWRkOmZ1bmN0aW9uKGEpe2lmKGYoYSxcImFkZFwiLHRoaXMpKXJldHVybiB0aGlzO3ZhciBiPXRoaXMuZ2V0KGEub3B0aW9ucy5ldmVudCk7cmV0dXJuIGImJnRoaXMucmVtb3ZlKGIpLHRoaXMucmVjb2duaXplcnMucHVzaChhKSxhLm1hbmFnZXI9dGhpcyx0aGlzLnRvdWNoQWN0aW9uLnVwZGF0ZSgpLGF9LHJlbW92ZTpmdW5jdGlvbihhKXtpZihmKGEsXCJyZW1vdmVcIix0aGlzKSlyZXR1cm4gdGhpczt2YXIgYj10aGlzLnJlY29nbml6ZXJzO3JldHVybiBhPXRoaXMuZ2V0KGEpLGIuc3BsaWNlKHMoYixhKSwxKSx0aGlzLnRvdWNoQWN0aW9uLnVwZGF0ZSgpLHRoaXN9LG9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5oYW5kbGVycztyZXR1cm4gZyhyKGEpLGZ1bmN0aW9uKGEpe2NbYV09Y1thXXx8W10sY1thXS5wdXNoKGIpfSksdGhpc30sb2ZmOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5oYW5kbGVycztyZXR1cm4gZyhyKGEpLGZ1bmN0aW9uKGEpe2I/Y1thXS5zcGxpY2UocyhjW2FdLGIpLDEpOmRlbGV0ZSBjW2FdfSksdGhpc30sZW1pdDpmdW5jdGlvbihhLGIpe3RoaXMub3B0aW9ucy5kb21FdmVudHMmJmhiKGEsYik7dmFyIGM9dGhpcy5oYW5kbGVyc1thXSYmdGhpcy5oYW5kbGVyc1thXS5zbGljZSgpO2lmKGMmJmMubGVuZ3RoKXtiLnR5cGU9YSxiLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7Yi5zcmNFdmVudC5wcmV2ZW50RGVmYXVsdCgpfTtmb3IodmFyIGQ9MDtkPGMubGVuZ3RoOyljW2RdKGIpLGQrK319LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQmJmdiKHRoaXMsITEpLHRoaXMuaGFuZGxlcnM9e30sdGhpcy5zZXNzaW9uPXt9LHRoaXMuaW5wdXQuZGVzdHJveSgpLHRoaXMuZWxlbWVudD1udWxsfX0saChlYix7SU5QVVRfU1RBUlQ6eWIsSU5QVVRfTU9WRTp6YixJTlBVVF9FTkQ6QWIsSU5QVVRfQ0FOQ0VMOkJiLFNUQVRFX1BPU1NJQkxFOmVjLFNUQVRFX0JFR0FOOmZjLFNUQVRFX0NIQU5HRUQ6Z2MsU1RBVEVfRU5ERUQ6aGMsU1RBVEVfUkVDT0dOSVpFRDppYyxTVEFURV9DQU5DRUxMRUQ6amMsU1RBVEVfRkFJTEVEOmtjLERJUkVDVElPTl9OT05FOkNiLERJUkVDVElPTl9MRUZUOkRiLERJUkVDVElPTl9SSUdIVDpFYixESVJFQ1RJT05fVVA6RmIsRElSRUNUSU9OX0RPV046R2IsRElSRUNUSU9OX0hPUklaT05UQUw6SGIsRElSRUNUSU9OX1ZFUlRJQ0FMOkliLERJUkVDVElPTl9BTEw6SmIsTWFuYWdlcjpmYixJbnB1dDp5LFRvdWNoQWN0aW9uOlQsVG91Y2hJbnB1dDpRLE1vdXNlSW5wdXQ6TSxQb2ludGVyRXZlbnRJbnB1dDpOLFRvdWNoTW91c2VJbnB1dDpTLFNpbmdsZVRvdWNoSW5wdXQ6TyxSZWNvZ25pemVyOlYsQXR0clJlY29nbml6ZXI6WixUYXA6ZGIsUGFuOiQsU3dpcGU6Y2IsUGluY2g6XyxSb3RhdGU6YmIsUHJlc3M6YWIsb246bixvZmY6byxlYWNoOmcsbWVyZ2U6aSxleHRlbmQ6aCxpbmhlcml0OmosYmluZEZuOmsscHJlZml4ZWQ6dn0pLHR5cGVvZiBkZWZpbmU9PWtiJiZkZWZpbmUuYW1kP2RlZmluZShmdW5jdGlvbigpe3JldHVybiBlYn0pOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWViOmFbY109ZWJ9KHdpbmRvdyxkb2N1bWVudCxcIkhhbW1lclwiKTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aGFtbWVyLm1pbi5tYXAiLCIvKiA9PSBqcXVlcnkgbW91c2V3aGVlbCBwbHVnaW4gPT0gVmVyc2lvbjogMy4xLjEyLCBMaWNlbnNlOiBNSVQgTGljZW5zZSAoTUlUKSAqL1xyXG4hZnVuY3Rpb24oYSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXCJqcXVlcnlcIl0sYSk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9YTphKGpRdWVyeSl9KGZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYil7dmFyIGc9Ynx8d2luZG93LmV2ZW50LGg9aS5jYWxsKGFyZ3VtZW50cywxKSxqPTAsbD0wLG09MCxuPTAsbz0wLHA9MDtpZihiPWEuZXZlbnQuZml4KGcpLGIudHlwZT1cIm1vdXNld2hlZWxcIixcImRldGFpbFwiaW4gZyYmKG09LTEqZy5kZXRhaWwpLFwid2hlZWxEZWx0YVwiaW4gZyYmKG09Zy53aGVlbERlbHRhKSxcIndoZWVsRGVsdGFZXCJpbiBnJiYobT1nLndoZWVsRGVsdGFZKSxcIndoZWVsRGVsdGFYXCJpbiBnJiYobD0tMSpnLndoZWVsRGVsdGFYKSxcImF4aXNcImluIGcmJmcuYXhpcz09PWcuSE9SSVpPTlRBTF9BWElTJiYobD0tMSptLG09MCksaj0wPT09bT9sOm0sXCJkZWx0YVlcImluIGcmJihtPS0xKmcuZGVsdGFZLGo9bSksXCJkZWx0YVhcImluIGcmJihsPWcuZGVsdGFYLDA9PT1tJiYoaj0tMSpsKSksMCE9PW18fDAhPT1sKXtpZigxPT09Zy5kZWx0YU1vZGUpe3ZhciBxPWEuZGF0YSh0aGlzLFwibW91c2V3aGVlbC1saW5lLWhlaWdodFwiKTtqKj1xLG0qPXEsbCo9cX1lbHNlIGlmKDI9PT1nLmRlbHRhTW9kZSl7dmFyIHI9YS5kYXRhKHRoaXMsXCJtb3VzZXdoZWVsLXBhZ2UtaGVpZ2h0XCIpO2oqPXIsbSo9cixsKj1yfWlmKG49TWF0aC5tYXgoTWF0aC5hYnMobSksTWF0aC5hYnMobCkpLCghZnx8Zj5uKSYmKGY9bixkKGcsbikmJihmLz00MCkpLGQoZyxuKSYmKGovPTQwLGwvPTQwLG0vPTQwKSxqPU1hdGhbaj49MT9cImZsb29yXCI6XCJjZWlsXCJdKGovZiksbD1NYXRoW2w+PTE/XCJmbG9vclwiOlwiY2VpbFwiXShsL2YpLG09TWF0aFttPj0xP1wiZmxvb3JcIjpcImNlaWxcIl0obS9mKSxrLnNldHRpbmdzLm5vcm1hbGl6ZU9mZnNldCYmdGhpcy5nZXRCb3VuZGluZ0NsaWVudFJlY3Qpe3ZhciBzPXRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7bz1iLmNsaWVudFgtcy5sZWZ0LHA9Yi5jbGllbnRZLXMudG9wfXJldHVybiBiLmRlbHRhWD1sLGIuZGVsdGFZPW0sYi5kZWx0YUZhY3Rvcj1mLGIub2Zmc2V0WD1vLGIub2Zmc2V0WT1wLGIuZGVsdGFNb2RlPTAsaC51bnNoaWZ0KGIsaixsLG0pLGUmJmNsZWFyVGltZW91dChlKSxlPXNldFRpbWVvdXQoYywyMDApLChhLmV2ZW50LmRpc3BhdGNofHxhLmV2ZW50LmhhbmRsZSkuYXBwbHkodGhpcyxoKX19ZnVuY3Rpb24gYygpe2Y9bnVsbH1mdW5jdGlvbiBkKGEsYil7cmV0dXJuIGsuc2V0dGluZ3MuYWRqdXN0T2xkRGVsdGFzJiZcIm1vdXNld2hlZWxcIj09PWEudHlwZSYmYiUxMjA9PT0wfXZhciBlLGYsZz1bXCJ3aGVlbFwiLFwibW91c2V3aGVlbFwiLFwiRE9NTW91c2VTY3JvbGxcIixcIk1vek1vdXNlUGl4ZWxTY3JvbGxcIl0saD1cIm9ud2hlZWxcImluIGRvY3VtZW50fHxkb2N1bWVudC5kb2N1bWVudE1vZGU+PTk/W1wid2hlZWxcIl06W1wibW91c2V3aGVlbFwiLFwiRG9tTW91c2VTY3JvbGxcIixcIk1vek1vdXNlUGl4ZWxTY3JvbGxcIl0saT1BcnJheS5wcm90b3R5cGUuc2xpY2U7aWYoYS5ldmVudC5maXhIb29rcylmb3IodmFyIGo9Zy5sZW5ndGg7ajspYS5ldmVudC5maXhIb29rc1tnWy0tal1dPWEuZXZlbnQubW91c2VIb29rczt2YXIgaz1hLmV2ZW50LnNwZWNpYWwubW91c2V3aGVlbD17dmVyc2lvbjpcIjMuMS4xMlwiLHNldHVwOmZ1bmN0aW9uKCl7aWYodGhpcy5hZGRFdmVudExpc3RlbmVyKWZvcih2YXIgYz1oLmxlbmd0aDtjOyl0aGlzLmFkZEV2ZW50TGlzdGVuZXIoaFstLWNdLGIsITEpO2Vsc2UgdGhpcy5vbm1vdXNld2hlZWw9YjthLmRhdGEodGhpcyxcIm1vdXNld2hlZWwtbGluZS1oZWlnaHRcIixrLmdldExpbmVIZWlnaHQodGhpcykpLGEuZGF0YSh0aGlzLFwibW91c2V3aGVlbC1wYWdlLWhlaWdodFwiLGsuZ2V0UGFnZUhlaWdodCh0aGlzKSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7aWYodGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKWZvcih2YXIgYz1oLmxlbmd0aDtjOyl0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoaFstLWNdLGIsITEpO2Vsc2UgdGhpcy5vbm1vdXNld2hlZWw9bnVsbDthLnJlbW92ZURhdGEodGhpcyxcIm1vdXNld2hlZWwtbGluZS1oZWlnaHRcIiksYS5yZW1vdmVEYXRhKHRoaXMsXCJtb3VzZXdoZWVsLXBhZ2UtaGVpZ2h0XCIpfSxnZXRMaW5lSGVpZ2h0OmZ1bmN0aW9uKGIpe3ZhciBjPWEoYiksZD1jW1wib2Zmc2V0UGFyZW50XCJpbiBhLmZuP1wib2Zmc2V0UGFyZW50XCI6XCJwYXJlbnRcIl0oKTtyZXR1cm4gZC5sZW5ndGh8fChkPWEoXCJib2R5XCIpKSxwYXJzZUludChkLmNzcyhcImZvbnRTaXplXCIpLDEwKXx8cGFyc2VJbnQoYy5jc3MoXCJmb250U2l6ZVwiKSwxMCl8fDE2fSxnZXRQYWdlSGVpZ2h0OmZ1bmN0aW9uKGIpe3JldHVybiBhKGIpLmhlaWdodCgpfSxzZXR0aW5nczp7YWRqdXN0T2xkRGVsdGFzOiEwLG5vcm1hbGl6ZU9mZnNldDohMH19O2EuZm4uZXh0ZW5kKHttb3VzZXdoZWVsOmZ1bmN0aW9uKGEpe3JldHVybiBhP3RoaXMuYmluZChcIm1vdXNld2hlZWxcIixhKTp0aGlzLnRyaWdnZXIoXCJtb3VzZXdoZWVsXCIpfSx1bm1vdXNld2hlZWw6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudW5iaW5kKFwibW91c2V3aGVlbFwiLGEpfX0pfSk7XHJcbi8qID09IG1hbGlodSBqcXVlcnkgY3VzdG9tIHNjcm9sbGJhciBwbHVnaW4gPT0gVmVyc2lvbjogMy4wLjcsIExpY2Vuc2U6IE1JVCBMaWNlbnNlIChNSVQpICovXHJcbiFmdW5jdGlvbihlLHQsYSl7IWZ1bmN0aW9uKHQpe3ZhciBvPVwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCxuPVwiaHR0cHM6XCI9PWEubG9jYXRpb24ucHJvdG9jb2w/XCJodHRwczpcIjpcImh0dHA6XCIsaT1cImNkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9qcXVlcnktbW91c2V3aGVlbC8zLjEuMTIvanF1ZXJ5Lm1vdXNld2hlZWwubWluLmpzXCI7b3x8ZS5ldmVudC5zcGVjaWFsLm1vdXNld2hlZWx8fGUoXCJoZWFkXCIpLmFwcGVuZChkZWNvZGVVUkkoXCIlM0NzY3JpcHQgc3JjPVwiK24rXCIvL1wiK2krXCIlM0UlM0Mvc2NyaXB0JTNFXCIpKSx0KCl9KGZ1bmN0aW9uKCl7dmFyIG8sbj1cIm1DdXN0b21TY3JvbGxiYXJcIixpPVwibUNTXCIscj1cIi5tQ3VzdG9tU2Nyb2xsYmFyXCIsbD17c2V0VG9wOjAsc2V0TGVmdDowLGF4aXM6XCJ5XCIsc2Nyb2xsYmFyUG9zaXRpb246XCJpbnNpZGVcIixzY3JvbGxJbmVydGlhOjk1MCxhdXRvRHJhZ2dlckxlbmd0aDohMCxhbHdheXNTaG93U2Nyb2xsYmFyOjAsc25hcE9mZnNldDowLG1vdXNlV2hlZWw6e2VuYWJsZTohMCxzY3JvbGxBbW91bnQ6XCJhdXRvXCIsYXhpczpcInlcIixkZWx0YUZhY3RvcjpcImF1dG9cIixkaXNhYmxlT3ZlcjpbXCJzZWxlY3RcIixcIm9wdGlvblwiLFwia2V5Z2VuXCIsXCJkYXRhbGlzdFwiLFwidGV4dGFyZWFcIl19LHNjcm9sbEJ1dHRvbnM6e3Njcm9sbFR5cGU6XCJzdGVwbGVzc1wiLHNjcm9sbEFtb3VudDpcImF1dG9cIn0sa2V5Ym9hcmQ6e2VuYWJsZTohMCxzY3JvbGxUeXBlOlwic3RlcGxlc3NcIixzY3JvbGxBbW91bnQ6XCJhdXRvXCJ9LGNvbnRlbnRUb3VjaFNjcm9sbDoyNSxhZHZhbmNlZDp7YXV0b1Njcm9sbE9uRm9jdXM6XCJpbnB1dCx0ZXh0YXJlYSxzZWxlY3QsYnV0dG9uLGRhdGFsaXN0LGtleWdlbixhW3RhYmluZGV4XSxhcmVhLG9iamVjdCxbY29udGVudGVkaXRhYmxlPSd0cnVlJ11cIix1cGRhdGVPbkNvbnRlbnRSZXNpemU6ITAsdXBkYXRlT25JbWFnZUxvYWQ6ITB9LHRoZW1lOlwibGlnaHRcIixjYWxsYmFja3M6e29uVG90YWxTY3JvbGxPZmZzZXQ6MCxvblRvdGFsU2Nyb2xsQmFja09mZnNldDowLGFsd2F5c1RyaWdnZXJPZmZzZXRzOiEwfX0scz0wLGM9e30sZD10LmF0dGFjaEV2ZW50JiYhdC5hZGRFdmVudExpc3RlbmVyPzE6MCx1PSExLGY9W1wibUNTQl9kcmFnZ2VyX29uRHJhZ1wiLFwibUNTQl9zY3JvbGxUb29sc19vbkRyYWdcIixcIm1DU19pbWdfbG9hZGVkXCIsXCJtQ1NfZGlzYWJsZWRcIixcIm1DU19kZXN0cm95ZWRcIixcIm1DU19ub19zY3JvbGxiYXJcIixcIm1DUy1hdXRvSGlkZVwiLFwibUNTLWRpci1ydGxcIixcIm1DU19ub19zY3JvbGxiYXJfeVwiLFwibUNTX25vX3Njcm9sbGJhcl94XCIsXCJtQ1NfeV9oaWRkZW5cIixcIm1DU194X2hpZGRlblwiLFwibUNTQl9kcmFnZ2VyQ29udGFpbmVyXCIsXCJtQ1NCX2J1dHRvblVwXCIsXCJtQ1NCX2J1dHRvbkRvd25cIixcIm1DU0JfYnV0dG9uTGVmdFwiLFwibUNTQl9idXR0b25SaWdodFwiXSxoPXtpbml0OmZ1bmN0aW9uKHQpe3ZhciB0PWUuZXh0ZW5kKCEwLHt9LGwsdCksYT1tLmNhbGwodGhpcyk7aWYodC5saXZlKXt2YXIgbz10LmxpdmVTZWxlY3Rvcnx8dGhpcy5zZWxlY3Rvcnx8cixuPWUobyk7aWYoXCJvZmZcIj09PXQubGl2ZSlyZXR1cm4gdm9pZCBnKG8pO2Nbb109c2V0VGltZW91dChmdW5jdGlvbigpe24ubUN1c3RvbVNjcm9sbGJhcih0KSxcIm9uY2VcIj09PXQubGl2ZSYmbi5sZW5ndGgmJmcobyl9LDUwMCl9ZWxzZSBnKG8pO3JldHVybiB0LnNldFdpZHRoPXQuc2V0X3dpZHRoP3Quc2V0X3dpZHRoOnQuc2V0V2lkdGgsdC5zZXRIZWlnaHQ9dC5zZXRfaGVpZ2h0P3Quc2V0X2hlaWdodDp0LnNldEhlaWdodCx0LmF4aXM9dC5ob3Jpem9udGFsU2Nyb2xsP1wieFwiOnYodC5heGlzKSx0LnNjcm9sbEluZXJ0aWE9dC5zY3JvbGxJbmVydGlhPjAmJnQuc2Nyb2xsSW5lcnRpYTwxNz8xNzp0LnNjcm9sbEluZXJ0aWEsXCJvYmplY3RcIiE9dHlwZW9mIHQubW91c2VXaGVlbCYmMT09dC5tb3VzZVdoZWVsJiYodC5tb3VzZVdoZWVsPXtlbmFibGU6ITAsc2Nyb2xsQW1vdW50OlwiYXV0b1wiLGF4aXM6XCJ5XCIscHJldmVudERlZmF1bHQ6ITEsZGVsdGFGYWN0b3I6XCJhdXRvXCIsbm9ybWFsaXplRGVsdGE6ITEsaW52ZXJ0OiExfSksdC5tb3VzZVdoZWVsLnNjcm9sbEFtb3VudD10Lm1vdXNlV2hlZWxQaXhlbHM/dC5tb3VzZVdoZWVsUGl4ZWxzOnQubW91c2VXaGVlbC5zY3JvbGxBbW91bnQsdC5tb3VzZVdoZWVsLm5vcm1hbGl6ZURlbHRhPXQuYWR2YW5jZWQubm9ybWFsaXplTW91c2VXaGVlbERlbHRhP3QuYWR2YW5jZWQubm9ybWFsaXplTW91c2VXaGVlbERlbHRhOnQubW91c2VXaGVlbC5ub3JtYWxpemVEZWx0YSx0LnNjcm9sbEJ1dHRvbnMuc2Nyb2xsVHlwZT14KHQuc2Nyb2xsQnV0dG9ucy5zY3JvbGxUeXBlKSxwKHQpLGUoYSkuZWFjaChmdW5jdGlvbigpe3ZhciBhPWUodGhpcyk7aWYoIWEuZGF0YShpKSl7YS5kYXRhKGkse2lkeDorK3Msb3B0OnQsc2Nyb2xsUmF0aW86e3k6bnVsbCx4Om51bGx9LG92ZXJmbG93ZWQ6bnVsbCxjb250ZW50UmVzZXQ6e3k6bnVsbCx4Om51bGx9LGJpbmRFdmVudHM6ITEsdHdlZW5SdW5uaW5nOiExLHNlcXVlbnRpYWw6e30sbGFuZ0RpcjphLmNzcyhcImRpcmVjdGlvblwiKSxjYk9mZnNldHM6bnVsbCx0cmlnZ2VyOm51bGx9KTt2YXIgbz1hLmRhdGEoaSksbj1vLm9wdCxyPWEuZGF0YShcIm1jcy1heGlzXCIpLGw9YS5kYXRhKFwibWNzLXNjcm9sbGJhci1wb3NpdGlvblwiKSxjPWEuZGF0YShcIm1jcy10aGVtZVwiKTtyJiYobi5heGlzPXIpLGwmJihuLnNjcm9sbGJhclBvc2l0aW9uPWwpLGMmJihuLnRoZW1lPWMscChuKSksXy5jYWxsKHRoaXMpLGUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXIgaW1nOm5vdCguXCIrZlsyXStcIilcIikuYWRkQ2xhc3MoZlsyXSksaC51cGRhdGUuY2FsbChudWxsLGEpfX0pfSx1cGRhdGU6ZnVuY3Rpb24odCxhKXt2YXIgbz10fHxtLmNhbGwodGhpcyk7cmV0dXJuIGUobykuZWFjaChmdW5jdGlvbigpe3ZhciB0PWUodGhpcyk7aWYodC5kYXRhKGkpKXt2YXIgbz10LmRhdGEoaSksbj1vLm9wdCxyPWUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJcIiksbD1bZShcIiNtQ1NCX1wiK28uaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK28uaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKV07aWYoIXIubGVuZ3RoKXJldHVybjtvLnR3ZWVuUnVubmluZyYmUSh0KSx0Lmhhc0NsYXNzKGZbM10pJiZ0LnJlbW92ZUNsYXNzKGZbM10pLHQuaGFzQ2xhc3MoZls0XSkmJnQucmVtb3ZlQ2xhc3MoZls0XSksQy5jYWxsKHRoaXMpLHcuY2FsbCh0aGlzKSxcInlcIj09PW4uYXhpc3x8bi5hZHZhbmNlZC5hdXRvRXhwYW5kSG9yaXpvbnRhbFNjcm9sbHx8ci5jc3MoXCJ3aWR0aFwiLFMoci5jaGlsZHJlbigpKSksby5vdmVyZmxvd2VkPWsuY2FsbCh0aGlzKSxSLmNhbGwodGhpcyksbi5hdXRvRHJhZ2dlckxlbmd0aCYmeS5jYWxsKHRoaXMpLEIuY2FsbCh0aGlzKSxPLmNhbGwodGhpcyk7dmFyIHM9W01hdGguYWJzKHJbMF0ub2Zmc2V0VG9wKSxNYXRoLmFicyhyWzBdLm9mZnNldExlZnQpXTtcInhcIiE9PW4uYXhpcyYmKG8ub3ZlcmZsb3dlZFswXT9sWzBdLmhlaWdodCgpPmxbMF0ucGFyZW50KCkuaGVpZ2h0KCk/TS5jYWxsKHRoaXMpOihHKHQsc1swXS50b1N0cmluZygpLHtkaXI6XCJ5XCIsZHVyOjAsb3ZlcndyaXRlOlwibm9uZVwifSksby5jb250ZW50UmVzZXQueT1udWxsKTooTS5jYWxsKHRoaXMpLFwieVwiPT09bi5heGlzP0kuY2FsbCh0aGlzKTpcInl4XCI9PT1uLmF4aXMmJm8ub3ZlcmZsb3dlZFsxXSYmRyh0LHNbMV0udG9TdHJpbmcoKSx7ZGlyOlwieFwiLGR1cjowLG92ZXJ3cml0ZTpcIm5vbmVcIn0pKSksXCJ5XCIhPT1uLmF4aXMmJihvLm92ZXJmbG93ZWRbMV0/bFsxXS53aWR0aCgpPmxbMV0ucGFyZW50KCkud2lkdGgoKT9NLmNhbGwodGhpcyk6KEcodCxzWzFdLnRvU3RyaW5nKCkse2RpcjpcInhcIixkdXI6MCxvdmVyd3JpdGU6XCJub25lXCJ9KSxvLmNvbnRlbnRSZXNldC54PW51bGwpOihNLmNhbGwodGhpcyksXCJ4XCI9PT1uLmF4aXM/SS5jYWxsKHRoaXMpOlwieXhcIj09PW4uYXhpcyYmby5vdmVyZmxvd2VkWzBdJiZHKHQsc1swXS50b1N0cmluZygpLHtkaXI6XCJ5XCIsZHVyOjAsb3ZlcndyaXRlOlwibm9uZVwifSkpKSxhJiZvJiYoMj09PWEmJm4uY2FsbGJhY2tzLm9uSW1hZ2VMb2FkJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmNhbGxiYWNrcy5vbkltYWdlTG9hZD9uLmNhbGxiYWNrcy5vbkltYWdlTG9hZC5jYWxsKHRoaXMpOjM9PT1hJiZuLmNhbGxiYWNrcy5vblNlbGVjdG9yQ2hhbmdlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmNhbGxiYWNrcy5vblNlbGVjdG9yQ2hhbmdlP24uY2FsbGJhY2tzLm9uU2VsZWN0b3JDaGFuZ2UuY2FsbCh0aGlzKTpuLmNhbGxiYWNrcy5vblVwZGF0ZSYmXCJmdW5jdGlvblwiPT10eXBlb2Ygbi5jYWxsYmFja3Mub25VcGRhdGUmJm4uY2FsbGJhY2tzLm9uVXBkYXRlLmNhbGwodGhpcykpLE4uY2FsbCh0aGlzKX19KX0sc2Nyb2xsVG86ZnVuY3Rpb24odCxhKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgdCYmbnVsbCE9dCl7dmFyIG89bS5jYWxsKHRoaXMpO3JldHVybiBlKG8pLmVhY2goZnVuY3Rpb24oKXt2YXIgbz1lKHRoaXMpO2lmKG8uZGF0YShpKSl7dmFyIG49by5kYXRhKGkpLHI9bi5vcHQsbD17dHJpZ2dlcjpcImV4dGVybmFsXCIsc2Nyb2xsSW5lcnRpYTpyLnNjcm9sbEluZXJ0aWEsc2Nyb2xsRWFzaW5nOlwibWNzRWFzZUluT3V0XCIsbW92ZURyYWdnZXI6ITEsdGltZW91dDo2MCxjYWxsYmFja3M6ITAsb25TdGFydDohMCxvblVwZGF0ZTohMCxvbkNvbXBsZXRlOiEwfSxzPWUuZXh0ZW5kKCEwLHt9LGwsYSksYz1ZLmNhbGwodGhpcyx0KSxkPXMuc2Nyb2xsSW5lcnRpYT4wJiZzLnNjcm9sbEluZXJ0aWE8MTc/MTc6cy5zY3JvbGxJbmVydGlhO2NbMF09WC5jYWxsKHRoaXMsY1swXSxcInlcIiksY1sxXT1YLmNhbGwodGhpcyxjWzFdLFwieFwiKSxzLm1vdmVEcmFnZ2VyJiYoY1swXSo9bi5zY3JvbGxSYXRpby55LGNbMV0qPW4uc2Nyb2xsUmF0aW8ueCkscy5kdXI9ZCxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bnVsbCE9PWNbMF0mJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBjWzBdJiZcInhcIiE9PXIuYXhpcyYmbi5vdmVyZmxvd2VkWzBdJiYocy5kaXI9XCJ5XCIscy5vdmVyd3JpdGU9XCJhbGxcIixHKG8sY1swXS50b1N0cmluZygpLHMpKSxudWxsIT09Y1sxXSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGNbMV0mJlwieVwiIT09ci5heGlzJiZuLm92ZXJmbG93ZWRbMV0mJihzLmRpcj1cInhcIixzLm92ZXJ3cml0ZT1cIm5vbmVcIixHKG8sY1sxXS50b1N0cmluZygpLHMpKX0scy50aW1lb3V0KX19KX19LHN0b3A6ZnVuY3Rpb24oKXt2YXIgdD1tLmNhbGwodGhpcyk7cmV0dXJuIGUodCkuZWFjaChmdW5jdGlvbigpe3ZhciB0PWUodGhpcyk7dC5kYXRhKGkpJiZRKHQpfSl9LGRpc2FibGU6ZnVuY3Rpb24odCl7dmFyIGE9bS5jYWxsKHRoaXMpO3JldHVybiBlKGEpLmVhY2goZnVuY3Rpb24oKXt2YXIgYT1lKHRoaXMpO2lmKGEuZGF0YShpKSl7e2EuZGF0YShpKX1OLmNhbGwodGhpcyxcInJlbW92ZVwiKSxJLmNhbGwodGhpcyksdCYmTS5jYWxsKHRoaXMpLFIuY2FsbCh0aGlzLCEwKSxhLmFkZENsYXNzKGZbM10pfX0pfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIHQ9bS5jYWxsKHRoaXMpO3JldHVybiBlKHQpLmVhY2goZnVuY3Rpb24oKXt2YXIgYT1lKHRoaXMpO2lmKGEuZGF0YShpKSl7dmFyIG89YS5kYXRhKGkpLHI9by5vcHQsbD1lKFwiI21DU0JfXCIrby5pZHgpLHM9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKSxjPWUoXCIubUNTQl9cIitvLmlkeCtcIl9zY3JvbGxiYXJcIik7ci5saXZlJiZnKHIubGl2ZVNlbGVjdG9yfHxlKHQpLnNlbGVjdG9yKSxOLmNhbGwodGhpcyxcInJlbW92ZVwiKSxJLmNhbGwodGhpcyksTS5jYWxsKHRoaXMpLGEucmVtb3ZlRGF0YShpKSwkKHRoaXMsXCJtY3NcIiksYy5yZW1vdmUoKSxzLmZpbmQoXCJpbWcuXCIrZlsyXSkucmVtb3ZlQ2xhc3MoZlsyXSksbC5yZXBsYWNlV2l0aChzLmNvbnRlbnRzKCkpLGEucmVtb3ZlQ2xhc3MobitcIiBfXCIraStcIl9cIitvLmlkeCtcIiBcIitmWzZdK1wiIFwiK2ZbN10rXCIgXCIrZls1XStcIiBcIitmWzNdKS5hZGRDbGFzcyhmWzRdKX19KX19LG09ZnVuY3Rpb24oKXtyZXR1cm5cIm9iamVjdFwiIT10eXBlb2YgZSh0aGlzKXx8ZSh0aGlzKS5sZW5ndGg8MT9yOnRoaXN9LHA9ZnVuY3Rpb24odCl7dmFyIGE9W1wicm91bmRlZFwiLFwicm91bmRlZC1kYXJrXCIsXCJyb3VuZGVkLWRvdHNcIixcInJvdW5kZWQtZG90cy1kYXJrXCJdLG89W1wicm91bmRlZC1kb3RzXCIsXCJyb3VuZGVkLWRvdHMtZGFya1wiLFwiM2RcIixcIjNkLWRhcmtcIixcIjNkLXRoaWNrXCIsXCIzZC10aGljay1kYXJrXCIsXCJpbnNldFwiLFwiaW5zZXQtZGFya1wiLFwiaW5zZXQtMlwiLFwiaW5zZXQtMi1kYXJrXCIsXCJpbnNldC0zXCIsXCJpbnNldC0zLWRhcmtcIl0sbj1bXCJtaW5pbWFsXCIsXCJtaW5pbWFsLWRhcmtcIl0saT1bXCJtaW5pbWFsXCIsXCJtaW5pbWFsLWRhcmtcIl0scj1bXCJtaW5pbWFsXCIsXCJtaW5pbWFsLWRhcmtcIl07dC5hdXRvRHJhZ2dlckxlbmd0aD1lLmluQXJyYXkodC50aGVtZSxhKT4tMT8hMTp0LmF1dG9EcmFnZ2VyTGVuZ3RoLHQuYXV0b0V4cGFuZFNjcm9sbGJhcj1lLmluQXJyYXkodC50aGVtZSxvKT4tMT8hMTp0LmF1dG9FeHBhbmRTY3JvbGxiYXIsdC5zY3JvbGxCdXR0b25zLmVuYWJsZT1lLmluQXJyYXkodC50aGVtZSxuKT4tMT8hMTp0LnNjcm9sbEJ1dHRvbnMuZW5hYmxlLHQuYXV0b0hpZGVTY3JvbGxiYXI9ZS5pbkFycmF5KHQudGhlbWUsaSk+LTE/ITA6dC5hdXRvSGlkZVNjcm9sbGJhcix0LnNjcm9sbGJhclBvc2l0aW9uPWUuaW5BcnJheSh0LnRoZW1lLHIpPi0xP1wib3V0c2lkZVwiOnQuc2Nyb2xsYmFyUG9zaXRpb259LGc9ZnVuY3Rpb24oZSl7Y1tlXSYmKGNsZWFyVGltZW91dChjW2VdKSwkKGMsZSkpfSx2PWZ1bmN0aW9uKGUpe3JldHVyblwieXhcIj09PWV8fFwieHlcIj09PWV8fFwiYXV0b1wiPT09ZT9cInl4XCI6XCJ4XCI9PT1lfHxcImhvcml6b250YWxcIj09PWU/XCJ4XCI6XCJ5XCJ9LHg9ZnVuY3Rpb24oZSl7cmV0dXJuXCJzdGVwcGVkXCI9PT1lfHxcInBpeGVsc1wiPT09ZXx8XCJzdGVwXCI9PT1lfHxcImNsaWNrXCI9PT1lP1wic3RlcHBlZFwiOlwic3RlcGxlc3NcIn0sXz1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1hLm9wdCxyPW8uYXV0b0V4cGFuZFNjcm9sbGJhcj9cIiBcIitmWzFdK1wiX2V4cGFuZFwiOlwiXCIsbD1bXCI8ZGl2IGlkPSdtQ1NCX1wiK2EuaWR4K1wiX3Njcm9sbGJhcl92ZXJ0aWNhbCcgY2xhc3M9J21DU0Jfc2Nyb2xsVG9vbHMgbUNTQl9cIithLmlkeCtcIl9zY3JvbGxiYXIgbUNTLVwiK28udGhlbWUrXCIgbUNTQl9zY3JvbGxUb29sc192ZXJ0aWNhbFwiK3IrXCInPjxkaXYgY2xhc3M9J1wiK2ZbMTJdK1wiJz48ZGl2IGlkPSdtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfdmVydGljYWwnIGNsYXNzPSdtQ1NCX2RyYWdnZXInIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTsnIG9uY29udGV4dG1lbnU9J3JldHVybiBmYWxzZTsnPjxkaXYgY2xhc3M9J21DU0JfZHJhZ2dlcl9iYXInIC8+PC9kaXY+PGRpdiBjbGFzcz0nbUNTQl9kcmFnZ2VyUmFpbCcgLz48L2Rpdj48L2Rpdj5cIixcIjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyX2hvcml6b250YWwnIGNsYXNzPSdtQ1NCX3Njcm9sbFRvb2xzIG1DU0JfXCIrYS5pZHgrXCJfc2Nyb2xsYmFyIG1DUy1cIitvLnRoZW1lK1wiIG1DU0Jfc2Nyb2xsVG9vbHNfaG9yaXpvbnRhbFwiK3IrXCInPjxkaXYgY2xhc3M9J1wiK2ZbMTJdK1wiJz48ZGl2IGlkPSdtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbCcgY2xhc3M9J21DU0JfZHJhZ2dlcicgc3R5bGU9J3Bvc2l0aW9uOmFic29sdXRlOycgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOyc+PGRpdiBjbGFzcz0nbUNTQl9kcmFnZ2VyX2JhcicgLz48L2Rpdj48ZGl2IGNsYXNzPSdtQ1NCX2RyYWdnZXJSYWlsJyAvPjwvZGl2PjwvZGl2PlwiXSxzPVwieXhcIj09PW8uYXhpcz9cIm1DU0JfdmVydGljYWxfaG9yaXpvbnRhbFwiOlwieFwiPT09by5heGlzP1wibUNTQl9ob3Jpem9udGFsXCI6XCJtQ1NCX3ZlcnRpY2FsXCIsYz1cInl4XCI9PT1vLmF4aXM/bFswXStsWzFdOlwieFwiPT09by5heGlzP2xbMV06bFswXSxkPVwieXhcIj09PW8uYXhpcz9cIjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyX3dyYXBwZXInIGNsYXNzPSdtQ1NCX2NvbnRhaW5lcl93cmFwcGVyJyAvPlwiOlwiXCIsdT1vLmF1dG9IaWRlU2Nyb2xsYmFyP1wiIFwiK2ZbNl06XCJcIixoPVwieFwiIT09by5heGlzJiZcInJ0bFwiPT09YS5sYW5nRGlyP1wiIFwiK2ZbN106XCJcIjtvLnNldFdpZHRoJiZ0LmNzcyhcIndpZHRoXCIsby5zZXRXaWR0aCksby5zZXRIZWlnaHQmJnQuY3NzKFwiaGVpZ2h0XCIsby5zZXRIZWlnaHQpLG8uc2V0TGVmdD1cInlcIiE9PW8uYXhpcyYmXCJydGxcIj09PWEubGFuZ0Rpcj9cIjk4OTk5OXB4XCI6by5zZXRMZWZ0LHQuYWRkQ2xhc3MobitcIiBfXCIraStcIl9cIithLmlkeCt1K2gpLndyYXBJbm5lcihcIjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCInIGNsYXNzPSdtQ3VzdG9tU2Nyb2xsQm94IG1DUy1cIitvLnRoZW1lK1wiIFwiK3MrXCInPjxkaXYgaWQ9J21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyJyBjbGFzcz0nbUNTQl9jb250YWluZXInIHN0eWxlPSdwb3NpdGlvbjpyZWxhdGl2ZTsgdG9wOlwiK28uc2V0VG9wK1wiOyBsZWZ0OlwiK28uc2V0TGVmdCtcIjsnIGRpcj1cIithLmxhbmdEaXIrXCIgLz48L2Rpdj5cIik7dmFyIG09ZShcIiNtQ1NCX1wiK2EuaWR4KSxwPWUoXCIjbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJcIik7XCJ5XCI9PT1vLmF4aXN8fG8uYWR2YW5jZWQuYXV0b0V4cGFuZEhvcml6b250YWxTY3JvbGx8fHAuY3NzKFwid2lkdGhcIixTKHAuY2hpbGRyZW4oKSkpLFwib3V0c2lkZVwiPT09by5zY3JvbGxiYXJQb3NpdGlvbj8oXCJzdGF0aWNcIj09PXQuY3NzKFwicG9zaXRpb25cIikmJnQuY3NzKFwicG9zaXRpb25cIixcInJlbGF0aXZlXCIpLHQuY3NzKFwib3ZlcmZsb3dcIixcInZpc2libGVcIiksbS5hZGRDbGFzcyhcIm1DU0Jfb3V0c2lkZVwiKS5hZnRlcihjKSk6KG0uYWRkQ2xhc3MoXCJtQ1NCX2luc2lkZVwiKS5hcHBlbmQoYykscC53cmFwKGQpKSxiLmNhbGwodGhpcyk7dmFyIGc9W2UoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLGUoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIildO2dbMF0uY3NzKFwibWluLWhlaWdodFwiLGdbMF0uaGVpZ2h0KCkpLGdbMV0uY3NzKFwibWluLXdpZHRoXCIsZ1sxXS53aWR0aCgpKX0sUz1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCx0Lm1hcChmdW5jdGlvbigpe3JldHVybiBlKHRoaXMpLm91dGVyV2lkdGgoITApfSkuZ2V0KCkpfSx3PWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWEub3B0LG49ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKTtvLmFkdmFuY2VkLmF1dG9FeHBhbmRIb3Jpem9udGFsU2Nyb2xsJiZcInlcIiE9PW8uYXhpcyYmbi5jc3Moe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIix3aWR0aDpcImF1dG9cIn0pLndyYXAoXCI8ZGl2IGNsYXNzPSdtQ1NCX2hfd3JhcHBlcicgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlOyBsZWZ0OjA7IHdpZHRoOjk5OTk5OXB4OycgLz5cIikuY3NzKHt3aWR0aDpNYXRoLmNlaWwoblswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCsuNCktTWF0aC5mbG9vcihuWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQpLHBvc2l0aW9uOlwicmVsYXRpdmVcIn0pLnVud3JhcCgpfSxiPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWEub3B0LG49ZShcIi5tQ1NCX1wiK2EuaWR4K1wiX3Njcm9sbGJhcjpmaXJzdFwiKSxyPWF0KG8uc2Nyb2xsQnV0dG9ucy50YWJpbmRleCk/XCJ0YWJpbmRleD0nXCIrby5zY3JvbGxCdXR0b25zLnRhYmluZGV4K1wiJ1wiOlwiXCIsbD1bXCI8YSBocmVmPScjJyBjbGFzcz0nXCIrZlsxM10rXCInIG9uY29udGV4dG1lbnU9J3JldHVybiBmYWxzZTsnIFwiK3IrXCIgLz5cIixcIjxhIGhyZWY9JyMnIGNsYXNzPSdcIitmWzE0XStcIicgb25jb250ZXh0bWVudT0ncmV0dXJuIGZhbHNlOycgXCIrcitcIiAvPlwiLFwiPGEgaHJlZj0nIycgY2xhc3M9J1wiK2ZbMTVdK1wiJyBvbmNvbnRleHRtZW51PSdyZXR1cm4gZmFsc2U7JyBcIityK1wiIC8+XCIsXCI8YSBocmVmPScjJyBjbGFzcz0nXCIrZlsxNl0rXCInIG9uY29udGV4dG1lbnU9J3JldHVybiBmYWxzZTsnIFwiK3IrXCIgLz5cIl0scz1bXCJ4XCI9PT1vLmF4aXM/bFsyXTpsWzBdLFwieFwiPT09by5heGlzP2xbM106bFsxXSxsWzJdLGxbM11dO28uc2Nyb2xsQnV0dG9ucy5lbmFibGUmJm4ucHJlcGVuZChzWzBdKS5hcHBlbmQoc1sxXSkubmV4dChcIi5tQ1NCX3Njcm9sbFRvb2xzXCIpLnByZXBlbmQoc1syXSkuYXBwZW5kKHNbM10pfSxDPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWUoXCIjbUNTQl9cIithLmlkeCksbj10LmNzcyhcIm1heC1oZWlnaHRcIil8fFwibm9uZVwiLHI9LTEhPT1uLmluZGV4T2YoXCIlXCIpLGw9dC5jc3MoXCJib3gtc2l6aW5nXCIpO2lmKFwibm9uZVwiIT09bil7dmFyIHM9cj90LnBhcmVudCgpLmhlaWdodCgpKnBhcnNlSW50KG4pLzEwMDpwYXJzZUludChuKTtcImJvcmRlci1ib3hcIj09PWwmJihzLT10LmlubmVySGVpZ2h0KCktdC5oZWlnaHQoKSsodC5vdXRlckhlaWdodCgpLXQuaW5uZXJIZWlnaHQoKSkpLG8uY3NzKFwibWF4LWhlaWdodFwiLE1hdGgucm91bmQocykpfX0seT1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1lKFwiI21DU0JfXCIrYS5pZHgpLG49ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKSxyPVtlKFwiI21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXSxsPVtvLmhlaWdodCgpL24ub3V0ZXJIZWlnaHQoITEpLG8ud2lkdGgoKS9uLm91dGVyV2lkdGgoITEpXSxzPVtwYXJzZUludChyWzBdLmNzcyhcIm1pbi1oZWlnaHRcIikpLE1hdGgucm91bmQobFswXSpyWzBdLnBhcmVudCgpLmhlaWdodCgpKSxwYXJzZUludChyWzFdLmNzcyhcIm1pbi13aWR0aFwiKSksTWF0aC5yb3VuZChsWzFdKnJbMV0ucGFyZW50KCkud2lkdGgoKSldLGM9ZCYmc1sxXTxzWzBdP3NbMF06c1sxXSx1PWQmJnNbM108c1syXT9zWzJdOnNbM107clswXS5jc3Moe2hlaWdodDpjLFwibWF4LWhlaWdodFwiOnJbMF0ucGFyZW50KCkuaGVpZ2h0KCktMTB9KS5maW5kKFwiLm1DU0JfZHJhZ2dlcl9iYXJcIikuY3NzKHtcImxpbmUtaGVpZ2h0XCI6c1swXStcInB4XCJ9KSxyWzFdLmNzcyh7d2lkdGg6dSxcIm1heC13aWR0aFwiOnJbMV0ucGFyZW50KCkud2lkdGgoKS0xMH0pfSxCPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWUoXCIjbUNTQl9cIithLmlkeCksbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLHI9W2UoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLGUoXCIjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWxcIildLGw9W24ub3V0ZXJIZWlnaHQoITEpLW8uaGVpZ2h0KCksbi5vdXRlcldpZHRoKCExKS1vLndpZHRoKCldLHM9W2xbMF0vKHJbMF0ucGFyZW50KCkuaGVpZ2h0KCktclswXS5oZWlnaHQoKSksbFsxXS8oclsxXS5wYXJlbnQoKS53aWR0aCgpLXJbMV0ud2lkdGgoKSldO2Euc2Nyb2xsUmF0aW89e3k6c1swXSx4OnNbMV19fSxUPWZ1bmN0aW9uKGUsdCxhKXt2YXIgbz1hP2ZbMF0rXCJfZXhwYW5kZWRcIjpcIlwiLG49ZS5jbG9zZXN0KFwiLm1DU0Jfc2Nyb2xsVG9vbHNcIik7XCJhY3RpdmVcIj09PXQ/KGUudG9nZ2xlQ2xhc3MoZlswXStcIiBcIitvKSxuLnRvZ2dsZUNsYXNzKGZbMV0pLGVbMF0uX2RyYWdnYWJsZT1lWzBdLl9kcmFnZ2FibGU/MDoxKTplWzBdLl9kcmFnZ2FibGV8fChcImhpZGVcIj09PXQ/KGUucmVtb3ZlQ2xhc3MoZlswXSksbi5yZW1vdmVDbGFzcyhmWzFdKSk6KGUuYWRkQ2xhc3MoZlswXSksbi5hZGRDbGFzcyhmWzFdKSkpfSxrPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxhPXQuZGF0YShpKSxvPWUoXCIjbUNTQl9cIithLmlkeCksbj1lKFwiI21DU0JfXCIrYS5pZHgrXCJfY29udGFpbmVyXCIpLHI9bnVsbD09YS5vdmVyZmxvd2VkP24uaGVpZ2h0KCk6bi5vdXRlckhlaWdodCghMSksbD1udWxsPT1hLm92ZXJmbG93ZWQ/bi53aWR0aCgpOm4ub3V0ZXJXaWR0aCghMSk7cmV0dXJuW3I+by5oZWlnaHQoKSxsPm8ud2lkdGgoKV19LE09ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89YS5vcHQsbj1lKFwiI21DU0JfXCIrYS5pZHgpLHI9ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKSxsPVtlKFwiI21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbFwiKSxlKFwiI21DU0JfXCIrYS5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpXTtpZihRKHQpLChcInhcIiE9PW8uYXhpcyYmIWEub3ZlcmZsb3dlZFswXXx8XCJ5XCI9PT1vLmF4aXMmJmEub3ZlcmZsb3dlZFswXSkmJihsWzBdLmFkZChyKS5jc3MoXCJ0b3BcIiwwKSxHKHQsXCJfcmVzZXRZXCIpKSxcInlcIiE9PW8uYXhpcyYmIWEub3ZlcmZsb3dlZFsxXXx8XCJ4XCI9PT1vLmF4aXMmJmEub3ZlcmZsb3dlZFsxXSl7dmFyIHM9ZHg9MDtcInJ0bFwiPT09YS5sYW5nRGlyJiYocz1uLndpZHRoKCktci5vdXRlcldpZHRoKCExKSxkeD1NYXRoLmFicyhzL2Euc2Nyb2xsUmF0aW8ueCkpLHIuY3NzKFwibGVmdFwiLHMpLGxbMV0uY3NzKFwibGVmdFwiLGR4KSxHKHQsXCJfcmVzZXRYXCIpfX0sTz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXtyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLmV2ZW50LnNwZWNpYWwubW91c2V3aGVlbD8oY2xlYXJUaW1lb3V0KHIpLEEuY2FsbChhWzBdKSk6dCgpfSwxMDApfXZhciBhPWUodGhpcyksbz1hLmRhdGEoaSksbj1vLm9wdDtpZighby5iaW5kRXZlbnRzKXtpZihELmNhbGwodGhpcyksbi5jb250ZW50VG91Y2hTY3JvbGwmJkwuY2FsbCh0aGlzKSxXLmNhbGwodGhpcyksbi5tb3VzZVdoZWVsLmVuYWJsZSl7dmFyIHI7dCgpfXouY2FsbCh0aGlzKSxVLmNhbGwodGhpcyksbi5hZHZhbmNlZC5hdXRvU2Nyb2xsT25Gb2N1cyYmSC5jYWxsKHRoaXMpLG4uc2Nyb2xsQnV0dG9ucy5lbmFibGUmJkYuY2FsbCh0aGlzKSxuLmtleWJvYXJkLmVuYWJsZSYmcS5jYWxsKHRoaXMpLG8uYmluZEV2ZW50cz0hMH19LEk9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLG89dC5kYXRhKGkpLG49by5vcHQscj1pK1wiX1wiK28uaWR4LGw9XCIubUNTQl9cIitvLmlkeCtcIl9zY3JvbGxiYXJcIixzPWUoXCIjbUNTQl9cIitvLmlkeCtcIiwjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXIsI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyX3dyYXBwZXIsXCIrbCtcIiAuXCIrZlsxMl0rXCIsI21DU0JfXCIrby5pZHgrXCJfZHJhZ2dlcl92ZXJ0aWNhbCwjbUNTQl9cIitvLmlkeCtcIl9kcmFnZ2VyX2hvcml6b250YWwsXCIrbCtcIj5hXCIpLGM9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKTtuLmFkdmFuY2VkLnJlbGVhc2VEcmFnZ2FibGVTZWxlY3RvcnMmJnMuYWRkKGUobi5hZHZhbmNlZC5yZWxlYXNlRHJhZ2dhYmxlU2VsZWN0b3JzKSksby5iaW5kRXZlbnRzJiYoZShhKS51bmJpbmQoXCIuXCIrcikscy5lYWNoKGZ1bmN0aW9uKCl7ZSh0aGlzKS51bmJpbmQoXCIuXCIrcil9KSxjbGVhclRpbWVvdXQodFswXS5fZm9jdXNUaW1lb3V0KSwkKHRbMF0sXCJfZm9jdXNUaW1lb3V0XCIpLGNsZWFyVGltZW91dChvLnNlcXVlbnRpYWwuc3RlcCksJChvLnNlcXVlbnRpYWwsXCJzdGVwXCIpLGNsZWFyVGltZW91dChjWzBdLm9uQ29tcGxldGVUaW1lb3V0KSwkKGNbMF0sXCJvbkNvbXBsZXRlVGltZW91dFwiKSxvLmJpbmRFdmVudHM9ITEpfSxSPWZ1bmN0aW9uKHQpe3ZhciBhPWUodGhpcyksbz1hLmRhdGEoaSksbj1vLm9wdCxyPWUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJfd3JhcHBlclwiKSxsPXIubGVuZ3RoP3I6ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKSxzPVtlKFwiI21DU0JfXCIrby5pZHgrXCJfc2Nyb2xsYmFyX3ZlcnRpY2FsXCIpLGUoXCIjbUNTQl9cIitvLmlkeCtcIl9zY3JvbGxiYXJfaG9yaXpvbnRhbFwiKV0sYz1bc1swXS5maW5kKFwiLm1DU0JfZHJhZ2dlclwiKSxzWzFdLmZpbmQoXCIubUNTQl9kcmFnZ2VyXCIpXTtcInhcIiE9PW4uYXhpcyYmKG8ub3ZlcmZsb3dlZFswXSYmIXQ/KHNbMF0uYWRkKGNbMF0pLmFkZChzWzBdLmNoaWxkcmVuKFwiYVwiKSkuY3NzKFwiZGlzcGxheVwiLFwiYmxvY2tcIiksbC5yZW1vdmVDbGFzcyhmWzhdK1wiIFwiK2ZbMTBdKSk6KG4uYWx3YXlzU2hvd1Njcm9sbGJhcj8oMiE9PW4uYWx3YXlzU2hvd1Njcm9sbGJhciYmY1swXS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpLGwucmVtb3ZlQ2xhc3MoZlsxMF0pKTooc1swXS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpLGwuYWRkQ2xhc3MoZlsxMF0pKSxsLmFkZENsYXNzKGZbOF0pKSksXCJ5XCIhPT1uLmF4aXMmJihvLm92ZXJmbG93ZWRbMV0mJiF0PyhzWzFdLmFkZChjWzFdKS5hZGQoc1sxXS5jaGlsZHJlbihcImFcIikpLmNzcyhcImRpc3BsYXlcIixcImJsb2NrXCIpLGwucmVtb3ZlQ2xhc3MoZls5XStcIiBcIitmWzExXSkpOihuLmFsd2F5c1Nob3dTY3JvbGxiYXI/KDIhPT1uLmFsd2F5c1Nob3dTY3JvbGxiYXImJmNbMV0uY3NzKFwiZGlzcGxheVwiLFwibm9uZVwiKSxsLnJlbW92ZUNsYXNzKGZbMTFdKSk6KHNbMV0uY3NzKFwiZGlzcGxheVwiLFwibm9uZVwiKSxsLmFkZENsYXNzKGZbMTFdKSksbC5hZGRDbGFzcyhmWzldKSkpLG8ub3ZlcmZsb3dlZFswXXx8by5vdmVyZmxvd2VkWzFdP2EucmVtb3ZlQ2xhc3MoZls1XSk6YS5hZGRDbGFzcyhmWzVdKX0sRT1mdW5jdGlvbihlKXt2YXIgdD1lLnR5cGU7c3dpdGNoKHQpe2Nhc2VcInBvaW50ZXJkb3duXCI6Y2FzZVwiTVNQb2ludGVyRG93blwiOmNhc2VcInBvaW50ZXJtb3ZlXCI6Y2FzZVwiTVNQb2ludGVyTW92ZVwiOmNhc2VcInBvaW50ZXJ1cFwiOmNhc2VcIk1TUG9pbnRlclVwXCI6cmV0dXJuW2Uub3JpZ2luYWxFdmVudC5wYWdlWSxlLm9yaWdpbmFsRXZlbnQucGFnZVgsITFdO2Nhc2VcInRvdWNoc3RhcnRcIjpjYXNlXCJ0b3VjaG1vdmVcIjpjYXNlXCJ0b3VjaGVuZFwiOnZhciBhPWUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdfHxlLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0sbz1lLm9yaWdpbmFsRXZlbnQudG91Y2hlcy5sZW5ndGh8fGUub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcy5sZW5ndGg7cmV0dXJuW2EucGFnZVksYS5wYWdlWCxvPjFdO2RlZmF1bHQ6cmV0dXJuW2UucGFnZVksZS5wYWdlWCwhMV19fSxEPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlKXt2YXIgdD1wLmZpbmQoXCJpZnJhbWVcIik7aWYodC5sZW5ndGgpe3ZhciBhPWU/XCJhdXRvXCI6XCJub25lXCI7dC5jc3MoXCJwb2ludGVyLWV2ZW50c1wiLGEpfX1mdW5jdGlvbiBvKGUsdCxhLG8pe2lmKHBbMF0uaWRsZVRpbWVyPWYuc2Nyb2xsSW5lcnRpYTwyMzM/MjUwOjAsbi5hdHRyKFwiaWRcIik9PT1tWzFdKXZhciBpPVwieFwiLHI9KG5bMF0ub2Zmc2V0TGVmdC10K28pKmMuc2Nyb2xsUmF0aW8ueDtlbHNlIHZhciBpPVwieVwiLHI9KG5bMF0ub2Zmc2V0VG9wLWUrYSkqYy5zY3JvbGxSYXRpby55O0cocyxyLnRvU3RyaW5nKCkse2RpcjppLGRyYWc6ITB9KX12YXIgbixyLGwscz1lKHRoaXMpLGM9cy5kYXRhKGkpLGY9Yy5vcHQsaD1pK1wiX1wiK2MuaWR4LG09W1wibUNTQl9cIitjLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIsXCJtQ1NCX1wiK2MuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiXSxwPWUoXCIjbUNTQl9cIitjLmlkeCtcIl9jb250YWluZXJcIiksZz1lKFwiI1wiK21bMF0rXCIsI1wiK21bMV0pLHY9Zi5hZHZhbmNlZC5yZWxlYXNlRHJhZ2dhYmxlU2VsZWN0b3JzP2cuYWRkKGUoZi5hZHZhbmNlZC5yZWxlYXNlRHJhZ2dhYmxlU2VsZWN0b3JzKSk6ZztnLmJpbmQoXCJtb3VzZWRvd24uXCIraCtcIiB0b3VjaHN0YXJ0LlwiK2grXCIgcG9pbnRlcmRvd24uXCIraCtcIiBNU1BvaW50ZXJEb3duLlwiK2gsZnVuY3Rpb24obyl7aWYoby5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxvLnByZXZlbnREZWZhdWx0KCksZXQobykpe3U9ITAsZCYmKGEub25zZWxlY3RzdGFydD1mdW5jdGlvbigpe3JldHVybiExfSksdCghMSksUShzKSxuPWUodGhpcyk7dmFyIGk9bi5vZmZzZXQoKSxjPUUobylbMF0taS50b3AsaD1FKG8pWzFdLWkubGVmdCxtPW4uaGVpZ2h0KCkraS50b3AscD1uLndpZHRoKCkraS5sZWZ0O20+YyYmYz4wJiZwPmgmJmg+MCYmKHI9YyxsPWgpLFQobixcImFjdGl2ZVwiLGYuYXV0b0V4cGFuZFNjcm9sbGJhcil9fSkuYmluZChcInRvdWNobW92ZS5cIitoLGZ1bmN0aW9uKGUpe2Uuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksZS5wcmV2ZW50RGVmYXVsdCgpO3ZhciB0PW4ub2Zmc2V0KCksYT1FKGUpWzBdLXQudG9wLGk9RShlKVsxXS10LmxlZnQ7byhyLGwsYSxpKX0pLGUoYSkuYmluZChcIm1vdXNlbW92ZS5cIitoK1wiIHBvaW50ZXJtb3ZlLlwiK2grXCIgTVNQb2ludGVyTW92ZS5cIitoLGZ1bmN0aW9uKGUpe2lmKG4pe3ZhciB0PW4ub2Zmc2V0KCksYT1FKGUpWzBdLXQudG9wLGk9RShlKVsxXS10LmxlZnQ7aWYocj09PWEpcmV0dXJuO28ocixsLGEsaSl9fSkuYWRkKHYpLmJpbmQoXCJtb3VzZXVwLlwiK2grXCIgdG91Y2hlbmQuXCIraCtcIiBwb2ludGVydXAuXCIraCtcIiBNU1BvaW50ZXJVcC5cIitoLGZ1bmN0aW9uKCl7biYmKFQobixcImFjdGl2ZVwiLGYuYXV0b0V4cGFuZFNjcm9sbGJhciksbj1udWxsKSx1PSExLGQmJihhLm9uc2VsZWN0c3RhcnQ9bnVsbCksdCghMCl9KX0sTD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSx0KXt2YXIgYT1bMS41KnQsMip0LHQvMS41LHQvMl07cmV0dXJuIGU+OTA/dD40P2FbMF06YVszXTplPjYwP3Q+Mz9hWzNdOmFbMl06ZT4zMD90Pjg/YVsxXTp0PjY/YVswXTp0PjQ/dDphWzJdOnQ+OD90OmFbM119ZnVuY3Rpb24gYShlLHQsYSxvLG4saSl7ZSYmRyhfLGUudG9TdHJpbmcoKSx7ZHVyOnQsc2Nyb2xsRWFzaW5nOmEsZGlyOm8sb3ZlcndyaXRlOm4sZHJhZzppfSl9dmFyIG4scixsLHMsYyxkLGYsaCxtLHAsZyx2LHgsXz1lKHRoaXMpLFM9Xy5kYXRhKGkpLHc9Uy5vcHQsYj1pK1wiX1wiK1MuaWR4LEM9ZShcIiNtQ1NCX1wiK1MuaWR4KSx5PWUoXCIjbUNTQl9cIitTLmlkeCtcIl9jb250YWluZXJcIiksQj1bZShcIiNtQ1NCX1wiK1MuaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK1MuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKV0sVD1bXSxrPVtdLE09MCxPPVwieXhcIj09PXcuYXhpcz9cIm5vbmVcIjpcImFsbFwiLEk9W107eS5iaW5kKFwidG91Y2hzdGFydC5cIitiK1wiIHBvaW50ZXJkb3duLlwiK2IrXCIgTVNQb2ludGVyRG93bi5cIitiLGZ1bmN0aW9uKGUpe2lmKCF0dChlKXx8dXx8RShlKVsyXSlyZXR1cm4gdm9pZChvPTApO289MSx2PTAseD0wO3ZhciB0PXkub2Zmc2V0KCk7bj1FKGUpWzBdLXQudG9wLHI9RShlKVsxXS10LmxlZnQsST1bRShlKVswXSxFKGUpWzFdXX0pLmJpbmQoXCJ0b3VjaG1vdmUuXCIrYitcIiBwb2ludGVybW92ZS5cIitiK1wiIE1TUG9pbnRlck1vdmUuXCIrYixmdW5jdGlvbihlKXtpZih0dChlKSYmIXUmJiFFKGUpWzJdJiYoZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSwheHx8dikpe2Q9SygpO3ZhciB0PUMub2Zmc2V0KCksbz1FKGUpWzBdLXQudG9wLGk9RShlKVsxXS10LmxlZnQsbD1cIm1jc0xpbmVhck91dFwiO2lmKFQucHVzaChvKSxrLnB1c2goaSksSVsyXT1NYXRoLmFicyhFKGUpWzBdLUlbMF0pLElbM109TWF0aC5hYnMoRShlKVsxXS1JWzFdKSxTLm92ZXJmbG93ZWRbMF0pdmFyIHM9QlswXS5wYXJlbnQoKS5oZWlnaHQoKS1CWzBdLmhlaWdodCgpLGM9bi1vPjAmJm8tbj4tKHMqUy5zY3JvbGxSYXRpby55KSYmKDIqSVszXTxJWzJdfHxcInl4XCI9PT13LmF4aXMpO2lmKFMub3ZlcmZsb3dlZFsxXSl2YXIgZj1CWzFdLnBhcmVudCgpLndpZHRoKCktQlsxXS53aWR0aCgpLGg9ci1pPjAmJmktcj4tKGYqUy5zY3JvbGxSYXRpby54KSYmKDIqSVsyXTxJWzNdfHxcInl4XCI9PT13LmF4aXMpO2N8fGg/KGUucHJldmVudERlZmF1bHQoKSx2PTEpOng9MSxwPVwieXhcIj09PXcuYXhpcz9bbi1vLHItaV06XCJ4XCI9PT13LmF4aXM/W251bGwsci1pXTpbbi1vLG51bGxdLHlbMF0uaWRsZVRpbWVyPTI1MCxTLm92ZXJmbG93ZWRbMF0mJmEocFswXSxNLGwsXCJ5XCIsXCJhbGxcIiwhMCksUy5vdmVyZmxvd2VkWzFdJiZhKHBbMV0sTSxsLFwieFwiLE8sITApfX0pLEMuYmluZChcInRvdWNoc3RhcnQuXCIrYitcIiBwb2ludGVyZG93bi5cIitiK1wiIE1TUG9pbnRlckRvd24uXCIrYixmdW5jdGlvbihlKXtpZighdHQoZSl8fHV8fEUoZSlbMl0pcmV0dXJuIHZvaWQobz0wKTtvPTEsZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxRKF8pLGM9SygpO3ZhciB0PUMub2Zmc2V0KCk7bD1FKGUpWzBdLXQudG9wLHM9RShlKVsxXS10LmxlZnQsVD1bXSxrPVtdfSkuYmluZChcInRvdWNoZW5kLlwiK2IrXCIgcG9pbnRlcnVwLlwiK2IrXCIgTVNQb2ludGVyVXAuXCIrYixmdW5jdGlvbihlKXtpZih0dChlKSYmIXUmJiFFKGUpWzJdKXtlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLHY9MCx4PTAsZj1LKCk7dmFyIG89Qy5vZmZzZXQoKSxuPUUoZSlbMF0tby50b3AsaT1FKGUpWzFdLW8ubGVmdDtpZighKGYtZD4zMCkpe209MWUzLyhmLWMpO3ZhciByPVwibWNzRWFzZU91dFwiLF89Mi41Pm0sYj1fP1tUW1QubGVuZ3RoLTJdLGtbay5sZW5ndGgtMl1dOlswLDBdO2g9Xz9bbi1iWzBdLGktYlsxXV06W24tbCxpLXNdO3ZhciBCPVtNYXRoLmFicyhoWzBdKSxNYXRoLmFicyhoWzFdKV07bT1fP1tNYXRoLmFicyhoWzBdLzQpLE1hdGguYWJzKGhbMV0vNCldOlttLG1dO3ZhciBNPVtNYXRoLmFicyh5WzBdLm9mZnNldFRvcCktaFswXSp0KEJbMF0vbVswXSxtWzBdKSxNYXRoLmFicyh5WzBdLm9mZnNldExlZnQpLWhbMV0qdChCWzFdL21bMV0sbVsxXSldO3A9XCJ5eFwiPT09dy5heGlzP1tNWzBdLE1bMV1dOlwieFwiPT09dy5heGlzP1tudWxsLE1bMV1dOltNWzBdLG51bGxdLGc9WzQqQlswXSt3LnNjcm9sbEluZXJ0aWEsNCpCWzFdK3cuc2Nyb2xsSW5lcnRpYV07dmFyIEk9cGFyc2VJbnQody5jb250ZW50VG91Y2hTY3JvbGwpfHwwO3BbMF09QlswXT5JP3BbMF06MCxwWzFdPUJbMV0+ST9wWzFdOjAsUy5vdmVyZmxvd2VkWzBdJiZhKHBbMF0sZ1swXSxyLFwieVwiLE8sITEpLFMub3ZlcmZsb3dlZFsxXSYmYShwWzFdLGdbMV0scixcInhcIixPLCExKX19fSl9LFc9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKCl7cmV0dXJuIHQuZ2V0U2VsZWN0aW9uP3QuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKTphLnNlbGVjdGlvbiYmXCJDb250cm9sXCIhPWEuc2VsZWN0aW9uLnR5cGU/YS5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS50ZXh0OjB9ZnVuY3Rpb24gcihlLHQsYSl7Zi50eXBlPWEmJmw/XCJzdGVwcGVkXCI6XCJzdGVwbGVzc1wiLGYuc2Nyb2xsQW1vdW50PTEwLGoocyxlLHQsXCJtY3NMaW5lYXJPdXRcIixhPzYwOm51bGwpfXZhciBsLHM9ZSh0aGlzKSxjPXMuZGF0YShpKSxkPWMub3B0LGY9Yy5zZXF1ZW50aWFsLGg9aStcIl9cIitjLmlkeCxtPWUoXCIjbUNTQl9cIitjLmlkeCtcIl9jb250YWluZXJcIikscD1tLnBhcmVudCgpO20uYmluZChcIm1vdXNlZG93bi5cIitoLGZ1bmN0aW9uKCl7b3x8bHx8KGw9MSx1PSEwKX0pLmFkZChhKS5iaW5kKFwibW91c2Vtb3ZlLlwiK2gsZnVuY3Rpb24oZSl7aWYoIW8mJmwmJm4oKSl7dmFyIHQ9bS5vZmZzZXQoKSxhPUUoZSlbMF0tdC50b3ArbVswXS5vZmZzZXRUb3AsaT1FKGUpWzFdLXQubGVmdCttWzBdLm9mZnNldExlZnQ7YT4wJiZhPHAuaGVpZ2h0KCkmJmk+MCYmaTxwLndpZHRoKCk/Zi5zdGVwJiZyKFwib2ZmXCIsbnVsbCxcInN0ZXBwZWRcIik6KFwieFwiIT09ZC5heGlzJiZjLm92ZXJmbG93ZWRbMF0mJigwPmE/cihcIm9uXCIsMzgpOmE+cC5oZWlnaHQoKSYmcihcIm9uXCIsNDApKSxcInlcIiE9PWQuYXhpcyYmYy5vdmVyZmxvd2VkWzFdJiYoMD5pP3IoXCJvblwiLDM3KTppPnAud2lkdGgoKSYmcihcIm9uXCIsMzkpKSl9fSkuYmluZChcIm1vdXNldXAuXCIraCxmdW5jdGlvbigpe298fChsJiYobD0wLHIoXCJvZmZcIixudWxsKSksdT0hMSl9KX0sQT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dmFyIHQ9bnVsbDt0cnl7dmFyIGE9ZS5jb250ZW50RG9jdW1lbnR8fGUuY29udGVudFdpbmRvdy5kb2N1bWVudDt0PWEuYm9keS5pbm5lckhUTUx9Y2F0Y2gobyl7fXJldHVybiBudWxsIT09dH12YXIgYT1lKHRoaXMpLG89YS5kYXRhKGkpO2lmKG8pe3ZhciBuPW8ub3B0LHI9aStcIl9cIitvLmlkeCxsPWUoXCIjbUNTQl9cIitvLmlkeCkscz1bZShcIiNtQ1NCX1wiK28uaWR4K1wiX2RyYWdnZXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK28uaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKV0sYz1lKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpLmZpbmQoXCJpZnJhbWVcIiksdT1sO2MubGVuZ3RoJiZjLmVhY2goZnVuY3Rpb24oKXt2YXIgYT10aGlzO3QoYSkmJih1PXUuYWRkKGUoYSkuY29udGVudHMoKS5maW5kKFwiYm9keVwiKSkpfSksdS5iaW5kKFwibW91c2V3aGVlbC5cIityLGZ1bmN0aW9uKHQsaSl7aWYoUShhKSwhUChhLHQudGFyZ2V0KSl7dmFyIHI9XCJhdXRvXCIhPT1uLm1vdXNlV2hlZWwuZGVsdGFGYWN0b3I/cGFyc2VJbnQobi5tb3VzZVdoZWVsLmRlbHRhRmFjdG9yKTpkJiZ0LmRlbHRhRmFjdG9yPDEwMD8xMDA6dC5kZWx0YUZhY3Rvcnx8MTAwO2lmKFwieFwiPT09bi5heGlzfHxcInhcIj09PW4ubW91c2VXaGVlbC5heGlzKXZhciBjPVwieFwiLHU9W01hdGgucm91bmQocipvLnNjcm9sbFJhdGlvLngpLHBhcnNlSW50KG4ubW91c2VXaGVlbC5zY3JvbGxBbW91bnQpXSxmPVwiYXV0b1wiIT09bi5tb3VzZVdoZWVsLnNjcm9sbEFtb3VudD91WzFdOnVbMF0+PWwud2lkdGgoKT8uOSpsLndpZHRoKCk6dVswXSxoPU1hdGguYWJzKGUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJcIilbMF0ub2Zmc2V0TGVmdCksbT1zWzFdWzBdLm9mZnNldExlZnQscD1zWzFdLnBhcmVudCgpLndpZHRoKCktc1sxXS53aWR0aCgpLGc9dC5kZWx0YVh8fHQuZGVsdGFZfHxpO2Vsc2UgdmFyIGM9XCJ5XCIsdT1bTWF0aC5yb3VuZChyKm8uc2Nyb2xsUmF0aW8ueSkscGFyc2VJbnQobi5tb3VzZVdoZWVsLnNjcm9sbEFtb3VudCldLGY9XCJhdXRvXCIhPT1uLm1vdXNlV2hlZWwuc2Nyb2xsQW1vdW50P3VbMV06dVswXT49bC5oZWlnaHQoKT8uOSpsLmhlaWdodCgpOnVbMF0saD1NYXRoLmFicyhlKFwiI21DU0JfXCIrby5pZHgrXCJfY29udGFpbmVyXCIpWzBdLm9mZnNldFRvcCksbT1zWzBdWzBdLm9mZnNldFRvcCxwPXNbMF0ucGFyZW50KCkuaGVpZ2h0KCktc1swXS5oZWlnaHQoKSxnPXQuZGVsdGFZfHxpO1wieVwiPT09YyYmIW8ub3ZlcmZsb3dlZFswXXx8XCJ4XCI9PT1jJiYhby5vdmVyZmxvd2VkWzFdfHwobi5tb3VzZVdoZWVsLmludmVydCYmKGc9LWcpLG4ubW91c2VXaGVlbC5ub3JtYWxpemVEZWx0YSYmKGc9MD5nPy0xOjEpLChnPjAmJjAhPT1tfHwwPmcmJm0hPT1wfHxuLm1vdXNlV2hlZWwucHJldmVudERlZmF1bHQpJiYodC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0LnByZXZlbnREZWZhdWx0KCkpLEcoYSwoaC1nKmYpLnRvU3RyaW5nKCkse2RpcjpjfSkpfX0pfX0sUD1mdW5jdGlvbih0LGEpe3ZhciBvPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxuPXQuZGF0YShpKS5vcHQubW91c2VXaGVlbC5kaXNhYmxlT3ZlcixyPVtcInNlbGVjdFwiLFwidGV4dGFyZWFcIl07cmV0dXJuIGUuaW5BcnJheShvLG4pPi0xJiYhKGUuaW5BcnJheShvLHIpPi0xJiYhZShhKS5pcyhcIjpmb2N1c1wiKSl9LHo9ZnVuY3Rpb24oKXt2YXIgdD1lKHRoaXMpLGE9dC5kYXRhKGkpLG89aStcIl9cIithLmlkeCxuPWUoXCIjbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJcIikscj1uLnBhcmVudCgpLGw9ZShcIi5tQ1NCX1wiK2EuaWR4K1wiX3Njcm9sbGJhciAuXCIrZlsxMl0pO2wuYmluZChcInRvdWNoc3RhcnQuXCIrbytcIiBwb2ludGVyZG93bi5cIitvK1wiIE1TUG9pbnRlckRvd24uXCIrbyxmdW5jdGlvbigpe3U9ITB9KS5iaW5kKFwidG91Y2hlbmQuXCIrbytcIiBwb2ludGVydXAuXCIrbytcIiBNU1BvaW50ZXJVcC5cIitvLGZ1bmN0aW9uKCl7dT0hMX0pLmJpbmQoXCJjbGljay5cIitvLGZ1bmN0aW9uKG8pe2lmKGUoby50YXJnZXQpLmhhc0NsYXNzKGZbMTJdKXx8ZShvLnRhcmdldCkuaGFzQ2xhc3MoXCJtQ1NCX2RyYWdnZXJSYWlsXCIpKXtRKHQpO3ZhciBpPWUodGhpcyksbD1pLmZpbmQoXCIubUNTQl9kcmFnZ2VyXCIpO2lmKGkucGFyZW50KFwiLm1DU0Jfc2Nyb2xsVG9vbHNfaG9yaXpvbnRhbFwiKS5sZW5ndGg+MCl7aWYoIWEub3ZlcmZsb3dlZFsxXSlyZXR1cm47dmFyIHM9XCJ4XCIsYz1vLnBhZ2VYPmwub2Zmc2V0KCkubGVmdD8tMToxLGQ9TWF0aC5hYnMoblswXS5vZmZzZXRMZWZ0KS0uOSpjKnIud2lkdGgoKX1lbHNle2lmKCFhLm92ZXJmbG93ZWRbMF0pcmV0dXJuO3ZhciBzPVwieVwiLGM9by5wYWdlWT5sLm9mZnNldCgpLnRvcD8tMToxLGQ9TWF0aC5hYnMoblswXS5vZmZzZXRUb3ApLS45KmMqci5oZWlnaHQoKX1HKHQsZC50b1N0cmluZygpLHtkaXI6cyxzY3JvbGxFYXNpbmc6XCJtY3NFYXNlSW5PdXRcIn0pfX0pfSxIPWZ1bmN0aW9uKCl7dmFyIHQ9ZSh0aGlzKSxvPXQuZGF0YShpKSxuPW8ub3B0LHI9aStcIl9cIitvLmlkeCxsPWUoXCIjbUNTQl9cIitvLmlkeCtcIl9jb250YWluZXJcIikscz1sLnBhcmVudCgpO2wuYmluZChcImZvY3VzaW4uXCIrcixmdW5jdGlvbigpe3ZhciBvPWUoYS5hY3RpdmVFbGVtZW50KSxpPWwuZmluZChcIi5tQ3VzdG9tU2Nyb2xsQm94XCIpLmxlbmd0aCxyPTA7by5pcyhuLmFkdmFuY2VkLmF1dG9TY3JvbGxPbkZvY3VzKSYmKFEodCksY2xlYXJUaW1lb3V0KHRbMF0uX2ZvY3VzVGltZW91dCksdFswXS5fZm9jdXNUaW1lcj1pPyhyKzE3KSppOjAsdFswXS5fZm9jdXNUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXt2YXIgZT1bb3QobylbMF0sb3QobylbMV1dLGE9W2xbMF0ub2Zmc2V0VG9wLGxbMF0ub2Zmc2V0TGVmdF0saT1bYVswXStlWzBdPj0wJiZhWzBdK2VbMF08cy5oZWlnaHQoKS1vLm91dGVySGVpZ2h0KCExKSxhWzFdK2VbMV0+PTAmJmFbMF0rZVsxXTxzLndpZHRoKCktby5vdXRlcldpZHRoKCExKV0sYz1cInl4XCIhPT1uLmF4aXN8fGlbMF18fGlbMV0/XCJhbGxcIjpcIm5vbmVcIjtcInhcIj09PW4uYXhpc3x8aVswXXx8Ryh0LGVbMF0udG9TdHJpbmcoKSx7ZGlyOlwieVwiLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwiLG92ZXJ3cml0ZTpjLGR1cjpyfSksXCJ5XCI9PT1uLmF4aXN8fGlbMV18fEcodCxlWzFdLnRvU3RyaW5nKCkse2RpcjpcInhcIixzY3JvbGxFYXNpbmc6XCJtY3NFYXNlSW5PdXRcIixvdmVyd3JpdGU6YyxkdXI6cn0pfSx0WzBdLl9mb2N1c1RpbWVyKSl9KX0sVT1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1pK1wiX1wiK2EuaWR4LG49ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lclwiKS5wYXJlbnQoKTtuLmJpbmQoXCJzY3JvbGwuXCIrbyxmdW5jdGlvbigpeygwIT09bi5zY3JvbGxUb3AoKXx8MCE9PW4uc2Nyb2xsTGVmdCgpKSYmZShcIi5tQ1NCX1wiK2EuaWR4K1wiX3Njcm9sbGJhclwiKS5jc3MoXCJ2aXNpYmlsaXR5XCIsXCJoaWRkZW5cIil9KX0sRj1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksYT10LmRhdGEoaSksbz1hLm9wdCxuPWEuc2VxdWVudGlhbCxyPWkrXCJfXCIrYS5pZHgsbD1cIi5tQ1NCX1wiK2EuaWR4K1wiX3Njcm9sbGJhclwiLHM9ZShsK1wiPmFcIik7cy5iaW5kKFwibW91c2Vkb3duLlwiK3IrXCIgdG91Y2hzdGFydC5cIityK1wiIHBvaW50ZXJkb3duLlwiK3IrXCIgTVNQb2ludGVyRG93bi5cIityK1wiIG1vdXNldXAuXCIrcitcIiB0b3VjaGVuZC5cIityK1wiIHBvaW50ZXJ1cC5cIityK1wiIE1TUG9pbnRlclVwLlwiK3IrXCIgbW91c2VvdXQuXCIrcitcIiBwb2ludGVyb3V0LlwiK3IrXCIgTVNQb2ludGVyT3V0LlwiK3IrXCIgY2xpY2suXCIrcixmdW5jdGlvbihpKXtmdW5jdGlvbiByKGUsYSl7bi5zY3JvbGxBbW91bnQ9by5zbmFwQW1vdW50fHxvLnNjcm9sbEJ1dHRvbnMuc2Nyb2xsQW1vdW50LGoodCxlLGEpfWlmKGkucHJldmVudERlZmF1bHQoKSxldChpKSl7dmFyIGw9ZSh0aGlzKS5hdHRyKFwiY2xhc3NcIik7c3dpdGNoKG4udHlwZT1vLnNjcm9sbEJ1dHRvbnMuc2Nyb2xsVHlwZSxpLnR5cGUpe2Nhc2VcIm1vdXNlZG93blwiOmNhc2VcInRvdWNoc3RhcnRcIjpjYXNlXCJwb2ludGVyZG93blwiOmNhc2VcIk1TUG9pbnRlckRvd25cIjppZihcInN0ZXBwZWRcIj09PW4udHlwZSlyZXR1cm47dT0hMCxhLnR3ZWVuUnVubmluZz0hMSxyKFwib25cIixsKTticmVhaztjYXNlXCJtb3VzZXVwXCI6Y2FzZVwidG91Y2hlbmRcIjpjYXNlXCJwb2ludGVydXBcIjpjYXNlXCJNU1BvaW50ZXJVcFwiOmNhc2VcIm1vdXNlb3V0XCI6Y2FzZVwicG9pbnRlcm91dFwiOmNhc2VcIk1TUG9pbnRlck91dFwiOmlmKFwic3RlcHBlZFwiPT09bi50eXBlKXJldHVybjt1PSExLG4uZGlyJiZyKFwib2ZmXCIsbCk7YnJlYWs7Y2FzZVwiY2xpY2tcIjppZihcInN0ZXBwZWRcIiE9PW4udHlwZXx8YS50d2VlblJ1bm5pbmcpcmV0dXJuO3IoXCJvblwiLGwpfX19KX0scT1mdW5jdGlvbigpe3ZhciB0PWUodGhpcyksbz10LmRhdGEoaSksbj1vLm9wdCxyPW8uc2VxdWVudGlhbCxsPWkrXCJfXCIrby5pZHgscz1lKFwiI21DU0JfXCIrby5pZHgpLGM9ZShcIiNtQ1NCX1wiK28uaWR4K1wiX2NvbnRhaW5lclwiKSxkPWMucGFyZW50KCksdT1cImlucHV0LHRleHRhcmVhLHNlbGVjdCxkYXRhbGlzdCxrZXlnZW4sW2NvbnRlbnRlZGl0YWJsZT0ndHJ1ZSddXCI7cy5hdHRyKFwidGFiaW5kZXhcIixcIjBcIikuYmluZChcImJsdXIuXCIrbCtcIiBrZXlkb3duLlwiK2wrXCIga2V5dXAuXCIrbCxmdW5jdGlvbihpKXtmdW5jdGlvbiBsKGUsYSl7ci50eXBlPW4ua2V5Ym9hcmQuc2Nyb2xsVHlwZSxyLnNjcm9sbEFtb3VudD1uLnNuYXBBbW91bnR8fG4ua2V5Ym9hcmQuc2Nyb2xsQW1vdW50LFwic3RlcHBlZFwiPT09ci50eXBlJiZvLnR3ZWVuUnVubmluZ3x8aih0LGUsYSl9c3dpdGNoKGkudHlwZSl7Y2FzZVwiYmx1clwiOm8udHdlZW5SdW5uaW5nJiZyLmRpciYmbChcIm9mZlwiLG51bGwpO2JyZWFrO2Nhc2VcImtleWRvd25cIjpjYXNlXCJrZXl1cFwiOnZhciBzPWkua2V5Q29kZT9pLmtleUNvZGU6aS53aGljaCxmPVwib25cIjtpZihcInhcIiE9PW4uYXhpcyYmKDM4PT09c3x8NDA9PT1zKXx8XCJ5XCIhPT1uLmF4aXMmJigzNz09PXN8fDM5PT09cykpe2lmKCgzOD09PXN8fDQwPT09cykmJiFvLm92ZXJmbG93ZWRbMF18fCgzNz09PXN8fDM5PT09cykmJiFvLm92ZXJmbG93ZWRbMV0pcmV0dXJuO1wia2V5dXBcIj09PWkudHlwZSYmKGY9XCJvZmZcIiksZShhLmFjdGl2ZUVsZW1lbnQpLmlzKHUpfHwoaS5wcmV2ZW50RGVmYXVsdCgpLGkuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksbChmLHMpKX1lbHNlIGlmKDMzPT09c3x8MzQ9PT1zKXtpZigoby5vdmVyZmxvd2VkWzBdfHxvLm92ZXJmbG93ZWRbMV0pJiYoaS5wcmV2ZW50RGVmYXVsdCgpLGkuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCkpLFwia2V5dXBcIj09PWkudHlwZSl7USh0KTt2YXIgaD0zND09PXM/LTE6MTtpZihcInhcIj09PW4uYXhpc3x8XCJ5eFwiPT09bi5heGlzJiZvLm92ZXJmbG93ZWRbMV0mJiFvLm92ZXJmbG93ZWRbMF0pdmFyIG09XCJ4XCIscD1NYXRoLmFicyhjWzBdLm9mZnNldExlZnQpLS45KmgqZC53aWR0aCgpO2Vsc2UgdmFyIG09XCJ5XCIscD1NYXRoLmFicyhjWzBdLm9mZnNldFRvcCktLjkqaCpkLmhlaWdodCgpO0codCxwLnRvU3RyaW5nKCkse2RpcjptLHNjcm9sbEVhc2luZzpcIm1jc0Vhc2VJbk91dFwifSl9fWVsc2UgaWYoKDM1PT09c3x8MzY9PT1zKSYmIWUoYS5hY3RpdmVFbGVtZW50KS5pcyh1KSYmKChvLm92ZXJmbG93ZWRbMF18fG8ub3ZlcmZsb3dlZFsxXSkmJihpLnByZXZlbnREZWZhdWx0KCksaS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSksXCJrZXl1cFwiPT09aS50eXBlKSl7aWYoXCJ4XCI9PT1uLmF4aXN8fFwieXhcIj09PW4uYXhpcyYmby5vdmVyZmxvd2VkWzFdJiYhby5vdmVyZmxvd2VkWzBdKXZhciBtPVwieFwiLHA9MzU9PT1zP01hdGguYWJzKGQud2lkdGgoKS1jLm91dGVyV2lkdGgoITEpKTowO2Vsc2UgdmFyIG09XCJ5XCIscD0zNT09PXM/TWF0aC5hYnMoZC5oZWlnaHQoKS1jLm91dGVySGVpZ2h0KCExKSk6MDtHKHQscC50b1N0cmluZygpLHtkaXI6bSxzY3JvbGxFYXNpbmc6XCJtY3NFYXNlSW5PdXRcIn0pfX19KX0saj1mdW5jdGlvbih0LGEsbyxuLHIpe2Z1bmN0aW9uIGwoZSl7dmFyIGE9XCJzdGVwcGVkXCIhPT11LnR5cGUsbz1yP3I6ZT9hP3AvMS41Omc6MWUzLzYwLGk9ZT9hPzcuNTo0MDoyLjUscz1bTWF0aC5hYnMoaFswXS5vZmZzZXRUb3ApLE1hdGguYWJzKGhbMF0ub2Zmc2V0TGVmdCldLGQ9W2Muc2Nyb2xsUmF0aW8ueT4xMD8xMDpjLnNjcm9sbFJhdGlvLnksYy5zY3JvbGxSYXRpby54PjEwPzEwOmMuc2Nyb2xsUmF0aW8ueF0sZj1cInhcIj09PXUuZGlyWzBdP3NbMV0rdS5kaXJbMV0qZFsxXSppOnNbMF0rdS5kaXJbMV0qZFswXSppLG09XCJ4XCI9PT11LmRpclswXT9zWzFdK3UuZGlyWzFdKnBhcnNlSW50KHUuc2Nyb2xsQW1vdW50KTpzWzBdK3UuZGlyWzFdKnBhcnNlSW50KHUuc2Nyb2xsQW1vdW50KSx2PVwiYXV0b1wiIT09dS5zY3JvbGxBbW91bnQ/bTpmLHg9bj9uOmU/YT9cIm1jc0xpbmVhck91dFwiOlwibWNzRWFzZUluT3V0XCI6XCJtY3NMaW5lYXJcIixfPWU/ITA6ITE7cmV0dXJuIGUmJjE3Pm8mJih2PVwieFwiPT09dS5kaXJbMF0/c1sxXTpzWzBdKSxHKHQsdi50b1N0cmluZygpLHtkaXI6dS5kaXJbMF0sc2Nyb2xsRWFzaW5nOngsZHVyOm8sb25Db21wbGV0ZTpffSksZT92b2lkKHUuZGlyPSExKTooY2xlYXJUaW1lb3V0KHUuc3RlcCksdm9pZCh1LnN0ZXA9c2V0VGltZW91dChmdW5jdGlvbigpe2woKX0sbykpKX1mdW5jdGlvbiBzKCl7Y2xlYXJUaW1lb3V0KHUuc3RlcCksJCh1LFwic3RlcFwiKSxRKHQpfXZhciBjPXQuZGF0YShpKSxkPWMub3B0LHU9Yy5zZXF1ZW50aWFsLGg9ZShcIiNtQ1NCX1wiK2MuaWR4K1wiX2NvbnRhaW5lclwiKSxtPVwic3RlcHBlZFwiPT09dS50eXBlPyEwOiExLHA9ZC5zY3JvbGxJbmVydGlhPDI2PzI2OmQuc2Nyb2xsSW5lcnRpYSxnPWQuc2Nyb2xsSW5lcnRpYTwxPzE3OmQuc2Nyb2xsSW5lcnRpYTtzd2l0Y2goYSl7Y2FzZVwib25cIjppZih1LmRpcj1bbz09PWZbMTZdfHxvPT09ZlsxNV18fDM5PT09b3x8Mzc9PT1vP1wieFwiOlwieVwiLG89PT1mWzEzXXx8bz09PWZbMTVdfHwzOD09PW98fDM3PT09bz8tMToxXSxRKHQpLGF0KG8pJiZcInN0ZXBwZWRcIj09PXUudHlwZSlyZXR1cm47bChtKTticmVhaztjYXNlXCJvZmZcIjpzKCksKG18fGMudHdlZW5SdW5uaW5nJiZ1LmRpcikmJmwoITApfX0sWT1mdW5jdGlvbih0KXt2YXIgYT1lKHRoaXMpLmRhdGEoaSkub3B0LG89W107cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmKHQ9dCgpKSx0IGluc3RhbmNlb2YgQXJyYXk/bz10Lmxlbmd0aD4xP1t0WzBdLHRbMV1dOlwieFwiPT09YS5heGlzP1tudWxsLHRbMF1dOlt0WzBdLG51bGxdOihvWzBdPXQueT90Lnk6dC54fHxcInhcIj09PWEuYXhpcz9udWxsOnQsb1sxXT10Lng/dC54OnQueXx8XCJ5XCI9PT1hLmF4aXM/bnVsbDp0KSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBvWzBdJiYob1swXT1vWzBdKCkpLFwiZnVuY3Rpb25cIj09dHlwZW9mIG9bMV0mJihvWzFdPW9bMV0oKSksb30sWD1mdW5jdGlvbih0LGEpe2lmKG51bGwhPXQmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiB0KXt2YXIgbz1lKHRoaXMpLG49by5kYXRhKGkpLHI9bi5vcHQsbD1lKFwiI21DU0JfXCIrbi5pZHgrXCJfY29udGFpbmVyXCIpLHM9bC5wYXJlbnQoKSxjPXR5cGVvZiB0O2F8fChhPVwieFwiPT09ci5heGlzP1wieFwiOlwieVwiKTt2YXIgZD1cInhcIj09PWE/bC5vdXRlcldpZHRoKCExKTpsLm91dGVySGVpZ2h0KCExKSx1PVwieFwiPT09YT9sWzBdLm9mZnNldExlZnQ6bFswXS5vZmZzZXRUb3AsZj1cInhcIj09PWE/XCJsZWZ0XCI6XCJ0b3BcIjtzd2l0Y2goYyl7Y2FzZVwiZnVuY3Rpb25cIjpyZXR1cm4gdCgpO2Nhc2VcIm9iamVjdFwiOnZhciBtPXQuanF1ZXJ5P3Q6ZSh0KTtpZighbS5sZW5ndGgpcmV0dXJuO3JldHVyblwieFwiPT09YT9vdChtKVsxXTpvdChtKVswXTtjYXNlXCJzdHJpbmdcIjpjYXNlXCJudW1iZXJcIjppZihhdCh0KSlyZXR1cm4gTWF0aC5hYnModCk7aWYoLTEhPT10LmluZGV4T2YoXCIlXCIpKXJldHVybiBNYXRoLmFicyhkKnBhcnNlSW50KHQpLzEwMCk7aWYoLTEhPT10LmluZGV4T2YoXCItPVwiKSlyZXR1cm4gTWF0aC5hYnModS1wYXJzZUludCh0LnNwbGl0KFwiLT1cIilbMV0pKTtpZigtMSE9PXQuaW5kZXhPZihcIis9XCIpKXt2YXIgcD11K3BhcnNlSW50KHQuc3BsaXQoXCIrPVwiKVsxXSk7cmV0dXJuIHA+PTA/MDpNYXRoLmFicyhwKX1pZigtMSE9PXQuaW5kZXhPZihcInB4XCIpJiZhdCh0LnNwbGl0KFwicHhcIilbMF0pKXJldHVybiBNYXRoLmFicyh0LnNwbGl0KFwicHhcIilbMF0pO2lmKFwidG9wXCI9PT10fHxcImxlZnRcIj09PXQpcmV0dXJuIDA7aWYoXCJib3R0b21cIj09PXQpcmV0dXJuIE1hdGguYWJzKHMuaGVpZ2h0KCktbC5vdXRlckhlaWdodCghMSkpO2lmKFwicmlnaHRcIj09PXQpcmV0dXJuIE1hdGguYWJzKHMud2lkdGgoKS1sLm91dGVyV2lkdGgoITEpKTtpZihcImZpcnN0XCI9PT10fHxcImxhc3RcIj09PXQpe3ZhciBtPWwuZmluZChcIjpcIit0KTtyZXR1cm5cInhcIj09PWE/b3QobSlbMV06b3QobSlbMF19cmV0dXJuIGUodCkubGVuZ3RoP1wieFwiPT09YT9vdChlKHQpKVsxXTpvdChlKHQpKVswXToobC5jc3MoZix0KSx2b2lkIGgudXBkYXRlLmNhbGwobnVsbCxvWzBdKSl9fX0sTj1mdW5jdGlvbih0KXtmdW5jdGlvbiBhKCl7Y2xlYXJUaW1lb3V0KHVbMF0uYXV0b1VwZGF0ZSksdVswXS5hdXRvVXBkYXRlPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gZC5hZHZhbmNlZC51cGRhdGVPblNlbGVjdG9yQ2hhbmdlJiYobT1yKCksbSE9PVMpPyhsKDMpLHZvaWQoUz1tKSk6KGQuYWR2YW5jZWQudXBkYXRlT25Db250ZW50UmVzaXplJiYocD1bdS5vdXRlckhlaWdodCghMSksdS5vdXRlcldpZHRoKCExKSx2LmhlaWdodCgpLHYud2lkdGgoKSxfKClbMF0sXygpWzFdXSwocFswXSE9PXdbMF18fHBbMV0hPT13WzFdfHxwWzJdIT09d1syXXx8cFszXSE9PXdbM118fHBbNF0hPT13WzRdfHxwWzVdIT09d1s1XSkmJihsKHBbMF0hPT13WzBdfHxwWzFdIT09d1sxXSksdz1wKSksZC5hZHZhbmNlZC51cGRhdGVPbkltYWdlTG9hZCYmKGc9bygpLGchPT1iJiYodS5maW5kKFwiaW1nXCIpLmVhY2goZnVuY3Rpb24oKXtuKHRoaXMpfSksYj1nKSksdm9pZCgoZC5hZHZhbmNlZC51cGRhdGVPblNlbGVjdG9yQ2hhbmdlfHxkLmFkdmFuY2VkLnVwZGF0ZU9uQ29udGVudFJlc2l6ZXx8ZC5hZHZhbmNlZC51cGRhdGVPbkltYWdlTG9hZCkmJmEoKSkpfSw2MCl9ZnVuY3Rpb24gbygpe3ZhciBlPTA7cmV0dXJuIGQuYWR2YW5jZWQudXBkYXRlT25JbWFnZUxvYWQmJihlPXUuZmluZChcImltZ1wiKS5sZW5ndGgpLGV9ZnVuY3Rpb24gbih0KXtmdW5jdGlvbiBhKGUsdCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQuYXBwbHkoZSxhcmd1bWVudHMpfX1mdW5jdGlvbiBvKCl7dGhpcy5vbmxvYWQ9bnVsbCxlKHQpLmFkZENsYXNzKGZbMl0pLGwoMil9aWYoZSh0KS5oYXNDbGFzcyhmWzJdKSlyZXR1cm4gdm9pZCBsKCk7dmFyIG49bmV3IEltYWdlO24ub25sb2FkPWEobixvKSxuLnNyYz10LnNyY31mdW5jdGlvbiByKCl7ZC5hZHZhbmNlZC51cGRhdGVPblNlbGVjdG9yQ2hhbmdlPT09ITAmJihkLmFkdmFuY2VkLnVwZGF0ZU9uU2VsZWN0b3JDaGFuZ2U9XCIqXCIpO3ZhciB0PTAsYT11LmZpbmQoZC5hZHZhbmNlZC51cGRhdGVPblNlbGVjdG9yQ2hhbmdlKTtyZXR1cm4gZC5hZHZhbmNlZC51cGRhdGVPblNlbGVjdG9yQ2hhbmdlJiZhLmxlbmd0aD4wJiZhLmVhY2goZnVuY3Rpb24oKXt0Kz1lKHRoaXMpLmhlaWdodCgpK2UodGhpcykud2lkdGgoKX0pLHR9ZnVuY3Rpb24gbChlKXtjbGVhclRpbWVvdXQodVswXS5hdXRvVXBkYXRlKSxoLnVwZGF0ZS5jYWxsKG51bGwsc1swXSxlKX12YXIgcz1lKHRoaXMpLGM9cy5kYXRhKGkpLGQ9Yy5vcHQsdT1lKFwiI21DU0JfXCIrYy5pZHgrXCJfY29udGFpbmVyXCIpO2lmKHQpcmV0dXJuIGNsZWFyVGltZW91dCh1WzBdLmF1dG9VcGRhdGUpLHZvaWQgJCh1WzBdLFwiYXV0b1VwZGF0ZVwiKTt2YXIgbSxwLGcsdj11LnBhcmVudCgpLHg9W2UoXCIjbUNTQl9cIitjLmlkeCtcIl9zY3JvbGxiYXJfdmVydGljYWxcIiksZShcIiNtQ1NCX1wiK2MuaWR4K1wiX3Njcm9sbGJhcl9ob3Jpem9udGFsXCIpXSxfPWZ1bmN0aW9uKCl7cmV0dXJuW3hbMF0uaXMoXCI6dmlzaWJsZVwiKT94WzBdLm91dGVySGVpZ2h0KCEwKTowLHhbMV0uaXMoXCI6dmlzaWJsZVwiKT94WzFdLm91dGVyV2lkdGgoITApOjBdfSxTPXIoKSx3PVt1Lm91dGVySGVpZ2h0KCExKSx1Lm91dGVyV2lkdGgoITEpLHYuaGVpZ2h0KCksdi53aWR0aCgpLF8oKVswXSxfKClbMV1dLGI9bygpO2EoKX0sVj1mdW5jdGlvbihlLHQsYSl7cmV0dXJuIE1hdGgucm91bmQoZS90KSp0LWF9LFE9ZnVuY3Rpb24odCl7dmFyIGE9dC5kYXRhKGkpLG89ZShcIiNtQ1NCX1wiK2EuaWR4K1wiX2NvbnRhaW5lciwjbUNTQl9cIithLmlkeCtcIl9jb250YWluZXJfd3JhcHBlciwjbUNTQl9cIithLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsLCNtQ1NCX1wiK2EuaWR4K1wiX2RyYWdnZXJfaG9yaXpvbnRhbFwiKTtvLmVhY2goZnVuY3Rpb24oKXtaLmNhbGwodGhpcyl9KX0sRz1mdW5jdGlvbih0LGEsbyl7ZnVuY3Rpb24gbihlKXtyZXR1cm4gcyYmYy5jYWxsYmFja3NbZV0mJlwiZnVuY3Rpb25cIj09dHlwZW9mIGMuY2FsbGJhY2tzW2VdfWZ1bmN0aW9uIHIoKXtyZXR1cm5bYy5jYWxsYmFja3MuYWx3YXlzVHJpZ2dlck9mZnNldHN8fF8+PVNbMF0rYixjLmNhbGxiYWNrcy5hbHdheXNUcmlnZ2VyT2Zmc2V0c3x8LUM+PV9dfWZ1bmN0aW9uIGwoKXt2YXIgZT1baFswXS5vZmZzZXRUb3AsaFswXS5vZmZzZXRMZWZ0XSxhPVt2WzBdLm9mZnNldFRvcCx2WzBdLm9mZnNldExlZnRdLG49W2gub3V0ZXJIZWlnaHQoITEpLGgub3V0ZXJXaWR0aCghMSldLGk9W2YuaGVpZ2h0KCksZi53aWR0aCgpXTt0WzBdLm1jcz17Y29udGVudDpoLHRvcDplWzBdLGxlZnQ6ZVsxXSxkcmFnZ2VyVG9wOmFbMF0sZHJhZ2dlckxlZnQ6YVsxXSx0b3BQY3Q6TWF0aC5yb3VuZCgxMDAqTWF0aC5hYnMoZVswXSkvKE1hdGguYWJzKG5bMF0pLWlbMF0pKSxsZWZ0UGN0Ok1hdGgucm91bmQoMTAwKk1hdGguYWJzKGVbMV0pLyhNYXRoLmFicyhuWzFdKS1pWzFdKSksZGlyZWN0aW9uOm8uZGlyfX12YXIgcz10LmRhdGEoaSksYz1zLm9wdCxkPXt0cmlnZ2VyOlwiaW50ZXJuYWxcIixkaXI6XCJ5XCIsc2Nyb2xsRWFzaW5nOlwibWNzRWFzZU91dFwiLGRyYWc6ITEsZHVyOmMuc2Nyb2xsSW5lcnRpYSxvdmVyd3JpdGU6XCJhbGxcIixjYWxsYmFja3M6ITAsb25TdGFydDohMCxvblVwZGF0ZTohMCxvbkNvbXBsZXRlOiEwfSxvPWUuZXh0ZW5kKGQsbyksdT1bby5kdXIsby5kcmFnPzA6by5kdXJdLGY9ZShcIiNtQ1NCX1wiK3MuaWR4KSxoPWUoXCIjbUNTQl9cIitzLmlkeCtcIl9jb250YWluZXJcIiksbT1oLnBhcmVudCgpLHA9Yy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbE9mZnNldD9ZLmNhbGwodCxjLmNhbGxiYWNrcy5vblRvdGFsU2Nyb2xsT2Zmc2V0KTpbMCwwXSxnPWMuY2FsbGJhY2tzLm9uVG90YWxTY3JvbGxCYWNrT2Zmc2V0P1kuY2FsbCh0LGMuY2FsbGJhY2tzLm9uVG90YWxTY3JvbGxCYWNrT2Zmc2V0KTpbMCwwXTtpZihzLnRyaWdnZXI9by50cmlnZ2VyLCgwIT09bS5zY3JvbGxUb3AoKXx8MCE9PW0uc2Nyb2xsTGVmdCgpKSYmKGUoXCIubUNTQl9cIitzLmlkeCtcIl9zY3JvbGxiYXJcIikuY3NzKFwidmlzaWJpbGl0eVwiLFwidmlzaWJsZVwiKSxtLnNjcm9sbFRvcCgwKS5zY3JvbGxMZWZ0KDApKSxcIl9yZXNldFlcIiE9PWF8fHMuY29udGVudFJlc2V0Lnl8fChuKFwib25PdmVyZmxvd1lOb25lXCIpJiZjLmNhbGxiYWNrcy5vbk92ZXJmbG93WU5vbmUuY2FsbCh0WzBdKSxzLmNvbnRlbnRSZXNldC55PTEpLFwiX3Jlc2V0WFwiIT09YXx8cy5jb250ZW50UmVzZXQueHx8KG4oXCJvbk92ZXJmbG93WE5vbmVcIikmJmMuY2FsbGJhY2tzLm9uT3ZlcmZsb3dYTm9uZS5jYWxsKHRbMF0pLHMuY29udGVudFJlc2V0Lng9MSksXCJfcmVzZXRZXCIhPT1hJiZcIl9yZXNldFhcIiE9PWEpe3N3aXRjaCghcy5jb250ZW50UmVzZXQueSYmdFswXS5tY3N8fCFzLm92ZXJmbG93ZWRbMF18fChuKFwib25PdmVyZmxvd1lcIikmJmMuY2FsbGJhY2tzLm9uT3ZlcmZsb3dZLmNhbGwodFswXSkscy5jb250ZW50UmVzZXQueD1udWxsKSwhcy5jb250ZW50UmVzZXQueCYmdFswXS5tY3N8fCFzLm92ZXJmbG93ZWRbMV18fChuKFwib25PdmVyZmxvd1hcIikmJmMuY2FsbGJhY2tzLm9uT3ZlcmZsb3dYLmNhbGwodFswXSkscy5jb250ZW50UmVzZXQueD1udWxsKSxjLnNuYXBBbW91bnQmJihhPVYoYSxjLnNuYXBBbW91bnQsYy5zbmFwT2Zmc2V0KSksby5kaXIpe2Nhc2VcInhcIjp2YXIgdj1lKFwiI21DU0JfXCIrcy5pZHgrXCJfZHJhZ2dlcl9ob3Jpem9udGFsXCIpLHg9XCJsZWZ0XCIsXz1oWzBdLm9mZnNldExlZnQsUz1bZi53aWR0aCgpLWgub3V0ZXJXaWR0aCghMSksdi5wYXJlbnQoKS53aWR0aCgpLXYud2lkdGgoKV0sdz1bYSwwPT09YT8wOmEvcy5zY3JvbGxSYXRpby54XSxiPXBbMV0sQz1nWzFdLHk9Yj4wP2Ivcy5zY3JvbGxSYXRpby54OjAsQj1DPjA/Qy9zLnNjcm9sbFJhdGlvLng6MDtcclxuYnJlYWs7Y2FzZVwieVwiOnZhciB2PWUoXCIjbUNTQl9cIitzLmlkeCtcIl9kcmFnZ2VyX3ZlcnRpY2FsXCIpLHg9XCJ0b3BcIixfPWhbMF0ub2Zmc2V0VG9wLFM9W2YuaGVpZ2h0KCktaC5vdXRlckhlaWdodCghMSksdi5wYXJlbnQoKS5oZWlnaHQoKS12LmhlaWdodCgpXSx3PVthLDA9PT1hPzA6YS9zLnNjcm9sbFJhdGlvLnldLGI9cFswXSxDPWdbMF0seT1iPjA/Yi9zLnNjcm9sbFJhdGlvLnk6MCxCPUM+MD9DL3Muc2Nyb2xsUmF0aW8ueTowfXdbMV08MHx8MD09PXdbMF0mJjA9PT13WzFdP3c9WzAsMF06d1sxXT49U1sxXT93PVtTWzBdLFNbMV1dOndbMF09LXdbMF0sdFswXS5tY3N8fChsKCksbihcIm9uSW5pdFwiKSYmYy5jYWxsYmFja3Mub25Jbml0LmNhbGwodFswXSkpLGNsZWFyVGltZW91dChoWzBdLm9uQ29tcGxldGVUaW1lb3V0KSwocy50d2VlblJ1bm5pbmd8fCEoMD09PV8mJndbMF0+PTB8fF89PT1TWzBdJiZ3WzBdPD1TWzBdKSkmJihKKHZbMF0seCxNYXRoLnJvdW5kKHdbMV0pLHVbMV0sby5zY3JvbGxFYXNpbmcpLEooaFswXSx4LE1hdGgucm91bmQod1swXSksdVswXSxvLnNjcm9sbEVhc2luZyxvLm92ZXJ3cml0ZSx7b25TdGFydDpmdW5jdGlvbigpe28uY2FsbGJhY2tzJiZvLm9uU3RhcnQmJiFzLnR3ZWVuUnVubmluZyYmKG4oXCJvblNjcm9sbFN0YXJ0XCIpJiYobCgpLGMuY2FsbGJhY2tzLm9uU2Nyb2xsU3RhcnQuY2FsbCh0WzBdKSkscy50d2VlblJ1bm5pbmc9ITAsVCh2KSxzLmNiT2Zmc2V0cz1yKCkpfSxvblVwZGF0ZTpmdW5jdGlvbigpe28uY2FsbGJhY2tzJiZvLm9uVXBkYXRlJiZuKFwid2hpbGVTY3JvbGxpbmdcIikmJihsKCksYy5jYWxsYmFja3Mud2hpbGVTY3JvbGxpbmcuY2FsbCh0WzBdKSl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtpZihvLmNhbGxiYWNrcyYmby5vbkNvbXBsZXRlKXtcInl4XCI9PT1jLmF4aXMmJmNsZWFyVGltZW91dChoWzBdLm9uQ29tcGxldGVUaW1lb3V0KTt2YXIgZT1oWzBdLmlkbGVUaW1lcnx8MDtoWzBdLm9uQ29tcGxldGVUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtuKFwib25TY3JvbGxcIikmJihsKCksYy5jYWxsYmFja3Mub25TY3JvbGwuY2FsbCh0WzBdKSksbihcIm9uVG90YWxTY3JvbGxcIikmJndbMV0+PVNbMV0teSYmcy5jYk9mZnNldHNbMF0mJihsKCksYy5jYWxsYmFja3Mub25Ub3RhbFNjcm9sbC5jYWxsKHRbMF0pKSxuKFwib25Ub3RhbFNjcm9sbEJhY2tcIikmJndbMV08PUImJnMuY2JPZmZzZXRzWzFdJiYobCgpLGMuY2FsbGJhY2tzLm9uVG90YWxTY3JvbGxCYWNrLmNhbGwodFswXSkpLHMudHdlZW5SdW5uaW5nPSExLGhbMF0uaWRsZVRpbWVyPTAsVCh2LFwiaGlkZVwiKX0sZSl9fX0pKX19LEo9ZnVuY3Rpb24oZSxhLG8sbixpLHIsbCl7ZnVuY3Rpb24gcygpe2Iuc3RvcHx8KF98fHAuY2FsbCgpLF89SygpLXgsYygpLF8+PWIudGltZSYmKGIudGltZT1fPmIudGltZT9fK2gtKF8tYi50aW1lKTpfK2gtMSxiLnRpbWU8XysxJiYoYi50aW1lPV8rMSkpLGIudGltZTxuP2IuaWQ9bShzKTp2LmNhbGwoKSl9ZnVuY3Rpb24gYygpe24+MD8oYi5jdXJyVmFsPWYoYi50aW1lLFMsQyxuLGkpLHdbYV09TWF0aC5yb3VuZChiLmN1cnJWYWwpK1wicHhcIik6d1thXT1vK1wicHhcIixnLmNhbGwoKX1mdW5jdGlvbiBkKCl7aD0xZTMvNjAsYi50aW1lPV8raCxtPXQucmVxdWVzdEFuaW1hdGlvbkZyYW1lP3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lOmZ1bmN0aW9uKGUpe3JldHVybiBjKCksc2V0VGltZW91dChlLC4wMSl9LGIuaWQ9bShzKX1mdW5jdGlvbiB1KCl7bnVsbCE9Yi5pZCYmKHQucmVxdWVzdEFuaW1hdGlvbkZyYW1lP3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUoYi5pZCk6Y2xlYXJUaW1lb3V0KGIuaWQpLGIuaWQ9bnVsbCl9ZnVuY3Rpb24gZihlLHQsYSxvLG4pe3N3aXRjaChuKXtjYXNlXCJsaW5lYXJcIjpjYXNlXCJtY3NMaW5lYXJcIjpyZXR1cm4gYSplL28rdDtjYXNlXCJtY3NMaW5lYXJPdXRcIjpyZXR1cm4gZS89byxlLS0sYSpNYXRoLnNxcnQoMS1lKmUpK3Q7Y2FzZVwiZWFzZUluT3V0U21vb3RoXCI6cmV0dXJuIGUvPW8vMiwxPmU/YS8yKmUqZSt0OihlLS0sLWEvMiooZSooZS0yKS0xKSt0KTtjYXNlXCJlYXNlSW5PdXRTdHJvbmdcIjpyZXR1cm4gZS89by8yLDE+ZT9hLzIqTWF0aC5wb3coMiwxMCooZS0xKSkrdDooZS0tLGEvMiooLU1hdGgucG93KDIsLTEwKmUpKzIpK3QpO2Nhc2VcImVhc2VJbk91dFwiOmNhc2VcIm1jc0Vhc2VJbk91dFwiOnJldHVybiBlLz1vLzIsMT5lP2EvMiplKmUqZSt0OihlLT0yLGEvMiooZSplKmUrMikrdCk7Y2FzZVwiZWFzZU91dFNtb290aFwiOnJldHVybiBlLz1vLGUtLSwtYSooZSplKmUqZS0xKSt0O2Nhc2VcImVhc2VPdXRTdHJvbmdcIjpyZXR1cm4gYSooLU1hdGgucG93KDIsLTEwKmUvbykrMSkrdDtjYXNlXCJlYXNlT3V0XCI6Y2FzZVwibWNzRWFzZU91dFwiOmRlZmF1bHQ6dmFyIGk9KGUvPW8pKmUscj1pKmU7cmV0dXJuIHQrYSooLjQ5OTk5OTk5OTk5OTk5NypyKmkrLTIuNSppKmkrNS41KnIrLTYuNSppKzQqZSl9fWUuX21Ud2Vlbnx8KGUuX21Ud2Vlbj17dG9wOnt9LGxlZnQ6e319KTt2YXIgaCxtLGw9bHx8e30scD1sLm9uU3RhcnR8fGZ1bmN0aW9uKCl7fSxnPWwub25VcGRhdGV8fGZ1bmN0aW9uKCl7fSx2PWwub25Db21wbGV0ZXx8ZnVuY3Rpb24oKXt9LHg9SygpLF89MCxTPWUub2Zmc2V0VG9wLHc9ZS5zdHlsZSxiPWUuX21Ud2VlblthXTtcImxlZnRcIj09PWEmJihTPWUub2Zmc2V0TGVmdCk7dmFyIEM9by1TO2Iuc3RvcD0wLFwibm9uZVwiIT09ciYmdSgpLGQoKX0sSz1mdW5jdGlvbigpe3JldHVybiB0LnBlcmZvcm1hbmNlJiZ0LnBlcmZvcm1hbmNlLm5vdz90LnBlcmZvcm1hbmNlLm5vdygpOnQucGVyZm9ybWFuY2UmJnQucGVyZm9ybWFuY2Uud2Via2l0Tm93P3QucGVyZm9ybWFuY2Uud2Via2l0Tm93KCk6RGF0ZS5ub3c/RGF0ZS5ub3coKToobmV3IERhdGUpLmdldFRpbWUoKX0sWj1mdW5jdGlvbigpe3ZhciBlPXRoaXM7ZS5fbVR3ZWVufHwoZS5fbVR3ZWVuPXt0b3A6e30sbGVmdDp7fX0pO2Zvcih2YXIgYT1bXCJ0b3BcIixcImxlZnRcIl0sbz0wO288YS5sZW5ndGg7bysrKXt2YXIgbj1hW29dO2UuX21Ud2VlbltuXS5pZCYmKHQucmVxdWVzdEFuaW1hdGlvbkZyYW1lP3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUoZS5fbVR3ZWVuW25dLmlkKTpjbGVhclRpbWVvdXQoZS5fbVR3ZWVuW25dLmlkKSxlLl9tVHdlZW5bbl0uaWQ9bnVsbCxlLl9tVHdlZW5bbl0uc3RvcD0xKX19LCQ9ZnVuY3Rpb24oZSx0KXt0cnl7ZGVsZXRlIGVbdF19Y2F0Y2goYSl7ZVt0XT1udWxsfX0sZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIShlLndoaWNoJiYxIT09ZS53aGljaCl9LHR0PWZ1bmN0aW9uKGUpe3ZhciB0PWUub3JpZ2luYWxFdmVudC5wb2ludGVyVHlwZTtyZXR1cm4hKHQmJlwidG91Y2hcIiE9PXQmJjIhPT10KX0sYXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIWlzTmFOKHBhcnNlRmxvYXQoZSkpJiZpc0Zpbml0ZShlKX0sb3Q9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnRzKFwiLm1DU0JfY29udGFpbmVyXCIpO3JldHVybltlLm9mZnNldCgpLnRvcC10Lm9mZnNldCgpLnRvcCxlLm9mZnNldCgpLmxlZnQtdC5vZmZzZXQoKS5sZWZ0XX07ZS5mbltuXT1mdW5jdGlvbih0KXtyZXR1cm4gaFt0XT9oW3RdLmFwcGx5KHRoaXMsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpKTpcIm9iamVjdFwiIT10eXBlb2YgdCYmdD92b2lkIGUuZXJyb3IoXCJNZXRob2QgXCIrdCtcIiBkb2VzIG5vdCBleGlzdFwiKTpoLmluaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlW25dPWZ1bmN0aW9uKHQpe3JldHVybiBoW3RdP2hbdF0uYXBwbHkodGhpcyxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkpOlwib2JqZWN0XCIhPXR5cGVvZiB0JiZ0P3ZvaWQgZS5lcnJvcihcIk1ldGhvZCBcIit0K1wiIGRvZXMgbm90IGV4aXN0XCIpOmguaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGVbbl0uZGVmYXVsdHM9bCx0W25dPSEwLGUodCkubG9hZChmdW5jdGlvbigpe2Uocilbbl0oKSxlLmV4dGVuZChlLmV4cHJbXCI6XCJdLHttY3NJblZpZXc6ZS5leHByW1wiOlwiXS5tY3NJblZpZXd8fGZ1bmN0aW9uKHQpe3ZhciBhLG8sbj1lKHQpLGk9bi5wYXJlbnRzKFwiLm1DU0JfY29udGFpbmVyXCIpO2lmKGkubGVuZ3RoKXJldHVybiBhPWkucGFyZW50KCksbz1baVswXS5vZmZzZXRUb3AsaVswXS5vZmZzZXRMZWZ0XSxvWzBdK290KG4pWzBdPj0wJiZvWzBdK290KG4pWzBdPGEuaGVpZ2h0KCktbi5vdXRlckhlaWdodCghMSkmJm9bMV0rb3QobilbMV0+PTAmJm9bMV0rb3QobilbMV08YS53aWR0aCgpLW4ub3V0ZXJXaWR0aCghMSl9LG1jc092ZXJmbG93OmUuZXhwcltcIjpcIl0ubWNzT3ZlcmZsb3d8fGZ1bmN0aW9uKHQpe3ZhciBhPWUodCkuZGF0YShpKTtpZihhKXJldHVybiBhLm92ZXJmbG93ZWRbMF18fGEub3ZlcmZsb3dlZFsxXX19KX0pfSl9KGpRdWVyeSx3aW5kb3csZG9jdW1lbnQpOyIsIi8qXHJcbiBBbmd1bGFySlMgdjEuMy45XHJcbiAoYykgMjAxMC0yMDE0IEdvb2dsZSwgSW5jLiBodHRwOi8vYW5ndWxhcmpzLm9yZ1xyXG4gTGljZW5zZTogTUlUXHJcbiovXHJcbihmdW5jdGlvbihNLFksdCl7J3VzZSBzdHJpY3QnO2Z1bmN0aW9uIFQoYil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzWzBdLGM7Yz1cIltcIisoYj9iK1wiOlwiOlwiXCIpK2ErXCJdIGh0dHA6Ly9lcnJvcnMuYW5ndWxhcmpzLm9yZy8xLjMuOS9cIisoYj9iK1wiL1wiOlwiXCIpK2E7Zm9yKGE9MTthPGFyZ3VtZW50cy5sZW5ndGg7YSsrKXtjPWMrKDE9PWE/XCI/XCI6XCImXCIpK1wicFwiKyhhLTEpK1wiPVwiO3ZhciBkPWVuY29kZVVSSUNvbXBvbmVudCxlO2U9YXJndW1lbnRzW2FdO2U9XCJmdW5jdGlvblwiPT10eXBlb2YgZT9lLnRvU3RyaW5nKCkucmVwbGFjZSgvIFxce1tcXHNcXFNdKiQvLFwiXCIpOlwidW5kZWZpbmVkXCI9PXR5cGVvZiBlP1widW5kZWZpbmVkXCI6XCJzdHJpbmdcIiE9dHlwZW9mIGU/SlNPTi5zdHJpbmdpZnkoZSk6ZTtjKz1kKGUpfXJldHVybiBFcnJvcihjKX19ZnVuY3Rpb24gVGEoYil7aWYobnVsbD09Ynx8VWEoYikpcmV0dXJuITE7dmFyIGE9Yi5sZW5ndGg7cmV0dXJuIGIubm9kZVR5cGU9PT1cclxub2EmJmE/ITA6RihiKXx8RChiKXx8MD09PWF8fFwibnVtYmVyXCI9PT10eXBlb2YgYSYmMDxhJiZhLTEgaW4gYn1mdW5jdGlvbiBzKGIsYSxjKXt2YXIgZCxlO2lmKGIpaWYoRyhiKSlmb3IoZCBpbiBiKVwicHJvdG90eXBlXCI9PWR8fFwibGVuZ3RoXCI9PWR8fFwibmFtZVwiPT1kfHxiLmhhc093blByb3BlcnR5JiYhYi5oYXNPd25Qcm9wZXJ0eShkKXx8YS5jYWxsKGMsYltkXSxkLGIpO2Vsc2UgaWYoRChiKXx8VGEoYikpe3ZhciBmPVwib2JqZWN0XCIhPT10eXBlb2YgYjtkPTA7Zm9yKGU9Yi5sZW5ndGg7ZDxlO2QrKykoZnx8ZCBpbiBiKSYmYS5jYWxsKGMsYltkXSxkLGIpfWVsc2UgaWYoYi5mb3JFYWNoJiZiLmZvckVhY2ghPT1zKWIuZm9yRWFjaChhLGMsYik7ZWxzZSBmb3IoZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJmEuY2FsbChjLGJbZF0sZCxiKTtyZXR1cm4gYn1mdW5jdGlvbiBFZChiLGEsYyl7Zm9yKHZhciBkPU9iamVjdC5rZXlzKGIpLnNvcnQoKSxlPTA7ZTxkLmxlbmd0aDtlKyspYS5jYWxsKGMsXHJcbmJbZFtlXV0sZFtlXSk7cmV0dXJuIGR9ZnVuY3Rpb24ga2MoYil7cmV0dXJuIGZ1bmN0aW9uKGEsYyl7YihjLGEpfX1mdW5jdGlvbiBGZCgpe3JldHVybisrbmJ9ZnVuY3Rpb24gbGMoYixhKXthP2IuJCRoYXNoS2V5PWE6ZGVsZXRlIGIuJCRoYXNoS2V5fWZ1bmN0aW9uIHooYil7Zm9yKHZhciBhPWIuJCRoYXNoS2V5LGM9MSxkPWFyZ3VtZW50cy5sZW5ndGg7YzxkO2MrKyl7dmFyIGU9YXJndW1lbnRzW2NdO2lmKGUpZm9yKHZhciBmPU9iamVjdC5rZXlzKGUpLGc9MCxoPWYubGVuZ3RoO2c8aDtnKyspe3ZhciBsPWZbZ107YltsXT1lW2xdfX1sYyhiLGEpO3JldHVybiBifWZ1bmN0aW9uIGJhKGIpe3JldHVybiBwYXJzZUludChiLDEwKX1mdW5jdGlvbiBIKCl7fWZ1bmN0aW9uIHBhKGIpe3JldHVybiBifWZ1bmN0aW9uIGRhKGIpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBifX1mdW5jdGlvbiBBKGIpe3JldHVyblwidW5kZWZpbmVkXCI9PT10eXBlb2YgYn1mdW5jdGlvbiB5KGIpe3JldHVyblwidW5kZWZpbmVkXCIhPT1cclxudHlwZW9mIGJ9ZnVuY3Rpb24gSShiKXtyZXR1cm4gbnVsbCE9PWImJlwib2JqZWN0XCI9PT10eXBlb2YgYn1mdW5jdGlvbiBGKGIpe3JldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYn1mdW5jdGlvbiBWKGIpe3JldHVyblwibnVtYmVyXCI9PT10eXBlb2YgYn1mdW5jdGlvbiBxYShiKXtyZXR1cm5cIltvYmplY3QgRGF0ZV1cIj09PURhLmNhbGwoYil9ZnVuY3Rpb24gRyhiKXtyZXR1cm5cImZ1bmN0aW9uXCI9PT10eXBlb2YgYn1mdW5jdGlvbiBvYihiKXtyZXR1cm5cIltvYmplY3QgUmVnRXhwXVwiPT09RGEuY2FsbChiKX1mdW5jdGlvbiBVYShiKXtyZXR1cm4gYiYmYi53aW5kb3c9PT1ifWZ1bmN0aW9uIFZhKGIpe3JldHVybiBiJiZiLiRldmFsQXN5bmMmJmIuJHdhdGNofWZ1bmN0aW9uIFdhKGIpe3JldHVyblwiYm9vbGVhblwiPT09dHlwZW9mIGJ9ZnVuY3Rpb24gbWMoYil7cmV0dXJuISghYnx8IShiLm5vZGVOYW1lfHxiLnByb3AmJmIuYXR0ciYmYi5maW5kKSl9ZnVuY3Rpb24gR2QoYil7dmFyIGE9e307XHJcbmI9Yi5zcGxpdChcIixcIik7dmFyIGM7Zm9yKGM9MDtjPGIubGVuZ3RoO2MrKylhW2JbY11dPSEwO3JldHVybiBhfWZ1bmN0aW9uIHVhKGIpe3JldHVybiBRKGIubm9kZU5hbWV8fGJbMF0mJmJbMF0ubm9kZU5hbWUpfWZ1bmN0aW9uIFhhKGIsYSl7dmFyIGM9Yi5pbmRleE9mKGEpOzA8PWMmJmIuc3BsaWNlKGMsMSk7cmV0dXJuIGF9ZnVuY3Rpb24gRWEoYixhLGMsZCl7aWYoVWEoYil8fFZhKGIpKXRocm93IEthKFwiY3B3c1wiKTtpZihhKXtpZihiPT09YSl0aHJvdyBLYShcImNwaVwiKTtjPWN8fFtdO2Q9ZHx8W107aWYoSShiKSl7dmFyIGU9Yy5pbmRleE9mKGIpO2lmKC0xIT09ZSlyZXR1cm4gZFtlXTtjLnB1c2goYik7ZC5wdXNoKGEpfWlmKEQoYikpZm9yKHZhciBmPWEubGVuZ3RoPTA7ZjxiLmxlbmd0aDtmKyspZT1FYShiW2ZdLG51bGwsYyxkKSxJKGJbZl0pJiYoYy5wdXNoKGJbZl0pLGQucHVzaChlKSksYS5wdXNoKGUpO2Vsc2V7dmFyIGc9YS4kJGhhc2hLZXk7RChhKT9hLmxlbmd0aD1cclxuMDpzKGEsZnVuY3Rpb24oYixjKXtkZWxldGUgYVtjXX0pO2ZvcihmIGluIGIpYi5oYXNPd25Qcm9wZXJ0eShmKSYmKGU9RWEoYltmXSxudWxsLGMsZCksSShiW2ZdKSYmKGMucHVzaChiW2ZdKSxkLnB1c2goZSkpLGFbZl09ZSk7bGMoYSxnKX19ZWxzZSBpZihhPWIpRChiKT9hPUVhKGIsW10sYyxkKTpxYShiKT9hPW5ldyBEYXRlKGIuZ2V0VGltZSgpKTpvYihiKT8oYT1uZXcgUmVnRXhwKGIuc291cmNlLGIudG9TdHJpbmcoKS5tYXRjaCgvW15cXC9dKiQvKVswXSksYS5sYXN0SW5kZXg9Yi5sYXN0SW5kZXgpOkkoYikmJihlPU9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKGIpKSxhPUVhKGIsZSxjLGQpKTtyZXR1cm4gYX1mdW5jdGlvbiByYShiLGEpe2lmKEQoYikpe2E9YXx8W107Zm9yKHZhciBjPTAsZD1iLmxlbmd0aDtjPGQ7YysrKWFbY109YltjXX1lbHNlIGlmKEkoYikpZm9yKGMgaW4gYT1hfHx7fSxiKWlmKFwiJFwiIT09Yy5jaGFyQXQoMCl8fFwiJFwiIT09Yy5jaGFyQXQoMSkpYVtjXT1cclxuYltjXTtyZXR1cm4gYXx8Yn1mdW5jdGlvbiBmYShiLGEpe2lmKGI9PT1hKXJldHVybiEwO2lmKG51bGw9PT1ifHxudWxsPT09YSlyZXR1cm4hMTtpZihiIT09YiYmYSE9PWEpcmV0dXJuITA7dmFyIGM9dHlwZW9mIGIsZDtpZihjPT10eXBlb2YgYSYmXCJvYmplY3RcIj09YylpZihEKGIpKXtpZighRChhKSlyZXR1cm4hMTtpZigoYz1iLmxlbmd0aCk9PWEubGVuZ3RoKXtmb3IoZD0wO2Q8YztkKyspaWYoIWZhKGJbZF0sYVtkXSkpcmV0dXJuITE7cmV0dXJuITB9fWVsc2V7aWYocWEoYikpcmV0dXJuIHFhKGEpP2ZhKGIuZ2V0VGltZSgpLGEuZ2V0VGltZSgpKTohMTtpZihvYihiKSYmb2IoYSkpcmV0dXJuIGIudG9TdHJpbmcoKT09YS50b1N0cmluZygpO2lmKFZhKGIpfHxWYShhKXx8VWEoYil8fFVhKGEpfHxEKGEpKXJldHVybiExO2M9e307Zm9yKGQgaW4gYilpZihcIiRcIiE9PWQuY2hhckF0KDApJiYhRyhiW2RdKSl7aWYoIWZhKGJbZF0sYVtkXSkpcmV0dXJuITE7Y1tkXT0hMH1mb3IoZCBpbiBhKWlmKCFjLmhhc093blByb3BlcnR5KGQpJiZcclxuXCIkXCIhPT1kLmNoYXJBdCgwKSYmYVtkXSE9PXQmJiFHKGFbZF0pKXJldHVybiExO3JldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIFlhKGIsYSxjKXtyZXR1cm4gYi5jb25jYXQoWmEuY2FsbChhLGMpKX1mdW5jdGlvbiBuYyhiLGEpe3ZhciBjPTI8YXJndW1lbnRzLmxlbmd0aD9aYS5jYWxsKGFyZ3VtZW50cywyKTpbXTtyZXR1cm4hRyhhKXx8YSBpbnN0YW5jZW9mIFJlZ0V4cD9hOmMubGVuZ3RoP2Z1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/YS5hcHBseShiLFlhKGMsYXJndW1lbnRzLDApKTphLmFwcGx5KGIsYyl9OmZ1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/YS5hcHBseShiLGFyZ3VtZW50cyk6YS5jYWxsKGIpfX1mdW5jdGlvbiBIZChiLGEpe3ZhciBjPWE7XCJzdHJpbmdcIj09PXR5cGVvZiBiJiZcIiRcIj09PWIuY2hhckF0KDApJiZcIiRcIj09PWIuY2hhckF0KDEpP2M9dDpVYShhKT9jPVwiJFdJTkRPV1wiOmEmJlk9PT1hP2M9XCIkRE9DVU1FTlRcIjpWYShhKSYmXHJcbihjPVwiJFNDT1BFXCIpO3JldHVybiBjfWZ1bmN0aW9uICRhKGIsYSl7aWYoXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBiKXJldHVybiB0O1YoYSl8fChhPWE/MjpudWxsKTtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoYixIZCxhKX1mdW5jdGlvbiBvYyhiKXtyZXR1cm4gRihiKT9KU09OLnBhcnNlKGIpOmJ9ZnVuY3Rpb24gdmEoYil7Yj1CKGIpLmNsb25lKCk7dHJ5e2IuZW1wdHkoKX1jYXRjaChhKXt9dmFyIGM9QihcIjxkaXY+XCIpLmFwcGVuZChiKS5odG1sKCk7dHJ5e3JldHVybiBiWzBdLm5vZGVUeXBlPT09cGI/UShjKTpjLm1hdGNoKC9eKDxbXj5dKz4pLylbMV0ucmVwbGFjZSgvXjwoW1xcd1xcLV0rKS8sZnVuY3Rpb24oYSxiKXtyZXR1cm5cIjxcIitRKGIpfSl9Y2F0Y2goZCl7cmV0dXJuIFEoYyl9fWZ1bmN0aW9uIHBjKGIpe3RyeXtyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGIpfWNhdGNoKGEpe319ZnVuY3Rpb24gcWMoYil7dmFyIGE9e30sYyxkO3MoKGJ8fFwiXCIpLnNwbGl0KFwiJlwiKSxmdW5jdGlvbihiKXtiJiZcclxuKGM9Yi5yZXBsYWNlKC9cXCsvZyxcIiUyMFwiKS5zcGxpdChcIj1cIiksZD1wYyhjWzBdKSx5KGQpJiYoYj15KGNbMV0pP3BjKGNbMV0pOiEwLHJjLmNhbGwoYSxkKT9EKGFbZF0pP2FbZF0ucHVzaChiKTphW2RdPVthW2RdLGJdOmFbZF09YikpfSk7cmV0dXJuIGF9ZnVuY3Rpb24gTmIoYil7dmFyIGE9W107cyhiLGZ1bmN0aW9uKGIsZCl7RChiKT9zKGIsZnVuY3Rpb24oYil7YS5wdXNoKEZhKGQsITApKyghMD09PWI/XCJcIjpcIj1cIitGYShiLCEwKSkpfSk6YS5wdXNoKEZhKGQsITApKyghMD09PWI/XCJcIjpcIj1cIitGYShiLCEwKSkpfSk7cmV0dXJuIGEubGVuZ3RoP2Euam9pbihcIiZcIik6XCJcIn1mdW5jdGlvbiBxYihiKXtyZXR1cm4gRmEoYiwhMCkucmVwbGFjZSgvJTI2L2dpLFwiJlwiKS5yZXBsYWNlKC8lM0QvZ2ksXCI9XCIpLnJlcGxhY2UoLyUyQi9naSxcIitcIil9ZnVuY3Rpb24gRmEoYixhKXtyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGIpLnJlcGxhY2UoLyU0MC9naSxcIkBcIikucmVwbGFjZSgvJTNBL2dpLFxyXG5cIjpcIikucmVwbGFjZSgvJTI0L2csXCIkXCIpLnJlcGxhY2UoLyUyQy9naSxcIixcIikucmVwbGFjZSgvJTNCL2dpLFwiO1wiKS5yZXBsYWNlKC8lMjAvZyxhP1wiJTIwXCI6XCIrXCIpfWZ1bmN0aW9uIElkKGIsYSl7dmFyIGMsZCxlPXJiLmxlbmd0aDtiPUIoYik7Zm9yKGQ9MDtkPGU7KytkKWlmKGM9cmJbZF0rYSxGKGM9Yi5hdHRyKGMpKSlyZXR1cm4gYztyZXR1cm4gbnVsbH1mdW5jdGlvbiBKZChiLGEpe3ZhciBjLGQsZT17fTtzKHJiLGZ1bmN0aW9uKGEpe2ErPVwiYXBwXCI7IWMmJmIuaGFzQXR0cmlidXRlJiZiLmhhc0F0dHJpYnV0ZShhKSYmKGM9YixkPWIuZ2V0QXR0cmlidXRlKGEpKX0pO3MocmIsZnVuY3Rpb24oYSl7YSs9XCJhcHBcIjt2YXIgZTshYyYmKGU9Yi5xdWVyeVNlbGVjdG9yKFwiW1wiK2EucmVwbGFjZShcIjpcIixcIlxcXFw6XCIpK1wiXVwiKSkmJihjPWUsZD1lLmdldEF0dHJpYnV0ZShhKSl9KTtjJiYoZS5zdHJpY3REaT1udWxsIT09SWQoYyxcInN0cmljdC1kaVwiKSxhKGMsZD9bZF06W10sZSkpfWZ1bmN0aW9uIHNjKGIsXHJcbmEsYyl7SShjKXx8KGM9e30pO2M9eih7c3RyaWN0RGk6ITF9LGMpO3ZhciBkPWZ1bmN0aW9uKCl7Yj1CKGIpO2lmKGIuaW5qZWN0b3IoKSl7dmFyIGQ9YlswXT09PVk/XCJkb2N1bWVudFwiOnZhKGIpO3Rocm93IEthKFwiYnRzdHJwZFwiLGQucmVwbGFjZSgvPC8sXCImbHQ7XCIpLnJlcGxhY2UoLz4vLFwiJmd0O1wiKSk7fWE9YXx8W107YS51bnNoaWZ0KFtcIiRwcm92aWRlXCIsZnVuY3Rpb24oYSl7YS52YWx1ZShcIiRyb290RWxlbWVudFwiLGIpfV0pO2MuZGVidWdJbmZvRW5hYmxlZCYmYS5wdXNoKFtcIiRjb21waWxlUHJvdmlkZXJcIixmdW5jdGlvbihhKXthLmRlYnVnSW5mb0VuYWJsZWQoITApfV0pO2EudW5zaGlmdChcIm5nXCIpO2Q9T2IoYSxjLnN0cmljdERpKTtkLmludm9rZShbXCIkcm9vdFNjb3BlXCIsXCIkcm9vdEVsZW1lbnRcIixcIiRjb21waWxlXCIsXCIkaW5qZWN0b3JcIixmdW5jdGlvbihhLGIsYyxkKXthLiRhcHBseShmdW5jdGlvbigpe2IuZGF0YShcIiRpbmplY3RvclwiLGQpO2MoYikoYSl9KX1dKTtyZXR1cm4gZH0sXHJcbmU9L15OR19FTkFCTEVfREVCVUdfSU5GTyEvLGY9L15OR19ERUZFUl9CT09UU1RSQVAhLztNJiZlLnRlc3QoTS5uYW1lKSYmKGMuZGVidWdJbmZvRW5hYmxlZD0hMCxNLm5hbWU9TS5uYW1lLnJlcGxhY2UoZSxcIlwiKSk7aWYoTSYmIWYudGVzdChNLm5hbWUpKXJldHVybiBkKCk7TS5uYW1lPU0ubmFtZS5yZXBsYWNlKGYsXCJcIik7Z2EucmVzdW1lQm9vdHN0cmFwPWZ1bmN0aW9uKGIpe3MoYixmdW5jdGlvbihiKXthLnB1c2goYil9KTtkKCl9fWZ1bmN0aW9uIEtkKCl7TS5uYW1lPVwiTkdfRU5BQkxFX0RFQlVHX0lORk8hXCIrTS5uYW1lO00ubG9jYXRpb24ucmVsb2FkKCl9ZnVuY3Rpb24gTGQoYil7Yj1nYS5lbGVtZW50KGIpLmluamVjdG9yKCk7aWYoIWIpdGhyb3cgS2EoXCJ0ZXN0XCIpO3JldHVybiBiLmdldChcIiQkdGVzdGFiaWxpdHlcIil9ZnVuY3Rpb24gdGMoYixhKXthPWF8fFwiX1wiO3JldHVybiBiLnJlcGxhY2UoTWQsZnVuY3Rpb24oYixkKXtyZXR1cm4oZD9hOlwiXCIpK2IudG9Mb3dlckNhc2UoKX0pfVxyXG5mdW5jdGlvbiBOZCgpe3ZhciBiO3VjfHwoKHNhPU0ualF1ZXJ5KSYmc2EuZm4ub24/KEI9c2EseihzYS5mbix7c2NvcGU6TGEuc2NvcGUsaXNvbGF0ZVNjb3BlOkxhLmlzb2xhdGVTY29wZSxjb250cm9sbGVyOkxhLmNvbnRyb2xsZXIsaW5qZWN0b3I6TGEuaW5qZWN0b3IsaW5oZXJpdGVkRGF0YTpMYS5pbmhlcml0ZWREYXRhfSksYj1zYS5jbGVhbkRhdGEsc2EuY2xlYW5EYXRhPWZ1bmN0aW9uKGEpe3ZhciBjO2lmKFBiKVBiPSExO2Vsc2UgZm9yKHZhciBkPTAsZTtudWxsIT0oZT1hW2RdKTtkKyspKGM9c2EuX2RhdGEoZSxcImV2ZW50c1wiKSkmJmMuJGRlc3Ryb3kmJnNhKGUpLnRyaWdnZXJIYW5kbGVyKFwiJGRlc3Ryb3lcIik7YihhKX0pOkI9UixnYS5lbGVtZW50PUIsdWM9ITApfWZ1bmN0aW9uIFFiKGIsYSxjKXtpZighYil0aHJvdyBLYShcImFyZXFcIixhfHxcIj9cIixjfHxcInJlcXVpcmVkXCIpO3JldHVybiBifWZ1bmN0aW9uIHNiKGIsYSxjKXtjJiZEKGIpJiYoYj1iW2IubGVuZ3RoLTFdKTtcclxuUWIoRyhiKSxhLFwibm90IGEgZnVuY3Rpb24sIGdvdCBcIisoYiYmXCJvYmplY3RcIj09PXR5cGVvZiBiP2IuY29uc3RydWN0b3IubmFtZXx8XCJPYmplY3RcIjp0eXBlb2YgYikpO3JldHVybiBifWZ1bmN0aW9uIE1hKGIsYSl7aWYoXCJoYXNPd25Qcm9wZXJ0eVwiPT09Yil0aHJvdyBLYShcImJhZG5hbWVcIixhKTt9ZnVuY3Rpb24gdmMoYixhLGMpe2lmKCFhKXJldHVybiBiO2E9YS5zcGxpdChcIi5cIik7Zm9yKHZhciBkLGU9YixmPWEubGVuZ3RoLGc9MDtnPGY7ZysrKWQ9YVtnXSxiJiYoYj0oZT1iKVtkXSk7cmV0dXJuIWMmJkcoYik/bmMoZSxiKTpifWZ1bmN0aW9uIHRiKGIpe3ZhciBhPWJbMF07Yj1iW2IubGVuZ3RoLTFdO3ZhciBjPVthXTtkb3thPWEubmV4dFNpYmxpbmc7aWYoIWEpYnJlYWs7Yy5wdXNoKGEpfXdoaWxlKGEhPT1iKTtyZXR1cm4gQihjKX1mdW5jdGlvbiBoYSgpe3JldHVybiBPYmplY3QuY3JlYXRlKG51bGwpfWZ1bmN0aW9uIE9kKGIpe2Z1bmN0aW9uIGEoYSxiLGMpe3JldHVybiBhW2JdfHxcclxuKGFbYl09YygpKX12YXIgYz1UKFwiJGluamVjdG9yXCIpLGQ9VChcIm5nXCIpO2I9YShiLFwiYW5ndWxhclwiLE9iamVjdCk7Yi4kJG1pbkVycj1iLiQkbWluRXJyfHxUO3JldHVybiBhKGIsXCJtb2R1bGVcIixmdW5jdGlvbigpe3ZhciBiPXt9O3JldHVybiBmdW5jdGlvbihmLGcsaCl7aWYoXCJoYXNPd25Qcm9wZXJ0eVwiPT09Zil0aHJvdyBkKFwiYmFkbmFtZVwiLFwibW9kdWxlXCIpO2cmJmIuaGFzT3duUHJvcGVydHkoZikmJihiW2ZdPW51bGwpO3JldHVybiBhKGIsZixmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYyxkLGUsZil7Znx8KGY9Yik7cmV0dXJuIGZ1bmN0aW9uKCl7ZltlfHxcInB1c2hcIl0oW2MsZCxhcmd1bWVudHNdKTtyZXR1cm4gdX19aWYoIWcpdGhyb3cgYyhcIm5vbW9kXCIsZik7dmFyIGI9W10sZD1bXSxlPVtdLHE9YShcIiRpbmplY3RvclwiLFwiaW52b2tlXCIsXCJwdXNoXCIsZCksdT17X2ludm9rZVF1ZXVlOmIsX2NvbmZpZ0Jsb2NrczpkLF9ydW5CbG9ja3M6ZSxyZXF1aXJlczpnLG5hbWU6Zixwcm92aWRlcjphKFwiJHByb3ZpZGVcIixcclxuXCJwcm92aWRlclwiKSxmYWN0b3J5OmEoXCIkcHJvdmlkZVwiLFwiZmFjdG9yeVwiKSxzZXJ2aWNlOmEoXCIkcHJvdmlkZVwiLFwic2VydmljZVwiKSx2YWx1ZTphKFwiJHByb3ZpZGVcIixcInZhbHVlXCIpLGNvbnN0YW50OmEoXCIkcHJvdmlkZVwiLFwiY29uc3RhbnRcIixcInVuc2hpZnRcIiksYW5pbWF0aW9uOmEoXCIkYW5pbWF0ZVByb3ZpZGVyXCIsXCJyZWdpc3RlclwiKSxmaWx0ZXI6YShcIiRmaWx0ZXJQcm92aWRlclwiLFwicmVnaXN0ZXJcIiksY29udHJvbGxlcjphKFwiJGNvbnRyb2xsZXJQcm92aWRlclwiLFwicmVnaXN0ZXJcIiksZGlyZWN0aXZlOmEoXCIkY29tcGlsZVByb3ZpZGVyXCIsXCJkaXJlY3RpdmVcIiksY29uZmlnOnEscnVuOmZ1bmN0aW9uKGEpe2UucHVzaChhKTtyZXR1cm4gdGhpc319O2gmJnEoaCk7cmV0dXJuIHV9KX19KX1mdW5jdGlvbiBQZChiKXt6KGIse2Jvb3RzdHJhcDpzYyxjb3B5OkVhLGV4dGVuZDp6LGVxdWFsczpmYSxlbGVtZW50OkIsZm9yRWFjaDpzLGluamVjdG9yOk9iLG5vb3A6SCxiaW5kOm5jLHRvSnNvbjokYSxcclxuZnJvbUpzb246b2MsaWRlbnRpdHk6cGEsaXNVbmRlZmluZWQ6QSxpc0RlZmluZWQ6eSxpc1N0cmluZzpGLGlzRnVuY3Rpb246Ryxpc09iamVjdDpJLGlzTnVtYmVyOlYsaXNFbGVtZW50Om1jLGlzQXJyYXk6RCx2ZXJzaW9uOlFkLGlzRGF0ZTpxYSxsb3dlcmNhc2U6USx1cHBlcmNhc2U6dWIsY2FsbGJhY2tzOntjb3VudGVyOjB9LGdldFRlc3RhYmlsaXR5OkxkLCQkbWluRXJyOlQsJCRjc3A6YWIscmVsb2FkV2l0aERlYnVnSW5mbzpLZH0pO2JiPU9kKE0pO3RyeXtiYihcIm5nTG9jYWxlXCIpfWNhdGNoKGEpe2JiKFwibmdMb2NhbGVcIixbXSkucHJvdmlkZXIoXCIkbG9jYWxlXCIsUmQpfWJiKFwibmdcIixbXCJuZ0xvY2FsZVwiXSxbXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe2EucHJvdmlkZXIoeyQkc2FuaXRpemVVcmk6U2R9KTthLnByb3ZpZGVyKFwiJGNvbXBpbGVcIix3YykuZGlyZWN0aXZlKHthOlRkLGlucHV0OnhjLHRleHRhcmVhOnhjLGZvcm06VWQsc2NyaXB0OlZkLHNlbGVjdDpXZCxzdHlsZTpYZCxcclxub3B0aW9uOllkLG5nQmluZDpaZCxuZ0JpbmRIdG1sOiRkLG5nQmluZFRlbXBsYXRlOmFlLG5nQ2xhc3M6YmUsbmdDbGFzc0V2ZW46Y2UsbmdDbGFzc09kZDpkZSxuZ0Nsb2FrOmVlLG5nQ29udHJvbGxlcjpmZSxuZ0Zvcm06Z2UsbmdIaWRlOmhlLG5nSWY6aWUsbmdJbmNsdWRlOmplLG5nSW5pdDprZSxuZ05vbkJpbmRhYmxlOmxlLG5nUGx1cmFsaXplOm1lLG5nUmVwZWF0Om5lLG5nU2hvdzpvZSxuZ1N0eWxlOnBlLG5nU3dpdGNoOnFlLG5nU3dpdGNoV2hlbjpyZSxuZ1N3aXRjaERlZmF1bHQ6c2UsbmdPcHRpb25zOnRlLG5nVHJhbnNjbHVkZTp1ZSxuZ01vZGVsOnZlLG5nTGlzdDp3ZSxuZ0NoYW5nZTp4ZSxwYXR0ZXJuOnljLG5nUGF0dGVybjp5YyxyZXF1aXJlZDp6YyxuZ1JlcXVpcmVkOnpjLG1pbmxlbmd0aDpBYyxuZ01pbmxlbmd0aDpBYyxtYXhsZW5ndGg6QmMsbmdNYXhsZW5ndGg6QmMsbmdWYWx1ZTp5ZSxuZ01vZGVsT3B0aW9uczp6ZX0pLmRpcmVjdGl2ZSh7bmdJbmNsdWRlOkFlfSkuZGlyZWN0aXZlKHZiKS5kaXJlY3RpdmUoQ2MpO1xyXG5hLnByb3ZpZGVyKHskYW5jaG9yU2Nyb2xsOkJlLCRhbmltYXRlOkNlLCRicm93c2VyOkRlLCRjYWNoZUZhY3Rvcnk6RWUsJGNvbnRyb2xsZXI6RmUsJGRvY3VtZW50OkdlLCRleGNlcHRpb25IYW5kbGVyOkhlLCRmaWx0ZXI6RGMsJGludGVycG9sYXRlOkllLCRpbnRlcnZhbDpKZSwkaHR0cDpLZSwkaHR0cEJhY2tlbmQ6TGUsJGxvY2F0aW9uOk1lLCRsb2c6TmUsJHBhcnNlOk9lLCRyb290U2NvcGU6UGUsJHE6UWUsJCRxOlJlLCRzY2U6U2UsJHNjZURlbGVnYXRlOlRlLCRzbmlmZmVyOlVlLCR0ZW1wbGF0ZUNhY2hlOlZlLCR0ZW1wbGF0ZVJlcXVlc3Q6V2UsJCR0ZXN0YWJpbGl0eTpYZSwkdGltZW91dDpZZSwkd2luZG93OlplLCQkckFGOiRlLCQkYXN5bmNDYWxsYmFjazphZiwkJGpxTGl0ZTpiZn0pfV0pfWZ1bmN0aW9uIGNiKGIpe3JldHVybiBiLnJlcGxhY2UoY2YsZnVuY3Rpb24oYSxiLGQsZSl7cmV0dXJuIGU/ZC50b1VwcGVyQ2FzZSgpOmR9KS5yZXBsYWNlKGRmLFwiTW96JDFcIil9XHJcbmZ1bmN0aW9uIEVjKGIpe2I9Yi5ub2RlVHlwZTtyZXR1cm4gYj09PW9hfHwhYnx8OT09PWJ9ZnVuY3Rpb24gRmMoYixhKXt2YXIgYyxkLGU9YS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksZj1bXTtpZihSYi50ZXN0KGIpKXtjPWN8fGUuYXBwZW5kQ2hpbGQoYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtkPShlZi5leGVjKGIpfHxbXCJcIixcIlwiXSlbMV0udG9Mb3dlckNhc2UoKTtkPWlhW2RdfHxpYS5fZGVmYXVsdDtjLmlubmVySFRNTD1kWzFdK2IucmVwbGFjZShmZixcIjwkMT48LyQyPlwiKStkWzJdO2ZvcihkPWRbMF07ZC0tOyljPWMubGFzdENoaWxkO2Y9WWEoZixjLmNoaWxkTm9kZXMpO2M9ZS5maXJzdENoaWxkO2MudGV4dENvbnRlbnQ9XCJcIn1lbHNlIGYucHVzaChhLmNyZWF0ZVRleHROb2RlKGIpKTtlLnRleHRDb250ZW50PVwiXCI7ZS5pbm5lckhUTUw9XCJcIjtzKGYsZnVuY3Rpb24oYSl7ZS5hcHBlbmRDaGlsZChhKX0pO3JldHVybiBlfWZ1bmN0aW9uIFIoYil7aWYoYiBpbnN0YW5jZW9mXHJcblIpcmV0dXJuIGI7dmFyIGE7RihiKSYmKGI9VShiKSxhPSEwKTtpZighKHRoaXMgaW5zdGFuY2VvZiBSKSl7aWYoYSYmXCI8XCIhPWIuY2hhckF0KDApKXRocm93IFNiKFwibm9zZWxcIik7cmV0dXJuIG5ldyBSKGIpfWlmKGEpe2E9WTt2YXIgYztiPShjPWdmLmV4ZWMoYikpP1thLmNyZWF0ZUVsZW1lbnQoY1sxXSldOihjPUZjKGIsYSkpP2MuY2hpbGROb2RlczpbXX1HYyh0aGlzLGIpfWZ1bmN0aW9uIFRiKGIpe3JldHVybiBiLmNsb25lTm9kZSghMCl9ZnVuY3Rpb24gd2IoYixhKXthfHx4YihiKTtpZihiLnF1ZXJ5U2VsZWN0b3JBbGwpZm9yKHZhciBjPWIucXVlcnlTZWxlY3RvckFsbChcIipcIiksZD0wLGU9Yy5sZW5ndGg7ZDxlO2QrKyl4YihjW2RdKX1mdW5jdGlvbiBIYyhiLGEsYyxkKXtpZih5KGQpKXRocm93IFNiKFwib2ZmYXJnc1wiKTt2YXIgZT0oZD15YihiKSkmJmQuZXZlbnRzLGY9ZCYmZC5oYW5kbGU7aWYoZilpZihhKXMoYS5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7aWYoeShjKSl7dmFyIGQ9XHJcbmVbYV07WGEoZHx8W10sYyk7aWYoZCYmMDxkLmxlbmd0aClyZXR1cm59Yi5yZW1vdmVFdmVudExpc3RlbmVyKGEsZiwhMSk7ZGVsZXRlIGVbYV19KTtlbHNlIGZvcihhIGluIGUpXCIkZGVzdHJveVwiIT09YSYmYi5yZW1vdmVFdmVudExpc3RlbmVyKGEsZiwhMSksZGVsZXRlIGVbYV19ZnVuY3Rpb24geGIoYixhKXt2YXIgYz1iLm5nMzM5LGQ9YyYmemJbY107ZCYmKGE/ZGVsZXRlIGQuZGF0YVthXTooZC5oYW5kbGUmJihkLmV2ZW50cy4kZGVzdHJveSYmZC5oYW5kbGUoe30sXCIkZGVzdHJveVwiKSxIYyhiKSksZGVsZXRlIHpiW2NdLGIubmczMzk9dCkpfWZ1bmN0aW9uIHliKGIsYSl7dmFyIGM9Yi5uZzMzOSxjPWMmJnpiW2NdO2EmJiFjJiYoYi5uZzMzOT1jPSsraGYsYz16YltjXT17ZXZlbnRzOnt9LGRhdGE6e30saGFuZGxlOnR9KTtyZXR1cm4gY31mdW5jdGlvbiBVYihiLGEsYyl7aWYoRWMoYikpe3ZhciBkPXkoYyksZT0hZCYmYSYmIUkoYSksZj0hYTtiPShiPXliKGIsIWUpKSYmYi5kYXRhO1xyXG5pZihkKWJbYV09YztlbHNle2lmKGYpcmV0dXJuIGI7aWYoZSlyZXR1cm4gYiYmYlthXTt6KGIsYSl9fX1mdW5jdGlvbiBBYihiLGEpe3JldHVybiBiLmdldEF0dHJpYnV0ZT8tMTwoXCIgXCIrKGIuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIil8fFwiXCIpK1wiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLFwiIFwiKS5pbmRleE9mKFwiIFwiK2ErXCIgXCIpOiExfWZ1bmN0aW9uIEJiKGIsYSl7YSYmYi5zZXRBdHRyaWJ1dGUmJnMoYS5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7Yi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLFUoKFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcIiBcIikucmVwbGFjZShcIiBcIitVKGEpK1wiIFwiLFwiIFwiKSkpfSl9ZnVuY3Rpb24gQ2IoYixhKXtpZihhJiZiLnNldEF0dHJpYnV0ZSl7dmFyIGM9KFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcIiBcIik7cyhhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXthPVxyXG5VKGEpOy0xPT09Yy5pbmRleE9mKFwiIFwiK2ErXCIgXCIpJiYoYys9YStcIiBcIil9KTtiLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsVShjKSl9fWZ1bmN0aW9uIEdjKGIsYSl7aWYoYSlpZihhLm5vZGVUeXBlKWJbYi5sZW5ndGgrK109YTtlbHNle3ZhciBjPWEubGVuZ3RoO2lmKFwibnVtYmVyXCI9PT10eXBlb2YgYyYmYS53aW5kb3chPT1hKXtpZihjKWZvcih2YXIgZD0wO2Q8YztkKyspYltiLmxlbmd0aCsrXT1hW2RdfWVsc2UgYltiLmxlbmd0aCsrXT1hfX1mdW5jdGlvbiBJYyhiLGEpe3JldHVybiBEYihiLFwiJFwiKyhhfHxcIm5nQ29udHJvbGxlclwiKStcIkNvbnRyb2xsZXJcIil9ZnVuY3Rpb24gRGIoYixhLGMpezk9PWIubm9kZVR5cGUmJihiPWIuZG9jdW1lbnRFbGVtZW50KTtmb3IoYT1EKGEpP2E6W2FdO2I7KXtmb3IodmFyIGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspaWYoKGM9Qi5kYXRhKGIsYVtkXSkpIT09dClyZXR1cm4gYztiPWIucGFyZW50Tm9kZXx8MTE9PT1iLm5vZGVUeXBlJiZiLmhvc3R9fVxyXG5mdW5jdGlvbiBKYyhiKXtmb3Iod2IoYiwhMCk7Yi5maXJzdENoaWxkOyliLnJlbW92ZUNoaWxkKGIuZmlyc3RDaGlsZCl9ZnVuY3Rpb24gS2MoYixhKXthfHx3YihiKTt2YXIgYz1iLnBhcmVudE5vZGU7YyYmYy5yZW1vdmVDaGlsZChiKX1mdW5jdGlvbiBqZihiLGEpe2E9YXx8TTtpZihcImNvbXBsZXRlXCI9PT1hLmRvY3VtZW50LnJlYWR5U3RhdGUpYS5zZXRUaW1lb3V0KGIpO2Vsc2UgQihhKS5vbihcImxvYWRcIixiKX1mdW5jdGlvbiBMYyhiLGEpe3ZhciBjPUViW2EudG9Mb3dlckNhc2UoKV07cmV0dXJuIGMmJk1jW3VhKGIpXSYmY31mdW5jdGlvbiBrZihiLGEpe3ZhciBjPWIubm9kZU5hbWU7cmV0dXJuKFwiSU5QVVRcIj09PWN8fFwiVEVYVEFSRUFcIj09PWMpJiZOY1thXX1mdW5jdGlvbiBsZihiLGEpe3ZhciBjPWZ1bmN0aW9uKGMsZSl7Yy5pc0RlZmF1bHRQcmV2ZW50ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gYy5kZWZhdWx0UHJldmVudGVkfTt2YXIgZj1hW2V8fGMudHlwZV0sZz1mP2YubGVuZ3RoOlxyXG4wO2lmKGcpe2lmKEEoYy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQpKXt2YXIgaD1jLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjtjLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbj1mdW5jdGlvbigpe2MuaW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkPSEwO2Muc3RvcFByb3BhZ2F0aW9uJiZjLnN0b3BQcm9wYWdhdGlvbigpO2gmJmguY2FsbChjKX19Yy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1mdW5jdGlvbigpe3JldHVybiEwPT09Yy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWR9OzE8ZyYmKGY9cmEoZikpO2Zvcih2YXIgbD0wO2w8ZztsKyspYy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpfHxmW2xdLmNhbGwoYixjKX19O2MuZWxlbT1iO3JldHVybiBjfWZ1bmN0aW9uIGJmKCl7dGhpcy4kZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHooUix7aGFzQ2xhc3M6ZnVuY3Rpb24oYixhKXtiLmF0dHImJihiPWJbMF0pO3JldHVybiBBYihiLGEpfSxhZGRDbGFzczpmdW5jdGlvbihiLFxyXG5hKXtiLmF0dHImJihiPWJbMF0pO3JldHVybiBDYihiLGEpfSxyZW1vdmVDbGFzczpmdW5jdGlvbihiLGEpe2IuYXR0ciYmKGI9YlswXSk7cmV0dXJuIEJiKGIsYSl9fSl9fWZ1bmN0aW9uIE5hKGIsYSl7dmFyIGM9YiYmYi4kJGhhc2hLZXk7aWYoYylyZXR1cm5cImZ1bmN0aW9uXCI9PT10eXBlb2YgYyYmKGM9Yi4kJGhhc2hLZXkoKSksYztjPXR5cGVvZiBiO3JldHVybiBjPVwiZnVuY3Rpb25cIj09Y3x8XCJvYmplY3RcIj09YyYmbnVsbCE9PWI/Yi4kJGhhc2hLZXk9YytcIjpcIisoYXx8RmQpKCk6YytcIjpcIitifWZ1bmN0aW9uIGRiKGIsYSl7aWYoYSl7dmFyIGM9MDt0aGlzLm5leHRVaWQ9ZnVuY3Rpb24oKXtyZXR1cm4rK2N9fXMoYix0aGlzLnB1dCx0aGlzKX1mdW5jdGlvbiBtZihiKXtyZXR1cm4oYj1iLnRvU3RyaW5nKCkucmVwbGFjZShPYyxcIlwiKS5tYXRjaChQYykpP1wiZnVuY3Rpb24oXCIrKGJbMV18fFwiXCIpLnJlcGxhY2UoL1tcXHNcXHJcXG5dKy8sXCIgXCIpK1wiKVwiOlwiZm5cIn1mdW5jdGlvbiBWYihiLFxyXG5hLGMpe3ZhciBkO2lmKFwiZnVuY3Rpb25cIj09PXR5cGVvZiBiKXtpZighKGQ9Yi4kaW5qZWN0KSl7ZD1bXTtpZihiLmxlbmd0aCl7aWYoYSl0aHJvdyBGKGMpJiZjfHwoYz1iLm5hbWV8fG1mKGIpKSxHYShcInN0cmljdGRpXCIsYyk7YT1iLnRvU3RyaW5nKCkucmVwbGFjZShPYyxcIlwiKTthPWEubWF0Y2goUGMpO3MoYVsxXS5zcGxpdChuZiksZnVuY3Rpb24oYSl7YS5yZXBsYWNlKG9mLGZ1bmN0aW9uKGEsYixjKXtkLnB1c2goYyl9KX0pfWIuJGluamVjdD1kfX1lbHNlIEQoYik/KGE9Yi5sZW5ndGgtMSxzYihiW2FdLFwiZm5cIiksZD1iLnNsaWNlKDAsYSkpOnNiKGIsXCJmblwiLCEwKTtyZXR1cm4gZH1mdW5jdGlvbiBPYihiLGEpe2Z1bmN0aW9uIGMoYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7aWYoSShiKSlzKGIsa2MoYSkpO2Vsc2UgcmV0dXJuIGEoYixjKX19ZnVuY3Rpb24gZChhLGIpe01hKGEsXCJzZXJ2aWNlXCIpO2lmKEcoYil8fEQoYikpYj1xLmluc3RhbnRpYXRlKGIpO2lmKCFiLiRnZXQpdGhyb3cgR2EoXCJwZ2V0XCIsXHJcbmEpO3JldHVybiBwW2ErXCJQcm92aWRlclwiXT1ifWZ1bmN0aW9uIGUoYSxiKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1yLmludm9rZShiLHRoaXMpO2lmKEEoYykpdGhyb3cgR2EoXCJ1bmRlZlwiLGEpO3JldHVybiBjfX1mdW5jdGlvbiBmKGEsYixjKXtyZXR1cm4gZChhLHskZ2V0OiExIT09Yz9lKGEsYik6Yn0pfWZ1bmN0aW9uIGcoYSl7dmFyIGI9W10sYztzKGEsZnVuY3Rpb24oYSl7ZnVuY3Rpb24gZChhKXt2YXIgYixjO2I9MDtmb3IoYz1hLmxlbmd0aDtiPGM7YisrKXt2YXIgZT1hW2JdLGY9cS5nZXQoZVswXSk7ZltlWzFdXS5hcHBseShmLGVbMl0pfX1pZighbS5nZXQoYSkpe20ucHV0KGEsITApO3RyeXtGKGEpPyhjPWJiKGEpLGI9Yi5jb25jYXQoZyhjLnJlcXVpcmVzKSkuY29uY2F0KGMuX3J1bkJsb2NrcyksZChjLl9pbnZva2VRdWV1ZSksZChjLl9jb25maWdCbG9ja3MpKTpHKGEpP2IucHVzaChxLmludm9rZShhKSk6RChhKT9iLnB1c2gocS5pbnZva2UoYSkpOnNiKGEsXCJtb2R1bGVcIil9Y2F0Y2goZSl7dGhyb3cgRChhKSYmXHJcbihhPWFbYS5sZW5ndGgtMV0pLGUubWVzc2FnZSYmZS5zdGFjayYmLTE9PWUuc3RhY2suaW5kZXhPZihlLm1lc3NhZ2UpJiYoZT1lLm1lc3NhZ2UrXCJcXG5cIitlLnN0YWNrKSxHYShcIm1vZHVsZXJyXCIsYSxlLnN0YWNrfHxlLm1lc3NhZ2V8fGUpO319fSk7cmV0dXJuIGJ9ZnVuY3Rpb24gaChiLGMpe2Z1bmN0aW9uIGQoYSxlKXtpZihiLmhhc093blByb3BlcnR5KGEpKXtpZihiW2FdPT09bCl0aHJvdyBHYShcImNkZXBcIixhK1wiIDwtIFwiK2suam9pbihcIiA8LSBcIikpO3JldHVybiBiW2FdfXRyeXtyZXR1cm4gay51bnNoaWZ0KGEpLGJbYV09bCxiW2FdPWMoYSxlKX1jYXRjaChmKXt0aHJvdyBiW2FdPT09bCYmZGVsZXRlIGJbYV0sZjt9ZmluYWxseXtrLnNoaWZ0KCl9fWZ1bmN0aW9uIGUoYixjLGYsZyl7XCJzdHJpbmdcIj09PXR5cGVvZiBmJiYoZz1mLGY9bnVsbCk7dmFyIGg9W10saz1WYihiLGEsZyksbCxxLHA7cT0wO2ZvcihsPWsubGVuZ3RoO3E8bDtxKyspe3A9a1txXTtpZihcInN0cmluZ1wiIT09XHJcbnR5cGVvZiBwKXRocm93IEdhKFwiaXRrblwiLHApO2gucHVzaChmJiZmLmhhc093blByb3BlcnR5KHApP2ZbcF06ZChwLGcpKX1EKGIpJiYoYj1iW2xdKTtyZXR1cm4gYi5hcHBseShjLGgpfXJldHVybntpbnZva2U6ZSxpbnN0YW50aWF0ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9T2JqZWN0LmNyZWF0ZSgoRChhKT9hW2EubGVuZ3RoLTFdOmEpLnByb3RvdHlwZSk7YT1lKGEsZCxiLGMpO3JldHVybiBJKGEpfHxHKGEpP2E6ZH0sZ2V0OmQsYW5ub3RhdGU6VmIsaGFzOmZ1bmN0aW9uKGEpe3JldHVybiBwLmhhc093blByb3BlcnR5KGErXCJQcm92aWRlclwiKXx8Yi5oYXNPd25Qcm9wZXJ0eShhKX19fWE9ITA9PT1hO3ZhciBsPXt9LGs9W10sbT1uZXcgZGIoW10sITApLHA9eyRwcm92aWRlOntwcm92aWRlcjpjKGQpLGZhY3Rvcnk6YyhmKSxzZXJ2aWNlOmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZihhLFtcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEpe3JldHVybiBhLmluc3RhbnRpYXRlKGIpfV0pfSksXHJcbnZhbHVlOmMoZnVuY3Rpb24oYSxiKXtyZXR1cm4gZihhLGRhKGIpLCExKX0pLGNvbnN0YW50OmMoZnVuY3Rpb24oYSxiKXtNYShhLFwiY29uc3RhbnRcIik7cFthXT1iO3VbYV09Yn0pLGRlY29yYXRvcjpmdW5jdGlvbihhLGIpe3ZhciBjPXEuZ2V0KGErXCJQcm92aWRlclwiKSxkPWMuJGdldDtjLiRnZXQ9ZnVuY3Rpb24oKXt2YXIgYT1yLmludm9rZShkLGMpO3JldHVybiByLmludm9rZShiLG51bGwseyRkZWxlZ2F0ZTphfSl9fX19LHE9cC4kaW5qZWN0b3I9aChwLGZ1bmN0aW9uKGEsYil7Z2EuaXNTdHJpbmcoYikmJmsucHVzaChiKTt0aHJvdyBHYShcInVucHJcIixrLmpvaW4oXCIgPC0gXCIpKTt9KSx1PXt9LHI9dS4kaW5qZWN0b3I9aCh1LGZ1bmN0aW9uKGEsYil7dmFyIGM9cS5nZXQoYStcIlByb3ZpZGVyXCIsYik7cmV0dXJuIHIuaW52b2tlKGMuJGdldCxjLHQsYSl9KTtzKGcoYiksZnVuY3Rpb24oYSl7ci5pbnZva2UoYXx8SCl9KTtyZXR1cm4gcn1mdW5jdGlvbiBCZSgpe3ZhciBiPSEwO3RoaXMuZGlzYWJsZUF1dG9TY3JvbGxpbmc9XHJcbmZ1bmN0aW9uKCl7Yj0hMX07dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixcIiRsb2NhdGlvblwiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGEsYyxkKXtmdW5jdGlvbiBlKGEpe3ZhciBiPW51bGw7QXJyYXkucHJvdG90eXBlLnNvbWUuY2FsbChhLGZ1bmN0aW9uKGEpe2lmKFwiYVwiPT09dWEoYSkpcmV0dXJuIGI9YSwhMH0pO3JldHVybiBifWZ1bmN0aW9uIGYoYil7aWYoYil7Yi5zY3JvbGxJbnRvVmlldygpO3ZhciBjO2M9Zy55T2Zmc2V0O0coYyk/Yz1jKCk6bWMoYyk/KGM9Y1swXSxjPVwiZml4ZWRcIiE9PWEuZ2V0Q29tcHV0ZWRTdHlsZShjKS5wb3NpdGlvbj8wOmMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tKTpWKGMpfHwoYz0wKTtjJiYoYj1iLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCxhLnNjcm9sbEJ5KDAsYi1jKSl9ZWxzZSBhLnNjcm9sbFRvKDAsMCl9ZnVuY3Rpb24gZygpe3ZhciBhPWMuaGFzaCgpLGI7YT8oYj1oLmdldEVsZW1lbnRCeUlkKGEpKT9mKGIpOihiPWUoaC5nZXRFbGVtZW50c0J5TmFtZShhKSkpP1xyXG5mKGIpOlwidG9wXCI9PT1hJiZmKG51bGwpOmYobnVsbCl9dmFyIGg9YS5kb2N1bWVudDtiJiZkLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBjLmhhc2goKX0sZnVuY3Rpb24oYSxiKXthPT09YiYmXCJcIj09PWF8fGpmKGZ1bmN0aW9uKCl7ZC4kZXZhbEFzeW5jKGcpfSl9KTtyZXR1cm4gZ31dfWZ1bmN0aW9uIGFmKCl7dGhpcy4kZ2V0PVtcIiQkckFGXCIsXCIkdGltZW91dFwiLGZ1bmN0aW9uKGIsYSl7cmV0dXJuIGIuc3VwcG9ydGVkP2Z1bmN0aW9uKGEpe3JldHVybiBiKGEpfTpmdW5jdGlvbihiKXtyZXR1cm4gYShiLDAsITEpfX1dfWZ1bmN0aW9uIHBmKGIsYSxjLGQpe2Z1bmN0aW9uIGUoYSl7dHJ5e2EuYXBwbHkobnVsbCxaYS5jYWxsKGFyZ3VtZW50cywxKSl9ZmluYWxseXtpZih2LS0sMD09PXYpZm9yKDt3Lmxlbmd0aDspdHJ5e3cucG9wKCkoKX1jYXRjaChiKXtjLmVycm9yKGIpfX19ZnVuY3Rpb24gZihhLGIpeyhmdW5jdGlvbiBOKCl7cyhMLGZ1bmN0aW9uKGEpe2EoKX0pO0M9YihOLFxyXG5hKX0pKCl9ZnVuY3Rpb24gZygpe2goKTtsKCl9ZnVuY3Rpb24gaCgpe3g9Yi5oaXN0b3J5LnN0YXRlO3g9QSh4KT9udWxsOng7ZmEoeCxKKSYmKHg9Sik7Sj14fWZ1bmN0aW9uIGwoKXtpZihFIT09bS51cmwoKXx8UCE9PXgpRT1tLnVybCgpLFA9eCxzKFcsZnVuY3Rpb24oYSl7YShtLnVybCgpLHgpfSl9ZnVuY3Rpb24gayhhKXt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChhKX1jYXRjaChiKXtyZXR1cm4gYX19dmFyIG09dGhpcyxwPWFbMF0scT1iLmxvY2F0aW9uLHU9Yi5oaXN0b3J5LHI9Yi5zZXRUaW1lb3V0LE89Yi5jbGVhclRpbWVvdXQsbj17fTttLmlzTW9jaz0hMTt2YXIgdj0wLHc9W107bS4kJGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0PWU7bS4kJGluY091dHN0YW5kaW5nUmVxdWVzdENvdW50PWZ1bmN0aW9uKCl7disrfTttLm5vdGlmeVdoZW5Ob091dHN0YW5kaW5nUmVxdWVzdHM9ZnVuY3Rpb24oYSl7cyhMLGZ1bmN0aW9uKGEpe2EoKX0pOzA9PT12P2EoKTpcclxudy5wdXNoKGEpfTt2YXIgTD1bXSxDO20uYWRkUG9sbEZuPWZ1bmN0aW9uKGEpe0EoQykmJmYoMTAwLHIpO0wucHVzaChhKTtyZXR1cm4gYX07dmFyIHgsUCxFPXEuaHJlZixTPWEuZmluZChcImJhc2VcIiksWD1udWxsO2goKTtQPXg7bS51cmw9ZnVuY3Rpb24oYSxjLGUpe0EoZSkmJihlPW51bGwpO3EhPT1iLmxvY2F0aW9uJiYocT1iLmxvY2F0aW9uKTt1IT09Yi5oaXN0b3J5JiYodT1iLmhpc3RvcnkpO2lmKGEpe3ZhciBmPVA9PT1lO2lmKEU9PT1hJiYoIWQuaGlzdG9yeXx8ZikpcmV0dXJuIG07dmFyIGc9RSYmSGEoRSk9PT1IYShhKTtFPWE7UD1lOyFkLmhpc3Rvcnl8fGcmJmY/KGd8fChYPWEpLGM/cS5yZXBsYWNlKGEpOmc/KGM9cSxlPWEuaW5kZXhPZihcIiNcIiksYT0tMT09PWU/XCJcIjphLnN1YnN0cihlKzEpLGMuaGFzaD1hKTpxLmhyZWY9YSk6KHVbYz9cInJlcGxhY2VTdGF0ZVwiOlwicHVzaFN0YXRlXCJdKGUsXCJcIixhKSxoKCksUD14KTtyZXR1cm4gbX1yZXR1cm4gWHx8cS5ocmVmLnJlcGxhY2UoLyUyNy9nLFxyXG5cIidcIil9O20uc3RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4geH07dmFyIFc9W10sd2E9ITEsSj1udWxsO20ub25VcmxDaGFuZ2U9ZnVuY3Rpb24oYSl7aWYoIXdhKXtpZihkLmhpc3RvcnkpQihiKS5vbihcInBvcHN0YXRlXCIsZyk7QihiKS5vbihcImhhc2hjaGFuZ2VcIixnKTt3YT0hMH1XLnB1c2goYSk7cmV0dXJuIGF9O20uJCRjaGVja1VybENoYW5nZT1sO20uYmFzZUhyZWY9ZnVuY3Rpb24oKXt2YXIgYT1TLmF0dHIoXCJocmVmXCIpO3JldHVybiBhP2EucmVwbGFjZSgvXihodHRwcz9cXDopP1xcL1xcL1teXFwvXSovLFwiXCIpOlwiXCJ9O3ZhciBlYT17fSx5PVwiXCIsY2E9bS5iYXNlSHJlZigpO20uY29va2llcz1mdW5jdGlvbihhLGIpe3ZhciBkLGUsZixnO2lmKGEpYj09PXQ/cC5jb29raWU9ZW5jb2RlVVJJQ29tcG9uZW50KGEpK1wiPTtwYXRoPVwiK2NhK1wiO2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVRcIjpGKGIpJiYoZD0ocC5jb29raWU9ZW5jb2RlVVJJQ29tcG9uZW50KGEpK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChiKStcclxuXCI7cGF0aD1cIitjYSkubGVuZ3RoKzEsNDA5NjxkJiZjLndhcm4oXCJDb29raWUgJ1wiK2ErXCInIHBvc3NpYmx5IG5vdCBzZXQgb3Igb3ZlcmZsb3dlZCBiZWNhdXNlIGl0IHdhcyB0b28gbGFyZ2UgKFwiK2QrXCIgPiA0MDk2IGJ5dGVzKSFcIikpO2Vsc2V7aWYocC5jb29raWUhPT15KWZvcih5PXAuY29va2llLGQ9eS5zcGxpdChcIjsgXCIpLGVhPXt9LGY9MDtmPGQubGVuZ3RoO2YrKyllPWRbZl0sZz1lLmluZGV4T2YoXCI9XCIpLDA8ZyYmKGE9ayhlLnN1YnN0cmluZygwLGcpKSxlYVthXT09PXQmJihlYVthXT1rKGUuc3Vic3RyaW5nKGcrMSkpKSk7cmV0dXJuIGVhfX07bS5kZWZlcj1mdW5jdGlvbihhLGIpe3ZhciBjO3YrKztjPXIoZnVuY3Rpb24oKXtkZWxldGUgbltjXTtlKGEpfSxifHwwKTtuW2NdPSEwO3JldHVybiBjfTttLmRlZmVyLmNhbmNlbD1mdW5jdGlvbihhKXtyZXR1cm4gblthXT8oZGVsZXRlIG5bYV0sTyhhKSxlKEgpLCEwKTohMX19ZnVuY3Rpb24gRGUoKXt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFxyXG5cIiRsb2dcIixcIiRzbmlmZmVyXCIsXCIkZG9jdW1lbnRcIixmdW5jdGlvbihiLGEsYyxkKXtyZXR1cm4gbmV3IHBmKGIsZCxhLGMpfV19ZnVuY3Rpb24gRWUoKXt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGIsZCl7ZnVuY3Rpb24gZShhKXthIT1wJiYocT9xPT1hJiYocT1hLm4pOnE9YSxmKGEubixhLnApLGYoYSxwKSxwPWEscC5uPW51bGwpfWZ1bmN0aW9uIGYoYSxiKXthIT1iJiYoYSYmKGEucD1iKSxiJiYoYi5uPWEpKX1pZihiIGluIGEpdGhyb3cgVChcIiRjYWNoZUZhY3RvcnlcIikoXCJpaWRcIixiKTt2YXIgZz0wLGg9eih7fSxkLHtpZDpifSksbD17fSxrPWQmJmQuY2FwYWNpdHl8fE51bWJlci5NQVhfVkFMVUUsbT17fSxwPW51bGwscT1udWxsO3JldHVybiBhW2JdPXtwdXQ6ZnVuY3Rpb24oYSxiKXtpZihrPE51bWJlci5NQVhfVkFMVUUpe3ZhciBjPW1bYV18fChtW2FdPXtrZXk6YX0pO2UoYyl9aWYoIUEoYikpcmV0dXJuIGEgaW4gbHx8ZysrLGxbYV09YixnPmsmJnRoaXMucmVtb3ZlKHEua2V5KSxcclxuYn0sZ2V0OmZ1bmN0aW9uKGEpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGI9bVthXTtpZighYilyZXR1cm47ZShiKX1yZXR1cm4gbFthXX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2lmKGs8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGI9bVthXTtpZighYilyZXR1cm47Yj09cCYmKHA9Yi5wKTtiPT1xJiYocT1iLm4pO2YoYi5uLGIucCk7ZGVsZXRlIG1bYV19ZGVsZXRlIGxbYV07Zy0tfSxyZW1vdmVBbGw6ZnVuY3Rpb24oKXtsPXt9O2c9MDttPXt9O3A9cT1udWxsfSxkZXN0cm95OmZ1bmN0aW9uKCl7bT1oPWw9bnVsbDtkZWxldGUgYVtiXX0saW5mbzpmdW5jdGlvbigpe3JldHVybiB6KHt9LGgse3NpemU6Z30pfX19dmFyIGE9e307Yi5pbmZvPWZ1bmN0aW9uKCl7dmFyIGI9e307cyhhLGZ1bmN0aW9uKGEsZSl7YltlXT1hLmluZm8oKX0pO3JldHVybiBifTtiLmdldD1mdW5jdGlvbihiKXtyZXR1cm4gYVtiXX07cmV0dXJuIGJ9fWZ1bmN0aW9uIFZlKCl7dGhpcy4kZ2V0PVtcIiRjYWNoZUZhY3RvcnlcIixcclxuZnVuY3Rpb24oYil7cmV0dXJuIGIoXCJ0ZW1wbGF0ZXNcIil9XX1mdW5jdGlvbiB3YyhiLGEpe2Z1bmN0aW9uIGMoYSxiKXt2YXIgYz0vXlxccyooW0AmXXw9KFxcKj8pKShcXD8/KVxccyooXFx3KilcXHMqJC8sZD17fTtzKGEsZnVuY3Rpb24oYSxlKXt2YXIgZj1hLm1hdGNoKGMpO2lmKCFmKXRocm93IGphKFwiaXNjcFwiLGIsZSxhKTtkW2VdPXttb2RlOmZbMV1bMF0sY29sbGVjdGlvbjpcIipcIj09PWZbMl0sb3B0aW9uYWw6XCI/XCI9PT1mWzNdLGF0dHJOYW1lOmZbNF18fGV9fSk7cmV0dXJuIGR9dmFyIGQ9e30sZT0vXlxccypkaXJlY3RpdmVcXDpcXHMqKFtcXHdcXC1dKylcXHMrKC4qKSQvLGY9LygoW1xcd1xcLV0rKSg/OlxcOihbXjtdKykpPzs/KS8sZz1HZChcIm5nU3JjLG5nU3Jjc2V0LHNyYyxzcmNzZXRcIiksaD0vXig/OihcXF5cXF4/KT8oXFw/KT8oXFxeXFxePyk/KT8vLGw9L14ob25bYS16XSt8Zm9ybWFjdGlvbikkLzt0aGlzLmRpcmVjdGl2ZT1mdW5jdGlvbiBwKGEsZSl7TWEoYSxcImRpcmVjdGl2ZVwiKTtGKGEpPyhRYihlLFxyXG5cImRpcmVjdGl2ZUZhY3RvcnlcIiksZC5oYXNPd25Qcm9wZXJ0eShhKXx8KGRbYV09W10sYi5mYWN0b3J5KGErXCJEaXJlY3RpdmVcIixbXCIkaW5qZWN0b3JcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsZnVuY3Rpb24oYixlKXt2YXIgZj1bXTtzKGRbYV0sZnVuY3Rpb24oZCxnKXt0cnl7dmFyIGg9Yi5pbnZva2UoZCk7RyhoKT9oPXtjb21waWxlOmRhKGgpfTohaC5jb21waWxlJiZoLmxpbmsmJihoLmNvbXBpbGU9ZGEoaC5saW5rKSk7aC5wcmlvcml0eT1oLnByaW9yaXR5fHwwO2guaW5kZXg9ZztoLm5hbWU9aC5uYW1lfHxhO2gucmVxdWlyZT1oLnJlcXVpcmV8fGguY29udHJvbGxlciYmaC5uYW1lO2gucmVzdHJpY3Q9aC5yZXN0cmljdHx8XCJFQVwiO0koaC5zY29wZSkmJihoLiQkaXNvbGF0ZUJpbmRpbmdzPWMoaC5zY29wZSxoLm5hbWUpKTtmLnB1c2goaCl9Y2F0Y2gobCl7ZShsKX19KTtyZXR1cm4gZn1dKSksZFthXS5wdXNoKGUpKTpzKGEsa2MocCkpO3JldHVybiB0aGlzfTt0aGlzLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0PVxyXG5mdW5jdGlvbihiKXtyZXR1cm4geShiKT8oYS5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdChiKSx0aGlzKTphLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0KCl9O3RoaXMuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGIpe3JldHVybiB5KGIpPyhhLmltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdChiKSx0aGlzKTphLmltZ1NyY1Nhbml0aXphdGlvbldoaXRlbGlzdCgpfTt2YXIgaz0hMDt0aGlzLmRlYnVnSW5mb0VuYWJsZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/KGs9YSx0aGlzKTprfTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsXCIkaW50ZXJwb2xhdGVcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkdGVtcGxhdGVSZXF1ZXN0XCIsXCIkcGFyc2VcIixcIiRjb250cm9sbGVyXCIsXCIkcm9vdFNjb3BlXCIsXCIkZG9jdW1lbnRcIixcIiRzY2VcIixcIiRhbmltYXRlXCIsXCIkJHNhbml0aXplVXJpXCIsZnVuY3Rpb24oYSxiLGMscixPLG4sdix3LEwsQyx4KXtmdW5jdGlvbiBQKGEsYil7dHJ5e2EuYWRkQ2xhc3MoYil9Y2F0Y2goYyl7fX1cclxuZnVuY3Rpb24gRShhLGIsYyxkLGUpe2EgaW5zdGFuY2VvZiBCfHwoYT1CKGEpKTtzKGEsZnVuY3Rpb24oYixjKXtiLm5vZGVUeXBlPT1wYiYmYi5ub2RlVmFsdWUubWF0Y2goL1xcUysvKSYmKGFbY109QihiKS53cmFwKFwiPHNwYW4+PC9zcGFuPlwiKS5wYXJlbnQoKVswXSl9KTt2YXIgZj1TKGEsYixhLGMsZCxlKTtFLiQkYWRkU2NvcGVDbGFzcyhhKTt2YXIgZz1udWxsO3JldHVybiBmdW5jdGlvbihiLGMsZCl7UWIoYixcInNjb3BlXCIpO2Q9ZHx8e307dmFyIGU9ZC5wYXJlbnRCb3VuZFRyYW5zY2x1ZGVGbixoPWQudHJhbnNjbHVkZUNvbnRyb2xsZXJzO2Q9ZC5mdXR1cmVQYXJlbnRFbGVtZW50O2UmJmUuJCRib3VuZFRyYW5zY2x1ZGUmJihlPWUuJCRib3VuZFRyYW5zY2x1ZGUpO2d8fChnPShkPWQmJmRbMF0pP1wiZm9yZWlnbm9iamVjdFwiIT09dWEoZCkmJmQudG9TdHJpbmcoKS5tYXRjaCgvU1ZHLyk/XCJzdmdcIjpcImh0bWxcIjpcImh0bWxcIik7ZD1cImh0bWxcIiE9PWc/QihXYihnLEIoXCI8ZGl2PlwiKS5hcHBlbmQoYSkuaHRtbCgpKSk6XHJcbmM/TGEuY2xvbmUuY2FsbChhKTphO2lmKGgpZm9yKHZhciBsIGluIGgpZC5kYXRhKFwiJFwiK2wrXCJDb250cm9sbGVyXCIsaFtsXS5pbnN0YW5jZSk7RS4kJGFkZFNjb3BlSW5mbyhkLGIpO2MmJmMoZCxiKTtmJiZmKGIsZCxkLGUpO3JldHVybiBkfX1mdW5jdGlvbiBTKGEsYixjLGQsZSxmKXtmdW5jdGlvbiBnKGEsYyxkLGUpe3ZhciBmLGwsayxxLHAsbix3O2lmKHIpZm9yKHc9QXJyYXkoYy5sZW5ndGgpLHE9MDtxPGgubGVuZ3RoO3ErPTMpZj1oW3FdLHdbZl09Y1tmXTtlbHNlIHc9YztxPTA7Zm9yKHA9aC5sZW5ndGg7cTxwOylsPXdbaFtxKytdXSxjPWhbcSsrXSxmPWhbcSsrXSxjPyhjLnNjb3BlPyhrPWEuJG5ldygpLEUuJCRhZGRTY29wZUluZm8oQihsKSxrKSk6az1hLG49Yy50cmFuc2NsdWRlT25UaGlzRWxlbWVudD9YKGEsYy50cmFuc2NsdWRlLGUsYy5lbGVtZW50VHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQpOiFjLnRlbXBsYXRlT25UaGlzRWxlbWVudCYmZT9lOiFlJiZiP1goYSxcclxuYik6bnVsbCxjKGYsayxsLGQsbikpOmYmJmYoYSxsLmNoaWxkTm9kZXMsdCxlKX1mb3IodmFyIGg9W10sbCxrLHEscCxyLG49MDtuPGEubGVuZ3RoO24rKyl7bD1uZXcgWGI7az1XKGFbbl0sW10sbCwwPT09bj9kOnQsZSk7KGY9ay5sZW5ndGg/ZWEoayxhW25dLGwsYixjLG51bGwsW10sW10sZik6bnVsbCkmJmYuc2NvcGUmJkUuJCRhZGRTY29wZUNsYXNzKGwuJCRlbGVtZW50KTtsPWYmJmYudGVybWluYWx8fCEocT1hW25dLmNoaWxkTm9kZXMpfHwhcS5sZW5ndGg/bnVsbDpTKHEsZj8oZi50cmFuc2NsdWRlT25UaGlzRWxlbWVudHx8IWYudGVtcGxhdGVPblRoaXNFbGVtZW50KSYmZi50cmFuc2NsdWRlOmIpO2lmKGZ8fGwpaC5wdXNoKG4sZixsKSxwPSEwLHI9cnx8ZjtmPW51bGx9cmV0dXJuIHA/ZzpudWxsfWZ1bmN0aW9uIFgoYSxiLGMsZCl7cmV0dXJuIGZ1bmN0aW9uKGQsZSxmLGcsaCl7ZHx8KGQ9YS4kbmV3KCExLGgpLGQuJCR0cmFuc2NsdWRlZD0hMCk7cmV0dXJuIGIoZCxlLFxyXG57cGFyZW50Qm91bmRUcmFuc2NsdWRlRm46Yyx0cmFuc2NsdWRlQ29udHJvbGxlcnM6ZixmdXR1cmVQYXJlbnRFbGVtZW50Omd9KX19ZnVuY3Rpb24gVyhhLGIsYyxkLGcpe3ZhciBoPWMuJGF0dHIsbDtzd2l0Y2goYS5ub2RlVHlwZSl7Y2FzZSBvYTpjYShiLHlhKHVhKGEpKSxcIkVcIixkLGcpO2Zvcih2YXIgayxxLHAscj1hLmF0dHJpYnV0ZXMsbj0wLHc9ciYmci5sZW5ndGg7bjx3O24rKyl7dmFyIE89ITEsTD0hMTtrPXJbbl07bD1rLm5hbWU7cT1VKGsudmFsdWUpO2s9eWEobCk7aWYocD1mYi50ZXN0KGspKWw9bC5yZXBsYWNlKFJjLFwiXCIpLnN1YnN0cig4KS5yZXBsYWNlKC9fKC4pL2csZnVuY3Rpb24oYSxiKXtyZXR1cm4gYi50b1VwcGVyQ2FzZSgpfSk7dmFyIHU9ay5yZXBsYWNlKC8oU3RhcnR8RW5kKSQvLFwiXCIpO0EodSkmJms9PT11K1wiU3RhcnRcIiYmKE89bCxMPWwuc3Vic3RyKDAsbC5sZW5ndGgtNSkrXCJlbmRcIixsPWwuc3Vic3RyKDAsbC5sZW5ndGgtNikpO2s9eWEobC50b0xvd2VyQ2FzZSgpKTtcclxuaFtrXT1sO2lmKHB8fCFjLmhhc093blByb3BlcnR5KGspKWNba109cSxMYyhhLGspJiYoY1trXT0hMCk7UGEoYSxiLHEsayxwKTtjYShiLGssXCJBXCIsZCxnLE8sTCl9YT1hLmNsYXNzTmFtZTtpZihGKGEpJiZcIlwiIT09YSlmb3IoO2w9Zi5leGVjKGEpOylrPXlhKGxbMl0pLGNhKGIsayxcIkNcIixkLGcpJiYoY1trXT1VKGxbM10pKSxhPWEuc3Vic3RyKGwuaW5kZXgrbFswXS5sZW5ndGgpO2JyZWFrO2Nhc2UgcGI6TShiLGEubm9kZVZhbHVlKTticmVhaztjYXNlIDg6dHJ5e2lmKGw9ZS5leGVjKGEubm9kZVZhbHVlKSlrPXlhKGxbMV0pLGNhKGIsayxcIk1cIixkLGcpJiYoY1trXT1VKGxbMl0pKX1jYXRjaCh2KXt9fWIuc29ydChOKTtyZXR1cm4gYn1mdW5jdGlvbiB3YShhLGIsYyl7dmFyIGQ9W10sZT0wO2lmKGImJmEuaGFzQXR0cmlidXRlJiZhLmhhc0F0dHJpYnV0ZShiKSl7ZG97aWYoIWEpdGhyb3cgamEoXCJ1dGVyZGlyXCIsYixjKTthLm5vZGVUeXBlPT1vYSYmKGEuaGFzQXR0cmlidXRlKGIpJiZcclxuZSsrLGEuaGFzQXR0cmlidXRlKGMpJiZlLS0pO2QucHVzaChhKTthPWEubmV4dFNpYmxpbmd9d2hpbGUoMDxlKX1lbHNlIGQucHVzaChhKTtyZXR1cm4gQihkKX1mdW5jdGlvbiBKKGEsYixjKXtyZXR1cm4gZnVuY3Rpb24oZCxlLGYsZyxoKXtlPXdhKGVbMF0sYixjKTtyZXR1cm4gYShkLGUsZixnLGgpfX1mdW5jdGlvbiBlYShhLGQsZSxmLGcsbCxrLHAscil7ZnVuY3Rpb24gdyhhLGIsYyxkKXtpZihhKXtjJiYoYT1KKGEsYyxkKSk7YS5yZXF1aXJlPUsucmVxdWlyZTthLmRpcmVjdGl2ZU5hbWU9ejtpZihTPT09S3x8Sy4kJGlzb2xhdGVTY29wZSlhPVooYSx7aXNvbGF0ZVNjb3BlOiEwfSk7ay5wdXNoKGEpfWlmKGIpe2MmJihiPUooYixjLGQpKTtiLnJlcXVpcmU9Sy5yZXF1aXJlO2IuZGlyZWN0aXZlTmFtZT16O2lmKFM9PT1LfHxLLiQkaXNvbGF0ZVNjb3BlKWI9WihiLHtpc29sYXRlU2NvcGU6ITB9KTtwLnB1c2goYil9fWZ1bmN0aW9uIEwoYSxiLGMsZCl7dmFyIGUsZj1cImRhdGFcIixcclxuZz0hMSxsPWMsaztpZihGKGIpKXtrPWIubWF0Y2goaCk7Yj1iLnN1YnN0cmluZyhrWzBdLmxlbmd0aCk7a1szXSYmKGtbMV0/a1szXT1udWxsOmtbMV09a1szXSk7XCJeXCI9PT1rWzFdP2Y9XCJpbmhlcml0ZWREYXRhXCI6XCJeXlwiPT09a1sxXSYmKGY9XCJpbmhlcml0ZWREYXRhXCIsbD1jLnBhcmVudCgpKTtcIj9cIj09PWtbMl0mJihnPSEwKTtlPW51bGw7ZCYmXCJkYXRhXCI9PT1mJiYoZT1kW2JdKSYmKGU9ZS5pbnN0YW5jZSk7ZT1lfHxsW2ZdKFwiJFwiK2IrXCJDb250cm9sbGVyXCIpO2lmKCFlJiYhZyl0aHJvdyBqYShcImN0cmVxXCIsYixhKTtyZXR1cm4gZXx8bnVsbH1EKGIpJiYoZT1bXSxzKGIsZnVuY3Rpb24oYil7ZS5wdXNoKEwoYSxiLGMsZCkpfSkpO3JldHVybiBlfWZ1bmN0aW9uIHYoYSxjLGYsZyxoKXtmdW5jdGlvbiBsKGEsYixjKXt2YXIgZDtWYShhKXx8KGM9YixiPWEsYT10KTtIJiYoZD1QKTtjfHwoYz1IP1cucGFyZW50KCk6Vyk7cmV0dXJuIGgoYSxiLGQsYyx3YSl9dmFyIHIsdyx1LHgsXHJcblAsZWIsVyxKO2Q9PT1mPyhKPWUsVz1lLiQkZWxlbWVudCk6KFc9QihmKSxKPW5ldyBYYihXLGUpKTtTJiYoeD1jLiRuZXcoITApKTtoJiYoZWI9bCxlYi4kJGJvdW5kVHJhbnNjbHVkZT1oKTtDJiYoWD17fSxQPXt9LHMoQyxmdW5jdGlvbihhKXt2YXIgYj17JHNjb3BlOmE9PT1TfHxhLiQkaXNvbGF0ZVNjb3BlP3g6YywkZWxlbWVudDpXLCRhdHRyczpKLCR0cmFuc2NsdWRlOmVifTt1PWEuY29udHJvbGxlcjtcIkBcIj09dSYmKHU9SlthLm5hbWVdKTtiPW4odSxiLCEwLGEuY29udHJvbGxlckFzKTtQW2EubmFtZV09YjtIfHxXLmRhdGEoXCIkXCIrYS5uYW1lK1wiQ29udHJvbGxlclwiLGIuaW5zdGFuY2UpO1hbYS5uYW1lXT1ifSkpO2lmKFMpe0UuJCRhZGRTY29wZUluZm8oVyx4LCEwLCEoa2EmJihrYT09PVN8fGthPT09Uy4kJG9yaWdpbmFsRGlyZWN0aXZlKSkpO0UuJCRhZGRTY29wZUNsYXNzKFcsITApO2c9WCYmWFtTLm5hbWVdO3ZhciB4YT14O2cmJmcuaWRlbnRpZmllciYmITA9PT1TLmJpbmRUb0NvbnRyb2xsZXImJlxyXG4oeGE9Zy5pbnN0YW5jZSk7cyh4LiQkaXNvbGF0ZUJpbmRpbmdzPVMuJCRpc29sYXRlQmluZGluZ3MsZnVuY3Rpb24oYSxkKXt2YXIgZT1hLmF0dHJOYW1lLGY9YS5vcHRpb25hbCxnLGgsbCxrO3N3aXRjaChhLm1vZGUpe2Nhc2UgXCJAXCI6Si4kb2JzZXJ2ZShlLGZ1bmN0aW9uKGEpe3hhW2RdPWF9KTtKLiQkb2JzZXJ2ZXJzW2VdLiQkc2NvcGU9YztKW2VdJiYoeGFbZF09YihKW2VdKShjKSk7YnJlYWs7Y2FzZSBcIj1cIjppZihmJiYhSltlXSlicmVhaztoPU8oSltlXSk7az1oLmxpdGVyYWw/ZmE6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWJ8fGEhPT1hJiZiIT09Yn07bD1oLmFzc2lnbnx8ZnVuY3Rpb24oKXtnPXhhW2RdPWgoYyk7dGhyb3cgamEoXCJub25hc3NpZ25cIixKW2VdLFMubmFtZSk7fTtnPXhhW2RdPWgoYyk7Zj1mdW5jdGlvbihhKXtrKGEseGFbZF0pfHwoayhhLGcpP2woYyxhPXhhW2RdKTp4YVtkXT1hKTtyZXR1cm4gZz1hfTtmLiRzdGF0ZWZ1bD0hMDtmPWEuY29sbGVjdGlvbj9cclxuYy4kd2F0Y2hDb2xsZWN0aW9uKEpbZV0sZik6Yy4kd2F0Y2goTyhKW2VdLGYpLG51bGwsaC5saXRlcmFsKTt4LiRvbihcIiRkZXN0cm95XCIsZik7YnJlYWs7Y2FzZSBcIiZcIjpoPU8oSltlXSkseGFbZF09ZnVuY3Rpb24oYSl7cmV0dXJuIGgoYyxhKX19fSl9WCYmKHMoWCxmdW5jdGlvbihhKXthKCl9KSxYPW51bGwpO2c9MDtmb3Iocj1rLmxlbmd0aDtnPHI7ZysrKXc9a1tnXSwkKHcsdy5pc29sYXRlU2NvcGU/eDpjLFcsSix3LnJlcXVpcmUmJkwody5kaXJlY3RpdmVOYW1lLHcucmVxdWlyZSxXLFApLGViKTt2YXIgd2E9YztTJiYoUy50ZW1wbGF0ZXx8bnVsbD09PVMudGVtcGxhdGVVcmwpJiYod2E9eCk7YSYmYSh3YSxmLmNoaWxkTm9kZXMsdCxoKTtmb3IoZz1wLmxlbmd0aC0xOzA8PWc7Zy0tKXc9cFtnXSwkKHcsdy5pc29sYXRlU2NvcGU/eDpjLFcsSix3LnJlcXVpcmUmJkwody5kaXJlY3RpdmVOYW1lLHcucmVxdWlyZSxXLFApLGViKX1yPXJ8fHt9O2Zvcih2YXIgeD0tTnVtYmVyLk1BWF9WQUxVRSxcclxuUCxDPXIuY29udHJvbGxlckRpcmVjdGl2ZXMsWCxTPXIubmV3SXNvbGF0ZVNjb3BlRGlyZWN0aXZlLGthPXIudGVtcGxhdGVEaXJlY3RpdmUsZWE9ci5ub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlLGNhPSExLEE9ITEsSD1yLmhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlLGFhPWUuJCRlbGVtZW50PUIoZCksSyx6LE4sQWE9ZixRLE09MCxSPWEubGVuZ3RoO008UjtNKyspe0s9YVtNXTt2YXIgUGE9Sy4kJHN0YXJ0LGZiPUsuJCRlbmQ7UGEmJihhYT13YShkLFBhLGZiKSk7Tj10O2lmKHg+Sy5wcmlvcml0eSlicmVhaztpZihOPUsuc2NvcGUpSy50ZW1wbGF0ZVVybHx8KEkoTik/KE9hKFwibmV3L2lzb2xhdGVkIHNjb3BlXCIsU3x8UCxLLGFhKSxTPUspOk9hKFwibmV3L2lzb2xhdGVkIHNjb3BlXCIsUyxLLGFhKSksUD1QfHxLO3o9Sy5uYW1lOyFLLnRlbXBsYXRlVXJsJiZLLmNvbnRyb2xsZXImJihOPUsuY29udHJvbGxlcixDPUN8fHt9LE9hKFwiJ1wiK3orXCInIGNvbnRyb2xsZXJcIixDW3pdLFxyXG5LLGFhKSxDW3pdPUspO2lmKE49Sy50cmFuc2NsdWRlKWNhPSEwLEsuJCR0bGJ8fChPYShcInRyYW5zY2x1c2lvblwiLGVhLEssYWEpLGVhPUspLFwiZWxlbWVudFwiPT1OPyhIPSEwLHg9Sy5wcmlvcml0eSxOPWFhLGFhPWUuJCRlbGVtZW50PUIoWS5jcmVhdGVDb21tZW50KFwiIFwiK3orXCI6IFwiK2Vbel0rXCIgXCIpKSxkPWFhWzBdLFYoZyxaYS5jYWxsKE4sMCksZCksQWE9RShOLGYseCxsJiZsLm5hbWUse25vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmU6ZWF9KSk6KE49QihUYihkKSkuY29udGVudHMoKSxhYS5lbXB0eSgpLEFhPUUoTixmKSk7aWYoSy50ZW1wbGF0ZSlpZihBPSEwLE9hKFwidGVtcGxhdGVcIixrYSxLLGFhKSxrYT1LLE49RyhLLnRlbXBsYXRlKT9LLnRlbXBsYXRlKGFhLGUpOksudGVtcGxhdGUsTj1TYyhOKSxLLnJlcGxhY2Upe2w9SztOPVJiLnRlc3QoTik/VGMoV2IoSy50ZW1wbGF0ZU5hbWVzcGFjZSxVKE4pKSk6W107ZD1OWzBdO2lmKDEhPU4ubGVuZ3RofHxkLm5vZGVUeXBlIT09XHJcbm9hKXRocm93IGphKFwidHBscnRcIix6LFwiXCIpO1YoZyxhYSxkKTtSPXskYXR0cjp7fX07Tj1XKGQsW10sUik7dmFyIGJhPWEuc3BsaWNlKE0rMSxhLmxlbmd0aC0oTSsxKSk7UyYmeShOKTthPWEuY29uY2F0KE4pLmNvbmNhdChiYSk7UWMoZSxSKTtSPWEubGVuZ3RofWVsc2UgYWEuaHRtbChOKTtpZihLLnRlbXBsYXRlVXJsKUE9ITAsT2EoXCJ0ZW1wbGF0ZVwiLGthLEssYWEpLGthPUssSy5yZXBsYWNlJiYobD1LKSx2PVQoYS5zcGxpY2UoTSxhLmxlbmd0aC1NKSxhYSxlLGcsY2EmJkFhLGsscCx7Y29udHJvbGxlckRpcmVjdGl2ZXM6QyxuZXdJc29sYXRlU2NvcGVEaXJlY3RpdmU6Uyx0ZW1wbGF0ZURpcmVjdGl2ZTprYSxub25UbGJUcmFuc2NsdWRlRGlyZWN0aXZlOmVhfSksUj1hLmxlbmd0aDtlbHNlIGlmKEsuY29tcGlsZSl0cnl7UT1LLmNvbXBpbGUoYWEsZSxBYSksRyhRKT93KG51bGwsUSxQYSxmYik6USYmdyhRLnByZSxRLnBvc3QsUGEsZmIpfWNhdGNoKHFmKXtjKHFmLHZhKGFhKSl9Sy50ZXJtaW5hbCYmXHJcbih2LnRlcm1pbmFsPSEwLHg9TWF0aC5tYXgoeCxLLnByaW9yaXR5KSl9di5zY29wZT1QJiYhMD09PVAuc2NvcGU7di50cmFuc2NsdWRlT25UaGlzRWxlbWVudD1jYTt2LmVsZW1lbnRUcmFuc2NsdWRlT25UaGlzRWxlbWVudD1IO3YudGVtcGxhdGVPblRoaXNFbGVtZW50PUE7di50cmFuc2NsdWRlPUFhO3IuaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmU9SDtyZXR1cm4gdn1mdW5jdGlvbiB5KGEpe2Zvcih2YXIgYj0wLGM9YS5sZW5ndGg7YjxjO2IrKyl7dmFyIGQ9YixlO2U9eihPYmplY3QuY3JlYXRlKGFbYl0pLHskJGlzb2xhdGVTY29wZTohMH0pO2FbZF09ZX19ZnVuY3Rpb24gY2EoYixlLGYsZyxoLGwsayl7aWYoZT09PWgpcmV0dXJuIG51bGw7aD1udWxsO2lmKGQuaGFzT3duUHJvcGVydHkoZSkpe3ZhciBxO2U9YS5nZXQoZStcIkRpcmVjdGl2ZVwiKTtmb3IodmFyIHI9MCxuPWUubGVuZ3RoO3I8bjtyKyspdHJ5e2lmKHE9ZVtyXSwoZz09PXR8fGc+cS5wcmlvcml0eSkmJi0xIT1cclxucS5yZXN0cmljdC5pbmRleE9mKGYpKXtpZihsKXt2YXIgdz17JCRzdGFydDpsLCQkZW5kOmt9O3E9eihPYmplY3QuY3JlYXRlKHEpLHcpfWIucHVzaChxKTtoPXF9fWNhdGNoKE8pe2MoTyl9fXJldHVybiBofWZ1bmN0aW9uIEEoYil7aWYoZC5oYXNPd25Qcm9wZXJ0eShiKSlmb3IodmFyIGM9YS5nZXQoYitcIkRpcmVjdGl2ZVwiKSxlPTAsZj1jLmxlbmd0aDtlPGY7ZSsrKWlmKGI9Y1tlXSxiLm11bHRpRWxlbWVudClyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBRYyhhLGIpe3ZhciBjPWIuJGF0dHIsZD1hLiRhdHRyLGU9YS4kJGVsZW1lbnQ7cyhhLGZ1bmN0aW9uKGQsZSl7XCIkXCIhPWUuY2hhckF0KDApJiYoYltlXSYmYltlXSE9PWQmJihkKz0oXCJzdHlsZVwiPT09ZT9cIjtcIjpcIiBcIikrYltlXSksYS4kc2V0KGUsZCwhMCxjW2VdKSl9KTtzKGIsZnVuY3Rpb24oYixmKXtcImNsYXNzXCI9PWY/KFAoZSxiKSxhW1wiY2xhc3NcIl09KGFbXCJjbGFzc1wiXT9hW1wiY2xhc3NcIl0rXCIgXCI6XCJcIikrYik6XCJzdHlsZVwiPT1cclxuZj8oZS5hdHRyKFwic3R5bGVcIixlLmF0dHIoXCJzdHlsZVwiKStcIjtcIitiKSxhLnN0eWxlPShhLnN0eWxlP2Euc3R5bGUrXCI7XCI6XCJcIikrYik6XCIkXCI9PWYuY2hhckF0KDApfHxhLmhhc093blByb3BlcnR5KGYpfHwoYVtmXT1iLGRbZl09Y1tmXSl9KX1mdW5jdGlvbiBUKGEsYixjLGQsZSxmLGcsaCl7dmFyIGw9W10sayxxLHA9YlswXSxuPWEuc2hpZnQoKSx3PXooe30sbix7dGVtcGxhdGVVcmw6bnVsbCx0cmFuc2NsdWRlOm51bGwscmVwbGFjZTpudWxsLCQkb3JpZ2luYWxEaXJlY3RpdmU6bn0pLE89RyhuLnRlbXBsYXRlVXJsKT9uLnRlbXBsYXRlVXJsKGIsYyk6bi50ZW1wbGF0ZVVybCx1PW4udGVtcGxhdGVOYW1lc3BhY2U7Yi5lbXB0eSgpO3IoTC5nZXRUcnVzdGVkUmVzb3VyY2VVcmwoTykpLnRoZW4oZnVuY3Rpb24ocil7dmFyIEwsdjtyPVNjKHIpO2lmKG4ucmVwbGFjZSl7cj1SYi50ZXN0KHIpP1RjKFdiKHUsVShyKSkpOltdO0w9clswXTtpZigxIT1yLmxlbmd0aHx8TC5ub2RlVHlwZSE9PVxyXG5vYSl0aHJvdyBqYShcInRwbHJ0XCIsbi5uYW1lLE8pO3I9eyRhdHRyOnt9fTtWKGQsYixMKTt2YXIgeD1XKEwsW10scik7SShuLnNjb3BlKSYmeSh4KTthPXguY29uY2F0KGEpO1FjKGMscil9ZWxzZSBMPXAsYi5odG1sKHIpO2EudW5zaGlmdCh3KTtrPWVhKGEsTCxjLGUsYixuLGYsZyxoKTtzKGQsZnVuY3Rpb24oYSxjKXthPT1MJiYoZFtjXT1iWzBdKX0pO2ZvcihxPVMoYlswXS5jaGlsZE5vZGVzLGUpO2wubGVuZ3RoOyl7cj1sLnNoaWZ0KCk7dj1sLnNoaWZ0KCk7dmFyIEM9bC5zaGlmdCgpLEU9bC5zaGlmdCgpLHg9YlswXTtpZighci4kJGRlc3Ryb3llZCl7aWYodiE9PXApe3ZhciBKPXYuY2xhc3NOYW1lO2guaGFzRWxlbWVudFRyYW5zY2x1ZGVEaXJlY3RpdmUmJm4ucmVwbGFjZXx8KHg9VGIoTCkpO1YoQyxCKHYpLHgpO1AoQih4KSxKKX12PWsudHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQ/WChyLGsudHJhbnNjbHVkZSxFKTpFO2socSxyLHgsZCx2KX19bD1udWxsfSk7cmV0dXJuIGZ1bmN0aW9uKGEsXHJcbmIsYyxkLGUpe2E9ZTtiLiQkZGVzdHJveWVkfHwobD9sLnB1c2goYixjLGQsYSk6KGsudHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQmJihhPVgoYixrLnRyYW5zY2x1ZGUsZSkpLGsocSxiLGMsZCxhKSkpfX1mdW5jdGlvbiBOKGEsYil7dmFyIGM9Yi5wcmlvcml0eS1hLnByaW9yaXR5O3JldHVybiAwIT09Yz9jOmEubmFtZSE9PWIubmFtZT9hLm5hbWU8Yi5uYW1lPy0xOjE6YS5pbmRleC1iLmluZGV4fWZ1bmN0aW9uIE9hKGEsYixjLGQpe2lmKGIpdGhyb3cgamEoXCJtdWx0aWRpclwiLGIubmFtZSxjLm5hbWUsYSx2YShkKSk7fWZ1bmN0aW9uIE0oYSxjKXt2YXIgZD1iKGMsITApO2QmJmEucHVzaCh7cHJpb3JpdHk6MCxjb21waWxlOmZ1bmN0aW9uKGEpe2E9YS5wYXJlbnQoKTt2YXIgYj0hIWEubGVuZ3RoO2ImJkUuJCRhZGRCaW5kaW5nQ2xhc3MoYSk7cmV0dXJuIGZ1bmN0aW9uKGEsYyl7dmFyIGU9Yy5wYXJlbnQoKTtifHxFLiQkYWRkQmluZGluZ0NsYXNzKGUpO0UuJCRhZGRCaW5kaW5nSW5mbyhlLFxyXG5kLmV4cHJlc3Npb25zKTthLiR3YXRjaChkLGZ1bmN0aW9uKGEpe2NbMF0ubm9kZVZhbHVlPWF9KX19fSl9ZnVuY3Rpb24gV2IoYSxiKXthPVEoYXx8XCJodG1sXCIpO3N3aXRjaChhKXtjYXNlIFwic3ZnXCI6Y2FzZSBcIm1hdGhcIjp2YXIgYz1ZLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Yy5pbm5lckhUTUw9XCI8XCIrYStcIj5cIitiK1wiPC9cIithK1wiPlwiO3JldHVybiBjLmNoaWxkTm9kZXNbMF0uY2hpbGROb2RlcztkZWZhdWx0OnJldHVybiBifX1mdW5jdGlvbiBSKGEsYil7aWYoXCJzcmNkb2NcIj09YilyZXR1cm4gTC5IVE1MO3ZhciBjPXVhKGEpO2lmKFwieGxpbmtIcmVmXCI9PWJ8fFwiZm9ybVwiPT1jJiZcImFjdGlvblwiPT1ifHxcImltZ1wiIT1jJiYoXCJzcmNcIj09Ynx8XCJuZ1NyY1wiPT1iKSlyZXR1cm4gTC5SRVNPVVJDRV9VUkx9ZnVuY3Rpb24gUGEoYSxjLGQsZSxmKXt2YXIgaD1SKGEsZSk7Zj1nW2VdfHxmO3ZhciBrPWIoZCwhMCxoLGYpO2lmKGspe2lmKFwibXVsdGlwbGVcIj09PWUmJlwic2VsZWN0XCI9PT11YShhKSl0aHJvdyBqYShcInNlbG11bHRpXCIsXHJcbnZhKGEpKTtjLnB1c2goe3ByaW9yaXR5OjEwMCxjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3ByZTpmdW5jdGlvbihhLGMsZyl7Yz1nLiQkb2JzZXJ2ZXJzfHwoZy4kJG9ic2VydmVycz17fSk7aWYobC50ZXN0KGUpKXRocm93IGphKFwibm9kb21ldmVudHNcIik7dmFyIHA9Z1tlXTtwIT09ZCYmKGs9cCYmYihwLCEwLGgsZiksZD1wKTtrJiYoZ1tlXT1rKGEpLChjW2VdfHwoY1tlXT1bXSkpLiQkaW50ZXI9ITAsKGcuJCRvYnNlcnZlcnMmJmcuJCRvYnNlcnZlcnNbZV0uJCRzY29wZXx8YSkuJHdhdGNoKGssZnVuY3Rpb24oYSxiKXtcImNsYXNzXCI9PT1lJiZhIT1iP2cuJHVwZGF0ZUNsYXNzKGEsYik6Zy4kc2V0KGUsYSl9KSl9fX19KX19ZnVuY3Rpb24gVihhLGIsYyl7dmFyIGQ9YlswXSxlPWIubGVuZ3RoLGY9ZC5wYXJlbnROb2RlLGcsaDtpZihhKWZvcihnPTAsaD1hLmxlbmd0aDtnPGg7ZysrKWlmKGFbZ109PWQpe2FbZysrXT1jO2g9ZytlLTE7Zm9yKHZhciBsPWEubGVuZ3RoO2c8bDtnKyssXHJcbmgrKyloPGw/YVtnXT1hW2hdOmRlbGV0ZSBhW2ddO2EubGVuZ3RoLT1lLTE7YS5jb250ZXh0PT09ZCYmKGEuY29udGV4dD1jKTticmVha31mJiZmLnJlcGxhY2VDaGlsZChjLGQpO2E9WS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7YS5hcHBlbmRDaGlsZChkKTtCKGMpLmRhdGEoQihkKS5kYXRhKCkpO3NhPyhQYj0hMCxzYS5jbGVhbkRhdGEoW2RdKSk6ZGVsZXRlIEIuY2FjaGVbZFtCLmV4cGFuZG9dXTtkPTE7Zm9yKGU9Yi5sZW5ndGg7ZDxlO2QrKylmPWJbZF0sQihmKS5yZW1vdmUoKSxhLmFwcGVuZENoaWxkKGYpLGRlbGV0ZSBiW2RdO2JbMF09YztiLmxlbmd0aD0xfWZ1bmN0aW9uIFooYSxiKXtyZXR1cm4geihmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sYSxiKX1mdW5jdGlvbiAkKGEsYixkLGUsZixnKXt0cnl7YShiLGQsZSxmLGcpfWNhdGNoKGgpe2MoaCx2YShkKSl9fXZhciBYYj1mdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBjPU9iamVjdC5rZXlzKGIpLFxyXG5kLGUsZjtkPTA7Zm9yKGU9Yy5sZW5ndGg7ZDxlO2QrKylmPWNbZF0sdGhpc1tmXT1iW2ZdfWVsc2UgdGhpcy4kYXR0cj17fTt0aGlzLiQkZWxlbWVudD1hfTtYYi5wcm90b3R5cGU9eyRub3JtYWxpemU6eWEsJGFkZENsYXNzOmZ1bmN0aW9uKGEpe2EmJjA8YS5sZW5ndGgmJkMuYWRkQ2xhc3ModGhpcy4kJGVsZW1lbnQsYSl9LCRyZW1vdmVDbGFzczpmdW5jdGlvbihhKXthJiYwPGEubGVuZ3RoJiZDLnJlbW92ZUNsYXNzKHRoaXMuJCRlbGVtZW50LGEpfSwkdXBkYXRlQ2xhc3M6ZnVuY3Rpb24oYSxiKXt2YXIgYz1VYyhhLGIpO2MmJmMubGVuZ3RoJiZDLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LGMpOyhjPVVjKGIsYSkpJiZjLmxlbmd0aCYmQy5yZW1vdmVDbGFzcyh0aGlzLiQkZWxlbWVudCxjKX0sJHNldDpmdW5jdGlvbihhLGIsZCxlKXt2YXIgZj10aGlzLiQkZWxlbWVudFswXSxnPUxjKGYsYSksaD1rZihmLGEpLGY9YTtnPyh0aGlzLiQkZWxlbWVudC5wcm9wKGEsYiksZT1nKTpcclxuaCYmKHRoaXNbaF09YixmPWgpO3RoaXNbYV09YjtlP3RoaXMuJGF0dHJbYV09ZTooZT10aGlzLiRhdHRyW2FdKXx8KHRoaXMuJGF0dHJbYV09ZT10YyhhLFwiLVwiKSk7Zz11YSh0aGlzLiQkZWxlbWVudCk7aWYoXCJhXCI9PT1nJiZcImhyZWZcIj09PWF8fFwiaW1nXCI9PT1nJiZcInNyY1wiPT09YSl0aGlzW2FdPWI9eChiLFwic3JjXCI9PT1hKTtlbHNlIGlmKFwiaW1nXCI9PT1nJiZcInNyY3NldFwiPT09YSl7Zm9yKHZhciBnPVwiXCIsaD1VKGIpLGw9LyhcXHMrXFxkK3hcXHMqLHxcXHMrXFxkK3dcXHMqLHxcXHMrLHwsXFxzKykvLGw9L1xccy8udGVzdChoKT9sOi8oLCkvLGg9aC5zcGxpdChsKSxsPU1hdGguZmxvb3IoaC5sZW5ndGgvMiksaz0wO2s8bDtrKyspdmFyIHE9MiprLGc9Zyt4KFUoaFtxXSksITApLGc9ZysoXCIgXCIrVShoW3ErMV0pKTtoPVUoaFsyKmtdKS5zcGxpdCgvXFxzLyk7Zys9eChVKGhbMF0pLCEwKTsyPT09aC5sZW5ndGgmJihnKz1cIiBcIitVKGhbMV0pKTt0aGlzW2FdPWI9Z30hMSE9PWQmJihudWxsPT09Ynx8XHJcbmI9PT10P3RoaXMuJCRlbGVtZW50LnJlbW92ZUF0dHIoZSk6dGhpcy4kJGVsZW1lbnQuYXR0cihlLGIpKTsoYT10aGlzLiQkb2JzZXJ2ZXJzKSYmcyhhW2ZdLGZ1bmN0aW9uKGEpe3RyeXthKGIpfWNhdGNoKGQpe2MoZCl9fSl9LCRvYnNlcnZlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuJCRvYnNlcnZlcnN8fChjLiQkb2JzZXJ2ZXJzPWhhKCkpLGU9ZFthXXx8KGRbYV09W10pO2UucHVzaChiKTt2LiRldmFsQXN5bmMoZnVuY3Rpb24oKXshZS4kJGludGVyJiZjLmhhc093blByb3BlcnR5KGEpJiZiKGNbYV0pfSk7cmV0dXJuIGZ1bmN0aW9uKCl7WGEoZSxiKX19fTt2YXIgQWE9Yi5zdGFydFN5bWJvbCgpLGthPWIuZW5kU3ltYm9sKCksU2M9XCJ7e1wiPT1BYXx8XCJ9fVwiPT1rYT9wYTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC9cXHtcXHsvZyxBYSkucmVwbGFjZSgvfX0vZyxrYSl9LGZiPS9ebmdBdHRyW0EtWl0vO0UuJCRhZGRCaW5kaW5nSW5mbz1rP2Z1bmN0aW9uKGEsYil7dmFyIGM9XHJcbmEuZGF0YShcIiRiaW5kaW5nXCIpfHxbXTtEKGIpP2M9Yy5jb25jYXQoYik6Yy5wdXNoKGIpO2EuZGF0YShcIiRiaW5kaW5nXCIsYyl9Okg7RS4kJGFkZEJpbmRpbmdDbGFzcz1rP2Z1bmN0aW9uKGEpe1AoYSxcIm5nLWJpbmRpbmdcIil9Okg7RS4kJGFkZFNjb3BlSW5mbz1rP2Z1bmN0aW9uKGEsYixjLGQpe2EuZGF0YShjP2Q/XCIkaXNvbGF0ZVNjb3BlTm9UZW1wbGF0ZVwiOlwiJGlzb2xhdGVTY29wZVwiOlwiJHNjb3BlXCIsYil9Okg7RS4kJGFkZFNjb3BlQ2xhc3M9az9mdW5jdGlvbihhLGIpe1AoYSxiP1wibmctaXNvbGF0ZS1zY29wZVwiOlwibmctc2NvcGVcIil9Okg7cmV0dXJuIEV9XX1mdW5jdGlvbiB5YShiKXtyZXR1cm4gY2IoYi5yZXBsYWNlKFJjLFwiXCIpKX1mdW5jdGlvbiBVYyhiLGEpe3ZhciBjPVwiXCIsZD1iLnNwbGl0KC9cXHMrLyksZT1hLnNwbGl0KC9cXHMrLyksZj0wO2E6Zm9yKDtmPGQubGVuZ3RoO2YrKyl7Zm9yKHZhciBnPWRbZl0saD0wO2g8ZS5sZW5ndGg7aCsrKWlmKGc9PWVbaF0pY29udGludWUgYTtcclxuYys9KDA8Yy5sZW5ndGg/XCIgXCI6XCJcIikrZ31yZXR1cm4gY31mdW5jdGlvbiBUYyhiKXtiPUIoYik7dmFyIGE9Yi5sZW5ndGg7aWYoMT49YSlyZXR1cm4gYjtmb3IoO2EtLTspOD09PWJbYV0ubm9kZVR5cGUmJnJmLmNhbGwoYixhLDEpO3JldHVybiBifWZ1bmN0aW9uIEZlKCl7dmFyIGI9e30sYT0hMSxjPS9eKFxcUyspKFxccythc1xccysoXFx3KykpPyQvO3RoaXMucmVnaXN0ZXI9ZnVuY3Rpb24oYSxjKXtNYShhLFwiY29udHJvbGxlclwiKTtJKGEpP3ooYixhKTpiW2FdPWN9O3RoaXMuYWxsb3dHbG9iYWxzPWZ1bmN0aW9uKCl7YT0hMH07dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLFwiJHdpbmRvd1wiLGZ1bmN0aW9uKGQsZSl7ZnVuY3Rpb24gZihhLGIsYyxkKXtpZighYXx8IUkoYS4kc2NvcGUpKXRocm93IFQoXCIkY29udHJvbGxlclwiKShcIm5vc2NwXCIsZCxiKTthLiRzY29wZVtiXT1jfXJldHVybiBmdW5jdGlvbihnLGgsbCxrKXt2YXIgbSxwLHE7bD0hMD09PWw7ayYmRihrKSYmKHE9ayk7RihnKSYmXHJcbihrPWcubWF0Y2goYykscD1rWzFdLHE9cXx8a1szXSxnPWIuaGFzT3duUHJvcGVydHkocCk/YltwXTp2YyhoLiRzY29wZSxwLCEwKXx8KGE/dmMoZSxwLCEwKTp0KSxzYihnLHAsITApKTtpZihsKXJldHVybiBsPShEKGcpP2dbZy5sZW5ndGgtMV06ZykucHJvdG90eXBlLG09T2JqZWN0LmNyZWF0ZShsKSxxJiZmKGgscSxtLHB8fGcubmFtZSkseihmdW5jdGlvbigpe2QuaW52b2tlKGcsbSxoLHApO3JldHVybiBtfSx7aW5zdGFuY2U6bSxpZGVudGlmaWVyOnF9KTttPWQuaW5zdGFudGlhdGUoZyxoLHApO3EmJmYoaCxxLG0scHx8Zy5uYW1lKTtyZXR1cm4gbX19XX1mdW5jdGlvbiBHZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsZnVuY3Rpb24oYil7cmV0dXJuIEIoYi5kb2N1bWVudCl9XX1mdW5jdGlvbiBIZSgpe3RoaXMuJGdldD1bXCIkbG9nXCIsZnVuY3Rpb24oYil7cmV0dXJuIGZ1bmN0aW9uKGEsYyl7Yi5lcnJvci5hcHBseShiLGFyZ3VtZW50cyl9fV19ZnVuY3Rpb24gWWIoYixhKXtpZihGKGIpKXt2YXIgYz1cclxuYi5yZXBsYWNlKHNmLFwiXCIpLnRyaW0oKTtpZihjKXt2YXIgZD1hKFwiQ29udGVudC1UeXBlXCIpOyhkPWQmJjA9PT1kLmluZGV4T2YoVmMpKXx8KGQ9KGQ9Yy5tYXRjaCh0ZikpJiZ1ZltkWzBdXS50ZXN0KGMpKTtkJiYoYj1vYyhjKSl9fXJldHVybiBifWZ1bmN0aW9uIFdjKGIpe3ZhciBhPWhhKCksYyxkLGU7aWYoIWIpcmV0dXJuIGE7cyhiLnNwbGl0KFwiXFxuXCIpLGZ1bmN0aW9uKGIpe2U9Yi5pbmRleE9mKFwiOlwiKTtjPVEoVShiLnN1YnN0cigwLGUpKSk7ZD1VKGIuc3Vic3RyKGUrMSkpO2MmJihhW2NdPWFbY10/YVtjXStcIiwgXCIrZDpkKX0pO3JldHVybiBhfWZ1bmN0aW9uIFhjKGIpe3ZhciBhPUkoYik/Yjp0O3JldHVybiBmdW5jdGlvbihjKXthfHwoYT1XYyhiKSk7cmV0dXJuIGM/KGM9YVtRKGMpXSx2b2lkIDA9PT1jJiYoYz1udWxsKSxjKTphfX1mdW5jdGlvbiBZYyhiLGEsYyxkKXtpZihHKGQpKXJldHVybiBkKGIsYSxjKTtzKGQsZnVuY3Rpb24oZCl7Yj1kKGIsYSxjKX0pO3JldHVybiBifVxyXG5mdW5jdGlvbiBLZSgpe3ZhciBiPXRoaXMuZGVmYXVsdHM9e3RyYW5zZm9ybVJlc3BvbnNlOltZYl0sdHJhbnNmb3JtUmVxdWVzdDpbZnVuY3Rpb24oYSl7cmV0dXJuIEkoYSkmJlwiW29iamVjdCBGaWxlXVwiIT09RGEuY2FsbChhKSYmXCJbb2JqZWN0IEJsb2JdXCIhPT1EYS5jYWxsKGEpJiZcIltvYmplY3QgRm9ybURhdGFdXCIhPT1EYS5jYWxsKGEpPyRhKGEpOmF9XSxoZWFkZXJzOntjb21tb246e0FjY2VwdDpcImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKlwifSxwb3N0OnJhKFpiKSxwdXQ6cmEoWmIpLHBhdGNoOnJhKFpiKX0seHNyZkNvb2tpZU5hbWU6XCJYU1JGLVRPS0VOXCIseHNyZkhlYWRlck5hbWU6XCJYLVhTUkYtVE9LRU5cIn0sYT0hMTt0aGlzLnVzZUFwcGx5QXN5bmM9ZnVuY3Rpb24oYil7cmV0dXJuIHkoYik/KGE9ISFiLHRoaXMpOmF9O3ZhciBjPXRoaXMuaW50ZXJjZXB0b3JzPVtdO3RoaXMuJGdldD1bXCIkaHR0cEJhY2tlbmRcIixcIiRicm93c2VyXCIsXCIkY2FjaGVGYWN0b3J5XCIsXHJcblwiJHJvb3RTY29wZVwiLFwiJHFcIixcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGQsZSxmLGcsaCxsKXtmdW5jdGlvbiBrKGEpe2Z1bmN0aW9uIGMoYSl7dmFyIGI9eih7fSxhKTtiLmRhdGE9YS5kYXRhP1ljKGEuZGF0YSxhLmhlYWRlcnMsYS5zdGF0dXMsZS50cmFuc2Zvcm1SZXNwb25zZSk6YS5kYXRhO2E9YS5zdGF0dXM7cmV0dXJuIDIwMDw9YSYmMzAwPmE/YjpoLnJlamVjdChiKX1mdW5jdGlvbiBkKGEpe3ZhciBiLGM9e307cyhhLGZ1bmN0aW9uKGEsZCl7RyhhKT8oYj1hKCksbnVsbCE9YiYmKGNbZF09YikpOmNbZF09YX0pO3JldHVybiBjfWlmKCFnYS5pc09iamVjdChhKSl0aHJvdyBUKFwiJGh0dHBcIikoXCJiYWRyZXFcIixhKTt2YXIgZT16KHttZXRob2Q6XCJnZXRcIix0cmFuc2Zvcm1SZXF1ZXN0OmIudHJhbnNmb3JtUmVxdWVzdCx0cmFuc2Zvcm1SZXNwb25zZTpiLnRyYW5zZm9ybVJlc3BvbnNlfSxhKTtlLmhlYWRlcnM9ZnVuY3Rpb24oYSl7dmFyIGM9Yi5oZWFkZXJzLGU9eih7fSxhLmhlYWRlcnMpLFxyXG5mLGcsYz16KHt9LGMuY29tbW9uLGNbUShhLm1ldGhvZCldKTthOmZvcihmIGluIGMpe2E9UShmKTtmb3IoZyBpbiBlKWlmKFEoZyk9PT1hKWNvbnRpbnVlIGE7ZVtmXT1jW2ZdfXJldHVybiBkKGUpfShhKTtlLm1ldGhvZD11YihlLm1ldGhvZCk7dmFyIGY9W2Z1bmN0aW9uKGEpe3ZhciBkPWEuaGVhZGVycyxlPVljKGEuZGF0YSxYYyhkKSx0LGEudHJhbnNmb3JtUmVxdWVzdCk7QShlKSYmcyhkLGZ1bmN0aW9uKGEsYil7XCJjb250ZW50LXR5cGVcIj09PVEoYikmJmRlbGV0ZSBkW2JdfSk7QShhLndpdGhDcmVkZW50aWFscykmJiFBKGIud2l0aENyZWRlbnRpYWxzKSYmKGEud2l0aENyZWRlbnRpYWxzPWIud2l0aENyZWRlbnRpYWxzKTtyZXR1cm4gbShhLGUpLnRoZW4oYyxjKX0sdF0sZz1oLndoZW4oZSk7Zm9yKHModSxmdW5jdGlvbihhKXsoYS5yZXF1ZXN0fHxhLnJlcXVlc3RFcnJvcikmJmYudW5zaGlmdChhLnJlcXVlc3QsYS5yZXF1ZXN0RXJyb3IpOyhhLnJlc3BvbnNlfHxhLnJlc3BvbnNlRXJyb3IpJiZcclxuZi5wdXNoKGEucmVzcG9uc2UsYS5yZXNwb25zZUVycm9yKX0pO2YubGVuZ3RoOyl7YT1mLnNoaWZ0KCk7dmFyIGw9Zi5zaGlmdCgpLGc9Zy50aGVuKGEsbCl9Zy5zdWNjZXNzPWZ1bmN0aW9uKGEpe2cudGhlbihmdW5jdGlvbihiKXthKGIuZGF0YSxiLnN0YXR1cyxiLmhlYWRlcnMsZSl9KTtyZXR1cm4gZ307Zy5lcnJvcj1mdW5jdGlvbihhKXtnLnRoZW4obnVsbCxmdW5jdGlvbihiKXthKGIuZGF0YSxiLnN0YXR1cyxiLmhlYWRlcnMsZSl9KTtyZXR1cm4gZ307cmV0dXJuIGd9ZnVuY3Rpb24gbShjLGYpe2Z1bmN0aW9uIGwoYixjLGQsZSl7ZnVuY3Rpb24gZigpe20oYyxiLGQsZSl9UCYmKDIwMDw9YiYmMzAwPmI/UC5wdXQoWCxbYixjLFdjKGQpLGVdKTpQLnJlbW92ZShYKSk7YT9nLiRhcHBseUFzeW5jKGYpOihmKCksZy4kJHBoYXNlfHxnLiRhcHBseSgpKX1mdW5jdGlvbiBtKGEsYixkLGUpe2I9TWF0aC5tYXgoYiwwKTsoMjAwPD1iJiYzMDA+Yj9DLnJlc29sdmU6Qy5yZWplY3QpKHtkYXRhOmEsXHJcbnN0YXR1czpiLGhlYWRlcnM6WGMoZCksY29uZmlnOmMsc3RhdHVzVGV4dDplfSl9ZnVuY3Rpb24gdyhhKXttKGEuZGF0YSxhLnN0YXR1cyxyYShhLmhlYWRlcnMoKSksYS5zdGF0dXNUZXh0KX1mdW5jdGlvbiB1KCl7dmFyIGE9ay5wZW5kaW5nUmVxdWVzdHMuaW5kZXhPZihjKTstMSE9PWEmJmsucGVuZGluZ1JlcXVlc3RzLnNwbGljZShhLDEpfXZhciBDPWguZGVmZXIoKSx4PUMucHJvbWlzZSxQLEUscz1jLmhlYWRlcnMsWD1wKGMudXJsLGMucGFyYW1zKTtrLnBlbmRpbmdSZXF1ZXN0cy5wdXNoKGMpO3gudGhlbih1LHUpOyFjLmNhY2hlJiYhYi5jYWNoZXx8ITE9PT1jLmNhY2hlfHxcIkdFVFwiIT09Yy5tZXRob2QmJlwiSlNPTlBcIiE9PWMubWV0aG9kfHwoUD1JKGMuY2FjaGUpP2MuY2FjaGU6SShiLmNhY2hlKT9iLmNhY2hlOnEpO1AmJihFPVAuZ2V0KFgpLHkoRSk/RSYmRyhFLnRoZW4pP0UudGhlbih3LHcpOkQoRSk/bShFWzFdLEVbMF0scmEoRVsyXSksRVszXSk6bShFLDIwMCx7fSxcclxuXCJPS1wiKTpQLnB1dChYLHgpKTtBKEUpJiYoKEU9WmMoYy51cmwpP2UuY29va2llcygpW2MueHNyZkNvb2tpZU5hbWV8fGIueHNyZkNvb2tpZU5hbWVdOnQpJiYoc1tjLnhzcmZIZWFkZXJOYW1lfHxiLnhzcmZIZWFkZXJOYW1lXT1FKSxkKGMubWV0aG9kLFgsZixsLHMsYy50aW1lb3V0LGMud2l0aENyZWRlbnRpYWxzLGMucmVzcG9uc2VUeXBlKSk7cmV0dXJuIHh9ZnVuY3Rpb24gcChhLGIpe2lmKCFiKXJldHVybiBhO3ZhciBjPVtdO0VkKGIsZnVuY3Rpb24oYSxiKXtudWxsPT09YXx8QShhKXx8KEQoYSl8fChhPVthXSkscyhhLGZ1bmN0aW9uKGEpe0koYSkmJihhPXFhKGEpP2EudG9JU09TdHJpbmcoKTokYShhKSk7Yy5wdXNoKEZhKGIpK1wiPVwiK0ZhKGEpKX0pKX0pOzA8Yy5sZW5ndGgmJihhKz0oLTE9PWEuaW5kZXhPZihcIj9cIik/XCI/XCI6XCImXCIpK2Muam9pbihcIiZcIikpO3JldHVybiBhfXZhciBxPWYoXCIkaHR0cFwiKSx1PVtdO3MoYyxmdW5jdGlvbihhKXt1LnVuc2hpZnQoRihhKT9sLmdldChhKTpcclxubC5pbnZva2UoYSkpfSk7ay5wZW5kaW5nUmVxdWVzdHM9W107KGZ1bmN0aW9uKGEpe3MoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2tbYV09ZnVuY3Rpb24oYixjKXtyZXR1cm4gayh6KGN8fHt9LHttZXRob2Q6YSx1cmw6Yn0pKX19KX0pKFwiZ2V0XCIsXCJkZWxldGVcIixcImhlYWRcIixcImpzb25wXCIpOyhmdW5jdGlvbihhKXtzKGFyZ3VtZW50cyxmdW5jdGlvbihhKXtrW2FdPWZ1bmN0aW9uKGIsYyxkKXtyZXR1cm4gayh6KGR8fHt9LHttZXRob2Q6YSx1cmw6YixkYXRhOmN9KSl9fSl9KShcInBvc3RcIixcInB1dFwiLFwicGF0Y2hcIik7ay5kZWZhdWx0cz1iO3JldHVybiBrfV19ZnVuY3Rpb24gdmYoKXtyZXR1cm4gbmV3IE0uWE1MSHR0cFJlcXVlc3R9ZnVuY3Rpb24gTGUoKXt0aGlzLiRnZXQ9W1wiJGJyb3dzZXJcIixcIiR3aW5kb3dcIixcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKGIsYSxjKXtyZXR1cm4gd2YoYix2ZixiLmRlZmVyLGEuYW5ndWxhci5jYWxsYmFja3MsY1swXSl9XX1mdW5jdGlvbiB3ZihiLGEsYyxcclxuZCxlKXtmdW5jdGlvbiBmKGEsYixjKXt2YXIgZj1lLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIiksbT1udWxsO2YudHlwZT1cInRleHQvamF2YXNjcmlwdFwiO2Yuc3JjPWE7Zi5hc3luYz0hMDttPWZ1bmN0aW9uKGEpe2YucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIixtLCExKTtmLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLG0sITEpO2UuYm9keS5yZW1vdmVDaGlsZChmKTtmPW51bGw7dmFyIGc9LTEsdT1cInVua25vd25cIjthJiYoXCJsb2FkXCIhPT1hLnR5cGV8fGRbYl0uY2FsbGVkfHwoYT17dHlwZTpcImVycm9yXCJ9KSx1PWEudHlwZSxnPVwiZXJyb3JcIj09PWEudHlwZT80MDQ6MjAwKTtjJiZjKGcsdSl9O2YuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixtLCExKTtmLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLG0sITEpO2UuYm9keS5hcHBlbmRDaGlsZChmKTtyZXR1cm4gbX1yZXR1cm4gZnVuY3Rpb24oZSxoLGwsayxtLHAscSx1KXtmdW5jdGlvbiByKCl7diYmdigpO3cmJncuYWJvcnQoKX1cclxuZnVuY3Rpb24gTyhhLGQsZSxmLGcpe0MhPT10JiZjLmNhbmNlbChDKTt2PXc9bnVsbDthKGQsZSxmLGcpO2IuJCRjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdChIKX1iLiQkaW5jT3V0c3RhbmRpbmdSZXF1ZXN0Q291bnQoKTtoPWh8fGIudXJsKCk7aWYoXCJqc29ucFwiPT1RKGUpKXt2YXIgbj1cIl9cIisoZC5jb3VudGVyKyspLnRvU3RyaW5nKDM2KTtkW25dPWZ1bmN0aW9uKGEpe2Rbbl0uZGF0YT1hO2Rbbl0uY2FsbGVkPSEwfTt2YXIgdj1mKGgucmVwbGFjZShcIkpTT05fQ0FMTEJBQ0tcIixcImFuZ3VsYXIuY2FsbGJhY2tzLlwiK24pLG4sZnVuY3Rpb24oYSxiKXtPKGssYSxkW25dLmRhdGEsXCJcIixiKTtkW25dPUh9KX1lbHNle3ZhciB3PWEoKTt3Lm9wZW4oZSxoLCEwKTtzKG0sZnVuY3Rpb24oYSxiKXt5KGEpJiZ3LnNldFJlcXVlc3RIZWFkZXIoYixhKX0pO3cub25sb2FkPWZ1bmN0aW9uKCl7dmFyIGE9dy5zdGF0dXNUZXh0fHxcIlwiLGI9XCJyZXNwb25zZVwiaW4gdz93LnJlc3BvbnNlOncucmVzcG9uc2VUZXh0LFxyXG5jPTEyMjM9PT13LnN0YXR1cz8yMDQ6dy5zdGF0dXM7MD09PWMmJihjPWI/MjAwOlwiZmlsZVwiPT1CYShoKS5wcm90b2NvbD80MDQ6MCk7TyhrLGMsYix3LmdldEFsbFJlc3BvbnNlSGVhZGVycygpLGEpfTtlPWZ1bmN0aW9uKCl7TyhrLC0xLG51bGwsbnVsbCxcIlwiKX07dy5vbmVycm9yPWU7dy5vbmFib3J0PWU7cSYmKHcud2l0aENyZWRlbnRpYWxzPSEwKTtpZih1KXRyeXt3LnJlc3BvbnNlVHlwZT11fWNhdGNoKEwpe2lmKFwianNvblwiIT09dSl0aHJvdyBMO313LnNlbmQobHx8bnVsbCl9aWYoMDxwKXZhciBDPWMocixwKTtlbHNlIHAmJkcocC50aGVuKSYmcC50aGVuKHIpfX1mdW5jdGlvbiBJZSgpe3ZhciBiPVwie3tcIixhPVwifX1cIjt0aGlzLnN0YXJ0U3ltYm9sPWZ1bmN0aW9uKGEpe3JldHVybiBhPyhiPWEsdGhpcyk6Yn07dGhpcy5lbmRTeW1ib2w9ZnVuY3Rpb24oYil7cmV0dXJuIGI/KGE9Yix0aGlzKTphfTt0aGlzLiRnZXQ9W1wiJHBhcnNlXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJHNjZVwiLFxyXG5mdW5jdGlvbihjLGQsZSl7ZnVuY3Rpb24gZihhKXtyZXR1cm5cIlxcXFxcXFxcXFxcXFwiK2F9ZnVuY3Rpb24gZyhmLGcsdSxyKXtmdW5jdGlvbiBPKGMpe3JldHVybiBjLnJlcGxhY2UoayxiKS5yZXBsYWNlKG0sYSl9ZnVuY3Rpb24gbihhKXt0cnl7dmFyIGI9YTthPXU/ZS5nZXRUcnVzdGVkKHUsYik6ZS52YWx1ZU9mKGIpO3ZhciBjO2lmKHImJiF5KGEpKWM9YTtlbHNlIGlmKG51bGw9PWEpYz1cIlwiO2Vsc2V7c3dpdGNoKHR5cGVvZiBhKXtjYXNlIFwic3RyaW5nXCI6YnJlYWs7Y2FzZSBcIm51bWJlclwiOmE9XCJcIithO2JyZWFrO2RlZmF1bHQ6YT0kYShhKX1jPWF9cmV0dXJuIGN9Y2F0Y2goZyl7Yz0kYihcImludGVyclwiLGYsZy50b1N0cmluZygpKSxkKGMpfX1yPSEhcjtmb3IodmFyIHYsdyxMPTAsQz1bXSx4PVtdLFA9Zi5sZW5ndGgsRT1bXSxzPVtdO0w8UDspaWYoLTEhPSh2PWYuaW5kZXhPZihiLEwpKSYmLTEhPSh3PWYuaW5kZXhPZihhLHYraCkpKUwhPT12JiZFLnB1c2goTyhmLnN1YnN0cmluZyhMLFxyXG52KSkpLEw9Zi5zdWJzdHJpbmcoditoLHcpLEMucHVzaChMKSx4LnB1c2goYyhMLG4pKSxMPXcrbCxzLnB1c2goRS5sZW5ndGgpLEUucHVzaChcIlwiKTtlbHNle0whPT1QJiZFLnB1c2goTyhmLnN1YnN0cmluZyhMKSkpO2JyZWFrfWlmKHUmJjE8RS5sZW5ndGgpdGhyb3cgJGIoXCJub2NvbmNhdFwiLGYpO2lmKCFnfHxDLmxlbmd0aCl7dmFyIFg9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz1DLmxlbmd0aDtiPGM7YisrKXtpZihyJiZBKGFbYl0pKXJldHVybjtFW3NbYl1dPWFbYl19cmV0dXJuIEUuam9pbihcIlwiKX07cmV0dXJuIHooZnVuY3Rpb24oYSl7dmFyIGI9MCxjPUMubGVuZ3RoLGU9QXJyYXkoYyk7dHJ5e2Zvcig7YjxjO2IrKyllW2JdPXhbYl0oYSk7cmV0dXJuIFgoZSl9Y2F0Y2goZyl7YT0kYihcImludGVyclwiLGYsZy50b1N0cmluZygpKSxkKGEpfX0se2V4cDpmLGV4cHJlc3Npb25zOkMsJCR3YXRjaERlbGVnYXRlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZDtyZXR1cm4gYS4kd2F0Y2hHcm91cCh4LFxyXG5mdW5jdGlvbihjLGUpe3ZhciBmPVgoYyk7RyhiKSYmYi5jYWxsKHRoaXMsZixjIT09ZT9kOmYsYSk7ZD1mfSxjKX19KX19dmFyIGg9Yi5sZW5ndGgsbD1hLmxlbmd0aCxrPW5ldyBSZWdFeHAoYi5yZXBsYWNlKC8uL2csZiksXCJnXCIpLG09bmV3IFJlZ0V4cChhLnJlcGxhY2UoLy4vZyxmKSxcImdcIik7Zy5zdGFydFN5bWJvbD1mdW5jdGlvbigpe3JldHVybiBifTtnLmVuZFN5bWJvbD1mdW5jdGlvbigpe3JldHVybiBhfTtyZXR1cm4gZ31dfWZ1bmN0aW9uIEplKCl7dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiR3aW5kb3dcIixcIiRxXCIsXCIkJHFcIixmdW5jdGlvbihiLGEsYyxkKXtmdW5jdGlvbiBlKGUsaCxsLGspe3ZhciBtPWEuc2V0SW50ZXJ2YWwscD1hLmNsZWFySW50ZXJ2YWwscT0wLHU9eShrKSYmIWsscj0odT9kOmMpLmRlZmVyKCksTz1yLnByb21pc2U7bD15KGwpP2w6MDtPLnRoZW4obnVsbCxudWxsLGUpO08uJCRpbnRlcnZhbElkPW0oZnVuY3Rpb24oKXtyLm5vdGlmeShxKyspOzA8XHJcbmwmJnE+PWwmJihyLnJlc29sdmUocSkscChPLiQkaW50ZXJ2YWxJZCksZGVsZXRlIGZbTy4kJGludGVydmFsSWRdKTt1fHxiLiRhcHBseSgpfSxoKTtmW08uJCRpbnRlcnZhbElkXT1yO3JldHVybiBPfXZhciBmPXt9O2UuY2FuY2VsPWZ1bmN0aW9uKGIpe3JldHVybiBiJiZiLiQkaW50ZXJ2YWxJZCBpbiBmPyhmW2IuJCRpbnRlcnZhbElkXS5yZWplY3QoXCJjYW5jZWxlZFwiKSxhLmNsZWFySW50ZXJ2YWwoYi4kJGludGVydmFsSWQpLGRlbGV0ZSBmW2IuJCRpbnRlcnZhbElkXSwhMCk6ITF9O3JldHVybiBlfV19ZnVuY3Rpb24gUmQoKXt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm57aWQ6XCJlbi11c1wiLE5VTUJFUl9GT1JNQVRTOntERUNJTUFMX1NFUDpcIi5cIixHUk9VUF9TRVA6XCIsXCIsUEFUVEVSTlM6W3ttaW5JbnQ6MSxtaW5GcmFjOjAsbWF4RnJhYzozLHBvc1ByZTpcIlwiLHBvc1N1ZjpcIlwiLG5lZ1ByZTpcIi1cIixuZWdTdWY6XCJcIixnU2l6ZTozLGxnU2l6ZTozfSx7bWluSW50OjEsbWluRnJhYzoyLFxyXG5tYXhGcmFjOjIscG9zUHJlOlwiXFx1MDBhNFwiLHBvc1N1ZjpcIlwiLG5lZ1ByZTpcIihcXHUwMGE0XCIsbmVnU3VmOlwiKVwiLGdTaXplOjMsbGdTaXplOjN9XSxDVVJSRU5DWV9TWU06XCIkXCJ9LERBVEVUSU1FX0ZPUk1BVFM6e01PTlRIOlwiSmFudWFyeSBGZWJydWFyeSBNYXJjaCBBcHJpbCBNYXkgSnVuZSBKdWx5IEF1Z3VzdCBTZXB0ZW1iZXIgT2N0b2JlciBOb3ZlbWJlciBEZWNlbWJlclwiLnNwbGl0KFwiIFwiKSxTSE9SVE1PTlRIOlwiSmFuIEZlYiBNYXIgQXByIE1heSBKdW4gSnVsIEF1ZyBTZXAgT2N0IE5vdiBEZWNcIi5zcGxpdChcIiBcIiksREFZOlwiU3VuZGF5IE1vbmRheSBUdWVzZGF5IFdlZG5lc2RheSBUaHVyc2RheSBGcmlkYXkgU2F0dXJkYXlcIi5zcGxpdChcIiBcIiksU0hPUlREQVk6XCJTdW4gTW9uIFR1ZSBXZWQgVGh1IEZyaSBTYXRcIi5zcGxpdChcIiBcIiksQU1QTVM6W1wiQU1cIixcIlBNXCJdLG1lZGl1bTpcIk1NTSBkLCB5IGg6bW06c3MgYVwiLFwic2hvcnRcIjpcIk0vZC95eSBoOm1tIGFcIixmdWxsRGF0ZTpcIkVFRUUsIE1NTU0gZCwgeVwiLFxyXG5sb25nRGF0ZTpcIk1NTU0gZCwgeVwiLG1lZGl1bURhdGU6XCJNTU0gZCwgeVwiLHNob3J0RGF0ZTpcIk0vZC95eVwiLG1lZGl1bVRpbWU6XCJoOm1tOnNzIGFcIixzaG9ydFRpbWU6XCJoOm1tIGFcIn0scGx1cmFsQ2F0OmZ1bmN0aW9uKGIpe3JldHVybiAxPT09Yj9cIm9uZVwiOlwib3RoZXJcIn19fX1mdW5jdGlvbiBhYyhiKXtiPWIuc3BsaXQoXCIvXCIpO2Zvcih2YXIgYT1iLmxlbmd0aDthLS07KWJbYV09cWIoYlthXSk7cmV0dXJuIGIuam9pbihcIi9cIil9ZnVuY3Rpb24gJGMoYixhKXt2YXIgYz1CYShiKTthLiQkcHJvdG9jb2w9Yy5wcm90b2NvbDthLiQkaG9zdD1jLmhvc3RuYW1lO2EuJCRwb3J0PWJhKGMucG9ydCl8fHhmW2MucHJvdG9jb2xdfHxudWxsfWZ1bmN0aW9uIGFkKGIsYSl7dmFyIGM9XCIvXCIhPT1iLmNoYXJBdCgwKTtjJiYoYj1cIi9cIitiKTt2YXIgZD1CYShiKTthLiQkcGF0aD1kZWNvZGVVUklDb21wb25lbnQoYyYmXCIvXCI9PT1kLnBhdGhuYW1lLmNoYXJBdCgwKT9kLnBhdGhuYW1lLnN1YnN0cmluZygxKTpcclxuZC5wYXRobmFtZSk7YS4kJHNlYXJjaD1xYyhkLnNlYXJjaCk7YS4kJGhhc2g9ZGVjb2RlVVJJQ29tcG9uZW50KGQuaGFzaCk7YS4kJHBhdGgmJlwiL1wiIT1hLiQkcGF0aC5jaGFyQXQoMCkmJihhLiQkcGF0aD1cIi9cIithLiQkcGF0aCl9ZnVuY3Rpb24gemEoYixhKXtpZigwPT09YS5pbmRleE9mKGIpKXJldHVybiBhLnN1YnN0cihiLmxlbmd0aCl9ZnVuY3Rpb24gSGEoYil7dmFyIGE9Yi5pbmRleE9mKFwiI1wiKTtyZXR1cm4tMT09YT9iOmIuc3Vic3RyKDAsYSl9ZnVuY3Rpb24gYmQoYil7cmV0dXJuIGIucmVwbGFjZSgvKCMuKyl8IyQvLFwiJDFcIil9ZnVuY3Rpb24gYmMoYil7cmV0dXJuIGIuc3Vic3RyKDAsSGEoYikubGFzdEluZGV4T2YoXCIvXCIpKzEpfWZ1bmN0aW9uIGNjKGIsYSl7dGhpcy4kJGh0bWw1PSEwO2E9YXx8XCJcIjt2YXIgYz1iYyhiKTskYyhiLHRoaXMpO3RoaXMuJCRwYXJzZT1mdW5jdGlvbihhKXt2YXIgYj16YShjLGEpO2lmKCFGKGIpKXRocm93IEZiKFwiaXB0aHByZnhcIixhLGMpO1xyXG5hZChiLHRoaXMpO3RoaXMuJCRwYXRofHwodGhpcy4kJHBhdGg9XCIvXCIpO3RoaXMuJCRjb21wb3NlKCl9O3RoaXMuJCRjb21wb3NlPWZ1bmN0aW9uKCl7dmFyIGE9TmIodGhpcy4kJHNlYXJjaCksYj10aGlzLiQkaGFzaD9cIiNcIitxYih0aGlzLiQkaGFzaCk6XCJcIjt0aGlzLiQkdXJsPWFjKHRoaXMuJCRwYXRoKSsoYT9cIj9cIithOlwiXCIpK2I7dGhpcy4kJGFic1VybD1jK3RoaXMuJCR1cmwuc3Vic3RyKDEpfTt0aGlzLiQkcGFyc2VMaW5rVXJsPWZ1bmN0aW9uKGQsZSl7aWYoZSYmXCIjXCI9PT1lWzBdKXJldHVybiB0aGlzLmhhc2goZS5zbGljZSgxKSksITA7dmFyIGYsZzsoZj16YShiLGQpKSE9PXQ/KGc9ZixnPShmPXphKGEsZikpIT09dD9jKyh6YShcIi9cIixmKXx8Zik6YitnKTooZj16YShjLGQpKSE9PXQ/Zz1jK2Y6Yz09ZCtcIi9cIiYmKGc9Yyk7ZyYmdGhpcy4kJHBhcnNlKGcpO3JldHVybiEhZ319ZnVuY3Rpb24gZGMoYixhKXt2YXIgYz1iYyhiKTskYyhiLHRoaXMpO3RoaXMuJCRwYXJzZT1mdW5jdGlvbihkKXtkPVxyXG56YShiLGQpfHx6YShjLGQpO3ZhciBlO1wiI1wiPT09ZC5jaGFyQXQoMCk/KGU9emEoYSxkKSxBKGUpJiYoZT1kKSk6ZT10aGlzLiQkaHRtbDU/ZDpcIlwiO2FkKGUsdGhpcyk7ZD10aGlzLiQkcGF0aDt2YXIgZj0vXlxcL1tBLVpdOihcXC8uKikvOzA9PT1lLmluZGV4T2YoYikmJihlPWUucmVwbGFjZShiLFwiXCIpKTtmLmV4ZWMoZSl8fChkPShlPWYuZXhlYyhkKSk/ZVsxXTpkKTt0aGlzLiQkcGF0aD1kO3RoaXMuJCRjb21wb3NlKCl9O3RoaXMuJCRjb21wb3NlPWZ1bmN0aW9uKCl7dmFyIGM9TmIodGhpcy4kJHNlYXJjaCksZT10aGlzLiQkaGFzaD9cIiNcIitxYih0aGlzLiQkaGFzaCk6XCJcIjt0aGlzLiQkdXJsPWFjKHRoaXMuJCRwYXRoKSsoYz9cIj9cIitjOlwiXCIpK2U7dGhpcy4kJGFic1VybD1iKyh0aGlzLiQkdXJsP2ErdGhpcy4kJHVybDpcIlwiKX07dGhpcy4kJHBhcnNlTGlua1VybD1mdW5jdGlvbihhLGMpe3JldHVybiBIYShiKT09SGEoYSk/KHRoaXMuJCRwYXJzZShhKSwhMCk6ITF9fWZ1bmN0aW9uIGNkKGIsXHJcbmEpe3RoaXMuJCRodG1sNT0hMDtkYy5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGM9YmMoYik7dGhpcy4kJHBhcnNlTGlua1VybD1mdW5jdGlvbihkLGUpe2lmKGUmJlwiI1wiPT09ZVswXSlyZXR1cm4gdGhpcy5oYXNoKGUuc2xpY2UoMSkpLCEwO3ZhciBmLGc7Yj09SGEoZCk/Zj1kOihnPXphKGMsZCkpP2Y9YithK2c6Yz09PWQrXCIvXCImJihmPWMpO2YmJnRoaXMuJCRwYXJzZShmKTtyZXR1cm4hIWZ9O3RoaXMuJCRjb21wb3NlPWZ1bmN0aW9uKCl7dmFyIGM9TmIodGhpcy4kJHNlYXJjaCksZT10aGlzLiQkaGFzaD9cIiNcIitxYih0aGlzLiQkaGFzaCk6XCJcIjt0aGlzLiQkdXJsPWFjKHRoaXMuJCRwYXRoKSsoYz9cIj9cIitjOlwiXCIpK2U7dGhpcy4kJGFic1VybD1iK2ErdGhpcy4kJHVybH19ZnVuY3Rpb24gR2IoYil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbYl19fWZ1bmN0aW9uIGRkKGIsYSl7cmV0dXJuIGZ1bmN0aW9uKGMpe2lmKEEoYykpcmV0dXJuIHRoaXNbYl07dGhpc1tiXT1cclxuYShjKTt0aGlzLiQkY29tcG9zZSgpO3JldHVybiB0aGlzfX1mdW5jdGlvbiBNZSgpe3ZhciBiPVwiXCIsYT17ZW5hYmxlZDohMSxyZXF1aXJlQmFzZTohMCxyZXdyaXRlTGlua3M6ITB9O3RoaXMuaGFzaFByZWZpeD1mdW5jdGlvbihhKXtyZXR1cm4geShhKT8oYj1hLHRoaXMpOmJ9O3RoaXMuaHRtbDVNb2RlPWZ1bmN0aW9uKGIpe3JldHVybiBXYShiKT8oYS5lbmFibGVkPWIsdGhpcyk6SShiKT8oV2EoYi5lbmFibGVkKSYmKGEuZW5hYmxlZD1iLmVuYWJsZWQpLFdhKGIucmVxdWlyZUJhc2UpJiYoYS5yZXF1aXJlQmFzZT1iLnJlcXVpcmVCYXNlKSxXYShiLnJld3JpdGVMaW5rcykmJihhLnJld3JpdGVMaW5rcz1iLnJld3JpdGVMaW5rcyksdGhpcyk6YX07dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiRicm93c2VyXCIsXCIkc25pZmZlclwiLFwiJHJvb3RFbGVtZW50XCIsXCIkd2luZG93XCIsZnVuY3Rpb24oYyxkLGUsZixnKXtmdW5jdGlvbiBoKGEsYixjKXt2YXIgZT1rLnVybCgpLGY9ay4kJHN0YXRlO1xyXG50cnl7ZC51cmwoYSxiLGMpLGsuJCRzdGF0ZT1kLnN0YXRlKCl9Y2F0Y2goZyl7dGhyb3cgay51cmwoZSksay4kJHN0YXRlPWYsZzt9fWZ1bmN0aW9uIGwoYSxiKXtjLiRicm9hZGNhc3QoXCIkbG9jYXRpb25DaGFuZ2VTdWNjZXNzXCIsay5hYnNVcmwoKSxhLGsuJCRzdGF0ZSxiKX12YXIgayxtO209ZC5iYXNlSHJlZigpO3ZhciBwPWQudXJsKCkscTtpZihhLmVuYWJsZWQpe2lmKCFtJiZhLnJlcXVpcmVCYXNlKXRocm93IEZiKFwibm9iYXNlXCIpO3E9cC5zdWJzdHJpbmcoMCxwLmluZGV4T2YoXCIvXCIscC5pbmRleE9mKFwiLy9cIikrMikpKyhtfHxcIi9cIik7bT1lLmhpc3Rvcnk/Y2M6Y2R9ZWxzZSBxPUhhKHApLG09ZGM7az1uZXcgbShxLFwiI1wiK2IpO2suJCRwYXJzZUxpbmtVcmwocCxwKTtrLiQkc3RhdGU9ZC5zdGF0ZSgpO3ZhciB1PS9eXFxzKihqYXZhc2NyaXB0fG1haWx0byk6L2k7Zi5vbihcImNsaWNrXCIsZnVuY3Rpb24oYil7aWYoYS5yZXdyaXRlTGlua3MmJiFiLmN0cmxLZXkmJiFiLm1ldGFLZXkmJlxyXG4yIT1iLndoaWNoKXtmb3IodmFyIGU9QihiLnRhcmdldCk7XCJhXCIhPT11YShlWzBdKTspaWYoZVswXT09PWZbMF18fCEoZT1lLnBhcmVudCgpKVswXSlyZXR1cm47dmFyIGg9ZS5wcm9wKFwiaHJlZlwiKSxsPWUuYXR0cihcImhyZWZcIil8fGUuYXR0cihcInhsaW5rOmhyZWZcIik7SShoKSYmXCJbb2JqZWN0IFNWR0FuaW1hdGVkU3RyaW5nXVwiPT09aC50b1N0cmluZygpJiYoaD1CYShoLmFuaW1WYWwpLmhyZWYpO3UudGVzdChoKXx8IWh8fGUuYXR0cihcInRhcmdldFwiKXx8Yi5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8IWsuJCRwYXJzZUxpbmtVcmwoaCxsKXx8KGIucHJldmVudERlZmF1bHQoKSxrLmFic1VybCgpIT1kLnVybCgpJiYoYy4kYXBwbHkoKSxnLmFuZ3VsYXJbXCJmZi02ODQyMDgtcHJldmVudERlZmF1bHRcIl09ITApKX19KTtrLmFic1VybCgpIT1wJiZkLnVybChrLmFic1VybCgpLCEwKTt2YXIgcj0hMDtkLm9uVXJsQ2hhbmdlKGZ1bmN0aW9uKGEsYil7Yy4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7dmFyIGQ9XHJcbmsuYWJzVXJsKCksZT1rLiQkc3RhdGUsZjtrLiQkcGFyc2UoYSk7ay4kJHN0YXRlPWI7Zj1jLiRicm9hZGNhc3QoXCIkbG9jYXRpb25DaGFuZ2VTdGFydFwiLGEsZCxiLGUpLmRlZmF1bHRQcmV2ZW50ZWQ7ay5hYnNVcmwoKT09PWEmJihmPyhrLiQkcGFyc2UoZCksay4kJHN0YXRlPWUsaChkLCExLGUpKToocj0hMSxsKGQsZSkpKX0pO2MuJCRwaGFzZXx8Yy4kZGlnZXN0KCl9KTtjLiR3YXRjaChmdW5jdGlvbigpe3ZhciBhPWJkKGQudXJsKCkpLGI9YmQoay5hYnNVcmwoKSksZj1kLnN0YXRlKCksZz1rLiQkcmVwbGFjZSxxPWEhPT1ifHxrLiQkaHRtbDUmJmUuaGlzdG9yeSYmZiE9PWsuJCRzdGF0ZTtpZihyfHxxKXI9ITEsYy4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7dmFyIGI9ay5hYnNVcmwoKSxkPWMuJGJyb2FkY2FzdChcIiRsb2NhdGlvbkNoYW5nZVN0YXJ0XCIsYixhLGsuJCRzdGF0ZSxmKS5kZWZhdWx0UHJldmVudGVkO2suYWJzVXJsKCk9PT1iJiYoZD8oay4kJHBhcnNlKGEpLGsuJCRzdGF0ZT1cclxuZik6KHEmJmgoYixnLGY9PT1rLiQkc3RhdGU/bnVsbDprLiQkc3RhdGUpLGwoYSxmKSkpfSk7ay4kJHJlcGxhY2U9ITF9KTtyZXR1cm4ga31dfWZ1bmN0aW9uIE5lKCl7dmFyIGI9ITAsYT10aGlzO3RoaXMuZGVidWdFbmFibGVkPWZ1bmN0aW9uKGEpe3JldHVybiB5KGEpPyhiPWEsdGhpcyk6Yn07dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEpe2EgaW5zdGFuY2VvZiBFcnJvciYmKGEuc3RhY2s/YT1hLm1lc3NhZ2UmJi0xPT09YS5zdGFjay5pbmRleE9mKGEubWVzc2FnZSk/XCJFcnJvcjogXCIrYS5tZXNzYWdlK1wiXFxuXCIrYS5zdGFjazphLnN0YWNrOmEuc291cmNlVVJMJiYoYT1hLm1lc3NhZ2UrXCJcXG5cIithLnNvdXJjZVVSTCtcIjpcIithLmxpbmUpKTtyZXR1cm4gYX1mdW5jdGlvbiBlKGEpe3ZhciBiPWMuY29uc29sZXx8e30sZT1iW2FdfHxiLmxvZ3x8SDthPSExO3RyeXthPSEhZS5hcHBseX1jYXRjaChsKXt9cmV0dXJuIGE/ZnVuY3Rpb24oKXt2YXIgYT1cclxuW107cyhhcmd1bWVudHMsZnVuY3Rpb24oYil7YS5wdXNoKGQoYikpfSk7cmV0dXJuIGUuYXBwbHkoYixhKX06ZnVuY3Rpb24oYSxiKXtlKGEsbnVsbD09Yj9cIlwiOmIpfX1yZXR1cm57bG9nOmUoXCJsb2dcIiksaW5mbzplKFwiaW5mb1wiKSx3YXJuOmUoXCJ3YXJuXCIpLGVycm9yOmUoXCJlcnJvclwiKSxkZWJ1ZzpmdW5jdGlvbigpe3ZhciBjPWUoXCJkZWJ1Z1wiKTtyZXR1cm4gZnVuY3Rpb24oKXtiJiZjLmFwcGx5KGEsYXJndW1lbnRzKX19KCl9fV19ZnVuY3Rpb24gdGEoYixhKXtpZihcIl9fZGVmaW5lR2V0dGVyX19cIj09PWJ8fFwiX19kZWZpbmVTZXR0ZXJfX1wiPT09Ynx8XCJfX2xvb2t1cEdldHRlcl9fXCI9PT1ifHxcIl9fbG9va3VwU2V0dGVyX19cIj09PWJ8fFwiX19wcm90b19fXCI9PT1iKXRocm93IGxhKFwiaXNlY2ZsZFwiLGEpO3JldHVybiBifWZ1bmN0aW9uIG1hKGIsYSl7aWYoYil7aWYoYi5jb25zdHJ1Y3Rvcj09PWIpdGhyb3cgbGEoXCJpc2VjZm5cIixhKTtpZihiLndpbmRvdz09PWIpdGhyb3cgbGEoXCJpc2Vjd2luZG93XCIsXHJcbmEpO2lmKGIuY2hpbGRyZW4mJihiLm5vZGVOYW1lfHxiLnByb3AmJmIuYXR0ciYmYi5maW5kKSl0aHJvdyBsYShcImlzZWNkb21cIixhKTtpZihiPT09T2JqZWN0KXRocm93IGxhKFwiaXNlY29ialwiLGEpO31yZXR1cm4gYn1mdW5jdGlvbiBlYyhiKXtyZXR1cm4gYi5jb25zdGFudH1mdW5jdGlvbiBnYihiLGEsYyxkLGUpe21hKGIsZSk7bWEoYSxlKTtjPWMuc3BsaXQoXCIuXCIpO2Zvcih2YXIgZixnPTA7MTxjLmxlbmd0aDtnKyspe2Y9dGEoYy5zaGlmdCgpLGUpO3ZhciBoPTA9PT1nJiZhJiZhW2ZdfHxiW2ZdO2h8fChoPXt9LGJbZl09aCk7Yj1tYShoLGUpfWY9dGEoYy5zaGlmdCgpLGUpO21hKGJbZl0sZSk7cmV0dXJuIGJbZl09ZH1mdW5jdGlvbiBRYShiKXtyZXR1cm5cImNvbnN0cnVjdG9yXCI9PWJ9ZnVuY3Rpb24gZWQoYixhLGMsZCxlLGYsZyl7dGEoYixmKTt0YShhLGYpO3RhKGMsZik7dGEoZCxmKTt0YShlLGYpO3ZhciBoPWZ1bmN0aW9uKGEpe3JldHVybiBtYShhLGYpfSxsPWd8fFFhKGIpP1xyXG5oOnBhLGs9Z3x8UWEoYSk/aDpwYSxtPWd8fFFhKGMpP2g6cGEscD1nfHxRYShkKT9oOnBhLHE9Z3x8UWEoZSk/aDpwYTtyZXR1cm4gZnVuY3Rpb24oZixnKXt2YXIgaD1nJiZnLmhhc093blByb3BlcnR5KGIpP2c6ZjtpZihudWxsPT1oKXJldHVybiBoO2g9bChoW2JdKTtpZighYSlyZXR1cm4gaDtpZihudWxsPT1oKXJldHVybiB0O2g9ayhoW2FdKTtpZighYylyZXR1cm4gaDtpZihudWxsPT1oKXJldHVybiB0O2g9bShoW2NdKTtpZighZClyZXR1cm4gaDtpZihudWxsPT1oKXJldHVybiB0O2g9cChoW2RdKTtyZXR1cm4gZT9udWxsPT1oP3Q6aD1xKGhbZV0pOmh9fWZ1bmN0aW9uIHlmKGIsYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7cmV0dXJuIGIoYyxkLG1hLGEpfX1mdW5jdGlvbiB6ZihiLGEsYyl7dmFyIGQ9YS5leHBlbnNpdmVDaGVja3MsZT1kP0FmOkJmLGY9ZVtiXTtpZihmKXJldHVybiBmO3ZhciBnPWIuc3BsaXQoXCIuXCIpLGg9Zy5sZW5ndGg7aWYoYS5jc3ApZj02Pmg/ZWQoZ1swXSxcclxuZ1sxXSxnWzJdLGdbM10sZ1s0XSxjLGQpOmZ1bmN0aW9uKGEsYil7dmFyIGU9MCxmO2RvIGY9ZWQoZ1tlKytdLGdbZSsrXSxnW2UrK10sZ1tlKytdLGdbZSsrXSxjLGQpKGEsYiksYj10LGE9Zjt3aGlsZShlPGgpO3JldHVybiBmfTtlbHNle3ZhciBsPVwiXCI7ZCYmKGwrPVwicyA9IGVzbyhzLCBmZSk7XFxubCA9IGVzbyhsLCBmZSk7XFxuXCIpO3ZhciBrPWQ7cyhnLGZ1bmN0aW9uKGEsYil7dGEoYSxjKTt2YXIgZT0oYj9cInNcIjonKChsJiZsLmhhc093blByb3BlcnR5KFwiJythKydcIikpP2w6cyknKStcIi5cIithO2lmKGR8fFFhKGEpKWU9XCJlc28oXCIrZStcIiwgZmUpXCIsaz0hMDtsKz1cImlmKHMgPT0gbnVsbCkgcmV0dXJuIHVuZGVmaW5lZDtcXG5zPVwiK2UrXCI7XFxuXCJ9KTtsKz1cInJldHVybiBzO1wiO2E9bmV3IEZ1bmN0aW9uKFwic1wiLFwibFwiLFwiZXNvXCIsXCJmZVwiLGwpO2EudG9TdHJpbmc9ZGEobCk7ayYmKGE9eWYoYSxjKSk7Zj1hfWYuc2hhcmVkR2V0dGVyPSEwO2YuYXNzaWduPWZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gZ2IoYSxcclxuZCxiLGMsYil9O3JldHVybiBlW2JdPWZ9ZnVuY3Rpb24gZmMoYil7cmV0dXJuIEcoYi52YWx1ZU9mKT9iLnZhbHVlT2YoKTpDZi5jYWxsKGIpfWZ1bmN0aW9uIE9lKCl7dmFyIGI9aGEoKSxhPWhhKCk7dGhpcy4kZ2V0PVtcIiRmaWx0ZXJcIixcIiRzbmlmZmVyXCIsZnVuY3Rpb24oYyxkKXtmdW5jdGlvbiBlKGEpe3ZhciBiPWE7YS5zaGFyZWRHZXR0ZXImJihiPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEoYixjKX0sYi5saXRlcmFsPWEubGl0ZXJhbCxiLmNvbnN0YW50PWEuY29uc3RhbnQsYi5hc3NpZ249YS5hc3NpZ24pO3JldHVybiBifWZ1bmN0aW9uIGYoYSxiKXtmb3IodmFyIGM9MCxkPWEubGVuZ3RoO2M8ZDtjKyspe3ZhciBlPWFbY107ZS5jb25zdGFudHx8KGUuaW5wdXRzP2YoZS5pbnB1dHMsYik6LTE9PT1iLmluZGV4T2YoZSkmJmIucHVzaChlKSl9cmV0dXJuIGJ9ZnVuY3Rpb24gZyhhLGIpe3JldHVybiBudWxsPT1hfHxudWxsPT1iP2E9PT1iOlwib2JqZWN0XCI9PT10eXBlb2YgYSYmXHJcbihhPWZjKGEpLFwib2JqZWN0XCI9PT10eXBlb2YgYSk/ITE6YT09PWJ8fGEhPT1hJiZiIT09Yn1mdW5jdGlvbiBoKGEsYixjLGQpe3ZhciBlPWQuJCRpbnB1dHN8fChkLiQkaW5wdXRzPWYoZC5pbnB1dHMsW10pKSxoO2lmKDE9PT1lLmxlbmd0aCl7dmFyIGw9ZyxlPWVbMF07cmV0dXJuIGEuJHdhdGNoKGZ1bmN0aW9uKGEpe3ZhciBiPWUoYSk7ZyhiLGwpfHwoaD1kKGEpLGw9YiYmZmMoYikpO3JldHVybiBofSxiLGMpfWZvcih2YXIgaz1bXSxxPTAscD1lLmxlbmd0aDtxPHA7cSsrKWtbcV09ZztyZXR1cm4gYS4kd2F0Y2goZnVuY3Rpb24oYSl7Zm9yKHZhciBiPSExLGM9MCxmPWUubGVuZ3RoO2M8ZjtjKyspe3ZhciBsPWVbY10oYSk7aWYoYnx8KGI9IWcobCxrW2NdKSkpa1tjXT1sJiZmYyhsKX1iJiYoaD1kKGEpKTtyZXR1cm4gaH0sYixjKX1mdW5jdGlvbiBsKGEsYixjLGQpe3ZhciBlLGY7cmV0dXJuIGU9YS4kd2F0Y2goZnVuY3Rpb24oYSl7cmV0dXJuIGQoYSl9LGZ1bmN0aW9uKGEsXHJcbmMsZCl7Zj1hO0coYikmJmIuYXBwbHkodGhpcyxhcmd1bWVudHMpO3koYSkmJmQuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCl7eShmKSYmZSgpfSl9LGMpfWZ1bmN0aW9uIGsoYSxiLGMsZCl7ZnVuY3Rpb24gZShhKXt2YXIgYj0hMDtzKGEsZnVuY3Rpb24oYSl7eShhKXx8KGI9ITEpfSk7cmV0dXJuIGJ9dmFyIGYsZztyZXR1cm4gZj1hLiR3YXRjaChmdW5jdGlvbihhKXtyZXR1cm4gZChhKX0sZnVuY3Rpb24oYSxjLGQpe2c9YTtHKGIpJiZiLmNhbGwodGhpcyxhLGMsZCk7ZShhKSYmZC4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKXtlKGcpJiZmKCl9KX0sYyl9ZnVuY3Rpb24gbShhLGIsYyxkKXt2YXIgZTtyZXR1cm4gZT1hLiR3YXRjaChmdW5jdGlvbihhKXtyZXR1cm4gZChhKX0sZnVuY3Rpb24oYSxjLGQpe0coYikmJmIuYXBwbHkodGhpcyxhcmd1bWVudHMpO2UoKX0sYyl9ZnVuY3Rpb24gcChhLGIpe2lmKCFiKXJldHVybiBhO3ZhciBjPWEuJCR3YXRjaERlbGVnYXRlLGM9YyE9PWsmJlxyXG5jIT09bD9mdW5jdGlvbihjLGQpe3ZhciBlPWEoYyxkKTtyZXR1cm4gYihlLGMsZCl9OmZ1bmN0aW9uKGMsZCl7dmFyIGU9YShjLGQpLGY9YihlLGMsZCk7cmV0dXJuIHkoZSk/ZjplfTthLiQkd2F0Y2hEZWxlZ2F0ZSYmYS4kJHdhdGNoRGVsZWdhdGUhPT1oP2MuJCR3YXRjaERlbGVnYXRlPWEuJCR3YXRjaERlbGVnYXRlOmIuJHN0YXRlZnVsfHwoYy4kJHdhdGNoRGVsZWdhdGU9aCxjLmlucHV0cz1bYV0pO3JldHVybiBjfXZhciBxPXtjc3A6ZC5jc3AsZXhwZW5zaXZlQ2hlY2tzOiExfSx1PXtjc3A6ZC5jc3AsZXhwZW5zaXZlQ2hlY2tzOiEwfTtyZXR1cm4gZnVuY3Rpb24oZCxmLGcpe3ZhciB2LHcsTDtzd2l0Y2godHlwZW9mIGQpe2Nhc2UgXCJzdHJpbmdcIjpMPWQ9ZC50cmltKCk7dmFyIEM9Zz9hOmI7dj1DW0xdO3Z8fChcIjpcIj09PWQuY2hhckF0KDApJiZcIjpcIj09PWQuY2hhckF0KDEpJiYodz0hMCxkPWQuc3Vic3RyaW5nKDIpKSxnPWc/dTpxLHY9bmV3IGdjKGcpLHY9KG5ldyBoYih2LFxyXG5jLGcpKS5wYXJzZShkKSx2LmNvbnN0YW50P3YuJCR3YXRjaERlbGVnYXRlPW06dz8odj1lKHYpLHYuJCR3YXRjaERlbGVnYXRlPXYubGl0ZXJhbD9rOmwpOnYuaW5wdXRzJiYodi4kJHdhdGNoRGVsZWdhdGU9aCksQ1tMXT12KTtyZXR1cm4gcCh2LGYpO2Nhc2UgXCJmdW5jdGlvblwiOnJldHVybiBwKGQsZik7ZGVmYXVsdDpyZXR1cm4gcChILGYpfX19XX1mdW5jdGlvbiBRZSgpe3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLGZ1bmN0aW9uKGIsYSl7cmV0dXJuIGZkKGZ1bmN0aW9uKGEpe2IuJGV2YWxBc3luYyhhKX0sYSl9XX1mdW5jdGlvbiBSZSgpe3RoaXMuJGdldD1bXCIkYnJvd3NlclwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixmdW5jdGlvbihiLGEpe3JldHVybiBmZChmdW5jdGlvbihhKXtiLmRlZmVyKGEpfSxhKX1dfWZ1bmN0aW9uIGZkKGIsYSl7ZnVuY3Rpb24gYyhhLGIsYyl7ZnVuY3Rpb24gZChiKXtyZXR1cm4gZnVuY3Rpb24oYyl7ZXx8KGU9ITAsXHJcbmIuY2FsbChhLGMpKX19dmFyIGU9ITE7cmV0dXJuW2QoYiksZChjKV19ZnVuY3Rpb24gZCgpe3RoaXMuJCRzdGF0ZT17c3RhdHVzOjB9fWZ1bmN0aW9uIGUoYSxiKXtyZXR1cm4gZnVuY3Rpb24oYyl7Yi5jYWxsKGEsYyl9fWZ1bmN0aW9uIGYoYyl7IWMucHJvY2Vzc1NjaGVkdWxlZCYmYy5wZW5kaW5nJiYoYy5wcm9jZXNzU2NoZWR1bGVkPSEwLGIoZnVuY3Rpb24oKXt2YXIgYixkLGU7ZT1jLnBlbmRpbmc7Yy5wcm9jZXNzU2NoZWR1bGVkPSExO2MucGVuZGluZz10O2Zvcih2YXIgZj0wLGc9ZS5sZW5ndGg7ZjxnOysrZil7ZD1lW2ZdWzBdO2I9ZVtmXVtjLnN0YXR1c107dHJ5e0coYik/ZC5yZXNvbHZlKGIoYy52YWx1ZSkpOjE9PT1jLnN0YXR1cz9kLnJlc29sdmUoYy52YWx1ZSk6ZC5yZWplY3QoYy52YWx1ZSl9Y2F0Y2goaCl7ZC5yZWplY3QoaCksYShoKX19fSkpfWZ1bmN0aW9uIGcoKXt0aGlzLnByb21pc2U9bmV3IGQ7dGhpcy5yZXNvbHZlPWUodGhpcyx0aGlzLnJlc29sdmUpO1xyXG50aGlzLnJlamVjdD1lKHRoaXMsdGhpcy5yZWplY3QpO3RoaXMubm90aWZ5PWUodGhpcyx0aGlzLm5vdGlmeSl9dmFyIGg9VChcIiRxXCIsVHlwZUVycm9yKTtkLnByb3RvdHlwZT17dGhlbjpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9bmV3IGc7dGhpcy4kJHN0YXRlLnBlbmRpbmc9dGhpcy4kJHN0YXRlLnBlbmRpbmd8fFtdO3RoaXMuJCRzdGF0ZS5wZW5kaW5nLnB1c2goW2QsYSxiLGNdKTswPHRoaXMuJCRzdGF0ZS5zdGF0dXMmJmYodGhpcy4kJHN0YXRlKTtyZXR1cm4gZC5wcm9taXNlfSxcImNhdGNoXCI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMudGhlbihudWxsLGEpfSxcImZpbmFsbHlcIjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24oYil7cmV0dXJuIGsoYiwhMCxhKX0sZnVuY3Rpb24oYil7cmV0dXJuIGsoYiwhMSxhKX0sYil9fTtnLnByb3RvdHlwZT17cmVzb2x2ZTpmdW5jdGlvbihhKXt0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXN8fChhPT09dGhpcy5wcm9taXNlP1xyXG50aGlzLiQkcmVqZWN0KGgoXCJxY3ljbGVcIixhKSk6dGhpcy4kJHJlc29sdmUoYSkpfSwkJHJlc29sdmU6ZnVuY3Rpb24oYil7dmFyIGQsZTtlPWModGhpcyx0aGlzLiQkcmVzb2x2ZSx0aGlzLiQkcmVqZWN0KTt0cnl7aWYoSShiKXx8RyhiKSlkPWImJmIudGhlbjtHKGQpPyh0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXM9LTEsZC5jYWxsKGIsZVswXSxlWzFdLHRoaXMubm90aWZ5KSk6KHRoaXMucHJvbWlzZS4kJHN0YXRlLnZhbHVlPWIsdGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzPTEsZih0aGlzLnByb21pc2UuJCRzdGF0ZSkpfWNhdGNoKGcpe2VbMV0oZyksYShnKX19LHJlamVjdDpmdW5jdGlvbihhKXt0aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXN8fHRoaXMuJCRyZWplY3QoYSl9LCQkcmVqZWN0OmZ1bmN0aW9uKGEpe3RoaXMucHJvbWlzZS4kJHN0YXRlLnZhbHVlPWE7dGhpcy5wcm9taXNlLiQkc3RhdGUuc3RhdHVzPTI7Zih0aGlzLnByb21pc2UuJCRzdGF0ZSl9LG5vdGlmeTpmdW5jdGlvbihjKXt2YXIgZD1cclxudGhpcy5wcm9taXNlLiQkc3RhdGUucGVuZGluZzswPj10aGlzLnByb21pc2UuJCRzdGF0ZS5zdGF0dXMmJmQmJmQubGVuZ3RoJiZiKGZ1bmN0aW9uKCl7Zm9yKHZhciBiLGUsZj0wLGc9ZC5sZW5ndGg7ZjxnO2YrKyl7ZT1kW2ZdWzBdO2I9ZFtmXVszXTt0cnl7ZS5ub3RpZnkoRyhiKT9iKGMpOmMpfWNhdGNoKGgpe2EoaCl9fX0pfX07dmFyIGw9ZnVuY3Rpb24oYSxiKXt2YXIgYz1uZXcgZztiP2MucmVzb2x2ZShhKTpjLnJlamVjdChhKTtyZXR1cm4gYy5wcm9taXNlfSxrPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1udWxsO3RyeXtHKGMpJiYoZD1jKCkpfWNhdGNoKGUpe3JldHVybiBsKGUsITEpfXJldHVybiBkJiZHKGQudGhlbik/ZC50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGwoYSxiKX0sZnVuY3Rpb24oYSl7cmV0dXJuIGwoYSwhMSl9KTpsKGEsYil9LG09ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9bmV3IGc7ZS5yZXNvbHZlKGEpO3JldHVybiBlLnByb21pc2UudGhlbihiLGMsZCl9LFxyXG5wPWZ1bmN0aW9uIHUoYSl7aWYoIUcoYSkpdGhyb3cgaChcIm5vcnNsdnJcIixhKTtpZighKHRoaXMgaW5zdGFuY2VvZiB1KSlyZXR1cm4gbmV3IHUoYSk7dmFyIGI9bmV3IGc7YShmdW5jdGlvbihhKXtiLnJlc29sdmUoYSl9LGZ1bmN0aW9uKGEpe2IucmVqZWN0KGEpfSk7cmV0dXJuIGIucHJvbWlzZX07cC5kZWZlcj1mdW5jdGlvbigpe3JldHVybiBuZXcgZ307cC5yZWplY3Q9ZnVuY3Rpb24oYSl7dmFyIGI9bmV3IGc7Yi5yZWplY3QoYSk7cmV0dXJuIGIucHJvbWlzZX07cC53aGVuPW07cC5hbGw9ZnVuY3Rpb24oYSl7dmFyIGI9bmV3IGcsYz0wLGQ9RChhKT9bXTp7fTtzKGEsZnVuY3Rpb24oYSxlKXtjKys7bShhKS50aGVuKGZ1bmN0aW9uKGEpe2QuaGFzT3duUHJvcGVydHkoZSl8fChkW2VdPWEsLS1jfHxiLnJlc29sdmUoZCkpfSxmdW5jdGlvbihhKXtkLmhhc093blByb3BlcnR5KGUpfHxiLnJlamVjdChhKX0pfSk7MD09PWMmJmIucmVzb2x2ZShkKTtyZXR1cm4gYi5wcm9taXNlfTtcclxucmV0dXJuIHB9ZnVuY3Rpb24gJGUoKXt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihiLGEpe3ZhciBjPWIucmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxiLndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSxkPWIuY2FuY2VsQW5pbWF0aW9uRnJhbWV8fGIud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fGIud2Via2l0Q2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lLGU9ISFjLGY9ZT9mdW5jdGlvbihhKXt2YXIgYj1jKGEpO3JldHVybiBmdW5jdGlvbigpe2QoYil9fTpmdW5jdGlvbihiKXt2YXIgYz1hKGIsMTYuNjYsITEpO3JldHVybiBmdW5jdGlvbigpe2EuY2FuY2VsKGMpfX07Zi5zdXBwb3J0ZWQ9ZTtyZXR1cm4gZn1dfWZ1bmN0aW9uIFBlKCl7dmFyIGI9MTAsYT1UKFwiJHJvb3RTY29wZVwiKSxjPW51bGwsZD1udWxsO3RoaXMuZGlnZXN0VHRsPWZ1bmN0aW9uKGEpe2FyZ3VtZW50cy5sZW5ndGgmJihiPWEpO3JldHVybiBifTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsXHJcblwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcIiRwYXJzZVwiLFwiJGJyb3dzZXJcIixmdW5jdGlvbihlLGYsZyxoKXtmdW5jdGlvbiBsKCl7dGhpcy4kaWQ9KytuYjt0aGlzLiQkcGhhc2U9dGhpcy4kcGFyZW50PXRoaXMuJCR3YXRjaGVycz10aGlzLiQkbmV4dFNpYmxpbmc9dGhpcy4kJHByZXZTaWJsaW5nPXRoaXMuJCRjaGlsZEhlYWQ9dGhpcy4kJGNoaWxkVGFpbD1udWxsO3RoaXMuJHJvb3Q9dGhpczt0aGlzLiQkZGVzdHJveWVkPSExO3RoaXMuJCRsaXN0ZW5lcnM9e307dGhpcy4kJGxpc3RlbmVyQ291bnQ9e307dGhpcy4kJGlzb2xhdGVCaW5kaW5ncz1udWxsfWZ1bmN0aW9uIGsoYil7aWYoci4kJHBoYXNlKXRocm93IGEoXCJpbnByb2dcIixyLiQkcGhhc2UpO3IuJCRwaGFzZT1ifWZ1bmN0aW9uIG0oYSxiLGMpe2RvIGEuJCRsaXN0ZW5lckNvdW50W2NdLT1iLDA9PT1hLiQkbGlzdGVuZXJDb3VudFtjXSYmZGVsZXRlIGEuJCRsaXN0ZW5lckNvdW50W2NdO3doaWxlKGE9YS4kcGFyZW50KX1mdW5jdGlvbiBwKCl7fVxyXG5mdW5jdGlvbiBxKCl7Zm9yKDt2Lmxlbmd0aDspdHJ5e3Yuc2hpZnQoKSgpfWNhdGNoKGEpe2YoYSl9ZD1udWxsfWZ1bmN0aW9uIHUoKXtudWxsPT09ZCYmKGQ9aC5kZWZlcihmdW5jdGlvbigpe3IuJGFwcGx5KHEpfSkpfWwucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpsLCRuZXc6ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKCl7ZC4kJGRlc3Ryb3llZD0hMH12YXIgZDtiPWJ8fHRoaXM7YT8oZD1uZXcgbCxkLiRyb290PXRoaXMuJHJvb3QpOih0aGlzLiQkQ2hpbGRTY29wZXx8KHRoaXMuJCRDaGlsZFNjb3BlPWZ1bmN0aW9uKCl7dGhpcy4kJHdhdGNoZXJzPXRoaXMuJCRuZXh0U2libGluZz10aGlzLiQkY2hpbGRIZWFkPXRoaXMuJCRjaGlsZFRhaWw9bnVsbDt0aGlzLiQkbGlzdGVuZXJzPXt9O3RoaXMuJCRsaXN0ZW5lckNvdW50PXt9O3RoaXMuJGlkPSsrbmI7dGhpcy4kJENoaWxkU2NvcGU9bnVsbH0sdGhpcy4kJENoaWxkU2NvcGUucHJvdG90eXBlPXRoaXMpLGQ9bmV3IHRoaXMuJCRDaGlsZFNjb3BlKTtcclxuZC4kcGFyZW50PWI7ZC4kJHByZXZTaWJsaW5nPWIuJCRjaGlsZFRhaWw7Yi4kJGNoaWxkSGVhZD8oYi4kJGNoaWxkVGFpbC4kJG5leHRTaWJsaW5nPWQsYi4kJGNoaWxkVGFpbD1kKTpiLiQkY2hpbGRIZWFkPWIuJCRjaGlsZFRhaWw9ZDsoYXx8YiE9dGhpcykmJmQuJG9uKFwiJGRlc3Ryb3lcIixjKTtyZXR1cm4gZH0sJHdhdGNoOmZ1bmN0aW9uKGEsYixkKXt2YXIgZT1nKGEpO2lmKGUuJCR3YXRjaERlbGVnYXRlKXJldHVybiBlLiQkd2F0Y2hEZWxlZ2F0ZSh0aGlzLGIsZCxlKTt2YXIgZj10aGlzLiQkd2F0Y2hlcnMsaD17Zm46YixsYXN0OnAsZ2V0OmUsZXhwOmEsZXE6ISFkfTtjPW51bGw7RyhiKXx8KGguZm49SCk7Znx8KGY9dGhpcy4kJHdhdGNoZXJzPVtdKTtmLnVuc2hpZnQoaCk7cmV0dXJuIGZ1bmN0aW9uKCl7WGEoZixoKTtjPW51bGx9fSwkd2F0Y2hHcm91cDpmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoKXtoPSExO2w/KGw9ITEsYihlLGUsZykpOmIoZSxkLGcpfXZhciBkPUFycmF5KGEubGVuZ3RoKSxcclxuZT1BcnJheShhLmxlbmd0aCksZj1bXSxnPXRoaXMsaD0hMSxsPSEwO2lmKCFhLmxlbmd0aCl7dmFyIGs9ITA7Zy4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7ayYmYihlLGUsZyl9KTtyZXR1cm4gZnVuY3Rpb24oKXtrPSExfX1pZigxPT09YS5sZW5ndGgpcmV0dXJuIHRoaXMuJHdhdGNoKGFbMF0sZnVuY3Rpb24oYSxjLGYpe2VbMF09YTtkWzBdPWM7YihlLGE9PT1jP2U6ZCxmKX0pO3MoYSxmdW5jdGlvbihhLGIpe3ZhciBsPWcuJHdhdGNoKGEsZnVuY3Rpb24oYSxmKXtlW2JdPWE7ZFtiXT1mO2h8fChoPSEwLGcuJGV2YWxBc3luYyhjKSl9KTtmLnB1c2gobCl9KTtyZXR1cm4gZnVuY3Rpb24oKXtmb3IoO2YubGVuZ3RoOylmLnNoaWZ0KCkoKX19LCR3YXRjaENvbGxlY3Rpb246ZnVuY3Rpb24oYSxiKXtmdW5jdGlvbiBjKGEpe2U9YTt2YXIgYixkLGcsaDtpZighQShlKSl7aWYoSShlKSlpZihUYShlKSlmb3IoZiE9PXEmJihmPXEsdT1mLmxlbmd0aD0wLGsrKyksYT1lLmxlbmd0aCx1IT09XHJcbmEmJihrKyssZi5sZW5ndGg9dT1hKSxiPTA7YjxhO2IrKyloPWZbYl0sZz1lW2JdLGQ9aCE9PWgmJmchPT1nLGR8fGg9PT1nfHwoaysrLGZbYl09Zyk7ZWxzZXtmIT09bSYmKGY9bT17fSx1PTAsaysrKTthPTA7Zm9yKGIgaW4gZSllLmhhc093blByb3BlcnR5KGIpJiYoYSsrLGc9ZVtiXSxoPWZbYl0sYiBpbiBmPyhkPWghPT1oJiZnIT09ZyxkfHxoPT09Z3x8KGsrKyxmW2JdPWcpKToodSsrLGZbYl09ZyxrKyspKTtpZih1PmEpZm9yKGIgaW4gaysrLGYpZS5oYXNPd25Qcm9wZXJ0eShiKXx8KHUtLSxkZWxldGUgZltiXSl9ZWxzZSBmIT09ZSYmKGY9ZSxrKyspO3JldHVybiBrfX1jLiRzdGF0ZWZ1bD0hMDt2YXIgZD10aGlzLGUsZixoLGw9MTxiLmxlbmd0aCxrPTAscD1nKGEsYykscT1bXSxtPXt9LG49ITAsdT0wO3JldHVybiB0aGlzLiR3YXRjaChwLGZ1bmN0aW9uKCl7bj8obj0hMSxiKGUsZSxkKSk6YihlLGgsZCk7aWYobClpZihJKGUpKWlmKFRhKGUpKXtoPUFycmF5KGUubGVuZ3RoKTtcclxuZm9yKHZhciBhPTA7YTxlLmxlbmd0aDthKyspaFthXT1lW2FdfWVsc2UgZm9yKGEgaW4gaD17fSxlKXJjLmNhbGwoZSxhKSYmKGhbYV09ZVthXSk7ZWxzZSBoPWV9KX0sJGRpZ2VzdDpmdW5jdGlvbigpe3ZhciBlLGcsbCxtLHUsdixzPWIsdCxXPVtdLHksSjtrKFwiJGRpZ2VzdFwiKTtoLiQkY2hlY2tVcmxDaGFuZ2UoKTt0aGlzPT09ciYmbnVsbCE9PWQmJihoLmRlZmVyLmNhbmNlbChkKSxxKCkpO2M9bnVsbDtkb3t2PSExO2Zvcih0PXRoaXM7Ty5sZW5ndGg7KXt0cnl7Sj1PLnNoaWZ0KCksSi5zY29wZS4kZXZhbChKLmV4cHJlc3Npb24sSi5sb2NhbHMpfWNhdGNoKEIpe2YoQil9Yz1udWxsfWE6ZG97aWYobT10LiQkd2F0Y2hlcnMpZm9yKHU9bS5sZW5ndGg7dS0tOyl0cnl7aWYoZT1tW3VdKWlmKChnPWUuZ2V0KHQpKSE9PShsPWUubGFzdCkmJiEoZS5lcT9mYShnLGwpOlwibnVtYmVyXCI9PT10eXBlb2YgZyYmXCJudW1iZXJcIj09PXR5cGVvZiBsJiZpc05hTihnKSYmaXNOYU4obCkpKXY9XHJcbiEwLGM9ZSxlLmxhc3Q9ZS5lcT9FYShnLG51bGwpOmcsZS5mbihnLGw9PT1wP2c6bCx0KSw1PnMmJih5PTQtcyxXW3ldfHwoV1t5XT1bXSksV1t5XS5wdXNoKHttc2c6RyhlLmV4cCk/XCJmbjogXCIrKGUuZXhwLm5hbWV8fGUuZXhwLnRvU3RyaW5nKCkpOmUuZXhwLG5ld1ZhbDpnLG9sZFZhbDpsfSkpO2Vsc2UgaWYoZT09PWMpe3Y9ITE7YnJlYWsgYX19Y2F0Y2goQSl7ZihBKX1pZighKG09dC4kJGNoaWxkSGVhZHx8dCE9PXRoaXMmJnQuJCRuZXh0U2libGluZykpZm9yKDt0IT09dGhpcyYmIShtPXQuJCRuZXh0U2libGluZyk7KXQ9dC4kcGFyZW50fXdoaWxlKHQ9bSk7aWYoKHZ8fE8ubGVuZ3RoKSYmIXMtLSl0aHJvdyByLiQkcGhhc2U9bnVsbCxhKFwiaW5mZGlnXCIsYixXKTt9d2hpbGUodnx8Ty5sZW5ndGgpO2ZvcihyLiQkcGhhc2U9bnVsbDtuLmxlbmd0aDspdHJ5e24uc2hpZnQoKSgpfWNhdGNoKGNhKXtmKGNhKX19LCRkZXN0cm95OmZ1bmN0aW9uKCl7aWYoIXRoaXMuJCRkZXN0cm95ZWQpe3ZhciBhPVxyXG50aGlzLiRwYXJlbnQ7dGhpcy4kYnJvYWRjYXN0KFwiJGRlc3Ryb3lcIik7dGhpcy4kJGRlc3Ryb3llZD0hMDtpZih0aGlzIT09cil7Zm9yKHZhciBiIGluIHRoaXMuJCRsaXN0ZW5lckNvdW50KW0odGhpcyx0aGlzLiQkbGlzdGVuZXJDb3VudFtiXSxiKTthLiQkY2hpbGRIZWFkPT10aGlzJiYoYS4kJGNoaWxkSGVhZD10aGlzLiQkbmV4dFNpYmxpbmcpO2EuJCRjaGlsZFRhaWw9PXRoaXMmJihhLiQkY2hpbGRUYWlsPXRoaXMuJCRwcmV2U2libGluZyk7dGhpcy4kJHByZXZTaWJsaW5nJiYodGhpcy4kJHByZXZTaWJsaW5nLiQkbmV4dFNpYmxpbmc9dGhpcy4kJG5leHRTaWJsaW5nKTt0aGlzLiQkbmV4dFNpYmxpbmcmJih0aGlzLiQkbmV4dFNpYmxpbmcuJCRwcmV2U2libGluZz10aGlzLiQkcHJldlNpYmxpbmcpO3RoaXMuJGRlc3Ryb3k9dGhpcy4kZGlnZXN0PXRoaXMuJGFwcGx5PXRoaXMuJGV2YWxBc3luYz10aGlzLiRhcHBseUFzeW5jPUg7dGhpcy4kb249dGhpcy4kd2F0Y2g9dGhpcy4kd2F0Y2hHcm91cD1cclxuZnVuY3Rpb24oKXtyZXR1cm4gSH07dGhpcy4kJGxpc3RlbmVycz17fTt0aGlzLiRwYXJlbnQ9dGhpcy4kJG5leHRTaWJsaW5nPXRoaXMuJCRwcmV2U2libGluZz10aGlzLiQkY2hpbGRIZWFkPXRoaXMuJCRjaGlsZFRhaWw9dGhpcy4kcm9vdD10aGlzLiQkd2F0Y2hlcnM9bnVsbH19fSwkZXZhbDpmdW5jdGlvbihhLGIpe3JldHVybiBnKGEpKHRoaXMsYil9LCRldmFsQXN5bmM6ZnVuY3Rpb24oYSxiKXtyLiQkcGhhc2V8fE8ubGVuZ3RofHxoLmRlZmVyKGZ1bmN0aW9uKCl7Ty5sZW5ndGgmJnIuJGRpZ2VzdCgpfSk7Ty5wdXNoKHtzY29wZTp0aGlzLGV4cHJlc3Npb246YSxsb2NhbHM6Yn0pfSwkJHBvc3REaWdlc3Q6ZnVuY3Rpb24oYSl7bi5wdXNoKGEpfSwkYXBwbHk6ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBrKFwiJGFwcGx5XCIpLHRoaXMuJGV2YWwoYSl9Y2F0Y2goYil7ZihiKX1maW5hbGx5e3IuJCRwaGFzZT1udWxsO3RyeXtyLiRkaWdlc3QoKX1jYXRjaChjKXt0aHJvdyBmKGMpLGM7XHJcbn19fSwkYXBwbHlBc3luYzpmdW5jdGlvbihhKXtmdW5jdGlvbiBiKCl7Yy4kZXZhbChhKX12YXIgYz10aGlzO2EmJnYucHVzaChiKTt1KCl9LCRvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuJCRsaXN0ZW5lcnNbYV07Y3x8KHRoaXMuJCRsaXN0ZW5lcnNbYV09Yz1bXSk7Yy5wdXNoKGIpO3ZhciBkPXRoaXM7ZG8gZC4kJGxpc3RlbmVyQ291bnRbYV18fChkLiQkbGlzdGVuZXJDb3VudFthXT0wKSxkLiQkbGlzdGVuZXJDb3VudFthXSsrO3doaWxlKGQ9ZC4kcGFyZW50KTt2YXIgZT10aGlzO3JldHVybiBmdW5jdGlvbigpe3ZhciBkPWMuaW5kZXhPZihiKTstMSE9PWQmJihjW2RdPW51bGwsbShlLDEsYSkpfX0sJGVtaXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1bXSxkLGU9dGhpcyxnPSExLGg9e25hbWU6YSx0YXJnZXRTY29wZTplLHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe2c9ITB9LHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7aC5kZWZhdWx0UHJldmVudGVkPSEwfSxkZWZhdWx0UHJldmVudGVkOiExfSxcclxubD1ZYShbaF0sYXJndW1lbnRzLDEpLGsscDtkb3tkPWUuJCRsaXN0ZW5lcnNbYV18fGM7aC5jdXJyZW50U2NvcGU9ZTtrPTA7Zm9yKHA9ZC5sZW5ndGg7azxwO2srKylpZihkW2tdKXRyeXtkW2tdLmFwcGx5KG51bGwsbCl9Y2F0Y2gobSl7ZihtKX1lbHNlIGQuc3BsaWNlKGssMSksay0tLHAtLTtpZihnKXJldHVybiBoLmN1cnJlbnRTY29wZT1udWxsLGg7ZT1lLiRwYXJlbnR9d2hpbGUoZSk7aC5jdXJyZW50U2NvcGU9bnVsbDtyZXR1cm4gaH0sJGJyb2FkY2FzdDpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMsZD10aGlzLGU9e25hbWU6YSx0YXJnZXRTY29wZTp0aGlzLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7ZS5kZWZhdWx0UHJldmVudGVkPSEwfSxkZWZhdWx0UHJldmVudGVkOiExfTtpZighdGhpcy4kJGxpc3RlbmVyQ291bnRbYV0pcmV0dXJuIGU7Zm9yKHZhciBnPVlhKFtlXSxhcmd1bWVudHMsMSksaCxsO2M9ZDspe2UuY3VycmVudFNjb3BlPWM7ZD1jLiQkbGlzdGVuZXJzW2FdfHxcclxuW107aD0wO2ZvcihsPWQubGVuZ3RoO2g8bDtoKyspaWYoZFtoXSl0cnl7ZFtoXS5hcHBseShudWxsLGcpfWNhdGNoKGspe2Yoayl9ZWxzZSBkLnNwbGljZShoLDEpLGgtLSxsLS07aWYoIShkPWMuJCRsaXN0ZW5lckNvdW50W2FdJiZjLiQkY2hpbGRIZWFkfHxjIT09dGhpcyYmYy4kJG5leHRTaWJsaW5nKSlmb3IoO2MhPT10aGlzJiYhKGQ9Yy4kJG5leHRTaWJsaW5nKTspYz1jLiRwYXJlbnR9ZS5jdXJyZW50U2NvcGU9bnVsbDtyZXR1cm4gZX19O3ZhciByPW5ldyBsLE89ci4kJGFzeW5jUXVldWU9W10sbj1yLiQkcG9zdERpZ2VzdFF1ZXVlPVtdLHY9ci4kJGFwcGx5QXN5bmNRdWV1ZT1bXTtyZXR1cm4gcn1dfWZ1bmN0aW9uIFNkKCl7dmFyIGI9L15cXHMqKGh0dHBzP3xmdHB8bWFpbHRvfHRlbHxmaWxlKTovLGE9L15cXHMqKChodHRwcz98ZnRwfGZpbGV8YmxvYik6fGRhdGE6aW1hZ2VcXC8pLzt0aGlzLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGEpe3JldHVybiB5KGEpP1xyXG4oYj1hLHRoaXMpOmJ9O3RoaXMuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGIpe3JldHVybiB5KGIpPyhhPWIsdGhpcyk6YX07dGhpcy4kZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGMsZCl7dmFyIGU9ZD9hOmIsZjtmPUJhKGMpLmhyZWY7cmV0dXJuXCJcIj09PWZ8fGYubWF0Y2goZSk/YzpcInVuc2FmZTpcIitmfX19ZnVuY3Rpb24gRGYoYil7aWYoXCJzZWxmXCI9PT1iKXJldHVybiBiO2lmKEYoYikpe2lmKC0xPGIuaW5kZXhPZihcIioqKlwiKSl0aHJvdyBDYShcIml3Y2FyZFwiLGIpO2I9Z2QoYikucmVwbGFjZShcIlxcXFwqXFxcXCpcIixcIi4qXCIpLnJlcGxhY2UoXCJcXFxcKlwiLFwiW146Ly4/JjtdKlwiKTtyZXR1cm4gbmV3IFJlZ0V4cChcIl5cIitiK1wiJFwiKX1pZihvYihiKSlyZXR1cm4gbmV3IFJlZ0V4cChcIl5cIitiLnNvdXJjZStcIiRcIik7dGhyb3cgQ2EoXCJpbWF0Y2hlclwiKTt9ZnVuY3Rpb24gaGQoYil7dmFyIGE9W107eShiKSYmcyhiLGZ1bmN0aW9uKGIpe2EucHVzaChEZihiKSl9KTtcclxucmV0dXJuIGF9ZnVuY3Rpb24gVGUoKXt0aGlzLlNDRV9DT05URVhUUz1uYTt2YXIgYj1bXCJzZWxmXCJdLGE9W107dGhpcy5yZXNvdXJjZVVybFdoaXRlbGlzdD1mdW5jdGlvbihhKXthcmd1bWVudHMubGVuZ3RoJiYoYj1oZChhKSk7cmV0dXJuIGJ9O3RoaXMucmVzb3VyY2VVcmxCbGFja2xpc3Q9ZnVuY3Rpb24oYil7YXJndW1lbnRzLmxlbmd0aCYmKGE9aGQoYikpO3JldHVybiBhfTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsZnVuY3Rpb24oYyl7ZnVuY3Rpb24gZChhLGIpe3JldHVyblwic2VsZlwiPT09YT9aYyhiKTohIWEuZXhlYyhiLmhyZWYpfWZ1bmN0aW9uIGUoYSl7dmFyIGI9ZnVuY3Rpb24oYSl7dGhpcy4kJHVud3JhcFRydXN0ZWRWYWx1ZT1mdW5jdGlvbigpe3JldHVybiBhfX07YSYmKGIucHJvdG90eXBlPW5ldyBhKTtiLnByb3RvdHlwZS52YWx1ZU9mPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWUoKX07Yi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kJHVud3JhcFRydXN0ZWRWYWx1ZSgpLnRvU3RyaW5nKCl9O1xyXG5yZXR1cm4gYn12YXIgZj1mdW5jdGlvbihhKXt0aHJvdyBDYShcInVuc2FmZVwiKTt9O2MuaGFzKFwiJHNhbml0aXplXCIpJiYoZj1jLmdldChcIiRzYW5pdGl6ZVwiKSk7dmFyIGc9ZSgpLGg9e307aFtuYS5IVE1MXT1lKGcpO2hbbmEuQ1NTXT1lKGcpO2hbbmEuVVJMXT1lKGcpO2hbbmEuSlNdPWUoZyk7aFtuYS5SRVNPVVJDRV9VUkxdPWUoaFtuYS5VUkxdKTtyZXR1cm57dHJ1c3RBczpmdW5jdGlvbihhLGIpe3ZhciBjPWguaGFzT3duUHJvcGVydHkoYSk/aFthXTpudWxsO2lmKCFjKXRocm93IENhKFwiaWNvbnRleHRcIixhLGIpO2lmKG51bGw9PT1ifHxiPT09dHx8XCJcIj09PWIpcmV0dXJuIGI7aWYoXCJzdHJpbmdcIiE9PXR5cGVvZiBiKXRocm93IENhKFwiaXR5cGVcIixhKTtyZXR1cm4gbmV3IGMoYil9LGdldFRydXN0ZWQ6ZnVuY3Rpb24oYyxlKXtpZihudWxsPT09ZXx8ZT09PXR8fFwiXCI9PT1lKXJldHVybiBlO3ZhciBnPWguaGFzT3duUHJvcGVydHkoYyk/aFtjXTpudWxsO2lmKGcmJmUgaW5zdGFuY2VvZlxyXG5nKXJldHVybiBlLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk7aWYoYz09PW5hLlJFU09VUkNFX1VSTCl7dmFyIGc9QmEoZS50b1N0cmluZygpKSxwLHEsdT0hMTtwPTA7Zm9yKHE9Yi5sZW5ndGg7cDxxO3ArKylpZihkKGJbcF0sZykpe3U9ITA7YnJlYWt9aWYodSlmb3IocD0wLHE9YS5sZW5ndGg7cDxxO3ArKylpZihkKGFbcF0sZykpe3U9ITE7YnJlYWt9aWYodSlyZXR1cm4gZTt0aHJvdyBDYShcImluc2VjdXJsXCIsZS50b1N0cmluZygpKTt9aWYoYz09PW5hLkhUTUwpcmV0dXJuIGYoZSk7dGhyb3cgQ2EoXCJ1bnNhZmVcIik7fSx2YWx1ZU9mOmZ1bmN0aW9uKGEpe3JldHVybiBhIGluc3RhbmNlb2YgZz9hLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk6YX19fV19ZnVuY3Rpb24gU2UoKXt2YXIgYj0hMDt0aGlzLmVuYWJsZWQ9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9ISFhKTtyZXR1cm4gYn07dGhpcy4kZ2V0PVtcIiRwYXJzZVwiLFwiJHNjZURlbGVnYXRlXCIsZnVuY3Rpb24oYSxjKXtpZihiJiZcclxuOD5SYSl0aHJvdyBDYShcImllcXVpcmtzXCIpO3ZhciBkPXJhKG5hKTtkLmlzRW5hYmxlZD1mdW5jdGlvbigpe3JldHVybiBifTtkLnRydXN0QXM9Yy50cnVzdEFzO2QuZ2V0VHJ1c3RlZD1jLmdldFRydXN0ZWQ7ZC52YWx1ZU9mPWMudmFsdWVPZjtifHwoZC50cnVzdEFzPWQuZ2V0VHJ1c3RlZD1mdW5jdGlvbihhLGIpe3JldHVybiBifSxkLnZhbHVlT2Y9cGEpO2QucGFyc2VBcz1mdW5jdGlvbihiLGMpe3ZhciBlPWEoYyk7cmV0dXJuIGUubGl0ZXJhbCYmZS5jb25zdGFudD9lOmEoYyxmdW5jdGlvbihhKXtyZXR1cm4gZC5nZXRUcnVzdGVkKGIsYSl9KX07dmFyIGU9ZC5wYXJzZUFzLGY9ZC5nZXRUcnVzdGVkLGc9ZC50cnVzdEFzO3MobmEsZnVuY3Rpb24oYSxiKXt2YXIgYz1RKGIpO2RbY2IoXCJwYXJzZV9hc19cIitjKV09ZnVuY3Rpb24oYil7cmV0dXJuIGUoYSxiKX07ZFtjYihcImdldF90cnVzdGVkX1wiK2MpXT1mdW5jdGlvbihiKXtyZXR1cm4gZihhLGIpfTtkW2NiKFwidHJ1c3RfYXNfXCIrXHJcbmMpXT1mdW5jdGlvbihiKXtyZXR1cm4gZyhhLGIpfX0pO3JldHVybiBkfV19ZnVuY3Rpb24gVWUoKXt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oYixhKXt2YXIgYz17fSxkPWJhKCgvYW5kcm9pZCAoXFxkKykvLmV4ZWMoUSgoYi5uYXZpZ2F0b3J8fHt9KS51c2VyQWdlbnQpKXx8W10pWzFdKSxlPS9Cb3hlZS9pLnRlc3QoKGIubmF2aWdhdG9yfHx7fSkudXNlckFnZW50KSxmPWFbMF18fHt9LGcsaD0vXihNb3p8d2Via2l0fG1zKSg/PVtBLVpdKS8sbD1mLmJvZHkmJmYuYm9keS5zdHlsZSxrPSExLG09ITE7aWYobCl7Zm9yKHZhciBwIGluIGwpaWYoaz1oLmV4ZWMocCkpe2c9a1swXTtnPWcuc3Vic3RyKDAsMSkudG9VcHBlckNhc2UoKStnLnN1YnN0cigxKTticmVha31nfHwoZz1cIldlYmtpdE9wYWNpdHlcImluIGwmJlwid2Via2l0XCIpO2s9ISEoXCJ0cmFuc2l0aW9uXCJpbiBsfHxnK1wiVHJhbnNpdGlvblwiaW4gbCk7bT0hIShcImFuaW1hdGlvblwiaW4gbHx8ZytcIkFuaW1hdGlvblwiaW5cclxubCk7IWR8fGsmJm18fChrPUYoZi5ib2R5LnN0eWxlLndlYmtpdFRyYW5zaXRpb24pLG09RihmLmJvZHkuc3R5bGUud2Via2l0QW5pbWF0aW9uKSl9cmV0dXJue2hpc3Rvcnk6ISghYi5oaXN0b3J5fHwhYi5oaXN0b3J5LnB1c2hTdGF0ZXx8ND5kfHxlKSxoYXNFdmVudDpmdW5jdGlvbihhKXtpZihcImlucHV0XCI9PT1hJiYxMT49UmEpcmV0dXJuITE7aWYoQShjW2FdKSl7dmFyIGI9Zi5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2NbYV09XCJvblwiK2EgaW4gYn1yZXR1cm4gY1thXX0sY3NwOmFiKCksdmVuZG9yUHJlZml4OmcsdHJhbnNpdGlvbnM6ayxhbmltYXRpb25zOm0sYW5kcm9pZDpkfX1dfWZ1bmN0aW9uIFdlKCl7dGhpcy4kZ2V0PVtcIiR0ZW1wbGF0ZUNhY2hlXCIsXCIkaHR0cFwiLFwiJHFcIixmdW5jdGlvbihiLGEsYyl7ZnVuY3Rpb24gZChlLGYpe2QudG90YWxQZW5kaW5nUmVxdWVzdHMrKzt2YXIgZz1hLmRlZmF1bHRzJiZhLmRlZmF1bHRzLnRyYW5zZm9ybVJlc3BvbnNlO0QoZyk/Zz1nLmZpbHRlcihmdW5jdGlvbihhKXtyZXR1cm4gYSE9PVxyXG5ZYn0pOmc9PT1ZYiYmKGc9bnVsbCk7cmV0dXJuIGEuZ2V0KGUse2NhY2hlOmIsdHJhbnNmb3JtUmVzcG9uc2U6Z30pLnRoZW4oZnVuY3Rpb24oYSl7ZC50b3RhbFBlbmRpbmdSZXF1ZXN0cy0tO3JldHVybiBhLmRhdGF9LGZ1bmN0aW9uKGEpe2QudG90YWxQZW5kaW5nUmVxdWVzdHMtLTtpZighZil0aHJvdyBqYShcInRwbG9hZFwiLGUpO3JldHVybiBjLnJlamVjdChhKX0pfWQudG90YWxQZW5kaW5nUmVxdWVzdHM9MDtyZXR1cm4gZH1dfWZ1bmN0aW9uIFhlKCl7dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiRicm93c2VyXCIsXCIkbG9jYXRpb25cIixmdW5jdGlvbihiLGEsYyl7cmV0dXJue2ZpbmRCaW5kaW5nczpmdW5jdGlvbihhLGIsYyl7YT1hLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJuZy1iaW5kaW5nXCIpO3ZhciBnPVtdO3MoYSxmdW5jdGlvbihhKXt2YXIgZD1nYS5lbGVtZW50KGEpLmRhdGEoXCIkYmluZGluZ1wiKTtkJiZzKGQsZnVuY3Rpb24oZCl7Yz8obmV3IFJlZ0V4cChcIihefFxcXFxzKVwiK1xyXG5nZChiKStcIihcXFxcc3xcXFxcfHwkKVwiKSkudGVzdChkKSYmZy5wdXNoKGEpOi0xIT1kLmluZGV4T2YoYikmJmcucHVzaChhKX0pfSk7cmV0dXJuIGd9LGZpbmRNb2RlbHM6ZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZz1bXCJuZy1cIixcImRhdGEtbmctXCIsXCJuZ1xcXFw6XCJdLGg9MDtoPGcubGVuZ3RoOysraCl7dmFyIGw9YS5xdWVyeVNlbGVjdG9yQWxsKFwiW1wiK2dbaF0rXCJtb2RlbFwiKyhjP1wiPVwiOlwiKj1cIikrJ1wiJytiKydcIl0nKTtpZihsLmxlbmd0aClyZXR1cm4gbH19LGdldExvY2F0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGMudXJsKCl9LHNldExvY2F0aW9uOmZ1bmN0aW9uKGEpe2EhPT1jLnVybCgpJiYoYy51cmwoYSksYi4kZGlnZXN0KCkpfSx3aGVuU3RhYmxlOmZ1bmN0aW9uKGIpe2Eubm90aWZ5V2hlbk5vT3V0c3RhbmRpbmdSZXF1ZXN0cyhiKX19fV19ZnVuY3Rpb24gWWUoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJGJyb3dzZXJcIixcIiRxXCIsXCIkJHFcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXHJcbmZ1bmN0aW9uKGIsYSxjLGQsZSl7ZnVuY3Rpb24gZihmLGwsayl7dmFyIG09eShrKSYmIWsscD0obT9kOmMpLmRlZmVyKCkscT1wLnByb21pc2U7bD1hLmRlZmVyKGZ1bmN0aW9uKCl7dHJ5e3AucmVzb2x2ZShmKCkpfWNhdGNoKGEpe3AucmVqZWN0KGEpLGUoYSl9ZmluYWxseXtkZWxldGUgZ1txLiQkdGltZW91dElkXX1tfHxiLiRhcHBseSgpfSxsKTtxLiQkdGltZW91dElkPWw7Z1tsXT1wO3JldHVybiBxfXZhciBnPXt9O2YuY2FuY2VsPWZ1bmN0aW9uKGIpe3JldHVybiBiJiZiLiQkdGltZW91dElkIGluIGc/KGdbYi4kJHRpbWVvdXRJZF0ucmVqZWN0KFwiY2FuY2VsZWRcIiksZGVsZXRlIGdbYi4kJHRpbWVvdXRJZF0sYS5kZWZlci5jYW5jZWwoYi4kJHRpbWVvdXRJZCkpOiExfTtyZXR1cm4gZn1dfWZ1bmN0aW9uIEJhKGIpe1JhJiYoWi5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsYiksYj1aLmhyZWYpO1ouc2V0QXR0cmlidXRlKFwiaHJlZlwiLGIpO3JldHVybntocmVmOlouaHJlZixwcm90b2NvbDpaLnByb3RvY29sP1xyXG5aLnByb3RvY29sLnJlcGxhY2UoLzokLyxcIlwiKTpcIlwiLGhvc3Q6Wi5ob3N0LHNlYXJjaDpaLnNlYXJjaD9aLnNlYXJjaC5yZXBsYWNlKC9eXFw/LyxcIlwiKTpcIlwiLGhhc2g6Wi5oYXNoP1ouaGFzaC5yZXBsYWNlKC9eIy8sXCJcIik6XCJcIixob3N0bmFtZTpaLmhvc3RuYW1lLHBvcnQ6Wi5wb3J0LHBhdGhuYW1lOlwiL1wiPT09Wi5wYXRobmFtZS5jaGFyQXQoMCk/Wi5wYXRobmFtZTpcIi9cIitaLnBhdGhuYW1lfX1mdW5jdGlvbiBaYyhiKXtiPUYoYik/QmEoYik6YjtyZXR1cm4gYi5wcm90b2NvbD09PWlkLnByb3RvY29sJiZiLmhvc3Q9PT1pZC5ob3N0fWZ1bmN0aW9uIFplKCl7dGhpcy4kZ2V0PWRhKE0pfWZ1bmN0aW9uIERjKGIpe2Z1bmN0aW9uIGEoYyxkKXtpZihJKGMpKXt2YXIgZT17fTtzKGMsZnVuY3Rpb24oYixjKXtlW2NdPWEoYyxiKX0pO3JldHVybiBlfXJldHVybiBiLmZhY3RvcnkoYytcIkZpbHRlclwiLGQpfXRoaXMucmVnaXN0ZXI9YTt0aGlzLiRnZXQ9W1wiJGluamVjdG9yXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBhLmdldChiK1xyXG5cIkZpbHRlclwiKX19XTthKFwiY3VycmVuY3lcIixqZCk7YShcImRhdGVcIixrZCk7YShcImZpbHRlclwiLEVmKTthKFwianNvblwiLEZmKTthKFwibGltaXRUb1wiLEdmKTthKFwibG93ZXJjYXNlXCIsSGYpO2EoXCJudW1iZXJcIixsZCk7YShcIm9yZGVyQnlcIixtZCk7YShcInVwcGVyY2FzZVwiLElmKX1mdW5jdGlvbiBFZigpe3JldHVybiBmdW5jdGlvbihiLGEsYyl7aWYoIUQoYikpcmV0dXJuIGI7dmFyIGQ7c3dpdGNoKHR5cGVvZiBhKXtjYXNlIFwiZnVuY3Rpb25cIjpicmVhaztjYXNlIFwiYm9vbGVhblwiOmNhc2UgXCJudW1iZXJcIjpjYXNlIFwic3RyaW5nXCI6ZD0hMDtjYXNlIFwib2JqZWN0XCI6YT1KZihhLGMsZCk7YnJlYWs7ZGVmYXVsdDpyZXR1cm4gYn1yZXR1cm4gYi5maWx0ZXIoYSl9fWZ1bmN0aW9uIEpmKGIsYSxjKXt2YXIgZD1JKGIpJiZcIiRcImluIGI7ITA9PT1hP2E9ZmE6RyhhKXx8KGE9ZnVuY3Rpb24oYSxiKXtpZihJKGEpfHxJKGIpKXJldHVybiExO2E9UShcIlwiK2EpO2I9UShcIlwiK2IpO3JldHVybi0xIT09YS5pbmRleE9mKGIpfSk7XHJcbnJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZCYmIUkoZSk/SWEoZSxiLiQsYSwhMSk6SWEoZSxiLGEsYyl9fWZ1bmN0aW9uIElhKGIsYSxjLGQsZSl7dmFyIGY9dHlwZW9mIGIsZz10eXBlb2YgYTtpZihcInN0cmluZ1wiPT09ZyYmXCIhXCI9PT1hLmNoYXJBdCgwKSlyZXR1cm4hSWEoYixhLnN1YnN0cmluZygxKSxjLGQpO2lmKEQoYikpcmV0dXJuIGIuc29tZShmdW5jdGlvbihiKXtyZXR1cm4gSWEoYixhLGMsZCl9KTtzd2l0Y2goZil7Y2FzZSBcIm9iamVjdFwiOnZhciBoO2lmKGQpe2ZvcihoIGluIGIpaWYoXCIkXCIhPT1oLmNoYXJBdCgwKSYmSWEoYltoXSxhLGMsITApKXJldHVybiEwO3JldHVybiBlPyExOklhKGIsYSxjLCExKX1pZihcIm9iamVjdFwiPT09Zyl7Zm9yKGggaW4gYSlpZihlPWFbaF0sIUcoZSkmJihmPVwiJFwiPT09aCwhSWEoZj9iOmJbaF0sZSxjLGYsZikpKXJldHVybiExO3JldHVybiEwfXJldHVybiBjKGIsYSk7Y2FzZSBcImZ1bmN0aW9uXCI6cmV0dXJuITE7ZGVmYXVsdDpyZXR1cm4gYyhiLFxyXG5hKX19ZnVuY3Rpb24gamQoYil7dmFyIGE9Yi5OVU1CRVJfRk9STUFUUztyZXR1cm4gZnVuY3Rpb24oYixkLGUpe0EoZCkmJihkPWEuQ1VSUkVOQ1lfU1lNKTtBKGUpJiYoZT1hLlBBVFRFUk5TWzFdLm1heEZyYWMpO3JldHVybiBudWxsPT1iP2I6bmQoYixhLlBBVFRFUk5TWzFdLGEuR1JPVVBfU0VQLGEuREVDSU1BTF9TRVAsZSkucmVwbGFjZSgvXFx1MDBBNC9nLGQpfX1mdW5jdGlvbiBsZChiKXt2YXIgYT1iLk5VTUJFUl9GT1JNQVRTO3JldHVybiBmdW5jdGlvbihiLGQpe3JldHVybiBudWxsPT1iP2I6bmQoYixhLlBBVFRFUk5TWzBdLGEuR1JPVVBfU0VQLGEuREVDSU1BTF9TRVAsZCl9fWZ1bmN0aW9uIG5kKGIsYSxjLGQsZSl7aWYoIWlzRmluaXRlKGIpfHxJKGIpKXJldHVyblwiXCI7dmFyIGY9MD5iO2I9TWF0aC5hYnMoYik7dmFyIGc9YitcIlwiLGg9XCJcIixsPVtdLGs9ITE7aWYoLTEhPT1nLmluZGV4T2YoXCJlXCIpKXt2YXIgbT1nLm1hdGNoKC8oW1xcZFxcLl0rKWUoLT8pKFxcZCspLyk7bSYmXHJcblwiLVwiPT1tWzJdJiZtWzNdPmUrMT9iPTA6KGg9ZyxrPSEwKX1pZihrKTA8ZSYmMT5iJiYoaD1iLnRvRml4ZWQoZSksYj1wYXJzZUZsb2F0KGgpKTtlbHNle2c9KGcuc3BsaXQob2QpWzFdfHxcIlwiKS5sZW5ndGg7QShlKSYmKGU9TWF0aC5taW4oTWF0aC5tYXgoYS5taW5GcmFjLGcpLGEubWF4RnJhYykpO2I9KyhNYXRoLnJvdW5kKCsoYi50b1N0cmluZygpK1wiZVwiK2UpKS50b1N0cmluZygpK1wiZVwiKy1lKTt2YXIgZz0oXCJcIitiKS5zcGxpdChvZCksaz1nWzBdLGc9Z1sxXXx8XCJcIixwPTAscT1hLmxnU2l6ZSx1PWEuZ1NpemU7aWYoay5sZW5ndGg+PXErdSlmb3IocD1rLmxlbmd0aC1xLG09MDttPHA7bSsrKTA9PT0ocC1tKSV1JiYwIT09bSYmKGgrPWMpLGgrPWsuY2hhckF0KG0pO2ZvcihtPXA7bTxrLmxlbmd0aDttKyspMD09PShrLmxlbmd0aC1tKSVxJiYwIT09bSYmKGgrPWMpLGgrPWsuY2hhckF0KG0pO2Zvcig7Zy5sZW5ndGg8ZTspZys9XCIwXCI7ZSYmXCIwXCIhPT1lJiYoaCs9ZCtnLnN1YnN0cigwLFxyXG5lKSl9MD09PWImJihmPSExKTtsLnB1c2goZj9hLm5lZ1ByZTphLnBvc1ByZSxoLGY/YS5uZWdTdWY6YS5wb3NTdWYpO3JldHVybiBsLmpvaW4oXCJcIil9ZnVuY3Rpb24gSGIoYixhLGMpe3ZhciBkPVwiXCI7MD5iJiYoZD1cIi1cIixiPS1iKTtmb3IoYj1cIlwiK2I7Yi5sZW5ndGg8YTspYj1cIjBcIitiO2MmJihiPWIuc3Vic3RyKGIubGVuZ3RoLWEpKTtyZXR1cm4gZCtifWZ1bmN0aW9uICQoYixhLGMsZCl7Yz1jfHwwO3JldHVybiBmdW5jdGlvbihlKXtlPWVbXCJnZXRcIitiXSgpO2lmKDA8Y3x8ZT4tYyllKz1jOzA9PT1lJiYtMTI9PWMmJihlPTEyKTtyZXR1cm4gSGIoZSxhLGQpfX1mdW5jdGlvbiBJYihiLGEpe3JldHVybiBmdW5jdGlvbihjLGQpe3ZhciBlPWNbXCJnZXRcIitiXSgpLGY9dWIoYT9cIlNIT1JUXCIrYjpiKTtyZXR1cm4gZFtmXVtlXX19ZnVuY3Rpb24gcGQoYil7dmFyIGE9KG5ldyBEYXRlKGIsMCwxKSkuZ2V0RGF5KCk7cmV0dXJuIG5ldyBEYXRlKGIsMCwoND49YT81OjEyKS1hKX1mdW5jdGlvbiBxZChiKXtyZXR1cm4gZnVuY3Rpb24oYSl7dmFyIGM9XHJcbnBkKGEuZ2V0RnVsbFllYXIoKSk7YT0rbmV3IERhdGUoYS5nZXRGdWxsWWVhcigpLGEuZ2V0TW9udGgoKSxhLmdldERhdGUoKSsoNC1hLmdldERheSgpKSktK2M7YT0xK01hdGgucm91bmQoYS82MDQ4RTUpO3JldHVybiBIYihhLGIpfX1mdW5jdGlvbiBrZChiKXtmdW5jdGlvbiBhKGEpe3ZhciBiO2lmKGI9YS5tYXRjaChjKSl7YT1uZXcgRGF0ZSgwKTt2YXIgZj0wLGc9MCxoPWJbOF0/YS5zZXRVVENGdWxsWWVhcjphLnNldEZ1bGxZZWFyLGw9Yls4XT9hLnNldFVUQ0hvdXJzOmEuc2V0SG91cnM7Yls5XSYmKGY9YmEoYls5XStiWzEwXSksZz1iYShiWzldK2JbMTFdKSk7aC5jYWxsKGEsYmEoYlsxXSksYmEoYlsyXSktMSxiYShiWzNdKSk7Zj1iYShiWzRdfHwwKS1mO2c9YmEoYls1XXx8MCktZztoPWJhKGJbNl18fDApO2I9TWF0aC5yb3VuZCgxRTMqcGFyc2VGbG9hdChcIjAuXCIrKGJbN118fDApKSk7bC5jYWxsKGEsZixnLGgsYil9cmV0dXJuIGF9dmFyIGM9L14oXFxkezR9KS0/KFxcZFxcZCktPyhcXGRcXGQpKD86VChcXGRcXGQpKD86Oj8oXFxkXFxkKSg/Ojo/KFxcZFxcZCkoPzpcXC4oXFxkKykpPyk/KT8oWnwoWystXSkoXFxkXFxkKTo/KFxcZFxcZCkpPyk/JC87XHJcbnJldHVybiBmdW5jdGlvbihjLGUsZil7dmFyIGc9XCJcIixoPVtdLGwsaztlPWV8fFwibWVkaXVtRGF0ZVwiO2U9Yi5EQVRFVElNRV9GT1JNQVRTW2VdfHxlO0YoYykmJihjPUtmLnRlc3QoYyk/YmEoYyk6YShjKSk7VihjKSYmKGM9bmV3IERhdGUoYykpO2lmKCFxYShjKSlyZXR1cm4gYztmb3IoO2U7KShrPUxmLmV4ZWMoZSkpPyhoPVlhKGgsaywxKSxlPWgucG9wKCkpOihoLnB1c2goZSksZT1udWxsKTtmJiZcIlVUQ1wiPT09ZiYmKGM9bmV3IERhdGUoYy5nZXRUaW1lKCkpLGMuc2V0TWludXRlcyhjLmdldE1pbnV0ZXMoKStjLmdldFRpbWV6b25lT2Zmc2V0KCkpKTtzKGgsZnVuY3Rpb24oYSl7bD1NZlthXTtnKz1sP2woYyxiLkRBVEVUSU1FX0ZPUk1BVFMpOmEucmVwbGFjZSgvKF4nfCckKS9nLFwiXCIpLnJlcGxhY2UoLycnL2csXCInXCIpfSk7cmV0dXJuIGd9fWZ1bmN0aW9uIEZmKCl7cmV0dXJuIGZ1bmN0aW9uKGIsYSl7QShhKSYmKGE9Mik7cmV0dXJuICRhKGIsYSl9fWZ1bmN0aW9uIEdmKCl7cmV0dXJuIGZ1bmN0aW9uKGIsXHJcbmEpe1YoYikmJihiPWIudG9TdHJpbmcoKSk7cmV0dXJuIEQoYil8fEYoYik/KGE9SW5maW5pdHk9PT1NYXRoLmFicyhOdW1iZXIoYSkpP051bWJlcihhKTpiYShhKSk/MDxhP2Iuc2xpY2UoMCxhKTpiLnNsaWNlKGEpOkYoYik/XCJcIjpbXTpifX1mdW5jdGlvbiBtZChiKXtyZXR1cm4gZnVuY3Rpb24oYSxjLGQpe2Z1bmN0aW9uIGUoYSxiKXtyZXR1cm4gYj9mdW5jdGlvbihiLGMpe3JldHVybiBhKGMsYil9OmF9ZnVuY3Rpb24gZihhKXtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJudW1iZXJcIjpjYXNlIFwiYm9vbGVhblwiOmNhc2UgXCJzdHJpbmdcIjpyZXR1cm4hMDtkZWZhdWx0OnJldHVybiExfX1mdW5jdGlvbiBnKGEpe3JldHVybiBudWxsPT09YT9cIm51bGxcIjpcImZ1bmN0aW9uXCI9PT10eXBlb2YgYS52YWx1ZU9mJiYoYT1hLnZhbHVlT2YoKSxmKGEpKXx8XCJmdW5jdGlvblwiPT09dHlwZW9mIGEudG9TdHJpbmcmJihhPWEudG9TdHJpbmcoKSxmKGEpKT9hOlwiXCJ9ZnVuY3Rpb24gaChhLGIpe3ZhciBjPVxyXG50eXBlb2YgYSxkPXR5cGVvZiBiO2M9PT1kJiZcIm9iamVjdFwiPT09YyYmKGE9ZyhhKSxiPWcoYikpO3JldHVybiBjPT09ZD8oXCJzdHJpbmdcIj09PWMmJihhPWEudG9Mb3dlckNhc2UoKSxiPWIudG9Mb3dlckNhc2UoKSksYT09PWI/MDphPGI/LTE6MSk6YzxkPy0xOjF9aWYoIVRhKGEpKXJldHVybiBhO2M9RChjKT9jOltjXTswPT09Yy5sZW5ndGgmJihjPVtcIitcIl0pO2M9Yy5tYXAoZnVuY3Rpb24oYSl7dmFyIGM9ITEsZD1hfHxwYTtpZihGKGEpKXtpZihcIitcIj09YS5jaGFyQXQoMCl8fFwiLVwiPT1hLmNoYXJBdCgwKSljPVwiLVwiPT1hLmNoYXJBdCgwKSxhPWEuc3Vic3RyaW5nKDEpO2lmKFwiXCI9PT1hKXJldHVybiBlKGgsYyk7ZD1iKGEpO2lmKGQuY29uc3RhbnQpe3ZhciBmPWQoKTtyZXR1cm4gZShmdW5jdGlvbihhLGIpe3JldHVybiBoKGFbZl0sYltmXSl9LGMpfX1yZXR1cm4gZShmdW5jdGlvbihhLGIpe3JldHVybiBoKGQoYSksZChiKSl9LGMpfSk7cmV0dXJuIFphLmNhbGwoYSkuc29ydChlKGZ1bmN0aW9uKGEsXHJcbmIpe2Zvcih2YXIgZD0wO2Q8Yy5sZW5ndGg7ZCsrKXt2YXIgZT1jW2RdKGEsYik7aWYoMCE9PWUpcmV0dXJuIGV9cmV0dXJuIDB9LGQpKX19ZnVuY3Rpb24gSmEoYil7RyhiKSYmKGI9e2xpbms6Yn0pO2IucmVzdHJpY3Q9Yi5yZXN0cmljdHx8XCJBQ1wiO3JldHVybiBkYShiKX1mdW5jdGlvbiByZChiLGEsYyxkLGUpe3ZhciBmPXRoaXMsZz1bXSxoPWYuJCRwYXJlbnRGb3JtPWIucGFyZW50KCkuY29udHJvbGxlcihcImZvcm1cIil8fEpiO2YuJGVycm9yPXt9O2YuJCRzdWNjZXNzPXt9O2YuJHBlbmRpbmc9dDtmLiRuYW1lPWUoYS5uYW1lfHxhLm5nRm9ybXx8XCJcIikoYyk7Zi4kZGlydHk9ITE7Zi4kcHJpc3RpbmU9ITA7Zi4kdmFsaWQ9ITA7Zi4kaW52YWxpZD0hMTtmLiRzdWJtaXR0ZWQ9ITE7aC4kYWRkQ29udHJvbChmKTtmLiRyb2xsYmFja1ZpZXdWYWx1ZT1mdW5jdGlvbigpe3MoZyxmdW5jdGlvbihhKXthLiRyb2xsYmFja1ZpZXdWYWx1ZSgpfSl9O2YuJGNvbW1pdFZpZXdWYWx1ZT1mdW5jdGlvbigpe3MoZyxcclxuZnVuY3Rpb24oYSl7YS4kY29tbWl0Vmlld1ZhbHVlKCl9KX07Zi4kYWRkQ29udHJvbD1mdW5jdGlvbihhKXtNYShhLiRuYW1lLFwiaW5wdXRcIik7Zy5wdXNoKGEpO2EuJG5hbWUmJihmW2EuJG5hbWVdPWEpfTtmLiQkcmVuYW1lQ29udHJvbD1mdW5jdGlvbihhLGIpe3ZhciBjPWEuJG5hbWU7ZltjXT09PWEmJmRlbGV0ZSBmW2NdO2ZbYl09YTthLiRuYW1lPWJ9O2YuJHJlbW92ZUNvbnRyb2w9ZnVuY3Rpb24oYSl7YS4kbmFtZSYmZlthLiRuYW1lXT09PWEmJmRlbGV0ZSBmW2EuJG5hbWVdO3MoZi4kcGVuZGluZyxmdW5jdGlvbihiLGMpe2YuJHNldFZhbGlkaXR5KGMsbnVsbCxhKX0pO3MoZi4kZXJyb3IsZnVuY3Rpb24oYixjKXtmLiRzZXRWYWxpZGl0eShjLG51bGwsYSl9KTtYYShnLGEpfTtzZCh7Y3RybDp0aGlzLCRlbGVtZW50OmIsc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hW2JdO2Q/LTE9PT1kLmluZGV4T2YoYykmJmQucHVzaChjKTphW2JdPVtjXX0sdW5zZXQ6ZnVuY3Rpb24oYSxcclxuYixjKXt2YXIgZD1hW2JdO2QmJihYYShkLGMpLDA9PT1kLmxlbmd0aCYmZGVsZXRlIGFbYl0pfSxwYXJlbnRGb3JtOmgsJGFuaW1hdGU6ZH0pO2YuJHNldERpcnR5PWZ1bmN0aW9uKCl7ZC5yZW1vdmVDbGFzcyhiLFNhKTtkLmFkZENsYXNzKGIsS2IpO2YuJGRpcnR5PSEwO2YuJHByaXN0aW5lPSExO2guJHNldERpcnR5KCl9O2YuJHNldFByaXN0aW5lPWZ1bmN0aW9uKCl7ZC5zZXRDbGFzcyhiLFNhLEtiK1wiIG5nLXN1Ym1pdHRlZFwiKTtmLiRkaXJ0eT0hMTtmLiRwcmlzdGluZT0hMDtmLiRzdWJtaXR0ZWQ9ITE7cyhnLGZ1bmN0aW9uKGEpe2EuJHNldFByaXN0aW5lKCl9KX07Zi4kc2V0VW50b3VjaGVkPWZ1bmN0aW9uKCl7cyhnLGZ1bmN0aW9uKGEpe2EuJHNldFVudG91Y2hlZCgpfSl9O2YuJHNldFN1Ym1pdHRlZD1mdW5jdGlvbigpe2QuYWRkQ2xhc3MoYixcIm5nLXN1Ym1pdHRlZFwiKTtmLiRzdWJtaXR0ZWQ9ITA7aC4kc2V0U3VibWl0dGVkKCl9fWZ1bmN0aW9uIGhjKGIpe2IuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gYi4kaXNFbXB0eShhKT9cclxuYTphLnRvU3RyaW5nKCl9KX1mdW5jdGlvbiBpYihiLGEsYyxkLGUsZil7dmFyIGc9UShhWzBdLnR5cGUpO2lmKCFlLmFuZHJvaWQpe3ZhciBoPSExO2Eub24oXCJjb21wb3NpdGlvbnN0YXJ0XCIsZnVuY3Rpb24oYSl7aD0hMH0pO2Eub24oXCJjb21wb3NpdGlvbmVuZFwiLGZ1bmN0aW9uKCl7aD0hMTtsKCl9KX12YXIgbD1mdW5jdGlvbihiKXtrJiYoZi5kZWZlci5jYW5jZWwoayksaz1udWxsKTtpZighaCl7dmFyIGU9YS52YWwoKTtiPWImJmIudHlwZTtcInBhc3N3b3JkXCI9PT1nfHxjLm5nVHJpbSYmXCJmYWxzZVwiPT09Yy5uZ1RyaW18fChlPVUoZSkpOyhkLiR2aWV3VmFsdWUhPT1lfHxcIlwiPT09ZSYmZC4kJGhhc05hdGl2ZVZhbGlkYXRvcnMpJiZkLiRzZXRWaWV3VmFsdWUoZSxiKX19O2lmKGUuaGFzRXZlbnQoXCJpbnB1dFwiKSlhLm9uKFwiaW5wdXRcIixsKTtlbHNle3ZhciBrLG09ZnVuY3Rpb24oYSxiLGMpe2t8fChrPWYuZGVmZXIoZnVuY3Rpb24oKXtrPW51bGw7YiYmYi52YWx1ZT09PWN8fGwoYSl9KSl9O1xyXG5hLm9uKFwia2V5ZG93blwiLGZ1bmN0aW9uKGEpe3ZhciBiPWEua2V5Q29kZTs5MT09PWJ8fDE1PGImJjE5PmJ8fDM3PD1iJiY0MD49Ynx8bShhLHRoaXMsdGhpcy52YWx1ZSl9KTtpZihlLmhhc0V2ZW50KFwicGFzdGVcIikpYS5vbihcInBhc3RlIGN1dFwiLG0pfWEub24oXCJjaGFuZ2VcIixsKTtkLiRyZW5kZXI9ZnVuY3Rpb24oKXthLnZhbChkLiRpc0VtcHR5KGQuJHZpZXdWYWx1ZSk/XCJcIjpkLiR2aWV3VmFsdWUpfX1mdW5jdGlvbiBMYihiLGEpe3JldHVybiBmdW5jdGlvbihjLGQpe3ZhciBlLGY7aWYocWEoYykpcmV0dXJuIGM7aWYoRihjKSl7J1wiJz09Yy5jaGFyQXQoMCkmJidcIic9PWMuY2hhckF0KGMubGVuZ3RoLTEpJiYoYz1jLnN1YnN0cmluZygxLGMubGVuZ3RoLTEpKTtpZihOZi50ZXN0KGMpKXJldHVybiBuZXcgRGF0ZShjKTtiLmxhc3RJbmRleD0wO2lmKGU9Yi5leGVjKGMpKXJldHVybiBlLnNoaWZ0KCksZj1kP3t5eXl5OmQuZ2V0RnVsbFllYXIoKSxNTTpkLmdldE1vbnRoKCkrMSxcclxuZGQ6ZC5nZXREYXRlKCksSEg6ZC5nZXRIb3VycygpLG1tOmQuZ2V0TWludXRlcygpLHNzOmQuZ2V0U2Vjb25kcygpLHNzczpkLmdldE1pbGxpc2Vjb25kcygpLzFFM306e3l5eXk6MTk3MCxNTToxLGRkOjEsSEg6MCxtbTowLHNzOjAsc3NzOjB9LHMoZSxmdW5jdGlvbihiLGMpe2M8YS5sZW5ndGgmJihmW2FbY11dPStiKX0pLG5ldyBEYXRlKGYueXl5eSxmLk1NLTEsZi5kZCxmLkhILGYubW0sZi5zc3x8MCwxRTMqZi5zc3N8fDApfXJldHVybiBOYU59fWZ1bmN0aW9uIGpiKGIsYSxjLGQpe3JldHVybiBmdW5jdGlvbihlLGYsZyxoLGwsayxtKXtmdW5jdGlvbiBwKGEpe3JldHVybiBhJiYhKGEuZ2V0VGltZSYmYS5nZXRUaW1lKCkhPT1hLmdldFRpbWUoKSl9ZnVuY3Rpb24gcShhKXtyZXR1cm4geShhKT9xYShhKT9hOmMoYSk6dH10ZChlLGYsZyxoKTtpYihlLGYsZyxoLGwsayk7dmFyIHU9aCYmaC4kb3B0aW9ucyYmaC4kb3B0aW9ucy50aW1lem9uZSxyO2guJCRwYXJzZXJOYW1lPWI7XHJcbmguJHBhcnNlcnMucHVzaChmdW5jdGlvbihiKXtyZXR1cm4gaC4kaXNFbXB0eShiKT9udWxsOmEudGVzdChiKT8oYj1jKGIsciksXCJVVENcIj09PXUmJmIuc2V0TWludXRlcyhiLmdldE1pbnV0ZXMoKS1iLmdldFRpbWV6b25lT2Zmc2V0KCkpLGIpOnR9KTtoLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7aWYoYSYmIXFhKGEpKXRocm93IE1iKFwiZGF0ZWZtdFwiLGEpO2lmKHAoYSkpe2lmKChyPWEpJiZcIlVUQ1wiPT09dSl7dmFyIGI9NkU0KnIuZ2V0VGltZXpvbmVPZmZzZXQoKTtyPW5ldyBEYXRlKHIuZ2V0VGltZSgpK2IpfXJldHVybiBtKFwiZGF0ZVwiKShhLGQsdSl9cj1udWxsO3JldHVyblwiXCJ9KTtpZih5KGcubWluKXx8Zy5uZ01pbil7dmFyIHM7aC4kdmFsaWRhdG9ycy5taW49ZnVuY3Rpb24oYSl7cmV0dXJuIXAoYSl8fEEocyl8fGMoYSk+PXN9O2cuJG9ic2VydmUoXCJtaW5cIixmdW5jdGlvbihhKXtzPXEoYSk7aC4kdmFsaWRhdGUoKX0pfWlmKHkoZy5tYXgpfHxnLm5nTWF4KXt2YXIgbjtcclxuaC4kdmFsaWRhdG9ycy5tYXg9ZnVuY3Rpb24oYSl7cmV0dXJuIXAoYSl8fEEobil8fGMoYSk8PW59O2cuJG9ic2VydmUoXCJtYXhcIixmdW5jdGlvbihhKXtuPXEoYSk7aC4kdmFsaWRhdGUoKX0pfX19ZnVuY3Rpb24gdGQoYixhLGMsZCl7KGQuJCRoYXNOYXRpdmVWYWxpZGF0b3JzPUkoYVswXS52YWxpZGl0eSkpJiZkLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYil7dmFyIGM9YS5wcm9wKFwidmFsaWRpdHlcIil8fHt9O3JldHVybiBjLmJhZElucHV0JiYhYy50eXBlTWlzbWF0Y2g/dDpifSl9ZnVuY3Rpb24gdWQoYixhLGMsZCxlKXtpZih5KGQpKXtiPWIoZCk7aWYoIWIuY29uc3RhbnQpdGhyb3cgVChcIm5nTW9kZWxcIikoXCJjb25zdGV4cHJcIixjLGQpO3JldHVybiBiKGEpfXJldHVybiBlfWZ1bmN0aW9uIGljKGIsYSl7Yj1cIm5nQ2xhc3NcIitiO3JldHVybltcIiRhbmltYXRlXCIsZnVuY3Rpb24oYyl7ZnVuY3Rpb24gZChhLGIpe3ZhciBjPVtdLGQ9MDthOmZvcig7ZDxhLmxlbmd0aDtkKyspe2Zvcih2YXIgZT1cclxuYVtkXSxtPTA7bTxiLmxlbmd0aDttKyspaWYoZT09YlttXSljb250aW51ZSBhO2MucHVzaChlKX1yZXR1cm4gY31mdW5jdGlvbiBlKGEpe2lmKCFEKGEpKXtpZihGKGEpKXJldHVybiBhLnNwbGl0KFwiIFwiKTtpZihJKGEpKXt2YXIgYj1bXTtzKGEsZnVuY3Rpb24oYSxjKXthJiYoYj1iLmNvbmNhdChjLnNwbGl0KFwiIFwiKSkpfSk7cmV0dXJuIGJ9fXJldHVybiBhfXJldHVybntyZXN0cmljdDpcIkFDXCIsbGluazpmdW5jdGlvbihmLGcsaCl7ZnVuY3Rpb24gbChhLGIpe3ZhciBjPWcuZGF0YShcIiRjbGFzc0NvdW50c1wiKXx8e30sZD1bXTtzKGEsZnVuY3Rpb24oYSl7aWYoMDxifHxjW2FdKWNbYV09KGNbYV18fDApK2IsY1thXT09PSsoMDxiKSYmZC5wdXNoKGEpfSk7Zy5kYXRhKFwiJGNsYXNzQ291bnRzXCIsYyk7cmV0dXJuIGQuam9pbihcIiBcIil9ZnVuY3Rpb24gayhiKXtpZighMD09PWF8fGYuJGluZGV4JTI9PT1hKXt2YXIgaz1lKGJ8fFtdKTtpZighbSl7dmFyIHU9bChrLDEpO2guJGFkZENsYXNzKHUpfWVsc2UgaWYoIWZhKGIsXHJcbm0pKXt2YXIgcj1lKG0pLHU9ZChrLHIpLGs9ZChyLGspLHU9bCh1LDEpLGs9bChrLC0xKTt1JiZ1Lmxlbmd0aCYmYy5hZGRDbGFzcyhnLHUpO2smJmsubGVuZ3RoJiZjLnJlbW92ZUNsYXNzKGcsayl9fW09cmEoYil9dmFyIG07Zi4kd2F0Y2goaFtiXSxrLCEwKTtoLiRvYnNlcnZlKFwiY2xhc3NcIixmdW5jdGlvbihhKXtrKGYuJGV2YWwoaFtiXSkpfSk7XCJuZ0NsYXNzXCIhPT1iJiZmLiR3YXRjaChcIiRpbmRleFwiLGZ1bmN0aW9uKGMsZCl7dmFyIGc9YyYxO2lmKGchPT0oZCYxKSl7dmFyIGs9ZShmLiRldmFsKGhbYl0pKTtnPT09YT8oZz1sKGssMSksaC4kYWRkQ2xhc3MoZykpOihnPWwoaywtMSksaC4kcmVtb3ZlQ2xhc3MoZykpfX0pfX19XX1mdW5jdGlvbiBzZChiKXtmdW5jdGlvbiBhKGEsYil7YiYmIWZbYV0/KGsuYWRkQ2xhc3MoZSxhKSxmW2FdPSEwKTohYiYmZlthXSYmKGsucmVtb3ZlQ2xhc3MoZSxhKSxmW2FdPSExKX1mdW5jdGlvbiBjKGIsYyl7Yj1iP1wiLVwiK3RjKGIsXCItXCIpOlwiXCI7XHJcbmEoa2IrYiwhMD09PWMpO2EodmQrYiwhMT09PWMpfXZhciBkPWIuY3RybCxlPWIuJGVsZW1lbnQsZj17fSxnPWIuc2V0LGg9Yi51bnNldCxsPWIucGFyZW50Rm9ybSxrPWIuJGFuaW1hdGU7Zlt2ZF09IShmW2tiXT1lLmhhc0NsYXNzKGtiKSk7ZC4kc2V0VmFsaWRpdHk9ZnVuY3Rpb24oYixlLGYpe2U9PT10PyhkLiRwZW5kaW5nfHwoZC4kcGVuZGluZz17fSksZyhkLiRwZW5kaW5nLGIsZikpOihkLiRwZW5kaW5nJiZoKGQuJHBlbmRpbmcsYixmKSx3ZChkLiRwZW5kaW5nKSYmKGQuJHBlbmRpbmc9dCkpO1dhKGUpP2U/KGgoZC4kZXJyb3IsYixmKSxnKGQuJCRzdWNjZXNzLGIsZikpOihnKGQuJGVycm9yLGIsZiksaChkLiQkc3VjY2VzcyxiLGYpKTooaChkLiRlcnJvcixiLGYpLGgoZC4kJHN1Y2Nlc3MsYixmKSk7ZC4kcGVuZGluZz8oYSh4ZCwhMCksZC4kdmFsaWQ9ZC4kaW52YWxpZD10LGMoXCJcIixudWxsKSk6KGEoeGQsITEpLGQuJHZhbGlkPXdkKGQuJGVycm9yKSxkLiRpbnZhbGlkPVxyXG4hZC4kdmFsaWQsYyhcIlwiLGQuJHZhbGlkKSk7ZT1kLiRwZW5kaW5nJiZkLiRwZW5kaW5nW2JdP3Q6ZC4kZXJyb3JbYl0/ITE6ZC4kJHN1Y2Nlc3NbYl0/ITA6bnVsbDtjKGIsZSk7bC4kc2V0VmFsaWRpdHkoYixlLGQpfX1mdW5jdGlvbiB3ZChiKXtpZihiKWZvcih2YXIgYSBpbiBiKXJldHVybiExO3JldHVybiEwfXZhciBPZj0vXlxcLyguKylcXC8oW2Etel0qKSQvLFE9ZnVuY3Rpb24oYil7cmV0dXJuIEYoYik/Yi50b0xvd2VyQ2FzZSgpOmJ9LHJjPU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksdWI9ZnVuY3Rpb24oYil7cmV0dXJuIEYoYik/Yi50b1VwcGVyQ2FzZSgpOmJ9LFJhLEIsc2EsWmE9W10uc2xpY2UscmY9W10uc3BsaWNlLFBmPVtdLnB1c2gsRGE9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxLYT1UKFwibmdcIiksZ2E9TS5hbmd1bGFyfHwoTS5hbmd1bGFyPXt9KSxiYixuYj0wO1JhPVkuZG9jdW1lbnRNb2RlO0guJGluamVjdD1bXTtwYS4kaW5qZWN0PVtdO3ZhciBEPVxyXG5BcnJheS5pc0FycmF5LFU9ZnVuY3Rpb24oYil7cmV0dXJuIEYoYik/Yi50cmltKCk6Yn0sZ2Q9ZnVuY3Rpb24oYil7cmV0dXJuIGIucmVwbGFjZSgvKFstKClcXFtcXF17fSs/Ki4kXFxefCw6IzwhXFxcXF0pL2csXCJcXFxcJDFcIikucmVwbGFjZSgvXFx4MDgvZyxcIlxcXFx4MDhcIil9LGFiPWZ1bmN0aW9uKCl7aWYoeShhYi5pc0FjdGl2ZV8pKXJldHVybiBhYi5pc0FjdGl2ZV87dmFyIGI9ISghWS5xdWVyeVNlbGVjdG9yKFwiW25nLWNzcF1cIikmJiFZLnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS1uZy1jc3BdXCIpKTtpZighYil0cnl7bmV3IEZ1bmN0aW9uKFwiXCIpfWNhdGNoKGEpe2I9ITB9cmV0dXJuIGFiLmlzQWN0aXZlXz1ifSxyYj1bXCJuZy1cIixcImRhdGEtbmctXCIsXCJuZzpcIixcIngtbmctXCJdLE1kPS9bQS1aXS9nLHVjPSExLFBiLG9hPTEscGI9MyxRZD17ZnVsbDpcIjEuMy45XCIsbWFqb3I6MSxtaW5vcjozLGRvdDo5LGNvZGVOYW1lOlwibXVsdGlkaW1lbnNpb25hbC1hd2FyZW5lc3NcIn07Ui5leHBhbmRvPVwibmczMzlcIjtcclxudmFyIHpiPVIuY2FjaGU9e30saGY9MTtSLl9kYXRhPWZ1bmN0aW9uKGIpe3JldHVybiB0aGlzLmNhY2hlW2JbdGhpcy5leHBhbmRvXV18fHt9fTt2YXIgY2Y9LyhbXFw6XFwtXFxfXSsoLikpL2csZGY9L15tb3ooW0EtWl0pLyxRZj17bW91c2VsZWF2ZTpcIm1vdXNlb3V0XCIsbW91c2VlbnRlcjpcIm1vdXNlb3ZlclwifSxTYj1UKFwianFMaXRlXCIpLGdmPS9ePChcXHcrKVxccypcXC8/Pig/OjxcXC9cXDE+fCkkLyxSYj0vPHwmIz9cXHcrOy8sZWY9LzwoW1xcdzpdKykvLGZmPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcXHc6XSspW14+XSopXFwvPi9naSxpYT17b3B0aW9uOlsxLCc8c2VsZWN0IG11bHRpcGxlPVwibXVsdGlwbGVcIj4nLFwiPC9zZWxlY3Q+XCJdLHRoZWFkOlsxLFwiPHRhYmxlPlwiLFwiPC90YWJsZT5cIl0sY29sOlsyLFwiPHRhYmxlPjxjb2xncm91cD5cIixcIjwvY29sZ3JvdXA+PC90YWJsZT5cIl0sdHI6WzIsXCI8dGFibGU+PHRib2R5PlwiLFwiPC90Ym9keT48L3RhYmxlPlwiXSxcclxudGQ6WzMsXCI8dGFibGU+PHRib2R5Pjx0cj5cIixcIjwvdHI+PC90Ym9keT48L3RhYmxlPlwiXSxfZGVmYXVsdDpbMCxcIlwiLFwiXCJdfTtpYS5vcHRncm91cD1pYS5vcHRpb247aWEudGJvZHk9aWEudGZvb3Q9aWEuY29sZ3JvdXA9aWEuY2FwdGlvbj1pYS50aGVhZDtpYS50aD1pYS50ZDt2YXIgTGE9Ui5wcm90b3R5cGU9e3JlYWR5OmZ1bmN0aW9uKGIpe2Z1bmN0aW9uIGEoKXtjfHwoYz0hMCxiKCkpfXZhciBjPSExO1wiY29tcGxldGVcIj09PVkucmVhZHlTdGF0ZT9zZXRUaW1lb3V0KGEpOih0aGlzLm9uKFwiRE9NQ29udGVudExvYWRlZFwiLGEpLFIoTSkub24oXCJsb2FkXCIsYSkpfSx0b1N0cmluZzpmdW5jdGlvbigpe3ZhciBiPVtdO3ModGhpcyxmdW5jdGlvbihhKXtiLnB1c2goXCJcIithKX0pO3JldHVyblwiW1wiK2Iuam9pbihcIiwgXCIpK1wiXVwifSxlcTpmdW5jdGlvbihiKXtyZXR1cm4gMDw9Yj9CKHRoaXNbYl0pOkIodGhpc1t0aGlzLmxlbmd0aCtiXSl9LGxlbmd0aDowLHB1c2g6UGYsc29ydDpbXS5zb3J0LFxyXG5zcGxpY2U6W10uc3BsaWNlfSxFYj17fTtzKFwibXVsdGlwbGUgc2VsZWN0ZWQgY2hlY2tlZCBkaXNhYmxlZCByZWFkT25seSByZXF1aXJlZCBvcGVuXCIuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGIpe0ViW1EoYildPWJ9KTt2YXIgTWM9e307cyhcImlucHV0IHNlbGVjdCBvcHRpb24gdGV4dGFyZWEgYnV0dG9uIGZvcm0gZGV0YWlsc1wiLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihiKXtNY1tiXT0hMH0pO3ZhciBOYz17bmdNaW5sZW5ndGg6XCJtaW5sZW5ndGhcIixuZ01heGxlbmd0aDpcIm1heGxlbmd0aFwiLG5nTWluOlwibWluXCIsbmdNYXg6XCJtYXhcIixuZ1BhdHRlcm46XCJwYXR0ZXJuXCJ9O3Moe2RhdGE6VWIscmVtb3ZlRGF0YTp4Yn0sZnVuY3Rpb24oYixhKXtSW2FdPWJ9KTtzKHtkYXRhOlViLGluaGVyaXRlZERhdGE6RGIsc2NvcGU6ZnVuY3Rpb24oYil7cmV0dXJuIEIuZGF0YShiLFwiJHNjb3BlXCIpfHxEYihiLnBhcmVudE5vZGV8fGIsW1wiJGlzb2xhdGVTY29wZVwiLFwiJHNjb3BlXCJdKX0saXNvbGF0ZVNjb3BlOmZ1bmN0aW9uKGIpe3JldHVybiBCLmRhdGEoYixcclxuXCIkaXNvbGF0ZVNjb3BlXCIpfHxCLmRhdGEoYixcIiRpc29sYXRlU2NvcGVOb1RlbXBsYXRlXCIpfSxjb250cm9sbGVyOkljLGluamVjdG9yOmZ1bmN0aW9uKGIpe3JldHVybiBEYihiLFwiJGluamVjdG9yXCIpfSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGIsYSl7Yi5yZW1vdmVBdHRyaWJ1dGUoYSl9LGhhc0NsYXNzOkFiLGNzczpmdW5jdGlvbihiLGEsYyl7YT1jYihhKTtpZih5KGMpKWIuc3R5bGVbYV09YztlbHNlIHJldHVybiBiLnN0eWxlW2FdfSxhdHRyOmZ1bmN0aW9uKGIsYSxjKXt2YXIgZD1RKGEpO2lmKEViW2RdKWlmKHkoYykpYz8oYlthXT0hMCxiLnNldEF0dHJpYnV0ZShhLGQpKTooYlthXT0hMSxiLnJlbW92ZUF0dHJpYnV0ZShkKSk7ZWxzZSByZXR1cm4gYlthXXx8KGIuYXR0cmlidXRlcy5nZXROYW1lZEl0ZW0oYSl8fEgpLnNwZWNpZmllZD9kOnQ7ZWxzZSBpZih5KGMpKWIuc2V0QXR0cmlidXRlKGEsYyk7ZWxzZSBpZihiLmdldEF0dHJpYnV0ZSlyZXR1cm4gYj1iLmdldEF0dHJpYnV0ZShhLFxyXG4yKSxudWxsPT09Yj90OmJ9LHByb3A6ZnVuY3Rpb24oYixhLGMpe2lmKHkoYykpYlthXT1jO2Vsc2UgcmV0dXJuIGJbYV19LHRleHQ6ZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGEsYil7aWYoQShiKSl7dmFyIGQ9YS5ub2RlVHlwZTtyZXR1cm4gZD09PW9hfHxkPT09cGI/YS50ZXh0Q29udGVudDpcIlwifWEudGV4dENvbnRlbnQ9Yn1iLiRkdj1cIlwiO3JldHVybiBifSgpLHZhbDpmdW5jdGlvbihiLGEpe2lmKEEoYSkpe2lmKGIubXVsdGlwbGUmJlwic2VsZWN0XCI9PT11YShiKSl7dmFyIGM9W107cyhiLm9wdGlvbnMsZnVuY3Rpb24oYSl7YS5zZWxlY3RlZCYmYy5wdXNoKGEudmFsdWV8fGEudGV4dCl9KTtyZXR1cm4gMD09PWMubGVuZ3RoP251bGw6Y31yZXR1cm4gYi52YWx1ZX1iLnZhbHVlPWF9LGh0bWw6ZnVuY3Rpb24oYixhKXtpZihBKGEpKXJldHVybiBiLmlubmVySFRNTDt3YihiLCEwKTtiLmlubmVySFRNTD1hfSxlbXB0eTpKY30sZnVuY3Rpb24oYixhKXtSLnByb3RvdHlwZVthXT1mdW5jdGlvbihhLFxyXG5kKXt2YXIgZSxmLGc9dGhpcy5sZW5ndGg7aWYoYiE9PUpjJiYoMj09Yi5sZW5ndGgmJmIhPT1BYiYmYiE9PUljP2E6ZCk9PT10KXtpZihJKGEpKXtmb3IoZT0wO2U8ZztlKyspaWYoYj09PVViKWIodGhpc1tlXSxhKTtlbHNlIGZvcihmIGluIGEpYih0aGlzW2VdLGYsYVtmXSk7cmV0dXJuIHRoaXN9ZT1iLiRkdjtnPWU9PT10P01hdGgubWluKGcsMSk6Zztmb3IoZj0wO2Y8ZztmKyspe3ZhciBoPWIodGhpc1tmXSxhLGQpO2U9ZT9lK2g6aH1yZXR1cm4gZX1mb3IoZT0wO2U8ZztlKyspYih0aGlzW2VdLGEsZCk7cmV0dXJuIHRoaXN9fSk7cyh7cmVtb3ZlRGF0YTp4YixvbjpmdW5jdGlvbiBhKGMsZCxlLGYpe2lmKHkoZikpdGhyb3cgU2IoXCJvbmFyZ3NcIik7aWYoRWMoYykpe3ZhciBnPXliKGMsITApO2Y9Zy5ldmVudHM7dmFyIGg9Zy5oYW5kbGU7aHx8KGg9Zy5oYW5kbGU9bGYoYyxmKSk7Zm9yKHZhciBnPTA8PWQuaW5kZXhPZihcIiBcIik/ZC5zcGxpdChcIiBcIik6W2RdLGw9Zy5sZW5ndGg7bC0tOyl7ZD1cclxuZ1tsXTt2YXIgaz1mW2RdO2t8fChmW2RdPVtdLFwibW91c2VlbnRlclwiPT09ZHx8XCJtb3VzZWxlYXZlXCI9PT1kP2EoYyxRZltkXSxmdW5jdGlvbihhKXt2YXIgYz1hLnJlbGF0ZWRUYXJnZXQ7YyYmKGM9PT10aGlzfHx0aGlzLmNvbnRhaW5zKGMpKXx8aChhLGQpfSk6XCIkZGVzdHJveVwiIT09ZCYmYy5hZGRFdmVudExpc3RlbmVyKGQsaCwhMSksaz1mW2RdKTtrLnB1c2goZSl9fX0sb2ZmOkhjLG9uZTpmdW5jdGlvbihhLGMsZCl7YT1CKGEpO2Eub24oYyxmdW5jdGlvbiBmKCl7YS5vZmYoYyxkKTthLm9mZihjLGYpfSk7YS5vbihjLGQpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbihhLGMpe3ZhciBkLGU9YS5wYXJlbnROb2RlO3diKGEpO3MobmV3IFIoYyksZnVuY3Rpb24oYyl7ZD9lLmluc2VydEJlZm9yZShjLGQubmV4dFNpYmxpbmcpOmUucmVwbGFjZUNoaWxkKGMsYSk7ZD1jfSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3ZhciBjPVtdO3MoYS5jaGlsZE5vZGVzLGZ1bmN0aW9uKGEpe2Eubm9kZVR5cGU9PT1cclxub2EmJmMucHVzaChhKX0pO3JldHVybiBjfSxjb250ZW50czpmdW5jdGlvbihhKXtyZXR1cm4gYS5jb250ZW50RG9jdW1lbnR8fGEuY2hpbGROb2Rlc3x8W119LGFwcGVuZDpmdW5jdGlvbihhLGMpe3ZhciBkPWEubm9kZVR5cGU7aWYoZD09PW9hfHwxMT09PWQpe2M9bmV3IFIoYyk7Zm9yKHZhciBkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKWEuYXBwZW5kQ2hpbGQoY1tkXSl9fSxwcmVwZW5kOmZ1bmN0aW9uKGEsYyl7aWYoYS5ub2RlVHlwZT09PW9hKXt2YXIgZD1hLmZpcnN0Q2hpbGQ7cyhuZXcgUihjKSxmdW5jdGlvbihjKXthLmluc2VydEJlZm9yZShjLGQpfSl9fSx3cmFwOmZ1bmN0aW9uKGEsYyl7Yz1CKGMpLmVxKDApLmNsb25lKClbMF07dmFyIGQ9YS5wYXJlbnROb2RlO2QmJmQucmVwbGFjZUNoaWxkKGMsYSk7Yy5hcHBlbmRDaGlsZChhKX0scmVtb3ZlOktjLGRldGFjaDpmdW5jdGlvbihhKXtLYyhhLCEwKX0sYWZ0ZXI6ZnVuY3Rpb24oYSxjKXt2YXIgZD1hLGU9YS5wYXJlbnROb2RlO1xyXG5jPW5ldyBSKGMpO2Zvcih2YXIgZj0wLGc9Yy5sZW5ndGg7ZjxnO2YrKyl7dmFyIGg9Y1tmXTtlLmluc2VydEJlZm9yZShoLGQubmV4dFNpYmxpbmcpO2Q9aH19LGFkZENsYXNzOkNiLHJlbW92ZUNsYXNzOkJiLHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKGEsYyxkKXtjJiZzKGMuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGMpe3ZhciBmPWQ7QShmKSYmKGY9IUFiKGEsYykpOyhmP0NiOkJiKShhLGMpfSl9LHBhcmVudDpmdW5jdGlvbihhKXtyZXR1cm4oYT1hLnBhcmVudE5vZGUpJiYxMSE9PWEubm9kZVR5cGU/YTpudWxsfSxuZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBhLm5leHRFbGVtZW50U2libGluZ30sZmluZDpmdW5jdGlvbihhLGMpe3JldHVybiBhLmdldEVsZW1lbnRzQnlUYWdOYW1lP2EuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYyk6W119LGNsb25lOlRiLHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZSxmLGc9Yy50eXBlfHxjLGg9eWIoYSk7aWYoaD0oaD1oJiZoLmV2ZW50cykmJlxyXG5oW2ddKWU9e3ByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPSEwfSxpc0RlZmF1bHRQcmV2ZW50ZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hMD09PXRoaXMuZGVmYXVsdFByZXZlbnRlZH0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9ITB9LGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOmZ1bmN0aW9uKCl7cmV0dXJuITA9PT10aGlzLmltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZH0sc3RvcFByb3BhZ2F0aW9uOkgsdHlwZTpnLHRhcmdldDphfSxjLnR5cGUmJihlPXooZSxjKSksYz1yYShoKSxmPWQ/W2VdLmNvbmNhdChkKTpbZV0scyhjLGZ1bmN0aW9uKGMpe2UuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKXx8Yy5hcHBseShhLGYpfSl9fSxmdW5jdGlvbihhLGMpe1IucHJvdG90eXBlW2NdPWZ1bmN0aW9uKGMsZSxmKXtmb3IodmFyIGcsaD0wLGw9dGhpcy5sZW5ndGg7aDxcclxubDtoKyspQShnKT8oZz1hKHRoaXNbaF0sYyxlLGYpLHkoZykmJihnPUIoZykpKTpHYyhnLGEodGhpc1toXSxjLGUsZikpO3JldHVybiB5KGcpP2c6dGhpc307Ui5wcm90b3R5cGUuYmluZD1SLnByb3RvdHlwZS5vbjtSLnByb3RvdHlwZS51bmJpbmQ9Ui5wcm90b3R5cGUub2ZmfSk7ZGIucHJvdG90eXBlPXtwdXQ6ZnVuY3Rpb24oYSxjKXt0aGlzW05hKGEsdGhpcy5uZXh0VWlkKV09Y30sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzW05hKGEsdGhpcy5uZXh0VWlkKV19LHJlbW92ZTpmdW5jdGlvbihhKXt2YXIgYz10aGlzW2E9TmEoYSx0aGlzLm5leHRVaWQpXTtkZWxldGUgdGhpc1thXTtyZXR1cm4gY319O3ZhciBQYz0vXmZ1bmN0aW9uXFxzKlteXFwoXSpcXChcXHMqKFteXFwpXSopXFwpL20sbmY9LywvLG9mPS9eXFxzKihfPykoXFxTKz8pXFwxXFxzKiQvLE9jPS8oKFxcL1xcLy4qJCl8KFxcL1xcKltcXHNcXFNdKj9cXCpcXC8pKS9tZyxHYT1UKFwiJGluamVjdG9yXCIpO09iLiQkYW5ub3RhdGU9VmI7dmFyIFJmPVxyXG5UKFwiJGFuaW1hdGVcIiksQ2U9W1wiJHByb3ZpZGVcIixmdW5jdGlvbihhKXt0aGlzLiQkc2VsZWN0b3JzPXt9O3RoaXMucmVnaXN0ZXI9ZnVuY3Rpb24oYyxkKXt2YXIgZT1jK1wiLWFuaW1hdGlvblwiO2lmKGMmJlwiLlwiIT1jLmNoYXJBdCgwKSl0aHJvdyBSZihcIm5vdGNzZWxcIixjKTt0aGlzLiQkc2VsZWN0b3JzW2Muc3Vic3RyKDEpXT1lO2EuZmFjdG9yeShlLGQpfTt0aGlzLmNsYXNzTmFtZUZpbHRlcj1mdW5jdGlvbihhKXsxPT09YXJndW1lbnRzLmxlbmd0aCYmKHRoaXMuJCRjbGFzc05hbWVGaWx0ZXI9YSBpbnN0YW5jZW9mIFJlZ0V4cD9hOm51bGwpO3JldHVybiB0aGlzLiQkY2xhc3NOYW1lRmlsdGVyfTt0aGlzLiRnZXQ9W1wiJCRxXCIsXCIkJGFzeW5jQ2FsbGJhY2tcIixcIiRyb290U2NvcGVcIixmdW5jdGlvbihhLGQsZSl7ZnVuY3Rpb24gZihkKXt2YXIgZixnPWEuZGVmZXIoKTtnLnByb21pc2UuJCRjYW5jZWxGbj1mdW5jdGlvbigpe2YmJmYoKX07ZS4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKXtmPVxyXG5kKGZ1bmN0aW9uKCl7Zy5yZXNvbHZlKCl9KX0pO3JldHVybiBnLnByb21pc2V9ZnVuY3Rpb24gZyhhLGMpe3ZhciBkPVtdLGU9W10sZj1oYSgpO3MoKGEuYXR0cihcImNsYXNzXCIpfHxcIlwiKS5zcGxpdCgvXFxzKy8pLGZ1bmN0aW9uKGEpe2ZbYV09ITB9KTtzKGMsZnVuY3Rpb24oYSxjKXt2YXIgZz1mW2NdOyExPT09YSYmZz9lLnB1c2goYyk6ITAhPT1hfHxnfHxkLnB1c2goYyl9KTtyZXR1cm4gMDxkLmxlbmd0aCtlLmxlbmd0aCYmW2QubGVuZ3RoP2Q6bnVsbCxlLmxlbmd0aD9lOm51bGxdfWZ1bmN0aW9uIGgoYSxjLGQpe2Zvcih2YXIgZT0wLGY9Yy5sZW5ndGg7ZTxmOysrZSlhW2NbZV1dPWR9ZnVuY3Rpb24gbCgpe218fChtPWEuZGVmZXIoKSxkKGZ1bmN0aW9uKCl7bS5yZXNvbHZlKCk7bT1udWxsfSkpO3JldHVybiBtLnByb21pc2V9ZnVuY3Rpb24gayhhLGMpe2lmKGdhLmlzT2JqZWN0KGMpKXt2YXIgZD16KGMuZnJvbXx8e30sYy50b3x8e30pO2EuY3NzKGQpfX12YXIgbTtyZXR1cm57YW5pbWF0ZTpmdW5jdGlvbihhLFxyXG5jLGQpe2soYSx7ZnJvbTpjLHRvOmR9KTtyZXR1cm4gbCgpfSxlbnRlcjpmdW5jdGlvbihhLGMsZCxlKXtrKGEsZSk7ZD9kLmFmdGVyKGEpOmMucHJlcGVuZChhKTtyZXR1cm4gbCgpfSxsZWF2ZTpmdW5jdGlvbihhLGMpe2EucmVtb3ZlKCk7cmV0dXJuIGwoKX0sbW92ZTpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gdGhpcy5lbnRlcihhLGMsZCxlKX0sYWRkQ2xhc3M6ZnVuY3Rpb24oYSxjLGQpe3JldHVybiB0aGlzLnNldENsYXNzKGEsYyxbXSxkKX0sJCRhZGRDbGFzc0ltbWVkaWF0ZWx5OmZ1bmN0aW9uKGEsYyxkKXthPUIoYSk7Yz1GKGMpP2M6RChjKT9jLmpvaW4oXCIgXCIpOlwiXCI7cyhhLGZ1bmN0aW9uKGEpe0NiKGEsYyl9KTtrKGEsZCk7cmV0dXJuIGwoKX0scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSxjLGQpe3JldHVybiB0aGlzLnNldENsYXNzKGEsW10sYyxkKX0sJCRyZW1vdmVDbGFzc0ltbWVkaWF0ZWx5OmZ1bmN0aW9uKGEsYyxkKXthPUIoYSk7Yz1GKGMpP2M6RChjKT9jLmpvaW4oXCIgXCIpOlxyXG5cIlwiO3MoYSxmdW5jdGlvbihhKXtCYihhLGMpfSk7ayhhLGQpO3JldHVybiBsKCl9LHNldENsYXNzOmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBrPXRoaXMsbD0hMTthPUIoYSk7dmFyIG09YS5kYXRhKFwiJCRhbmltYXRlQ2xhc3Nlc1wiKTttP2UmJm0ub3B0aW9ucyYmKG0ub3B0aW9ucz1nYS5leHRlbmQobS5vcHRpb25zfHx7fSxlKSk6KG09e2NsYXNzZXM6e30sb3B0aW9uczplfSxsPSEwKTtlPW0uY2xhc3NlcztjPUQoYyk/YzpjLnNwbGl0KFwiIFwiKTtkPUQoZCk/ZDpkLnNwbGl0KFwiIFwiKTtoKGUsYywhMCk7aChlLGQsITEpO2wmJihtLnByb21pc2U9ZihmdW5jdGlvbihjKXt2YXIgZD1hLmRhdGEoXCIkJGFuaW1hdGVDbGFzc2VzXCIpO2EucmVtb3ZlRGF0YShcIiQkYW5pbWF0ZUNsYXNzZXNcIik7aWYoZCl7dmFyIGU9ZyhhLGQuY2xhc3Nlcyk7ZSYmay4kJHNldENsYXNzSW1tZWRpYXRlbHkoYSxlWzBdLGVbMV0sZC5vcHRpb25zKX1jKCl9KSxhLmRhdGEoXCIkJGFuaW1hdGVDbGFzc2VzXCIsbSkpO1xyXG5yZXR1cm4gbS5wcm9taXNlfSwkJHNldENsYXNzSW1tZWRpYXRlbHk6ZnVuY3Rpb24oYSxjLGQsZSl7YyYmdGhpcy4kJGFkZENsYXNzSW1tZWRpYXRlbHkoYSxjKTtkJiZ0aGlzLiQkcmVtb3ZlQ2xhc3NJbW1lZGlhdGVseShhLGQpO2soYSxlKTtyZXR1cm4gbCgpfSxlbmFibGVkOkgsY2FuY2VsOkh9fV19XSxqYT1UKFwiJGNvbXBpbGVcIik7d2MuJGluamVjdD1bXCIkcHJvdmlkZVwiLFwiJCRzYW5pdGl6ZVVyaVByb3ZpZGVyXCJdO3ZhciBSYz0vXigoPzp4fGRhdGEpW1xcOlxcLV9dKS9pLFZjPVwiYXBwbGljYXRpb24vanNvblwiLFpiPXtcIkNvbnRlbnQtVHlwZVwiOlZjK1wiO2NoYXJzZXQ9dXRmLThcIn0sdGY9L15cXFt8Xlxceyg/IVxceykvLHVmPXtcIltcIjovXSQvLFwie1wiOi99JC99LHNmPS9eXFwpXFxdXFx9Jyw/XFxuLywkYj1UKFwiJGludGVycG9sYXRlXCIpLFNmPS9eKFteXFw/I10qKShcXD8oW14jXSopKT8oIyguKikpPyQvLHhmPXtodHRwOjgwLGh0dHBzOjQ0MyxmdHA6MjF9LEZiPVQoXCIkbG9jYXRpb25cIiksVGY9XHJcbnskJGh0bWw1OiExLCQkcmVwbGFjZTohMSxhYnNVcmw6R2IoXCIkJGFic1VybFwiKSx1cmw6ZnVuY3Rpb24oYSl7aWYoQShhKSlyZXR1cm4gdGhpcy4kJHVybDt2YXIgYz1TZi5leGVjKGEpOyhjWzFdfHxcIlwiPT09YSkmJnRoaXMucGF0aChkZWNvZGVVUklDb21wb25lbnQoY1sxXSkpOyhjWzJdfHxjWzFdfHxcIlwiPT09YSkmJnRoaXMuc2VhcmNoKGNbM118fFwiXCIpO3RoaXMuaGFzaChjWzVdfHxcIlwiKTtyZXR1cm4gdGhpc30scHJvdG9jb2w6R2IoXCIkJHByb3RvY29sXCIpLGhvc3Q6R2IoXCIkJGhvc3RcIikscG9ydDpHYihcIiQkcG9ydFwiKSxwYXRoOmRkKFwiJCRwYXRoXCIsZnVuY3Rpb24oYSl7YT1udWxsIT09YT9hLnRvU3RyaW5nKCk6XCJcIjtyZXR1cm5cIi9cIj09YS5jaGFyQXQoMCk/YTpcIi9cIithfSksc2VhcmNoOmZ1bmN0aW9uKGEsYyl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gdGhpcy4kJHNlYXJjaDtjYXNlIDE6aWYoRihhKXx8VihhKSlhPWEudG9TdHJpbmcoKSx0aGlzLiQkc2VhcmNoPVxyXG5xYyhhKTtlbHNlIGlmKEkoYSkpYT1FYShhLHt9KSxzKGEsZnVuY3Rpb24oYyxlKXtudWxsPT1jJiZkZWxldGUgYVtlXX0pLHRoaXMuJCRzZWFyY2g9YTtlbHNlIHRocm93IEZiKFwiaXNyY2hhcmdcIik7YnJlYWs7ZGVmYXVsdDpBKGMpfHxudWxsPT09Yz9kZWxldGUgdGhpcy4kJHNlYXJjaFthXTp0aGlzLiQkc2VhcmNoW2FdPWN9dGhpcy4kJGNvbXBvc2UoKTtyZXR1cm4gdGhpc30saGFzaDpkZChcIiQkaGFzaFwiLGZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT09YT9hLnRvU3RyaW5nKCk6XCJcIn0pLHJlcGxhY2U6ZnVuY3Rpb24oKXt0aGlzLiQkcmVwbGFjZT0hMDtyZXR1cm4gdGhpc319O3MoW2NkLGRjLGNjXSxmdW5jdGlvbihhKXthLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKFRmKTthLnByb3RvdHlwZS5zdGF0ZT1mdW5jdGlvbihjKXtpZighYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdGhpcy4kJHN0YXRlO2lmKGEhPT1jY3x8IXRoaXMuJCRodG1sNSl0aHJvdyBGYihcIm5vc3RhdGVcIik7dGhpcy4kJHN0YXRlPVxyXG5BKGMpP251bGw6YztyZXR1cm4gdGhpc319KTt2YXIgbGE9VChcIiRwYXJzZVwiKSxVZj1GdW5jdGlvbi5wcm90b3R5cGUuY2FsbCxWZj1GdW5jdGlvbi5wcm90b3R5cGUuYXBwbHksV2Y9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQsbGI9aGEoKTtzKHtcIm51bGxcIjpmdW5jdGlvbigpe3JldHVybiBudWxsfSxcInRydWVcIjpmdW5jdGlvbigpe3JldHVybiEwfSxcImZhbHNlXCI6ZnVuY3Rpb24oKXtyZXR1cm4hMX0sdW5kZWZpbmVkOmZ1bmN0aW9uKCl7fX0sZnVuY3Rpb24oYSxjKXthLmNvbnN0YW50PWEubGl0ZXJhbD1hLnNoYXJlZEdldHRlcj0hMDtsYltjXT1hfSk7bGJbXCJ0aGlzXCJdPWZ1bmN0aW9uKGEpe3JldHVybiBhfTtsYltcInRoaXNcIl0uc2hhcmVkR2V0dGVyPSEwO3ZhciBtYj16KGhhKCkse1wiK1wiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO3JldHVybiB5KGQpP3koZSk/ZCtlOmQ6eShlKT9lOnR9LFwiLVwiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO1xyXG5yZXR1cm4oeShkKT9kOjApLSh5KGUpP2U6MCl9LFwiKlwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykqZShhLGMpfSxcIi9cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpL2UoYSxjKX0sXCIlXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSVlKGEsYyl9LFwiPT09XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKT09PWUoYSxjKX0sXCIhPT1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpIT09ZShhLGMpfSxcIj09XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKT09ZShhLGMpfSxcIiE9XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSE9ZShhLGMpfSxcIjxcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPGUoYSxjKX0sXCI+XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKT5lKGEsYyl9LFwiPD1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPD1lKGEsYyl9LFwiPj1cIjpmdW5jdGlvbihhLGMsXHJcbmQsZSl7cmV0dXJuIGQoYSxjKT49ZShhLGMpfSxcIiYmXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSYmZShhLGMpfSxcInx8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKXx8ZShhLGMpfSxcIiFcIjpmdW5jdGlvbihhLGMsZCl7cmV0dXJuIWQoYSxjKX0sXCI9XCI6ITAsXCJ8XCI6ITB9KSxYZj17bjpcIlxcblwiLGY6XCJcXGZcIixyOlwiXFxyXCIsdDpcIlxcdFwiLHY6XCJcXHZcIixcIidcIjpcIidcIiwnXCInOidcIid9LGdjPWZ1bmN0aW9uKGEpe3RoaXMub3B0aW9ucz1hfTtnYy5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmdjLGxleDpmdW5jdGlvbihhKXt0aGlzLnRleHQ9YTt0aGlzLmluZGV4PTA7Zm9yKHRoaXMudG9rZW5zPVtdO3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspaWYoYT10aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgpLCdcIic9PT1hfHxcIidcIj09PWEpdGhpcy5yZWFkU3RyaW5nKGEpO2Vsc2UgaWYodGhpcy5pc051bWJlcihhKXx8XCIuXCI9PT1hJiZ0aGlzLmlzTnVtYmVyKHRoaXMucGVlaygpKSl0aGlzLnJlYWROdW1iZXIoKTtcclxuZWxzZSBpZih0aGlzLmlzSWRlbnQoYSkpdGhpcy5yZWFkSWRlbnQoKTtlbHNlIGlmKHRoaXMuaXMoYSxcIigpe31bXS4sOzo/XCIpKXRoaXMudG9rZW5zLnB1c2goe2luZGV4OnRoaXMuaW5kZXgsdGV4dDphfSksdGhpcy5pbmRleCsrO2Vsc2UgaWYodGhpcy5pc1doaXRlc3BhY2UoYSkpdGhpcy5pbmRleCsrO2Vsc2V7dmFyIGM9YSt0aGlzLnBlZWsoKSxkPWMrdGhpcy5wZWVrKDIpLGU9bWJbY10sZj1tYltkXTttYlthXXx8ZXx8Zj8oYT1mP2Q6ZT9jOmEsdGhpcy50b2tlbnMucHVzaCh7aW5kZXg6dGhpcy5pbmRleCx0ZXh0OmEsb3BlcmF0b3I6ITB9KSx0aGlzLmluZGV4Kz1hLmxlbmd0aCk6dGhpcy50aHJvd0Vycm9yKFwiVW5leHBlY3RlZCBuZXh0IGNoYXJhY3RlciBcIix0aGlzLmluZGV4LHRoaXMuaW5kZXgrMSl9cmV0dXJuIHRoaXMudG9rZW5zfSxpczpmdW5jdGlvbihhLGMpe3JldHVybi0xIT09Yy5pbmRleE9mKGEpfSxwZWVrOmZ1bmN0aW9uKGEpe2E9YXx8MTtyZXR1cm4gdGhpcy5pbmRleCtcclxuYTx0aGlzLnRleHQubGVuZ3RoP3RoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCthKTohMX0saXNOdW1iZXI6ZnVuY3Rpb24oYSl7cmV0dXJuXCIwXCI8PWEmJlwiOVwiPj1hJiZcInN0cmluZ1wiPT09dHlwZW9mIGF9LGlzV2hpdGVzcGFjZTpmdW5jdGlvbihhKXtyZXR1cm5cIiBcIj09PWF8fFwiXFxyXCI9PT1hfHxcIlxcdFwiPT09YXx8XCJcXG5cIj09PWF8fFwiXFx2XCI9PT1hfHxcIlxcdTAwYTBcIj09PWF9LGlzSWRlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuXCJhXCI8PWEmJlwielwiPj1hfHxcIkFcIjw9YSYmXCJaXCI+PWF8fFwiX1wiPT09YXx8XCIkXCI9PT1hfSxpc0V4cE9wZXJhdG9yOmZ1bmN0aW9uKGEpe3JldHVyblwiLVwiPT09YXx8XCIrXCI9PT1hfHx0aGlzLmlzTnVtYmVyKGEpfSx0aHJvd0Vycm9yOmZ1bmN0aW9uKGEsYyxkKXtkPWR8fHRoaXMuaW5kZXg7Yz15KGMpP1wicyBcIitjK1wiLVwiK3RoaXMuaW5kZXgrXCIgW1wiK3RoaXMudGV4dC5zdWJzdHJpbmcoYyxkKStcIl1cIjpcIiBcIitkO3Rocm93IGxhKFwibGV4ZXJyXCIsYSxjLHRoaXMudGV4dCk7XHJcbn0scmVhZE51bWJlcjpmdW5jdGlvbigpe2Zvcih2YXIgYT1cIlwiLGM9dGhpcy5pbmRleDt0aGlzLmluZGV4PHRoaXMudGV4dC5sZW5ndGg7KXt2YXIgZD1RKHRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCkpO2lmKFwiLlwiPT1kfHx0aGlzLmlzTnVtYmVyKGQpKWErPWQ7ZWxzZXt2YXIgZT10aGlzLnBlZWsoKTtpZihcImVcIj09ZCYmdGhpcy5pc0V4cE9wZXJhdG9yKGUpKWErPWQ7ZWxzZSBpZih0aGlzLmlzRXhwT3BlcmF0b3IoZCkmJmUmJnRoaXMuaXNOdW1iZXIoZSkmJlwiZVwiPT1hLmNoYXJBdChhLmxlbmd0aC0xKSlhKz1kO2Vsc2UgaWYoIXRoaXMuaXNFeHBPcGVyYXRvcihkKXx8ZSYmdGhpcy5pc051bWJlcihlKXx8XCJlXCIhPWEuY2hhckF0KGEubGVuZ3RoLTEpKWJyZWFrO2Vsc2UgdGhpcy50aHJvd0Vycm9yKFwiSW52YWxpZCBleHBvbmVudFwiKX10aGlzLmluZGV4Kyt9dGhpcy50b2tlbnMucHVzaCh7aW5kZXg6Yyx0ZXh0OmEsY29uc3RhbnQ6ITAsdmFsdWU6TnVtYmVyKGEpfSl9LHJlYWRJZGVudDpmdW5jdGlvbigpe2Zvcih2YXIgYT1cclxudGhpcy5pbmRleDt0aGlzLmluZGV4PHRoaXMudGV4dC5sZW5ndGg7KXt2YXIgYz10aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgpO2lmKCF0aGlzLmlzSWRlbnQoYykmJiF0aGlzLmlzTnVtYmVyKGMpKWJyZWFrO3RoaXMuaW5kZXgrK310aGlzLnRva2Vucy5wdXNoKHtpbmRleDphLHRleHQ6dGhpcy50ZXh0LnNsaWNlKGEsdGhpcy5pbmRleCksaWRlbnRpZmllcjohMH0pfSxyZWFkU3RyaW5nOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuaW5kZXg7dGhpcy5pbmRleCsrO2Zvcih2YXIgZD1cIlwiLGU9YSxmPSExO3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3ZhciBnPXRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCksZT1lK2c7aWYoZilcInVcIj09PWc/KGY9dGhpcy50ZXh0LnN1YnN0cmluZyh0aGlzLmluZGV4KzEsdGhpcy5pbmRleCs1KSxmLm1hdGNoKC9bXFxkYS1mXXs0fS9pKXx8dGhpcy50aHJvd0Vycm9yKFwiSW52YWxpZCB1bmljb2RlIGVzY2FwZSBbXFxcXHVcIitmK1wiXVwiKSx0aGlzLmluZGV4Kz1cclxuNCxkKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGYsMTYpKSk6ZCs9WGZbZ118fGcsZj0hMTtlbHNlIGlmKFwiXFxcXFwiPT09ZylmPSEwO2Vsc2V7aWYoZz09PWEpe3RoaXMuaW5kZXgrKzt0aGlzLnRva2Vucy5wdXNoKHtpbmRleDpjLHRleHQ6ZSxjb25zdGFudDohMCx2YWx1ZTpkfSk7cmV0dXJufWQrPWd9dGhpcy5pbmRleCsrfXRoaXMudGhyb3dFcnJvcihcIlVudGVybWluYXRlZCBxdW90ZVwiLGMpfX07dmFyIGhiPWZ1bmN0aW9uKGEsYyxkKXt0aGlzLmxleGVyPWE7dGhpcy4kZmlsdGVyPWM7dGhpcy5vcHRpb25zPWR9O2hiLlpFUk89eihmdW5jdGlvbigpe3JldHVybiAwfSx7c2hhcmVkR2V0dGVyOiEwLGNvbnN0YW50OiEwfSk7aGIucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpoYixwYXJzZTpmdW5jdGlvbihhKXt0aGlzLnRleHQ9YTt0aGlzLnRva2Vucz10aGlzLmxleGVyLmxleChhKTthPXRoaXMuc3RhdGVtZW50cygpOzAhPT10aGlzLnRva2Vucy5sZW5ndGgmJnRoaXMudGhyb3dFcnJvcihcImlzIGFuIHVuZXhwZWN0ZWQgdG9rZW5cIixcclxudGhpcy50b2tlbnNbMF0pO2EubGl0ZXJhbD0hIWEubGl0ZXJhbDthLmNvbnN0YW50PSEhYS5jb25zdGFudDtyZXR1cm4gYX0scHJpbWFyeTpmdW5jdGlvbigpe3ZhciBhO3RoaXMuZXhwZWN0KFwiKFwiKT8oYT10aGlzLmZpbHRlckNoYWluKCksdGhpcy5jb25zdW1lKFwiKVwiKSk6dGhpcy5leHBlY3QoXCJbXCIpP2E9dGhpcy5hcnJheURlY2xhcmF0aW9uKCk6dGhpcy5leHBlY3QoXCJ7XCIpP2E9dGhpcy5vYmplY3QoKTp0aGlzLnBlZWsoKS5pZGVudGlmaWVyJiZ0aGlzLnBlZWsoKS50ZXh0IGluIGxiP2E9bGJbdGhpcy5jb25zdW1lKCkudGV4dF06dGhpcy5wZWVrKCkuaWRlbnRpZmllcj9hPXRoaXMuaWRlbnRpZmllcigpOnRoaXMucGVlaygpLmNvbnN0YW50P2E9dGhpcy5jb25zdGFudCgpOnRoaXMudGhyb3dFcnJvcihcIm5vdCBhIHByaW1hcnkgZXhwcmVzc2lvblwiLHRoaXMucGVlaygpKTtmb3IodmFyIGMsZDtjPXRoaXMuZXhwZWN0KFwiKFwiLFwiW1wiLFwiLlwiKTspXCIoXCI9PT1jLnRleHQ/KGE9dGhpcy5mdW5jdGlvbkNhbGwoYSxcclxuZCksZD1udWxsKTpcIltcIj09PWMudGV4dD8oZD1hLGE9dGhpcy5vYmplY3RJbmRleChhKSk6XCIuXCI9PT1jLnRleHQ/KGQ9YSxhPXRoaXMuZmllbGRBY2Nlc3MoYSkpOnRoaXMudGhyb3dFcnJvcihcIklNUE9TU0lCTEVcIik7cmV0dXJuIGF9LHRocm93RXJyb3I6ZnVuY3Rpb24oYSxjKXt0aHJvdyBsYShcInN5bnRheFwiLGMudGV4dCxhLGMuaW5kZXgrMSx0aGlzLnRleHQsdGhpcy50ZXh0LnN1YnN0cmluZyhjLmluZGV4KSk7fSxwZWVrVG9rZW46ZnVuY3Rpb24oKXtpZigwPT09dGhpcy50b2tlbnMubGVuZ3RoKXRocm93IGxhKFwidWVvZVwiLHRoaXMudGV4dCk7cmV0dXJuIHRoaXMudG9rZW5zWzBdfSxwZWVrOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiB0aGlzLnBlZWtBaGVhZCgwLGEsYyxkLGUpfSxwZWVrQWhlYWQ6ZnVuY3Rpb24oYSxjLGQsZSxmKXtpZih0aGlzLnRva2Vucy5sZW5ndGg+YSl7YT10aGlzLnRva2Vuc1thXTt2YXIgZz1hLnRleHQ7aWYoZz09PWN8fGc9PT1kfHxnPT09ZXx8Zz09PVxyXG5mfHwhKGN8fGR8fGV8fGYpKXJldHVybiBhfXJldHVybiExfSxleHBlY3Q6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuKGE9dGhpcy5wZWVrKGEsYyxkLGUpKT8odGhpcy50b2tlbnMuc2hpZnQoKSxhKTohMX0sY29uc3VtZTpmdW5jdGlvbihhKXtpZigwPT09dGhpcy50b2tlbnMubGVuZ3RoKXRocm93IGxhKFwidWVvZVwiLHRoaXMudGV4dCk7dmFyIGM9dGhpcy5leHBlY3QoYSk7Y3x8dGhpcy50aHJvd0Vycm9yKFwiaXMgdW5leHBlY3RlZCwgZXhwZWN0aW5nIFtcIithK1wiXVwiLHRoaXMucGVlaygpKTtyZXR1cm4gY30sdW5hcnlGbjpmdW5jdGlvbihhLGMpe3ZhciBkPW1iW2FdO3JldHVybiB6KGZ1bmN0aW9uKGEsZil7cmV0dXJuIGQoYSxmLGMpfSx7Y29uc3RhbnQ6Yy5jb25zdGFudCxpbnB1dHM6W2NdfSl9LGJpbmFyeUZuOmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBmPW1iW2NdO3JldHVybiB6KGZ1bmN0aW9uKGMsZSl7cmV0dXJuIGYoYyxlLGEsZCl9LHtjb25zdGFudDphLmNvbnN0YW50JiZcclxuZC5jb25zdGFudCxpbnB1dHM6IWUmJlthLGRdfSl9LGlkZW50aWZpZXI6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5jb25zdW1lKCkudGV4dDt0aGlzLnBlZWsoXCIuXCIpJiZ0aGlzLnBlZWtBaGVhZCgxKS5pZGVudGlmaWVyJiYhdGhpcy5wZWVrQWhlYWQoMixcIihcIik7KWErPXRoaXMuY29uc3VtZSgpLnRleHQrdGhpcy5jb25zdW1lKCkudGV4dDtyZXR1cm4gemYoYSx0aGlzLm9wdGlvbnMsdGhpcy50ZXh0KX0sY29uc3RhbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmNvbnN1bWUoKS52YWx1ZTtyZXR1cm4geihmdW5jdGlvbigpe3JldHVybiBhfSx7Y29uc3RhbnQ6ITAsbGl0ZXJhbDohMH0pfSxzdGF0ZW1lbnRzOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPVtdOzspaWYoMDx0aGlzLnRva2Vucy5sZW5ndGgmJiF0aGlzLnBlZWsoXCJ9XCIsXCIpXCIsXCI7XCIsXCJdXCIpJiZhLnB1c2godGhpcy5maWx0ZXJDaGFpbigpKSwhdGhpcy5leHBlY3QoXCI7XCIpKXJldHVybiAxPT09YS5sZW5ndGg/YVswXTpmdW5jdGlvbihjLFxyXG5kKXtmb3IodmFyIGUsZj0wLGc9YS5sZW5ndGg7ZjxnO2YrKyllPWFbZl0oYyxkKTtyZXR1cm4gZX19LGZpbHRlckNoYWluOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuZXhwcmVzc2lvbigpO3RoaXMuZXhwZWN0KFwifFwiKTspYT10aGlzLmZpbHRlcihhKTtyZXR1cm4gYX0sZmlsdGVyOmZ1bmN0aW9uKGEpe3ZhciBjPXRoaXMuJGZpbHRlcih0aGlzLmNvbnN1bWUoKS50ZXh0KSxkLGU7aWYodGhpcy5wZWVrKFwiOlwiKSlmb3IoZD1bXSxlPVtdO3RoaXMuZXhwZWN0KFwiOlwiKTspZC5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTt2YXIgZj1bYV0uY29uY2F0KGR8fFtdKTtyZXR1cm4geihmdW5jdGlvbihmLGgpe3ZhciBsPWEoZixoKTtpZihlKXtlWzBdPWw7Zm9yKGw9ZC5sZW5ndGg7bC0tOyllW2wrMV09ZFtsXShmLGgpO3JldHVybiBjLmFwcGx5KHQsZSl9cmV0dXJuIGMobCl9LHtjb25zdGFudDohYy4kc3RhdGVmdWwmJmYuZXZlcnkoZWMpLGlucHV0czohYy4kc3RhdGVmdWwmJmZ9KX0sZXhwcmVzc2lvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFzc2lnbm1lbnQoKX0sXHJcbmFzc2lnbm1lbnQ6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnRlcm5hcnkoKSxjLGQ7cmV0dXJuKGQ9dGhpcy5leHBlY3QoXCI9XCIpKT8oYS5hc3NpZ258fHRoaXMudGhyb3dFcnJvcihcImltcGxpZXMgYXNzaWdubWVudCBidXQgW1wiK3RoaXMudGV4dC5zdWJzdHJpbmcoMCxkLmluZGV4KStcIl0gY2FuIG5vdCBiZSBhc3NpZ25lZCB0b1wiLGQpLGM9dGhpcy50ZXJuYXJ5KCkseihmdW5jdGlvbihkLGYpe3JldHVybiBhLmFzc2lnbihkLGMoZCxmKSxmKX0se2lucHV0czpbYSxjXX0pKTphfSx0ZXJuYXJ5OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5sb2dpY2FsT1IoKSxjO2lmKHRoaXMuZXhwZWN0KFwiP1wiKSYmKGM9dGhpcy5hc3NpZ25tZW50KCksdGhpcy5jb25zdW1lKFwiOlwiKSkpe3ZhciBkPXRoaXMuYXNzaWdubWVudCgpO3JldHVybiB6KGZ1bmN0aW9uKGUsZil7cmV0dXJuIGEoZSxmKT9jKGUsZik6ZChlLGYpfSx7Y29uc3RhbnQ6YS5jb25zdGFudCYmYy5jb25zdGFudCYmZC5jb25zdGFudH0pfXJldHVybiBhfSxcclxubG9naWNhbE9SOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMubG9naWNhbEFORCgpLGM7Yz10aGlzLmV4cGVjdChcInx8XCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsdGhpcy5sb2dpY2FsQU5EKCksITApO3JldHVybiBhfSxsb2dpY2FsQU5EOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuZXF1YWxpdHkoKSxjO2M9dGhpcy5leHBlY3QoXCImJlwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy50ZXh0LHRoaXMuZXF1YWxpdHkoKSwhMCk7cmV0dXJuIGF9LGVxdWFsaXR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMucmVsYXRpb25hbCgpLGM7Yz10aGlzLmV4cGVjdChcIj09XCIsXCIhPVwiLFwiPT09XCIsXCIhPT1cIik7KWE9dGhpcy5iaW5hcnlGbihhLGMudGV4dCx0aGlzLnJlbGF0aW9uYWwoKSk7cmV0dXJuIGF9LHJlbGF0aW9uYWw6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5hZGRpdGl2ZSgpLGM7Yz10aGlzLmV4cGVjdChcIjxcIixcIj5cIixcIjw9XCIsXCI+PVwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy50ZXh0LFxyXG50aGlzLmFkZGl0aXZlKCkpO3JldHVybiBhfSxhZGRpdGl2ZTpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLm11bHRpcGxpY2F0aXZlKCksYztjPXRoaXMuZXhwZWN0KFwiK1wiLFwiLVwiKTspYT10aGlzLmJpbmFyeUZuKGEsYy50ZXh0LHRoaXMubXVsdGlwbGljYXRpdmUoKSk7cmV0dXJuIGF9LG11bHRpcGxpY2F0aXZlOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMudW5hcnkoKSxjO2M9dGhpcy5leHBlY3QoXCIqXCIsXCIvXCIsXCIlXCIpOylhPXRoaXMuYmluYXJ5Rm4oYSxjLnRleHQsdGhpcy51bmFyeSgpKTtyZXR1cm4gYX0sdW5hcnk6ZnVuY3Rpb24oKXt2YXIgYTtyZXR1cm4gdGhpcy5leHBlY3QoXCIrXCIpP3RoaXMucHJpbWFyeSgpOihhPXRoaXMuZXhwZWN0KFwiLVwiKSk/dGhpcy5iaW5hcnlGbihoYi5aRVJPLGEudGV4dCx0aGlzLnVuYXJ5KCkpOihhPXRoaXMuZXhwZWN0KFwiIVwiKSk/dGhpcy51bmFyeUZuKGEudGV4dCx0aGlzLnVuYXJ5KCkpOnRoaXMucHJpbWFyeSgpfSxmaWVsZEFjY2VzczpmdW5jdGlvbihhKXt2YXIgYz1cclxudGhpcy5pZGVudGlmaWVyKCk7cmV0dXJuIHooZnVuY3Rpb24oZCxlLGYpe2Q9Znx8YShkLGUpO3JldHVybiBudWxsPT1kP3Q6YyhkKX0se2Fzc2lnbjpmdW5jdGlvbihkLGUsZil7dmFyIGc9YShkLGYpO2d8fGEuYXNzaWduKGQsZz17fSxmKTtyZXR1cm4gYy5hc3NpZ24oZyxlKX19KX0sb2JqZWN0SW5kZXg6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy50ZXh0LGQ9dGhpcy5leHByZXNzaW9uKCk7dGhpcy5jb25zdW1lKFwiXVwiKTtyZXR1cm4geihmdW5jdGlvbihlLGYpe3ZhciBnPWEoZSxmKSxoPWQoZSxmKTt0YShoLGMpO3JldHVybiBnP21hKGdbaF0sYyk6dH0se2Fzc2lnbjpmdW5jdGlvbihlLGYsZyl7dmFyIGg9dGEoZChlLGcpLGMpLGw9bWEoYShlLGcpLGMpO2x8fGEuYXNzaWduKGUsbD17fSxnKTtyZXR1cm4gbFtoXT1mfX0pfSxmdW5jdGlvbkNhbGw6ZnVuY3Rpb24oYSxjKXt2YXIgZD1bXTtpZihcIilcIiE9PXRoaXMucGVla1Rva2VuKCkudGV4dCl7ZG8gZC5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKTtcclxud2hpbGUodGhpcy5leHBlY3QoXCIsXCIpKX10aGlzLmNvbnN1bWUoXCIpXCIpO3ZhciBlPXRoaXMudGV4dCxmPWQubGVuZ3RoP1tdOm51bGw7cmV0dXJuIGZ1bmN0aW9uKGcsaCl7dmFyIGw9Yz9jKGcsaCk6eShjKT90Omcsaz1hKGcsaCxsKXx8SDtpZihmKWZvcih2YXIgbT1kLmxlbmd0aDttLS07KWZbbV09bWEoZFttXShnLGgpLGUpO21hKGwsZSk7aWYoayl7aWYoay5jb25zdHJ1Y3Rvcj09PWspdGhyb3cgbGEoXCJpc2VjZm5cIixlKTtpZihrPT09VWZ8fGs9PT1WZnx8az09PVdmKXRocm93IGxhKFwiaXNlY2ZmXCIsZSk7fWw9ay5hcHBseT9rLmFwcGx5KGwsZik6ayhmWzBdLGZbMV0sZlsyXSxmWzNdLGZbNF0pO3JldHVybiBtYShsLGUpfX0sYXJyYXlEZWNsYXJhdGlvbjpmdW5jdGlvbigpe3ZhciBhPVtdO2lmKFwiXVwiIT09dGhpcy5wZWVrVG9rZW4oKS50ZXh0KXtkb3tpZih0aGlzLnBlZWsoXCJdXCIpKWJyZWFrO2EucHVzaCh0aGlzLmV4cHJlc3Npb24oKSl9d2hpbGUodGhpcy5leHBlY3QoXCIsXCIpKVxyXG59dGhpcy5jb25zdW1lKFwiXVwiKTtyZXR1cm4geihmdW5jdGlvbihjLGQpe2Zvcih2YXIgZT1bXSxmPTAsZz1hLmxlbmd0aDtmPGc7ZisrKWUucHVzaChhW2ZdKGMsZCkpO3JldHVybiBlfSx7bGl0ZXJhbDohMCxjb25zdGFudDphLmV2ZXJ5KGVjKSxpbnB1dHM6YX0pfSxvYmplY3Q6ZnVuY3Rpb24oKXt2YXIgYT1bXSxjPVtdO2lmKFwifVwiIT09dGhpcy5wZWVrVG9rZW4oKS50ZXh0KXtkb3tpZih0aGlzLnBlZWsoXCJ9XCIpKWJyZWFrO3ZhciBkPXRoaXMuY29uc3VtZSgpO2QuY29uc3RhbnQ/YS5wdXNoKGQudmFsdWUpOmQuaWRlbnRpZmllcj9hLnB1c2goZC50ZXh0KTp0aGlzLnRocm93RXJyb3IoXCJpbnZhbGlkIGtleVwiLGQpO3RoaXMuY29uc3VtZShcIjpcIik7Yy5wdXNoKHRoaXMuZXhwcmVzc2lvbigpKX13aGlsZSh0aGlzLmV4cGVjdChcIixcIikpfXRoaXMuY29uc3VtZShcIn1cIik7cmV0dXJuIHooZnVuY3Rpb24oZCxmKXtmb3IodmFyIGc9e30saD0wLGw9Yy5sZW5ndGg7aDxsO2grKylnW2FbaF1dPVxyXG5jW2hdKGQsZik7cmV0dXJuIGd9LHtsaXRlcmFsOiEwLGNvbnN0YW50OmMuZXZlcnkoZWMpLGlucHV0czpjfSl9fTt2YXIgQmY9aGEoKSxBZj1oYSgpLENmPU9iamVjdC5wcm90b3R5cGUudmFsdWVPZixDYT1UKFwiJHNjZVwiKSxuYT17SFRNTDpcImh0bWxcIixDU1M6XCJjc3NcIixVUkw6XCJ1cmxcIixSRVNPVVJDRV9VUkw6XCJyZXNvdXJjZVVybFwiLEpTOlwianNcIn0samE9VChcIiRjb21waWxlXCIpLFo9WS5jcmVhdGVFbGVtZW50KFwiYVwiKSxpZD1CYShNLmxvY2F0aW9uLmhyZWYpO0RjLiRpbmplY3Q9W1wiJHByb3ZpZGVcIl07amQuJGluamVjdD1bXCIkbG9jYWxlXCJdO2xkLiRpbmplY3Q9W1wiJGxvY2FsZVwiXTt2YXIgb2Q9XCIuXCIsTWY9e3l5eXk6JChcIkZ1bGxZZWFyXCIsNCkseXk6JChcIkZ1bGxZZWFyXCIsMiwwLCEwKSx5OiQoXCJGdWxsWWVhclwiLDEpLE1NTU06SWIoXCJNb250aFwiKSxNTU06SWIoXCJNb250aFwiLCEwKSxNTTokKFwiTW9udGhcIiwyLDEpLE06JChcIk1vbnRoXCIsMSwxKSxkZDokKFwiRGF0ZVwiLDIpLGQ6JChcIkRhdGVcIixcclxuMSksSEg6JChcIkhvdXJzXCIsMiksSDokKFwiSG91cnNcIiwxKSxoaDokKFwiSG91cnNcIiwyLC0xMiksaDokKFwiSG91cnNcIiwxLC0xMiksbW06JChcIk1pbnV0ZXNcIiwyKSxtOiQoXCJNaW51dGVzXCIsMSksc3M6JChcIlNlY29uZHNcIiwyKSxzOiQoXCJTZWNvbmRzXCIsMSksc3NzOiQoXCJNaWxsaXNlY29uZHNcIiwzKSxFRUVFOkliKFwiRGF5XCIpLEVFRTpJYihcIkRheVwiLCEwKSxhOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIDEyPmEuZ2V0SG91cnMoKT9jLkFNUE1TWzBdOmMuQU1QTVNbMV19LFo6ZnVuY3Rpb24oYSl7YT0tMSphLmdldFRpbWV6b25lT2Zmc2V0KCk7cmV0dXJuIGE9KDA8PWE/XCIrXCI6XCJcIikrKEhiKE1hdGhbMDxhP1wiZmxvb3JcIjpcImNlaWxcIl0oYS82MCksMikrSGIoTWF0aC5hYnMoYSU2MCksMikpfSx3dzpxZCgyKSx3OnFkKDEpfSxMZj0vKCg/OlteeU1kSGhtc2FaRXcnXSspfCg/OicoPzpbXiddfCcnKSonKXwoPzpFK3x5K3xNK3xkK3xIK3xoK3xtK3xzK3xhfFp8dyspKSguKikvLEtmPS9eXFwtP1xcZCskLztcclxua2QuJGluamVjdD1bXCIkbG9jYWxlXCJdO3ZhciBIZj1kYShRKSxJZj1kYSh1Yik7bWQuJGluamVjdD1bXCIkcGFyc2VcIl07dmFyIFRkPWRhKHtyZXN0cmljdDpcIkVcIixjb21waWxlOmZ1bmN0aW9uKGEsYyl7aWYoIWMuaHJlZiYmIWMueGxpbmtIcmVmJiYhYy5uYW1lKXJldHVybiBmdW5jdGlvbihhLGMpe3ZhciBmPVwiW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ11cIj09PURhLmNhbGwoYy5wcm9wKFwiaHJlZlwiKSk/XCJ4bGluazpocmVmXCI6XCJocmVmXCI7Yy5vbihcImNsaWNrXCIsZnVuY3Rpb24oYSl7Yy5hdHRyKGYpfHxhLnByZXZlbnREZWZhdWx0KCl9KX19fSksdmI9e307cyhFYixmdW5jdGlvbihhLGMpe2lmKFwibXVsdGlwbGVcIiE9YSl7dmFyIGQ9eWEoXCJuZy1cIitjKTt2YltkXT1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixwcmlvcml0eToxMDAsbGluazpmdW5jdGlvbihhLGYsZyl7YS4kd2F0Y2goZ1tkXSxmdW5jdGlvbihhKXtnLiRzZXQoYywhIWEpfSl9fX19fSk7cyhOYyxmdW5jdGlvbihhLFxyXG5jKXt2YltjXT1mdW5jdGlvbigpe3JldHVybntwcmlvcml0eToxMDAsbGluazpmdW5jdGlvbihhLGUsZil7aWYoXCJuZ1BhdHRlcm5cIj09PWMmJlwiL1wiPT1mLm5nUGF0dGVybi5jaGFyQXQoMCkmJihlPWYubmdQYXR0ZXJuLm1hdGNoKE9mKSkpe2YuJHNldChcIm5nUGF0dGVyblwiLG5ldyBSZWdFeHAoZVsxXSxlWzJdKSk7cmV0dXJufWEuJHdhdGNoKGZbY10sZnVuY3Rpb24oYSl7Zi4kc2V0KGMsYSl9KX19fX0pO3MoW1wic3JjXCIsXCJzcmNzZXRcIixcImhyZWZcIl0sZnVuY3Rpb24oYSl7dmFyIGM9eWEoXCJuZy1cIithKTt2YltjXT1mdW5jdGlvbigpe3JldHVybntwcmlvcml0eTo5OSxsaW5rOmZ1bmN0aW9uKGQsZSxmKXt2YXIgZz1hLGg9YTtcImhyZWZcIj09PWEmJlwiW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ11cIj09PURhLmNhbGwoZS5wcm9wKFwiaHJlZlwiKSkmJihoPVwieGxpbmtIcmVmXCIsZi4kYXR0cltoXT1cInhsaW5rOmhyZWZcIixnPW51bGwpO2YuJG9ic2VydmUoYyxmdW5jdGlvbihjKXtjPyhmLiRzZXQoaCxcclxuYyksUmEmJmcmJmUucHJvcChnLGZbaF0pKTpcImhyZWZcIj09PWEmJmYuJHNldChoLG51bGwpfSl9fX19KTt2YXIgSmI9eyRhZGRDb250cm9sOkgsJCRyZW5hbWVDb250cm9sOmZ1bmN0aW9uKGEsYyl7YS4kbmFtZT1jfSwkcmVtb3ZlQ29udHJvbDpILCRzZXRWYWxpZGl0eTpILCRzZXREaXJ0eTpILCRzZXRQcmlzdGluZTpILCRzZXRTdWJtaXR0ZWQ6SH07cmQuJGluamVjdD1bXCIkZWxlbWVudFwiLFwiJGF0dHJzXCIsXCIkc2NvcGVcIixcIiRhbmltYXRlXCIsXCIkaW50ZXJwb2xhdGVcIl07dmFyIHlkPWZ1bmN0aW9uKGEpe3JldHVybltcIiR0aW1lb3V0XCIsZnVuY3Rpb24oYyl7cmV0dXJue25hbWU6XCJmb3JtXCIscmVzdHJpY3Q6YT9cIkVBQ1wiOlwiRVwiLGNvbnRyb2xsZXI6cmQsY29tcGlsZTpmdW5jdGlvbihhKXthLmFkZENsYXNzKFNhKS5hZGRDbGFzcyhrYik7cmV0dXJue3ByZTpmdW5jdGlvbihhLGQsZyxoKXtpZighKFwiYWN0aW9uXCJpbiBnKSl7dmFyIGw9ZnVuY3Rpb24oYyl7YS4kYXBwbHkoZnVuY3Rpb24oKXtoLiRjb21taXRWaWV3VmFsdWUoKTtcclxuaC4kc2V0U3VibWl0dGVkKCl9KTtjLnByZXZlbnREZWZhdWx0KCl9O2RbMF0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLGwsITEpO2Qub24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7YyhmdW5jdGlvbigpe2RbMF0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLGwsITEpfSwwLCExKX0pfXZhciBrPWguJCRwYXJlbnRGb3JtLG09aC4kbmFtZTttJiYoZ2IoYSxudWxsLG0saCxtKSxnLiRvYnNlcnZlKGcubmFtZT9cIm5hbWVcIjpcIm5nRm9ybVwiLGZ1bmN0aW9uKGMpe20hPT1jJiYoZ2IoYSxudWxsLG0sdCxtKSxtPWMsZ2IoYSxudWxsLG0saCxtKSxrLiQkcmVuYW1lQ29udHJvbChoLG0pKX0pKTtkLm9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2suJHJlbW92ZUNvbnRyb2woaCk7bSYmZ2IoYSxudWxsLG0sdCxtKTt6KGgsSmIpfSl9fX19fV19LFVkPXlkKCksZ2U9eWQoITApLE5mPS9cXGR7NH0tWzAxXVxcZC1bMC0zXVxcZFRbMC0yXVxcZDpbMC01XVxcZDpbMC01XVxcZFxcLlxcZCsoWystXVswLTJdXFxkOlswLTVdXFxkfFopLyxcclxuWWY9L14oZnRwfGh0dHB8aHR0cHMpOlxcL1xcLyhcXHcrOnswLDF9XFx3KkApPyhcXFMrKSg6WzAtOV0rKT8oXFwvfFxcLyhbXFx3IyE6Lj8rPSYlQCFcXC1cXC9dKSk/JC8sWmY9L15bYS16MC05ISMkJSYnKitcXC89P15fYHt8fX4uLV0rQFthLXowLTldKFthLXowLTktXSpbYS16MC05XSk/KFxcLlthLXowLTldKFthLXowLTktXSpbYS16MC05XSk/KSokL2ksJGY9L15cXHMqKFxcLXxcXCspPyhcXGQrfChcXGQqKFxcLlxcZCopKSlcXHMqJC8semQ9L14oXFxkezR9KS0oXFxkezJ9KS0oXFxkezJ9KSQvLEFkPS9eKFxcZHs0fSktKFxcZFxcZCktKFxcZFxcZClUKFxcZFxcZCk6KFxcZFxcZCkoPzo6KFxcZFxcZCkoXFwuXFxkezEsM30pPyk/JC8samM9L14oXFxkezR9KS1XKFxcZFxcZCkkLyxCZD0vXihcXGR7NH0pLShcXGRcXGQpJC8sQ2Q9L14oXFxkXFxkKTooXFxkXFxkKSg/OjooXFxkXFxkKShcXC5cXGR7MSwzfSk/KT8kLyxEZD17dGV4dDpmdW5jdGlvbihhLGMsZCxlLGYsZyl7aWIoYSxjLGQsZSxmLGcpO2hjKGUpfSxkYXRlOmpiKFwiZGF0ZVwiLHpkLExiKHpkLFtcInl5eXlcIixcclxuXCJNTVwiLFwiZGRcIl0pLFwieXl5eS1NTS1kZFwiKSxcImRhdGV0aW1lLWxvY2FsXCI6amIoXCJkYXRldGltZWxvY2FsXCIsQWQsTGIoQWQsXCJ5eXl5IE1NIGRkIEhIIG1tIHNzIHNzc1wiLnNwbGl0KFwiIFwiKSksXCJ5eXl5LU1NLWRkVEhIOm1tOnNzLnNzc1wiKSx0aW1lOmpiKFwidGltZVwiLENkLExiKENkLFtcIkhIXCIsXCJtbVwiLFwic3NcIixcInNzc1wiXSksXCJISDptbTpzcy5zc3NcIiksd2VlazpqYihcIndlZWtcIixqYyxmdW5jdGlvbihhLGMpe2lmKHFhKGEpKXJldHVybiBhO2lmKEYoYSkpe2pjLmxhc3RJbmRleD0wO3ZhciBkPWpjLmV4ZWMoYSk7aWYoZCl7dmFyIGU9K2RbMV0sZj0rZFsyXSxnPWQ9MCxoPTAsbD0wLGs9cGQoZSksZj03KihmLTEpO2MmJihkPWMuZ2V0SG91cnMoKSxnPWMuZ2V0TWludXRlcygpLGg9Yy5nZXRTZWNvbmRzKCksbD1jLmdldE1pbGxpc2Vjb25kcygpKTtyZXR1cm4gbmV3IERhdGUoZSwwLGsuZ2V0RGF0ZSgpK2YsZCxnLGgsbCl9fXJldHVybiBOYU59LFwieXl5eS1Xd3dcIiksbW9udGg6amIoXCJtb250aFwiLFxyXG5CZCxMYihCZCxbXCJ5eXl5XCIsXCJNTVwiXSksXCJ5eXl5LU1NXCIpLG51bWJlcjpmdW5jdGlvbihhLGMsZCxlLGYsZyl7dGQoYSxjLGQsZSk7aWIoYSxjLGQsZSxmLGcpO2UuJCRwYXJzZXJOYW1lPVwibnVtYmVyXCI7ZS4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBlLiRpc0VtcHR5KGEpP251bGw6JGYudGVzdChhKT9wYXJzZUZsb2F0KGEpOnR9KTtlLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7aWYoIWUuJGlzRW1wdHkoYSkpe2lmKCFWKGEpKXRocm93IE1iKFwibnVtZm10XCIsYSk7YT1hLnRvU3RyaW5nKCl9cmV0dXJuIGF9KTtpZihkLm1pbnx8ZC5uZ01pbil7dmFyIGg7ZS4kdmFsaWRhdG9ycy5taW49ZnVuY3Rpb24oYSl7cmV0dXJuIGUuJGlzRW1wdHkoYSl8fEEoaCl8fGE+PWh9O2QuJG9ic2VydmUoXCJtaW5cIixmdW5jdGlvbihhKXt5KGEpJiYhVihhKSYmKGE9cGFyc2VGbG9hdChhLDEwKSk7aD1WKGEpJiYhaXNOYU4oYSk/YTp0O2UuJHZhbGlkYXRlKCl9KX1pZihkLm1heHx8XHJcbmQubmdNYXgpe3ZhciBsO2UuJHZhbGlkYXRvcnMubWF4PWZ1bmN0aW9uKGEpe3JldHVybiBlLiRpc0VtcHR5KGEpfHxBKGwpfHxhPD1sfTtkLiRvYnNlcnZlKFwibWF4XCIsZnVuY3Rpb24oYSl7eShhKSYmIVYoYSkmJihhPXBhcnNlRmxvYXQoYSwxMCkpO2w9VihhKSYmIWlzTmFOKGEpP2E6dDtlLiR2YWxpZGF0ZSgpfSl9fSx1cmw6ZnVuY3Rpb24oYSxjLGQsZSxmLGcpe2liKGEsYyxkLGUsZixnKTtoYyhlKTtlLiQkcGFyc2VyTmFtZT1cInVybFwiO2UuJHZhbGlkYXRvcnMudXJsPWZ1bmN0aW9uKGEsYyl7dmFyIGQ9YXx8YztyZXR1cm4gZS4kaXNFbXB0eShkKXx8WWYudGVzdChkKX19LGVtYWlsOmZ1bmN0aW9uKGEsYyxkLGUsZixnKXtpYihhLGMsZCxlLGYsZyk7aGMoZSk7ZS4kJHBhcnNlck5hbWU9XCJlbWFpbFwiO2UuJHZhbGlkYXRvcnMuZW1haWw9ZnVuY3Rpb24oYSxjKXt2YXIgZD1hfHxjO3JldHVybiBlLiRpc0VtcHR5KGQpfHxaZi50ZXN0KGQpfX0scmFkaW86ZnVuY3Rpb24oYSxjLFxyXG5kLGUpe0EoZC5uYW1lKSYmYy5hdHRyKFwibmFtZVwiLCsrbmIpO2Mub24oXCJjbGlja1wiLGZ1bmN0aW9uKGEpe2NbMF0uY2hlY2tlZCYmZS4kc2V0Vmlld1ZhbHVlKGQudmFsdWUsYSYmYS50eXBlKX0pO2UuJHJlbmRlcj1mdW5jdGlvbigpe2NbMF0uY2hlY2tlZD1kLnZhbHVlPT1lLiR2aWV3VmFsdWV9O2QuJG9ic2VydmUoXCJ2YWx1ZVwiLGUuJHJlbmRlcil9LGNoZWNrYm94OmZ1bmN0aW9uKGEsYyxkLGUsZixnLGgsbCl7dmFyIGs9dWQobCxhLFwibmdUcnVlVmFsdWVcIixkLm5nVHJ1ZVZhbHVlLCEwKSxtPXVkKGwsYSxcIm5nRmFsc2VWYWx1ZVwiLGQubmdGYWxzZVZhbHVlLCExKTtjLm9uKFwiY2xpY2tcIixmdW5jdGlvbihhKXtlLiRzZXRWaWV3VmFsdWUoY1swXS5jaGVja2VkLGEmJmEudHlwZSl9KTtlLiRyZW5kZXI9ZnVuY3Rpb24oKXtjWzBdLmNoZWNrZWQ9ZS4kdmlld1ZhbHVlfTtlLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiExPT09YX07ZS4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBmYShhLFxyXG5rKX0pO2UuJHBhcnNlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gYT9rOm19KX0saGlkZGVuOkgsYnV0dG9uOkgsc3VibWl0OkgscmVzZXQ6SCxmaWxlOkh9LHhjPVtcIiRicm93c2VyXCIsXCIkc25pZmZlclwiLFwiJGZpbHRlclwiLFwiJHBhcnNlXCIsZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHJlcXVpcmU6W1wiP25nTW9kZWxcIl0sbGluazp7cHJlOmZ1bmN0aW9uKGYsZyxoLGwpe2xbMF0mJihEZFtRKGgudHlwZSldfHxEZC50ZXh0KShmLGcsaCxsWzBdLGMsYSxkLGUpfX19fV0sYWc9L14odHJ1ZXxmYWxzZXxcXGQrKSQvLHllPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHByaW9yaXR5OjEwMCxjb21waWxlOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIGFnLnRlc3QoYy5uZ1ZhbHVlKT9mdW5jdGlvbihhLGMsZil7Zi4kc2V0KFwidmFsdWVcIixhLiRldmFsKGYubmdWYWx1ZSkpfTpmdW5jdGlvbihhLGMsZil7YS4kd2F0Y2goZi5uZ1ZhbHVlLGZ1bmN0aW9uKGEpe2YuJHNldChcInZhbHVlXCIsXHJcbmEpfSl9fX19LFpkPVtcIiRjb21waWxlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiQUNcIixjb21waWxlOmZ1bmN0aW9uKGMpe2EuJCRhZGRCaW5kaW5nQ2xhc3MoYyk7cmV0dXJuIGZ1bmN0aW9uKGMsZSxmKXthLiQkYWRkQmluZGluZ0luZm8oZSxmLm5nQmluZCk7ZT1lWzBdO2MuJHdhdGNoKGYubmdCaW5kLGZ1bmN0aW9uKGEpe2UudGV4dENvbnRlbnQ9YT09PXQ/XCJcIjphfSl9fX19XSxhZT1bXCIkaW50ZXJwb2xhdGVcIixcIiRjb21waWxlXCIsZnVuY3Rpb24oYSxjKXtyZXR1cm57Y29tcGlsZTpmdW5jdGlvbihkKXtjLiQkYWRkQmluZGluZ0NsYXNzKGQpO3JldHVybiBmdW5jdGlvbihkLGYsZyl7ZD1hKGYuYXR0cihnLiRhdHRyLm5nQmluZFRlbXBsYXRlKSk7Yy4kJGFkZEJpbmRpbmdJbmZvKGYsZC5leHByZXNzaW9ucyk7Zj1mWzBdO2cuJG9ic2VydmUoXCJuZ0JpbmRUZW1wbGF0ZVwiLGZ1bmN0aW9uKGEpe2YudGV4dENvbnRlbnQ9YT09PXQ/XCJcIjphfSl9fX19XSwkZD1bXCIkc2NlXCIsXHJcblwiJHBhcnNlXCIsXCIkY29tcGlsZVwiLGZ1bmN0aW9uKGEsYyxkKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsY29tcGlsZTpmdW5jdGlvbihlLGYpe3ZhciBnPWMoZi5uZ0JpbmRIdG1sKSxoPWMoZi5uZ0JpbmRIdG1sLGZ1bmN0aW9uKGEpe3JldHVybihhfHxcIlwiKS50b1N0cmluZygpfSk7ZC4kJGFkZEJpbmRpbmdDbGFzcyhlKTtyZXR1cm4gZnVuY3Rpb24oYyxlLGYpe2QuJCRhZGRCaW5kaW5nSW5mbyhlLGYubmdCaW5kSHRtbCk7Yy4kd2F0Y2goaCxmdW5jdGlvbigpe2UuaHRtbChhLmdldFRydXN0ZWRIdG1sKGcoYykpfHxcIlwiKX0pfX19fV0seGU9ZGEoe3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6XCJuZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXtlLiR2aWV3Q2hhbmdlTGlzdGVuZXJzLnB1c2goZnVuY3Rpb24oKXthLiRldmFsKGQubmdDaGFuZ2UpfSl9fSksYmU9aWMoXCJcIiwhMCksZGU9aWMoXCJPZGRcIiwwKSxjZT1pYyhcIkV2ZW5cIiwxKSxlZT1KYSh7Y29tcGlsZTpmdW5jdGlvbihhLGMpe2MuJHNldChcIm5nQ2xvYWtcIixcclxudCk7YS5yZW1vdmVDbGFzcyhcIm5nLWNsb2FrXCIpfX0pLGZlPVtmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixzY29wZTohMCxjb250cm9sbGVyOlwiQFwiLHByaW9yaXR5OjUwMH19XSxDYz17fSxiZz17Ymx1cjohMCxmb2N1czohMH07cyhcImNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgbW91c2VlbnRlciBtb3VzZWxlYXZlIGtleWRvd24ga2V5dXAga2V5cHJlc3Mgc3VibWl0IGZvY3VzIGJsdXIgY29weSBjdXQgcGFzdGVcIi5zcGxpdChcIiBcIiksZnVuY3Rpb24oYSl7dmFyIGM9eWEoXCJuZy1cIithKTtDY1tjXT1bXCIkcGFyc2VcIixcIiRyb290U2NvcGVcIixmdW5jdGlvbihkLGUpe3JldHVybntyZXN0cmljdDpcIkFcIixjb21waWxlOmZ1bmN0aW9uKGYsZyl7dmFyIGg9ZChnW2NdLG51bGwsITApO3JldHVybiBmdW5jdGlvbihjLGQpe2Qub24oYSxmdW5jdGlvbihkKXt2YXIgZj1mdW5jdGlvbigpe2goYyx7JGV2ZW50OmR9KX07XHJcbmJnW2FdJiZlLiQkcGhhc2U/Yy4kZXZhbEFzeW5jKGYpOmMuJGFwcGx5KGYpfSl9fX19XX0pO3ZhciBpZT1bXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybnttdWx0aUVsZW1lbnQ6ITAsdHJhbnNjbHVkZTpcImVsZW1lbnRcIixwcmlvcml0eTo2MDAsdGVybWluYWw6ITAscmVzdHJpY3Q6XCJBXCIsJCR0bGI6ITAsbGluazpmdW5jdGlvbihjLGQsZSxmLGcpe3ZhciBoLGwsaztjLiR3YXRjaChlLm5nSWYsZnVuY3Rpb24oYyl7Yz9sfHxnKGZ1bmN0aW9uKGMsZil7bD1mO2NbYy5sZW5ndGgrK109WS5jcmVhdGVDb21tZW50KFwiIGVuZCBuZ0lmOiBcIitlLm5nSWYrXCIgXCIpO2g9e2Nsb25lOmN9O2EuZW50ZXIoYyxkLnBhcmVudCgpLGQpfSk6KGsmJihrLnJlbW92ZSgpLGs9bnVsbCksbCYmKGwuJGRlc3Ryb3koKSxsPW51bGwpLGgmJihrPXRiKGguY2xvbmUpLGEubGVhdmUoaykudGhlbihmdW5jdGlvbigpe2s9bnVsbH0pLGg9bnVsbCkpfSl9fX1dLGplPVtcIiR0ZW1wbGF0ZVJlcXVlc3RcIixcIiRhbmNob3JTY3JvbGxcIixcclxuXCIkYW5pbWF0ZVwiLFwiJHNjZVwiLGZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybntyZXN0cmljdDpcIkVDQVwiLHByaW9yaXR5OjQwMCx0ZXJtaW5hbDohMCx0cmFuc2NsdWRlOlwiZWxlbWVudFwiLGNvbnRyb2xsZXI6Z2Eubm9vcCxjb21waWxlOmZ1bmN0aW9uKGYsZyl7dmFyIGg9Zy5uZ0luY2x1ZGV8fGcuc3JjLGw9Zy5vbmxvYWR8fFwiXCIsaz1nLmF1dG9zY3JvbGw7cmV0dXJuIGZ1bmN0aW9uKGYsZyxxLHMscil7dmFyIHQ9MCxuLHYsdyxMPWZ1bmN0aW9uKCl7diYmKHYucmVtb3ZlKCksdj1udWxsKTtuJiYobi4kZGVzdHJveSgpLG49bnVsbCk7dyYmKGQubGVhdmUodykudGhlbihmdW5jdGlvbigpe3Y9bnVsbH0pLHY9dyx3PW51bGwpfTtmLiR3YXRjaChlLnBhcnNlQXNSZXNvdXJjZVVybChoKSxmdW5jdGlvbihlKXt2YXIgaD1mdW5jdGlvbigpeyF5KGspfHxrJiYhZi4kZXZhbChrKXx8YygpfSxxPSsrdDtlPyhhKGUsITApLnRoZW4oZnVuY3Rpb24oYSl7aWYocT09PXQpe3ZhciBjPWYuJG5ldygpO1xyXG5zLnRlbXBsYXRlPWE7YT1yKGMsZnVuY3Rpb24oYSl7TCgpO2QuZW50ZXIoYSxudWxsLGcpLnRoZW4oaCl9KTtuPWM7dz1hO24uJGVtaXQoXCIkaW5jbHVkZUNvbnRlbnRMb2FkZWRcIixlKTtmLiRldmFsKGwpfX0sZnVuY3Rpb24oKXtxPT09dCYmKEwoKSxmLiRlbWl0KFwiJGluY2x1ZGVDb250ZW50RXJyb3JcIixlKSl9KSxmLiRlbWl0KFwiJGluY2x1ZGVDb250ZW50UmVxdWVzdGVkXCIsZSkpOihMKCkscy50ZW1wbGF0ZT1udWxsKX0pfX19fV0sQWU9W1wiJGNvbXBpbGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQ0FcIixwcmlvcml0eTotNDAwLHJlcXVpcmU6XCJuZ0luY2x1ZGVcIixsaW5rOmZ1bmN0aW9uKGMsZCxlLGYpey9TVkcvLnRlc3QoZFswXS50b1N0cmluZygpKT8oZC5lbXB0eSgpLGEoRmMoZi50ZW1wbGF0ZSxZKS5jaGlsZE5vZGVzKShjLGZ1bmN0aW9uKGEpe2QuYXBwZW5kKGEpfSx7ZnV0dXJlUGFyZW50RWxlbWVudDpkfSkpOihkLmh0bWwoZi50ZW1wbGF0ZSksYShkLmNvbnRlbnRzKCkpKGMpKX19fV0sXHJcbmtlPUphKHtwcmlvcml0eTo0NTAsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwcmU6ZnVuY3Rpb24oYSxjLGQpe2EuJGV2YWwoZC5uZ0luaXQpfX19fSksd2U9ZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscHJpb3JpdHk6MTAwLHJlcXVpcmU6XCJuZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXt2YXIgZj1jLmF0dHIoZC4kYXR0ci5uZ0xpc3QpfHxcIiwgXCIsZz1cImZhbHNlXCIhPT1kLm5nVHJpbSxoPWc/VShmKTpmO2UuJHBhcnNlcnMucHVzaChmdW5jdGlvbihhKXtpZighQShhKSl7dmFyIGM9W107YSYmcyhhLnNwbGl0KGgpLGZ1bmN0aW9uKGEpe2EmJmMucHVzaChnP1UoYSk6YSl9KTtyZXR1cm4gY319KTtlLiRmb3JtYXR0ZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIEQoYSk/YS5qb2luKGYpOnR9KTtlLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiFhfHwhYS5sZW5ndGh9fX19LGtiPVwibmctdmFsaWRcIix2ZD1cIm5nLWludmFsaWRcIixTYT1cIm5nLXByaXN0aW5lXCIsXHJcbktiPVwibmctZGlydHlcIix4ZD1cIm5nLXBlbmRpbmdcIixNYj1uZXcgVChcIm5nTW9kZWxcIiksY2c9W1wiJHNjb3BlXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJGF0dHJzXCIsXCIkZWxlbWVudFwiLFwiJHBhcnNlXCIsXCIkYW5pbWF0ZVwiLFwiJHRpbWVvdXRcIixcIiRyb290U2NvcGVcIixcIiRxXCIsXCIkaW50ZXJwb2xhdGVcIixmdW5jdGlvbihhLGMsZCxlLGYsZyxoLGwsayxtKXt0aGlzLiRtb2RlbFZhbHVlPXRoaXMuJHZpZXdWYWx1ZT1OdW1iZXIuTmFOO3RoaXMuJCRyYXdNb2RlbFZhbHVlPXQ7dGhpcy4kdmFsaWRhdG9ycz17fTt0aGlzLiRhc3luY1ZhbGlkYXRvcnM9e307dGhpcy4kcGFyc2Vycz1bXTt0aGlzLiRmb3JtYXR0ZXJzPVtdO3RoaXMuJHZpZXdDaGFuZ2VMaXN0ZW5lcnM9W107dGhpcy4kdW50b3VjaGVkPSEwO3RoaXMuJHRvdWNoZWQ9ITE7dGhpcy4kcHJpc3RpbmU9ITA7dGhpcy4kZGlydHk9ITE7dGhpcy4kdmFsaWQ9ITA7dGhpcy4kaW52YWxpZD0hMTt0aGlzLiRlcnJvcj17fTt0aGlzLiQkc3VjY2Vzcz1cclxue307dGhpcy4kcGVuZGluZz10O3RoaXMuJG5hbWU9bShkLm5hbWV8fFwiXCIsITEpKGEpO3ZhciBwPWYoZC5uZ01vZGVsKSxxPXAuYXNzaWduLHU9cCxyPXEsTz1udWxsLG49dGhpczt0aGlzLiQkc2V0T3B0aW9ucz1mdW5jdGlvbihhKXtpZigobi4kb3B0aW9ucz1hKSYmYS5nZXR0ZXJTZXR0ZXIpe3ZhciBjPWYoZC5uZ01vZGVsK1wiKClcIiksZz1mKGQubmdNb2RlbCtcIigkJCRwKVwiKTt1PWZ1bmN0aW9uKGEpe3ZhciBkPXAoYSk7RyhkKSYmKGQ9YyhhKSk7cmV0dXJuIGR9O3I9ZnVuY3Rpb24oYSxjKXtHKHAoYSkpP2coYSx7JCQkcDpuLiRtb2RlbFZhbHVlfSk6cShhLG4uJG1vZGVsVmFsdWUpfX1lbHNlIGlmKCFwLmFzc2lnbil0aHJvdyBNYihcIm5vbmFzc2lnblwiLGQubmdNb2RlbCx2YShlKSk7fTt0aGlzLiRyZW5kZXI9SDt0aGlzLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiBBKGEpfHxcIlwiPT09YXx8bnVsbD09PWF8fGEhPT1hfTt2YXIgdj1lLmluaGVyaXRlZERhdGEoXCIkZm9ybUNvbnRyb2xsZXJcIil8fFxyXG5KYix3PTA7c2Qoe2N0cmw6dGhpcywkZWxlbWVudDplLHNldDpmdW5jdGlvbihhLGMpe2FbY109ITB9LHVuc2V0OmZ1bmN0aW9uKGEsYyl7ZGVsZXRlIGFbY119LHBhcmVudEZvcm06diwkYW5pbWF0ZTpnfSk7dGhpcy4kc2V0UHJpc3RpbmU9ZnVuY3Rpb24oKXtuLiRkaXJ0eT0hMTtuLiRwcmlzdGluZT0hMDtnLnJlbW92ZUNsYXNzKGUsS2IpO2cuYWRkQ2xhc3MoZSxTYSl9O3RoaXMuJHNldERpcnR5PWZ1bmN0aW9uKCl7bi4kZGlydHk9ITA7bi4kcHJpc3RpbmU9ITE7Zy5yZW1vdmVDbGFzcyhlLFNhKTtnLmFkZENsYXNzKGUsS2IpO3YuJHNldERpcnR5KCl9O3RoaXMuJHNldFVudG91Y2hlZD1mdW5jdGlvbigpe24uJHRvdWNoZWQ9ITE7bi4kdW50b3VjaGVkPSEwO2cuc2V0Q2xhc3MoZSxcIm5nLXVudG91Y2hlZFwiLFwibmctdG91Y2hlZFwiKX07dGhpcy4kc2V0VG91Y2hlZD1mdW5jdGlvbigpe24uJHRvdWNoZWQ9ITA7bi4kdW50b3VjaGVkPSExO2cuc2V0Q2xhc3MoZSxcIm5nLXRvdWNoZWRcIixcclxuXCJuZy11bnRvdWNoZWRcIil9O3RoaXMuJHJvbGxiYWNrVmlld1ZhbHVlPWZ1bmN0aW9uKCl7aC5jYW5jZWwoTyk7bi4kdmlld1ZhbHVlPW4uJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlO24uJHJlbmRlcigpfTt0aGlzLiR2YWxpZGF0ZT1mdW5jdGlvbigpe2lmKCFWKG4uJG1vZGVsVmFsdWUpfHwhaXNOYU4obi4kbW9kZWxWYWx1ZSkpe3ZhciBhPW4uJCRyYXdNb2RlbFZhbHVlLGM9bi4kdmFsaWQsZD1uLiRtb2RlbFZhbHVlLGU9bi4kb3B0aW9ucyYmbi4kb3B0aW9ucy5hbGxvd0ludmFsaWQ7bi4kJHJ1blZhbGlkYXRvcnMobi4kZXJyb3Jbbi4kJHBhcnNlck5hbWV8fFwicGFyc2VcIl0/ITE6dCxhLG4uJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlLGZ1bmN0aW9uKGYpe2V8fGM9PT1mfHwobi4kbW9kZWxWYWx1ZT1mP2E6dCxuLiRtb2RlbFZhbHVlIT09ZCYmbi4kJHdyaXRlTW9kZWxUb1Njb3BlKCkpfSl9fTt0aGlzLiQkcnVuVmFsaWRhdG9ycz1mdW5jdGlvbihhLGMsZCxlKXtmdW5jdGlvbiBmKCl7dmFyIGE9XHJcbiEwO3Mobi4kdmFsaWRhdG9ycyxmdW5jdGlvbihlLGYpe3ZhciBnPWUoYyxkKTthPWEmJmc7aChmLGcpfSk7cmV0dXJuIGE/ITA6KHMobi4kYXN5bmNWYWxpZGF0b3JzLGZ1bmN0aW9uKGEsYyl7aChjLG51bGwpfSksITEpfWZ1bmN0aW9uIGcoKXt2YXIgYT1bXSxlPSEwO3Mobi4kYXN5bmNWYWxpZGF0b3JzLGZ1bmN0aW9uKGYsZyl7dmFyIGw9ZihjLGQpO2lmKCFsfHwhRyhsLnRoZW4pKXRocm93IE1iKFwiJGFzeW5jVmFsaWRhdG9yc1wiLGwpO2goZyx0KTthLnB1c2gobC50aGVuKGZ1bmN0aW9uKCl7aChnLCEwKX0sZnVuY3Rpb24oYSl7ZT0hMTtoKGcsITEpfSkpfSk7YS5sZW5ndGg/ay5hbGwoYSkudGhlbihmdW5jdGlvbigpe2woZSl9LEgpOmwoITApfWZ1bmN0aW9uIGgoYSxjKXttPT09dyYmbi4kc2V0VmFsaWRpdHkoYSxjKX1mdW5jdGlvbiBsKGEpe209PT13JiZlKGEpfXcrKzt2YXIgbT13OyhmdW5jdGlvbihhKXt2YXIgYz1uLiQkcGFyc2VyTmFtZXx8XCJwYXJzZVwiO2lmKGE9PT1cclxudCloKGMsbnVsbCk7ZWxzZSBpZihoKGMsYSksIWEpcmV0dXJuIHMobi4kdmFsaWRhdG9ycyxmdW5jdGlvbihhLGMpe2goYyxudWxsKX0pLHMobi4kYXN5bmNWYWxpZGF0b3JzLGZ1bmN0aW9uKGEsYyl7aChjLG51bGwpfSksITE7cmV0dXJuITB9KShhKT9mKCk/ZygpOmwoITEpOmwoITEpfTt0aGlzLiRjb21taXRWaWV3VmFsdWU9ZnVuY3Rpb24oKXt2YXIgYT1uLiR2aWV3VmFsdWU7aC5jYW5jZWwoTyk7aWYobi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWUhPT1hfHxcIlwiPT09YSYmbi4kJGhhc05hdGl2ZVZhbGlkYXRvcnMpbi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWU9YSxuLiRwcmlzdGluZSYmdGhpcy4kc2V0RGlydHkoKSx0aGlzLiQkcGFyc2VBbmRWYWxpZGF0ZSgpfTt0aGlzLiQkcGFyc2VBbmRWYWxpZGF0ZT1mdW5jdGlvbigpe3ZhciBjPW4uJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlLGQ9QShjKT90OiEwO2lmKGQpZm9yKHZhciBlPTA7ZTxuLiRwYXJzZXJzLmxlbmd0aDtlKyspaWYoYz1cclxubi4kcGFyc2Vyc1tlXShjKSxBKGMpKXtkPSExO2JyZWFrfVYobi4kbW9kZWxWYWx1ZSkmJmlzTmFOKG4uJG1vZGVsVmFsdWUpJiYobi4kbW9kZWxWYWx1ZT11KGEpKTt2YXIgZj1uLiRtb2RlbFZhbHVlLGc9bi4kb3B0aW9ucyYmbi4kb3B0aW9ucy5hbGxvd0ludmFsaWQ7bi4kJHJhd01vZGVsVmFsdWU9YztnJiYobi4kbW9kZWxWYWx1ZT1jLG4uJG1vZGVsVmFsdWUhPT1mJiZuLiQkd3JpdGVNb2RlbFRvU2NvcGUoKSk7bi4kJHJ1blZhbGlkYXRvcnMoZCxjLG4uJCRsYXN0Q29tbWl0dGVkVmlld1ZhbHVlLGZ1bmN0aW9uKGEpe2d8fChuLiRtb2RlbFZhbHVlPWE/Yzp0LG4uJG1vZGVsVmFsdWUhPT1mJiZuLiQkd3JpdGVNb2RlbFRvU2NvcGUoKSl9KX07dGhpcy4kJHdyaXRlTW9kZWxUb1Njb3BlPWZ1bmN0aW9uKCl7cihhLG4uJG1vZGVsVmFsdWUpO3Mobi4kdmlld0NoYW5nZUxpc3RlbmVycyxmdW5jdGlvbihhKXt0cnl7YSgpfWNhdGNoKGQpe2MoZCl9fSl9O3RoaXMuJHNldFZpZXdWYWx1ZT1cclxuZnVuY3Rpb24oYSxjKXtuLiR2aWV3VmFsdWU9YTtuLiRvcHRpb25zJiYhbi4kb3B0aW9ucy51cGRhdGVPbkRlZmF1bHR8fG4uJCRkZWJvdW5jZVZpZXdWYWx1ZUNvbW1pdChjKX07dGhpcy4kJGRlYm91bmNlVmlld1ZhbHVlQ29tbWl0PWZ1bmN0aW9uKGMpe3ZhciBkPTAsZT1uLiRvcHRpb25zO2UmJnkoZS5kZWJvdW5jZSkmJihlPWUuZGVib3VuY2UsVihlKT9kPWU6VihlW2NdKT9kPWVbY106VihlW1wiZGVmYXVsdFwiXSkmJihkPWVbXCJkZWZhdWx0XCJdKSk7aC5jYW5jZWwoTyk7ZD9PPWgoZnVuY3Rpb24oKXtuLiRjb21taXRWaWV3VmFsdWUoKX0sZCk6bC4kJHBoYXNlP24uJGNvbW1pdFZpZXdWYWx1ZSgpOmEuJGFwcGx5KGZ1bmN0aW9uKCl7bi4kY29tbWl0Vmlld1ZhbHVlKCl9KX07YS4kd2F0Y2goZnVuY3Rpb24oKXt2YXIgYz11KGEpO2lmKGMhPT1uLiRtb2RlbFZhbHVlKXtuLiRtb2RlbFZhbHVlPW4uJCRyYXdNb2RlbFZhbHVlPWM7Zm9yKHZhciBkPW4uJGZvcm1hdHRlcnMsZT1kLmxlbmd0aCxcclxuZj1jO2UtLTspZj1kW2VdKGYpO24uJHZpZXdWYWx1ZSE9PWYmJihuLiR2aWV3VmFsdWU9bi4kJGxhc3RDb21taXR0ZWRWaWV3VmFsdWU9ZixuLiRyZW5kZXIoKSxuLiQkcnVuVmFsaWRhdG9ycyh0LGMsZixIKSl9cmV0dXJuIGN9KX1dLHZlPVtcIiRyb290U2NvcGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpbXCJuZ01vZGVsXCIsXCJeP2Zvcm1cIixcIl4/bmdNb2RlbE9wdGlvbnNcIl0sY29udHJvbGxlcjpjZyxwcmlvcml0eToxLGNvbXBpbGU6ZnVuY3Rpb24oYyl7Yy5hZGRDbGFzcyhTYSkuYWRkQ2xhc3MoXCJuZy11bnRvdWNoZWRcIikuYWRkQ2xhc3Moa2IpO3JldHVybntwcmU6ZnVuY3Rpb24oYSxjLGYsZyl7dmFyIGg9Z1swXSxsPWdbMV18fEpiO2guJCRzZXRPcHRpb25zKGdbMl0mJmdbMl0uJG9wdGlvbnMpO2wuJGFkZENvbnRyb2woaCk7Zi4kb2JzZXJ2ZShcIm5hbWVcIixmdW5jdGlvbihhKXtoLiRuYW1lIT09YSYmbC4kJHJlbmFtZUNvbnRyb2woaCxhKX0pO2EuJG9uKFwiJGRlc3Ryb3lcIixcclxuZnVuY3Rpb24oKXtsLiRyZW1vdmVDb250cm9sKGgpfSl9LHBvc3Q6ZnVuY3Rpb24oYyxlLGYsZyl7dmFyIGg9Z1swXTtpZihoLiRvcHRpb25zJiZoLiRvcHRpb25zLnVwZGF0ZU9uKWUub24oaC4kb3B0aW9ucy51cGRhdGVPbixmdW5jdGlvbihhKXtoLiQkZGVib3VuY2VWaWV3VmFsdWVDb21taXQoYSYmYS50eXBlKX0pO2Uub24oXCJibHVyXCIsZnVuY3Rpb24oZSl7aC4kdG91Y2hlZHx8KGEuJCRwaGFzZT9jLiRldmFsQXN5bmMoaC4kc2V0VG91Y2hlZCk6Yy4kYXBwbHkoaC4kc2V0VG91Y2hlZCkpfSl9fX19fV0sZGc9LyhcXHMrfF4pZGVmYXVsdChcXHMrfCQpLyx6ZT1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixjb250cm9sbGVyOltcIiRzY29wZVwiLFwiJGF0dHJzXCIsZnVuY3Rpb24oYSxjKXt2YXIgZD10aGlzO3RoaXMuJG9wdGlvbnM9YS4kZXZhbChjLm5nTW9kZWxPcHRpb25zKTt0aGlzLiRvcHRpb25zLnVwZGF0ZU9uIT09dD8odGhpcy4kb3B0aW9ucy51cGRhdGVPbkRlZmF1bHQ9XHJcbiExLHRoaXMuJG9wdGlvbnMudXBkYXRlT249VSh0aGlzLiRvcHRpb25zLnVwZGF0ZU9uLnJlcGxhY2UoZGcsZnVuY3Rpb24oKXtkLiRvcHRpb25zLnVwZGF0ZU9uRGVmYXVsdD0hMDtyZXR1cm5cIiBcIn0pKSk6dGhpcy4kb3B0aW9ucy51cGRhdGVPbkRlZmF1bHQ9ITB9XX19LGxlPUphKHt0ZXJtaW5hbDohMCxwcmlvcml0eToxRTN9KSxtZT1bXCIkbG9jYWxlXCIsXCIkaW50ZXJwb2xhdGVcIixmdW5jdGlvbihhLGMpe3ZhciBkPS97fS9nLGU9L153aGVuKE1pbnVzKT8oLispJC87cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixsaW5rOmZ1bmN0aW9uKGYsZyxoKXtmdW5jdGlvbiBsKGEpe2cudGV4dChhfHxcIlwiKX12YXIgaz1oLmNvdW50LG09aC4kYXR0ci53aGVuJiZnLmF0dHIoaC4kYXR0ci53aGVuKSxwPWgub2Zmc2V0fHwwLHE9Zi4kZXZhbChtKXx8e30sdT17fSxtPWMuc3RhcnRTeW1ib2woKSxyPWMuZW5kU3ltYm9sKCksdD1tK2srXCItXCIrcCtyLG49Z2Eubm9vcCx2O3MoaCxmdW5jdGlvbihhLGMpe3ZhciBkPVxyXG5lLmV4ZWMoYyk7ZCYmKGQ9KGRbMV0/XCItXCI6XCJcIikrUShkWzJdKSxxW2RdPWcuYXR0cihoLiRhdHRyW2NdKSl9KTtzKHEsZnVuY3Rpb24oYSxlKXt1W2VdPWMoYS5yZXBsYWNlKGQsdCkpfSk7Zi4kd2F0Y2goayxmdW5jdGlvbihjKXtjPXBhcnNlRmxvYXQoYyk7dmFyIGQ9aXNOYU4oYyk7ZHx8YyBpbiBxfHwoYz1hLnBsdXJhbENhdChjLXApKTtjPT09dnx8ZCYmaXNOYU4odil8fChuKCksbj1mLiR3YXRjaCh1W2NdLGwpLHY9Yyl9KX19fV0sbmU9W1wiJHBhcnNlXCIsXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9VChcIm5nUmVwZWF0XCIpLGU9ZnVuY3Rpb24oYSxjLGQsZSxrLG0scCl7YVtkXT1lO2smJihhW2tdPW0pO2EuJGluZGV4PWM7YS4kZmlyc3Q9MD09PWM7YS4kbGFzdD1jPT09cC0xO2EuJG1pZGRsZT0hKGEuJGZpcnN0fHxhLiRsYXN0KTthLiRvZGQ9IShhLiRldmVuPTA9PT0oYyYxKSl9O3JldHVybntyZXN0cmljdDpcIkFcIixtdWx0aUVsZW1lbnQ6ITAsdHJhbnNjbHVkZTpcImVsZW1lbnRcIixcclxucHJpb3JpdHk6MUUzLHRlcm1pbmFsOiEwLCQkdGxiOiEwLGNvbXBpbGU6ZnVuY3Rpb24oZixnKXt2YXIgaD1nLm5nUmVwZWF0LGw9WS5jcmVhdGVDb21tZW50KFwiIGVuZCBuZ1JlcGVhdDogXCIraCtcIiBcIiksaz1oLm1hdGNoKC9eXFxzKihbXFxzXFxTXSs/KVxccytpblxccysoW1xcc1xcU10rPykoPzpcXHMrYXNcXHMrKFtcXHNcXFNdKz8pKT8oPzpcXHMrdHJhY2tcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT9cXHMqJC8pO2lmKCFrKXRocm93IGQoXCJpZXhwXCIsaCk7dmFyIG09a1sxXSxwPWtbMl0scT1rWzNdLHU9a1s0XSxrPW0ubWF0Y2goL14oPzooXFxzKltcXCRcXHddKyl8XFwoXFxzKihbXFwkXFx3XSspXFxzKixcXHMqKFtcXCRcXHddKylcXHMqXFwpKSQvKTtpZighayl0aHJvdyBkKFwiaWlkZXhwXCIsbSk7dmFyIHI9a1szXXx8a1sxXSx5PWtbMl07aWYocSYmKCEvXlskYS16QS1aX11bJGEtekEtWjAtOV9dKiQvLnRlc3QocSl8fC9eKG51bGx8dW5kZWZpbmVkfHRoaXN8XFwkaW5kZXh8XFwkZmlyc3R8XFwkbWlkZGxlfFxcJGxhc3R8XFwkZXZlbnxcXCRvZGR8XFwkcGFyZW50KSQvLnRlc3QocSkpKXRocm93IGQoXCJiYWRpZGVudFwiLFxyXG5xKTt2YXIgbix2LHcsQSx6PXskaWQ6TmF9O3U/bj1hKHUpOih3PWZ1bmN0aW9uKGEsYyl7cmV0dXJuIE5hKGMpfSxBPWZ1bmN0aW9uKGEpe3JldHVybiBhfSk7cmV0dXJuIGZ1bmN0aW9uKGEsZixnLGssbSl7biYmKHY9ZnVuY3Rpb24oYyxkLGUpe3kmJih6W3ldPWMpO3pbcl09ZDt6LiRpbmRleD1lO3JldHVybiBuKGEseil9KTt2YXIgdT1oYSgpO2EuJHdhdGNoQ29sbGVjdGlvbihwLGZ1bmN0aW9uKGcpe3ZhciBrLHAsbj1mWzBdLEUsej1oYSgpLEgsUyxOLEQsRyxDLEk7cSYmKGFbcV09Zyk7aWYoVGEoZykpRz1nLHA9dnx8dztlbHNle3A9dnx8QTtHPVtdO2ZvcihJIGluIGcpZy5oYXNPd25Qcm9wZXJ0eShJKSYmXCIkXCIhPUkuY2hhckF0KDApJiZHLnB1c2goSSk7Ry5zb3J0KCl9SD1HLmxlbmd0aDtJPUFycmF5KEgpO2ZvcihrPTA7azxIO2srKylpZihTPWc9PT1HP2s6R1trXSxOPWdbU10sRD1wKFMsTixrKSx1W0RdKUM9dVtEXSxkZWxldGUgdVtEXSx6W0RdPUMsSVtrXT1DO2Vsc2V7aWYoeltEXSl0aHJvdyBzKEksXHJcbmZ1bmN0aW9uKGEpe2EmJmEuc2NvcGUmJih1W2EuaWRdPWEpfSksZChcImR1cGVzXCIsaCxELE4pO0lba109e2lkOkQsc2NvcGU6dCxjbG9uZTp0fTt6W0RdPSEwfWZvcihFIGluIHUpe0M9dVtFXTtEPXRiKEMuY2xvbmUpO2MubGVhdmUoRCk7aWYoRFswXS5wYXJlbnROb2RlKWZvcihrPTAscD1ELmxlbmd0aDtrPHA7aysrKURba10uJCROR19SRU1PVkVEPSEwO0Muc2NvcGUuJGRlc3Ryb3koKX1mb3Ioaz0wO2s8SDtrKyspaWYoUz1nPT09Rz9rOkdba10sTj1nW1NdLEM9SVtrXSxDLnNjb3BlKXtFPW47ZG8gRT1FLm5leHRTaWJsaW5nO3doaWxlKEUmJkUuJCROR19SRU1PVkVEKTtDLmNsb25lWzBdIT1FJiZjLm1vdmUodGIoQy5jbG9uZSksbnVsbCxCKG4pKTtuPUMuY2xvbmVbQy5jbG9uZS5sZW5ndGgtMV07ZShDLnNjb3BlLGsscixOLHksUyxIKX1lbHNlIG0oZnVuY3Rpb24oYSxkKXtDLnNjb3BlPWQ7dmFyIGY9bC5jbG9uZU5vZGUoITEpO2FbYS5sZW5ndGgrK109ZjtjLmVudGVyKGEsXHJcbm51bGwsQihuKSk7bj1mO0MuY2xvbmU9YTt6W0MuaWRdPUM7ZShDLnNjb3BlLGsscixOLHksUyxIKX0pO3U9en0pfX19fV0sb2U9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsbXVsdGlFbGVtZW50OiEwLGxpbms6ZnVuY3Rpb24oYyxkLGUpe2MuJHdhdGNoKGUubmdTaG93LGZ1bmN0aW9uKGMpe2FbYz9cInJlbW92ZUNsYXNzXCI6XCJhZGRDbGFzc1wiXShkLFwibmctaGlkZVwiLHt0ZW1wQ2xhc3NlczpcIm5nLWhpZGUtYW5pbWF0ZVwifSl9KX19fV0saGU9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsbXVsdGlFbGVtZW50OiEwLGxpbms6ZnVuY3Rpb24oYyxkLGUpe2MuJHdhdGNoKGUubmdIaWRlLGZ1bmN0aW9uKGMpe2FbYz9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShkLFwibmctaGlkZVwiLHt0ZW1wQ2xhc3NlczpcIm5nLWhpZGUtYW5pbWF0ZVwifSl9KX19fV0scGU9SmEoZnVuY3Rpb24oYSxjLGQpe2EuJHdhdGNoQ29sbGVjdGlvbihkLm5nU3R5bGUsXHJcbmZ1bmN0aW9uKGEsZCl7ZCYmYSE9PWQmJnMoZCxmdW5jdGlvbihhLGQpe2MuY3NzKGQsXCJcIil9KTthJiZjLmNzcyhhKX0pfSkscWU9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHJlcXVpcmU6XCJuZ1N3aXRjaFwiLGNvbnRyb2xsZXI6W1wiJHNjb3BlXCIsZnVuY3Rpb24oKXt0aGlzLmNhc2VzPXt9fV0sbGluazpmdW5jdGlvbihjLGQsZSxmKXt2YXIgZz1bXSxoPVtdLGw9W10saz1bXSxtPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIGZ1bmN0aW9uKCl7YS5zcGxpY2UoYywxKX19O2MuJHdhdGNoKGUubmdTd2l0Y2h8fGUub24sZnVuY3Rpb24oYyl7dmFyIGQsZTtkPTA7Zm9yKGU9bC5sZW5ndGg7ZDxlOysrZClhLmNhbmNlbChsW2RdKTtkPWwubGVuZ3RoPTA7Zm9yKGU9ay5sZW5ndGg7ZDxlOysrZCl7dmFyIHI9dGIoaFtkXS5jbG9uZSk7a1tkXS4kZGVzdHJveSgpOyhsW2RdPWEubGVhdmUocikpLnRoZW4obShsLGQpKX1oLmxlbmd0aD0wO2subGVuZ3RoPTA7KGc9XHJcbmYuY2FzZXNbXCIhXCIrY118fGYuY2FzZXNbXCI/XCJdKSYmcyhnLGZ1bmN0aW9uKGMpe2MudHJhbnNjbHVkZShmdW5jdGlvbihkLGUpe2sucHVzaChlKTt2YXIgZj1jLmVsZW1lbnQ7ZFtkLmxlbmd0aCsrXT1ZLmNyZWF0ZUNvbW1lbnQoXCIgZW5kIG5nU3dpdGNoV2hlbjogXCIpO2gucHVzaCh7Y2xvbmU6ZH0pO2EuZW50ZXIoZCxmLnBhcmVudCgpLGYpfSl9KX0pfX19XSxyZT1KYSh7dHJhbnNjbHVkZTpcImVsZW1lbnRcIixwcmlvcml0eToxMjAwLHJlcXVpcmU6XCJebmdTd2l0Y2hcIixtdWx0aUVsZW1lbnQ6ITAsbGluazpmdW5jdGlvbihhLGMsZCxlLGYpe2UuY2FzZXNbXCIhXCIrZC5uZ1N3aXRjaFdoZW5dPWUuY2FzZXNbXCIhXCIrZC5uZ1N3aXRjaFdoZW5dfHxbXTtlLmNhc2VzW1wiIVwiK2QubmdTd2l0Y2hXaGVuXS5wdXNoKHt0cmFuc2NsdWRlOmYsZWxlbWVudDpjfSl9fSksc2U9SmEoe3RyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6MTIwMCxyZXF1aXJlOlwiXm5nU3dpdGNoXCIsbXVsdGlFbGVtZW50OiEwLFxyXG5saW5rOmZ1bmN0aW9uKGEsYyxkLGUsZil7ZS5jYXNlc1tcIj9cIl09ZS5jYXNlc1tcIj9cIl18fFtdO2UuY2FzZXNbXCI/XCJdLnB1c2goe3RyYW5zY2x1ZGU6ZixlbGVtZW50OmN9KX19KSx1ZT1KYSh7cmVzdHJpY3Q6XCJFQUNcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUsZil7aWYoIWYpdGhyb3cgVChcIm5nVHJhbnNjbHVkZVwiKShcIm9ycGhhblwiLHZhKGMpKTtmKGZ1bmN0aW9uKGEpe2MuZW1wdHkoKTtjLmFwcGVuZChhKX0pfX0pLFZkPVtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHRlcm1pbmFsOiEwLGNvbXBpbGU6ZnVuY3Rpb24oYyxkKXtcInRleHQvbmctdGVtcGxhdGVcIj09ZC50eXBlJiZhLnB1dChkLmlkLGNbMF0udGV4dCl9fX1dLGVnPVQoXCJuZ09wdGlvbnNcIiksdGU9ZGEoe3Jlc3RyaWN0OlwiQVwiLHRlcm1pbmFsOiEwfSksV2Q9W1wiJGNvbXBpbGVcIixcIiRwYXJzZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9L15cXHMqKFtcXHNcXFNdKz8pKD86XFxzK2FzXFxzKyhbXFxzXFxTXSs/KSk/KD86XFxzK2dyb3VwXFxzK2J5XFxzKyhbXFxzXFxTXSs/KSk/XFxzK2ZvclxccysoPzooW1xcJFxcd11bXFwkXFx3XSopfCg/OlxcKFxccyooW1xcJFxcd11bXFwkXFx3XSopXFxzKixcXHMqKFtcXCRcXHddW1xcJFxcd10qKVxccypcXCkpKVxccytpblxccysoW1xcc1xcU10rPykoPzpcXHMrdHJhY2tcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT8kLyxcclxuZT17JHNldFZpZXdWYWx1ZTpIfTtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpbXCJzZWxlY3RcIixcIj9uZ01vZGVsXCJdLGNvbnRyb2xsZXI6W1wiJGVsZW1lbnRcIixcIiRzY29wZVwiLFwiJGF0dHJzXCIsZnVuY3Rpb24oYSxjLGQpe3ZhciBsPXRoaXMsaz17fSxtPWUscDtsLmRhdGFib3VuZD1kLm5nTW9kZWw7bC5pbml0PWZ1bmN0aW9uKGEsYyxkKXttPWE7cD1kfTtsLmFkZE9wdGlvbj1mdW5jdGlvbihjLGQpe01hKGMsJ1wib3B0aW9uIHZhbHVlXCInKTtrW2NdPSEwO20uJHZpZXdWYWx1ZT09YyYmKGEudmFsKGMpLHAucGFyZW50KCkmJnAucmVtb3ZlKCkpO2QmJmRbMF0uaGFzQXR0cmlidXRlKFwic2VsZWN0ZWRcIikmJihkWzBdLnNlbGVjdGVkPSEwKX07bC5yZW1vdmVPcHRpb249ZnVuY3Rpb24oYSl7dGhpcy5oYXNPcHRpb24oYSkmJihkZWxldGUga1thXSxtLiR2aWV3VmFsdWU9PT1hJiZ0aGlzLnJlbmRlclVua25vd25PcHRpb24oYSkpfTtsLnJlbmRlclVua25vd25PcHRpb249ZnVuY3Rpb24oYyl7Yz1cclxuXCI/IFwiK05hKGMpK1wiID9cIjtwLnZhbChjKTthLnByZXBlbmQocCk7YS52YWwoYyk7cC5wcm9wKFwic2VsZWN0ZWRcIiwhMCl9O2wuaGFzT3B0aW9uPWZ1bmN0aW9uKGEpe3JldHVybiBrLmhhc093blByb3BlcnR5KGEpfTtjLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtsLnJlbmRlclVua25vd25PcHRpb249SH0pfV0sbGluazpmdW5jdGlvbihlLGcsaCxsKXtmdW5jdGlvbiBrKGEsYyxkLGUpe2QuJHJlbmRlcj1mdW5jdGlvbigpe3ZhciBhPWQuJHZpZXdWYWx1ZTtlLmhhc09wdGlvbihhKT8oQy5wYXJlbnQoKSYmQy5yZW1vdmUoKSxjLnZhbChhKSxcIlwiPT09YSYmbi5wcm9wKFwic2VsZWN0ZWRcIiwhMCkpOkEoYSkmJm4/Yy52YWwoXCJcIik6ZS5yZW5kZXJVbmtub3duT3B0aW9uKGEpfTtjLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oKXthLiRhcHBseShmdW5jdGlvbigpe0MucGFyZW50KCkmJkMucmVtb3ZlKCk7ZC4kc2V0Vmlld1ZhbHVlKGMudmFsKCkpfSl9KX1mdW5jdGlvbiBtKGEsYyxkKXt2YXIgZTtcclxuZC4kcmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IGRiKGQuJHZpZXdWYWx1ZSk7cyhjLmZpbmQoXCJvcHRpb25cIiksZnVuY3Rpb24oYyl7Yy5zZWxlY3RlZD15KGEuZ2V0KGMudmFsdWUpKX0pfTthLiR3YXRjaChmdW5jdGlvbigpe2ZhKGUsZC4kdmlld1ZhbHVlKXx8KGU9cmEoZC4kdmlld1ZhbHVlKSxkLiRyZW5kZXIoKSl9KTtjLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oKXthLiRhcHBseShmdW5jdGlvbigpe3ZhciBhPVtdO3MoYy5maW5kKFwib3B0aW9uXCIpLGZ1bmN0aW9uKGMpe2Muc2VsZWN0ZWQmJmEucHVzaChjLnZhbHVlKX0pO2QuJHNldFZpZXdWYWx1ZShhKX0pfSl9ZnVuY3Rpb24gcChlLGYsZyl7ZnVuY3Rpb24gaChhLGMsZCl7VFt4XT1kO0cmJihUW0ddPWMpO3JldHVybiBhKGUsVCl9ZnVuY3Rpb24gayhhKXt2YXIgYztpZih1KWlmKE0mJkQoYSkpe2M9bmV3IGRiKFtdKTtmb3IodmFyIGQ9MDtkPGEubGVuZ3RoO2QrKyljLnB1dChoKE0sbnVsbCxhW2RdKSwhMCl9ZWxzZSBjPVxyXG5uZXcgZGIoYSk7ZWxzZSBNJiYoYT1oKE0sbnVsbCxhKSk7cmV0dXJuIGZ1bmN0aW9uKGQsZSl7dmFyIGY7Zj1NP006Qj9COkY7cmV0dXJuIHU/eShjLnJlbW92ZShoKGYsZCxlKSkpOmE9PT1oKGYsZCxlKX19ZnVuY3Rpb24gbCgpe3Z8fChlLiQkcG9zdERpZ2VzdChwKSx2PSEwKX1mdW5jdGlvbiBtKGEsYyxkKXthW2NdPWFbY118fDA7YVtjXSs9ZD8xOi0xfWZ1bmN0aW9uIHAoKXt2PSExO3ZhciBhPXtcIlwiOltdfSxjPVtcIlwiXSxkLGwsbixyLHQ7bj1nLiR2aWV3VmFsdWU7cj1QKGUpfHxbXTt2YXIgQj1HP09iamVjdC5rZXlzKHIpLnNvcnQoKTpyLHgsQSxELEYsTj17fTt0PWsobik7dmFyIEo9ITEsVSxWO1E9e307Zm9yKEY9MDtEPUIubGVuZ3RoLEY8RDtGKyspe3g9RjtpZihHJiYoeD1CW0ZdLFwiJFwiPT09eC5jaGFyQXQoMCkpKWNvbnRpbnVlO0E9clt4XTtkPWgoSSx4LEEpfHxcIlwiOyhsPWFbZF0pfHwobD1hW2RdPVtdLGMucHVzaChkKSk7ZD10KHgsQSk7Sj1KfHxkO0E9aChDLHgsQSk7XHJcbkE9eShBKT9BOlwiXCI7Vj1NP00oZSxUKTpHP0JbRl06RjtNJiYoUVtWXT14KTtsLnB1c2goe2lkOlYsbGFiZWw6QSxzZWxlY3RlZDpkfSl9dXx8KHp8fG51bGw9PT1uP2FbXCJcIl0udW5zaGlmdCh7aWQ6XCJcIixsYWJlbDpcIlwiLHNlbGVjdGVkOiFKfSk6Snx8YVtcIlwiXS51bnNoaWZ0KHtpZDpcIj9cIixsYWJlbDpcIlwiLHNlbGVjdGVkOiEwfSkpO3g9MDtmb3IoQj1jLmxlbmd0aDt4PEI7eCsrKXtkPWNbeF07bD1hW2RdO1IubGVuZ3RoPD14PyhuPXtlbGVtZW50OkguY2xvbmUoKS5hdHRyKFwibGFiZWxcIixkKSxsYWJlbDpsLmxhYmVsfSxyPVtuXSxSLnB1c2gociksZi5hcHBlbmQobi5lbGVtZW50KSk6KHI9Ult4XSxuPXJbMF0sbi5sYWJlbCE9ZCYmbi5lbGVtZW50LmF0dHIoXCJsYWJlbFwiLG4ubGFiZWw9ZCkpO0o9bnVsbDtGPTA7Zm9yKEQ9bC5sZW5ndGg7RjxEO0YrKylkPWxbRl0sKHQ9cltGKzFdKT8oSj10LmVsZW1lbnQsdC5sYWJlbCE9PWQubGFiZWwmJihtKE4sdC5sYWJlbCwhMSksbShOLGQubGFiZWwsXHJcbiEwKSxKLnRleHQodC5sYWJlbD1kLmxhYmVsKSxKLnByb3AoXCJsYWJlbFwiLHQubGFiZWwpKSx0LmlkIT09ZC5pZCYmSi52YWwodC5pZD1kLmlkKSxKWzBdLnNlbGVjdGVkIT09ZC5zZWxlY3RlZCYmKEoucHJvcChcInNlbGVjdGVkXCIsdC5zZWxlY3RlZD1kLnNlbGVjdGVkKSxSYSYmSi5wcm9wKFwic2VsZWN0ZWRcIix0LnNlbGVjdGVkKSkpOihcIlwiPT09ZC5pZCYmej9VPXo6KFU9dy5jbG9uZSgpKS52YWwoZC5pZCkucHJvcChcInNlbGVjdGVkXCIsZC5zZWxlY3RlZCkuYXR0cihcInNlbGVjdGVkXCIsZC5zZWxlY3RlZCkucHJvcChcImxhYmVsXCIsZC5sYWJlbCkudGV4dChkLmxhYmVsKSxyLnB1c2godD17ZWxlbWVudDpVLGxhYmVsOmQubGFiZWwsaWQ6ZC5pZCxzZWxlY3RlZDpkLnNlbGVjdGVkfSksbShOLGQubGFiZWwsITApLEo/Si5hZnRlcihVKTpuLmVsZW1lbnQuYXBwZW5kKFUpLEo9VSk7Zm9yKEYrKztyLmxlbmd0aD5GOylkPXIucG9wKCksbShOLGQubGFiZWwsITEpLGQuZWxlbWVudC5yZW1vdmUoKX1mb3IoO1IubGVuZ3RoPlxyXG54Oyl7bD1SLnBvcCgpO2ZvcihGPTE7RjxsLmxlbmd0aDsrK0YpbShOLGxbRl0ubGFiZWwsITEpO2xbMF0uZWxlbWVudC5yZW1vdmUoKX1zKE4sZnVuY3Rpb24oYSxjKXswPGE/cS5hZGRPcHRpb24oYyk6MD5hJiZxLnJlbW92ZU9wdGlvbihjKX0pfXZhciBuO2lmKCEobj1yLm1hdGNoKGQpKSl0aHJvdyBlZyhcImlleHBcIixyLHZhKGYpKTt2YXIgQz1jKG5bMl18fG5bMV0pLHg9bls0XXx8bls2XSxBPS8gYXMgLy50ZXN0KG5bMF0pJiZuWzFdLEI9QT9jKEEpOm51bGwsRz1uWzVdLEk9YyhuWzNdfHxcIlwiKSxGPWMoblsyXT9uWzFdOngpLFA9YyhuWzddKSxNPW5bOF0/YyhuWzhdKTpudWxsLFE9e30sUj1bW3tlbGVtZW50OmYsbGFiZWw6XCJcIn1dXSxUPXt9O3omJihhKHopKGUpLHoucmVtb3ZlQ2xhc3MoXCJuZy1zY29wZVwiKSx6LnJlbW92ZSgpKTtmLmVtcHR5KCk7Zi5vbihcImNoYW5nZVwiLGZ1bmN0aW9uKCl7ZS4kYXBwbHkoZnVuY3Rpb24oKXt2YXIgYT1QKGUpfHxbXSxjO2lmKHUpYz1bXSxzKGYudmFsKCksXHJcbmZ1bmN0aW9uKGQpe2Q9TT9RW2RdOmQ7Yy5wdXNoKFwiP1wiPT09ZD90OlwiXCI9PT1kP251bGw6aChCP0I6RixkLGFbZF0pKX0pO2Vsc2V7dmFyIGQ9TT9RW2YudmFsKCldOmYudmFsKCk7Yz1cIj9cIj09PWQ/dDpcIlwiPT09ZD9udWxsOmgoQj9COkYsZCxhW2RdKX1nLiRzZXRWaWV3VmFsdWUoYyk7cCgpfSl9KTtnLiRyZW5kZXI9cDtlLiR3YXRjaENvbGxlY3Rpb24oUCxsKTtlLiR3YXRjaENvbGxlY3Rpb24oZnVuY3Rpb24oKXt2YXIgYT1QKGUpLGM7aWYoYSYmRChhKSl7Yz1BcnJheShhLmxlbmd0aCk7Zm9yKHZhciBkPTAsZj1hLmxlbmd0aDtkPGY7ZCsrKWNbZF09aChDLGQsYVtkXSl9ZWxzZSBpZihhKWZvcihkIGluIGM9e30sYSlhLmhhc093blByb3BlcnR5KGQpJiYoY1tkXT1oKEMsZCxhW2RdKSk7cmV0dXJuIGN9LGwpO3UmJmUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpe3JldHVybiBnLiRtb2RlbFZhbHVlfSxsKX1pZihsWzFdKXt2YXIgcT1sWzBdO2w9bFsxXTt2YXIgdT1oLm11bHRpcGxlLFxyXG5yPWgubmdPcHRpb25zLHo9ITEsbix2PSExLHc9QihZLmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIikpLEg9QihZLmNyZWF0ZUVsZW1lbnQoXCJvcHRncm91cFwiKSksQz13LmNsb25lKCk7aD0wO2Zvcih2YXIgeD1nLmNoaWxkcmVuKCksRz14Lmxlbmd0aDtoPEc7aCsrKWlmKFwiXCI9PT14W2hdLnZhbHVlKXtuPXo9eC5lcShoKTticmVha31xLmluaXQobCx6LEMpO3UmJihsLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiFhfHwwPT09YS5sZW5ndGh9KTtyP3AoZSxnLGwpOnU/bShlLGcsbCk6ayhlLGcsbCxxKX19fX1dLFlkPVtcIiRpbnRlcnBvbGF0ZVwiLGZ1bmN0aW9uKGEpe3ZhciBjPXthZGRPcHRpb246SCxyZW1vdmVPcHRpb246SH07cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHByaW9yaXR5OjEwMCxjb21waWxlOmZ1bmN0aW9uKGQsZSl7aWYoQShlLnZhbHVlKSl7dmFyIGY9YShkLnRleHQoKSwhMCk7Znx8ZS4kc2V0KFwidmFsdWVcIixkLnRleHQoKSl9cmV0dXJuIGZ1bmN0aW9uKGEsZCxlKXt2YXIgaz1cclxuZC5wYXJlbnQoKSxtPWsuZGF0YShcIiRzZWxlY3RDb250cm9sbGVyXCIpfHxrLnBhcmVudCgpLmRhdGEoXCIkc2VsZWN0Q29udHJvbGxlclwiKTttJiZtLmRhdGFib3VuZHx8KG09Yyk7Zj9hLiR3YXRjaChmLGZ1bmN0aW9uKGEsYyl7ZS4kc2V0KFwidmFsdWVcIixhKTtjIT09YSYmbS5yZW1vdmVPcHRpb24oYyk7bS5hZGRPcHRpb24oYSxkKX0pOm0uYWRkT3B0aW9uKGUudmFsdWUsZCk7ZC5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXttLnJlbW92ZU9wdGlvbihlLnZhbHVlKX0pfX19fV0sWGQ9ZGEoe3Jlc3RyaWN0OlwiRVwiLHRlcm1pbmFsOiExfSksemM9ZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIj9uZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXtlJiYoZC5yZXF1aXJlZD0hMCxlLiR2YWxpZGF0b3JzLnJlcXVpcmVkPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIWQucmVxdWlyZWR8fCFlLiRpc0VtcHR5KGMpfSxkLiRvYnNlcnZlKFwicmVxdWlyZWRcIixmdW5jdGlvbigpe2UuJHZhbGlkYXRlKCl9KSl9fX0sXHJcbnljPWZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6XCI/bmdNb2RlbFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSl7aWYoZSl7dmFyIGYsZz1kLm5nUGF0dGVybnx8ZC5wYXR0ZXJuO2QuJG9ic2VydmUoXCJwYXR0ZXJuXCIsZnVuY3Rpb24oYSl7RihhKSYmMDxhLmxlbmd0aCYmKGE9bmV3IFJlZ0V4cChcIl5cIithK1wiJFwiKSk7aWYoYSYmIWEudGVzdCl0aHJvdyBUKFwibmdQYXR0ZXJuXCIpKFwibm9yZWdleHBcIixnLGEsdmEoYykpO2Y9YXx8dDtlLiR2YWxpZGF0ZSgpfSk7ZS4kdmFsaWRhdG9ycy5wYXR0ZXJuPWZ1bmN0aW9uKGEpe3JldHVybiBlLiRpc0VtcHR5KGEpfHxBKGYpfHxmLnRlc3QoYSl9fX19fSxCYz1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixyZXF1aXJlOlwiP25nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2lmKGUpe3ZhciBmPS0xO2QuJG9ic2VydmUoXCJtYXhsZW5ndGhcIixmdW5jdGlvbihhKXthPWJhKGEpO2Y9aXNOYU4oYSk/LTE6YTtlLiR2YWxpZGF0ZSgpfSk7XHJcbmUuJHZhbGlkYXRvcnMubWF4bGVuZ3RoPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIDA+Znx8ZS4kaXNFbXB0eShhKXx8Yy5sZW5ndGg8PWZ9fX19fSxBYz1mdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkFcIixyZXF1aXJlOlwiP25nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2lmKGUpe3ZhciBmPTA7ZC4kb2JzZXJ2ZShcIm1pbmxlbmd0aFwiLGZ1bmN0aW9uKGEpe2Y9YmEoYSl8fDA7ZS4kdmFsaWRhdGUoKX0pO2UuJHZhbGlkYXRvcnMubWlubGVuZ3RoPWZ1bmN0aW9uKGEsYyl7cmV0dXJuIGUuJGlzRW1wdHkoYyl8fGMubGVuZ3RoPj1mfX19fX07TS5hbmd1bGFyLmJvb3RzdHJhcD9jb25zb2xlLmxvZyhcIldBUk5JTkc6IFRyaWVkIHRvIGxvYWQgYW5ndWxhciBtb3JlIHRoYW4gb25jZS5cIik6KE5kKCksUGQoZ2EpLEIoWSkucmVhZHkoZnVuY3Rpb24oKXtKZChZLHNjKX0pKX0pKHdpbmRvdyxkb2N1bWVudCk7IXdpbmRvdy5hbmd1bGFyLiQkY3NwKCkmJndpbmRvdy5hbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQpLmZpbmQoXCJoZWFkXCIpLnByZXBlbmQoJzxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5AY2hhcnNldCBcIlVURi04XCI7W25nXFxcXDpjbG9ha10sW25nLWNsb2FrXSxbZGF0YS1uZy1jbG9ha10sW3gtbmctY2xvYWtdLC5uZy1jbG9haywueC1uZy1jbG9haywubmctaGlkZTpub3QoLm5nLWhpZGUtYW5pbWF0ZSl7ZGlzcGxheTpub25lICFpbXBvcnRhbnQ7fW5nXFxcXDpmb3Jte2Rpc3BsYXk6YmxvY2s7fTwvc3R5bGU+Jyk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFuZ3VsYXIubWluLmpzLm1hcFxyXG4iLCIvKipcclxuICogQGxpY2Vuc2UgQW5ndWxhckpTIHYxLjMuMTFcclxuICogKGMpIDIwMTAtMjAxNCBHb29nbGUsIEluYy4gaHR0cDovL2FuZ3VsYXJqcy5vcmdcclxuICogTGljZW5zZTogTUlUXHJcbiAqL1xyXG4oZnVuY3Rpb24od2luZG93LCBhbmd1bGFyLCB1bmRlZmluZWQpIHsndXNlIHN0cmljdCc7XHJcblxyXG4vKiBqc2hpbnQgbWF4bGVuOiBmYWxzZSAqL1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbmdBbmltYXRlXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKlxyXG4gKiBUaGUgYG5nQW5pbWF0ZWAgbW9kdWxlIHByb3ZpZGVzIHN1cHBvcnQgZm9yIEphdmFTY3JpcHQsIENTUzMgdHJhbnNpdGlvbiBhbmQgQ1NTMyBrZXlmcmFtZSBhbmltYXRpb24gaG9va3Mgd2l0aGluIGV4aXN0aW5nIGNvcmUgYW5kIGN1c3RvbSBkaXJlY3RpdmVzLlxyXG4gKlxyXG4gKiA8ZGl2IGRvYy1tb2R1bGUtY29tcG9uZW50cz1cIm5nQW5pbWF0ZVwiPjwvZGl2PlxyXG4gKlxyXG4gKiAjIFVzYWdlXHJcbiAqXHJcbiAqIFRvIHNlZSBhbmltYXRpb25zIGluIGFjdGlvbiwgYWxsIHRoYXQgaXMgcmVxdWlyZWQgaXMgdG8gZGVmaW5lIHRoZSBhcHByb3ByaWF0ZSBDU1MgY2xhc3Nlc1xyXG4gKiBvciB0byByZWdpc3RlciBhIEphdmFTY3JpcHQgYW5pbWF0aW9uIHZpYSB0aGUgYG15TW9kdWxlLmFuaW1hdGlvbigpYCBmdW5jdGlvbi4gVGhlIGRpcmVjdGl2ZXMgdGhhdCBzdXBwb3J0IGFuaW1hdGlvbiBhdXRvbWF0aWNhbGx5IGFyZTpcclxuICogYG5nUmVwZWF0YCwgYG5nSW5jbHVkZWAsIGBuZ0lmYCwgYG5nU3dpdGNoYCwgYG5nU2hvd2AsIGBuZ0hpZGVgLCBgbmdWaWV3YCBhbmQgYG5nQ2xhc3NgLiBDdXN0b20gZGlyZWN0aXZlcyBjYW4gdGFrZSBhZHZhbnRhZ2Ugb2YgYW5pbWF0aW9uXHJcbiAqIGJ5IHVzaW5nIHRoZSBgJGFuaW1hdGVgIHNlcnZpY2UuXHJcbiAqXHJcbiAqIEJlbG93IGlzIGEgbW9yZSBkZXRhaWxlZCBicmVha2Rvd24gb2YgdGhlIHN1cHBvcnRlZCBhbmltYXRpb24gZXZlbnRzIHByb3ZpZGVkIGJ5IHByZS1leGlzdGluZyBuZyBkaXJlY3RpdmVzOlxyXG4gKlxyXG4gKiB8IERpcmVjdGl2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgU3VwcG9ydGVkIEFuaW1hdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1JlcGVhdCNhbmltYXRpb25zIG5nUmVwZWF0fSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciwgbGVhdmUgYW5kIG1vdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBuZ1JvdXRlLmRpcmVjdGl2ZTpuZ1ZpZXcjYW5pbWF0aW9ucyBuZ1ZpZXd9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgZW50ZXIgYW5kIGxlYXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSW5jbHVkZSNhbmltYXRpb25zIG5nSW5jbHVkZX0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGVudGVyIGFuZCBsZWF2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1N3aXRjaCNhbmltYXRpb25zIG5nU3dpdGNofSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdJZiNhbmltYXRpb25zIG5nSWZ9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgZW50ZXIgYW5kIGxlYXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nQ2xhc3MjYW5pbWF0aW9ucyBuZ0NsYXNzfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGFkZCBhbmQgcmVtb3ZlICh0aGUgQ1NTIGNsYXNzKGVzKSBwcmVzZW50KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1Nob3cjYW5pbWF0aW9ucyBuZ1Nob3d9ICYge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0hpZGUjYW5pbWF0aW9ucyBuZ0hpZGV9ICAgICAgICAgICAgfCBhZGQgYW5kIHJlbW92ZSAodGhlIG5nLWhpZGUgY2xhc3MgdmFsdWUpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6Zm9ybSNhbmltYXRpb24taG9va3MgZm9ybX0gJiB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWwjYW5pbWF0aW9uLWhvb2tzIG5nTW9kZWx9ICAgIHwgYWRkIGFuZCByZW1vdmUgKGRpcnR5LCBwcmlzdGluZSwgdmFsaWQsIGludmFsaWQgJiBhbGwgb3RoZXIgdmFsaWRhdGlvbnMpIHxcclxuICogfCB7QGxpbmsgbW9kdWxlOm5nTWVzc2FnZXMjYW5pbWF0aW9ucyBuZ01lc3NhZ2VzfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGFkZCBhbmQgcmVtb3ZlIChuZy1hY3RpdmUgJiBuZy1pbmFjdGl2ZSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG1vZHVsZTpuZ01lc3NhZ2VzI2FuaW1hdGlvbnMgbmdNZXNzYWdlfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBlbnRlciBhbmQgbGVhdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKlxyXG4gKiBZb3UgY2FuIGZpbmQgb3V0IG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgYW5pbWF0aW9ucyB1cG9uIHZpc2l0aW5nIGVhY2ggZGlyZWN0aXZlIHBhZ2UuXHJcbiAqXHJcbiAqIEJlbG93IGlzIGFuIGV4YW1wbGUgb2YgaG93IHRvIGFwcGx5IGFuaW1hdGlvbnMgdG8gYSBkaXJlY3RpdmUgdGhhdCBzdXBwb3J0cyBhbmltYXRpb24gaG9va3M6XHJcbiAqXHJcbiAqIGBgYGh0bWxcclxuICogPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPlxyXG4gKiAuc2xpZGUubmctZW50ZXIsIC5zbGlkZS5uZy1sZWF2ZSB7XHJcbiAqICAgLXdlYmtpdC10cmFuc2l0aW9uOjAuNXMgbGluZWFyIGFsbDtcclxuICogICB0cmFuc2l0aW9uOjAuNXMgbGluZWFyIGFsbDtcclxuICogfVxyXG4gKlxyXG4gKiAuc2xpZGUubmctZW50ZXIgeyB9ICAgICAgICAvJiM0Mjsgc3RhcnRpbmcgYW5pbWF0aW9ucyBmb3IgZW50ZXIgJiM0MjsvXHJcbiAqIC5zbGlkZS5uZy1lbnRlci5uZy1lbnRlci1hY3RpdmUgeyB9IC8mIzQyOyB0ZXJtaW5hbCBhbmltYXRpb25zIGZvciBlbnRlciAmIzQyOy9cclxuICogLnNsaWRlLm5nLWxlYXZlIHsgfSAgICAgICAgLyYjNDI7IHN0YXJ0aW5nIGFuaW1hdGlvbnMgZm9yIGxlYXZlICYjNDI7L1xyXG4gKiAuc2xpZGUubmctbGVhdmUubmctbGVhdmUtYWN0aXZlIHsgfSAvJiM0MjsgdGVybWluYWwgYW5pbWF0aW9ucyBmb3IgbGVhdmUgJiM0MjsvXHJcbiAqIDwvc3R5bGU+XHJcbiAqXHJcbiAqIDwhLS1cclxuICogdGhlIGFuaW1hdGUgc2VydmljZSB3aWxsIGF1dG9tYXRpY2FsbHkgYWRkIC5uZy1lbnRlciBhbmQgLm5nLWxlYXZlIHRvIHRoZSBlbGVtZW50XHJcbiAqIHRvIHRyaWdnZXIgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbnNcclxuICogLS0+XHJcbiAqIDxBTlkgY2xhc3M9XCJzbGlkZVwiIG5nLWluY2x1ZGU9XCIuLi5cIj48L0FOWT5cclxuICogYGBgXHJcbiAqXHJcbiAqIEtlZXAgaW4gbWluZCB0aGF0LCBieSBkZWZhdWx0LCBpZiBhbiBhbmltYXRpb24gaXMgcnVubmluZywgYW55IGNoaWxkIGVsZW1lbnRzIGNhbm5vdCBiZSBhbmltYXRlZFxyXG4gKiB1bnRpbCB0aGUgcGFyZW50IGVsZW1lbnQncyBhbmltYXRpb24gaGFzIGNvbXBsZXRlZC4gVGhpcyBibG9ja2luZyBmZWF0dXJlIGNhbiBiZSBvdmVycmlkZGVuIGJ5XHJcbiAqIHBsYWNpbmcgdGhlIGBuZy1hbmltYXRlLWNoaWxkcmVuYCBhdHRyaWJ1dGUgb24gYSBwYXJlbnQgY29udGFpbmVyIHRhZy5cclxuICpcclxuICogYGBgaHRtbFxyXG4gKiA8ZGl2IGNsYXNzPVwic2xpZGUtYW5pbWF0aW9uXCIgbmctaWY9XCJvblwiIG5nLWFuaW1hdGUtY2hpbGRyZW4+XHJcbiAqICAgPGRpdiBjbGFzcz1cImZhZGUtYW5pbWF0aW9uXCIgbmctaWY9XCJvblwiPlxyXG4gKiAgICAgPGRpdiBjbGFzcz1cImV4cGxvZGUtYW5pbWF0aW9uXCIgbmctaWY9XCJvblwiPlxyXG4gKiAgICAgICAgLi4uXHJcbiAqICAgICA8L2Rpdj5cclxuICogICA8L2Rpdj5cclxuICogPC9kaXY+XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBXaGVuIHRoZSBgb25gIGV4cHJlc3Npb24gdmFsdWUgY2hhbmdlcyBhbmQgYW4gYW5pbWF0aW9uIGlzIHRyaWdnZXJlZCB0aGVuIGVhY2ggb2YgdGhlIGVsZW1lbnRzIHdpdGhpblxyXG4gKiB3aWxsIGFsbCBhbmltYXRlIHdpdGhvdXQgdGhlIGJsb2NrIGJlaW5nIGFwcGxpZWQgdG8gY2hpbGQgZWxlbWVudHMuXHJcbiAqXHJcbiAqICMjIEFyZSBhbmltYXRpb25zIHJ1biB3aGVuIHRoZSBhcHBsaWNhdGlvbiBzdGFydHM/XHJcbiAqIE5vIHRoZXkgYXJlIG5vdC4gV2hlbiBhbiBhcHBsaWNhdGlvbiBpcyBib290c3RyYXBwZWQgQW5ndWxhciB3aWxsIGRpc2FibGUgYW5pbWF0aW9ucyBmcm9tIHJ1bm5pbmcgdG8gYXZvaWRcclxuICogYSBmcmVuenkgb2YgYW5pbWF0aW9ucyBmcm9tIGJlaW5nIHRyaWdnZXJlZCBhcyBzb29uIGFzIHRoZSBicm93c2VyIGhhcyByZW5kZXJlZCB0aGUgc2NyZWVuLiBGb3IgdGhpcyB0byB3b3JrLFxyXG4gKiBBbmd1bGFyIHdpbGwgd2FpdCBmb3IgdHdvIGRpZ2VzdCBjeWNsZXMgdW50aWwgZW5hYmxpbmcgYW5pbWF0aW9ucy4gRnJvbSB0aGVyZSBvbiwgYW55IGFuaW1hdGlvbi10cmlnZ2VyaW5nXHJcbiAqIGxheW91dCBjaGFuZ2VzIGluIHRoZSBhcHBsaWNhdGlvbiB3aWxsIHRyaWdnZXIgYW5pbWF0aW9ucyBhcyBub3JtYWwuXHJcbiAqXHJcbiAqIEluIGFkZGl0aW9uLCB1cG9uIGJvb3RzdHJhcCwgaWYgdGhlIHJvdXRpbmcgc3lzdGVtIG9yIGFueSBkaXJlY3RpdmVzIG9yIGxvYWQgcmVtb3RlIGRhdGEgKHZpYSAkaHR0cCkgdGhlbiBBbmd1bGFyXHJcbiAqIHdpbGwgYXV0b21hdGljYWxseSBleHRlbmQgdGhlIHdhaXQgdGltZSB0byBlbmFibGUgYW5pbWF0aW9ucyBvbmNlICoqYWxsKiogb2YgdGhlIG91dGJvdW5kIEhUVFAgcmVxdWVzdHNcclxuICogYXJlIGNvbXBsZXRlLlxyXG4gKlxyXG4gKiAjIyBDU1MtZGVmaW5lZCBBbmltYXRpb25zXHJcbiAqIFRoZSBhbmltYXRlIHNlcnZpY2Ugd2lsbCBhdXRvbWF0aWNhbGx5IGFwcGx5IHR3byBDU1MgY2xhc3NlcyB0byB0aGUgYW5pbWF0ZWQgZWxlbWVudCBhbmQgdGhlc2UgdHdvIENTUyBjbGFzc2VzXHJcbiAqIGFyZSBkZXNpZ25lZCB0byBjb250YWluIHRoZSBzdGFydCBhbmQgZW5kIENTUyBzdHlsaW5nLiBCb3RoIENTUyB0cmFuc2l0aW9ucyBhbmQga2V5ZnJhbWUgYW5pbWF0aW9ucyBhcmUgc3VwcG9ydGVkXHJcbiAqIGFuZCBjYW4gYmUgdXNlZCB0byBwbGF5IGFsb25nIHdpdGggdGhpcyBuYW1pbmcgc3RydWN0dXJlLlxyXG4gKlxyXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgYmVsb3cgZGVtb25zdHJhdGVzIGhvdyB0byBwZXJmb3JtIGFuaW1hdGlvbnMgdXNpbmcgKipDU1MgdHJhbnNpdGlvbnMqKiB3aXRoIEFuZ3VsYXI6XHJcbiAqXHJcbiAqIGBgYGh0bWxcclxuICogPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPlxyXG4gKiAvJiM0MjtcclxuICogIFRoZSBhbmltYXRlIGNsYXNzIGlzIGFwYXJ0IG9mIHRoZSBlbGVtZW50IGFuZCB0aGUgbmctZW50ZXIgY2xhc3NcclxuICogIGlzIGF0dGFjaGVkIHRvIHRoZSBlbGVtZW50IG9uY2UgdGhlIGVudGVyIGFuaW1hdGlvbiBldmVudCBpcyB0cmlnZ2VyZWRcclxuICogJiM0MjsvXHJcbiAqIC5yZXZlYWwtYW5pbWF0aW9uLm5nLWVudGVyIHtcclxuICogIC13ZWJraXQtdHJhbnNpdGlvbjogMXMgbGluZWFyIGFsbDsgLyYjNDI7IFNhZmFyaS9DaHJvbWUgJiM0MjsvXHJcbiAqICB0cmFuc2l0aW9uOiAxcyBsaW5lYXIgYWxsOyAvJiM0MjsgQWxsIG90aGVyIG1vZGVybiBicm93c2VycyBhbmQgSUUxMCsgJiM0MjsvXHJcbiAqXHJcbiAqICAvJiM0MjsgVGhlIGFuaW1hdGlvbiBwcmVwYXJhdGlvbiBjb2RlICYjNDI7L1xyXG4gKiAgb3BhY2l0eTogMDtcclxuICogfVxyXG4gKlxyXG4gKiAvJiM0MjtcclxuICogIEtlZXAgaW4gbWluZCB0aGF0IHlvdSB3YW50IHRvIGNvbWJpbmUgYm90aCBDU1NcclxuICogIGNsYXNzZXMgdG9nZXRoZXIgdG8gYXZvaWQgYW55IENTUy1zcGVjaWZpY2l0eVxyXG4gKiAgY29uZmxpY3RzXHJcbiAqICYjNDI7L1xyXG4gKiAucmV2ZWFsLWFuaW1hdGlvbi5uZy1lbnRlci5uZy1lbnRlci1hY3RpdmUge1xyXG4gKiAgLyYjNDI7IFRoZSBhbmltYXRpb24gY29kZSBpdHNlbGYgJiM0MjsvXHJcbiAqICBvcGFjaXR5OiAxO1xyXG4gKiB9XHJcbiAqIDwvc3R5bGU+XHJcbiAqXHJcbiAqIDxkaXYgY2xhc3M9XCJ2aWV3LWNvbnRhaW5lclwiPlxyXG4gKiAgIDxkaXYgbmctdmlldyBjbGFzcz1cInJldmVhbC1hbmltYXRpb25cIj48L2Rpdj5cclxuICogPC9kaXY+XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBUaGUgZm9sbG93aW5nIGNvZGUgYmVsb3cgZGVtb25zdHJhdGVzIGhvdyB0byBwZXJmb3JtIGFuaW1hdGlvbnMgdXNpbmcgKipDU1MgYW5pbWF0aW9ucyoqIHdpdGggQW5ndWxhcjpcclxuICpcclxuICogYGBgaHRtbFxyXG4gKiA8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+XHJcbiAqIC5yZXZlYWwtYW5pbWF0aW9uLm5nLWVudGVyIHtcclxuICogICAtd2Via2l0LWFuaW1hdGlvbjogZW50ZXJfc2VxdWVuY2UgMXMgbGluZWFyOyAvJiM0MjsgU2FmYXJpL0Nocm9tZSAmIzQyOy9cclxuICogICBhbmltYXRpb246IGVudGVyX3NlcXVlbmNlIDFzIGxpbmVhcjsgLyYjNDI7IElFMTArIGFuZCBGdXR1cmUgQnJvd3NlcnMgJiM0MjsvXHJcbiAqIH1cclxuICogQC13ZWJraXQta2V5ZnJhbWVzIGVudGVyX3NlcXVlbmNlIHtcclxuICogICBmcm9tIHsgb3BhY2l0eTowOyB9XHJcbiAqICAgdG8geyBvcGFjaXR5OjE7IH1cclxuICogfVxyXG4gKiBAa2V5ZnJhbWVzIGVudGVyX3NlcXVlbmNlIHtcclxuICogICBmcm9tIHsgb3BhY2l0eTowOyB9XHJcbiAqICAgdG8geyBvcGFjaXR5OjE7IH1cclxuICogfVxyXG4gKiA8L3N0eWxlPlxyXG4gKlxyXG4gKiA8ZGl2IGNsYXNzPVwidmlldy1jb250YWluZXJcIj5cclxuICogICA8ZGl2IG5nLXZpZXcgY2xhc3M9XCJyZXZlYWwtYW5pbWF0aW9uXCI+PC9kaXY+XHJcbiAqIDwvZGl2PlxyXG4gKiBgYGBcclxuICpcclxuICogQm90aCBDU1MzIGFuaW1hdGlvbnMgYW5kIHRyYW5zaXRpb25zIGNhbiBiZSB1c2VkIHRvZ2V0aGVyIGFuZCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgZmlndXJlIG91dCB0aGUgY29ycmVjdCBkdXJhdGlvbiBhbmQgZGVsYXkgdGltaW5nLlxyXG4gKlxyXG4gKiBVcG9uIERPTSBtdXRhdGlvbiwgdGhlIGV2ZW50IGNsYXNzIGlzIGFkZGVkIGZpcnN0IChzb21ldGhpbmcgbGlrZSBgbmctZW50ZXJgKSwgdGhlbiB0aGUgYnJvd3NlciBwcmVwYXJlcyBpdHNlbGYgdG8gYWRkXHJcbiAqIHRoZSBhY3RpdmUgY2xhc3MgKGluIHRoaXMgY2FzZSBgbmctZW50ZXItYWN0aXZlYCkgd2hpY2ggdGhlbiB0cmlnZ2VycyB0aGUgYW5pbWF0aW9uLiBUaGUgYW5pbWF0aW9uIG1vZHVsZSB3aWxsIGF1dG9tYXRpY2FsbHlcclxuICogZGV0ZWN0IHRoZSBDU1MgY29kZSB0byBkZXRlcm1pbmUgd2hlbiB0aGUgYW5pbWF0aW9uIGVuZHMuIE9uY2UgdGhlIGFuaW1hdGlvbiBpcyBvdmVyIHRoZW4gYm90aCBDU1MgY2xhc3NlcyB3aWxsIGJlXHJcbiAqIHJlbW92ZWQgZnJvbSB0aGUgRE9NLiBJZiBhIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBDU1MgdHJhbnNpdGlvbnMgb3IgQ1NTIGFuaW1hdGlvbnMgdGhlbiB0aGUgYW5pbWF0aW9uIHdpbGwgc3RhcnQgYW5kIGVuZFxyXG4gKiBpbW1lZGlhdGVseSByZXN1bHRpbmcgaW4gYSBET00gZWxlbWVudCB0aGF0IGlzIGF0IGl0cyBmaW5hbCBzdGF0ZS4gVGhpcyBmaW5hbCBzdGF0ZSBpcyB3aGVuIHRoZSBET00gZWxlbWVudFxyXG4gKiBoYXMgbm8gQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGNsYXNzZXMgYXBwbGllZCB0byBpdC5cclxuICpcclxuICogIyMjIFN0cnVjdHVyYWwgdHJhbnNpdGlvbiBhbmltYXRpb25zXHJcbiAqXHJcbiAqIFN0cnVjdHVyYWwgdHJhbnNpdGlvbnMgKHN1Y2ggYXMgZW50ZXIsIGxlYXZlIGFuZCBtb3ZlKSB3aWxsIGFsd2F5cyBhcHBseSBhIGAwcyBub25lYCB0cmFuc2l0aW9uXHJcbiAqIHZhbHVlIHRvIGZvcmNlIHRoZSBicm93c2VyIGludG8gcmVuZGVyaW5nIHRoZSBzdHlsZXMgZGVmaW5lZCBpbiB0aGUgc2V0dXAgKGAubmctZW50ZXJgLCBgLm5nLWxlYXZlYFxyXG4gKiBvciBgLm5nLW1vdmVgKSBjbGFzcy4gVGhpcyBtZWFucyB0aGF0IGFueSBhY3RpdmUgdHJhbnNpdGlvbiBhbmltYXRpb25zIG9wZXJhdGluZyBvbiB0aGUgZWxlbWVudFxyXG4gKiB3aWxsIGJlIGN1dCBvZmYgdG8gbWFrZSB3YXkgZm9yIHRoZSBlbnRlciwgbGVhdmUgb3IgbW92ZSBhbmltYXRpb24uXHJcbiAqXHJcbiAqICMjIyBDbGFzcy1iYXNlZCB0cmFuc2l0aW9uIGFuaW1hdGlvbnNcclxuICpcclxuICogQ2xhc3MtYmFzZWQgdHJhbnNpdGlvbnMgcmVmZXIgdG8gdHJhbnNpdGlvbiBhbmltYXRpb25zIHRoYXQgYXJlIHRyaWdnZXJlZCB3aGVuIGEgQ1NTIGNsYXNzIGlzXHJcbiAqIGFkZGVkIHRvIG9yIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAodmlhIGAkYW5pbWF0ZS5hZGRDbGFzc2AsIGAkYW5pbWF0ZS5yZW1vdmVDbGFzc2AsXHJcbiAqIGAkYW5pbWF0ZS5zZXRDbGFzc2AsIG9yIGJ5IGRpcmVjdGl2ZXMgc3VjaCBhcyBgbmdDbGFzc2AsIGBuZ01vZGVsYCBhbmQgYGZvcm1gKS5cclxuICogVGhleSBhcmUgZGlmZmVyZW50IHdoZW4gY29tcGFyZWQgdG8gc3RydWN0dXJhbCBhbmltYXRpb25zIHNpbmNlIHRoZXkgKipkbyBub3QgY2FuY2VsIGV4aXN0aW5nXHJcbiAqIGFuaW1hdGlvbnMqKiBub3IgZG8gdGhleSAqKmJsb2NrIHN1Y2Nlc3NpdmUgdHJhbnNpdGlvbnMqKiBmcm9tIHJlbmRlcmluZyBvbiB0aGUgc2FtZSBlbGVtZW50LlxyXG4gKiBUaGlzIGRpc3RpbmN0aW9uIGFsbG93cyBmb3IgKiptdWx0aXBsZSBjbGFzcy1iYXNlZCB0cmFuc2l0aW9ucyoqIHRvIGJlIHBlcmZvcm1lZCBvbiB0aGUgc2FtZSBlbGVtZW50LlxyXG4gKlxyXG4gKiBJbiBhZGRpdGlvbiB0byBuZ0FuaW1hdGUgc3VwcG9ydGluZyB0aGUgZGVmYXVsdCAobmF0dXJhbCkgZnVuY3Rpb25hbGl0eSBvZiBjbGFzcy1iYXNlZCB0cmFuc2l0aW9uXHJcbiAqIGFuaW1hdGlvbnMsIG5nQW5pbWF0ZSBhbHNvIGRlY29yYXRlcyB0aGUgZWxlbWVudCB3aXRoIHN0YXJ0aW5nIGFuZCBlbmRpbmcgQ1NTIGNsYXNzZXMgdG8gYWlkIHRoZVxyXG4gKiBkZXZlbG9wZXIgaW4gZnVydGhlciBzdHlsaW5nIHRoZSBlbGVtZW50IHRocm91Z2hvdXQgdGhlIHRyYW5zaXRpb24gYW5pbWF0aW9uLiBFYXJsaWVyIHZlcnNpb25zXHJcbiAqIG9mIG5nQW5pbWF0ZSBtYXkgaGF2ZSBjYXVzZWQgbmF0dXJhbCBDU1MgdHJhbnNpdGlvbnMgdG8gYnJlYWsgYW5kIG5vdCByZW5kZXIgcHJvcGVybHkgZHVlIHRvXHJcbiAqICRhbmltYXRlIHRlbXBvcmFyaWx5IGJsb2NraW5nIHRyYW5zaXRpb25zIHVzaW5nIGAwcyBub25lYCBpbiBvcmRlciB0byBhbGxvdyB0aGUgc2V0dXAgQ1NTIGNsYXNzXHJcbiAqICh0aGUgYC1hZGRgIG9yIGAtcmVtb3ZlYCBjbGFzcykgdG8gYmUgYXBwbGllZCB3aXRob3V0IHRyaWdnZXJpbmcgYW4gYW5pbWF0aW9uLiBIb3dldmVyLCBhcyBvZlxyXG4gKiAqKnZlcnNpb24gMS4zKiosIHRoaXMgd29ya2Fyb3VuZCBoYXMgYmVlbiByZW1vdmVkIHdpdGggbmdBbmltYXRlIGFuZCBhbGwgbm9uLW5nQW5pbWF0ZSBDU1NcclxuICogY2xhc3MgdHJhbnNpdGlvbnMgYXJlIGNvbXBhdGlibGUgd2l0aCBuZ0FuaW1hdGUuXHJcbiAqXHJcbiAqIFRoZXJlIGlzLCBob3dldmVyLCBvbmUgc3BlY2lhbCBjYXNlIHdoZW4gZGVhbGluZyB3aXRoIGNsYXNzLWJhc2VkIHRyYW5zaXRpb25zIGluIG5nQW5pbWF0ZS5cclxuICogV2hlbiByZW5kZXJpbmcgY2xhc3MtYmFzZWQgdHJhbnNpdGlvbnMgdGhhdCBtYWtlIHVzZSBvZiB0aGUgc2V0dXAgYW5kIGFjdGl2ZSBDU1MgY2xhc3Nlc1xyXG4gKiAoZS5nLiBgLmZhZGUtYWRkYCBhbmQgYC5mYWRlLWFkZC1hY3RpdmVgIGZvciB3aGVuIGAuZmFkZWAgaXMgYWRkZWQpIGJlIHN1cmUgdG8gZGVmaW5lXHJcbiAqIHRoZSB0cmFuc2l0aW9uIHZhbHVlICoqb24gdGhlIGFjdGl2ZSBDU1MgY2xhc3MqKiBhbmQgbm90IHRoZSBzZXR1cCBjbGFzcy5cclxuICpcclxuICogYGBgY3NzXHJcbiAqIC5mYWRlLWFkZCB7XHJcbiAqICAgLyYjNDI7IHJlbWVtYmVyIHRvIHBsYWNlIGEgMHMgdHJhbnNpdGlvbiBoZXJlXHJcbiAqICAgICAgdG8gZW5zdXJlIHRoYXQgdGhlIHN0eWxlcyBhcmUgYXBwbGllZCBpbnN0YW50bHlcclxuICogICAgICBldmVuIGlmIHRoZSBlbGVtZW50IGFscmVhZHkgaGFzIGEgdHJhbnNpdGlvbiBzdHlsZSAmIzQyOy9cclxuICogICB0cmFuc2l0aW9uOjBzIGxpbmVhciBhbGw7XHJcbiAqXHJcbiAqICAgLyYjNDI7IHN0YXJ0aW5nIENTUyBzdHlsZXMgJiM0MjsvXHJcbiAqICAgb3BhY2l0eToxO1xyXG4gKiB9XHJcbiAqIC5mYWRlLWFkZC5mYWRlLWFkZC1hY3RpdmUge1xyXG4gKiAgIC8mIzQyOyB0aGlzIHdpbGwgYmUgdGhlIGxlbmd0aCBvZiB0aGUgYW5pbWF0aW9uICYjNDI7L1xyXG4gKiAgIHRyYW5zaXRpb246MXMgbGluZWFyIGFsbDtcclxuICogICBvcGFjaXR5OjA7XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIFRoZSBzZXR1cCBDU1MgY2xhc3MgKGluIHRoaXMgY2FzZSBgLmZhZGUtYWRkYCkgYWxzbyBoYXMgYSB0cmFuc2l0aW9uIHN0eWxlIHByb3BlcnR5LCBob3dldmVyLCBpdFxyXG4gKiBoYXMgYSBkdXJhdGlvbiBvZiB6ZXJvLiBUaGlzIG1heSBub3QgYmUgcmVxdWlyZWQsIGhvd2V2ZXIsIGluY2FzZSB0aGUgYnJvd3NlciBpcyB1bmFibGUgdG8gcmVuZGVyXHJcbiAqIHRoZSBzdHlsaW5nIHByZXNlbnQgaW4gdGhpcyBDU1MgY2xhc3MgaW5zdGFudGx5IHRoZW4gaXQgY291bGQgYmUgdGhhdCB0aGUgYnJvd3NlciBpcyBhdHRlbXB0aW5nXHJcbiAqIHRvIHBlcmZvcm0gYW4gdW5uZWNlc3NhcnkgdHJhbnNpdGlvbi5cclxuICpcclxuICogVGhpcyB3b3JrYXJvdW5kLCBob3dldmVyLCBkb2VzIG5vdCBhcHBseSB0byAgc3RhbmRhcmQgY2xhc3MtYmFzZWQgdHJhbnNpdGlvbnMgdGhhdCBhcmUgcmVuZGVyZWRcclxuICogd2hlbiBhIENTUyBjbGFzcyBjb250YWluaW5nIGEgdHJhbnNpdGlvbiBpcyBhcHBsaWVkIHRvIGFuIGVsZW1lbnQ6XHJcbiAqXHJcbiAqIGBgYGNzc1xyXG4gKiAvJiM0MjsgdGhpcyB3b3JrcyBhcyBleHBlY3RlZCAmIzQyOy9cclxuICogLmZhZGUge1xyXG4gKiAgIHRyYW5zaXRpb246MXMgbGluZWFyIGFsbDtcclxuICogICBvcGFjaXR5OjA7XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIFBsZWFzZSBrZWVwIHRoaXMgaW4gbWluZCB3aGVuIGNvZGluZyB0aGUgQ1NTIG1hcmt1cCB0aGF0IHdpbGwgYmUgdXNlZCB3aXRoaW4gY2xhc3MtYmFzZWQgdHJhbnNpdGlvbnMuXHJcbiAqIEFsc28sIHRyeSBub3QgdG8gbWl4IHRoZSB0d28gY2xhc3MtYmFzZWQgYW5pbWF0aW9uIGZsYXZvcnMgdG9nZXRoZXIgc2luY2UgdGhlIENTUyBjb2RlIG1heSBiZWNvbWVcclxuICogb3Zlcmx5IGNvbXBsZXguXHJcbiAqXHJcbiAqXHJcbiAqICMjIyBQcmV2ZW50aW5nIENvbGxpc2lvbnMgV2l0aCBUaGlyZCBQYXJ0eSBMaWJyYXJpZXNcclxuICpcclxuICogU29tZSB0aGlyZC1wYXJ0eSBmcmFtZXdvcmtzIHBsYWNlIGFuaW1hdGlvbiBkdXJhdGlvbiBkZWZhdWx0cyBhY3Jvc3MgbWFueSBlbGVtZW50IG9yIGNsYXNzTmFtZVxyXG4gKiBzZWxlY3RvcnMgaW4gb3JkZXIgdG8gbWFrZSB0aGVpciBjb2RlIHNtYWxsIGFuZCByZXVzZWFibGUuIFRoaXMgY2FuIGxlYWQgdG8gaXNzdWVzIHdpdGggbmdBbmltYXRlLCB3aGljaFxyXG4gKiBpcyBleHBlY3RpbmcgYWN0dWFsIGFuaW1hdGlvbnMgb24gdGhlc2UgZWxlbWVudHMgYW5kIGhhcyB0byB3YWl0IGZvciB0aGVpciBjb21wbGV0aW9uLlxyXG4gKlxyXG4gKiBZb3UgY2FuIHByZXZlbnQgdGhpcyB1bndhbnRlZCBiZWhhdmlvciBieSB1c2luZyBhIHByZWZpeCBvbiBhbGwgeW91ciBhbmltYXRpb24gY2xhc3NlczpcclxuICpcclxuICogYGBgY3NzXHJcbiAqIC8mIzQyOyBwcmVmaXhlZCB3aXRoIGFuaW1hdGUtICYjNDI7L1xyXG4gKiAuYW5pbWF0ZS1mYWRlLWFkZC5hbmltYXRlLWZhZGUtYWRkLWFjdGl2ZSB7XHJcbiAqICAgdHJhbnNpdGlvbjoxcyBsaW5lYXIgYWxsO1xyXG4gKiAgIG9wYWNpdHk6MDtcclxuICogfVxyXG4gKiBgYGBcclxuICpcclxuICogWW91IHRoZW4gY29uZmlndXJlIGAkYW5pbWF0ZWAgdG8gZW5mb3JjZSB0aGlzIHByZWZpeDpcclxuICpcclxuICogYGBganNcclxuICogJGFuaW1hdGVQcm92aWRlci5jbGFzc05hbWVGaWx0ZXIoL2FuaW1hdGUtLyk7XHJcbiAqIGBgYFxyXG4gKiA8L2Rpdj5cclxuICpcclxuICogIyMjIENTUyBTdGFnZ2VyaW5nIEFuaW1hdGlvbnNcclxuICogQSBTdGFnZ2VyaW5nIGFuaW1hdGlvbiBpcyBhIGNvbGxlY3Rpb24gb2YgYW5pbWF0aW9ucyB0aGF0IGFyZSBpc3N1ZWQgd2l0aCBhIHNsaWdodCBkZWxheSBpbiBiZXR3ZWVuIGVhY2ggc3VjY2Vzc2l2ZSBvcGVyYXRpb24gcmVzdWx0aW5nIGluIGFcclxuICogY3VydGFpbi1saWtlIGVmZmVjdC4gVGhlIG5nQW5pbWF0ZSBtb2R1bGUgKHZlcnNpb25zID49MS4yKSBzdXBwb3J0cyBzdGFnZ2VyaW5nIGFuaW1hdGlvbnMgYW5kIHRoZSBzdGFnZ2VyIGVmZmVjdCBjYW4gYmVcclxuICogcGVyZm9ybWVkIGJ5IGNyZWF0aW5nIGEgKipuZy1FVkVOVC1zdGFnZ2VyKiogQ1NTIGNsYXNzIGFuZCBhdHRhY2hpbmcgdGhhdCBjbGFzcyB0byB0aGUgYmFzZSBDU1MgY2xhc3MgdXNlZCBmb3JcclxuICogdGhlIGFuaW1hdGlvbi4gVGhlIHN0eWxlIHByb3BlcnR5IGV4cGVjdGVkIHdpdGhpbiB0aGUgc3RhZ2dlciBjbGFzcyBjYW4gZWl0aGVyIGJlIGEgKip0cmFuc2l0aW9uLWRlbGF5Kiogb3IgYW5cclxuICogKiphbmltYXRpb24tZGVsYXkqKiBwcm9wZXJ0eSAob3IgYm90aCBpZiB5b3VyIGFuaW1hdGlvbiBjb250YWlucyBib3RoIHRyYW5zaXRpb25zIGFuZCBrZXlmcmFtZSBhbmltYXRpb25zKS5cclxuICpcclxuICogYGBgY3NzXHJcbiAqIC5teS1hbmltYXRpb24ubmctZW50ZXIge1xyXG4gKiAgIC8mIzQyOyBzdGFuZGFyZCB0cmFuc2l0aW9uIGNvZGUgJiM0MjsvXHJcbiAqICAgLXdlYmtpdC10cmFuc2l0aW9uOiAxcyBsaW5lYXIgYWxsO1xyXG4gKiAgIHRyYW5zaXRpb246IDFzIGxpbmVhciBhbGw7XHJcbiAqICAgb3BhY2l0eTowO1xyXG4gKiB9XHJcbiAqIC5teS1hbmltYXRpb24ubmctZW50ZXItc3RhZ2dlciB7XHJcbiAqICAgLyYjNDI7IHRoaXMgd2lsbCBoYXZlIGEgMTAwbXMgZGVsYXkgYmV0d2VlbiBlYWNoIHN1Y2Nlc3NpdmUgbGVhdmUgYW5pbWF0aW9uICYjNDI7L1xyXG4gKiAgIC13ZWJraXQtdHJhbnNpdGlvbi1kZWxheTogMC4xcztcclxuICogICB0cmFuc2l0aW9uLWRlbGF5OiAwLjFzO1xyXG4gKlxyXG4gKiAgIC8mIzQyOyBpbiBjYXNlIHRoZSBzdGFnZ2VyIGRvZXNuJ3Qgd29yayB0aGVuIHRoZXNlIHR3byB2YWx1ZXNcclxuICogICAgbXVzdCBiZSBzZXQgdG8gMCB0byBhdm9pZCBhbiBhY2NpZGVudGFsIENTUyBpbmhlcml0YW5jZSAmIzQyOy9cclxuICogICAtd2Via2l0LXRyYW5zaXRpb24tZHVyYXRpb246IDBzO1xyXG4gKiAgIHRyYW5zaXRpb24tZHVyYXRpb246IDBzO1xyXG4gKiB9XHJcbiAqIC5teS1hbmltYXRpb24ubmctZW50ZXIubmctZW50ZXItYWN0aXZlIHtcclxuICogICAvJiM0Mjsgc3RhbmRhcmQgdHJhbnNpdGlvbiBzdHlsZXMgJiM0MjsvXHJcbiAqICAgb3BhY2l0eToxO1xyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBTdGFnZ2VyaW5nIGFuaW1hdGlvbnMgd29yayBieSBkZWZhdWx0IGluIG5nUmVwZWF0IChzbyBsb25nIGFzIHRoZSBDU1MgY2xhc3MgaXMgZGVmaW5lZCkuIE91dHNpZGUgb2YgbmdSZXBlYXQsIHRvIHVzZSBzdGFnZ2VyaW5nIGFuaW1hdGlvbnNcclxuICogb24geW91ciBvd24sIHRoZXkgY2FuIGJlIHRyaWdnZXJlZCBieSBmaXJpbmcgbXVsdGlwbGUgY2FsbHMgdG8gdGhlIHNhbWUgZXZlbnQgb24gJGFuaW1hdGUuIEhvd2V2ZXIsIHRoZSByZXN0cmljdGlvbnMgc3Vycm91bmRpbmcgdGhpc1xyXG4gKiBhcmUgdGhhdCBlYWNoIG9mIHRoZSBlbGVtZW50cyBtdXN0IGhhdmUgdGhlIHNhbWUgQ1NTIGNsYXNzTmFtZSB2YWx1ZSBhcyB3ZWxsIGFzIHRoZSBzYW1lIHBhcmVudCBlbGVtZW50LiBBIHN0YWdnZXIgb3BlcmF0aW9uXHJcbiAqIHdpbGwgYWxzbyBiZSByZXNldCBpZiBtb3JlIHRoYW4gMTBtcyBoYXMgcGFzc2VkIGFmdGVyIHRoZSBsYXN0IGFuaW1hdGlvbiBoYXMgYmVlbiBmaXJlZC5cclxuICpcclxuICogVGhlIGZvbGxvd2luZyBjb2RlIHdpbGwgaXNzdWUgdGhlICoqbmctbGVhdmUtc3RhZ2dlcioqIGV2ZW50IG9uIHRoZSBlbGVtZW50IHByb3ZpZGVkOlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiB2YXIga2lkcyA9IHBhcmVudC5jaGlsZHJlbigpO1xyXG4gKlxyXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzBdKTsgLy9zdGFnZ2VyIGluZGV4PTBcclxuICogJGFuaW1hdGUubGVhdmUoa2lkc1sxXSk7IC8vc3RhZ2dlciBpbmRleD0xXHJcbiAqICRhbmltYXRlLmxlYXZlKGtpZHNbMl0pOyAvL3N0YWdnZXIgaW5kZXg9MlxyXG4gKiAkYW5pbWF0ZS5sZWF2ZShraWRzWzNdKTsgLy9zdGFnZ2VyIGluZGV4PTNcclxuICogJGFuaW1hdGUubGVhdmUoa2lkc1s0XSk7IC8vc3RhZ2dlciBpbmRleD00XHJcbiAqXHJcbiAqICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gKiAgIC8vc3RhZ2dlciBoYXMgcmVzZXQgaXRzZWxmXHJcbiAqICAgJGFuaW1hdGUubGVhdmUoa2lkc1s1XSk7IC8vc3RhZ2dlciBpbmRleD0wXHJcbiAqICAgJGFuaW1hdGUubGVhdmUoa2lkc1s2XSk7IC8vc3RhZ2dlciBpbmRleD0xXHJcbiAqIH0sIDEwMCwgZmFsc2UpO1xyXG4gKiBgYGBcclxuICpcclxuICogU3RhZ2dlciBhbmltYXRpb25zIGFyZSBjdXJyZW50bHkgb25seSBzdXBwb3J0ZWQgd2l0aGluIENTUy1kZWZpbmVkIGFuaW1hdGlvbnMuXHJcbiAqXHJcbiAqICMjIEphdmFTY3JpcHQtZGVmaW5lZCBBbmltYXRpb25zXHJcbiAqIEluIHRoZSBldmVudCB0aGF0IHlvdSBkbyBub3Qgd2FudCB0byB1c2UgQ1NTMyB0cmFuc2l0aW9ucyBvciBDU1MzIGFuaW1hdGlvbnMgb3IgaWYgeW91IHdpc2ggdG8gb2ZmZXIgYW5pbWF0aW9ucyBvbiBicm93c2VycyB0aGF0IGRvIG5vdFxyXG4gKiB5ZXQgc3VwcG9ydCBDU1MgdHJhbnNpdGlvbnMvYW5pbWF0aW9ucywgdGhlbiB5b3UgY2FuIG1ha2UgdXNlIG9mIEphdmFTY3JpcHQgYW5pbWF0aW9ucyBkZWZpbmVkIGluc2lkZSBvZiB5b3VyIEFuZ3VsYXJKUyBtb2R1bGUuXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIC8vIWFubm90YXRlPVwiWW91ckFwcFwiIFlvdXIgQW5ndWxhckpTIE1vZHVsZXxSZXBsYWNlIHRoaXMgb3IgbmdNb2R1bGUgd2l0aCB0aGUgbW9kdWxlIHRoYXQgeW91IHVzZWQgdG8gZGVmaW5lIHlvdXIgYXBwbGljYXRpb24uXHJcbiAqIHZhciBuZ01vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdZb3VyQXBwJywgWyduZ0FuaW1hdGUnXSk7XHJcbiAqIG5nTW9kdWxlLmFuaW1hdGlvbignLm15LWNyYXp5LWFuaW1hdGlvbicsIGZ1bmN0aW9uKCkge1xyXG4gKiAgIHJldHVybiB7XHJcbiAqICAgICBlbnRlcjogZnVuY3Rpb24oZWxlbWVudCwgZG9uZSkge1xyXG4gKiAgICAgICAvL3J1biB0aGUgYW5pbWF0aW9uIGhlcmUgYW5kIGNhbGwgZG9uZSB3aGVuIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGVcclxuICogICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xyXG4gKiAgICAgICAgIC8vdGhpcyAob3B0aW9uYWwpIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIGFuaW1hdGlvblxyXG4gKiAgICAgICAgIC8vY29tcGxldGVzIG9yIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBjYW5jZWxsZWQgKHRoZSBjYW5jZWxsZWRcclxuICogICAgICAgICAvL2ZsYWcgd2lsbCBiZSBzZXQgdG8gdHJ1ZSBpZiBjYW5jZWxsZWQpLlxyXG4gKiAgICAgICB9O1xyXG4gKiAgICAgfSxcclxuICogICAgIGxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBkb25lKSB7IH0sXHJcbiAqICAgICBtb3ZlOiBmdW5jdGlvbihlbGVtZW50LCBkb25lKSB7IH0sXHJcbiAqXHJcbiAqICAgICAvL2FuaW1hdGlvbiB0aGF0IGNhbiBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBjbGFzcyBpcyBhZGRlZFxyXG4gKiAgICAgYmVmb3JlQWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkgeyB9LFxyXG4gKlxyXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFmdGVyIHRoZSBjbGFzcyBpcyBhZGRlZFxyXG4gKiAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkgeyB9LFxyXG4gKlxyXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGJlZm9yZSB0aGUgY2xhc3MgaXMgcmVtb3ZlZFxyXG4gKiAgICAgYmVmb3JlUmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkgeyB9LFxyXG4gKlxyXG4gKiAgICAgLy9hbmltYXRpb24gdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFmdGVyIHRoZSBjbGFzcyBpcyByZW1vdmVkXHJcbiAqICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7IH1cclxuICogICB9O1xyXG4gKiB9KTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGFyZSBjcmVhdGVkIHdpdGggYSBDU1MtbGlrZSBjbGFzcyBzZWxlY3RvciBhbmQgYSBjb2xsZWN0aW9uIG9mIGV2ZW50cyB3aGljaCBhcmUgc2V0IHRvIHJ1blxyXG4gKiBhIGphdmFzY3JpcHQgY2FsbGJhY2sgZnVuY3Rpb24uIFdoZW4gYW4gYW5pbWF0aW9uIGlzIHRyaWdnZXJlZCwgJGFuaW1hdGUgd2lsbCBsb29rIGZvciBhIG1hdGNoaW5nIGFuaW1hdGlvbiB3aGljaCBmaXRzXHJcbiAqIHRoZSBlbGVtZW50J3MgQ1NTIGNsYXNzIGF0dHJpYnV0ZSB2YWx1ZSBhbmQgdGhlbiBydW4gdGhlIG1hdGNoaW5nIGFuaW1hdGlvbiBldmVudCBmdW5jdGlvbiAoaWYgZm91bmQpLlxyXG4gKiBJbiBvdGhlciB3b3JkcywgaWYgdGhlIENTUyBjbGFzc2VzIHByZXNlbnQgb24gdGhlIGFuaW1hdGVkIGVsZW1lbnQgbWF0Y2ggYW55IG9mIHRoZSBKYXZhU2NyaXB0IGFuaW1hdGlvbnMgdGhlbiB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gd2lsbFxyXG4gKiBiZSBleGVjdXRlZC4gSXQgc2hvdWxkIGJlIGFsc28gbm90ZWQgdGhhdCBvbmx5IHNpbXBsZSwgc2luZ2xlIGNsYXNzIHNlbGVjdG9ycyBhcmUgYWxsb3dlZCAoY29tcG91bmQgY2xhc3Mgc2VsZWN0b3JzIGFyZSBub3Qgc3VwcG9ydGVkKS5cclxuICpcclxuICogV2l0aGluIGEgSmF2YVNjcmlwdCBhbmltYXRpb24sIGFuIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXZlbnQgY2FsbGJhY2sgYW5pbWF0aW9uIGZ1bmN0aW9ucyBpcyBleHBlY3RlZCB0byBiZSByZXR1cm5lZC5cclxuICogQXMgZXhwbGFpbmVkIGFib3ZlLCB0aGVzZSBjYWxsYmFja3MgYXJlIHRyaWdnZXJlZCBiYXNlZCBvbiB0aGUgYW5pbWF0aW9uIGV2ZW50LiBUaGVyZWZvcmUgaWYgYW4gZW50ZXIgYW5pbWF0aW9uIGlzIHJ1bixcclxuICogYW5kIHRoZSBKYXZhU2NyaXB0IGFuaW1hdGlvbiBpcyBmb3VuZCwgdGhlbiB0aGUgZW50ZXIgY2FsbGJhY2sgd2lsbCBoYW5kbGUgdGhhdCBhbmltYXRpb24gKGluIGFkZGl0aW9uIHRvIHRoZSBDU1Mga2V5ZnJhbWUgYW5pbWF0aW9uXHJcbiAqIG9yIHRyYW5zaXRpb24gY29kZSB0aGF0IGlzIGRlZmluZWQgdmlhIGEgc3R5bGVzaGVldCkuXHJcbiAqXHJcbiAqXHJcbiAqICMjIyBBcHBseWluZyBEaXJlY3RpdmUtc3BlY2lmaWMgU3R5bGVzIHRvIGFuIEFuaW1hdGlvblxyXG4gKiBJbiBzb21lIGNhc2VzIGEgZGlyZWN0aXZlIG9yIHNlcnZpY2UgbWF5IHdhbnQgdG8gcHJvdmlkZSBgJGFuaW1hdGVgIHdpdGggZXh0cmEgZGV0YWlscyB0aGF0IHRoZSBhbmltYXRpb24gd2lsbFxyXG4gKiBpbmNsdWRlIGludG8gaXRzIGFuaW1hdGlvbi4gTGV0J3Mgc2F5IGZvciBleGFtcGxlIHdlIHdhbnRlZCB0byByZW5kZXIgYW4gYW5pbWF0aW9uIHRoYXQgYW5pbWF0ZXMgYW4gZWxlbWVudFxyXG4gKiB0b3dhcmRzIHRoZSBtb3VzZSBjb29yZGluYXRlcyBhcyB0byB3aGVyZSB0aGUgdXNlciBjbGlja2VkIGxhc3QuIEJ5IGNvbGxlY3RpbmcgdGhlIFgvWSBjb29yZGluYXRlcyBvZiB0aGUgY2xpY2tcclxuICogKHZpYSB0aGUgZXZlbnQgcGFyYW1ldGVyKSB3ZSBjYW4gc2V0IHRoZSBgdG9wYCBhbmQgYGxlZnRgIHN0eWxlcyBpbnRvIGFuIG9iamVjdCBhbmQgcGFzcyB0aGF0IGludG8gb3VyIGZ1bmN0aW9uXHJcbiAqIGNhbGwgdG8gYCRhbmltYXRlLmFkZENsYXNzYC5cclxuICpcclxuICogYGBganNcclxuICogY2FudmFzLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICogICAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCAnb24nLCB7XHJcbiAqICAgICB0bzoge1xyXG4gKiAgICAgICBsZWZ0IDogZS5jbGllbnQueCArICdweCcsXHJcbiAqICAgICAgIHRvcCA6IGUuY2xpZW50LnkgKyAncHgnXHJcbiAqICAgICB9XHJcbiAqICAgfSk6XHJcbiAqIH0pO1xyXG4gKiBgYGBcclxuICpcclxuICogTm93IHdoZW4gdGhlIGFuaW1hdGlvbiBydW5zLCBhbmQgYSB0cmFuc2l0aW9uIG9yIGtleWZyYW1lIGFuaW1hdGlvbiBpcyBwaWNrZWQgdXAsIHRoZW4gdGhlIGFuaW1hdGlvbiBpdHNlbGYgd2lsbFxyXG4gKiBhbHNvIGluY2x1ZGUgYW5kIHRyYW5zaXRpb24gdGhlIHN0eWxpbmcgb2YgdGhlIGBsZWZ0YCBhbmQgYHRvcGAgcHJvcGVydGllcyBpbnRvIGl0cyBydW5uaW5nIGFuaW1hdGlvbi4gSWYgd2Ugd2FudFxyXG4gKiB0byBwcm92aWRlIHNvbWUgc3RhcnRpbmcgYW5pbWF0aW9uIHZhbHVlcyB0aGVuIHdlIGNhbiBkbyBzbyBieSBwbGFjaW5nIHRoZSBzdGFydGluZyBhbmltYXRpb25zIHN0eWxlcyBpbnRvIGFuIG9iamVjdFxyXG4gKiBjYWxsZWQgYGZyb21gIGluIHRoZSBzYW1lIG9iamVjdCBhcyB0aGUgYHRvYCBhbmltYXRpb25zLlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBjYW52YXMub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gKiAgICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdvbicsIHtcclxuICogICAgIGZyb206IHtcclxuICogICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxyXG4gKiAgICAgICAgbGVmdDogJzBweCcsXHJcbiAqICAgICAgICB0b3A6ICcwcHgnXHJcbiAqICAgICB9LFxyXG4gKiAgICAgdG86IHtcclxuICogICAgICAgbGVmdCA6IGUuY2xpZW50LnggKyAncHgnLFxyXG4gKiAgICAgICB0b3AgOiBlLmNsaWVudC55ICsgJ3B4J1xyXG4gKiAgICAgfVxyXG4gKiAgIH0pOlxyXG4gKiB9KTtcclxuICogYGBgXHJcbiAqXHJcbiAqIE9uY2UgdGhlIGFuaW1hdGlvbiBpcyBjb21wbGV0ZSBvciBjYW5jZWxsZWQgdGhlbiB0aGUgdW5pb24gb2YgYm90aCB0aGUgYmVmb3JlIGFuZCBhZnRlciBzdHlsZXMgYXJlIGFwcGxpZWQgdG8gdGhlXHJcbiAqIGVsZW1lbnQuIElmIGBuZ0FuaW1hdGVgIGlzIG5vdCBwcmVzZW50IHRoZW4gdGhlIHN0eWxlcyB3aWxsIGJlIGFwcGxpZWQgaW1tZWRpYXRlbHkuXHJcbiAqXHJcbiAqL1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ25nQW5pbWF0ZScsIFsnbmcnXSlcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIHByb3ZpZGVyXHJcbiAgICogQG5hbWUgJGFuaW1hdGVQcm92aWRlclxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqXHJcbiAgICogVGhlIGAkYW5pbWF0ZVByb3ZpZGVyYCBhbGxvd3MgZGV2ZWxvcGVycyB0byByZWdpc3RlciBKYXZhU2NyaXB0IGFuaW1hdGlvbiBldmVudCBoYW5kbGVycyBkaXJlY3RseSBpbnNpZGUgb2YgYSBtb2R1bGUuXHJcbiAgICogV2hlbiBhbiBhbmltYXRpb24gaXMgdHJpZ2dlcmVkLCB0aGUgJGFuaW1hdGUgc2VydmljZSB3aWxsIHF1ZXJ5IHRoZSAkYW5pbWF0ZSBzZXJ2aWNlIHRvIGZpbmQgYW55IGFuaW1hdGlvbnMgdGhhdCBtYXRjaFxyXG4gICAqIHRoZSBwcm92aWRlZCBuYW1lIHZhbHVlLlxyXG4gICAqXHJcbiAgICogUmVxdWlyZXMgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSB0byBiZSBpbnN0YWxsZWQuXHJcbiAgICpcclxuICAgKiBQbGVhc2UgdmlzaXQgdGhlIHtAbGluayBuZ0FuaW1hdGUgYG5nQW5pbWF0ZWB9IG1vZHVsZSBvdmVydmlldyBwYWdlIGxlYXJuIG1vcmUgYWJvdXQgaG93IHRvIHVzZSBhbmltYXRpb25zIGluIHlvdXIgYXBwbGljYXRpb24uXHJcbiAgICpcclxuICAgKi9cclxuICAuZGlyZWN0aXZlKCduZ0FuaW1hdGVDaGlsZHJlbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIE5HX0FOSU1BVEVfQ0hJTERSRU4gPSAnJCRuZ0FuaW1hdGVDaGlsZHJlbic7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgIHZhciB2YWwgPSBhdHRycy5uZ0FuaW1hdGVDaGlsZHJlbjtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNTdHJpbmcodmFsKSAmJiB2YWwubGVuZ3RoID09PSAwKSB7IC8vZW1wdHkgYXR0cmlidXRlXHJcbiAgICAgICAgZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ0hJTERSRU4sIHRydWUpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNjb3BlLiR3YXRjaCh2YWwsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DSElMRFJFTiwgISF2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfSlcclxuXHJcbiAgLy90aGlzIHByaXZhdGUgc2VydmljZSBpcyBvbmx5IHVzZWQgd2l0aGluIENTUy1lbmFibGVkIGFuaW1hdGlvbnNcclxuICAvL0lFOCArIElFOSBkbyBub3Qgc3VwcG9ydCByQUYgbmF0aXZlbHksIGJ1dCB0aGF0IGlzIGZpbmUgc2luY2UgdGhleVxyXG4gIC8vYWxzbyBkb24ndCBzdXBwb3J0IHRyYW5zaXRpb25zIGFuZCBrZXlmcmFtZXMgd2hpY2ggbWVhbnMgdGhhdCB0aGUgY29kZVxyXG4gIC8vYmVsb3cgd2lsbCBuZXZlciBiZSB1c2VkIGJ5IHRoZSB0d28gYnJvd3NlcnMuXHJcbiAgLmZhY3RvcnkoJyQkYW5pbWF0ZVJlZmxvdycsIFsnJCRyQUYnLCAnJGRvY3VtZW50JywgZnVuY3Rpb24oJCRyQUYsICRkb2N1bWVudCkge1xyXG4gICAgdmFyIGJvZCA9ICRkb2N1bWVudFswXS5ib2R5O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGZuKSB7XHJcbiAgICAgIC8vdGhlIHJldHVybmVkIGZ1bmN0aW9uIGFjdHMgYXMgdGhlIGNhbmNlbGxhdGlvbiBmdW5jdGlvblxyXG4gICAgICByZXR1cm4gJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy90aGUgbGluZSBiZWxvdyB3aWxsIGZvcmNlIHRoZSBicm93c2VyIHRvIHBlcmZvcm0gYSByZXBhaW50XHJcbiAgICAgICAgLy9zbyB0aGF0IGFsbCB0aGUgYW5pbWF0ZWQgZWxlbWVudHMgd2l0aGluIHRoZSBhbmltYXRpb24gZnJhbWVcclxuICAgICAgICAvL3dpbGwgYmUgcHJvcGVybHkgdXBkYXRlZCBhbmQgZHJhd24gb24gc2NyZWVuLiBUaGlzIGlzXHJcbiAgICAgICAgLy9yZXF1aXJlZCB0byBwZXJmb3JtIG11bHRpLWNsYXNzIENTUyBiYXNlZCBhbmltYXRpb25zIHdpdGhcclxuICAgICAgICAvL0ZpcmVmb3guIERPIE5PVCBSRU1PVkUgVEhJUyBMSU5FLlxyXG4gICAgICAgIHZhciBhID0gYm9kLm9mZnNldFdpZHRoICsgMTtcclxuICAgICAgICBmbigpO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgfV0pXHJcblxyXG4gIC5jb25maWcoWyckcHJvdmlkZScsICckYW5pbWF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHByb3ZpZGUsICRhbmltYXRlUHJvdmlkZXIpIHtcclxuICAgIHZhciBub29wID0gYW5ndWxhci5ub29wO1xyXG4gICAgdmFyIGZvckVhY2ggPSBhbmd1bGFyLmZvckVhY2g7XHJcbiAgICB2YXIgc2VsZWN0b3JzID0gJGFuaW1hdGVQcm92aWRlci4kJHNlbGVjdG9ycztcclxuICAgIHZhciBpc0FycmF5ID0gYW5ndWxhci5pc0FycmF5O1xyXG4gICAgdmFyIGlzU3RyaW5nID0gYW5ndWxhci5pc1N0cmluZztcclxuICAgIHZhciBpc09iamVjdCA9IGFuZ3VsYXIuaXNPYmplY3Q7XHJcblxyXG4gICAgdmFyIEVMRU1FTlRfTk9ERSA9IDE7XHJcbiAgICB2YXIgTkdfQU5JTUFURV9TVEFURSA9ICckJG5nQW5pbWF0ZVN0YXRlJztcclxuICAgIHZhciBOR19BTklNQVRFX0NISUxEUkVOID0gJyQkbmdBbmltYXRlQ2hpbGRyZW4nO1xyXG4gICAgdmFyIE5HX0FOSU1BVEVfQ0xBU1NfTkFNRSA9ICduZy1hbmltYXRlJztcclxuICAgIHZhciByb290QW5pbWF0ZVN0YXRlID0ge3J1bm5pbmc6IHRydWV9O1xyXG5cclxuICAgIGZ1bmN0aW9uIGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBlbG0gPSBlbGVtZW50W2ldO1xyXG4gICAgICAgIGlmIChlbG0ubm9kZVR5cGUgPT0gRUxFTUVOVF9OT0RFKSB7XHJcbiAgICAgICAgICByZXR1cm4gZWxtO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHByZXBhcmVFbGVtZW50KGVsZW1lbnQpIHtcclxuICAgICAgcmV0dXJuIGVsZW1lbnQgJiYgYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KSB7XHJcbiAgICAgIHJldHVybiBhbmd1bGFyLmVsZW1lbnQoZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpc01hdGNoaW5nRWxlbWVudChlbG0xLCBlbG0yKSB7XHJcbiAgICAgIHJldHVybiBleHRyYWN0RWxlbWVudE5vZGUoZWxtMSkgPT0gZXh0cmFjdEVsZW1lbnROb2RlKGVsbTIpO1xyXG4gICAgfVxyXG4gICAgdmFyICQkanFMaXRlO1xyXG4gICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckYW5pbWF0ZScsXHJcbiAgICAgICAgWyckZGVsZWdhdGUnLCAnJCRxJywgJyRpbmplY3RvcicsICckc25pZmZlcicsICckcm9vdEVsZW1lbnQnLCAnJCRhc3luY0NhbGxiYWNrJywgJyRyb290U2NvcGUnLCAnJGRvY3VtZW50JywgJyR0ZW1wbGF0ZVJlcXVlc3QnLCAnJCRqcUxpdGUnLFxyXG4gZnVuY3Rpb24oJGRlbGVnYXRlLCAgICQkcSwgICAkaW5qZWN0b3IsICAgJHNuaWZmZXIsICAgJHJvb3RFbGVtZW50LCAgICQkYXN5bmNDYWxsYmFjaywgICAkcm9vdFNjb3BlLCAgICRkb2N1bWVudCwgICAkdGVtcGxhdGVSZXF1ZXN0LCAgICQkJGpxTGl0ZSkge1xyXG5cclxuICAgICAgJCRqcUxpdGUgPSAkJCRqcUxpdGU7XHJcbiAgICAgICRyb290RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUsIHJvb3RBbmltYXRlU3RhdGUpO1xyXG5cclxuICAgICAgLy8gV2FpdCB1bnRpbCBhbGwgZGlyZWN0aXZlIGFuZCByb3V0ZS1yZWxhdGVkIHRlbXBsYXRlcyBhcmUgZG93bmxvYWRlZCBhbmRcclxuICAgICAgLy8gY29tcGlsZWQuIFRoZSAkdGVtcGxhdGVSZXF1ZXN0LnRvdGFsUGVuZGluZ1JlcXVlc3RzIHZhcmlhYmxlIGtlZXBzIHRyYWNrIG9mXHJcbiAgICAgIC8vIGFsbCBvZiB0aGUgcmVtb3RlIHRlbXBsYXRlcyBiZWluZyBjdXJyZW50bHkgZG93bmxvYWRlZC4gSWYgdGhlcmUgYXJlIG5vXHJcbiAgICAgIC8vIHRlbXBsYXRlcyBjdXJyZW50bHkgZG93bmxvYWRpbmcgdGhlbiB0aGUgd2F0Y2hlciB3aWxsIHN0aWxsIGZpcmUgYW55d2F5LlxyXG4gICAgICB2YXIgZGVyZWdpc3RlcldhdGNoID0gJHJvb3RTY29wZS4kd2F0Y2goXHJcbiAgICAgICAgZnVuY3Rpb24oKSB7IHJldHVybiAkdGVtcGxhdGVSZXF1ZXN0LnRvdGFsUGVuZGluZ1JlcXVlc3RzOyB9LFxyXG4gICAgICAgIGZ1bmN0aW9uKHZhbCwgb2xkVmFsKSB7XHJcbiAgICAgICAgICBpZiAodmFsICE9PSAwKSByZXR1cm47XHJcbiAgICAgICAgICBkZXJlZ2lzdGVyV2F0Y2goKTtcclxuXHJcbiAgICAgICAgICAvLyBOb3cgdGhhdCBhbGwgdGVtcGxhdGVzIGhhdmUgYmVlbiBkb3dubG9hZGVkLCAkYW5pbWF0ZSB3aWxsIHdhaXQgdW50aWxcclxuICAgICAgICAgIC8vIHRoZSBwb3N0IGRpZ2VzdCBxdWV1ZSBpcyBlbXB0eSBiZWZvcmUgZW5hYmxpbmcgYW5pbWF0aW9ucy4gQnkgaGF2aW5nIHR3b1xyXG4gICAgICAgICAgLy8gY2FsbHMgdG8gJHBvc3REaWdlc3QgY2FsbHMgd2UgY2FuIGVuc3VyZSB0aGF0IHRoZSBmbGFnIGlzIGVuYWJsZWQgYXQgdGhlXHJcbiAgICAgICAgICAvLyB2ZXJ5IGVuZCBvZiB0aGUgcG9zdCBkaWdlc3QgcXVldWUuIFNpbmNlIGFsbCBvZiB0aGUgYW5pbWF0aW9ucyBpbiAkYW5pbWF0ZVxyXG4gICAgICAgICAgLy8gdXNlICRwb3N0RGlnZXN0LCBpdCdzIGltcG9ydGFudCB0aGF0IHRoZSBjb2RlIGJlbG93IGV4ZWN1dGVzIGF0IHRoZSBlbmQuXHJcbiAgICAgICAgICAvLyBUaGlzIGJhc2ljYWxseSBtZWFucyB0aGF0IHRoZSBwYWdlIGlzIGZ1bGx5IGRvd25sb2FkZWQgYW5kIGNvbXBpbGVkIGJlZm9yZVxyXG4gICAgICAgICAgLy8gYW55IGFuaW1hdGlvbnMgYXJlIHRyaWdnZXJlZC5cclxuICAgICAgICAgICRyb290U2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICByb290QW5pbWF0ZVN0YXRlLnJ1bm5pbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICk7XHJcblxyXG4gICAgICB2YXIgZ2xvYmFsQW5pbWF0aW9uQ291bnRlciA9IDA7XHJcbiAgICAgIHZhciBjbGFzc05hbWVGaWx0ZXIgPSAkYW5pbWF0ZVByb3ZpZGVyLmNsYXNzTmFtZUZpbHRlcigpO1xyXG4gICAgICB2YXIgaXNBbmltYXRhYmxlQ2xhc3NOYW1lID0gIWNsYXNzTmFtZUZpbHRlclxyXG4gICAgICAgICAgICAgID8gZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9XHJcbiAgICAgICAgICAgICAgOiBmdW5jdGlvbihjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjbGFzc05hbWVGaWx0ZXIudGVzdChjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICBmdW5jdGlvbiBjbGFzc0Jhc2VkQW5pbWF0aW9uc0Jsb2NrZWQoZWxlbWVudCwgc2V0dGVyKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XHJcbiAgICAgICAgaWYgKHNldHRlcikge1xyXG4gICAgICAgICAgZGF0YS5ydW5uaW5nID0gdHJ1ZTtcclxuICAgICAgICAgIGRhdGEuc3RydWN0dXJhbCA9IHRydWU7XHJcbiAgICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhLmRpc2FibGVkIHx8IChkYXRhLnJ1bm5pbmcgJiYgZGF0YS5zdHJ1Y3R1cmFsKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gcnVuQW5pbWF0aW9uUG9zdERpZ2VzdChmbikge1xyXG4gICAgICAgIHZhciBjYW5jZWxGbiwgZGVmZXIgPSAkJHEuZGVmZXIoKTtcclxuICAgICAgICBkZWZlci5wcm9taXNlLiQkY2FuY2VsRm4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGNhbmNlbEZuICYmIGNhbmNlbEZuKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkcm9vdFNjb3BlLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGNhbmNlbEZuID0gZm4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpIHtcclxuICAgICAgICAvLyBzb21lIHBsdWdpbiBjb2RlIG1heSBzdGlsbCBiZSBwYXNzaW5nIGluIHRoZSBjYWxsYmFja1xyXG4gICAgICAgIC8vIGZ1bmN0aW9uIGFzIHRoZSBsYXN0IHBhcmFtIGZvciB0aGUgJGFuaW1hdGUgbWV0aG9kcyBzb1xyXG4gICAgICAgIC8vIGl0J3MgYmVzdCB0byBvbmx5IGFsbG93IHN0cmluZyBvciBhcnJheSB2YWx1ZXMgZm9yIG5vd1xyXG4gICAgICAgIGlmIChpc09iamVjdChvcHRpb25zKSkge1xyXG4gICAgICAgICAgaWYgKG9wdGlvbnMudGVtcENsYXNzZXMgJiYgaXNTdHJpbmcob3B0aW9ucy50ZW1wQ2xhc3NlcykpIHtcclxuICAgICAgICAgICAgb3B0aW9ucy50ZW1wQ2xhc3NlcyA9IG9wdGlvbnMudGVtcENsYXNzZXMuc3BsaXQoL1xccysvKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBvcHRpb25zO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gcmVzb2x2ZUVsZW1lbnRDbGFzc2VzKGVsZW1lbnQsIGNhY2hlLCBydW5uaW5nQW5pbWF0aW9ucykge1xyXG4gICAgICAgIHJ1bm5pbmdBbmltYXRpb25zID0gcnVubmluZ0FuaW1hdGlvbnMgfHwge307XHJcblxyXG4gICAgICAgIHZhciBsb29rdXAgPSB7fTtcclxuICAgICAgICBmb3JFYWNoKHJ1bm5pbmdBbmltYXRpb25zLCBmdW5jdGlvbihkYXRhLCBzZWxlY3Rvcikge1xyXG4gICAgICAgICAgZm9yRWFjaChzZWxlY3Rvci5zcGxpdCgnICcpLCBmdW5jdGlvbihzKSB7XHJcbiAgICAgICAgICAgIGxvb2t1cFtzXT1kYXRhO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBoYXNDbGFzc2VzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgICAgICBmb3JFYWNoKChlbGVtZW50LmF0dHIoJ2NsYXNzJykgfHwgJycpLnNwbGl0KC9cXHMrLyksIGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgaGFzQ2xhc3Nlc1tjbGFzc05hbWVdID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIHRvQWRkID0gW10sIHRvUmVtb3ZlID0gW107XHJcbiAgICAgICAgZm9yRWFjaCgoY2FjaGUgJiYgY2FjaGUuY2xhc3NlcykgfHwgW10sIGZ1bmN0aW9uKHN0YXR1cywgY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICB2YXIgaGFzQ2xhc3MgPSBoYXNDbGFzc2VzW2NsYXNzTmFtZV07XHJcbiAgICAgICAgICB2YXIgbWF0Y2hpbmdBbmltYXRpb24gPSBsb29rdXBbY2xhc3NOYW1lXSB8fCB7fTtcclxuXHJcbiAgICAgICAgICAvLyBXaGVuIGFkZENsYXNzIGFuZCByZW1vdmVDbGFzcyBpcyBjYWxsZWQgdGhlbiAkYW5pbWF0ZSB3aWxsIGNoZWNrIHRvXHJcbiAgICAgICAgICAvLyBzZWUgaWYgYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIGNhbmNlbCBlYWNoIG90aGVyIG91dC4gV2hlbiB0aGVyZSBhcmVcclxuICAgICAgICAgIC8vIG1vcmUgY2FsbHMgdG8gcmVtb3ZlQ2xhc3MgdGhhbiBhZGRDbGFzcyB0aGVuIHRoZSBjb3VudCBmYWxscyBiZWxvdyAwXHJcbiAgICAgICAgICAvLyBhbmQgdGhlbiB0aGUgcmVtb3ZlQ2xhc3MgYW5pbWF0aW9uIHdpbGwgYmUgYWxsb3dlZC4gT3RoZXJ3aXNlIGlmIHRoZVxyXG4gICAgICAgICAgLy8gY291bnQgaXMgYWJvdmUgMCB0aGVuIHRoYXQgbWVhbnMgYW4gYWRkQ2xhc3MgYW5pbWF0aW9uIHdpbGwgY29tbWVuY2UuXHJcbiAgICAgICAgICAvLyBPbmNlIGFuIGFuaW1hdGlvbiBpcyBhbGxvd2VkIHRoZW4gdGhlIGNvZGUgd2lsbCBhbHNvIGNoZWNrIHRvIHNlZSBpZlxyXG4gICAgICAgICAgLy8gdGhlcmUgZXhpc3RzIGFueSBvbi1nb2luZyBhbmltYXRpb24gdGhhdCBpcyBhbHJlYWR5IGFkZGluZyBvciByZW12b2luZ1xyXG4gICAgICAgICAgLy8gdGhlIG1hdGNoaW5nIENTUyBjbGFzcy5cclxuICAgICAgICAgIGlmIChzdGF0dXMgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIC8vZG9lcyBpdCBoYXZlIHRoZSBjbGFzcyBvciB3aWxsIGl0IGhhdmUgdGhlIGNsYXNzXHJcbiAgICAgICAgICAgIGlmIChoYXNDbGFzcyB8fCBtYXRjaGluZ0FuaW1hdGlvbi5ldmVudCA9PSAnYWRkQ2xhc3MnKSB7XHJcbiAgICAgICAgICAgICAgdG9SZW1vdmUucHVzaChjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAvL2lzIHRoZSBjbGFzcyBtaXNzaW5nIG9yIHdpbGwgaXQgYmUgcmVtb3ZlZD9cclxuICAgICAgICAgICAgaWYgKCFoYXNDbGFzcyB8fCBtYXRjaGluZ0FuaW1hdGlvbi5ldmVudCA9PSAncmVtb3ZlQ2xhc3MnKSB7XHJcbiAgICAgICAgICAgICAgdG9BZGQucHVzaChjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiAodG9BZGQubGVuZ3RoICsgdG9SZW1vdmUubGVuZ3RoKSA+IDAgJiYgW3RvQWRkLmpvaW4oJyAnKSwgdG9SZW1vdmUuam9pbignICcpXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gbG9va3VwKG5hbWUpIHtcclxuICAgICAgICBpZiAobmFtZSkge1xyXG4gICAgICAgICAgdmFyIG1hdGNoZXMgPSBbXSxcclxuICAgICAgICAgICAgICBmbGFnTWFwID0ge30sXHJcbiAgICAgICAgICAgICAgY2xhc3NlcyA9IG5hbWUuc3Vic3RyKDEpLnNwbGl0KCcuJyk7XHJcblxyXG4gICAgICAgICAgLy90aGUgZW1wdHkgc3RyaW5nIHZhbHVlIGlzIHRoZSBkZWZhdWx0IGFuaW1hdGlvblxyXG4gICAgICAgICAgLy9vcGVyYXRpb24gd2hpY2ggcGVyZm9ybXMgQ1NTIHRyYW5zaXRpb24gYW5kIGtleWZyYW1lXHJcbiAgICAgICAgICAvL2FuaW1hdGlvbnMgc25pZmZpbmcuIFRoaXMgaXMgYWx3YXlzIGluY2x1ZGVkIGZvciBlYWNoXHJcbiAgICAgICAgICAvL2VsZW1lbnQgYW5pbWF0aW9uIHByb2NlZHVyZSBpZiB0aGUgYnJvd3NlciBzdXBwb3J0c1xyXG4gICAgICAgICAgLy90cmFuc2l0aW9ucyBhbmQvb3Iga2V5ZnJhbWUgYW5pbWF0aW9ucy4gVGhlIGRlZmF1bHRcclxuICAgICAgICAgIC8vYW5pbWF0aW9uIGlzIGFkZGVkIHRvIHRoZSB0b3Agb2YgdGhlIGxpc3QgdG8gcHJldmVudFxyXG4gICAgICAgICAgLy9hbnkgcHJldmlvdXMgYW5pbWF0aW9ucyBmcm9tIGFmZmVjdGluZyB0aGUgZWxlbWVudCBzdHlsaW5nXHJcbiAgICAgICAgICAvL3ByaW9yIHRvIHRoZSBlbGVtZW50IGJlaW5nIGFuaW1hdGVkLlxyXG4gICAgICAgICAgaWYgKCRzbmlmZmVyLnRyYW5zaXRpb25zIHx8ICRzbmlmZmVyLmFuaW1hdGlvbnMpIHtcclxuICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKCRpbmplY3Rvci5nZXQoc2VsZWN0b3JzWycnXSkpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGZvciAodmFyIGk9MDsgaSA8IGNsYXNzZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGtsYXNzID0gY2xhc3Nlc1tpXSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yRmFjdG9yeU5hbWUgPSBzZWxlY3RvcnNba2xhc3NdO1xyXG4gICAgICAgICAgICBpZiAoc2VsZWN0b3JGYWN0b3J5TmFtZSAmJiAhZmxhZ01hcFtrbGFzc10pIHtcclxuICAgICAgICAgICAgICBtYXRjaGVzLnB1c2goJGluamVjdG9yLmdldChzZWxlY3RvckZhY3RvcnlOYW1lKSk7XHJcbiAgICAgICAgICAgICAgZmxhZ01hcFtrbGFzc10gPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICByZXR1cm4gbWF0Y2hlcztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGlvblJ1bm5lcihlbGVtZW50LCBhbmltYXRpb25FdmVudCwgY2xhc3NOYW1lLCBvcHRpb25zKSB7XHJcbiAgICAgICAgLy90cmFuc2NsdWRlZCBkaXJlY3RpdmVzIG1heSBzb21ldGltZXMgZmlyZSBhbiBhbmltYXRpb24gdXNpbmcgb25seSBjb21tZW50IG5vZGVzXHJcbiAgICAgICAgLy9iZXN0IHRvIGNhdGNoIHRoaXMgZWFybHkgb24gdG8gcHJldmVudCBhbnkgYW5pbWF0aW9uIG9wZXJhdGlvbnMgZnJvbSBvY2N1cnJpbmdcclxuICAgICAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF07XHJcbiAgICAgICAgaWYgKCFub2RlKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucy50byA9IG9wdGlvbnMudG8gfHwge307XHJcbiAgICAgICAgICBvcHRpb25zLmZyb20gPSBvcHRpb25zLmZyb20gfHwge307XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgY2xhc3NOYW1lQWRkO1xyXG4gICAgICAgIHZhciBjbGFzc05hbWVSZW1vdmU7XHJcbiAgICAgICAgaWYgKGlzQXJyYXkoY2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgY2xhc3NOYW1lQWRkID0gY2xhc3NOYW1lWzBdO1xyXG4gICAgICAgICAgY2xhc3NOYW1lUmVtb3ZlID0gY2xhc3NOYW1lWzFdO1xyXG4gICAgICAgICAgaWYgKCFjbGFzc05hbWVBZGQpIHtcclxuICAgICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lUmVtb3ZlO1xyXG4gICAgICAgICAgICBhbmltYXRpb25FdmVudCA9ICdyZW1vdmVDbGFzcyc7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKCFjbGFzc05hbWVSZW1vdmUpIHtcclxuICAgICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lQWRkO1xyXG4gICAgICAgICAgICBhbmltYXRpb25FdmVudCA9ICdhZGRDbGFzcyc7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWVBZGQgKyAnICcgKyBjbGFzc05hbWVSZW1vdmU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaXNTZXRDbGFzc09wZXJhdGlvbiA9IGFuaW1hdGlvbkV2ZW50ID09ICdzZXRDbGFzcyc7XHJcbiAgICAgICAgdmFyIGlzQ2xhc3NCYXNlZCA9IGlzU2V0Q2xhc3NPcGVyYXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgYW5pbWF0aW9uRXZlbnQgPT0gJ2FkZENsYXNzJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBhbmltYXRpb25FdmVudCA9PSAncmVtb3ZlQ2xhc3MnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IGFuaW1hdGlvbkV2ZW50ID09ICdhbmltYXRlJztcclxuXHJcbiAgICAgICAgdmFyIGN1cnJlbnRDbGFzc05hbWUgPSBlbGVtZW50LmF0dHIoJ2NsYXNzJyk7XHJcbiAgICAgICAgdmFyIGNsYXNzZXMgPSBjdXJyZW50Q2xhc3NOYW1lICsgJyAnICsgY2xhc3NOYW1lO1xyXG4gICAgICAgIGlmICghaXNBbmltYXRhYmxlQ2xhc3NOYW1lKGNsYXNzZXMpKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgYmVmb3JlQ29tcGxldGUgPSBub29wLFxyXG4gICAgICAgICAgICBiZWZvcmVDYW5jZWwgPSBbXSxcclxuICAgICAgICAgICAgYmVmb3JlID0gW10sXHJcbiAgICAgICAgICAgIGFmdGVyQ29tcGxldGUgPSBub29wLFxyXG4gICAgICAgICAgICBhZnRlckNhbmNlbCA9IFtdLFxyXG4gICAgICAgICAgICBhZnRlciA9IFtdO1xyXG5cclxuICAgICAgICB2YXIgYW5pbWF0aW9uTG9va3VwID0gKCcgJyArIGNsYXNzZXMpLnJlcGxhY2UoL1xccysvZywnLicpO1xyXG4gICAgICAgIGZvckVhY2gobG9va3VwKGFuaW1hdGlvbkxvb2t1cCksIGZ1bmN0aW9uKGFuaW1hdGlvbkZhY3RvcnkpIHtcclxuICAgICAgICAgIHZhciBjcmVhdGVkID0gcmVnaXN0ZXJBbmltYXRpb24oYW5pbWF0aW9uRmFjdG9yeSwgYW5pbWF0aW9uRXZlbnQpO1xyXG4gICAgICAgICAgaWYgKCFjcmVhdGVkICYmIGlzU2V0Q2xhc3NPcGVyYXRpb24pIHtcclxuICAgICAgICAgICAgcmVnaXN0ZXJBbmltYXRpb24oYW5pbWF0aW9uRmFjdG9yeSwgJ2FkZENsYXNzJyk7XHJcbiAgICAgICAgICAgIHJlZ2lzdGVyQW5pbWF0aW9uKGFuaW1hdGlvbkZhY3RvcnksICdyZW1vdmVDbGFzcycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiByZWdpc3RlckFuaW1hdGlvbihhbmltYXRpb25GYWN0b3J5LCBldmVudCkge1xyXG4gICAgICAgICAgdmFyIGFmdGVyRm4gPSBhbmltYXRpb25GYWN0b3J5W2V2ZW50XTtcclxuICAgICAgICAgIHZhciBiZWZvcmVGbiA9IGFuaW1hdGlvbkZhY3RvcnlbJ2JlZm9yZScgKyBldmVudC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGV2ZW50LnN1YnN0cigxKV07XHJcbiAgICAgICAgICBpZiAoYWZ0ZXJGbiB8fCBiZWZvcmVGbikge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQgPT0gJ2xlYXZlJykge1xyXG4gICAgICAgICAgICAgIGJlZm9yZUZuID0gYWZ0ZXJGbjtcclxuICAgICAgICAgICAgICAvL3doZW4gc2V0IGFzIG51bGwgdGhlbiBhbmltYXRpb24ga25vd3MgdG8gc2tpcCB0aGlzIHBoYXNlXHJcbiAgICAgICAgICAgICAgYWZ0ZXJGbiA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYWZ0ZXIucHVzaCh7XHJcbiAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LCBmbjogYWZ0ZXJGblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYmVmb3JlLnB1c2goe1xyXG4gICAgICAgICAgICAgIGV2ZW50OiBldmVudCwgZm46IGJlZm9yZUZuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJ1bihmbnMsIGNhbmNlbGxhdGlvbnMsIGFsbENvbXBsZXRlRm4pIHtcclxuICAgICAgICAgIHZhciBhbmltYXRpb25zID0gW107XHJcbiAgICAgICAgICBmb3JFYWNoKGZucywgZnVuY3Rpb24oYW5pbWF0aW9uKSB7XHJcbiAgICAgICAgICAgIGFuaW1hdGlvbi5mbiAmJiBhbmltYXRpb25zLnB1c2goYW5pbWF0aW9uKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgICAgICBmdW5jdGlvbiBhZnRlckFuaW1hdGlvbkNvbXBsZXRlKGluZGV4KSB7XHJcbiAgICAgICAgICAgIGlmIChjYW5jZWxsYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgKGNhbmNlbGxhdGlvbnNbaW5kZXhdIHx8IG5vb3ApKCk7XHJcbiAgICAgICAgICAgICAgaWYgKCsrY291bnQgPCBhbmltYXRpb25zLmxlbmd0aCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvL1RoZSBjb2RlIGJlbG93IGFkZHMgZGlyZWN0bHkgdG8gdGhlIGFycmF5IGluIG9yZGVyIHRvIHdvcmsgd2l0aFxyXG4gICAgICAgICAgLy9ib3RoIHN5bmMgYW5kIGFzeW5jIGFuaW1hdGlvbnMuIFN5bmMgYW5pbWF0aW9ucyBhcmUgd2hlbiB0aGUgZG9uZSgpXHJcbiAgICAgICAgICAvL29wZXJhdGlvbiBpcyBjYWxsZWQgcmlnaHQgYXdheS4gRE8gTk9UIFJFRkFDVE9SIVxyXG4gICAgICAgICAgZm9yRWFjaChhbmltYXRpb25zLCBmdW5jdGlvbihhbmltYXRpb24sIGluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBwcm9ncmVzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUoaW5kZXgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGFuaW1hdGlvbi5ldmVudCkge1xyXG4gICAgICAgICAgICAgIGNhc2UgJ3NldENsYXNzJzpcclxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgY2xhc3NOYW1lQWRkLCBjbGFzc05hbWVSZW1vdmUsIHByb2dyZXNzLCBvcHRpb25zKSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlICdhbmltYXRlJzpcclxuICAgICAgICAgICAgICAgIGNhbmNlbGxhdGlvbnMucHVzaChhbmltYXRpb24uZm4oZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zLmZyb20sIG9wdGlvbnMudG8sIHByb2dyZXNzKSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICBjYXNlICdhZGRDbGFzcyc6XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zLnB1c2goYW5pbWF0aW9uLmZuKGVsZW1lbnQsIGNsYXNzTmFtZUFkZCB8fCBjbGFzc05hbWUsICAgICBwcm9ncmVzcywgb3B0aW9ucykpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgY2FzZSAncmVtb3ZlQ2xhc3MnOlxyXG4gICAgICAgICAgICAgICAgY2FuY2VsbGF0aW9ucy5wdXNoKGFuaW1hdGlvbi5mbihlbGVtZW50LCBjbGFzc05hbWVSZW1vdmUgfHwgY2xhc3NOYW1lLCAgcHJvZ3Jlc3MsIG9wdGlvbnMpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxsYXRpb25zLnB1c2goYW5pbWF0aW9uLmZuKGVsZW1lbnQsIHByb2dyZXNzLCBvcHRpb25zKSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgaWYgKGNhbmNlbGxhdGlvbnMgJiYgY2FuY2VsbGF0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgYWxsQ29tcGxldGVGbigpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIG5vZGU6IG5vZGUsXHJcbiAgICAgICAgICBldmVudDogYW5pbWF0aW9uRXZlbnQsXHJcbiAgICAgICAgICBjbGFzc05hbWU6IGNsYXNzTmFtZSxcclxuICAgICAgICAgIGlzQ2xhc3NCYXNlZDogaXNDbGFzc0Jhc2VkLFxyXG4gICAgICAgICAgaXNTZXRDbGFzc09wZXJhdGlvbjogaXNTZXRDbGFzc09wZXJhdGlvbixcclxuICAgICAgICAgIGFwcGx5U3R5bGVzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICBlbGVtZW50LmNzcyhhbmd1bGFyLmV4dGVuZChvcHRpb25zLmZyb20gfHwge30sIG9wdGlvbnMudG8gfHwge30pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIGJlZm9yZTogZnVuY3Rpb24oYWxsQ29tcGxldGVGbikge1xyXG4gICAgICAgICAgICBiZWZvcmVDb21wbGV0ZSA9IGFsbENvbXBsZXRlRm47XHJcbiAgICAgICAgICAgIHJ1bihiZWZvcmUsIGJlZm9yZUNhbmNlbCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgYmVmb3JlQ29tcGxldGUgPSBub29wO1xyXG4gICAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgYWZ0ZXI6IGZ1bmN0aW9uKGFsbENvbXBsZXRlRm4pIHtcclxuICAgICAgICAgICAgYWZ0ZXJDb21wbGV0ZSA9IGFsbENvbXBsZXRlRm47XHJcbiAgICAgICAgICAgIHJ1bihhZnRlciwgYWZ0ZXJDYW5jZWwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIGFmdGVyQ29tcGxldGUgPSBub29wO1xyXG4gICAgICAgICAgICAgIGFsbENvbXBsZXRlRm4oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKGJlZm9yZUNhbmNlbCkge1xyXG4gICAgICAgICAgICAgIGZvckVhY2goYmVmb3JlQ2FuY2VsLCBmdW5jdGlvbihjYW5jZWxGbikge1xyXG4gICAgICAgICAgICAgICAgKGNhbmNlbEZuIHx8IG5vb3ApKHRydWUpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIGJlZm9yZUNvbXBsZXRlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhZnRlckNhbmNlbCkge1xyXG4gICAgICAgICAgICAgIGZvckVhY2goYWZ0ZXJDYW5jZWwsIGZ1bmN0aW9uKGNhbmNlbEZuKSB7XHJcbiAgICAgICAgICAgICAgICAoY2FuY2VsRm4gfHwgbm9vcCkodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgYWZ0ZXJDb21wbGV0ZSh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAgICAgKiBAbmFtZSAkYW5pbWF0ZVxyXG4gICAgICAgKiBAa2luZCBvYmplY3RcclxuICAgICAgICpcclxuICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAqIFRoZSBgJGFuaW1hdGVgIHNlcnZpY2UgcHJvdmlkZXMgYW5pbWF0aW9uIGRldGVjdGlvbiBzdXBwb3J0IHdoaWxlIHBlcmZvcm1pbmcgRE9NIG9wZXJhdGlvbnMgKGVudGVyLCBsZWF2ZSBhbmQgbW92ZSkgYXMgd2VsbCBhcyBkdXJpbmcgYWRkQ2xhc3MgYW5kIHJlbW92ZUNsYXNzIG9wZXJhdGlvbnMuXHJcbiAgICAgICAqIFdoZW4gYW55IG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHJ1biwgdGhlICRhbmltYXRlIHNlcnZpY2VcclxuICAgICAgICogd2lsbCBleGFtaW5lIGFueSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyAod2hpY2ggYXJlIGRlZmluZWQgYnkgdXNpbmcgdGhlICRhbmltYXRlUHJvdmlkZXIgcHJvdmlkZXIgb2JqZWN0KVxyXG4gICAgICAgKiBhcyB3ZWxsIGFzIGFueSBDU1MtZGVmaW5lZCBhbmltYXRpb25zIGFnYWluc3QgdGhlIENTUyBjbGFzc2VzIHByZXNlbnQgb24gdGhlIGVsZW1lbnQgb25jZSB0aGUgRE9NIG9wZXJhdGlvbiBpcyBydW4uXHJcbiAgICAgICAqXHJcbiAgICAgICAqIFRoZSBgJGFuaW1hdGVgIHNlcnZpY2UgaXMgdXNlZCBiZWhpbmQgdGhlIHNjZW5lcyB3aXRoIHByZS1leGlzdGluZyBkaXJlY3RpdmVzIGFuZCBhbmltYXRpb24gd2l0aCB0aGVzZSBkaXJlY3RpdmVzXHJcbiAgICAgICAqIHdpbGwgd29yayBvdXQgb2YgdGhlIGJveCB3aXRob3V0IGFueSBleHRyYSBjb25maWd1cmF0aW9uLlxyXG4gICAgICAgKlxyXG4gICAgICAgKiBSZXF1aXJlcyB0aGUge0BsaW5rIG5nQW5pbWF0ZSBgbmdBbmltYXRlYH0gbW9kdWxlIHRvIGJlIGluc3RhbGxlZC5cclxuICAgICAgICpcclxuICAgICAgICogUGxlYXNlIHZpc2l0IHRoZSB7QGxpbmsgbmdBbmltYXRlIGBuZ0FuaW1hdGVgfSBtb2R1bGUgb3ZlcnZpZXcgcGFnZSBsZWFybiBtb3JlIGFib3V0IGhvdyB0byB1c2UgYW5pbWF0aW9ucyBpbiB5b3VyIGFwcGxpY2F0aW9uLlxyXG4gICAgICAgKiAjIyBDYWxsYmFjayBQcm9taXNlc1xyXG4gICAgICAgKiBXaXRoIEFuZ3VsYXJKUyAxLjMsIGVhY2ggb2YgdGhlIGFuaW1hdGlvbiBtZXRob2RzLCBvbiB0aGUgYCRhbmltYXRlYCBzZXJ2aWNlLCByZXR1cm4gYSBwcm9taXNlIHdoZW4gY2FsbGVkLiBUaGVcclxuICAgICAgICogcHJvbWlzZSBpdHNlbGYgaXMgdGhlbiByZXNvbHZlZCBvbmNlIHRoZSBhbmltYXRpb24gaGFzIGNvbXBsZXRlZCBpdHNlbGYsIGhhcyBiZWVuIGNhbmNlbGxlZCBvciBoYXMgYmVlblxyXG4gICAgICAgKiBza2lwcGVkIGR1ZSB0byBhbmltYXRpb25zIGJlaW5nIGRpc2FibGVkLiAoTm90ZSB0aGF0IGV2ZW4gaWYgdGhlIGFuaW1hdGlvbiBpcyBjYW5jZWxsZWQgaXQgd2lsbCBzdGlsbFxyXG4gICAgICAgKiBjYWxsIHRoZSByZXNvbHZlIGZ1bmN0aW9uIG9mIHRoZSBhbmltYXRpb24uKVxyXG4gICAgICAgKlxyXG4gICAgICAgKiBgYGBqc1xyXG4gICAgICAgKiAkYW5pbWF0ZS5lbnRlcihlbGVtZW50LCBjb250YWluZXIpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAqICAgLy8uLi50aGlzIGlzIGNhbGxlZCBvbmNlIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGUuLi5cclxuICAgICAgICogfSk7XHJcbiAgICAgICAqIGBgYFxyXG4gICAgICAgKlxyXG4gICAgICAgKiBBbHNvIG5vdGUgdGhhdCwgZHVlIHRvIHRoZSBuYXR1cmUgb2YgdGhlIGNhbGxiYWNrIHByb21pc2UsIGlmIGFueSBBbmd1bGFyLXNwZWNpZmljIGNvZGUgKGxpa2UgY2hhbmdpbmcgdGhlIHNjb3BlLFxyXG4gICAgICAgKiBsb2NhdGlvbiBvZiB0aGUgcGFnZSwgZXRjLi4uKSBpcyBleGVjdXRlZCB3aXRoaW4gdGhlIGNhbGxiYWNrIHByb21pc2UgdGhlbiBiZSBzdXJlIHRvIHdyYXAgdGhlIGNvZGUgdXNpbmdcclxuICAgICAgICogYCRzY29wZS4kYXBwbHkoLi4uKWA7XHJcbiAgICAgICAqXHJcbiAgICAgICAqIGBgYGpzXHJcbiAgICAgICAqICRhbmltYXRlLmxlYXZlKGVsZW1lbnQpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAqICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICogICAgICRsb2NhdGlvbi5wYXRoKCcvbmV3LXBhZ2UnKTtcclxuICAgICAgICogICB9KTtcclxuICAgICAgICogfSk7XHJcbiAgICAgICAqIGBgYFxyXG4gICAgICAgKlxyXG4gICAgICAgKiBBbiBhbmltYXRpb24gY2FuIGFsc28gYmUgY2FuY2VsbGVkIGJ5IGNhbGxpbmcgdGhlIGAkYW5pbWF0ZS5jYW5jZWwocHJvbWlzZSlgIG1ldGhvZCB3aXRoIHRoZSBwcm92aWRlZFxyXG4gICAgICAgKiBwcm9taXNlIHRoYXQgd2FzIHJldHVybmVkIHdoZW4gdGhlIGFuaW1hdGlvbiB3YXMgc3RhcnRlZC5cclxuICAgICAgICpcclxuICAgICAgICogYGBganNcclxuICAgICAgICogdmFyIHByb21pc2UgPSAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCAnc3VwZXItbG9uZy1hbmltYXRpb24nKTtcclxuICAgICAgICogcHJvbWlzZS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgKiAgIC8vdGhpcyB3aWxsIHN0aWxsIGJlIGNhbGxlZCBldmVuIGlmIGNhbmNlbGxlZFxyXG4gICAgICAgKiB9KTtcclxuICAgICAgICpcclxuICAgICAgICogZWxlbWVudC5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICogICAvL3Rvb28gbGF6eSB0byB3YWl0IGZvciB0aGUgYW5pbWF0aW9uIHRvIGVuZFxyXG4gICAgICAgKiAgICRhbmltYXRlLmNhbmNlbChwcm9taXNlKTtcclxuICAgICAgICogfSk7XHJcbiAgICAgICAqIGBgYFxyXG4gICAgICAgKlxyXG4gICAgICAgKiAoS2VlcCBpbiBtaW5kIHRoYXQgdGhlIHByb21pc2UgY2FuY2VsbGF0aW9uIGlzIHVuaXF1ZSB0byBgJGFuaW1hdGVgIHNpbmNlIHByb21pc2VzIGluXHJcbiAgICAgICAqIGdlbmVyYWwgY2Fubm90IGJlIGNhbmNlbGxlZC4pXHJcbiAgICAgICAqXHJcbiAgICAgICAqL1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNhbmltYXRlXHJcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIFBlcmZvcm1zIGFuIGlubGluZSBhbmltYXRpb24gb24gdGhlIGVsZW1lbnQgd2hpY2ggYXBwbGllcyB0aGUgcHJvdmlkZWQgYHRvYCBhbmQgYGZyb21gIENTUyBzdHlsZXMgdG8gdGhlIGVsZW1lbnQuXHJcbiAgICAgICAgICogSWYgYW55IGRldGVjdGVkIENTUyB0cmFuc2l0aW9uLCBrZXlmcmFtZSBvciBKYXZhU2NyaXB0IG1hdGNoZXMgdGhlIHByb3ZpZGVkIGBjbGFzc05hbWVgIHZhbHVlIHRoZW4gdGhlIGFuaW1hdGlvblxyXG4gICAgICAgICAqIHdpbGwgdGFrZSBvbiB0aGUgcHJvdmlkZWQgc3R5bGVzLiBGb3IgZXhhbXBsZSwgaWYgYSB0cmFuc2l0aW9uIGFuaW1hdGlvbiBpcyBzZXQgZm9yIHRoZSBnaXZlbiBjbGFzc05hbWUgdGhlbiB0aGVcclxuICAgICAgICAgKiBwcm92aWRlZCBgZnJvbWAgYW5kIGB0b2Agc3R5bGVzIHdpbGwgYmUgYXBwbGllZCBhbG9uZ3NpZGUgdGhlIGdpdmVuIHRyYW5zaXRpb24uIElmIGEgSmF2YVNjcmlwdCBhbmltYXRpb24gaXNcclxuICAgICAgICAgKiBkZXRlY3RlZCB0aGVuIHRoZSBwcm92aWRlZCBzdHlsZXMgd2lsbCBiZSBnaXZlbiBpbiBhcyBmdW5jdGlvbiBwYXJhbXRlcnMuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBgYGBqc1xyXG4gICAgICAgICAqIG5nTW9kdWxlLmFuaW1hdGlvbignLm15LWlubGluZS1hbmltYXRpb24nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgKiAgIHJldHVybiB7XHJcbiAgICAgICAgICogICAgIGFuaW1hdGUgOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGZyb20sIHRvLCBkb25lKSB7XHJcbiAgICAgICAgICogICAgICAgLy9zdHlsZXNcclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqICAgfVxyXG4gICAgICAgICAqIH0pO1xyXG4gICAgICAgICAqIGBgYFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyB0aGUgYGFuaW1hdGVgIGFuaW1hdGlvbjpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XHJcbiAgICAgICAgICogfCAxLiBgJGFuaW1hdGUuYW5pbWF0ZSguLi4pYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAyLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgbmV4dCBkaWdlc3QgdG8gc3RhcnQgdGhlIGFuaW1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAzLiBgJGFuaW1hdGVgIHJ1bnMgdGhlIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGRldGVjdGVkIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA0LiB0aGUgYGNsYXNzTmFtZWAgY2xhc3MgdmFsdWUgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA1LiBgJGFuaW1hdGVgIHNjYW5zIHRoZSBlbGVtZW50IHN0eWxlcyB0byBnZXQgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbiBkdXJhdGlvbiBhbmQgZGVsYXkgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIGJsb2NrcyBhbGwgQ1NTIHRyYW5zaXRpb25zIG9uIHRoZSBlbGVtZW50IHRvIGVuc3VyZSB0aGUgYC5jbGFzc05hbWVgIGNsYXNzIHN0eWxpbmcgaXMgYXBwbGllZCByaWdodCBhd2F5fCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA3LiBgJGFuaW1hdGVgIGFwcGxpZXMgdGhlIHByb3ZpZGVkIGNvbGxlY3Rpb24gb2YgYGZyb21gIENTUyBzdHlsZXMgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA4LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA5LiBgJGFuaW1hdGVgIHJlbW92ZXMgdGhlIENTUyB0cmFuc2l0aW9uIGJsb2NrIHBsYWNlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWVcImAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAxMC4gdGhlIGBjbGFzc05hbWUtYWN0aXZlYCBjbGFzcyBpcyBhZGRlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWUgY2xhc3NOYW1lLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMS4gYCRhbmltYXRlYCBhcHBsaWVzIHRoZSBjb2xsZWN0aW9uIG9mIGB0b2AgQ1NTIHN0eWxlcyB0byB0aGUgZWxlbWVudCB3aGljaCBhcmUgdGhlbiBoYW5kbGVkIGJ5IHRoZSB0cmFuc2l0aW9uICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWUgY2xhc3NOYW1lLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMi4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAodmlhIGV2ZW50cyBhbmQgdGltZW91dCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBjbGFzc05hbWUgY2xhc3NOYW1lLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMy4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAxNC4gVGhlIHJldHVybmVkIHByb21pc2UgaXMgcmVzb2x2ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgZW50ZXIgYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGZyb20gYSBjb2xsZWN0aW9uIG9mIENTUyBzdHlsZXMgdGhhdCB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHN0YXJ0IG9mIHRoZSBhbmltYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gdG8gYSBjb2xsZWN0aW9uIG9mIENTUyBzdHlsZXMgdGhhdCB0aGUgZWxlbWVudCB3aWxsIGFuaW1hdGUgdG93YXJkc1xyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nPX0gY2xhc3NOYW1lIGFuIG9wdGlvbmFsIENTUyBjbGFzcyB0aGF0IHdpbGwgYmUgYWRkZWQgdG8gdGhlIGVsZW1lbnQgZm9yIHRoZSBkdXJhdGlvbiBvZiB0aGUgYW5pbWF0aW9uICh0aGUgZGVmYXVsdCBjbGFzcyBpcyBgbmctaW5saW5lLWFuaW1hdGVgKVxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIG9wdGlvbnMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXHJcbiAgICAgICAgKi9cclxuICAgICAgICBhbmltYXRlOiBmdW5jdGlvbihlbGVtZW50LCBmcm9tLCB0bywgY2xhc3NOYW1lLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUgfHwgJ25nLWlubGluZS1hbmltYXRlJztcclxuICAgICAgICAgIG9wdGlvbnMgPSBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpIHx8IHt9O1xyXG4gICAgICAgICAgb3B0aW9ucy5mcm9tID0gdG8gPyBmcm9tIDogbnVsbDtcclxuICAgICAgICAgIG9wdGlvbnMudG8gICA9IHRvID8gdG8gOiBmcm9tO1xyXG5cclxuICAgICAgICAgIHJldHVybiBydW5BbmltYXRpb25Qb3N0RGlnZXN0KGZ1bmN0aW9uKGRvbmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBlcmZvcm1BbmltYXRpb24oJ2FuaW1hdGUnLCBjbGFzc05hbWUsIHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KSwgbnVsbCwgbnVsbCwgbm9vcCwgb3B0aW9ucywgZG9uZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjZW50ZXJcclxuICAgICAgICAgKiBAa2luZCBmdW5jdGlvblxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogQXBwZW5kcyB0aGUgZWxlbWVudCB0byB0aGUgcGFyZW50RWxlbWVudCBlbGVtZW50IHRoYXQgcmVzaWRlcyBpbiB0aGUgZG9jdW1lbnQgYW5kIHRoZW4gcnVucyB0aGUgZW50ZXIgYW5pbWF0aW9uLiBPbmNlXHJcbiAgICAgICAgICogdGhlIGFuaW1hdGlvbiBpcyBzdGFydGVkLCB0aGUgZm9sbG93aW5nIENTUyBjbGFzc2VzIHdpbGwgYmUgcHJlc2VudCBvbiB0aGUgZWxlbWVudCBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBhbmltYXRpb246XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIGVudGVyIGFuaW1hdGlvbjpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcclxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5lbnRlciguLi4pYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAyLiBlbGVtZW50IGlzIGluc2VydGVkIGludG8gdGhlIGBwYXJlbnRFbGVtZW50YCBlbGVtZW50IG9yIGJlc2lkZSB0aGUgYGFmdGVyRWxlbWVudGAgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMy4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIG5leHQgZGlnZXN0IHRvIHN0YXJ0IHRoZSBhbmltYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDQuIGAkYW5pbWF0ZWAgcnVucyB0aGUgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgZGV0ZWN0ZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA1LiB0aGUgYC5uZy1lbnRlcmAgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiYCAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNi4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXJcImAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgYmxvY2tzIGFsbCBDU1MgdHJhbnNpdGlvbnMgb24gdGhlIGVsZW1lbnQgdG8gZW5zdXJlIHRoZSBgLm5nLWVudGVyYCBjbGFzcyBzdHlsaW5nIGlzIGFwcGxpZWQgcmlnaHQgYXdheSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyXCJgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA4LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlclwiYCAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgOS4gYCRhbmltYXRlYCByZW1vdmVzIHRoZSBDU1MgdHJhbnNpdGlvbiBibG9jayBwbGFjZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctZW50ZXJcImAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEwLiB0aGUgYC5uZy1lbnRlci1hY3RpdmVgIGNsYXNzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWVudGVyIG5nLWVudGVyLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMS4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAodmlhIGV2ZW50cyBhbmQgdGltZW91dCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1lbnRlciBuZy1lbnRlci1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgMTIuIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEzLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgZW50ZXIgYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBwYXJlbnRFbGVtZW50IHRoZSBwYXJlbnQgZWxlbWVudCBvZiB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBlbnRlciBhbmltYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGFmdGVyRWxlbWVudCB0aGUgc2libGluZyBlbGVtZW50ICh3aGljaCBpcyB0aGUgcHJldmlvdXMgZWxlbWVudCkgb2YgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgZW50ZXIgYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygb3B0aW9ucyB0aGF0IHdpbGwgYmUgcGlja2VkIHVwIGJ5IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb25cclxuICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcclxuICAgICAgICAqL1xyXG4gICAgICAgIGVudGVyOiBmdW5jdGlvbihlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBwYXJzZUFuaW1hdGVPcHRpb25zKG9wdGlvbnMpO1xyXG4gICAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KTtcclxuICAgICAgICAgIHBhcmVudEVsZW1lbnQgPSBwcmVwYXJlRWxlbWVudChwYXJlbnRFbGVtZW50KTtcclxuICAgICAgICAgIGFmdGVyRWxlbWVudCA9IHByZXBhcmVFbGVtZW50KGFmdGVyRWxlbWVudCk7XHJcblxyXG4gICAgICAgICAgY2xhc3NCYXNlZEFuaW1hdGlvbnNCbG9ja2VkKGVsZW1lbnQsIHRydWUpO1xyXG4gICAgICAgICAgJGRlbGVnYXRlLmVudGVyKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XHJcbiAgICAgICAgICByZXR1cm4gcnVuQW5pbWF0aW9uUG9zdERpZ2VzdChmdW5jdGlvbihkb25lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwZXJmb3JtQW5pbWF0aW9uKCdlbnRlcicsICduZy1lbnRlcicsIHN0cmlwQ29tbWVudHNGcm9tRWxlbWVudChlbGVtZW50KSwgcGFyZW50RWxlbWVudCwgYWZ0ZXJFbGVtZW50LCBub29wLCBvcHRpb25zLCBkb25lKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNsZWF2ZVxyXG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBSdW5zIHRoZSBsZWF2ZSBhbmltYXRpb24gb3BlcmF0aW9uIGFuZCwgdXBvbiBjb21wbGV0aW9uLCByZW1vdmVzIHRoZSBlbGVtZW50IGZyb20gdGhlIERPTS4gT25jZVxyXG4gICAgICAgICAqIHRoZSBhbmltYXRpb24gaXMgc3RhcnRlZCwgdGhlIGZvbGxvd2luZyBDU1MgY2xhc3NlcyB3aWxsIGJlIGFkZGVkIGZvciB0aGUgZHVyYXRpb24gb2YgdGhlIGFuaW1hdGlvbjpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgbGVhdmUgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxyXG4gICAgICAgICAqIHwgMS4gYCRhbmltYXRlLmxlYXZlKC4uLilgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDIuIGAkYW5pbWF0ZWAgcnVucyB0aGUgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgZGV0ZWN0ZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAzLiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgbmV4dCBkaWdlc3QgdG8gc3RhcnQgdGhlIGFuaW1hdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNC4gdGhlIGAubmctbGVhdmVgIGNsYXNzIGlzIGFkZGVkIHRvIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcImAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDUuIGAkYW5pbWF0ZWAgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlXCJgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA2LiBgJGFuaW1hdGVgIGJsb2NrcyBhbGwgQ1NTIHRyYW5zaXRpb25zIG9uIHRoZSBlbGVtZW50IHRvIGVuc3VyZSB0aGUgYC5uZy1sZWF2ZWAgY2xhc3Mgc3R5bGluZyBpcyBhcHBsaWVkIHJpZ2h0IGF3YXkgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZVwiYCAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNy4gYCRhbmltYXRlYCB3YWl0cyBmb3IgYSBzaW5nbGUgYW5pbWF0aW9uIGZyYW1lICh0aGlzIHBlcmZvcm1zIGEgcmVmbG93KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmVcImAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDguIGAkYW5pbWF0ZWAgcmVtb3ZlcyB0aGUgQ1NTIHRyYW5zaXRpb24gYmxvY2sgcGxhY2VkIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLWxlYXZlXCJgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA5LiB0aGUgYC5uZy1sZWF2ZS1hY3RpdmVgIGNsYXNzIGlzIGFkZGVkICh0aGlzIHRyaWdnZXJzIHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1sZWF2ZSBuZy1sZWF2ZS1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgMTAuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgKHZpYSBldmVudHMgYW5kIHRpbWVvdXQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbGVhdmUgbmctbGVhdmUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDExLiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAxMi4gVGhlIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET00gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAuLi4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEzLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IC4uLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtET01FbGVtZW50fSBlbGVtZW50IHRoZSBlbGVtZW50IHRoYXQgd2lsbCBiZSB0aGUgZm9jdXMgb2YgdGhlIGxlYXZlIGFuaW1hdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIHN0eWxlcyB0aGF0IHdpbGwgYmUgcGlja2VkIHVwIGJ5IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb25cclxuICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcclxuICAgICAgICAqL1xyXG4gICAgICAgIGxlYXZlOiBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gcGFyc2VBbmltYXRlT3B0aW9ucyhvcHRpb25zKTtcclxuICAgICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudCk7XHJcblxyXG4gICAgICAgICAgY2FuY2VsQ2hpbGRBbmltYXRpb25zKGVsZW1lbnQpO1xyXG4gICAgICAgICAgY2xhc3NCYXNlZEFuaW1hdGlvbnNCbG9ja2VkKGVsZW1lbnQsIHRydWUpO1xyXG4gICAgICAgICAgcmV0dXJuIHJ1bkFuaW1hdGlvblBvc3REaWdlc3QoZnVuY3Rpb24oZG9uZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGVyZm9ybUFuaW1hdGlvbignbGVhdmUnLCAnbmctbGVhdmUnLCBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCksIG51bGwsIG51bGwsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICRkZWxlZ2F0ZS5sZWF2ZShlbGVtZW50KTtcclxuICAgICAgICAgICAgfSwgb3B0aW9ucywgZG9uZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjbW92ZVxyXG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBGaXJlcyB0aGUgbW92ZSBET00gb3BlcmF0aW9uLiBKdXN0IGJlZm9yZSB0aGUgYW5pbWF0aW9uIHN0YXJ0cywgdGhlIGFuaW1hdGUgc2VydmljZSB3aWxsIGVpdGhlciBhcHBlbmQgaXQgaW50byB0aGUgcGFyZW50RWxlbWVudCBjb250YWluZXIgb3JcclxuICAgICAgICAgKiBhZGQgdGhlIGVsZW1lbnQgZGlyZWN0bHkgYWZ0ZXIgdGhlIGFmdGVyRWxlbWVudCBlbGVtZW50IGlmIHByZXNlbnQuIFRoZW4gdGhlIG1vdmUgYW5pbWF0aW9uIHdpbGwgYmUgcnVuLiBPbmNlXHJcbiAgICAgICAgICogdGhlIGFuaW1hdGlvbiBpcyBzdGFydGVkLCB0aGUgZm9sbG93aW5nIENTUyBjbGFzc2VzIHdpbGwgYmUgYWRkZWQgZm9yIHRoZSBkdXJhdGlvbiBvZiB0aGUgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQmVsb3cgaXMgYSBicmVha2Rvd24gb2YgZWFjaCBzdGVwIHRoYXQgb2NjdXJzIGR1cmluZyBtb3ZlIGFuaW1hdGlvbjpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcclxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5tb3ZlKC4uLilgIGlzIGNhbGxlZCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAyLiBlbGVtZW50IGlzIG1vdmVkIGludG8gdGhlIHBhcmVudEVsZW1lbnQgZWxlbWVudCBvciBiZXNpZGUgdGhlIGFmdGVyRWxlbWVudCBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMy4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIG5leHQgZGlnZXN0IHRvIHN0YXJ0IHRoZSBhbmltYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZVwiYCAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDQuIGAkYW5pbWF0ZWAgcnVucyB0aGUgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgZGV0ZWN0ZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGVcImAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA1LiB0aGUgYC5uZy1tb3ZlYCBjbGFzcyBpcyBhZGRlZCB0byB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmVcImAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNi4gYCRhbmltYXRlYCBzY2FucyB0aGUgZWxlbWVudCBzdHlsZXMgdG8gZ2V0IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb24gZHVyYXRpb24gYW5kIGRlbGF5ICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlXCJgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgYmxvY2tzIGFsbCBDU1MgdHJhbnNpdGlvbnMgb24gdGhlIGVsZW1lbnQgdG8gZW5zdXJlIHRoZSBgLm5nLW1vdmVgIGNsYXNzIHN0eWxpbmcgaXMgYXBwbGllZCByaWdodCBhd2F5IHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZVwiYCAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA4LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmVcImAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgOS4gYCRhbmltYXRlYCByZW1vdmVzIHRoZSBDU1MgdHJhbnNpdGlvbiBibG9jayBwbGFjZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBuZy1tb3ZlXCJgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEwLiB0aGUgYC5uZy1tb3ZlLWFjdGl2ZWAgY2xhc3MgaXMgYWRkZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgbmctbW92ZSBuZy1tb3ZlLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCAxMS4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAodmlhIGV2ZW50cyBhbmQgdGltZW91dCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG5nLW1vdmUgbmctbW92ZS1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgMTIuIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEzLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIHRoZSBmb2N1cyBvZiB0aGUgbW92ZSBhbmltYXRpb25cclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IHBhcmVudEVsZW1lbnQgdGhlIHBhcmVudEVsZW1lbnQgZWxlbWVudCBvZiB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBtb3ZlIGFuaW1hdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gYWZ0ZXJFbGVtZW50IHRoZSBzaWJsaW5nIGVsZW1lbnQgKHdoaWNoIGlzIHRoZSBwcmV2aW91cyBlbGVtZW50KSBvZiB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgdGhlIGZvY3VzIG9mIHRoZSBtb3ZlIGFuaW1hdGlvblxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBhbiBvcHRpb25hbCBjb2xsZWN0aW9uIG9mIHN0eWxlcyB0aGF0IHdpbGwgYmUgcGlja2VkIHVwIGJ5IHRoZSBDU1MgdHJhbnNpdGlvbi9hbmltYXRpb25cclxuICAgICAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSB0aGUgYW5pbWF0aW9uIGNhbGxiYWNrIHByb21pc2VcclxuICAgICAgICAqL1xyXG4gICAgICAgIG1vdmU6IGZ1bmN0aW9uKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQsIGFmdGVyRWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IHBhcnNlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XHJcbiAgICAgICAgICBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICAgICAgcGFyZW50RWxlbWVudCA9IHByZXBhcmVFbGVtZW50KHBhcmVudEVsZW1lbnQpO1xyXG4gICAgICAgICAgYWZ0ZXJFbGVtZW50ID0gcHJlcGFyZUVsZW1lbnQoYWZ0ZXJFbGVtZW50KTtcclxuXHJcbiAgICAgICAgICBjYW5jZWxDaGlsZEFuaW1hdGlvbnMoZWxlbWVudCk7XHJcbiAgICAgICAgICBjbGFzc0Jhc2VkQW5pbWF0aW9uc0Jsb2NrZWQoZWxlbWVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAkZGVsZWdhdGUubW92ZShlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQpO1xyXG4gICAgICAgICAgcmV0dXJuIHJ1bkFuaW1hdGlvblBvc3REaWdlc3QoZnVuY3Rpb24oZG9uZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGVyZm9ybUFuaW1hdGlvbignbW92ZScsICduZy1tb3ZlJywgc3RyaXBDb21tZW50c0Zyb21FbGVtZW50KGVsZW1lbnQpLCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIG5vb3AsIG9wdGlvbnMsIGRvbmUpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI2FkZENsYXNzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBUcmlnZ2VycyBhIGN1c3RvbSBhbmltYXRpb24gZXZlbnQgYmFzZWQgb2ZmIHRoZSBjbGFzc05hbWUgdmFyaWFibGUgYW5kIHRoZW4gYXR0YWNoZXMgdGhlIGNsYXNzTmFtZSB2YWx1ZSB0byB0aGUgZWxlbWVudCBhcyBhIENTUyBjbGFzcy5cclxuICAgICAgICAgKiBVbmxpa2UgdGhlIG90aGVyIGFuaW1hdGlvbiBtZXRob2RzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgc3VmZml4IHRoZSBjbGFzc05hbWUgdmFsdWUgd2l0aCB7QHR5cGUgLWFkZH0gaW4gb3JkZXIgdG8gcHJvdmlkZVxyXG4gICAgICAgICAqIHRoZSBhbmltYXRlIHNlcnZpY2UgdGhlIHNldHVwIGFuZCBhY3RpdmUgQ1NTIGNsYXNzZXMgaW4gb3JkZXIgdG8gdHJpZ2dlciB0aGUgYW5pbWF0aW9uICh0aGlzIHdpbGwgYmUgc2tpcHBlZCBpZiBubyBDU1MgdHJhbnNpdGlvbnNcclxuICAgICAgICAgKiBvciBrZXlmcmFtZXMgYXJlIGRlZmluZWQgb24gdGhlIC1hZGQtYWN0aXZlIG9yIGJhc2UgQ1NTIGNsYXNzKS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEJlbG93IGlzIGEgYnJlYWtkb3duIG9mIGVhY2ggc3RlcCB0aGF0IG9jY3VycyBkdXJpbmcgYWRkQ2xhc3MgYW5pbWF0aW9uOlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogfCBBbmltYXRpb24gU3RlcCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcclxuICAgICAgICAgKiB8IDEuIGAkYW5pbWF0ZS5hZGRDbGFzcyhlbGVtZW50LCAnc3VwZXInKWAgaXMgY2FsbGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDIuIGAkYW5pbWF0ZWAgcnVucyB0aGUgSmF2YVNjcmlwdC1kZWZpbmVkIGFuaW1hdGlvbnMgZGV0ZWN0ZWQgb24gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDMuIHRoZSBgLnN1cGVyLWFkZGAgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLWFkZFwiYCAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDQuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIGEgc2luZ2xlIGFuaW1hdGlvbiBmcmFtZSAodGhpcyBwZXJmb3JtcyBhIHJlZmxvdykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLWFkZFwiYCAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDUuIHRoZSBgLnN1cGVyYCBhbmQgYC5zdXBlci1hZGQtYWN0aXZlYCBjbGFzc2VzIGFyZSBhZGRlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyIHN1cGVyLWFkZCBzdXBlci1hZGQtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDYuIGAkYW5pbWF0ZWAgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyIHN1cGVyLWFkZCBzdXBlci1hZGQtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDcuIGAkYW5pbWF0ZWAgd2FpdHMgZm9yIHRoZSBhbmltYXRpb24gdG8gY29tcGxldGUgKHZpYSBldmVudHMgYW5kIHRpbWVvdXQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyIHN1cGVyLWFkZCBzdXBlci1hZGQtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDguIFRoZSBhbmltYXRpb24gZW5kcyBhbmQgYWxsIGdlbmVyYXRlZCBDU1MgY2xhc3NlcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlclwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDkuIFRoZSBzdXBlciBjbGFzcyBpcyBrZXB0IG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlclwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDEwLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSBpcyByZXNvbHZlZC4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlclwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RE9NRWxlbWVudH0gZWxlbWVudCB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgYW5pbWF0ZWRcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NOYW1lIHRoZSBDU1MgY2xhc3MgdGhhdCB3aWxsIGJlIGFkZGVkIHRvIHRoZSBlbGVtZW50IGFuZCB0aGVuIGFuaW1hdGVkXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygc3R5bGVzIHRoYXQgd2lsbCBiZSBwaWNrZWQgdXAgYnkgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvblxyXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxyXG4gICAgICAgICovXHJcbiAgICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgb3B0aW9ucykge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lLCBbXSwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAqIEBuYW1lICRhbmltYXRlI3JlbW92ZUNsYXNzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBUcmlnZ2VycyBhIGN1c3RvbSBhbmltYXRpb24gZXZlbnQgYmFzZWQgb2ZmIHRoZSBjbGFzc05hbWUgdmFyaWFibGUgYW5kIHRoZW4gcmVtb3ZlcyB0aGUgQ1NTIGNsYXNzIHByb3ZpZGVkIGJ5IHRoZSBjbGFzc05hbWUgdmFsdWVcclxuICAgICAgICAgKiBmcm9tIHRoZSBlbGVtZW50LiBVbmxpa2UgdGhlIG90aGVyIGFuaW1hdGlvbiBtZXRob2RzLCB0aGUgYW5pbWF0ZSBzZXJ2aWNlIHdpbGwgc3VmZml4IHRoZSBjbGFzc05hbWUgdmFsdWUgd2l0aCB7QHR5cGUgLXJlbW92ZX0gaW5cclxuICAgICAgICAgKiBvcmRlciB0byBwcm92aWRlIHRoZSBhbmltYXRlIHNlcnZpY2UgdGhlIHNldHVwIGFuZCBhY3RpdmUgQ1NTIGNsYXNzZXMgaW4gb3JkZXIgdG8gdHJpZ2dlciB0aGUgYW5pbWF0aW9uICh0aGlzIHdpbGwgYmUgc2tpcHBlZCBpZlxyXG4gICAgICAgICAqIG5vIENTUyB0cmFuc2l0aW9ucyBvciBrZXlmcmFtZXMgYXJlIGRlZmluZWQgb24gdGhlIC1yZW1vdmUgb3IgYmFzZSBDU1MgY2xhc3NlcykuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBCZWxvdyBpcyBhIGJyZWFrZG93biBvZiBlYWNoIHN0ZXAgdGhhdCBvY2N1cnMgZHVyaW5nIHJlbW92ZUNsYXNzIGFuaW1hdGlvbjpcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIHwgQW5pbWF0aW9uIFN0ZXAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBXaGF0IHRoZSBlbGVtZW50IGNsYXNzIGF0dHJpYnV0ZSBsb29rcyBsaWtlICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxyXG4gICAgICAgICAqIHwgMS4gYCRhbmltYXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsICdzdXBlcicpYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXJcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCAyLiBgJGFuaW1hdGVgIHJ1bnMgdGhlIEphdmFTY3JpcHQtZGVmaW5lZCBhbmltYXRpb25zIGRldGVjdGVkIG9uIHRoZSBlbGVtZW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBzdXBlciBuZy1hbmltYXRlXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDMuIHRoZSBgLnN1cGVyLXJlbW92ZWAgY2xhc3MgaXMgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIHN1cGVyIG5nLWFuaW1hdGUgc3VwZXItcmVtb3ZlXCJgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNC4gYCRhbmltYXRlYCB3YWl0cyBmb3IgYSBzaW5nbGUgYW5pbWF0aW9uIGZyYW1lICh0aGlzIHBlcmZvcm1zIGEgcmVmbG93KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gc3VwZXIgbmctYW5pbWF0ZSBzdXBlci1yZW1vdmVcImAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA1LiB0aGUgYC5zdXBlci1yZW1vdmUtYWN0aXZlYCBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgYC5zdXBlcmAgaXMgcmVtb3ZlZCAodGhpcyB0cmlnZ2VycyB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uKSB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIHN1cGVyLXJlbW92ZSBzdXBlci1yZW1vdmUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDYuIGAkYW5pbWF0ZWAgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgc3VwZXItcmVtb3ZlIHN1cGVyLXJlbW92ZS1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgNy4gYCRhbmltYXRlYCB3YWl0cyBmb3IgdGhlIGFuaW1hdGlvbiB0byBjb21wbGV0ZSAodmlhIGV2ZW50cyBhbmQgdGltZW91dCkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBzdXBlci1yZW1vdmUgc3VwZXItcmVtb3ZlLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCA4LiBUaGUgYW5pbWF0aW9uIGVuZHMgYW5kIGFsbCBnZW5lcmF0ZWQgQ1NTIGNsYXNzZXMgYXJlIHJlbW92ZWQgZnJvbSB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvblwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDkuIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHJlc29sdmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlIGFuaW1hdGVkXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzTmFtZSB0aGUgQ1NTIGNsYXNzIHRoYXQgd2lsbCBiZSBhbmltYXRlZCBhbmQgdGhlbiByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnRcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgYW4gb3B0aW9uYWwgY29sbGVjdGlvbiBvZiBzdHlsZXMgdGhhdCB3aWxsIGJlIHBpY2tlZCB1cCBieSB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uXHJcbiAgICAgICAgICogQHJldHVybiB7UHJvbWlzZX0gdGhlIGFuaW1hdGlvbiBjYWxsYmFjayBwcm9taXNlXHJcbiAgICAgICAgKi9cclxuICAgICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZXRDbGFzcyhlbGVtZW50LCBbXSwgY2xhc3NOYW1lLCBvcHRpb25zKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSAkYW5pbWF0ZSNzZXRDbGFzc1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uIEFkZHMgYW5kL29yIHJlbW92ZXMgdGhlIGdpdmVuIENTUyBjbGFzc2VzIHRvIGFuZCBmcm9tIHRoZSBlbGVtZW50LlxyXG4gICAgICAgICAqIE9uY2UgY29tcGxldGUsIHRoZSBgZG9uZSgpYCBjYWxsYmFjayB3aWxsIGJlIGZpcmVkIChpZiBwcm92aWRlZCkuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiB8IEFuaW1hdGlvbiBTdGVwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgV2hhdCB0aGUgZWxlbWVudCBjbGFzcyBhdHRyaWJ1dGUgbG9va3MgbGlrZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XHJcbiAgICAgICAgICogfCAxLiBgJGFuaW1hdGUuc2V0Q2xhc3MoZWxlbWVudCwgJ29uJywgJ29mZicpYCBpcyBjYWxsZWQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBvZmZcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgMi4gYCRhbmltYXRlYCBydW5zIHRoZSBKYXZhU2NyaXB0LWRlZmluZWQgYW5pbWF0aW9ucyBkZXRlY3RlZCBvbiB0aGUgZWxlbWVudCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBvZmZcImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDMuIHRoZSBgLm9uLWFkZGAgYW5kIGAub2ZmLXJlbW92ZWAgY2xhc3NlcyBhcmUgYWRkZWQgdG8gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgb24tYWRkIG9mZi1yZW1vdmUgb2ZmXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICogfCA0LiBgJGFuaW1hdGVgIHdhaXRzIGZvciBhIHNpbmdsZSBhbmltYXRpb24gZnJhbWUgKHRoaXMgcGVyZm9ybXMgYSByZWZsb3cpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG9uLWFkZCBvZmYtcmVtb3ZlIG9mZlwiYCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gICAgICAgICAqIHwgNS4gdGhlIGAub25gLCBgLm9uLWFkZC1hY3RpdmVgIGFuZCBgLm9mZi1yZW1vdmUtYWN0aXZlYCBjbGFzc2VzIGFyZSBhZGRlZCBhbmQgYC5vZmZgIGlzIHJlbW92ZWQgKHRoaXMgdHJpZ2dlcnMgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvbikgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gbmctYW5pbWF0ZSBvbiBvbi1hZGQgb24tYWRkLWFjdGl2ZSBvZmYtcmVtb3ZlIG9mZi1yZW1vdmUtYWN0aXZlXCJgIHxcclxuICAgICAgICAgKiB8IDYuIGAkYW5pbWF0ZWAgc2NhbnMgdGhlIGVsZW1lbnQgc3R5bGVzIHRvIGdldCB0aGUgQ1NTIHRyYW5zaXRpb24vYW5pbWF0aW9uIGR1cmF0aW9uIGFuZCBkZWxheSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG5nLWFuaW1hdGUgb24gb24tYWRkIG9uLWFkZC1hY3RpdmUgb2ZmLXJlbW92ZSBvZmYtcmVtb3ZlLWFjdGl2ZVwiYCB8XHJcbiAgICAgICAgICogfCA3LiBgJGFuaW1hdGVgIHdhaXRzIGZvciB0aGUgYW5pbWF0aW9uIHRvIGNvbXBsZXRlICh2aWEgZXZlbnRzIGFuZCB0aW1lb3V0KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8IGBjbGFzcz1cIm15LWFuaW1hdGlvbiBuZy1hbmltYXRlIG9uIG9uLWFkZCBvbi1hZGQtYWN0aXZlIG9mZi1yZW1vdmUgb2ZmLXJlbW92ZS1hY3RpdmVcImAgfFxyXG4gICAgICAgICAqIHwgOC4gVGhlIGFuaW1hdGlvbiBlbmRzIGFuZCBhbGwgZ2VuZXJhdGVkIENTUyBjbGFzc2VzIGFyZSByZW1vdmVkIGZyb20gdGhlIGVsZW1lbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBgY2xhc3M9XCJteS1hbmltYXRpb24gb25cImAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICAgICAgICAgKiB8IDkuIFRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHJlc29sdmVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgYGNsYXNzPVwibXktYW5pbWF0aW9uIG9uXCJgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnR9IGVsZW1lbnQgdGhlIGVsZW1lbnQgd2hpY2ggd2lsbCBoYXZlIGl0cyBDU1MgY2xhc3NlcyBjaGFuZ2VkXHJcbiAgICAgICAgICogICByZW1vdmVkIGZyb20gaXRcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gYWRkIHRoZSBDU1MgY2xhc3NlcyB3aGljaCB3aWxsIGJlIGFkZGVkIHRvIHRoZSBlbGVtZW50XHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHJlbW92ZSB0aGUgQ1NTIGNsYXNzIHdoaWNoIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBlbGVtZW50XHJcbiAgICAgICAgICogICBDU1MgY2xhc3NlcyBoYXZlIGJlZW4gc2V0IG9uIHRoZSBlbGVtZW50XHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIGFuIG9wdGlvbmFsIGNvbGxlY3Rpb24gb2Ygc3R5bGVzIHRoYXQgd2lsbCBiZSBwaWNrZWQgdXAgYnkgdGhlIENTUyB0cmFuc2l0aW9uL2FuaW1hdGlvblxyXG4gICAgICAgICAqIEByZXR1cm4ge1Byb21pc2V9IHRoZSBhbmltYXRpb24gY2FsbGJhY2sgcHJvbWlzZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IHBhcnNlQW5pbWF0ZU9wdGlvbnMob3B0aW9ucyk7XHJcblxyXG4gICAgICAgICAgdmFyIFNUT1JBR0VfS0VZID0gJyQkYW5pbWF0ZUNsYXNzZXMnO1xyXG4gICAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KTtcclxuICAgICAgICAgIGVsZW1lbnQgPSBzdHJpcENvbW1lbnRzRnJvbUVsZW1lbnQoZWxlbWVudCk7XHJcblxyXG4gICAgICAgICAgaWYgKGNsYXNzQmFzZWRBbmltYXRpb25zQmxvY2tlZChlbGVtZW50KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGRlbGVnYXRlLiQkc2V0Q2xhc3NJbW1lZGlhdGVseShlbGVtZW50LCBhZGQsIHJlbW92ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gd2UncmUgdXNpbmcgYSBjb21iaW5lZCBhcnJheSBmb3IgYm90aCB0aGUgYWRkIGFuZCByZW1vdmVcclxuICAgICAgICAgIC8vIG9wZXJhdGlvbnMgc2luY2UgdGhlIE9SREVSIE9GIGFkZENsYXNzIGFuZCByZW1vdmVDbGFzcyBtYXR0ZXJzXHJcbiAgICAgICAgICB2YXIgY2xhc3NlcywgY2FjaGUgPSBlbGVtZW50LmRhdGEoU1RPUkFHRV9LRVkpO1xyXG4gICAgICAgICAgdmFyIGhhc0NhY2hlID0gISFjYWNoZTtcclxuICAgICAgICAgIGlmICghY2FjaGUpIHtcclxuICAgICAgICAgICAgY2FjaGUgPSB7fTtcclxuICAgICAgICAgICAgY2FjaGUuY2xhc3NlcyA9IHt9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY2xhc3NlcyA9IGNhY2hlLmNsYXNzZXM7XHJcblxyXG4gICAgICAgICAgYWRkID0gaXNBcnJheShhZGQpID8gYWRkIDogYWRkLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICBmb3JFYWNoKGFkZCwgZnVuY3Rpb24oYykge1xyXG4gICAgICAgICAgICBpZiAoYyAmJiBjLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgIGNsYXNzZXNbY10gPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICByZW1vdmUgPSBpc0FycmF5KHJlbW92ZSkgPyByZW1vdmUgOiByZW1vdmUuc3BsaXQoJyAnKTtcclxuICAgICAgICAgIGZvckVhY2gocmVtb3ZlLCBmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgIGlmIChjICYmIGMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgY2xhc3Nlc1tjXSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBpZiAoaGFzQ2FjaGUpIHtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgY2FjaGUub3B0aW9ucykge1xyXG4gICAgICAgICAgICAgIGNhY2hlLm9wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZChjYWNoZS5vcHRpb25zIHx8IHt9LCBvcHRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy90aGUgZGlnZXN0IGN5Y2xlIHdpbGwgY29tYmluZSBhbGwgdGhlIGFuaW1hdGlvbnMgaW50byBvbmUgZnVuY3Rpb25cclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlLnByb21pc2U7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBlbGVtZW50LmRhdGEoU1RPUkFHRV9LRVksIGNhY2hlID0ge1xyXG4gICAgICAgICAgICAgIGNsYXNzZXM6IGNsYXNzZXMsXHJcbiAgICAgICAgICAgICAgb3B0aW9uczogb3B0aW9uc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICByZXR1cm4gY2FjaGUucHJvbWlzZSA9IHJ1bkFuaW1hdGlvblBvc3REaWdlc3QoZnVuY3Rpb24oZG9uZSkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50RWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50Tm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcclxuICAgICAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBlbGVtZW50Tm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAvLyBUT0RPKG1hdHNrbyk6IG1vdmUgdGhpcyBjb2RlIGludG8gdGhlIGFuaW1hdGlvbnNEaXNhYmxlZCgpIGZ1bmN0aW9uIG9uY2UgIzgwOTIgaXMgZml4ZWRcclxuICAgICAgICAgICAgaWYgKCFwYXJlbnROb2RlIHx8IHBhcmVudE5vZGVbJyQkTkdfUkVNT1ZFRCddIHx8IGVsZW1lbnROb2RlWyckJE5HX1JFTU9WRUQnXSkge1xyXG4gICAgICAgICAgICAgIGRvbmUoKTtcclxuICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBjYWNoZSA9IGVsZW1lbnQuZGF0YShTVE9SQUdFX0tFWSk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRGF0YShTVE9SQUdFX0tFWSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgc3RhdGUgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XHJcbiAgICAgICAgICAgIHZhciBjbGFzc2VzID0gcmVzb2x2ZUVsZW1lbnRDbGFzc2VzKGVsZW1lbnQsIGNhY2hlLCBzdGF0ZS5hY3RpdmUpO1xyXG4gICAgICAgICAgICByZXR1cm4gIWNsYXNzZXNcclxuICAgICAgICAgICAgICA/IGRvbmUoKVxyXG4gICAgICAgICAgICAgIDogcGVyZm9ybUFuaW1hdGlvbignc2V0Q2xhc3MnLCBjbGFzc2VzLCBlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBudWxsLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzZXNbMF0pICRkZWxlZ2F0ZS4kJGFkZENsYXNzSW1tZWRpYXRlbHkoZWxlbWVudCwgY2xhc3Nlc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChjbGFzc2VzWzFdKSAkZGVsZWdhdGUuJCRyZW1vdmVDbGFzc0ltbWVkaWF0ZWx5KGVsZW1lbnQsIGNsYXNzZXNbMV0pO1xyXG4gICAgICAgICAgICAgICAgfSwgY2FjaGUub3B0aW9ucywgZG9uZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjY2FuY2VsXHJcbiAgICAgICAgICogQGtpbmQgZnVuY3Rpb25cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7UHJvbWlzZX0gYW5pbWF0aW9uUHJvbWlzZSBUaGUgYW5pbWF0aW9uIHByb21pc2UgdGhhdCBpcyByZXR1cm5lZCB3aGVuIGFuIGFuaW1hdGlvbiBpcyBzdGFydGVkLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogQ2FuY2VscyB0aGUgcHJvdmlkZWQgYW5pbWF0aW9uLlxyXG4gICAgICAgICovXHJcbiAgICAgICAgY2FuY2VsOiBmdW5jdGlvbihwcm9taXNlKSB7XHJcbiAgICAgICAgICBwcm9taXNlLiQkY2FuY2VsRm4oKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgJGFuaW1hdGUjZW5hYmxlZFxyXG4gICAgICAgICAqIEBraW5kIGZ1bmN0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSB2YWx1ZSBJZiBwcm92aWRlZCB0aGVuIHNldCB0aGUgYW5pbWF0aW9uIG9uIG9yIG9mZi5cclxuICAgICAgICAgKiBAcGFyYW0ge0RPTUVsZW1lbnQ9fSBlbGVtZW50IElmIHByb3ZpZGVkIHRoZW4gdGhlIGVsZW1lbnQgd2lsbCBiZSB1c2VkIHRvIHJlcHJlc2VudCB0aGUgZW5hYmxlL2Rpc2FibGUgb3BlcmF0aW9uXHJcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0gQ3VycmVudCBhbmltYXRpb24gc3RhdGUuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBHbG9iYWxseSBlbmFibGVzL2Rpc2FibGVzIGFuaW1hdGlvbnMuXHJcbiAgICAgICAgICpcclxuICAgICAgICAqL1xyXG4gICAgICAgIGVuYWJsZWQ6IGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XHJcbiAgICAgICAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50KTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSkgfHwge307XHJcbiAgICAgICAgICAgICAgICBkYXRhLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCBkYXRhKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgIHJvb3RBbmltYXRlU3RhdGUuZGlzYWJsZWQgPSAhdmFsdWU7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICB2YWx1ZSA9ICFyb290QW5pbWF0ZVN0YXRlLmRpc2FibGVkO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiAhIXZhbHVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgIGFsbCBhbmltYXRpb25zIGNhbGwgdGhpcyBzaGFyZWQgYW5pbWF0aW9uIHRyaWdnZXJpbmcgZnVuY3Rpb24gaW50ZXJuYWxseS5cclxuICAgICAgICBUaGUgYW5pbWF0aW9uRXZlbnQgdmFyaWFibGUgcmVmZXJzIHRvIHRoZSBKYXZhU2NyaXB0IGFuaW1hdGlvbiBldmVudCB0aGF0IHdpbGwgYmUgdHJpZ2dlcmVkXHJcbiAgICAgICAgYW5kIHRoZSBjbGFzc05hbWUgdmFsdWUgaXMgdGhlIG5hbWUgb2YgdGhlIGFuaW1hdGlvbiB0aGF0IHdpbGwgYmUgYXBwbGllZCB3aXRoaW4gdGhlXHJcbiAgICAgICAgQ1NTIGNvZGUuIEVsZW1lbnQsIGBwYXJlbnRFbGVtZW50YCBhbmQgYGFmdGVyRWxlbWVudGAgYXJlIHByb3ZpZGVkIERPTSBlbGVtZW50cyBmb3IgdGhlIGFuaW1hdGlvblxyXG4gICAgICAgIGFuZCB0aGUgb25Db21wbGV0ZSBjYWxsYmFjayB3aWxsIGJlIGZpcmVkIG9uY2UgdGhlIGFuaW1hdGlvbiBpcyBmdWxseSBjb21wbGV0ZS5cclxuICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gcGVyZm9ybUFuaW1hdGlvbihhbmltYXRpb25FdmVudCwgY2xhc3NOYW1lLCBlbGVtZW50LCBwYXJlbnRFbGVtZW50LCBhZnRlckVsZW1lbnQsIGRvbU9wZXJhdGlvbiwgb3B0aW9ucywgZG9uZUNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIG5vb3BDYW5jZWwgPSBub29wO1xyXG4gICAgICAgIHZhciBydW5uZXIgPSBhbmltYXRpb25SdW5uZXIoZWxlbWVudCwgYW5pbWF0aW9uRXZlbnQsIGNsYXNzTmFtZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKCFydW5uZXIpIHtcclxuICAgICAgICAgIGZpcmVET01PcGVyYXRpb24oKTtcclxuICAgICAgICAgIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICBmaXJlQWZ0ZXJDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICBjbG9zZUFuaW1hdGlvbigpO1xyXG4gICAgICAgICAgcmV0dXJuIG5vb3BDYW5jZWw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhbmltYXRpb25FdmVudCA9IHJ1bm5lci5ldmVudDtcclxuICAgICAgICBjbGFzc05hbWUgPSBydW5uZXIuY2xhc3NOYW1lO1xyXG4gICAgICAgIHZhciBlbGVtZW50RXZlbnRzID0gYW5ndWxhci5lbGVtZW50Ll9kYXRhKHJ1bm5lci5ub2RlKTtcclxuICAgICAgICBlbGVtZW50RXZlbnRzID0gZWxlbWVudEV2ZW50cyAmJiBlbGVtZW50RXZlbnRzLmV2ZW50cztcclxuXHJcbiAgICAgICAgaWYgKCFwYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICBwYXJlbnRFbGVtZW50ID0gYWZ0ZXJFbGVtZW50ID8gYWZ0ZXJFbGVtZW50LnBhcmVudCgpIDogZWxlbWVudC5wYXJlbnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vc2tpcCB0aGUgYW5pbWF0aW9uIGlmIGFuaW1hdGlvbnMgYXJlIGRpc2FibGVkLCBhIHBhcmVudCBpcyBhbHJlYWR5IGJlaW5nIGFuaW1hdGVkLFxyXG4gICAgICAgIC8vdGhlIGVsZW1lbnQgaXMgbm90IGN1cnJlbnRseSBhdHRhY2hlZCB0byB0aGUgZG9jdW1lbnQgYm9keSBvciB0aGVuIGNvbXBsZXRlbHkgY2xvc2VcclxuICAgICAgICAvL3RoZSBhbmltYXRpb24gaWYgYW55IG1hdGNoaW5nIGFuaW1hdGlvbnMgYXJlIG5vdCBmb3VuZCBhdCBhbGwuXHJcbiAgICAgICAgLy9OT1RFOiBJRTggKyBJRTkgc2hvdWxkIGNsb3NlIHByb3Blcmx5IChydW4gY2xvc2VBbmltYXRpb24oKSkgaW4gY2FzZSBhbiBhbmltYXRpb24gd2FzIGZvdW5kLlxyXG4gICAgICAgIGlmIChhbmltYXRpb25zRGlzYWJsZWQoZWxlbWVudCwgcGFyZW50RWxlbWVudCkpIHtcclxuICAgICAgICAgIGZpcmVET01PcGVyYXRpb24oKTtcclxuICAgICAgICAgIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICBmaXJlQWZ0ZXJDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICBjbG9zZUFuaW1hdGlvbigpO1xyXG4gICAgICAgICAgcmV0dXJuIG5vb3BDYW5jZWw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbmdBbmltYXRlU3RhdGUgID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xyXG4gICAgICAgIHZhciBydW5uaW5nQW5pbWF0aW9ucyAgICAgPSBuZ0FuaW1hdGVTdGF0ZS5hY3RpdmUgfHwge307XHJcbiAgICAgICAgdmFyIHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA9IG5nQW5pbWF0ZVN0YXRlLnRvdGFsQWN0aXZlIHx8IDA7XHJcbiAgICAgICAgdmFyIGxhc3RBbmltYXRpb24gICAgICAgICA9IG5nQW5pbWF0ZVN0YXRlLmxhc3Q7XHJcbiAgICAgICAgdmFyIHNraXBBbmltYXRpb24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKHRvdGFsQWN0aXZlQW5pbWF0aW9ucyA+IDApIHtcclxuICAgICAgICAgIHZhciBhbmltYXRpb25zVG9DYW5jZWwgPSBbXTtcclxuICAgICAgICAgIGlmICghcnVubmVyLmlzQ2xhc3NCYXNlZCkge1xyXG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRXZlbnQgPT0gJ2xlYXZlJyAmJiBydW5uaW5nQW5pbWF0aW9uc1snbmctbGVhdmUnXSkge1xyXG4gICAgICAgICAgICAgIHNraXBBbmltYXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIC8vY2FuY2VsIGFsbCBhbmltYXRpb25zIHdoZW4gYSBzdHJ1Y3R1cmFsIGFuaW1hdGlvbiB0YWtlcyBwbGFjZVxyXG4gICAgICAgICAgICAgIGZvciAodmFyIGtsYXNzIGluIHJ1bm5pbmdBbmltYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBhbmltYXRpb25zVG9DYW5jZWwucHVzaChydW5uaW5nQW5pbWF0aW9uc1trbGFzc10pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBuZ0FuaW1hdGVTdGF0ZSA9IHt9O1xyXG4gICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAobGFzdEFuaW1hdGlvbi5ldmVudCA9PSAnc2V0Q2xhc3MnKSB7XHJcbiAgICAgICAgICAgIGFuaW1hdGlvbnNUb0NhbmNlbC5wdXNoKGxhc3RBbmltYXRpb24pO1xyXG4gICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIGlmIChydW5uaW5nQW5pbWF0aW9uc1tjbGFzc05hbWVdKSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50ID0gcnVubmluZ0FuaW1hdGlvbnNbY2xhc3NOYW1lXTtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQuZXZlbnQgPT0gYW5pbWF0aW9uRXZlbnQpIHtcclxuICAgICAgICAgICAgICBza2lwQW5pbWF0aW9uID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBhbmltYXRpb25zVG9DYW5jZWwucHVzaChjdXJyZW50KTtcclxuICAgICAgICAgICAgICBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoYW5pbWF0aW9uc1RvQ2FuY2VsLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yRWFjaChhbmltYXRpb25zVG9DYW5jZWwsIGZ1bmN0aW9uKG9wZXJhdGlvbikge1xyXG4gICAgICAgICAgICAgIG9wZXJhdGlvbi5jYW5jZWwoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocnVubmVyLmlzQ2xhc3NCYXNlZFxyXG4gICAgICAgICAgICAmJiAhcnVubmVyLmlzU2V0Q2xhc3NPcGVyYXRpb25cclxuICAgICAgICAgICAgJiYgYW5pbWF0aW9uRXZlbnQgIT0gJ2FuaW1hdGUnXHJcbiAgICAgICAgICAgICYmICFza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgICBza2lwQW5pbWF0aW9uID0gKGFuaW1hdGlvbkV2ZW50ID09ICdhZGRDbGFzcycpID09IGVsZW1lbnQuaGFzQ2xhc3MoY2xhc3NOYW1lKTsgLy9vcHBvc2l0ZSBvZiBYT1JcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgICBmaXJlRE9NT3BlcmF0aW9uKCk7XHJcbiAgICAgICAgICBmaXJlQmVmb3JlQ2FsbGJhY2tBc3luYygpO1xyXG4gICAgICAgICAgZmlyZUFmdGVyQ2FsbGJhY2tBc3luYygpO1xyXG4gICAgICAgICAgZmlyZURvbmVDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgICByZXR1cm4gbm9vcENhbmNlbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJ1bm5pbmdBbmltYXRpb25zICAgICA9IG5nQW5pbWF0ZVN0YXRlLmFjdGl2ZSB8fCB7fTtcclxuICAgICAgICB0b3RhbEFjdGl2ZUFuaW1hdGlvbnMgPSBuZ0FuaW1hdGVTdGF0ZS50b3RhbEFjdGl2ZSB8fCAwO1xyXG5cclxuICAgICAgICBpZiAoYW5pbWF0aW9uRXZlbnQgPT0gJ2xlYXZlJykge1xyXG4gICAgICAgICAgLy90aGVyZSdzIG5vIG5lZWQgdG8gZXZlciByZW1vdmUgdGhlIGxpc3RlbmVyIHNpbmNlIHRoZSBlbGVtZW50XHJcbiAgICAgICAgICAvL3dpbGwgYmUgcmVtb3ZlZCAoZGVzdHJveWVkKSBhZnRlciB0aGUgbGVhdmUgYW5pbWF0aW9uIGVuZHMgb3JcclxuICAgICAgICAgIC8vaXMgY2FuY2VsbGVkIG1pZHdheVxyXG4gICAgICAgICAgZWxlbWVudC5vbmUoJyRkZXN0cm95JywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudCh0aGlzKTtcclxuICAgICAgICAgICAgdmFyIHN0YXRlID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xyXG4gICAgICAgICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICAgICAgICB2YXIgYWN0aXZlTGVhdmVBbmltYXRpb24gPSBzdGF0ZS5hY3RpdmVbJ25nLWxlYXZlJ107XHJcbiAgICAgICAgICAgICAgaWYgKGFjdGl2ZUxlYXZlQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVMZWF2ZUFuaW1hdGlvbi5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIGNsZWFudXAoZWxlbWVudCwgJ25nLWxlYXZlJyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vdGhlIG5nLWFuaW1hdGUgY2xhc3MgZG9lcyBub3RoaW5nLCBidXQgaXQncyBoZXJlIHRvIGFsbG93IGZvclxyXG4gICAgICAgIC8vcGFyZW50IGFuaW1hdGlvbnMgdG8gZmluZCBhbmQgY2FuY2VsIGNoaWxkIGFuaW1hdGlvbnMgd2hlbiBuZWVkZWRcclxuICAgICAgICAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBOR19BTklNQVRFX0NMQVNTX05BTUUpO1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMudGVtcENsYXNzZXMpIHtcclxuICAgICAgICAgIGZvckVhY2gob3B0aW9ucy50ZW1wQ2xhc3NlcywgZnVuY3Rpb24oY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgICQkanFMaXRlLmFkZENsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBsb2NhbEFuaW1hdGlvbkNvdW50ID0gZ2xvYmFsQW5pbWF0aW9uQ291bnRlcisrO1xyXG4gICAgICAgIHRvdGFsQWN0aXZlQW5pbWF0aW9ucysrO1xyXG4gICAgICAgIHJ1bm5pbmdBbmltYXRpb25zW2NsYXNzTmFtZV0gPSBydW5uZXI7XHJcblxyXG4gICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFLCB7XHJcbiAgICAgICAgICBsYXN0OiBydW5uZXIsXHJcbiAgICAgICAgICBhY3RpdmU6IHJ1bm5pbmdBbmltYXRpb25zLFxyXG4gICAgICAgICAgaW5kZXg6IGxvY2FsQW5pbWF0aW9uQ291bnQsXHJcbiAgICAgICAgICB0b3RhbEFjdGl2ZTogdG90YWxBY3RpdmVBbmltYXRpb25zXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vZmlyc3Qgd2UgcnVuIHRoZSBiZWZvcmUgYW5pbWF0aW9ucyBhbmQgd2hlbiBhbGwgb2YgdGhvc2UgYXJlIGNvbXBsZXRlXHJcbiAgICAgICAgLy90aGVuIHdlIHBlcmZvcm0gdGhlIERPTSBvcGVyYXRpb24gYW5kIHJ1biB0aGUgbmV4dCBzZXQgb2YgYW5pbWF0aW9uc1xyXG4gICAgICAgIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCk7XHJcbiAgICAgICAgcnVubmVyLmJlZm9yZShmdW5jdGlvbihjYW5jZWxsZWQpIHtcclxuICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xyXG4gICAgICAgICAgY2FuY2VsbGVkID0gY2FuY2VsbGVkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICFkYXRhIHx8ICFkYXRhLmFjdGl2ZVtjbGFzc05hbWVdIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChydW5uZXIuaXNDbGFzc0Jhc2VkICYmIGRhdGEuYWN0aXZlW2NsYXNzTmFtZV0uZXZlbnQgIT0gYW5pbWF0aW9uRXZlbnQpO1xyXG5cclxuICAgICAgICAgIGZpcmVET01PcGVyYXRpb24oKTtcclxuICAgICAgICAgIGlmIChjYW5jZWxsZWQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgY2xvc2VBbmltYXRpb24oKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKTtcclxuICAgICAgICAgICAgcnVubmVyLmFmdGVyKGNsb3NlQW5pbWF0aW9uKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJ1bm5lci5jYW5jZWw7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVET01DYWxsYmFjayhhbmltYXRpb25QaGFzZSkge1xyXG4gICAgICAgICAgdmFyIGV2ZW50TmFtZSA9ICckYW5pbWF0ZTonICsgYW5pbWF0aW9uUGhhc2U7XHJcbiAgICAgICAgICBpZiAoZWxlbWVudEV2ZW50cyAmJiBlbGVtZW50RXZlbnRzW2V2ZW50TmFtZV0gJiYgZWxlbWVudEV2ZW50c1tldmVudE5hbWVdLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgJCRhc3luY0NhbGxiYWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIGVsZW1lbnQudHJpZ2dlckhhbmRsZXIoZXZlbnROYW1lLCB7XHJcbiAgICAgICAgICAgICAgICBldmVudDogYW5pbWF0aW9uRXZlbnQsXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGNsYXNzTmFtZVxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVCZWZvcmVDYWxsYmFja0FzeW5jKCkge1xyXG4gICAgICAgICAgZmlyZURPTUNhbGxiYWNrKCdiZWZvcmUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVBZnRlckNhbGxiYWNrQXN5bmMoKSB7XHJcbiAgICAgICAgICBmaXJlRE9NQ2FsbGJhY2soJ2FmdGVyJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmaXJlRG9uZUNhbGxiYWNrQXN5bmMoKSB7XHJcbiAgICAgICAgICBmaXJlRE9NQ2FsbGJhY2soJ2Nsb3NlJyk7XHJcbiAgICAgICAgICBkb25lQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vaXQgaXMgbGVzcyBjb21wbGljYXRlZCB0byB1c2UgYSBmbGFnIHRoYW4gbWFuYWdpbmcgYW5kIGNhbmNlbGluZ1xyXG4gICAgICAgIC8vdGltZW91dHMgY29udGFpbmluZyBtdWx0aXBsZSBjYWxsYmFja3MuXHJcbiAgICAgICAgZnVuY3Rpb24gZmlyZURPTU9wZXJhdGlvbigpIHtcclxuICAgICAgICAgIGlmICghZmlyZURPTU9wZXJhdGlvbi5oYXNCZWVuUnVuKSB7XHJcbiAgICAgICAgICAgIGZpcmVET01PcGVyYXRpb24uaGFzQmVlblJ1biA9IHRydWU7XHJcbiAgICAgICAgICAgIGRvbU9wZXJhdGlvbigpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xvc2VBbmltYXRpb24oKSB7XHJcbiAgICAgICAgICBpZiAoIWNsb3NlQW5pbWF0aW9uLmhhc0JlZW5SdW4pIHtcclxuICAgICAgICAgICAgaWYgKHJ1bm5lcikgeyAvL3RoZSBydW5uZXIgZG9lc24ndCBleGlzdCBpZiBpdCBmYWlscyB0byBpbnN0YW50aWF0ZVxyXG4gICAgICAgICAgICAgIHJ1bm5lci5hcHBseVN0eWxlcygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbG9zZUFuaW1hdGlvbi5oYXNCZWVuUnVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy50ZW1wQ2xhc3Nlcykge1xyXG4gICAgICAgICAgICAgIGZvckVhY2gob3B0aW9ucy50ZW1wQ2xhc3NlcywgZnVuY3Rpb24oY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgLyogb25seSBzdHJ1Y3R1cmFsIGFuaW1hdGlvbnMgd2FpdCBmb3IgcmVmbG93IGJlZm9yZSByZW1vdmluZyBhblxyXG4gICAgICAgICAgICAgICAgIGFuaW1hdGlvbiwgYnV0IGNsYXNzLWJhc2VkIGFuaW1hdGlvbnMgZG9uJ3QuIEFuIGV4YW1wbGUgb2YgdGhpc1xyXG4gICAgICAgICAgICAgICAgIGZhaWxpbmcgd291bGQgYmUgd2hlbiBhIHBhcmVudCBIVE1MIHRhZyBoYXMgYSBuZy1jbGFzcyBhdHRyaWJ1dGVcclxuICAgICAgICAgICAgICAgICBjYXVzaW5nIEFMTCBkaXJlY3RpdmVzIGJlbG93IHRvIHNraXAgYW5pbWF0aW9ucyBkdXJpbmcgdGhlIGRpZ2VzdCAqL1xyXG4gICAgICAgICAgICAgIGlmIChydW5uZXIgJiYgcnVubmVyLmlzQ2xhc3NCYXNlZCkge1xyXG4gICAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCBjbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkJGFzeW5jQ2FsbGJhY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfU1RBVEUpIHx8IHt9O1xyXG4gICAgICAgICAgICAgICAgICBpZiAobG9jYWxBbmltYXRpb25Db3VudCA9PSBkYXRhLmluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cChlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9TVEFURSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpcmVEb25lQ2FsbGJhY2tBc3luYygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gY2FuY2VsQ2hpbGRBbmltYXRpb25zKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KTtcclxuICAgICAgICBpZiAobm9kZSkge1xyXG4gICAgICAgICAgdmFyIG5vZGVzID0gYW5ndWxhci5pc0Z1bmN0aW9uKG5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSkgP1xyXG4gICAgICAgICAgICBub2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoTkdfQU5JTUFURV9DTEFTU19OQU1FKSA6XHJcbiAgICAgICAgICAgIG5vZGUucXVlcnlTZWxlY3RvckFsbCgnLicgKyBOR19BTklNQVRFX0NMQVNTX05BTUUpO1xyXG4gICAgICAgICAgZm9yRWFjaChub2RlcywgZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICBlbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5hY3RpdmUpIHtcclxuICAgICAgICAgICAgICBmb3JFYWNoKGRhdGEuYWN0aXZlLCBmdW5jdGlvbihydW5uZXIpIHtcclxuICAgICAgICAgICAgICAgIHJ1bm5lci5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBjbGVhbnVwKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGlmIChpc01hdGNoaW5nRWxlbWVudChlbGVtZW50LCAkcm9vdEVsZW1lbnQpKSB7XHJcbiAgICAgICAgICBpZiAoIXJvb3RBbmltYXRlU3RhdGUuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcm9vdEFuaW1hdGVTdGF0ZS5ydW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJvb3RBbmltYXRlU3RhdGUuc3RydWN0dXJhbCA9IGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fTtcclxuXHJcbiAgICAgICAgICB2YXIgcmVtb3ZlQW5pbWF0aW9ucyA9IGNsYXNzTmFtZSA9PT0gdHJ1ZTtcclxuICAgICAgICAgIGlmICghcmVtb3ZlQW5pbWF0aW9ucyAmJiBkYXRhLmFjdGl2ZSAmJiBkYXRhLmFjdGl2ZVtjbGFzc05hbWVdKSB7XHJcbiAgICAgICAgICAgIGRhdGEudG90YWxBY3RpdmUtLTtcclxuICAgICAgICAgICAgZGVsZXRlIGRhdGEuYWN0aXZlW2NsYXNzTmFtZV07XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKHJlbW92ZUFuaW1hdGlvbnMgfHwgIWRhdGEudG90YWxBY3RpdmUpIHtcclxuICAgICAgICAgICAgJCRqcUxpdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgTkdfQU5JTUFURV9DTEFTU19OQU1FKTtcclxuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVEYXRhKE5HX0FOSU1BVEVfU1RBVEUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYW5pbWF0aW9uc0Rpc2FibGVkKGVsZW1lbnQsIHBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICBpZiAocm9vdEFuaW1hdGVTdGF0ZS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaXNNYXRjaGluZ0VsZW1lbnQoZWxlbWVudCwgJHJvb3RFbGVtZW50KSkge1xyXG4gICAgICAgICAgcmV0dXJuIHJvb3RBbmltYXRlU3RhdGUucnVubmluZztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBhbGxvd0NoaWxkQW5pbWF0aW9ucywgcGFyZW50UnVubmluZ0FuaW1hdGlvbiwgaGFzUGFyZW50O1xyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgIC8vdGhlIGVsZW1lbnQgZGlkIG5vdCByZWFjaCB0aGUgcm9vdCBlbGVtZW50IHdoaWNoIG1lYW5zIHRoYXQgaXRcclxuICAgICAgICAgIC8vaXMgbm90IGFwYXJ0IG9mIHRoZSBET00uIFRoZXJlZm9yZSB0aGVyZSBpcyBubyByZWFzb24gdG8gZG9cclxuICAgICAgICAgIC8vYW55IGFuaW1hdGlvbnMgb24gaXRcclxuICAgICAgICAgIGlmIChwYXJlbnRFbGVtZW50Lmxlbmd0aCA9PT0gMCkgYnJlYWs7XHJcblxyXG4gICAgICAgICAgdmFyIGlzUm9vdCA9IGlzTWF0Y2hpbmdFbGVtZW50KHBhcmVudEVsZW1lbnQsICRyb290RWxlbWVudCk7XHJcbiAgICAgICAgICB2YXIgc3RhdGUgPSBpc1Jvb3QgPyByb290QW5pbWF0ZVN0YXRlIDogKHBhcmVudEVsZW1lbnQuZGF0YShOR19BTklNQVRFX1NUQVRFKSB8fCB7fSk7XHJcbiAgICAgICAgICBpZiAoc3RhdGUuZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy9ubyBtYXR0ZXIgd2hhdCwgZm9yIGFuIGFuaW1hdGlvbiB0byB3b3JrIGl0IG11c3QgcmVhY2ggdGhlIHJvb3QgZWxlbWVudFxyXG4gICAgICAgICAgLy90aGlzIGltcGxpZXMgdGhhdCB0aGUgZWxlbWVudCBpcyBhdHRhY2hlZCB0byB0aGUgRE9NIHdoZW4gdGhlIGFuaW1hdGlvbiBpcyBydW5cclxuICAgICAgICAgIGlmIChpc1Jvb3QpIHtcclxuICAgICAgICAgICAgaGFzUGFyZW50ID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvL29uY2UgYSBmbGFnIGlzIGZvdW5kIHRoYXQgaXMgc3RyaWN0bHkgZmFsc2UgdGhlbiBldmVyeXRoaW5nIGJlZm9yZVxyXG4gICAgICAgICAgLy9pdCB3aWxsIGJlIGRpc2NhcmRlZCBhbmQgYWxsIGNoaWxkIGFuaW1hdGlvbnMgd2lsbCBiZSByZXN0cmljdGVkXHJcbiAgICAgICAgICBpZiAoYWxsb3dDaGlsZEFuaW1hdGlvbnMgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHZhciBhbmltYXRlQ2hpbGRyZW5GbGFnID0gcGFyZW50RWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ0hJTERSRU4pO1xyXG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoYW5pbWF0ZUNoaWxkcmVuRmxhZykpIHtcclxuICAgICAgICAgICAgICBhbGxvd0NoaWxkQW5pbWF0aW9ucyA9IGFuaW1hdGVDaGlsZHJlbkZsYWc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBwYXJlbnRSdW5uaW5nQW5pbWF0aW9uID0gcGFyZW50UnVubmluZ0FuaW1hdGlvbiB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnJ1bm5pbmcgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc3RhdGUubGFzdCAmJiAhc3RhdGUubGFzdC5pc0NsYXNzQmFzZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3aGlsZSAocGFyZW50RWxlbWVudCA9IHBhcmVudEVsZW1lbnQucGFyZW50KCkpO1xyXG5cclxuICAgICAgICByZXR1cm4gIWhhc1BhcmVudCB8fCAoIWFsbG93Q2hpbGRBbmltYXRpb25zICYmIHBhcmVudFJ1bm5pbmdBbmltYXRpb24pO1xyXG4gICAgICB9XHJcbiAgICB9XSk7XHJcblxyXG4gICAgJGFuaW1hdGVQcm92aWRlci5yZWdpc3RlcignJywgWyckd2luZG93JywgJyRzbmlmZmVyJywgJyR0aW1lb3V0JywgJyQkYW5pbWF0ZVJlZmxvdycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCR3aW5kb3csICAgJHNuaWZmZXIsICAgJHRpbWVvdXQsICAgJCRhbmltYXRlUmVmbG93KSB7XHJcbiAgICAgIC8vIERldGVjdCBwcm9wZXIgdHJhbnNpdGlvbmVuZC9hbmltYXRpb25lbmQgZXZlbnQgbmFtZXMuXHJcbiAgICAgIHZhciBDU1NfUFJFRklYID0gJycsIFRSQU5TSVRJT05fUFJPUCwgVFJBTlNJVElPTkVORF9FVkVOVCwgQU5JTUFUSU9OX1BST1AsIEFOSU1BVElPTkVORF9FVkVOVDtcclxuXHJcbiAgICAgIC8vIElmIHVucHJlZml4ZWQgZXZlbnRzIGFyZSBub3Qgc3VwcG9ydGVkIGJ1dCB3ZWJraXQtcHJlZml4ZWQgYXJlLCB1c2UgdGhlIGxhdHRlci5cclxuICAgICAgLy8gT3RoZXJ3aXNlLCBqdXN0IHVzZSBXM0MgbmFtZXMsIGJyb3dzZXJzIG5vdCBzdXBwb3J0aW5nIHRoZW0gYXQgYWxsIHdpbGwganVzdCBpZ25vcmUgdGhlbS5cclxuICAgICAgLy8gTm90ZTogQ2hyb21lIGltcGxlbWVudHMgYHdpbmRvdy5vbndlYmtpdGFuaW1hdGlvbmVuZGAgYW5kIGRvZXNuJ3QgaW1wbGVtZW50IGB3aW5kb3cub25hbmltYXRpb25lbmRgXHJcbiAgICAgIC8vIGJ1dCBhdCB0aGUgc2FtZSB0aW1lIGRpc3BhdGNoZXMgdGhlIGBhbmltYXRpb25lbmRgIGV2ZW50IGFuZCBub3QgYHdlYmtpdEFuaW1hdGlvbkVuZGAuXHJcbiAgICAgIC8vIFJlZ2lzdGVyIGJvdGggZXZlbnRzIGluIGNhc2UgYHdpbmRvdy5vbmFuaW1hdGlvbmVuZGAgaXMgbm90IHN1cHBvcnRlZCBiZWNhdXNlIG9mIHRoYXQsXHJcbiAgICAgIC8vIGRvIHRoZSBzYW1lIGZvciBgdHJhbnNpdGlvbmVuZGAgYXMgU2FmYXJpIGlzIGxpa2VseSB0byBleGhpYml0IHNpbWlsYXIgYmVoYXZpb3IuXHJcbiAgICAgIC8vIEFsc28sIHRoZSBvbmx5IG1vZGVybiBicm93c2VyIHRoYXQgdXNlcyB2ZW5kb3IgcHJlZml4ZXMgZm9yIHRyYW5zaXRpb25zL2tleWZyYW1lcyBpcyB3ZWJraXRcclxuICAgICAgLy8gdGhlcmVmb3JlIHRoZXJlIGlzIG5vIHJlYXNvbiB0byB0ZXN0IGFueW1vcmUgZm9yIG90aGVyIHZlbmRvciBwcmVmaXhlczogaHR0cDovL2Nhbml1c2UuY29tLyNzZWFyY2g9dHJhbnNpdGlvblxyXG4gICAgICBpZiAod2luZG93Lm9udHJhbnNpdGlvbmVuZCA9PT0gdW5kZWZpbmVkICYmIHdpbmRvdy5vbndlYmtpdHRyYW5zaXRpb25lbmQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIENTU19QUkVGSVggPSAnLXdlYmtpdC0nO1xyXG4gICAgICAgIFRSQU5TSVRJT05fUFJPUCA9ICdXZWJraXRUcmFuc2l0aW9uJztcclxuICAgICAgICBUUkFOU0lUSU9ORU5EX0VWRU5UID0gJ3dlYmtpdFRyYW5zaXRpb25FbmQgdHJhbnNpdGlvbmVuZCc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgVFJBTlNJVElPTl9QUk9QID0gJ3RyYW5zaXRpb24nO1xyXG4gICAgICAgIFRSQU5TSVRJT05FTkRfRVZFTlQgPSAndHJhbnNpdGlvbmVuZCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh3aW5kb3cub25hbmltYXRpb25lbmQgPT09IHVuZGVmaW5lZCAmJiB3aW5kb3cub253ZWJraXRhbmltYXRpb25lbmQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIENTU19QUkVGSVggPSAnLXdlYmtpdC0nO1xyXG4gICAgICAgIEFOSU1BVElPTl9QUk9QID0gJ1dlYmtpdEFuaW1hdGlvbic7XHJcbiAgICAgICAgQU5JTUFUSU9ORU5EX0VWRU5UID0gJ3dlYmtpdEFuaW1hdGlvbkVuZCBhbmltYXRpb25lbmQnO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIEFOSU1BVElPTl9QUk9QID0gJ2FuaW1hdGlvbic7XHJcbiAgICAgICAgQU5JTUFUSU9ORU5EX0VWRU5UID0gJ2FuaW1hdGlvbmVuZCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBEVVJBVElPTl9LRVkgPSAnRHVyYXRpb24nO1xyXG4gICAgICB2YXIgUFJPUEVSVFlfS0VZID0gJ1Byb3BlcnR5JztcclxuICAgICAgdmFyIERFTEFZX0tFWSA9ICdEZWxheSc7XHJcbiAgICAgIHZhciBBTklNQVRJT05fSVRFUkFUSU9OX0NPVU5UX0tFWSA9ICdJdGVyYXRpb25Db3VudCc7XHJcbiAgICAgIHZhciBBTklNQVRJT05fUExBWVNUQVRFX0tFWSA9ICdQbGF5U3RhdGUnO1xyXG4gICAgICB2YXIgTkdfQU5JTUFURV9QQVJFTlRfS0VZID0gJyQkbmdBbmltYXRlS2V5JztcclxuICAgICAgdmFyIE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZID0gJyQkbmdBbmltYXRlQ1NTM0RhdGEnO1xyXG4gICAgICB2YXIgRUxBUFNFRF9USU1FX01BWF9ERUNJTUFMX1BMQUNFUyA9IDM7XHJcbiAgICAgIHZhciBDTE9TSU5HX1RJTUVfQlVGRkVSID0gMS41O1xyXG4gICAgICB2YXIgT05FX1NFQ09ORCA9IDEwMDA7XHJcblxyXG4gICAgICB2YXIgbG9va3VwQ2FjaGUgPSB7fTtcclxuICAgICAgdmFyIHBhcmVudENvdW50ZXIgPSAwO1xyXG4gICAgICB2YXIgYW5pbWF0aW9uUmVmbG93UXVldWUgPSBbXTtcclxuICAgICAgdmFyIGNhbmNlbEFuaW1hdGlvblJlZmxvdztcclxuICAgICAgZnVuY3Rpb24gY2xlYXJDYWNoZUFmdGVyUmVmbG93KCkge1xyXG4gICAgICAgIGlmICghY2FuY2VsQW5pbWF0aW9uUmVmbG93KSB7XHJcbiAgICAgICAgICBjYW5jZWxBbmltYXRpb25SZWZsb3cgPSAkJGFuaW1hdGVSZWZsb3coZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGFuaW1hdGlvblJlZmxvd1F1ZXVlID0gW107XHJcbiAgICAgICAgICAgIGNhbmNlbEFuaW1hdGlvblJlZmxvdyA9IG51bGw7XHJcbiAgICAgICAgICAgIGxvb2t1cENhY2hlID0ge307XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGFmdGVyUmVmbG93KGVsZW1lbnQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgaWYgKGNhbmNlbEFuaW1hdGlvblJlZmxvdykge1xyXG4gICAgICAgICAgY2FuY2VsQW5pbWF0aW9uUmVmbG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFuaW1hdGlvblJlZmxvd1F1ZXVlLnB1c2goY2FsbGJhY2spO1xyXG4gICAgICAgIGNhbmNlbEFuaW1hdGlvblJlZmxvdyA9ICQkYW5pbWF0ZVJlZmxvdyhmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGZvckVhY2goYW5pbWF0aW9uUmVmbG93UXVldWUsIGZ1bmN0aW9uKGZuKSB7XHJcbiAgICAgICAgICAgIGZuKCk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICBhbmltYXRpb25SZWZsb3dRdWV1ZSA9IFtdO1xyXG4gICAgICAgICAgY2FuY2VsQW5pbWF0aW9uUmVmbG93ID0gbnVsbDtcclxuICAgICAgICAgIGxvb2t1cENhY2hlID0ge307XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBjbG9zaW5nVGltZXIgPSBudWxsO1xyXG4gICAgICB2YXIgY2xvc2luZ1RpbWVzdGFtcCA9IDA7XHJcbiAgICAgIHZhciBhbmltYXRpb25FbGVtZW50UXVldWUgPSBbXTtcclxuICAgICAgZnVuY3Rpb24gYW5pbWF0aW9uQ2xvc2VIYW5kbGVyKGVsZW1lbnQsIHRvdGFsVGltZSkge1xyXG4gICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xyXG4gICAgICAgIGVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQobm9kZSk7XHJcblxyXG4gICAgICAgIC8vdGhpcyBpdGVtIHdpbGwgYmUgZ2FyYmFnZSBjb2xsZWN0ZWQgYnkgdGhlIGNsb3NpbmdcclxuICAgICAgICAvL2FuaW1hdGlvbiB0aW1lb3V0XHJcbiAgICAgICAgYW5pbWF0aW9uRWxlbWVudFF1ZXVlLnB1c2goZWxlbWVudCk7XHJcblxyXG4gICAgICAgIC8vYnV0IGl0IG1heSBub3QgbmVlZCB0byBjYW5jZWwgb3V0IHRoZSBleGlzdGluZyB0aW1lb3V0XHJcbiAgICAgICAgLy9pZiB0aGUgdGltZXN0YW1wIGlzIGxlc3MgdGhhbiB0aGUgcHJldmlvdXMgb25lXHJcbiAgICAgICAgdmFyIGZ1dHVyZVRpbWVzdGFtcCA9IERhdGUubm93KCkgKyB0b3RhbFRpbWU7XHJcbiAgICAgICAgaWYgKGZ1dHVyZVRpbWVzdGFtcCA8PSBjbG9zaW5nVGltZXN0YW1wKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkdGltZW91dC5jYW5jZWwoY2xvc2luZ1RpbWVyKTtcclxuXHJcbiAgICAgICAgY2xvc2luZ1RpbWVzdGFtcCA9IGZ1dHVyZVRpbWVzdGFtcDtcclxuICAgICAgICBjbG9zaW5nVGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGNsb3NlQWxsQW5pbWF0aW9ucyhhbmltYXRpb25FbGVtZW50UXVldWUpO1xyXG4gICAgICAgICAgYW5pbWF0aW9uRWxlbWVudFF1ZXVlID0gW107XHJcbiAgICAgICAgfSwgdG90YWxUaW1lLCBmYWxzZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGNsb3NlQWxsQW5pbWF0aW9ucyhlbGVtZW50cykge1xyXG4gICAgICAgIGZvckVhY2goZWxlbWVudHMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgIHZhciBlbGVtZW50RGF0YSA9IGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSk7XHJcbiAgICAgICAgICBpZiAoZWxlbWVudERhdGEpIHtcclxuICAgICAgICAgICAgZm9yRWFjaChlbGVtZW50RGF0YS5jbG9zZUFuaW1hdGlvbkZucywgZnVuY3Rpb24oZm4pIHtcclxuICAgICAgICAgICAgICBmbigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0RWxlbWVudEFuaW1hdGlvbkRldGFpbHMoZWxlbWVudCwgY2FjaGVLZXkpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IGNhY2hlS2V5ID8gbG9va3VwQ2FjaGVbY2FjaGVLZXldIDogbnVsbDtcclxuICAgICAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb24gPSAwO1xyXG4gICAgICAgICAgdmFyIHRyYW5zaXRpb25EZWxheSA9IDA7XHJcbiAgICAgICAgICB2YXIgYW5pbWF0aW9uRHVyYXRpb24gPSAwO1xyXG4gICAgICAgICAgdmFyIGFuaW1hdGlvbkRlbGF5ID0gMDtcclxuXHJcbiAgICAgICAgICAvL3dlIHdhbnQgYWxsIHRoZSBzdHlsZXMgZGVmaW5lZCBiZWZvcmUgYW5kIGFmdGVyXHJcbiAgICAgICAgICBmb3JFYWNoKGVsZW1lbnQsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgPT0gRUxFTUVOVF9OT0RFKSB7XHJcbiAgICAgICAgICAgICAgdmFyIGVsZW1lbnRTdHlsZXMgPSAkd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkgfHwge307XHJcblxyXG4gICAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uRHVyYXRpb25TdHlsZSA9IGVsZW1lbnRTdHlsZXNbVFJBTlNJVElPTl9QUk9QICsgRFVSQVRJT05fS0VZXTtcclxuICAgICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb24gPSBNYXRoLm1heChwYXJzZU1heFRpbWUodHJhbnNpdGlvbkR1cmF0aW9uU3R5bGUpLCB0cmFuc2l0aW9uRHVyYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgICB2YXIgdHJhbnNpdGlvbkRlbGF5U3R5bGUgPSBlbGVtZW50U3R5bGVzW1RSQU5TSVRJT05fUFJPUCArIERFTEFZX0tFWV07XHJcbiAgICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGF5ICA9IE1hdGgubWF4KHBhcnNlTWF4VGltZSh0cmFuc2l0aW9uRGVsYXlTdHlsZSksIHRyYW5zaXRpb25EZWxheSk7XHJcblxyXG4gICAgICAgICAgICAgIHZhciBhbmltYXRpb25EZWxheVN0eWxlID0gZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIERFTEFZX0tFWV07XHJcbiAgICAgICAgICAgICAgYW5pbWF0aW9uRGVsYXkgICA9IE1hdGgubWF4KHBhcnNlTWF4VGltZShlbGVtZW50U3R5bGVzW0FOSU1BVElPTl9QUk9QICsgREVMQVlfS0VZXSksIGFuaW1hdGlvbkRlbGF5KTtcclxuXHJcbiAgICAgICAgICAgICAgdmFyIGFEdXJhdGlvbiAgPSBwYXJzZU1heFRpbWUoZWxlbWVudFN0eWxlc1tBTklNQVRJT05fUFJPUCArIERVUkFUSU9OX0tFWV0pO1xyXG5cclxuICAgICAgICAgICAgICBpZiAoYUR1cmF0aW9uID4gMCkge1xyXG4gICAgICAgICAgICAgICAgYUR1cmF0aW9uICo9IHBhcnNlSW50KGVsZW1lbnRTdHlsZXNbQU5JTUFUSU9OX1BST1AgKyBBTklNQVRJT05fSVRFUkFUSU9OX0NPVU5UX0tFWV0sIDEwKSB8fCAxO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBhbmltYXRpb25EdXJhdGlvbiA9IE1hdGgubWF4KGFEdXJhdGlvbiwgYW5pbWF0aW9uRHVyYXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIHRvdGFsOiAwLFxyXG4gICAgICAgICAgICB0cmFuc2l0aW9uRGVsYXk6IHRyYW5zaXRpb25EZWxheSxcclxuICAgICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiB0cmFuc2l0aW9uRHVyYXRpb24sXHJcbiAgICAgICAgICAgIGFuaW1hdGlvbkRlbGF5OiBhbmltYXRpb25EZWxheSxcclxuICAgICAgICAgICAgYW5pbWF0aW9uRHVyYXRpb246IGFuaW1hdGlvbkR1cmF0aW9uXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgaWYgKGNhY2hlS2V5KSB7XHJcbiAgICAgICAgICAgIGxvb2t1cENhY2hlW2NhY2hlS2V5XSA9IGRhdGE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBwYXJzZU1heFRpbWUoc3RyKSB7XHJcbiAgICAgICAgdmFyIG1heFZhbHVlID0gMDtcclxuICAgICAgICB2YXIgdmFsdWVzID0gaXNTdHJpbmcoc3RyKSA/XHJcbiAgICAgICAgICBzdHIuc3BsaXQoL1xccyosXFxzKi8pIDpcclxuICAgICAgICAgIFtdO1xyXG4gICAgICAgIGZvckVhY2godmFsdWVzLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgbWF4VmFsdWUgPSBNYXRoLm1heChwYXJzZUZsb2F0KHZhbHVlKSB8fCAwLCBtYXhWYWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG1heFZhbHVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRDYWNoZUtleShlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIHBhcmVudEVsZW1lbnQgPSBlbGVtZW50LnBhcmVudCgpO1xyXG4gICAgICAgIHZhciBwYXJlbnRJRCA9IHBhcmVudEVsZW1lbnQuZGF0YShOR19BTklNQVRFX1BBUkVOVF9LRVkpO1xyXG4gICAgICAgIGlmICghcGFyZW50SUQpIHtcclxuICAgICAgICAgIHBhcmVudEVsZW1lbnQuZGF0YShOR19BTklNQVRFX1BBUkVOVF9LRVksICsrcGFyZW50Q291bnRlcik7XHJcbiAgICAgICAgICBwYXJlbnRJRCA9IHBhcmVudENvdW50ZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJlbnRJRCArICctJyArIGV4dHJhY3RFbGVtZW50Tm9kZShlbGVtZW50KS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVTZXR1cChhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBzdHlsZXMpIHtcclxuICAgICAgICB2YXIgc3RydWN0dXJhbCA9IFsnbmctZW50ZXInLCduZy1sZWF2ZScsJ25nLW1vdmUnXS5pbmRleE9mKGNsYXNzTmFtZSkgPj0gMDtcclxuXHJcbiAgICAgICAgdmFyIGNhY2hlS2V5ID0gZ2V0Q2FjaGVLZXkoZWxlbWVudCk7XHJcbiAgICAgICAgdmFyIGV2ZW50Q2FjaGVLZXkgPSBjYWNoZUtleSArICcgJyArIGNsYXNzTmFtZTtcclxuICAgICAgICB2YXIgaXRlbUluZGV4ID0gbG9va3VwQ2FjaGVbZXZlbnRDYWNoZUtleV0gPyArK2xvb2t1cENhY2hlW2V2ZW50Q2FjaGVLZXldLnRvdGFsIDogMDtcclxuXHJcbiAgICAgICAgdmFyIHN0YWdnZXIgPSB7fTtcclxuICAgICAgICBpZiAoaXRlbUluZGV4ID4gMCkge1xyXG4gICAgICAgICAgdmFyIHN0YWdnZXJDbGFzc05hbWUgPSBjbGFzc05hbWUgKyAnLXN0YWdnZXInO1xyXG4gICAgICAgICAgdmFyIHN0YWdnZXJDYWNoZUtleSA9IGNhY2hlS2V5ICsgJyAnICsgc3RhZ2dlckNsYXNzTmFtZTtcclxuICAgICAgICAgIHZhciBhcHBseUNsYXNzZXMgPSAhbG9va3VwQ2FjaGVbc3RhZ2dlckNhY2hlS2V5XTtcclxuXHJcbiAgICAgICAgICBhcHBseUNsYXNzZXMgJiYgJCRqcUxpdGUuYWRkQ2xhc3MoZWxlbWVudCwgc3RhZ2dlckNsYXNzTmFtZSk7XHJcblxyXG4gICAgICAgICAgc3RhZ2dlciA9IGdldEVsZW1lbnRBbmltYXRpb25EZXRhaWxzKGVsZW1lbnQsIHN0YWdnZXJDYWNoZUtleSk7XHJcblxyXG4gICAgICAgICAgYXBwbHlDbGFzc2VzICYmICQkanFMaXRlLnJlbW92ZUNsYXNzKGVsZW1lbnQsIHN0YWdnZXJDbGFzc05hbWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJCRqcUxpdGUuYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcclxuXHJcbiAgICAgICAgdmFyIGZvcm1lckRhdGEgPSBlbGVtZW50LmRhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpIHx8IHt9O1xyXG4gICAgICAgIHZhciB0aW1pbmdzID0gZ2V0RWxlbWVudEFuaW1hdGlvbkRldGFpbHMoZWxlbWVudCwgZXZlbnRDYWNoZUtleSk7XHJcbiAgICAgICAgdmFyIHRyYW5zaXRpb25EdXJhdGlvbiA9IHRpbWluZ3MudHJhbnNpdGlvbkR1cmF0aW9uO1xyXG4gICAgICAgIHZhciBhbmltYXRpb25EdXJhdGlvbiA9IHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb247XHJcblxyXG4gICAgICAgIGlmIChzdHJ1Y3R1cmFsICYmIHRyYW5zaXRpb25EdXJhdGlvbiA9PT0gMCAmJiBhbmltYXRpb25EdXJhdGlvbiA9PT0gMCkge1xyXG4gICAgICAgICAgJCRqcUxpdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBibG9ja1RyYW5zaXRpb24gPSBzdHlsZXMgfHwgKHN0cnVjdHVyYWwgJiYgdHJhbnNpdGlvbkR1cmF0aW9uID4gMCk7XHJcbiAgICAgICAgdmFyIGJsb2NrQW5pbWF0aW9uID0gYW5pbWF0aW9uRHVyYXRpb24gPiAwICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhZ2dlci5hbmltYXRpb25EZWxheSA+IDAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFnZ2VyLmFuaW1hdGlvbkR1cmF0aW9uID09PSAwO1xyXG5cclxuICAgICAgICB2YXIgY2xvc2VBbmltYXRpb25GbnMgPSBmb3JtZXJEYXRhLmNsb3NlQW5pbWF0aW9uRm5zIHx8IFtdO1xyXG4gICAgICAgIGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSwge1xyXG4gICAgICAgICAgc3RhZ2dlcjogc3RhZ2dlcixcclxuICAgICAgICAgIGNhY2hlS2V5OiBldmVudENhY2hlS2V5LFxyXG4gICAgICAgICAgcnVubmluZzogZm9ybWVyRGF0YS5ydW5uaW5nIHx8IDAsXHJcbiAgICAgICAgICBpdGVtSW5kZXg6IGl0ZW1JbmRleCxcclxuICAgICAgICAgIGJsb2NrVHJhbnNpdGlvbjogYmxvY2tUcmFuc2l0aW9uLFxyXG4gICAgICAgICAgY2xvc2VBbmltYXRpb25GbnM6IGNsb3NlQW5pbWF0aW9uRm5zXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBub2RlID0gZXh0cmFjdEVsZW1lbnROb2RlKGVsZW1lbnQpO1xyXG5cclxuICAgICAgICBpZiAoYmxvY2tUcmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICBibG9ja1RyYW5zaXRpb25zKG5vZGUsIHRydWUpO1xyXG4gICAgICAgICAgaWYgKHN0eWxlcykge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNzcyhzdHlsZXMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGJsb2NrQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgICBibG9ja0FuaW1hdGlvbnMobm9kZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZVJ1bihhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSwgc3R5bGVzKSB7XHJcbiAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XHJcbiAgICAgICAgdmFyIGVsZW1lbnREYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcclxuICAgICAgICBpZiAobm9kZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykuaW5kZXhPZihjbGFzc05hbWUpID09IC0xIHx8ICFlbGVtZW50RGF0YSkge1xyXG4gICAgICAgICAgYWN0aXZlQW5pbWF0aW9uQ29tcGxldGUoKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBhY3RpdmVDbGFzc05hbWUgPSAnJztcclxuICAgICAgICB2YXIgcGVuZGluZ0NsYXNzTmFtZSA9ICcnO1xyXG4gICAgICAgIGZvckVhY2goY2xhc3NOYW1lLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGtsYXNzLCBpKSB7XHJcbiAgICAgICAgICB2YXIgcHJlZml4ID0gKGkgPiAwID8gJyAnIDogJycpICsga2xhc3M7XHJcbiAgICAgICAgICBhY3RpdmVDbGFzc05hbWUgKz0gcHJlZml4ICsgJy1hY3RpdmUnO1xyXG4gICAgICAgICAgcGVuZGluZ0NsYXNzTmFtZSArPSBwcmVmaXggKyAnLXBlbmRpbmcnO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgc3R5bGUgPSAnJztcclxuICAgICAgICB2YXIgYXBwbGllZFN0eWxlcyA9IFtdO1xyXG4gICAgICAgIHZhciBpdGVtSW5kZXggPSBlbGVtZW50RGF0YS5pdGVtSW5kZXg7XHJcbiAgICAgICAgdmFyIHN0YWdnZXIgPSBlbGVtZW50RGF0YS5zdGFnZ2VyO1xyXG4gICAgICAgIHZhciBzdGFnZ2VyVGltZSA9IDA7XHJcbiAgICAgICAgaWYgKGl0ZW1JbmRleCA+IDApIHtcclxuICAgICAgICAgIHZhciB0cmFuc2l0aW9uU3RhZ2dlckRlbGF5ID0gMDtcclxuICAgICAgICAgIGlmIChzdGFnZ2VyLnRyYW5zaXRpb25EZWxheSA+IDAgJiYgc3RhZ2dlci50cmFuc2l0aW9uRHVyYXRpb24gPT09IDApIHtcclxuICAgICAgICAgICAgdHJhbnNpdGlvblN0YWdnZXJEZWxheSA9IHN0YWdnZXIudHJhbnNpdGlvbkRlbGF5ICogaXRlbUluZGV4O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHZhciBhbmltYXRpb25TdGFnZ2VyRGVsYXkgPSAwO1xyXG4gICAgICAgICAgaWYgKHN0YWdnZXIuYW5pbWF0aW9uRGVsYXkgPiAwICYmIHN0YWdnZXIuYW5pbWF0aW9uRHVyYXRpb24gPT09IDApIHtcclxuICAgICAgICAgICAgYW5pbWF0aW9uU3RhZ2dlckRlbGF5ID0gc3RhZ2dlci5hbmltYXRpb25EZWxheSAqIGl0ZW1JbmRleDtcclxuICAgICAgICAgICAgYXBwbGllZFN0eWxlcy5wdXNoKENTU19QUkVGSVggKyAnYW5pbWF0aW9uLXBsYXktc3RhdGUnKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBzdGFnZ2VyVGltZSA9IE1hdGgucm91bmQoTWF0aC5tYXgodHJhbnNpdGlvblN0YWdnZXJEZWxheSwgYW5pbWF0aW9uU3RhZ2dlckRlbGF5KSAqIDEwMCkgLyAxMDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXN0YWdnZXJUaW1lKSB7XHJcbiAgICAgICAgICAkJGpxTGl0ZS5hZGRDbGFzcyhlbGVtZW50LCBhY3RpdmVDbGFzc05hbWUpO1xyXG4gICAgICAgICAgaWYgKGVsZW1lbnREYXRhLmJsb2NrVHJhbnNpdGlvbikge1xyXG4gICAgICAgICAgICBibG9ja1RyYW5zaXRpb25zKG5vZGUsIGZhbHNlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBldmVudENhY2hlS2V5ID0gZWxlbWVudERhdGEuY2FjaGVLZXkgKyAnICcgKyBhY3RpdmVDbGFzc05hbWU7XHJcbiAgICAgICAgdmFyIHRpbWluZ3MgPSBnZXRFbGVtZW50QW5pbWF0aW9uRGV0YWlscyhlbGVtZW50LCBldmVudENhY2hlS2V5KTtcclxuICAgICAgICB2YXIgbWF4RHVyYXRpb24gPSBNYXRoLm1heCh0aW1pbmdzLnRyYW5zaXRpb25EdXJhdGlvbiwgdGltaW5ncy5hbmltYXRpb25EdXJhdGlvbik7XHJcbiAgICAgICAgaWYgKG1heER1cmF0aW9uID09PSAwKSB7XHJcbiAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBhY3RpdmVDbGFzc05hbWUpO1xyXG4gICAgICAgICAgYW5pbWF0ZUNsb3NlKGVsZW1lbnQsIGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICBhY3RpdmVBbmltYXRpb25Db21wbGV0ZSgpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFzdGFnZ2VyVGltZSAmJiBzdHlsZXMgJiYgT2JqZWN0LmtleXMoc3R5bGVzKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBpZiAoIXRpbWluZ3MudHJhbnNpdGlvbkR1cmF0aW9uKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY3NzKCd0cmFuc2l0aW9uJywgdGltaW5ncy5hbmltYXRpb25EdXJhdGlvbiArICdzIGxpbmVhciBhbGwnKTtcclxuICAgICAgICAgICAgYXBwbGllZFN0eWxlcy5wdXNoKCd0cmFuc2l0aW9uJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbGVtZW50LmNzcyhzdHlsZXMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG1heERlbGF5ID0gTWF0aC5tYXgodGltaW5ncy50cmFuc2l0aW9uRGVsYXksIHRpbWluZ3MuYW5pbWF0aW9uRGVsYXkpO1xyXG4gICAgICAgIHZhciBtYXhEZWxheVRpbWUgPSBtYXhEZWxheSAqIE9ORV9TRUNPTkQ7XHJcblxyXG4gICAgICAgIGlmIChhcHBsaWVkU3R5bGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIC8vdGhlIGVsZW1lbnQgYmVpbmcgYW5pbWF0ZWQgbWF5IHNvbWV0aW1lcyBjb250YWluIGNvbW1lbnQgbm9kZXMgaW5cclxuICAgICAgICAgIC8vdGhlIGpxTGl0ZSBvYmplY3QsIHNvIHdlJ3JlIHNhZmUgdG8gdXNlIGEgc2luZ2xlIHZhcmlhYmxlIHRvIGhvdXNlXHJcbiAgICAgICAgICAvL3RoZSBzdHlsZXMgc2luY2UgdGhlcmUgaXMgYWx3YXlzIG9ubHkgb25lIGVsZW1lbnQgYmVpbmcgYW5pbWF0ZWRcclxuICAgICAgICAgIHZhciBvbGRTdHlsZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCdzdHlsZScpIHx8ICcnO1xyXG4gICAgICAgICAgaWYgKG9sZFN0eWxlLmNoYXJBdChvbGRTdHlsZS5sZW5ndGggLSAxKSAhPT0gJzsnKSB7XHJcbiAgICAgICAgICAgIG9sZFN0eWxlICs9ICc7JztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCdzdHlsZScsIG9sZFN0eWxlICsgJyAnICsgc3R5bGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgICAgdmFyIGNzczNBbmltYXRpb25FdmVudHMgPSBBTklNQVRJT05FTkRfRVZFTlQgKyAnICcgKyBUUkFOU0lUSU9ORU5EX0VWRU5UO1xyXG4gICAgICAgIHZhciBhbmltYXRpb25UaW1lICAgICA9IChtYXhEZWxheSArIG1heER1cmF0aW9uKSAqIENMT1NJTkdfVElNRV9CVUZGRVI7XHJcbiAgICAgICAgdmFyIHRvdGFsVGltZSAgICAgICAgID0gKHN0YWdnZXJUaW1lICsgYW5pbWF0aW9uVGltZSkgKiBPTkVfU0VDT05EO1xyXG5cclxuICAgICAgICB2YXIgc3RhZ2dlclRpbWVvdXQ7XHJcbiAgICAgICAgaWYgKHN0YWdnZXJUaW1lID4gMCkge1xyXG4gICAgICAgICAgJCRqcUxpdGUuYWRkQ2xhc3MoZWxlbWVudCwgcGVuZGluZ0NsYXNzTmFtZSk7XHJcbiAgICAgICAgICBzdGFnZ2VyVGltZW91dCA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzdGFnZ2VyVGltZW91dCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBpZiAodGltaW5ncy50cmFuc2l0aW9uRHVyYXRpb24gPiAwKSB7XHJcbiAgICAgICAgICAgICAgYmxvY2tUcmFuc2l0aW9ucyhub2RlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb24gPiAwKSB7XHJcbiAgICAgICAgICAgICAgYmxvY2tBbmltYXRpb25zKG5vZGUsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJCRqcUxpdGUuYWRkQ2xhc3MoZWxlbWVudCwgYWN0aXZlQ2xhc3NOYW1lKTtcclxuICAgICAgICAgICAgJCRqcUxpdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgcGVuZGluZ0NsYXNzTmFtZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc3R5bGVzKSB7XHJcbiAgICAgICAgICAgICAgaWYgKHRpbWluZ3MudHJhbnNpdGlvbkR1cmF0aW9uID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNzcygndHJhbnNpdGlvbicsIHRpbWluZ3MuYW5pbWF0aW9uRHVyYXRpb24gKyAncyBsaW5lYXIgYWxsJyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGVsZW1lbnQuY3NzKHN0eWxlcyk7XHJcbiAgICAgICAgICAgICAgYXBwbGllZFN0eWxlcy5wdXNoKCd0cmFuc2l0aW9uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sIHN0YWdnZXJUaW1lICogT05FX1NFQ09ORCwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZWxlbWVudC5vbihjc3MzQW5pbWF0aW9uRXZlbnRzLCBvbkFuaW1hdGlvblByb2dyZXNzKTtcclxuICAgICAgICBlbGVtZW50RGF0YS5jbG9zZUFuaW1hdGlvbkZucy5wdXNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgb25FbmQoKTtcclxuICAgICAgICAgIGFjdGl2ZUFuaW1hdGlvbkNvbXBsZXRlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGVsZW1lbnREYXRhLnJ1bm5pbmcrKztcclxuICAgICAgICBhbmltYXRpb25DbG9zZUhhbmRsZXIoZWxlbWVudCwgdG90YWxUaW1lKTtcclxuICAgICAgICByZXR1cm4gb25FbmQ7XHJcblxyXG4gICAgICAgIC8vIFRoaXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIGNhbGxlZCBieSAkYW5pbWF0ZSBzb1xyXG4gICAgICAgIC8vIHRoZXJlIGlzIG5vIG5lZWQgdG8gYXR0YWNoIHRoaXMgaW50ZXJuYWxseSB0byB0aGVcclxuICAgICAgICAvLyB0aW1lb3V0IGRvbmUgbWV0aG9kLlxyXG4gICAgICAgIGZ1bmN0aW9uIG9uRW5kKCkge1xyXG4gICAgICAgICAgZWxlbWVudC5vZmYoY3NzM0FuaW1hdGlvbkV2ZW50cywgb25BbmltYXRpb25Qcm9ncmVzcyk7XHJcbiAgICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBhY3RpdmVDbGFzc05hbWUpO1xyXG4gICAgICAgICAgJCRqcUxpdGUucmVtb3ZlQ2xhc3MoZWxlbWVudCwgcGVuZGluZ0NsYXNzTmFtZSk7XHJcbiAgICAgICAgICBpZiAoc3RhZ2dlclRpbWVvdXQpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHN0YWdnZXJUaW1lb3V0KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xyXG4gICAgICAgICAgdmFyIG5vZGUgPSBleHRyYWN0RWxlbWVudE5vZGUoZWxlbWVudCk7XHJcbiAgICAgICAgICBmb3IgKHZhciBpIGluIGFwcGxpZWRTdHlsZXMpIHtcclxuICAgICAgICAgICAgbm9kZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShhcHBsaWVkU3R5bGVzW2ldKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uQW5pbWF0aW9uUHJvZ3Jlc3MoZXZlbnQpIHtcclxuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgdmFyIGV2ID0gZXZlbnQub3JpZ2luYWxFdmVudCB8fCBldmVudDtcclxuICAgICAgICAgIHZhciB0aW1lU3RhbXAgPSBldi4kbWFudWFsVGltZVN0YW1wIHx8IGV2LnRpbWVTdGFtcCB8fCBEYXRlLm5vdygpO1xyXG5cclxuICAgICAgICAgIC8qIEZpcmVmb3ggKG9yIHBvc3NpYmx5IGp1c3QgR2Vja28pIGxpa2VzIHRvIG5vdCByb3VuZCB2YWx1ZXMgdXBcclxuICAgICAgICAgICAqIHdoZW4gYSBtcyBtZWFzdXJlbWVudCBpcyB1c2VkIGZvciB0aGUgYW5pbWF0aW9uICovXHJcbiAgICAgICAgICB2YXIgZWxhcHNlZFRpbWUgPSBwYXJzZUZsb2F0KGV2LmVsYXBzZWRUaW1lLnRvRml4ZWQoRUxBUFNFRF9USU1FX01BWF9ERUNJTUFMX1BMQUNFUykpO1xyXG5cclxuICAgICAgICAgIC8qICRtYW51YWxUaW1lU3RhbXAgaXMgYSBtb2NrZWQgdGltZVN0YW1wIHZhbHVlIHdoaWNoIGlzIHNldFxyXG4gICAgICAgICAgICogd2l0aGluIGJyb3dzZXJUcmlnZ2VyKCkuIFRoaXMgaXMgb25seSBoZXJlIHNvIHRoYXQgdGVzdHMgY2FuXHJcbiAgICAgICAgICAgKiBtb2NrIGFuaW1hdGlvbnMgcHJvcGVybHkuIFJlYWwgZXZlbnRzIGZhbGxiYWNrIHRvIGV2ZW50LnRpbWVTdGFtcCxcclxuICAgICAgICAgICAqIG9yLCBpZiB0aGV5IGRvbid0LCB0aGVuIGEgdGltZVN0YW1wIGlzIGF1dG9tYXRpY2FsbHkgY3JlYXRlZCBmb3IgdGhlbS5cclxuICAgICAgICAgICAqIFdlJ3JlIGNoZWNraW5nIHRvIHNlZSBpZiB0aGUgdGltZVN0YW1wIHN1cnBhc3NlcyB0aGUgZXhwZWN0ZWQgZGVsYXksXHJcbiAgICAgICAgICAgKiBidXQgd2UncmUgdXNpbmcgZWxhcHNlZFRpbWUgaW5zdGVhZCBvZiB0aGUgdGltZVN0YW1wIG9uIHRoZSAybmRcclxuICAgICAgICAgICAqIHByZS1jb25kaXRpb24gc2luY2UgYW5pbWF0aW9ucyBzb21ldGltZXMgY2xvc2Ugb2ZmIGVhcmx5ICovXHJcbiAgICAgICAgICBpZiAoTWF0aC5tYXgodGltZVN0YW1wIC0gc3RhcnRUaW1lLCAwKSA+PSBtYXhEZWxheVRpbWUgJiYgZWxhcHNlZFRpbWUgPj0gbWF4RHVyYXRpb24pIHtcclxuICAgICAgICAgICAgYWN0aXZlQW5pbWF0aW9uQ29tcGxldGUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGJsb2NrVHJhbnNpdGlvbnMobm9kZSwgYm9vbCkge1xyXG4gICAgICAgIG5vZGUuc3R5bGVbVFJBTlNJVElPTl9QUk9QICsgUFJPUEVSVFlfS0VZXSA9IGJvb2wgPyAnbm9uZScgOiAnJztcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYmxvY2tBbmltYXRpb25zKG5vZGUsIGJvb2wpIHtcclxuICAgICAgICBub2RlLnN0eWxlW0FOSU1BVElPTl9QUk9QICsgQU5JTUFUSU9OX1BMQVlTVEFURV9LRVldID0gYm9vbCA/ICdwYXVzZWQnIDogJyc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVCZWZvcmUoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgc3R5bGVzKSB7XHJcbiAgICAgICAgaWYgKGFuaW1hdGVTZXR1cChhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBzdHlsZXMpKSB7XHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oY2FuY2VsbGVkKSB7XHJcbiAgICAgICAgICAgIGNhbmNlbGxlZCAmJiBhbmltYXRlQ2xvc2UoZWxlbWVudCwgY2xhc3NOYW1lKTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBhbmltYXRlQWZ0ZXIoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZSwgc3R5bGVzKSB7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQuZGF0YShOR19BTklNQVRFX0NTU19EQVRBX0tFWSkpIHtcclxuICAgICAgICAgIHJldHVybiBhbmltYXRlUnVuKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFmdGVyQW5pbWF0aW9uQ29tcGxldGUsIHN0eWxlcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpO1xyXG4gICAgICAgICAgYWZ0ZXJBbmltYXRpb25Db21wbGV0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYW5pbWF0ZShhbmltYXRpb25FdmVudCwgZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZSwgb3B0aW9ucykge1xyXG4gICAgICAgIC8vSWYgdGhlIGFuaW1hdGVTZXR1cCBmdW5jdGlvbiBkb2Vzbid0IGJvdGhlciByZXR1cm5pbmcgYVxyXG4gICAgICAgIC8vY2FuY2VsbGF0aW9uIGZ1bmN0aW9uIHRoZW4gaXQgbWVhbnMgdGhhdCB0aGVyZSBpcyBubyBhbmltYXRpb25cclxuICAgICAgICAvL3RvIHBlcmZvcm0gYXQgYWxsXHJcbiAgICAgICAgdmFyIHByZVJlZmxvd0NhbmNlbGxhdGlvbiA9IGFuaW1hdGVCZWZvcmUoYW5pbWF0aW9uRXZlbnQsIGVsZW1lbnQsIGNsYXNzTmFtZSwgb3B0aW9ucy5mcm9tKTtcclxuICAgICAgICBpZiAoIXByZVJlZmxvd0NhbmNlbGxhdGlvbikge1xyXG4gICAgICAgICAgY2xlYXJDYWNoZUFmdGVyUmVmbG93KCk7XHJcbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZSgpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9UaGVyZSBhcmUgdHdvIGNhbmNlbGxhdGlvbiBmdW5jdGlvbnM6IG9uZSBpcyBiZWZvcmUgdGhlIGZpcnN0XHJcbiAgICAgICAgLy9yZWZsb3cgYW5pbWF0aW9uIGFuZCB0aGUgc2Vjb25kIGlzIGR1cmluZyB0aGUgYWN0aXZlIHN0YXRlXHJcbiAgICAgICAgLy9hbmltYXRpb24uIFRoZSBmaXJzdCBmdW5jdGlvbiB3aWxsIHRha2UgY2FyZSBvZiByZW1vdmluZyB0aGVcclxuICAgICAgICAvL2RhdGEgZnJvbSB0aGUgZWxlbWVudCB3aGljaCB3aWxsIG5vdCBtYWtlIHRoZSAybmQgYW5pbWF0aW9uXHJcbiAgICAgICAgLy9oYXBwZW4gaW4gdGhlIGZpcnN0IHBsYWNlXHJcbiAgICAgICAgdmFyIGNhbmNlbCA9IHByZVJlZmxvd0NhbmNlbGxhdGlvbjtcclxuICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIC8vb25jZSB0aGUgcmVmbG93IGlzIGNvbXBsZXRlIHRoZW4gd2UgcG9pbnQgY2FuY2VsIHRvXHJcbiAgICAgICAgICAvL3RoZSBuZXcgY2FuY2VsbGF0aW9uIGZ1bmN0aW9uIHdoaWNoIHdpbGwgcmVtb3ZlIGFsbCBvZiB0aGVcclxuICAgICAgICAgIC8vYW5pbWF0aW9uIHByb3BlcnRpZXMgZnJvbSB0aGUgYWN0aXZlIGFuaW1hdGlvblxyXG4gICAgICAgICAgY2FuY2VsID0gYW5pbWF0ZUFmdGVyKGFuaW1hdGlvbkV2ZW50LCBlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlLCBvcHRpb25zLnRvKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNhbmNlbGxlZCkge1xyXG4gICAgICAgICAgKGNhbmNlbCB8fCBub29wKShjYW5jZWxsZWQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGFuaW1hdGVDbG9zZShlbGVtZW50LCBjbGFzc05hbWUpIHtcclxuICAgICAgICAkJGpxTGl0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xyXG4gICAgICAgIHZhciBkYXRhID0gZWxlbWVudC5kYXRhKE5HX0FOSU1BVEVfQ1NTX0RBVEFfS0VZKTtcclxuICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgaWYgKGRhdGEucnVubmluZykge1xyXG4gICAgICAgICAgICBkYXRhLnJ1bm5pbmctLTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICghZGF0YS5ydW5uaW5nIHx8IGRhdGEucnVubmluZyA9PT0gMCkge1xyXG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZURhdGEoTkdfQU5JTUFURV9DU1NfREFUQV9LRVkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhbmltYXRlOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGZyb20sIHRvLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgICAgb3B0aW9ucy5mcm9tID0gZnJvbTtcclxuICAgICAgICAgIG9wdGlvbnMudG8gPSB0bztcclxuICAgICAgICAgIHJldHVybiBhbmltYXRlKCdhbmltYXRlJywgZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGVudGVyOiBmdW5jdGlvbihlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpIHtcclxuICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgICAgcmV0dXJuIGFuaW1hdGUoJ2VudGVyJywgZWxlbWVudCwgJ25nLWVudGVyJywgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBsZWF2ZTogZnVuY3Rpb24oZWxlbWVudCwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHJldHVybiBhbmltYXRlKCdsZWF2ZScsIGVsZW1lbnQsICduZy1sZWF2ZScsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbW92ZTogZnVuY3Rpb24oZWxlbWVudCwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHJldHVybiBhbmltYXRlKCdtb3ZlJywgZWxlbWVudCwgJ25nLW1vdmUnLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGJlZm9yZVNldENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBhZGQsIHJlbW92ZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBzdWZmaXhDbGFzc2VzKHJlbW92ZSwgJy1yZW1vdmUnKSArICcgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3VmZml4Q2xhc3NlcyhhZGQsICctYWRkJyk7XHJcbiAgICAgICAgICB2YXIgY2FuY2VsbGF0aW9uTWV0aG9kID0gYW5pbWF0ZUJlZm9yZSgnc2V0Q2xhc3MnLCBlbGVtZW50LCBjbGFzc05hbWUsIG9wdGlvbnMuZnJvbSk7XHJcbiAgICAgICAgICBpZiAoY2FuY2VsbGF0aW9uTWV0aG9kKSB7XHJcbiAgICAgICAgICAgIGFmdGVyUmVmbG93KGVsZW1lbnQsIGFuaW1hdGlvbkNvbXBsZXRlZCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjYW5jZWxsYXRpb25NZXRob2Q7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjbGVhckNhY2hlQWZ0ZXJSZWZsb3coKTtcclxuICAgICAgICAgIGFuaW1hdGlvbkNvbXBsZXRlZCgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGJlZm9yZUFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICB2YXIgY2FuY2VsbGF0aW9uTWV0aG9kID0gYW5pbWF0ZUJlZm9yZSgnYWRkQ2xhc3MnLCBlbGVtZW50LCBzdWZmaXhDbGFzc2VzKGNsYXNzTmFtZSwgJy1hZGQnKSwgb3B0aW9ucy5mcm9tKTtcclxuICAgICAgICAgIGlmIChjYW5jZWxsYXRpb25NZXRob2QpIHtcclxuICAgICAgICAgICAgYWZ0ZXJSZWZsb3coZWxlbWVudCwgYW5pbWF0aW9uQ29tcGxldGVkKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNhbmNlbGxhdGlvbk1ldGhvZDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNsZWFyQ2FjaGVBZnRlclJlZmxvdygpO1xyXG4gICAgICAgICAgYW5pbWF0aW9uQ29tcGxldGVkKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYmVmb3JlUmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgYW5pbWF0aW9uQ29tcGxldGVkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICAgIHZhciBjYW5jZWxsYXRpb25NZXRob2QgPSBhbmltYXRlQmVmb3JlKCdyZW1vdmVDbGFzcycsIGVsZW1lbnQsIHN1ZmZpeENsYXNzZXMoY2xhc3NOYW1lLCAnLXJlbW92ZScpLCBvcHRpb25zLmZyb20pO1xyXG4gICAgICAgICAgaWYgKGNhbmNlbGxhdGlvbk1ldGhvZCkge1xyXG4gICAgICAgICAgICBhZnRlclJlZmxvdyhlbGVtZW50LCBhbmltYXRpb25Db21wbGV0ZWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FuY2VsbGF0aW9uTWV0aG9kO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY2xlYXJDYWNoZUFmdGVyUmVmbG93KCk7XHJcbiAgICAgICAgICBhbmltYXRpb25Db21wbGV0ZWQoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgYWRkLCByZW1vdmUsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICByZW1vdmUgPSBzdWZmaXhDbGFzc2VzKHJlbW92ZSwgJy1yZW1vdmUnKTtcclxuICAgICAgICAgIGFkZCA9IHN1ZmZpeENsYXNzZXMoYWRkLCAnLWFkZCcpO1xyXG4gICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHJlbW92ZSArICcgJyArIGFkZDtcclxuICAgICAgICAgIHJldHVybiBhbmltYXRlQWZ0ZXIoJ3NldENsYXNzJywgZWxlbWVudCwgY2xhc3NOYW1lLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMudG8pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFkZENsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZUFmdGVyKCdhZGRDbGFzcycsIGVsZW1lbnQsIHN1ZmZpeENsYXNzZXMoY2xhc3NOYW1lLCAnLWFkZCcpLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMudG8pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUsIGFuaW1hdGlvbkNvbXBsZXRlZCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgICByZXR1cm4gYW5pbWF0ZUFmdGVyKCdyZW1vdmVDbGFzcycsIGVsZW1lbnQsIHN1ZmZpeENsYXNzZXMoY2xhc3NOYW1lLCAnLXJlbW92ZScpLCBhbmltYXRpb25Db21wbGV0ZWQsIG9wdGlvbnMudG8pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIHN1ZmZpeENsYXNzZXMoY2xhc3Nlcywgc3VmZml4KSB7XHJcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICcnO1xyXG4gICAgICAgIGNsYXNzZXMgPSBpc0FycmF5KGNsYXNzZXMpID8gY2xhc3NlcyA6IGNsYXNzZXMuc3BsaXQoL1xccysvKTtcclxuICAgICAgICBmb3JFYWNoKGNsYXNzZXMsIGZ1bmN0aW9uKGtsYXNzLCBpKSB7XHJcbiAgICAgICAgICBpZiAoa2xhc3MgJiYga2xhc3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjbGFzc05hbWUgKz0gKGkgPiAwID8gJyAnIDogJycpICsga2xhc3MgKyBzdWZmaXg7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNsYXNzTmFtZTtcclxuICAgICAgfVxyXG4gICAgfV0pO1xyXG4gIH1dKTtcclxuXHJcblxyXG59KSh3aW5kb3csIHdpbmRvdy5hbmd1bGFyKTtcclxuIiwiLyoqXHJcbiAqIEBsaWNlbnNlIEFuZ3VsYXJKUyB2MS4zLjExXHJcbiAqIChjKSAyMDEwLTIwMTQgR29vZ2xlLCBJbmMuIGh0dHA6Ly9hbmd1bGFyanMub3JnXHJcbiAqIExpY2Vuc2U6IE1JVFxyXG4gKi9cclxuKGZ1bmN0aW9uKHdpbmRvdywgYW5ndWxhciwgdW5kZWZpbmVkKSB7J3VzZSBzdHJpY3QnO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbmdBcmlhXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKlxyXG4gKiBUaGUgYG5nQXJpYWAgbW9kdWxlIHByb3ZpZGVzIHN1cHBvcnQgZm9yIGNvbW1vblxyXG4gKiBbPGFiYnIgdGl0bGU9XCJBY2Nlc3NpYmxlIFJpY2ggSW50ZXJuZXQgQXBwbGljYXRpb25zXCI+QVJJQTwvYWJicj5dKGh0dHA6Ly93d3cudzMub3JnL1RSL3dhaS1hcmlhLylcclxuICogYXR0cmlidXRlcyB0aGF0IGNvbnZleSBzdGF0ZSBvciBzZW1hbnRpYyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgYXBwbGljYXRpb24gZm9yIHVzZXJzXHJcbiAqIG9mIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMsIHN1Y2ggYXMgc2NyZWVuIHJlYWRlcnMuXHJcbiAqXHJcbiAqIDxkaXYgZG9jLW1vZHVsZS1jb21wb25lbnRzPVwibmdBcmlhXCI+PC9kaXY+XHJcbiAqXHJcbiAqICMjIFVzYWdlXHJcbiAqXHJcbiAqIEZvciBuZ0FyaWEgdG8gZG8gaXRzIG1hZ2ljLCBzaW1wbHkgaW5jbHVkZSB0aGUgbW9kdWxlIGFzIGEgZGVwZW5kZW5jeS4gVGhlIGRpcmVjdGl2ZXMgc3VwcG9ydGVkXHJcbiAqIGJ5IG5nQXJpYSBhcmU6XHJcbiAqIGBuZ01vZGVsYCwgYG5nRGlzYWJsZWRgLCBgbmdTaG93YCwgYG5nSGlkZWAsIGBuZ0NsaWNrYCwgYG5nRGJsQ2xpY2tgLCBhbmQgYG5nTWVzc2FnZXNgLlxyXG4gKlxyXG4gKiBCZWxvdyBpcyBhIG1vcmUgZGV0YWlsZWQgYnJlYWtkb3duIG9mIHRoZSBhdHRyaWJ1dGVzIGhhbmRsZWQgYnkgbmdBcmlhOlxyXG4gKlxyXG4gKiB8IERpcmVjdGl2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBTdXBwb3J0ZWQgQXR0cmlidXRlcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nTW9kZWwgbmdNb2RlbH0gICAgICAgIHwgYXJpYS1jaGVja2VkLCBhcmlhLXZhbHVlbWluLCBhcmlhLXZhbHVlbWF4LCBhcmlhLXZhbHVlbm93LCBhcmlhLWludmFsaWQsIGFyaWEtcmVxdWlyZWQgfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdEaXNhYmxlZCBuZ0Rpc2FibGVkfSAgfCBhcmlhLWRpc2FibGVkICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ1Nob3cgbmdTaG93fSAgICAgICAgICB8IGFyaWEtaGlkZGVuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbmcuZGlyZWN0aXZlOm5nSGlkZSBuZ0hpZGV9ICAgICAgICAgIHwgYXJpYS1oaWRkZW4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKiB8IHtAbGluayBuZy5kaXJlY3RpdmU6bmdDbGljayBuZ0NsaWNrfSAgICAgICAgfCB0YWJpbmRleCwga2V5cHJlc3MgZXZlbnQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqIHwge0BsaW5rIG5nLmRpcmVjdGl2ZTpuZ0RibGNsaWNrIG5nRGJsY2xpY2t9ICB8IHRhYmluZGV4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogfCB7QGxpbmsgbW9kdWxlOm5nTWVzc2FnZXMgbmdNZXNzYWdlc30gICAgICAgIHwgYXJpYS1saXZlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfFxyXG4gKlxyXG4gKiBGaW5kIG91dCBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGVhY2ggZGlyZWN0aXZlIGJ5IHJlYWRpbmcgdGhlXHJcbiAqIHtAbGluayBndWlkZS9hY2Nlc3NpYmlsaXR5IG5nQXJpYSBEZXZlbG9wZXIgR3VpZGV9LlxyXG4gKlxyXG4gKiAjI0V4YW1wbGVcclxuICogVXNpbmcgbmdEaXNhYmxlZCB3aXRoIG5nQXJpYTpcclxuICogYGBgaHRtbFxyXG4gKiA8bWQtY2hlY2tib3ggbmctZGlzYWJsZWQ9XCJkaXNhYmxlZFwiPlxyXG4gKiBgYGBcclxuICogQmVjb21lczpcclxuICogYGBgaHRtbFxyXG4gKiA8bWQtY2hlY2tib3ggbmctZGlzYWJsZWQ9XCJkaXNhYmxlZFwiIGFyaWEtZGlzYWJsZWQ9XCJ0cnVlXCI+XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiAjI0Rpc2FibGluZyBBdHRyaWJ1dGVzXHJcbiAqIEl0J3MgcG9zc2libGUgdG8gZGlzYWJsZSBpbmRpdmlkdWFsIGF0dHJpYnV0ZXMgYWRkZWQgYnkgbmdBcmlhIHdpdGggdGhlXHJcbiAqIHtAbGluayBuZ0FyaWEuJGFyaWFQcm92aWRlciNjb25maWcgY29uZmlnfSBtZXRob2QuIEZvciBtb3JlIGRldGFpbHMsIHNlZSB0aGVcclxuICoge0BsaW5rIGd1aWRlL2FjY2Vzc2liaWxpdHkgRGV2ZWxvcGVyIEd1aWRlfS5cclxuICovXHJcbiAvKiBnbG9iYWwgLW5nQXJpYU1vZHVsZSAqL1xyXG52YXIgbmdBcmlhTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ25nQXJpYScsIFsnbmcnXSkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVyKCckYXJpYScsICRBcmlhUHJvdmlkZXIpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBwcm92aWRlclxyXG4gKiBAbmFtZSAkYXJpYVByb3ZpZGVyXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKlxyXG4gKiBVc2VkIGZvciBjb25maWd1cmluZyB0aGUgQVJJQSBhdHRyaWJ1dGVzIGluamVjdGVkIGFuZCBtYW5hZ2VkIGJ5IG5nQXJpYS5cclxuICpcclxuICogYGBganNcclxuICogYW5ndWxhci5tb2R1bGUoJ215QXBwJywgWyduZ0FyaWEnXSwgZnVuY3Rpb24gY29uZmlnKCRhcmlhUHJvdmlkZXIpIHtcclxuICogICAkYXJpYVByb3ZpZGVyLmNvbmZpZyh7XHJcbiAqICAgICBhcmlhVmFsdWU6IHRydWUsXHJcbiAqICAgICB0YWJpbmRleDogZmFsc2VcclxuICogICB9KTtcclxuICogfSk7XHJcbiAqYGBgXHJcbiAqXHJcbiAqICMjIERlcGVuZGVuY2llc1xyXG4gKiBSZXF1aXJlcyB0aGUge0BsaW5rIG5nQXJpYX0gbW9kdWxlIHRvIGJlIGluc3RhbGxlZC5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uICRBcmlhUHJvdmlkZXIoKSB7XHJcbiAgdmFyIGNvbmZpZyA9IHtcclxuICAgIGFyaWFIaWRkZW46IHRydWUsXHJcbiAgICBhcmlhQ2hlY2tlZDogdHJ1ZSxcclxuICAgIGFyaWFEaXNhYmxlZDogdHJ1ZSxcclxuICAgIGFyaWFSZXF1aXJlZDogdHJ1ZSxcclxuICAgIGFyaWFJbnZhbGlkOiB0cnVlLFxyXG4gICAgYXJpYU11bHRpbGluZTogdHJ1ZSxcclxuICAgIGFyaWFWYWx1ZTogdHJ1ZSxcclxuICAgIHRhYmluZGV4OiB0cnVlLFxyXG4gICAgYmluZEtleXByZXNzOiB0cnVlXHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAqIEBuYW1lICRhcmlhUHJvdmlkZXIjY29uZmlnXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge29iamVjdH0gY29uZmlnIG9iamVjdCB0byBlbmFibGUvZGlzYWJsZSBzcGVjaWZpYyBBUklBIGF0dHJpYnV0ZXNcclxuICAgKlxyXG4gICAqICAtICoqYXJpYUhpZGRlbioqIOKAkyBge2Jvb2xlYW59YCDigJMgRW5hYmxlcy9kaXNhYmxlcyBhcmlhLWhpZGRlbiB0YWdzXHJcbiAgICogIC0gKiphcmlhQ2hlY2tlZCoqIOKAkyBge2Jvb2xlYW59YCDigJMgRW5hYmxlcy9kaXNhYmxlcyBhcmlhLWNoZWNrZWQgdGFnc1xyXG4gICAqICAtICoqYXJpYURpc2FibGVkKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtZGlzYWJsZWQgdGFnc1xyXG4gICAqICAtICoqYXJpYVJlcXVpcmVkKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtcmVxdWlyZWQgdGFnc1xyXG4gICAqICAtICoqYXJpYUludmFsaWQqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgYXJpYS1pbnZhbGlkIHRhZ3NcclxuICAgKiAgLSAqKmFyaWFNdWx0aWxpbmUqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgYXJpYS1tdWx0aWxpbmUgdGFnc1xyXG4gICAqICAtICoqYXJpYVZhbHVlKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGFyaWEtdmFsdWVtaW4sIGFyaWEtdmFsdWVtYXggYW5kIGFyaWEtdmFsdWVub3cgdGFnc1xyXG4gICAqICAtICoqdGFiaW5kZXgqKiDigJMgYHtib29sZWFufWAg4oCTIEVuYWJsZXMvZGlzYWJsZXMgdGFiaW5kZXggdGFnc1xyXG4gICAqICAtICoqYmluZEtleXByZXNzKiog4oCTIGB7Ym9vbGVhbn1gIOKAkyBFbmFibGVzL2Rpc2FibGVzIGtleXByZXNzIGV2ZW50IGJpbmRpbmcgb24gbmctY2xpY2tcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIEVuYWJsZXMvZGlzYWJsZXMgdmFyaW91cyBBUklBIGF0dHJpYnV0ZXNcclxuICAgKi9cclxuICB0aGlzLmNvbmZpZyA9IGZ1bmN0aW9uKG5ld0NvbmZpZykge1xyXG4gICAgY29uZmlnID0gYW5ndWxhci5leHRlbmQoY29uZmlnLCBuZXdDb25maWcpO1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHdhdGNoRXhwcihhdHRyTmFtZSwgYXJpYUF0dHIsIG5lZ2F0ZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKSB7XHJcbiAgICAgIHZhciBhcmlhQ2FtZWxOYW1lID0gYXR0ci4kbm9ybWFsaXplKGFyaWFBdHRyKTtcclxuICAgICAgaWYgKGNvbmZpZ1thcmlhQ2FtZWxOYW1lXSAmJiAhYXR0clthcmlhQ2FtZWxOYW1lXSkge1xyXG4gICAgICAgIHNjb3BlLiR3YXRjaChhdHRyW2F0dHJOYW1lXSwgZnVuY3Rpb24oYm9vbFZhbCkge1xyXG4gICAgICAgICAgaWYgKG5lZ2F0ZSkge1xyXG4gICAgICAgICAgICBib29sVmFsID0gIWJvb2xWYWw7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbGVtLmF0dHIoYXJpYUF0dHIsIGJvb2xWYWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgKiBAbmFtZSAkYXJpYVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICpcclxuICAgKiBUaGUgJGFyaWEgc2VydmljZSBjb250YWlucyBoZWxwZXIgbWV0aG9kcyBmb3IgYXBwbHlpbmcgY29tbW9uXHJcbiAgICogW0FSSUFdKGh0dHA6Ly93d3cudzMub3JnL1RSL3dhaS1hcmlhLykgYXR0cmlidXRlcyB0byBIVE1MIGRpcmVjdGl2ZXMuXHJcbiAgICpcclxuICAgKiBuZ0FyaWEgaW5qZWN0cyBjb21tb24gYWNjZXNzaWJpbGl0eSBhdHRyaWJ1dGVzIHRoYXQgdGVsbCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzIHdoZW4gSFRNTFxyXG4gICAqIGVsZW1lbnRzIGFyZSBlbmFibGVkLCBzZWxlY3RlZCwgaGlkZGVuLCBhbmQgbW9yZS4gVG8gc2VlIGhvdyB0aGlzIGlzIHBlcmZvcm1lZCB3aXRoIG5nQXJpYSxcclxuICAgKiBsZXQncyByZXZpZXcgYSBjb2RlIHNuaXBwZXQgZnJvbSBuZ0FyaWEgaXRzZWxmOlxyXG4gICAqXHJcbiAgICpgYGBqc1xyXG4gICAqIG5nQXJpYU1vZHVsZS5kaXJlY3RpdmUoJ25nRGlzYWJsZWQnLCBbJyRhcmlhJywgZnVuY3Rpb24oJGFyaWEpIHtcclxuICAgKiAgIHJldHVybiAkYXJpYS4kJHdhdGNoRXhwcignbmdEaXNhYmxlZCcsICdhcmlhLWRpc2FibGVkJyk7XHJcbiAgICogfV0pXHJcbiAgICpgYGBcclxuICAgKiBTaG93biBhYm92ZSwgdGhlIG5nQXJpYSBtb2R1bGUgY3JlYXRlcyBhIGRpcmVjdGl2ZSB3aXRoIHRoZSBzYW1lIHNpZ25hdHVyZSBhcyB0aGVcclxuICAgKiB0cmFkaXRpb25hbCBgbmctZGlzYWJsZWRgIGRpcmVjdGl2ZS4gQnV0IHRoaXMgbmdBcmlhIHZlcnNpb24gaXMgZGVkaWNhdGVkIHRvXHJcbiAgICogc29sZWx5IG1hbmFnaW5nIGFjY2Vzc2liaWxpdHkgYXR0cmlidXRlcy4gVGhlIGludGVybmFsIGAkYXJpYWAgc2VydmljZSBpcyB1c2VkIHRvIHdhdGNoIHRoZVxyXG4gICAqIGJvb2xlYW4gYXR0cmlidXRlIGBuZ0Rpc2FibGVkYC4gSWYgaXQgaGFzIG5vdCBiZWVuIGV4cGxpY2l0bHkgc2V0IGJ5IHRoZSBkZXZlbG9wZXIsXHJcbiAgICogYGFyaWEtZGlzYWJsZWRgIGlzIGluamVjdGVkIGFzIGFuIGF0dHJpYnV0ZSB3aXRoIGl0cyB2YWx1ZSBzeW5jaHJvbml6ZWQgdG8gdGhlIHZhbHVlIGluXHJcbiAgICogYG5nRGlzYWJsZWRgLlxyXG4gICAqXHJcbiAgICogQmVjYXVzZSBuZ0FyaWEgaG9va3MgaW50byB0aGUgYG5nLWRpc2FibGVkYCBkaXJlY3RpdmUsIGRldmVsb3BlcnMgZG8gbm90IGhhdmUgdG8gZG9cclxuICAgKiBhbnl0aGluZyB0byBlbmFibGUgdGhpcyBmZWF0dXJlLiBUaGUgYGFyaWEtZGlzYWJsZWRgIGF0dHJpYnV0ZSBpcyBhdXRvbWF0aWNhbGx5IG1hbmFnZWRcclxuICAgKiBzaW1wbHkgYXMgYSBzaWxlbnQgc2lkZS1lZmZlY3Qgb2YgdXNpbmcgYG5nLWRpc2FibGVkYCB3aXRoIHRoZSBuZ0FyaWEgbW9kdWxlLlxyXG4gICAqXHJcbiAgICogVGhlIGZ1bGwgbGlzdCBvZiBkaXJlY3RpdmVzIHRoYXQgaW50ZXJmYWNlIHdpdGggbmdBcmlhOlxyXG4gICAqICogKipuZ01vZGVsKipcclxuICAgKiAqICoqbmdTaG93KipcclxuICAgKiAqICoqbmdIaWRlKipcclxuICAgKiAqICoqbmdDbGljayoqXHJcbiAgICogKiAqKm5nRGJsY2xpY2sqKlxyXG4gICAqICogKipuZ01lc3NhZ2VzKipcclxuICAgKiAqICoqbmdEaXNhYmxlZCoqXHJcbiAgICpcclxuICAgKiBSZWFkIHRoZSB7QGxpbmsgZ3VpZGUvYWNjZXNzaWJpbGl0eSBuZ0FyaWEgRGV2ZWxvcGVyIEd1aWRlfSBmb3IgYSB0aG9yb3VnaCBleHBsYW5hdGlvbiBvZiBlYWNoXHJcbiAgICogZGlyZWN0aXZlLlxyXG4gICAqXHJcbiAgICpcclxuICAgKiAjIyBEZXBlbmRlbmNpZXNcclxuICAgKiBSZXF1aXJlcyB0aGUge0BsaW5rIG5nQXJpYX0gbW9kdWxlIHRvIGJlIGluc3RhbGxlZC5cclxuICAgKi9cclxuICB0aGlzLiRnZXQgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvbmZpZzogZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbmZpZ1trZXldO1xyXG4gICAgICB9LFxyXG4gICAgICAkJHdhdGNoRXhwcjogd2F0Y2hFeHByXHJcbiAgICB9O1xyXG4gIH07XHJcbn1cclxuXHJcblxyXG5uZ0FyaWFNb2R1bGUuZGlyZWN0aXZlKCduZ1Nob3cnLCBbJyRhcmlhJywgZnVuY3Rpb24oJGFyaWEpIHtcclxuICByZXR1cm4gJGFyaWEuJCR3YXRjaEV4cHIoJ25nU2hvdycsICdhcmlhLWhpZGRlbicsIHRydWUpO1xyXG59XSlcclxuLmRpcmVjdGl2ZSgnbmdIaWRlJywgWyckYXJpYScsIGZ1bmN0aW9uKCRhcmlhKSB7XHJcbiAgcmV0dXJuICRhcmlhLiQkd2F0Y2hFeHByKCduZ0hpZGUnLCAnYXJpYS1oaWRkZW4nLCBmYWxzZSk7XHJcbn1dKVxyXG4uZGlyZWN0aXZlKCduZ01vZGVsJywgWyckYXJpYScsIGZ1bmN0aW9uKCRhcmlhKSB7XHJcblxyXG4gIGZ1bmN0aW9uIHNob3VsZEF0dGFjaEF0dHIoYXR0ciwgbm9ybWFsaXplZEF0dHIsIGVsZW0pIHtcclxuICAgIHJldHVybiAkYXJpYS5jb25maWcobm9ybWFsaXplZEF0dHIpICYmICFlbGVtLmF0dHIoYXR0cik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRTaGFwZShhdHRyLCBlbGVtKSB7XHJcbiAgICB2YXIgdHlwZSA9IGF0dHIudHlwZSxcclxuICAgICAgICByb2xlID0gYXR0ci5yb2xlO1xyXG5cclxuICAgIHJldHVybiAoKHR5cGUgfHwgcm9sZSkgPT09ICdjaGVja2JveCcgfHwgcm9sZSA9PT0gJ21lbnVpdGVtY2hlY2tib3gnKSA/ICdjaGVja2JveCcgOlxyXG4gICAgICAgICAgICgodHlwZSB8fCByb2xlKSA9PT0gJ3JhZGlvJyAgICB8fCByb2xlID09PSAnbWVudWl0ZW1yYWRpbycpID8gJ3JhZGlvJyA6XHJcbiAgICAgICAgICAgKHR5cGUgPT09ICdyYW5nZScgICAgICAgICAgICAgIHx8IHJvbGUgPT09ICdwcm9ncmVzc2JhcicgfHwgcm9sZSA9PT0gJ3NsaWRlcicpID8gJ3JhbmdlJyA6XHJcbiAgICAgICAgICAgKHR5cGUgfHwgcm9sZSkgPT09ICd0ZXh0Ym94JyAgIHx8IGVsZW1bMF0ubm9kZU5hbWUgPT09ICdURVhUQVJFQScgPyAnbXVsdGlsaW5lJyA6ICcnO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxyXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIsIG5nTW9kZWwpIHtcclxuICAgICAgdmFyIHNoYXBlID0gZ2V0U2hhcGUoYXR0ciwgZWxlbSk7XHJcbiAgICAgIHZhciBuZWVkc1RhYkluZGV4ID0gc2hvdWxkQXR0YWNoQXR0cigndGFiaW5kZXgnLCAndGFiaW5kZXgnLCBlbGVtKTtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIG5nQXJpYVdhdGNoTW9kZWxWYWx1ZSgpIHtcclxuICAgICAgICByZXR1cm4gbmdNb2RlbC4kbW9kZWxWYWx1ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0UmFkaW9SZWFjdGlvbigpIHtcclxuICAgICAgICBpZiAobmVlZHNUYWJJbmRleCkge1xyXG4gICAgICAgICAgbmVlZHNUYWJJbmRleCA9IGZhbHNlO1xyXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5nQXJpYVJhZGlvUmVhY3Rpb24obmV3VmFsKSB7XHJcbiAgICAgICAgICAgIHZhciBib29sVmFsID0gbmV3VmFsID09PSBhdHRyLnZhbHVlO1xyXG4gICAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtY2hlY2tlZCcsIGJvb2xWYWwpO1xyXG4gICAgICAgICAgICBlbGVtLmF0dHIoJ3RhYmluZGV4JywgMCAtICFib29sVmFsKTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBuZ0FyaWFSYWRpb1JlYWN0aW9uKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtY2hlY2tlZCcsIG5ld1ZhbCA9PT0gYXR0ci52YWx1ZSk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gbmdBcmlhQ2hlY2tib3hSZWFjdGlvbihuZXdWYWwpIHtcclxuICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtY2hlY2tlZCcsICEhbmV3VmFsKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgc3dpdGNoIChzaGFwZSkge1xyXG4gICAgICAgIGNhc2UgJ3JhZGlvJzpcclxuICAgICAgICBjYXNlICdjaGVja2JveCc6XHJcbiAgICAgICAgICBpZiAoc2hvdWxkQXR0YWNoQXR0cignYXJpYS1jaGVja2VkJywgJ2FyaWFDaGVja2VkJywgZWxlbSkpIHtcclxuICAgICAgICAgICAgc2NvcGUuJHdhdGNoKG5nQXJpYVdhdGNoTW9kZWxWYWx1ZSwgc2hhcGUgPT09ICdyYWRpbycgP1xyXG4gICAgICAgICAgICAgICAgZ2V0UmFkaW9SZWFjdGlvbigpIDogbmdBcmlhQ2hlY2tib3hSZWFjdGlvbik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdyYW5nZSc6XHJcbiAgICAgICAgICBpZiAoJGFyaWEuY29uZmlnKCdhcmlhVmFsdWUnKSkge1xyXG4gICAgICAgICAgICBpZiAoYXR0ci5taW4gJiYgIWVsZW0uYXR0cignYXJpYS12YWx1ZW1pbicpKSB7XHJcbiAgICAgICAgICAgICAgZWxlbS5hdHRyKCdhcmlhLXZhbHVlbWluJywgYXR0ci5taW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhdHRyLm1heCAmJiAhZWxlbS5hdHRyKCdhcmlhLXZhbHVlbWF4JykpIHtcclxuICAgICAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtdmFsdWVtYXgnLCBhdHRyLm1heCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFlbGVtLmF0dHIoJ2FyaWEtdmFsdWVub3cnKSkge1xyXG4gICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChuZ0FyaWFXYXRjaE1vZGVsVmFsdWUsIGZ1bmN0aW9uIG5nQXJpYVZhbHVlTm93UmVhY3Rpb24obmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtdmFsdWVub3cnLCBuZXdWYWwpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdtdWx0aWxpbmUnOlxyXG4gICAgICAgICAgaWYgKHNob3VsZEF0dGFjaEF0dHIoJ2FyaWEtbXVsdGlsaW5lJywgJ2FyaWFNdWx0aWxpbmUnLCBlbGVtKSkge1xyXG4gICAgICAgICAgICBlbGVtLmF0dHIoJ2FyaWEtbXVsdGlsaW5lJywgdHJ1ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKG5lZWRzVGFiSW5kZXgpIHtcclxuICAgICAgICBlbGVtLmF0dHIoJ3RhYmluZGV4JywgMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChuZ01vZGVsLiR2YWxpZGF0b3JzLnJlcXVpcmVkICYmIHNob3VsZEF0dGFjaEF0dHIoJ2FyaWEtcmVxdWlyZWQnLCAnYXJpYVJlcXVpcmVkJywgZWxlbSkpIHtcclxuICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gbmdBcmlhUmVxdWlyZWRXYXRjaCgpIHtcclxuICAgICAgICAgIHJldHVybiBuZ01vZGVsLiRlcnJvci5yZXF1aXJlZDtcclxuICAgICAgICB9LCBmdW5jdGlvbiBuZ0FyaWFSZXF1aXJlZFJlYWN0aW9uKG5ld1ZhbCkge1xyXG4gICAgICAgICAgZWxlbS5hdHRyKCdhcmlhLXJlcXVpcmVkJywgISFuZXdWYWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoc2hvdWxkQXR0YWNoQXR0cignYXJpYS1pbnZhbGlkJywgJ2FyaWFJbnZhbGlkJywgZWxlbSkpIHtcclxuICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gbmdBcmlhSW52YWxpZFdhdGNoKCkge1xyXG4gICAgICAgICAgcmV0dXJuIG5nTW9kZWwuJGludmFsaWQ7XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gbmdBcmlhSW52YWxpZFJlYWN0aW9uKG5ld1ZhbCkge1xyXG4gICAgICAgICAgZWxlbS5hdHRyKCdhcmlhLWludmFsaWQnLCAhIW5ld1ZhbCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG59XSlcclxuLmRpcmVjdGl2ZSgnbmdEaXNhYmxlZCcsIFsnJGFyaWEnLCBmdW5jdGlvbigkYXJpYSkge1xyXG4gIHJldHVybiAkYXJpYS4kJHdhdGNoRXhwcignbmdEaXNhYmxlZCcsICdhcmlhLWRpc2FibGVkJyk7XHJcbn1dKVxyXG4uZGlyZWN0aXZlKCduZ01lc3NhZ2VzJywgZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICByZXF1aXJlOiAnP25nTWVzc2FnZXMnLFxyXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIsIG5nTWVzc2FnZXMpIHtcclxuICAgICAgaWYgKCFlbGVtLmF0dHIoJ2FyaWEtbGl2ZScpKSB7XHJcbiAgICAgICAgZWxlbS5hdHRyKCdhcmlhLWxpdmUnLCAnYXNzZXJ0aXZlJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG59KVxyXG4uZGlyZWN0aXZlKCduZ0NsaWNrJyxbJyRhcmlhJywgJyRwYXJzZScsIGZ1bmN0aW9uKCRhcmlhLCAkcGFyc2UpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIGNvbXBpbGU6IGZ1bmN0aW9uKGVsZW0sIGF0dHIpIHtcclxuICAgICAgdmFyIGZuID0gJHBhcnNlKGF0dHIubmdDbGljaywgLyogaW50ZXJjZXB0b3JGbiAqLyBudWxsLCAvKiBleHBlbnNpdmVDaGVja3MgKi8gdHJ1ZSk7XHJcbiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cikge1xyXG4gICAgICAgIGlmICgkYXJpYS5jb25maWcoJ3RhYmluZGV4JykgJiYgIWVsZW0uYXR0cigndGFiaW5kZXgnKSkge1xyXG4gICAgICAgICAgZWxlbS5hdHRyKCd0YWJpbmRleCcsIDApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCRhcmlhLmNvbmZpZygnYmluZEtleXByZXNzJykgJiYgIWF0dHIubmdLZXlwcmVzcykge1xyXG4gICAgICAgICAgZWxlbS5vbigna2V5cHJlc3MnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzIgfHwgZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcclxuICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoY2FsbGJhY2spO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBjYWxsYmFjaygpIHtcclxuICAgICAgICAgICAgICBmbihzY29wZSwgeyAkZXZlbnQ6IGV2ZW50IH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfTtcclxufV0pXHJcbi5kaXJlY3RpdmUoJ25nRGJsY2xpY2snLCBbJyRhcmlhJywgZnVuY3Rpb24oJGFyaWEpIHtcclxuICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpIHtcclxuICAgIGlmICgkYXJpYS5jb25maWcoJ3RhYmluZGV4JykgJiYgIWVsZW0uYXR0cigndGFiaW5kZXgnKSkge1xyXG4gICAgICBlbGVtLmF0dHIoJ3RhYmluZGV4JywgMCk7XHJcbiAgICB9XHJcbiAgfTtcclxufV0pO1xyXG5cclxuXHJcbn0pKHdpbmRvdywgd2luZG93LmFuZ3VsYXIpO1xyXG4iLCIvKiFcclxuICogQW5ndWxhciBNYXRlcmlhbCBEZXNpZ25cclxuICogaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvbWF0ZXJpYWxcclxuICogQGxpY2Vuc2UgTUlUXHJcbiAqIHYwLjEwLjAtbWFzdGVyLTZlOWFiZGRcclxuICovXHJcbihmdW5jdGlvbiggd2luZG93LCBhbmd1bGFyLCB1bmRlZmluZWQgKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbmdNYXRlcmlhbCcsIFtcIm5nXCIsXCJuZ0FuaW1hdGVcIixcIm5nQXJpYVwiLFwibWF0ZXJpYWwuY29yZVwiLFwibWF0ZXJpYWwuY29yZS5nZXN0dXJlc1wiLFwibWF0ZXJpYWwuY29yZS50aGVtaW5nLnBhbGV0dGVcIixcIm1hdGVyaWFsLmNvcmUudGhlbWluZ1wiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGVcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3BcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuYm90dG9tU2hlZXRcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuYnV0dG9uXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmNhcmRcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuY2hlY2tib3hcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHNcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuY29udGVudFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5kaWFsb2dcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuZGl2aWRlclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5mYWJBY3Rpb25zXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmZhYlNwZWVkRGlhbFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUb29sYmFyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLmZhYlRyaWdnZXJcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuZ3JpZExpc3RcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5pbnB1dFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5saXN0XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLm1lbnVcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NDaXJjdWxhclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5wcm9ncmVzc0xpbmVhclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5yYWRpb0J1dHRvblwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zZWxlY3RcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdlwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zbGlkZXJcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMuc3RpY2t5XCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnN1YmhlYWRlclwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zd2lwZVwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy5zd2l0Y2hcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMudGFic1wiLFwibWF0ZXJpYWwuY29tcG9uZW50cy50b2FzdFwiLFwibWF0ZXJpYWwuY29tcG9uZW50cy50b29sYmFyXCIsXCJtYXRlcmlhbC5jb21wb25lbnRzLnRvb2x0aXBcIixcIm1hdGVyaWFsLmNvbXBvbmVudHMud2hpdGVmcmFtZVwiXSk7XHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6YXRpb24gZnVuY3Rpb24gdGhhdCB2YWxpZGF0ZXMgZW52aXJvbm1lbnRcclxuICogcmVxdWlyZW1lbnRzLlxyXG4gKi9cclxuYW5ndWxhclxyXG4gIC5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnLCBbICdtYXRlcmlhbC5jb3JlLmdlc3R1cmVzJywgJ21hdGVyaWFsLmNvcmUudGhlbWluZycgXSlcclxuICAuY29uZmlnKCBNZENvcmVDb25maWd1cmUgKTtcclxuXHJcblxyXG5mdW5jdGlvbiBNZENvcmVDb25maWd1cmUoJHByb3ZpZGUsICRtZFRoZW1pbmdQcm92aWRlcikge1xyXG5cclxuICAkcHJvdmlkZS5kZWNvcmF0b3IoJyQkckFGJywgW1wiJGRlbGVnYXRlXCIsIHJBRkRlY29yYXRvcl0pO1xyXG5cclxuICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxyXG4gICAgLnByaW1hcnlQYWxldHRlKCdpbmRpZ28nKVxyXG4gICAgLmFjY2VudFBhbGV0dGUoJ3BpbmsnKVxyXG4gICAgLndhcm5QYWxldHRlKCdyZWQnKVxyXG4gICAgLmJhY2tncm91bmRQYWxldHRlKCdncmV5Jyk7XHJcbn1cclxuTWRDb3JlQ29uZmlndXJlLiRpbmplY3QgPSBbXCIkcHJvdmlkZVwiLCBcIiRtZFRoZW1pbmdQcm92aWRlclwiXTtcclxuXHJcbmZ1bmN0aW9uIHJBRkRlY29yYXRvciggJGRlbGVnYXRlICkge1xyXG4gIC8qKlxyXG4gICAqIFVzZSB0aGlzIHRvIHRocm90dGxlIGV2ZW50cyB0aGF0IGNvbWUgaW4gb2Z0ZW4uXHJcbiAgICogVGhlIHRocm90dGxlZCBmdW5jdGlvbiB3aWxsIGFsd2F5cyB1c2UgdGhlICpsYXN0KiBpbnZvY2F0aW9uIGJlZm9yZSB0aGVcclxuICAgKiBjb21pbmcgZnJhbWUuXHJcbiAgICpcclxuICAgKiBGb3IgZXhhbXBsZSwgd2luZG93IHJlc2l6ZSBldmVudHMgdGhhdCBmaXJlIG1hbnkgdGltZXMgYSBzZWNvbmQ6XHJcbiAgICogSWYgd2Ugc2V0IHRvIHVzZSBhbiByYWYtdGhyb3R0bGVkIGNhbGxiYWNrIG9uIHdpbmRvdyByZXNpemUsIHRoZW5cclxuICAgKiBvdXIgY2FsbGJhY2sgd2lsbCBvbmx5IGJlIGZpcmVkIG9uY2UgcGVyIGZyYW1lLCB3aXRoIHRoZSBsYXN0IHJlc2l6ZVxyXG4gICAqIGV2ZW50IHRoYXQgaGFwcGVuZWQgYmVmb3JlIHRoYXQgZnJhbWUuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayBmdW5jdGlvbiB0byBkZWJvdW5jZVxyXG4gICAqL1xyXG4gICRkZWxlZ2F0ZS50aHJvdHRsZSA9IGZ1bmN0aW9uKGNiKSB7XHJcbiAgICB2YXIgcXVldWVBcmdzLCBhbHJlYWR5UXVldWVkLCBxdWV1ZUNiLCBjb250ZXh0O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGRlYm91bmNlZCgpIHtcclxuICAgICAgcXVldWVBcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICBjb250ZXh0ID0gdGhpcztcclxuICAgICAgcXVldWVDYiA9IGNiO1xyXG4gICAgICBpZiAoIWFscmVhZHlRdWV1ZWQpIHtcclxuICAgICAgICBhbHJlYWR5UXVldWVkID0gdHJ1ZTtcclxuICAgICAgICAkZGVsZWdhdGUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBxdWV1ZUNiLmFwcGx5KGNvbnRleHQsIHF1ZXVlQXJncyk7XHJcbiAgICAgICAgICBhbHJlYWR5UXVldWVkID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfTtcclxuICByZXR1cm4gJGRlbGVnYXRlO1xyXG59XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXHJcbi5mYWN0b3J5KCckbWRDb25zdGFudCcsIE1kQ29uc3RhbnRGYWN0b3J5KTtcclxuXHJcbmZ1bmN0aW9uIE1kQ29uc3RhbnRGYWN0b3J5KCQkckFGLCAkc25pZmZlcikge1xyXG5cclxuICB2YXIgd2Via2l0ID0gL3dlYmtpdC9pLnRlc3QoJHNuaWZmZXIudmVuZG9yUHJlZml4KTtcclxuICBmdW5jdGlvbiB2ZW5kb3JQcm9wZXJ0eShuYW1lKSB7XHJcbiAgICByZXR1cm4gd2Via2l0ID8gICgnd2Via2l0JyArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnN1YnN0cmluZygxKSkgOiBuYW1lO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIEtFWV9DT0RFOiB7XHJcbiAgICAgIEVOVEVSOiAxMyxcclxuICAgICAgRVNDQVBFOiAyNyxcclxuICAgICAgU1BBQ0U6IDMyLFxyXG4gICAgICBMRUZUX0FSUk9XIDogMzcsXHJcbiAgICAgIFVQX0FSUk9XIDogMzgsXHJcbiAgICAgIFJJR0hUX0FSUk9XIDogMzksXHJcbiAgICAgIERPV05fQVJST1cgOiA0MCxcclxuICAgICAgVEFCIDogOSxcclxuICAgICAgQkFDS1NQQUNFOiA4LFxyXG4gICAgICBERUxFVEU6IDQ2XHJcbiAgICB9LFxyXG4gICAgQ1NTOiB7XHJcbiAgICAgIC8qIENvbnN0YW50cyAqL1xyXG4gICAgICBUUkFOU0lUSU9ORU5EOiAndHJhbnNpdGlvbmVuZCcgKyAod2Via2l0ID8gJyB3ZWJraXRUcmFuc2l0aW9uRW5kJyA6ICcnKSxcclxuICAgICAgQU5JTUFUSU9ORU5EOiAnYW5pbWF0aW9uZW5kJyArICh3ZWJraXQgPyAnIHdlYmtpdEFuaW1hdGlvbkVuZCcgOiAnJyksXHJcblxyXG4gICAgICBUUkFOU0ZPUk06IHZlbmRvclByb3BlcnR5KCd0cmFuc2Zvcm0nKSxcclxuICAgICAgVFJBTlNGT1JNX09SSUdJTjogdmVuZG9yUHJvcGVydHkoJ3RyYW5zZm9ybU9yaWdpbicpLFxyXG4gICAgICBUUkFOU0lUSU9OOiB2ZW5kb3JQcm9wZXJ0eSgndHJhbnNpdGlvbicpLFxyXG4gICAgICBUUkFOU0lUSU9OX0RVUkFUSU9OOiB2ZW5kb3JQcm9wZXJ0eSgndHJhbnNpdGlvbkR1cmF0aW9uJyksXHJcbiAgICAgIEFOSU1BVElPTl9QTEFZX1NUQVRFOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uUGxheVN0YXRlJyksXHJcbiAgICAgIEFOSU1BVElPTl9EVVJBVElPTjogdmVuZG9yUHJvcGVydHkoJ2FuaW1hdGlvbkR1cmF0aW9uJyksXHJcbiAgICAgIEFOSU1BVElPTl9OQU1FOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uTmFtZScpLFxyXG4gICAgICBBTklNQVRJT05fVElNSU5HOiB2ZW5kb3JQcm9wZXJ0eSgnYW5pbWF0aW9uVGltaW5nRnVuY3Rpb24nKSxcclxuICAgICAgQU5JTUFUSU9OX0RJUkVDVElPTjogdmVuZG9yUHJvcGVydHkoJ2FuaW1hdGlvbkRpcmVjdGlvbicpXHJcbiAgICB9LFxyXG4gICAgTUVESUE6IHtcclxuICAgICAgJ3NtJzogJyhtYXgtd2lkdGg6IDYwMHB4KScsXHJcbiAgICAgICdndC1zbSc6ICcobWluLXdpZHRoOiA2MDBweCknLFxyXG4gICAgICAnbWQnOiAnKG1pbi13aWR0aDogNjAwcHgpIGFuZCAobWF4LXdpZHRoOiA5NjBweCknLFxyXG4gICAgICAnZ3QtbWQnOiAnKG1pbi13aWR0aDogOTYwcHgpJyxcclxuICAgICAgJ2xnJzogJyhtaW4td2lkdGg6IDk2MHB4KSBhbmQgKG1heC13aWR0aDogMTIwMHB4KScsXHJcbiAgICAgICdndC1sZyc6ICcobWluLXdpZHRoOiAxMjAwcHgpJ1xyXG4gICAgfSxcclxuICAgIE1FRElBX1BSSU9SSVRZOiBbXHJcbiAgICAgICdndC1sZycsXHJcbiAgICAgICdsZycsXHJcbiAgICAgICdndC1tZCcsXHJcbiAgICAgICdtZCcsXHJcbiAgICAgICdndC1zbScsXHJcbiAgICAgICdzbSdcclxuICAgIF1cclxuICB9O1xyXG59XHJcbk1kQ29uc3RhbnRGYWN0b3J5LiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRzbmlmZmVyXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAgIC5jb25maWcoIFtcIiRwcm92aWRlXCIsIGZ1bmN0aW9uKCRwcm92aWRlKXtcclxuICAgICAgICRwcm92aWRlLmRlY29yYXRvcignJG1kVXRpbCcsIFsnJGRlbGVnYXRlJywgZnVuY3Rpb24gKCRkZWxlZ2F0ZSl7XHJcbiAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICogSW5qZWN0IHRoZSBpdGVyYXRvciBmYWNhZGUgdG8gZWFzaWx5IHN1cHBvcnQgaXRlcmF0aW9uIGFuZCBhY2Nlc3NvcnNcclxuICAgICAgICAgICAgKiBAc2VlIGl0ZXJhdG9yIGJlbG93XHJcbiAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgJGRlbGVnYXRlLml0ZXJhdG9yID0gTWRJdGVyYXRvcjtcclxuXHJcbiAgICAgICAgICAgcmV0dXJuICRkZWxlZ2F0ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgXSk7XHJcbiAgICAgfV0pO1xyXG5cclxuICAvKipcclxuICAgKiBpdGVyYXRvciBpcyBhIGxpc3QgZmFjYWRlIHRvIGVhc2lseSBzdXBwb3J0IGl0ZXJhdGlvbiBhbmQgYWNjZXNzb3JzXHJcbiAgICpcclxuICAgKiBAcGFyYW0gaXRlbXMgQXJyYXkgbGlzdCB3aGljaCB0aGlzIGl0ZXJhdG9yIHdpbGwgZW51bWVyYXRlXHJcbiAgICogQHBhcmFtIHJlbG9vcCBCb29sZWFuIGVuYWJsZXMgaXRlcmF0b3IgdG8gY29uc2lkZXIgdGhlIGxpc3QgYXMgYW4gZW5kbGVzcyByZWxvb3BcclxuICAgKi9cclxuICBmdW5jdGlvbiBNZEl0ZXJhdG9yKGl0ZW1zLCByZWxvb3ApIHtcclxuICAgIHZhciB0cnVlRm4gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRydWU7IH07XHJcblxyXG4gICAgaWYgKGl0ZW1zICYmICFhbmd1bGFyLmlzQXJyYXkoaXRlbXMpKSB7XHJcbiAgICAgIGl0ZW1zID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoaXRlbXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbG9vcCA9ICEhcmVsb29wO1xyXG4gICAgdmFyIF9pdGVtcyA9IGl0ZW1zIHx8IFsgXTtcclxuXHJcbiAgICAvLyBQdWJsaXNoZWQgQVBJXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpdGVtczogZ2V0SXRlbXMsXHJcbiAgICAgIGNvdW50OiBjb3VudCxcclxuXHJcbiAgICAgIGluUmFuZ2U6IGluUmFuZ2UsXHJcbiAgICAgIGNvbnRhaW5zOiBjb250YWlucyxcclxuICAgICAgaW5kZXhPZjogaW5kZXhPZixcclxuICAgICAgaXRlbUF0OiBpdGVtQXQsXHJcblxyXG4gICAgICBmaW5kQnk6IGZpbmRCeSxcclxuXHJcbiAgICAgIGFkZDogYWRkLFxyXG4gICAgICByZW1vdmU6IHJlbW92ZSxcclxuXHJcbiAgICAgIGZpcnN0OiBmaXJzdCxcclxuICAgICAgbGFzdDogbGFzdCxcclxuICAgICAgbmV4dDogYW5ndWxhci5iaW5kKG51bGwsIGZpbmRTdWJzZXF1ZW50SXRlbSwgZmFsc2UpLFxyXG4gICAgICBwcmV2aW91czogYW5ndWxhci5iaW5kKG51bGwsIGZpbmRTdWJzZXF1ZW50SXRlbSwgdHJ1ZSksXHJcblxyXG4gICAgICBoYXNQcmV2aW91czogaGFzUHJldmlvdXMsXHJcbiAgICAgIGhhc05leHQ6IGhhc05leHRcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHVibGlzaCBjb3B5IG9mIHRoZSBlbnVtZXJhYmxlIHNldFxyXG4gICAgICogQHJldHVybnMge0FycmF5fCp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldEl0ZW1zKCkge1xyXG4gICAgICByZXR1cm4gW10uY29uY2F0KF9pdGVtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZXRlcm1pbmUgbGVuZ3RoIG9mIHRoZSBsaXN0XHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXkubGVuZ3RofCp8bnVtYmVyfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjb3VudCgpIHtcclxuICAgICAgcmV0dXJuIF9pdGVtcy5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJcyB0aGUgaW5kZXggc3BlY2lmaWVkIHZhbGlkXHJcbiAgICAgKiBAcGFyYW0gaW5kZXhcclxuICAgICAqIEByZXR1cm5zIHtBcnJheS5sZW5ndGh8KnxudW1iZXJ8Ym9vbGVhbn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaW5SYW5nZShpbmRleCkge1xyXG4gICAgICByZXR1cm4gX2l0ZW1zLmxlbmd0aCAmJiAoIGluZGV4ID4gLTEgKSAmJiAoaW5kZXggPCBfaXRlbXMubGVuZ3RoICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYW4gdGhlIGl0ZXJhdG9yIHByb2NlZWQgdG8gdGhlIG5leHQgaXRlbSBpbiB0aGUgbGlzdDsgcmVsYXRpdmUgdG9cclxuICAgICAqIHRoZSBzcGVjaWZpZWQgaXRlbS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaXRlbVxyXG4gICAgICogQHJldHVybnMge0FycmF5Lmxlbmd0aHwqfG51bWJlcnxib29sZWFufVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBoYXNOZXh0KGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0gPyBpblJhbmdlKGluZGV4T2YoaXRlbSkgKyAxKSA6IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FuIHRoZSBpdGVyYXRvciBwcm9jZWVkIHRvIHRoZSBwcmV2aW91cyBpdGVtIGluIHRoZSBsaXN0OyByZWxhdGl2ZSB0b1xyXG4gICAgICogdGhlIHNwZWNpZmllZCBpdGVtLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpdGVtXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXkubGVuZ3RofCp8bnVtYmVyfGJvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGhhc1ByZXZpb3VzKGl0ZW0pIHtcclxuICAgICAgcmV0dXJuIGl0ZW0gPyBpblJhbmdlKGluZGV4T2YoaXRlbSkgLSAxKSA6IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGl0ZW0gYXQgc3BlY2lmaWVkIGluZGV4L3Bvc2l0aW9uXHJcbiAgICAgKiBAcGFyYW0gaW5kZXhcclxuICAgICAqIEByZXR1cm5zIHsqfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBpdGVtQXQoaW5kZXgpIHtcclxuICAgICAgcmV0dXJuIGluUmFuZ2UoaW5kZXgpID8gX2l0ZW1zW2luZGV4XSA6IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5kIGFsbCBlbGVtZW50cyBtYXRjaGluZyB0aGUga2V5L3ZhbHVlIHBhaXJcclxuICAgICAqIG90aGVyd2lzZSByZXR1cm4gbnVsbFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2YWxcclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIGFycmF5XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZpbmRCeShrZXksIHZhbCkge1xyXG4gICAgICByZXR1cm4gX2l0ZW1zLmZpbHRlcihmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgcmV0dXJuIGl0ZW1ba2V5XSA9PT0gdmFsO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBpdGVtIHRvIGxpc3RcclxuICAgICAqIEBwYXJhbSBpdGVtXHJcbiAgICAgKiBAcGFyYW0gaW5kZXhcclxuICAgICAqIEByZXR1cm5zIHsqfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhZGQoaXRlbSwgaW5kZXgpIHtcclxuICAgICAgaWYgKCAhaXRlbSApIHJldHVybiAtMTtcclxuXHJcbiAgICAgIGlmICghYW5ndWxhci5pc051bWJlcihpbmRleCkpIHtcclxuICAgICAgICBpbmRleCA9IF9pdGVtcy5sZW5ndGg7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIF9pdGVtcy5zcGxpY2UoaW5kZXgsIDAsIGl0ZW0pO1xyXG5cclxuICAgICAgcmV0dXJuIGluZGV4T2YoaXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgaXRlbSBmcm9tIGxpc3QuLi5cclxuICAgICAqIEBwYXJhbSBpdGVtXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHJlbW92ZShpdGVtKSB7XHJcbiAgICAgIGlmICggY29udGFpbnMoaXRlbSkgKXtcclxuICAgICAgICBfaXRlbXMuc3BsaWNlKGluZGV4T2YoaXRlbSksIDEpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIHplcm8tYmFzZWQgaW5kZXggb2YgdGhlIHRhcmdldCBpdGVtXHJcbiAgICAgKiBAcGFyYW0gaXRlbVxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGluZGV4T2YoaXRlbSkge1xyXG4gICAgICByZXR1cm4gX2l0ZW1zLmluZGV4T2YoaXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCb29sZWFuIGV4aXN0ZW5jZSBjaGVja1xyXG4gICAgICogQHBhcmFtIGl0ZW1cclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjb250YWlucyhpdGVtKSB7XHJcbiAgICAgIHJldHVybiBpdGVtICYmIChpbmRleE9mKGl0ZW0pID4gLTEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGZpcnN0IGl0ZW0gaW4gdGhlIGxpc3RcclxuICAgICAqIEByZXR1cm5zIHsqfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBmaXJzdCgpIHtcclxuICAgICAgcmV0dXJuIF9pdGVtcy5sZW5ndGggPyBfaXRlbXNbMF0gOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGxhc3QgaXRlbSBpbiB0aGUgbGlzdC4uLlxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGxhc3QoKSB7XHJcbiAgICAgIHJldHVybiBfaXRlbXMubGVuZ3RoID8gX2l0ZW1zW19pdGVtcy5sZW5ndGggLSAxXSA6IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5kIHRoZSBuZXh0IGl0ZW0uIElmIHJlbG9vcCBpcyB0cnVlIGFuZCBhdCB0aGUgZW5kIG9mIHRoZSBsaXN0LCBpdCB3aWxsIGdvIGJhY2sgdG8gdGhlXHJcbiAgICAgKiBmaXJzdCBpdGVtLiBJZiBnaXZlbiwgdGhlIGB2YWxpZGF0ZWAgY2FsbGJhY2sgd2lsbCBiZSB1c2VkIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBuZXh0IGl0ZW1cclxuICAgICAqIGlzIHZhbGlkLiBJZiBub3QgdmFsaWQsIGl0IHdpbGwgdHJ5IHRvIGZpbmQgdGhlIG5leHQgaXRlbSBhZ2Fpbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGJhY2t3YXJkcyBTcGVjaWZpZXMgdGhlIGRpcmVjdGlvbiBvZiBzZWFyY2hpbmcgKGZvcndhcmRzL2JhY2t3YXJkcylcclxuICAgICAqIEBwYXJhbSB7Kn0gaXRlbSBUaGUgaXRlbSB3aG9zZSBzdWJzZXF1ZW50IGl0ZW0gd2UgYXJlIGxvb2tpbmcgZm9yXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9uPX0gdmFsaWRhdGUgVGhlIGB2YWxpZGF0ZWAgZnVuY3Rpb25cclxuICAgICAqIEBwYXJhbSB7aW50ZWdlcj19IGxpbWl0IFRoZSByZWN1cnNpb24gbGltaXRcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0gVGhlIHN1YnNlcXVlbnQgaXRlbSBvciBudWxsXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGZpbmRTdWJzZXF1ZW50SXRlbShiYWNrd2FyZHMsIGl0ZW0sIHZhbGlkYXRlLCBsaW1pdCkge1xyXG4gICAgICB2YWxpZGF0ZSA9IHZhbGlkYXRlIHx8IHRydWVGbjtcclxuXHJcbiAgICAgIHZhciBjdXJJbmRleCA9IGluZGV4T2YoaXRlbSk7XHJcbiAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgaWYgKCFpblJhbmdlKGN1ckluZGV4KSkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIHZhciBuZXh0SW5kZXggPSBjdXJJbmRleCArIChiYWNrd2FyZHMgPyAtMSA6IDEpO1xyXG4gICAgICAgIHZhciBmb3VuZEl0ZW0gPSBudWxsO1xyXG4gICAgICAgIGlmIChpblJhbmdlKG5leHRJbmRleCkpIHtcclxuICAgICAgICAgIGZvdW5kSXRlbSA9IF9pdGVtc1tuZXh0SW5kZXhdO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocmVsb29wKSB7XHJcbiAgICAgICAgICBmb3VuZEl0ZW0gPSBiYWNrd2FyZHMgPyBsYXN0KCkgOiBmaXJzdCgpO1xyXG4gICAgICAgICAgbmV4dEluZGV4ID0gaW5kZXhPZihmb3VuZEl0ZW0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKChmb3VuZEl0ZW0gPT09IG51bGwpIHx8IChuZXh0SW5kZXggPT09IGxpbWl0KSkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgaWYgKHZhbGlkYXRlKGZvdW5kSXRlbSkpIHJldHVybiBmb3VuZEl0ZW07XHJcblxyXG4gICAgICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKGxpbWl0KSkgbGltaXQgPSBuZXh0SW5kZXg7XHJcblxyXG4gICAgICAgIGN1ckluZGV4ID0gbmV4dEluZGV4O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuLmZhY3RvcnkoJyRtZE1lZGlhJywgbWRNZWRpYUZhY3RvcnkpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAqIEBuYW1lICRtZE1lZGlhXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYCRtZE1lZGlhYCBpcyB1c2VkIHRvIGV2YWx1YXRlIHdoZXRoZXIgYSBnaXZlbiBtZWRpYSBxdWVyeSBpcyB0cnVlIG9yIGZhbHNlIGdpdmVuIHRoZVxyXG4gKiBjdXJyZW50IGRldmljZSdzIHNjcmVlbiAvIHdpbmRvdyBzaXplLiBUaGUgbWVkaWEgcXVlcnkgd2lsbCBiZSByZS1ldmFsdWF0ZWQgb24gcmVzaXplLCBhbGxvd2luZ1xyXG4gKiB5b3UgdG8gcmVnaXN0ZXIgYSB3YXRjaC5cclxuICpcclxuICogYCRtZE1lZGlhYCBhbHNvIGhhcyBwcmUtcHJvZ3JhbW1lZCBzdXBwb3J0IGZvciBtZWRpYSBxdWVyaWVzIHRoYXQgbWF0Y2ggdGhlIGxheW91dCBicmVha3BvaW50cy5cclxuICogIChgc21gLCBgZ3Qtc21gLCBgbWRgLCBgZ3QtbWRgLCBgbGdgLCBgZ3QtbGdgKS5cclxuICpcclxuICogQHJldHVybnMge2Jvb2xlYW59IGEgYm9vbGVhbiByZXByZXNlbnRpbmcgd2hldGhlciBvciBub3QgdGhlIGdpdmVuIG1lZGlhIHF1ZXJ5IGlzIHRydWUgb3IgZmFsc2UuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICogYXBwLmNvbnRyb2xsZXIoJ015Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRtZE1lZGlhLCAkc2NvcGUpIHtcclxuICogICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkgeyByZXR1cm4gJG1kTWVkaWEoJ2xnJyk7IH0sIGZ1bmN0aW9uKGJpZykge1xyXG4gKiAgICAgJHNjb3BlLmJpZ1NjcmVlbiA9IGJpZztcclxuICogICB9KTtcclxuICpcclxuICogICAkc2NvcGUuc2NyZWVuSXNTbWFsbCA9ICRtZE1lZGlhKCdzbScpO1xyXG4gKiAgICRzY29wZS5jdXN0b21RdWVyeSA9ICRtZE1lZGlhKCcobWluLXdpZHRoOiAxMjM0cHgpJyk7XHJcbiAqICAgJHNjb3BlLmFub3RoZXJDdXN0b20gPSAkbWRNZWRpYSgnbWF4LXdpZHRoOiAzMDBweCcpO1xyXG4gKiB9KTtcclxuICogPC9obGpzPlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIG1kTWVkaWFGYWN0b3J5KCRtZENvbnN0YW50LCAkcm9vdFNjb3BlLCAkd2luZG93KSB7XHJcbiAgdmFyIHF1ZXJpZXMgPSB7fTtcclxuICB2YXIgbXFscyA9IHt9O1xyXG4gIHZhciByZXN1bHRzID0ge307XHJcbiAgdmFyIG5vcm1hbGl6ZUNhY2hlID0ge307XHJcblxyXG4gICRtZE1lZGlhLmdldFJlc3BvbnNpdmVBdHRyaWJ1dGUgPSBnZXRSZXNwb25zaXZlQXR0cmlidXRlO1xyXG4gICRtZE1lZGlhLmdldFF1ZXJ5ID0gZ2V0UXVlcnk7XHJcbiAgJG1kTWVkaWEud2F0Y2hSZXNwb25zaXZlQXR0cmlidXRlcyA9IHdhdGNoUmVzcG9uc2l2ZUF0dHJpYnV0ZXM7XHJcblxyXG4gIHJldHVybiAkbWRNZWRpYTtcclxuXHJcbiAgZnVuY3Rpb24gJG1kTWVkaWEocXVlcnkpIHtcclxuICAgIHZhciB2YWxpZGF0ZWQgPSBxdWVyaWVzW3F1ZXJ5XTtcclxuICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHZhbGlkYXRlZCkpIHtcclxuICAgICAgdmFsaWRhdGVkID0gcXVlcmllc1txdWVyeV0gPSB2YWxpZGF0ZShxdWVyeSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHJlc3VsdCA9IHJlc3VsdHNbdmFsaWRhdGVkXTtcclxuICAgIGlmIChhbmd1bGFyLmlzVW5kZWZpbmVkKHJlc3VsdCkpIHtcclxuICAgICAgcmVzdWx0ID0gYWRkKHZhbGlkYXRlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHZhbGlkYXRlKHF1ZXJ5KSB7XHJcbiAgICByZXR1cm4gJG1kQ29uc3RhbnQuTUVESUFbcXVlcnldIHx8XHJcbiAgICAgICAgICAgKChxdWVyeS5jaGFyQXQoMCkgIT09ICcoJykgPyAoJygnICsgcXVlcnkgKyAnKScpIDogcXVlcnkpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gYWRkKHF1ZXJ5KSB7XHJcbiAgICB2YXIgcmVzdWx0ID0gbXFsc1txdWVyeV0gPSAkd2luZG93Lm1hdGNoTWVkaWEocXVlcnkpO1xyXG4gICAgcmVzdWx0LmFkZExpc3RlbmVyKG9uUXVlcnlDaGFuZ2UpO1xyXG4gICAgcmV0dXJuIChyZXN1bHRzW3Jlc3VsdC5tZWRpYV0gPSAhIXJlc3VsdC5tYXRjaGVzKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG9uUXVlcnlDaGFuZ2UocXVlcnkpIHtcclxuICAgICRyb290U2NvcGUuJGV2YWxBc3luYyhmdW5jdGlvbigpIHtcclxuICAgICAgcmVzdWx0c1txdWVyeS5tZWRpYV0gPSAhIXF1ZXJ5Lm1hdGNoZXM7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldFF1ZXJ5KG5hbWUpIHtcclxuICAgIHJldHVybiBtcWxzW25hbWVdO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZShhdHRycywgYXR0ck5hbWUpIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJG1kQ29uc3RhbnQuTUVESUFfUFJJT1JJVFkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdmFyIG1lZGlhTmFtZSA9ICRtZENvbnN0YW50Lk1FRElBX1BSSU9SSVRZW2ldO1xyXG4gICAgICBpZiAoIW1xbHNbcXVlcmllc1ttZWRpYU5hbWVdXS5tYXRjaGVzKSB7XHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBub3JtYWxpemVkTmFtZSA9IGdldE5vcm1hbGl6ZWROYW1lKGF0dHJzLCBhdHRyTmFtZSArICctJyArIG1lZGlhTmFtZSk7XHJcbiAgICAgIGlmIChhdHRyc1tub3JtYWxpemVkTmFtZV0pIHtcclxuICAgICAgICByZXR1cm4gYXR0cnNbbm9ybWFsaXplZE5hbWVdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZmFsbGJhY2sgb24gdW5wcmVmaXhlZFxyXG4gICAgcmV0dXJuIGF0dHJzW2dldE5vcm1hbGl6ZWROYW1lKGF0dHJzLCBhdHRyTmFtZSldO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gd2F0Y2hSZXNwb25zaXZlQXR0cmlidXRlcyhhdHRyTmFtZXMsIGF0dHJzLCB3YXRjaEZuKSB7XHJcbiAgICB2YXIgdW53YXRjaEZucyA9IFtdO1xyXG4gICAgYXR0ck5hbWVzLmZvckVhY2goZnVuY3Rpb24oYXR0ck5hbWUpIHtcclxuICAgICAgdmFyIG5vcm1hbGl6ZWROYW1lID0gZ2V0Tm9ybWFsaXplZE5hbWUoYXR0cnMsIGF0dHJOYW1lKTtcclxuICAgICAgaWYgKGF0dHJzW25vcm1hbGl6ZWROYW1lXSkge1xyXG4gICAgICAgIHVud2F0Y2hGbnMucHVzaChcclxuICAgICAgICAgICAgYXR0cnMuJG9ic2VydmUobm9ybWFsaXplZE5hbWUsIGFuZ3VsYXIuYmluZCh2b2lkIDAsIHdhdGNoRm4sIG51bGwpKSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAodmFyIG1lZGlhTmFtZSBpbiAkbWRDb25zdGFudC5NRURJQSkge1xyXG4gICAgICAgIG5vcm1hbGl6ZWROYW1lID0gZ2V0Tm9ybWFsaXplZE5hbWUoYXR0cnMsIGF0dHJOYW1lICsgJy0nICsgbWVkaWFOYW1lKTtcclxuICAgICAgICBpZiAoIWF0dHJzW25vcm1hbGl6ZWROYW1lXSkge1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdW53YXRjaEZucy5wdXNoKGF0dHJzLiRvYnNlcnZlKG5vcm1hbGl6ZWROYW1lLCBhbmd1bGFyLmJpbmQodm9pZCAwLCB3YXRjaEZuLCBtZWRpYU5hbWUpKSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBmdW5jdGlvbiB1bndhdGNoKCkge1xyXG4gICAgICB1bndhdGNoRm5zLmZvckVhY2goZnVuY3Rpb24oZm4pIHsgZm4oKTsgfSlcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyBJbXByb3ZlcyBwZXJmb3JtYW5jZSBkcmFtYXRpY2FsbHlcclxuICBmdW5jdGlvbiBnZXROb3JtYWxpemVkTmFtZShhdHRycywgYXR0ck5hbWUpIHtcclxuICAgIHJldHVybiBub3JtYWxpemVDYWNoZVthdHRyTmFtZV0gfHxcclxuICAgICAgICAobm9ybWFsaXplQ2FjaGVbYXR0ck5hbWVdID0gYXR0cnMuJG5vcm1hbGl6ZShhdHRyTmFtZSkpO1xyXG4gIH1cclxufVxyXG5tZE1lZGlhRmFjdG9yeS4kaW5qZWN0ID0gW1wiJG1kQ29uc3RhbnRcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJHdpbmRvd1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qXHJcbiAqIFRoaXMgdmFyIGhhcyB0byBiZSBvdXRzaWRlIHRoZSBhbmd1bGFyIGZhY3RvcnksIG90aGVyd2lzZSB3aGVuXHJcbiAqIHRoZXJlIGFyZSBtdWx0aXBsZSBtYXRlcmlhbCBhcHBzIG9uIHRoZSBzYW1lIHBhZ2UsIGVhY2ggYXBwXHJcbiAqIHdpbGwgY3JlYXRlIGl0cyBvd24gaW5zdGFuY2Ugb2YgdGhpcyBhcnJheSBhbmQgdGhlIGFwcCdzIElEc1xyXG4gKiB3aWxsIG5vdCBiZSB1bmlxdWUuXHJcbiAqL1xyXG52YXIgbmV4dFVuaXF1ZUlkID0gMDtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAuZmFjdG9yeSgnJG1kVXRpbCcsIFtcIiRjYWNoZUZhY3RvcnlcIiwgXCIkZG9jdW1lbnRcIiwgXCIkdGltZW91dFwiLCBcIiRxXCIsIFwiJHdpbmRvd1wiLCBcIiRtZENvbnN0YW50XCIsIGZ1bmN0aW9uICgkY2FjaGVGYWN0b3J5LCAkZG9jdW1lbnQsICR0aW1lb3V0LCAkcSwgJHdpbmRvdywgJG1kQ29uc3RhbnQpIHtcclxuICAgIHZhciBVdGlsO1xyXG5cclxuICAgIGZ1bmN0aW9uIGdldE5vZGUoZWwpIHtcclxuICAgICAgcmV0dXJuIGVsWzBdIHx8IGVsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBVdGlsID0ge1xyXG4gICAgICBub3c6IHdpbmRvdy5wZXJmb3JtYW5jZSA/XHJcbiAgICAgICAgYW5ndWxhci5iaW5kKHdpbmRvdy5wZXJmb3JtYW5jZSwgd2luZG93LnBlcmZvcm1hbmNlLm5vdykgOlxyXG4gICAgICAgIERhdGUubm93LFxyXG5cclxuICAgICAgY2xpZW50UmVjdDogZnVuY3Rpb24gKGVsZW1lbnQsIG9mZnNldFBhcmVudCwgaXNPZmZzZXRSZWN0KSB7XHJcbiAgICAgICAgdmFyIG5vZGUgPSBnZXROb2RlKGVsZW1lbnQpO1xyXG4gICAgICAgIG9mZnNldFBhcmVudCA9IGdldE5vZGUob2Zmc2V0UGFyZW50IHx8IG5vZGUub2Zmc2V0UGFyZW50IHx8IGRvY3VtZW50LmJvZHkpO1xyXG4gICAgICAgIHZhciBub2RlUmVjdCA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgIC8vIFRoZSB1c2VyIGNhbiBhc2sgZm9yIGFuIG9mZnNldFJlY3Q6IGEgcmVjdCByZWxhdGl2ZSB0byB0aGUgb2Zmc2V0UGFyZW50LFxyXG4gICAgICAgIC8vIG9yIGEgY2xpZW50UmVjdDogYSByZWN0IHJlbGF0aXZlIHRvIHRoZSBwYWdlXHJcbiAgICAgICAgdmFyIG9mZnNldFJlY3QgPSBpc09mZnNldFJlY3QgP1xyXG4gICAgICAgICAgb2Zmc2V0UGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDpcclxuICAgICAgICB7bGVmdDogMCwgdG9wOiAwLCB3aWR0aDogMCwgaGVpZ2h0OiAwfTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgbGVmdDogbm9kZVJlY3QubGVmdCAtIG9mZnNldFJlY3QubGVmdCxcclxuICAgICAgICAgIHRvcDogbm9kZVJlY3QudG9wIC0gb2Zmc2V0UmVjdC50b3AsXHJcbiAgICAgICAgICB3aWR0aDogbm9kZVJlY3Qud2lkdGgsXHJcbiAgICAgICAgICBoZWlnaHQ6IG5vZGVSZWN0LmhlaWdodFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0sXHJcbiAgICAgIG9mZnNldFJlY3Q6IGZ1bmN0aW9uIChlbGVtZW50LCBvZmZzZXRQYXJlbnQpIHtcclxuICAgICAgICByZXR1cm4gVXRpbC5jbGllbnRSZWN0KGVsZW1lbnQsIG9mZnNldFBhcmVudCwgdHJ1ZSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBBbm5veWluZyBtZXRob2QgdG8gY29weSBub2RlcyB0byBhbiBhcnJheSwgdGhhbmtzIHRvIElFXHJcbiAgICAgIG5vZGVzVG9BcnJheTogZnVuY3Rpb24gKG5vZGVzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICByZXN1bHRzLnB1c2gobm9kZXMuaXRlbShpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gRGlzYWJsZXMgc2Nyb2xsIGFyb3VuZCB0aGUgcGFzc2VkIGVsZW1lbnQuXHJcbiAgICAgIGRpc2FibGVTY3JvbGxBcm91bmQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKFV0aWwuZGlzYWJsZVNjcm9sbEFyb3VuZC5fZW5hYmxlU2Nyb2xsaW5nKSByZXR1cm4gVXRpbC5kaXNhYmxlU2Nyb2xsQXJvdW5kLl9lbmFibGVTY3JvbGxpbmc7XHJcbiAgICAgICAgZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50KTtcclxuICAgICAgICB2YXIgYm9keSA9ICRkb2N1bWVudFswXS5ib2R5LFxyXG4gICAgICAgICAgcmVzdG9yZUJvZHkgPSBkaXNhYmxlQm9keVNjcm9sbCgpLFxyXG4gICAgICAgICAgcmVzdG9yZUVsZW1lbnQgPSBkaXNhYmxlRWxlbWVudFNjcm9sbCgpO1xyXG5cclxuICAgICAgICByZXR1cm4gVXRpbC5kaXNhYmxlU2Nyb2xsQXJvdW5kLl9lbmFibGVTY3JvbGxpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICByZXN0b3JlQm9keSgpO1xyXG4gICAgICAgICAgcmVzdG9yZUVsZW1lbnQoKTtcclxuICAgICAgICAgIGRlbGV0ZSBVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBDcmVhdGVzIGEgdmlydHVhbCBzY3JvbGxpbmcgbWFzayB0byBhYnNvcmIgdG91Y2htb3ZlLCBrZXlib2FyZCwgc2Nyb2xsYmFyIGNsaWNraW5nLCBhbmQgd2hlZWwgZXZlbnRzXHJcbiAgICAgICAgZnVuY3Rpb24gZGlzYWJsZUVsZW1lbnRTY3JvbGwoKSB7XHJcbiAgICAgICAgICB2YXIgekluZGV4ID0gJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnRbMF0pLnpJbmRleCAtIDE7XHJcbiAgICAgICAgICBpZiAoaXNOYU4oekluZGV4KSkgekluZGV4ID0gOTk7XHJcbiAgICAgICAgICB2YXIgc2Nyb2xsTWFzayA9IGFuZ3VsYXIuZWxlbWVudChcclxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1zY3JvbGwtbWFza1wiIHN0eWxlPVwiei1pbmRleDogJyArIHpJbmRleCArICdcIj4nICtcclxuICAgICAgICAgICAgJyAgPGRpdiBjbGFzcz1cIm1kLXNjcm9sbC1tYXNrLWJhclwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAnPC9kaXY+Jyk7XHJcbiAgICAgICAgICBib2R5LmFwcGVuZENoaWxkKHNjcm9sbE1hc2tbMF0pO1xyXG5cclxuICAgICAgICAgIHNjcm9sbE1hc2sub24oJ3doZWVsJywgcHJldmVudERlZmF1bHQpO1xyXG4gICAgICAgICAgc2Nyb2xsTWFzay5vbigndG91Y2htb3ZlJywgcHJldmVudERlZmF1bHQpO1xyXG4gICAgICAgICAgJGRvY3VtZW50Lm9uKCdrZXlkb3duJywgZGlzYWJsZUtleU5hdik7XHJcblxyXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHJlc3RvcmVTY3JvbGwoKSB7XHJcbiAgICAgICAgICAgIHNjcm9sbE1hc2sub2ZmKCd3aGVlbCcpO1xyXG4gICAgICAgICAgICBzY3JvbGxNYXNrLm9mZigndG91Y2htb3ZlJyk7XHJcbiAgICAgICAgICAgIHNjcm9sbE1hc2tbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JvbGxNYXNrWzBdKTtcclxuICAgICAgICAgICAgJGRvY3VtZW50Lm9mZigna2V5ZG93bicsIGRpc2FibGVLZXlOYXYpO1xyXG4gICAgICAgICAgICBkZWxldGUgVXRpbC5kaXNhYmxlU2Nyb2xsQXJvdW5kLl9lbmFibGVTY3JvbGxpbmc7XHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIC8vIFByZXZlbnQga2V5cHJlc3NlcyBmcm9tIGVsZW1lbnRzIGluc2lkZSB0aGUgYm9keVxyXG4gICAgICAgICAgLy8gdXNlZCB0byBzdG9wIHRoZSBrZXlwcmVzc2VzIHRoYXQgY291bGQgY2F1c2UgdGhlIHBhZ2UgdG8gc2Nyb2xsXHJcbiAgICAgICAgICAvLyAoYXJyb3cga2V5cywgc3BhY2ViYXIsIHRhYiwgZXRjKS5cclxuICAgICAgICAgIGZ1bmN0aW9uIGRpc2FibGVLZXlOYXYoZSkge1xyXG4gICAgICAgICAgICAvLy0tIHRlbXBvcmFyaWx5IHJlbW92ZWQgdGhpcyBsb2dpYywgd2lsbCBwb3NzaWJseSByZS1hZGQgYXQgYSBsYXRlciBkYXRlXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgaWYgKCFlbGVtZW50WzBdLmNvbnRhaW5zKGUudGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZnVuY3Rpb24gcHJldmVudERlZmF1bHQoZSkge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDb252ZXJ0cyB0aGUgYm9keSB0byBhIHBvc2l0aW9uIGZpeGVkIGJsb2NrIGFuZCB0cmFuc2xhdGUgaXQgdG8gdGhlIHByb3BlciBzY3JvbGxcclxuICAgICAgICAvLyBwb3NpdGlvblxyXG4gICAgICAgIGZ1bmN0aW9uIGRpc2FibGVCb2R5U2Nyb2xsKCkge1xyXG4gICAgICAgICAgdmFyIHJlc3RvcmVTdHlsZSA9IGJvZHkuZ2V0QXR0cmlidXRlKCdzdHlsZScpIHx8ICcnO1xyXG4gICAgICAgICAgdmFyIHNjcm9sbE9mZnNldCA9IGJvZHkuc2Nyb2xsVG9wICsgYm9keS5wYXJlbnRFbGVtZW50LnNjcm9sbFRvcDtcclxuICAgICAgICAgIHZhciBjbGllbnRXaWR0aCA9IGJvZHkuY2xpZW50V2lkdGg7XHJcblxyXG4gICAgICAgICAgYXBwbHlTdHlsZXMoYm9keSwge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogJ2ZpeGVkJyxcclxuICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcclxuICAgICAgICAgICAgb3ZlcmZsb3dZOiAnc2Nyb2xsJyxcclxuICAgICAgICAgICAgdG9wOiAtc2Nyb2xsT2Zmc2V0ICsgJ3B4J1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgaWYgKGJvZHkuY2xpZW50V2lkdGggPCBjbGllbnRXaWR0aCkgYXBwbHlTdHlsZXMoYm9keSwge292ZXJmbG93OiAnaGlkZGVuJ30pO1xyXG5cclxuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiByZXN0b3JlU2Nyb2xsKCkge1xyXG4gICAgICAgICAgICBib2R5LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCByZXN0b3JlU3R5bGUpO1xyXG4gICAgICAgICAgICBib2R5LnNjcm9sbFRvcCA9IHNjcm9sbE9mZnNldDtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhcHBseVN0eWxlcyhlbCwgc3R5bGVzKSB7XHJcbiAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc3R5bGVzKSB7XHJcbiAgICAgICAgICAgIGVsLnN0eWxlW2tleV0gPSBzdHlsZXNba2V5XTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGVuYWJsZVNjcm9sbGluZzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBtZXRob2QgPSB0aGlzLmRpc2FibGVTY3JvbGxBcm91bmQuX2VuYWJsZVNjcm9sbGluZztcclxuICAgICAgICBtZXRob2QgJiYgbWV0aG9kKCk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGZsb2F0aW5nU2Nyb2xsYmFyczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZsb2F0aW5nU2Nyb2xsYmFycy5jYWNoZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgdmFyIHRlbXBOb2RlID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2IHN0eWxlPVwid2lkdGg6IDEwMCU7IHotaW5kZXg6IC0xOyBwb3NpdGlvbjogYWJzb2x1dGU7IGhlaWdodDogMzVweDsgb3ZlcmZsb3cteTogc2Nyb2xsXCI+PGRpdiBzdHlsZT1cImhlaWdodDogNjA7XCI+PC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAkZG9jdW1lbnRbMF0uYm9keS5hcHBlbmRDaGlsZCh0ZW1wTm9kZVswXSk7XHJcbiAgICAgICAgICB0aGlzLmZsb2F0aW5nU2Nyb2xsYmFycy5jYWNoZWQgPSAodGVtcE5vZGVbMF0ub2Zmc2V0V2lkdGggPT0gdGVtcE5vZGVbMF0uY2hpbGROb2Rlc1swXS5vZmZzZXRXaWR0aCk7XHJcbiAgICAgICAgICB0ZW1wTm9kZS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmxvYXRpbmdTY3JvbGxiYXJzLmNhY2hlZDtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIE1vYmlsZSBzYWZhcmkgb25seSBhbGxvd3MgeW91IHRvIHNldCBmb2N1cyBpbiBjbGljayBldmVudCBsaXN0ZW5lcnMuLi5cclxuICAgICAgZm9yY2VGb2N1czogZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF0gfHwgZWxlbWVudDtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiBmb2N1c09uQ2xpY2soZXYpIHtcclxuICAgICAgICAgIGlmIChldi50YXJnZXQgPT09IG5vZGUgJiYgZXYuJGZvY3VzKSB7XHJcbiAgICAgICAgICAgIG5vZGUuZm9jdXMoKTtcclxuICAgICAgICAgICAgZXYuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmb2N1c09uQ2xpY2spO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRydWUpO1xyXG5cclxuICAgICAgICB2YXIgbmV3RXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKTtcclxuICAgICAgICBuZXdFdmVudC5pbml0TW91c2VFdmVudCgnY2xpY2snLCBmYWxzZSwgdHJ1ZSwgd2luZG93LCB7fSwgMCwgMCwgMCwgMCxcclxuICAgICAgICAgIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCBudWxsKTtcclxuICAgICAgICBuZXdFdmVudC4kbWF0ZXJpYWwgPSB0cnVlO1xyXG4gICAgICAgIG5ld0V2ZW50LiRmb2N1cyA9IHRydWU7XHJcbiAgICAgICAgbm9kZS5kaXNwYXRjaEV2ZW50KG5ld0V2ZW50KTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHRyYW5zaXRpb25FbmRQcm9taXNlOiBmdW5jdGlvbiAoZWxlbWVudCwgb3B0cykge1xyXG4gICAgICAgIG9wdHMgPSBvcHRzIHx8IHt9O1xyXG4gICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgZWxlbWVudC5vbigkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTkVORCwgZmluaXNoZWQpO1xyXG4gICAgICAgIGZ1bmN0aW9uIGZpbmlzaGVkKGV2KSB7XHJcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyB0cmFuc2l0aW9uZW5kIGRpZG4ndCBidWJibGUgdXAgZnJvbSBhIGNoaWxkXHJcbiAgICAgICAgICBpZiAoIWV2IHx8IGV2LnRhcmdldCA9PT0gZWxlbWVudFswXSkge1xyXG4gICAgICAgICAgICBlbGVtZW50Lm9mZigkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTkVORCwgZmluaXNoZWQpO1xyXG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAob3B0cy50aW1lb3V0KSAkdGltZW91dChmaW5pc2hlZCwgb3B0cy50aW1lb3V0KTtcclxuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGZha2VOZ01vZGVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICRmYWtlOiB0cnVlLFxyXG4gICAgICAgICAgJHNldFRvdWNoZWQ6IGFuZ3VsYXIubm9vcCxcclxuICAgICAgICAgICRzZXRWaWV3VmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLiR2aWV3VmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgdGhpcy4kcmVuZGVyKHZhbHVlKTtcclxuICAgICAgICAgICAgdGhpcy4kdmlld0NoYW5nZUxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYikge1xyXG4gICAgICAgICAgICAgIGNiKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgICRpc0VtcHR5OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICgnJyArIHZhbHVlKS5sZW5ndGggPT09IDA7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgJHBhcnNlcnM6IFtdLFxyXG4gICAgICAgICAgJGZvcm1hdHRlcnM6IFtdLFxyXG4gICAgICAgICAgJHZpZXdDaGFuZ2VMaXN0ZW5lcnM6IFtdLFxyXG4gICAgICAgICAgJHJlbmRlcjogYW5ndWxhci5ub29wXHJcbiAgICAgICAgfTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgYXMgbG9uZyBhcyBpdCBjb250aW51ZXMgdG8gYmUgaW52b2tlZCwgd2lsbCBub3RcclxuICAgICAgLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvclxyXG4gICAgICAvLyBOIG1pbGxpc2Vjb25kcy5cclxuICAgICAgLy8gQHBhcmFtIHdhaXQgSW50ZWdlciB2YWx1ZSBvZiBtc2VjcyB0byBkZWxheSAoc2luY2UgbGFzdCBkZWJvdW5jZSByZXNldCk7IGRlZmF1bHQgdmFsdWUgMTAgbXNlY3NcclxuICAgICAgLy8gQHBhcmFtIGludm9rZUFwcGx5IHNob3VsZCB0aGUgJHRpbWVvdXQgdHJpZ2dlciAkZGlnZXN0KCkgZGlydHkgY2hlY2tpbmdcclxuICAgICAgZGVib3VuY2U6IGZ1bmN0aW9uIChmdW5jLCB3YWl0LCBzY29wZSwgaW52b2tlQXBwbHkpIHtcclxuICAgICAgICB2YXIgdGltZXI7XHJcblxyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBkZWJvdW5jZWQoKSB7XHJcbiAgICAgICAgICB2YXIgY29udGV4dCA9IHNjb3BlLFxyXG4gICAgICAgICAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcclxuXHJcbiAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICB0aW1lciA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuXHJcbiAgICAgICAgICB9LCB3YWl0IHx8IDEwLCBpbnZva2VBcHBseSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGNhbiBvbmx5IGJlIHRyaWdnZXJlZCBldmVyeSBgZGVsYXlgIG1pbGxpc2Vjb25kcy5cclxuICAgICAgLy8gSW4gb3RoZXIgd29yZHMsIHRoZSBmdW5jdGlvbiB3aWxsIG5vdCBiZSBjYWxsZWQgdW5sZXNzIGl0IGhhcyBiZWVuIG1vcmVcclxuICAgICAgLy8gdGhhbiBgZGVsYXlgIG1pbGxpc2Vjb25kcyBzaW5jZSB0aGUgbGFzdCBjYWxsLlxyXG4gICAgICB0aHJvdHRsZTogZnVuY3Rpb24gdGhyb3R0bGUoZnVuYywgZGVsYXkpIHtcclxuICAgICAgICB2YXIgcmVjZW50O1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiB0aHJvdHRsZWQoKSB7XHJcbiAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXM7XHJcbiAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgIHZhciBub3cgPSBVdGlsLm5vdygpO1xyXG5cclxuICAgICAgICAgIGlmICghcmVjZW50IHx8IChub3cgLSByZWNlbnQgPiBkZWxheSkpIHtcclxuICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgICAgICAgICAgcmVjZW50ID0gbm93O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogTWVhc3VyZXMgdGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdGFrZW4gdG8gcnVuIHRoZSBwcm92aWRlZCBjYWxsYmFja1xyXG4gICAgICAgKiBmdW5jdGlvbi4gVXNlcyBhIGhpZ2gtcHJlY2lzaW9uIHRpbWVyIGlmIGF2YWlsYWJsZS5cclxuICAgICAgICovXHJcbiAgICAgIHRpbWU6IGZ1bmN0aW9uIHRpbWUoY2IpIHtcclxuICAgICAgICB2YXIgc3RhcnQgPSBVdGlsLm5vdygpO1xyXG4gICAgICAgIGNiKCk7XHJcbiAgICAgICAgcmV0dXJuIFV0aWwubm93KCkgLSBzdGFydDtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBHZXQgYSB1bmlxdWUgSUQuXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGFuIHVuaXF1ZSBudW1lcmljIHN0cmluZ1xyXG4gICAgICAgKi9cclxuICAgICAgbmV4dFVpZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAnJyArIG5leHRVbmlxdWVJZCsrO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gU3RvcCB3YXRjaGVycyBhbmQgZXZlbnRzIGZyb20gZmlyaW5nIG9uIGEgc2NvcGUgd2l0aG91dCBkZXN0cm95aW5nIGl0LFxyXG4gICAgICAvLyBieSBkaXNjb25uZWN0aW5nIGl0IGZyb20gaXRzIHBhcmVudCBhbmQgaXRzIHNpYmxpbmdzJyBsaW5rZWQgbGlzdHMuXHJcbiAgICAgIGRpc2Nvbm5lY3RTY29wZTogZnVuY3Rpb24gZGlzY29ubmVjdFNjb3BlKHNjb3BlKSB7XHJcbiAgICAgICAgaWYgKCFzY29wZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAvLyB3ZSBjYW4ndCBkZXN0cm95IHRoZSByb290IHNjb3BlIG9yIGEgc2NvcGUgdGhhdCBoYXMgYmVlbiBhbHJlYWR5IGRlc3Ryb3llZFxyXG4gICAgICAgIGlmIChzY29wZS4kcm9vdCA9PT0gc2NvcGUpIHJldHVybjtcclxuICAgICAgICBpZiAoc2NvcGUuJCRkZXN0cm95ZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgdmFyIHBhcmVudCA9IHNjb3BlLiRwYXJlbnQ7XHJcbiAgICAgICAgc2NvcGUuJCRkaXNjb25uZWN0ZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAvLyBTZWUgU2NvcGUuJGRlc3Ryb3lcclxuICAgICAgICBpZiAocGFyZW50LiQkY2hpbGRIZWFkID09PSBzY29wZSkgcGFyZW50LiQkY2hpbGRIZWFkID0gc2NvcGUuJCRuZXh0U2libGluZztcclxuICAgICAgICBpZiAocGFyZW50LiQkY2hpbGRUYWlsID09PSBzY29wZSkgcGFyZW50LiQkY2hpbGRUYWlsID0gc2NvcGUuJCRwcmV2U2libGluZztcclxuICAgICAgICBpZiAoc2NvcGUuJCRwcmV2U2libGluZykgc2NvcGUuJCRwcmV2U2libGluZy4kJG5leHRTaWJsaW5nID0gc2NvcGUuJCRuZXh0U2libGluZztcclxuICAgICAgICBpZiAoc2NvcGUuJCRuZXh0U2libGluZykgc2NvcGUuJCRuZXh0U2libGluZy4kJHByZXZTaWJsaW5nID0gc2NvcGUuJCRwcmV2U2libGluZztcclxuXHJcbiAgICAgICAgc2NvcGUuJCRuZXh0U2libGluZyA9IHNjb3BlLiQkcHJldlNpYmxpbmcgPSBudWxsO1xyXG5cclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8vIFVuZG8gdGhlIGVmZmVjdHMgb2YgZGlzY29ubmVjdFNjb3BlIGFib3ZlLlxyXG4gICAgICByZWNvbm5lY3RTY29wZTogZnVuY3Rpb24gcmVjb25uZWN0U2NvcGUoc2NvcGUpIHtcclxuICAgICAgICBpZiAoIXNjb3BlKSByZXR1cm47XHJcblxyXG4gICAgICAgIC8vIHdlIGNhbid0IGRpc2Nvbm5lY3QgdGhlIHJvb3Qgbm9kZSBvciBzY29wZSBhbHJlYWR5IGRpc2Nvbm5lY3RlZFxyXG4gICAgICAgIGlmIChzY29wZS4kcm9vdCA9PT0gc2NvcGUpIHJldHVybjtcclxuICAgICAgICBpZiAoIXNjb3BlLiQkZGlzY29ubmVjdGVkKSByZXR1cm47XHJcblxyXG4gICAgICAgIHZhciBjaGlsZCA9IHNjb3BlO1xyXG5cclxuICAgICAgICB2YXIgcGFyZW50ID0gY2hpbGQuJHBhcmVudDtcclxuICAgICAgICBjaGlsZC4kJGRpc2Nvbm5lY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIC8vIFNlZSBTY29wZS4kbmV3IGZvciB0aGlzIGxvZ2ljLi4uXHJcbiAgICAgICAgY2hpbGQuJCRwcmV2U2libGluZyA9IHBhcmVudC4kJGNoaWxkVGFpbDtcclxuICAgICAgICBpZiAocGFyZW50LiQkY2hpbGRIZWFkKSB7XHJcbiAgICAgICAgICBwYXJlbnQuJCRjaGlsZFRhaWwuJCRuZXh0U2libGluZyA9IGNoaWxkO1xyXG4gICAgICAgICAgcGFyZW50LiQkY2hpbGRUYWlsID0gY2hpbGQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHBhcmVudC4kJGNoaWxkSGVhZCA9IHBhcmVudC4kJGNoaWxkVGFpbCA9IGNoaWxkO1xyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8qXHJcbiAgICAgICAqIGdldENsb3Nlc3QgcmVwbGljYXRlcyBqUXVlcnkuY2xvc2VzdCgpIHRvIHdhbGsgdXAgdGhlIERPTSB0cmVlIHVudGlsIGl0IGZpbmRzIGEgbWF0Y2hpbmcgbm9kZU5hbWVcclxuICAgICAgICpcclxuICAgICAgICogQHBhcmFtIGVsIEVsZW1lbnQgdG8gc3RhcnQgd2Fsa2luZyB0aGUgRE9NIGZyb21cclxuICAgICAgICogQHBhcmFtIHRhZ05hbWUgVGFnIG5hbWUgdG8gZmluZCBjbG9zZXN0IHRvIGVsLCBzdWNoIGFzICdmb3JtJ1xyXG4gICAgICAgKi9cclxuICAgICAgZ2V0Q2xvc2VzdDogZnVuY3Rpb24gZ2V0Q2xvc2VzdChlbCwgdGFnTmFtZSwgb25seVBhcmVudCkge1xyXG4gICAgICAgIGlmIChlbCBpbnN0YW5jZW9mIGFuZ3VsYXIuZWxlbWVudCkgZWwgPSBlbFswXTtcclxuICAgICAgICB0YWdOYW1lID0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChvbmx5UGFyZW50KSBlbCA9IGVsLnBhcmVudE5vZGU7XHJcbiAgICAgICAgaWYgKCFlbCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgZG8ge1xyXG4gICAgICAgICAgaWYgKGVsLm5vZGVOYW1lID09PSB0YWdOYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlbDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IHdoaWxlIChlbCA9IGVsLnBhcmVudE5vZGUpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEZ1bmN0aW9uYWwgZXF1aXZhbGVudCBmb3IgJGVsZW1lbnQuZmlsdGVyKOKAmG1kLWJvdHRvbS1zaGVldOKAmSlcclxuICAgICAgICogdXNlZnVsIHdpdGggaW50ZXJpbUVsZW1lbnRzIHdoZXJlIHRoZSBlbGVtZW50IGFuZCBpdHMgY29udGFpbmVyIGFyZSBpbXBvcnRhbnQuLi5cclxuICAgICAgICovXHJcbiAgICAgIGV4dHJhY3RFbGVtZW50QnlOYW1lOiBmdW5jdGlvbiAoZWxlbWVudCwgbm9kZU5hbWUpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gZWxlbWVudC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgaWYgKGVsZW1lbnRbaV0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbm9kZU5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50W2ldKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogR2l2ZSBvcHRpb25hbCBwcm9wZXJ0aWVzIHdpdGggbm8gdmFsdWUgYSBib29sZWFuIHRydWUgaWYgYXR0ciBwcm92aWRlZCBvciBmYWxzZSBvdGhlcndpc2VcclxuICAgICAgICovXHJcbiAgICAgIGluaXRPcHRpb25hbFByb3BlcnRpZXM6IGZ1bmN0aW9uIChzY29wZSwgYXR0ciwgZGVmYXVsdHMpIHtcclxuICAgICAgICBkZWZhdWx0cyA9IGRlZmF1bHRzIHx8IHt9O1xyXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChzY29wZS4kJGlzb2xhdGVCaW5kaW5ncywgZnVuY3Rpb24gKGJpbmRpbmcsIGtleSkge1xyXG4gICAgICAgICAgaWYgKGJpbmRpbmcub3B0aW9uYWwgJiYgYW5ndWxhci5pc1VuZGVmaW5lZChzY29wZVtrZXldKSkge1xyXG4gICAgICAgICAgICB2YXIgYXR0cklzRGVmaW5lZCA9IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHJbYmluZGluZy5hdHRyTmFtZV0pO1xyXG4gICAgICAgICAgICBzY29wZVtrZXldID0gYW5ndWxhci5pc0RlZmluZWQoZGVmYXVsdHNba2V5XSkgPyBkZWZhdWx0c1trZXldIDogYXR0cklzRGVmaW5lZDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgIH07XHJcblxyXG4gIH1dKTtcclxuXHJcbi8qXHJcbiAqIFNpbmNlIHJlbW92aW5nIGpRdWVyeSBmcm9tIHRoZSBkZW1vcywgc29tZSBjb2RlIHRoYXQgdXNlcyBgZWxlbWVudC5mb2N1cygpYCBpcyBicm9rZW4uXHJcbiAqXHJcbiAqIFdlIG5lZWQgdG8gYWRkIGBlbGVtZW50LmZvY3VzKClgLCBiZWNhdXNlIGl0J3MgdGVzdGFibGUgdW5saWtlIGBlbGVtZW50WzBdLmZvY3VzYC5cclxuICpcclxuICogVE9ETyhham9zbGluKTogVGhpcyBzaG91bGQgYmUgYWRkZWQgaW4gYSBiZXR0ZXIgcGxhY2UgbGF0ZXIuXHJcbiAqL1xyXG5cclxuYW5ndWxhci5lbGVtZW50LnByb3RvdHlwZS5mb2N1cyA9IGFuZ3VsYXIuZWxlbWVudC5wcm90b3R5cGUuZm9jdXMgfHwgZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHRoaXMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXNbMF0uZm9jdXMoKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH07XHJcbmFuZ3VsYXIuZWxlbWVudC5wcm90b3R5cGUuYmx1ciA9IGFuZ3VsYXIuZWxlbWVudC5wcm90b3R5cGUuYmx1ciB8fCBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGhpcy5sZW5ndGgpIHtcclxuICAgICAgdGhpc1swXS5ibHVyKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9O1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAuc2VydmljZSgnJG1kQXJpYScsIEFyaWFTZXJ2aWNlKTtcclxuXHJcbi8qXHJcbiAqIEBuZ0luamVjdFxyXG4gKi9cclxuZnVuY3Rpb24gQXJpYVNlcnZpY2UoJCRyQUYsICRsb2csICR3aW5kb3cpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGV4cGVjdDogZXhwZWN0LFxyXG4gICAgZXhwZWN0QXN5bmM6IGV4cGVjdEFzeW5jLFxyXG4gICAgZXhwZWN0V2l0aFRleHQ6IGV4cGVjdFdpdGhUZXh0XHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgZXhwZWN0ZWQgYXR0cmlidXRlIGhhcyBiZWVuIHNwZWNpZmllZCBvbiB0aGUgdGFyZ2V0IGVsZW1lbnQgb3IgY2hpbGRcclxuICAgKiBAcGFyYW0gZWxlbWVudFxyXG4gICAqIEBwYXJhbSBhdHRyTmFtZVxyXG4gICAqIEBwYXJhbSB7b3B0aW9uYWx9IGRlZmF1bHRWYWx1ZSBXaGF0IHRvIHNldCB0aGUgYXR0ciB0byBpZiBubyB2YWx1ZSBpcyBmb3VuZFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGV4cGVjdChlbGVtZW50LCBhdHRyTmFtZSwgZGVmYXVsdFZhbHVlKSB7XHJcbiAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF0gfHwgZWxlbWVudDtcclxuXHJcbiAgICAvLyBpZiBub2RlIGV4aXN0cyBhbmQgbmVpdGhlciBpdCBub3IgaXRzIGNoaWxkcmVuIGhhdmUgdGhlIGF0dHJpYnV0ZVxyXG4gICAgaWYgKG5vZGUgJiZcclxuICAgICAgICgoIW5vZGUuaGFzQXR0cmlidXRlKGF0dHJOYW1lKSB8fFxyXG4gICAgICAgIG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJOYW1lKS5sZW5ndGggPT09IDApICYmXHJcbiAgICAgICAgIWNoaWxkSGFzQXR0cmlidXRlKG5vZGUsIGF0dHJOYW1lKSkpIHtcclxuXHJcbiAgICAgIGRlZmF1bHRWYWx1ZSA9IGFuZ3VsYXIuaXNTdHJpbmcoZGVmYXVsdFZhbHVlKSA/IGRlZmF1bHRWYWx1ZS50cmltKCkgOiAnJztcclxuICAgICAgaWYgKGRlZmF1bHRWYWx1ZS5sZW5ndGgpIHtcclxuICAgICAgICBlbGVtZW50LmF0dHIoYXR0ck5hbWUsIGRlZmF1bHRWYWx1ZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJGxvZy53YXJuKCdBUklBOiBBdHRyaWJ1dGUgXCInLCBhdHRyTmFtZSwgJ1wiLCByZXF1aXJlZCBmb3IgYWNjZXNzaWJpbGl0eSwgaXMgbWlzc2luZyBvbiBub2RlOicsIG5vZGUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZXhwZWN0QXN5bmMoZWxlbWVudCwgYXR0ck5hbWUsIGRlZmF1bHRWYWx1ZUdldHRlcikge1xyXG4gICAgLy8gUHJvYmxlbTogd2hlbiByZXRyaWV2aW5nIHRoZSBlbGVtZW50J3MgY29udGVudHMgc3luY2hyb25vdXNseSB0byBmaW5kIHRoZSBsYWJlbCxcclxuICAgIC8vIHRoZSB0ZXh0IG1heSBub3QgYmUgZGVmaW5lZCB5ZXQgaW4gdGhlIGNhc2Ugb2YgYSBiaW5kaW5nLlxyXG4gICAgLy8gVGhlcmUgaXMgYSBoaWdoZXIgY2hhbmNlIHRoYXQgYSBiaW5kaW5nIHdpbGwgYmUgZGVmaW5lZCBpZiB3ZSB3YWl0IG9uZSBmcmFtZS5cclxuICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICBleHBlY3QoZWxlbWVudCwgYXR0ck5hbWUsIGRlZmF1bHRWYWx1ZUdldHRlcigpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZXhwZWN0V2l0aFRleHQoZWxlbWVudCwgYXR0ck5hbWUpIHtcclxuICAgIGV4cGVjdEFzeW5jKGVsZW1lbnQsIGF0dHJOYW1lLCBmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIGdldFRleHQoZWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldFRleHQoZWxlbWVudCkge1xyXG4gICAgcmV0dXJuIGVsZW1lbnQudGV4dCgpLnRyaW0oKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNoaWxkSGFzQXR0cmlidXRlKG5vZGUsIGF0dHJOYW1lKSB7XHJcbiAgICB2YXIgaGFzQ2hpbGRyZW4gPSBub2RlLmhhc0NoaWxkTm9kZXMoKSxcclxuICAgICAgICBoYXNBdHRyID0gZmFsc2U7XHJcblxyXG4gICAgZnVuY3Rpb24gaXNIaWRkZW4oZWwpIHtcclxuICAgICAgdmFyIHN0eWxlID0gZWwuY3VycmVudFN0eWxlID8gZWwuY3VycmVudFN0eWxlIDogJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcclxuICAgICAgcmV0dXJuIChzdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKGhhc0NoaWxkcmVuKSB7XHJcbiAgICAgIHZhciBjaGlsZHJlbiA9IG5vZGUuY2hpbGROb2RlcztcclxuICAgICAgZm9yKHZhciBpPTA7IGk8Y2hpbGRyZW4ubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgIGlmKGNoaWxkLm5vZGVUeXBlID09PSAxICYmIGNoaWxkLmhhc0F0dHJpYnV0ZShhdHRyTmFtZSkpIHtcclxuICAgICAgICAgIGlmKCFpc0hpZGRlbihjaGlsZCkpe1xyXG4gICAgICAgICAgICBoYXNBdHRyID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBoYXNBdHRyO1xyXG4gIH1cclxufVxyXG5BcmlhU2VydmljZS4kaW5qZWN0ID0gW1wiJCRyQUZcIiwgXCIkbG9nXCIsIFwiJHdpbmRvd1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAuc2VydmljZSgnJG1kQ29tcGlsZXInLCBtZENvbXBpbGVyU2VydmljZSk7XHJcblxyXG5mdW5jdGlvbiBtZENvbXBpbGVyU2VydmljZSgkcSwgJGh0dHAsICRpbmplY3RvciwgJGNvbXBpbGUsICRjb250cm9sbGVyLCAkdGVtcGxhdGVDYWNoZSkge1xyXG4gIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cclxuXHJcbiAgLypcclxuICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAqIEBuYW1lICRtZENvbXBpbGVyXHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogVGhlICRtZENvbXBpbGVyIHNlcnZpY2UgaXMgYW4gYWJzdHJhY3Rpb24gb2YgYW5ndWxhcidzIGNvbXBpbGVyLCB0aGF0IGFsbG93cyB0aGUgZGV2ZWxvcGVyXHJcbiAgICogdG8gZWFzaWx5IGNvbXBpbGUgYW4gZWxlbWVudCB3aXRoIGEgdGVtcGxhdGVVcmwsIGNvbnRyb2xsZXIsIGFuZCBsb2NhbHMuXHJcbiAgICpcclxuICAgKiBAdXNhZ2VcclxuICAgKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICAgKiAkbWRDb21waWxlci5jb21waWxlKHtcclxuICAgKiAgIHRlbXBsYXRlVXJsOiAnbW9kYWwuaHRtbCcsXHJcbiAgICogICBjb250cm9sbGVyOiAnTW9kYWxDdHJsJyxcclxuICAgKiAgIGxvY2Fsczoge1xyXG4gICAqICAgICBtb2RhbDogbXlNb2RhbEluc3RhbmNlO1xyXG4gICAqICAgfVxyXG4gICAqIH0pLnRoZW4oZnVuY3Rpb24oY29tcGlsZURhdGEpIHtcclxuICAgKiAgIGNvbXBpbGVEYXRhLmVsZW1lbnQ7IC8vIG1vZGFsLmh0bWwncyB0ZW1wbGF0ZSBpbiBhbiBlbGVtZW50XHJcbiAgICogICBjb21waWxlRGF0YS5saW5rKG15U2NvcGUpOyAvL2F0dGFjaCBjb250cm9sbGVyICYgc2NvcGUgdG8gZWxlbWVudFxyXG4gICAqIH0pO1xyXG4gICAqIDwvaGxqcz5cclxuICAgKi9cclxuXHJcbiAgIC8qXHJcbiAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICogQG5hbWUgJG1kQ29tcGlsZXIjY29tcGlsZVxyXG4gICAgKiBAZGVzY3JpcHRpb24gQSBoZWxwZXIgdG8gY29tcGlsZSBhbiBIVE1MIHRlbXBsYXRlL3RlbXBsYXRlVXJsIHdpdGggYSBnaXZlbiBjb250cm9sbGVyLFxyXG4gICAgKiBsb2NhbHMsIGFuZCBzY29wZS5cclxuICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgQW4gb3B0aW9ucyBvYmplY3QsIHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOlxyXG4gICAgKlxyXG4gICAgKiAgICAtIGBjb250cm9sbGVyYCAtIGB7KHN0cmluZz18ZnVuY3Rpb24oKT19YCBDb250cm9sbGVyIGZuIHRoYXQgc2hvdWxkIGJlIGFzc29jaWF0ZWQgd2l0aFxyXG4gICAgKiAgICAgIG5ld2x5IGNyZWF0ZWQgc2NvcGUgb3IgdGhlIG5hbWUgb2YgYSByZWdpc3RlcmVkIGNvbnRyb2xsZXIgaWYgcGFzc2VkIGFzIGEgc3RyaW5nLlxyXG4gICAgKiAgICAtIGBjb250cm9sbGVyQXNgIC0gYHtzdHJpbmc9fWAgQSBjb250cm9sbGVyIGFsaWFzIG5hbWUuIElmIHByZXNlbnQgdGhlIGNvbnRyb2xsZXIgd2lsbCBiZVxyXG4gICAgKiAgICAgIHB1Ymxpc2hlZCB0byBzY29wZSB1bmRlciB0aGUgYGNvbnRyb2xsZXJBc2AgbmFtZS5cclxuICAgICogICAgLSBgdGVtcGxhdGVgIC0gYHtzdHJpbmc9fWAgQW4gaHRtbCB0ZW1wbGF0ZSBhcyBhIHN0cmluZy5cclxuICAgICogICAgLSBgdGVtcGxhdGVVcmxgIC0gYHtzdHJpbmc9fWAgQSBwYXRoIHRvIGFuIGh0bWwgdGVtcGxhdGUuXHJcbiAgICAqICAgIC0gYHRyYW5zZm9ybVRlbXBsYXRlYCAtIGB7ZnVuY3Rpb24odGVtcGxhdGUpPX1gIEEgZnVuY3Rpb24gd2hpY2ggdHJhbnNmb3JtcyB0aGUgdGVtcGxhdGUgYWZ0ZXJcclxuICAgICogICAgICBpdCBpcyBsb2FkZWQuIEl0IHdpbGwgYmUgZ2l2ZW4gdGhlIHRlbXBsYXRlIHN0cmluZyBhcyBhIHBhcmFtZXRlciwgYW5kIHNob3VsZFxyXG4gICAgKiAgICAgIHJldHVybiBhIGEgbmV3IHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHRyYW5zZm9ybWVkIHRlbXBsYXRlLlxyXG4gICAgKiAgICAtIGByZXNvbHZlYCAtIGB7T2JqZWN0LjxzdHJpbmcsIGZ1bmN0aW9uPj19YCAtIEFuIG9wdGlvbmFsIG1hcCBvZiBkZXBlbmRlbmNpZXMgd2hpY2ggc2hvdWxkXHJcbiAgICAqICAgICAgYmUgaW5qZWN0ZWQgaW50byB0aGUgY29udHJvbGxlci4gSWYgYW55IG9mIHRoZXNlIGRlcGVuZGVuY2llcyBhcmUgcHJvbWlzZXMsIHRoZSBjb21waWxlclxyXG4gICAgKiAgICAgIHdpbGwgd2FpdCBmb3IgdGhlbSBhbGwgdG8gYmUgcmVzb2x2ZWQsIG9yIGlmIG9uZSBpcyByZWplY3RlZCBiZWZvcmUgdGhlIGNvbnRyb2xsZXIgaXNcclxuICAgICogICAgICBpbnN0YW50aWF0ZWQgYGNvbXBpbGUoKWAgd2lsbCBmYWlsLi5cclxuICAgICogICAgICAqIGBrZXlgIC0gYHtzdHJpbmd9YDogYSBuYW1lIG9mIGEgZGVwZW5kZW5jeSB0byBiZSBpbmplY3RlZCBpbnRvIHRoZSBjb250cm9sbGVyLlxyXG4gICAgKiAgICAgICogYGZhY3RvcnlgIC0gYHtzdHJpbmd8ZnVuY3Rpb259YDogSWYgYHN0cmluZ2AgdGhlbiBpdCBpcyBhbiBhbGlhcyBmb3IgYSBzZXJ2aWNlLlxyXG4gICAgKiAgICAgICAgT3RoZXJ3aXNlIGlmIGZ1bmN0aW9uLCB0aGVuIGl0IGlzIGluamVjdGVkIGFuZCB0aGUgcmV0dXJuIHZhbHVlIGlzIHRyZWF0ZWQgYXMgdGhlXHJcbiAgICAqICAgICAgICBkZXBlbmRlbmN5LiBJZiB0aGUgcmVzdWx0IGlzIGEgcHJvbWlzZSwgaXQgaXMgcmVzb2x2ZWQgYmVmb3JlIGl0cyB2YWx1ZSBpcyBcclxuICAgICogICAgICAgIGluamVjdGVkIGludG8gdGhlIGNvbnRyb2xsZXIuXHJcbiAgICAqXHJcbiAgICAqIEByZXR1cm5zIHtvYmplY3Q9fSBwcm9taXNlIEEgcHJvbWlzZSwgd2hpY2ggd2lsbCBiZSByZXNvbHZlZCB3aXRoIGEgYGNvbXBpbGVEYXRhYCBvYmplY3QuXHJcbiAgICAqIGBjb21waWxlRGF0YWAgaGFzIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczogXHJcbiAgICAqXHJcbiAgICAqICAgLSBgZWxlbWVudGAgLSBge2VsZW1lbnR9YDogYW4gdW5jb21waWxlZCBlbGVtZW50IG1hdGNoaW5nIHRoZSBwcm92aWRlZCB0ZW1wbGF0ZS5cclxuICAgICogICAtIGBsaW5rYCAtIGB7ZnVuY3Rpb24oc2NvcGUpfWA6IEEgbGluayBmdW5jdGlvbiwgd2hpY2gsIHdoZW4gY2FsbGVkLCB3aWxsIGNvbXBpbGVcclxuICAgICogICAgIHRoZSBlbGVtZW50IGFuZCBpbnN0YW50aWF0ZSB0aGUgcHJvdmlkZWQgY29udHJvbGxlciAoaWYgZ2l2ZW4pLlxyXG4gICAgKiAgIC0gYGxvY2Fsc2AgLSBge29iamVjdH1gOiBUaGUgbG9jYWxzIHdoaWNoIHdpbGwgYmUgcGFzc2VkIGludG8gdGhlIGNvbnRyb2xsZXIgb25jZSBgbGlua2AgaXNcclxuICAgICogICAgIGNhbGxlZC4gSWYgYGJpbmRUb0NvbnRyb2xsZXJgIGlzIHRydWUsIHRoZXkgd2lsbCBiZSBjb3BwaWVkIHRvIHRoZSBjdHJsIGluc3RlYWRcclxuICAgICogICAtIGBiaW5kVG9Db250cm9sbGVyYCAtIGBib29sYDogYmluZCB0aGUgbG9jYWxzIHRvIHRoZSBjb250cm9sbGVyLCBpbnN0ZWFkIG9mIHBhc3NpbmcgdGhlbSBpbi5cclxuICAgICovXHJcbiAgdGhpcy5jb21waWxlID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgdmFyIHRlbXBsYXRlVXJsID0gb3B0aW9ucy50ZW1wbGF0ZVVybDtcclxuICAgIHZhciB0ZW1wbGF0ZSA9IG9wdGlvbnMudGVtcGxhdGUgfHwgJyc7XHJcbiAgICB2YXIgY29udHJvbGxlciA9IG9wdGlvbnMuY29udHJvbGxlcjtcclxuICAgIHZhciBjb250cm9sbGVyQXMgPSBvcHRpb25zLmNvbnRyb2xsZXJBcztcclxuICAgIHZhciByZXNvbHZlID0gb3B0aW9ucy5yZXNvbHZlIHx8IHt9O1xyXG4gICAgdmFyIGxvY2FscyA9IG9wdGlvbnMubG9jYWxzIHx8IHt9O1xyXG4gICAgdmFyIHRyYW5zZm9ybVRlbXBsYXRlID0gb3B0aW9ucy50cmFuc2Zvcm1UZW1wbGF0ZSB8fCBhbmd1bGFyLmlkZW50aXR5O1xyXG4gICAgdmFyIGJpbmRUb0NvbnRyb2xsZXIgPSBvcHRpb25zLmJpbmRUb0NvbnRyb2xsZXI7XHJcblxyXG4gICAgLy8gVGFrZSByZXNvbHZlIHZhbHVlcyBhbmQgaW52b2tlIHRoZW0uICBcclxuICAgIC8vIFJlc29sdmVzIGNhbiBlaXRoZXIgYmUgYSBzdHJpbmcgKHZhbHVlOiAnTXlSZWdpc3RlcmVkQW5ndWxhckNvbnN0JyksXHJcbiAgICAvLyBvciBhbiBpbnZva2FibGUgJ2ZhY3RvcnknIG9mIHNvcnRzOiAodmFsdWU6IGZ1bmN0aW9uIFZhbHVlR2V0dGVyKCRkZXBlbmRlbmN5KSB7fSlcclxuICAgIGFuZ3VsYXIuZm9yRWFjaChyZXNvbHZlLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XHJcbiAgICAgIGlmIChhbmd1bGFyLmlzU3RyaW5nKHZhbHVlKSkge1xyXG4gICAgICAgIHJlc29sdmVba2V5XSA9ICRpbmplY3Rvci5nZXQodmFsdWUpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlc29sdmVba2V5XSA9ICRpbmplY3Rvci5pbnZva2UodmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIC8vQWRkIHRoZSBsb2NhbHMsIHdoaWNoIGFyZSBqdXN0IHN0cmFpZ2h0IHZhbHVlcyB0byBpbmplY3RcclxuICAgIC8vZWcgbG9jYWxzOiB7IHRocmVlOiAzIH0sIHdpbGwgaW5qZWN0IHRocmVlIGludG8gdGhlIGNvbnRyb2xsZXJcclxuICAgIGFuZ3VsYXIuZXh0ZW5kKHJlc29sdmUsIGxvY2Fscyk7XHJcblxyXG4gICAgaWYgKHRlbXBsYXRlVXJsKSB7XHJcbiAgICAgIHJlc29sdmUuJHRlbXBsYXRlID0gJGh0dHAuZ2V0KHRlbXBsYXRlVXJsLCB7Y2FjaGU6ICR0ZW1wbGF0ZUNhY2hlfSlcclxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXNvbHZlLiR0ZW1wbGF0ZSA9ICRxLndoZW4odGVtcGxhdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFdhaXQgZm9yIGFsbCB0aGUgcmVzb2x2ZXMgdG8gZmluaXNoIGlmIHRoZXkgYXJlIHByb21pc2VzXHJcbiAgICByZXR1cm4gJHEuYWxsKHJlc29sdmUpLnRoZW4oZnVuY3Rpb24obG9jYWxzKSB7XHJcblxyXG4gICAgICB2YXIgdGVtcGxhdGUgPSB0cmFuc2Zvcm1UZW1wbGF0ZShsb2NhbHMuJHRlbXBsYXRlKTtcclxuICAgICAgdmFyIGVsZW1lbnQgPSBvcHRpb25zLmVsZW1lbnQgfHwgYW5ndWxhci5lbGVtZW50KCc8ZGl2PicpLmh0bWwodGVtcGxhdGUudHJpbSgpKS5jb250ZW50cygpO1xyXG4gICAgICB2YXIgbGlua0ZuID0gJGNvbXBpbGUoZWxlbWVudCk7XHJcblxyXG4gICAgICAvL1JldHVybiBhIGxpbmtpbmcgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCBsYXRlciB3aGVuIHRoZSBlbGVtZW50IGlzIHJlYWR5XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbG9jYWxzOiBsb2NhbHMsXHJcbiAgICAgICAgZWxlbWVudDogZWxlbWVudCxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlKSB7XHJcbiAgICAgICAgICBsb2NhbHMuJHNjb3BlID0gc2NvcGU7XHJcblxyXG4gICAgICAgICAgLy9JbnN0YW50aWF0ZSBjb250cm9sbGVyIGlmIGl0IGV4aXN0cywgYmVjYXVzZSB3ZSBoYXZlIHNjb3BlXHJcbiAgICAgICAgICBpZiAoY29udHJvbGxlcikge1xyXG4gICAgICAgICAgICB2YXIgaW52b2tlQ3RybCA9ICRjb250cm9sbGVyKGNvbnRyb2xsZXIsIGxvY2FscywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGlmIChiaW5kVG9Db250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoaW52b2tlQ3RybC5pbnN0YW5jZSwgbG9jYWxzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgY3RybCA9IGludm9rZUN0cmwoKTtcclxuICAgICAgICAgICAgLy9TZWUgYW5ndWxhci1yb3V0ZSBzb3VyY2UgZm9yIHRoaXMgbG9naWNcclxuICAgICAgICAgICAgZWxlbWVudC5kYXRhKCckbmdDb250cm9sbGVyQ29udHJvbGxlcicsIGN0cmwpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmNoaWxkcmVuKCkuZGF0YSgnJG5nQ29udHJvbGxlckNvbnRyb2xsZXInLCBjdHJsKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjb250cm9sbGVyQXMpIHtcclxuICAgICAgICAgICAgICBzY29wZVtjb250cm9sbGVyQXNdID0gY3RybDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGxpbmtGbihzY29wZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG4gIH07XHJcbn1cclxubWRDb21waWxlclNlcnZpY2UuJGluamVjdCA9IFtcIiRxXCIsIFwiJGh0dHBcIiwgXCIkaW5qZWN0b3JcIiwgXCIkY29tcGlsZVwiLCBcIiRjb250cm9sbGVyXCIsIFwiJHRlbXBsYXRlQ2FjaGVcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIHZhciBIQU5ETEVSUyA9IHt9O1xyXG4gIC8qIFRoZSBzdGF0ZSBvZiB0aGUgY3VycmVudCAncG9pbnRlcidcclxuICAgKiBUaGUgcG9pbnRlciByZXByZXNlbnRzIHRoZSBzdGF0ZSBvZiB0aGUgY3VycmVudCB0b3VjaC5cclxuICAgKiBJdCBjb250YWlucyBub3JtYWxpemVkIHggYW5kIHkgY29vcmRpbmF0ZXMgZnJvbSBET00gZXZlbnRzLFxyXG4gICAqIGFzIHdlbGwgYXMgb3RoZXIgaW5mb3JtYXRpb24gYWJzdHJhY3RlZCBmcm9tIHRoZSBET00uXHJcbiAgICovXHJcbiAgdmFyIHBvaW50ZXIsIGxhc3RQb2ludGVyLCBmb3JjZVNraXBDbGlja0hpamFjayA9IGZhbHNlO1xyXG5cclxuICAvLyBVc2VkIHRvIGF0dGFjaCBldmVudCBsaXN0ZW5lcnMgb25jZSB3aGVuIG11bHRpcGxlIG5nLWFwcHMgYXJlIHJ1bm5pbmcuXHJcbiAgdmFyIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuICBcclxuICBhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb3JlLmdlc3R1cmVzJywgWyBdKVxyXG4gICAgLnByb3ZpZGVyKCckbWRHZXN0dXJlJywgTWRHZXN0dXJlUHJvdmlkZXIpXHJcbiAgICAuZmFjdG9yeSgnJCRNZEdlc3R1cmVIYW5kbGVyJywgTWRHZXN0dXJlSGFuZGxlcilcclxuICAgIC5ydW4oIGF0dGFjaFRvRG9jdW1lbnQgKTtcclxuXHJcbiAgLyoqXHJcbiAgICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAgICogQG5hbWUgJG1kR2VzdHVyZVByb3ZpZGVyXHJcbiAgICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmUuZ2VzdHVyZXNcclxuICAgICAqXHJcbiAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAqIEluIHNvbWUgc2NlbmFyaW9zIG9uIE1vYmlsZSBkZXZpY2VzICh3aXRob3V0IGpRdWVyeSksIHRoZSBjbGljayBldmVudHMgc2hvdWxkIE5PVCBiZSBoaWphY2tlZC5cclxuICAgICAqIGAkbWRHZXN0dXJlUHJvdmlkZXJgIGlzIHVzZWQgdG8gY29uZmlndXJlIHRoZSBHZXN0dXJlIG1vZHVsZSB0byBpZ25vcmUgb3Igc2tpcCBjbGljayBoaWphY2tpbmcgb24gbW9iaWxlXHJcbiAgICAgKiBkZXZpY2VzLlxyXG4gICAgICpcclxuICAgICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICAgICogICBhcHAuY29uZmlnKGZ1bmN0aW9uKCRtZEdlc3R1cmVQcm92aWRlcikge1xyXG4gICAgICpcclxuICAgICAqICAgICAvLyBGb3IgbW9iaWxlIGRldmljZXMgd2l0aG91dCBqUXVlcnkgbG9hZGVkLCBkbyBub3RcclxuICAgICAqICAgICAvLyBpbnRlcmNlcHQgY2xpY2sgZXZlbnRzIGR1cmluZyB0aGUgY2FwdHVyZSBwaGFzZS5cclxuICAgICAqICAgICAkbWRHZXN0dXJlUHJvdmlkZXIuc2tpcENsaWNrSGlqYWNrKCk7XHJcbiAgICAgKlxyXG4gICAgICogICB9KTtcclxuICAgICAqIDwvaGxqcz5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICBmdW5jdGlvbiBNZEdlc3R1cmVQcm92aWRlcigpIHsgfVxyXG5cclxuICBNZEdlc3R1cmVQcm92aWRlci5wcm90b3R5cGUgPSB7XHJcblxyXG4gICAgLy8gUHVibGlzaCBhY2Nlc3MgdG8gc2V0dGVyIHRvIGNvbmZpZ3VyZSBhIHZhcmlhYmxlICBCRUZPUkUgdGhlXHJcbiAgICAvLyAkbWRHZXN0dXJlIHNlcnZpY2UgaXMgaW5zdGFudGlhdGVkLi4uXHJcbiAgICBza2lwQ2xpY2tIaWphY2s6IGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gZm9yY2VTa2lwQ2xpY2tIaWphY2sgPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqICRnZXQgaXMgdXNlZCB0byBidWlsZCBhbiBpbnN0YW5jZSBvZiAkbWRHZXN0dXJlXHJcbiAgICAgKiBAbmdJbmplY3RcclxuICAgICAqL1xyXG4gICAgJGdldCA6IFtcIiQkTWRHZXN0dXJlSGFuZGxlclwiLCBcIiQkckFGXCIsIFwiJHRpbWVvdXRcIiwgZnVuY3Rpb24oJCRNZEdlc3R1cmVIYW5kbGVyLCAkJHJBRiwgJHRpbWVvdXQpIHtcclxuICAgICAgICAgcmV0dXJuIG5ldyBNZEdlc3R1cmUoJCRNZEdlc3R1cmVIYW5kbGVyLCAkJHJBRiwgJHRpbWVvdXQpO1xyXG4gICAgfV1cclxuICB9O1xyXG5cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIE1kR2VzdHVyZSBmYWN0b3J5IGNvbnN0cnVjdGlvbiBmdW5jdGlvblxyXG4gICAqIEBuZ0luamVjdFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIE1kR2VzdHVyZSgkJE1kR2VzdHVyZUhhbmRsZXIsICQkckFGLCAkdGltZW91dCkge1xyXG4gICAgdmFyIHVzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQgfHwgbmF2aWdhdG9yLnZlbmRvciB8fCB3aW5kb3cub3BlcmE7XHJcbiAgICB2YXIgaXNJb3MgPSB1c2VyQWdlbnQubWF0Y2goL2lwYWR8aXBob25lfGlwb2QvaSk7XHJcbiAgICB2YXIgaXNBbmRyb2lkID0gdXNlckFnZW50Lm1hdGNoKC9hbmRyb2lkL2kpO1xyXG4gICAgdmFyIGhhc0pRdWVyeSA9ICAodHlwZW9mIHdpbmRvdy5qUXVlcnkgIT09ICd1bmRlZmluZWQnKSAmJiAoYW5ndWxhci5lbGVtZW50ID09PSB3aW5kb3cualF1ZXJ5KTtcclxuXHJcbiAgICB2YXIgc2VsZiA9IHtcclxuICAgICAgaGFuZGxlcjogYWRkSGFuZGxlcixcclxuICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyLFxyXG4gICAgICAvLyBPbiBtb2JpbGUgdy9vdXQgalF1ZXJ5LCB3ZSBub3JtYWxseSBpbnRlcmNlcHQgY2xpY2tzLiBTaG91bGQgd2Ugc2tpcCB0aGF0P1xyXG4gICAgICBpc0hpamFja2luZ0NsaWNrczogKGlzSW9zIHx8IGlzQW5kcm9pZCkgJiYgIWhhc0pRdWVyeSAmJiAhZm9yY2VTa2lwQ2xpY2tIaWphY2tcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHNlbGYuaXNIaWphY2tpbmdDbGlja3MpIHtcclxuICAgICAgc2VsZi5oYW5kbGVyKCdjbGljaycsIHtcclxuICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICBtYXhEaXN0YW5jZTogNlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgICAgaWYgKHBvaW50ZXIuZGlzdGFuY2UgPCB0aGlzLnN0YXRlLm9wdGlvbnMubWF4RGlzdGFuY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnY2xpY2snKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICAgKiBSZWdpc3RlciBhbiBlbGVtZW50IHRvIGxpc3RlbiBmb3IgYSBoYW5kbGVyLlxyXG4gICAgICogVGhpcyBhbGxvd3MgYW4gZWxlbWVudCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBvcHRpb25zIGZvciBhIGhhbmRsZXIuXHJcbiAgICAgKiBBZGRpdGlvbmFsbHksIHNvbWUgaGFuZGxlcnMgbGlrZSBkcmFnIGFuZCBob2xkIG9ubHkgZGlzcGF0Y2ggZXZlbnRzIGlmXHJcbiAgICAgKiB0aGUgZG9tRXZlbnQgaGFwcGVucyBpbnNpZGUgYW4gZWxlbWVudCB0aGF0J3MgcmVnaXN0ZXJlZCB0byBsaXN0ZW4gZm9yIHRoZXNlIGV2ZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAc2VlIEdlc3R1cmVIYW5kbGVyIGZvciBob3cgb3ZlcnJpZGluZyBvZiBkZWZhdWx0IG9wdGlvbnMgd29ya3MuXHJcbiAgICAgKiBAZXhhbXBsZSAkbWRHZXN0dXJlLnJlZ2lzdGVyKG15RWxlbWVudCwgJ2RyYWcnLCB7IG1pbkRpc3RhbmNlOiAyMCwgaG9yemlvbnRhbDogZmFsc2UgfSlcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXIoZWxlbWVudCwgaGFuZGxlck5hbWUsIG9wdGlvbnMpIHtcclxuICAgICAgdmFyIGhhbmRsZXIgPSBIQU5ETEVSU1toYW5kbGVyTmFtZS5yZXBsYWNlKC9eXFwkbWQuLywgJycpXTtcclxuICAgICAgaWYgKCFoYW5kbGVyKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcmVnaXN0ZXIgZWxlbWVudCB3aXRoIGhhbmRsZXIgJyArIGhhbmRsZXJOYW1lICsgJy4gJyArXHJcbiAgICAgICAgJ0F2YWlsYWJsZSBoYW5kbGVyczogJyArIE9iamVjdC5rZXlzKEhBTkRMRVJTKS5qb2luKCcsICcpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gaGFuZGxlci5yZWdpc3RlckVsZW1lbnQoZWxlbWVudCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICAqIGFkZCBhIGhhbmRsZXIgdG8gJG1kR2VzdHVyZS4gc2VlIGJlbG93LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhZGRIYW5kbGVyKG5hbWUsIGRlZmluaXRpb24pIHtcclxuICAgICAgdmFyIGhhbmRsZXIgPSBuZXcgJCRNZEdlc3R1cmVIYW5kbGVyKG5hbWUpO1xyXG4gICAgICBhbmd1bGFyLmV4dGVuZChoYW5kbGVyLCBkZWZpbml0aW9uKTtcclxuICAgICAgSEFORExFUlNbbmFtZV0gPSBoYW5kbGVyO1xyXG5cclxuICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICAqIFJlZ2lzdGVyIGhhbmRsZXJzLiBUaGVzZSBsaXN0ZW4gdG8gdG91Y2gvc3RhcnQvbW92ZSBldmVudHMsIGludGVycHJldCB0aGVtLFxyXG4gICAgICogYW5kIGRpc3BhdGNoIGdlc3R1cmUgZXZlbnRzIGRlcGVuZGluZyBvbiBvcHRpb25zICYgY29uZGl0aW9ucy4gVGhlc2UgYXJlIGFsbFxyXG4gICAgICogaW5zdGFuY2VzIG9mIEdlc3R1cmVIYW5kbGVyLlxyXG4gICAgICogQHNlZSBHZXN0dXJlSGFuZGxlciBcclxuICAgICAqL1xyXG4gICAgcmV0dXJuIHNlbGZcclxuICAgICAgLypcclxuICAgICAgICogVGhlIHByZXNzIGhhbmRsZXIgZGlzcGF0Y2hlcyBhbiBldmVudCBvbiB0b3VjaGRvd24vdG91Y2hlbmQuXHJcbiAgICAgICAqIEl0J3MgYSBzaW1wbGUgYWJzdHJhY3Rpb24gb2YgdG91Y2gvbW91c2UvcG9pbnRlciBzdGFydCBhbmQgZW5kLlxyXG4gICAgICAgKi9cclxuICAgICAgLmhhbmRsZXIoJ3ByZXNzJywge1xyXG4gICAgICAgIG9uU3RhcnQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLnByZXNzZG93bicpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLnByZXNzdXAnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgKiBUaGUgaG9sZCBoYW5kbGVyIGRpc3BhdGNoZXMgYW4gZXZlbnQgaWYgdGhlIHVzZXIga2VlcHMgdGhlaXIgZmluZ2VyIHdpdGhpblxyXG4gICAgICAgKiB0aGUgc2FtZSA8bWF4RGlzdGFuY2U+IGFyZWEgZm9yIDxkZWxheT4gbXMuXHJcbiAgICAgICAqIFRoZSBob2xkIGhhbmRsZXIgd2lsbCBvbmx5IHJ1biBpZiBhIHBhcmVudCBvZiB0aGUgdG91Y2ggdGFyZ2V0IGlzIHJlZ2lzdGVyZWRcclxuICAgICAgICogdG8gbGlzdGVuIGZvciBob2xkIGV2ZW50cyB0aHJvdWdoICRtZEdlc3R1cmUucmVnaXN0ZXIoKVxyXG4gICAgICAgKi9cclxuICAgICAgLmhhbmRsZXIoJ2hvbGQnLCB7XHJcbiAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgbWF4RGlzdGFuY2U6IDYsXHJcbiAgICAgICAgICBkZWxheTogNTAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkNhbmNlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRoaXMuc3RhdGUudGltZW91dCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvblN0YXJ0OiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcclxuICAgICAgICAgIC8vIEZvciBob2xkLCByZXF1aXJlIGEgcGFyZW50IHRvIGJlIHJlZ2lzdGVyZWQgd2l0aCAkbWRHZXN0dXJlLnJlZ2lzdGVyKClcclxuICAgICAgICAgIC8vIEJlY2F1c2Ugd2UgcHJldmVudCBzY3JvbGwgZXZlbnRzLCB0aGlzIGlzIG5lY2Vzc2FyeS5cclxuICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5yZWdpc3RlcmVkUGFyZW50KSByZXR1cm4gdGhpcy5jYW5jZWwoKTtcclxuXHJcbiAgICAgICAgICB0aGlzLnN0YXRlLnBvcyA9IHt4OiBwb2ludGVyLngsIHk6IHBvaW50ZXIueX07XHJcbiAgICAgICAgICB0aGlzLnN0YXRlLnRpbWVvdXQgPSAkdGltZW91dChhbmd1bGFyLmJpbmQodGhpcywgZnVuY3Rpb24gaG9sZERlbGF5Rm4oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldiwgJyRtZC5ob2xkJyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FuY2VsKCk7IC8vd2UncmUgZG9uZSFcclxuICAgICAgICAgIH0pLCB0aGlzLnN0YXRlLm9wdGlvbnMuZGVsYXksIGZhbHNlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uTW92ZTogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgICAvLyBEb24ndCBzY3JvbGwgd2hpbGUgd2FpdGluZyBmb3IgaG9sZC5cclxuICAgICAgICAgIC8vIElmIHdlIGRvbid0IHByZXZlbnREZWZhdWx0IHRvdWNobW92ZSBldmVudHMgaGVyZSwgQW5kcm9pZCB3aWxsIGFzc3VtZSB3ZSBkb24ndFxyXG4gICAgICAgICAgLy8gd2FudCB0byBsaXN0ZW4gdG8gYW55bW9yZSB0b3VjaCBldmVudHMuIEl0IHdpbGwgc3RhcnQgc2Nyb2xsaW5nIGFuZCBzdG9wIHNlbmRpbmdcclxuICAgICAgICAgIC8vIHRvdWNobW92ZSBldmVudHMuXHJcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAgIC8vIElmIHRoZSB1c2VyIG1vdmVzIGdyZWF0ZXIgdGhhbiA8bWF4RGlzdGFuY2U+IHBpeGVscywgc3RvcCB0aGUgaG9sZCB0aW1lclxyXG4gICAgICAgICAgLy8gc2V0IGluIG9uU3RhcnRcclxuICAgICAgICAgIHZhciBkeCA9IHRoaXMuc3RhdGUucG9zLnggLSBwb2ludGVyLng7XHJcbiAgICAgICAgICB2YXIgZHkgPSB0aGlzLnN0YXRlLnBvcy55IC0gcG9pbnRlci55O1xyXG4gICAgICAgICAgaWYgKE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSkgPiB0aGlzLm9wdGlvbnMubWF4RGlzdGFuY2UpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW5jZWwoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRW5kOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB0aGlzLm9uQ2FuY2VsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLypcclxuICAgICAgICogVGhlIGRyYWcgaGFuZGxlciBkaXNwYXRjaGVzIGEgZHJhZyBldmVudCBpZiB0aGUgdXNlciBob2xkcyBhbmQgbW92ZXMgaGlzIGZpbmdlciBncmVhdGVyIHRoYW5cclxuICAgICAgICogPG1pbkRpc3RhbmNlPiBweCBpbiB0aGUgeCBvciB5IGRpcmVjdGlvbiwgZGVwZW5kaW5nIG9uIG9wdGlvbnMuaG9yaXpvbnRhbC5cclxuICAgICAgICogVGhlIGRyYWcgd2lsbCBiZSBjYW5jZWxsZWQgaWYgdGhlIHVzZXIgbW92ZXMgaGlzIGZpbmdlciBncmVhdGVyIHRoYW4gPG1pbkRpc3RhbmNlPio8Y2FuY2VsTXVsdGlwbGllcj4gaW5cclxuICAgICAgICogdGhlIHBlcnBpbmRpY3VsYXIgZGlyZWN0aW9uLiBFZyBpZiB0aGUgZHJhZyBpcyBob3Jpem9udGFsIGFuZCB0aGUgdXNlciBtb3ZlcyBoaXMgZmluZ2VyIDxtaW5EaXN0YW5jZT4qPGNhbmNlbE11bHRpcGxpZXI+XHJcbiAgICAgICAqIHBpeGVscyB2ZXJ0aWNhbGx5LCB0aGlzIGhhbmRsZXIgd29uJ3QgY29uc2lkZXIgdGhlIG1vdmUgcGFydCBvZiBhIGRyYWcuXHJcbiAgICAgICAqL1xyXG4gICAgICAuaGFuZGxlcignZHJhZycsIHtcclxuICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICBtaW5EaXN0YW5jZTogNixcclxuICAgICAgICAgIGhvcml6b250YWw6IHRydWUsXHJcbiAgICAgICAgICBjYW5jZWxNdWx0aXBsaWVyOiAxLjVcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uU3RhcnQ6IGZ1bmN0aW9uIChldikge1xyXG4gICAgICAgICAgLy8gRm9yIGRyYWcsIHJlcXVpcmUgYSBwYXJlbnQgdG8gYmUgcmVnaXN0ZXJlZCB3aXRoICRtZEdlc3R1cmUucmVnaXN0ZXIoKVxyXG4gICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnJlZ2lzdGVyZWRQYXJlbnQpIHRoaXMuY2FuY2VsKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbk1vdmU6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgICAgdmFyIHNob3VsZFN0YXJ0RHJhZywgc2hvdWxkQ2FuY2VsO1xyXG4gICAgICAgICAgLy8gRG9uJ3Qgc2Nyb2xsIHdoaWxlIGRlY2lkaW5nIGlmIHRoaXMgdG91Y2htb3ZlIHF1YWxpZmllcyBhcyBhIGRyYWcgZXZlbnQuXHJcbiAgICAgICAgICAvLyBJZiB3ZSBkb24ndCBwcmV2ZW50RGVmYXVsdCB0b3VjaG1vdmUgZXZlbnRzIGhlcmUsIEFuZHJvaWQgd2lsbCBhc3N1bWUgd2UgZG9uJ3RcclxuICAgICAgICAgIC8vIHdhbnQgdG8gbGlzdGVuIHRvIGFueW1vcmUgdG91Y2ggZXZlbnRzLiBJdCB3aWxsIHN0YXJ0IHNjcm9sbGluZyBhbmQgc3RvcCBzZW5kaW5nXHJcbiAgICAgICAgICAvLyB0b3VjaG1vdmUgZXZlbnRzLlxyXG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUub3B0aW9ucy5ob3Jpem9udGFsKSB7XHJcbiAgICAgICAgICAgICAgc2hvdWxkU3RhcnREcmFnID0gTWF0aC5hYnMocG9pbnRlci5kaXN0YW5jZVgpID4gdGhpcy5zdGF0ZS5vcHRpb25zLm1pbkRpc3RhbmNlO1xyXG4gICAgICAgICAgICAgIHNob3VsZENhbmNlbCA9IE1hdGguYWJzKHBvaW50ZXIuZGlzdGFuY2VZKSA+IHRoaXMuc3RhdGUub3B0aW9ucy5taW5EaXN0YW5jZSAqIHRoaXMuc3RhdGUub3B0aW9ucy5jYW5jZWxNdWx0aXBsaWVyO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHNob3VsZFN0YXJ0RHJhZyA9IE1hdGguYWJzKHBvaW50ZXIuZGlzdGFuY2VZKSA+IHRoaXMuc3RhdGUub3B0aW9ucy5taW5EaXN0YW5jZTtcclxuICAgICAgICAgICAgICBzaG91bGRDYW5jZWwgPSBNYXRoLmFicyhwb2ludGVyLmRpc3RhbmNlWCkgPiB0aGlzLnN0YXRlLm9wdGlvbnMubWluRGlzdGFuY2UgKiB0aGlzLnN0YXRlLm9wdGlvbnMuY2FuY2VsTXVsdGlwbGllcjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHNob3VsZFN0YXJ0RHJhZykge1xyXG4gICAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBwb2ludGVyIHJlcHJlc2VudGluZyB0aGlzIGRyYWcsIHN0YXJ0aW5nIGF0IHRoaXMgcG9pbnQgd2hlcmUgdGhlIGRyYWcgc3RhcnRlZC5cclxuICAgICAgICAgICAgICB0aGlzLnN0YXRlLmRyYWdQb2ludGVyID0gbWFrZVN0YXJ0UG9pbnRlcihldik7XHJcbiAgICAgICAgICAgICAgdXBkYXRlUG9pbnRlclN0YXRlKGV2LCB0aGlzLnN0YXRlLmRyYWdQb2ludGVyKTtcclxuICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZXYsICckbWQuZHJhZ3N0YXJ0JywgdGhpcy5zdGF0ZS5kcmFnUG9pbnRlcik7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZENhbmNlbCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hEcmFnTW92ZShldik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAvLyBPbmx5IGRpc3BhdGNoIGRyYWdtb3ZlIGV2ZW50cyBldmVyeSBmcmFtZTsgYW55IG1vcmUgaXMgdW5uZWNlc3NyYXlcclxuICAgICAgICBkaXNwYXRjaERyYWdNb3ZlOiAkJHJBRi50aHJvdHRsZShmdW5jdGlvbiAoZXYpIHtcclxuICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgZHJhZyBkaWRuJ3Qgc3RvcCB3aGlsZSB3YWl0aW5nIGZvciB0aGUgbmV4dCBmcmFtZVxyXG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGUuaXNSdW5uaW5nKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVBvaW50ZXJTdGF0ZShldiwgdGhpcy5zdGF0ZS5kcmFnUG9pbnRlcik7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldiwgJyRtZC5kcmFnJywgdGhpcy5zdGF0ZS5kcmFnUG9pbnRlcik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSksXHJcbiAgICAgICAgb25FbmQ6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgICAgaWYgKHRoaXMuc3RhdGUuZHJhZ1BvaW50ZXIpIHtcclxuICAgICAgICAgICAgdXBkYXRlUG9pbnRlclN0YXRlKGV2LCB0aGlzLnN0YXRlLmRyYWdQb2ludGVyKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCAnJG1kLmRyYWdlbmQnLCB0aGlzLnN0YXRlLmRyYWdQb2ludGVyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgKiBUaGUgc3dpcGUgaGFuZGxlciB3aWxsIGRpc3BhdGNoIGEgc3dpcGUgZXZlbnQgaWYsIG9uIHRoZSBlbmQgb2YgYSB0b3VjaCxcclxuICAgICAgICogdGhlIHZlbG9jaXR5IGFuZCBkaXN0YW5jZSB3ZXJlIGhpZ2ggZW5vdWdoLlxyXG4gICAgICAgKiBUT0RPOiBhZGQgdmVydGljYWwgc3dpcGluZyB3aXRoIGEgYGhvcml6b250YWxgIG9wdGlvbiBzaW1pbGFyIHRvIHRoZSBkcmFnIGhhbmRsZXIuXHJcbiAgICAgICAqL1xyXG4gICAgICAuaGFuZGxlcignc3dpcGUnLCB7XHJcbiAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgbWluVmVsb2NpdHk6IDAuNjUsXHJcbiAgICAgICAgICBtaW5EaXN0YW5jZTogMTBcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRW5kOiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcclxuICAgICAgICAgIGlmIChNYXRoLmFicyhwb2ludGVyLnZlbG9jaXR5WCkgPiB0aGlzLnN0YXRlLm9wdGlvbnMubWluVmVsb2NpdHkgJiZcclxuICAgICAgICAgICAgTWF0aC5hYnMocG9pbnRlci5kaXN0YW5jZVgpID4gdGhpcy5zdGF0ZS5vcHRpb25zLm1pbkRpc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHZhciBldmVudFR5cGUgPSBwb2ludGVyLmRpcmVjdGlvblggPT0gJ2xlZnQnID8gJyRtZC5zd2lwZWxlZnQnIDogJyRtZC5zd2lwZXJpZ2h0JztcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2LCBldmVudFR5cGUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gIH1cclxuICBNZEdlc3R1cmUuJGluamVjdCA9IFtcIiQkTWRHZXN0dXJlSGFuZGxlclwiLCBcIiQkckFGXCIsIFwiJHRpbWVvdXRcIl07XHJcblxyXG4gIC8qKlxyXG4gICAqIE1kR2VzdHVyZUhhbmRsZXJcclxuICAgKiBBIEdlc3R1cmVIYW5kbGVyIGlzIGFuIG9iamVjdCB3aGljaCBpcyBhYmxlIHRvIGRpc3BhdGNoIGN1c3RvbSBkb20gZXZlbnRzXHJcbiAgICogYmFzZWQgb24gbmF0aXZlIGRvbSB7dG91Y2gscG9pbnRlcixtb3VzZX17c3RhcnQsbW92ZSxlbmR9IGV2ZW50cy5cclxuICAgKlxyXG4gICAqIEEgZ2VzdHVyZSB3aWxsIG1hbmFnZSBpdHMgbGlmZWN5Y2xlIHRocm91Z2ggdGhlIHN0YXJ0LG1vdmUsZW5kLCBhbmQgY2FuY2VsXHJcbiAgICogZnVuY3Rpb25zLCB3aGljaCBhcmUgY2FsbGVkIGJ5IG5hdGl2ZSBkb20gZXZlbnRzLlxyXG4gICAqXHJcbiAgICogQSBnZXN0dXJlIGhhcyB0aGUgY29uY2VwdCBvZiAnb3B0aW9ucycgKGVnIGEgc3dpcGUncyByZXF1aXJlZCB2ZWxvY2l0eSksIHdoaWNoIGNhbiBiZVxyXG4gICAqIG92ZXJyaWRkZW4gYnkgZWxlbWVudHMgcmVnaXN0ZXJpbmcgdGhyb3VnaCAkbWRHZXN0dXJlLnJlZ2lzdGVyKClcclxuICAgKi9cclxuICBmdW5jdGlvbiBHZXN0dXJlSGFuZGxlciAobmFtZSkge1xyXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIHRoaXMuc3RhdGUgPSB7fTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIE1kR2VzdHVyZUhhbmRsZXIoKSB7XHJcbiAgICB2YXIgaGFzSlF1ZXJ5ID0gICh0eXBlb2Ygd2luZG93LmpRdWVyeSAhPT0gJ3VuZGVmaW5lZCcpICYmIChhbmd1bGFyLmVsZW1lbnQgPT09IHdpbmRvdy5qUXVlcnkpO1xyXG5cclxuICAgIEdlc3R1cmVIYW5kbGVyLnByb3RvdHlwZSA9IHtcclxuICAgICAgb3B0aW9uczoge30sXHJcbiAgICAgIC8vIGpRdWVyeSBsaXN0ZW5lcnMgZG9uJ3Qgd29yayB3aXRoIGN1c3RvbSBET01FdmVudHMsIHNvIHdlIGhhdmUgdG8gZGlzcGF0Y2ggZXZlbnRzXHJcbiAgICAgIC8vIGRpZmZlcmVudGx5IHdoZW4galF1ZXJ5IGlzIGxvYWRlZFxyXG4gICAgICBkaXNwYXRjaEV2ZW50OiBoYXNKUXVlcnkgPyAgalF1ZXJ5RGlzcGF0Y2hFdmVudCA6IG5hdGl2ZURpc3BhdGNoRXZlbnQsXHJcblxyXG4gICAgICAvLyBUaGVzZSBhcmUgb3ZlcnJpZGRlbiBieSB0aGUgcmVnaXN0ZXJlZCBoYW5kbGVyXHJcbiAgICAgIG9uU3RhcnQ6IGFuZ3VsYXIubm9vcCxcclxuICAgICAgb25Nb3ZlOiBhbmd1bGFyLm5vb3AsXHJcbiAgICAgIG9uRW5kOiBhbmd1bGFyLm5vb3AsXHJcbiAgICAgIG9uQ2FuY2VsOiBhbmd1bGFyLm5vb3AsXHJcblxyXG4gICAgICAvLyBvblN0YXJ0IHNldHMgdXAgYSBuZXcgc3RhdGUgZm9yIHRoZSBoYW5kbGVyLCB3aGljaCBpbmNsdWRlcyBvcHRpb25zIGZyb20gdGhlXHJcbiAgICAgIC8vIG5lYXJlc3QgcmVnaXN0ZXJlZCBwYXJlbnQgZWxlbWVudCBvZiBldi50YXJnZXQuXHJcbiAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoZXYsIHBvaW50ZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGF0ZS5pc1J1bm5pbmcpIHJldHVybjtcclxuICAgICAgICB2YXIgcGFyZW50VGFyZ2V0ID0gdGhpcy5nZXROZWFyZXN0UGFyZW50KGV2LnRhcmdldCk7XHJcbiAgICAgICAgLy8gR2V0IHRoZSBvcHRpb25zIGZyb20gdGhlIG5lYXJlc3QgcmVnaXN0ZXJlZCBwYXJlbnRcclxuICAgICAgICB2YXIgcGFyZW50VGFyZ2V0T3B0aW9ucyA9IHBhcmVudFRhcmdldCAmJiBwYXJlbnRUYXJnZXQuJG1kR2VzdHVyZVt0aGlzLm5hbWVdIHx8IHt9O1xyXG5cclxuICAgICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgICAgaXNSdW5uaW5nOiB0cnVlLFxyXG4gICAgICAgICAgLy8gT3ZlcnJpZGUgdGhlIGRlZmF1bHQgb3B0aW9ucyB3aXRoIHRoZSBuZWFyZXN0IHJlZ2lzdGVyZWQgcGFyZW50J3Mgb3B0aW9uc1xyXG4gICAgICAgICAgb3B0aW9uczogYW5ndWxhci5leHRlbmQoe30sIHRoaXMub3B0aW9ucywgcGFyZW50VGFyZ2V0T3B0aW9ucyksXHJcbiAgICAgICAgICAvLyBQYXNzIGluIHRoZSByZWdpc3RlcmVkIHBhcmVudCBub2RlIHRvIHRoZSBzdGF0ZSBzbyB0aGUgb25TdGFydCBsaXN0ZW5lciBjYW4gdXNlXHJcbiAgICAgICAgICByZWdpc3RlcmVkUGFyZW50OiBwYXJlbnRUYXJnZXRcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub25TdGFydChldiwgcG9pbnRlcik7XHJcbiAgICAgIH0sXHJcbiAgICAgIG1vdmU6IGZ1bmN0aW9uIChldiwgcG9pbnRlcikge1xyXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5pc1J1bm5pbmcpIHJldHVybjtcclxuICAgICAgICB0aGlzLm9uTW92ZShldiwgcG9pbnRlcik7XHJcbiAgICAgIH0sXHJcbiAgICAgIGVuZDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzUnVubmluZykgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMub25FbmQoZXYsIHBvaW50ZXIpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUuaXNSdW5uaW5nID0gZmFsc2U7XHJcbiAgICAgIH0sXHJcbiAgICAgIGNhbmNlbDogZnVuY3Rpb24gKGV2LCBwb2ludGVyKSB7XHJcbiAgICAgICAgdGhpcy5vbkNhbmNlbChldiwgcG9pbnRlcik7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLy8gRmluZCBhbmQgcmV0dXJuIHRoZSBuZWFyZXN0IHBhcmVudCBlbGVtZW50IHRoYXQgaGFzIGJlZW4gcmVnaXN0ZXJlZCB0b1xyXG4gICAgICAvLyBsaXN0ZW4gZm9yIHRoaXMgaGFuZGxlciB2aWEgJG1kR2VzdHVyZS5yZWdpc3RlcihlbGVtZW50LCAnaGFuZGxlck5hbWUnKS5cclxuICAgICAgZ2V0TmVhcmVzdFBhcmVudDogZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgICB2YXIgY3VycmVudCA9IG5vZGU7XHJcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQpIHtcclxuICAgICAgICAgIGlmICgoY3VycmVudC4kbWRHZXN0dXJlIHx8IHt9KVt0aGlzLm5hbWVdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50Tm9kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvLyBDYWxsZWQgZnJvbSAkbWRHZXN0dXJlLnJlZ2lzdGVyIHdoZW4gYW4gZWxlbWVudCByZWlnc3RlcnMgaXRzZWxmIHdpdGggYSBoYW5kbGVyLlxyXG4gICAgICAvLyBTdG9yZSB0aGUgb3B0aW9ucyB0aGUgdXNlciBnYXZlIG9uIHRoZSBET01FbGVtZW50IGl0c2VsZi4gVGhlc2Ugb3B0aW9ucyB3aWxsXHJcbiAgICAgIC8vIGJlIHJldHJpZXZlZCB3aXRoIGdldE5lYXJlc3RQYXJlbnQgd2hlbiB0aGUgaGFuZGxlciBzdGFydHMuXHJcbiAgICAgIHJlZ2lzdGVyRWxlbWVudDogZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZWxlbWVudFswXS4kbWRHZXN0dXJlID0gZWxlbWVudFswXS4kbWRHZXN0dXJlIHx8IHt9O1xyXG4gICAgICAgIGVsZW1lbnRbMF0uJG1kR2VzdHVyZVt0aGlzLm5hbWVdID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICBlbGVtZW50Lm9uKCckZGVzdHJveScsIG9uRGVzdHJveSk7XHJcblxyXG4gICAgICAgIHJldHVybiBvbkRlc3Ryb3k7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uRGVzdHJveSgpIHtcclxuICAgICAgICAgIGRlbGV0ZSBlbGVtZW50WzBdLiRtZEdlc3R1cmVbc2VsZi5uYW1lXTtcclxuICAgICAgICAgIGVsZW1lbnQub2ZmKCckZGVzdHJveScsIG9uRGVzdHJveSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBHZXN0dXJlSGFuZGxlcjtcclxuXHJcbiAgICAvKlxyXG4gICAgICogRGlzcGF0Y2ggYW4gZXZlbnQgd2l0aCBqUXVlcnlcclxuICAgICAqIFRPRE86IE1ha2Ugc3VyZSB0aGlzIHNlbmRzIGJ1YmJsaW5nIGV2ZW50c1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzcmNFdmVudCB0aGUgb3JpZ2luYWwgRE9NIHRvdWNoIGV2ZW50IHRoYXQgc3RhcnRlZCB0aGlzLlxyXG4gICAgICogQHBhcmFtIGV2ZW50VHlwZSB0aGUgbmFtZSBvZiB0aGUgY3VzdG9tIGV2ZW50IHRvIHNlbmQgKGVnICdjbGljaycgb3IgJyRtZC5kcmFnJylcclxuICAgICAqIEBwYXJhbSBldmVudFBvaW50ZXIgdGhlIHBvaW50ZXIgb2JqZWN0IHRoYXQgbWF0Y2hlcyB0aGlzIGV2ZW50LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBqUXVlcnlEaXNwYXRjaEV2ZW50KHNyY0V2ZW50LCBldmVudFR5cGUsIGV2ZW50UG9pbnRlcikge1xyXG4gICAgICBldmVudFBvaW50ZXIgPSBldmVudFBvaW50ZXIgfHwgcG9pbnRlcjtcclxuICAgICAgdmFyIGV2ZW50T2JqID0gbmV3IGFuZ3VsYXIuZWxlbWVudC5FdmVudChldmVudFR5cGUpO1xyXG5cclxuICAgICAgZXZlbnRPYmouJG1hdGVyaWFsID0gdHJ1ZTtcclxuICAgICAgZXZlbnRPYmoucG9pbnRlciA9IGV2ZW50UG9pbnRlcjtcclxuICAgICAgZXZlbnRPYmouc3JjRXZlbnQgPSBzcmNFdmVudDtcclxuXHJcbiAgICAgIGFuZ3VsYXIuZXh0ZW5kKGV2ZW50T2JqLCB7XHJcbiAgICAgICAgY2xpZW50WDogZXZlbnRQb2ludGVyLngsXHJcbiAgICAgICAgY2xpZW50WTogZXZlbnRQb2ludGVyLnksXHJcbiAgICAgICAgc2NyZWVuWDogZXZlbnRQb2ludGVyLngsXHJcbiAgICAgICAgc2NyZWVuWTogZXZlbnRQb2ludGVyLnksXHJcbiAgICAgICAgcGFnZVg6IGV2ZW50UG9pbnRlci54LFxyXG4gICAgICAgIHBhZ2VZOiBldmVudFBvaW50ZXIueSxcclxuICAgICAgICBjdHJsS2V5OiBzcmNFdmVudC5jdHJsS2V5LFxyXG4gICAgICAgIGFsdEtleTogc3JjRXZlbnQuYWx0S2V5LFxyXG4gICAgICAgIHNoaWZ0S2V5OiBzcmNFdmVudC5zaGlmdEtleSxcclxuICAgICAgICBtZXRhS2V5OiBzcmNFdmVudC5tZXRhS2V5XHJcbiAgICAgIH0pO1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoZXZlbnRQb2ludGVyLnRhcmdldCkudHJpZ2dlcihldmVudE9iaik7XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICAqIE5PVEU6IG5hdGl2ZURpc3BhdGNoRXZlbnQgaXMgdmVyeSBwZXJmb3JtYW5jZSBzZW5zaXRpdmUuXHJcbiAgICAgKiBAcGFyYW0gc3JjRXZlbnQgdGhlIG9yaWdpbmFsIERPTSB0b3VjaCBldmVudCB0aGF0IHN0YXJ0ZWQgdGhpcy5cclxuICAgICAqIEBwYXJhbSBldmVudFR5cGUgdGhlIG5hbWUgb2YgdGhlIGN1c3RvbSBldmVudCB0byBzZW5kIChlZyAnY2xpY2snIG9yICckbWQuZHJhZycpXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRQb2ludGVyIHRoZSBwb2ludGVyIG9iamVjdCB0aGF0IG1hdGNoZXMgdGhpcyBldmVudC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbmF0aXZlRGlzcGF0Y2hFdmVudChzcmNFdmVudCwgZXZlbnRUeXBlLCBldmVudFBvaW50ZXIpIHtcclxuICAgICAgZXZlbnRQb2ludGVyID0gZXZlbnRQb2ludGVyIHx8IHBvaW50ZXI7XHJcbiAgICAgIHZhciBldmVudE9iajtcclxuXHJcbiAgICAgIGlmIChldmVudFR5cGUgPT09ICdjbGljaycpIHtcclxuICAgICAgICBldmVudE9iaiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50cycpO1xyXG4gICAgICAgIGV2ZW50T2JqLmluaXRNb3VzZUV2ZW50KFxyXG4gICAgICAgICAgJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSwgd2luZG93LCBzcmNFdmVudC5kZXRhaWwsXHJcbiAgICAgICAgICBldmVudFBvaW50ZXIueCwgZXZlbnRQb2ludGVyLnksIGV2ZW50UG9pbnRlci54LCBldmVudFBvaW50ZXIueSxcclxuICAgICAgICAgIHNyY0V2ZW50LmN0cmxLZXksIHNyY0V2ZW50LmFsdEtleSwgc3JjRXZlbnQuc2hpZnRLZXksIHNyY0V2ZW50Lm1ldGFLZXksXHJcbiAgICAgICAgICBzcmNFdmVudC5idXR0b24sIHNyY0V2ZW50LnJlbGF0ZWRUYXJnZXQgfHwgbnVsbFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGV2ZW50T2JqID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XHJcbiAgICAgICAgZXZlbnRPYmouaW5pdEN1c3RvbUV2ZW50KGV2ZW50VHlwZSwgdHJ1ZSwgdHJ1ZSwge30pO1xyXG4gICAgICB9XHJcbiAgICAgIGV2ZW50T2JqLiRtYXRlcmlhbCA9IHRydWU7XHJcbiAgICAgIGV2ZW50T2JqLnBvaW50ZXIgPSBldmVudFBvaW50ZXI7XHJcbiAgICAgIGV2ZW50T2JqLnNyY0V2ZW50ID0gc3JjRXZlbnQ7XHJcbiAgICAgIGV2ZW50UG9pbnRlci50YXJnZXQuZGlzcGF0Y2hFdmVudChldmVudE9iaik7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQXR0YWNoIEdlc3R1cmVzOiBob29rIGRvY3VtZW50IGFuZCBjaGVjayBzaG91bGRIaWphY2sgY2xpY2tzXHJcbiAgICogQG5nSW5qZWN0XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gYXR0YWNoVG9Eb2N1bWVudCggJG1kR2VzdHVyZSwgJCRNZEdlc3R1cmVIYW5kbGVyICkge1xyXG5cclxuICAgIC8vIFBvbHlmaWxsIGRvY3VtZW50LmNvbnRhaW5zIGZvciBJRTExLlxyXG4gICAgLy8gVE9ETzogbW92ZSB0byB1dGlsXHJcbiAgICBkb2N1bWVudC5jb250YWlucyB8fCAoZG9jdW1lbnQuY29udGFpbnMgPSBmdW5jdGlvbiAobm9kZSkge1xyXG4gICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5jb250YWlucyhub2RlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghaXNJbml0aWFsaXplZCAmJiAkbWRHZXN0dXJlLmlzSGlqYWNraW5nQ2xpY2tzICkge1xyXG4gICAgICAvKlxyXG4gICAgICAgKiBJZiBoaWphY2sgY2xpY2tzIGlzIHRydWUsIHdlIHByZXZlbnREZWZhdWx0IGFueSBjbGljayB0aGF0IHdhc24ndFxyXG4gICAgICAgKiBzZW50IGJ5IG5nTWF0ZXJpYWwuIFRoaXMgaXMgYmVjYXVzZSBvbiBvbGRlciBBbmRyb2lkICYgaU9TLCBhIGZhbHNlLCBvciAnZ2hvc3QnLFxyXG4gICAgICAgKiBjbGljayBldmVudCB3aWxsIGJlIHNlbnQgfjQwMG1zIGFmdGVyIGEgdG91Y2hlbmQgZXZlbnQgaGFwcGVucy5cclxuICAgICAgICogVGhlIG9ubHkgd2F5IHRvIGtub3cgaWYgdGhpcyBjbGljayBpcyByZWFsIGlzIHRvIHByZXZlbnQgYW55IG5vcm1hbFxyXG4gICAgICAgKiBjbGljayBldmVudHMsIGFuZCBhZGQgYSBmbGFnIHRvIGV2ZW50cyBzZW50IGJ5IG1hdGVyaWFsIHNvIHdlIGtub3cgbm90IHRvIHByZXZlbnQgdGhvc2UuXHJcbiAgICAgICAqIFxyXG4gICAgICAgKiBUd28gZXhjZXB0aW9ucyB0byBjbGljayBldmVudHMgdGhhdCBzaG91bGQgYmUgcHJldmVudGVkIGFyZTpcclxuICAgICAgICogIC0gY2xpY2sgZXZlbnRzIHNlbnQgYnkgdGhlIGtleWJvYXJkIChlZyBmb3JtIHN1Ym1pdClcclxuICAgICAgICogIC0gZXZlbnRzIHRoYXQgb3JpZ2luYXRlIGZyb20gYW4gSW9uaWMgYXBwXHJcbiAgICAgICAqL1xyXG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIGNsaWNrSGlqYWNrZXIoZXYpIHtcclxuICAgICAgICB2YXIgaXNLZXlDbGljayA9IGV2LmNsaWVudFggPT09IDAgJiYgZXYuY2xpZW50WSA9PT0gMDtcclxuICAgICAgICBpZiAoIWlzS2V5Q2xpY2sgJiYgIWV2LiRtYXRlcmlhbCAmJiAhZXYuaXNJb25pY1RhcCkge1xyXG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgIFxyXG4gICAgICBpc0luaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBMaXN0ZW4gdG8gYWxsIGV2ZW50cyB0byBjb3ZlciBhbGwgcGxhdGZvcm1zLlxyXG4gICAgdmFyIFNUQVJUX0VWRU5UUyA9ICdtb3VzZWRvd24gdG91Y2hzdGFydCBwb2ludGVyZG93bic7XHJcbiAgICB2YXIgTU9WRV9FVkVOVFMgPSAnbW91c2Vtb3ZlIHRvdWNobW92ZSBwb2ludGVybW92ZSc7XHJcbiAgICB2YXIgRU5EX0VWRU5UUyA9ICdtb3VzZXVwIG1vdXNlbGVhdmUgdG91Y2hlbmQgdG91Y2hjYW5jZWwgcG9pbnRlcnVwIHBvaW50ZXJjYW5jZWwnO1xyXG5cclxuICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudClcclxuICAgICAgLm9uKFNUQVJUX0VWRU5UUywgZ2VzdHVyZVN0YXJ0KVxyXG4gICAgICAub24oTU9WRV9FVkVOVFMsIGdlc3R1cmVNb3ZlKVxyXG4gICAgICAub24oRU5EX0VWRU5UUywgZ2VzdHVyZUVuZClcclxuICAgICAgLy8gRm9yIHRlc3RpbmdcclxuICAgICAgLm9uKCckJG1kR2VzdHVyZVJlc2V0JywgZnVuY3Rpb24gZ2VzdHVyZUNsZWFyQ2FjaGUgKCkge1xyXG4gICAgICAgIGxhc3RQb2ludGVyID0gcG9pbnRlciA9IG51bGw7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBXaGVuIGEgRE9NIGV2ZW50IGhhcHBlbnMsIHJ1biBhbGwgcmVnaXN0ZXJlZCBnZXN0dXJlIGhhbmRsZXJzJyBsaWZlY3ljbGVcclxuICAgICAqIG1ldGhvZHMgd2hpY2ggbWF0Y2ggdGhlIERPTSBldmVudC5cclxuICAgICAqIEVnIHdoZW4gYSAndG91Y2hzdGFydCcgZXZlbnQgaGFwcGVucywgcnVuSGFuZGxlcnMoJ3N0YXJ0Jykgd2lsbCBjYWxsIGFuZFxyXG4gICAgICogcnVuIGBoYW5kbGVyLmNhbmNlbCgpYCBhbmQgYGhhbmRsZXIuc3RhcnQoKWAgb24gYWxsIHJlZ2lzdGVyZWQgaGFuZGxlcnMuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHJ1bkhhbmRsZXJzKGhhbmRsZXJFdmVudCwgZXZlbnQpIHtcclxuICAgICAgdmFyIGhhbmRsZXI7XHJcbiAgICAgIGZvciAodmFyIG5hbWUgaW4gSEFORExFUlMpIHtcclxuICAgICAgICBoYW5kbGVyID0gSEFORExFUlNbbmFtZV07XHJcbiAgICAgICAgaWYoIGhhbmRsZXIgaW5zdGFuY2VvZiAkJE1kR2VzdHVyZUhhbmRsZXIgKSB7XHJcblxyXG4gICAgICAgICAgaWYgKGhhbmRsZXJFdmVudCA9PT0gJ3N0YXJ0Jykge1xyXG4gICAgICAgICAgICAvLyBSdW4gY2FuY2VsIHRvIHJlc2V0IGFueSBoYW5kbGVycycgc3RhdGVcclxuICAgICAgICAgICAgaGFuZGxlci5jYW5jZWwoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGhhbmRsZXJbaGFuZGxlckV2ZW50XShldmVudCwgcG9pbnRlcik7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICAgKiBnZXN0dXJlU3RhcnQgdmV0cyBpZiBhIHN0YXJ0IGV2ZW50IGlzIGxlZ2l0aW1hdGUgKGFuZCBub3QgcGFydCBvZiBhICdnaG9zdCBjbGljaycgZnJvbSBpT1MvQW5kcm9pZClcclxuICAgICAqIElmIGl0IGlzIGxlZ2l0aW1hdGUsIHdlIGluaXRpYXRlIHRoZSBwb2ludGVyIHN0YXRlIGFuZCBtYXJrIHRoZSBjdXJyZW50IHBvaW50ZXIncyB0eXBlXHJcbiAgICAgKiBGb3IgZXhhbXBsZSwgZm9yIGEgdG91Y2hzdGFydCBldmVudCwgbWFyayB0aGUgY3VycmVudCBwb2ludGVyIGFzIGEgJ3RvdWNoJyBwb2ludGVyLCBzbyBtb3VzZSBldmVudHNcclxuICAgICAqIHdvbid0IGVmZmVjdCBpdC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2VzdHVyZVN0YXJ0KGV2KSB7XHJcbiAgICAgIC8vIElmIHdlJ3JlIGFscmVhZHkgdG91Y2hlZCBkb3duLCBhYm9ydFxyXG4gICAgICBpZiAocG9pbnRlcikgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIG5vdyA9ICtEYXRlLm5vdygpO1xyXG5cclxuICAgICAgLy8gaU9TICYgb2xkIGFuZHJvaWQgYnVnOiBhZnRlciBhIHRvdWNoIGV2ZW50LCBhIGNsaWNrIGV2ZW50IGlzIHNlbnQgMzUwIG1zIGxhdGVyLlxyXG4gICAgICAvLyBJZiA8NDAwbXMgaGF2ZSBwYXNzZWQsIGRvbid0IGFsbG93IGFuIGV2ZW50IG9mIGEgZGlmZmVyZW50IHR5cGUgdGhhbiB0aGUgcHJldmlvdXMgZXZlbnRcclxuICAgICAgaWYgKGxhc3RQb2ludGVyICYmICF0eXBlc01hdGNoKGV2LCBsYXN0UG9pbnRlcikgJiYgKG5vdyAtIGxhc3RQb2ludGVyLmVuZFRpbWUgPCAxNTAwKSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgcG9pbnRlciA9IG1ha2VTdGFydFBvaW50ZXIoZXYpO1xyXG5cclxuICAgICAgcnVuSGFuZGxlcnMoJ3N0YXJ0JywgZXYpO1xyXG4gICAgfVxyXG4gICAgLypcclxuICAgICAqIElmIGEgbW92ZSBldmVudCBoYXBwZW5zIG9mIHRoZSByaWdodCB0eXBlLCB1cGRhdGUgdGhlIHBvaW50ZXIgYW5kIHJ1biBhbGwgdGhlIG1vdmUgaGFuZGxlcnMuXHJcbiAgICAgKiBcIm9mIHRoZSByaWdodCB0eXBlXCI6IGlmIGEgbW91c2Vtb3ZlIGhhcHBlbnMgYnV0IG91ciBwb2ludGVyIHN0YXJ0ZWQgd2l0aCBhIHRvdWNoIGV2ZW50LCBkbyBub3RoaW5nLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXN0dXJlTW92ZShldikge1xyXG4gICAgICBpZiAoIXBvaW50ZXIgfHwgIXR5cGVzTWF0Y2goZXYsIHBvaW50ZXIpKSByZXR1cm47XHJcblxyXG4gICAgICB1cGRhdGVQb2ludGVyU3RhdGUoZXYsIHBvaW50ZXIpO1xyXG4gICAgICBydW5IYW5kbGVycygnbW92ZScsIGV2KTtcclxuICAgIH1cclxuICAgIC8qXHJcbiAgICAgKiBJZiBhbiBlbmQgZXZlbnQgaGFwcGVucyBvZiB0aGUgcmlnaHQgdHlwZSwgdXBkYXRlIHRoZSBwb2ludGVyLCBydW4gZW5kSGFuZGxlcnMsIGFuZCBzYXZlIHRoZSBwb2ludGVyIGFzICdsYXN0UG9pbnRlcidcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2VzdHVyZUVuZChldikge1xyXG4gICAgICBpZiAoIXBvaW50ZXIgfHwgIXR5cGVzTWF0Y2goZXYsIHBvaW50ZXIpKSByZXR1cm47XHJcblxyXG4gICAgICB1cGRhdGVQb2ludGVyU3RhdGUoZXYsIHBvaW50ZXIpO1xyXG4gICAgICBwb2ludGVyLmVuZFRpbWUgPSArRGF0ZS5ub3coKTtcclxuXHJcbiAgICAgIHJ1bkhhbmRsZXJzKCdlbmQnLCBldik7XHJcblxyXG4gICAgICBsYXN0UG9pbnRlciA9IHBvaW50ZXI7XHJcbiAgICAgIHBvaW50ZXIgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgYXR0YWNoVG9Eb2N1bWVudC4kaW5qZWN0ID0gW1wiJG1kR2VzdHVyZVwiLCBcIiQkTWRHZXN0dXJlSGFuZGxlclwiXTtcclxuXHJcbiAgLy8gKioqKioqKioqKioqKioqKioqKipcclxuICAvLyBNb2R1bGUgRnVuY3Rpb25zXHJcbiAgLy8gKioqKioqKioqKioqKioqKioqKipcclxuXHJcbiAgLypcclxuICAgKiBJbml0aWF0ZSB0aGUgcG9pbnRlci4geCwgeSwgYW5kIHRoZSBwb2ludGVyJ3MgdHlwZS5cclxuICAgKi9cclxuICBmdW5jdGlvbiBtYWtlU3RhcnRQb2ludGVyKGV2KSB7XHJcbiAgICB2YXIgcG9pbnQgPSBnZXRFdmVudFBvaW50KGV2KTtcclxuICAgIHZhciBzdGFydFBvaW50ZXIgPSB7XHJcbiAgICAgIHN0YXJ0VGltZTogK0RhdGUubm93KCksXHJcbiAgICAgIHRhcmdldDogZXYudGFyZ2V0LFxyXG4gICAgICAvLyAncCcgZm9yIHBvaW50ZXIgZXZlbnRzLCAnbScgZm9yIG1vdXNlLCAndCcgZm9yIHRvdWNoXHJcbiAgICAgIHR5cGU6IGV2LnR5cGUuY2hhckF0KDApXHJcbiAgICB9O1xyXG4gICAgc3RhcnRQb2ludGVyLnN0YXJ0WCA9IHN0YXJ0UG9pbnRlci54ID0gcG9pbnQucGFnZVg7XHJcbiAgICBzdGFydFBvaW50ZXIuc3RhcnRZID0gc3RhcnRQb2ludGVyLnkgPSBwb2ludC5wYWdlWTtcclxuICAgIHJldHVybiBzdGFydFBvaW50ZXI7XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gICAqIHJldHVybiB3aGV0aGVyIHRoZSBwb2ludGVyJ3MgdHlwZSBtYXRjaGVzIHRoZSBldmVudCdzIHR5cGUuXHJcbiAgICogRWcgaWYgYSB0b3VjaCBldmVudCBoYXBwZW5zIGJ1dCB0aGUgcG9pbnRlciBoYXMgYSBtb3VzZSB0eXBlLCByZXR1cm4gZmFsc2UuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gdHlwZXNNYXRjaChldiwgcG9pbnRlcikge1xyXG4gICAgcmV0dXJuIGV2ICYmIHBvaW50ZXIgJiYgZXYudHlwZS5jaGFyQXQoMCkgPT09IHBvaW50ZXIudHlwZTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICogVXBkYXRlIHRoZSBnaXZlbiBwb2ludGVyIGJhc2VkIHVwb24gdGhlIGdpdmVuIERPTUV2ZW50LlxyXG4gICAqIERpc3RhbmNlLCB2ZWxvY2l0eSwgZGlyZWN0aW9uLCBkdXJhdGlvbiwgZXRjXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gdXBkYXRlUG9pbnRlclN0YXRlKGV2LCBwb2ludGVyKSB7XHJcbiAgICB2YXIgcG9pbnQgPSBnZXRFdmVudFBvaW50KGV2KTtcclxuICAgIHZhciB4ID0gcG9pbnRlci54ID0gcG9pbnQucGFnZVg7XHJcbiAgICB2YXIgeSA9IHBvaW50ZXIueSA9IHBvaW50LnBhZ2VZO1xyXG5cclxuICAgIHBvaW50ZXIuZGlzdGFuY2VYID0geCAtIHBvaW50ZXIuc3RhcnRYO1xyXG4gICAgcG9pbnRlci5kaXN0YW5jZVkgPSB5IC0gcG9pbnRlci5zdGFydFk7XHJcbiAgICBwb2ludGVyLmRpc3RhbmNlID0gTWF0aC5zcXJ0KFxyXG4gICAgICBwb2ludGVyLmRpc3RhbmNlWCAqIHBvaW50ZXIuZGlzdGFuY2VYICsgcG9pbnRlci5kaXN0YW5jZVkgKiBwb2ludGVyLmRpc3RhbmNlWVxyXG4gICAgKTtcclxuXHJcbiAgICBwb2ludGVyLmRpcmVjdGlvblggPSBwb2ludGVyLmRpc3RhbmNlWCA+IDAgPyAncmlnaHQnIDogcG9pbnRlci5kaXN0YW5jZVggPCAwID8gJ2xlZnQnIDogJyc7XHJcbiAgICBwb2ludGVyLmRpcmVjdGlvblkgPSBwb2ludGVyLmRpc3RhbmNlWSA+IDAgPyAndXAnIDogcG9pbnRlci5kaXN0YW5jZVkgPCAwID8gJ2Rvd24nIDogJyc7XHJcblxyXG4gICAgcG9pbnRlci5kdXJhdGlvbiA9ICtEYXRlLm5vdygpIC0gcG9pbnRlci5zdGFydFRpbWU7XHJcbiAgICBwb2ludGVyLnZlbG9jaXR5WCA9IHBvaW50ZXIuZGlzdGFuY2VYIC8gcG9pbnRlci5kdXJhdGlvbjtcclxuICAgIHBvaW50ZXIudmVsb2NpdHlZID0gcG9pbnRlci5kaXN0YW5jZVkgLyBwb2ludGVyLmR1cmF0aW9uO1xyXG4gIH1cclxuXHJcbiAgLypcclxuICAgKiBOb3JtYWxpemUgdGhlIHBvaW50IHdoZXJlIHRoZSBET00gZXZlbnQgaGFwcGVuZWQgd2hldGhlciBpdCdzIHRvdWNoIG9yIG1vdXNlLlxyXG4gICAqIEByZXR1cm5zIHBvaW50IGV2ZW50IG9iaiB3aXRoIHBhZ2VYIGFuZCBwYWdlWSBvbiBpdC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXRFdmVudFBvaW50KGV2KSB7XHJcbiAgICBldiA9IGV2Lm9yaWdpbmFsRXZlbnQgfHwgZXY7IC8vIHN1cHBvcnQgalF1ZXJ5IGV2ZW50c1xyXG4gICAgcmV0dXJuIChldi50b3VjaGVzICYmIGV2LnRvdWNoZXNbMF0pIHx8XHJcbiAgICAgIChldi5jaGFuZ2VkVG91Y2hlcyAmJiBldi5jaGFuZ2VkVG91Y2hlc1swXSkgfHxcclxuICAgICAgZXY7XHJcbiAgfVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gIC5wcm92aWRlcignJCRpbnRlcmltRWxlbWVudCcsIEludGVyaW1FbGVtZW50UHJvdmlkZXIpO1xyXG5cclxuLypcclxuICogQG5nZG9jIHNlcnZpY2VcclxuICogQG5hbWUgJCRpbnRlcmltRWxlbWVudFxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIEZhY3RvcnkgdGhhdCBjb250cnVjdHMgYCQkaW50ZXJpbUVsZW1lbnQuJHNlcnZpY2VgIHNlcnZpY2VzLlxyXG4gKiBVc2VkIGludGVybmFsbHkgaW4gbWF0ZXJpYWwgZGVzaWduIGZvciBlbGVtZW50cyB0aGF0IGFwcGVhciBvbiBzY3JlZW4gdGVtcG9yYXJpbHkuXHJcbiAqIFRoZSBzZXJ2aWNlIHByb3ZpZGVzIGEgcHJvbWlzZS1saWtlIEFQSSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgdGVtcG9yYXJ5XHJcbiAqIGVsZW1lbnRzLlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBhcHAuc2VydmljZSgnJG1kVG9hc3QnLCBmdW5jdGlvbigkJGludGVyaW1FbGVtZW50KSB7XHJcbiAqICAgdmFyICRtZFRvYXN0ID0gJCRpbnRlcmltRWxlbWVudCh0b2FzdERlZmF1bHRPcHRpb25zKTtcclxuICogICByZXR1cm4gJG1kVG9hc3Q7XHJcbiAqIH0pO1xyXG4gKiBgYGBcclxuICogQHBhcmFtIHtvYmplY3Q9fSBkZWZhdWx0T3B0aW9ucyBPcHRpb25zIHVzZWQgYnkgZGVmYXVsdCBmb3IgdGhlIGBzaG93YCBtZXRob2Qgb24gdGhlIHNlcnZpY2UuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHskJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlfVxyXG4gKlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIEludGVyaW1FbGVtZW50UHJvdmlkZXIoKSB7XHJcbiAgY3JlYXRlSW50ZXJpbUVsZW1lbnRQcm92aWRlci4kZ2V0ID0gSW50ZXJpbUVsZW1lbnRGYWN0b3J5O1xyXG4gIEludGVyaW1FbGVtZW50RmFjdG9yeS4kaW5qZWN0ID0gW1wiJGRvY3VtZW50XCIsIFwiJHFcIiwgXCIkcm9vdFNjb3BlXCIsIFwiJHRpbWVvdXRcIiwgXCIkcm9vdEVsZW1lbnRcIiwgXCIkYW5pbWF0ZVwiLCBcIiRpbnRlcnBvbGF0ZVwiLCBcIiRtZENvbXBpbGVyXCIsIFwiJG1kVGhlbWluZ1wiXTtcclxuICByZXR1cm4gY3JlYXRlSW50ZXJpbUVsZW1lbnRQcm92aWRlcjtcclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyBhIG5ldyBwcm92aWRlciB3aGljaCBhbGxvd3MgY29uZmlndXJhdGlvbiBvZiBhIG5ldyBpbnRlcmltRWxlbWVudFxyXG4gICAqIHNlcnZpY2UuIEFsbG93cyBjb25maWd1cmF0aW9uIG9mIGRlZmF1bHQgb3B0aW9ucyAmIG1ldGhvZHMgZm9yIG9wdGlvbnMsXHJcbiAgICogYXMgd2VsbCBhcyBjb25maWd1cmF0aW9uIG9mICdwcmVzZXQnIG1ldGhvZHMgKGVnIGRpYWxvZy5iYXNpYygpOiBiYXNpYyBpcyBhIHByZXNldCBtZXRob2QpXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY3JlYXRlSW50ZXJpbUVsZW1lbnRQcm92aWRlcihpbnRlcmltRmFjdG9yeU5hbWUpIHtcclxuICAgIHZhciBFWFBPU0VEX01FVEhPRFMgPSBbJ29uSGlkZScsICdvblNob3cnLCAnb25SZW1vdmUnXTtcclxuXHJcbiAgICB2YXIgY3VzdG9tTWV0aG9kcyA9IHt9O1xyXG4gICAgdmFyIHByb3ZpZGVyQ29uZmlnID0ge1xyXG4gICAgICBwcmVzZXRzOiB7fVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcHJvdmlkZXIgPSB7XHJcbiAgICAgIHNldERlZmF1bHRzOiBzZXREZWZhdWx0cyxcclxuICAgICAgYWRkUHJlc2V0OiBhZGRQcmVzZXQsXHJcbiAgICAgIGFkZE1ldGhvZDogYWRkTWV0aG9kLFxyXG4gICAgICAkZ2V0OiBmYWN0b3J5XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogYWxsIGludGVyaW0gZWxlbWVudHMgd2lsbCBjb21lIHdpdGggdGhlICdidWlsZCcgcHJlc2V0XHJcbiAgICAgKi9cclxuICAgIHByb3ZpZGVyLmFkZFByZXNldCgnYnVpbGQnLCB7XHJcbiAgICAgIG1ldGhvZHM6IFsnY29udHJvbGxlcicsICdjb250cm9sbGVyQXMnLCAncmVzb2x2ZScsXHJcbiAgICAgICAgJ3RlbXBsYXRlJywgJ3RlbXBsYXRlVXJsJywgJ3RoZW1hYmxlJywgJ3RyYW5zZm9ybVRlbXBsYXRlJywgJ3BhcmVudCddXHJcbiAgICB9KTtcclxuXHJcbiAgICBmYWN0b3J5LiRpbmplY3QgPSBbXCIkJGludGVyaW1FbGVtZW50XCIsIFwiJGFuaW1hdGVcIiwgXCIkaW5qZWN0b3JcIl07XHJcbiAgICByZXR1cm4gcHJvdmlkZXI7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTYXZlIHRoZSBjb25maWd1cmVkIGRlZmF1bHRzIHRvIGJlIHVzZWQgd2hlbiB0aGUgZmFjdG9yeSBpcyBpbnN0YW50aWF0ZWRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gc2V0RGVmYXVsdHMoZGVmaW5pdGlvbikge1xyXG4gICAgICBwcm92aWRlckNvbmZpZy5vcHRpb25zRmFjdG9yeSA9IGRlZmluaXRpb24ub3B0aW9ucztcclxuICAgICAgcHJvdmlkZXJDb25maWcubWV0aG9kcyA9IChkZWZpbml0aW9uLm1ldGhvZHMgfHwgW10pLmNvbmNhdChFWFBPU0VEX01FVEhPRFMpO1xyXG4gICAgICByZXR1cm4gcHJvdmlkZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGQgYSBtZXRob2QgdG8gdGhlIGZhY3RvcnkgdGhhdCBpc24ndCBzcGVjaWZpYyB0byBhbnkgaW50ZXJpbSBlbGVtZW50IG9wZXJhdGlvbnNcclxuICAgICAqL1xyXG5cclxuICAgIGZ1bmN0aW9uIGFkZE1ldGhvZChuYW1lLCBmbikge1xyXG4gICAgICBjdXN0b21NZXRob2RzW25hbWVdID0gZm47XHJcbiAgICAgIHJldHVybiBwcm92aWRlcjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNhdmUgdGhlIGNvbmZpZ3VyZWQgcHJlc2V0IHRvIGJlIHVzZWQgd2hlbiB0aGUgZmFjdG9yeSBpcyBpbnN0YW50aWF0ZWRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gYWRkUHJlc2V0KG5hbWUsIGRlZmluaXRpb24pIHtcclxuICAgICAgZGVmaW5pdGlvbiA9IGRlZmluaXRpb24gfHwge307XHJcbiAgICAgIGRlZmluaXRpb24ubWV0aG9kcyA9IGRlZmluaXRpb24ubWV0aG9kcyB8fCBbXTtcclxuICAgICAgZGVmaW5pdGlvbi5vcHRpb25zID0gZGVmaW5pdGlvbi5vcHRpb25zIHx8IGZ1bmN0aW9uKCkgeyByZXR1cm4ge307IH07XHJcblxyXG4gICAgICBpZiAoL15jYW5jZWx8aGlkZXxzaG93JC8udGVzdChuYW1lKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByZXNldCAnXCIgKyBuYW1lICsgXCInIGluIFwiICsgaW50ZXJpbUZhY3RvcnlOYW1lICsgXCIgaXMgcmVzZXJ2ZWQhXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkZWZpbml0aW9uLm1ldGhvZHMuaW5kZXhPZignX29wdGlvbnMnKSA+IC0xKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kICdfb3B0aW9ucycgaW4gXCIgKyBpbnRlcmltRmFjdG9yeU5hbWUgKyBcIiBpcyByZXNlcnZlZCFcIik7XHJcbiAgICAgIH1cclxuICAgICAgcHJvdmlkZXJDb25maWcucHJlc2V0c1tuYW1lXSA9IHtcclxuICAgICAgICBtZXRob2RzOiBkZWZpbml0aW9uLm1ldGhvZHMuY29uY2F0KEVYUE9TRURfTUVUSE9EUyksXHJcbiAgICAgICAgb3B0aW9uc0ZhY3Rvcnk6IGRlZmluaXRpb24ub3B0aW9ucyxcclxuICAgICAgICBhcmdPcHRpb246IGRlZmluaXRpb24uYXJnT3B0aW9uXHJcbiAgICAgIH07XHJcbiAgICAgIHJldHVybiBwcm92aWRlcjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhIGZhY3RvcnkgdGhhdCBoYXMgdGhlIGdpdmVuIG1ldGhvZHMgJiBkZWZhdWx0cyBpbXBsZW1lbnRpbmcgaW50ZXJpbUVsZW1lbnRcclxuICAgICAqL1xyXG4gICAgLyogQG5nSW5qZWN0ICovXHJcbiAgICBmdW5jdGlvbiBmYWN0b3J5KCQkaW50ZXJpbUVsZW1lbnQsICRhbmltYXRlLCAkaW5qZWN0b3IpIHtcclxuICAgICAgdmFyIGRlZmF1bHRNZXRob2RzO1xyXG4gICAgICB2YXIgZGVmYXVsdE9wdGlvbnM7XHJcbiAgICAgIHZhciBpbnRlcmltRWxlbWVudFNlcnZpY2UgPSAkJGludGVyaW1FbGVtZW50KCk7XHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgKiBwdWJsaWNTZXJ2aWNlIGlzIHdoYXQgdGhlIGRldmVsb3BlciB3aWxsIGJlIHVzaW5nLlxyXG4gICAgICAgKiBJdCBoYXMgbWV0aG9kcyBoaWRlKCksIGNhbmNlbCgpLCBzaG93KCksIGJ1aWxkKCksIGFuZCBhbnkgb3RoZXJcclxuICAgICAgICogcHJlc2V0cyB3aGljaCB3ZXJlIHNldCBkdXJpbmcgdGhlIGNvbmZpZyBwaGFzZS5cclxuICAgICAgICovXHJcbiAgICAgIHZhciBwdWJsaWNTZXJ2aWNlID0ge1xyXG4gICAgICAgIGhpZGU6IGludGVyaW1FbGVtZW50U2VydmljZS5oaWRlLFxyXG4gICAgICAgIGNhbmNlbDogaW50ZXJpbUVsZW1lbnRTZXJ2aWNlLmNhbmNlbCxcclxuICAgICAgICBzaG93OiBzaG93SW50ZXJpbUVsZW1lbnRcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGRlZmF1bHRNZXRob2RzID0gcHJvdmlkZXJDb25maWcubWV0aG9kcyB8fCBbXTtcclxuICAgICAgLy8gVGhpcyBtdXN0IGJlIGludm9rZWQgYWZ0ZXIgdGhlIHB1YmxpY1NlcnZpY2UgaXMgaW5pdGlhbGl6ZWRcclxuICAgICAgZGVmYXVsdE9wdGlvbnMgPSBpbnZva2VGYWN0b3J5KHByb3ZpZGVyQ29uZmlnLm9wdGlvbnNGYWN0b3J5LCB7fSk7XHJcblxyXG4gICAgICAvLyBDb3B5IG92ZXIgdGhlIHNpbXBsZSBjdXN0b20gbWV0aG9kc1xyXG4gICAgICBhbmd1bGFyLmZvckVhY2goY3VzdG9tTWV0aG9kcywgZnVuY3Rpb24oZm4sIG5hbWUpIHtcclxuICAgICAgICBwdWJsaWNTZXJ2aWNlW25hbWVdID0gZm47XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgYW5ndWxhci5mb3JFYWNoKHByb3ZpZGVyQ29uZmlnLnByZXNldHMsIGZ1bmN0aW9uKGRlZmluaXRpb24sIG5hbWUpIHtcclxuICAgICAgICB2YXIgcHJlc2V0RGVmYXVsdHMgPSBpbnZva2VGYWN0b3J5KGRlZmluaXRpb24ub3B0aW9uc0ZhY3RvcnksIHt9KTtcclxuICAgICAgICB2YXIgcHJlc2V0TWV0aG9kcyA9IChkZWZpbml0aW9uLm1ldGhvZHMgfHwgW10pLmNvbmNhdChkZWZhdWx0TWV0aG9kcyk7XHJcblxyXG4gICAgICAgIC8vIEV2ZXJ5IGludGVyaW1FbGVtZW50IGJ1aWx0IHdpdGggYSBwcmVzZXQgaGFzIGEgZmllbGQgY2FsbGVkIGAkdHlwZWAsXHJcbiAgICAgICAgLy8gd2hpY2ggbWF0Y2hlcyB0aGUgbmFtZSBvZiB0aGUgcHJlc2V0LlxyXG4gICAgICAgIC8vIEVnIGluIHByZXNldCAnY29uZmlybScsIG9wdGlvbnMuJHR5cGUgPT09ICdjb25maXJtJ1xyXG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHByZXNldERlZmF1bHRzLCB7ICR0eXBlOiBuYW1lIH0pO1xyXG5cclxuICAgICAgICAvLyBUaGlzIGNyZWF0ZXMgYSBwcmVzZXQgY2xhc3Mgd2hpY2ggaGFzIHNldHRlciBtZXRob2RzIGZvciBldmVyeVxyXG4gICAgICAgIC8vIG1ldGhvZCBnaXZlbiBpbiB0aGUgYC5hZGRQcmVzZXQoKWAgZnVuY3Rpb24sIGFzIHdlbGwgYXMgZXZlcnlcclxuICAgICAgICAvLyBtZXRob2QgZ2l2ZW4gaW4gdGhlIGAuc2V0RGVmYXVsdHMoKWAgZnVuY3Rpb24uXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBAZXhhbXBsZVxyXG4gICAgICAgIC8vIC5zZXREZWZhdWx0cyh7XHJcbiAgICAgICAgLy8gICBtZXRob2RzOiBbJ2hhc0JhY2tkcm9wJywgJ2NsaWNrT3V0c2lkZVRvQ2xvc2UnLCAnZXNjYXBlVG9DbG9zZScsICd0YXJnZXRFdmVudCddLFxyXG4gICAgICAgIC8vICAgb3B0aW9uczogZGlhbG9nRGVmYXVsdE9wdGlvbnNcclxuICAgICAgICAvLyB9KVxyXG4gICAgICAgIC8vIC5hZGRQcmVzZXQoJ2FsZXJ0Jywge1xyXG4gICAgICAgIC8vICAgbWV0aG9kczogWyd0aXRsZScsICdvayddLFxyXG4gICAgICAgIC8vICAgb3B0aW9uczogYWxlcnREaWFsb2dPcHRpb25zXHJcbiAgICAgICAgLy8gfSlcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFNldCB2YWx1ZXMgd2lsbCBiZSBwYXNzZWQgdG8gdGhlIG9wdGlvbnMgd2hlbiBpbnRlcmltRWxlbW50LnNob3coKSBpcyBjYWxsZWQuXHJcbiAgICAgICAgZnVuY3Rpb24gUHJlc2V0KG9wdHMpIHtcclxuICAgICAgICAgIHRoaXMuX29wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZCh7fSwgcHJlc2V0RGVmYXVsdHMsIG9wdHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhbmd1bGFyLmZvckVhY2gocHJlc2V0TWV0aG9kcywgZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgUHJlc2V0LnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29wdGlvbnNbbmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgc2hvcnRjdXQgbWV0aG9kIGZvciBvbmUtbGluZWFyIG1ldGhvZHNcclxuICAgICAgICBpZiAoZGVmaW5pdGlvbi5hcmdPcHRpb24pIHtcclxuICAgICAgICAgIHZhciBtZXRob2ROYW1lID0gJ3Nob3cnICsgbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSk7XHJcbiAgICAgICAgICBwdWJsaWNTZXJ2aWNlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oYXJnKSB7XHJcbiAgICAgICAgICAgIHZhciBjb25maWcgPSBwdWJsaWNTZXJ2aWNlW25hbWVdKGFyZyk7XHJcbiAgICAgICAgICAgIHJldHVybiBwdWJsaWNTZXJ2aWNlLnNob3coY29uZmlnKTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBlZyAkbWREaWFsb2cuYWxlcnQoKSB3aWxsIHJldHVybiBhIG5ldyBhbGVydCBwcmVzZXRcclxuICAgICAgICBwdWJsaWNTZXJ2aWNlW25hbWVdID0gZnVuY3Rpb24oYXJnKSB7XHJcbiAgICAgICAgICAvLyBJZiBhcmdPcHRpb24gaXMgc3VwcGxpZWQsIGVnIGBhcmdPcHRpb246ICdjb250ZW50J2AsIHRoZW4gd2UgYXNzdW1lXHJcbiAgICAgICAgICAvLyBpZiB0aGUgYXJndW1lbnQgaXMgbm90IGFuIG9wdGlvbnMgb2JqZWN0IHRoZW4gaXQgaXMgdGhlIGBhcmdPcHRpb25gIG9wdGlvbi5cclxuICAgICAgICAgIC8vXHJcbiAgICAgICAgICAvLyBAZXhhbXBsZSBgJG1kVG9hc3Quc2ltcGxlKCdoZWxsbycpYCAvLyBzZXRzIG9wdGlvbnMuY29udGVudCB0byBoZWxsb1xyXG4gICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVjYXVzZSBhcmdPcHRpb24gPT09ICdjb250ZW50J1xyXG4gICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggJiYgZGVmaW5pdGlvbi5hcmdPcHRpb24gJiYgIWFuZ3VsYXIuaXNPYmplY3QoYXJnKSAmJlxyXG4gICAgICAgICAgICAgICFhbmd1bGFyLmlzQXJyYXkoYXJnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKG5ldyBQcmVzZXQoKSlbZGVmaW5pdGlvbi5hcmdPcHRpb25dKGFyZyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByZXNldChhcmcpO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9O1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiBwdWJsaWNTZXJ2aWNlO1xyXG5cclxuICAgICAgZnVuY3Rpb24gc2hvd0ludGVyaW1FbGVtZW50KG9wdHMpIHtcclxuICAgICAgICAvLyBvcHRzIGlzIGVpdGhlciBhIHByZXNldCB3aGljaCBzdG9yZXMgaXRzIG9wdGlvbnMgb24gYW4gX29wdGlvbnMgZmllbGQsXHJcbiAgICAgICAgLy8gb3IganVzdCBhbiBvYmplY3QgbWFkZSB1cCBvZiBvcHRpb25zXHJcbiAgICAgICAgaWYgKG9wdHMgJiYgb3B0cy5fb3B0aW9ucykgb3B0cyA9IG9wdHMuX29wdGlvbnM7XHJcbiAgICAgICAgcmV0dXJuIGludGVyaW1FbGVtZW50U2VydmljZS5zaG93KFxyXG4gICAgICAgICAgYW5ndWxhci5leHRlbmQoe30sIGRlZmF1bHRPcHRpb25zLCBvcHRzKVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBIZWxwZXIgdG8gY2FsbCAkaW5qZWN0b3IuaW52b2tlIHdpdGggYSBsb2NhbCBvZiB0aGUgZmFjdG9yeSBuYW1lIGZvclxyXG4gICAgICAgKiB0aGlzIHByb3ZpZGVyLlxyXG4gICAgICAgKiBJZiBhbiAkbWREaWFsb2cgaXMgcHJvdmlkaW5nIG9wdGlvbnMgZm9yIGEgZGlhbG9nIGFuZCB0cmllcyB0byBpbmplY3RcclxuICAgICAgICogJG1kRGlhbG9nLCBhIGNpcmN1bGFyIGRlcGVuZGVuY3kgZXJyb3Igd2lsbCBoYXBwZW4uXHJcbiAgICAgICAqIFdlIGdldCBhcm91bmQgdGhhdCBieSBtYW51YWxseSBpbmplY3RpbmcgJG1kRGlhbG9nIGFzIGEgbG9jYWwuXHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBpbnZva2VGYWN0b3J5KGZhY3RvcnksIGRlZmF1bHRWYWwpIHtcclxuICAgICAgICB2YXIgbG9jYWxzID0ge307XHJcbiAgICAgICAgbG9jYWxzW2ludGVyaW1GYWN0b3J5TmFtZV0gPSBwdWJsaWNTZXJ2aWNlO1xyXG4gICAgICAgIHJldHVybiAkaW5qZWN0b3IuaW52b2tlKGZhY3RvcnkgfHwgZnVuY3Rpb24oKSB7IHJldHVybiBkZWZhdWx0VmFsOyB9LCB7fSwgbG9jYWxzKTtcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKiBAbmdJbmplY3QgKi9cclxuICBmdW5jdGlvbiBJbnRlcmltRWxlbWVudEZhY3RvcnkoJGRvY3VtZW50LCAkcSwgJHJvb3RTY29wZSwgJHRpbWVvdXQsICRyb290RWxlbWVudCwgJGFuaW1hdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpbnRlcnBvbGF0ZSwgJG1kQ29tcGlsZXIsICRtZFRoZW1pbmcgKSB7XHJcbiAgICB2YXIgc3RhcnRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuc3RhcnRTeW1ib2woKSxcclxuICAgICAgICBlbmRTeW1ib2wgPSAkaW50ZXJwb2xhdGUuZW5kU3ltYm9sKCksXHJcbiAgICAgICAgdXNlc1N0YW5kYXJkU3ltYm9scyA9ICgoc3RhcnRTeW1ib2wgPT09ICd7eycpICYmIChlbmRTeW1ib2wgPT09ICd9fScpKSxcclxuICAgICAgICBwcm9jZXNzVGVtcGxhdGUgID0gdXNlc1N0YW5kYXJkU3ltYm9scyA/IGFuZ3VsYXIuaWRlbnRpdHkgOiByZXBsYWNlSW50ZXJwb2xhdGlvblN5bWJvbHM7XHJcblxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZUludGVyaW1FbGVtZW50U2VydmljZSgpIHtcclxuICAgICAgLypcclxuICAgICAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgICAgICogQG5hbWUgJCRpbnRlcmltRWxlbWVudC4kc2VydmljZVxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICogQSBzZXJ2aWNlIHVzZWQgdG8gY29udHJvbCBpbnNlcnRpbmcgYW5kIHJlbW92aW5nIGFuIGVsZW1lbnQgaW50byB0aGUgRE9NLlxyXG4gICAgICAgKlxyXG4gICAgICAgKi9cclxuICAgICAgdmFyIHN0YWNrID0gW107XHJcbiAgICAgIHZhciBzZXJ2aWNlO1xyXG4gICAgICByZXR1cm4gc2VydmljZSA9IHtcclxuICAgICAgICBzaG93OiBzaG93LFxyXG4gICAgICAgIGhpZGU6IGhpZGUsXHJcbiAgICAgICAgY2FuY2VsOiBjYW5jZWxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8qXHJcbiAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICogQG5hbWUgJCRpbnRlcmltRWxlbWVudC4kc2VydmljZSNzaG93XHJcbiAgICAgICAqIEBraW5kIGZ1bmN0aW9uXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgKiBBZGRzIHRoZSBgJGludGVyaW1FbGVtZW50YCB0byB0aGUgRE9NIGFuZCByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgb3IgcmVqZWN0ZWRcclxuICAgICAgICogd2l0aCBoaWRlIG9yIGNhbmNlbCwgcmVzcGVjdGl2ZWx5LlxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcGFyYW0geyp9IG9wdGlvbnMgaXMgaGFzaE1hcCBvZiBzZXR0aW5nc1xyXG4gICAgICAgKiBAcmV0dXJucyBhIFByb21pc2VcclxuICAgICAgICpcclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIHNob3cob3B0aW9ucykge1xyXG4gICAgICAgIGlmIChzdGFjay5sZW5ndGgpIHtcclxuICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmNhbmNlbCgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzaG93KG9wdGlvbnMpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhciBpbnRlcmltRWxlbWVudCA9IG5ldyBJbnRlcmltRWxlbWVudChvcHRpb25zKTtcclxuICAgICAgICAgIHN0YWNrLnB1c2goaW50ZXJpbUVsZW1lbnQpO1xyXG4gICAgICAgICAgcmV0dXJuIGludGVyaW1FbGVtZW50LnNob3coKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW50ZXJpbUVsZW1lbnQuZGVmZXJyZWQucHJvbWlzZTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLypcclxuICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgKiBAbmFtZSAkJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlI2hpZGVcclxuICAgICAgICogQGtpbmQgZnVuY3Rpb25cclxuICAgICAgICpcclxuICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAqIFJlbW92ZXMgdGhlIGAkaW50ZXJpbUVsZW1lbnRgIGZyb20gdGhlIERPTSBhbmQgcmVzb2x2ZXMgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgc2hvd2BcclxuICAgICAgICpcclxuICAgICAgICogQHBhcmFtIHsqfSByZXNvbHZlUGFyYW0gRGF0YSB0byByZXNvbHZlIHRoZSBwcm9taXNlIHdpdGhcclxuICAgICAgICogQHJldHVybnMgYSBQcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCBhZnRlciB0aGUgZWxlbWVudCBoYXMgYmVlbiByZW1vdmVkLlxyXG4gICAgICAgKlxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gaGlkZShyZXNwb25zZSkge1xyXG4gICAgICAgIHZhciBpbnRlcmltRWxlbWVudCA9IHN0YWNrLnNoaWZ0KCk7XHJcbiAgICAgICAgcmV0dXJuIGludGVyaW1FbGVtZW50ICYmIGludGVyaW1FbGVtZW50LnJlbW92ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpbnRlcmltRWxlbWVudC5kZWZlcnJlZC5yZXNvbHZlKHJlc3BvbnNlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLypcclxuICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgKiBAbmFtZSAkJGludGVyaW1FbGVtZW50LiRzZXJ2aWNlI2NhbmNlbFxyXG4gICAgICAgKiBAa2luZCBmdW5jdGlvblxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICogUmVtb3ZlcyB0aGUgYCRpbnRlcmltRWxlbWVudGAgZnJvbSB0aGUgRE9NIGFuZCByZWplY3RzIHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYHNob3dgXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBwYXJhbSB7Kn0gcmVhc29uIERhdGEgdG8gcmVqZWN0IHRoZSBwcm9taXNlIHdpdGhcclxuICAgICAgICogQHJldHVybnMgUHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgYWZ0ZXIgdGhlIGVsZW1lbnQgaGFzIGJlZW4gcmVtb3ZlZC5cclxuICAgICAgICpcclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIGNhbmNlbChyZWFzb24pIHtcclxuICAgICAgICB2YXIgaW50ZXJpbUVsZW1lbnQgPSBzdGFjay5zaGlmdCgpO1xyXG4gICAgICAgIHJldHVybiAkcS53aGVuKGludGVyaW1FbGVtZW50ICYmIGludGVyaW1FbGVtZW50LnJlbW92ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpbnRlcmltRWxlbWVudC5kZWZlcnJlZC5yZWplY3QocmVhc29uKTtcclxuICAgICAgICB9KSk7XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICAvKlxyXG4gICAgICAgKiBJbnRlcm5hbCBJbnRlcmltIEVsZW1lbnQgT2JqZWN0XHJcbiAgICAgICAqIFVzZWQgaW50ZXJuYWxseSB0byBtYW5hZ2UgdGhlIERPTSBlbGVtZW50IGFuZCByZWxhdGVkIGRhdGFcclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIEludGVyaW1FbGVtZW50KG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgc2VsZjtcclxuICAgICAgICB2YXIgaGlkZVRpbWVvdXQsIGVsZW1lbnQsIHNob3dEb25lLCByZW1vdmVEb25lO1xyXG5cclxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICBvcHRpb25zID0gYW5ndWxhci5leHRlbmQoe1xyXG4gICAgICAgICAgcHJlc2VydmVTY29wZTogZmFsc2UsXHJcbiAgICAgICAgICBzY29wZTogb3B0aW9ucy5zY29wZSB8fCAkcm9vdFNjb3BlLiRuZXcob3B0aW9ucy5pc29sYXRlU2NvcGUpLFxyXG4gICAgICAgICAgb25TaG93OiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgICByZXR1cm4gJGFuaW1hdGUuZW50ZXIoZWxlbWVudCwgb3B0aW9ucy5wYXJlbnQpO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG9uUmVtb3ZlOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICAgICAgICAvLyBFbGVtZW50IGNvdWxkIGJlIHVuZGVmaW5lZCBpZiBhIG5ldyBlbGVtZW50IGlzIHNob3duIGJlZm9yZVxyXG4gICAgICAgICAgICAvLyB0aGUgb2xkIG9uZSBmaW5pc2hlcyBjb21waWxpbmcuXHJcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50ICYmICRhbmltYXRlLmxlYXZlKGVsZW1lbnQpIHx8ICRxLndoZW4oKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LCBvcHRpb25zKTtcclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMudGVtcGxhdGUpIHtcclxuICAgICAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSBwcm9jZXNzVGVtcGxhdGUob3B0aW9ucy50ZW1wbGF0ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc2VsZiA9IHtcclxuICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnMsXHJcbiAgICAgICAgICBkZWZlcnJlZDogJHEuZGVmZXIoKSxcclxuICAgICAgICAgIHNob3c6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgY29tcGlsZVByb21pc2U7XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnNraXBDb21waWxlKSB7XHJcbiAgICAgICAgICAgICAgY29tcGlsZVByb21pc2UgPSAkcShmdW5jdGlvbihyZXNvbHZlKSB7IFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh7XHJcbiAgICAgICAgICAgICAgICAgIGxvY2Fsczoge30sXHJcbiAgICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKCkgeyByZXR1cm4gb3B0aW9ucy5lbGVtZW50OyB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBjb21waWxlUHJvbWlzZSA9ICRtZENvbXBpbGVyLmNvbXBpbGUob3B0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBzaG93RG9uZSA9IGNvbXBpbGVQcm9taXNlLnRoZW4oZnVuY3Rpb24oY29tcGlsZURhdGEpIHtcclxuICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChjb21waWxlRGF0YS5sb2NhbHMsIHNlbGYub3B0aW9ucyk7XHJcblxyXG4gICAgICAgICAgICAgIGVsZW1lbnQgPSBjb21waWxlRGF0YS5saW5rKG9wdGlvbnMuc2NvcGUpO1xyXG5cclxuICAgICAgICAgICAgICAvLyBTZWFyY2ggZm9yIHBhcmVudCBhdCBpbnNlcnRpb24gdGltZSwgaWYgbm90IHNwZWNpZmllZFxyXG4gICAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24ob3B0aW9ucy5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLnBhcmVudCA9IG9wdGlvbnMucGFyZW50KG9wdGlvbnMuc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc1N0cmluZyhvcHRpb25zLnBhcmVudCkpIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMucGFyZW50ID0gYW5ndWxhci5lbGVtZW50KCRkb2N1bWVudFswXS5xdWVyeVNlbGVjdG9yKG9wdGlvbnMucGFyZW50KSk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyBJZiBwYXJlbnQgcXVlcnlTZWxlY3Rvci9nZXR0ZXIgZnVuY3Rpb24gZmFpbHMsIG9yIGl0J3MganVzdCBudWxsLFxyXG4gICAgICAgICAgICAgIC8vIGZpbmQgYSBkZWZhdWx0LlxyXG4gICAgICAgICAgICAgIGlmICghKG9wdGlvbnMucGFyZW50IHx8IHt9KS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbDtcclxuICAgICAgICAgICAgICAgIGlmICgkcm9vdEVsZW1lbnRbMF0gJiYgJHJvb3RFbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgZWwgPSAkcm9vdEVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignOm5vdChzdmcpID4gYm9keScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFlbCkgZWwgPSAkcm9vdEVsZW1lbnRbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZWwubm9kZU5hbWUgPT0gJyNjb21tZW50Jykge1xyXG4gICAgICAgICAgICAgICAgICBlbCA9ICRkb2N1bWVudFswXS5ib2R5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5wYXJlbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWwpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgaWYgKG9wdGlvbnMudGhlbWFibGUpICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgdmFyIHJldCA9IG9wdGlvbnMub25TaG93KG9wdGlvbnMuc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgIHJldHVybiAkcS53aGVuKHJldClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgIC8vIElzc3VlIG9uQ29tcGxldGUgY2FsbGJhY2sgd2hlbiB0aGUgYHNob3coKWAgZmluaXNoZXNcclxuICAgICAgICAgICAgICAgICAgKG9wdGlvbnMub25Db21wbGV0ZSB8fCBhbmd1bGFyLm5vb3ApKG9wdGlvbnMuc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICBzdGFydEhpZGVUaW1lb3V0KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnRIaWRlVGltZW91dCgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmhpZGVEZWxheSkge1xyXG4gICAgICAgICAgICAgICAgICBoaWRlVGltZW91dCA9ICR0aW1lb3V0KHNlcnZpY2UuY2FuY2VsLCBvcHRpb25zLmhpZGVEZWxheSkgO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVhc29uKSB7IHNob3dEb25lID0gdHJ1ZTsgc2VsZi5kZWZlcnJlZC5yZWplY3QocmVhc29uKTsgfSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY2FuY2VsVGltZW91dDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChoaWRlVGltZW91dCkge1xyXG4gICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbChoaWRlVGltZW91dCk7XHJcbiAgICAgICAgICAgICAgaGlkZVRpbWVvdXQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxmLmNhbmNlbFRpbWVvdXQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZURvbmUgPSAkcS53aGVuKHNob3dEb25lKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIHZhciByZXQgPSBlbGVtZW50ID8gb3B0aW9ucy5vblJlbW92ZShvcHRpb25zLnNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSA6IHRydWU7XHJcbiAgICAgICAgICAgICAgcmV0dXJuICRxLndoZW4ocmV0KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zLnByZXNlcnZlU2NvcGUpIG9wdGlvbnMuc2NvcGUuJGRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHJlbW92ZURvbmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBSZXBsYWNlIGB7e2AgYW5kIGB9fWAgaW4gYSBzdHJpbmcgKHVzdWFsbHkgYSB0ZW1wbGF0ZSkgd2l0aCB0aGUgYWN0dWFsIHN0YXJ0LS9lbmRTeW1ib2xzIHVzZWRcclxuICAgICAqIGZvciBpbnRlcnBvbGF0aW9uLiBUaGlzIGFsbG93cyBwcmUtZGVmaW5lZCB0ZW1wbGF0ZXMgKGZvciBjb21wb25lbnRzIHN1Y2ggYXMgZGlhbG9nLCB0b2FzdCBldGMpXHJcbiAgICAgKiB0byBjb250aW51ZSB0byB3b3JrIGluIGFwcHMgdGhhdCB1c2UgY3VzdG9tIGludGVycG9sYXRpb24gc3RhcnQtL2VuZFN5bWJvbHMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgVGhlIHRleHQgaW4gd2hpY2ggdG8gcmVwbGFjZSBge3tgIC8gYH19YFxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIG1vZGlmaWVkIHN0cmluZyB1c2luZyB0aGUgYWN0dWFsIGludGVycG9sYXRpb24gc3RhcnQtL2VuZFN5bWJvbHNcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVwbGFjZUludGVycG9sYXRpb25TeW1ib2xzKHRleHQpIHtcclxuICAgICAgaWYgKCF0ZXh0IHx8ICFhbmd1bGFyLmlzU3RyaW5nKHRleHQpKSByZXR1cm4gdGV4dDtcclxuICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvXFx7XFx7L2csIHN0YXJ0U3ltYm9sKS5yZXBsYWNlKC99fS9nLCBlbmRTeW1ib2wpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIG1vZHVsZVxyXG4gICAqIEBuYW1lIG1hdGVyaWFsLmNvcmUuY29tcG9uZW50UmVnaXN0cnlcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIEEgY29tcG9uZW50IGluc3RhbmNlIHJlZ2lzdHJhdGlvbiBzZXJ2aWNlLlxyXG4gICAqIE5vdGU6IGN1cnJlbnRseSB0aGlzIGFzIGEgcHJpdmF0ZSBzZXJ2aWNlIGluIHRoZSBTaWRlTmF2IGNvbXBvbmVudC5cclxuICAgKi9cclxuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXHJcbiAgICAuZmFjdG9yeSgnJG1kQ29tcG9uZW50UmVnaXN0cnknLCBDb21wb25lbnRSZWdpc3RyeSk7XHJcblxyXG4gIC8qXHJcbiAgICogQHByaXZhdGVcclxuICAgKiBAbmdkb2MgZmFjdG9yeVxyXG4gICAqIEBuYW1lIENvbXBvbmVudFJlZ2lzdHJ5XHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlLmNvbXBvbmVudFJlZ2lzdHJ5XHJcbiAgICpcclxuICAgKi9cclxuICBmdW5jdGlvbiBDb21wb25lbnRSZWdpc3RyeSgkbG9nLCAkcSkge1xyXG5cclxuICAgIHZhciBzZWxmO1xyXG4gICAgdmFyIGluc3RhbmNlcyA9IFsgXTtcclxuICAgIHZhciBwZW5kaW5ncyA9IHsgfTtcclxuXHJcbiAgICByZXR1cm4gc2VsZiA9IHtcclxuICAgICAgLyoqXHJcbiAgICAgICAqIFVzZWQgdG8gcHJpbnQgYW4gZXJyb3Igd2hlbiBhbiBpbnN0YW5jZSBmb3IgYSBoYW5kbGUgaXNuJ3QgZm91bmQuXHJcbiAgICAgICAqL1xyXG4gICAgICBub3RGb3VuZEVycm9yOiBmdW5jdGlvbihoYW5kbGUpIHtcclxuICAgICAgICAkbG9nLmVycm9yKCdObyBpbnN0YW5jZSBmb3VuZCBmb3IgaGFuZGxlJywgaGFuZGxlKTtcclxuICAgICAgfSxcclxuICAgICAgLyoqXHJcbiAgICAgICAqIFJldHVybiBhbGwgcmVnaXN0ZXJlZCBpbnN0YW5jZXMgYXMgYW4gYXJyYXkuXHJcbiAgICAgICAqL1xyXG4gICAgICBnZXRJbnN0YW5jZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZXM7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogR2V0IGEgcmVnaXN0ZXJlZCBpbnN0YW5jZS5cclxuICAgICAgICogQHBhcmFtIGhhbmRsZSB0aGUgU3RyaW5nIGhhbmRsZSB0byBsb29rIHVwIGZvciBhIHJlZ2lzdGVyZWQgaW5zdGFuY2UuXHJcbiAgICAgICAqL1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uKGhhbmRsZSkge1xyXG4gICAgICAgIGlmICggIWlzVmFsaWRJRChoYW5kbGUpICkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIHZhciBpLCBqLCBpbnN0YW5jZTtcclxuICAgICAgICBmb3IoaSA9IDAsIGogPSBpbnN0YW5jZXMubGVuZ3RoOyBpIDwgajsgaSsrKSB7XHJcbiAgICAgICAgICBpbnN0YW5jZSA9IGluc3RhbmNlc1tpXTtcclxuICAgICAgICAgIGlmKGluc3RhbmNlLiQkbWRIYW5kbGUgPT09IGhhbmRsZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIFJlZ2lzdGVyIGFuIGluc3RhbmNlLlxyXG4gICAgICAgKiBAcGFyYW0gaW5zdGFuY2UgdGhlIGluc3RhbmNlIHRvIHJlZ2lzdGVyXHJcbiAgICAgICAqIEBwYXJhbSBoYW5kbGUgdGhlIGhhbmRsZSB0byBpZGVudGlmeSB0aGUgaW5zdGFuY2UgdW5kZXIuXHJcbiAgICAgICAqL1xyXG4gICAgICByZWdpc3RlcjogZnVuY3Rpb24oaW5zdGFuY2UsIGhhbmRsZSkge1xyXG4gICAgICAgIGlmICggIWhhbmRsZSApIHJldHVybiBhbmd1bGFyLm5vb3A7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLiQkbWRIYW5kbGUgPSBoYW5kbGU7XHJcbiAgICAgICAgaW5zdGFuY2VzLnB1c2goaW5zdGFuY2UpO1xyXG4gICAgICAgIHJlc29sdmVXaGVuKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBkZXJlZ2lzdGVyO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZW1vdmUgcmVnaXN0cmF0aW9uIGZvciBhbiBpbnN0YW5jZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRlcmVnaXN0ZXIoKSB7XHJcbiAgICAgICAgICB2YXIgaW5kZXggPSBpbnN0YW5jZXMuaW5kZXhPZihpbnN0YW5jZSk7XHJcbiAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUmVzb2x2ZSBhbnkgcGVuZGluZyBwcm9taXNlcyBmb3IgdGhpcyBpbnN0YW5jZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIHJlc29sdmVXaGVuKCkge1xyXG4gICAgICAgICAgdmFyIGRmZCA9IHBlbmRpbmdzW2hhbmRsZV07XHJcbiAgICAgICAgICBpZiAoIGRmZCApIHtcclxuICAgICAgICAgICAgZGZkLnJlc29sdmUoIGluc3RhbmNlICk7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBwZW5kaW5nc1toYW5kbGVdO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBBc3luYyBhY2Nlc3NvciB0byByZWdpc3RlcmVkIGNvbXBvbmVudCBpbnN0YW5jZVxyXG4gICAgICAgKiBJZiBub3QgYXZhaWxhYmxlIHRoZW4gYSBwcm9taXNlIGlzIGNyZWF0ZWQgdG8gbm90aWZ5XHJcbiAgICAgICAqIGFsbCBsaXN0ZW5lcnMgd2hlbiB0aGUgaW5zdGFuY2UgaXMgcmVnaXN0ZXJlZC5cclxuICAgICAgICovXHJcbiAgICAgIHdoZW4gOiBmdW5jdGlvbihoYW5kbGUpIHtcclxuICAgICAgICBpZiAoIGlzVmFsaWRJRChoYW5kbGUpICkge1xyXG4gICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHNlbGYuZ2V0KGhhbmRsZSk7XHJcblxyXG4gICAgICAgICAgaWYgKCBpbnN0YW5jZSApICB7XHJcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoIGluc3RhbmNlICk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwZW5kaW5nc1toYW5kbGVdID0gZGVmZXJyZWQ7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAkcS5yZWplY3QoXCJJbnZhbGlkIGBtZC1jb21wb25lbnQtaWRgIHZhbHVlLlwiKTtcclxuICAgICAgfVxyXG5cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gaXNWYWxpZElEKGhhbmRsZSl7XHJcbiAgICAgIHJldHVybiBoYW5kbGUgJiYgKGhhbmRsZSAhPT0gXCJcIik7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuICBDb21wb25lbnRSZWdpc3RyeS4kaW5qZWN0ID0gW1wiJGxvZ1wiLCBcIiRxXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgKiBAbmFtZSAkbWRCdXR0b25JbmtSaXBwbGVcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFByb3ZpZGVzIHJpcHBsZSBlZmZlY3RzIGZvciBtZC1idXR0b24uICBTZWUgJG1kSW5rUmlwcGxlIHNlcnZpY2UgZm9yIGFsbCBwb3NzaWJsZSBjb25maWd1cmF0aW9uIG9wdGlvbnMuXHJcbiAgICpcclxuICAgKiBAcGFyYW0ge29iamVjdD19IHNjb3BlIFNjb3BlIHdpdGhpbiB0aGUgY3VycmVudCBjb250ZXh0XHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBlbGVtZW50IFRoZSBlbGVtZW50IHRoZSByaXBwbGUgZWZmZWN0IHNob3VsZCBiZSBhcHBsaWVkIHRvXHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIChPcHRpb25hbCkgQ29uZmlndXJhdGlvbiBvcHRpb25zIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0cmlwcGxlIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuXHJcbiAgYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gICAgLmZhY3RvcnkoJyRtZEJ1dHRvbklua1JpcHBsZScsIE1kQnV0dG9uSW5rUmlwcGxlKTtcclxuXHJcbiAgZnVuY3Rpb24gTWRCdXR0b25JbmtSaXBwbGUoJG1kSW5rUmlwcGxlKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhdHRhY2g6IGF0dGFjaFxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBhdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgdmFyIGVsZW1lbnRPcHRpb25zID0gb3B0aW9uc0ZvckVsZW1lbnQoZWxlbWVudCk7XHJcbiAgICAgIHJldHVybiAkbWRJbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBhbmd1bGFyLmV4dGVuZChlbGVtZW50T3B0aW9ucywgb3B0aW9ucykpO1xyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBvcHRpb25zRm9yRWxlbWVudChlbGVtZW50KSB7XHJcbiAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdtZC1pY29uLWJ1dHRvbicpKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGlzTWVudUl0ZW06IGVsZW1lbnQuaGFzQ2xhc3MoJ21kLW1lbnUtaXRlbScpLFxyXG4gICAgICAgICAgZml0UmlwcGxlOiB0cnVlLFxyXG4gICAgICAgICAgY2VudGVyOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaXNNZW51SXRlbTogZWxlbWVudC5oYXNDbGFzcygnbWQtbWVudS1pdGVtJyksXHJcbiAgICAgICAgICBkaW1CYWNrZ3JvdW5kOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuICBNZEJ1dHRvbklua1JpcHBsZS4kaW5qZWN0ID0gW1wiJG1kSW5rUmlwcGxlXCJdOztcclxufSkoKTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLyoqXHJcbiAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgKiBAbmFtZSAkbWRDaGVja2JveElua1JpcHBsZVxyXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29yZVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogUHJvdmlkZXMgcmlwcGxlIGVmZmVjdHMgZm9yIG1kLWNoZWNrYm94LiAgU2VlICRtZElua1JpcHBsZSBzZXJ2aWNlIGZvciBhbGwgcG9zc2libGUgY29uZmlndXJhdGlvbiBvcHRpb25zLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBzY29wZSBTY29wZSB3aXRoaW4gdGhlIGN1cnJlbnQgY29udGV4dFxyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gZWxlbWVudCBUaGUgZWxlbWVudCB0aGUgcmlwcGxlIGVmZmVjdCBzaG91bGQgYmUgYXBwbGllZCB0b1xyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAoT3B0aW9uYWwpIENvbmZpZ3VyYXRpb24gb3B0aW9ucyB0byBvdmVycmlkZSB0aGUgZGVmYXVsdHJpcHBsZSBjb25maWd1cmF0aW9uXHJcbiAgICovXHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAgIC5mYWN0b3J5KCckbWRDaGVja2JveElua1JpcHBsZScsIE1kQ2hlY2tib3hJbmtSaXBwbGUpO1xyXG5cclxuICBmdW5jdGlvbiBNZENoZWNrYm94SW5rUmlwcGxlKCRtZElua1JpcHBsZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXR0YWNoOiBhdHRhY2hcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgIHJldHVybiAkbWRJbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBhbmd1bGFyLmV4dGVuZCh7XHJcbiAgICAgICAgY2VudGVyOiB0cnVlLFxyXG4gICAgICAgIGRpbUJhY2tncm91bmQ6IGZhbHNlLFxyXG4gICAgICAgIGZpdFJpcHBsZTogdHJ1ZVxyXG4gICAgICB9LCBvcHRpb25zKSk7XHJcbiAgICB9O1xyXG4gIH1cclxuICBNZENoZWNrYm94SW5rUmlwcGxlLiRpbmplY3QgPSBbXCIkbWRJbmtSaXBwbGVcIl07O1xyXG59KSgpO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgLyoqXHJcbiAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgKiBAbmFtZSAkbWRMaXN0SW5rUmlwcGxlXHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb3JlXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBQcm92aWRlcyByaXBwbGUgZWZmZWN0cyBmb3IgbWQtbGlzdC4gIFNlZSAkbWRJbmtSaXBwbGUgc2VydmljZSBmb3IgYWxsIHBvc3NpYmxlIGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gc2NvcGUgU2NvcGUgd2l0aGluIHRoZSBjdXJyZW50IGNvbnRleHRcclxuICAgKiBAcGFyYW0ge29iamVjdD19IGVsZW1lbnQgVGhlIGVsZW1lbnQgdGhlIHJpcHBsZSBlZmZlY3Qgc2hvdWxkIGJlIGFwcGxpZWQgdG9cclxuICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgKE9wdGlvbmFsKSBDb25maWd1cmF0aW9uIG9wdGlvbnMgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHRyaXBwbGUgY29uZmlndXJhdGlvblxyXG4gICAqL1xyXG5cclxuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZScpXHJcbiAgICAuZmFjdG9yeSgnJG1kTGlzdElua1JpcHBsZScsIE1kTGlzdElua1JpcHBsZSk7XHJcblxyXG4gIGZ1bmN0aW9uIE1kTGlzdElua1JpcHBsZSgkbWRJbmtSaXBwbGUpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGF0dGFjaDogYXR0YWNoXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIGF0dGFjaChzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICByZXR1cm4gJG1kSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCwgYW5ndWxhci5leHRlbmQoe1xyXG4gICAgICAgIGNlbnRlcjogZmFsc2UsXHJcbiAgICAgICAgZGltQmFja2dyb3VuZDogdHJ1ZSxcclxuICAgICAgICBvdXRsaW5lOiBmYWxzZSxcclxuICAgICAgICByaXBwbGVTaXplOiAnZnVsbCdcclxuICAgICAgfSwgb3B0aW9ucykpO1xyXG4gICAgfTtcclxuICB9XHJcbiAgTWRMaXN0SW5rUmlwcGxlLiRpbmplY3QgPSBbXCIkbWRJbmtSaXBwbGVcIl07O1xyXG59KSgpO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvcmUnKVxyXG4gIC5mYWN0b3J5KCckbWRJbmtSaXBwbGUnLCBJbmtSaXBwbGVTZXJ2aWNlKVxyXG4gIC5kaXJlY3RpdmUoJ21kSW5rUmlwcGxlJywgSW5rUmlwcGxlRGlyZWN0aXZlKVxyXG4gIC5kaXJlY3RpdmUoJ21kTm9JbmsnLCBhdHRyTm9EaXJlY3RpdmUoKSlcclxuICAuZGlyZWN0aXZlKCdtZE5vQmFyJywgYXR0ck5vRGlyZWN0aXZlKCkpXHJcbiAgLmRpcmVjdGl2ZSgnbWROb1N0cmV0Y2gnLCBhdHRyTm9EaXJlY3RpdmUoKSk7XHJcblxyXG5mdW5jdGlvbiBJbmtSaXBwbGVEaXJlY3RpdmUoJG1kQnV0dG9uSW5rUmlwcGxlLCAkbWRDaGVja2JveElua1JpcHBsZSkge1xyXG4gIHJldHVybiB7XHJcbiAgICBjb250cm9sbGVyOiBhbmd1bGFyLm5vb3AsXHJcbiAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgaWYgKGF0dHIuaGFzT3duUHJvcGVydHkoJ21kSW5rUmlwcGxlQ2hlY2tib3gnKSkge1xyXG4gICAgICAgICRtZENoZWNrYm94SW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJG1kQnV0dG9uSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG59XHJcbklua1JpcHBsZURpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kQnV0dG9uSW5rUmlwcGxlXCIsIFwiJG1kQ2hlY2tib3hJbmtSaXBwbGVcIl07XHJcblxyXG5mdW5jdGlvbiBJbmtSaXBwbGVTZXJ2aWNlKCR3aW5kb3csICR0aW1lb3V0KSB7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBhdHRhY2g6IGF0dGFjaFxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIGF0dGFjaChzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgaWYgKGVsZW1lbnQuY29udHJvbGxlcignbWROb0luaycpKSByZXR1cm4gYW5ndWxhci5ub29wO1xyXG5cclxuICAgIG9wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZCh7XHJcbiAgICAgIGNvbG9yRWxlbWVudDogZWxlbWVudCxcclxuICAgICAgbW91c2Vkb3duOiB0cnVlLFxyXG4gICAgICBob3ZlcjogdHJ1ZSxcclxuICAgICAgZm9jdXM6IHRydWUsXHJcbiAgICAgIGNlbnRlcjogZmFsc2UsXHJcbiAgICAgIG1vdXNlZG93blBhdXNlVGltZTogMTUwLFxyXG4gICAgICBkaW1CYWNrZ3JvdW5kOiBmYWxzZSxcclxuICAgICAgb3V0bGluZTogZmFsc2UsXHJcbiAgICAgIGZ1bGxSaXBwbGU6IHRydWUsXHJcbiAgICAgIGlzTWVudUl0ZW06IGZhbHNlLFxyXG4gICAgICBmaXRSaXBwbGU6IGZhbHNlXHJcbiAgICB9LCBvcHRpb25zKTtcclxuXHJcbiAgICB2YXIgcmlwcGxlU2l6ZSxcclxuICAgICAgICBjb250cm9sbGVyID0gZWxlbWVudC5jb250cm9sbGVyKCdtZElua1JpcHBsZScpIHx8IHt9LFxyXG4gICAgICAgIGNvdW50ZXIgPSAwLFxyXG4gICAgICAgIHJpcHBsZXMgPSBbXSxcclxuICAgICAgICBzdGF0ZXMgPSBbXSxcclxuICAgICAgICBpc0FjdGl2ZUV4cHIgPSBlbGVtZW50LmF0dHIoJ21kLWhpZ2hsaWdodCcpLFxyXG4gICAgICAgIGlzQWN0aXZlID0gZmFsc2UsXHJcbiAgICAgICAgaXNIZWxkID0gZmFsc2UsXHJcbiAgICAgICAgbm9kZSA9IGVsZW1lbnRbMF0sXHJcbiAgICAgICAgcmlwcGxlU2l6ZVNldHRpbmcgPSBlbGVtZW50LmF0dHIoJ21kLXJpcHBsZS1zaXplJyksXHJcbiAgICAgICAgY29sb3IgPSBwYXJzZUNvbG9yKGVsZW1lbnQuYXR0cignbWQtaW5rLXJpcHBsZScpKSB8fCBwYXJzZUNvbG9yKG9wdGlvbnMuY29sb3JFbGVtZW50Lmxlbmd0aCAmJiAkd2luZG93LmdldENvbXB1dGVkU3R5bGUob3B0aW9ucy5jb2xvckVsZW1lbnRbMF0pLmNvbG9yIHx8ICdyZ2IoMCwgMCwgMCknKTtcclxuXHJcbiAgICBzd2l0Y2ggKHJpcHBsZVNpemVTZXR0aW5nKSB7XHJcbiAgICAgIGNhc2UgJ2Z1bGwnOlxyXG4gICAgICAgIG9wdGlvbnMuZnVsbFJpcHBsZSA9IHRydWU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3BhcnRpYWwnOlxyXG4gICAgICAgIG9wdGlvbnMuZnVsbFJpcHBsZSA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGV4cG9zZSBvbklucHV0IGZvciByaXBwbGUgdGVzdGluZ1xyXG4gICAgaWYgKG9wdGlvbnMubW91c2Vkb3duKSB7XHJcbiAgICAgIGVsZW1lbnQub24oJyRtZC5wcmVzc2Rvd24nLCBvblByZXNzRG93bilcclxuICAgICAgICAub24oJyRtZC5wcmVzc3VwJywgb25QcmVzc1VwKTtcclxuICAgIH1cclxuXHJcbiAgICBjb250cm9sbGVyLmNyZWF0ZVJpcHBsZSA9IGNyZWF0ZVJpcHBsZTtcclxuXHJcbiAgICBpZiAoaXNBY3RpdmVFeHByKSB7XHJcbiAgICAgIHNjb3BlLiR3YXRjaChpc0FjdGl2ZUV4cHIsIGZ1bmN0aW9uIHdhdGNoQWN0aXZlKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgaXNBY3RpdmUgPSBuZXdWYWx1ZTtcclxuICAgICAgICBpZiAoaXNBY3RpdmUgJiYgIXJpcHBsZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7IGNyZWF0ZVJpcHBsZSgwLCAwKTsgfSwgMCwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhbmd1bGFyLmZvckVhY2gocmlwcGxlcywgdXBkYXRlRWxlbWVudCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFB1Ymxpc2ggc2VsZi1kZXRhY2ggbWV0aG9kIGlmIGRlc2lyZWQuLi5cclxuICAgIHJldHVybiBmdW5jdGlvbiBkZXRhY2goKSB7XHJcbiAgICAgIGVsZW1lbnQub2ZmKCckbWQucHJlc3Nkb3duJywgb25QcmVzc0Rvd24pXHJcbiAgICAgICAgLm9mZignJG1kLnByZXNzdXAnLCBvblByZXNzVXApO1xyXG4gICAgICBnZXRSaXBwbGVDb250YWluZXIoKS5yZW1vdmUoKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBjdXJyZW50IHJpcHBsZSBjb250YWluZXJcclxuICAgICAqIElmIHRoZXJlIGlzIG5vIHJpcHBsZSBjb250YWluZXIsIGl0IGNyZWF0ZXMgb25lIGFuZCByZXR1cm5zIGl0XHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge2FuZ3VsYXIuZWxlbWVudH0gcmlwcGxlIGNvbnRhaW5lciBlbGVtZW50XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldFJpcHBsZUNvbnRhaW5lcigpIHtcclxuICAgICAgdmFyIGNvbnRhaW5lciA9IGVsZW1lbnQuZGF0YSgnJG1kUmlwcGxlQ29udGFpbmVyJyk7XHJcbiAgICAgIGlmIChjb250YWluZXIpIHJldHVybiBjb250YWluZXI7XHJcbiAgICAgIGNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cIm1kLXJpcHBsZS1jb250YWluZXJcIj4nKTtcclxuICAgICAgZWxlbWVudC5hcHBlbmQoY29udGFpbmVyKTtcclxuICAgICAgZWxlbWVudC5kYXRhKCckbWRSaXBwbGVDb250YWluZXInLCBjb250YWluZXIpO1xyXG4gICAgICByZXR1cm4gY29udGFpbmVyO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHBhcnNlQ29sb3IoY29sb3IpIHtcclxuICAgICAgaWYgKCFjb2xvcikgcmV0dXJuO1xyXG4gICAgICBpZiAoY29sb3IuaW5kZXhPZigncmdiYScpID09PSAwKSByZXR1cm4gY29sb3IucmVwbGFjZSgvXFxkP1xcLj9cXGQqXFxzKlxcKVxccyokLywgJzAuMSknKTtcclxuICAgICAgaWYgKGNvbG9yLmluZGV4T2YoJ3JnYicpICA9PT0gMCkgcmV0dXJuIHJnYlRvUkdCQShjb2xvcik7XHJcbiAgICAgIGlmIChjb2xvci5pbmRleE9mKCcjJykgICAgPT09IDApIHJldHVybiBoZXhUb1JHQkEoY29sb3IpO1xyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIENvbnZlcnRzIGEgaGV4IHZhbHVlIHRvIGFuIHJnYmEgc3RyaW5nXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBoZXggdmFsdWUgKDMgb3IgNiBkaWdpdHMpIHRvIGJlIGNvbnZlcnRlZFxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSByZ2JhIGNvbG9yIHdpdGggMC4xIGFscGhhXHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBoZXhUb1JHQkEoY29sb3IpIHtcclxuICAgICAgICB2YXIgaGV4ID0gY29sb3IuY2hhckF0KDApID09PSAnIycgPyBjb2xvci5zdWJzdHIoMSkgOiBjb2xvcixcclxuICAgICAgICAgIGRpZyA9IGhleC5sZW5ndGggLyAzLFxyXG4gICAgICAgICAgcmVkID0gaGV4LnN1YnN0cigwLCBkaWcpLFxyXG4gICAgICAgICAgZ3JuID0gaGV4LnN1YnN0cihkaWcsIGRpZyksXHJcbiAgICAgICAgICBibHUgPSBoZXguc3Vic3RyKGRpZyAqIDIpO1xyXG4gICAgICAgIGlmIChkaWcgPT09IDEpIHtcclxuICAgICAgICAgIHJlZCArPSByZWQ7XHJcbiAgICAgICAgICBncm4gKz0gZ3JuO1xyXG4gICAgICAgICAgYmx1ICs9IGJsdTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICdyZ2JhKCcgKyBwYXJzZUludChyZWQsIDE2KSArICcsJyArIHBhcnNlSW50KGdybiwgMTYpICsgJywnICsgcGFyc2VJbnQoYmx1LCAxNikgKyAnLDAuMSknO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQ29udmVydHMgcmdiIHZhbHVlIHRvIHJnYmEgc3RyaW5nXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZ2IgY29sb3Igc3RyaW5nXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHJnYmEgY29sb3Igd2l0aCAwLjEgYWxwaGFcclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIHJnYlRvUkdCQShjb2xvcikge1xyXG4gICAgICAgIHJldHVybiBjb2xvci5yZXBsYWNlKCcpJywgJywgMC4xKScpLnJlcGxhY2UoJygnLCAnYSgnKTtcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZW1vdmVFbGVtZW50KGVsZW0sIHdhaXQpIHtcclxuICAgICAgcmlwcGxlcy5zcGxpY2UocmlwcGxlcy5pbmRleE9mKGVsZW0pLCAxKTtcclxuICAgICAgaWYgKHJpcHBsZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgZ2V0UmlwcGxlQ29udGFpbmVyKCkuY3NzKHsgYmFja2dyb3VuZENvbG9yOiAnJyB9KTtcclxuICAgICAgfVxyXG4gICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7IGVsZW0ucmVtb3ZlKCk7IH0sIHdhaXQsIGZhbHNlKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVFbGVtZW50KGVsZW0pIHtcclxuICAgICAgdmFyIGluZGV4ID0gcmlwcGxlcy5pbmRleE9mKGVsZW0pLFxyXG4gICAgICAgICAgc3RhdGUgPSBzdGF0ZXNbaW5kZXhdIHx8IHt9LFxyXG4gICAgICAgICAgZWxlbUlzQWN0aXZlID0gcmlwcGxlcy5sZW5ndGggPiAxID8gZmFsc2UgOiBpc0FjdGl2ZSxcclxuICAgICAgICAgIGVsZW1Jc0hlbGQgICA9IHJpcHBsZXMubGVuZ3RoID4gMSA/IGZhbHNlIDogaXNIZWxkO1xyXG4gICAgICBpZiAoZWxlbUlzQWN0aXZlIHx8IHN0YXRlLmFuaW1hdGluZyB8fCBlbGVtSXNIZWxkKSB7XHJcbiAgICAgICAgZWxlbS5hZGRDbGFzcygnbWQtcmlwcGxlLXZpc2libGUnKTtcclxuICAgICAgfSBlbHNlIGlmIChlbGVtKSB7XHJcbiAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnbWQtcmlwcGxlLXZpc2libGUnKTtcclxuICAgICAgICBpZiAob3B0aW9ucy5vdXRsaW5lKSB7XHJcbiAgICAgICAgICBlbGVtLmNzcyh7XHJcbiAgICAgICAgICAgIHdpZHRoOiByaXBwbGVTaXplICsgJ3B4JyxcclxuICAgICAgICAgICAgaGVpZ2h0OiByaXBwbGVTaXplICsgJ3B4JyxcclxuICAgICAgICAgICAgbWFyZ2luTGVmdDogKHJpcHBsZVNpemUgKiAtMSkgKyAncHgnLFxyXG4gICAgICAgICAgICBtYXJnaW5Ub3A6IChyaXBwbGVTaXplICogLTEpICsgJ3B4J1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlbW92ZUVsZW1lbnQoZWxlbSwgb3B0aW9ucy5vdXRsaW5lID8gNDUwIDogNjUwKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIHJpcHBsZSBhdCB0aGUgcHJvdmlkZWQgY29vcmRpbmF0ZXNcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGVmdCBjdXJzb3IgcG9zaXRpb25cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0b3AgY3Vyc29yIHBvc2l0aW9uXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge2FuZ3VsYXIuZWxlbWVudH0gdGhlIGdlbmVyYXRlZCByaXBwbGUgZWxlbWVudFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjcmVhdGVSaXBwbGUobGVmdCwgdG9wKSB7XHJcblxyXG4gICAgICBjb2xvciA9IHBhcnNlQ29sb3IoZWxlbWVudC5hdHRyKCdtZC1pbmstcmlwcGxlJykpIHx8IHBhcnNlQ29sb3IoJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG9wdGlvbnMuY29sb3JFbGVtZW50WzBdKS5jb2xvciB8fCAncmdiKDAsIDAsIDApJyk7XHJcblxyXG4gICAgICB2YXIgY29udGFpbmVyID0gZ2V0UmlwcGxlQ29udGFpbmVyKCksXHJcbiAgICAgICAgICBzaXplID0gZ2V0UmlwcGxlU2l6ZShsZWZ0LCB0b3ApLFxyXG4gICAgICAgICAgY3NzID0gZ2V0UmlwcGxlQ3NzKHNpemUsIGxlZnQsIHRvcCksXHJcbiAgICAgICAgICBlbGVtID0gZ2V0UmlwcGxlRWxlbWVudChjc3MpLFxyXG4gICAgICAgICAgaW5kZXggPSByaXBwbGVzLmluZGV4T2YoZWxlbSksXHJcbiAgICAgICAgICBzdGF0ZSA9IHN0YXRlc1tpbmRleF0gfHwge307XHJcblxyXG4gICAgICByaXBwbGVTaXplID0gc2l6ZTtcclxuXHJcbiAgICAgIHN0YXRlLmFuaW1hdGluZyA9IHRydWU7XHJcblxyXG4gICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuZGltQmFja2dyb3VuZCkge1xyXG4gICAgICAgICAgY29udGFpbmVyLmNzcyh7IGJhY2tncm91bmRDb2xvcjogY29sb3IgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsZW0uYWRkQ2xhc3MoJ21kLXJpcHBsZS1wbGFjZWQgbWQtcmlwcGxlLXNjYWxlZCcpO1xyXG4gICAgICAgIGlmIChvcHRpb25zLm91dGxpbmUpIHtcclxuICAgICAgICAgIGVsZW0uY3NzKHtcclxuICAgICAgICAgICAgYm9yZGVyV2lkdGg6IChzaXplICogMC41KSArICdweCcsXHJcbiAgICAgICAgICAgIG1hcmdpbkxlZnQ6IChzaXplICogLTAuNSkgKyAncHgnLFxyXG4gICAgICAgICAgICBtYXJnaW5Ub3A6IChzaXplICogLTAuNSkgKyAncHgnXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZWxlbS5jc3MoeyBsZWZ0OiAnNTAlJywgdG9wOiAnNTAlJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdXBkYXRlRWxlbWVudChlbGVtKTtcclxuICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBzdGF0ZS5hbmltYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgIHVwZGF0ZUVsZW1lbnQoZWxlbSk7XHJcbiAgICAgICAgfSwgKG9wdGlvbnMub3V0bGluZSA/IDQ1MCA6IDIyNSksIGZhbHNlKTtcclxuICAgICAgfSwgMCwgZmFsc2UpO1xyXG5cclxuICAgICAgcmV0dXJuIGVsZW07XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQ3JlYXRlcyB0aGUgcmlwcGxlIGVsZW1lbnQgd2l0aCB0aGUgcHJvdmlkZWQgY3NzXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjc3MgcHJvcGVydGllcyB0byBiZSBhcHBsaWVkXHJcbiAgICAgICAqXHJcbiAgICAgICAqIEByZXR1cm5zIHthbmd1bGFyLmVsZW1lbnR9IHRoZSBnZW5lcmF0ZWQgcmlwcGxlIGVsZW1lbnRcclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIGdldFJpcHBsZUVsZW1lbnQoY3NzKSB7XHJcbiAgICAgICAgdmFyIGVsZW0gPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXYgY2xhc3M9XCJtZC1yaXBwbGVcIiBkYXRhLWNvdW50ZXI9XCInICsgY291bnRlcisrICsgJ1wiPicpO1xyXG4gICAgICAgIHJpcHBsZXMudW5zaGlmdChlbGVtKTtcclxuICAgICAgICBzdGF0ZXMudW5zaGlmdCh7IGFuaW1hdGluZzogdHJ1ZSB9KTtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kKGVsZW0pO1xyXG4gICAgICAgIGNzcyAmJiBlbGVtLmNzcyhjc3MpO1xyXG4gICAgICAgIHJldHVybiBlbGVtO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQ2FsY3VsYXRlIHRoZSByaXBwbGUgc2l6ZVxyXG4gICAgICAgKlxyXG4gICAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBjYWxjdWxhdGVkIHJpcHBsZSBkaWFtZXRlclxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gZ2V0UmlwcGxlU2l6ZShsZWZ0LCB0b3ApIHtcclxuICAgICAgICB2YXIgd2lkdGggPSBjb250YWluZXIucHJvcCgnb2Zmc2V0V2lkdGgnKSxcclxuICAgICAgICAgICAgaGVpZ2h0ID0gY29udGFpbmVyLnByb3AoJ29mZnNldEhlaWdodCcpLFxyXG4gICAgICAgICAgICBtdWx0aXBsaWVyLCBzaXplLCByZWN0O1xyXG4gICAgICAgIGlmIChvcHRpb25zLmlzTWVudUl0ZW0pIHtcclxuICAgICAgICAgIHNpemUgPSBNYXRoLnNxcnQoTWF0aC5wb3cod2lkdGgsIDIpICsgTWF0aC5wb3coaGVpZ2h0LCAyKSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLm91dGxpbmUpIHtcclxuICAgICAgICAgIHJlY3QgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgbGVmdCAtPSByZWN0LmxlZnQ7XHJcbiAgICAgICAgICB0b3AgLT0gcmVjdC50b3A7XHJcbiAgICAgICAgICB3aWR0aCA9IE1hdGgubWF4KGxlZnQsIHdpZHRoIC0gbGVmdCk7XHJcbiAgICAgICAgICBoZWlnaHQgPSBNYXRoLm1heCh0b3AsIGhlaWdodCAtIHRvcCk7XHJcbiAgICAgICAgICBzaXplID0gMiAqIE1hdGguc3FydChNYXRoLnBvdyh3aWR0aCwgMikgKyBNYXRoLnBvdyhoZWlnaHQsIDIpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbXVsdGlwbGllciA9IG9wdGlvbnMuZnVsbFJpcHBsZSA/IDEuMSA6IDAuODtcclxuICAgICAgICAgIHNpemUgPSBNYXRoLnNxcnQoTWF0aC5wb3cod2lkdGgsIDIpICsgTWF0aC5wb3coaGVpZ2h0LCAyKSkgKiBtdWx0aXBsaWVyO1xyXG4gICAgICAgICAgaWYgKG9wdGlvbnMuZml0UmlwcGxlKSB7XHJcbiAgICAgICAgICAgIHNpemUgPSBNYXRoLm1pbihoZWlnaHQsIHdpZHRoLCBzaXplKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNpemU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBHZW5lcmF0ZXMgdGhlIHJpcHBsZSBjc3NcclxuICAgICAgICpcclxuICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHRoZSBkaWFtZXRlciBvZiB0aGUgcmlwcGxlXHJcbiAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aGUgbGVmdCBjdXJzb3Igb2Zmc2V0XHJcbiAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aGUgdG9wIGN1cnNvciBvZmZzZXRcclxuICAgICAgICpcclxuICAgICAgICogQHJldHVybnMge3tiYWNrZ3JvdW5kQ29sb3I6IHN0cmluZywgYm9yZGVyQ29sb3I6IHN0cmluZywgd2lkdGg6IHN0cmluZywgaGVpZ2h0OiBzdHJpbmd9fVxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gZ2V0UmlwcGxlQ3NzKHNpemUsIGxlZnQsIHRvcCkge1xyXG4gICAgICAgIHZhciByZWN0ID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICAgICAgY3NzICA9IHtcclxuICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHJnYmFUb1JHQihjb2xvciksXHJcbiAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IHJnYmFUb1JHQihjb2xvciksXHJcbiAgICAgICAgICAgICAgd2lkdGg6IHNpemUgKyAncHgnLFxyXG4gICAgICAgICAgICAgIGhlaWdodDogc2l6ZSArICdweCdcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMub3V0bGluZSkge1xyXG4gICAgICAgICAgY3NzLndpZHRoID0gMDtcclxuICAgICAgICAgIGNzcy5oZWlnaHQgPSAwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjc3MubWFyZ2luTGVmdCA9IGNzcy5tYXJnaW5Ub3AgPSAoc2l6ZSAqIC0wLjUpICsgJ3B4JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvcHRpb25zLmNlbnRlcikge1xyXG4gICAgICAgICAgY3NzLmxlZnQgPSBjc3MudG9wID0gJzUwJSc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNzcy5sZWZ0ID0gTWF0aC5yb3VuZCgobGVmdCAtIHJlY3QubGVmdCkgLyBjb250YWluZXIucHJvcCgnb2Zmc2V0V2lkdGgnKSAqIDEwMCkgKyAnJSc7XHJcbiAgICAgICAgICBjc3MudG9wID0gTWF0aC5yb3VuZCgodG9wIC0gcmVjdC50b3ApIC8gY29udGFpbmVyLnByb3AoJ29mZnNldEhlaWdodCcpICogMTAwKSArICclJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBjc3M7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbnZlcnRzIHJnYmEgc3RyaW5nIHRvIHJnYiwgcmVtb3ZpbmcgdGhlIGFscGhhIHZhbHVlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmdiYSBjb2xvclxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ30gcmdiIGNvbG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gcmdiYVRvUkdCKGNvbG9yKSB7XHJcbiAgICAgICAgICByZXR1cm4gY29sb3IucmVwbGFjZSgncmdiYScsICdyZ2InKS5yZXBsYWNlKC8sW15cXCksXStcXCkvLCAnKScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFuZGxlcyB1c2VyIGlucHV0IHN0YXJ0IGFuZCBzdG9wIGV2ZW50c1xyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gb25QcmVzc0Rvd24oZXYpIHtcclxuICAgICAgaWYgKCFpc1JpcHBsZUFsbG93ZWQoKSkgcmV0dXJuO1xyXG5cclxuICAgICAgY3JlYXRlUmlwcGxlKGV2LnBvaW50ZXIueCwgZXYucG9pbnRlci55KTtcclxuICAgICAgaXNIZWxkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG9uUHJlc3NVcCgpIHtcclxuICAgICAgaXNIZWxkID0gZmFsc2U7XHJcbiAgICAgIHZhciByaXBwbGUgPSByaXBwbGVzWyByaXBwbGVzLmxlbmd0aCAtIDEgXTtcclxuICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkgeyB1cGRhdGVFbGVtZW50KHJpcHBsZSk7IH0sIDAsIGZhbHNlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERldGVybWluZXMgaWYgdGhlIHJpcHBsZSBpcyBhbGxvd2VkXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUgaWYgdGhlIHJpcHBsZSBpcyBhbGxvd2VkLCBmYWxzZSBpZiBub3RcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaXNSaXBwbGVBbGxvd2VkKCkge1xyXG4gICAgICB2YXIgcGFyZW50ID0gbm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICB2YXIgZ3JhbmRwYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudE5vZGU7XHJcbiAgICAgIHZhciBhbmNlc3RvciA9IGdyYW5kcGFyZW50ICYmIGdyYW5kcGFyZW50LnBhcmVudE5vZGU7XHJcbiAgICAgIHJldHVybiAhaXNEaXNhYmxlZChub2RlKSAmJiAhaXNEaXNhYmxlZChwYXJlbnQpICYmICFpc0Rpc2FibGVkKGdyYW5kcGFyZW50KSAmJiAhaXNEaXNhYmxlZChhbmNlc3Rvcik7XHJcbiAgICAgIGZ1bmN0aW9uIGlzRGlzYWJsZWQgKGVsZW0pIHtcclxuICAgICAgICByZXR1cm4gZWxlbSAmJiBlbGVtLmhhc0F0dHJpYnV0ZSAmJiBlbGVtLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9XHJcbn1cclxuSW5rUmlwcGxlU2VydmljZS4kaW5qZWN0ID0gW1wiJHdpbmRvd1wiLCBcIiR0aW1lb3V0XCJdO1xyXG5cclxuLyoqXHJcbiAqIG5vaW5rL25vYmFyL25vc3RyZXRjaCBkaXJlY3RpdmU6IG1ha2UgYW55IGVsZW1lbnQgdGhhdCBoYXMgb25lIG9mXHJcbiAqIHRoZXNlIGF0dHJpYnV0ZXMgYmUgZ2l2ZW4gYSBjb250cm9sbGVyLCBzbyB0aGF0IG90aGVyIGRpcmVjdGl2ZXMgY2FuXHJcbiAqIGByZXF1aXJlOmAgdGhlc2UgYW5kIHNlZSBpZiB0aGVyZSBpcyBhIGBubzx4eHg+YCBwYXJlbnQgYXR0cmlidXRlLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPHBhcmVudCBtZC1uby1pbms+XHJcbiAqICAgPGNoaWxkIGRldGVjdC1ubz5cclxuICogICA8L2NoaWxkPlxyXG4gKiA8L3BhcmVudD5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICogbXlBcHAuZGlyZWN0aXZlKCdkZXRlY3RObycsIGZ1bmN0aW9uKCkge1xyXG4gKiAgIHJldHVybiB7XHJcbiAqICAgICByZXF1aXJlOiBbJ14/bWROb0luaycsIF4/bWROb0JhciddLFxyXG4gKiAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XHJcbiAqICAgICAgIHZhciBub2lua0N0cmwgPSBjdHJsc1swXTtcclxuICogICAgICAgdmFyIG5vYmFyQ3RybCA9IGN0cmxzWzFdO1xyXG4gKiAgICAgICBpZiAobm9JbmtDdHJsKSB7XHJcbiAqICAgICAgICAgYWxlcnQoXCJ0aGUgbWQtbm8taW5rIGZsYWcgaGFzIGJlZW4gc3BlY2lmaWVkIG9uIGFuIGFuY2VzdG9yIVwiKTtcclxuICogICAgICAgfVxyXG4gKiAgICAgICBpZiAobm9iYXJDdHJsKSB7XHJcbiAqICAgICAgICAgYWxlcnQoXCJ0aGUgbWQtbm8tYmFyIGZsYWcgaGFzIGJlZW4gc3BlY2lmaWVkIG9uIGFuIGFuY2VzdG9yIVwiKTtcclxuICogICAgICAgfVxyXG4gKiAgICAgfVxyXG4gKiAgIH07XHJcbiAqIH0pO1xyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5mdW5jdGlvbiBhdHRyTm9EaXJlY3RpdmUoKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udHJvbGxlcjogYW5ndWxhci5ub29wXHJcbiAgICB9O1xyXG4gIH07XHJcbn1cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgLyoqXHJcbiAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgKiBAbmFtZSAkbWRUYWJJbmtSaXBwbGVcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFByb3ZpZGVzIHJpcHBsZSBlZmZlY3RzIGZvciBtZC10YWJzLiAgU2VlICRtZElua1JpcHBsZSBzZXJ2aWNlIGZvciBhbGwgcG9zc2libGUgY29uZmlndXJhdGlvbiBvcHRpb25zLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtvYmplY3Q9fSBzY29wZSBTY29wZSB3aXRoaW4gdGhlIGN1cnJlbnQgY29udGV4dFxyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gZWxlbWVudCBUaGUgZWxlbWVudCB0aGUgcmlwcGxlIGVmZmVjdCBzaG91bGQgYmUgYXBwbGllZCB0b1xyXG4gICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAoT3B0aW9uYWwpIENvbmZpZ3VyYXRpb24gb3B0aW9ucyB0byBvdmVycmlkZSB0aGUgZGVmYXVsdHJpcHBsZSBjb25maWd1cmF0aW9uXHJcbiAgICovXHJcblxyXG4gIGFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlJylcclxuICAgIC5mYWN0b3J5KCckbWRUYWJJbmtSaXBwbGUnLCBNZFRhYklua1JpcHBsZSk7XHJcblxyXG4gIGZ1bmN0aW9uIE1kVGFiSW5rUmlwcGxlKCRtZElua1JpcHBsZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXR0YWNoOiBhdHRhY2hcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgIHJldHVybiAkbWRJbmtSaXBwbGUuYXR0YWNoKHNjb3BlLCBlbGVtZW50LCBhbmd1bGFyLmV4dGVuZCh7XHJcbiAgICAgICAgY2VudGVyOiBmYWxzZSxcclxuICAgICAgICBkaW1CYWNrZ3JvdW5kOiB0cnVlLFxyXG4gICAgICAgIG91dGxpbmU6IGZhbHNlLFxyXG4gICAgICAgIHJpcHBsZVNpemU6ICdmdWxsJ1xyXG4gICAgICB9LCBvcHRpb25zKSk7XHJcbiAgICB9O1xyXG4gIH1cclxuICBNZFRhYklua1JpcHBsZS4kaW5qZWN0ID0gW1wiJG1kSW5rUmlwcGxlXCJdOztcclxufSkoKTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb3JlLnRoZW1pbmcucGFsZXR0ZScsIFtdKVxyXG4uY29uc3RhbnQoJyRtZENvbG9yUGFsZXR0ZScsIHtcclxuICAncmVkJzoge1xyXG4gICAgJzUwJzogJyNmZmViZWUnLFxyXG4gICAgJzEwMCc6ICcjZmZjZGQyJyxcclxuICAgICcyMDAnOiAnI2VmOWE5YScsXHJcbiAgICAnMzAwJzogJyNlNTczNzMnLFxyXG4gICAgJzQwMCc6ICcjZWY1MzUwJyxcclxuICAgICc1MDAnOiAnI2Y0NDMzNicsXHJcbiAgICAnNjAwJzogJyNlNTM5MzUnLFxyXG4gICAgJzcwMCc6ICcjZDMyZjJmJyxcclxuICAgICc4MDAnOiAnI2M2MjgyOCcsXHJcbiAgICAnOTAwJzogJyNiNzFjMWMnLFxyXG4gICAgJ0ExMDAnOiAnI2ZmOGE4MCcsXHJcbiAgICAnQTIwMCc6ICcjZmY1MjUyJyxcclxuICAgICdBNDAwJzogJyNmZjE3NDQnLFxyXG4gICAgJ0E3MDAnOiAnI2Q1MDAwMCcsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIDMwMCA0MDAgQTEwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIDcwMCBBMjAwIEE0MDAgQTcwMCdcclxuICB9LFxyXG4gICdwaW5rJzoge1xyXG4gICAgJzUwJzogJyNmY2U0ZWMnLFxyXG4gICAgJzEwMCc6ICcjZjhiYmQwJyxcclxuICAgICcyMDAnOiAnI2Y0OGZiMScsXHJcbiAgICAnMzAwJzogJyNmMDYyOTInLFxyXG4gICAgJzQwMCc6ICcjZWM0MDdhJyxcclxuICAgICc1MDAnOiAnI2U5MWU2MycsXHJcbiAgICAnNjAwJzogJyNkODFiNjAnLFxyXG4gICAgJzcwMCc6ICcjYzIxODViJyxcclxuICAgICc4MDAnOiAnI2FkMTQ1NycsXHJcbiAgICAnOTAwJzogJyM4ODBlNGYnLFxyXG4gICAgJ0ExMDAnOiAnI2ZmODBhYicsXHJcbiAgICAnQTIwMCc6ICcjZmY0MDgxJyxcclxuICAgICdBNDAwJzogJyNmNTAwNTcnLFxyXG4gICAgJ0E3MDAnOiAnI2M1MTE2MicsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIDMwMCA0MDAgQTEwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc1MDAgNjAwIEEyMDAgQTQwMCBBNzAwJ1xyXG4gIH0sXHJcbiAgJ3B1cnBsZSc6IHtcclxuICAgICc1MCc6ICcjZjNlNWY1JyxcclxuICAgICcxMDAnOiAnI2UxYmVlNycsXHJcbiAgICAnMjAwJzogJyNjZTkzZDgnLFxyXG4gICAgJzMwMCc6ICcjYmE2OGM4JyxcclxuICAgICc0MDAnOiAnI2FiNDdiYycsXHJcbiAgICAnNTAwJzogJyM5YzI3YjAnLFxyXG4gICAgJzYwMCc6ICcjOGUyNGFhJyxcclxuICAgICc3MDAnOiAnIzdiMWZhMicsXHJcbiAgICAnODAwJzogJyM2YTFiOWEnLFxyXG4gICAgJzkwMCc6ICcjNGExNDhjJyxcclxuICAgICdBMTAwJzogJyNlYTgwZmMnLFxyXG4gICAgJ0EyMDAnOiAnI2UwNDBmYicsXHJcbiAgICAnQTQwMCc6ICcjZDUwMGY5JyxcclxuICAgICdBNzAwJzogJyNhYTAwZmYnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JyxcclxuICAgICdjb250cmFzdERhcmtDb2xvcnMnOiAnNTAgMTAwIDIwMCBBMTAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzMwMCA0MDAgQTIwMCBBNDAwIEE3MDAnXHJcbiAgfSxcclxuICAnZGVlcC1wdXJwbGUnOiB7XHJcbiAgICAnNTAnOiAnI2VkZTdmNicsXHJcbiAgICAnMTAwJzogJyNkMWM0ZTknLFxyXG4gICAgJzIwMCc6ICcjYjM5ZGRiJyxcclxuICAgICczMDAnOiAnIzk1NzVjZCcsXHJcbiAgICAnNDAwJzogJyM3ZTU3YzInLFxyXG4gICAgJzUwMCc6ICcjNjczYWI3JyxcclxuICAgICc2MDAnOiAnIzVlMzViMScsXHJcbiAgICAnNzAwJzogJyM1MTJkYTgnLFxyXG4gICAgJzgwMCc6ICcjNDUyN2EwJyxcclxuICAgICc5MDAnOiAnIzMxMWI5MicsXHJcbiAgICAnQTEwMCc6ICcjYjM4OGZmJyxcclxuICAgICdBMjAwJzogJyM3YzRkZmYnLFxyXG4gICAgJ0E0MDAnOiAnIzY1MWZmZicsXHJcbiAgICAnQTcwMCc6ICcjNjIwMGVhJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdsaWdodCcsXHJcbiAgICAnY29udHJhc3REYXJrQ29sb3JzJzogJzUwIDEwMCAyMDAgQTEwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICczMDAgNDAwIEEyMDAnXHJcbiAgfSxcclxuICAnaW5kaWdvJzoge1xyXG4gICAgJzUwJzogJyNlOGVhZjYnLFxyXG4gICAgJzEwMCc6ICcjYzVjYWU5JyxcclxuICAgICcyMDAnOiAnIzlmYThkYScsXHJcbiAgICAnMzAwJzogJyM3OTg2Y2InLFxyXG4gICAgJzQwMCc6ICcjNWM2YmMwJyxcclxuICAgICc1MDAnOiAnIzNmNTFiNScsXHJcbiAgICAnNjAwJzogJyMzOTQ5YWInLFxyXG4gICAgJzcwMCc6ICcjMzAzZjlmJyxcclxuICAgICc4MDAnOiAnIzI4MzU5MycsXHJcbiAgICAnOTAwJzogJyMxYTIzN2UnLFxyXG4gICAgJ0ExMDAnOiAnIzhjOWVmZicsXHJcbiAgICAnQTIwMCc6ICcjNTM2ZGZlJyxcclxuICAgICdBNDAwJzogJyMzZDVhZmUnLFxyXG4gICAgJ0E3MDAnOiAnIzMwNGZmZScsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIEExMDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnMzAwIDQwMCBBMjAwIEE0MDAnXHJcbiAgfSxcclxuICAnYmx1ZSc6IHtcclxuICAgICc1MCc6ICcjZTNmMmZkJyxcclxuICAgICcxMDAnOiAnI2JiZGVmYicsXHJcbiAgICAnMjAwJzogJyM5MGNhZjknLFxyXG4gICAgJzMwMCc6ICcjNjRiNWY2JyxcclxuICAgICc0MDAnOiAnIzQyYTVmNScsXHJcbiAgICAnNTAwJzogJyMyMTk2ZjMnLFxyXG4gICAgJzYwMCc6ICcjMWU4OGU1JyxcclxuICAgICc3MDAnOiAnIzE5NzZkMicsXHJcbiAgICAnODAwJzogJyMxNTY1YzAnLFxyXG4gICAgJzkwMCc6ICcjMGQ0N2ExJyxcclxuICAgICdBMTAwJzogJyM4MmIxZmYnLFxyXG4gICAgJ0EyMDAnOiAnIzQ0OGFmZicsXHJcbiAgICAnQTQwMCc6ICcjMjk3OWZmJyxcclxuICAgICdBNzAwJzogJyMyOTYyZmYnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2xpZ2h0JyxcclxuICAgICdjb250cmFzdERhcmtDb2xvcnMnOiAnMTAwIDIwMCAzMDAgNDAwIEExMDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgQTIwMCBBNDAwIEE3MDAnXHJcbiAgfSxcclxuICAnbGlnaHQtYmx1ZSc6IHtcclxuICAgICc1MCc6ICcjZTFmNWZlJyxcclxuICAgICcxMDAnOiAnI2IzZTVmYycsXHJcbiAgICAnMjAwJzogJyM4MWQ0ZmEnLFxyXG4gICAgJzMwMCc6ICcjNGZjM2Y3JyxcclxuICAgICc0MDAnOiAnIzI5YjZmNicsXHJcbiAgICAnNTAwJzogJyMwM2E5ZjQnLFxyXG4gICAgJzYwMCc6ICcjMDM5YmU1JyxcclxuICAgICc3MDAnOiAnIzAyODhkMScsXHJcbiAgICAnODAwJzogJyMwMjc3YmQnLFxyXG4gICAgJzkwMCc6ICcjMDE1NzliJyxcclxuICAgICdBMTAwJzogJyM4MGQ4ZmYnLFxyXG4gICAgJ0EyMDAnOiAnIzQwYzRmZicsXHJcbiAgICAnQTQwMCc6ICcjMDBiMGZmJyxcclxuICAgICdBNzAwJzogJyMwMDkxZWEnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxyXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwIDkwMCBBNzAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIDgwMCBBNzAwJ1xyXG4gIH0sXHJcbiAgJ2N5YW4nOiB7XHJcbiAgICAnNTAnOiAnI2UwZjdmYScsXHJcbiAgICAnMTAwJzogJyNiMmViZjInLFxyXG4gICAgJzIwMCc6ICcjODBkZWVhJyxcclxuICAgICczMDAnOiAnIzRkZDBlMScsXHJcbiAgICAnNDAwJzogJyMyNmM2ZGEnLFxyXG4gICAgJzUwMCc6ICcjMDBiY2Q0JyxcclxuICAgICc2MDAnOiAnIzAwYWNjMScsXHJcbiAgICAnNzAwJzogJyMwMDk3YTcnLFxyXG4gICAgJzgwMCc6ICcjMDA4MzhmJyxcclxuICAgICc5MDAnOiAnIzAwNjA2NCcsXHJcbiAgICAnQTEwMCc6ICcjODRmZmZmJyxcclxuICAgICdBMjAwJzogJyMxOGZmZmYnLFxyXG4gICAgJ0E0MDAnOiAnIzAwZTVmZicsXHJcbiAgICAnQTcwMCc6ICcjMDBiOGQ0JyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcclxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIDgwMCA5MDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAgODAwJ1xyXG4gIH0sXHJcbiAgJ3RlYWwnOiB7XHJcbiAgICAnNTAnOiAnI2UwZjJmMScsXHJcbiAgICAnMTAwJzogJyNiMmRmZGInLFxyXG4gICAgJzIwMCc6ICcjODBjYmM0JyxcclxuICAgICczMDAnOiAnIzRkYjZhYycsXHJcbiAgICAnNDAwJzogJyMyNmE2OWEnLFxyXG4gICAgJzUwMCc6ICcjMDA5Njg4JyxcclxuICAgICc2MDAnOiAnIzAwODk3YicsXHJcbiAgICAnNzAwJzogJyMwMDc5NmInLFxyXG4gICAgJzgwMCc6ICcjMDA2OTVjJyxcclxuICAgICc5MDAnOiAnIzAwNGQ0MCcsXHJcbiAgICAnQTEwMCc6ICcjYTdmZmViJyxcclxuICAgICdBMjAwJzogJyM2NGZmZGEnLFxyXG4gICAgJ0E0MDAnOiAnIzFkZTliNicsXHJcbiAgICAnQTcwMCc6ICcjMDBiZmE1JyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcclxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIDgwMCA5MDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAnXHJcbiAgfSxcclxuICAnZ3JlZW4nOiB7XHJcbiAgICAnNTAnOiAnI2U4ZjVlOScsXHJcbiAgICAnMTAwJzogJyNjOGU2YzknLFxyXG4gICAgJzIwMCc6ICcjYTVkNmE3JyxcclxuICAgICczMDAnOiAnIzgxYzc4NCcsXHJcbiAgICAnNDAwJzogJyM2NmJiNmEnLFxyXG4gICAgJzUwMCc6ICcjNGNhZjUwJyxcclxuICAgICc2MDAnOiAnIzQzYTA0NycsXHJcbiAgICAnNzAwJzogJyMzODhlM2MnLFxyXG4gICAgJzgwMCc6ICcjMmU3ZDMyJyxcclxuICAgICc5MDAnOiAnIzFiNWUyMCcsXHJcbiAgICAnQTEwMCc6ICcjYjlmNmNhJyxcclxuICAgICdBMjAwJzogJyM2OWYwYWUnLFxyXG4gICAgJ0E0MDAnOiAnIzAwZTY3NicsXHJcbiAgICAnQTcwMCc6ICcjMDBjODUzJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcclxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIDgwMCA5MDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnNTAwIDYwMCA3MDAnXHJcbiAgfSxcclxuICAnbGlnaHQtZ3JlZW4nOiB7XHJcbiAgICAnNTAnOiAnI2YxZjhlOScsXHJcbiAgICAnMTAwJzogJyNkY2VkYzgnLFxyXG4gICAgJzIwMCc6ICcjYzVlMWE1JyxcclxuICAgICczMDAnOiAnI2FlZDU4MScsXHJcbiAgICAnNDAwJzogJyM5Y2NjNjUnLFxyXG4gICAgJzUwMCc6ICcjOGJjMzRhJyxcclxuICAgICc2MDAnOiAnIzdjYjM0MicsXHJcbiAgICAnNzAwJzogJyM2ODlmMzgnLFxyXG4gICAgJzgwMCc6ICcjNTU4YjJmJyxcclxuICAgICc5MDAnOiAnIzMzNjkxZScsXHJcbiAgICAnQTEwMCc6ICcjY2NmZjkwJyxcclxuICAgICdBMjAwJzogJyNiMmZmNTknLFxyXG4gICAgJ0E0MDAnOiAnIzc2ZmYwMycsXHJcbiAgICAnQTcwMCc6ICcjNjRkZDE3JyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJyxcclxuICAgICdjb250cmFzdExpZ2h0Q29sb3JzJzogJzgwMCA5MDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnODAwIDkwMCdcclxuICB9LFxyXG4gICdsaW1lJzoge1xyXG4gICAgJzUwJzogJyNmOWZiZTcnLFxyXG4gICAgJzEwMCc6ICcjZjBmNGMzJyxcclxuICAgICcyMDAnOiAnI2U2ZWU5YycsXHJcbiAgICAnMzAwJzogJyNkY2U3NzUnLFxyXG4gICAgJzQwMCc6ICcjZDRlMTU3JyxcclxuICAgICc1MDAnOiAnI2NkZGMzOScsXHJcbiAgICAnNjAwJzogJyNjMGNhMzMnLFxyXG4gICAgJzcwMCc6ICcjYWZiNDJiJyxcclxuICAgICc4MDAnOiAnIzllOWQyNCcsXHJcbiAgICAnOTAwJzogJyM4Mjc3MTcnLFxyXG4gICAgJ0ExMDAnOiAnI2Y0ZmY4MScsXHJcbiAgICAnQTIwMCc6ICcjZWVmZjQxJyxcclxuICAgICdBNDAwJzogJyNjNmZmMDAnLFxyXG4gICAgJ0E3MDAnOiAnI2FlZWEwMCcsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnZGFyaycsXHJcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc5MDAnLFxyXG4gICAgJ2NvbnRyYXN0U3Ryb25nTGlnaHRDb2xvcnMnOiAnOTAwJ1xyXG4gIH0sXHJcbiAgJ3llbGxvdyc6IHtcclxuICAgICc1MCc6ICcjZmZmZGU3JyxcclxuICAgICcxMDAnOiAnI2ZmZjljNCcsXHJcbiAgICAnMjAwJzogJyNmZmY1OWQnLFxyXG4gICAgJzMwMCc6ICcjZmZmMTc2JyxcclxuICAgICc0MDAnOiAnI2ZmZWU1OCcsXHJcbiAgICAnNTAwJzogJyNmZmViM2InLFxyXG4gICAgJzYwMCc6ICcjZmRkODM1JyxcclxuICAgICc3MDAnOiAnI2ZiYzAyZCcsXHJcbiAgICAnODAwJzogJyNmOWE4MjUnLFxyXG4gICAgJzkwMCc6ICcjZjU3ZjE3JyxcclxuICAgICdBMTAwJzogJyNmZmZmOGQnLFxyXG4gICAgJ0EyMDAnOiAnI2ZmZmYwMCcsXHJcbiAgICAnQTQwMCc6ICcjZmZlYTAwJyxcclxuICAgICdBNzAwJzogJyNmZmQ2MDAnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnXHJcbiAgfSxcclxuICAnYW1iZXInOiB7XHJcbiAgICAnNTAnOiAnI2ZmZjhlMScsXHJcbiAgICAnMTAwJzogJyNmZmVjYjMnLFxyXG4gICAgJzIwMCc6ICcjZmZlMDgyJyxcclxuICAgICczMDAnOiAnI2ZmZDU0ZicsXHJcbiAgICAnNDAwJzogJyNmZmNhMjgnLFxyXG4gICAgJzUwMCc6ICcjZmZjMTA3JyxcclxuICAgICc2MDAnOiAnI2ZmYjMwMCcsXHJcbiAgICAnNzAwJzogJyNmZmEwMDAnLFxyXG4gICAgJzgwMCc6ICcjZmY4ZjAwJyxcclxuICAgICc5MDAnOiAnI2ZmNmYwMCcsXHJcbiAgICAnQTEwMCc6ICcjZmZlNTdmJyxcclxuICAgICdBMjAwJzogJyNmZmQ3NDAnLFxyXG4gICAgJ0E0MDAnOiAnI2ZmYzQwMCcsXHJcbiAgICAnQTcwMCc6ICcjZmZhYjAwJyxcclxuICAgICdjb250cmFzdERlZmF1bHRDb2xvcic6ICdkYXJrJ1xyXG4gIH0sXHJcbiAgJ29yYW5nZSc6IHtcclxuICAgICc1MCc6ICcjZmZmM2UwJyxcclxuICAgICcxMDAnOiAnI2ZmZTBiMicsXHJcbiAgICAnMjAwJzogJyNmZmNjODAnLFxyXG4gICAgJzMwMCc6ICcjZmZiNzRkJyxcclxuICAgICc0MDAnOiAnI2ZmYTcyNicsXHJcbiAgICAnNTAwJzogJyNmZjk4MDAnLFxyXG4gICAgJzYwMCc6ICcjZmI4YzAwJyxcclxuICAgICc3MDAnOiAnI2Y1N2MwMCcsXHJcbiAgICAnODAwJzogJyNlZjZjMDAnLFxyXG4gICAgJzkwMCc6ICcjZTY1MTAwJyxcclxuICAgICdBMTAwJzogJyNmZmQxODAnLFxyXG4gICAgJ0EyMDAnOiAnI2ZmYWI0MCcsXHJcbiAgICAnQTQwMCc6ICcjZmY5MTAwJyxcclxuICAgICdBNzAwJzogJyNmZjZkMDAnLFxyXG4gICAgJ2NvbnRyYXN0RGVmYXVsdENvbG9yJzogJ2RhcmsnLFxyXG4gICAgJ2NvbnRyYXN0TGlnaHRDb2xvcnMnOiAnODAwIDkwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc4MDAgOTAwJ1xyXG4gIH0sXHJcbiAgJ2RlZXAtb3JhbmdlJzoge1xyXG4gICAgJzUwJzogJyNmYmU5ZTcnLFxyXG4gICAgJzEwMCc6ICcjZmZjY2JjJyxcclxuICAgICcyMDAnOiAnI2ZmYWI5MScsXHJcbiAgICAnMzAwJzogJyNmZjhhNjUnLFxyXG4gICAgJzQwMCc6ICcjZmY3MDQzJyxcclxuICAgICc1MDAnOiAnI2ZmNTcyMicsXHJcbiAgICAnNjAwJzogJyNmNDUxMWUnLFxyXG4gICAgJzcwMCc6ICcjZTY0YTE5JyxcclxuICAgICc4MDAnOiAnI2Q4NDMxNScsXHJcbiAgICAnOTAwJzogJyNiZjM2MGMnLFxyXG4gICAgJ0ExMDAnOiAnI2ZmOWU4MCcsXHJcbiAgICAnQTIwMCc6ICcjZmY2ZTQwJyxcclxuICAgICdBNDAwJzogJyNmZjNkMDAnLFxyXG4gICAgJ0E3MDAnOiAnI2RkMmMwMCcsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIDMwMCA0MDAgQTEwMCBBMjAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzUwMCA2MDAgNzAwIDgwMCA5MDAgQTQwMCBBNzAwJ1xyXG4gIH0sXHJcbiAgJ2Jyb3duJzoge1xyXG4gICAgJzUwJzogJyNlZmViZTknLFxyXG4gICAgJzEwMCc6ICcjZDdjY2M4JyxcclxuICAgICcyMDAnOiAnI2JjYWFhNCcsXHJcbiAgICAnMzAwJzogJyNhMTg4N2YnLFxyXG4gICAgJzQwMCc6ICcjOGQ2ZTYzJyxcclxuICAgICc1MDAnOiAnIzc5NTU0OCcsXHJcbiAgICAnNjAwJzogJyM2ZDRjNDEnLFxyXG4gICAgJzcwMCc6ICcjNWQ0MDM3JyxcclxuICAgICc4MDAnOiAnIzRlMzQyZScsXHJcbiAgICAnOTAwJzogJyMzZTI3MjMnLFxyXG4gICAgJ0ExMDAnOiAnI2Q3Y2NjOCcsXHJcbiAgICAnQTIwMCc6ICcjYmNhYWE0JyxcclxuICAgICdBNDAwJzogJyM4ZDZlNjMnLFxyXG4gICAgJ0E3MDAnOiAnIzVkNDAzNycsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwJyxcclxuICAgICdjb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzJzogJzMwMCA0MDAnXHJcbiAgfSxcclxuICAnZ3JleSc6IHtcclxuICAgICc1MCc6ICcjZmFmYWZhJyxcclxuICAgICcxMDAnOiAnI2Y1ZjVmNScsXHJcbiAgICAnMjAwJzogJyNlZWVlZWUnLFxyXG4gICAgJzMwMCc6ICcjZTBlMGUwJyxcclxuICAgICc0MDAnOiAnI2JkYmRiZCcsXHJcbiAgICAnNTAwJzogJyM5ZTllOWUnLFxyXG4gICAgJzYwMCc6ICcjNzU3NTc1JyxcclxuICAgICc3MDAnOiAnIzYxNjE2MScsXHJcbiAgICAnODAwJzogJyM0MjQyNDInLFxyXG4gICAgJzkwMCc6ICcjMjEyMTIxJyxcclxuICAgICcxMDAwJzogJyMwMDAwMDAnLFxyXG4gICAgJ0ExMDAnOiAnI2ZmZmZmZicsXHJcbiAgICAnQTIwMCc6ICcjZWVlZWVlJyxcclxuICAgICdBNDAwJzogJyNiZGJkYmQnLFxyXG4gICAgJ0E3MDAnOiAnIzYxNjE2MScsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnZGFyaycsXHJcbiAgICAnY29udHJhc3RMaWdodENvbG9ycyc6ICc2MDAgNzAwIDgwMCA5MDAnXHJcbiAgfSxcclxuICAnYmx1ZS1ncmV5Jzoge1xyXG4gICAgJzUwJzogJyNlY2VmZjEnLFxyXG4gICAgJzEwMCc6ICcjY2ZkOGRjJyxcclxuICAgICcyMDAnOiAnI2IwYmVjNScsXHJcbiAgICAnMzAwJzogJyM5MGE0YWUnLFxyXG4gICAgJzQwMCc6ICcjNzg5MDljJyxcclxuICAgICc1MDAnOiAnIzYwN2Q4YicsXHJcbiAgICAnNjAwJzogJyM1NDZlN2EnLFxyXG4gICAgJzcwMCc6ICcjNDU1YTY0JyxcclxuICAgICc4MDAnOiAnIzM3NDc0ZicsXHJcbiAgICAnOTAwJzogJyMyNjMyMzgnLFxyXG4gICAgJ0ExMDAnOiAnI2NmZDhkYycsXHJcbiAgICAnQTIwMCc6ICcjYjBiZWM1JyxcclxuICAgICdBNDAwJzogJyM3ODkwOWMnLFxyXG4gICAgJ0E3MDAnOiAnIzQ1NWE2NCcsXHJcbiAgICAnY29udHJhc3REZWZhdWx0Q29sb3InOiAnbGlnaHQnLFxyXG4gICAgJ2NvbnRyYXN0RGFya0NvbG9ycyc6ICc1MCAxMDAgMjAwIDMwMCcsXHJcbiAgICAnY29udHJhc3RTdHJvbmdMaWdodENvbG9ycyc6ICc0MDAgNTAwJ1xyXG4gIH1cclxufSk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29yZS50aGVtaW5nJywgWydtYXRlcmlhbC5jb3JlLnRoZW1pbmcucGFsZXR0ZSddKVxyXG4gIC5kaXJlY3RpdmUoJ21kVGhlbWUnLCBUaGVtaW5nRGlyZWN0aXZlKVxyXG4gIC5kaXJlY3RpdmUoJ21kVGhlbWFibGUnLCBUaGVtYWJsZURpcmVjdGl2ZSlcclxuICAucHJvdmlkZXIoJyRtZFRoZW1pbmcnLCBUaGVtaW5nUHJvdmlkZXIpXHJcbiAgLnJ1bihnZW5lcmF0ZVRoZW1lcyk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIHByb3ZpZGVyXHJcbiAqIEBuYW1lICRtZFRoZW1pbmdQcm92aWRlclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvcmVcclxuICpcclxuICogQGRlc2NyaXB0aW9uIFByb3ZpZGVyIHRvIGNvbmZpZ3VyZSB0aGUgYCRtZFRoZW1pbmdgIHNlcnZpY2UuXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kVGhlbWluZ1Byb3ZpZGVyI3NldERlZmF1bHRUaGVtZVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdGhlbWVOYW1lIERlZmF1bHQgdGhlbWUgbmFtZSB0byBiZSBhcHBsaWVkIHRvIGVsZW1lbnRzLiBEZWZhdWx0IHZhbHVlIGlzIGBkZWZhdWx0YC5cclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRUaGVtaW5nUHJvdmlkZXIjYWx3YXlzV2F0Y2hUaGVtZVxyXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHdhdGNoIFdoZXRoZXIgb3Igbm90IHRvIGFsd2F5cyB3YXRjaCB0aGVtZXMgZm9yIGNoYW5nZXMgYW5kIHJlLWFwcGx5XHJcbiAqIGNsYXNzZXMgd2hlbiB0aGV5IGNoYW5nZS4gRGVmYXVsdCBpcyBgZmFsc2VgLiBFbmFibGluZyBjYW4gcmVkdWNlIHBlcmZvcm1hbmNlLlxyXG4gKi9cclxuXHJcbi8qIFNvbWUgRXhhbXBsZSBWYWxpZCBUaGVtaW5nIEV4cHJlc3Npb25zXHJcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKlxyXG4gKiBJbnRlbnRpb24gZ3JvdXAgZXhwYW5zaW9uOiAodmFsaWQgZm9yIHByaW1hcnksIGFjY2VudCwgd2FybiwgYmFja2dyb3VuZClcclxuICpcclxuICoge3twcmltYXJ5LTEwMH19IC0gZ3JhYiBzaGFkZSAxMDAgZnJvbSB0aGUgcHJpbWFyeSBwYWxldHRlXHJcbiAqIHt7cHJpbWFyeS0xMDAtMC43fX0gLSBncmFiIHNoYWRlIDEwMCwgYXBwbHkgb3BhY2l0eSBvZiAwLjdcclxuICoge3twcmltYXJ5LWh1ZS0xfX0gLSBncmFiIHRoZSBzaGFkZSBhc3NpZ25lZCB0byBodWUtMSBmcm9tIHRoZSBwcmltYXJ5IHBhbGV0dGVcclxuICoge3twcmltYXJ5LWh1ZS0xLTAuN319IC0gYXBwbHkgMC43IG9wYWNpdHkgdG8gcHJpbWFyeS1odWUtMVxyXG4gKiB7e3ByaW1hcnktY29sb3J9fSAtIEdlbmVyYXRlcyAubWQtaHVlLTEsIC5tZC1odWUtMiwgLm1kLWh1ZS0zIHdpdGggY29uZmlndXJlZCBzaGFkZXMgc2V0IGZvciBlYWNoIGh1ZVxyXG4gKiB7e3ByaW1hcnktY29sb3ItMC43fX0gLSBBcHBseSAwLjcgb3BhY2l0eSB0byBlYWNoIG9mIHRoZSBhYm92ZSBydWxlc1xyXG4gKiB7e3ByaW1hcnktY29udHJhc3R9fSAtIEdlbmVyYXRlcyAubWQtaHVlLTEsIC5tZC1odWUtMiwgLm1kLWh1ZS0zIHdpdGggY29uZmlndXJlZCBjb250cmFzdCAoaWUuIHRleHQpIGNvbG9yIHNoYWRlcyBzZXQgZm9yIGVhY2ggaHVlXHJcbiAqIHt7cHJpbWFyeS1jb250cmFzdC0wLjd9fSAtIEFwcGx5IDAuNyBvcGFjaXR5IHRvIGVhY2ggb2YgdGhlIGFib3ZlIHJ1bGVzXHJcbiAqXHJcbiAqIEZvcmVncm91bmQgZXhwYW5zaW9uOiBBcHBsaWVzIHJnYmEgdG8gYmxhY2svd2hpdGUgZm9yZWdyb3VuZCB0ZXh0XHJcbiAqXHJcbiAqIHt7Zm9yZWdyb3VuZC0xfX0gLSB1c2VkIGZvciBwcmltYXJ5IHRleHRcclxuICoge3tmb3JlZ3JvdW5kLTJ9fSAtIHVzZWQgZm9yIHNlY29uZGFyeSB0ZXh0L2RpdmlkZXJcclxuICoge3tmb3JlZ3JvdW5kLTN9fSAtIHVzZWQgZm9yIGRpc2FibGVkIHRleHRcclxuICoge3tmb3JlZ3JvdW5kLTR9fSAtIHVzZWQgZm9yIGRpdmlkZXJzXHJcbiAqXHJcbiAqL1xyXG5cclxuLy8gSW4gbWVtb3J5IGdlbmVyYXRlZCBDU1MgcnVsZXM7IHJlZ2lzdGVyZWQgYnkgdGhlbWUubmFtZVxyXG52YXIgR0VORVJBVEVEID0geyB9O1xyXG5cclxuLy8gSW4gbWVtb3J5IHN0b3JhZ2Ugb2YgZGVmaW5lZCB0aGVtZXMgYW5kIGNvbG9yIHBhbGV0dGVzIChib3RoIGxvYWRlZCBieSBDU1MsIGFuZCB1c2VyIHNwZWNpZmllZClcclxudmFyIFBBTEVUVEVTO1xyXG52YXIgVEhFTUVTO1xyXG5cclxudmFyIERBUktfRk9SRUdST1VORCA9IHtcclxuICBuYW1lOiAnZGFyaycsXHJcbiAgJzEnOiAncmdiYSgwLDAsMCwwLjg3KScsXHJcbiAgJzInOiAncmdiYSgwLDAsMCwwLjU0KScsXHJcbiAgJzMnOiAncmdiYSgwLDAsMCwwLjI2KScsXHJcbiAgJzQnOiAncmdiYSgwLDAsMCwwLjEyKSdcclxufTtcclxudmFyIExJR0hUX0ZPUkVHUk9VTkQgPSB7XHJcbiAgbmFtZTogJ2xpZ2h0JyxcclxuICAnMSc6ICdyZ2JhKDI1NSwyNTUsMjU1LDEuMCknLFxyXG4gICcyJzogJ3JnYmEoMjU1LDI1NSwyNTUsMC43KScsXHJcbiAgJzMnOiAncmdiYSgyNTUsMjU1LDI1NSwwLjMpJyxcclxuICAnNCc6ICdyZ2JhKDI1NSwyNTUsMjU1LDAuMTIpJ1xyXG59O1xyXG5cclxudmFyIERBUktfU0hBRE9XID0gJzFweCAxcHggMHB4IHJnYmEoMCwwLDAsMC40KSwgLTFweCAtMXB4IDBweCByZ2JhKDAsMCwwLDAuNCknO1xyXG52YXIgTElHSFRfU0hBRE9XID0gJyc7XHJcblxyXG52YXIgREFSS19DT05UUkFTVF9DT0xPUiA9IGNvbG9yVG9SZ2JhQXJyYXkoJ3JnYmEoMCwwLDAsMC44NyknKTtcclxudmFyIExJR0hUX0NPTlRSQVNUX0NPTE9SID0gY29sb3JUb1JnYmFBcnJheSgncmdiYSgyNTUsMjU1LDI1NSwwLjg3Jyk7XHJcbnZhciBTVFJPTkdfTElHSFRfQ09OVFJBU1RfQ09MT1IgPSBjb2xvclRvUmdiYUFycmF5KCdyZ2IoMjU1LDI1NSwyNTUpJyk7XHJcblxyXG52YXIgVEhFTUVfQ09MT1JfVFlQRVMgPSBbJ3ByaW1hcnknLCAnYWNjZW50JywgJ3dhcm4nLCAnYmFja2dyb3VuZCddO1xyXG52YXIgREVGQVVMVF9DT0xPUl9UWVBFID0gJ3ByaW1hcnknO1xyXG5cclxuLy8gQSBjb2xvciBpbiBhIHRoZW1lIHdpbGwgdXNlIHRoZXNlIGh1ZXMgYnkgZGVmYXVsdCwgaWYgbm90IHNwZWNpZmllZCBieSB1c2VyLlxyXG52YXIgTElHSFRfREVGQVVMVF9IVUVTID0ge1xyXG4gICdhY2NlbnQnOiB7XHJcbiAgICAnZGVmYXVsdCc6ICdBMjAwJyxcclxuICAgICdodWUtMSc6ICdBMTAwJyxcclxuICAgICdodWUtMic6ICdBNDAwJyxcclxuICAgICdodWUtMyc6ICdBNzAwJ1xyXG4gIH0sXHJcbiAgJ2JhY2tncm91bmQnOiB7XHJcbiAgICAnZGVmYXVsdCc6ICdBMTAwJyxcclxuICAgICdodWUtMSc6ICczMDAnLFxyXG4gICAgJ2h1ZS0yJzogJzgwMCcsXHJcbiAgICAnaHVlLTMnOiAnOTAwJ1xyXG4gIH1cclxufTtcclxuXHJcbnZhciBEQVJLX0RFRkFVTFRfSFVFUyA9IHtcclxuICAnYmFja2dyb3VuZCc6IHtcclxuICAgICdkZWZhdWx0JzogJzgwMCcsXHJcbiAgICAnaHVlLTEnOiAnMzAwJyxcclxuICAgICdodWUtMic6ICc2MDAnLFxyXG4gICAgJ2h1ZS0zJzogJzkwMCdcclxuICB9XHJcbn07XHJcblRIRU1FX0NPTE9SX1RZUEVTLmZvckVhY2goZnVuY3Rpb24oY29sb3JUeXBlKSB7XHJcbiAgLy8gQ29sb3IgdHlwZXMgd2l0aCB1bnNwZWNpZmllZCBkZWZhdWx0IGh1ZXMgd2lsbCB1c2UgdGhlc2UgZGVmYXVsdCBodWUgdmFsdWVzXHJcbiAgdmFyIGRlZmF1bHREZWZhdWx0SHVlcyA9IHtcclxuICAgICdkZWZhdWx0JzogJzUwMCcsXHJcbiAgICAnaHVlLTEnOiAnMzAwJyxcclxuICAgICdodWUtMic6ICc4MDAnLFxyXG4gICAgJ2h1ZS0zJzogJ0ExMDAnXHJcbiAgfTtcclxuICBpZiAoIUxJR0hUX0RFRkFVTFRfSFVFU1tjb2xvclR5cGVdKSBMSUdIVF9ERUZBVUxUX0hVRVNbY29sb3JUeXBlXSA9IGRlZmF1bHREZWZhdWx0SHVlcztcclxuICBpZiAoIURBUktfREVGQVVMVF9IVUVTW2NvbG9yVHlwZV0pIERBUktfREVGQVVMVF9IVUVTW2NvbG9yVHlwZV0gPSBkZWZhdWx0RGVmYXVsdEh1ZXM7XHJcbn0pO1xyXG5cclxudmFyIFZBTElEX0hVRV9WQUxVRVMgPSBbXHJcbiAgJzUwJywgJzEwMCcsICcyMDAnLCAnMzAwJywgJzQwMCcsICc1MDAnLCAnNjAwJyxcclxuICAnNzAwJywgJzgwMCcsICc5MDAnLCAnQTEwMCcsICdBMjAwJywgJ0E0MDAnLCAnQTcwMCdcclxuXTtcclxuXHJcbmZ1bmN0aW9uIFRoZW1pbmdQcm92aWRlcigkbWRDb2xvclBhbGV0dGUpIHtcclxuICBQQUxFVFRFUyA9IHsgfTtcclxuICBUSEVNRVMgPSB7IH07XHJcblxyXG4gIHZhciB0aGVtaW5nUHJvdmlkZXI7XHJcbiAgdmFyIGRlZmF1bHRUaGVtZSA9ICdkZWZhdWx0JztcclxuICB2YXIgYWx3YXlzV2F0Y2hUaGVtZSA9IGZhbHNlO1xyXG5cclxuICAvLyBMb2FkIEpTIERlZmluZWQgUGFsZXR0ZXNcclxuICBhbmd1bGFyLmV4dGVuZChQQUxFVFRFUywgJG1kQ29sb3JQYWxldHRlKTtcclxuXHJcbiAgLy8gRGVmYXVsdCB0aGVtZSBkZWZpbmVkIGluIGNvcmUuanNcclxuXHJcbiAgVGhlbWluZ1NlcnZpY2UuJGluamVjdCA9IFtcIiRyb290U2NvcGVcIiwgXCIkbG9nXCJdO1xyXG4gIHJldHVybiB0aGVtaW5nUHJvdmlkZXIgPSB7XHJcbiAgICBkZWZpbmVQYWxldHRlOiBkZWZpbmVQYWxldHRlLFxyXG4gICAgZXh0ZW5kUGFsZXR0ZTogZXh0ZW5kUGFsZXR0ZSxcclxuICAgIHRoZW1lOiByZWdpc3RlclRoZW1lLFxyXG5cclxuICAgIHNldERlZmF1bHRUaGVtZTogZnVuY3Rpb24odGhlbWUpIHtcclxuICAgICAgZGVmYXVsdFRoZW1lID0gdGhlbWU7XHJcbiAgICB9LFxyXG4gICAgYWx3YXlzV2F0Y2hUaGVtZTogZnVuY3Rpb24oYWx3YXlzV2F0Y2gpIHtcclxuICAgICAgYWx3YXlzV2F0Y2hUaGVtZSA9IGFsd2F5c1dhdGNoO1xyXG4gICAgfSxcclxuICAgICRnZXQ6IFRoZW1pbmdTZXJ2aWNlLFxyXG4gICAgX0xJR0hUX0RFRkFVTFRfSFVFUzogTElHSFRfREVGQVVMVF9IVUVTLFxyXG4gICAgX0RBUktfREVGQVVMVF9IVUVTOiBEQVJLX0RFRkFVTFRfSFVFUyxcclxuICAgIF9QQUxFVFRFUzogUEFMRVRURVMsXHJcbiAgICBfVEhFTUVTOiBUSEVNRVMsXHJcbiAgICBfcGFyc2VSdWxlczogcGFyc2VSdWxlcyxcclxuICAgIF9yZ2JhOiByZ2JhXHJcbiAgfTtcclxuXHJcbiAgLy8gRXhhbXBsZTogJG1kVGhlbWluZ1Byb3ZpZGVyLmRlZmluZVBhbGV0dGUoJ25lb25SZWQnLCB7IDUwOiAnI2Y1ZmFmYScsIC4uLiB9KTtcclxuICBmdW5jdGlvbiBkZWZpbmVQYWxldHRlKG5hbWUsIG1hcCkge1xyXG4gICAgbWFwID0gbWFwIHx8IHt9O1xyXG4gICAgUEFMRVRURVNbbmFtZV0gPSBjaGVja1BhbGV0dGVWYWxpZChuYW1lLCBtYXApO1xyXG4gICAgcmV0dXJuIHRoZW1pbmdQcm92aWRlcjtcclxuICB9XHJcblxyXG4gIC8vIFJldHVybnMgYW4gbmV3IG9iamVjdCB3aGljaCBpcyBhIGNvcHkgb2YgYSBnaXZlbiBwYWxldHRlIGBuYW1lYCB3aXRoIHZhcmlhYmxlcyBmcm9tXHJcbiAgLy8gYG1hcGAgb3ZlcndyaXR0ZW5cclxuICAvLyBFeGFtcGxlOiB2YXIgbmVvblJlZE1hcCA9ICRtZFRoZW1pbmdQcm92aWRlci5leHRlbmRQYWxldHRlKCdyZWQnLCB7IDUwOiAnI2Y1ZmFmYWZhJyB9KTtcclxuICBmdW5jdGlvbiBleHRlbmRQYWxldHRlKG5hbWUsIG1hcCkge1xyXG4gICAgcmV0dXJuIGNoZWNrUGFsZXR0ZVZhbGlkKG5hbWUsICBhbmd1bGFyLmV4dGVuZCh7fSwgUEFMRVRURVNbbmFtZV0gfHwge30sIG1hcCkgKTtcclxuICB9XHJcblxyXG4gIC8vIE1ha2Ugc3VyZSB0aGF0IHBhbGV0dGUgaGFzIGFsbCByZXF1aXJlZCBodWVzXHJcbiAgZnVuY3Rpb24gY2hlY2tQYWxldHRlVmFsaWQobmFtZSwgbWFwKSB7XHJcbiAgICB2YXIgbWlzc2luZ0NvbG9ycyA9IFZBTElEX0hVRV9WQUxVRVMuZmlsdGVyKGZ1bmN0aW9uKGZpZWxkKSB7XHJcbiAgICAgIHJldHVybiAhbWFwW2ZpZWxkXTtcclxuICAgIH0pO1xyXG4gICAgaWYgKG1pc3NpbmdDb2xvcnMubGVuZ3RoKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgY29sb3JzICUxIGluIHBhbGV0dGUgJTIhXCJcclxuICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMScsIG1pc3NpbmdDb2xvcnMuam9pbignLCAnKSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMicsIG5hbWUpKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbWFwO1xyXG4gIH1cclxuXHJcbiAgLy8gUmVnaXN0ZXIgYSB0aGVtZSAod2hpY2ggaXMgYSBjb2xsZWN0aW9uIG9mIGNvbG9yIHBhbGV0dGVzIHRvIHVzZSB3aXRoIHZhcmlvdXMgc3RhdGVzXHJcbiAgLy8gaWUuIHdhcm4sIGFjY2VudCwgcHJpbWFyeSApXHJcbiAgLy8gT3B0aW9uYWxseSBpbmhlcml0IGZyb20gYW4gZXhpc3RpbmcgdGhlbWVcclxuICAvLyAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2N1c3RvbS10aGVtZScpLnByaW1hcnlQYWxldHRlKCdyZWQnKTtcclxuICBmdW5jdGlvbiByZWdpc3RlclRoZW1lKG5hbWUsIGluaGVyaXRGcm9tKSB7XHJcbiAgICBpZiAoVEhFTUVTW25hbWVdKSByZXR1cm4gVEhFTUVTW25hbWVdO1xyXG5cclxuICAgIGluaGVyaXRGcm9tID0gaW5oZXJpdEZyb20gfHwgJ2RlZmF1bHQnO1xyXG5cclxuICAgIHZhciBwYXJlbnRUaGVtZSA9IHR5cGVvZiBpbmhlcml0RnJvbSA9PT0gJ3N0cmluZycgPyBUSEVNRVNbaW5oZXJpdEZyb21dIDogaW5oZXJpdEZyb207XHJcbiAgICB2YXIgdGhlbWUgPSBuZXcgVGhlbWUobmFtZSk7XHJcblxyXG4gICAgaWYgKHBhcmVudFRoZW1lKSB7XHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChwYXJlbnRUaGVtZS5jb2xvcnMsIGZ1bmN0aW9uKGNvbG9yLCBjb2xvclR5cGUpIHtcclxuICAgICAgICB0aGVtZS5jb2xvcnNbY29sb3JUeXBlXSA9IHtcclxuICAgICAgICAgIG5hbWU6IGNvbG9yLm5hbWUsXHJcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgYSBDT1BZIG9mIHRoZSBodWVzIGlzIGdpdmVuIHRvIHRoZSBjaGlsZCBjb2xvcixcclxuICAgICAgICAgIC8vIG5vdCB0aGUgc2FtZSByZWZlcmVuY2UuXHJcbiAgICAgICAgICBodWVzOiBhbmd1bGFyLmV4dGVuZCh7fSwgY29sb3IuaHVlcylcclxuICAgICAgICB9O1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFRIRU1FU1tuYW1lXSA9IHRoZW1lO1xyXG5cclxuICAgIHJldHVybiB0aGVtZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIFRoZW1lKG5hbWUpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubmFtZSA9IG5hbWU7XHJcbiAgICBzZWxmLmNvbG9ycyA9IHt9O1xyXG5cclxuICAgIHNlbGYuZGFyayA9IHNldERhcms7XHJcbiAgICBzZXREYXJrKGZhbHNlKTtcclxuXHJcbiAgICBmdW5jdGlvbiBzZXREYXJrKGlzRGFyaykge1xyXG4gICAgICBpc0RhcmsgPSBhcmd1bWVudHMubGVuZ3RoID09PSAwID8gdHJ1ZSA6ICEhaXNEYXJrO1xyXG5cclxuICAgICAgLy8gSWYgbm8gY2hhbmdlLCBhYm9ydFxyXG4gICAgICBpZiAoaXNEYXJrID09PSBzZWxmLmlzRGFyaykgcmV0dXJuO1xyXG5cclxuICAgICAgc2VsZi5pc0RhcmsgPSBpc0Rhcms7XHJcblxyXG4gICAgICBzZWxmLmZvcmVncm91bmRQYWxldHRlID0gc2VsZi5pc0RhcmsgPyBMSUdIVF9GT1JFR1JPVU5EIDogREFSS19GT1JFR1JPVU5EO1xyXG4gICAgICBzZWxmLmZvcmVncm91bmRTaGFkb3cgPSBzZWxmLmlzRGFyayA/IERBUktfU0hBRE9XIDogTElHSFRfU0hBRE9XO1xyXG5cclxuICAgICAgLy8gTGlnaHQgYW5kIGRhcmsgdGhlbWVzIGhhdmUgZGlmZmVyZW50IGRlZmF1bHQgaHVlcy5cclxuICAgICAgLy8gR28gdGhyb3VnaCBlYWNoIGV4aXN0aW5nIGNvbG9yIHR5cGUgZm9yIHRoaXMgdGhlbWUsIGFuZCBmb3IgZXZlcnlcclxuICAgICAgLy8gaHVlIHZhbHVlIHRoYXQgaXMgc3RpbGwgdGhlIGRlZmF1bHQgaHVlIHZhbHVlIGZyb20gdGhlIHByZXZpb3VzIGxpZ2h0L2Rhcmsgc2V0dGluZyxcclxuICAgICAgLy8gc2V0IGl0IHRvIHRoZSBkZWZhdWx0IGh1ZSB2YWx1ZSBmcm9tIHRoZSBuZXcgbGlnaHQvZGFyayBzZXR0aW5nLlxyXG4gICAgICB2YXIgbmV3RGVmYXVsdEh1ZXMgPSBzZWxmLmlzRGFyayA/IERBUktfREVGQVVMVF9IVUVTIDogTElHSFRfREVGQVVMVF9IVUVTO1xyXG4gICAgICB2YXIgb2xkRGVmYXVsdEh1ZXMgPSBzZWxmLmlzRGFyayA/IExJR0hUX0RFRkFVTFRfSFVFUyA6IERBUktfREVGQVVMVF9IVUVTO1xyXG4gICAgICBhbmd1bGFyLmZvckVhY2gobmV3RGVmYXVsdEh1ZXMsIGZ1bmN0aW9uKG5ld0RlZmF1bHRzLCBjb2xvclR5cGUpIHtcclxuICAgICAgICB2YXIgY29sb3IgPSBzZWxmLmNvbG9yc1tjb2xvclR5cGVdO1xyXG4gICAgICAgIHZhciBvbGREZWZhdWx0cyA9IG9sZERlZmF1bHRIdWVzW2NvbG9yVHlwZV07XHJcbiAgICAgICAgaWYgKGNvbG9yKSB7XHJcbiAgICAgICAgICBmb3IgKHZhciBodWVOYW1lIGluIGNvbG9yLmh1ZXMpIHtcclxuICAgICAgICAgICAgaWYgKGNvbG9yLmh1ZXNbaHVlTmFtZV0gPT09IG9sZERlZmF1bHRzW2h1ZU5hbWVdKSB7XHJcbiAgICAgICAgICAgICAgY29sb3IuaHVlc1todWVOYW1lXSA9IG5ld0RlZmF1bHRzW2h1ZU5hbWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgfVxyXG5cclxuICAgIFRIRU1FX0NPTE9SX1RZUEVTLmZvckVhY2goZnVuY3Rpb24oY29sb3JUeXBlKSB7XHJcbiAgICAgIHZhciBkZWZhdWx0SHVlcyA9IChzZWxmLmlzRGFyayA/IERBUktfREVGQVVMVF9IVUVTIDogTElHSFRfREVGQVVMVF9IVUVTKVtjb2xvclR5cGVdO1xyXG4gICAgICBzZWxmW2NvbG9yVHlwZSArICdQYWxldHRlJ10gPSBmdW5jdGlvbiBzZXRQYWxldHRlVHlwZShwYWxldHRlTmFtZSwgaHVlcykge1xyXG4gICAgICAgIHZhciBjb2xvciA9IHNlbGYuY29sb3JzW2NvbG9yVHlwZV0gPSB7XHJcbiAgICAgICAgICBuYW1lOiBwYWxldHRlTmFtZSxcclxuICAgICAgICAgIGh1ZXM6IGFuZ3VsYXIuZXh0ZW5kKHt9LCBkZWZhdWx0SHVlcywgaHVlcylcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBPYmplY3Qua2V5cyhjb2xvci5odWVzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgIGlmICghZGVmYXVsdEh1ZXNbbmFtZV0pIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBodWUgbmFtZSAnJTEnIGluIHRoZW1lICUyJ3MgJTMgY29sb3IgJTQuIEF2YWlsYWJsZSBodWUgbmFtZXM6ICU0XCJcclxuICAgICAgICAgICAgICAucmVwbGFjZSgnJTEnLCBuYW1lKVxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclMicsIHNlbGYubmFtZSlcclxuICAgICAgICAgICAgICAucmVwbGFjZSgnJTMnLCBwYWxldHRlTmFtZSlcclxuICAgICAgICAgICAgICAucmVwbGFjZSgnJTQnLCBPYmplY3Qua2V5cyhkZWZhdWx0SHVlcykuam9pbignLCAnKSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBPYmplY3Qua2V5cyhjb2xvci5odWVzKS5tYXAoZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICByZXR1cm4gY29sb3IuaHVlc1trZXldO1xyXG4gICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24oaHVlVmFsdWUpIHtcclxuICAgICAgICAgIGlmIChWQUxJRF9IVUVfVkFMVUVTLmluZGV4T2YoaHVlVmFsdWUpID09IC0xKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaHVlIHZhbHVlICclMScgaW4gdGhlbWUgJTIncyAlMyBjb2xvciAlNC4gQXZhaWxhYmxlIGh1ZSB2YWx1ZXM6ICU1XCJcclxuICAgICAgICAgICAgICAucmVwbGFjZSgnJTEnLCBodWVWYWx1ZSlcclxuICAgICAgICAgICAgICAucmVwbGFjZSgnJTInLCBzZWxmLm5hbWUpXHJcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyUzJywgY29sb3JUeXBlKVxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclNCcsIHBhbGV0dGVOYW1lKVxyXG4gICAgICAgICAgICAgIC5yZXBsYWNlKCclNScsIFZBTElEX0hVRV9WQUxVRVMuam9pbignLCAnKSlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHNlbGZbY29sb3JUeXBlICsgJ0NvbG9yJ10gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCckbWRUaGVtaW5nUHJvdmlkZXJUaGVtZS4nICsgY29sb3JUeXBlICsgJ0NvbG9yKCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICdVc2UgJG1kVGhlbWluZ1Byb3ZpZGVyVGhlbWUuJyArIGNvbG9yVHlwZSArICdQYWxldHRlKCkgaW5zdGVhZC4nKTtcclxuICAgICAgICByZXR1cm4gc2VsZltjb2xvclR5cGUgKyAnUGFsZXR0ZSddLmFwcGx5KHNlbGYsIGFyZ3MpO1xyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICAqIEBuYW1lICRtZFRoZW1pbmdcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqXHJcbiAgICogU2VydmljZSB0aGF0IG1ha2VzIGFuIGVsZW1lbnQgYXBwbHkgdGhlbWluZyByZWxhdGVkIGNsYXNzZXMgdG8gaXRzZWxmLlxyXG4gICAqXHJcbiAgICogYGBganNcclxuICAgKiBhcHAuZGlyZWN0aXZlKCdteUZhbmN5RGlyZWN0aXZlJywgZnVuY3Rpb24oJG1kVGhlbWluZykge1xyXG4gICAqICAgcmV0dXJuIHtcclxuICAgKiAgICAgcmVzdHJpY3Q6ICdlJyxcclxuICAgKiAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRycykge1xyXG4gICAqICAgICAgICRtZFRoZW1pbmcoZWwpO1xyXG4gICAqICAgICB9XHJcbiAgICogICB9O1xyXG4gICAqIH0pO1xyXG4gICAqIGBgYFxyXG4gICAqIEBwYXJhbSB7ZWw9fSBlbGVtZW50IHRvIGFwcGx5IHRoZW1pbmcgdG9cclxuICAgKi9cclxuICAvKiBAbmdJbmplY3QgKi9cclxuICBmdW5jdGlvbiBUaGVtaW5nU2VydmljZSgkcm9vdFNjb3BlLCAkbG9nKSB7XHJcblxyXG4gICAgYXBwbHlUaGVtZS5pbmhlcml0ID0gZnVuY3Rpb24oZWwsIHBhcmVudCkge1xyXG4gICAgICB2YXIgY3RybCA9IHBhcmVudC5jb250cm9sbGVyKCdtZFRoZW1lJyk7XHJcblxyXG4gICAgICB2YXIgYXR0clRoZW1lVmFsdWUgPSBlbC5hdHRyKCdtZC10aGVtZS13YXRjaCcpO1xyXG4gICAgICBpZiAoIChhbHdheXNXYXRjaFRoZW1lIHx8IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHJUaGVtZVZhbHVlKSkgJiYgYXR0clRoZW1lVmFsdWUgIT0gJ2ZhbHNlJykge1xyXG4gICAgICAgIHZhciBkZXJlZ2lzdGVyV2F0Y2ggPSAkcm9vdFNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHJldHVybiBjdHJsICYmIGN0cmwuJG1kVGhlbWUgfHwgZGVmYXVsdFRoZW1lO1xyXG4gICAgICAgIH0sIGNoYW5nZVRoZW1lKTtcclxuICAgICAgICBlbC5vbignJGRlc3Ryb3knLCBkZXJlZ2lzdGVyV2F0Y2gpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciB0aGVtZSA9IGN0cmwgJiYgY3RybC4kbWRUaGVtZSB8fCBkZWZhdWx0VGhlbWU7XHJcbiAgICAgICAgY2hhbmdlVGhlbWUodGhlbWUpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBjaGFuZ2VUaGVtZSh0aGVtZSkge1xyXG4gICAgICAgIGlmICghcmVnaXN0ZXJlZCh0aGVtZSkpIHtcclxuICAgICAgICAgICRsb2cud2FybignQXR0ZW1wdGVkIHRvIHVzZSB1bnJlZ2lzdGVyZWQgdGhlbWUgXFwnJyArIHRoZW1lICsgJ1xcJy4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJ1JlZ2lzdGVyIGl0IHdpdGggJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvbGRUaGVtZSA9IGVsLmRhdGEoJyRtZFRoZW1lTmFtZScpO1xyXG4gICAgICAgIGlmIChvbGRUaGVtZSkgZWwucmVtb3ZlQ2xhc3MoJ21kLScgKyBvbGRUaGVtZSArJy10aGVtZScpO1xyXG4gICAgICAgIGVsLmFkZENsYXNzKCdtZC0nICsgdGhlbWUgKyAnLXRoZW1lJyk7XHJcbiAgICAgICAgZWwuZGF0YSgnJG1kVGhlbWVOYW1lJywgdGhlbWUpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGFwcGx5VGhlbWUuVEhFTUVTID0gYW5ndWxhci5leHRlbmQoe30sIFRIRU1FUyk7XHJcbiAgICBhcHBseVRoZW1lLmRlZmF1bHRUaGVtZSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gZGVmYXVsdFRoZW1lOyB9O1xyXG4gICAgYXBwbHlUaGVtZS5yZWdpc3RlcmVkID0gcmVnaXN0ZXJlZDtcclxuXHJcbiAgICByZXR1cm4gYXBwbHlUaGVtZTtcclxuXHJcbiAgICBmdW5jdGlvbiByZWdpc3RlcmVkKHRoZW1lTmFtZSkge1xyXG4gICAgICBpZiAodGhlbWVOYW1lID09PSB1bmRlZmluZWQgfHwgdGhlbWVOYW1lID09PSAnJykgcmV0dXJuIHRydWU7XHJcbiAgICAgIHJldHVybiBhcHBseVRoZW1lLlRIRU1FU1t0aGVtZU5hbWVdICE9PSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYXBwbHlUaGVtZShzY29wZSwgZWwpIHtcclxuICAgICAgLy8gQWxsb3cgdXMgdG8gYmUgaW52b2tlZCB2aWEgYSBsaW5raW5nIGZ1bmN0aW9uIHNpZ25hdHVyZS5cclxuICAgICAgaWYgKGVsID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBlbCA9IHNjb3BlO1xyXG4gICAgICAgIHNjb3BlID0gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChzY29wZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgc2NvcGUgPSAkcm9vdFNjb3BlO1xyXG4gICAgICB9XHJcbiAgICAgIGFwcGx5VGhlbWUuaW5oZXJpdChlbCwgZWwpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5UaGVtaW5nUHJvdmlkZXIuJGluamVjdCA9IFtcIiRtZENvbG9yUGFsZXR0ZVwiXTtcclxuXHJcbmZ1bmN0aW9uIFRoZW1pbmdEaXJlY3RpdmUoJG1kVGhlbWluZywgJGludGVycG9sYXRlLCAkbG9nKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHByaW9yaXR5OiAxMDAsXHJcbiAgICBsaW5rOiB7XHJcbiAgICAgIHByZTogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRycykge1xyXG4gICAgICAgIHZhciBjdHJsID0ge1xyXG4gICAgICAgICAgJHNldFRoZW1lOiBmdW5jdGlvbih0aGVtZSkge1xyXG4gICAgICAgICAgICBpZiAoISRtZFRoZW1pbmcucmVnaXN0ZXJlZCh0aGVtZSkpIHtcclxuICAgICAgICAgICAgICAkbG9nLndhcm4oJ2F0dGVtcHRlZCB0byB1c2UgdW5yZWdpc3RlcmVkIHRoZW1lIFxcJycgKyB0aGVtZSArICdcXCcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjdHJsLiRtZFRoZW1lID0gdGhlbWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlbC5kYXRhKCckbWRUaGVtZUNvbnRyb2xsZXInLCBjdHJsKTtcclxuICAgICAgICBjdHJsLiRzZXRUaGVtZSgkaW50ZXJwb2xhdGUoYXR0cnMubWRUaGVtZSkoc2NvcGUpKTtcclxuICAgICAgICBhdHRycy4kb2JzZXJ2ZSgnbWRUaGVtZScsIGN0cmwuJHNldFRoZW1lKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuVGhlbWluZ0RpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiLCBcIiRpbnRlcnBvbGF0ZVwiLCBcIiRsb2dcIl07XHJcblxyXG5mdW5jdGlvbiBUaGVtYWJsZURpcmVjdGl2ZSgkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuICRtZFRoZW1pbmc7XHJcbn1cclxuVGhlbWFibGVEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIl07XHJcblxyXG5mdW5jdGlvbiBwYXJzZVJ1bGVzKHRoZW1lLCBjb2xvclR5cGUsIHJ1bGVzKSB7XHJcbiAgY2hlY2tWYWxpZFBhbGV0dGUodGhlbWUsIGNvbG9yVHlwZSk7XHJcblxyXG4gIHJ1bGVzID0gcnVsZXMucmVwbGFjZSgvVEhFTUVfTkFNRS9nLCB0aGVtZS5uYW1lKTtcclxuICB2YXIgZ2VuZXJhdGVkUnVsZXMgPSBbXTtcclxuICB2YXIgY29sb3IgPSB0aGVtZS5jb2xvcnNbY29sb3JUeXBlXTtcclxuXHJcbiAgdmFyIHRoZW1lTmFtZVJlZ2V4ID0gbmV3IFJlZ0V4cCgnLm1kLScgKyB0aGVtZS5uYW1lICsgJy10aGVtZScsICdnJyk7XHJcbiAgLy8gTWF0Y2hlcyAne3sgcHJpbWFyeS1jb2xvciB9fScsIGV0Y1xyXG4gIHZhciBodWVSZWdleCA9IG5ldyBSZWdFeHAoJyhcXCd8XCIpP3t7XFxcXHMqKCcgKyBjb2xvclR5cGUgKyAnKS0oY29sb3J8Y29udHJhc3QpLT8oXFxcXGRcXFxcLj9cXFxcZCopP1xcXFxzKn19KFxcXCJ8XFwnKT8nLCdnJyk7XHJcbiAgdmFyIHNpbXBsZVZhcmlhYmxlUmVnZXggPSAvJz9cIj9cXHtcXHtcXHMqKFthLXpBLVpdKyktKEE/XFxkK3xodWVcXC1bMC0zXXxzaGFkb3cpLT8oXFxkXFwuP1xcZCopP1xccypcXH1cXH0nP1wiPy9nO1xyXG4gIHZhciBwYWxldHRlID0gUEFMRVRURVNbY29sb3IubmFtZV07XHJcblxyXG4gIC8vIGZpbmQgYW5kIHJlcGxhY2Ugc2ltcGxlIHZhcmlhYmxlcyB3aGVyZSB3ZSB1c2UgYSBzcGVjaWZpYyBodWUsIG5vdCBhbiBlbnRpcmUgcGFsZXR0ZVxyXG4gIC8vIGVnLiBcInt7cHJpbWFyeS0xMDB9fVwiXHJcbiAgLy9cXCgnICsgVEhFTUVfQ09MT1JfVFlQRVMuam9pbignXFx8JykgKyAnXFwpJ1xyXG4gIHJ1bGVzID0gcnVsZXMucmVwbGFjZShzaW1wbGVWYXJpYWJsZVJlZ2V4LCBmdW5jdGlvbihtYXRjaCwgY29sb3JUeXBlLCBodWUsIG9wYWNpdHkpIHtcclxuICAgIGlmIChjb2xvclR5cGUgPT09ICdmb3JlZ3JvdW5kJykge1xyXG4gICAgICBpZiAoaHVlID09ICdzaGFkb3cnKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoZW1lLmZvcmVncm91bmRTaGFkb3c7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoZW1lLmZvcmVncm91bmRQYWxldHRlW2h1ZV0gfHwgdGhlbWUuZm9yZWdyb3VuZFBhbGV0dGVbJzEnXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKGh1ZS5pbmRleE9mKCdodWUnKSA9PT0gMCkge1xyXG4gICAgICBodWUgPSB0aGVtZS5jb2xvcnNbY29sb3JUeXBlXS5odWVzW2h1ZV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmdiYSggKFBBTEVUVEVTWyB0aGVtZS5jb2xvcnNbY29sb3JUeXBlXS5uYW1lIF1baHVlXSB8fCAnJykudmFsdWUsIG9wYWNpdHkgKTtcclxuICB9KTtcclxuXHJcbiAgLy8gRm9yIGVhY2ggdHlwZSwgZ2VuZXJhdGUgcnVsZXMgZm9yIGVhY2ggaHVlIChpZS4gZGVmYXVsdCwgbWQtaHVlLTEsIG1kLWh1ZS0yLCBtZC1odWUtMylcclxuICBhbmd1bGFyLmZvckVhY2goY29sb3IuaHVlcywgZnVuY3Rpb24oaHVlVmFsdWUsIGh1ZU5hbWUpIHtcclxuICAgIHZhciBuZXdSdWxlID0gcnVsZXNcclxuICAgICAgLnJlcGxhY2UoaHVlUmVnZXgsIGZ1bmN0aW9uKG1hdGNoLCBfLCBjb2xvclR5cGUsIGh1ZVR5cGUsIG9wYWNpdHkpIHtcclxuICAgICAgICByZXR1cm4gcmdiYShwYWxldHRlW2h1ZVZhbHVlXVtodWVUeXBlID09PSAnY29sb3InID8gJ3ZhbHVlJyA6ICdjb250cmFzdCddLCBvcGFjaXR5KTtcclxuICAgICAgfSk7XHJcbiAgICBpZiAoaHVlTmFtZSAhPT0gJ2RlZmF1bHQnKSB7XHJcbiAgICAgIG5ld1J1bGUgPSBuZXdSdWxlLnJlcGxhY2UodGhlbWVOYW1lUmVnZXgsICcubWQtJyArIHRoZW1lLm5hbWUgKyAnLXRoZW1lLm1kLScgKyBodWVOYW1lKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEb24ndCBhcHBseSBhIHNlbGVjdG9yIHJ1bGUgdG8gdGhlIGRlZmF1bHQgdGhlbWUsIG1ha2luZyBpdCBlYXNpZXIgdG8gb3ZlcnJpZGVcclxuICAgIC8vIHN0eWxlcyBvZiB0aGUgYmFzZS1jb21wb25lbnRcclxuICAgIGlmICh0aGVtZS5uYW1lID09ICdkZWZhdWx0Jykge1xyXG4gICAgICBuZXdSdWxlID0gbmV3UnVsZS5yZXBsYWNlKC9cXC5tZC1kZWZhdWx0LXRoZW1lL2csICcnKTtcclxuICAgIH1cclxuICAgIGdlbmVyYXRlZFJ1bGVzLnB1c2gobmV3UnVsZSk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBnZW5lcmF0ZWRSdWxlcztcclxufVxyXG5cclxuLy8gR2VuZXJhdGUgb3VyIHRoZW1lcyBhdCBydW4gdGltZSBnaXZlbiB0aGUgc3RhdGUgb2YgVEhFTUVTIGFuZCBQQUxFVFRFU1xyXG5mdW5jdGlvbiBnZW5lcmF0ZVRoZW1lcygkaW5qZWN0b3IpIHtcclxuXHJcbiAgdmFyIGhlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdO1xyXG4gIHZhciBmaXJzdENoaWxkID0gaGVhZCA/IGhlYWQuZmlyc3RFbGVtZW50Q2hpbGQgOiBudWxsO1xyXG4gIHZhciB0aGVtZUNzcyA9ICRpbmplY3Rvci5oYXMoJyRNRF9USEVNRV9DU1MnKSA/ICRpbmplY3Rvci5nZXQoJyRNRF9USEVNRV9DU1MnKSA6ICcnO1xyXG5cclxuICBpZiAoICFmaXJzdENoaWxkICkgcmV0dXJuO1xyXG4gIGlmICh0aGVtZUNzcy5sZW5ndGggPT09IDApIHJldHVybjsgLy8gbm8gcnVsZXMsIHNvIG5vIHBvaW50IGluIHJ1bm5pbmcgdGhpcyBleHBlbnNpdmUgdGFza1xyXG5cclxuICAvLyBFeHBvc2UgY29udHJhc3QgY29sb3JzIGZvciBwYWxldHRlcyB0byBlbnN1cmUgdGhhdCB0ZXh0IGlzIGFsd2F5cyByZWFkYWJsZVxyXG4gIGFuZ3VsYXIuZm9yRWFjaChQQUxFVFRFUywgc2FuaXRpemVQYWxldHRlKTtcclxuXHJcbiAgLy8gTURfVEhFTUVfQ1NTIGlzIGEgc3RyaW5nIGdlbmVyYXRlZCBieSB0aGUgYnVpbGQgcHJvY2VzcyB0aGF0IGluY2x1ZGVzIGFsbCB0aGUgdGhlbWFibGVcclxuICAvLyBjb21wb25lbnRzIGFzIHRlbXBsYXRlc1xyXG5cclxuICAvLyBCcmVhayB0aGUgQ1NTIGludG8gaW5kaXZpZHVhbCBydWxlc1xyXG4gIHZhciBydWxlc0J5VHlwZSA9IHt9O1xyXG4gIHZhciBydWxlcyA9IHRoZW1lQ3NzXHJcbiAgICAgICAgICAgICAgICAgIC5zcGxpdCgvXFx9KD8hKFxcfXwnfFwifDspKS8pXHJcbiAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24ocnVsZSkgeyByZXR1cm4gcnVsZSAmJiBydWxlLmxlbmd0aDsgfSlcclxuICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihydWxlKSB7IHJldHVybiBydWxlLnRyaW0oKSArICd9JzsgfSk7XHJcblxyXG5cclxuICB2YXIgcnVsZU1hdGNoUmVnZXggPSBuZXcgUmVnRXhwKCdtZC0oJyArIFRIRU1FX0NPTE9SX1RZUEVTLmpvaW4oJ3wnKSArICcpJywgJ2cnKTtcclxuXHJcbiAgVEhFTUVfQ09MT1JfVFlQRVMuZm9yRWFjaChmdW5jdGlvbih0eXBlKSB7XHJcbiAgICBydWxlc0J5VHlwZVt0eXBlXSA9ICcnO1xyXG4gIH0pO1xyXG5cclxuXHJcbiAgLy8gU29ydCB0aGUgcnVsZXMgYmFzZWQgb24gdHlwZSwgYWxsb3dpbmcgdXMgdG8gZG8gY29sb3Igc3Vic3RpdHV0aW9uIG9uIGEgcGVyLXR5cGUgYmFzaXNcclxuICBydWxlcy5mb3JFYWNoKGZ1bmN0aW9uKHJ1bGUpIHtcclxuICAgIHZhciBtYXRjaCA9IHJ1bGUubWF0Y2gocnVsZU1hdGNoUmVnZXgpO1xyXG4gICAgLy8gRmlyc3Q6IHRlc3QgdGhhdCBpZiB0aGUgcnVsZSBoYXMgJy5tZC1hY2NlbnQnLCBpdCBnb2VzIGludG8gdGhlIGFjY2VudCBzZXQgb2YgcnVsZXNcclxuICAgIGZvciAodmFyIGkgPSAwLCB0eXBlOyB0eXBlID0gVEhFTUVfQ09MT1JfVFlQRVNbaV07IGkrKykge1xyXG4gICAgICBpZiAocnVsZS5pbmRleE9mKCcubWQtJyArIHR5cGUpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4gcnVsZXNCeVR5cGVbdHlwZV0gKz0gcnVsZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIG5vIGVnICdtZC1hY2NlbnQnIGNsYXNzIGlzIGZvdW5kLCB0cnkgdG8ganVzdCBmaW5kICdhY2NlbnQnIGluIHRoZSBydWxlIGFuZCBndWVzcyBmcm9tXHJcbiAgICAvLyB0aGVyZVxyXG4gICAgZm9yIChpID0gMDsgdHlwZSA9IFRIRU1FX0NPTE9SX1RZUEVTW2ldOyBpKyspIHtcclxuICAgICAgaWYgKHJ1bGUuaW5kZXhPZih0eXBlKSA+IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIHJ1bGVzQnlUeXBlW3R5cGVdICs9IHJ1bGU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWZhdWx0IHRvIHRoZSBwcmltYXJ5IGFycmF5XHJcbiAgICByZXR1cm4gcnVsZXNCeVR5cGVbREVGQVVMVF9DT0xPUl9UWVBFXSArPSBydWxlO1xyXG4gIH0pO1xyXG5cclxuICAgIC8vIEZvciBlYWNoIHRoZW1lLCB1c2UgdGhlIGNvbG9yIHBhbGV0dGVzIHNwZWNpZmllZCBmb3JcclxuICAgIC8vIGBwcmltYXJ5YCwgYHdhcm5gIGFuZCBgYWNjZW50YCB0byBnZW5lcmF0ZSBDU1MgcnVsZXMuXHJcblxyXG4gICAgYW5ndWxhci5mb3JFYWNoKFRIRU1FUywgZnVuY3Rpb24odGhlbWUpIHtcclxuICAgICAgaWYgKCAhR0VORVJBVEVEW3RoZW1lLm5hbWVdICkge1xyXG5cclxuXHJcbiAgICAgICAgVEhFTUVfQ09MT1JfVFlQRVMuZm9yRWFjaChmdW5jdGlvbihjb2xvclR5cGUpIHtcclxuICAgICAgICAgIHZhciBzdHlsZVN0cmluZ3MgPSBwYXJzZVJ1bGVzKHRoZW1lLCBjb2xvclR5cGUsIHJ1bGVzQnlUeXBlW2NvbG9yVHlwZV0pO1xyXG4gICAgICAgICAgd2hpbGUgKHN0eWxlU3RyaW5ncy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcclxuICAgICAgICAgICAgICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0L2NzcycpO1xyXG4gICAgICAgICAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzdHlsZVN0cmluZ3Muc2hpZnQoKSkpO1xyXG4gICAgICAgICAgICBoZWFkLmluc2VydEJlZm9yZShzdHlsZSwgZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICBpZiAodGhlbWUuY29sb3JzLnByaW1hcnkubmFtZSA9PSB0aGVtZS5jb2xvcnMuYWNjZW50Lm5hbWUpIHtcclxuICAgICAgICAgIGNvbnNvbGUud2FybihcIiRtZFRoZW1pbmdQcm92aWRlcjogVXNpbmcgdGhlIHNhbWUgcGFsZXR0ZSBmb3IgcHJpbWFyeSBhbmRcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgXCIgYWNjZW50LiBUaGlzIHZpb2xhdGVzIHRoZSBtYXRlcmlhbCBkZXNpZ24gc3BlYy5cIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBHRU5FUkFURURbdGhlbWUubmFtZV0gPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcblxyXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAvLyBJbnRlcm5hbCBmdW5jdGlvbnNcclxuICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqXHJcblxyXG4gIC8vIFRoZSB1c2VyIHNwZWNpZmllcyBhICdkZWZhdWx0JyBjb250cmFzdCBjb2xvciBhcyBlaXRoZXIgbGlnaHQgb3IgZGFyayxcclxuICAvLyB0aGVuIGV4cGxpY2l0bHkgbGlzdHMgd2hpY2ggaHVlcyBhcmUgdGhlIG9wcG9zaXRlIGNvbnRyYXN0IChlZy4gQTEwMCBoYXMgZGFyaywgQTIwMCBoYXMgbGlnaHQpXHJcbiAgZnVuY3Rpb24gc2FuaXRpemVQYWxldHRlKHBhbGV0dGUpIHtcclxuICAgIHZhciBkZWZhdWx0Q29udHJhc3QgPSBwYWxldHRlLmNvbnRyYXN0RGVmYXVsdENvbG9yO1xyXG4gICAgdmFyIGxpZ2h0Q29sb3JzID0gcGFsZXR0ZS5jb250cmFzdExpZ2h0Q29sb3JzIHx8IFtdO1xyXG4gICAgdmFyIHN0cm9uZ0xpZ2h0Q29sb3JzID0gcGFsZXR0ZS5jb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzIHx8IFtdO1xyXG4gICAgdmFyIGRhcmtDb2xvcnMgPSBwYWxldHRlLmNvbnRyYXN0RGFya0NvbG9ycyB8fCBbXTtcclxuXHJcbiAgICAvLyBUaGVzZSBjb2xvcnMgYXJlIHByb3ZpZGVkIGFzIHNwYWNlLXNlcGFyYXRlZCBsaXN0c1xyXG4gICAgaWYgKHR5cGVvZiBsaWdodENvbG9ycyA9PT0gJ3N0cmluZycpIGxpZ2h0Q29sb3JzID0gbGlnaHRDb2xvcnMuc3BsaXQoJyAnKTtcclxuICAgIGlmICh0eXBlb2Ygc3Ryb25nTGlnaHRDb2xvcnMgPT09ICdzdHJpbmcnKSBzdHJvbmdMaWdodENvbG9ycyA9IHN0cm9uZ0xpZ2h0Q29sb3JzLnNwbGl0KCcgJyk7XHJcbiAgICBpZiAodHlwZW9mIGRhcmtDb2xvcnMgPT09ICdzdHJpbmcnKSBkYXJrQ29sb3JzID0gZGFya0NvbG9ycy5zcGxpdCgnICcpO1xyXG5cclxuICAgIC8vIENsZWFudXAgYWZ0ZXIgb3Vyc2VsdmVzXHJcbiAgICBkZWxldGUgcGFsZXR0ZS5jb250cmFzdERlZmF1bHRDb2xvcjtcclxuICAgIGRlbGV0ZSBwYWxldHRlLmNvbnRyYXN0TGlnaHRDb2xvcnM7XHJcbiAgICBkZWxldGUgcGFsZXR0ZS5jb250cmFzdFN0cm9uZ0xpZ2h0Q29sb3JzO1xyXG4gICAgZGVsZXRlIHBhbGV0dGUuY29udHJhc3REYXJrQ29sb3JzO1xyXG5cclxuICAgIC8vIENoYW5nZSB7ICdBMTAwJzogJyNmZmZlZWUnIH0gdG8geyAnQTEwMCc6IHsgdmFsdWU6ICcjZmZmZWVlJywgY29udHJhc3Q6REFSS19DT05UUkFTVF9DT0xPUiB9XHJcbiAgICBhbmd1bGFyLmZvckVhY2gocGFsZXR0ZSwgZnVuY3Rpb24oaHVlVmFsdWUsIGh1ZU5hbWUpIHtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QoaHVlVmFsdWUpKSByZXR1cm47IC8vIEFscmVhZHkgY29udmVydGVkXHJcbiAgICAgIC8vIE1hcCBldmVyeXRoaW5nIHRvIHJnYiBjb2xvcnNcclxuICAgICAgdmFyIHJnYlZhbHVlID0gY29sb3JUb1JnYmFBcnJheShodWVWYWx1ZSk7XHJcbiAgICAgIGlmICghcmdiVmFsdWUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2xvciAlMSwgaW4gcGFsZXR0ZSAlMidzIGh1ZSAlMywgaXMgaW52YWxpZC4gSGV4IG9yIHJnYihhKSBjb2xvciBleHBlY3RlZC5cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTEnLCBodWVWYWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoJyUyJywgcGFsZXR0ZS5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTMnLCBodWVOYW1lKSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHBhbGV0dGVbaHVlTmFtZV0gPSB7XHJcbiAgICAgICAgdmFsdWU6IHJnYlZhbHVlLFxyXG4gICAgICAgIGNvbnRyYXN0OiBnZXRDb250cmFzdENvbG9yKClcclxuICAgICAgfTtcclxuICAgICAgZnVuY3Rpb24gZ2V0Q29udHJhc3RDb2xvcigpIHtcclxuICAgICAgICBpZiAoZGVmYXVsdENvbnRyYXN0ID09PSAnbGlnaHQnKSB7XHJcbiAgICAgICAgICBpZiAoZGFya0NvbG9ycy5pbmRleE9mKGh1ZU5hbWUpID4gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIERBUktfQ09OVFJBU1RfQ09MT1I7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3Ryb25nTGlnaHRDb2xvcnMuaW5kZXhPZihodWVOYW1lKSA+IC0xID8gU1RST05HX0xJR0hUX0NPTlRSQVNUX0NPTE9SXHJcbiAgICAgICAgICAgICAgOiBMSUdIVF9DT05UUkFTVF9DT0xPUjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGxpZ2h0Q29sb3JzLmluZGV4T2YoaHVlTmFtZSkgPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3Ryb25nTGlnaHRDb2xvcnMuaW5kZXhPZihodWVOYW1lKSA+IC0xID8gU1RST05HX0xJR0hUX0NPTlRSQVNUX0NPTE9SXHJcbiAgICAgICAgICAgICAgOiBMSUdIVF9DT05UUkFTVF9DT0xPUjtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBEQVJLX0NPTlRSQVNUX0NPTE9SO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbn1cclxuZ2VuZXJhdGVUaGVtZXMuJGluamVjdCA9IFtcIiRpbmplY3RvclwiXTtcclxuXHJcbmZ1bmN0aW9uIGNoZWNrVmFsaWRQYWxldHRlKHRoZW1lLCBjb2xvclR5cGUpIHtcclxuICAvLyBJZiB0aGVtZSBhdHRlbXB0cyB0byB1c2UgYSBwYWxldHRlIHRoYXQgZG9lc250IGV4aXN0LCB0aHJvdyBlcnJvclxyXG4gIGlmICghUEFMRVRURVNbICh0aGVtZS5jb2xvcnNbY29sb3JUeXBlXSB8fCB7fSkubmFtZSBdKSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgIFwiWW91IHN1cHBsaWVkIGFuIGludmFsaWQgY29sb3IgcGFsZXR0ZSBmb3IgdGhlbWUgJTEncyAlMiBwYWxldHRlLiBBdmFpbGFibGUgcGFsZXR0ZXM6ICUzXCJcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTEnLCB0aGVtZS5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCclMicsIGNvbG9yVHlwZSlcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgnJTMnLCBPYmplY3Qua2V5cyhQQUxFVFRFUykuam9pbignLCAnKSlcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjb2xvclRvUmdiYUFycmF5KGNscikge1xyXG4gIGlmIChhbmd1bGFyLmlzQXJyYXkoY2xyKSAmJiBjbHIubGVuZ3RoID09IDMpIHJldHVybiBjbHI7XHJcbiAgaWYgKC9ecmdiLy50ZXN0KGNscikpIHtcclxuICAgIHJldHVybiBjbHIucmVwbGFjZSgvKF5cXHMqcmdiYT9cXCh8XFwpXFxzKiQpL2csICcnKS5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbih2YWx1ZSwgaSkge1xyXG4gICAgICByZXR1cm4gaSA9PSAzID8gcGFyc2VGbG9hdCh2YWx1ZSwgMTApIDogcGFyc2VJbnQodmFsdWUsIDEwKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBpZiAoY2xyLmNoYXJBdCgwKSA9PSAnIycpIGNsciA9IGNsci5zdWJzdHJpbmcoMSk7XHJcbiAgaWYgKCEvXihbYS1mQS1GMC05XXszfSl7MSwyfSQvZy50ZXN0KGNscikpIHJldHVybjtcclxuXHJcbiAgdmFyIGRpZyA9IGNsci5sZW5ndGggLyAzO1xyXG4gIHZhciByZWQgPSBjbHIuc3Vic3RyKDAsIGRpZyk7XHJcbiAgdmFyIGdybiA9IGNsci5zdWJzdHIoZGlnLCBkaWcpO1xyXG4gIHZhciBibHUgPSBjbHIuc3Vic3RyKGRpZyAqIDIpO1xyXG4gIGlmIChkaWcgPT09IDEpIHtcclxuICAgIHJlZCArPSByZWQ7XHJcbiAgICBncm4gKz0gZ3JuO1xyXG4gICAgYmx1ICs9IGJsdTtcclxuICB9XHJcbiAgcmV0dXJuIFtwYXJzZUludChyZWQsIDE2KSwgcGFyc2VJbnQoZ3JuLCAxNiksIHBhcnNlSW50KGJsdSwgMTYpXTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmdiYShyZ2JBcnJheSwgb3BhY2l0eSkge1xyXG4gIGlmICggIXJnYkFycmF5ICkgcmV0dXJuIFwicmdiKCcwLDAsMCcpXCI7XHJcblxyXG4gIGlmIChyZ2JBcnJheS5sZW5ndGggPT0gNCkge1xyXG4gICAgcmdiQXJyYXkgPSBhbmd1bGFyLmNvcHkocmdiQXJyYXkpO1xyXG4gICAgb3BhY2l0eSA/IHJnYkFycmF5LnBvcCgpIDogb3BhY2l0eSA9IHJnYkFycmF5LnBvcCgpO1xyXG4gIH1cclxuICByZXR1cm4gb3BhY2l0eSAmJiAodHlwZW9mIG9wYWNpdHkgPT0gJ251bWJlcicgfHwgKHR5cGVvZiBvcGFjaXR5ID09ICdzdHJpbmcnICYmIG9wYWNpdHkubGVuZ3RoKSkgP1xyXG4gICAgJ3JnYmEoJyArIHJnYkFycmF5LmpvaW4oJywnKSArICcsJyArIG9wYWNpdHkgKyAnKScgOlxyXG4gICAgJ3JnYignICsgcmdiQXJyYXkuam9pbignLCcpICsgJyknO1xyXG59XHJcblxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGVcclxuICovXHJcbi8qXHJcbiAqIEBzZWUganMgZm9sZGVyIGZvciBhdXRvY29tcGxldGUgaW1wbGVtZW50YXRpb25cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuaWNvbidcclxuXSk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3BcclxuICogQGRlc2NyaXB0aW9uIEJhY2tkcm9wXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRCYWNrZHJvcFxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3BcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGA8bWQtYmFja2Ryb3A+YCBpcyBhIGJhY2tkcm9wIGVsZW1lbnQgdXNlZCBieSBvdGhlciBjb21wb25lbnRzLCBzdWNoIGFzIGRpYWxvZyBhbmQgYm90dG9tIHNoZWV0LlxyXG4gKiBBcHBseSBjbGFzcyBgb3BhcXVlYCB0byBtYWtlIHRoZSBiYWNrZHJvcCB1c2UgdGhlIHRoZW1lIGJhY2tkcm9wIGNvbG9yLlxyXG4gKlxyXG4gKi9cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmJhY2tkcm9wJywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJ1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kQmFja2Ryb3AnLCBCYWNrZHJvcERpcmVjdGl2ZSk7XHJcblxyXG5mdW5jdGlvbiBCYWNrZHJvcERpcmVjdGl2ZSgkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuICRtZFRoZW1pbmc7XHJcbn1cclxuQmFja2Ryb3BEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmJvdHRvbVNoZWV0XHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBCb3R0b21TaGVldFxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYm90dG9tU2hlZXQnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmJhY2tkcm9wJ1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kQm90dG9tU2hlZXQnLCBNZEJvdHRvbVNoZWV0RGlyZWN0aXZlKVxyXG4gIC5wcm92aWRlcignJG1kQm90dG9tU2hlZXQnLCBNZEJvdHRvbVNoZWV0UHJvdmlkZXIpO1xyXG5cclxuZnVuY3Rpb24gTWRCb3R0b21TaGVldERpcmVjdGl2ZSgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJ1xyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2Mgc2VydmljZVxyXG4gKiBAbmFtZSAkbWRCb3R0b21TaGVldFxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuYm90dG9tU2hlZXRcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGAkbWRCb3R0b21TaGVldGAgb3BlbnMgYSBib3R0b20gc2hlZXQgb3ZlciB0aGUgYXBwIGFuZCBwcm92aWRlcyBhIHNpbXBsZSBwcm9taXNlIEFQSS5cclxuICpcclxuICogIyMgUmVzdHJpY3Rpb25zXHJcbiAqXHJcbiAqIC0gVGhlIGJvdHRvbSBzaGVldCdzIHRlbXBsYXRlIG11c3QgaGF2ZSBhbiBvdXRlciBgPG1kLWJvdHRvbS1zaGVldD5gIGVsZW1lbnQuXHJcbiAqIC0gQWRkIHRoZSBgbWQtZ3JpZGAgY2xhc3MgdG8gdGhlIGJvdHRvbSBzaGVldCBmb3IgYSBncmlkIGxheW91dC5cclxuICogLSBBZGQgdGhlIGBtZC1saXN0YCBjbGFzcyB0byB0aGUgYm90dG9tIHNoZWV0IGZvciBhIGxpc3QgbGF5b3V0LlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPGRpdiBuZy1jb250cm9sbGVyPVwiTXlDb250cm9sbGVyXCI+XHJcbiAqICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cIm9wZW5Cb3R0b21TaGVldCgpXCI+XHJcbiAqICAgICBPcGVuIGEgQm90dG9tIFNoZWV0IVxyXG4gKiAgIDwvbWQtYnV0dG9uPlxyXG4gKiA8L2Rpdj5cclxuICogPC9obGpzPlxyXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICogdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nTWF0ZXJpYWwnXSk7XHJcbiAqIGFwcC5jb250cm9sbGVyKCdNeUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRtZEJvdHRvbVNoZWV0KSB7XHJcbiAqICAgJHNjb3BlLm9wZW5Cb3R0b21TaGVldCA9IGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgJG1kQm90dG9tU2hlZXQuc2hvdyh7XHJcbiAqICAgICAgIHRlbXBsYXRlOiAnPG1kLWJvdHRvbS1zaGVldD5IZWxsbyE8L21kLWJvdHRvbS1zaGVldD4nXHJcbiAqICAgICB9KTtcclxuICogICB9O1xyXG4gKiB9KTtcclxuICogPC9obGpzPlxyXG4gKi9cclxuXHJcbiAvKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRCb3R0b21TaGVldCNzaG93XHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBTaG93IGEgYm90dG9tIHNoZWV0IHdpdGggdGhlIHNwZWNpZmllZCBvcHRpb25zLlxyXG4gKlxyXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyBBbiBvcHRpb25zIG9iamVjdCwgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6XHJcbiAqXHJcbiAqICAgLSBgdGVtcGxhdGVVcmxgIC0gYHtzdHJpbmc9fWA6IFRoZSB1cmwgb2YgYW4gaHRtbCB0ZW1wbGF0ZSBmaWxlIHRoYXQgd2lsbFxyXG4gKiAgIGJlIHVzZWQgYXMgdGhlIGNvbnRlbnQgb2YgdGhlIGJvdHRvbSBzaGVldC4gUmVzdHJpY3Rpb25zOiB0aGUgdGVtcGxhdGUgbXVzdFxyXG4gKiAgIGhhdmUgYW4gb3V0ZXIgYG1kLWJvdHRvbS1zaGVldGAgZWxlbWVudC5cclxuICogICAtIGB0ZW1wbGF0ZWAgLSBge3N0cmluZz19YDogU2FtZSBhcyB0ZW1wbGF0ZVVybCwgZXhjZXB0IHRoaXMgaXMgYW4gYWN0dWFsXHJcbiAqICAgdGVtcGxhdGUgc3RyaW5nLlxyXG4gKiAgIC0gYHNjb3BlYCAtIGB7b2JqZWN0PX1gOiB0aGUgc2NvcGUgdG8gbGluayB0aGUgdGVtcGxhdGUgLyBjb250cm9sbGVyIHRvLiBJZiBub25lIGlzIHNwZWNpZmllZCwgaXQgd2lsbCBjcmVhdGUgYSBuZXcgY2hpbGQgc2NvcGUuXHJcbiAqICAgICBUaGlzIHNjb3BlIHdpbGwgYmUgZGVzdHJveWVkIHdoZW4gdGhlIGJvdHRvbSBzaGVldCBpcyByZW1vdmVkIHVubGVzcyBgcHJlc2VydmVTY29wZWAgaXMgc2V0IHRvIHRydWUuXHJcbiAqICAgLSBgcHJlc2VydmVTY29wZWAgLSBge2Jvb2xlYW49fWA6IHdoZXRoZXIgdG8gcHJlc2VydmUgdGhlIHNjb3BlIHdoZW4gdGhlIGVsZW1lbnQgaXMgcmVtb3ZlZC4gRGVmYXVsdCBpcyBmYWxzZVxyXG4gKiAgIC0gYGNvbnRyb2xsZXJgIC0gYHtzdHJpbmc9fWA6IFRoZSBjb250cm9sbGVyIHRvIGFzc29jaWF0ZSB3aXRoIHRoaXMgYm90dG9tIHNoZWV0LlxyXG4gKiAgIC0gYGxvY2Fsc2AgLSBge3N0cmluZz19YDogQW4gb2JqZWN0IGNvbnRhaW5pbmcga2V5L3ZhbHVlIHBhaXJzLiBUaGUga2V5cyB3aWxsXHJcbiAqICAgYmUgdXNlZCBhcyBuYW1lcyBvZiB2YWx1ZXMgdG8gaW5qZWN0IGludG8gdGhlIGNvbnRyb2xsZXIuIEZvciBleGFtcGxlLFxyXG4gKiAgIGBsb2NhbHM6IHt0aHJlZTogM31gIHdvdWxkIGluamVjdCBgdGhyZWVgIGludG8gdGhlIGNvbnRyb2xsZXIgd2l0aCB0aGUgdmFsdWVcclxuICogICBvZiAzLlxyXG4gKiAgIC0gYHRhcmdldEV2ZW50YCAtIGB7RE9NQ2xpY2tFdmVudD19YDogQSBjbGljaydzIGV2ZW50IG9iamVjdC4gV2hlbiBwYXNzZWQgaW4gYXMgYW4gb3B0aW9uLFxyXG4gKiAgIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2xpY2sgd2lsbCBiZSB1c2VkIGFzIHRoZSBzdGFydGluZyBwb2ludCBmb3IgdGhlIG9wZW5pbmcgYW5pbWF0aW9uXHJcbiAqICAgb2YgdGhlIHRoZSBkaWFsb2cuXHJcbiAqICAgLSBgcmVzb2x2ZWAgLSBge29iamVjdD19YDogU2ltaWxhciB0byBsb2NhbHMsIGV4Y2VwdCBpdCB0YWtlcyBwcm9taXNlcyBhcyB2YWx1ZXNcclxuICogICBhbmQgdGhlIGJvdHRvbSBzaGVldCB3aWxsIG5vdCBvcGVuIHVudGlsIHRoZSBwcm9taXNlcyByZXNvbHZlLlxyXG4gKiAgIC0gYGNvbnRyb2xsZXJBc2AgLSBge3N0cmluZz19YDogQW4gYWxpYXMgdG8gYXNzaWduIHRoZSBjb250cm9sbGVyIHRvIG9uIHRoZSBzY29wZS5cclxuICogICAtIGBwYXJlbnRgIC0gYHtlbGVtZW50PX1gOiBUaGUgZWxlbWVudCB0byBhcHBlbmQgdGhlIGJvdHRvbSBzaGVldCB0by4gVGhlIGBwYXJlbnRgIG1heSBiZSBhIGBmdW5jdGlvbmAsIGBzdHJpbmdgLFxyXG4gKiAgIGBvYmplY3RgLCBvciBudWxsLiBEZWZhdWx0cyB0byBhcHBlbmRpbmcgdG8gdGhlIGJvZHkgb2YgdGhlIHJvb3QgZWxlbWVudCAob3IgdGhlIHJvb3QgZWxlbWVudCkgb2YgdGhlIGFwcGxpY2F0aW9uLlxyXG4gKiAgIGUuZy4gYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250ZW50JykpIG9yIFwiI2NvbnRlbnRcIlxyXG4gKiAgIC0gYGRpc2FibGVQYXJlbnRTY3JvbGxgIC0gYHtib29sZWFuPX1gOiBXaGV0aGVyIHRvIGRpc2FibGUgc2Nyb2xsaW5nIHdoaWxlIHRoZSBib3R0b20gc2hlZXQgaXMgb3Blbi5cclxuICogICAgIERlZmF1bHQgdHJ1ZS5cclxuICpcclxuICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IGNhbiBiZSByZXNvbHZlZCB3aXRoIGAkbWRCb3R0b21TaGVldC5oaWRlKClgIG9yXHJcbiAqIHJlamVjdGVkIHdpdGggYCRtZEJvdHRvbVNoZWV0LmNhbmNlbCgpYC5cclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRCb3R0b21TaGVldCNoaWRlXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBIaWRlIHRoZSBleGlzdGluZyBib3R0b20gc2hlZXQgYW5kIHJlc29sdmUgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbVxyXG4gKiBgJG1kQm90dG9tU2hlZXQuc2hvdygpYC4gVGhpcyBjYWxsIHdpbGwgY2xvc2UgdGhlIG1vc3QgcmVjZW50bHkgb3BlbmVkL2N1cnJlbnQgYm90dG9tc2hlZXQgKGlmIGFueSkuXHJcbiAqXHJcbiAqIEBwYXJhbSB7Kj19IHJlc3BvbnNlIEFuIGFyZ3VtZW50IGZvciB0aGUgcmVzb2x2ZWQgcHJvbWlzZS5cclxuICpcclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRCb3R0b21TaGVldCNjYW5jZWxcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEhpZGUgdGhlIGV4aXN0aW5nIGJvdHRvbSBzaGVldCBhbmQgcmVqZWN0IHRoZSBwcm9taXNlIHJldHVybmVkIGZyb21cclxuICogYCRtZEJvdHRvbVNoZWV0LnNob3coKWAuXHJcbiAqXHJcbiAqIEBwYXJhbSB7Kj19IHJlc3BvbnNlIEFuIGFyZ3VtZW50IGZvciB0aGUgcmVqZWN0ZWQgcHJvbWlzZS5cclxuICpcclxuICovXHJcblxyXG5mdW5jdGlvbiBNZEJvdHRvbVNoZWV0UHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XHJcbiAgLy8gaG93IGZhc3Qgd2UgbmVlZCB0byBmbGljayBkb3duIHRvIGNsb3NlIHRoZSBzaGVldCwgcGl4ZWxzL21zXHJcbiAgdmFyIENMT1NJTkdfVkVMT0NJVFkgPSAwLjU7XHJcbiAgdmFyIFBBRERJTkcgPSA4MDsgLy8gc2FtZSBhcyBjc3NcclxuXHJcbiAgYm90dG9tU2hlZXREZWZhdWx0cy4kaW5qZWN0ID0gW1wiJGFuaW1hdGVcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRtZFV0aWxcIiwgXCIkdGltZW91dFwiLCBcIiRjb21waWxlXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZEJvdHRvbVNoZWV0XCIsIFwiJHJvb3RFbGVtZW50XCIsIFwiJG1kR2VzdHVyZVwiXTtcclxuICByZXR1cm4gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWRCb3R0b21TaGVldCcpXHJcbiAgICAuc2V0RGVmYXVsdHMoe1xyXG4gICAgICBtZXRob2RzOiBbJ2Rpc2FibGVQYXJlbnRTY3JvbGwnLCAnZXNjYXBlVG9DbG9zZScsICd0YXJnZXRFdmVudCddLFxyXG4gICAgICBvcHRpb25zOiBib3R0b21TaGVldERlZmF1bHRzXHJcbiAgICB9KTtcclxuXHJcbiAgLyogQG5nSW5qZWN0ICovXHJcbiAgZnVuY3Rpb24gYm90dG9tU2hlZXREZWZhdWx0cygkYW5pbWF0ZSwgJG1kQ29uc3RhbnQsICRtZFV0aWwsICR0aW1lb3V0LCAkY29tcGlsZSwgJG1kVGhlbWluZywgJG1kQm90dG9tU2hlZXQsICRyb290RWxlbWVudCwgJG1kR2VzdHVyZSkge1xyXG4gICAgdmFyIGJhY2tkcm9wO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRoZW1hYmxlOiB0cnVlLFxyXG4gICAgICB0YXJnZXRFdmVudDogbnVsbCxcclxuICAgICAgb25TaG93OiBvblNob3csXHJcbiAgICAgIG9uUmVtb3ZlOiBvblJlbW92ZSxcclxuICAgICAgZXNjYXBlVG9DbG9zZTogdHJ1ZSxcclxuICAgICAgZGlzYWJsZVBhcmVudFNjcm9sbDogdHJ1ZVxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gb25TaG93KHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcblxyXG4gICAgICBlbGVtZW50ID0gJG1kVXRpbC5leHRyYWN0RWxlbWVudEJ5TmFtZShlbGVtZW50LCAnbWQtYm90dG9tLXNoZWV0Jyk7XHJcblxyXG4gICAgICAvLyBBZGQgYSBiYWNrZHJvcCB0aGF0IHdpbGwgY2xvc2Ugb24gY2xpY2tcclxuICAgICAgYmFja2Ryb3AgPSAkY29tcGlsZSgnPG1kLWJhY2tkcm9wIGNsYXNzPVwibWQtb3BhcXVlIG1kLWJvdHRvbS1zaGVldC1iYWNrZHJvcFwiPicpKHNjb3BlKTtcclxuICAgICAgYmFja2Ryb3Aub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHRpbWVvdXQoJG1kQm90dG9tU2hlZXQuY2FuY2VsKTtcclxuICAgICAgfSk7XHJcbiAgICAgICRtZFRoZW1pbmcuaW5oZXJpdChiYWNrZHJvcCwgb3B0aW9ucy5wYXJlbnQpO1xyXG5cclxuICAgICAgJGFuaW1hdGUuZW50ZXIoYmFja2Ryb3AsIG9wdGlvbnMucGFyZW50LCBudWxsKTtcclxuXHJcbiAgICAgIHZhciBib3R0b21TaGVldCA9IG5ldyBCb3R0b21TaGVldChlbGVtZW50LCBvcHRpb25zLnBhcmVudCk7XHJcbiAgICAgIG9wdGlvbnMuYm90dG9tU2hlZXQgPSBib3R0b21TaGVldDtcclxuXHJcbiAgICAgIC8vIEdpdmUgdXAgZm9jdXMgb24gY2FsbGluZyBpdGVtXHJcbiAgICAgIG9wdGlvbnMudGFyZ2V0RXZlbnQgJiYgYW5ndWxhci5lbGVtZW50KG9wdGlvbnMudGFyZ2V0RXZlbnQudGFyZ2V0KS5ibHVyKCk7XHJcbiAgICAgICRtZFRoZW1pbmcuaW5oZXJpdChib3R0b21TaGVldC5lbGVtZW50LCBvcHRpb25zLnBhcmVudCk7XHJcblxyXG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlUGFyZW50U2Nyb2xsKSB7XHJcbiAgICAgICAgb3B0aW9ucy5sYXN0T3ZlcmZsb3cgPSBvcHRpb25zLnBhcmVudC5jc3MoJ292ZXJmbG93Jyk7XHJcbiAgICAgICAgb3B0aW9ucy5wYXJlbnQuY3NzKCdvdmVyZmxvdycsICdoaWRkZW4nKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuICRhbmltYXRlLmVudGVyKGJvdHRvbVNoZWV0LmVsZW1lbnQsIG9wdGlvbnMucGFyZW50KVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgdmFyIGZvY3VzYWJsZSA9IGFuZ3VsYXIuZWxlbWVudChcclxuICAgICAgICAgICAgZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCdidXR0b24nKSB8fFxyXG4gICAgICAgICAgICBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ2EnKSB8fFxyXG4gICAgICAgICAgICBlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ1tuZy1jbGlja10nKVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIGZvY3VzYWJsZS5mb2N1cygpO1xyXG5cclxuICAgICAgICAgIGlmIChvcHRpb25zLmVzY2FwZVRvQ2xvc2UpIHtcclxuICAgICAgICAgICAgb3B0aW9ucy5yb290RWxlbWVudEtleXVwQ2FsbGJhY2sgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFKSB7XHJcbiAgICAgICAgICAgICAgICAkdGltZW91dCgkbWRCb3R0b21TaGVldC5jYW5jZWwpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJHJvb3RFbGVtZW50Lm9uKCdrZXl1cCcsIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gb25SZW1vdmUoc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHJcbiAgICAgIHZhciBib3R0b21TaGVldCA9IG9wdGlvbnMuYm90dG9tU2hlZXQ7XHJcblxyXG4gICAgICAkYW5pbWF0ZS5sZWF2ZShiYWNrZHJvcCk7XHJcbiAgICAgIHJldHVybiAkYW5pbWF0ZS5sZWF2ZShib3R0b21TaGVldC5lbGVtZW50KS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcclxuICAgICAgICAgIG9wdGlvbnMucGFyZW50LmNzcygnb3ZlcmZsb3cnLCBvcHRpb25zLmxhc3RPdmVyZmxvdyk7XHJcbiAgICAgICAgICBkZWxldGUgb3B0aW9ucy5sYXN0T3ZlcmZsb3c7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBib3R0b21TaGVldC5jbGVhbnVwKCk7XHJcblxyXG4gICAgICAgIC8vIFJlc3RvcmUgZm9jdXNcclxuICAgICAgICBvcHRpb25zLnRhcmdldEV2ZW50ICYmIGFuZ3VsYXIuZWxlbWVudChvcHRpb25zLnRhcmdldEV2ZW50LnRhcmdldCkuZm9jdXMoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCb3R0b21TaGVldCBjbGFzcyB0byBhcHBseSBib3R0b20tc2hlZXQgYmVoYXZpb3IgdG8gYW4gZWxlbWVudFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBCb3R0b21TaGVldChlbGVtZW50LCBwYXJlbnQpIHtcclxuICAgICAgdmFyIGRlcmVnaXN0ZXIgPSAkbWRHZXN0dXJlLnJlZ2lzdGVyKHBhcmVudCwgJ2RyYWcnLCB7IGhvcml6b250YWw6IGZhbHNlIH0pO1xyXG4gICAgICBwYXJlbnQub24oJyRtZC5kcmFnc3RhcnQnLCBvbkRyYWdTdGFydClcclxuICAgICAgICAub24oJyRtZC5kcmFnJywgb25EcmFnKVxyXG4gICAgICAgIC5vbignJG1kLmRyYWdlbmQnLCBvbkRyYWdFbmQpO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxyXG4gICAgICAgIGNsZWFudXA6IGZ1bmN0aW9uIGNsZWFudXAoKSB7XHJcbiAgICAgICAgICBkZXJlZ2lzdGVyKCk7XHJcbiAgICAgICAgICBwYXJlbnQub2ZmKCckbWQuZHJhZ3N0YXJ0Jywgb25EcmFnU3RhcnQpXHJcbiAgICAgICAgICAgIC5vZmYoJyRtZC5kcmFnJywgb25EcmFnKVxyXG4gICAgICAgICAgICAub2ZmKCckbWQuZHJhZ2VuZCcsIG9uRHJhZ0VuZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgZnVuY3Rpb24gb25EcmFnU3RhcnQoZXYpIHtcclxuICAgICAgICAvLyBEaXNhYmxlIHRyYW5zaXRpb25zIG9uIHRyYW5zZm9ybSBzbyB0aGF0IGl0IGZlZWxzIGZhc3RcclxuICAgICAgICBlbGVtZW50LmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTl9EVVJBVElPTiwgJzBtcycpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBvbkRyYWcoZXYpIHtcclxuICAgICAgICB2YXIgdHJhbnNmb3JtID0gZXYucG9pbnRlci5kaXN0YW5jZVk7XHJcbiAgICAgICAgaWYgKHRyYW5zZm9ybSA8IDUpIHtcclxuICAgICAgICAgIC8vIFNsb3cgZG93biBkcmFnIHdoZW4gdHJ5aW5nIHRvIGRyYWcgdXAsIGFuZCBzdG9wIGFmdGVyIFBBRERJTkdcclxuICAgICAgICAgIHRyYW5zZm9ybSA9IE1hdGgubWF4KC1QQURESU5HLCB0cmFuc2Zvcm0gLyAyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlbWVudC5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJ3RyYW5zbGF0ZTNkKDAsJyArIChQQURESU5HICsgdHJhbnNmb3JtKSArICdweCwwKScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBvbkRyYWdFbmQoZXYpIHtcclxuICAgICAgICBpZiAoZXYucG9pbnRlci5kaXN0YW5jZVkgPiAwICYmXHJcbiAgICAgICAgICAgIChldi5wb2ludGVyLmRpc3RhbmNlWSA+IDIwIHx8IE1hdGguYWJzKGV2LnBvaW50ZXIudmVsb2NpdHlZKSA+IENMT1NJTkdfVkVMT0NJVFkpKSB7XHJcbiAgICAgICAgICB2YXIgZGlzdGFuY2VSZW1haW5pbmcgPSBlbGVtZW50LnByb3AoJ29mZnNldEhlaWdodCcpIC0gZXYucG9pbnRlci5kaXN0YW5jZVk7XHJcbiAgICAgICAgICB2YXIgdHJhbnNpdGlvbkR1cmF0aW9uID0gTWF0aC5taW4oZGlzdGFuY2VSZW1haW5pbmcgLyBldi5wb2ludGVyLnZlbG9jaXR5WSAqIDAuNzUsIDUwMCk7XHJcbiAgICAgICAgICBlbGVtZW50LmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTl9EVVJBVElPTiwgdHJhbnNpdGlvbkR1cmF0aW9uICsgJ21zJyk7XHJcbiAgICAgICAgICAkdGltZW91dCgkbWRCb3R0b21TaGVldC5jYW5jZWwpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBlbGVtZW50LmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTl9EVVJBVElPTiwgJycpO1xyXG4gICAgICAgICAgZWxlbWVudC5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG59XHJcbk1kQm90dG9tU2hlZXRQcm92aWRlci4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5idXR0b25cclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIEJ1dHRvblxyXG4gKi9cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5idXR0b24nLCBbICdtYXRlcmlhbC5jb3JlJyBdKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRCdXR0b24nLCBNZEJ1dHRvbkRpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZEJ1dHRvblxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuYnV0dG9uXHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBgPG1kLWJ1dHRvbj5gIGlzIGEgYnV0dG9uIGRpcmVjdGl2ZSB3aXRoIG9wdGlvbmFsIGluayByaXBwbGVzIChkZWZhdWx0IGVuYWJsZWQpLlxyXG4gKlxyXG4gKiBJZiB5b3Ugc3VwcGx5IGEgYGhyZWZgIG9yIGBuZy1ocmVmYCBhdHRyaWJ1dGUsIGl0IHdpbGwgYmVjb21lIGFuIGA8YT5gIGVsZW1lbnQuIE90aGVyd2lzZSwgaXQgd2lsbFxyXG4gKiBiZWNvbWUgYSBgPGJ1dHRvbj5gIGVsZW1lbnQuIEFzIHBlciB0aGUgW01hdGVyaWFsIERlc2lnbiBzcGVjaWZpY2F0aW9uc10oaHR0cDovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9zcGVjL3N0eWxlL2NvbG9yLmh0bWwjY29sb3ItdWktY29sb3ItYXBwbGljYXRpb24pXHJcbiAqIHRoZSBGQUIgYnV0dG9uIGJhY2tncm91bmQgaXMgZmlsbGVkIHdpdGggdGhlIGFjY2VudCBjb2xvciBbYnkgZGVmYXVsdF0uIFRoZSBwcmltYXJ5IGNvbG9yIHBhbGV0dGUgbWF5IGJlIHVzZWQgd2l0aFxyXG4gKiB0aGUgYG1kLXByaW1hcnlgIGNsYXNzLlxyXG4gKlxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1uby1pbmsgSWYgcHJlc2VudCwgZGlzYWJsZSByaXBwbGUgaW5rIGVmZmVjdHMuXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG5nLWRpc2FibGVkIEVuL0Rpc2FibGUgYmFzZWQgb24gdGhlIGV4cHJlc3Npb25cclxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1yaXBwbGUtc2l6ZSBPdmVycmlkZXMgdGhlIGRlZmF1bHQgcmlwcGxlIHNpemUgbG9naWMuIE9wdGlvbnM6IGBmdWxsYCwgYHBhcnRpYWxgLCBgYXV0b2BcclxuICogQHBhcmFtIHtzdHJpbmc9fSBhcmlhLWxhYmVsIEFkZHMgYWx0ZXJuYXRpdmUgdGV4dCB0byBidXR0b24gZm9yIGFjY2Vzc2liaWxpdHksIHVzZWZ1bCBmb3IgaWNvbiBidXR0b25zLlxyXG4gKiBJZiBubyBkZWZhdWx0IHRleHQgaXMgZm91bmQsIGEgd2FybmluZyB3aWxsIGJlIGxvZ2dlZC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqXHJcbiAqIFJlZ3VsYXIgYnV0dG9uczpcclxuICpcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogIDxtZC1idXR0b24+IEZsYXQgQnV0dG9uIDwvbWQtYnV0dG9uPlxyXG4gKiAgPG1kLWJ1dHRvbiBocmVmPVwiaHR0cDovL2dvb2dsZS5jb21cIj4gRmxhdCBsaW5rIDwvbWQtYnV0dG9uPlxyXG4gKiAgPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXJhaXNlZFwiPiBSYWlzZWQgQnV0dG9uIDwvbWQtYnV0dG9uPlxyXG4gKiAgPG1kLWJ1dHRvbiBuZy1kaXNhYmxlZD1cInRydWVcIj4gRGlzYWJsZWQgQnV0dG9uIDwvbWQtYnV0dG9uPlxyXG4gKiAgPG1kLWJ1dHRvbj5cclxuICogICAgPG1kLWljb24gbWQtc3ZnLXNyYz1cInlvdXIvaWNvbi5zdmdcIj48L21kLWljb24+XHJcbiAqICAgIFJlZ2lzdGVyIE5vd1xyXG4gKiAgPC9tZC1idXR0b24+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogRkFCIGJ1dHRvbnM6XHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtZmFiXCIgYXJpYS1sYWJlbD1cIkZBQlwiPlxyXG4gKiAgICA8bWQtaWNvbiBtZC1zdmctc3JjPVwieW91ci9pY29uLnN2Z1wiPjwvbWQtaWNvbj5cclxuICogIDwvbWQtYnV0dG9uPlxyXG4gKiAgPCEtLSBtaW5pLUZBQiAtLT5cclxuICogIDxtZC1idXR0b24gY2xhc3M9XCJtZC1mYWIgbWQtbWluaVwiIGFyaWEtbGFiZWw9XCJNaW5pIEZBQlwiPlxyXG4gKiAgICA8bWQtaWNvbiBtZC1zdmctc3JjPVwieW91ci9pY29uLnN2Z1wiPjwvbWQtaWNvbj5cclxuICogIDwvbWQtYnV0dG9uPlxyXG4gKiAgPCEtLSBCdXR0b24gd2l0aCBTVkcgSWNvbiAtLT5cclxuICogIDxtZC1idXR0b24gY2xhc3M9XCJtZC1pY29uLWJ1dHRvblwiIGFyaWEtbGFiZWw9XCJDdXN0b20gSWNvbiBCdXR0b25cIj5cclxuICogICAgPG1kLWljb24gbWQtc3ZnLWljb249XCJwYXRoL3RvL3lvdXIuc3ZnXCI+PC9tZC1pY29uPlxyXG4gKiAgPC9tZC1idXR0b24+XHJcbiAqIDwvaGxqcz5cclxuICovXHJcbmZ1bmN0aW9uIE1kQnV0dG9uRGlyZWN0aXZlKCRtZEJ1dHRvbklua1JpcHBsZSwgJG1kVGhlbWluZywgJG1kQXJpYSwgJHRpbWVvdXQpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZTogZ2V0VGVtcGxhdGUsXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIGlzQW5jaG9yKGF0dHIpIHtcclxuICAgIHJldHVybiBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLmhyZWYpIHx8IGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubmdIcmVmKSB8fCBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm5nTGluaykgfHwgYW5ndWxhci5pc0RlZmluZWQoYXR0ci51aVNyZWYpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0VGVtcGxhdGUoZWxlbWVudCwgYXR0cikge1xyXG4gICAgcmV0dXJuIGlzQW5jaG9yKGF0dHIpID9cclxuICAgICAgICAgICAnPGEgY2xhc3M9XCJtZC1idXR0b25cIiBuZy10cmFuc2NsdWRlPjwvYT4nIDpcclxuICAgICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cIm1kLWJ1dHRvblwiIG5nLXRyYW5zY2x1ZGU+PC9idXR0b24+JztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcbiAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF07XHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgJG1kQnV0dG9uSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCk7XHJcblxyXG4gICAgdmFyIGVsZW1lbnRIYXNUZXh0ID0gbm9kZS50ZXh0Q29udGVudC50cmltKCk7XHJcbiAgICBpZiAoIWVsZW1lbnRIYXNUZXh0KSB7XHJcbiAgICAgICRtZEFyaWEuZXhwZWN0KGVsZW1lbnQsICdhcmlhLWxhYmVsJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRm9yIGFuY2hvciBlbGVtZW50cywgd2UgaGF2ZSB0byBzZXQgdGFiaW5kZXggbWFudWFsbHkgd2hlbiB0aGVcclxuICAgIC8vIGVsZW1lbnQgaXMgZGlzYWJsZWRcclxuICAgIGlmIChpc0FuY2hvcihhdHRyKSAmJiBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm5nRGlzYWJsZWQpICkge1xyXG4gICAgICBzY29wZS4kd2F0Y2goYXR0ci5uZ0Rpc2FibGVkLCBmdW5jdGlvbihpc0Rpc2FibGVkKSB7XHJcbiAgICAgICAgZWxlbWVudC5hdHRyKCd0YWJpbmRleCcsIGlzRGlzYWJsZWQgPyAtMSA6IDApO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBkaXNhYmxpbmcgY2xpY2sgZXZlbnQgd2hlbiBkaXNhYmxlZCBpcyB0cnVlXHJcbiAgICBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICBpZiAoYXR0ci5kaXNhYmxlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyByZXN0cmljdCBmb2N1cyBzdHlsZXMgdG8gdGhlIGtleWJvYXJkXHJcbiAgICBzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgZWxlbWVudC5vbignbW91c2Vkb3duJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICBzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5vbignZm9jdXMnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZihzY29wZS5tb3VzZUFjdGl2ZSA9PT0gZmFsc2UpIHsgZWxlbWVudC5hZGRDbGFzcygnbWQtZm9jdXNlZCcpOyB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5vbignYmx1cicsIGZ1bmN0aW9uKCkgeyBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1mb2N1c2VkJyk7IH0pO1xyXG4gIH1cclxuXHJcbn1cclxuTWRCdXR0b25EaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZEJ1dHRvbklua1JpcHBsZVwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkbWRBcmlhXCIsIFwiJHRpbWVvdXRcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmNhcmRcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIENhcmQgY29tcG9uZW50cy5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNhcmQnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRDYXJkJywgbWRDYXJkRGlyZWN0aXZlKTtcclxuXHJcblxyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRDYXJkXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jYXJkXHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgYDxtZC1jYXJkPmAgZGlyZWN0aXZlIGlzIGEgY29udGFpbmVyIGVsZW1lbnQgdXNlZCB3aXRoaW4gYDxtZC1jb250ZW50PmAgY29udGFpbmVycy5cclxuICpcclxuICogQW4gaW1hZ2UgaW5jbHVkZWQgYXMgYSBkaXJlY3QgZGVzY2VuZGFudCB3aWxsIGZpbGwgdGhlIGNhcmQncyB3aWR0aCwgd2hpbGUgdGhlIGA8bWQtY2FyZC1jb250ZW50PmBcclxuICogY29udGFpbmVyIHdpbGwgd3JhcCB0ZXh0IGNvbnRlbnQgYW5kIHByb3ZpZGUgcGFkZGluZy4gQW4gYDxtZC1jYXJkLWZvb3Rlcj5gIGVsZW1lbnQgY2FuIGJlXHJcbiAqIG9wdGlvbmFsbHkgaW5jbHVkZWQgdG8gcHV0IGNvbnRlbnQgZmx1c2ggYWdhaW5zdCB0aGUgYm90dG9tIGVkZ2Ugb2YgdGhlIGNhcmQuXHJcbiAqXHJcbiAqIEFjdGlvbiBidXR0b25zIGNhbiBiZSBpbmNsdWRlZCBpbiBhbiBlbGVtZW50IHdpdGggdGhlIGAubWQtYWN0aW9uc2AgY2xhc3MsIGFsc28gdXNlZCBpbiBgbWQtZGlhbG9nYC5cclxuICogWW91IGNhbiB0aGVuIHBvc2l0aW9uIGJ1dHRvbnMgdXNpbmcgbGF5b3V0IGF0dHJpYnV0ZXMuXHJcbiAqXHJcbiAqIENhcmRzIGhhdmUgY29uc3RhbnQgd2lkdGggYW5kIHZhcmlhYmxlIGhlaWdodHM7IHdoZXJlIHRoZSBtYXhpbXVtIGhlaWdodCBpcyBsaW1pdGVkIHRvIHdoYXQgY2FuXHJcbiAqIGZpdCB3aXRoaW4gYSBzaW5nbGUgdmlldyBvbiBhIHBsYXRmb3JtLCBidXQgaXQgY2FuIHRlbXBvcmFyaWx5IGV4cGFuZCBhcyBuZWVkZWQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiAjIyNDYXJkIHdpdGggb3B0aW9uYWwgZm9vdGVyXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1jYXJkPlxyXG4gKiAgPGltZyBzcmM9XCJjYXJkLWltYWdlLnBuZ1wiIGNsYXNzPVwibWQtY2FyZC1pbWFnZVwiIGFsdD1cImltYWdlIGNhcHRpb25cIj5cclxuICogIDxtZC1jYXJkLWNvbnRlbnQ+XHJcbiAqICAgIDxoMj5DYXJkIGhlYWRsaW5lPC9oMj5cclxuICogICAgPHA+Q2FyZCBjb250ZW50PC9wPlxyXG4gKiAgPC9tZC1jYXJkLWNvbnRlbnQ+XHJcbiAqICA8bWQtY2FyZC1mb290ZXI+XHJcbiAqICAgIENhcmQgZm9vdGVyXHJcbiAqICA8L21kLWNhcmQtZm9vdGVyPlxyXG4gKiA8L21kLWNhcmQ+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogIyMjQ2FyZCB3aXRoIGFjdGlvbnNcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLWNhcmQ+XHJcbiAqICA8aW1nIHNyYz1cImNhcmQtaW1hZ2UucG5nXCIgY2xhc3M9XCJtZC1jYXJkLWltYWdlXCIgYWx0PVwiaW1hZ2UgY2FwdGlvblwiPlxyXG4gKiAgPG1kLWNhcmQtY29udGVudD5cclxuICogICAgPGgyPkNhcmQgaGVhZGxpbmU8L2gyPlxyXG4gKiAgICA8cD5DYXJkIGNvbnRlbnQ8L3A+XHJcbiAqICA8L21kLWNhcmQtY29udGVudD5cclxuICogIDxkaXYgY2xhc3M9XCJtZC1hY3Rpb25zXCIgbGF5b3V0PVwicm93XCIgbGF5b3V0LWFsaWduPVwiZW5kIGNlbnRlclwiPlxyXG4gKiAgICA8bWQtYnV0dG9uPkFjdGlvbiAxPC9tZC1idXR0b24+XHJcbiAqICAgIDxtZC1idXR0b24+QWN0aW9uIDI8L21kLWJ1dHRvbj5cclxuICogIDwvZGl2PlxyXG4gKiA8L21kLWNhcmQ+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uIG1kQ2FyZERpcmVjdGl2ZSgkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cikge1xyXG4gICAgICAkbWRUaGVtaW5nKCRlbGVtZW50KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbm1kQ2FyZERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuY2hlY2tib3hcclxuICogQGRlc2NyaXB0aW9uIENoZWNrYm94IG1vZHVsZSFcclxuICovXHJcbmFuZ3VsYXJcclxuICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoZWNrYm94JywgWydtYXRlcmlhbC5jb3JlJ10pXHJcbiAgLmRpcmVjdGl2ZSgnbWRDaGVja2JveCcsIE1kQ2hlY2tib3hEaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRDaGVja2JveFxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuY2hlY2tib3hcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBjaGVja2JveCBkaXJlY3RpdmUgaXMgdXNlZCBsaWtlIHRoZSBub3JtYWwgW2FuZ3VsYXIgY2hlY2tib3hdKGh0dHBzOi8vZG9jcy5hbmd1bGFyanMub3JnL2FwaS9uZy9pbnB1dC9pbnB1dCU1QmNoZWNrYm94JTVEKS5cclxuICpcclxuICogQXMgcGVyIHRoZSBbbWF0ZXJpYWwgZGVzaWduIHNwZWNdKGh0dHA6Ly93d3cuZ29vZ2xlLmNvbS9kZXNpZ24vc3BlYy9zdHlsZS9jb2xvci5odG1sI2NvbG9yLXVpLWNvbG9yLWFwcGxpY2F0aW9uKVxyXG4gKiB0aGUgY2hlY2tib3ggaXMgaW4gdGhlIGFjY2VudCBjb2xvciBieSBkZWZhdWx0LiBUaGUgcHJpbWFyeSBjb2xvciBwYWxldHRlIG1heSBiZSB1c2VkIHdpdGhcclxuICogdGhlIGBtZC1wcmltYXJ5YCBjbGFzcy5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IG5nLW1vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBuZy10cnVlLXZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gc2VsZWN0ZWQuXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG5nLWZhbHNlLXZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gbm90IHNlbGVjdGVkLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nLWNoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWluayBVc2Ugb2YgYXR0cmlidXRlIGluZGljYXRlcyB1c2Ugb2YgcmlwcGxlIGluayBlZmZlY3RzXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBBZGRzIGxhYmVsIHRvIGNoZWNrYm94IGZvciBhY2Nlc3NpYmlsaXR5LlxyXG4gKiBEZWZhdWx0cyB0byBjaGVja2JveCdzIHRleHQuIElmIG5vIGRlZmF1bHQgdGV4dCBpcyBmb3VuZCwgYSB3YXJuaW5nIHdpbGwgYmUgbG9nZ2VkLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLWNoZWNrYm94IG5nLW1vZGVsPVwiaXNDaGVja2VkXCIgYXJpYS1sYWJlbD1cIkZpbmlzaGVkP1wiPlxyXG4gKiAgIEZpbmlzaGVkID9cclxuICogPC9tZC1jaGVja2JveD5cclxuICpcclxuICogPG1kLWNoZWNrYm94IG1kLW5vLWluayBuZy1tb2RlbD1cImhhc0lua1wiIGFyaWEtbGFiZWw9XCJObyBJbmsgRWZmZWN0c1wiPlxyXG4gKiAgIE5vIEluayBFZmZlY3RzXHJcbiAqIDwvbWQtY2hlY2tib3g+XHJcbiAqXHJcbiAqIDxtZC1jaGVja2JveCBuZy1kaXNhYmxlZD1cInRydWVcIiBuZy1tb2RlbD1cImlzRGlzYWJsZWRcIiBhcmlhLWxhYmVsPVwiRGlzYWJsZWRcIj5cclxuICogICBEaXNhYmxlZFxyXG4gKiA8L21kLWNoZWNrYm94PlxyXG4gKlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBNZENoZWNrYm94RGlyZWN0aXZlKGlucHV0RGlyZWN0aXZlLCAkbWRJbmtSaXBwbGUsICRtZEFyaWEsICRtZENvbnN0YW50LCAkbWRUaGVtaW5nLCAkbWRVdGlsLCAkdGltZW91dCkge1xyXG4gIGlucHV0RGlyZWN0aXZlID0gaW5wdXREaXJlY3RpdmVbMF07XHJcbiAgdmFyIENIRUNLRURfQ1NTID0gJ21kLWNoZWNrZWQnO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxyXG4gICAgcHJpb3JpdHk6MjEwLCAvLyBSdW4gYmVmb3JlIG5nQXJpYVxyXG4gICAgdGVtcGxhdGU6IFxyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLWNvbnRhaW5lclwiIG1kLWluay1yaXBwbGUgbWQtaW5rLXJpcHBsZS1jaGVja2JveD4nICtcclxuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWljb25cIj48L2Rpdj4nICtcclxuICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAnPGRpdiBuZy10cmFuc2NsdWRlIGNsYXNzPVwibWQtbGFiZWxcIj48L2Rpdj4nLFxyXG4gICAgY29tcGlsZTogY29tcGlsZVxyXG4gIH07XHJcblxyXG4gIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuICAvLyBQcml2YXRlIE1ldGhvZHNcclxuICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGUgKHRFbGVtZW50LCB0QXR0cnMpIHtcclxuXHJcbiAgICB0QXR0cnMudHlwZSA9ICdjaGVja2JveCc7XHJcbiAgICB0QXR0cnMudGFiaW5kZXggPSB0QXR0cnMudGFiaW5kZXggfHwgJzAnO1xyXG4gICAgdEVsZW1lbnQuYXR0cigncm9sZScsIHRBdHRycy50eXBlKTtcclxuXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIG5nTW9kZWxDdHJsKSB7XHJcbiAgICAgIG5nTW9kZWxDdHJsID0gbmdNb2RlbEN0cmwgfHwgJG1kVXRpbC5mYWtlTmdNb2RlbCgpO1xyXG4gICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG5cclxuICAgICAgaWYgKGF0dHIubmdDaGVja2VkKSB7XHJcbiAgICAgICAgc2NvcGUuJHdhdGNoKFxyXG4gICAgICAgICAgICBzY29wZS4kZXZhbC5iaW5kKHNjb3BlLCBhdHRyLm5nQ2hlY2tlZCksXHJcbiAgICAgICAgICAgIG5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUuYmluZChuZ01vZGVsQ3RybClcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICAgICQkd2F0Y2hFeHByKCduZ0Rpc2FibGVkJywgJ3RhYmluZGV4Jywge1xyXG4gICAgICAgIHRydWU6ICctMScsXHJcbiAgICAgICAgZmFsc2U6IGF0dHIudGFiaW5kZXhcclxuICAgICAgfSk7XHJcbiAgICAgICRtZEFyaWEuZXhwZWN0V2l0aFRleHQoZWxlbWVudCwgJ2FyaWEtbGFiZWwnKTtcclxuXHJcbiAgICAgIC8vIFJldXNlIHRoZSBvcmlnaW5hbCBpbnB1dFt0eXBlPWNoZWNrYm94XSBkaXJlY3RpdmUgZnJvbSBBbmd1bGFyIGNvcmUuXHJcbiAgICAgIC8vIFRoaXMgaXMgYSBiaXQgaGFja3kgYXMgd2UgbmVlZCBvdXIgb3duIGV2ZW50IGxpc3RlbmVyIGFuZCBvd24gcmVuZGVyXHJcbiAgICAgIC8vIGZ1bmN0aW9uLlxyXG4gICAgICBpbnB1dERpcmVjdGl2ZS5saW5rLnByZShzY29wZSwge1xyXG4gICAgICAgIG9uOiBhbmd1bGFyLm5vb3AsXHJcbiAgICAgICAgMDoge31cclxuICAgICAgfSwgYXR0ciwgW25nTW9kZWxDdHJsXSk7XHJcblxyXG4gICAgICBzY29wZS5tb3VzZUFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICBlbGVtZW50Lm9uKCdjbGljaycsIGxpc3RlbmVyKVxyXG4gICAgICAgIC5vbigna2V5cHJlc3MnLCBrZXlwcmVzc0hhbmRsZXIpXHJcbiAgICAgICAgLm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKCdmb2N1cycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgaWYoc2NvcGUubW91c2VBY3RpdmUgPT09IGZhbHNlKSB7IGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7IGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfSk7XHJcblxyXG4gICAgICBuZ01vZGVsQ3RybC4kcmVuZGVyID0gcmVuZGVyO1xyXG5cclxuICAgICAgZnVuY3Rpb24gJCR3YXRjaEV4cHIoZXhwciwgaHRtbEF0dHIsIHZhbHVlT3B0cykge1xyXG4gICAgICAgIGlmIChhdHRyW2V4cHJdKSB7XHJcbiAgICAgICAgICBzY29wZS4kd2F0Y2goYXR0cltleHByXSwgZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZU9wdHNbdmFsXSkge1xyXG4gICAgICAgICAgICAgIGVsZW1lbnQuYXR0cihodG1sQXR0ciwgdmFsdWVPcHRzW3ZhbF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGtleXByZXNzSGFuZGxlcihldikge1xyXG4gICAgICAgIHZhciBrZXlDb2RlID0gZXYud2hpY2ggfHwgZXYua2V5Q29kZTtcclxuICAgICAgICBpZiAoa2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuU1BBQ0UgfHwga2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuRU5URVIpIHtcclxuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICBpZiAoIWVsZW1lbnQuaGFzQ2xhc3MoJ21kLWZvY3VzZWQnKSkgeyBlbGVtZW50LmFkZENsYXNzKCdtZC1mb2N1c2VkJyk7IH1cclxuICAgICAgICAgIGxpc3RlbmVyKGV2KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZnVuY3Rpb24gbGlzdGVuZXIoZXYpIHtcclxuICAgICAgICBpZiAoZWxlbWVudFswXS5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHJldHVybjtcclxuXHJcbiAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgLy8gVG9nZ2xlIHRoZSBjaGVja2JveCB2YWx1ZS4uLlxyXG4gICAgICAgICAgdmFyIHZpZXdWYWx1ZSA9IGF0dHIubmdDaGVja2VkID8gYXR0ci5jaGVja2VkIDogIW5nTW9kZWxDdHJsLiR2aWV3VmFsdWU7XHJcblxyXG4gICAgICAgICAgbmdNb2RlbEN0cmwuJHNldFZpZXdWYWx1ZSggdmlld1ZhbHVlLCBldiAmJiBldi50eXBlKTtcclxuICAgICAgICAgIG5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gcmVuZGVyKCkge1xyXG4gICAgICAgIGlmKG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUpIHtcclxuICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoQ0hFQ0tFRF9DU1MpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKENIRUNLRURfQ1NTKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG59XHJcbk1kQ2hlY2tib3hEaXJlY3RpdmUuJGluamVjdCA9IFtcImlucHV0RGlyZWN0aXZlXCIsIFwiJG1kSW5rUmlwcGxlXCIsIFwiJG1kQXJpYVwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIiwgXCIkdGltZW91dFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHNcclxuICovXHJcbi8qXHJcbiAqIEBzZWUganMgZm9sZGVyIGZvciBjaGlwcyBpbXBsZW1lbnRhdGlvblxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHMnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZSdcclxuXSk7XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmNvbnRlbnRcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFNjcm9sbGFibGUgY29udGVudFxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY29udGVudCcsIFtcclxuICAnbWF0ZXJpYWwuY29yZSdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZENvbnRlbnQnLCBtZENvbnRlbnREaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRDb250ZW50XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50XHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgYDxtZC1jb250ZW50PmAgZGlyZWN0aXZlIGlzIGEgY29udGFpbmVyIGVsZW1lbnQgdXNlZnVsIGZvciBzY3JvbGxhYmxlIGNvbnRlbnRcclxuICpcclxuICogQHVzYWdlXHJcbiAqXHJcbiAqIC0gQWRkIHRoZSBgW2xheW91dC1wYWRkaW5nXWAgYXR0cmlidXRlIHRvIG1ha2UgdGhlIGNvbnRlbnQgcGFkZGVkLlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgPG1kLWNvbnRlbnQgbGF5b3V0LXBhZGRpbmc+XHJcbiAqICAgICAgTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIG5lIHF1b2Qgbm92dW0gbWVpLlxyXG4gKiAgPC9tZC1jb250ZW50PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gbWRDb250ZW50RGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGNvbnRyb2xsZXI6IFsnJHNjb3BlJywgJyRlbGVtZW50JywgQ29udGVudENvbnRyb2xsZXJdLFxyXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgdmFyIG5vZGUgPSBlbGVtZW50WzBdO1xyXG5cclxuICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuICAgICAgc2NvcGUuJGJyb2FkY2FzdCgnJG1kQ29udGVudExvYWRlZCcsIGVsZW1lbnQpO1xyXG5cclxuICAgICAgaW9zU2Nyb2xsRml4KGVsZW1lbnRbMF0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIENvbnRlbnRDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQpIHtcclxuICAgIHRoaXMuJHNjb3BlID0gJHNjb3BlO1xyXG4gICAgdGhpcy4kZWxlbWVudCA9ICRlbGVtZW50O1xyXG4gIH1cclxufVxyXG5tZENvbnRlbnREaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIl07XHJcblxyXG5mdW5jdGlvbiBpb3NTY3JvbGxGaXgobm9kZSkge1xyXG4gIC8vIElPUyBGSVg6XHJcbiAgLy8gSWYgd2Ugc2Nyb2xsIHdoZXJlIHRoZXJlIGlzIG5vIG1vcmUgcm9vbSBmb3IgdGhlIHdlYnZpZXcgdG8gc2Nyb2xsLFxyXG4gIC8vIGJ5IGRlZmF1bHQgdGhlIHdlYnZpZXcgaXRzZWxmIHdpbGwgc2Nyb2xsIHVwIGFuZCBkb3duLCB0aGlzIGxvb2tzIHJlYWxseVxyXG4gIC8vIGJhZC4gIFNvIGlmIHdlIGFyZSBzY3JvbGxpbmcgdG8gdGhlIHZlcnkgdG9wIG9yIGJvdHRvbSwgYWRkL3N1YnRyYWN0IG9uZVxyXG4gIGFuZ3VsYXIuZWxlbWVudChub2RlKS5vbignJG1kLnByZXNzZG93bicsIGZ1bmN0aW9uKGV2KSB7XHJcbiAgICAvLyBPbmx5IHRvdWNoIGV2ZW50c1xyXG4gICAgaWYgKGV2LnBvaW50ZXIudHlwZSAhPT0gJ3QnKSByZXR1cm47XHJcbiAgICAvLyBEb24ndCBsZXQgYSBjaGlsZCBjb250ZW50J3MgdG91Y2hzdGFydCBydWluIGl0IGZvciB1cy5cclxuICAgIGlmIChldi4kbWF0ZXJpYWxTY3JvbGxGaXhlZCkgcmV0dXJuO1xyXG4gICAgZXYuJG1hdGVyaWFsU2Nyb2xsRml4ZWQgPSB0cnVlO1xyXG5cclxuICAgIGlmIChub2RlLnNjcm9sbFRvcCA9PT0gMCkge1xyXG4gICAgICBub2RlLnNjcm9sbFRvcCA9IDE7XHJcbiAgICB9IGVsc2UgaWYgKG5vZGUuc2Nyb2xsSGVpZ2h0ID09PSBub2RlLnNjcm9sbFRvcCArIG5vZGUub2Zmc2V0SGVpZ2h0KSB7XHJcbiAgICAgIG5vZGUuc2Nyb2xsVG9wIC09IDE7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuZGlhbG9nXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5kaWFsb2cnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmJhY2tkcm9wJ1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kRGlhbG9nJywgTWREaWFsb2dEaXJlY3RpdmUpXHJcbiAgLnByb3ZpZGVyKCckbWREaWFsb2cnLCBNZERpYWxvZ1Byb3ZpZGVyKTtcclxuXHJcbmZ1bmN0aW9uIE1kRGlhbG9nRGlyZWN0aXZlKCQkckFGLCAkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY29udGVudCA9IGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignbWQtZGlhbG9nLWNvbnRlbnQnKTtcclxuICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50LnNjcm9sbEhlaWdodCA+IGNvbnRlbnQuY2xpZW50SGVpZ2h0KSB7XHJcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1jb250ZW50LW92ZXJmbG93Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbk1kRGlhbG9nRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRtZFRoZW1pbmdcIl07XHJcblxyXG4vKipcclxuICogQG5nZG9jIHNlcnZpY2VcclxuICogQG5hbWUgJG1kRGlhbG9nXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5kaWFsb2dcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGAkbWREaWFsb2dgIG9wZW5zIGEgZGlhbG9nIG92ZXIgdGhlIGFwcCB0byBpbmZvcm0gdXNlcnMgYWJvdXQgY3JpdGljYWwgaW5mb3JtYXRpb24gb3IgcmVxdWlyZVxyXG4gKiAgdGhlbSB0byBtYWtlIGRlY2lzaW9ucy4gVGhlcmUgYXJlIHR3byBhcHByb2FjaGVzIGZvciBzZXR1cDogYSBzaW1wbGUgcHJvbWlzZSBBUElcclxuICogIGFuZCByZWd1bGFyIG9iamVjdCBzeW50YXguXHJcbiAqXHJcbiAqICMjIFJlc3RyaWN0aW9uc1xyXG4gKlxyXG4gKiAtIFRoZSBkaWFsb2cgaXMgYWx3YXlzIGdpdmVuIGFuIGlzb2xhdGUgc2NvcGUuXHJcbiAqIC0gVGhlIGRpYWxvZydzIHRlbXBsYXRlIG11c3QgaGF2ZSBhbiBvdXRlciBgPG1kLWRpYWxvZz5gIGVsZW1lbnQuXHJcbiAqICAgSW5zaWRlLCB1c2UgYW4gYDxtZC1kaWFsb2ctY29udGVudD5gIGVsZW1lbnQgZm9yIHRoZSBkaWFsb2cncyBjb250ZW50LCBhbmQgdXNlXHJcbiAqICAgYW4gZWxlbWVudCB3aXRoIGNsYXNzIGBtZC1hY3Rpb25zYCBmb3IgdGhlIGRpYWxvZydzIGFjdGlvbnMuXHJcbiAqIC0gRGlhbG9ncyBtdXN0IGNvdmVyIHRoZSBlbnRpcmUgYXBwbGljYXRpb24gdG8ga2VlcCBpbnRlcmFjdGlvbnMgaW5zaWRlIG9mIHRoZW0uXHJcbiAqIFVzZSB0aGUgYHBhcmVudGAgb3B0aW9uIHRvIGNoYW5nZSB3aGVyZSBkaWFsb2dzIGFyZSBhcHBlbmRlZC5cclxuICpcclxuICogIyMgU2l6aW5nXHJcbiAqIC0gQ29tcGxleCBkaWFsb2dzIGNhbiBiZSBzaXplZCB3aXRoIGBmbGV4PVwicGVyY2VudGFnZVwiYCwgaS5lLiBgZmxleD1cIjY2XCJgLlxyXG4gKiAtIERlZmF1bHQgbWF4LXdpZHRoIGlzIDgwJSBvZiB0aGUgYHJvb3RFbGVtZW50YCBvciBgcGFyZW50YC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxkaXYgIG5nLWFwcD1cImRlbW9BcHBcIiBuZy1jb250cm9sbGVyPVwiRW1wbG95ZWVDb250cm9sbGVyXCI+XHJcbiAqICAgPGRpdj5cclxuICogICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJzaG93QWxlcnQoKVwiIGNsYXNzPVwibWQtcmFpc2VkIG1kLXdhcm5cIj5cclxuICogICAgICAgRW1wbG95ZWUgQWxlcnQhXHJcbiAqICAgICAgIDwvbWQtYnV0dG9uPlxyXG4gKiAgIDwvZGl2PlxyXG4gKiAgIDxkaXY+XHJcbiAqICAgICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwic2hvd0RpYWxvZygkZXZlbnQpXCIgY2xhc3M9XCJtZC1yYWlzZWRcIj5cclxuICogICAgICAgQ3VzdG9tIERpYWxvZ1xyXG4gKiAgICAgICA8L21kLWJ1dHRvbj5cclxuICogICA8L2Rpdj5cclxuICogICA8ZGl2PlxyXG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cImNsb3NlQWxlcnQoKVwiIG5nLWRpc2FibGVkPVwiIWhhc0FsZXJ0KClcIiBjbGFzcz1cIm1kLXJhaXNlZFwiPlxyXG4gKiAgICAgICBDbG9zZSBBbGVydFxyXG4gKiAgICAgPC9tZC1idXR0b24+XHJcbiAqICAgPC9kaXY+XHJcbiAqICAgPGRpdj5cclxuICogICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJzaG93R3JlZXRpbmcoJGV2ZW50KVwiIGNsYXNzPVwibWQtcmFpc2VkIG1kLXByaW1hcnlcIiA+XHJcbiAqICAgICAgIEdyZWV0IEVtcGxveWVlXHJcbiAqICAgICAgIDwvbWQtYnV0dG9uPlxyXG4gKiAgIDwvZGl2PlxyXG4gKiA8L2Rpdj5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiAjIyMgSmF2YVNjcmlwdDogb2JqZWN0IHN5bnRheFxyXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICogKGZ1bmN0aW9uKGFuZ3VsYXIsIHVuZGVmaW5lZCl7XHJcbiAqICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAqXHJcbiAqICAgYW5ndWxhclxyXG4gKiAgICAubW9kdWxlKCdkZW1vQXBwJywgWyduZ01hdGVyaWFsJ10pXHJcbiAqICAgIC5jb250cm9sbGVyKCdBcHBDdHJsJywgQXBwQ29udHJvbGxlcik7XHJcbiAqXHJcbiAqICAgZnVuY3Rpb24gQXBwQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZykge1xyXG4gKiAgICAgdmFyIGFsZXJ0O1xyXG4gKiAgICAgJHNjb3BlLnNob3dBbGVydCA9IHNob3dBbGVydDtcclxuICogICAgICRzY29wZS5zaG93RGlhbG9nID0gc2hvd0RpYWxvZztcclxuICogICAgICRzY29wZS5pdGVtcyA9IFsxLCAyLCAzXTtcclxuICpcclxuICogICAgIC8vIEludGVybmFsIG1ldGhvZFxyXG4gKiAgICAgZnVuY3Rpb24gc2hvd0FsZXJ0KCkge1xyXG4gKiAgICAgICBhbGVydCA9ICRtZERpYWxvZy5hbGVydCh7XHJcbiAqICAgICAgICAgdGl0bGU6ICdBdHRlbnRpb24nLFxyXG4gKiAgICAgICAgIGNvbnRlbnQ6ICdUaGlzIGlzIGFuIGV4YW1wbGUgb2YgaG93IGVhc3kgZGlhbG9ncyBjYW4gYmUhJyxcclxuICogICAgICAgICBvazogJ0Nsb3NlJ1xyXG4gKiAgICAgICB9KTtcclxuICpcclxuICogICAgICAgJG1kRGlhbG9nXHJcbiAqICAgICAgICAgLnNob3coIGFsZXJ0IClcclxuICogICAgICAgICAuZmluYWxseShmdW5jdGlvbigpIHtcclxuICogICAgICAgICAgIGFsZXJ0ID0gdW5kZWZpbmVkO1xyXG4gKiAgICAgICAgIH0pO1xyXG4gKiAgICAgfVxyXG4gKlxyXG4gKiAgICAgZnVuY3Rpb24gc2hvd0RpYWxvZygkZXZlbnQpIHtcclxuICogICAgICAgIHZhciBwYXJlbnRFbCA9IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KTtcclxuICogICAgICAgICRtZERpYWxvZy5zaG93KHtcclxuICogICAgICAgICAgcGFyZW50OiBwYXJlbnRFbCxcclxuICogICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcclxuICogICAgICAgICAgdGVtcGxhdGU6XHJcbiAqICAgICAgICAgICAgJzxtZC1kaWFsb2cgYXJpYS1sYWJlbD1cIkxpc3QgZGlhbG9nXCI+JyArXHJcbiAqICAgICAgICAgICAgJyAgPG1kLWRpYWxvZy1jb250ZW50PicrXHJcbiAqICAgICAgICAgICAgJyAgICA8bWQtbGlzdD4nK1xyXG4gKiAgICAgICAgICAgICcgICAgICA8bWQtbGlzdC1pdGVtIG5nLXJlcGVhdD1cIml0ZW0gaW4gaXRlbXNcIj4nK1xyXG4gKiAgICAgICAgICAgICcgICAgICAgPHA+TnVtYmVyIHt7aXRlbX19PC9wPicgK1xyXG4gKiAgICAgICAgICAgICcgICAgICA8L21kLWl0ZW0+JytcclxuICogICAgICAgICAgICAnICAgIDwvbWQtbGlzdD4nK1xyXG4gKiAgICAgICAgICAgICcgIDwvbWQtZGlhbG9nLWNvbnRlbnQ+JyArXHJcbiAqICAgICAgICAgICAgJyAgPGRpdiBjbGFzcz1cIm1kLWFjdGlvbnNcIj4nICtcclxuICogICAgICAgICAgICAnICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJjbG9zZURpYWxvZygpXCIgY2xhc3M9XCJtZC1wcmltYXJ5XCI+JyArXHJcbiAqICAgICAgICAgICAgJyAgICAgIENsb3NlIERpYWxvZycgK1xyXG4gKiAgICAgICAgICAgICcgICAgPC9tZC1idXR0b24+JyArXHJcbiAqICAgICAgICAgICAgJyAgPC9kaXY+JyArXHJcbiAqICAgICAgICAgICAgJzwvbWQtZGlhbG9nPicsXHJcbiAqICAgICAgICAgIGxvY2Fsczoge1xyXG4gKiAgICAgICAgICAgIGl0ZW1zOiAkc2NvcGUuaXRlbXNcclxuICogICAgICAgICAgfSxcclxuICogICAgICAgICAgY29udHJvbGxlcjogRGlhbG9nQ29udHJvbGxlclxyXG4gKiAgICAgICB9KTtcclxuICogICAgICAgZnVuY3Rpb24gRGlhbG9nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgaXRlbXMpIHtcclxuICogICAgICAgICAkc2NvcGUuaXRlbXMgPSBpdGVtcztcclxuICogICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcclxuICogICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAqICAgICAgICAgfVxyXG4gKiAgICAgICB9XHJcbiAqICAgICB9XHJcbiAqICAgfVxyXG4gKiB9KShhbmd1bGFyKTtcclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiAjIyMgSmF2YVNjcmlwdDogcHJvbWlzZSBBUEkgc3ludGF4LCBjdXN0b20gZGlhbG9nIHRlbXBsYXRlXHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiAoZnVuY3Rpb24oYW5ndWxhciwgdW5kZWZpbmVkKXtcclxuICogICBcInVzZSBzdHJpY3RcIjtcclxuICpcclxuICogICBhbmd1bGFyXHJcbiAqICAgICAubW9kdWxlKCdkZW1vQXBwJywgWyduZ01hdGVyaWFsJ10pXHJcbiAqICAgICAuY29udHJvbGxlcignRW1wbG95ZWVDb250cm9sbGVyJywgRW1wbG95ZWVFZGl0b3IpXHJcbiAqICAgICAuY29udHJvbGxlcignR3JlZXRpbmdDb250cm9sbGVyJywgR3JlZXRpbmdDb250cm9sbGVyKTtcclxuICpcclxuICogICAvLyBGaWN0aXRpb3VzIEVtcGxveWVlIEVkaXRvciB0byBzaG93IGhvdyB0byB1c2Ugc2ltcGxlIGFuZCBjb21wbGV4IGRpYWxvZ3MuXHJcbiAqXHJcbiAqICAgZnVuY3Rpb24gRW1wbG95ZWVFZGl0b3IoJHNjb3BlLCAkbWREaWFsb2cpIHtcclxuICogICAgIHZhciBhbGVydDtcclxuICpcclxuICogICAgICRzY29wZS5zaG93QWxlcnQgPSBzaG93QWxlcnQ7XHJcbiAqICAgICAkc2NvcGUuY2xvc2VBbGVydCA9IGNsb3NlQWxlcnQ7XHJcbiAqICAgICAkc2NvcGUuc2hvd0dyZWV0aW5nID0gc2hvd0N1c3RvbUdyZWV0aW5nO1xyXG4gKlxyXG4gKiAgICAgJHNjb3BlLmhhc0FsZXJ0ID0gZnVuY3Rpb24oKSB7IHJldHVybiAhIWFsZXJ0IH07XHJcbiAqICAgICAkc2NvcGUudXNlck5hbWUgPSAkc2NvcGUudXNlck5hbWUgfHwgJ0JvYmJ5JztcclxuICpcclxuICogICAgIC8vIERpYWxvZyAjMSAtIFNob3cgc2ltcGxlIGFsZXJ0IGRpYWxvZyBhbmQgY2FjaGVcclxuICogICAgIC8vIHJlZmVyZW5jZSB0byBkaWFsb2cgaW5zdGFuY2VcclxuICpcclxuICogICAgIGZ1bmN0aW9uIHNob3dBbGVydCgpIHtcclxuICogICAgICAgYWxlcnQgPSAkbWREaWFsb2cuYWxlcnQoKVxyXG4gKiAgICAgICAgIC50aXRsZSgnQXR0ZW50aW9uLCAnICsgJHNjb3BlLnVzZXJOYW1lKVxyXG4gKiAgICAgICAgIC5jb250ZW50KCdUaGlzIGlzIGFuIGV4YW1wbGUgb2YgaG93IGVhc3kgZGlhbG9ncyBjYW4gYmUhJylcclxuICogICAgICAgICAub2soJ0Nsb3NlJyk7XHJcbiAqXHJcbiAqICAgICAgICRtZERpYWxvZ1xyXG4gKiAgICAgICAgICAgLnNob3coIGFsZXJ0IClcclxuICogICAgICAgICAgIC5maW5hbGx5KGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgICAgICAgICBhbGVydCA9IHVuZGVmaW5lZDtcclxuICogICAgICAgICAgIH0pO1xyXG4gKiAgICAgfVxyXG4gKlxyXG4gKiAgICAgLy8gQ2xvc2UgdGhlIHNwZWNpZmllZCBkaWFsb2cgaW5zdGFuY2UgYW5kIHJlc29sdmUgd2l0aCAnZmluaXNoZWQnIGZsYWdcclxuICogICAgIC8vIE5vcm1hbGx5IHRoaXMgaXMgbm90IG5lZWRlZCwganVzdCB1c2UgJyRtZERpYWxvZy5oaWRlKCknIHRvIGNsb3NlXHJcbiAqICAgICAvLyB0aGUgbW9zdCByZWNlbnQgZGlhbG9nIHBvcHVwLlxyXG4gKlxyXG4gKiAgICAgZnVuY3Rpb24gY2xvc2VBbGVydCgpIHtcclxuICogICAgICAgJG1kRGlhbG9nLmhpZGUoIGFsZXJ0LCBcImZpbmlzaGVkXCIgKTtcclxuICogICAgICAgYWxlcnQgPSB1bmRlZmluZWQ7XHJcbiAqICAgICB9XHJcbiAqXHJcbiAqICAgICAvLyBEaWFsb2cgIzIgLSBEZW1vbnN0cmF0ZSBtb3JlIGNvbXBsZXggZGlhbG9ncyBjb25zdHJ1Y3Rpb24gYW5kIHBvcHVwLlxyXG4gKlxyXG4gKiAgICAgZnVuY3Rpb24gc2hvd0N1c3RvbUdyZWV0aW5nKCRldmVudCkge1xyXG4gKiAgICAgICAgICRtZERpYWxvZy5zaG93KHtcclxuICogICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXHJcbiAqICAgICAgICAgICB0ZW1wbGF0ZTpcclxuICogICAgICAgICAgICAgJzxtZC1kaWFsb2c+JyArXHJcbiAqXHJcbiAqICAgICAgICAgICAgICcgIDxtZC1kaWFsb2ctY29udGVudD5IZWxsbyB7eyBlbXBsb3llZSB9fSE8L21kLWRpYWxvZy1jb250ZW50PicgK1xyXG4gKlxyXG4gKiAgICAgICAgICAgICAnICA8ZGl2IGNsYXNzPVwibWQtYWN0aW9uc1wiPicgK1xyXG4gKiAgICAgICAgICAgICAnICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJjbG9zZURpYWxvZygpXCIgY2xhc3M9XCJtZC1wcmltYXJ5XCI+JyArXHJcbiAqICAgICAgICAgICAgICcgICAgICBDbG9zZSBHcmVldGluZycgK1xyXG4gKiAgICAgICAgICAgICAnICAgIDwvbWQtYnV0dG9uPicgK1xyXG4gKiAgICAgICAgICAgICAnICA8L2Rpdj4nICtcclxuICogICAgICAgICAgICAgJzwvbWQtZGlhbG9nPicsXHJcbiAqICAgICAgICAgICBjb250cm9sbGVyOiAnR3JlZXRpbmdDb250cm9sbGVyJyxcclxuICogICAgICAgICAgIG9uQ29tcGxldGU6IGFmdGVyU2hvd0FuaW1hdGlvbixcclxuICogICAgICAgICAgIGxvY2FsczogeyBlbXBsb3llZTogJHNjb3BlLnVzZXJOYW1lIH1cclxuICogICAgICAgICB9KTtcclxuICpcclxuICogICAgICAgICAvLyBXaGVuIHRoZSAnZW50ZXInIGFuaW1hdGlvbiBmaW5pc2hlcy4uLlxyXG4gKlxyXG4gKiAgICAgICAgIGZ1bmN0aW9uIGFmdGVyU2hvd0FuaW1hdGlvbihzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gKiAgICAgICAgICAgIC8vIHBvc3Qtc2hvdyBjb2RlIGhlcmU6IERPTSBlbGVtZW50IGZvY3VzLCBldGMuXHJcbiAqICAgICAgICAgfVxyXG4gKiAgICAgfVxyXG4gKlxyXG4gKiAgICAgLy8gRGlhbG9nICMzIC0gRGVtb25zdHJhdGUgdXNlIG9mIENvbnRyb2xsZXJBcyBhbmQgcGFzc2luZyAkc2NvcGUgdG8gZGlhbG9nXHJcbiAqICAgICAvLyAgICAgICAgICAgICBIZXJlIHdlIHVzZWQgbmctY29udHJvbGxlcj1cIkdyZWV0aW5nQ29udHJvbGxlciBhcyB2bVwiIGFuZFxyXG4gKiAgICAgLy8gICAgICAgICAgICAgJHNjb3BlLnZtID09PSA8Y29udHJvbGxlciBpbnN0YW5jZT5cclxuICpcclxuICogICAgIGZ1bmN0aW9uIHNob3dDdXN0b21HcmVldGluZygpIHtcclxuICpcclxuICogICAgICAgICRtZERpYWxvZy5zaG93KHtcclxuICogICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAqXHJcbiAqICAgICAgICAgICBzY29wZTogJHNjb3BlLCAgICAgICAgLy8gdXNlIHBhcmVudCBzY29wZSBpbiB0ZW1wbGF0ZVxyXG4gKiAgICAgICAgICAgcHJlc2VydmVTY29wZTogdHJ1ZSwgIC8vIGRvIG5vdCBmb3JnZXQgdGhpcyBpZiB1c2UgcGFyZW50IHNjb3BlXHJcblxyXG4gKiAgICAgICAgICAgLy8gU2luY2UgR3JlZXRpbmdDb250cm9sbGVyIGlzIGluc3RhbnRpYXRlZCB3aXRoIENvbnRyb2xsZXJBcyBzeW50YXhcclxuICogICAgICAgICAgIC8vIEFORCB3ZSBhcmUgcGFzc2luZyB0aGUgcGFyZW50ICckc2NvcGUnIHRvIHRoZSBkaWFsb2csIHdlIE1VU1RcclxuICogICAgICAgICAgIC8vIHVzZSAndm0uPHh4eD4nIGluIHRoZSB0ZW1wbGF0ZSBtYXJrdXBcclxuICpcclxuICogICAgICAgICAgIHRlbXBsYXRlOiAnPG1kLWRpYWxvZz4nICtcclxuICogICAgICAgICAgICAgICAgICAgICAnICA8bWQtZGlhbG9nLWNvbnRlbnQ+JyArXHJcbiAqICAgICAgICAgICAgICAgICAgICAgJyAgICAgSGkgVGhlcmUge3t2bS5lbXBsb3llZX19JyArXHJcbiAqICAgICAgICAgICAgICAgICAgICAgJyAgPC9tZC1kaWFsb2ctY29udGVudD4nICtcclxuICogICAgICAgICAgICAgICAgICAgICAnPC9tZC1kaWFsb2c+JyxcclxuICpcclxuICogICAgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uIERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2cpIHtcclxuICogICAgICAgICAgICAgJHNjb3BlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XHJcbiAqICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICogICAgICAgICAgICAgfVxyXG4gKiAgICAgICAgICAgfVxyXG4gKiAgICAgICAgfSk7XHJcbiAqICAgICB9XHJcbiAqXHJcbiAqICAgfVxyXG4gKlxyXG4gKiAgIC8vIEdyZWV0aW5nIGNvbnRyb2xsZXIgdXNlZCB3aXRoIHRoZSBtb3JlIGNvbXBsZXggJ3Nob3dDdXN0b21HcmVldGluZygpJyBjdXN0b20gZGlhbG9nXHJcbiAqXHJcbiAqICAgZnVuY3Rpb24gR3JlZXRpbmdDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCBlbXBsb3llZSkge1xyXG4gKiAgICAgLy8gQXNzaWduZWQgZnJvbSBjb25zdHJ1Y3Rpb24gPGNvZGU+bG9jYWxzPC9jb2RlPiBvcHRpb25zLi4uXHJcbiAqICAgICAkc2NvcGUuZW1wbG95ZWUgPSBlbXBsb3llZTtcclxuICpcclxuICogICAgICRzY29wZS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgICAvLyBFYXNpbHkgaGlkZXMgbW9zdCByZWNlbnQgZGlhbG9nIHNob3duLi4uXHJcbiAqICAgICAgIC8vIG5vIHNwZWNpZmljIGluc3RhbmNlIHJlZmVyZW5jZSBpcyBuZWVkZWQuXHJcbiAqICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAqICAgICB9O1xyXG4gKiAgIH1cclxuICpcclxuICogfSkoYW5ndWxhcik7XHJcbiAqIDwvaGxqcz5cclxuICovXHJcblxyXG4gLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kRGlhbG9nI2FsZXJ0XHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBCdWlsZHMgYSBwcmVjb25maWd1cmVkIGRpYWxvZyB3aXRoIHRoZSBzcGVjaWZpZWQgbWVzc2FnZS5cclxuICpcclxuICogQHJldHVybnMge29ian0gYW4gYCRtZERpYWxvZ1ByZXNldGAgd2l0aCB0aGUgY2hhaW5hYmxlIGNvbmZpZ3VyYXRpb24gbWV0aG9kczpcclxuICpcclxuICogLSAkbWREaWFsb2dQcmVzZXQjdGl0bGUoc3RyaW5nKSAtIHNldHMgdGl0bGUgdG8gc3RyaW5nXHJcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I2NvbnRlbnQoc3RyaW5nKSAtIHNldHMgY29udGVudCAvIG1lc3NhZ2UgdG8gc3RyaW5nXHJcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I29rKHN0cmluZykgLSBzZXRzIG9rYXkgYnV0dG9uIHRleHQgdG8gc3RyaW5nXHJcbiAqIC0gJG1kRGlhbG9nUHJlc2V0I3RoZW1lKHN0cmluZykgLSBzZXRzIHRoZSB0aGVtZSBvZiB0aGUgZGlhbG9nXHJcbiAqXHJcbiAqL1xyXG5cclxuIC8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZERpYWxvZyNjb25maXJtXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBCdWlsZHMgYSBwcmVjb25maWd1cmVkIGRpYWxvZyB3aXRoIHRoZSBzcGVjaWZpZWQgbWVzc2FnZS4gWW91IGNhbiBjYWxsIHNob3cgYW5kIHRoZSBwcm9taXNlIHJldHVybmVkXHJcbiAqIHdpbGwgYmUgcmVzb2x2ZWQgb25seSBpZiB0aGUgdXNlciBjbGlja3MgdGhlIGNvbmZpcm0gYWN0aW9uIG9uIHRoZSBkaWFsb2cuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtvYmp9IGFuIGAkbWREaWFsb2dQcmVzZXRgIHdpdGggdGhlIGNoYWluYWJsZSBjb25maWd1cmF0aW9uIG1ldGhvZHM6XHJcbiAqXHJcbiAqIEFkZGl0aW9uYWxseSwgaXQgc3VwcG9ydHMgdGhlIGZvbGxvd2luZyBtZXRob2RzOlxyXG4gKlxyXG4gKiAtICRtZERpYWxvZ1ByZXNldCN0aXRsZShzdHJpbmcpIC0gc2V0cyB0aXRsZSB0byBzdHJpbmdcclxuICogLSAkbWREaWFsb2dQcmVzZXQjY29udGVudChzdHJpbmcpIC0gc2V0cyBjb250ZW50IC8gbWVzc2FnZSB0byBzdHJpbmdcclxuICogLSAkbWREaWFsb2dQcmVzZXQjb2soc3RyaW5nKSAtIHNldHMgb2theSBidXR0b24gdGV4dCB0byBzdHJpbmdcclxuICogLSAkbWREaWFsb2dQcmVzZXQjY2FuY2VsKHN0cmluZykgLSBzZXRzIGNhbmNlbCBidXR0b24gdGV4dCB0byBzdHJpbmdcclxuICogLSAkbWREaWFsb2dQcmVzZXQjdGhlbWUoc3RyaW5nKSAtIHNldHMgdGhlIHRoZW1lIG9mIHRoZSBkaWFsb2dcclxuICpcclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWREaWFsb2cjc2hvd1xyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogU2hvdyBhIGRpYWxvZyB3aXRoIHRoZSBzcGVjaWZpZWQgb3B0aW9ucy5cclxuICpcclxuICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnNPclByZXNldCBFaXRoZXIgcHJvdmlkZSBhbiBgJG1kRGlhbG9nUHJlc2V0YCByZXR1cm5lZCBmcm9tIGBhbGVydCgpYCwgYW5kXHJcbiAqIGBjb25maXJtKClgLCBvciBhbiBvcHRpb25zIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcclxuICogICAtIGB0ZW1wbGF0ZVVybGAgLSBge3N0cmluZz19YDogVGhlIHVybCBvZiBhIHRlbXBsYXRlIHRoYXQgd2lsbCBiZSB1c2VkIGFzIHRoZSBjb250ZW50XHJcbiAqICAgb2YgdGhlIGRpYWxvZy5cclxuICogICAtIGB0ZW1wbGF0ZWAgLSBge3N0cmluZz19YDogU2FtZSBhcyB0ZW1wbGF0ZVVybCwgZXhjZXB0IHRoaXMgaXMgYW4gYWN0dWFsIHRlbXBsYXRlIHN0cmluZy5cclxuICogICAtIGB0YXJnZXRFdmVudGAgLSBge0RPTUNsaWNrRXZlbnQ9fWA6IEEgY2xpY2sncyBldmVudCBvYmplY3QuIFdoZW4gcGFzc2VkIGluIGFzIGFuIG9wdGlvbixcclxuICogICAgIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2xpY2sgd2lsbCBiZSB1c2VkIGFzIHRoZSBzdGFydGluZyBwb2ludCBmb3IgdGhlIG9wZW5pbmcgYW5pbWF0aW9uXHJcbiAqICAgICBvZiB0aGUgdGhlIGRpYWxvZy5cclxuICogICAtIGBzY29wZWAgLSBge29iamVjdD19YDogdGhlIHNjb3BlIHRvIGxpbmsgdGhlIHRlbXBsYXRlIC8gY29udHJvbGxlciB0by4gSWYgbm9uZSBpcyBzcGVjaWZpZWQsXHJcbiAqICAgICBpdCB3aWxsIGNyZWF0ZSBhIG5ldyBpc29sYXRlIHNjb3BlLlxyXG4gKiAgICAgVGhpcyBzY29wZSB3aWxsIGJlIGRlc3Ryb3llZCB3aGVuIHRoZSBkaWFsb2cgaXMgcmVtb3ZlZCB1bmxlc3MgYHByZXNlcnZlU2NvcGVgIGlzIHNldCB0byB0cnVlLlxyXG4gKiAgIC0gYHByZXNlcnZlU2NvcGVgIC0gYHtib29sZWFuPX1gOiB3aGV0aGVyIHRvIHByZXNlcnZlIHRoZSBzY29wZSB3aGVuIHRoZSBlbGVtZW50IGlzIHJlbW92ZWQuIERlZmF1bHQgaXMgZmFsc2VcclxuICogICAtIGBkaXNhYmxlUGFyZW50U2Nyb2xsYCAtIGB7Ym9vbGVhbj19YDogV2hldGhlciB0byBkaXNhYmxlIHNjcm9sbGluZyB3aGlsZSB0aGUgZGlhbG9nIGlzIG9wZW4uXHJcbiAqICAgICBEZWZhdWx0IHRydWUuXHJcbiAqICAgLSBgaGFzQmFja2Ryb3BgIC0gYHtib29sZWFuPX1gOiBXaGV0aGVyIHRoZXJlIHNob3VsZCBiZSBhbiBvcGFxdWUgYmFja2Ryb3AgYmVoaW5kIHRoZSBkaWFsb2cuXHJcbiAqICAgICBEZWZhdWx0IHRydWUuXHJcbiAqICAgLSBgY2xpY2tPdXRzaWRlVG9DbG9zZWAgLSBge2Jvb2xlYW49fWA6IFdoZXRoZXIgdGhlIHVzZXIgY2FuIGNsaWNrIG91dHNpZGUgdGhlIGRpYWxvZyB0b1xyXG4gKiAgICAgY2xvc2UgaXQuIERlZmF1bHQgZmFsc2UuXHJcbiAqICAgLSBgZXNjYXBlVG9DbG9zZWAgLSBge2Jvb2xlYW49fWA6IFdoZXRoZXIgdGhlIHVzZXIgY2FuIHByZXNzIGVzY2FwZSB0byBjbG9zZSB0aGUgZGlhbG9nLlxyXG4gKiAgICAgRGVmYXVsdCB0cnVlLlxyXG4gKiAgIC0gYGZvY3VzT25PcGVuYCAtIGB7Ym9vbGVhbj19YDogQW4gb3B0aW9uIHRvIG92ZXJyaWRlIGZvY3VzIGJlaGF2aW9yIG9uIG9wZW4uIE9ubHkgZGlzYWJsZSBpZlxyXG4gKiAgICAgZm9jdXNpbmcgc29tZSBvdGhlciB3YXksIGFzIGZvY3VzIG1hbmFnZW1lbnQgaXMgcmVxdWlyZWQgZm9yIGRpYWxvZ3MgdG8gYmUgYWNjZXNzaWJsZS5cclxuICogICAgIERlZmF1bHRzIHRvIHRydWUuXHJcbiAqICAgLSBgY29udHJvbGxlcmAgLSBge3N0cmluZz19YDogVGhlIGNvbnRyb2xsZXIgdG8gYXNzb2NpYXRlIHdpdGggdGhlIGRpYWxvZy4gVGhlIGNvbnRyb2xsZXJcclxuICogICAgIHdpbGwgYmUgaW5qZWN0ZWQgd2l0aCB0aGUgbG9jYWwgYCRtZERpYWxvZ2AsIHdoaWNoIHBhc3NlcyBhbG9uZyBhIHNjb3BlIGZvciB0aGUgZGlhbG9nLlxyXG4gKiAgIC0gYGxvY2Fsc2AgLSBge29iamVjdD19YDogQW4gb2JqZWN0IGNvbnRhaW5pbmcga2V5L3ZhbHVlIHBhaXJzLiBUaGUga2V5cyB3aWxsIGJlIHVzZWQgYXMgbmFtZXNcclxuICogICAgIG9mIHZhbHVlcyB0byBpbmplY3QgaW50byB0aGUgY29udHJvbGxlci4gRm9yIGV4YW1wbGUsIGBsb2NhbHM6IHt0aHJlZTogM31gIHdvdWxkIGluamVjdFxyXG4gKiAgICAgYHRocmVlYCBpbnRvIHRoZSBjb250cm9sbGVyLCB3aXRoIHRoZSB2YWx1ZSAzLiBJZiBgYmluZFRvQ29udHJvbGxlcmAgaXMgdHJ1ZSwgdGhleSB3aWxsIGJlXHJcbiAqICAgICBjb3BpZWQgdG8gdGhlIGNvbnRyb2xsZXIgaW5zdGVhZC5cclxuICogICAtIGBiaW5kVG9Db250cm9sbGVyYCAtIGBib29sYDogYmluZCB0aGUgbG9jYWxzIHRvIHRoZSBjb250cm9sbGVyLCBpbnN0ZWFkIG9mIHBhc3NpbmcgdGhlbSBpbi5cclxuICogICAgIFRoZXNlIHZhbHVlcyB3aWxsIG5vdCBiZSBhdmFpbGFibGUgdW50aWwgYWZ0ZXIgaW5pdGlhbGl6YXRpb24uXHJcbiAqICAgLSBgcmVzb2x2ZWAgLSBge29iamVjdD19YDogU2ltaWxhciB0byBsb2NhbHMsIGV4Y2VwdCBpdCB0YWtlcyBwcm9taXNlcyBhcyB2YWx1ZXMsIGFuZCB0aGVcclxuICogICAgIGRpYWxvZyB3aWxsIG5vdCBvcGVuIHVudGlsIGFsbCBvZiB0aGUgcHJvbWlzZXMgcmVzb2x2ZS5cclxuICogICAtIGBjb250cm9sbGVyQXNgIC0gYHtzdHJpbmc9fWA6IEFuIGFsaWFzIHRvIGFzc2lnbiB0aGUgY29udHJvbGxlciB0byBvbiB0aGUgc2NvcGUuXHJcbiAqICAgLSBgcGFyZW50YCAtIGB7ZWxlbWVudD19YDogVGhlIGVsZW1lbnQgdG8gYXBwZW5kIHRoZSBkaWFsb2cgdG8uIERlZmF1bHRzIHRvIGFwcGVuZGluZ1xyXG4gKiAgICAgdG8gdGhlIHJvb3QgZWxlbWVudCBvZiB0aGUgYXBwbGljYXRpb24uXHJcbiAqICAgLSBgb25Db21wbGV0ZWAgYHtmdW5jdGlvbj19YDogQ2FsbGJhY2sgZnVuY3Rpb24gdXNlZCB0byBhbm5vdW5jZSB3aGVuIHRoZSBzaG93KCkgYWN0aW9uIGlzXHJcbiAqICAgICBmaW5pc2hlZC5cclxuICpcclxuICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IGNhbiBiZSByZXNvbHZlZCB3aXRoIGAkbWREaWFsb2cuaGlkZSgpYCBvclxyXG4gKiByZWplY3RlZCB3aXRoIGAkbWREaWFsb2cuY2FuY2VsKClgLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZERpYWxvZyNoaWRlXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBIaWRlIGFuIGV4aXN0aW5nIGRpYWxvZyBhbmQgcmVzb2x2ZSB0aGUgcHJvbWlzZSByZXR1cm5lZCBmcm9tIGAkbWREaWFsb2cuc2hvdygpYC5cclxuICpcclxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZXNvbHZlZCBwcm9taXNlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgZGlhbG9nIGhhcyBiZWVuIGNsb3NlZC5cclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWREaWFsb2cjY2FuY2VsXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBIaWRlIGFuIGV4aXN0aW5nIGRpYWxvZyBhbmQgcmVqZWN0IHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYCRtZERpYWxvZy5zaG93KClgLlxyXG4gKlxyXG4gKiBAcGFyYW0geyo9fSByZXNwb25zZSBBbiBhcmd1bWVudCBmb3IgdGhlIHJlamVjdGVkIHByb21pc2UuXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtwcm9taXNlfSBBIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCB3aGVuIHRoZSBkaWFsb2cgaGFzIGJlZW4gY2xvc2VkLlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIE1kRGlhbG9nUHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XHJcblxyXG4gIHZhciBhbGVydERpYWxvZ01ldGhvZHMgPSBbJ3RpdGxlJywgJ2NvbnRlbnQnLCAnYXJpYUxhYmVsJywgJ29rJ107XHJcblxyXG4gIGFkdmFuY2VkRGlhbG9nT3B0aW9ucy4kaW5qZWN0ID0gW1wiJG1kRGlhbG9nXCIsIFwiJG1kVGhlbWluZ1wiXTtcclxuICBkaWFsb2dEZWZhdWx0T3B0aW9ucy4kaW5qZWN0ID0gW1wiJG1kQXJpYVwiLCBcIiRkb2N1bWVudFwiLCBcIiRtZFV0aWxcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkbWREaWFsb2dcIiwgXCIkdGltZW91dFwiLCBcIiRyb290RWxlbWVudFwiLCBcIiRhbmltYXRlXCIsIFwiJCRyQUZcIiwgXCIkcVwiXTtcclxuICByZXR1cm4gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWREaWFsb2cnKVxyXG4gICAgLnNldERlZmF1bHRzKHtcclxuICAgICAgbWV0aG9kczogWydkaXNhYmxlUGFyZW50U2Nyb2xsJywgJ2hhc0JhY2tkcm9wJywgJ2NsaWNrT3V0c2lkZVRvQ2xvc2UnLCAnZXNjYXBlVG9DbG9zZScsICd0YXJnZXRFdmVudCcsICdwYXJlbnQnXSxcclxuICAgICAgb3B0aW9uczogZGlhbG9nRGVmYXVsdE9wdGlvbnNcclxuICAgIH0pXHJcbiAgICAuYWRkUHJlc2V0KCdhbGVydCcsIHtcclxuICAgICAgbWV0aG9kczogWyd0aXRsZScsICdjb250ZW50JywgJ2FyaWFMYWJlbCcsICdvaycsICd0aGVtZSddLFxyXG4gICAgICBvcHRpb25zOiBhZHZhbmNlZERpYWxvZ09wdGlvbnNcclxuICAgIH0pXHJcbiAgICAuYWRkUHJlc2V0KCdjb25maXJtJywge1xyXG4gICAgICBtZXRob2RzOiBbJ3RpdGxlJywgJ2NvbnRlbnQnLCAnYXJpYUxhYmVsJywgJ29rJywgJ2NhbmNlbCcsICd0aGVtZSddLFxyXG4gICAgICBvcHRpb25zOiBhZHZhbmNlZERpYWxvZ09wdGlvbnNcclxuICAgIH0pO1xyXG5cclxuICAvKiBAbmdJbmplY3QgKi9cclxuICBmdW5jdGlvbiBhZHZhbmNlZERpYWxvZ09wdGlvbnMoJG1kRGlhbG9nLCAkbWRUaGVtaW5nKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0ZW1wbGF0ZTogW1xyXG4gICAgICAgICc8bWQtZGlhbG9nIG1kLXRoZW1lPVwie3sgZGlhbG9nLnRoZW1lIH19XCIgYXJpYS1sYWJlbD1cInt7IGRpYWxvZy5hcmlhTGFiZWwgfX1cIj4nLFxyXG4gICAgICAgICAgJzxtZC1kaWFsb2ctY29udGVudCByb2xlPVwiZG9jdW1lbnRcIiB0YWJJbmRleD1cIi0xXCI+JyxcclxuICAgICAgICAgICAgJzxoMiBjbGFzcz1cIm1kLXRpdGxlXCI+e3sgZGlhbG9nLnRpdGxlIH19PC9oMj4nLFxyXG4gICAgICAgICAgICAnPHA+e3sgZGlhbG9nLmNvbnRlbnQgfX08L3A+JyxcclxuICAgICAgICAgICc8L21kLWRpYWxvZy1jb250ZW50PicsXHJcbiAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWFjdGlvbnNcIj4nLFxyXG4gICAgICAgICAgICAnPG1kLWJ1dHRvbiBuZy1pZj1cImRpYWxvZy4kdHlwZSA9PSBcXCdjb25maXJtXFwnXCInICtcclxuICAgICAgICAgICAgICAgICAgICAgICcgbmctY2xpY2s9XCJkaWFsb2cuYWJvcnQoKVwiIGNsYXNzPVwibWQtcHJpbWFyeVwiPicsXHJcbiAgICAgICAgICAgICAgJ3t7IGRpYWxvZy5jYW5jZWwgfX0nLFxyXG4gICAgICAgICAgICAnPC9tZC1idXR0b24+JyxcclxuICAgICAgICAgICAgJzxtZC1idXR0b24gbmctY2xpY2s9XCJkaWFsb2cuaGlkZSgpXCIgY2xhc3M9XCJtZC1wcmltYXJ5XCI+JyxcclxuICAgICAgICAgICAgICAne3sgZGlhbG9nLm9rIH19JyxcclxuICAgICAgICAgICAgJzwvbWQtYnV0dG9uPicsXHJcbiAgICAgICAgICAnPC9kaXY+JyxcclxuICAgICAgICAnPC9tZC1kaWFsb2c+J1xyXG4gICAgICBdLmpvaW4oJycpLFxyXG4gICAgICBjb250cm9sbGVyOiBmdW5jdGlvbiBtZERpYWxvZ0N0cmwoKSB7XHJcbiAgICAgICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAkbWREaWFsb2cuaGlkZSh0cnVlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYWJvcnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9LFxyXG4gICAgICBjb250cm9sbGVyQXM6ICdkaWFsb2cnLFxyXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxyXG4gICAgICB0aGVtZTogJG1kVGhlbWluZy5kZWZhdWx0VGhlbWUoKVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIGRpYWxvZ0RlZmF1bHRPcHRpb25zKCRtZEFyaWEsICRkb2N1bWVudCwgJG1kVXRpbCwgJG1kQ29uc3RhbnQsICRtZFRoZW1pbmcsICRtZERpYWxvZywgJHRpbWVvdXQsICRyb290RWxlbWVudCwgJGFuaW1hdGUsICQkckFGLCAkcSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXHJcbiAgICAgIGlzb2xhdGVTY29wZTogdHJ1ZSxcclxuICAgICAgb25TaG93OiBvblNob3csXHJcbiAgICAgIG9uUmVtb3ZlOiBvblJlbW92ZSxcclxuICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogZmFsc2UsXHJcbiAgICAgIGVzY2FwZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgIHRhcmdldEV2ZW50OiBudWxsLFxyXG4gICAgICBmb2N1c09uT3BlbjogdHJ1ZSxcclxuICAgICAgZGlzYWJsZVBhcmVudFNjcm9sbDogdHJ1ZSxcclxuICAgICAgdHJhbnNmb3JtVGVtcGxhdGU6IGZ1bmN0aW9uKHRlbXBsYXRlKSB7XHJcbiAgICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPVwibWQtZGlhbG9nLWNvbnRhaW5lclwiPicgKyB0ZW1wbGF0ZSArICc8L2Rpdj4nO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHRyYXBGb2N1cyhldikge1xyXG4gICAgICB2YXIgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWQtZGlhbG9nJyk7XHJcblxyXG4gICAgICBpZiAoZGlhbG9nICYmICFkaWFsb2cuY29udGFpbnMoZXYudGFyZ2V0KSkge1xyXG4gICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIGRpYWxvZy5mb2N1cygpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gT24gc2hvdyBtZXRob2QgZm9yIGRpYWxvZ3NcclxuICAgIGZ1bmN0aW9uIG9uU2hvdyhzY29wZSwgZWxlbWVudCwgb3B0aW9ucykge1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJGRvY3VtZW50WzBdLmJvZHkpLmFkZENsYXNzKCdtZC1kaWFsb2ctaXMtc2hvd2luZycpO1xyXG4gICAgICBlbGVtZW50ID0gJG1kVXRpbC5leHRyYWN0RWxlbWVudEJ5TmFtZShlbGVtZW50LCAnbWQtZGlhbG9nJyk7XHJcblxyXG4gICAgICAvLyBJbmNhc2UgdGhlIHVzZXIgcHJvdmlkZXMgYSByYXcgZG9tIGVsZW1lbnQsIGFsd2F5cyB3cmFwIGl0IGluIGpxTGl0ZVxyXG4gICAgICBvcHRpb25zLnBhcmVudCA9IGFuZ3VsYXIuZWxlbWVudChvcHRpb25zLnBhcmVudCk7XHJcblxyXG4gICAgICBvcHRpb25zLnBvcEluVGFyZ2V0ID0gYW5ndWxhci5lbGVtZW50KChvcHRpb25zLnRhcmdldEV2ZW50IHx8IHt9KS50YXJnZXQpO1xyXG4gICAgICB2YXIgY2xvc2VCdXR0b24gPSBmaW5kQ2xvc2VCdXR0b24oKTtcclxuXHJcbiAgICAgIGlmIChvcHRpb25zLmhhc0JhY2tkcm9wKSB7XHJcbiAgICAgICAgLy8gRml4IGZvciBJRSAxMFxyXG4gICAgICAgIHZhciBjb21wdXRlRnJvbSA9IChvcHRpb25zLnBhcmVudFswXSA9PSAkZG9jdW1lbnRbMF0uYm9keSAmJiAkZG9jdW1lbnRbMF0uZG9jdW1lbnRFbGVtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICYmICRkb2N1bWVudFswXS5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wKSA/IGFuZ3VsYXIuZWxlbWVudCgkZG9jdW1lbnRbMF0uZG9jdW1lbnRFbGVtZW50KSA6IG9wdGlvbnMucGFyZW50O1xyXG4gICAgICAgIHZhciBwYXJlbnRPZmZzZXQgPSBjb21wdXRlRnJvbS5wcm9wKCdzY3JvbGxUb3AnKTtcclxuICAgICAgICBvcHRpb25zLmJhY2tkcm9wID0gYW5ndWxhci5lbGVtZW50KCc8bWQtYmFja2Ryb3AgY2xhc3M9XCJtZC1kaWFsb2ctYmFja2Ryb3AgbWQtb3BhcXVlXCI+Jyk7XHJcbiAgICAgICAgb3B0aW9ucy5iYWNrZHJvcC5jc3MoJ3RvcCcsIHBhcmVudE9mZnNldCArJ3B4Jyk7XHJcbiAgICAgICAgJG1kVGhlbWluZy5pbmhlcml0KG9wdGlvbnMuYmFja2Ryb3AsIG9wdGlvbnMucGFyZW50KTtcclxuICAgICAgICAkYW5pbWF0ZS5lbnRlcihvcHRpb25zLmJhY2tkcm9wLCBvcHRpb25zLnBhcmVudCk7XHJcbiAgICAgICAgZWxlbWVudC5jc3MoJ3RvcCcsIHBhcmVudE9mZnNldCArJ3B4Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciByb2xlID0gJ2RpYWxvZycsXHJcbiAgICAgICAgICBlbGVtZW50VG9Gb2N1cyA9IGNsb3NlQnV0dG9uO1xyXG5cclxuICAgICAgaWYgKG9wdGlvbnMuJHR5cGUgPT09ICdhbGVydCcpIHtcclxuICAgICAgICByb2xlID0gJ2FsZXJ0ZGlhbG9nJztcclxuICAgICAgICBlbGVtZW50VG9Gb2N1cyA9IGVsZW1lbnQuZmluZCgnbWQtZGlhbG9nLWNvbnRlbnQnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uZmlndXJlQXJpYShlbGVtZW50LmZpbmQoJ21kLWRpYWxvZycpLCByb2xlLCBvcHRpb25zKTtcclxuXHJcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdHJhcEZvY3VzLCB0cnVlKTtcclxuXHJcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcclxuICAgICAgICBvcHRpb25zLmxhc3RPdmVyZmxvdyA9IG9wdGlvbnMucGFyZW50LmNzcygnb3ZlcmZsb3cnKTtcclxuICAgICAgICBvcHRpb25zLnBhcmVudC5jc3MoJ292ZXJmbG93JywgJ2hpZGRlbicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gZGlhbG9nUG9wSW4oXHJcbiAgICAgICAgZWxlbWVudCxcclxuICAgICAgICBvcHRpb25zLnBhcmVudCxcclxuICAgICAgICBvcHRpb25zLnBvcEluVGFyZ2V0ICYmIG9wdGlvbnMucG9wSW5UYXJnZXQubGVuZ3RoICYmIG9wdGlvbnMucG9wSW5UYXJnZXRcclxuICAgICAgKVxyXG4gICAgICAudGhlbihmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgYXBwbHlBcmlhVG9TaWJsaW5ncyhlbGVtZW50LCB0cnVlKTtcclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuZXNjYXBlVG9DbG9zZSkge1xyXG4gICAgICAgICAgb3B0aW9ucy5yb290RWxlbWVudEtleXVwQ2FsbGJhY2sgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09ICRtZENvbnN0YW50LktFWV9DT0RFLkVTQ0FQRSkge1xyXG4gICAgICAgICAgICAgICR0aW1lb3V0KCRtZERpYWxvZy5jYW5jZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgJHJvb3RFbGVtZW50Lm9uKCdrZXl1cCcsIG9wdGlvbnMucm9vdEVsZW1lbnRLZXl1cENhbGxiYWNrKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChvcHRpb25zLmNsaWNrT3V0c2lkZVRvQ2xvc2UpIHtcclxuICAgICAgICAgIG9wdGlvbnMuZGlhbG9nQ2xpY2tPdXRzaWRlQ2FsbGJhY2sgPSBmdW5jdGlvbihldikge1xyXG4gICAgICAgICAgICAvLyBPbmx5IGNsb3NlIGlmIHdlIGNsaWNrIHRoZSBmbGV4IGNvbnRhaW5lciBvdXRzaWRlIHRoZSBiYWNrZHJvcFxyXG4gICAgICAgICAgICBpZiAoZXYudGFyZ2V0ID09PSBlbGVtZW50WzBdKSB7XHJcbiAgICAgICAgICAgICAgJHRpbWVvdXQoJG1kRGlhbG9nLmNhbmNlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIG9wdGlvbnMuZGlhbG9nQ2xpY2tPdXRzaWRlQ2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuZm9jdXNPbk9wZW4pIHtcclxuICAgICAgICAgIGVsZW1lbnRUb0ZvY3VzLmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcblxyXG4gICAgICBmdW5jdGlvbiBmaW5kQ2xvc2VCdXR0b24oKSB7XHJcbiAgICAgICAgLy9JZiBubyBlbGVtZW50IHdpdGggY2xhc3MgZGlhbG9nLWNsb3NlLCB0cnkgdG8gZmluZCB0aGUgbGFzdFxyXG4gICAgICAgIC8vYnV0dG9uIGNoaWxkIGluIG1kLWFjdGlvbnMgYW5kIGFzc3VtZSBpdCBpcyBhIGNsb3NlIGJ1dHRvblxyXG4gICAgICAgIHZhciBjbG9zZUJ1dHRvbiA9IGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLmRpYWxvZy1jbG9zZScpO1xyXG4gICAgICAgIGlmICghY2xvc2VCdXR0b24pIHtcclxuICAgICAgICAgIHZhciBhY3Rpb25CdXR0b25zID0gZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yQWxsKCcubWQtYWN0aW9ucyBidXR0b24nKTtcclxuICAgICAgICAgIGNsb3NlQnV0dG9uID0gYWN0aW9uQnV0dG9uc1sgYWN0aW9uQnV0dG9ucy5sZW5ndGggLSAxIF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhbmd1bGFyLmVsZW1lbnQoY2xvc2VCdXR0b24pO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vIE9uIHJlbW92ZSBmdW5jdGlvbiBmb3IgYWxsIGRpYWxvZ3NcclxuICAgIGZ1bmN0aW9uIG9uUmVtb3ZlKHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkZG9jdW1lbnRbMF0uYm9keSkucmVtb3ZlQ2xhc3MoJ21kLWRpYWxvZy1pcy1zaG93aW5nJyk7XHJcblxyXG4gICAgICBpZiAob3B0aW9ucy5iYWNrZHJvcCkge1xyXG4gICAgICAgICRhbmltYXRlLmxlYXZlKG9wdGlvbnMuYmFja2Ryb3ApO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcclxuICAgICAgICBvcHRpb25zLnBhcmVudC5jc3MoJ292ZXJmbG93Jywgb3B0aW9ucy5sYXN0T3ZlcmZsb3cpO1xyXG4gICAgICAgIGRlbGV0ZSBvcHRpb25zLmxhc3RPdmVyZmxvdztcclxuICAgICAgfVxyXG4gICAgICBpZiAob3B0aW9ucy5lc2NhcGVUb0Nsb3NlKSB7XHJcbiAgICAgICAgJHJvb3RFbGVtZW50Lm9mZigna2V5dXAnLCBvcHRpb25zLnJvb3RFbGVtZW50S2V5dXBDYWxsYmFjayk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG9wdGlvbnMuY2xpY2tPdXRzaWRlVG9DbG9zZSkge1xyXG4gICAgICAgIGVsZW1lbnQub2ZmKCdjbGljaycsIG9wdGlvbnMuZGlhbG9nQ2xpY2tPdXRzaWRlQ2FsbGJhY2spO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhcHBseUFyaWFUb1NpYmxpbmdzKGVsZW1lbnQsIGZhbHNlKTtcclxuXHJcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdHJhcEZvY3VzLCB0cnVlKTtcclxuXHJcbiAgICAgIHJldHVybiBkaWFsb2dQb3BPdXQoXHJcbiAgICAgICAgZWxlbWVudCxcclxuICAgICAgICBvcHRpb25zLnBhcmVudCxcclxuICAgICAgICBvcHRpb25zLnBvcEluVGFyZ2V0ICYmIG9wdGlvbnMucG9wSW5UYXJnZXQubGVuZ3RoICYmIG9wdGlvbnMucG9wSW5UYXJnZXRcclxuICAgICAgKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgb3B0aW9ucy5wb3BJblRhcmdldCAmJiBvcHRpb25zLnBvcEluVGFyZ2V0LmZvY3VzKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEluamVjdCBBUklBLXNwZWNpZmljIGF0dHJpYnV0ZXMgYXBwcm9wcmlhdGUgZm9yIERpYWxvZ3NcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY29uZmlndXJlQXJpYShlbGVtZW50LCByb2xlLCBvcHRpb25zKSB7XHJcblxyXG4gICAgICBlbGVtZW50LmF0dHIoe1xyXG4gICAgICAgICdyb2xlJzogcm9sZSxcclxuICAgICAgICAndGFiSW5kZXgnOiAnLTEnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIGRpYWxvZ0NvbnRlbnQgPSBlbGVtZW50LmZpbmQoJ21kLWRpYWxvZy1jb250ZW50Jyk7XHJcbiAgICAgIGlmIChkaWFsb2dDb250ZW50Lmxlbmd0aCA9PT0gMCl7XHJcbiAgICAgICAgZGlhbG9nQ29udGVudCA9IGVsZW1lbnQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBkaWFsb2dJZCA9IGVsZW1lbnQuYXR0cignaWQnKSB8fCAoJ2RpYWxvZ18nICsgJG1kVXRpbC5uZXh0VWlkKCkpO1xyXG4gICAgICBkaWFsb2dDb250ZW50LmF0dHIoJ2lkJywgZGlhbG9nSWQpO1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtZGVzY3JpYmVkYnknLCBkaWFsb2dJZCk7XHJcblxyXG4gICAgICBpZiAob3B0aW9ucy5hcmlhTGFiZWwpIHtcclxuICAgICAgICAkbWRBcmlhLmV4cGVjdChlbGVtZW50LCAnYXJpYS1sYWJlbCcsIG9wdGlvbnMuYXJpYUxhYmVsKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAkbWRBcmlhLmV4cGVjdEFzeW5jKGVsZW1lbnQsICdhcmlhLWxhYmVsJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICB2YXIgd29yZHMgPSBkaWFsb2dDb250ZW50LnRleHQoKS5zcGxpdCgvXFxzKy8pO1xyXG4gICAgICAgICAgaWYgKHdvcmRzLmxlbmd0aCA+IDMpIHdvcmRzID0gd29yZHMuc2xpY2UoMCwzKS5jb25jYXQoJy4uLicpO1xyXG4gICAgICAgICAgcmV0dXJuIHdvcmRzLmpvaW4oJyAnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGZpbHRlciBvdXQgcmF3IERPTSBub2Rlc1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBpc05vZGVPbmVPZihlbGVtLCBub2RlVHlwZUFycmF5KSB7XHJcbiAgICAgIGlmIChub2RlVHlwZUFycmF5LmluZGV4T2YoZWxlbS5ub2RlTmFtZSkgIT09IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogV2FsayBET00gdG8gYXBwbHkgb3IgcmVtb3ZlIGFyaWEtaGlkZGVuIG9uIHNpYmxpbmcgbm9kZXNcclxuICAgICAqIGFuZCBwYXJlbnQgc2libGluZyBub2Rlc1xyXG4gICAgICpcclxuICAgICAqIFByZXZlbnRzIHNjcmVlbiByZWFkZXIgaW50ZXJhY3Rpb24gYmVoaW5kIG1vZGFsIHdpbmRvd1xyXG4gICAgICogb24gc3dpcGUgaW50ZXJmYWNlc1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhcHBseUFyaWFUb1NpYmxpbmdzKGVsZW1lbnQsIHZhbHVlKSB7XHJcbiAgICAgIHZhciBhdHRyaWJ1dGUgPSAnYXJpYS1oaWRkZW4nO1xyXG5cclxuICAgICAgLy8gZ2V0IHJhdyBET00gbm9kZVxyXG4gICAgICBlbGVtZW50ID0gZWxlbWVudFswXTtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIHdhbGtET00oZWxlbWVudCkge1xyXG4gICAgICAgIHdoaWxlIChlbGVtZW50LnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgIGlmIChlbGVtZW50ID09PSBkb2N1bWVudC5ib2R5KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHZhciBjaGlsZHJlbiA9IGVsZW1lbnQucGFyZW50Tm9kZS5jaGlsZHJlbjtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgLy8gc2tpcCBvdmVyIGNoaWxkIGlmIGl0IGlzIGFuIGFzY2VuZGFudCBvZiB0aGUgZGlhbG9nXHJcbiAgICAgICAgICAgIC8vIG9yIGEgc2NyaXB0IG9yIHN0eWxlIHRhZ1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudCAhPT0gY2hpbGRyZW5baV0gJiYgIWlzTm9kZU9uZU9mKGNoaWxkcmVuW2ldLCBbJ1NDUklQVCcsICdTVFlMRSddKSkge1xyXG4gICAgICAgICAgICAgIGNoaWxkcmVuW2ldLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHdhbGtET00oZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHdhbGtET00oZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZGlhbG9nUG9wSW4oY29udGFpbmVyLCBwYXJlbnRFbGVtZW50LCBjbGlja0VsZW1lbnQpIHtcclxuICAgICAgdmFyIGRpYWxvZ0VsID0gY29udGFpbmVyLmZpbmQoJ21kLWRpYWxvZycpO1xyXG5cclxuICAgICAgcGFyZW50RWxlbWVudC5hcHBlbmQoY29udGFpbmVyKTtcclxuICAgICAgdHJhbnNmb3JtVG9DbGlja0VsZW1lbnQoZGlhbG9nRWwsIGNsaWNrRWxlbWVudCk7XHJcblxyXG4gICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICBkaWFsb2dFbC5hZGRDbGFzcygndHJhbnNpdGlvbi1pbicpXHJcbiAgICAgICAgICAuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sICcnKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gJG1kVXRpbC50cmFuc2l0aW9uRW5kUHJvbWlzZShkaWFsb2dFbCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZGlhbG9nUG9wT3V0KGNvbnRhaW5lciwgcGFyZW50RWxlbWVudCwgY2xpY2tFbGVtZW50KSB7XHJcbiAgICAgIHZhciBkaWFsb2dFbCA9IGNvbnRhaW5lci5maW5kKCdtZC1kaWFsb2cnKTtcclxuXHJcbiAgICAgIGRpYWxvZ0VsLmFkZENsYXNzKCd0cmFuc2l0aW9uLW91dCcpLnJlbW92ZUNsYXNzKCd0cmFuc2l0aW9uLWluJyk7XHJcbiAgICAgIHRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50KGRpYWxvZ0VsLCBjbGlja0VsZW1lbnQpO1xyXG5cclxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2UoZGlhbG9nRWwpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50KGRpYWxvZ0VsLCBjbGlja0VsZW1lbnQpIHtcclxuICAgICAgaWYgKGNsaWNrRWxlbWVudCkge1xyXG4gICAgICAgIHZhciBjbGlja1JlY3QgPSBjbGlja0VsZW1lbnRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdmFyIGRpYWxvZ1JlY3QgPSBkaWFsb2dFbFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgdmFyIHNjYWxlWCA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LndpZHRoIC8gZGlhbG9nUmVjdC53aWR0aCk7XHJcbiAgICAgICAgdmFyIHNjYWxlWSA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LmhlaWdodCAvIGRpYWxvZ1JlY3QuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgZGlhbG9nRWwuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sICd0cmFuc2xhdGUzZCgnICtcclxuICAgICAgICAgICgtZGlhbG9nUmVjdC5sZWZ0ICsgY2xpY2tSZWN0LmxlZnQgKyBjbGlja1JlY3Qud2lkdGgvMiAtIGRpYWxvZ1JlY3Qud2lkdGgvMikgKyAncHgsJyArXHJcbiAgICAgICAgICAoLWRpYWxvZ1JlY3QudG9wICsgY2xpY2tSZWN0LnRvcCArIGNsaWNrUmVjdC5oZWlnaHQvMiAtIGRpYWxvZ1JlY3QuaGVpZ2h0LzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgJzApIHNjYWxlKCcgKyBzY2FsZVggKyAnLCcgKyBzY2FsZVkgKyAnKSdcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZGlhbG9nVHJhbnNpdGlvbkVuZChkaWFsb2dFbCkge1xyXG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG4gICAgICBkaWFsb2dFbC5vbigkbWRDb25zdGFudC5DU1MuVFJBTlNJVElPTkVORCwgZmluaXNoZWQpO1xyXG4gICAgICBmdW5jdGlvbiBmaW5pc2hlZChldikge1xyXG4gICAgICAgIC8vTWFrZSBzdXJlIHRoaXMgdHJhbnNpdGlvbmVuZCBkaWRuJ3QgYnViYmxlIHVwIGZyb20gYSBjaGlsZFxyXG4gICAgICAgIGlmIChldi50YXJnZXQgPT09IGRpYWxvZ0VsWzBdKSB7XHJcbiAgICAgICAgICBkaWFsb2dFbC5vZmYoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TSVRJT05FTkQsIGZpbmlzaGVkKTtcclxuICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcbiAgICB9XHJcblxyXG4gIH1cclxufVxyXG5NZERpYWxvZ1Byb3ZpZGVyLiRpbmplY3QgPSBbXCIkJGludGVyaW1FbGVtZW50UHJvdmlkZXJcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmRpdmlkZXJcclxuICogQGRlc2NyaXB0aW9uIERpdmlkZXIgbW9kdWxlIVxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZGl2aWRlcicsIFtcclxuICAnbWF0ZXJpYWwuY29yZSdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZERpdmlkZXInLCBNZERpdmlkZXJEaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWREaXZpZGVyXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5kaXZpZGVyXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBEaXZpZGVycyBncm91cCBhbmQgc2VwYXJhdGUgY29udGVudCB3aXRoaW4gbGlzdHMgYW5kIHBhZ2UgbGF5b3V0cyB1c2luZyBzdHJvbmcgdmlzdWFsIGFuZCBzcGF0aWFsIGRpc3RpbmN0aW9ucy4gVGhpcyBkaXZpZGVyIGlzIGEgdGhpbiBydWxlLCBsaWdodHdlaWdodCBlbm91Z2ggdG8gbm90IGRpc3RyYWN0IHRoZSB1c2VyIGZyb20gY29udGVudC5cclxuICpcclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtaW5zZXQgQWRkIHRoaXMgYXR0cmlidXRlIHRvIGFjdGl2YXRlIHRoZSBpbnNldCBkaXZpZGVyIHN0eWxlLlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLWRpdmlkZXI+PC9tZC1kaXZpZGVyPlxyXG4gKlxyXG4gKiA8bWQtZGl2aWRlciBtZC1pbnNldD48L21kLWRpdmlkZXI+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uIE1kRGl2aWRlckRpcmVjdGl2ZSgkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBsaW5rOiAkbWRUaGVtaW5nXHJcbiAgfTtcclxufVxyXG5NZERpdmlkZXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmZhYkFjdGlvbnMnLCBbJ21hdGVyaWFsLmNvcmUnXSlcclxuICAgIC5kaXJlY3RpdmUoJ21kRmFiQWN0aW9ucycsIE1kRmFiQWN0aW9uc0RpcmVjdGl2ZSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICAgKiBAbmFtZSBtZEZhYkFjdGlvbnNcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuZmFiU3BlZWREaWFsXHJcbiAgICpcclxuICAgKiBAcmVzdHJpY3QgRVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogVGhlIGA8bWQtZmFiLWFjdGlvbnM+YCBkaXJlY3RpdmUgaXMgdXNlZCBpbnNpZGUgb2YgYSBgPG1kLWZhYi1zcGVlZC1kaWFsPmAgb3JcclxuICAgKiBgPG1kLWZhYi10b29sYmFyPmAgZGlyZWN0aXZlIHRvIG1hcmsgdGhlIGFuIGVsZW1lbnQgKG9yIGVsZW1lbnRzKSBhcyB0aGUgYWN0aW9ucyBhbmQgc2V0dXAgdGhlXHJcbiAgICogcHJvcGVyIGV2ZW50IGxpc3RlbmVycy5cclxuICAgKlxyXG4gICAqIEB1c2FnZVxyXG4gICAqIFNlZSB0aGUgYDxtZC1mYWItc3BlZWQtZGlhbD5gIG9yIGA8bWQtZmFiLXRvb2xiYXI+YCBkaXJlY3RpdmVzIGZvciBleGFtcGxlIHVzYWdlLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIE1kRmFiQWN0aW9uc0RpcmVjdGl2ZSgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlc3RyaWN0OiAnRScsXHJcblxyXG4gICAgICByZXF1aXJlOiBbJ14/bWRGYWJTcGVlZERpYWwnLCAnXj9tZEZhYlRvb2xiYXInXSxcclxuXHJcbiAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyaWJ1dGVzLCBjb250cm9sbGVycykge1xyXG4gICAgICAgIC8vIEdyYWIgd2hpY2hldmVyIHBhcmVudCBjb250cm9sbGVyIGlzIHVzZWRcclxuICAgICAgICB2YXIgY29udHJvbGxlciA9IGNvbnRyb2xsZXJzWzBdIHx8IGNvbnRyb2xsZXJzWzFdO1xyXG5cclxuICAgICAgICAvLyBNYWtlIHRoZSBjaGlsZHJlbiBvcGVuL2Nsb3NlIHRoZWlyIHBhcmVudCBkaXJlY3RpdmVcclxuICAgICAgICBpZiAoY29udHJvbGxlcikge1xyXG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGVsZW1lbnQuY2hpbGRyZW4oKSwgZnVuY3Rpb24oY2hpbGQpIHtcclxuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGNoaWxkKS5vbignZm9jdXMnLCBjb250cm9sbGVyLm9wZW4pO1xyXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoY2hpbGQpLm9uKCdibHVyJywgY29udHJvbGxlci5jbG9zZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFmdGVyIHNldHRpbmcgdXAgdGhlIGxpc3RlbmVycywgd3JhcCBldmVyeSBjaGlsZCBpbiBhIG5ldyBkaXYgYW5kIGFkZCBhIGNsYXNzIHRoYXQgd2UgY2FuXHJcbiAgICAgICAgLy8gc2NhbGUvZmxpbmcgaW5kZXBlbmRlbnRseVxyXG4gICAgICAgIGVsZW1lbnQuY2hpbGRyZW4oKS53cmFwKCc8ZGl2IGNsYXNzPVwibWQtZmFiLWFjdGlvbi1pdGVtXCI+Jyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG59KSgpO1xyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmZhYlNwZWVkRGlhbCcsIFtcclxuICAgICAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICAgICAnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUcmlnZ2VyJyxcclxuICAgICAgJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiQWN0aW9ucydcclxuICAgIF0pXHJcbiAgICAuZGlyZWN0aXZlKCdtZEZhYlNwZWVkRGlhbCcsIE1kRmFiU3BlZWREaWFsRGlyZWN0aXZlKVxyXG4gICAgLmFuaW1hdGlvbignLm1kLWZsaW5nJywgTWRGYWJTcGVlZERpYWxGbGluZ0FuaW1hdGlvbilcclxuICAgIC5hbmltYXRpb24oJy5tZC1zY2FsZScsIE1kRmFiU3BlZWREaWFsU2NhbGVBbmltYXRpb24pO1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAgICogQG5hbWUgbWRGYWJTcGVlZERpYWxcclxuICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuZmFiU3BlZWREaWFsXHJcbiAgICpcclxuICAgKiBAcmVzdHJpY3QgRVxyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogVGhlIGA8bWQtZmFiLXNwZWVkLWRpYWw+YCBkaXJlY3RpdmUgaXMgdXNlZCB0byBwcmVzZW50IGEgc2VyaWVzIG9mIHBvcHVwIGVsZW1lbnRzICh1c3VhbGx5XHJcbiAgICogYDxtZC1idXR0b24+YHMpIGZvciBxdWljayBhY2Nlc3MgdG8gY29tbW9uIGFjdGlvbnMuXHJcbiAgICpcclxuICAgKiBUaGVyZSBhcmUgY3VycmVudGx5IHR3byBhbmltYXRpb25zIGF2YWlsYWJsZSBieSBhcHBseWluZyBvbmUgb2YgdGhlIGZvbGxvd2luZyBjbGFzc2VzIHRvXHJcbiAgICogdGhlIGNvbXBvbmVudDpcclxuICAgKlxyXG4gICAqICAtIGBtZC1mbGluZ2AgLSBUaGUgc3BlZWQgZGlhbCBpdGVtcyBhcHBlYXIgZnJvbSB1bmRlcm5lYXRoIHRoZSB0cmlnZ2VyIGFuZCBtb3ZlIGludG8gdGhlaXJcclxuICAgKiAgICBhcHByb3ByaWF0ZSBwb3NpdGlvbnMuXHJcbiAgICogIC0gYG1kLXNjYWxlYCAtIFRoZSBzcGVlZCBkaWFsIGl0ZW1zIGFwcGVhciBpbiB0aGVpciBwcm9wZXIgcGxhY2VzIGJ5IHNjYWxpbmcgZnJvbSAwJSB0byAxMDAlLlxyXG4gICAqXHJcbiAgICogQHVzYWdlXHJcbiAgICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICAgKiA8bWQtZmFiLXNwZWVkLWRpYWwgZGlyZWN0aW9uPVwidXBcIiBjbGFzcz1cIm1kLWZsaW5nXCI+XHJcbiAgICogICA8bWQtZmFiLXRyaWdnZXI+XHJcbiAgICogICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIkFkZC4uLlwiPjxtZC1pY29uIGljb249XCIvaW1nL2ljb25zL3BsdXMuc3ZnXCI+PC9tZC1pY29uPjwvbWQtYnV0dG9uPlxyXG4gICAqICAgPC9tZC1mYWItdHJpZ2dlcj5cclxuICAgKlxyXG4gICAqICAgPG1kLWZhYi1hY3Rpb25zPlxyXG4gICAqICAgICA8bWQtYnV0dG9uIGFyaWEtbGFiZWw9XCJBZGQgVXNlclwiPlxyXG4gICAqICAgICAgIDxtZC1pY29uIGljb249XCIvaW1nL2ljb25zL3VzZXIuc3ZnXCI+PC9tZC1pY29uPlxyXG4gICAqICAgICA8L21kLWJ1dHRvbj5cclxuICAgKlxyXG4gICAqICAgICA8bWQtYnV0dG9uIGFyaWEtbGFiZWw9XCJBZGQgR3JvdXBcIj5cclxuICAgKiAgICAgICA8bWQtaWNvbiBpY29uPVwiL2ltZy9pY29ucy9ncm91cC5zdmdcIj48L21kLWljb24+XHJcbiAgICogICAgIDwvbWQtYnV0dG9uPlxyXG4gICAqICAgPC9tZC1mYWItYWN0aW9ucz5cclxuICAgKiA8L21kLWZhYi1zcGVlZC1kaWFsPlxyXG4gICAqIDwvaGxqcz5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtZGlyZWN0aW9uIEZyb20gd2hpY2ggZGlyZWN0aW9uIHlvdSB3b3VsZCBsaWtlIHRoZSBzcGVlZCBkaWFsIHRvIGFwcGVhclxyXG4gICAqIHJlbGF0aXZlIHRvIHRoZSB0cmlnZ2VyIGVsZW1lbnQuXHJcbiAgICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb3BlbiBQcm9ncmFtbWF0aWNhbGx5IGNvbnRyb2wgd2hldGhlciBvciBub3QgdGhlIHNwZWVkLWRpYWwgaXMgdmlzaWJsZS5cclxuICAgKi9cclxuICBmdW5jdGlvbiBNZEZhYlNwZWVkRGlhbERpcmVjdGl2ZSgpIHtcclxuICAgIEZhYlNwZWVkRGlhbENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGFuaW1hdGVcIl07XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXN0cmljdDogJ0UnLFxyXG5cclxuICAgICAgc2NvcGU6IHtcclxuICAgICAgICBkaXJlY3Rpb246ICdAP21kRGlyZWN0aW9uJyxcclxuICAgICAgICBpc09wZW46ICc9P21kT3BlbidcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXHJcbiAgICAgIGNvbnRyb2xsZXI6IEZhYlNwZWVkRGlhbENvbnRyb2xsZXIsXHJcbiAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuXHJcbiAgICAgIGxpbms6IEZhYlNwZWVkRGlhbExpbmtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gRmFiU3BlZWREaWFsTGluayhzY29wZSwgZWxlbWVudCkge1xyXG4gICAgICAvLyBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gaG9sZCBvdXIgQ1NTIHZhcmlhYmxlcyBzbyB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIGFuaW1hdGlvbnMgYmVsb3dcclxuICAgICAgZWxlbWVudC5wcmVwZW5kKCc8ZGl2IGNsYXNzPVwibWQtY3NzLXZhcmlhYmxlc1wiPjwvZGl2PicpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIEZhYlNwZWVkRGlhbENvbnRyb2xsZXIoJHNjb3BlLCAkZWxlbWVudCwgJGFuaW1hdGUpIHtcclxuICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgIC8vIERlZmluZSBvdXIgb3Blbi9jbG9zZSBmdW5jdGlvbnNcclxuICAgICAgLy8gTm90ZTogVXNlZCBieSBmYWJUcmlnZ2VyIGFuZCBmYWJBY3Rpb25zIGRpcmVjdGl2ZXNcclxuICAgICAgdm0ub3BlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzY29wZS4kYXBwbHkoJ3ZtLmlzT3BlbiA9IHRydWUnKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHZtLmNsb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseSgndm0uaXNPcGVuID0gZmFsc2UnKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHNldHVwRGVmYXVsdHMoKTtcclxuICAgICAgc2V0dXBMaXN0ZW5lcnMoKTtcclxuICAgICAgc2V0dXBXYXRjaGVycygpO1xyXG5cclxuICAgICAgLy8gU2V0IG91ciBkZWZhdWx0IHZhcmlhYmxlc1xyXG4gICAgICBmdW5jdGlvbiBzZXR1cERlZmF1bHRzKCkge1xyXG4gICAgICAgIC8vIFNldCB0aGUgZGVmYXVsdCBkaXJlY3Rpb24gdG8gJ2Rvd24nIGlmIG5vbmUgaXMgc3BlY2lmaWVkXHJcbiAgICAgICAgdm0uZGlyZWN0aW9uID0gdm0uZGlyZWN0aW9uIHx8ICdkb3duJztcclxuXHJcbiAgICAgICAgLy8gU2V0IHRoZSBkZWZhdWx0IHRvIGJlIGNsb3NlZFxyXG4gICAgICAgIHZtLmlzT3BlbiA9IHZtLmlzT3BlbiB8fCBmYWxzZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gU2V0dXAgb3VyIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgICBmdW5jdGlvbiBzZXR1cExpc3RlbmVycygpIHtcclxuICAgICAgICAkZWxlbWVudC5vbignbW91c2VlbnRlcicsIHZtLm9wZW4pO1xyXG4gICAgICAgICRlbGVtZW50Lm9uKCdtb3VzZWxlYXZlJywgdm0uY2xvc2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBTZXR1cCBvdXIgd2F0Y2hlcnNcclxuICAgICAgZnVuY3Rpb24gc2V0dXBXYXRjaGVycygpIHtcclxuICAgICAgICAvLyBXYXRjaCBmb3IgY2hhbmdlcyB0byB0aGUgZGlyZWN0aW9uIGFuZCB1cGRhdGUgY2xhc3Nlcy9hdHRyaWJ1dGVzXHJcbiAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0uZGlyZWN0aW9uJywgZnVuY3Rpb24obmV3RGlyLCBvbGREaXIpIHtcclxuICAgICAgICAgIC8vIEFkZCB0aGUgYXBwcm9wcmlhdGUgY2xhc3NlcyBzbyB3ZSBjYW4gdGFyZ2V0IHRoZSBkaXJlY3Rpb24gaW4gdGhlIENTU1xyXG4gICAgICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoJGVsZW1lbnQsICdtZC0nICsgb2xkRGlyKTtcclxuICAgICAgICAgICRhbmltYXRlLmFkZENsYXNzKCRlbGVtZW50LCAnbWQtJyArIG5ld0Rpcik7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAvLyBXYXRjaCBmb3IgY2hhbmdlcyB0byBtZC1vcGVuXHJcbiAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0uaXNPcGVuJywgZnVuY3Rpb24oaXNPcGVuKSB7XHJcbiAgICAgICAgICB2YXIgdG9BZGQgPSBpc09wZW4gPyAnbWQtaXMtb3BlbicgOiAnJztcclxuICAgICAgICAgIHZhciB0b1JlbW92ZSA9IGlzT3BlbiA/ICcnIDogJ21kLWlzLW9wZW4nO1xyXG5cclxuICAgICAgICAgICRhbmltYXRlLnNldENsYXNzKCRlbGVtZW50LCB0b0FkZCwgdG9SZW1vdmUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBNZEZhYlNwZWVkRGlhbEZsaW5nQW5pbWF0aW9uKCkge1xyXG4gICAgZnVuY3Rpb24gcnVuQW5pbWF0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgdmFyIGVsID0gZWxlbWVudFswXTtcclxuICAgICAgdmFyIGN0cmwgPSBlbGVtZW50LmNvbnRyb2xsZXIoJ21kRmFiU3BlZWREaWFsJyk7XHJcbiAgICAgIHZhciBpdGVtcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZC1mYWItYWN0aW9uLWl0ZW0nKTtcclxuXHJcbiAgICAgIC8vIEdyYWIgb3VyIGVsZW1lbnQgd2hpY2ggc3RvcmVzIENTUyB2YXJpYWJsZXNcclxuICAgICAgdmFyIHZhcmlhYmxlc0VsZW1lbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCcubWQtY3NzLXZhcmlhYmxlcycpO1xyXG5cclxuICAgICAgLy8gU2V0dXAgSlMgdmFyaWFibGVzIGJhc2VkIG9uIG91ciBDU1MgdmFyaWFibGVzXHJcbiAgICAgIHZhciBzdGFydFpJbmRleCA9IHZhcmlhYmxlc0VsZW1lbnQuc3R5bGUuekluZGV4O1xyXG5cclxuICAgICAgLy8gQWx3YXlzIHJlc2V0IHRoZSBpdGVtcyB0byB0aGVpciBuYXR1cmFsIHBvc2l0aW9uL3N0YXRlXHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcclxuICAgICAgICB2YXIgc3R5bGVzID0gaXRlbS5zdHlsZTtcclxuXHJcbiAgICAgICAgc3R5bGVzLnRyYW5zZm9ybSA9ICcnO1xyXG4gICAgICAgIHN0eWxlcy50cmFuc2l0aW9uRGVsYXkgPSAnJztcclxuICAgICAgICBzdHlsZXMub3BhY2l0eSA9IDE7XHJcblxyXG4gICAgICAgIC8vIE1ha2UgdGhlIGl0ZW1zIGNsb3Nlc3QgdG8gdGhlIHRyaWdnZXIgaGF2ZSB0aGUgaGlnaGVzdCB6LWluZGV4XHJcbiAgICAgICAgaXRlbS5zdHlsZS56SW5kZXggPSAoaXRlbXMubGVuZ3RoIC0gaW5kZXgpICsgc3RhcnRaSW5kZXg7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gSWYgdGhlIGNvbnRyb2wgaXMgY2xvc2VkLCBoaWRlIHRoZSBpdGVtcyBiZWhpbmQgdGhlIHRyaWdnZXJcclxuICAgICAgaWYgKCFjdHJsLmlzT3Blbikge1xyXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcclxuICAgICAgICAgIHZhciBuZXdQb3NpdGlvbiwgYXhpcztcclxuXHJcbiAgICAgICAgICBzd2l0Y2ggKGN0cmwuZGlyZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3VwJzpcclxuICAgICAgICAgICAgICBuZXdQb3NpdGlvbiA9IGl0ZW0uc2Nyb2xsSGVpZ2h0ICogKGluZGV4ICsgMSk7XHJcbiAgICAgICAgICAgICAgYXhpcyA9ICdZJztcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZG93bic6XHJcbiAgICAgICAgICAgICAgbmV3UG9zaXRpb24gPSAtaXRlbS5zY3JvbGxIZWlnaHQgKiAoaW5kZXggKyAxKTtcclxuICAgICAgICAgICAgICBheGlzID0gJ1knO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAgICBuZXdQb3NpdGlvbiA9IGl0ZW0uc2Nyb2xsV2lkdGggKiAoaW5kZXggKyAxKTtcclxuICAgICAgICAgICAgICBheGlzID0gJ1gnO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgICAgICAgbmV3UG9zaXRpb24gPSAtaXRlbS5zY3JvbGxXaWR0aCAqIChpbmRleCArIDEpO1xyXG4gICAgICAgICAgICAgIGF4aXMgPSAnWCc7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaXRlbS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlJyArIGF4aXMgKyAnKCcgKyBuZXdQb3NpdGlvbiArICdweCknO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkge1xyXG4gICAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdtZC1mbGluZycpKSB7XHJcbiAgICAgICAgICBydW5BbmltYXRpb24oZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uKGVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBNZEZhYlNwZWVkRGlhbFNjYWxlQW5pbWF0aW9uKCkge1xyXG4gICAgdmFyIGRlbGF5ID0gNjU7XHJcblxyXG4gICAgZnVuY3Rpb24gcnVuQW5pbWF0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgdmFyIGVsID0gZWxlbWVudFswXTtcclxuICAgICAgdmFyIGN0cmwgPSBlbGVtZW50LmNvbnRyb2xsZXIoJ21kRmFiU3BlZWREaWFsJyk7XHJcbiAgICAgIHZhciBpdGVtcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZC1mYWItYWN0aW9uLWl0ZW0nKTtcclxuXHJcbiAgICAgIC8vIEFsd2F5cyByZXNldCB0aGUgaXRlbXMgdG8gdGhlaXIgbmF0dXJhbCBwb3NpdGlvbi9zdGF0ZVxyXG4gICAgICBhbmd1bGFyLmZvckVhY2goaXRlbXMsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XHJcbiAgICAgICAgdmFyIHN0eWxlcyA9IGl0ZW0uc3R5bGUsXHJcbiAgICAgICAgICBvZmZzZXREZWxheSA9IGluZGV4ICogZGVsYXk7XHJcblxyXG4gICAgICAgIHN0eWxlcy5vcGFjaXR5ID0gY3RybC5pc09wZW4gPyAxIDogMDtcclxuICAgICAgICBzdHlsZXMudHJhbnNmb3JtID0gY3RybC5pc09wZW4gPyAnc2NhbGUoMSknIDogJ3NjYWxlKDApJztcclxuICAgICAgICBzdHlsZXMudHJhbnNpdGlvbkRlbGF5ID0gKGN0cmwuaXNPcGVuID8gIG9mZnNldERlbGF5IDogKGl0ZW1zLmxlbmd0aCAtIG9mZnNldERlbGF5KSkgKyAnbXMnO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uKGVsZW1lbnQpO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkge1xyXG4gICAgICAgIHJ1bkFuaW1hdGlvbihlbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufSkoKTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiVG9vbGJhcicsIFtcclxuICAgICAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICAgICAnbWF0ZXJpYWwuY29tcG9uZW50cy5mYWJUcmlnZ2VyJyxcclxuICAgICAgJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiQWN0aW9ucydcclxuICAgIF0pXHJcbiAgICAuZGlyZWN0aXZlKCdtZEZhYlRvb2xiYXInLCBNZEZhYlRvb2xiYXJEaXJlY3RpdmUpXHJcbiAgICAuYW5pbWF0aW9uKCcubWQtZmFiLXRvb2xiYXInLCBNZEZhYlRvb2xiYXJBbmltYXRpb24pO1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAgICogQG5hbWUgbWRGYWJUb29sYmFyXHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmZhYlRvb2xiYXJcclxuICAgKlxyXG4gICAqIEByZXN0cmljdCBFXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKlxyXG4gICAqIFRoZSBgPG1kLWZhYi10b29sYmFyPmAgZGlyZWN0aXZlIGlzIHVzZWQgcHJlc2VudCBhIHRvb2xiYXIgb2YgZWxlbWVudHMgKHVzdWFsbHkgYDxtZC1idXR0b24+YHMpXHJcbiAgICogZm9yIHF1aWNrIGFjY2VzcyB0byBjb21tb24gYWN0aW9ucyB3aGVuIGEgZmxvYXRpbmcgYWN0aW9uIGJ1dHRvbiBpcyBhY3RpdmF0ZWQgKHZpYSBob3ZlciBvclxyXG4gICAqIGtleWJvYXJkIG5hdmlnYXRpb24pLlxyXG4gICAqXHJcbiAgICogQHVzYWdlXHJcbiAgICpcclxuICAgKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gICAqIDxtZC1mYWItdG9vbGJhcj5cclxuICAgKiAgIDxtZC1mYWItdHJpZ2dlcj5cclxuICAgKiAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiQWRkLi4uXCI+PG1kLWljb24gaWNvbj1cIi9pbWcvaWNvbnMvcGx1cy5zdmdcIj48L21kLWljb24+PC9tZC1idXR0b24+XHJcbiAgICogICA8L21kLWZhYi10cmlnZ2VyPlxyXG4gICAqXHJcbiAgICogICA8bWQtZmFiLWFjdGlvbnM+XHJcbiAgICogICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIkFkZCBVc2VyXCI+XHJcbiAgICogICAgICAgPG1kLWljb24gaWNvbj1cIi9pbWcvaWNvbnMvdXNlci5zdmdcIj48L21kLWljb24+XHJcbiAgICogICAgIDwvbWQtYnV0dG9uPlxyXG4gICAqXHJcbiAgICogICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIkFkZCBHcm91cFwiPlxyXG4gICAqICAgICAgIDxtZC1pY29uIGljb249XCIvaW1nL2ljb25zL2dyb3VwLnN2Z1wiPjwvbWQtaWNvbj5cclxuICAgKiAgICAgPC9tZC1idXR0b24+XHJcbiAgICogICA8L21kLWZhYi1hY3Rpb25zPlxyXG4gICAqIDwvbWQtZmFiLXRvb2xiYXI+XHJcbiAgICogPC9obGpzPlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb3BlbiBQcm9ncmFtbWF0aWNhbGx5IGNvbnRyb2wgd2hldGhlciBvciBub3QgdGhlIHRvb2xiYXIgaXMgdmlzaWJsZS5cclxuICAgKi9cclxuICBmdW5jdGlvbiBNZEZhYlRvb2xiYXJEaXJlY3RpdmUoKSB7XHJcbiAgICBGYWJUb29sYmFyQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkYW5pbWF0ZVwiXTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICAgIHRlbXBsYXRlOlxyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtZmFiLXRvb2xiYXItd3JhcHBlclwiPicgK1xyXG4gICAgICAgICcgIDxkaXYgY2xhc3M9XCJtZC1mYWItdG9vbGJhci1jb250ZW50XCIgbmctdHJhbnNjbHVkZT48L2Rpdj4nICtcclxuICAgICAgICAnPC9kaXY+JyxcclxuXHJcbiAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgaXNPcGVuOiAnPT9tZE9wZW4nXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxyXG4gICAgICBjb250cm9sbGVyOiBGYWJUb29sYmFyQ29udHJvbGxlcixcclxuICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG5cclxuICAgICAgbGluazogbGlua1xyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBGYWJUb29sYmFyQ29udHJvbGxlcigkc2NvcGUsICRlbGVtZW50LCAkYW5pbWF0ZSkge1xyXG4gICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgLy8gU2V0IHRoZSBkZWZhdWx0IHRvIGJlIGNsb3NlZFxyXG4gICAgICB2bS5pc09wZW4gPSB2bS5pc09wZW4gfHwgZmFsc2U7XHJcblxyXG4gICAgICB2bS5vcGVuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdm0uaXNPcGVuID0gdHJ1ZTtcclxuICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICB2bS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZtLmlzT3BlbiA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIEFkZCBvdXIgY2xhc3Mgc28gd2UgY2FuIHRyaWdnZXIgdGhlIGFuaW1hdGlvbiBvbiBzdGFydFxyXG4gICAgICAkZWxlbWVudC5hZGRDbGFzcygnbWQtZmFiLXRvb2xiYXInKTtcclxuXHJcbiAgICAgIC8vIFNldHVwIHNvbWUgbW91c2UgZXZlbnRzIHNvIHRoZSBob3ZlciBlZmZlY3QgY2FuIGJlIHRyaWdnZXJlZFxyXG4gICAgICAvLyBhbnl3aGVyZSBvdmVyIHRoZSB0b29sYmFyXHJcbiAgICAgICRlbGVtZW50Lm9uKCdtb3VzZWVudGVyJywgdm0ub3Blbik7XHJcbiAgICAgICRlbGVtZW50Lm9uKCdtb3VzZWxlYXZlJywgdm0uY2xvc2UpO1xyXG5cclxuICAgICAgLy8gV2F0Y2ggZm9yIGNoYW5nZXMgdG8gbWQtb3BlbiBhbmQgdG9nZ2xlIG91ciBjbGFzc1xyXG4gICAgICAkc2NvcGUuJHdhdGNoKCd2bS5pc09wZW4nLCBmdW5jdGlvbihpc09wZW4pIHtcclxuICAgICAgICB2YXIgdG9BZGQgPSBpc09wZW4gPyAnbWQtaXMtb3BlbicgOiAnJztcclxuICAgICAgICB2YXIgdG9SZW1vdmUgPSBpc09wZW4gPyAnJyA6ICdtZC1pcy1vcGVuJztcclxuXHJcbiAgICAgICAgJGFuaW1hdGUuc2V0Q2xhc3MoJGVsZW1lbnQsIHRvQWRkLCB0b1JlbW92ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcclxuICAgICAgLy8gRG9uJ3QgYWxsb3cgZm9jdXMgb24gdGhlIHRyaWdnZXJcclxuICAgICAgZWxlbWVudC5maW5kKCdtZC1mYWItdHJpZ2dlcicpLmZpbmQoJ2J1dHRvbicpLmF0dHIoJ3RhYmluZGV4JywgJy0xJyk7XHJcblxyXG4gICAgICAvLyBQcmVwZW5kIHRoZSBiYWNrZ3JvdW5kIGVsZW1lbnQgdG8gdGhlIHRyaWdnZXIncyBidXR0b25cclxuICAgICAgZWxlbWVudC5maW5kKCdtZC1mYWItdHJpZ2dlcicpLmZpbmQoJ2J1dHRvbicpXHJcbiAgICAgICAgLnByZXBlbmQoJzxkaXYgY2xhc3M9XCJtZC1mYWItdG9vbGJhci1iYWNrZ3JvdW5kXCI+PC9kaXY+Jyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBNZEZhYlRvb2xiYXJBbmltYXRpb24oKSB7XHJcbiAgICB2YXIgb3JpZ2luYWxJY29uRGVsYXk7XHJcblxyXG4gICAgZnVuY3Rpb24gcnVuQW5pbWF0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkge1xyXG4gICAgICB2YXIgZWwgPSBlbGVtZW50WzBdO1xyXG4gICAgICB2YXIgY3RybCA9IGVsZW1lbnQuY29udHJvbGxlcignbWRGYWJUb29sYmFyJyk7XHJcblxyXG4gICAgICAvLyBHcmFiIHRoZSByZWxldmFudCBjaGlsZCBlbGVtZW50c1xyXG4gICAgICB2YXIgYmFja2dyb3VuZEVsZW1lbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCcubWQtZmFiLXRvb2xiYXItYmFja2dyb3VuZCcpO1xyXG4gICAgICB2YXIgdHJpZ2dlckVsZW1lbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCdtZC1mYWItdHJpZ2dlciBidXR0b24nKTtcclxuICAgICAgdmFyIGljb25FbGVtZW50ID0gZWwucXVlcnlTZWxlY3RvcignbWQtZmFiLXRyaWdnZXIgYnV0dG9uIG1kLWljb24nKTtcclxuICAgICAgdmFyIGFjdGlvbnMgPSBlbGVtZW50LmZpbmQoJ21kLWZhYi1hY3Rpb25zJykuY2hpbGRyZW4oKTtcclxuXHJcbiAgICAgIC8vIElmIHdlIGhhdmUgYm90aCBlbGVtZW50cywgdXNlIHRoZW0gdG8gcG9zaXRpb24gdGhlIG5ldyBiYWNrZ3JvdW5kXHJcbiAgICAgIGlmICh0cmlnZ2VyRWxlbWVudCAmJiBiYWNrZ3JvdW5kRWxlbWVudCkge1xyXG4gICAgICAgIC8vIEdldCBvdXIgdmFyaWFibGVzXHJcbiAgICAgICAgdmFyIGNvbG9yID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodHJpZ2dlckVsZW1lbnQpLmdldFByb3BlcnR5VmFsdWUoJ2JhY2tncm91bmQtY29sb3InKTtcclxuICAgICAgICB2YXIgd2lkdGggPSBlbC5vZmZzZXRXaWR0aDtcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gZWwub2Zmc2V0SGVpZ2h0O1xyXG5cclxuICAgICAgICAvLyBNYWtlIGEgc3F1YXJlXHJcbiAgICAgICAgdmFyIHNjYWxlID0gd2lkdGggKiAyO1xyXG5cclxuICAgICAgICAvLyBTZXQgc29tZSBiYXNpYyBzdHlsZXMgbm8gbWF0dGVyIHdoYXQgYW5pbWF0aW9uIHdlJ3JlIGRvaW5nXHJcbiAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XHJcbiAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUuYm9yZGVyUmFkaXVzID0gd2lkdGggKyAncHgnO1xyXG5cclxuICAgICAgICAvLyBJZiB3ZSdyZSBvcGVuXHJcbiAgICAgICAgaWYgKGN0cmwuaXNPcGVuKSB7XHJcblxyXG4gICAgICAgICAgLy8gU2V0IHRoZSB3aWR0aC9oZWlnaHQgdG8gdGFrZSB1cCB0aGUgZnVsbCB0b29sYmFyIHdpZHRoXHJcbiAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS53aWR0aCA9IHNjYWxlICsgJ3B4JztcclxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLmhlaWdodCA9IHNjYWxlICsgJ3B4JztcclxuXHJcbiAgICAgICAgICAvLyBTZXQgdGhlIHRvcC9sZWZ0IHRvIG1vdmUgdXAvbGVmdCAob3IgcmlnaHQpIGJ5IHRoZSBzY2FsZSB3aWR0aC9oZWlnaHRcclxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnRvcCA9IC0oc2NhbGUgLyAyKSArICdweCc7XHJcblxyXG4gICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLWxlZnQnKSkge1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5sZWZ0ID0gLShzY2FsZSAvIDIpICsgJ3B4JztcclxuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUucmlnaHQgPSBudWxsO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdtZC1yaWdodCcpKSB7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnJpZ2h0ID0gLShzY2FsZSAvIDIpICsgJ3B4JztcclxuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUubGVmdCA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gU2V0IHRoZSBuZXh0IGNsb3NlIGFuaW1hdGlvbiB0byBoYXZlIHRoZSBwcm9wZXIgZGVsYXlzXHJcbiAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSAnMG1zJztcclxuICAgICAgICAgIGljb25FbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcuM3MnO1xyXG5cclxuICAgICAgICAgIC8vIEFwcGx5IGEgdHJhbnNpdGlvbiBkZWxheSB0byBhY3Rpb25zXHJcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2goYWN0aW9ucywgZnVuY3Rpb24oYWN0aW9uLCBpbmRleCkge1xyXG4gICAgICAgICAgICBhY3Rpb24uc3R5bGUudHJhbnNpdGlvbkRlbGF5ID0gKGFjdGlvbnMubGVuZ3RoIC0gaW5kZXgpICogMjUgKyAnbXMnO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIE90aGVyd2lzZSwgc2V0IHRoZSB3aWR0aC9oZWlnaHQgdG8gdGhlIHRyaWdnZXIncyB3aWR0aC9oZWlnaHRcclxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLndpZHRoID0gdHJpZ2dlckVsZW1lbnQub2Zmc2V0V2lkdGggKyAncHgnO1xyXG4gICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gdHJpZ2dlckVsZW1lbnQub2Zmc2V0SGVpZ2h0ICsgJ3B4JztcclxuXHJcbiAgICAgICAgICAvLyBSZXNldCB0aGUgcG9zaXRpb25cclxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnRvcCA9ICcwcHgnO1xyXG5cclxuICAgICAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdtZC1sZWZ0JykpIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUubGVmdCA9ICcwcHgnO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kRWxlbWVudC5zdHlsZS5yaWdodCA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLXJpZ2h0JykpIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUucmlnaHQgPSAnMHB4JztcclxuICAgICAgICAgICAgYmFja2dyb3VuZEVsZW1lbnQuc3R5bGUubGVmdCA9IG51bGw7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gU2V0IHRoZSBuZXh0IG9wZW4gYW5pbWF0aW9uIHRvIGhhdmUgdGhlIHByb3BlciBkZWxheXNcclxuICAgICAgICAgIGJhY2tncm91bmRFbGVtZW50LnN0eWxlLnRyYW5zaXRpb25EZWxheSA9ICcyMDBtcyc7XHJcbiAgICAgICAgICBpY29uRWxlbWVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSAnMG1zJztcclxuXHJcbiAgICAgICAgICAvLyBBcHBseSBhIHRyYW5zaXRpb24gZGVsYXkgdG8gYWN0aW9uc1xyXG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGFjdGlvbnMsIGZ1bmN0aW9uKGFjdGlvbiwgaW5kZXgpIHtcclxuICAgICAgICAgICAgYWN0aW9uLnN0eWxlLnRyYW5zaXRpb25EZWxheSA9IChpbmRleCAqIDI1KSArICdtcyc7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBhZGRDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSk7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn0pKCk7XHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIGFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuZmFiVHJpZ2dlcicsIFsgJ21hdGVyaWFsLmNvcmUnIF0pXHJcbiAgICAuZGlyZWN0aXZlKCdtZEZhYlRyaWdnZXInLCBNZEZhYlRyaWdnZXJEaXJlY3RpdmUpO1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAgICogQG5hbWUgbWRGYWJUcmlnZ2VyXHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmZhYlNwZWVkRGlhbFxyXG4gICAqXHJcbiAgICogQHJlc3RyaWN0IEVcclxuICAgKlxyXG4gICAqIEBkZXNjcmlwdGlvblxyXG4gICAqIFRoZSBgPG1kLWZhYi10cmlnZ2VyPmAgZGlyZWN0aXZlIGlzIHVzZWQgaW5zaWRlIG9mIGEgYDxtZC1mYWItc3BlZWQtZGlhbD5gIG9yXHJcbiAgICogYDxtZC1mYWItdG9vbGJhcj5gIGRpcmVjdGl2ZSB0byBtYXJrIHRoZSBhbiBlbGVtZW50IChvciBlbGVtZW50cykgYXMgdGhlIHRyaWdnZXIgYW5kIHNldHVwIHRoZVxyXG4gICAqIHByb3BlciBldmVudCBsaXN0ZW5lcnMuXHJcbiAgICpcclxuICAgKiBAdXNhZ2VcclxuICAgKiBTZWUgdGhlIGA8bWQtZmFiLXNwZWVkLWRpYWw+YCBvciBgPG1kLWZhYi10b29sYmFyPmAgZGlyZWN0aXZlcyBmb3IgZXhhbXBsZSB1c2FnZS5cclxuICAgKi9cclxuICBmdW5jdGlvbiBNZEZhYlRyaWdnZXJEaXJlY3RpdmUoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXN0cmljdDogJ0UnLFxyXG5cclxuICAgICAgcmVxdWlyZTogWydeP21kRmFiU3BlZWREaWFsJywgJ14/bWRGYWJUb29sYmFyJ10sXHJcblxyXG4gICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cmlidXRlcywgY29udHJvbGxlcnMpIHtcclxuICAgICAgICAvLyBHcmFiIHdoaWNoZXZlciBwYXJlbnQgY29udHJvbGxlciBpcyB1c2VkXHJcbiAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBjb250cm9sbGVyc1swXSB8fCBjb250cm9sbGVyc1sxXTtcclxuXHJcbiAgICAgICAgLy8gTWFrZSB0aGUgY2hpbGRyZW4gb3Blbi9jbG9zZSB0aGVpciBwYXJlbnQgZGlyZWN0aXZlXHJcbiAgICAgICAgaWYgKGNvbnRyb2xsZXIpIHtcclxuICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChlbGVtZW50LmNoaWxkcmVuKCksIGZ1bmN0aW9uKGNoaWxkKSB7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChjaGlsZCkub24oJ2ZvY3VzJywgY29udHJvbGxlci5vcGVuKTtcclxuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGNoaWxkKS5vbignYmx1cicsIGNvbnRyb2xsZXIuY2xvc2UpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59KSgpO1xyXG5cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuZ3JpZExpc3RcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmdyaWRMaXN0JywgWydtYXRlcmlhbC5jb3JlJ10pXHJcbiAgICAgICAuZGlyZWN0aXZlKCdtZEdyaWRMaXN0JywgR3JpZExpc3REaXJlY3RpdmUpXHJcbiAgICAgICAuZGlyZWN0aXZlKCdtZEdyaWRUaWxlJywgR3JpZFRpbGVEaXJlY3RpdmUpXHJcbiAgICAgICAuZGlyZWN0aXZlKCdtZEdyaWRUaWxlRm9vdGVyJywgR3JpZFRpbGVDYXB0aW9uRGlyZWN0aXZlKVxyXG4gICAgICAgLmRpcmVjdGl2ZSgnbWRHcmlkVGlsZUhlYWRlcicsIEdyaWRUaWxlQ2FwdGlvbkRpcmVjdGl2ZSlcclxuICAgICAgIC5mYWN0b3J5KCckbWRHcmlkTGF5b3V0JywgR3JpZExheW91dEZhY3RvcnkpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRHcmlkTGlzdFxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuZ3JpZExpc3RcclxuICogQHJlc3RyaWN0IEVcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEdyaWQgbGlzdHMgYXJlIGFuIGFsdGVybmF0aXZlIHRvIHN0YW5kYXJkIGxpc3Qgdmlld3MuIEdyaWQgbGlzdHMgYXJlIGRpc3RpbmN0XHJcbiAqIGZyb20gZ3JpZHMgdXNlZCBmb3IgbGF5b3V0cyBhbmQgb3RoZXIgdmlzdWFsIHByZXNlbnRhdGlvbnMuXHJcbiAqXHJcbiAqIEEgZ3JpZCBsaXN0IGlzIGJlc3Qgc3VpdGVkIHRvIHByZXNlbnRpbmcgYSBob21vZ2Vub3VzIGRhdGEgdHlwZSwgdHlwaWNhbGx5XHJcbiAqIGltYWdlcywgYW5kIGlzIG9wdGltaXplZCBmb3IgdmlzdWFsIGNvbXByZWhlbnNpb24gYW5kIGRpZmZlcmVudGlhdGluZyBiZXR3ZWVuXHJcbiAqIGxpa2UgZGF0YSB0eXBlcy5cclxuICpcclxuICogQSBncmlkIGxpc3QgaXMgYSBjb250aW51b3VzIGVsZW1lbnQgY29uc2lzdGluZyBvZiB0ZXNzZWxsYXRlZCwgcmVndWxhclxyXG4gKiBzdWJkaXZpc2lvbnMgY2FsbGVkIGNlbGxzIHRoYXQgY29udGFpbiB0aWxlcyAoYG1kLWdyaWQtdGlsZWApLlxyXG4gKlxyXG4gKiA8aW1nIHNyYz1cIi8vbWF0ZXJpYWwtZGVzaWduLnN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vcHVibGlzaC92XzIvbWF0ZXJpYWxfZXh0X3B1Ymxpc2gvMEJ4NEJTdDZqbmlEN09WbEVhWFo1WW1VMVh6Zy9jb21wb25lbnRzX2dyaWRzX3VzYWdlMi5wbmdcIlxyXG4gKiAgICBzdHlsZT1cIndpZHRoOiAzMDBweDsgaGVpZ2h0OiBhdXRvOyBtYXJnaW4tcmlnaHQ6IDE2cHg7XCIgYWx0PVwiQ29uY2VwdCBvZiBncmlkIGV4cGxhaW5lZCB2aXN1YWxseVwiPlxyXG4gKiA8aW1nIHNyYz1cIi8vbWF0ZXJpYWwtZGVzaWduLnN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vcHVibGlzaC92XzIvbWF0ZXJpYWxfZXh0X3B1Ymxpc2gvMEJ4NEJTdDZqbmlEN1ZHaHNPRTVpZFdsSldYTS9jb21wb25lbnRzX2dyaWRzX3VzYWdlMy5wbmdcIlxyXG4gKiAgICBzdHlsZT1cIndpZHRoOiAzMDBweDsgaGVpZ2h0OiBhdXRvO1wiIGFsdD1cIkdyaWQgY29uY2VwdHMgbGVnZW5kXCI+XHJcbiAqXHJcbiAqIENlbGxzIGFyZSBhcnJheWVkIHZlcnRpY2FsbHkgYW5kIGhvcml6b250YWxseSB3aXRoaW4gdGhlIGdyaWQuXHJcbiAqXHJcbiAqIFRpbGVzIGhvbGQgY29udGVudCBhbmQgY2FuIHNwYW4gb25lIG9yIG1vcmUgY2VsbHMgdmVydGljYWxseSBvciBob3Jpem9udGFsbHkuXHJcbiAqXHJcbiAqICMjIyBSZXNwb25zaXZlIEF0dHJpYnV0ZXNcclxuICpcclxuICogVGhlIGBtZC1ncmlkLWxpc3RgIGRpcmVjdGl2ZSBzdXBwb3J0cyBcInJlc3BvbnNpdmVcIiBhdHRyaWJ1dGVzLCB3aGljaCBhbGxvd1xyXG4gKiBkaWZmZXJlbnQgYG1kLWNvbHNgLCBgbWQtZ3V0dGVyYCBhbmQgYG1kLXJvdy1oZWlnaHRgIHZhbHVlcyBkZXBlbmRpbmcgb24gdGhlXHJcbiAqIGN1cnJlbnRseSBtYXRjaGluZyBtZWRpYSBxdWVyeSAoYXMgZGVmaW5lZCBpbiBgJG1kQ29uc3RhbnQuTUVESUFgKS5cclxuICpcclxuICogSW4gb3JkZXIgdG8gc2V0IGEgcmVzcG9uc2l2ZSBhdHRyaWJ1dGUsIGZpcnN0IGRlZmluZSB0aGUgZmFsbGJhY2sgdmFsdWUgd2l0aFxyXG4gKiB0aGUgc3RhbmRhcmQgYXR0cmlidXRlIG5hbWUsIHRoZW4gYWRkIGFkZGl0aW9uYWwgYXR0cmlidXRlcyB3aXRoIHRoZVxyXG4gKiBmb2xsb3dpbmcgY29udmVudGlvbjogYHtiYXNlLWF0dHJpYnV0ZS1uYW1lfS17bWVkaWEtcXVlcnktbmFtZX09XCJ7dmFsdWV9XCJgXHJcbiAqIChpZS4gYG1kLWNvbHMtbGc9XCI4XCJgKVxyXG4gKlxyXG4gKiBAcGFyYW0ge251bWJlcn0gbWQtY29scyBOdW1iZXIgb2YgY29sdW1ucyBpbiB0aGUgZ3JpZC5cclxuICogQHBhcmFtIHtzdHJpbmd9IG1kLXJvdy1oZWlnaHQgT25lIG9mXHJcbiAqIDx1bD5cclxuICogICA8bGk+Q1NTIGxlbmd0aCAtIEZpeGVkIGhlaWdodCByb3dzIChlZy4gYDhweGAgb3IgYDFyZW1gKTwvbGk+XHJcbiAqICAgPGxpPmB7d2lkdGh9OntoZWlnaHR9YCAtIFJhdGlvIG9mIHdpZHRoIHRvIGhlaWdodCAoZWcuXHJcbiAqICAgYG1kLXJvdy1oZWlnaHQ9XCIxNjo5XCJgKTwvbGk+XHJcbiAqICAgPGxpPmBcImZpdFwiYCAtIEhlaWdodCB3aWxsIGJlIGRldGVybWluZWQgYnkgc3ViZGl2aWRpbmcgdGhlIGF2YWlsYWJsZVxyXG4gKiAgIGhlaWdodCBieSB0aGUgbnVtYmVyIG9mIHJvd3M8L2xpPlxyXG4gKiA8L3VsPlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLWd1dHRlciBUaGUgYW1vdW50IG9mIHNwYWNlIGJldHdlZW4gdGlsZXMgaW4gQ1NTIHVuaXRzXHJcbiAqICAgICAoZGVmYXVsdCAxcHgpXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLW9uLWxheW91dCBFeHByZXNzaW9uIHRvIGV2YWx1YXRlIGFmdGVyIGxheW91dC4gRXZlbnRcclxuICogICAgIG9iamVjdCBpcyBhdmFpbGFibGUgYXMgYCRldmVudGAsIGFuZCBjb250YWlucyBwZXJmb3JtYW5jZSBpbmZvcm1hdGlvbi5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIEJhc2ljOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC1saXN0IG1kLWNvbHM9XCI1XCIgbWQtZ3V0dGVyPVwiMWVtXCIgbWQtcm93LWhlaWdodD1cIjQ6M1wiPlxyXG4gKiAgIDxtZC1ncmlkLXRpbGU+PC9tZC1ncmlkLXRpbGU+XHJcbiAqIDwvbWQtZ3JpZC1saXN0PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIEZpeGVkLWhlaWdodCByb3dzOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC1saXN0IG1kLWNvbHM9XCI0XCIgbWQtcm93LWhlaWdodD1cIjIwMHB4XCIgLi4uPlxyXG4gKiAgIDxtZC1ncmlkLXRpbGU+PC9tZC1ncmlkLXRpbGU+XHJcbiAqIDwvbWQtZ3JpZC1saXN0PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIEZpdCByb3dzOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC1saXN0IG1kLWNvbHM9XCI0XCIgbWQtcm93LWhlaWdodD1cImZpdFwiIHN0eWxlPVwiaGVpZ2h0OiA0MDBweDtcIiAuLi4+XHJcbiAqICAgPG1kLWdyaWQtdGlsZT48L21kLWdyaWQtdGlsZT5cclxuICogPC9tZC1ncmlkLWxpc3Q+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogVXNpbmcgcmVzcG9uc2l2ZSBhdHRyaWJ1dGVzOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC1saXN0XHJcbiAqICAgICBtZC1jb2xzLXNtPVwiMlwiXHJcbiAqICAgICBtZC1jb2xzLW1kPVwiNFwiXHJcbiAqICAgICBtZC1jb2xzLWxnPVwiOFwiXHJcbiAqICAgICBtZC1jb2xzLWd0LWxnPVwiMTJcIlxyXG4gKiAgICAgLi4uPlxyXG4gKiAgIDxtZC1ncmlkLXRpbGU+PC9tZC1ncmlkLXRpbGU+XHJcbiAqIDwvbWQtZ3JpZC1saXN0PlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5mdW5jdGlvbiBHcmlkTGlzdERpcmVjdGl2ZSgkaW50ZXJwb2xhdGUsICRtZENvbnN0YW50LCAkbWRHcmlkTGF5b3V0LCAkbWRNZWRpYSkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgY29udHJvbGxlcjogR3JpZExpc3RDb250cm9sbGVyLFxyXG4gICAgc2NvcGU6IHtcclxuICAgICAgbWRPbkxheW91dDogJyYnXHJcbiAgICB9LFxyXG4gICAgbGluazogcG9zdExpbmtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcclxuICAgIC8vIEFwcGx5IHNlbWFudGljc1xyXG4gICAgZWxlbWVudC5hdHRyKCdyb2xlJywgJ2xpc3QnKTtcclxuXHJcbiAgICAvLyBQcm92aWRlIHRoZSBjb250cm9sbGVyIHdpdGggYSB3YXkgdG8gdHJpZ2dlciBsYXlvdXRzLlxyXG4gICAgY3RybC5sYXlvdXREZWxlZ2F0ZSA9IGxheW91dERlbGVnYXRlO1xyXG5cclxuICAgIHZhciBpbnZhbGlkYXRlTGF5b3V0ID0gYW5ndWxhci5iaW5kKGN0cmwsIGN0cmwuaW52YWxpZGF0ZUxheW91dCksXHJcbiAgICAgICAgdW53YXRjaEF0dHJzID0gd2F0Y2hNZWRpYSgpO1xyXG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgdW53YXRjaE1lZGlhKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFdhdGNoZXMgZm9yIGNoYW5nZXMgaW4gbWVkaWEsIGludmFsaWRhdGluZyBsYXlvdXQgYXMgbmVjZXNzYXJ5LlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiB3YXRjaE1lZGlhKCkge1xyXG4gICAgICBmb3IgKHZhciBtZWRpYU5hbWUgaW4gJG1kQ29uc3RhbnQuTUVESUEpIHtcclxuICAgICAgICAkbWRNZWRpYShtZWRpYU5hbWUpOyAvLyBpbml0aWFsaXplXHJcbiAgICAgICAgJG1kTWVkaWEuZ2V0UXVlcnkoJG1kQ29uc3RhbnQuTUVESUFbbWVkaWFOYW1lXSlcclxuICAgICAgICAgICAgLmFkZExpc3RlbmVyKGludmFsaWRhdGVMYXlvdXQpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiAkbWRNZWRpYS53YXRjaFJlc3BvbnNpdmVBdHRyaWJ1dGVzKFxyXG4gICAgICAgICAgWydtZC1jb2xzJywgJ21kLXJvdy1oZWlnaHQnXSwgYXR0cnMsIGxheW91dElmTWVkaWFNYXRjaCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdW53YXRjaE1lZGlhKCkge1xyXG4gICAgICBjdHJsLmxheW91dERlbGVnYXRlID0gYW5ndWxhci5ub29wO1xyXG5cclxuICAgICAgdW53YXRjaEF0dHJzKCk7XHJcbiAgICAgIGZvciAodmFyIG1lZGlhTmFtZSBpbiAkbWRDb25zdGFudC5NRURJQSkge1xyXG4gICAgICAgICRtZE1lZGlhLmdldFF1ZXJ5KCRtZENvbnN0YW50Lk1FRElBW21lZGlhTmFtZV0pXHJcbiAgICAgICAgICAgIC5yZW1vdmVMaXN0ZW5lcihpbnZhbGlkYXRlTGF5b3V0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUGVyZm9ybXMgZ3JpZCBsYXlvdXQgaWYgdGhlIHByb3ZpZGVkIG1lZGlhTmFtZSBtYXRjaGVzIHRoZSBjdXJyZW50bHlcclxuICAgICAqIGFjdGl2ZSBtZWRpYSB0eXBlLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBsYXlvdXRJZk1lZGlhTWF0Y2gobWVkaWFOYW1lKSB7XHJcbiAgICAgIGlmIChtZWRpYU5hbWUgPT0gbnVsbCkge1xyXG4gICAgICAgIC8vIFRPRE8oc2h5bmRtYW4pOiBJdCB3b3VsZCBiZSBuaWNlIHRvIG9ubHkgbGF5b3V0IGlmIHdlIGhhdmVcclxuICAgICAgICAvLyBpbnN0YW5jZXMgb2YgYXR0cmlidXRlcyB1c2luZyB0aGlzIG1lZGlhIHR5cGVcclxuICAgICAgICBjdHJsLmludmFsaWRhdGVMYXlvdXQoKTtcclxuICAgICAgfSBlbHNlIGlmICgkbWRNZWRpYShtZWRpYU5hbWUpKSB7XHJcbiAgICAgICAgY3RybC5pbnZhbGlkYXRlTGF5b3V0KCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB2YXIgbGFzdExheW91dFByb3BzO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW52b2tlcyB0aGUgbGF5b3V0IGVuZ2luZSwgYW5kIHVzZXMgaXRzIHJlc3VsdHMgdG8gbGF5IG91dCBvdXJcclxuICAgICAqIHRpbGUgZWxlbWVudHMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSB0aWxlc0ludmFsaWRhdGVkIFdoZXRoZXIgdGlsZXMgaGF2ZSBiZWVuXHJcbiAgICAgKiAgICBhZGRlZC9yZW1vdmVkL21vdmVkIHNpbmNlIHRoZSBsYXN0IGxheW91dC4gVGhpcyBpcyB0byBhdm9pZCBzaXR1YXRpb25zXHJcbiAgICAgKiAgICB3aGVyZSB0aWxlcyBhcmUgcmVwbGFjZWQgd2l0aCBwcm9wZXJ0aWVzIGlkZW50aWNhbCB0byB0aGVpciByZW1vdmVkXHJcbiAgICAgKiAgICBjb3VudGVycGFydHMuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGxheW91dERlbGVnYXRlKHRpbGVzSW52YWxpZGF0ZWQpIHtcclxuICAgICAgdmFyIHRpbGVzID0gZ2V0VGlsZUVsZW1lbnRzKCk7XHJcbiAgICAgIHZhciBwcm9wcyA9IHtcclxuICAgICAgICB0aWxlU3BhbnM6IGdldFRpbGVTcGFucyh0aWxlcyksXHJcbiAgICAgICAgY29sQ291bnQ6IGdldENvbHVtbkNvdW50KCksXHJcbiAgICAgICAgcm93TW9kZTogZ2V0Um93TW9kZSgpLFxyXG4gICAgICAgIHJvd0hlaWdodDogZ2V0Um93SGVpZ2h0KCksXHJcbiAgICAgICAgZ3V0dGVyOiBnZXRHdXR0ZXIoKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWYgKCF0aWxlc0ludmFsaWRhdGVkICYmIGFuZ3VsYXIuZXF1YWxzKHByb3BzLCBsYXN0TGF5b3V0UHJvcHMpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgcGVyZm9ybWFuY2UgPVxyXG4gICAgICAgICRtZEdyaWRMYXlvdXQocHJvcHMuY29sQ291bnQsIHByb3BzLnRpbGVTcGFucywgdGlsZXMpXHJcbiAgICAgICAgICAubWFwKGZ1bmN0aW9uKHRpbGVQb3NpdGlvbnMsIHJvd0NvdW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgZ3JpZDoge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCxcclxuICAgICAgICAgICAgICAgIHN0eWxlOiBnZXRHcmlkU3R5bGUocHJvcHMuY29sQ291bnQsIHJvd0NvdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzLmd1dHRlciwgcHJvcHMucm93TW9kZSwgcHJvcHMucm93SGVpZ2h0KVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgdGlsZXM6IHRpbGVQb3NpdGlvbnMubWFwKGZ1bmN0aW9uKHBzLCBpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICBlbGVtZW50OiBhbmd1bGFyLmVsZW1lbnQodGlsZXNbaV0pLFxyXG4gICAgICAgICAgICAgICAgICBzdHlsZTogZ2V0VGlsZVN0eWxlKHBzLnBvc2l0aW9uLCBwcy5zcGFucyxcclxuICAgICAgICAgICAgICAgICAgICAgIHByb3BzLmNvbENvdW50LCBwcm9wcy5yb3dDb3VudCxcclxuICAgICAgICAgICAgICAgICAgICAgIHByb3BzLmd1dHRlciwgcHJvcHMucm93TW9kZSwgcHJvcHMucm93SGVpZ2h0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAucmVmbG93KClcclxuICAgICAgICAgIC5wZXJmb3JtYW5jZSgpO1xyXG5cclxuICAgICAgLy8gUmVwb3J0IGxheW91dFxyXG4gICAgICBzY29wZS5tZE9uTGF5b3V0KHtcclxuICAgICAgICAkZXZlbnQ6IHtcclxuICAgICAgICAgIHBlcmZvcm1hbmNlOiBwZXJmb3JtYW5jZVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBsYXN0TGF5b3V0UHJvcHMgPSBwcm9wcztcclxuICAgIH1cclxuXHJcbiAgICAvLyBVc2UgJGludGVycG9sYXRlIHRvIGRvIHNvbWUgc2ltcGxlIHN0cmluZyBpbnRlcnBvbGF0aW9uIGFzIGEgY29udmVuaWVuY2UuXHJcblxyXG4gICAgdmFyIHN0YXJ0U3ltYm9sID0gJGludGVycG9sYXRlLnN0YXJ0U3ltYm9sKCk7XHJcbiAgICB2YXIgZW5kU3ltYm9sID0gJGludGVycG9sYXRlLmVuZFN5bWJvbCgpO1xyXG5cclxuICAgIC8vIFJldHVybnMgYW4gZXhwcmVzc2lvbiB3cmFwcGVkIGluIHRoZSBpbnRlcnBvbGF0b3IncyBzdGFydCBhbmQgZW5kIHN5bWJvbHMuXHJcbiAgICBmdW5jdGlvbiBleHByKGV4cHJTdHIpIHtcclxuICAgICAgcmV0dXJuIHN0YXJ0U3ltYm9sICsgZXhwclN0ciArIGVuZFN5bWJvbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBUaGUgYW1vdW50IG9mIHNwYWNlIGEgc2luZ2xlIDF4MSB0aWxlIHdvdWxkIHRha2UgdXAgKGVpdGhlciB3aWR0aCBvciBoZWlnaHQpLCB1c2VkIGFzXHJcbiAgICAvLyBhIGJhc2lzIGZvciBvdGhlciBjYWxjdWxhdGlvbnMuIFRoaXMgY29uc2lzdHMgb2YgdGFraW5nIHRoZSBiYXNlIHNpemUgcGVyY2VudCAoYXMgd291bGQgYmVcclxuICAgIC8vIGlmIGV2ZW5seSBkaXZpZGluZyB0aGUgc2l6ZSBiZXR3ZWVuIGNlbGxzKSwgYW5kIHRoZW4gc3VidHJhY3RpbmcgdGhlIHNpemUgb2Ygb25lIGd1dHRlci5cclxuICAgIC8vIEhvd2V2ZXIsIHNpbmNlIHRoZXJlIGFyZSBubyBndXR0ZXJzIG9uIHRoZSBlZGdlcywgZWFjaCB0aWxlIG9ubHkgdXNlcyBhIGZyYXRpb25cclxuICAgIC8vIChndXR0ZXJTaGFyZSA9IG51bUd1dHRlcnMgLyBudW1DZWxscykgb2YgdGhlIGd1dHRlciBzaXplLiAoSW1hZ2luZSBoYXZpbmcgb25lIGd1dHRlciBwZXJcclxuICAgIC8vIHRpbGUsIGFuZCB0aGVuIGJyZWFraW5nIHVwIHRoZSBleHRyYSBndXR0ZXIgb24gdGhlIGVkZ2UgZXZlbmx5IGFtb25nIHRoZSBjZWxscykuXHJcbiAgICB2YXIgVU5JVCA9ICRpbnRlcnBvbGF0ZShleHByKCdzaGFyZScpICsgJyUgLSAoJyArIGV4cHIoJ2d1dHRlcicpICsgJyAqICcgKyBleHByKCdndXR0ZXJTaGFyZScpICsgJyknKTtcclxuXHJcbiAgICAvLyBUaGUgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbCBwb3NpdGlvbiBvZiBhIHRpbGUsIGUuZy4sIHRoZSAndG9wJyBvciAnbGVmdCcgcHJvcGVydHkgdmFsdWUuXHJcbiAgICAvLyBUaGUgcG9zaXRpb24gY29tZXMgdGhlIHNpemUgb2YgYSAxeDEgdGlsZSBwbHVzIGd1dHRlciBmb3IgZWFjaCBwcmV2aW91cyB0aWxlIGluIHRoZVxyXG4gICAgLy8gcm93L2NvbHVtbiAob2Zmc2V0KS5cclxuICAgIHZhciBQT1NJVElPTiAgPSAkaW50ZXJwb2xhdGUoJ2NhbGMoKCcgKyBleHByKCd1bml0JykgKyAnICsgJyArIGV4cHIoJ2d1dHRlcicpICsgJykgKiAnICsgZXhwcignb2Zmc2V0JykgKyAnKScpO1xyXG5cclxuICAgIC8vIFRoZSBhY3R1YWwgc2l6ZSBvZiBhIHRpbGUsIGUuZy4sIHdpZHRoIG9yIGhlaWdodCwgdGFraW5nIHJvd1NwYW4gb3IgY29sU3BhbiBpbnRvIGFjY291bnQuXHJcbiAgICAvLyBUaGlzIGlzIGNvbXB1dGVkIGJ5IG11bHRpcGx5aW5nIHRoZSBiYXNlIHVuaXQgYnkgdGhlIHJvd1NwYW4vY29sU3BhbiwgYW5kIHRoZW4gYWRkaW5nIGJhY2tcclxuICAgIC8vIGluIHRoZSBzcGFjZSB0aGF0IHRoZSBndXR0ZXIgd291bGQgbm9ybWFsbHkgaGF2ZSB1c2VkICh3aGljaCB3YXMgYWxyZWFkeSBhY2NvdW50ZWQgZm9yIGluXHJcbiAgICAvLyB0aGUgYmFzZSB1bml0IGNhbGN1bGF0aW9uKS5cclxuICAgIHZhciBESU1FTlNJT04gPSAkaW50ZXJwb2xhdGUoJ2NhbGMoKCcgKyBleHByKCd1bml0JykgKyAnKSAqICcgKyBleHByKCdzcGFuJykgKyAnICsgKCcgKyBleHByKCdzcGFuJykgKyAnIC0gMSkgKiAnICsgZXhwcignZ3V0dGVyJykgKyAnKScpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB0aGUgc3R5bGVzIGFwcGxpZWQgdG8gYSB0aWxlIGVsZW1lbnQgZGVzY3JpYmVkIGJ5IHRoZSBnaXZlbiBwYXJhbWV0ZXJzLlxyXG4gICAgICogQHBhcmFtIHt7cm93OiBudW1iZXIsIGNvbDogbnVtYmVyfX0gcG9zaXRpb24gVGhlIHJvdyBhbmQgY29sdW1uIGluZGljZXMgb2YgdGhlIHRpbGUuXHJcbiAgICAgKiBAcGFyYW0ge3tyb3c6IG51bWJlciwgY29sOiBudW1iZXJ9fSBzcGFucyBUaGUgcm93U3BhbiBhbmQgY29sU3BhbiBvZiB0aGUgdGlsZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2xDb3VudCBUaGUgbnVtYmVyIG9mIGNvbHVtbnMuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93Q291bnQgVGhlIG51bWJlciBvZiByb3dzLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGd1dHRlciBUaGUgYW1vdW50IG9mIHNwYWNlIGJldHdlZW4gdGlsZXMuIFRoaXMgd2lsbCBiZSBzb21ldGhpbmcgbGlrZVxyXG4gICAgICogICAgICc1cHgnIG9yICcyZW0nLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJvd01vZGUgVGhlIHJvdyBoZWlnaHQgbW9kZS4gQ2FuIGJlIG9uZSBvZjpcclxuICAgICAqICAgICAnZml4ZWQnOiBhbGwgcm93cyBoYXZlIGEgZml4ZWQgc2l6ZSwgZ2l2ZW4gYnkgcm93SGVpZ2h0LFxyXG4gICAgICogICAgICdyYXRpbyc6IHJvdyBoZWlnaHQgZGVmaW5lZCBhcyBhIHJhdGlvIHRvIHdpZHRoLCBvclxyXG4gICAgICogICAgICdmaXQnOiBmaXQgdG8gdGhlIGdyaWQtbGlzdCBlbGVtZW50IGhlaWdodCwgZGl2aW5kaW5nIGV2ZW5seSBhbW9uZyByb3dzLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSByb3dIZWlnaHQgVGhlIGhlaWdodCBvZiBhIHJvdy4gVGhpcyBpcyBvbmx5IHVzZWQgZm9yICdmaXhlZCcgbW9kZSBhbmRcclxuICAgICAqICAgICBmb3IgJ3JhdGlvJyBtb2RlLiBGb3IgJ3JhdGlvJyBtb2RlLCB0aGlzIGlzIHRoZSAqcmF0aW8qIG9mIHdpZHRoLXRvLWhlaWdodCAoZS5nLiwgMC43NSkuXHJcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBNYXAgb2YgQ1NTIHByb3BlcnRpZXMgdG8gYmUgYXBwbGllZCB0byB0aGUgc3R5bGUgZWxlbWVudC4gV2lsbCBkZWZpbmVcclxuICAgICAqICAgICB2YWx1ZXMgZm9yIHRvcCwgbGVmdCwgd2lkdGgsIGhlaWdodCwgbWFyZ2luVG9wLCBhbmQgcGFkZGluZ1RvcC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0VGlsZVN0eWxlKHBvc2l0aW9uLCBzcGFucywgY29sQ291bnQsIHJvd0NvdW50LCBndXR0ZXIsIHJvd01vZGUsIHJvd0hlaWdodCkge1xyXG4gICAgICAvLyBUT0RPKHNoeW5kbWFuKTogVGhlcmUgYXJlIHN0eWxlIGNhY2hpbmcgb3Bwb3J0dW5pdGllcyBoZXJlLlxyXG5cclxuICAgICAgLy8gUGVyY2VudCBvZiB0aGUgYXZhaWxhYmxlIGhvcml6b250YWwgc3BhY2UgdGhhdCBvbmUgY29sdW1uIHRha2VzIHVwLlxyXG4gICAgICB2YXIgaFNoYXJlID0gKDEgLyBjb2xDb3VudCkgKiAxMDA7XHJcblxyXG4gICAgICAvLyBGcmFjdGlvbiBvZiB0aGUgZ3V0dGVyIHNpemUgdGhhdCBlYWNoIGNvbHVtbiB0YWtlcyB1cC5cclxuICAgICAgdmFyIGhHdXR0ZXJTaGFyZSA9IChjb2xDb3VudCAtIDEpIC8gY29sQ291bnQ7XHJcblxyXG4gICAgICAvLyBCYXNlIGhvcml6b250YWwgc2l6ZSBvZiBhIGNvbHVtbi5cclxuICAgICAgdmFyIGhVbml0ID0gVU5JVCh7c2hhcmU6IGhTaGFyZSwgZ3V0dGVyU2hhcmU6IGhHdXR0ZXJTaGFyZSwgZ3V0dGVyOiBndXR0ZXJ9KTtcclxuXHJcbiAgICAgIC8vIFRoZSB3aWR0aCBhbmQgaG9yaXpvbnRhbCBwb3NpdGlvbiBvZiBlYWNoIHRpbGUgaXMgYWx3YXlzIGNhbGN1bGF0ZWQgdGhlIHNhbWUgd2F5LCBidXQgdGhlXHJcbiAgICAgIC8vIGhlaWdodCBhbmQgdmVydGljYWwgcG9zaXRpb24gZGVwZW5kcyBvbiB0aGUgcm93TW9kZS5cclxuICAgICAgdmFyIHN0eWxlID0ge1xyXG4gICAgICAgIGxlZnQ6IFBPU0lUSU9OKHsgdW5pdDogaFVuaXQsIG9mZnNldDogcG9zaXRpb24uY29sLCBndXR0ZXI6IGd1dHRlciB9KSxcclxuICAgICAgICB3aWR0aDogRElNRU5TSU9OKHsgdW5pdDogaFVuaXQsIHNwYW46IHNwYW5zLmNvbCwgZ3V0dGVyOiBndXR0ZXIgfSksXHJcbiAgICAgICAgLy8gcmVzZXRzXHJcbiAgICAgICAgcGFkZGluZ1RvcDogJycsXHJcbiAgICAgICAgbWFyZ2luVG9wOiAnJyxcclxuICAgICAgICB0b3A6ICcnLFxyXG4gICAgICAgIGhlaWdodDogJydcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHN3aXRjaCAocm93TW9kZSkge1xyXG4gICAgICAgIGNhc2UgJ2ZpeGVkJzpcclxuICAgICAgICAgIC8vIEluIGZpeGVkIG1vZGUsIHNpbXBseSB1c2UgdGhlIGdpdmVuIHJvd0hlaWdodC5cclxuICAgICAgICAgIHN0eWxlLnRvcCA9IFBPU0lUSU9OKHsgdW5pdDogcm93SGVpZ2h0LCBvZmZzZXQ6IHBvc2l0aW9uLnJvdywgZ3V0dGVyOiBndXR0ZXIgfSk7XHJcbiAgICAgICAgICBzdHlsZS5oZWlnaHQgPSBESU1FTlNJT04oeyB1bml0OiByb3dIZWlnaHQsIHNwYW46IHNwYW5zLnJvdywgZ3V0dGVyOiBndXR0ZXIgfSk7XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAncmF0aW8nOlxyXG4gICAgICAgICAgLy8gUGVyY2VudCBvZiB0aGUgYXZhaWxhYmxlIHZlcnRpY2FsIHNwYWNlIHRoYXQgb25lIHJvdyB0YWtlcyB1cC4gSGVyZSwgcm93SGVpZ2h0IGhvbGRzXHJcbiAgICAgICAgICAvLyB0aGUgcmF0aW8gdmFsdWUuIEZvciBleGFtcGxlLCBpZiB0aGUgd2lkdGg6aGVpZ2h0IHJhdGlvIGlzIDQ6Mywgcm93SGVpZ2h0ID0gMS4zMzMuXHJcbiAgICAgICAgICB2YXIgdlNoYXJlID0gaFNoYXJlIC8gcm93SGVpZ2h0O1xyXG5cclxuICAgICAgICAgIC8vIEJhc2UgdmVyaXRjYWwgc2l6ZSBvZiBhIHJvdy5cclxuICAgICAgICAgIHZhciB2VW5pdCA9IFVOSVQoeyBzaGFyZTogdlNoYXJlLCBndXR0ZXJTaGFyZTogaEd1dHRlclNoYXJlLCBndXR0ZXI6IGd1dHRlciB9KTtcclxuXHJcbiAgICAgICAgICAvLyBwYWRpZG5nVG9wIGFuZCBtYXJnaW5Ub3AgYXJlIHVzZWQgdG8gbWFpbnRhaW4gdGhlIGdpdmVuIGFzcGVjdCByYXRpbywgYXNcclxuICAgICAgICAgIC8vIGEgcGVyY2VudGFnZS1iYXNlZCB2YWx1ZSBmb3IgdGhlc2UgcHJvcGVydGllcyBpcyBhcHBsaWVkIHRvIHRoZSAqd2lkdGgqIG9mIHRoZVxyXG4gICAgICAgICAgLy8gY29udGFpbmluZyBibG9jay4gU2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIvYm94Lmh0bWwjbWFyZ2luLXByb3BlcnRpZXNcclxuICAgICAgICAgIHN0eWxlLnBhZGRpbmdUb3AgPSBESU1FTlNJT04oeyB1bml0OiB2VW5pdCwgc3Bhbjogc3BhbnMucm93LCBndXR0ZXI6IGd1dHRlcn0pO1xyXG4gICAgICAgICAgc3R5bGUubWFyZ2luVG9wID0gUE9TSVRJT04oeyB1bml0OiB2VW5pdCwgb2Zmc2V0OiBwb3NpdGlvbi5yb3csIGd1dHRlcjogZ3V0dGVyIH0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ2ZpdCc6XHJcbiAgICAgICAgICAvLyBGcmFjdGlvbiBvZiB0aGUgZ3V0dGVyIHNpemUgdGhhdCBlYWNoIGNvbHVtbiB0YWtlcyB1cC5cclxuICAgICAgICAgIHZhciB2R3V0dGVyU2hhcmUgPSAocm93Q291bnQgLSAxKSAvIHJvd0NvdW50O1xyXG5cclxuICAgICAgICAgIC8vIFBlcmNlbnQgb2YgdGhlIGF2YWlsYWJsZSB2ZXJ0aWNhbCBzcGFjZSB0aGF0IG9uZSByb3cgdGFrZXMgdXAuXHJcbiAgICAgICAgICB2YXIgdlNoYXJlID0gKDEgLyByb3dDb3VudCkgKiAxMDA7XHJcblxyXG4gICAgICAgICAgLy8gQmFzZSB2ZXJ0aWNhbCBzaXplIG9mIGEgcm93LlxyXG4gICAgICAgICAgdmFyIHZVbml0ID0gVU5JVCh7c2hhcmU6IHZTaGFyZSwgZ3V0dGVyU2hhcmU6IHZHdXR0ZXJTaGFyZSwgZ3V0dGVyOiBndXR0ZXJ9KTtcclxuXHJcbiAgICAgICAgICBzdHlsZS50b3AgPSBQT1NJVElPTih7dW5pdDogdlVuaXQsIG9mZnNldDogcG9zaXRpb24ucm93LCBndXR0ZXI6IGd1dHRlcn0pO1xyXG4gICAgICAgICAgc3R5bGUuaGVpZ2h0ID0gRElNRU5TSU9OKHt1bml0OiB2VW5pdCwgc3Bhbjogc3BhbnMucm93LCBndXR0ZXI6IGd1dHRlcn0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBzdHlsZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRHcmlkU3R5bGUoY29sQ291bnQsIHJvd0NvdW50LCBndXR0ZXIsIHJvd01vZGUsIHJvd0hlaWdodCkge1xyXG4gICAgICB2YXIgc3R5bGUgPSB7XHJcbiAgICAgICAgaGVpZ2h0OiAnJyxcclxuICAgICAgICBwYWRkaW5nQm90dG9tOiAnJ1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgc3dpdGNoKHJvd01vZGUpIHtcclxuICAgICAgICBjYXNlICdmaXhlZCc6XHJcbiAgICAgICAgICBzdHlsZS5oZWlnaHQgPSBESU1FTlNJT04oeyB1bml0OiByb3dIZWlnaHQsIHNwYW46IHJvd0NvdW50LCBndXR0ZXI6IGd1dHRlciB9KTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlICdyYXRpbyc6XHJcbiAgICAgICAgICAvLyByb3dIZWlnaHQgaXMgd2lkdGggLyBoZWlnaHRcclxuICAgICAgICAgIHZhciBoR3V0dGVyU2hhcmUgPSBjb2xDb3VudCA9PT0gMSA/IDAgOiAoY29sQ291bnQgLSAxKSAvIGNvbENvdW50LFxyXG4gICAgICAgICAgICAgIGhTaGFyZSA9ICgxIC8gY29sQ291bnQpICogMTAwLFxyXG4gICAgICAgICAgICAgIHZTaGFyZSA9IGhTaGFyZSAqICgxIC8gcm93SGVpZ2h0KSxcclxuICAgICAgICAgICAgICB2VW5pdCA9IFVOSVQoeyBzaGFyZTogdlNoYXJlLCBndXR0ZXJTaGFyZTogaEd1dHRlclNoYXJlLCBndXR0ZXI6IGd1dHRlciB9KTtcclxuXHJcbiAgICAgICAgICBzdHlsZS5wYWRkaW5nQm90dG9tID0gRElNRU5TSU9OKHsgdW5pdDogdlVuaXQsIHNwYW46IHJvd0NvdW50LCBndXR0ZXI6IGd1dHRlcn0pO1xyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJ2ZpdCc6XHJcbiAgICAgICAgICAvLyBub29wLCBhcyB0aGUgaGVpZ2h0IGlzIHVzZXIgc2V0XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHN0eWxlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFRpbGVFbGVtZW50cygpIHtcclxuICAgICAgcmV0dXJuIFtdLmZpbHRlci5jYWxsKGVsZW1lbnQuY2hpbGRyZW4oKSwgZnVuY3Rpb24oZWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIGVsZS50YWdOYW1lID09ICdNRC1HUklELVRJTEUnO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldHMgYW4gYXJyYXkgb2Ygb2JqZWN0cyBjb250YWluaW5nIHRoZSByb3dzcGFuIGFuZCBjb2xzcGFuIGZvciBlYWNoIHRpbGUuXHJcbiAgICAgKiBAcmV0dXJucyB7QXJyYXk8e3JvdzogbnVtYmVyLCBjb2w6IG51bWJlcn0+fVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXRUaWxlU3BhbnModGlsZUVsZW1lbnRzKSB7XHJcbiAgICAgIHJldHVybiBbXS5tYXAuY2FsbCh0aWxlRWxlbWVudHMsIGZ1bmN0aW9uKGVsZSkge1xyXG4gICAgICAgIHZhciBjdHJsID0gYW5ndWxhci5lbGVtZW50KGVsZSkuY29udHJvbGxlcignbWRHcmlkVGlsZScpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICByb3c6IHBhcnNlSW50KFxyXG4gICAgICAgICAgICAgICRtZE1lZGlhLmdldFJlc3BvbnNpdmVBdHRyaWJ1dGUoY3RybC4kYXR0cnMsICdtZC1yb3dzcGFuJyksIDEwKSB8fCAxLFxyXG4gICAgICAgICAgY29sOiBwYXJzZUludChcclxuICAgICAgICAgICAgICAkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGN0cmwuJGF0dHJzLCAnbWQtY29sc3BhbicpLCAxMCkgfHwgMVxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldENvbHVtbkNvdW50KCkge1xyXG4gICAgICB2YXIgY29sQ291bnQgPSBwYXJzZUludCgkbWRNZWRpYS5nZXRSZXNwb25zaXZlQXR0cmlidXRlKGF0dHJzLCAnbWQtY29scycpLCAxMCk7XHJcbiAgICAgIGlmIChpc05hTihjb2xDb3VudCkpIHtcclxuICAgICAgICB0aHJvdyAnbWQtZ3JpZC1saXN0OiBtZC1jb2xzIGF0dHJpYnV0ZSB3YXMgbm90IGZvdW5kLCBvciBjb250YWluZWQgYSBub24tbnVtZXJpYyB2YWx1ZSc7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGNvbENvdW50O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldEd1dHRlcigpIHtcclxuICAgICAgcmV0dXJuIGFwcGx5RGVmYXVsdFVuaXQoJG1kTWVkaWEuZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZShhdHRycywgJ21kLWd1dHRlcicpIHx8IDEpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFJvd0hlaWdodCgpIHtcclxuICAgICAgdmFyIHJvd0hlaWdodCA9ICRtZE1lZGlhLmdldFJlc3BvbnNpdmVBdHRyaWJ1dGUoYXR0cnMsICdtZC1yb3ctaGVpZ2h0Jyk7XHJcbiAgICAgIHN3aXRjaCAoZ2V0Um93TW9kZSgpKSB7XHJcbiAgICAgICAgY2FzZSAnZml4ZWQnOlxyXG4gICAgICAgICAgcmV0dXJuIGFwcGx5RGVmYXVsdFVuaXQocm93SGVpZ2h0KTtcclxuICAgICAgICBjYXNlICdyYXRpbyc6XHJcbiAgICAgICAgICB2YXIgd2hSYXRpbyA9IHJvd0hlaWdodC5zcGxpdCgnOicpO1xyXG4gICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQod2hSYXRpb1swXSkgLyBwYXJzZUZsb2F0KHdoUmF0aW9bMV0pO1xyXG4gICAgICAgIGNhc2UgJ2ZpdCc6XHJcbiAgICAgICAgICByZXR1cm4gMDsgLy8gTi9BXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRSb3dNb2RlKCkge1xyXG4gICAgICB2YXIgcm93SGVpZ2h0ID0gJG1kTWVkaWEuZ2V0UmVzcG9uc2l2ZUF0dHJpYnV0ZShhdHRycywgJ21kLXJvdy1oZWlnaHQnKTtcclxuICAgICAgaWYgKHJvd0hlaWdodCA9PSAnZml0Jykge1xyXG4gICAgICAgIHJldHVybiAnZml0JztcclxuICAgICAgfSBlbHNlIGlmIChyb3dIZWlnaHQuaW5kZXhPZignOicpICE9PSAtMSkge1xyXG4gICAgICAgIHJldHVybiAncmF0aW8nO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiAnZml4ZWQnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gYXBwbHlEZWZhdWx0VW5pdCh2YWwpIHtcclxuICAgICAgcmV0dXJuIC9cXEQkLy50ZXN0KHZhbCkgPyB2YWwgOiB2YWwgKyAncHgnO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5HcmlkTGlzdERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJGludGVycG9sYXRlXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbWRHcmlkTGF5b3V0XCIsIFwiJG1kTWVkaWFcIl07XHJcblxyXG4vKiBAbmdJbmplY3QgKi9cclxuZnVuY3Rpb24gR3JpZExpc3RDb250cm9sbGVyKCR0aW1lb3V0KSB7XHJcbiAgdGhpcy5sYXlvdXRJbnZhbGlkYXRlZCA9IGZhbHNlO1xyXG4gIHRoaXMudGlsZXNJbnZhbGlkYXRlZCA9IGZhbHNlO1xyXG4gIHRoaXMuJHRpbWVvdXRfID0gJHRpbWVvdXQ7XHJcbiAgdGhpcy5sYXlvdXREZWxlZ2F0ZSA9IGFuZ3VsYXIubm9vcDtcclxufVxyXG5HcmlkTGlzdENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiR0aW1lb3V0XCJdO1xyXG5cclxuR3JpZExpc3RDb250cm9sbGVyLnByb3RvdHlwZSA9IHtcclxuICBpbnZhbGlkYXRlVGlsZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy50aWxlc0ludmFsaWRhdGVkID0gdHJ1ZTtcclxuICAgIHRoaXMuaW52YWxpZGF0ZUxheW91dCgpO1xyXG4gIH0sXHJcblxyXG4gIGludmFsaWRhdGVMYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKHRoaXMubGF5b3V0SW52YWxpZGF0ZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5sYXlvdXRJbnZhbGlkYXRlZCA9IHRydWU7XHJcbiAgICB0aGlzLiR0aW1lb3V0Xyhhbmd1bGFyLmJpbmQodGhpcywgdGhpcy5sYXlvdXQpKTtcclxuICB9LFxyXG5cclxuICBsYXlvdXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5sYXlvdXREZWxlZ2F0ZSh0aGlzLnRpbGVzSW52YWxpZGF0ZWQpO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgdGhpcy5sYXlvdXRJbnZhbGlkYXRlZCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnRpbGVzSW52YWxpZGF0ZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG5cclxuLyogQG5nSW5qZWN0ICovXHJcbmZ1bmN0aW9uIEdyaWRMYXlvdXRGYWN0b3J5KCRtZFV0aWwpIHtcclxuICB2YXIgZGVmYXVsdEFuaW1hdG9yID0gR3JpZFRpbGVBbmltYXRvcjtcclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHRoZSByZWZsb3cgYW5pbWF0b3IgY2FsbGJhY2tcclxuICAgKi9cclxuICBHcmlkTGF5b3V0LmFuaW1hdGVXaXRoID0gZnVuY3Rpb24oY3VzdG9tQW5pbWF0b3IpIHtcclxuICAgIGRlZmF1bHRBbmltYXRvciA9ICFhbmd1bGFyLmlzRnVuY3Rpb24oY3VzdG9tQW5pbWF0b3IpID8gR3JpZFRpbGVBbmltYXRvciA6IGN1c3RvbUFuaW1hdG9yO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiBHcmlkTGF5b3V0O1xyXG5cclxuICAvKipcclxuICAgKiBQdWJsaXNoIGxheW91dCBmdW5jdGlvblxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIEdyaWRMYXlvdXQoY29sQ291bnQsIHRpbGVTcGFucykge1xyXG4gICAgICB2YXIgc2VsZiwgbGF5b3V0SW5mbywgZ3JpZFN0eWxlcywgbGF5b3V0VGltZSwgbWFwVGltZSwgcmVmbG93VGltZTtcclxuXHJcbiAgICAgIGxheW91dFRpbWUgPSAkbWRVdGlsLnRpbWUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGF5b3V0SW5mbyA9IGNhbGN1bGF0ZUdyaWRGb3IoY29sQ291bnQsIHRpbGVTcGFucyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHNlbGYgPSB7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFuIGFycmF5IG9mIG9iamVjdHMgZGVzY3JpYmluZyBlYWNoIHRpbGUncyBwb3NpdGlvbiBpbiB0aGUgZ3JpZC5cclxuICAgICAgICAgKi9cclxuICAgICAgICBsYXlvdXRJbmZvOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHJldHVybiBsYXlvdXRJbmZvO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIE1hcHMgZ3JpZCBwb3NpdGlvbmluZyB0byBhbiBlbGVtZW50IGFuZCBhIHNldCBvZiBzdHlsZXMgdXNpbmcgdGhlXHJcbiAgICAgICAgICogcHJvdmlkZWQgdXBkYXRlRm4uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgbWFwOiBmdW5jdGlvbih1cGRhdGVGbikge1xyXG4gICAgICAgICAgbWFwVGltZSA9ICRtZFV0aWwudGltZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGluZm8gPSBzZWxmLmxheW91dEluZm8oKTtcclxuICAgICAgICAgICAgZ3JpZFN0eWxlcyA9IHVwZGF0ZUZuKGluZm8ucG9zaXRpb25pbmcsIGluZm8ucm93Q291bnQpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZWZhdWx0IGFuaW1hdG9yIHNpbXBseSBzZXRzIHRoZSBlbGVtZW50LmNzcyggPHN0eWxlcz4gKS4gQW4gYWx0ZXJuYXRlXHJcbiAgICAgICAgICogYW5pbWF0b3IgY2FuIGJlIHByb3ZpZGVkIGFzIGFuIGFyZ3VtZW50LiBUaGUgZnVuY3Rpb24gaGFzIHRoZSBmb2xsb3dpbmdcclxuICAgICAgICAgKiBzaWduYXR1cmU6XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICBmdW5jdGlvbih7Z3JpZDoge2VsZW1lbnQ6IEpRTGl0ZSwgc3R5bGU6IE9iamVjdH0sIHRpbGVzOiBBcnJheTx7ZWxlbWVudDogSlFMaXRlLCBzdHlsZTogT2JqZWN0fT4pXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmVmbG93OiBmdW5jdGlvbihhbmltYXRvckZuKSB7XHJcbiAgICAgICAgICByZWZsb3dUaW1lID0gJG1kVXRpbC50aW1lKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgYW5pbWF0b3IgPSBhbmltYXRvckZuIHx8IGRlZmF1bHRBbmltYXRvcjtcclxuICAgICAgICAgICAgYW5pbWF0b3IoZ3JpZFN0eWxlcy5ncmlkLCBncmlkU3R5bGVzLnRpbGVzKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGltaW5nIGZvciB0aGUgbW9zdCByZWNlbnQgbGF5b3V0IHJ1bi5cclxuICAgICAgICAgKi9cclxuICAgICAgICBwZXJmb3JtYW5jZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0aWxlQ291bnQ6IHRpbGVTcGFucy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGxheW91dFRpbWU6IGxheW91dFRpbWUsXHJcbiAgICAgICAgICAgIG1hcFRpbWU6IG1hcFRpbWUsXHJcbiAgICAgICAgICAgIHJlZmxvd1RpbWU6IHJlZmxvd1RpbWUsXHJcbiAgICAgICAgICAgIHRvdGFsVGltZTogbGF5b3V0VGltZSArIG1hcFRpbWUgKyByZWZsb3dUaW1lXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVmYXVsdCBHcmlkbGlzdCBhbmltYXRvciBzaW1wbGUgc2V0cyB0aGUgY3NzIGZvciBlYWNoIGVsZW1lbnQ7XHJcbiAgICogTk9URTogYW55IHRyYW5zaXRpb25zIGVmZmVjdHMgbXVzdCBiZSBtYW51YWxseSBzZXQgaW4gdGhlIENTUy5cclxuICAgKiBlLmcuXHJcbiAgICpcclxuICAgKiAgbWQtZ3JpZC10aWxlIHtcclxuICAgKiAgICB0cmFuc2l0aW9uOiBhbGwgNzAwbXMgZWFzZS1vdXQgNTBtcztcclxuICAgKiAgfVxyXG4gICAqXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gR3JpZFRpbGVBbmltYXRvcihncmlkLCB0aWxlcykge1xyXG4gICAgZ3JpZC5lbGVtZW50LmNzcyhncmlkLnN0eWxlKTtcclxuICAgIHRpbGVzLmZvckVhY2goZnVuY3Rpb24odCkge1xyXG4gICAgICB0LmVsZW1lbnQuY3NzKHQuc3R5bGUpO1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGN1bGF0ZXMgdGhlIHBvc2l0aW9ucyBvZiB0aWxlcy5cclxuICAgKlxyXG4gICAqIFRoZSBhbGdvcml0aG0gd29ya3MgYXMgZm9sbG93czpcclxuICAgKiAgICBBbiBBcnJheTxOdW1iZXI+IHdpdGggbGVuZ3RoIGNvbENvdW50IChzcGFjZVRyYWNrZXIpIGtlZXBzIHRyYWNrIG9mXHJcbiAgICogICAgYXZhaWxhYmxlIHRpbGluZyBwb3NpdGlvbnMsIHdoZXJlIGVsZW1lbnRzIG9mIHZhbHVlIDAgcmVwcmVzZW50cyBhblxyXG4gICAqICAgIGVtcHR5IHBvc2l0aW9uLiBTcGFjZSBmb3IgYSB0aWxlIGlzIHJlc2VydmVkIGJ5IGZpbmRpbmcgYSBzZXF1ZW5jZSBvZlxyXG4gICAqICAgIDBzIHdpdGggbGVuZ3RoIDw9IHRoYW4gdGhlIHRpbGUncyBjb2xzcGFuLiBXaGVuIHN1Y2ggYSBzcGFjZSBoYXMgYmVlblxyXG4gICAqICAgIGZvdW5kLCB0aGUgb2NjdXBpZWQgdGlsZSBwb3NpdGlvbnMgYXJlIGluY3JlbWVudGVkIGJ5IHRoZSB0aWxlJ3NcclxuICAgKiAgICByb3dzcGFuIHZhbHVlLCBhcyB0aGVzZSBwb3NpdGlvbnMgaGF2ZSBiZWNvbWUgdW5hdmFpbGFibGUgZm9yIHRoYXRcclxuICAgKiAgICBtYW55IHJvd3MuXHJcbiAgICpcclxuICAgKiAgICBJZiB0aGUgZW5kIG9mIGEgcm93IGhhcyBiZWVuIHJlYWNoZWQgd2l0aG91dCBmaW5kaW5nIHNwYWNlIGZvciB0aGVcclxuICAgKiAgICB0aWxlLCBzcGFjZVRyYWNrZXIncyBlbGVtZW50cyBhcmUgZWFjaCBkZWNyZW1lbnRlZCBieSAxIHRvIGEgbWluaW11bVxyXG4gICAqICAgIG9mIDAuIFJvd3MgYXJlIHNlYXJjaGVkIGluIHRoaXMgZmFzaGlvbiB1bnRpbCBzcGFjZSBpcyBmb3VuZC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBjYWxjdWxhdGVHcmlkRm9yKGNvbENvdW50LCB0aWxlU3BhbnMpIHtcclxuICAgIHZhciBjdXJDb2wgPSAwLFxyXG4gICAgICAgIGN1clJvdyA9IDAsXHJcbiAgICAgICAgc3BhY2VUcmFja2VyID0gbmV3U3BhY2VUcmFja2VyKCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcG9zaXRpb25pbmc6IHRpbGVTcGFucy5tYXAoZnVuY3Rpb24oc3BhbnMsIGkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3BhbnM6IHNwYW5zLFxyXG4gICAgICAgICAgcG9zaXRpb246IHJlc2VydmVTcGFjZShzcGFucywgaSlcclxuICAgICAgICB9O1xyXG4gICAgICB9KSxcclxuICAgICAgcm93Q291bnQ6IGN1clJvdyArIE1hdGgubWF4LmFwcGx5KE1hdGgsIHNwYWNlVHJhY2tlcilcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gcmVzZXJ2ZVNwYWNlKHNwYW5zLCBpKSB7XHJcbiAgICAgIGlmIChzcGFucy5jb2wgPiBjb2xDb3VudCkge1xyXG4gICAgICAgIHRocm93ICdtZC1ncmlkLWxpc3Q6IFRpbGUgYXQgcG9zaXRpb24gJyArIGkgKyAnIGhhcyBhIGNvbHNwYW4gJyArXHJcbiAgICAgICAgICAgICcoJyArIHNwYW5zLmNvbCArICcpIHRoYXQgZXhjZWVkcyB0aGUgY29sdW1uIGNvdW50ICcgK1xyXG4gICAgICAgICAgICAnKCcgKyBjb2xDb3VudCArICcpJztcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHN0YXJ0ID0gMCxcclxuICAgICAgICAgIGVuZCA9IDA7XHJcblxyXG4gICAgICAvLyBUT0RPKHNoeW5kbWFuKTogVGhpcyBsb29wIGlzbid0IHN0cmljdGx5IG5lY2Vzc2FyeSBpZiB5b3UgY2FuXHJcbiAgICAgIC8vIGRldGVybWluZSB0aGUgbWluaW11bSBudW1iZXIgb2Ygcm93cyBiZWZvcmUgYSBzcGFjZSBvcGVucyB1cC4gVG8gZG9cclxuICAgICAgLy8gdGhpcywgcmVjb2duaXplIHRoYXQgeW91J3ZlIGl0ZXJhdGVkIGFjcm9zcyBhbiBlbnRpcmUgcm93IGxvb2tpbmcgZm9yXHJcbiAgICAgIC8vIHNwYWNlLCBhbmQgaWYgc28gZmFzdC1mb3J3YXJkIGJ5IHRoZSBtaW5pbXVtIHJvd1NwYW4gY291bnQuIFJlcGVhdFxyXG4gICAgICAvLyB1bnRpbCB0aGUgcmVxdWlyZWQgc3BhY2Ugb3BlbnMgdXAuXHJcbiAgICAgIHdoaWxlIChlbmQgLSBzdGFydCA8IHNwYW5zLmNvbCkge1xyXG4gICAgICAgIGlmIChjdXJDb2wgPj0gY29sQ291bnQpIHtcclxuICAgICAgICAgIG5leHRSb3coKTtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3RhcnQgPSBzcGFjZVRyYWNrZXIuaW5kZXhPZigwLCBjdXJDb2wpO1xyXG4gICAgICAgIGlmIChzdGFydCA9PT0gLTEgfHwgKGVuZCA9IGZpbmRFbmQoc3RhcnQgKyAxKSkgPT09IC0xKSB7XHJcbiAgICAgICAgICBzdGFydCA9IGVuZCA9IDA7XHJcbiAgICAgICAgICBuZXh0Um93KCk7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGN1ckNvbCA9IGVuZCArIDE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGFkanVzdFJvdyhzdGFydCwgc3BhbnMuY29sLCBzcGFucy5yb3cpO1xyXG4gICAgICBjdXJDb2wgPSBzdGFydCArIHNwYW5zLmNvbDtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgY29sOiBzdGFydCxcclxuICAgICAgICByb3c6IGN1clJvd1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG5leHRSb3coKSB7XHJcbiAgICAgIGN1ckNvbCA9IDA7XHJcbiAgICAgIGN1clJvdysrO1xyXG4gICAgICBhZGp1c3RSb3coMCwgY29sQ291bnQsIC0xKTsgLy8gRGVjcmVtZW50IHJvdyBzcGFucyBieSBvbmVcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZGp1c3RSb3coZnJvbSwgY29scywgYnkpIHtcclxuICAgICAgZm9yICh2YXIgaSA9IGZyb207IGkgPCBmcm9tICsgY29sczsgaSsrKSB7XHJcbiAgICAgICAgc3BhY2VUcmFja2VyW2ldID0gTWF0aC5tYXgoc3BhY2VUcmFja2VyW2ldICsgYnksIDApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZmluZEVuZChzdGFydCkge1xyXG4gICAgICB2YXIgaTtcclxuICAgICAgZm9yIChpID0gc3RhcnQ7IGkgPCBzcGFjZVRyYWNrZXIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoc3BhY2VUcmFja2VyW2ldICE9PSAwKSB7XHJcbiAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChpID09PSBzcGFjZVRyYWNrZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBuZXdTcGFjZVRyYWNrZXIoKSB7XHJcbiAgICAgIHZhciB0cmFja2VyID0gW107XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29sQ291bnQ7IGkrKykge1xyXG4gICAgICAgIHRyYWNrZXIucHVzaCgwKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdHJhY2tlcjtcclxuICAgIH1cclxuICB9XHJcbn1cclxuR3JpZExheW91dEZhY3RvcnkuJGluamVjdCA9IFtcIiRtZFV0aWxcIl07XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZEdyaWRUaWxlXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5ncmlkTGlzdFxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGlsZXMgY29udGFpbiB0aGUgY29udGVudCBvZiBhbiBgbWQtZ3JpZC1saXN0YC4gVGhleSBzcGFuIG9uZSBvciBtb3JlIGdyaWRcclxuICogY2VsbHMgdmVydGljYWxseSBvciBob3Jpem9udGFsbHksIGFuZCB1c2UgYG1kLWdyaWQtdGlsZS17Zm9vdGVyLGhlYWRlcn1gIHRvXHJcbiAqIGRpc3BsYXkgc2Vjb25kYXJ5IGNvbnRlbnQuXHJcbiAqXHJcbiAqICMjIyBSZXNwb25zaXZlIEF0dHJpYnV0ZXNcclxuICpcclxuICogVGhlIGBtZC1ncmlkLXRpbGVgIGRpcmVjdGl2ZSBzdXBwb3J0cyBcInJlc3BvbnNpdmVcIiBhdHRyaWJ1dGVzLCB3aGljaCBhbGxvd1xyXG4gKiBkaWZmZXJlbnQgYG1kLXJvd3NwYW5gIGFuZCBgbWQtY29sc3BhbmAgdmFsdWVzIGRlcGVuZGluZyBvbiB0aGUgY3VycmVudGx5XHJcbiAqIG1hdGNoaW5nIG1lZGlhIHF1ZXJ5IChhcyBkZWZpbmVkIGluIGAkbWRDb25zdGFudC5NRURJQWApLlxyXG4gKlxyXG4gKiBJbiBvcmRlciB0byBzZXQgYSByZXNwb25zaXZlIGF0dHJpYnV0ZSwgZmlyc3QgZGVmaW5lIHRoZSBmYWxsYmFjayB2YWx1ZSB3aXRoXHJcbiAqIHRoZSBzdGFuZGFyZCBhdHRyaWJ1dGUgbmFtZSwgdGhlbiBhZGQgYWRkaXRpb25hbCBhdHRyaWJ1dGVzIHdpdGggdGhlXHJcbiAqIGZvbGxvd2luZyBjb252ZW50aW9uOiBge2Jhc2UtYXR0cmlidXRlLW5hbWV9LXttZWRpYS1xdWVyeS1uYW1lfT1cInt2YWx1ZX1cImBcclxuICogKGllLiBgbWQtY29sc3Bhbi1zbT1cIjRcImApXHJcbiAqXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtY29sc3BhbiBUaGUgbnVtYmVyIG9mIGNvbHVtbnMgdG8gc3BhbiAoZGVmYXVsdCAxKS4gQ2Fubm90XHJcbiAqICAgIGV4Y2VlZCB0aGUgbnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhlIGdyaWQuIFN1cHBvcnRzIGludGVycG9sYXRpb24uXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtcm93c3BhbiBUaGUgbnVtYmVyIG9mIHJvd3MgdG8gc3BhbiAoZGVmYXVsdCAxKS4gU3VwcG9ydHNcclxuICogICAgIGludGVycG9sYXRpb24uXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiBXaXRoIGhlYWRlcjpcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLWdyaWQtdGlsZT5cclxuICogICA8bWQtZ3JpZC10aWxlLWhlYWRlcj5cclxuICogICAgIDxoMz5UaGlzIGlzIGEgaGVhZGVyPC9oMz5cclxuICogICA8L21kLWdyaWQtdGlsZS1oZWFkZXI+XHJcbiAqIDwvbWQtZ3JpZC10aWxlPlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIFdpdGggZm9vdGVyOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC10aWxlPlxyXG4gKiAgIDxtZC1ncmlkLXRpbGUtZm9vdGVyPlxyXG4gKiAgICAgPGgzPlRoaXMgaXMgYSBmb290ZXI8L2gzPlxyXG4gKiAgIDwvbWQtZ3JpZC10aWxlLWZvb3Rlcj5cclxuICogPC9tZC1ncmlkLXRpbGU+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogU3Bhbm5pbmcgbXVsdGlwbGUgcm93cy9jb2x1bW5zOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC10aWxlIG1kLWNvbHNwYW49XCIyXCIgbWQtcm93c3Bhbj1cIjNcIj5cclxuICogPC9tZC1ncmlkLXRpbGU+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogUmVzcG9uc2l2ZSBhdHRyaWJ1dGVzOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtZ3JpZC10aWxlIG1kLWNvbHNwYW49XCIxXCIgbWQtY29sc3Bhbi1zbT1cIjNcIiBtZC1jb2xzcGFuLW1kPVwiNVwiPlxyXG4gKiA8L21kLWdyaWQtdGlsZT5cclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gR3JpZFRpbGVEaXJlY3RpdmUoJG1kTWVkaWEpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHJlcXVpcmU6ICdebWRHcmlkTGlzdCcsXHJcbiAgICB0ZW1wbGF0ZTogJzxmaWd1cmUgbmctdHJhbnNjbHVkZT48L2ZpZ3VyZT4nLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHNjb3BlOiB7fSxcclxuICAgIC8vIFNpbXBsZSBjb250cm9sbGVyIHRoYXQgZXhwb3NlcyBhdHRyaWJ1dGVzIHRvIHRoZSBncmlkIGRpcmVjdGl2ZVxyXG4gICAgY29udHJvbGxlcjogW1wiJGF0dHJzXCIsIGZ1bmN0aW9uKCRhdHRycykge1xyXG4gICAgICB0aGlzLiRhdHRycyA9ICRhdHRycztcclxuICAgIH1dLFxyXG4gICAgbGluazogcG9zdExpbmtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGdyaWRDdHJsKSB7XHJcbiAgICAvLyBBcHBseSBzZW1hbnRpY3NcclxuICAgIGVsZW1lbnQuYXR0cigncm9sZScsICdsaXN0aXRlbScpO1xyXG5cclxuICAgIC8vIElmIG91ciBjb2xzcGFuIG9yIHJvd3NwYW4gY2hhbmdlcywgdHJpZ2dlciBhIGxheW91dFxyXG4gICAgdmFyIHVud2F0Y2hBdHRycyA9ICRtZE1lZGlhLndhdGNoUmVzcG9uc2l2ZUF0dHJpYnV0ZXMoWydtZC1jb2xzcGFuJywgJ21kLXJvd3NwYW4nXSxcclxuICAgICAgICBhdHRycywgYW5ndWxhci5iaW5kKGdyaWRDdHJsLCBncmlkQ3RybC5pbnZhbGlkYXRlTGF5b3V0KSk7XHJcblxyXG4gICAgLy8gVGlsZSByZWdpc3RyYXRpb24vZGVyZWdpc3RyYXRpb25cclxuICAgIGdyaWRDdHJsLmludmFsaWRhdGVUaWxlcygpO1xyXG4gICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB1bndhdGNoQXR0cnMoKTtcclxuICAgICAgZ3JpZEN0cmwuaW52YWxpZGF0ZUxheW91dCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHNjb3BlLiRwYXJlbnQuJGluZGV4KSkge1xyXG4gICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBzY29wZS4kcGFyZW50LiRpbmRleDsgfSxcclxuICAgICAgICBmdW5jdGlvbiBpbmRleENoYW5nZWQobmV3SWR4LCBvbGRJZHgpIHtcclxuICAgICAgICAgIGlmIChuZXdJZHggPT09IG9sZElkeCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBncmlkQ3RybC5pbnZhbGlkYXRlVGlsZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuR3JpZFRpbGVEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZE1lZGlhXCJdO1xyXG5cclxuXHJcbmZ1bmN0aW9uIEdyaWRUaWxlQ2FwdGlvbkRpcmVjdGl2ZSgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgdGVtcGxhdGU6ICc8ZmlnY2FwdGlvbiBuZy10cmFuc2NsdWRlPjwvZmlnY2FwdGlvbj4nLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZVxyXG4gIH07XHJcbn1cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogSWNvblxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuaWNvbicsIFtcclxuICAgICdtYXRlcmlhbC5jb3JlJ1xyXG4gIF0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRJY29uJywgbWRJY29uRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kSWNvblxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblxyXG4gKlxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIGA8bWQtaWNvbj5gIGRpcmVjdGl2ZSBpcyBhbiBtYXJrdXAgZWxlbWVudCB1c2VmdWwgZm9yIHNob3dpbmcgYW4gaWNvbiBiYXNlZCBvbiBhIGZvbnQtaWNvblxyXG4gKiBvciBhIFNWRy4gSWNvbnMgYXJlIHZpZXctb25seSBlbGVtZW50cyB0aGF0IHNob3VsZCBub3QgYmUgdXNlZCBkaXJlY3RseSBhcyBidXR0b25zOyBpbnN0ZWFkIG5lc3QgYSBgPG1kLWljb24+YFxyXG4gKiBpbnNpZGUgYSBgbWQtYnV0dG9uYCB0byBhZGQgaG92ZXIgYW5kIGNsaWNrIGZlYXR1cmVzLlxyXG4gKlxyXG4gKiBXaGVuIHVzaW5nIFNWR3MsIGJvdGggZXh0ZXJuYWwgU1ZHcyAodmlhIFVSTHMpIG9yIHNldHMgb2YgU1ZHcyBbZnJvbSBpY29uIHNldHNdIGNhbiBiZVxyXG4gKiBlYXNpbHkgbG9hZGVkIGFuZCB1c2VkLldoZW4gdXNlIGZvbnQtaWNvbnMsIGRldmVsb3BlcnMgbXVzdCBmb2xsb3dpbmcgdGhyZWUgKDMpIHNpbXBsZSBzdGVwczpcclxuICpcclxuICogPG9sPlxyXG4gKiA8bGk+TG9hZCB0aGUgZm9udCBsaWJyYXJ5LiBlLmcuPGJyLz5cclxuICogICAgJmx0O2xpbmsgaHJlZj1cImh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vaWNvbj9mYW1pbHk9TWF0ZXJpYWwrSWNvbnNcIlxyXG4gKiAgICByZWw9XCJzdHlsZXNoZWV0XCImZ3Q7XHJcbiAqIDwvbGk+XHJcbiAqIDxsaT4gVXNlIGVpdGhlciAoYSkgZm9udC1pY29uIGNsYXNzIG5hbWVzIG9yIChiKSBmb250IGxpZ2F0dXJlcyB0byByZW5kZXIgdGhlIGZvbnQgZ2x5cGggYnkgdXNpbmcgaXRzIHRleHR1YWwgbmFtZTwvbGk+XHJcbiAqIDxsaT4gVXNlICZsdDttZC1pY29uIG1kLWZvbnQtaWNvbj1cImNsYXNzbmFtZVwiIC8mZ3Q7IG9yIDxici8+XHJcbiAqICAgICB1c2UgJmx0O21kLWljb24gbWQtZm9udC1zZXQ9XCJmb250IGxpYnJhcnkgY2xhc3NuYW1lIG9yIGFsaWFzXCImZ3Q7IHRleHR1YWxfbmFtZSAmbHQ7L21kLWljb24mZ3Q7IG9yIDxici8+XHJcbiAqICAgICB1c2UgJmx0O21kLWljb24gbWQtZm9udC1zZXQ9XCJmb250IGxpYnJhcnkgY2xhc3NuYW1lIG9yIGFsaWFzXCImZ3Q7IG51bWVyaWNhbF9jaGFyYWN0ZXJfcmVmZXJlbmNlICZsdDsvbWQtaWNvbiZndDtcclxuICogPC9saT5cclxuICogPC9vbD5cclxuICpcclxuICogRnVsbCBkZXRhaWxzIGZvciB0aGVzZSBzdGVwcyBjYW4gYmUgZm91bmQ6XHJcbiAqXHJcbiAqIDx1bD5cclxuICogPGxpPmh0dHA6Ly9nb29nbGUuZ2l0aHViLmlvL21hdGVyaWFsLWRlc2lnbi1pY29ucy88L2xpPlxyXG4gKiA8bGk+aHR0cDovL2dvb2dsZS5naXRodWIuaW8vbWF0ZXJpYWwtZGVzaWduLWljb25zLyNpY29uLWZvbnQtZm9yLXRoZS13ZWI8L2xpPlxyXG4gKiA8L3VsPlxyXG4gKlxyXG4gKiBUaGUgTWF0ZXJpYWwgRGVzaWduIGljb24gc3R5bGUgPGNvZGU+Lm1hdGVyaWFsLWljb25zPC9jb2RlPiBhbmQgdGhlIGljb24gZm9udCByZWZlcmVuY2VzIGFyZSBwdWJsaXNoZWQgaW5cclxuICogTWF0ZXJpYWwgRGVzaWduIEljb25zOlxyXG4gKlxyXG4gKiA8dWw+XHJcbiAqIDxsaT5odHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL2ljb25zLzwvbGk+XHJcbiAqIDxsaT5odHRwczovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9pY29ucy8jaWNfYWNjZXNzaWJpbGl0eTwvbGk+XHJcbiAqIDwvdWw+XHJcbiAqXHJcbiAqIDxoMiBpZD1cIm1hdGVyaWFsX2Rlc2lnbl9pY29uc1wiPk1hdGVyaWFsIERlc2lnbiBJY29uczwvaDI+XHJcbiAqIFVzaW5nIHRoZSBNYXRlcmlhbCBEZXNpZ24gSWNvbi1TZWxlY3RvciwgZGV2ZWxvcGVycyBjYW4gZWFzaWx5IGFuZCBxdWlja2x5IHNlYXJjaCBmb3IgYSBNYXRlcmlhbCBEZXNpZ24gZm9udC1pY29uIGFuZFxyXG4gKiBkZXRlcm1pbmUgaXRzIHRleHR1YWwgbmFtZSBhbmQgY2hhcmFjdGVyIHJlZmVyZW5jZSBjb2RlLiBDbGljayBvbiBhbnkgaWNvbiB0byBzZWUgdGhlIHNsaWRlLXVwIGluZm9ybWF0aW9uXHJcbiAqIHBhbmVsIHdpdGggZGV0YWlscyByZWdhcmRpbmcgYSBTVkcgZG93bmxvYWQgb3IgaW5mb3JtYXRpb24gb24gdGhlIGZvbnQtaWNvbiB1c2FnZS5cclxuICpcclxuICogPGEgaHJlZj1cImh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL2ljb25zLyNpY19hY2Nlc3NpYmlsaXR5XCIgdGFyZ2V0PVwiX2JsYW5rXCIgc3R5bGU9XCJib3JkZXItYm90dG9tOm5vbmU7XCI+XHJcbiAqIDxpbWcgc3JjPVwiaHR0cHM6Ly9jbG91ZC5naXRodWJ1c2VyY29udGVudC5jb20vYXNzZXRzLzIxMDQxMy83OTAyNDkwL2ZlOGRkMTRjLTA3ODAtMTFlNS05OGZiLWM4MjFjYzY0NzVlNi5wbmdcIlxyXG4gKiAgICAgIGFyaWEtbGFiZWw9XCJNYXRlcmlhbCBEZXNpZ24gSWNvbi1TZWxlY3RvclwiIHN0eWxlPVwibWF4LXdpZHRoOjc1JTtwYWRkaW5nLWxlZnQ6MTAlXCI+XHJcbiAqIDwvYT5cclxuICpcclxuICogPHNwYW4gY2xhc3M9XCJpbWFnZV9jYXB0aW9uXCI+XHJcbiAqICBDbGljayBvbiB0aGUgaW1hZ2UgYWJvdmUgdG8gbGluayB0byB0aGVcclxuICogIDxhIGhyZWY9XCJodHRwczovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9pY29ucy8jaWNfYWNjZXNzaWJpbGl0eVwiIHRhcmdldD1cIl9ibGFua1wiPk1hdGVyaWFsIERlc2lnbiBJY29uLVNlbGVjdG9yPC9hPi5cclxuICogPC9zcGFuPlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtZm9udC1pY29uIE5hbWUgb2YgQ1NTIGljb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBmb250LWZhY2Ugd2lsbCBiZSB1c2VkXHJcbiAqIHRvIHJlbmRlciB0aGUgaWNvbi4gUmVxdWlyZXMgdGhlIGZvbnRzIGFuZCB0aGUgbmFtZWQgQ1NTIHN0eWxlcyB0byBiZSBwcmVsb2FkZWQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1mb250LXNldCBDU1Mgc3R5bGUgbmFtZSBhc3NvY2lhdGVkIHdpdGggdGhlIGZvbnQgbGlicmFyeTsgd2hpY2ggd2lsbCBiZSBhc3NpZ25lZCBhc1xyXG4gKiB0aGUgY2xhc3MgZm9yIHRoZSBmb250LWljb24gbGlnYXR1cmUuIFRoaXMgdmFsdWUgbWF5IGFsc28gYmUgYW4gYWxpYXMgdGhhdCBpcyB1c2VkIHRvIGxvb2t1cCB0aGUgY2xhc3NuYW1lO1xyXG4gKiBpbnRlcm5hbGx5IHVzZSBgJG1kSWNvblByb3ZpZGVyLmZvbnRTZXQoPGFsaWFzPilgIHRvIGRldGVybWluZSB0aGUgc3R5bGUgbmFtZS5cclxuICogQHBhcmFtIHtzdHJpbmd9IG1kLXN2Zy1zcmMgVVJMIFtvciBleHByZXNzaW9uIF0gdXNlZCB0byBsb2FkLCBjYWNoZSwgYW5kIGRpc3BsYXkgYW4gZXh0ZXJuYWwgU1ZHLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtc3ZnLWljb24gTmFtZSB1c2VkIGZvciBsb29rdXAgb2YgdGhlIGljb24gZnJvbSB0aGUgaW50ZXJuYWwgY2FjaGU7IGludGVycG9sYXRlZCBzdHJpbmdzIG9yXHJcbiAqIGV4cHJlc3Npb25zIG1heSBhbHNvIGJlIHVzZWQuIFNwZWNpZmljIHNldCBuYW1lcyBjYW4gYmUgdXNlZCB3aXRoIHRoZSBzeW50YXggYDxzZXQgbmFtZT46PGljb24gbmFtZT5gLjxici8+PGJyLz5cclxuICogVG8gdXNlIGljb24gc2V0cywgZGV2ZWxvcGVycyBhcmUgcmVxdWlyZWQgdG8gcHJlLXJlZ2lzdGVyIHRoZSBzZXRzIHVzaW5nIHRoZSBgJG1kSWNvblByb3ZpZGVyYCBzZXJ2aWNlLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgTGFiZWxzIGljb24gZm9yIGFjY2Vzc2liaWxpdHkuIElmIGFuIGVtcHR5IHN0cmluZyBpcyBwcm92aWRlZCwgaWNvblxyXG4gKiB3aWxsIGJlIGhpZGRlbiBmcm9tIGFjY2Vzc2liaWxpdHkgbGF5ZXIgd2l0aCBgYXJpYS1oaWRkZW49XCJ0cnVlXCJgLiBJZiB0aGVyZSdzIG5vIGFyaWEtbGFiZWwgb24gdGhlIGljb25cclxuICogbm9yIGEgbGFiZWwgb24gdGhlIHBhcmVudCBlbGVtZW50LCBhIHdhcm5pbmcgd2lsbCBiZSBsb2dnZWQgdG8gdGhlIGNvbnNvbGUuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiBXaGVuIHVzaW5nIFNWR3M6XHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqXHJcbiAqICA8IS0tIEljb24gSUQ7IG1heSBjb250YWluIG9wdGlvbmFsIGljb24gc2V0IHByZWZpeDsgaWNvbnMgbXVzdCByZWdpc3RlcmVkIHVzaW5nICRtZEljb25Qcm92aWRlciAtLT5cclxuICogIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwic29jaWFsOmFuZHJvaWRcIiAgICBhcmlhLWxhYmVsPVwiYW5kcm9pZCBcIiA+PC9tZC1pY29uPlxyXG4gKlxyXG4gKiAgPCEtLSBJY29uIHVybHM7IG1heSBiZSBwcmVsb2FkZWQgaW4gdGVtcGxhdGVDYWNoZSAtLT5cclxuICogIDxtZC1pY29uIG1kLXN2Zy1zcmM9XCIvYW5kcm9pZC5zdmdcIiAgICAgICBhcmlhLWxhYmVsPVwiYW5kcm9pZCBcIiA+PC9tZC1pY29uPlxyXG4gKiAgPG1kLWljb24gbWQtc3ZnLXNyYz1cInt7IGdldEFuZHJvaWQoKSB9fVwiIGFyaWEtbGFiZWw9XCJhbmRyb2lkIFwiID48L21kLWljb24+XHJcbiAqXHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogVXNlIHRoZSA8Y29kZT4kbWRJY29uUHJvdmlkZXI8L2NvZGU+IHRvIGNvbmZpZ3VyZSB5b3VyIGFwcGxpY2F0aW9uIHdpdGhcclxuICogc3ZnIGljb25zZXRzLlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICogIGFuZ3VsYXIubW9kdWxlKCdhcHBTdmdJY29uU2V0cycsIFsnbmdNYXRlcmlhbCddKVxyXG4gKiAgICAuY29udHJvbGxlcignRGVtb0N0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHt9KVxyXG4gKiAgICAuY29uZmlnKGZ1bmN0aW9uKCRtZEljb25Qcm92aWRlcikge1xyXG4gKiAgICAgICRtZEljb25Qcm92aWRlclxyXG4gKiAgICAgICAgIC5pY29uU2V0KCdzb2NpYWwnLCAnaW1nL2ljb25zL3NldHMvc29jaWFsLWljb25zLnN2ZycsIDI0KVxyXG4gKiAgICAgICAgIC5kZWZhdWx0SWNvblNldCgnaW1nL2ljb25zL3NldHMvY29yZS1pY29ucy5zdmcnLCAyNCk7XHJcbiAqICAgICB9KTtcclxuICogPC9obGpzPlxyXG4gKlxyXG4gKlxyXG4gKiBXaGVuIHVzaW5nIEZvbnQgSWNvbnMgd2l0aCBjbGFzc25hbWVzOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKlxyXG4gKiAgPG1kLWljb24gbWQtZm9udC1pY29uPVwiYW5kcm9pZFwiIGFyaWEtbGFiZWw9XCJhbmRyb2lkXCIgPjwvbWQtaWNvbj5cclxuICogIDxtZC1pY29uIGNsYXNzPVwiaWNvbl9ob21lXCIgICAgICBhcmlhLWxhYmVsPVwiSG9tZVwiICAgID48L21kLWljb24+XHJcbiAqXHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogV2hlbiB1c2luZyBNYXRlcmlhbCBGb250IEljb25zIHdpdGggbGlnYXR1cmVzOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgPCEtLSBGb3IgTWF0ZXJpYWwgRGVzaWduIEljb25zIC0tPlxyXG4gKiAgPCEtLSBUaGUgY2xhc3MgJy5tYXRlcmlhbC1pY29ucycgaXMgYXV0by1hZGRlZCBpZiBhIHN0eWxlIGhhcyBOT1QgYmVlbiBzcGVjaWZpZWQgLS0+XHJcbiAqICA8bWQtaWNvbj4gZmFjZSA8L21kLWljb24+XHJcbiAqICA8bWQtaWNvbiBtZC1mb250LXNldD1cIm1hdGVyaWFsLWljb25zXCI+IGZhY2UgPC9tZC1pY29uPlxyXG4gKiAgPG1kLWljb24+ICN4RTg3QzsgPC9tZC1pY29uPlxyXG4gKiAgPCEtLSBUaGUgY2xhc3MgJy5tYXRlcmlhbC1pY29ucycgbXVzdCBiZSBtYW51YWxseSBhZGRlZCBpZiBvdGhlciBzdHlsZXMgYXJlIGFsc28gc3BlY2lmaWVkLS0+XHJcbiAqICA8bWQtaWNvbiBjbGFzcz1cIm1hdGVyaWFsLWljb25zIG1kLWxpZ2h0IG1kLTQ4XCI+IGZhY2UgPC9tZC1pY29uPlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIFdoZW4gdXNpbmcgb3RoZXIgRm9udC1JY29uIGxpYnJhcmllczpcclxuICpcclxuICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAqICAvLyBTcGVjaWZ5IGEgZm9udC1pY29uIHN0eWxlIGFsaWFzXHJcbiAqICBhbmd1bGFyLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcclxuICogICAgJG1kSWNvblByb3ZpZGVyLmZvbnRTZXQoJ2ZhJywgJ2ZvbnRhd2Vzb21lJyk7XHJcbiAqICB9KTtcclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgPG1kLWljb24gbWQtZm9udC1zZXQ9XCJmYVwiPmVtYWlsPC9tZC1pY29uPlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBtZEljb25EaXJlY3RpdmUoJG1kSWNvbiwgJG1kVGhlbWluZywgJG1kQXJpYSwgJGludGVycG9sYXRlICkge1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgc2NvcGU6IHtcclxuICAgICAgZm9udFNldCA6ICdAbWRGb250U2V0JyxcclxuICAgICAgZm9udEljb246ICdAbWRGb250SWNvbicsXHJcbiAgICAgIHN2Z0ljb24gOiAnQG1kU3ZnSWNvbicsXHJcbiAgICAgIHN2Z1NyYyAgOiAnQG1kU3ZnU3JjJ1xyXG4gICAgfSxcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBsaW5rIDogcG9zdExpbmtcclxuICB9O1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogRGlyZWN0aXZlIHBvc3RMaW5rXHJcbiAgICogU3VwcG9ydHMgZW1iZWRkZWQgU1ZHcywgZm9udC1pY29ucywgJiBleHRlcm5hbCBTVkdzXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcblxyXG4gICAgcHJlcGFyZUZvckZvbnRJY29uKCk7XHJcblxyXG4gICAgLy8gSWYgdXNpbmcgYSBmb250LWljb24sIHRoZW4gdGhlIHRleHR1YWwgbmFtZSBvZiB0aGUgaWNvbiBpdHNlbGZcclxuICAgIC8vIHByb3ZpZGVzIHRoZSBhcmlhLWxhYmVsLlxyXG5cclxuICAgIHZhciBsYWJlbCA9IGF0dHIuYWx0IHx8IHNjb3BlLmZvbnRJY29uIHx8IHNjb3BlLnN2Z0ljb24gfHwgZWxlbWVudC50ZXh0KCk7XHJcbiAgICB2YXIgYXR0ck5hbWUgPSBhdHRyLiRub3JtYWxpemUoYXR0ci4kYXR0ci5tZFN2Z0ljb24gfHwgYXR0ci4kYXR0ci5tZFN2Z1NyYyB8fCAnJyk7XHJcblxyXG4gICAgaWYgKCAhYXR0clsnYXJpYS1sYWJlbCddICkge1xyXG5cclxuICAgICAgaWYgKGxhYmVsICE9ICcnICYmICFwYXJlbnRzSGF2ZVRleHQoKSApIHtcclxuXHJcbiAgICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ2FyaWEtbGFiZWwnLCBsYWJlbCk7XHJcbiAgICAgICAgJG1kQXJpYS5leHBlY3QoZWxlbWVudCwgJ3JvbGUnLCAnaW1nJyk7XHJcblxyXG4gICAgICB9IGVsc2UgaWYgKCAhZWxlbWVudC50ZXh0KCkgKSB7XHJcbiAgICAgICAgLy8gSWYgbm90IGEgZm9udC1pY29uIHdpdGggbGlnYXR1cmUsIHRoZW5cclxuICAgICAgICAvLyBoaWRlIGZyb20gdGhlIGFjY2Vzc2liaWxpdHkgbGF5ZXIuXHJcblxyXG4gICAgICAgICRtZEFyaWEuZXhwZWN0KGVsZW1lbnQsICdhcmlhLWhpZGRlbicsICd0cnVlJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoYXR0ck5hbWUpIHtcclxuICAgICAgLy8gVXNlIGVpdGhlciBwcmUtY29uZmlndXJlZCBTVkcgb3IgVVJMIHNvdXJjZSwgcmVzcGVjdGl2ZWx5LlxyXG4gICAgICBhdHRyLiRvYnNlcnZlKGF0dHJOYW1lLCBmdW5jdGlvbihhdHRyVmFsKSB7XHJcblxyXG4gICAgICAgIGVsZW1lbnQuZW1wdHkoKTtcclxuICAgICAgICBpZiAoYXR0clZhbCkge1xyXG4gICAgICAgICAgJG1kSWNvbihhdHRyVmFsKS50aGVuKGZ1bmN0aW9uKHN2Zykge1xyXG4gICAgICAgICAgICBlbGVtZW50LmFwcGVuZChzdmcpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcGFyZW50c0hhdmVUZXh0KCkge1xyXG4gICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcclxuICAgICAgaWYgKHBhcmVudC5hdHRyKCdhcmlhLWxhYmVsJykgfHwgcGFyZW50LnRleHQoKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYocGFyZW50LnBhcmVudCgpLmF0dHIoJ2FyaWEtbGFiZWwnKSB8fCBwYXJlbnQucGFyZW50KCkudGV4dCgpKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHByZXBhcmVGb3JGb250SWNvbiAoKSB7XHJcbiAgICAgIGlmICghc2NvcGUuc3ZnSWNvbiAmJiAhc2NvcGUuc3ZnU3JjKSB7XHJcblxyXG4gICAgICAgIGlmIChzY29wZS5mb250SWNvbikge1xyXG4gICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtZm9udCcpO1xyXG4gICAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhzY29wZS5mb250SWNvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc2NvcGUuZm9udFNldCkge1xyXG4gICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygkbWRJY29uLmZvbnRTZXQoc2NvcGUuZm9udFNldCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRm9yIE1hdGVyaWFsIERlc2lnbiBmb250IGljb25zLCB0aGUgY2xhc3MgJy5tYXRlcmlhbC1pY29ucydcclxuICAgICAgICAvLyBpcyBhdXRvLWFkZGVkIElGIGEgc3R5bGUgaGFzIG5vdCBiZWVuIHNwZWNpZmllZFxyXG5cclxuICAgICAgICBpZiAoIXNjb3BlLmZvbnRJY29uICYmICFzY29wZS5mb250U2V0ICYmICFhbmd1bGFyLmlzRGVmaW5lZChhdHRyLmNsYXNzKSkge1xyXG5cclxuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWF0ZXJpYWwtaWNvbnMnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbm1kSWNvbkRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kSWNvblwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkbWRBcmlhXCIsIFwiJGludGVycG9sYXRlXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmljb24nIClcclxuICAgIC5wcm92aWRlcignJG1kSWNvbicsIE1kSWNvblByb3ZpZGVyKTtcclxuXHJcbiAgLyoqXHJcbiAgICAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAgICAqIEBuYW1lICRtZEljb25Qcm92aWRlclxyXG4gICAgKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuaWNvblxyXG4gICAgKlxyXG4gICAgKiBAZGVzY3JpcHRpb25cclxuICAgICogYCRtZEljb25Qcm92aWRlcmAgaXMgdXNlZCBvbmx5IHRvIHJlZ2lzdGVyIGljb24gSURzIHdpdGggVVJMcy4gVGhlc2UgY29uZmlndXJhdGlvbiBmZWF0dXJlcyBhbGxvd1xyXG4gICAgKiBpY29ucyBhbmQgaWNvbiBzZXRzIHRvIGJlIHByZS1yZWdpc3RlcmVkIGFuZCBhc3NvY2lhdGVkIHdpdGggc291cmNlIFVSTHMgKipiZWZvcmUqKiB0aGUgYDxtZC1pY29uIC8+YFxyXG4gICAgKiBkaXJlY3RpdmVzIGFyZSBjb21waWxlZC5cclxuICAgICpcclxuICAgICogSWYgdXNpbmcgZm9udC1pY29ucywgdGhlIGRldmVsb3BlciBpcyByZXBzb25zaWJsZSBmb3IgbG9hZGluZyB0aGUgZm9udHMuXHJcbiAgICAqXHJcbiAgICAqIElmIHVzaW5nIFNWR3MsIGxvYWRpbmcgb2YgdGhlIGFjdHVhbCBzdmcgZmlsZXMgYXJlIGRlZmVycmVkIHRvIG9uLWRlbWFuZCByZXF1ZXN0cyBhbmQgYXJlIGxvYWRlZFxyXG4gICAgKiBpbnRlcm5hbGx5IGJ5IHRoZSBgJG1kSWNvbmAgc2VydmljZSB1c2luZyB0aGUgYCRodHRwYCBzZXJ2aWNlLiBXaGVuIGFuIFNWRyBpcyByZXF1ZXN0ZWQgYnkgbmFtZS9JRCxcclxuICAgICogdGhlIGAkbWRJY29uYCBzZXJ2aWNlIHNlYXJjaGVzIGl0cyByZWdpc3RyeSBmb3IgdGhlIGFzc29jaWF0ZWQgc291cmNlIFVSTDtcclxuICAgICogdGhhdCBVUkwgaXMgdXNlZCB0byBvbi1kZW1hbmQgbG9hZCBhbmQgcGFyc2UgdGhlIFNWRyBkeW5hbWljYWxseS5cclxuICAgICpcclxuICAgICogQHVzYWdlXHJcbiAgICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XHJcbiAgICAqXHJcbiAgICAqICAgICAvLyBDb25maWd1cmUgVVJMcyBmb3IgaWNvbnMgc3BlY2lmaWVkIGJ5IFtzZXQ6XWlkLlxyXG4gICAgKlxyXG4gICAgKiAgICAgJG1kSWNvblByb3ZpZGVyXHJcbiAgICAqICAgICAgICAgIC5kZWZhdWx0Rm9udFNldCggJ2ZvbnRhd2Vzb21lJyApXHJcbiAgICAqICAgICAgICAgIC5kZWZhdWx0SWNvblNldCgnbXkvYXBwL2ljb25zLnN2ZycpICAgICAgIC8vIFJlZ2lzdGVyIGEgZGVmYXVsdCBzZXQgb2YgU1ZHIGljb25zXHJcbiAgICAqICAgICAgICAgIC5pY29uU2V0KCdzb2NpYWwnLCAnbXkvYXBwL3NvY2lhbC5zdmcnKSAgIC8vIFJlZ2lzdGVyIGEgbmFtZWQgaWNvbiBzZXQgb2YgU1ZHc1xyXG4gICAgKiAgICAgICAgICAuaWNvbignYW5kcm9pZCcsICdteS9hcHAvYW5kcm9pZC5zdmcnKSAgICAvLyBSZWdpc3RlciBhIHNwZWNpZmljIGljb24gKGJ5IG5hbWUpXHJcbiAgICAqICAgICAgICAgIC5pY29uKCd3b3JrOmNoYWlyJywgJ215L2FwcC9jaGFpci5zdmcnKTsgIC8vIFJlZ2lzdGVyIGljb24gaW4gYSBzcGVjaWZpYyBzZXRcclxuICAgICogICB9KTtcclxuICAgICogPC9obGpzPlxyXG4gICAgKlxyXG4gICAgKiBTVkcgaWNvbnMgYW5kIGljb24gc2V0cyBjYW4gYmUgZWFzaWx5IHByZS1sb2FkZWQgYW5kIGNhY2hlZCB1c2luZyBlaXRoZXIgKGEpIGEgYnVpbGQgcHJvY2VzcyBvciAoYikgYSBydW50aW1lXHJcbiAgICAqICoqc3RhcnR1cCoqIHByb2Nlc3MgKHNob3duIGJlbG93KTpcclxuICAgICpcclxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAgICAqICAgYXBwLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcclxuICAgICpcclxuICAgICogICAgIC8vIFJlZ2lzdGVyIGEgZGVmYXVsdCBzZXQgb2YgU1ZHIGljb24gZGVmaW5pdGlvbnNcclxuICAgICogICAgICRtZEljb25Qcm92aWRlci5kZWZhdWx0SWNvblNldCgnbXkvYXBwL2ljb25zLnN2ZycpXHJcbiAgICAqXHJcbiAgICAqICAgfSlcclxuICAgICogICAucnVuKGZ1bmN0aW9uKCRodHRwLCAkdGVtcGxhdGVDYWNoZSl7XHJcbiAgICAqXHJcbiAgICAqICAgICAvLyBQcmUtZmV0Y2ggaWNvbnMgc291cmNlcyBieSBVUkwgYW5kIGNhY2hlIGluIHRoZSAkdGVtcGxhdGVDYWNoZS4uLlxyXG4gICAgKiAgICAgLy8gc3Vic2VxdWVudCAkaHR0cCBjYWxscyB3aWxsIGxvb2sgdGhlcmUgZmlyc3QuXHJcbiAgICAqXHJcbiAgICAqICAgICB2YXIgdXJscyA9IFsgJ2lteS9hcHAvaWNvbnMuc3ZnJywgJ2ltZy9pY29ucy9hbmRyb2lkLnN2ZyddO1xyXG4gICAgKlxyXG4gICAgKiAgICAgYW5ndWxhci5mb3JFYWNoKHVybHMsIGZ1bmN0aW9uKHVybCkge1xyXG4gICAgKiAgICAgICAkaHR0cC5nZXQodXJsLCB7Y2FjaGU6ICR0ZW1wbGF0ZUNhY2hlfSk7XHJcbiAgICAqICAgICB9KTtcclxuICAgICpcclxuICAgICogICB9KTtcclxuICAgICpcclxuICAgICogPC9obGpzPlxyXG4gICAgKlxyXG4gICAgKiBOT1RFOiB0aGUgbG9hZGVkIFNWRyBkYXRhIGlzIHN1YnNlcXVlbnRseSBjYWNoZWQgaW50ZXJuYWxseSBmb3IgZnV0dXJlIHJlcXVlc3RzLlxyXG4gICAgKlxyXG4gICAgKi9cclxuXHJcbiAgIC8qKlxyXG4gICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAqIEBuYW1lICRtZEljb25Qcm92aWRlciNpY29uXHJcbiAgICAqXHJcbiAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgKiBSZWdpc3RlciBhIHNvdXJjZSBVUkwgZm9yIGEgc3BlY2lmaWMgaWNvbiBuYW1lOyB0aGUgbmFtZSBtYXkgaW5jbHVkZSBvcHRpb25hbCAnaWNvbiBzZXQnIG5hbWUgcHJlZml4LlxyXG4gICAgKiBUaGVzZSBpY29ucyAgd2lsbCBsYXRlciBiZSByZXRyaWV2ZWQgZnJvbSB0aGUgY2FjaGUgdXNpbmcgYCRtZEljb24oIDxpY29uIG5hbWU+IClgXHJcbiAgICAqXHJcbiAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBJY29uIG5hbWUvaWQgdXNlZCB0byByZWdpc3RlciB0aGUgaWNvblxyXG4gICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIHNwZWNpZmllcyB0aGUgZXh0ZXJuYWwgbG9jYXRpb24gZm9yIHRoZSBkYXRhIGZpbGUuIFVzZWQgaW50ZXJuYWxseSBieSBgJGh0dHBgIHRvIGxvYWQgdGhlXHJcbiAgICAqIGRhdGEgb3IgYXMgcGFydCBvZiB0aGUgbG9va3VwIGluIGAkdGVtcGxhdGVDYWNoZWAgaWYgcHJlLWxvYWRpbmcgd2FzIGNvbmZpZ3VyZWQuXHJcbiAgICAqIEBwYXJhbSB7bnVtYmVyPX0gdmlld0JveFNpemUgU2V0cyB0aGUgd2lkdGggYW5kIGhlaWdodCB0aGUgaWNvbidzIHZpZXdCb3guXHJcbiAgICAqIEl0IGlzIGlnbm9yZWQgZm9yIGljb25zIHdpdGggYW4gZXhpc3Rpbmcgdmlld0JveC4gRGVmYXVsdCBzaXplIGlzIDI0LlxyXG4gICAgKlxyXG4gICAgKiBAcmV0dXJucyB7b2JqfSBhbiBgJG1kSWNvblByb3ZpZGVyYCByZWZlcmVuY2U7IHVzZWQgdG8gc3VwcG9ydCBtZXRob2QgY2FsbCBjaGFpbnMgZm9yIHRoZSBBUElcclxuICAgICpcclxuICAgICogQHVzYWdlXHJcbiAgICAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XHJcbiAgICAqXHJcbiAgICAqICAgICAvLyBDb25maWd1cmUgVVJMcyBmb3IgaWNvbnMgc3BlY2lmaWVkIGJ5IFtzZXQ6XWlkLlxyXG4gICAgKlxyXG4gICAgKiAgICAgJG1kSWNvblByb3ZpZGVyXHJcbiAgICAqICAgICAgICAgIC5pY29uKCdhbmRyb2lkJywgJ215L2FwcC9hbmRyb2lkLnN2ZycpICAgIC8vIFJlZ2lzdGVyIGEgc3BlY2lmaWMgaWNvbiAoYnkgbmFtZSlcclxuICAgICogICAgICAgICAgLmljb24oJ3dvcms6Y2hhaXInLCAnbXkvYXBwL2NoYWlyLnN2ZycpOyAgLy8gUmVnaXN0ZXIgaWNvbiBpbiBhIHNwZWNpZmljIHNldFxyXG4gICAgKiAgIH0pO1xyXG4gICAgKiA8L2hsanM+XHJcbiAgICAqXHJcbiAgICAqL1xyXG4gICAvKipcclxuICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgKiBAbmFtZSAkbWRJY29uUHJvdmlkZXIjaWNvblNldFxyXG4gICAgKlxyXG4gICAgKiBAZGVzY3JpcHRpb25cclxuICAgICogUmVnaXN0ZXIgYSBzb3VyY2UgVVJMIGZvciBhICduYW1lZCcgc2V0IG9mIGljb25zOyBncm91cCBvZiBTVkcgZGVmaW5pdGlvbnMgd2hlcmUgZWFjaCBkZWZpbml0aW9uXHJcbiAgICAqIGhhcyBhbiBpY29uIGlkLiBJbmRpdmlkdWFsIGljb25zIGNhbiBiZSBzdWJzZXF1ZW50bHkgcmV0cmlldmVkIGZyb20gdGhpcyBjYWNoZWQgc2V0IHVzaW5nXHJcbiAgICAqIGAkbWRJY29uKDxpY29uIHNldCBuYW1lPjo8aWNvbiBuYW1lPilgXHJcbiAgICAqXHJcbiAgICAqIEBwYXJhbSB7c3RyaW5nfSBpZCBJY29uIG5hbWUvaWQgdXNlZCB0byByZWdpc3RlciB0aGUgaWNvbnNldFxyXG4gICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIHNwZWNpZmllcyB0aGUgZXh0ZXJuYWwgbG9jYXRpb24gZm9yIHRoZSBkYXRhIGZpbGUuIFVzZWQgaW50ZXJuYWxseSBieSBgJGh0dHBgIHRvIGxvYWQgdGhlXHJcbiAgICAqIGRhdGEgb3IgYXMgcGFydCBvZiB0aGUgbG9va3VwIGluIGAkdGVtcGxhdGVDYWNoZWAgaWYgcHJlLWxvYWRpbmcgd2FzIGNvbmZpZ3VyZWQuXHJcbiAgICAqIEBwYXJhbSB7bnVtYmVyPX0gdmlld0JveFNpemUgU2V0cyB0aGUgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgdmlld0JveCBvZiBhbGwgaWNvbnMgaW4gdGhlIHNldC4gXHJcbiAgICAqIEl0IGlzIGlnbm9yZWQgZm9yIGljb25zIHdpdGggYW4gZXhpc3Rpbmcgdmlld0JveC4gQWxsIGljb25zIGluIHRoZSBpY29uIHNldCBzaG91bGQgYmUgdGhlIHNhbWUgc2l6ZS5cclxuICAgICogRGVmYXVsdCB2YWx1ZSBpcyAyNC5cclxuICAgICpcclxuICAgICogQHJldHVybnMge29ian0gYW4gYCRtZEljb25Qcm92aWRlcmAgcmVmZXJlbmNlOyB1c2VkIHRvIHN1cHBvcnQgbWV0aG9kIGNhbGwgY2hhaW5zIGZvciB0aGUgQVBJXHJcbiAgICAqXHJcbiAgICAqXHJcbiAgICAqIEB1c2FnZVxyXG4gICAgKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICAgICogICBhcHAuY29uZmlnKGZ1bmN0aW9uKCRtZEljb25Qcm92aWRlcikge1xyXG4gICAgKlxyXG4gICAgKiAgICAgLy8gQ29uZmlndXJlIFVSTHMgZm9yIGljb25zIHNwZWNpZmllZCBieSBbc2V0Ol1pZC5cclxuICAgICpcclxuICAgICogICAgICRtZEljb25Qcm92aWRlclxyXG4gICAgKiAgICAgICAgICAuaWNvblNldCgnc29jaWFsJywgJ215L2FwcC9zb2NpYWwuc3ZnJykgICAvLyBSZWdpc3RlciBhIG5hbWVkIGljb24gc2V0XHJcbiAgICAqICAgfSk7XHJcbiAgICAqIDwvaGxqcz5cclxuICAgICpcclxuICAgICovXHJcbiAgIC8qKlxyXG4gICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAqIEBuYW1lICRtZEljb25Qcm92aWRlciNkZWZhdWx0SWNvblNldFxyXG4gICAgKlxyXG4gICAgKiBAZGVzY3JpcHRpb25cclxuICAgICogUmVnaXN0ZXIgYSBzb3VyY2UgVVJMIGZvciB0aGUgZGVmYXVsdCAnbmFtZWQnIHNldCBvZiBpY29ucy4gVW5sZXNzIGV4cGxpY2l0bHkgcmVnaXN0ZXJlZCxcclxuICAgICogc3Vic2VxdWVudCBsb29rdXBzIG9mIGljb25zIHdpbGwgZmFpbG92ZXIgdG8gc2VhcmNoIHRoaXMgJ2RlZmF1bHQnIGljb24gc2V0LlxyXG4gICAgKiBJY29uIGNhbiBiZSByZXRyaWV2ZWQgZnJvbSB0aGlzIGNhY2hlZCwgZGVmYXVsdCBzZXQgdXNpbmcgYCRtZEljb24oPG5hbWU+KWBcclxuICAgICpcclxuICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCBzcGVjaWZpZXMgdGhlIGV4dGVybmFsIGxvY2F0aW9uIGZvciB0aGUgZGF0YSBmaWxlLiBVc2VkIGludGVybmFsbHkgYnkgYCRodHRwYCB0byBsb2FkIHRoZVxyXG4gICAgKiBkYXRhIG9yIGFzIHBhcnQgb2YgdGhlIGxvb2t1cCBpbiBgJHRlbXBsYXRlQ2FjaGVgIGlmIHByZS1sb2FkaW5nIHdhcyBjb25maWd1cmVkLlxyXG4gICAgKiBAcGFyYW0ge251bWJlcj19IHZpZXdCb3hTaXplIFNldHMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgb2YgdGhlIHZpZXdCb3ggb2YgYWxsIGljb25zIGluIHRoZSBzZXQuIFxyXG4gICAgKiBJdCBpcyBpZ25vcmVkIGZvciBpY29ucyB3aXRoIGFuIGV4aXN0aW5nIHZpZXdCb3guIEFsbCBpY29ucyBpbiB0aGUgaWNvbiBzZXQgc2hvdWxkIGJlIHRoZSBzYW1lIHNpemUuXHJcbiAgICAqIERlZmF1bHQgdmFsdWUgaXMgMjQuXHJcbiAgICAqXHJcbiAgICAqIEByZXR1cm5zIHtvYmp9IGFuIGAkbWRJY29uUHJvdmlkZXJgIHJlZmVyZW5jZTsgdXNlZCB0byBzdXBwb3J0IG1ldGhvZCBjYWxsIGNoYWlucyBmb3IgdGhlIEFQSVxyXG4gICAgKlxyXG4gICAgKiBAdXNhZ2VcclxuICAgICogPGhsanMgbGFuZz1cImpzXCI+XHJcbiAgICAqICAgYXBwLmNvbmZpZyhmdW5jdGlvbigkbWRJY29uUHJvdmlkZXIpIHtcclxuICAgICpcclxuICAgICogICAgIC8vIENvbmZpZ3VyZSBVUkxzIGZvciBpY29ucyBzcGVjaWZpZWQgYnkgW3NldDpdaWQuXHJcbiAgICAqXHJcbiAgICAqICAgICAkbWRJY29uUHJvdmlkZXJcclxuICAgICogICAgICAgICAgLmRlZmF1bHRJY29uU2V0KCAnbXkvYXBwL3NvY2lhbC5zdmcnICkgICAvLyBSZWdpc3RlciBhIGRlZmF1bHQgaWNvbiBzZXRcclxuICAgICogICB9KTtcclxuICAgICogPC9obGpzPlxyXG4gICAgKlxyXG4gICAgKi9cclxuICAvKipcclxuICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICogQG5hbWUgJG1kSWNvblByb3ZpZGVyI2RlZmF1bHRGb250U2V0XHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBXaGVuIHVzaW5nIEZvbnQtSWNvbnMsIEFuZ3VsYXIgTWF0ZXJpYWwgYXNzdW1lcyB0aGUgdGhlIE1hdGVyaWFsIERlc2lnbiBpY29ucyB3aWxsIGJlIHVzZWQgYW5kIGF1dG9tYXRpY2FsbHlcclxuICAgKiBjb25maWd1cmVzIHRoZSBkZWZhdWx0IGZvbnQtc2V0ID09ICdtYXRlcmlhbC1pY29ucycuIE5vdGUgdGhhdCB0aGUgZm9udC1zZXQgcmVmZXJlbmNlcyB0aGUgZm9udC1pY29uIGxpYnJhcnlcclxuICAgKiBjbGFzcyBzdHlsZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIHRoZSBgPG1kLWljb24+YC5cclxuICAgKlxyXG4gICAqIENvbmZpZ3VyaW5nIHRoZSBkZWZhdWx0IG1lYW5zIHRoYXQgdGhlIGF0dHJpYnV0ZXNcclxuICAgKiBgbWQtZm9udC1zZXQ9XCJtYXRlcmlhbC1pY29uc1wiYCBvciBgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiYCBkbyBub3QgbmVlZCB0byBiZSBleHBsaWNpdGx5IGRlY2xhcmVkIG9uIHRoZVxyXG4gICAqIGA8bWQtaWNvbj5gIG1hcmt1cC4gRm9yIGV4YW1wbGU6XHJcbiAgICpcclxuICAgKiAgYDxtZC1pY29uPiBmYWNlIDwvbWQtaWNvbj5gXHJcbiAgICogIHdpbGwgcmVuZGVyIGFzXHJcbiAgICogIGA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLWljb25zXCI+IGZhY2UgPC9zcGFuPmAsIGFuZFxyXG4gICAqXHJcbiAgICogIGA8bWQtaWNvbiBtZC1mb250LXNldD1cImZhXCI+IGZhY2UgPC9tZC1pY29uPmBcclxuICAgKiAgd2lsbCByZW5kZXIgYXNcclxuICAgKiAgYDxzcGFuIGNsYXNzPVwiZmFcIj4gZmFjZSA8L3NwYW4+YFxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgb2YgdGhlIGZvbnQtbGlicmFyeSBzdHlsZSB0aGF0IHNob3VsZCBiZSBhcHBsaWVkIHRvIHRoZSBtZC1pY29uIERPTSBlbGVtZW50XHJcbiAgICpcclxuICAgKiBAdXNhZ2VcclxuICAgKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICAgKiAgIGFwcC5jb25maWcoZnVuY3Rpb24oJG1kSWNvblByb3ZpZGVyKSB7XHJcbiAgICogICAgICRtZEljb25Qcm92aWRlci5kZWZhdWx0Rm9udFNldCggJ2ZvbnRhd2Vzb21lJyApO1xyXG4gICAqICAgfSk7XHJcbiAgICogPC9obGpzPlxyXG4gICAqXHJcbiAgICovXHJcblxyXG4gICAvKipcclxuICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgKiBAbmFtZSAkbWRJY29uUHJvdmlkZXIjZGVmYXVsdFZpZXdCb3hTaXplXHJcbiAgICAqXHJcbiAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgKiBXaGlsZSBgPG1kLWljb24gLz5gIG1hcmt1cCBjYW4gYWxzbyBiZSBzdHlsZSB3aXRoIHNpemluZyBDU1MsIHRoaXMgbWV0aG9kIGNvbmZpZ3VyZXNcclxuICAgICogdGhlIGRlZmF1bHQgd2lkdGggKiphbmQqKiBoZWlnaHQgdXNlZCBmb3IgYWxsIGljb25zOyB1bmxlc3Mgb3ZlcnJpZGRlbiBieSBzcGVjaWZpYyBDU1MuXHJcbiAgICAqIFRoZSBkZWZhdWx0IHNpemluZyBpcyAoMjRweCwgMjRweCkuXHJcbiAgICAqIEBwYXJhbSB7bnVtYmVyPX0gdmlld0JveFNpemUgU2V0cyB0aGUgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgdmlld0JveCBmb3IgYW4gaWNvbiBvciBhbiBpY29uIHNldC5cclxuICAgICogQWxsIGljb25zIGluIGEgc2V0IHNob3VsZCBiZSB0aGUgc2FtZSBzaXplLiBUaGUgZGVmYXVsdCB2YWx1ZSBpcyAyNC5cclxuICAgICpcclxuICAgICogQHJldHVybnMge29ian0gYW4gYCRtZEljb25Qcm92aWRlcmAgcmVmZXJlbmNlOyB1c2VkIHRvIHN1cHBvcnQgbWV0aG9kIGNhbGwgY2hhaW5zIGZvciB0aGUgQVBJXHJcbiAgICAqXHJcbiAgICAqIEB1c2FnZVxyXG4gICAgKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICAgICogICBhcHAuY29uZmlnKGZ1bmN0aW9uKCRtZEljb25Qcm92aWRlcikge1xyXG4gICAgKlxyXG4gICAgKiAgICAgLy8gQ29uZmlndXJlIFVSTHMgZm9yIGljb25zIHNwZWNpZmllZCBieSBbc2V0Ol1pZC5cclxuICAgICpcclxuICAgICogICAgICRtZEljb25Qcm92aWRlclxyXG4gICAgKiAgICAgICAgICAuZGVmYXVsdFZpZXdCb3hTaXplKDM2KSAgIC8vIFJlZ2lzdGVyIGEgZGVmYXVsdCBpY29uIHNpemUgKHdpZHRoID09IGhlaWdodClcclxuICAgICogICB9KTtcclxuICAgICogPC9obGpzPlxyXG4gICAgKlxyXG4gICAgKi9cclxuXHJcbiB2YXIgY29uZmlnID0ge1xyXG4gICBkZWZhdWx0Vmlld0JveFNpemU6IDI0LFxyXG4gICBkZWZhdWx0Rm9udFNldDogJ21hdGVyaWFsLWljb25zJyxcclxuICAgZm9udFNldHMgOiBbIF1cclxuIH07XHJcblxyXG4gZnVuY3Rpb24gTWRJY29uUHJvdmlkZXIoKSB7IH1cclxuXHJcbiBNZEljb25Qcm92aWRlci5wcm90b3R5cGUgPSB7XHJcbiAgIGljb24gOiBmdW5jdGlvbiAoaWQsIHVybCwgdmlld0JveFNpemUpIHtcclxuICAgICBpZiAoIGlkLmluZGV4T2YoJzonKSA9PSAtMSApIGlkID0gJyRkZWZhdWx0OicgKyBpZDtcclxuXHJcbiAgICAgY29uZmlnW2lkXSA9IG5ldyBDb25maWd1cmF0aW9uSXRlbSh1cmwsIHZpZXdCb3hTaXplICk7XHJcbiAgICAgcmV0dXJuIHRoaXM7XHJcbiAgIH0sXHJcblxyXG4gICBpY29uU2V0IDogZnVuY3Rpb24gKGlkLCB1cmwsIHZpZXdCb3hTaXplKSB7XHJcbiAgICAgY29uZmlnW2lkXSA9IG5ldyBDb25maWd1cmF0aW9uSXRlbSh1cmwsIHZpZXdCb3hTaXplICk7XHJcbiAgICAgcmV0dXJuIHRoaXM7XHJcbiAgIH0sXHJcblxyXG4gICBkZWZhdWx0SWNvblNldCA6IGZ1bmN0aW9uICh1cmwsIHZpZXdCb3hTaXplKSB7XHJcbiAgICAgdmFyIHNldE5hbWUgPSAnJGRlZmF1bHQnO1xyXG5cclxuICAgICBpZiAoICFjb25maWdbc2V0TmFtZV0gKSB7XHJcbiAgICAgICBjb25maWdbc2V0TmFtZV0gPSBuZXcgQ29uZmlndXJhdGlvbkl0ZW0odXJsLCB2aWV3Qm94U2l6ZSApO1xyXG4gICAgIH1cclxuXHJcbiAgICAgY29uZmlnW3NldE5hbWVdLnZpZXdCb3hTaXplID0gdmlld0JveFNpemUgfHwgY29uZmlnLmRlZmF1bHRWaWV3Qm94U2l6ZTtcclxuXHJcbiAgICAgcmV0dXJuIHRoaXM7XHJcbiAgIH0sXHJcblxyXG4gICBkZWZhdWx0Vmlld0JveFNpemUgOiBmdW5jdGlvbiAodmlld0JveFNpemUpIHtcclxuICAgICBjb25maWcuZGVmYXVsdFZpZXdCb3hTaXplID0gdmlld0JveFNpemU7XHJcbiAgICAgcmV0dXJuIHRoaXM7XHJcbiAgIH0sXHJcbiAgIFxyXG4gICAvKipcclxuICAgICogUmVnaXN0ZXIgYW4gYWxpYXMgbmFtZSBhc3NvY2lhdGVkIHdpdGggYSBmb250LWljb24gbGlicmFyeSBzdHlsZSA7XHJcbiAgICAqL1xyXG4gICBmb250U2V0IDogZnVuY3Rpb24gZm9udFNldChhbGlhcywgY2xhc3NOYW1lKSB7XHJcbiAgICBjb25maWcuZm9udFNldHMucHVzaCh7XHJcbiAgICAgIGFsaWFzIDogYWxpYXMsXHJcbiAgICAgIGZvbnRTZXQgOiBjbGFzc05hbWUgfHwgYWxpYXNcclxuICAgIH0pO1xyXG4gICB9LFxyXG5cclxuICAgLyoqXHJcbiAgICAqIFNwZWNpZnkgYSBkZWZhdWx0IHN0eWxlIG5hbWUgYXNzb2NpYXRlZCB3aXRoIGEgZm9udC1pY29uIGxpYnJhcnlcclxuICAgICogZmFsbGJhY2sgdG8gTWF0ZXJpYWwgSWNvbnMuXHJcbiAgICAqXHJcbiAgICAqL1xyXG4gICBkZWZhdWx0Rm9udFNldCA6IGZ1bmN0aW9uIGRlZmF1bHRGb250U2V0KGNsYXNzTmFtZSkge1xyXG4gICAgY29uZmlnLmRlZmF1bHRGb250U2V0ID0gIWNsYXNzTmFtZSA/ICcnIDogY2xhc3NOYW1lO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgIH0sXHJcblxyXG4gICBkZWZhdWx0SWNvblNpemUgOiBmdW5jdGlvbiBkZWZhdWx0SWNvblNpemUoaWNvblNpemUpIHtcclxuICAgICBjb25maWcuZGVmYXVsdEljb25TaXplID0gaWNvblNpemU7XHJcbiAgICAgcmV0dXJuIHRoaXM7XHJcbiAgIH0sXHJcblxyXG4gICBwcmVsb2FkSWNvbnM6IGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xyXG4gICAgIHZhciBpY29uUHJvdmlkZXIgPSB0aGlzO1xyXG4gICAgIHZhciBzdmdSZWdpc3RyeSA9IFtcclxuICAgICAgIHtcclxuICAgICAgICAgaWQgOiAnbWQtdGFicy1hcnJvdycsXHJcbiAgICAgICAgIHVybDogJ21kLXRhYnMtYXJyb3cuc3ZnJyxcclxuICAgICAgICAgc3ZnOiAnPHN2ZyB2ZXJzaW9uPVwiMS4xXCIgeD1cIjBweFwiIHk9XCIwcHhcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+PGc+PHBvbHlnb24gcG9pbnRzPVwiMTUuNCw3LjQgMTQsNiA4LDEyIDE0LDE4IDE1LjQsMTYuNiAxMC44LDEyIFwiLz48L2c+PC9zdmc+J1xyXG4gICAgICAgfSxcclxuICAgICAgIHtcclxuICAgICAgICAgaWQgOiAnbWQtY2xvc2UnLFxyXG4gICAgICAgICB1cmw6ICdtZC1jbG9zZS5zdmcnLFxyXG4gICAgICAgICBzdmc6ICc8c3ZnIHZlcnNpb249XCIxLjFcIiB4PVwiMHB4XCIgeT1cIjBweFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj48Zz48cGF0aCBkPVwiTTE5IDYuNDFsLTEuNDEtMS40MS01LjU5IDUuNTktNS41OS01LjU5LTEuNDEgMS40MSA1LjU5IDUuNTktNS41OSA1LjU5IDEuNDEgMS40MSA1LjU5LTUuNTkgNS41OSA1LjU5IDEuNDEtMS40MS01LjU5LTUuNTl6XCIvPjwvZz48L3N2Zz4nXHJcbiAgICAgICB9LFxyXG4gICAgICAge1xyXG4gICAgICAgICBpZDogICdtZC1jYW5jZWwnLFxyXG4gICAgICAgICB1cmw6ICdtZC1jYW5jZWwuc3ZnJyxcclxuICAgICAgICAgc3ZnOiAnPHN2ZyB2ZXJzaW9uPVwiMS4xXCIgeD1cIjBweFwiIHk9XCIwcHhcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCI+PGc+PHBhdGggZD1cIk0xMiAyYy01LjUzIDAtMTAgNC40Ny0xMCAxMHM0LjQ3IDEwIDEwIDEwIDEwLTQuNDcgMTAtMTAtNC40Ny0xMC0xMC0xMHptNSAxMy41OWwtMS40MSAxLjQxLTMuNTktMy41OS0zLjU5IDMuNTktMS40MS0xLjQxIDMuNTktMy41OS0zLjU5LTMuNTkgMS40MS0xLjQxIDMuNTkgMy41OSAzLjU5LTMuNTkgMS40MSAxLjQxLTMuNTkgMy41OSAzLjU5IDMuNTl6XCIvPjwvZz48L3N2Zz4nXHJcbiAgICAgICB9LFxyXG4gICAgICAge1xyXG4gICAgICAgICBpZDogICdtZC1tZW51JyxcclxuICAgICAgICAgdXJsOiAnbWQtbWVudS5zdmcnLFxyXG4gICAgICAgICBzdmc6ICc8c3ZnIHZlcnNpb249XCIxLjFcIiB4PVwiMHB4XCIgeT1cIjBweFwiIHZpZXdCb3g9XCIwIDAgMTAwIDEwMFwiPjxwYXRoIGQ9XCJNIDUwIDAgTCAxMDAgMTQgTCA5MiA4MCBMIDUwIDEwMCBMIDggODAgTCAwIDE0IFpcIiBmaWxsPVwiI2IyYjJiMlwiPjwvcGF0aD48cGF0aCBkPVwiTSA1MCA1IEwgNiAxOCBMIDEzLjUgNzcgTCA1MCA5NCBaXCIgZmlsbD1cIiNFNDI5MzlcIj48L3BhdGg+PHBhdGggZD1cIk0gNTAgNSBMIDk0IDE4IEwgODYuNSA3NyBMIDUwIDk0IFpcIiBmaWxsPVwiI0I3MjgzM1wiPjwvcGF0aD48cGF0aCBkPVwiTSA1MCA3IEwgODMgNzUgTCA3MiA3NSBMIDY1IDU5IEwgNTAgNTkgTCA1MCA1MCBMIDYxIDUwIEwgNTAgMjYgWlwiIGZpbGw9XCIjYjJiMmIyXCI+PC9wYXRoPjxwYXRoIGQ9XCJNIDUwIDcgTCAxNyA3NSBMIDI4IDc1IEwgMzUgNTkgTCA1MCA1OSBMIDUwIDUwIEwgMzkgNTAgTCA1MCAyNiBaXCIgZmlsbD1cIiNmZmZcIj48L3BhdGg+PC9zdmc+J1xyXG4gICAgICAgfSxcclxuICAgICAgIHtcclxuICAgICAgICAgaWQ6ICAnbWQtdG9nZ2xlLWFycm93JyxcclxuICAgICAgICAgdXJsOiAnbWQtdG9nZ2xlLWFycm93LXN2ZycsXHJcbiAgICAgICAgIHN2ZzogJzxzdmcgdmVyc2lvbj1cIjEuMVwiIHg9XCIwcHhcIiB5PVwiMHB4XCIgdmlld0JveD1cIjAgMCA0OCA0OFwiPjxwYXRoIGQ9XCJNMjQgMTZsLTEyIDEyIDIuODMgMi44MyA5LjE3LTkuMTcgOS4xNyA5LjE3IDIuODMtMi44M3pcIi8+PHBhdGggZD1cIk0wIDBoNDh2NDhoLTQ4elwiIGZpbGw9XCJub25lXCIvPjwvc3ZnPidcclxuICAgICAgIH1cclxuICAgICBdO1xyXG5cclxuICAgICBzdmdSZWdpc3RyeS5mb3JFYWNoKGZ1bmN0aW9uKGFzc2V0KXtcclxuICAgICAgIGljb25Qcm92aWRlci5pY29uKGFzc2V0LmlkLCAgYXNzZXQudXJsKTtcclxuICAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dChhc3NldC51cmwsIGFzc2V0LnN2Zyk7XHJcbiAgICAgfSk7XHJcblxyXG4gICB9LFxyXG5cclxuICAgJGdldCA6IFsnJGh0dHAnLCAnJHEnLCAnJGxvZycsICckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKCRodHRwLCAkcSwgJGxvZywgJHRlbXBsYXRlQ2FjaGUpIHtcclxuICAgICB0aGlzLnByZWxvYWRJY29ucygkdGVtcGxhdGVDYWNoZSk7XHJcbiAgICAgcmV0dXJuIE1kSWNvblNlcnZpY2UoY29uZmlnLCAkaHR0cCwgJHEsICRsb2csICR0ZW1wbGF0ZUNhY2hlKTtcclxuICAgfV1cclxuIH07XHJcblxyXG4gICAvKipcclxuICAgICogIENvbmZpZ3VyYXRpb24gaXRlbSBzdG9yZWQgaW4gdGhlIEljb24gcmVnaXN0cnk7IHVzZWQgZm9yIGxvb2t1cHNcclxuICAgICogIHRvIGxvYWQgaWYgbm90IGFscmVhZHkgY2FjaGVkIGluIHRoZSBgbG9hZGVkYCBjYWNoZVxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gQ29uZmlndXJhdGlvbkl0ZW0odXJsLCB2aWV3Qm94U2l6ZSkge1xyXG4gICAgIHRoaXMudXJsID0gdXJsO1xyXG4gICAgIHRoaXMudmlld0JveFNpemUgPSB2aWV3Qm94U2l6ZSB8fCBjb25maWcuZGVmYXVsdFZpZXdCb3hTaXplO1xyXG4gICB9XHJcblxyXG4gLyoqXHJcbiAgKiBAbmdkb2Mgc2VydmljZVxyXG4gICogQG5hbWUgJG1kSWNvblxyXG4gICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmljb25cclxuICAqXHJcbiAgKiBAZGVzY3JpcHRpb25cclxuICAqIFRoZSBgJG1kSWNvbmAgc2VydmljZSBpcyBhIGZ1bmN0aW9uIHVzZWQgdG8gbG9va3VwIFNWRyBpY29ucy5cclxuICAqXHJcbiAgKiBAcGFyYW0ge3N0cmluZ30gaWQgUXVlcnkgdmFsdWUgZm9yIGEgdW5pcXVlIElkIG9yIFVSTC4gSWYgdGhlIGFyZ3VtZW50IGlzIGEgVVJMLCB0aGVuIHRoZSBzZXJ2aWNlIHdpbGwgcmV0cmlldmUgdGhlIGljb24gZWxlbWVudFxyXG4gICogZnJvbSBpdHMgaW50ZXJuYWwgY2FjaGUgb3IgbG9hZCB0aGUgaWNvbiBhbmQgY2FjaGUgaXQgZmlyc3QuIElmIHRoZSB2YWx1ZSBpcyBub3QgYSBVUkwtdHlwZSBzdHJpbmcsIHRoZW4gYW4gSUQgbG9va3VwIGlzXHJcbiAgKiBwZXJmb3JtZWQuIFRoZSBJZCBtYXkgYmUgYSB1bmlxdWUgaWNvbiBJRCBvciBtYXkgaW5jbHVkZSBhbiBpY29uU2V0IElEIHByZWZpeC5cclxuICAqXHJcbiAgKiBGb3IgdGhlICoqaWQqKiBxdWVyeSB0byB3b3JrIHByb3Blcmx5LCB0aGlzIG1lYW5zIHRoYXQgYWxsIGlkLXRvLVVSTCBtYXBwaW5ncyBtdXN0IGhhdmUgYmVlbiBwcmV2aW91c2x5IGNvbmZpZ3VyZWRcclxuICAqIHVzaW5nIHRoZSBgJG1kSWNvblByb3ZpZGVyYC5cclxuICAqXHJcbiAgKiBAcmV0dXJucyB7b2JqfSBDbG9uZSBvZiB0aGUgaW5pdGlhbCBTVkcgRE9NIGVsZW1lbnQ7IHdoaWNoIHdhcyBjcmVhdGVkIGZyb20gdGhlIFNWRyBtYXJrdXAgaW4gdGhlIFNWRyBkYXRhIGZpbGUuXHJcbiAgKlxyXG4gICogQHVzYWdlXHJcbiAgKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICAqIGZ1bmN0aW9uIFNvbWVEaXJlY3RpdmUoJG1kSWNvbikge1xyXG4gICpcclxuICAqICAgLy8gU2VlIGlmIHRoZSBpY29uIGhhcyBhbHJlYWR5IGJlZW4gbG9hZGVkLCBpZiBub3RcclxuICAqICAgLy8gdGhlbiBsb29rdXAgdGhlIGljb24gZnJvbSB0aGUgcmVnaXN0cnkgY2FjaGUsIGxvYWQgYW5kIGNhY2hlXHJcbiAgKiAgIC8vIGl0IGZvciBmdXR1cmUgcmVxdWVzdHMuXHJcbiAgKiAgIC8vIE5PVEU6IElEIHF1ZXJpZXMgcmVxdWlyZSBjb25maWd1cmF0aW9uIHdpdGggJG1kSWNvblByb3ZpZGVyXHJcbiAgKlxyXG4gICogICAkbWRJY29uKCdhbmRyb2lkJykudGhlbihmdW5jdGlvbihpY29uRWwpICAgIHsgZWxlbWVudC5hcHBlbmQoaWNvbkVsKTsgfSk7XHJcbiAgKiAgICRtZEljb24oJ3dvcms6Y2hhaXInKS50aGVuKGZ1bmN0aW9uKGljb25FbCkgeyBlbGVtZW50LmFwcGVuZChpY29uRWwpOyB9KTtcclxuICAqXHJcbiAgKiAgIC8vIExvYWQgYW5kIGNhY2hlIHRoZSBleHRlcm5hbCBTVkcgdXNpbmcgYSBVUkxcclxuICAqXHJcbiAgKiAgICRtZEljb24oJ2ltZy9pY29ucy9hbmRyb2lkLnN2ZycpLnRoZW4oZnVuY3Rpb24oaWNvbkVsKSB7XHJcbiAgKiAgICAgZWxlbWVudC5hcHBlbmQoaWNvbkVsKTtcclxuICAqICAgfSk7XHJcbiAgKiB9O1xyXG4gICogPC9obGpzPlxyXG4gICpcclxuICAqIE5PVEU6IFRoZSBgPG1kLWljb24gLz4gIGAgZGlyZWN0aXZlIGludGVybmFsbHkgdXNlcyB0aGUgYCRtZEljb25gIHNlcnZpY2UgdG8gcXVlcnksIGxvYWRlZCwgYW5kIGluc3RhbnRpYXRlXHJcbiAgKiBTVkcgRE9NIGVsZW1lbnRzLlxyXG4gICovXHJcbiBmdW5jdGlvbiBNZEljb25TZXJ2aWNlKGNvbmZpZywgJGh0dHAsICRxLCAkbG9nLCAkdGVtcGxhdGVDYWNoZSkge1xyXG4gICB2YXIgaWNvbkNhY2hlID0ge307XHJcbiAgIHZhciB1cmxSZWdleCA9IC9bLWEtekEtWjAtOUA6JV9cXCsufiM/Ji8vPV17MiwyNTZ9XFwuW2Etel17Miw0fVxcYihcXC9bLWEtekEtWjAtOUA6JV9cXCsufiM/Ji8vPV0qKT8vaTtcclxuXHJcbiAgIEljb24ucHJvdG90eXBlID0geyBjbG9uZSA6IGNsb25lU1ZHLCBwcmVwYXJlOiBwcmVwYXJlQW5kU3R5bGUgfTtcclxuICAgZ2V0SWNvbi5mb250U2V0ID0gZmluZFJlZ2lzdGVyZWRGb250U2V0O1xyXG5cclxuICAgLy8gUHVibGlzaCBzZXJ2aWNlLi4uXHJcbiAgIHJldHVybiBnZXRJY29uO1xyXG5cclxuICAgLyoqXHJcbiAgICAqIEFjdHVhbCAkbWRJY29uIHNlcnZpY2UgaXMgZXNzZW50aWFsbHkgYSBsb29rdXAgZnVuY3Rpb25cclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIGdldEljb24oaWQpIHtcclxuICAgICBpZCA9IGlkIHx8ICcnO1xyXG5cclxuICAgICAvLyBJZiBhbHJlYWR5IGxvYWRlZCBhbmQgY2FjaGVkLCB1c2UgYSBjbG9uZSBvZiB0aGUgY2FjaGVkIGljb24uXHJcbiAgICAgLy8gT3RoZXJ3aXNlIGVpdGhlciBsb2FkIGJ5IFVSTCwgb3IgbG9va3VwIGluIHRoZSByZWdpc3RyeSBhbmQgdGhlbiBsb2FkIGJ5IFVSTCwgYW5kIGNhY2hlLlxyXG5cclxuICAgICBpZiAoIGljb25DYWNoZVtpZF0gICAgICAgICApIHJldHVybiAkcS53aGVuKCBpY29uQ2FjaGVbaWRdLmNsb25lKCkgKTtcclxuICAgICBpZiAoIHVybFJlZ2V4LnRlc3QoaWQpICAgICApIHJldHVybiBsb2FkQnlVUkwoaWQpLnRoZW4oIGNhY2hlSWNvbihpZCkgKTtcclxuICAgICBpZiAoIGlkLmluZGV4T2YoJzonKSA9PSAtMSApIGlkID0gJyRkZWZhdWx0OicgKyBpZDtcclxuXHJcbiAgICAgcmV0dXJuIGxvYWRCeUlEKGlkKVxyXG4gICAgICAgICAuY2F0Y2gobG9hZEZyb21JY29uU2V0KVxyXG4gICAgICAgICAuY2F0Y2goYW5ub3VuY2VJZE5vdEZvdW5kKVxyXG4gICAgICAgICAuY2F0Y2goYW5ub3VuY2VOb3RGb3VuZClcclxuICAgICAgICAgLnRoZW4oIGNhY2hlSWNvbihpZCkgKTtcclxuICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqIExvb2t1cCByZWdpc3RlcmVkIGZvbnRTZXQgc3R5bGUgdXNpbmcgaXRzIGFsaWFzLi4uXHJcbiAgICAqIElmIG5vdCBmb3VuZCxcclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIGZpbmRSZWdpc3RlcmVkRm9udFNldChhbGlhcykge1xyXG4gICAgICB2YXIgdXNlRGVmYXVsdCA9IGFuZ3VsYXIuaXNVbmRlZmluZWQoYWxpYXMpIHx8ICEoYWxpYXMgJiYgYWxpYXMubGVuZ3RoKTtcclxuICAgICAgaWYgKCB1c2VEZWZhdWx0ICkgcmV0dXJuIGNvbmZpZy5kZWZhdWx0Rm9udFNldDtcclxuXHJcbiAgICAgIHZhciByZXN1bHQgPSBhbGlhcztcclxuICAgICAgYW5ndWxhci5mb3JFYWNoKGNvbmZpZy5mb250U2V0cywgZnVuY3Rpb24oaXQpe1xyXG4gICAgICAgIGlmICggaXQuYWxpYXMgPT0gYWxpYXMgKSByZXN1bHQgPSBpdC5mb250U2V0IHx8IHJlc3VsdDtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogUHJlcGFyZSBhbmQgY2FjaGUgdGhlIGxvYWRlZCBpY29uIGZvciB0aGUgc3BlY2lmaWVkIGBpZGBcclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIGNhY2hlSWNvbiggaWQgKSB7XHJcblxyXG4gICAgIHJldHVybiBmdW5jdGlvbiB1cGRhdGVDYWNoZSggaWNvbiApIHtcclxuICAgICAgIGljb25DYWNoZVtpZF0gPSBpc0ljb24oaWNvbikgPyBpY29uIDogbmV3IEljb24oaWNvbiwgY29uZmlnW2lkXSk7XHJcblxyXG4gICAgICAgcmV0dXJuIGljb25DYWNoZVtpZF0uY2xvbmUoKTtcclxuICAgICB9O1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogTG9va3VwIHRoZSBjb25maWd1cmF0aW9uIGluIHRoZSByZWdpc3RyeSwgaWYgIXJlZ2lzdGVyZWQgdGhyb3cgYW4gZXJyb3JcclxuICAgICogb3RoZXJ3aXNlIGxvYWQgdGhlIGljb24gW29uLWRlbWFuZF0gdXNpbmcgdGhlIHJlZ2lzdGVyZWQgVVJMLlxyXG4gICAgKlxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gbG9hZEJ5SUQoaWQpIHtcclxuICAgICB2YXIgaWNvbkNvbmZpZyA9IGNvbmZpZ1tpZF07XHJcblxyXG4gICAgIHJldHVybiAhaWNvbkNvbmZpZyA/ICRxLnJlamVjdChpZCkgOiBsb2FkQnlVUkwoaWNvbkNvbmZpZy51cmwpLnRoZW4oZnVuY3Rpb24oaWNvbikge1xyXG4gICAgICAgcmV0dXJuIG5ldyBJY29uKGljb24sIGljb25Db25maWcpO1xyXG4gICAgIH0pO1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogICAgTG9hZHMgdGhlIGZpbGUgYXMgWE1MIGFuZCB1c2VzIHF1ZXJ5U2VsZWN0b3IoIDxpZD4gKSB0byBmaW5kXHJcbiAgICAqICAgIHRoZSBkZXNpcmVkIG5vZGUuLi5cclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIGxvYWRGcm9tSWNvblNldChpZCkge1xyXG4gICAgIHZhciBzZXROYW1lID0gaWQuc3Vic3RyaW5nKDAsIGlkLmxhc3RJbmRleE9mKCc6JykpIHx8ICckZGVmYXVsdCc7XHJcbiAgICAgdmFyIGljb25TZXRDb25maWcgPSBjb25maWdbc2V0TmFtZV07XHJcblxyXG4gICAgIHJldHVybiAhaWNvblNldENvbmZpZyA/ICRxLnJlamVjdChpZCkgOiBsb2FkQnlVUkwoaWNvblNldENvbmZpZy51cmwpLnRoZW4oZXh0cmFjdEZyb21TZXQpO1xyXG5cclxuICAgICBmdW5jdGlvbiBleHRyYWN0RnJvbVNldChzZXQpIHtcclxuICAgICAgIHZhciBpY29uTmFtZSA9IGlkLnNsaWNlKGlkLmxhc3RJbmRleE9mKCc6JykgKyAxKTtcclxuICAgICAgIHZhciBpY29uID0gc2V0LnF1ZXJ5U2VsZWN0b3IoJyMnICsgaWNvbk5hbWUpO1xyXG4gICAgICAgcmV0dXJuICFpY29uID8gJHEucmVqZWN0KGlkKSA6IG5ldyBJY29uKGljb24sIGljb25TZXRDb25maWcpO1xyXG4gICAgIH1cclxuICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqIExvYWQgdGhlIGljb24gYnkgVVJMIChtYXkgdXNlIHRoZSAkdGVtcGxhdGVDYWNoZSkuXHJcbiAgICAqIEV4dHJhY3QgdGhlIGRhdGEgZm9yIGxhdGVyIGNvbnZlcnNpb24gdG8gSWNvblxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gbG9hZEJ5VVJMKHVybCkge1xyXG4gICAgIHJldHVybiAkaHR0cFxyXG4gICAgICAgLmdldCh1cmwsIHsgY2FjaGU6ICR0ZW1wbGF0ZUNhY2hlIH0pXHJcbiAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICByZXR1cm4gYW5ndWxhci5lbGVtZW50KCc8ZGl2PicpLmFwcGVuZChyZXNwb25zZS5kYXRhKS5maW5kKCdzdmcnKVswXTtcclxuICAgICAgIH0pO1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogVXNlciBkaWQgbm90IHNwZWNpZnkgYSBVUkwgYW5kIHRoZSBJRCBoYXMgbm90IGJlZW4gcmVnaXN0ZXJlZCB3aXRoIHRoZSAkbWRJY29uXHJcbiAgICAqIHJlZ2lzdHJ5XHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBhbm5vdW5jZUlkTm90Rm91bmQoaWQpIHtcclxuICAgICB2YXIgbXNnO1xyXG5cclxuICAgICBpZiAoYW5ndWxhci5pc1N0cmluZyhpZCkpIHtcclxuICAgICAgIG1zZyA9ICdpY29uICcgKyBpZCArICcgbm90IGZvdW5kJztcclxuICAgICAgICRsb2cud2Fybihtc2cpO1xyXG4gICAgIH1cclxuXHJcbiAgICAgcmV0dXJuICRxLnJlamVjdChtc2cgfHwgaWQpO1xyXG4gICB9XHJcblxyXG4gICAvKipcclxuICAgICogQ2F0Y2ggSFRUUCBvciBnZW5lcmljIGVycm9ycyBub3QgcmVsYXRlZCB0byBpbmNvcnJlY3QgaWNvbiBJRHMuXHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBhbm5vdW5jZU5vdEZvdW5kKGVycikge1xyXG4gICAgIHZhciBtc2cgPSBhbmd1bGFyLmlzU3RyaW5nKGVycikgPyBlcnIgOiAoZXJyLm1lc3NhZ2UgfHwgZXJyLmRhdGEgfHwgZXJyLnN0YXR1c1RleHQpO1xyXG4gICAgICRsb2cud2Fybihtc2cpO1xyXG5cclxuICAgICByZXR1cm4gJHEucmVqZWN0KG1zZyk7XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgKiBDaGVjayB0YXJnZXQgc2lnbmF0dXJlIHRvIHNlZSBpZiBpdCBpcyBhbiBJY29uIGluc3RhbmNlLlxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gaXNJY29uKHRhcmdldCkge1xyXG4gICAgIHJldHVybiBhbmd1bGFyLmlzRGVmaW5lZCh0YXJnZXQuZWxlbWVudCkgJiYgYW5ndWxhci5pc0RlZmluZWQodGFyZ2V0LmNvbmZpZyk7XHJcbiAgIH1cclxuXHJcbiAgIC8qKlxyXG4gICAgKiAgRGVmaW5lIHRoZSBJY29uIGNsYXNzXHJcbiAgICAqL1xyXG4gICBmdW5jdGlvbiBJY29uKGVsLCBjb25maWcpIHtcclxuICAgICBpZiAoZWwudGFnTmFtZSAhPSAnc3ZnJykge1xyXG4gICAgICAgZWwgPSBhbmd1bGFyLmVsZW1lbnQoJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPicpLmFwcGVuZChlbClbMF07XHJcbiAgICAgfVxyXG5cclxuICAgICAvLyBJbmplY3QgdGhlIG5hbWVzcGFjZSBpZiBub3QgYXZhaWxhYmxlLi4uXHJcbiAgICAgaWYgKCAhZWwuZ2V0QXR0cmlidXRlKCd4bWxucycpICkge1xyXG4gICAgICAgZWwuc2V0QXR0cmlidXRlKCd4bWxucycsIFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIik7XHJcbiAgICAgfVxyXG5cclxuICAgICB0aGlzLmVsZW1lbnQgPSBlbDtcclxuICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuICAgICB0aGlzLnByZXBhcmUoKTtcclxuICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqICBQcmVwYXJlIHRoZSBET00gZWxlbWVudCB0aGF0IHdpbGwgYmUgY2FjaGVkIGluIHRoZVxyXG4gICAgKiAgbG9hZGVkIGljb25DYWNoZSBzdG9yZS5cclxuICAgICovXHJcbiAgIGZ1bmN0aW9uIHByZXBhcmVBbmRTdHlsZSgpIHtcclxuICAgICB2YXIgdmlld0JveFNpemUgPSB0aGlzLmNvbmZpZyA/IHRoaXMuY29uZmlnLnZpZXdCb3hTaXplIDogY29uZmlnLmRlZmF1bHRWaWV3Qm94U2l6ZTtcclxuICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHtcclxuICAgICAgICAgICAnZml0JyAgIDogJycsXHJcbiAgICAgICAgICAgJ2hlaWdodCc6ICcxMDAlJyxcclxuICAgICAgICAgICAnd2lkdGgnIDogJzEwMCUnLFxyXG4gICAgICAgICAgICdwcmVzZXJ2ZUFzcGVjdFJhdGlvJzogJ3hNaWRZTWlkIG1lZXQnLFxyXG4gICAgICAgICAgICd2aWV3Qm94JyA6IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnKSB8fCAoJzAgMCAnICsgdmlld0JveFNpemUgKyAnICcgKyB2aWV3Qm94U2l6ZSlcclxuICAgICAgICAgfSwgZnVuY3Rpb24odmFsLCBhdHRyKSB7XHJcbiAgICAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyLCB2YWwpO1xyXG4gICAgICAgICB9LCB0aGlzKTtcclxuXHJcbiAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh7XHJcbiAgICAgICAgICAgJ3BvaW50ZXItZXZlbnRzJyA6ICdub25lJyxcclxuICAgICAgICAgICAnZGlzcGxheScgOiAnYmxvY2snXHJcbiAgICAgICAgIH0sIGZ1bmN0aW9uKHZhbCwgc3R5bGUpIHtcclxuICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGVbc3R5bGVdID0gdmFsO1xyXG4gICAgICAgICB9LCB0aGlzKTtcclxuICAgfVxyXG5cclxuICAgLyoqXHJcbiAgICAqIENsb25lIHRoZSBJY29uIERPTSBlbGVtZW50LlxyXG4gICAgKi9cclxuICAgZnVuY3Rpb24gY2xvbmVTVkcoKXtcclxuICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcclxuICAgfVxyXG5cclxuIH1cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuaW5wdXRcclxuICovXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5pbnB1dCcsIFtcclxuICAnbWF0ZXJpYWwuY29yZSdcclxuXSlcclxuICAuZGlyZWN0aXZlKCdtZElucHV0Q29udGFpbmVyJywgbWRJbnB1dENvbnRhaW5lckRpcmVjdGl2ZSlcclxuICAuZGlyZWN0aXZlKCdsYWJlbCcsIGxhYmVsRGlyZWN0aXZlKVxyXG4gIC5kaXJlY3RpdmUoJ2lucHV0JywgaW5wdXRUZXh0YXJlYURpcmVjdGl2ZSlcclxuICAuZGlyZWN0aXZlKCd0ZXh0YXJlYScsIGlucHV0VGV4dGFyZWFEaXJlY3RpdmUpXHJcbiAgLmRpcmVjdGl2ZSgnbWRNYXhsZW5ndGgnLCBtZE1heGxlbmd0aERpcmVjdGl2ZSlcclxuICAuZGlyZWN0aXZlKCdwbGFjZWhvbGRlcicsIHBsYWNlaG9sZGVyRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kSW5wdXRDb250YWluZXJcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmlucHV0XHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBgPG1kLWlucHV0LWNvbnRhaW5lcj5gIGlzIHRoZSBwYXJlbnQgb2YgYW55IGlucHV0IG9yIHRleHRhcmVhIGVsZW1lbnQuXHJcbiAqXHJcbiAqIElucHV0IGFuZCB0ZXh0YXJlYSBlbGVtZW50cyB3aWxsIG5vdCBiZWhhdmUgcHJvcGVybHkgdW5sZXNzIHRoZSBtZC1pbnB1dC1jb250YWluZXJcclxuICogcGFyZW50IGlzIHByb3ZpZGVkLlxyXG4gKlxyXG4gKiBAcGFyYW0gbWQtaXMtZXJyb3Ige2V4cHJlc3Npb249fSBXaGVuIHRoZSBnaXZlbiBleHByZXNzaW9uIGV2YWx1YXRlcyB0byB0cnVlLCB0aGUgaW5wdXQgY29udGFpbmVyIHdpbGwgZ28gaW50byBlcnJvciBzdGF0ZS4gRGVmYXVsdHMgdG8gZXJyb3JpbmcgaWYgdGhlIGlucHV0IGhhcyBiZWVuIHRvdWNoZWQgYW5kIGlzIGludmFsaWQuXHJcbiAqIEBwYXJhbSBtZC1uby1mbG9hdCB7Ym9vbGVhbj19IFdoZW4gcHJlc2VudCwgcGxhY2Vob2xkZXJzIHdpbGwgbm90IGJlIGNvbnZlcnRlZCB0byBmbG9hdGluZyBsYWJlbHNcclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqXHJcbiAqIDxtZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgPGxhYmVsPlVzZXJuYW1lPC9sYWJlbD5cclxuICogICA8aW5wdXQgdHlwZT1cInRleHRcIiBuZy1tb2RlbD1cInVzZXIubmFtZVwiPlxyXG4gKiA8L21kLWlucHV0LWNvbnRhaW5lcj5cclxuICpcclxuICogPG1kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICA8bGFiZWw+RGVzY3JpcHRpb248L2xhYmVsPlxyXG4gKiAgIDx0ZXh0YXJlYSBuZy1tb2RlbD1cInVzZXIuZGVzY3JpcHRpb25cIj48L3RleHRhcmVhPlxyXG4gKiA8L21kLWlucHV0LWNvbnRhaW5lcj5cclxuICpcclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gbWRJbnB1dENvbnRhaW5lckRpcmVjdGl2ZSgkbWRUaGVtaW5nLCAkcGFyc2UpIHtcclxuICBDb250YWluZXJDdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRhdHRyc1wiXTtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGxpbms6IHBvc3RMaW5rLFxyXG4gICAgY29udHJvbGxlcjogQ29udGFpbmVyQ3RybFxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gIH1cclxuICBmdW5jdGlvbiBDb250YWluZXJDdHJsKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHNlbGYuaXNFcnJvckdldHRlciA9ICRhdHRycy5tZElzRXJyb3IgJiYgJHBhcnNlKCRhdHRycy5tZElzRXJyb3IpO1xyXG5cclxuICAgIHNlbGYuZGVsZWdhdGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICBzZWxmLmlucHV0LmZvY3VzKCk7XHJcbiAgICB9O1xyXG4gICAgc2VsZi5lbGVtZW50ID0gJGVsZW1lbnQ7XHJcbiAgICBzZWxmLnNldEZvY3VzZWQgPSBmdW5jdGlvbihpc0ZvY3VzZWQpIHtcclxuICAgICAgJGVsZW1lbnQudG9nZ2xlQ2xhc3MoJ21kLWlucHV0LWZvY3VzZWQnLCAhIWlzRm9jdXNlZCk7XHJcbiAgICB9O1xyXG4gICAgc2VsZi5zZXRIYXNWYWx1ZSA9IGZ1bmN0aW9uKGhhc1ZhbHVlKSB7XHJcbiAgICAgICRlbGVtZW50LnRvZ2dsZUNsYXNzKCdtZC1pbnB1dC1oYXMtdmFsdWUnLCAhIWhhc1ZhbHVlKTtcclxuICAgIH07XHJcbiAgICBzZWxmLnNldEludmFsaWQgPSBmdW5jdGlvbihpc0ludmFsaWQpIHtcclxuICAgICAgJGVsZW1lbnQudG9nZ2xlQ2xhc3MoJ21kLWlucHV0LWludmFsaWQnLCAhIWlzSW52YWxpZCk7XHJcbiAgICB9O1xyXG4gICAgJHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIHNlbGYubGFiZWwgJiYgc2VsZi5pbnB1dDtcclxuICAgIH0sIGZ1bmN0aW9uKGhhc0xhYmVsQW5kSW5wdXQpIHtcclxuICAgICAgaWYgKGhhc0xhYmVsQW5kSW5wdXQgJiYgIXNlbGYubGFiZWwuYXR0cignZm9yJykpIHtcclxuICAgICAgICBzZWxmLmxhYmVsLmF0dHIoJ2ZvcicsIHNlbGYuaW5wdXQuYXR0cignaWQnKSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5tZElucHV0Q29udGFpbmVyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCIsIFwiJHBhcnNlXCJdO1xyXG5cclxuZnVuY3Rpb24gbGFiZWxEaXJlY3RpdmUoKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiAnXj9tZElucHV0Q29udGFpbmVyJyxcclxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjb250YWluZXJDdHJsKSB7XHJcbiAgICAgIGlmICghY29udGFpbmVyQ3RybCB8fCBhdHRyLm1kTm9GbG9hdCkgcmV0dXJuO1xyXG5cclxuICAgICAgY29udGFpbmVyQ3RybC5sYWJlbCA9IGVsZW1lbnQ7XHJcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb250YWluZXJDdHJsLmxhYmVsID0gbnVsbDtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRJbnB1dFxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuaW5wdXRcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFVzZSB0aGUgYDxpbnB1dD5gIG9yIHRoZSAgYDx0ZXh0YXJlYT5gIGFzIGEgY2hpbGQgb2YgYW4gYDxtZC1pbnB1dC1jb250YWluZXI+YC5cclxuICpcclxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1tYXhsZW5ndGggVGhlIG1heGltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMgYWxsb3dlZCBpbiB0aGlzIGlucHV0LiBJZiB0aGlzIGlzIHNwZWNpZmllZCwgYSBjaGFyYWN0ZXIgY291bnRlciB3aWxsIGJlIHNob3duIHVuZGVybmVhdGggdGhlIGlucHV0Ljxici8+PGJyLz5cclxuICogVGhlIHB1cnBvc2Ugb2YgKipgbWQtbWF4bGVuZ3RoYCoqIGlzIGV4YWN0bHkgdG8gc2hvdyB0aGUgbWF4IGxlbmd0aCBjb3VudGVyIHRleHQuIElmIHlvdSBkb24ndCB3YW50IHRoZSBjb3VudGVyIHRleHQgYW5kIG9ubHkgbmVlZCBcInBsYWluXCIgdmFsaWRhdGlvbiwgeW91IGNhbiB1c2UgdGhlIFwic2ltcGxlXCIgYG5nLW1heGxlbmd0aGAgb3IgbWF4bGVuZ3RoIGF0dHJpYnV0ZXMuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBBcmlhLWxhYmVsIGlzIHJlcXVpcmVkIHdoZW4gbm8gbGFiZWwgaXMgcHJlc2VudC4gIEEgd2FybmluZyBtZXNzYWdlIHdpbGwgYmUgbG9nZ2VkIGluIHRoZSBjb25zb2xlIGlmIG5vdCBwcmVzZW50LlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IHBsYWNlaG9sZGVyIEFuIGFsdGVybmF0aXZlIGFwcHJvYWNoIHRvIHVzaW5nIGFyaWEtbGFiZWwgd2hlbiB0aGUgbGFiZWwgaXMgbm90IHByZXNlbnQuICBUaGUgcGxhY2Vob2xkZXIgdGV4dCBpcyBjb3BpZWQgdG8gdGhlIGFyaWEtbGFiZWwgYXR0cmlidXRlLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICA8bGFiZWw+Q29sb3I8L2xhYmVsPlxyXG4gKiAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIG5nLW1vZGVsPVwiY29sb3JcIiByZXF1aXJlZCBtZC1tYXhsZW5ndGg9XCIxMFwiPlxyXG4gKiA8L21kLWlucHV0LWNvbnRhaW5lcj5cclxuICogPC9obGpzPlxyXG4gKiA8aDM+V2l0aCBFcnJvcnM8L2gzPlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8Zm9ybSBuYW1lPVwidXNlckZvcm1cIj5cclxuICogICA8bWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgICAgPGxhYmVsPkxhc3QgTmFtZTwvbGFiZWw+XHJcbiAqICAgICA8aW5wdXQgbmFtZT1cImxhc3ROYW1lXCIgbmctbW9kZWw9XCJsYXN0TmFtZVwiIHJlcXVpcmVkIG1kLW1heGxlbmd0aD1cIjEwXCIgbWlubGVuZ3RoPVwiNFwiPlxyXG4gKiAgICAgPGRpdiBuZy1tZXNzYWdlcz1cInVzZXJGb3JtLmxhc3ROYW1lLiRlcnJvclwiIG5nLXNob3c9XCJ1c2VyRm9ybS5sYXN0TmFtZS4kZGlydHlcIj5cclxuICogICAgICAgPGRpdiBuZy1tZXNzYWdlPVwicmVxdWlyZWRcIj5UaGlzIGlzIHJlcXVpcmVkITwvZGl2PlxyXG4gKiAgICAgICA8ZGl2IG5nLW1lc3NhZ2U9XCJtZC1tYXhsZW5ndGhcIj5UaGF0J3MgdG9vIGxvbmchPC9kaXY+XHJcbiAqICAgICAgIDxkaXYgbmctbWVzc2FnZT1cIm1pbmxlbmd0aFwiPlRoYXQncyB0b28gc2hvcnQhPC9kaXY+XHJcbiAqICAgICA8L2Rpdj5cclxuICogICA8L21kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICA8bWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgICAgPGxhYmVsPkJpb2dyYXBoeTwvbGFiZWw+XHJcbiAqICAgICA8dGV4dGFyZWEgbmFtZT1cImJpb1wiIG5nLW1vZGVsPVwiYmlvZ3JhcGh5XCIgcmVxdWlyZWQgbWQtbWF4bGVuZ3RoPVwiMTUwXCI+PC90ZXh0YXJlYT5cclxuICogICAgIDxkaXYgbmctbWVzc2FnZXM9XCJ1c2VyRm9ybS5iaW8uJGVycm9yXCIgbmctc2hvdz1cInVzZXJGb3JtLmJpby4kZGlydHlcIj5cclxuICogICAgICAgPGRpdiBuZy1tZXNzYWdlPVwicmVxdWlyZWRcIj5UaGlzIGlzIHJlcXVpcmVkITwvZGl2PlxyXG4gKiAgICAgICA8ZGl2IG5nLW1lc3NhZ2U9XCJtZC1tYXhsZW5ndGhcIj5UaGF0J3MgdG9vIGxvbmchPC9kaXY+XHJcbiAqICAgICA8L2Rpdj5cclxuICogICA8L21kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICA8bWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgICAgPGlucHV0IGFyaWEtbGFiZWw9J3RpdGxlJyBuZy1tb2RlbD0ndGl0bGUnPlxyXG4gKiAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiAgIDxtZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgICA8aW5wdXQgcGxhY2Vob2xkZXI9J3RpdGxlJyBuZy1tb2RlbD0ndGl0bGUnPlxyXG4gKiAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxyXG4gKiA8L2Zvcm0+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogUmVxdWlyZXMgW25nTWVzc2FnZXNdKGh0dHBzOi8vZG9jcy5hbmd1bGFyanMub3JnL2FwaS9uZ01lc3NhZ2VzKS5cclxuICogQmVoYXZlcyBsaWtlIHRoZSBbQW5ndWxhckpTIGlucHV0IGRpcmVjdGl2ZV0oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nL2RpcmVjdGl2ZS9pbnB1dCkuXHJcbiAqXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gaW5wdXRUZXh0YXJlYURpcmVjdGl2ZSgkbWRVdGlsLCAkd2luZG93LCAkbWRBcmlhKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiBbJ14/bWRJbnB1dENvbnRhaW5lcicsICc/bmdNb2RlbCddLFxyXG4gICAgbGluazogcG9zdExpbmtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcclxuXHJcbiAgICB2YXIgY29udGFpbmVyQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIG5nTW9kZWxDdHJsID0gY3RybHNbMV0gfHwgJG1kVXRpbC5mYWtlTmdNb2RlbCgpO1xyXG4gICAgdmFyIGlzUmVhZG9ubHkgPSBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLnJlYWRvbmx5KTtcclxuXHJcbiAgICBpZiAoICFjb250YWluZXJDdHJsICkgcmV0dXJuO1xyXG4gICAgaWYgKGNvbnRhaW5lckN0cmwuaW5wdXQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiPG1kLWlucHV0LWNvbnRhaW5lcj4gY2FuIG9ubHkgaGF2ZSAqb25lKiA8aW5wdXQ+IG9yIDx0ZXh0YXJlYT4gY2hpbGQgZWxlbWVudCFcIik7XHJcbiAgICB9XHJcbiAgICBjb250YWluZXJDdHJsLmlucHV0ID0gZWxlbWVudDtcclxuXHJcbiAgICBpZighY29udGFpbmVyQ3RybC5sYWJlbCkge1xyXG4gICAgICAkbWRBcmlhLmV4cGVjdChlbGVtZW50LCAnYXJpYS1sYWJlbCcsIGVsZW1lbnQuYXR0cigncGxhY2Vob2xkZXInKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZWxlbWVudC5hZGRDbGFzcygnbWQtaW5wdXQnKTtcclxuICAgIGlmICghZWxlbWVudC5hdHRyKCdpZCcpKSB7XHJcbiAgICAgIGVsZW1lbnQuYXR0cignaWQnLCAnaW5wdXRfJyArICRtZFV0aWwubmV4dFVpZCgpKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZWxlbWVudFswXS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICd0ZXh0YXJlYScpIHtcclxuICAgICAgc2V0dXBUZXh0YXJlYSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBpc0Vycm9yR2V0dGVyID0gY29udGFpbmVyQ3RybC5pc0Vycm9yR2V0dGVyIHx8IGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gbmdNb2RlbEN0cmwuJGludmFsaWQgJiYgbmdNb2RlbEN0cmwuJHRvdWNoZWQ7XHJcbiAgICB9O1xyXG4gICAgc2NvcGUuJHdhdGNoKGlzRXJyb3JHZXR0ZXIsIGNvbnRhaW5lckN0cmwuc2V0SW52YWxpZCk7XHJcblxyXG4gICAgbmdNb2RlbEN0cmwuJHBhcnNlcnMucHVzaChuZ01vZGVsUGlwZWxpbmVDaGVja1ZhbHVlKTtcclxuICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gobmdNb2RlbFBpcGVsaW5lQ2hlY2tWYWx1ZSk7XHJcblxyXG4gICAgZWxlbWVudC5vbignaW5wdXQnLCBpbnB1dENoZWNrVmFsdWUpO1xyXG5cclxuICAgIGlmICghaXNSZWFkb25seSkge1xyXG4gICAgICBlbGVtZW50XHJcbiAgICAgICAgLm9uKCdmb2N1cycsIGZ1bmN0aW9uKGV2KSB7XHJcbiAgICAgICAgICBjb250YWluZXJDdHJsLnNldEZvY3VzZWQodHJ1ZSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oJ2JsdXInLCBmdW5jdGlvbihldikge1xyXG4gICAgICAgICAgY29udGFpbmVyQ3RybC5zZXRGb2N1c2VkKGZhbHNlKTtcclxuICAgICAgICAgIGlucHV0Q2hlY2tWYWx1ZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvL25nTW9kZWxDdHJsLiRzZXRUb3VjaGVkKCk7XHJcbiAgICAvL2lmKCBuZ01vZGVsQ3RybC4kaW52YWxpZCApIGNvbnRhaW5lckN0cmwuc2V0SW52YWxpZCgpO1xyXG5cclxuICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpIHtcclxuICAgICAgY29udGFpbmVyQ3RybC5zZXRGb2N1c2VkKGZhbHNlKTtcclxuICAgICAgY29udGFpbmVyQ3RybC5zZXRIYXNWYWx1ZShmYWxzZSk7XHJcbiAgICAgIGNvbnRhaW5lckN0cmwuaW5wdXQgPSBudWxsO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBuZ01vZGVsUGlwZWxpbmVDaGVja1ZhbHVlKGFyZykge1xyXG4gICAgICBjb250YWluZXJDdHJsLnNldEhhc1ZhbHVlKCFuZ01vZGVsQ3RybC4kaXNFbXB0eShhcmcpKTtcclxuICAgICAgcmV0dXJuIGFyZztcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGlucHV0Q2hlY2tWYWx1ZSgpIHtcclxuICAgICAgLy8gQW4gaW5wdXQncyB2YWx1ZSBjb3VudHMgaWYgaXRzIGxlbmd0aCA+IDAsXHJcbiAgICAgIC8vIG9yIGlmIHRoZSBpbnB1dCdzIHZhbGlkaXR5IHN0YXRlIHNheXMgaXQgaGFzIGJhZCBpbnB1dCAoZWcgc3RyaW5nIGluIGEgbnVtYmVyIGlucHV0KVxyXG4gICAgICBjb250YWluZXJDdHJsLnNldEhhc1ZhbHVlKGVsZW1lbnQudmFsKCkubGVuZ3RoID4gMCB8fCAoZWxlbWVudFswXS52YWxpZGl0eXx8e30pLmJhZElucHV0KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZXR1cFRleHRhcmVhKCkge1xyXG4gICAgICB2YXIgbm9kZSA9IGVsZW1lbnRbMF07XHJcbiAgICAgIHZhciBvbkNoYW5nZVRleHRhcmVhID0gJG1kVXRpbC5kZWJvdW5jZShncm93VGV4dGFyZWEsIDEpO1xyXG5cclxuICAgICAgZnVuY3Rpb24gcGlwZWxpbmVMaXN0ZW5lcih2YWx1ZSkge1xyXG4gICAgICAgIG9uQ2hhbmdlVGV4dGFyZWEoKTtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChuZ01vZGVsQ3RybCkge1xyXG4gICAgICAgIG5nTW9kZWxDdHJsLiRmb3JtYXR0ZXJzLnB1c2gocGlwZWxpbmVMaXN0ZW5lcik7XHJcbiAgICAgICAgbmdNb2RlbEN0cmwuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChwaXBlbGluZUxpc3RlbmVyKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBvbkNoYW5nZVRleHRhcmVhKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxlbWVudC5vbigna2V5ZG93biBpbnB1dCcsIG9uQ2hhbmdlVGV4dGFyZWEpO1xyXG4gICAgICBlbGVtZW50Lm9uKCdzY3JvbGwnLCBvblNjcm9sbCk7XHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgb25DaGFuZ2VUZXh0YXJlYSk7XHJcblxyXG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZigncmVzaXplJywgb25DaGFuZ2VUZXh0YXJlYSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZnVuY3Rpb24gZ3Jvd1RleHRhcmVhKCkge1xyXG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gXCJhdXRvXCI7XHJcbiAgICAgICAgbm9kZS5zY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSBnZXRIZWlnaHQoKTtcclxuICAgICAgICBpZiAoaGVpZ2h0KSBub2RlLnN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGdldEhlaWdodCAoKSB7XHJcbiAgICAgICAgdmFyIGxpbmUgPSBub2RlLnNjcm9sbEhlaWdodCAtIG5vZGUub2Zmc2V0SGVpZ2h0O1xyXG4gICAgICAgIHJldHVybiBub2RlLm9mZnNldEhlaWdodCArIChsaW5lID4gMCA/IGxpbmUgOiAwKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gb25TY3JvbGwoZSkge1xyXG4gICAgICAgIG5vZGUuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgICAvLyBmb3Igc21vb3RoIG5ldyBsaW5lIGFkZGluZ1xyXG4gICAgICAgIHZhciBsaW5lID0gbm9kZS5zY3JvbGxIZWlnaHQgLSBub2RlLm9mZnNldEhlaWdodDtcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gbm9kZS5vZmZzZXRIZWlnaHQgKyBsaW5lO1xyXG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5pbnB1dFRleHRhcmVhRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRVdGlsXCIsIFwiJHdpbmRvd1wiLCBcIiRtZEFyaWFcIl07XHJcblxyXG5mdW5jdGlvbiBtZE1heGxlbmd0aERpcmVjdGl2ZSgkYW5pbWF0ZSkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgcmVxdWlyZTogWyduZ01vZGVsJywgJ15tZElucHV0Q29udGFpbmVyJ10sXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xyXG4gICAgdmFyIG1heGxlbmd0aDtcclxuICAgIHZhciBuZ01vZGVsQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIGNvbnRhaW5lckN0cmwgPSBjdHJsc1sxXTtcclxuICAgIHZhciBjaGFyQ291bnRFbCA9IGFuZ3VsYXIuZWxlbWVudCgnPGRpdiBjbGFzcz1cIm1kLWNoYXItY291bnRlclwiPicpO1xyXG5cclxuICAgIC8vIFN0b3AgbW9kZWwgZnJvbSB0cmltbWluZy4gVGhpcyBtYWtlcyBpdCBzbyB3aGl0ZXNwYWNlXHJcbiAgICAvLyBvdmVyIHRoZSBtYXhsZW5ndGggc3RpbGwgY291bnRzIGFzIGludmFsaWQuXHJcbiAgICBhdHRyLiRzZXQoJ25nVHJpbScsICdmYWxzZScpO1xyXG4gICAgY29udGFpbmVyQ3RybC5lbGVtZW50LmFwcGVuZChjaGFyQ291bnRFbCk7XHJcblxyXG4gICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChyZW5kZXJDaGFyQ291bnQpO1xyXG4gICAgbmdNb2RlbEN0cmwuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChyZW5kZXJDaGFyQ291bnQpO1xyXG4gICAgZWxlbWVudC5vbignaW5wdXQga2V5ZG93bicsIGZ1bmN0aW9uKCkge1xyXG4gICAgICByZW5kZXJDaGFyQ291bnQoKTsgLy9tYWtlIHN1cmUgaXQncyBjYWxsZWQgd2l0aCBubyBhcmdzXHJcbiAgICB9KTtcclxuXHJcbiAgICBzY29wZS4kd2F0Y2goYXR0ci5tZE1heGxlbmd0aCwgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgbWF4bGVuZ3RoID0gdmFsdWU7XHJcbiAgICAgIGlmIChhbmd1bGFyLmlzTnVtYmVyKHZhbHVlKSAmJiB2YWx1ZSA+IDApIHtcclxuICAgICAgICBpZiAoIWNoYXJDb3VudEVsLnBhcmVudCgpLmxlbmd0aCkge1xyXG4gICAgICAgICAgJGFuaW1hdGUuZW50ZXIoY2hhckNvdW50RWwsIGNvbnRhaW5lckN0cmwuZWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChjb250YWluZXJDdHJsLmVsZW1lbnRbMF0ubGFzdEVsZW1lbnRDaGlsZCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZW5kZXJDaGFyQ291bnQoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkYW5pbWF0ZS5sZWF2ZShjaGFyQ291bnRFbCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIG5nTW9kZWxDdHJsLiR2YWxpZGF0b3JzWydtZC1tYXhsZW5ndGgnXSA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xyXG4gICAgICBpZiAoIWFuZ3VsYXIuaXNOdW1iZXIobWF4bGVuZ3RoKSB8fCBtYXhsZW5ndGggPCAwKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuICggbW9kZWxWYWx1ZSB8fCBlbGVtZW50LnZhbCgpIHx8IHZpZXdWYWx1ZSB8fCAnJyApLmxlbmd0aCA8PSBtYXhsZW5ndGg7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHJlbmRlckNoYXJDb3VudCh2YWx1ZSkge1xyXG4gICAgICBjaGFyQ291bnRFbC50ZXh0KCAoIGVsZW1lbnQudmFsKCkgfHwgdmFsdWUgfHwgJycgKS5sZW5ndGggKyAnLycgKyBtYXhsZW5ndGggKTtcclxuICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5tZE1heGxlbmd0aERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJGFuaW1hdGVcIl07XHJcblxyXG5mdW5jdGlvbiBwbGFjZWhvbGRlckRpcmVjdGl2ZSgkbG9nKSB7XHJcbiAgdmFyIGJsYWNrTGlzdEVsZW1lbnRzID0gWydNRC1TRUxFQ1QnXTtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIHJlcXVpcmU6ICdeXj9tZElucHV0Q29udGFpbmVyJyxcclxuICAgIHByaW9yaXR5OiAyMDAsXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBpbnB1dENvbnRhaW5lcikge1xyXG4gICAgaWYgKCFpbnB1dENvbnRhaW5lcikgcmV0dXJuO1xyXG4gICAgaWYgKGJsYWNrTGlzdEVsZW1lbnRzLmluZGV4T2YoZWxlbWVudFswXS5ub2RlTmFtZSkgIT0gLTEpIHJldHVybjtcclxuICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChpbnB1dENvbnRhaW5lci5lbGVtZW50LmF0dHIoJ21kLW5vLWZsb2F0JykpKSByZXR1cm47XHJcblxyXG4gICAgdmFyIHBsYWNlaG9sZGVyVGV4dCA9IGF0dHIucGxhY2Vob2xkZXI7XHJcbiAgICBlbGVtZW50LnJlbW92ZUF0dHIoJ3BsYWNlaG9sZGVyJyk7XHJcblxyXG4gICAgaWYgKCBpbnB1dENvbnRhaW5lci5lbGVtZW50LmZpbmQoJ2xhYmVsJykubGVuZ3RoID09IDAgKSB7XHJcbiAgICAgIHZhciBwbGFjZWhvbGRlciA9ICc8bGFiZWwgbmctY2xpY2s9XCJkZWxlZ2F0ZUNsaWNrKClcIj4nICsgcGxhY2Vob2xkZXJUZXh0ICsgJzwvbGFiZWw+JztcclxuXHJcbiAgICAgIGlucHV0Q29udGFpbmVyLmVsZW1lbnQuYWRkQ2xhc3MoJ21kLWljb24tZmxvYXQnKTtcclxuICAgICAgaW5wdXRDb250YWluZXIuZWxlbWVudC5wcmVwZW5kKHBsYWNlaG9sZGVyKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICRsb2cud2FybihcIlRoZSBwbGFjZWhvbGRlcj0nXCIgKyBwbGFjZWhvbGRlclRleHQgKyBcIicgd2lsbCBiZSBpZ25vcmVkIHNpbmNlIHRoaXMgbWQtaW5wdXQtY29udGFpbmVyIGhhcyBhIGNoaWxkIGxhYmVsIGVsZW1lbnQuXCIpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbn1cclxucGxhY2Vob2xkZXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiRsb2dcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLmxpc3RcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIExpc3QgbW9kdWxlXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5saXN0JywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJ1xyXG5dKVxyXG4gIC5jb250cm9sbGVyKCdNZExpc3RDb250cm9sbGVyJywgTWRMaXN0Q29udHJvbGxlcilcclxuICAuZGlyZWN0aXZlKCdtZExpc3QnLCBtZExpc3REaXJlY3RpdmUpXHJcbiAgLmRpcmVjdGl2ZSgnbWRMaXN0SXRlbScsIG1kTGlzdEl0ZW1EaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRMaXN0XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5saXN0XHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgYDxtZC1saXN0PmAgZGlyZWN0aXZlIGlzIGEgbGlzdCBjb250YWluZXIgZm9yIDEuLm4gYDxtZC1saXN0LWl0ZW0+YCB0YWdzLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLWxpc3Q+XHJcbiAqICAgPG1kLWxpc3QtaXRlbSBjbGFzcz1cIm1kLTItbGluZVwiIG5nLXJlcGVhdD1cIml0ZW0gaW4gdG9kb3NcIj5cclxuICogICAgIDxtZC1jaGVja2JveCBuZy1tb2RlbD1cIml0ZW0uZG9uZVwiPjwvbWQtY2hlY2tib3g+XHJcbiAqICAgICA8ZGl2IGNsYXNzPVwibWQtbGlzdC1pdGVtLXRleHRcIj5cclxuICogICAgICAgPGgzPnt7aXRlbS50aXRsZX19PC9oMz5cclxuICogICAgICAgPHA+e3tpdGVtLmRlc2NyaXB0aW9ufX08L3A+XHJcbiAqICAgICA8L2Rpdj5cclxuICogICA8L21kLWxpc3QtaXRlbT5cclxuICogPC9tZC1saXN0PlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gbWRMaXN0RGlyZWN0aXZlKCRtZFRoZW1pbmcpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIGNvbXBpbGU6IGZ1bmN0aW9uKHRFbCkge1xyXG4gICAgICB0RWxbMF0uc2V0QXR0cmlidXRlKCdyb2xlJywgJ2xpc3QnKTtcclxuICAgICAgcmV0dXJuICRtZFRoZW1pbmc7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5tZExpc3REaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIl07XHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kTGlzdEl0ZW1cclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmxpc3RcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLWxpc3QtaXRlbT5gIGRpcmVjdGl2ZSBpcyBhIGNvbnRhaW5lciBpbnRlbmRlZCBmb3Igcm93IGl0ZW1zIGluIGEgYDxtZC1saXN0PmAgY29udGFpbmVyLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogIDxtZC1saXN0PlxyXG4gKiAgICA8bWQtbGlzdC1pdGVtPlxyXG4gKiAgICAgICAgICAgIEl0ZW0gY29udGVudCBpbiBsaXN0XHJcbiAqICAgIDwvbWQtbGlzdC1pdGVtPlxyXG4gKiAgPC9tZC1saXN0PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBtZExpc3RJdGVtRGlyZWN0aXZlKCRtZEFyaWEsICRtZENvbnN0YW50LCAkdGltZW91dCkge1xyXG4gIHZhciBwcm94aWVkVHlwZXMgPSBbJ21kLWNoZWNrYm94JywgJ21kLXN3aXRjaCddO1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgY29udHJvbGxlcjogJ01kTGlzdENvbnRyb2xsZXInLFxyXG4gICAgY29tcGlsZTogZnVuY3Rpb24odEVsLCB0QXR0cnMpIHtcclxuICAgICAgLy8gQ2hlY2sgZm9yIHByb3h5IGNvbnRyb2xzIChubyBuZy1jbGljayBvbiBwYXJlbnQsIGFuZCBhIGNvbnRyb2wgaW5zaWRlKVxyXG4gICAgICB2YXIgc2Vjb25kYXJ5SXRlbSA9IHRFbFswXS5xdWVyeVNlbGVjdG9yKCcubWQtc2Vjb25kYXJ5Jyk7XHJcbiAgICAgIHZhciBoYXNQcm94aWVkRWxlbWVudDtcclxuICAgICAgdmFyIHByb3h5RWxlbWVudDtcclxuXHJcbiAgICAgIHRFbFswXS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbGlzdGl0ZW0nKTtcclxuXHJcbiAgICAgIGlmICghdEF0dHJzLm5nQ2xpY2spIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgdHlwZTsgdHlwZSA9IHByb3hpZWRUeXBlc1tpXTsgKytpKSB7XHJcbiAgICAgICAgICBpZiAocHJveHlFbGVtZW50ID0gdEVsWzBdLnF1ZXJ5U2VsZWN0b3IodHlwZSkpIHtcclxuICAgICAgICAgICAgaGFzUHJveGllZEVsZW1lbnQgPSB0cnVlO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGhhc1Byb3hpZWRFbGVtZW50KSB7XHJcbiAgICAgICAgICB3cmFwSW4oJ2RpdicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIXRFbFswXS5xdWVyeVNlbGVjdG9yKCdtZC1idXR0b24nKSkge1xyXG4gICAgICAgICAgdEVsLmFkZENsYXNzKCdtZC1uby1wcm94eScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB3cmFwSW4oJ2J1dHRvbicpO1xyXG4gICAgICB9XHJcbiAgICAgIHNldHVwVG9nZ2xlQXJpYSgpO1xyXG5cclxuXHJcbiAgICAgIGZ1bmN0aW9uIHNldHVwVG9nZ2xlQXJpYSgpIHtcclxuICAgICAgICB2YXIgdG9nZ2xlVHlwZXMgPSBbJ21kLXN3aXRjaCcsICdtZC1jaGVja2JveCddO1xyXG4gICAgICAgIHZhciB0b2dnbGU7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCB0b2dnbGVUeXBlOyB0b2dnbGVUeXBlID0gdG9nZ2xlVHlwZXNbaV07ICsraSkge1xyXG4gICAgICAgICAgaWYgKHRvZ2dsZSA9IHRFbC5maW5kKHRvZ2dsZVR5cGUpWzBdKSB7XHJcbiAgICAgICAgICAgIGlmICghdG9nZ2xlLmhhc0F0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHAgPSB0RWwuZmluZCgncCcpWzBdO1xyXG4gICAgICAgICAgICAgIGlmICghcCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIHRvZ2dsZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnVG9nZ2xlICcgKyBwLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gd3JhcEluKHR5cGUpIHtcclxuICAgICAgICB2YXIgY29udGFpbmVyO1xyXG4gICAgICAgIGlmICh0eXBlID09ICdkaXYnKSB7XHJcbiAgICAgICAgICBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoJzxkaXYgY2xhc3M9XCJtZC1uby1zdHlsZSBtZC1saXN0LWl0ZW0taW5uZXJcIj4nKTtcclxuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQodEVsLmNvbnRlbnRzKCkpO1xyXG4gICAgICAgICAgdEVsLmFkZENsYXNzKCdtZC1wcm94eS1mb2N1cycpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoJzxtZC1idXR0b24gY2xhc3M9XCJtZC1uby1zdHlsZVwiPjxkaXYgY2xhc3M9XCJtZC1saXN0LWl0ZW0taW5uZXJcIj48L2Rpdj48L21kLWJ1dHRvbj4nKTtcclxuICAgICAgICAgIHZhciBjb3BpZWRBdHRycyA9IFsnbmctY2xpY2snLCAnYXJpYS1sYWJlbCcsICduZy1kaXNhYmxlZCddO1xyXG4gICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGNvcGllZEF0dHJzLCBmdW5jdGlvbihhdHRyKSB7XHJcbiAgICAgICAgICAgIGlmICh0RWxbMF0uaGFzQXR0cmlidXRlKGF0dHIpKSB7XHJcbiAgICAgICAgICAgICAgY29udGFpbmVyWzBdLnNldEF0dHJpYnV0ZShhdHRyLCB0RWxbMF0uZ2V0QXR0cmlidXRlKGF0dHIpKTtcclxuICAgICAgICAgICAgICB0RWxbMF0ucmVtb3ZlQXR0cmlidXRlKGF0dHIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNvbnRhaW5lci5jaGlsZHJlbigpLmVxKDApLmFwcGVuZCh0RWwuY29udGVudHMoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0RWxbMF0uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xyXG4gICAgICAgIHRFbC5hcHBlbmQoY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgaWYgKHNlY29uZGFyeUl0ZW0gJiYgc2Vjb25kYXJ5SXRlbS5oYXNBdHRyaWJ1dGUoJ25nLWNsaWNrJykpIHtcclxuICAgICAgICAgICRtZEFyaWEuZXhwZWN0KHNlY29uZGFyeUl0ZW0sICdhcmlhLWxhYmVsJyk7XHJcbiAgICAgICAgICB2YXIgYnV0dG9uV3JhcHBlciA9IGFuZ3VsYXIuZWxlbWVudCgnPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLXNlY29uZGFyeS1jb250YWluZXIgbWQtaWNvbi1idXR0b25cIj4nKTtcclxuICAgICAgICAgIGJ1dHRvbldyYXBwZXIuYXR0cignbmctY2xpY2snLCBzZWNvbmRhcnlJdGVtLmdldEF0dHJpYnV0ZSgnbmctY2xpY2snKSk7XHJcbiAgICAgICAgICBzZWNvbmRhcnlJdGVtLnJlbW92ZUF0dHJpYnV0ZSgnbmctY2xpY2snKTtcclxuICAgICAgICAgIHNlY29uZGFyeUl0ZW0uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xyXG4gICAgICAgICAgc2Vjb25kYXJ5SXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdtZC1zZWNvbmRhcnknKTtcclxuICAgICAgICAgIGJ1dHRvbldyYXBwZXIuYXBwZW5kKHNlY29uZGFyeUl0ZW0pO1xyXG4gICAgICAgICAgc2Vjb25kYXJ5SXRlbSA9IGJ1dHRvbldyYXBwZXJbMF07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBmb3IgYSBzZWNvbmRhcnkgaXRlbSBhbmQgbW92ZSBpdCBvdXRzaWRlXHJcbiAgICAgICAgaWYgKCBzZWNvbmRhcnlJdGVtICYmIChcclxuICAgICAgICAgIHNlY29uZGFyeUl0ZW0uaGFzQXR0cmlidXRlKCduZy1jbGljaycpIHx8XHJcbiAgICAgICAgICAgICggdEF0dHJzLm5nQ2xpY2sgJiZcclxuICAgICAgICAgICAgIGlzUHJveGllZEVsZW1lbnQoc2Vjb25kYXJ5SXRlbSkgKVxyXG4gICAgICAgICkpIHtcclxuICAgICAgICAgIHRFbC5hZGRDbGFzcygnbWQtd2l0aC1zZWNvbmRhcnknKTtcclxuICAgICAgICAgIHRFbC5hcHBlbmQoc2Vjb25kYXJ5SXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBpc1Byb3hpZWRFbGVtZW50KGVsKSB7XHJcbiAgICAgICAgcmV0dXJuIHByb3hpZWRUeXBlcy5pbmRleE9mKGVsLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpICE9IC0xO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcG9zdExpbms7XHJcblxyXG4gICAgICBmdW5jdGlvbiBwb3N0TGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0ciwgY3RybCkge1xyXG5cclxuICAgICAgICB2YXIgcHJveGllcyAgICA9IFtdLFxyXG4gICAgICAgICAgICBmaXJzdENoaWxkID0gJGVsZW1lbnRbMF0uZmlyc3RFbGVtZW50Q2hpbGQsXHJcbiAgICAgICAgICAgIGhhc0NsaWNrICAgPSBmaXJzdENoaWxkICYmIGZpcnN0Q2hpbGQuaGFzQXR0cmlidXRlKCduZy1jbGljaycpO1xyXG5cclxuICAgICAgICBjb21wdXRlUHJveGllcygpO1xyXG4gICAgICAgIGNvbXB1dGVDbGlja2FibGUoKTtcclxuXHJcbiAgICAgICAgaWYgKCRlbGVtZW50Lmhhc0NsYXNzKCdtZC1wcm94eS1mb2N1cycpICYmIHByb3hpZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocHJveGllcywgZnVuY3Rpb24ocHJveHkpIHtcclxuICAgICAgICAgICAgcHJveHkgPSBhbmd1bGFyLmVsZW1lbnQocHJveHkpO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHByb3h5Lm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAkc2NvcGUubW91c2VBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCRzY29wZS5tb3VzZUFjdGl2ZSA9PT0gZmFsc2UpIHsgJGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfVxyXG4gICAgICAgICAgICAgIHByb3h5Lm9uKCdibHVyJywgZnVuY3Rpb24gcHJveHlPbkJsdXIoKSB7XHJcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5yZW1vdmVDbGFzcygnbWQtZm9jdXNlZCcpO1xyXG4gICAgICAgICAgICAgICAgcHJveHkub2ZmKCdibHVyJywgcHJveHlPbkJsdXIpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY29tcHV0ZVByb3hpZXMoKSB7XHJcbiAgICAgICAgICB2YXIgY2hpbGRyZW4gPSAkZWxlbWVudC5jaGlsZHJlbigpO1xyXG4gICAgICAgICAgaWYgKGNoaWxkcmVuLmxlbmd0aCAmJiAhY2hpbGRyZW5bMF0uaGFzQXR0cmlidXRlKCduZy1jbGljaycpKSB7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChwcm94aWVkVHlwZXMsIGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZmlyc3RDaGlsZC5xdWVyeVNlbGVjdG9yQWxsKHR5cGUpLCBmdW5jdGlvbihjaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgcHJveGllcy5wdXNoKGNoaWxkKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGNvbXB1dGVDbGlja2FibGUoKSB7XHJcbiAgICAgICAgICBpZiAocHJveGllcy5sZW5ndGggfHwgaGFzQ2xpY2spIHtcclxuICAgICAgICAgICAgJGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWNsaWNrYWJsZScpO1xyXG5cclxuICAgICAgICAgICAgY3RybC5hdHRhY2hSaXBwbGUoJHNjb3BlLCBhbmd1bGFyLmVsZW1lbnQoJGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLW5vLXN0eWxlJykpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghaGFzQ2xpY2sgJiYgIXByb3hpZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICBmaXJzdENoaWxkICYmIGZpcnN0Q2hpbGQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldC5ub2RlTmFtZSAhPSAnSU5QVVQnICYmIGUudGFyZ2V0Lm5vZGVOYW1lICE9ICdURVhUQVJFQScpIHtcclxuICAgICAgICAgICAgICB2YXIga2V5Q29kZSA9IGUud2hpY2ggfHwgZS5rZXlDb2RlO1xyXG4gICAgICAgICAgICAgIGlmIChrZXlDb2RlID09ICRtZENvbnN0YW50LktFWV9DT0RFLlNQQUNFKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgICBmaXJzdENoaWxkLmNsaWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGVsZW1lbnQub2ZmKCdjbGljaycpO1xyXG4gICAgICAgICRlbGVtZW50Lm9mZigna2V5cHJlc3MnKTtcclxuXHJcbiAgICAgICAgaWYgKHByb3hpZXMubGVuZ3RoICYmIGZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICRlbGVtZW50LmNoaWxkcmVuKCkuZXEoMCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZiAoZmlyc3RDaGlsZC5jb250YWlucyhlLnRhcmdldCkpIHtcclxuICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocHJveGllcywgZnVuY3Rpb24ocHJveHkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldCAhPT0gcHJveHkgJiYgIXByb3h5LmNvbnRhaW5zKGUudGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQocHJveHkpLnRyaWdnZXJIYW5kbGVyKCdjbGljaycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG59XHJcbm1kTGlzdEl0ZW1EaXJlY3RpdmUuJGluamVjdCA9IFtcIiRtZEFyaWFcIiwgXCIkbWRDb25zdGFudFwiLCBcIiR0aW1lb3V0XCJdO1xyXG5cclxuLypcclxuICogQHByaXZhdGVcclxuICogQG5nZG9jIGNvbnRyb2xsZXJcclxuICogQG5hbWUgTWRMaXN0Q29udHJvbGxlclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMubGlzdFxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gTWRMaXN0Q29udHJvbGxlcigkc2NvcGUsICRlbGVtZW50LCAkbWRMaXN0SW5rUmlwcGxlKSB7XHJcbiAgdmFyIGN0cmwgPSB0aGlzO1xyXG4gIGN0cmwuYXR0YWNoUmlwcGxlID0gYXR0YWNoUmlwcGxlO1xyXG5cclxuICBmdW5jdGlvbiBhdHRhY2hSaXBwbGUgKHNjb3BlLCBlbGVtZW50KSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9IHt9O1xyXG4gICAgJG1kTGlzdElua1JpcHBsZS5hdHRhY2goc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpO1xyXG4gIH1cclxufVxyXG5NZExpc3RDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkZWxlbWVudFwiLCBcIiRtZExpc3RJbmtSaXBwbGVcIl07XHJcblxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5tZW51XHJcbiAqL1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMubWVudScsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnXHJcbl0pXHJcbi5kaXJlY3RpdmUoJ21kTWVudScsIE1lbnVEaXJlY3RpdmUpXHJcbi5jb250cm9sbGVyKCdtZE1lbnVDdHJsJywgTWVudUNvbnRyb2xsZXIpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRNZW51XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5tZW51XHJcbiAqIEByZXN0cmljdCBFXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKlxyXG4gKiBNZW51cyBhcmUgZWxlbWVudHMgdGhhdCBvcGVuIHdoZW4gY2xpY2tlZC4gVGhleSBhcmUgdXNlZnVsIGZvciBkaXNwbGF5aW5nXHJcbiAqIGFkZGl0aW9uYWwgb3B0aW9ucyB3aXRoaW4gdGhlIGNvbnRleHQgb2YgYW4gYWN0aW9uLlxyXG4gKlxyXG4gKiBFdmVyeSBgbWQtbWVudWAgbXVzdCBzcGVjaWZ5IGV4YWN0bHkgdHdvIGNoaWxkIGVsZW1lbnRzLiBUaGUgZmlyc3QgZWxlbWVudCBpcyB3aGF0IGlzXHJcbiAqIGxlZnQgaW4gdGhlIERPTSBhbmQgaXMgdXNlZCB0byBvcGVuIHRoZSBtZW51LiBUaGlzIGVsZW1lbnQgaXMgY2FsbGVkIHRoZSB0cmlnZ2VyIGVsZW1lbnQuXHJcbiAqIFRoZSB0cmlnZ2VyIGVsZW1lbnQncyBzY29wZSBoYXMgYWNjZXNzIHRvIGAkbWRPcGVuTWVudSgkZXZlbnQpYFxyXG4gKiB3aGljaCBpdCBtYXkgY2FsbCB0byBvcGVuIHRoZSBtZW51LiBCeSBwYXNzaW5nICRldmVudCBhcyBhcmd1bWVudCwgdGhlXHJcbiAqIGNvcnJlc3BvbmRpbmcgZXZlbnQgaXMgc3RvcHBlZCBmcm9tIHByb3BhZ2F0aW5nIHVwIHRoZSBET00tdHJlZS5cclxuICpcclxuICogVGhlIHNlY29uZCBlbGVtZW50IGlzIHRoZSBgbWQtbWVudS1jb250ZW50YCBlbGVtZW50IHdoaWNoIHJlcHJlc2VudHMgdGhlXHJcbiAqIGNvbnRlbnRzIG9mIHRoZSBtZW51IHdoZW4gaXQgaXMgb3Blbi4gVHlwaWNhbGx5IHRoaXMgd2lsbCBjb250YWluIGBtZC1tZW51LWl0ZW1gcyxcclxuICogYnV0IHlvdSBjYW4gZG8gY3VzdG9tIGNvbnRlbnQgYXMgd2VsbC5cclxuICpcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLW1lbnU+XHJcbiAqICA8IS0tIFRyaWdnZXIgZWxlbWVudCBpcyBhIG1kLWJ1dHRvbiB3aXRoIGFuIGljb24gLS0+XHJcbiAqICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwiJG1kT3Blbk1lbnUoJGV2ZW50KVwiIGNsYXNzPVwibWQtaWNvbi1idXR0b25cIiBhcmlhLWxhYmVsPVwiT3BlbiBzYW1wbGUgbWVudVwiPlxyXG4gKiAgICA8bWQtaWNvbiBtZC1zdmctaWNvbj1cImNhbGw6cGhvbmVcIj48L21kLWljb24+XHJcbiAqICA8L21kLWJ1dHRvbj5cclxuICogIDxtZC1tZW51LWNvbnRlbnQ+XHJcbiAqICAgIDxtZC1tZW51LWl0ZW0+PG1kLWJ1dHRvbiBuZy1jbGljaz1cImRvU29tZXRoaW5nKClcIj5EbyBTb21ldGhpbmc8L21kLWJ1dHRvbj48L21kLW1lbnUtaXRlbT5cclxuICogIDwvbWQtbWVudS1jb250ZW50PlxyXG4gKiA8L21kLW1lbnU+XHJcbiAqIDwvaGxqcz5cclxuXHJcbiAqICMjIFNpemluZyBNZW51c1xyXG4gKlxyXG4gKiBUaGUgd2lkdGggb2YgdGhlIG1lbnUgd2hlbiBpdCBpcyBvcGVuIG1heSBiZSBzcGVjaWZpZWQgYnkgc3BlY2lmeWluZyBhIGB3aWR0aGBcclxuICogYXR0cmlidXRlIG9uIHRoZSBgbWQtbWVudS1jb250ZW50YCBlbGVtZW50LlxyXG4gKiBTZWUgdGhlIFtNYXRlcmlhbCBEZXNpZ24gU3BlY10oaHR0cDovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9zcGVjL2NvbXBvbmVudHMvbWVudXMuaHRtbCNtZW51cy1zcGVjcylcclxuICogZm9yIG1vcmUgaW5mb3JtYXRpb24uXHJcbiAqXHJcbiAqXHJcbiAqICMjIEFsaWduaW5nIE1lbnVzXHJcbiAqXHJcbiAqIFdoZW4gYSBtZW51IG9wZW5zLCBpdCBpcyBpbXBvcnRhbnQgdGhhdCB0aGUgY29udGVudCBhbGlnbnMgd2l0aCB0aGUgdHJpZ2dlciBlbGVtZW50LlxyXG4gKiBGYWlsdXJlIHRvIGFsaWduIG1lbnVzIGNhbiByZXN1bHQgaW4gamFycmluZyBleHBlcmllbmNlcyBmb3IgdXNlcnMgYXMgY29udGVudFxyXG4gKiBzdWRkZW5seSBzaGlmdHMuIFRvIGhlbHAgd2l0aCB0aGlzLCBgbWQtbWVudWAgcHJvdmlkZXMgc2VydmVyYWwgQVBJcyB0byBoZWxwXHJcbiAqIHdpdGggYWxpZ25tZW50LlxyXG4gKlxyXG4gKiAjIyMgVGFyZ2V0IE1vZGVcclxuICpcclxuICogQnkgZGVmYXVsdCwgYG1kLW1lbnVgIHdpbGwgYXR0ZW1wdCB0byBhbGlnbiB0aGUgYG1kLW1lbnUtY29udGVudGAgYnkgYWxpZ25pbmdcclxuICogZGVzaWduYXRlZCBjaGlsZCBlbGVtZW50cyBpbiBib3RoIHRoZSB0cmlnZ2VyIGFuZCB0aGUgbWVudSBjb250ZW50LlxyXG4gKlxyXG4gKiBUbyBzcGVjaWZ5IHRoZSBhbGlnbm1lbnQgZWxlbWVudCBpbiB0aGUgYHRyaWdnZXJgIHlvdSBjYW4gdXNlIHRoZSBgbWQtbWVudS1vcmlnaW5gXHJcbiAqIGF0dHJpYnV0ZSBvbiBhIGNoaWxkIGVsZW1lbnQuIElmIG5vIGBtZC1tZW51LW9yaWdpbmAgaXMgc3BlY2lmaWVkLCB0aGUgYG1kLW1lbnVgXHJcbiAqIHdpbGwgYmUgdXNlZCBhcyB0aGUgb3JpZ2luIGVsZW1lbnQuXHJcbiAqXHJcbiAqIFNpbWlsYXJseSwgdGhlIGBtZC1tZW51LWNvbnRlbnRgIG1heSBzcGVjaWZ5IGEgYG1kLW1lbnUtYWxpZ24tdGFyZ2V0YCBmb3IgYVxyXG4gKiBgbWQtbWVudS1pdGVtYCB0byBzcGVjaWZ5IHRoZSBub2RlIHRoYXQgaXQgc2hvdWxkIHRyeSBhbmQgYWxpZ24gd2l0aC5cclxuICpcclxuICogSW4gdGhpcyBleGFtcGxlIGNvZGUsIHdlIHNwZWNpZnkgYW4gaWNvbiB0byBiZSBvdXIgb3JpZ2luIGVsZW1lbnQsIGFuZCBhblxyXG4gKiBpY29uIGluIG91ciBtZW51IGNvbnRlbnQgdG8gYmUgb3VyIGFsaWdubWVudCB0YXJnZXQuIFRoaXMgZW5zdXJlcyB0aGF0IGJvdGhcclxuICogaWNvbnMgYXJlIGFsaWduZWQgd2hlbiB0aGUgbWVudSBvcGVucy5cclxuICpcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLW1lbnU+XHJcbiAqICA8bWQtYnV0dG9uIG5nLWNsaWNrPVwiJG1kT3Blbk1lbnUoJGV2ZW50KVwiIGNsYXNzPVwibWQtaWNvbi1idXR0b25cIiBhcmlhLWxhYmVsPVwiT3BlbiBzb21lIG1lbnVcIj5cclxuICogICAgPG1kLWljb24gbWQtbWVudS1vcmlnaW4gbWQtc3ZnLWljb249XCJjYWxsOnBob25lXCI+PC9tZC1pY29uPlxyXG4gKiAgPC9tZC1idXR0b24+XHJcbiAqICA8bWQtbWVudS1jb250ZW50PlxyXG4gKiAgICA8bWQtbWVudS1pdGVtPlxyXG4gKiAgICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJkb1NvbWV0aGluZygpXCIgYXJpYS1sYWJlbD1cIkRvIHNvbWV0aGluZ1wiPlxyXG4gKiAgICAgICAgPG1kLWljb24gbWQtbWVudS1hbGlnbi10YXJnZXQgbWQtc3ZnLWljb249XCJjYWxsOnBob25lXCI+PC9tZC1pY29uPlxyXG4gKiAgICAgICAgRG8gU29tZXRoaW5nXHJcbiAqICAgICAgPC9tZC1idXR0b24+XHJcbiAqICAgIDwvbWQtbWVudS1pdGVtPlxyXG4gKiAgPC9tZC1tZW51LWNvbnRlbnQ+XHJcbiAqIDwvbWQtbWVudT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBTb21ldGltZXMgd2Ugd2FudCB0byBzcGVjaWZ5IGFsaWdubWVudCBvbiB0aGUgcmlnaHQgc2lkZSBvZiBhbiBlbGVtZW50LCBmb3IgZXhhbXBsZVxyXG4gKiBpZiB3ZSBoYXZlIGEgbWVudSBvbiB0aGUgcmlnaHQgc2lkZSBhIHRvb2xiYXIsIHdlIHdhbnQgdG8gcmlnaHQgYWxpZ24gb3VyIG1lbnUgY29udGVudC5cclxuICpcclxuICogV2UgY2FuIHNwZWNpZnkgdGhlIG9yaWdpbiBieSB1c2luZyB0aGUgYG1kLXBvc2l0aW9uLW1vZGVgIGF0dHJpYnV0ZSBvbiBib3RoXHJcbiAqIHRoZSBgeGAgYW5kIGB5YCBheGlzLiBSaWdodCBub3cgb25seSB0aGUgYHgtYXhpc2AgaGFzIG1vcmUgdGhhbiBvbmUgb3B0aW9uLlxyXG4gKiBZb3UgbWF5IHNwZWNpZnkgdGhlIGRlZmF1bHQgbW9kZSBvZiBgdGFyZ2V0IHRhcmdldGAgb3JcclxuICogYHRhcmdldC1yaWdodCB0YXJnZXRgIHRvIHNwZWNpZnkgYSByaWdodC1vcmllbnRlZCBhbGlnbm1lbnQgdGFyZ2V0LiBTZWUgdGhlXHJcbiAqIHBvc2l0aW9uIHNlY3Rpb24gb2YgdGhlIGRlbW9zIGZvciBtb3JlIGV4YW1wbGVzLlxyXG4gKlxyXG4gKiAjIyMgTWVudSBPZmZzZXRzXHJcbiAqXHJcbiAqIEl0IGlzIHNvbWV0aW1lcyB1bmF2b2lkYWJsZSB0byBuZWVkIHRvIGhhdmUgYSBkZWVwZXIgbGV2ZWwgb2YgY29udHJvbCBmb3JcclxuICogdGhlIHBvc2l0aW9uaW5nIG9mIGEgbWVudSB0byBlbnN1cmUgcGVyZmVjdCBhbGlnbm1lbnQuIGBtZC1tZW51YCBwcm92aWRlc1xyXG4gKiB0aGUgYG1kLW9mZnNldGAgYXR0cmlidXRlIHRvIGFsbG93IHBpeGVsIGxldmVsIHNwZWNpZmljdHkgb2YgYWRqdXN0aW5nIHRoZVxyXG4gKiBleGFjdCBwb3NpdGlvbmluZy5cclxuICpcclxuICogVGhpcyBvZmZzZXQgaXMgcHJvdmlkZWQgaW4gdGhlIGZvcm1hdCBvZiBgeCB5YCBvciBgbmAgd2hlcmUgYG5gIHdpbGwgYmUgdXNlZFxyXG4gKiBpbiBib3RoIHRoZSBgeGAgYW5kIGB5YCBheGlzLlxyXG4gKlxyXG4gKiBGb3IgZXhhbXBsZSwgdG8gbW92ZSBhIG1lbnUgYnkgYDJweGAgZnJvbSB0aGUgdG9wLCB3ZSBjYW4gdXNlOlxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtbWVudSBtZC1vZmZzZXQ9XCIyIDBcIj5cclxuICogICA8IS0tIG1lbnUtY29udGVudCAtLT5cclxuICogPC9tZC1tZW51PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtbWVudT5cclxuICogIDxtZC1idXR0b24gbmctY2xpY2s9XCIkbWRPcGVuTWVudSgkZXZlbnQpXCIgY2xhc3M9XCJtZC1pY29uLWJ1dHRvblwiPlxyXG4gKiAgICA8bWQtaWNvbiBtZC1zdmctaWNvbj1cImNhbGw6cGhvbmVcIj48L21kLWljb24+XHJcbiAqICA8L21kLWJ1dHRvbj5cclxuICogIDxtZC1tZW51LWNvbnRlbnQ+XHJcbiAqICAgIDxtZC1tZW51LWl0ZW0+PG1kLWJ1dHRvbiBuZy1jbGljaz1cImRvU29tZXRoaW5nKClcIj5EbyBTb21ldGhpbmc8L21kLWJ1dHRvbj48L21kLW1lbnUtaXRlbT5cclxuICogIDwvbWQtbWVudS1jb250ZW50PlxyXG4gKiA8L21kLW1lbnU+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IG1kLXBvc2l0aW9uLW1vZGUgVGhlIHBvc2l0aW9uIG1vZGUgaW4gdGhlIGZvcm0gb2ZcclxuICAgICAgICAgICAgIGB4YCwgYHlgLiBEZWZhdWx0IHZhbHVlIGlzIGB0YXJnZXRgLGB0YXJnZXRgLiBSaWdodCBub3cgdGhlIGB4YCBheGlzXHJcbiAgICAgICAgICAgICBhbHNvIHN1cHBwb3J0cyBgdGFyZ2V0LXJpZ2h0YC5cclxuICogQHBhcmFtIHtzdHJpbmd9IG1kLW9mZnNldCBBbiBvZmZzZXQgdG8gYXBwbHkgdG8gdGhlIGRyb3Bkb3duIGFmdGVyIHBvc2l0aW9uaW5nXHJcbiAgICAgICAgICAgICBgeGAsIGB5YC4gRGVmYXVsdCB2YWx1ZSBpcyBgMGAsYDBgLlxyXG4gKlxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIE1lbnVEaXJlY3RpdmUoJG1kTWVudSkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcmVxdWlyZTogJ21kTWVudScsXHJcbiAgICBjb250cm9sbGVyOiAnbWRNZW51Q3RybCcsIC8vIGVtcHR5IGZ1bmN0aW9uIHRvIGJlIGJ1aWx0IGJ5IGxpbmtcclxuICAgIHNjb3BlOiB0cnVlLFxyXG4gICAgY29tcGlsZTogY29tcGlsZVxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGUodGVtcGxhdGVFbGVtZW50KSB7XHJcbiAgICB0ZW1wbGF0ZUVsZW1lbnQuYWRkQ2xhc3MoJ21kLW1lbnUnKTtcclxuICAgIHZhciB0cmlnZ2VyRWxlbWVudCA9IHRlbXBsYXRlRWxlbWVudC5jaGlsZHJlbigpWzBdO1xyXG4gICAgaWYgKCF0cmlnZ2VyRWxlbWVudC5oYXNBdHRyaWJ1dGUoJ25nLWNsaWNrJykpIHtcclxuICAgICAgdHJpZ2dlckVsZW1lbnQgPSB0cmlnZ2VyRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdbbmctY2xpY2tdJyk7XHJcbiAgICB9XHJcbiAgICB0cmlnZ2VyRWxlbWVudCAmJiB0cmlnZ2VyRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGFzcG9wdXAnLCAndHJ1ZScpO1xyXG4gICAgaWYgKHRlbXBsYXRlRWxlbWVudC5jaGlsZHJlbigpLmxlbmd0aCAhPSAyKSB7XHJcbiAgICAgIHRocm93IEVycm9yKCdJbnZhbGlkIEhUTUwgZm9yIG1kLW1lbnUuIEV4cGVjdGVkIHR3byBjaGlsZHJlbiBlbGVtZW50cy4nKTtcclxuICAgIH1cclxuICAgIHJldHVybiBsaW5rO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIG1kTWVudUN0cmwpIHtcclxuXHJcbiAgICAvLyBNb3ZlIGV2ZXJ5dGhpbmcgaW50byBhIG1kLW1lbnUtY29udGFpbmVyIGFuZCBwYXNzIGl0IHRvIHRoZSBjb250cm9sbGVyXHJcbiAgICB2YXIgbWVudUNvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChcclxuICAgICAgJzxkaXYgY2xhc3M9XCJtZC1vcGVuLW1lbnUtY29udGFpbmVyIG1kLXdoaXRlZnJhbWUtejJcIj48L2Rpdj4nXHJcbiAgICApO1xyXG4gICAgdmFyIG1lbnVDb250ZW50cyA9IGVsZW1lbnQuY2hpbGRyZW4oKVsxXTtcclxuICAgIG1lbnVDb250YWluZXIuYXBwZW5kKG1lbnVDb250ZW50cyk7XHJcbiAgICBtZE1lbnVDdHJsLmluaXQobWVudUNvbnRhaW5lcik7XHJcblxyXG4gICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAobWRNZW51Q3RybC5pc09wZW4pIHtcclxuICAgICAgICBtZW51Q29udGFpbmVyLnJlbW92ZSgpO1xyXG4gICAgICAgIG1kTWVudUN0cmwuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxufVxyXG5NZW51RGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRNZW51XCJdO1xyXG5cclxuZnVuY3Rpb24gTWVudUNvbnRyb2xsZXIoJG1kTWVudSwgJGF0dHJzLCAkZWxlbWVudCwgJHNjb3BlKSB7XHJcblxyXG4gIHZhciBtZW51Q29udGFpbmVyO1xyXG4gIHZhciBjdHJsID0gdGhpcztcclxuICB2YXIgdHJpZ2dlckVsZW1lbnQ7XHJcblxyXG4gIC8vIENhbGxlZCBieSBvdXIgbGlua2luZyBmbiB0byBwcm92aWRlIGFjY2VzcyB0byB0aGUgbWVudS1jb250ZW50XHJcbiAgLy8gZWxlbWVudCByZW1vdmVkIGR1cmluZyBsaW5rXHJcbiAgdGhpcy5pbml0ID0gZnVuY3Rpb24oc2V0TWVudUNvbnRhaW5lcikge1xyXG4gICAgbWVudUNvbnRhaW5lciA9IHNldE1lbnVDb250YWluZXI7XHJcbiAgICB0cmlnZ2VyRWxlbWVudCA9ICRlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ1tuZy1jbGlja10nKTtcclxuICB9O1xyXG5cclxuICAvLyBVc2VzIHRoZSAkbWRNZW51IGludGVyaW0gZWxlbWVudCBzZXJ2aWNlIHRvIG9wZW4gdGhlIG1lbnUgY29udGVudHNcclxuICB0aGlzLm9wZW4gPSBmdW5jdGlvbiBvcGVuTWVudShldikge1xyXG4gICAgZXYgJiYgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgY3RybC5pc09wZW4gPSB0cnVlO1xyXG4gICAgdHJpZ2dlckVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcclxuICAgICRtZE1lbnUuc2hvdyh7XHJcbiAgICAgIG1kTWVudUN0cmw6IGN0cmwsXHJcbiAgICAgIGVsZW1lbnQ6IG1lbnVDb250YWluZXIsXHJcbiAgICAgIHRhcmdldDogJGVsZW1lbnRbMF1cclxuICAgIH0pO1xyXG4gIH07XHJcbiAgLy8gRXhwb3NlIGEgb3BlbiBmdW5jdGlvbiB0byB0aGUgY2hpbGQgc2NvcGUgZm9yIGh0bWwgdG8gdXNlXHJcbiAgJHNjb3BlLiRtZE9wZW5NZW51ID0gdGhpcy5vcGVuO1xyXG5cclxuICAvLyBVc2UgdGhlICRtZE1lbnUgaW50ZXJpbSBlbGVtZW50IHNlcnZpY2UgdG8gY2xvc2UgdGhlIG1lbnUgY29udGVudHNcclxuICB0aGlzLmNsb3NlID0gZnVuY3Rpb24gY2xvc2VNZW51KHNraXBGb2N1cykge1xyXG4gICAgY3RybC5pc09wZW4gPSBmYWxzZTtcclxuICAgIHRyaWdnZXJFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xyXG4gICAgJG1kTWVudS5oaWRlKCk7XHJcblxyXG4gICAgaWYgKCFza2lwRm9jdXMpIHtcclxuICAgICAgJGVsZW1lbnQuY2hpbGRyZW4oKVswXS5mb2N1cygpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIEJ1aWxkIGEgbmljZSBvYmplY3Qgb3V0IG9mIG91ciBzdHJpbmcgYXR0cmlidXRlIHdoaWNoIHNwZWNpZmllcyB0aGVcclxuICAvLyB0YXJnZXQgbW9kZSBmb3IgbGVmdCBhbmQgdG9wIHBvc2l0aW9uaW5nXHJcbiAgdGhpcy5wb3NpdGlvbk1vZGUgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBhdHRhY2htZW50ID0gKCRhdHRycy5tZFBvc2l0aW9uTW9kZSB8fCAndGFyZ2V0Jykuc3BsaXQoJyAnKTtcclxuXHJcbiAgICAvLyBJZiBhdHRhY2htZW50IGlzIGEgc2luZ2xlIGl0ZW0sIGR1cGxpY2F0ZSBpdCBmb3Igb3VyIHNlY29uZCB2YWx1ZS5cclxuICAgIC8vIGllLiAndGFyZ2V0JyAtPiAndGFyZ2V0IHRhcmdldCdcclxuICAgIGlmIChhdHRhY2htZW50Lmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgIGF0dGFjaG1lbnQucHVzaChhdHRhY2htZW50WzBdKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsZWZ0OiBhdHRhY2htZW50WzBdLFxyXG4gICAgICB0b3A6IGF0dGFjaG1lbnRbMV1cclxuICAgIH07XHJcbiAgfTtcclxuXHJcbiAgLy8gQnVpbGQgYSBuaWNlIG9iamVjdCBvdXQgb2Ygb3VyIHN0cmluZyBhdHRyaWJ1dGUgd2hpY2ggc3BlY2lmaWVzXHJcbiAgLy8gdGhlIG9mZnNldCBvZiB0b3AgYW5kIGxlZnQgaW4gcGl4ZWxzLlxyXG4gIHRoaXMub2Zmc2V0cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG9mZnNldHMgPSAoJGF0dHJzLm1kT2Zmc2V0IHx8ICcwIDAnKS5zcGxpdCgnICcpLm1hcChwYXJzZUZsb2F0KTtcclxuICAgIGlmIChvZmZzZXRzLmxlbmd0aCA9PSAyKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbGVmdDogb2Zmc2V0c1swXSxcclxuICAgICAgICB0b3A6IG9mZnNldHNbMV1cclxuICAgICAgfTtcclxuICAgIH0gZWxzZSBpZiAob2Zmc2V0cy5sZW5ndGggPT0gMSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHRvcDogb2Zmc2V0c1swXSxcclxuICAgICAgICBsZWZ0OiBvZmZzZXRzWzBdXHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aHJvdyBFcnJvcignSW52YWxpZCBvZmZzZXRzIHNwZWNpZmllZC4gUGxlYXNlIGZvbGxvdyBmb3JtYXQgPHgsIHk+IG9yIDxuPicpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuTWVudUNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRtZE1lbnVcIiwgXCIkYXR0cnNcIiwgXCIkZWxlbWVudFwiLCBcIiRzY29wZVwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLm1lbnUnKVxyXG4ucHJvdmlkZXIoJyRtZE1lbnUnLCBNZW51UHJvdmlkZXIpO1xyXG5cclxuLypcclxuICogSW50ZXJpbSBlbGVtZW50IHByb3ZpZGVyIGZvciB0aGUgbWVudS5cclxuICogSGFuZGxlcyBiZWhhdmlvciBmb3IgYSBtZW51IHdoaWxlIGl0IGlzIG9wZW4sIGluY2x1ZGluZzpcclxuICogICAgLSBoYW5kbGluZyBhbmltYXRpbmcgdGhlIG1lbnUgb3BlbmluZy9jbG9zaW5nXHJcbiAqICAgIC0gaGFuZGxpbmcga2V5L21vdXNlIGV2ZW50cyBvbiB0aGUgbWVudSBlbGVtZW50XHJcbiAqICAgIC0gaGFuZGxpbmcgZW5hYmxpbmcvZGlzYWJsaW5nIHNjcm9sbCB3aGlsZSB0aGUgbWVudSBpcyBvcGVuXHJcbiAqICAgIC0gaGFuZGxpbmcgcmVkcmF3aW5nIGR1cmluZyByZXNpemVzIGFuZCBvcmllbnRhdGlvbiBjaGFuZ2VzXHJcbiAqXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gTWVudVByb3ZpZGVyKCQkaW50ZXJpbUVsZW1lbnRQcm92aWRlcikge1xyXG4gIHZhciBNRU5VX0VER0VfTUFSR0lOID0gODtcclxuXHJcbiAgbWVudURlZmF1bHRPcHRpb25zLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiR3aW5kb3dcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiR0aW1lb3V0XCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkZG9jdW1lbnRcIl07XHJcbiAgcmV0dXJuICQkaW50ZXJpbUVsZW1lbnRQcm92aWRlcignJG1kTWVudScpXHJcbiAgICAuc2V0RGVmYXVsdHMoe1xyXG4gICAgICBtZXRob2RzOiBbJ3RhcmdldCddLFxyXG4gICAgICBvcHRpb25zOiBtZW51RGVmYXVsdE9wdGlvbnNcclxuICAgIH0pO1xyXG5cclxuICAvKiBAbmdJbmplY3QgKi9cclxuICBmdW5jdGlvbiBtZW51RGVmYXVsdE9wdGlvbnMoJCRyQUYsICR3aW5kb3csICRtZFV0aWwsICRtZFRoZW1pbmcsICR0aW1lb3V0LCAkbWRDb25zdGFudCwgJGRvY3VtZW50KSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwYXJlbnQ6ICdib2R5JyxcclxuICAgICAgb25TaG93OiBvblNob3csXHJcbiAgICAgIG9uUmVtb3ZlOiBvblJlbW92ZSxcclxuICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXHJcbiAgICAgIGRpc2FibGVQYXJlbnRTY3JvbGw6IHRydWUsXHJcbiAgICAgIHNraXBDb21waWxlOiB0cnVlLFxyXG4gICAgICB0aGVtYWJsZTogdHJ1ZVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEJvaWxlcnBsYXRlIGludGVyaW1FbGVtZW50IG9uU2hvdyBmdW5jdGlvblxyXG4gICAgICogSGFuZGxlcyBpbnNlcnRpbmcgdGhlIG1lbnUgaW50byB0aGUgRE9NLCBwb3NpdGlvbmluZyBpdCwgYW5kIHdpcmluZyB1cFxyXG4gICAgICogdmFyaW91cyBpbnRlcmFjdGlvbiBldmVudHNcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gb25TaG93KHNjb3BlLCBlbGVtZW50LCBvcHRzKSB7XHJcblxyXG4gICAgICAvLyBTYW5pdGl6ZSBhbmQgc2V0IGRlZmF1bHRzIG9uIG9wdHNcclxuICAgICAgYnVpbGRPcHRzKG9wdHMpO1xyXG5cclxuICAgICAgLy8gV2lyZSB1cCB0aGVtaW5nIG9uIG91ciBtZW51IGVsZW1lbnRcclxuICAgICAgJG1kVGhlbWluZy5pbmhlcml0KG9wdHMubWVudUNvbnRlbnRFbCwgb3B0cy50YXJnZXQpO1xyXG5cclxuICAgICAgLy8gUmVnaXN0ZXIgdmFyaW91cyBsaXN0ZW5lcnMgdG8gbW92ZSBtZW51IG9uIHJlc2l6ZS9vcmllbnRhdGlvbiBjaGFuZ2VcclxuICAgICAgaGFuZGxlUmVzaXppbmcoKTtcclxuXHJcbiAgICAgIC8vIERpc2FibGUgc2Nyb2xsaW5nXHJcbiAgICAgIGlmIChvcHRzLmRpc2FibGVQYXJlbnRTY3JvbGwpIHtcclxuICAgICAgICBvcHRzLnJlc3RvcmVTY3JvbGwgPSAkbWRVdGlsLmRpc2FibGVTY3JvbGxBcm91bmQob3B0cy5lbGVtZW50KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gT25seSBhY3RpdmF0ZSBjbGljayBsaXN0ZW5lcnMgYWZ0ZXIgYSBzaG9ydCB0aW1lIHRvIHN0b3AgYWNjaWRlbnRhbCBkb3VibGUgdGFwcy9jbGlja3NcclxuICAgICAgLy8gZnJvbSBjbGlja2luZyB0aGUgd3JvbmcgaXRlbVxyXG4gICAgICAkdGltZW91dChhY3RpdmF0ZUludGVyYWN0aW9uLCA3NSwgZmFsc2UpO1xyXG5cclxuICAgICAgaWYgKG9wdHMuYmFja2Ryb3ApIHtcclxuICAgICAgICAkbWRUaGVtaW5nLmluaGVyaXQob3B0cy5iYWNrZHJvcCwgb3B0cy5wYXJlbnQpO1xyXG4gICAgICAgIG9wdHMucGFyZW50LmFwcGVuZChvcHRzLmJhY2tkcm9wKTtcclxuICAgICAgfVxyXG4gICAgICBzaG93TWVudSgpO1xyXG5cclxuICAgICAgLy8gUmV0dXJuIHRoZSBwcm9taXNlIGZvciB3aGVuIG91ciBtZW51IGlzIGRvbmUgYW5pbWF0aW5nIGluXHJcbiAgICAgIHJldHVybiAkbWRVdGlsLnRyYW5zaXRpb25FbmRQcm9taXNlKGVsZW1lbnQsIHt0aW1lb3V0OiAzNTB9KTtcclxuXHJcbiAgICAgIC8qKiBDaGVjayBmb3IgdmFsaWQgb3B0cyBhbmQgc2V0IHNvbWUgc2FuZSBkZWZhdWx0cyAqL1xyXG4gICAgICBmdW5jdGlvbiBidWlsZE9wdHMoKSB7XHJcbiAgICAgICAgaWYgKCFvcHRzLnRhcmdldCkge1xyXG4gICAgICAgICAgdGhyb3cgRXJyb3IoXHJcbiAgICAgICAgICAgICckbWRNZW51LnNob3coKSBleHBlY3RlZCBhIHRhcmdldCB0byBhbmltYXRlIGZyb20gaW4gb3B0aW9ucy50YXJnZXQnXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhbmd1bGFyLmV4dGVuZChvcHRzLCB7XHJcbiAgICAgICAgICBhbHJlYWR5T3BlbjogZmFsc2UsXHJcbiAgICAgICAgICBpc1JlbW92ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgdGFyZ2V0OiBhbmd1bGFyLmVsZW1lbnQob3B0cy50YXJnZXQpLCAvL21ha2Ugc3VyZSBpdCdzIG5vdCBhIG5ha2VkIGRvbSBub2RlXHJcbiAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChvcHRzLnBhcmVudCksXHJcbiAgICAgICAgICBtZW51Q29udGVudEVsOiBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCdtZC1tZW51LWNvbnRlbnQnKSksXHJcbiAgICAgICAgICBiYWNrZHJvcDogb3B0cy5oYXNCYWNrZHJvcCAmJiBhbmd1bGFyLmVsZW1lbnQoJzxtZC1iYWNrZHJvcCBjbGFzcz1cIm1kLW1lbnUtYmFja2Ryb3AgbWQtY2xpY2stY2F0Y2hlclwiPicpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qKiBXaXJldXAgdmFyaW91cyByZXNpemUgbGlzdGVuZXJzIGZvciBzY3JlZW4gY2hhbmdlcyAqL1xyXG4gICAgICBmdW5jdGlvbiBoYW5kbGVSZXNpemluZygpIHtcclxuICAgICAgICBvcHRzLnJlc2l6ZUZuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBwb3NpdGlvbk1lbnUoZWxlbWVudCwgb3B0cyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ3Jlc2l6ZScsIG9wdHMucmVzaXplRm4pO1xyXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbignb3JpZW50YXRpb25jaGFuZ2UnLCBvcHRzLnJlc2l6ZUZuKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIFBsYWNlIHRoZSBtZW51IGludG8gdGhlIERPTSBhbmQgY2FsbCBwb3NpdGlvbmluZyByZWxhdGVkIGZ1bmN0aW9uc1xyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gc2hvd01lbnUoKSB7XHJcbiAgICAgICAgb3B0cy5wYXJlbnQuYXBwZW5kKGVsZW1lbnQpO1xyXG5cclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1sZWF2ZScpO1xyXG4gICAgICAgIC8vIEtpY2sgb2ZmIG91ciBhbmltYXRpb24vcG9zaXRpb25pbmcgYnV0IGZpcnN0LCB3YWl0IGEgZmV3IGZyYW1lc1xyXG4gICAgICAgIC8vIHNvIGFsbCBvZiBvdXIgY29tcHV0ZWQgcG9zaXRpb25zL3NpemVzIGFyZSBhY2N1cmF0ZVxyXG4gICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uTWVudShlbGVtZW50LCBvcHRzKTtcclxuICAgICAgICAgICAgLy8gV2FpdCBhIGZyYW1lIGJlZm9yZSBmYWRpbmcgaW4gbWVudSAobWQtYWN0aXZlKSBzbyB0aGF0IHdlIGRvbid0IHRyaWdnZXJcclxuICAgICAgICAgICAgLy8gdHJhbnNpdGlvbnMgb24gdGhlIG1lbnUgcG9zaXRpb24gY2hhbmdpbmdcclxuICAgICAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgb3B0cy5hbHJlYWR5T3BlbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgZWxlbWVudFswXS5zdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNXSA9ICcnO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIEFjdGl2YXRlIGludGVyYWN0aW9uIG9uIHRoZSBtZW51LiBXaXJlIHVwIGtleWJvYXJkIGxpc3Rlcm5zIGZvclxyXG4gICAgICAgKiBjbGlja3MsIGtleXByZXNzZXMsIGJhY2tkcm9wIGNsb3NpbmcsIGV0Yy5cclxuICAgICAgICovXHJcbiAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlSW50ZXJhY3Rpb24oKSB7XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtY2xpY2thYmxlJyk7XHJcblxyXG4gICAgICAgIC8vIGNsb3NlIG9uIGJhY2tkcm9wIGNsaWNrXHJcbiAgICAgICAgb3B0cy5iYWNrZHJvcCAmJiBvcHRzLmJhY2tkcm9wLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBvcHRzLm1kTWVudUN0cmwuY2xvc2UodHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFdpcmUgdXAga2V5Ym9hcmQgbGlzdGVuZXJzLlxyXG4gICAgICAgIC8vIENsb3NlIG9uIGVzY2FwZSwgZm9jdXMgbmV4dCBpdGVtIG9uIGRvd24gYXJyb3csIGZvY3VzIHByZXYgaXRlbSBvbiB1cFxyXG4gICAgICAgIG9wdHMubWVudUNvbnRlbnRFbC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2KSB7XHJcbiAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZXYua2V5Q29kZSkge1xyXG4gICAgICAgICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFOiBvcHRzLm1kTWVudUN0cmwuY2xvc2UoKTsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5VUF9BUlJPVzogZm9jdXNNZW51SXRlbShldiwgb3B0cy5tZW51Q29udGVudEVsLCBvcHRzLCAtMSk7IGJyZWFrO1xyXG4gICAgICAgICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRE9XTl9BUlJPVzogZm9jdXNNZW51SXRlbShldiwgb3B0cy5tZW51Q29udGVudEVsLCBvcHRzLCAxKTsgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDbG9zZSBtZW51IG9uIG1lbnUgaXRlbSBjbGljaywgaWYgc2FpZCBtZW51LWl0ZW0gaXMgbm90IGRpc2FibGVkXHJcbiAgICAgICAgb3B0cy5tZW51Q29udGVudEVsLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgICAgICAgIC8vIFRyYXZlcnNlIHVwIHRoZSBldmVudCB1bnRpbCB3ZSBnZXQgdG8gdGhlIG1lbnVDb250ZW50RWwgdG8gc2VlIGlmXHJcbiAgICAgICAgICAvLyB0aGVyZSBpcyBhbiBuZy1jbGljayBhbmQgdGhhdCB0aGUgbmctY2xpY2sgaXMgbm90IGRpc2FibGVkXHJcbiAgICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnbmctY2xpY2snKSkge1xyXG4gICAgICAgICAgICAgIGlmICghdGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgY2xvc2UoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gd2hpbGUgKCh0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZSkgJiYgdGFyZ2V0ICE9IG9wdHMubWVudUNvbnRlbnRFbClcclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBjbG9zZSgpIHtcclxuICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIG9wdHMubWRNZW51Q3RybC5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8ga2ljayBvZmYgaW5pdGlhbCBmb2N1cyBpbiB0aGUgbWVudSBvbiB0aGUgZmlyc3QgZWxlbWVudFxyXG4gICAgICAgIHZhciBmb2N1c1RhcmdldCA9IG9wdHMubWVudUNvbnRlbnRFbFswXS5xdWVyeVNlbGVjdG9yKCdbbWQtbWVudS1mb2N1cy10YXJnZXRdJyk7XHJcbiAgICAgICAgaWYgKCFmb2N1c1RhcmdldCkgZm9jdXNUYXJnZXQgPSBvcHRzLm1lbnVDb250ZW50RWxbMF0uZmlyc3RFbGVtZW50Q2hpbGQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICAgICAgZm9jdXNUYXJnZXQuZm9jdXMoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICAqIFRha2VzIGEga2V5cHJlc3MgZXZlbnQgYW5kIGZvY3VzZXMgdGhlIG5leHQvcHJldmlvdXMgbWVudVxyXG4gICAgICAqIGl0ZW0gZnJvbSB0aGUgZW1pdHRpbmcgZWxlbWVudFxyXG4gICAgICAqIEBwYXJhbSB7ZXZlbnR9IGUgLSBUaGUgb3JpZ2luIGtleXByZXNzIGV2ZW50XHJcbiAgICAgICogQHBhcmFtIHthbmd1bGFyLmVsZW1lbnR9IG1lbnVFbCAtIFRoZSBtZW51IGVsZW1lbnRcclxuICAgICAgKiBAcGFyYW0ge29iamVjdH0gb3B0cyAtIFRoZSBpbnRlcmltIGVsZW1lbnQgb3B0aW9ucyBmb3IgdGhlIG1kTWVudVxyXG4gICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkaXJlY3Rpb24gLSBUaGUgZGlyZWN0aW9uIHRvIG1vdmUgaW4gKCsxID0gbmV4dCwgLTEgPSBwcmV2KVxyXG4gICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZm9jdXNNZW51SXRlbShlLCBtZW51RWwsIG9wdHMsIGRpcmVjdGlvbikge1xyXG4gICAgICB2YXIgY3VycmVudEl0ZW0gPSAkbWRVdGlsLmdldENsb3Nlc3QoZS50YXJnZXQsICdNRC1NRU5VLUlURU0nKTtcclxuXHJcbiAgICAgIHZhciBpdGVtcyA9ICRtZFV0aWwubm9kZXNUb0FycmF5KG1lbnVFbFswXS5jaGlsZHJlbik7XHJcbiAgICAgIHZhciBjdXJyZW50SW5kZXggPSBpdGVtcy5pbmRleE9mKGN1cnJlbnRJdGVtKTtcclxuXHJcbiAgICAgIC8vIFRyYXZlcnNlIHRocm91Z2ggb3VyIGVsZW1lbnRzIGluIHRoZSBzcGVjaWZpZWQgZGlyZWN0aW9uICgrLy0xKSBhbmQgdHJ5IHRvXHJcbiAgICAgIC8vIGZvY3VzIHRoZW0gdW50aWwgd2UgZmluZCBvbmUgdGhhdCBhY2NlcHRzIGZvY3VzXHJcbiAgICAgIGZvciAodmFyIGkgPSBjdXJyZW50SW5kZXggKyBkaXJlY3Rpb247IGkgPj0gMCAmJiBpIDwgaXRlbXMubGVuZ3RoOyBpID0gaSArIGRpcmVjdGlvbikge1xyXG4gICAgICAgIHZhciBmb2N1c1RhcmdldCA9IGl0ZW1zW2ldLmZpcnN0RWxlbWVudENoaWxkIHx8IGl0ZW1zW2ldO1xyXG4gICAgICAgIHZhciBkaWRGb2N1cyA9IGF0dGVtcHRGb2N1cyhmb2N1c1RhcmdldCk7XHJcbiAgICAgICAgaWYgKGRpZEZvY3VzKSB7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEF0dGVtcHRzIHRvIGZvY3VzIGFuIGVsZW1lbnQuIENoZWNrcyB3aGV0aGVyIHRoYXQgZWxlbWVudCBpcyB0aGUgY3VycmVudGx5XHJcbiAgICAgKiBmb2N1c2VkIGVsZW1lbnQgYWZ0ZXIgYXR0ZW1wdGluZy5cclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsIC0gdGhlIGVsZW1lbnQgdG8gYXR0ZW1wdCBmb2N1cyBvblxyXG4gICAgICogQHJldHVybnMge2Jvb2x9IC0gd2hldGhlciB0aGUgZWxlbWVudCB3YXMgc3VjY2Vzc2Z1bGx5IGZvY3VzZWRcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gYXR0ZW1wdEZvY3VzKGVsKSB7XHJcbiAgICAgIGlmIChlbCAmJiBlbC5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JykgIT0gLTEpIHtcclxuICAgICAgICBlbC5mb2N1cygpO1xyXG4gICAgICAgIGlmICgkZG9jdW1lbnRbMF0uYWN0aXZlRWxlbWVudCA9PSBlbCkge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEJvaWxlcnBsYXRlIGludGVyaW1FbGVtZW50IG9uUmVtb3ZlIGZ1bmN0aW9uXHJcbiAgICAgKiBIYW5kbGVzIHJlbW92aW5nIHRoZSBtZW51IGZyb20gdGhlIERPTSwgY2xlYW5pbmcgdXAgdGhlIGVsZW1lbnRcclxuICAgICAqIGFuZCByZW1vdmluZyB2YXJpb3VzIGxpc3RlbmVyc1xyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBvblJlbW92ZShzY29wZSwgZWxlbWVudCwgb3B0cykge1xyXG4gICAgICBvcHRzLmlzUmVtb3ZlZCA9IHRydWU7XHJcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWxlYXZlJylcclxuICAgICAgICAucmVtb3ZlQ2xhc3MoJ21kLWNsaWNrYWJsZScpO1xyXG5cclxuICAgICAgLy8gRGlzYWJsZSByZXNpemluZyBoYW5kbGVyc1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdyZXNpemUnLCBvcHRzLnJlc2l6ZUZuKTtcclxuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZignb3JpZW50YXRpb25jaGFuZ2UnLCBvcHRzLnJlc2l6ZUZuKTtcclxuICAgICAgb3B0cy5yZXNpemVGbiA9IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgIC8vIFdhaXQgZm9yIGFuaW1hdGUgb3V0LCB0aGVuIHJlbW92ZSBmcm9tIHRoZSBET01cclxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2UoZWxlbWVudCwgeyB0aW1lb3V0OiAzNTAgfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1hY3RpdmUnKTtcclxuICAgICAgICBvcHRzLmJhY2tkcm9wICYmIG9wdHMuYmFja2Ryb3AucmVtb3ZlKCk7XHJcbiAgICAgICAgaWYgKGVsZW1lbnRbMF0ucGFyZW50Tm9kZSA9PT0gb3B0cy5wYXJlbnRbMF0pIHtcclxuICAgICAgICAgIG9wdHMucGFyZW50WzBdLnJlbW92ZUNoaWxkKGVsZW1lbnRbMF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBvcHRzLnJlc3RvcmVTY3JvbGwgJiYgb3B0cy5yZXN0b3JlU2Nyb2xsKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29tcHV0ZXMgbWVudSBwb3NpdGlvbiBhbmQgc2V0cyB0aGUgc3R5bGUgb24gdGhlIG1lbnUgY29udGFpbmVyXHJcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbCAtIHRoZSBtZW51IGNvbnRhaW5lciBlbGVtZW50XHJcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb3B0cyAtIHRoZSBpbnRlcmltIGVsZW1lbnQgb3B0aW9ucyBvYmplY3RcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcG9zaXRpb25NZW51KGVsLCBvcHRzKSB7XHJcbiAgICAgIGlmIChvcHRzLmlzUmVtb3ZlZCkgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIGNvbnRhaW5lck5vZGUgPSBlbFswXSxcclxuICAgICAgICAgIG9wZW5NZW51Tm9kZSA9IGVsWzBdLmZpcnN0RWxlbWVudENoaWxkLFxyXG4gICAgICAgICAgb3Blbk1lbnVOb2RlUmVjdCA9IG9wZW5NZW51Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICAgIGJvdW5kcnlOb2RlID0gb3B0cy5wYXJlbnRbMF0sXHJcbiAgICAgICAgICBib3VuZHJ5Tm9kZVJlY3QgPSBib3VuZHJ5Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgIHZhciBvcmlnaW5Ob2RlID0gb3B0cy50YXJnZXRbMF0ucXVlcnlTZWxlY3RvcignW21kLW1lbnUtb3JpZ2luXScpIHx8IG9wdHMudGFyZ2V0WzBdLFxyXG4gICAgICAgICAgb3JpZ2luTm9kZVJlY3QgPSBvcmlnaW5Ob2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuXHJcbiAgICAgIHZhciBib3VuZHMgPSB7XHJcbiAgICAgICAgbGVmdDogYm91bmRyeU5vZGVSZWN0LmxlZnQgKyBNRU5VX0VER0VfTUFSR0lOLFxyXG4gICAgICAgIHRvcDogYm91bmRyeU5vZGVSZWN0LnRvcCArIE1FTlVfRURHRV9NQVJHSU4sXHJcbiAgICAgICAgYm90dG9tOiBib3VuZHJ5Tm9kZVJlY3QuYm90dG9tIC0gTUVOVV9FREdFX01BUkdJTixcclxuICAgICAgICByaWdodDogYm91bmRyeU5vZGVSZWN0LnJpZ2h0IC0gTUVOVV9FREdFX01BUkdJTlxyXG4gICAgICB9O1xyXG5cclxuXHJcbiAgICAgIHZhciBhbGlnblRhcmdldCwgYWxpZ25UYXJnZXRSZWN0LCBleGlzdGluZ09mZnNldHM7XHJcbiAgICAgIHZhciBwb3NpdGlvbk1vZGUgPSBvcHRzLm1kTWVudUN0cmwucG9zaXRpb25Nb2RlKCk7XHJcblxyXG4gICAgICBpZiAocG9zaXRpb25Nb2RlLnRvcCA9PSAndGFyZ2V0JyB8fCBwb3NpdGlvbk1vZGUubGVmdCA9PSAndGFyZ2V0JyB8fCBwb3NpdGlvbk1vZGUubGVmdCA9PSAndGFyZ2V0LXJpZ2h0Jykge1xyXG4gICAgICAgIC8vIFRPRE86IEFsbG93IGNlbnRlcmluZyBvbiBhbiBhcmJpdHJhcnkgbm9kZSwgZm9yIG5vdyBjZW50ZXIgb24gZmlyc3QgbWVudS1pdGVtJ3MgY2hpbGRcclxuICAgICAgICBhbGlnblRhcmdldCA9IG9wZW5NZW51Tm9kZS5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZCB8fCBvcGVuTWVudU5vZGUuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICAgICAgYWxpZ25UYXJnZXQgPSBhbGlnblRhcmdldC5xdWVyeVNlbGVjdG9yKCdbbWQtbWVudS1hbGlnbi10YXJnZXRdJykgfHwgYWxpZ25UYXJnZXQ7XHJcbiAgICAgICAgYWxpZ25UYXJnZXRSZWN0ID0gYWxpZ25UYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgIGV4aXN0aW5nT2Zmc2V0cyA9IHtcclxuICAgICAgICAgIHRvcDogcGFyc2VGbG9hdChjb250YWluZXJOb2RlLnN0eWxlLnRvcCB8fCAwKSxcclxuICAgICAgICAgIGxlZnQ6IHBhcnNlRmxvYXQoY29udGFpbmVyTm9kZS5zdHlsZS5sZWZ0IHx8IDApXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHBvc2l0aW9uID0geyB9O1xyXG4gICAgICB2YXIgdHJhbnNmb3JtT3JpZ2luID0gJ3RvcCAnO1xyXG5cclxuICAgICAgc3dpdGNoIChwb3NpdGlvbk1vZGUudG9wKSB7XHJcbiAgICAgICAgY2FzZSAndGFyZ2V0JzpcclxuICAgICAgICAgIHBvc2l0aW9uLnRvcCA9IGV4aXN0aW5nT2Zmc2V0cy50b3AgKyBvcmlnaW5Ob2RlUmVjdC50b3AgLSBhbGlnblRhcmdldFJlY3QudG9wO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgLy8gRnV0dXJlIHN1cHBvcnQgZm9yIG1kTWVudUJhclxyXG4gICAgICAgIC8vIGNhc2UgJ3RvcCc6XHJcbiAgICAgICAgLy8gICBwb3NpdGlvbi50b3AgPSBvcmlnaW5Ob2RlUmVjdC50b3A7XHJcbiAgICAgICAgLy8gICBicmVhaztcclxuICAgICAgICAvLyBjYXNlICdib3R0b20nOlxyXG4gICAgICAgIC8vICAgcG9zaXRpb24udG9wID0gb3JpZ2luTm9kZVJlY3QudG9wICsgb3JpZ2luTm9kZVJlY3QuaGVpZ2h0O1xyXG4gICAgICAgIC8vICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB0YXJnZXQgbW9kZSBcIicgKyBwb3NpdGlvbk1vZGUudG9wICsgJ1wiIHNwZWNpZmllZCBmb3IgbWQtbWVudSBvbiBZIGF4aXMuJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHN3aXRjaCAocG9zaXRpb25Nb2RlLmxlZnQpIHtcclxuICAgICAgICBjYXNlICd0YXJnZXQnOlxyXG4gICAgICAgICAgcG9zaXRpb24ubGVmdCA9IGV4aXN0aW5nT2Zmc2V0cy5sZWZ0ICsgb3JpZ2luTm9kZVJlY3QubGVmdCAtIGFsaWduVGFyZ2V0UmVjdC5sZWZ0O1xyXG4gICAgICAgICAgdHJhbnNmb3JtT3JpZ2luICs9ICdsZWZ0JztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3RhcmdldC1yaWdodCc6XHJcbiAgICAgICAgICBwb3NpdGlvbi5sZWZ0ID0gb3JpZ2luTm9kZVJlY3QucmlnaHQgLSBvcGVuTWVudU5vZGVSZWN0LndpZHRoICsgKG9wZW5NZW51Tm9kZVJlY3QucmlnaHQgLSBhbGlnblRhcmdldFJlY3QucmlnaHQpO1xyXG4gICAgICAgICAgdHJhbnNmb3JtT3JpZ2luICs9ICdyaWdodCc7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICAvLyBGdXR1cmUgc3VwcG9ydCBmb3IgbWRNZW51QmFyXHJcbiAgICAgICAgLy8gY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgLy8gICBwb3NpdGlvbi5sZWZ0ID0gb3JpZ2luTm9kZVJlY3QubGVmdDtcclxuICAgICAgICAvLyAgIHRyYW5zZm9ybU9yaWdpbiArPSAnbGVmdCc7XHJcbiAgICAgICAgLy8gICBicmVhaztcclxuICAgICAgICAvLyBjYXNlICdyaWdodCc6XHJcbiAgICAgICAgLy8gICBwb3NpdGlvbi5sZWZ0ID0gb3JpZ2luTm9kZVJlY3QucmlnaHQgLSBjb250YWluZXJOb2RlLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIC8vICAgdHJhbnNmb3JtT3JpZ2luICs9ICdyaWdodCc7XHJcbiAgICAgICAgLy8gICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHRhcmdldCBtb2RlIFwiJyArIHBvc2l0aW9uTW9kZS5sZWZ0ICsgJ1wiIHNwZWNpZmllZCBmb3IgbWQtbWVudSBvbiBYIGF4aXMuJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBvZmZzZXRzID0gb3B0cy5tZE1lbnVDdHJsLm9mZnNldHMoKTtcclxuICAgICAgcG9zaXRpb24udG9wICs9IG9mZnNldHMudG9wO1xyXG4gICAgICBwb3NpdGlvbi5sZWZ0ICs9IG9mZnNldHMubGVmdDtcclxuXHJcbiAgICAgIGNsYW1wKHBvc2l0aW9uKTtcclxuXHJcbiAgICAgIGVsLmNzcyh7XHJcbiAgICAgICAgdG9wOiBwb3NpdGlvbi50b3AgKyAncHgnLFxyXG4gICAgICAgIGxlZnQ6IHBvc2l0aW9uLmxlZnQgKyAncHgnXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29udGFpbmVyTm9kZS5zdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNX09SSUdJTl0gPSB0cmFuc2Zvcm1PcmlnaW47XHJcblxyXG4gICAgICAvLyBBbmltYXRlIGEgc2NhbGUgb3V0IGlmIHdlIGFyZW4ndCBqdXN0IHJlcG9zaXRpb25pbmdcclxuICAgICAgaWYgKCFvcHRzLmFscmVhZHlPcGVuKSB7XHJcbiAgICAgICAgY29udGFpbmVyTm9kZS5zdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNXSA9ICdzY2FsZSgnICtcclxuICAgICAgICAgIE1hdGgubWluKG9yaWdpbk5vZGVSZWN0LndpZHRoIC8gY29udGFpbmVyTm9kZS5vZmZzZXRXaWR0aCwgMS4wKSArICcsJyArXHJcbiAgICAgICAgICBNYXRoLm1pbihvcmlnaW5Ob2RlUmVjdC5oZWlnaHQgLyBjb250YWluZXJOb2RlLm9mZnNldEhlaWdodCwgMS4wKSArXHJcbiAgICAgICAgJyknO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvKipcclxuICAgICAgICogQ2xhbXBzIHRoZSByZXBvc2l0aW9uaW5nIG9mIHRoZSBtZW51IHdpdGhpbiB0aGUgY29uZmluZXMgb2ZcclxuICAgICAgICogYm91bmRpbmcgZWxlbWVudCAob2Z0ZW4gdGhlIHNjcmVlbi9ib2R5KVxyXG4gICAgICAgKi9cclxuICAgICAgZnVuY3Rpb24gY2xhbXAocG9zKSB7XHJcbiAgICAgICAgcG9zLnRvcCA9IE1hdGgubWF4KE1hdGgubWluKHBvcy50b3AsIGJvdW5kcy5ib3R0b20gLSBjb250YWluZXJOb2RlLm9mZnNldEhlaWdodCksIGJvdW5kcy50b3ApO1xyXG4gICAgICAgIHBvcy5sZWZ0ID0gTWF0aC5tYXgoTWF0aC5taW4ocG9zLmxlZnQsIGJvdW5kcy5yaWdodCAtIGNvbnRhaW5lck5vZGUub2Zmc2V0V2lkdGgpLCBib3VuZHMubGVmdCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuTWVudVByb3ZpZGVyLiRpbmplY3QgPSBbXCIkJGludGVyaW1FbGVtZW50UHJvdmlkZXJcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzQ2lyY3VsYXJcclxuICogQGRlc2NyaXB0aW9uIENpcmN1bGFyIFByb2dyZXNzIG1vZHVsZSFcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzQ2lyY3VsYXInLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRQcm9ncmVzc0NpcmN1bGFyJywgTWRQcm9ncmVzc0NpcmN1bGFyRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kUHJvZ3Jlc3NDaXJjdWxhclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMucHJvZ3Jlc3NDaXJjdWxhclxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKlxyXG4qIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgY2lyY3VsYXIgcHJvZ3Jlc3MgZGlyZWN0aXZlIGlzIHVzZWQgdG8gbWFrZSBsb2FkaW5nIGNvbnRlbnQgaW4geW91ciBhcHAgYXMgZGVsaWdodGZ1bCBhbmRcclxuICogcGFpbmxlc3MgYXMgcG9zc2libGUgYnkgbWluaW1pemluZyB0aGUgYW1vdW50IG9mIHZpc3VhbCBjaGFuZ2UgYSB1c2VyIHNlZXMgYmVmb3JlIHRoZXkgY2FuIHZpZXdcclxuICogYW5kIGludGVyYWN0IHdpdGggY29udGVudC5cclxuICpcclxuICogRm9yIG9wZXJhdGlvbnMgd2hlcmUgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIG9wZXJhdGlvbiBjb21wbGV0ZWQgY2FuIGJlIGRldGVybWluZWQsIHVzZSBhXHJcbiAqIGRldGVybWluYXRlIGluZGljYXRvci4gVGhleSBnaXZlIHVzZXJzIGEgcXVpY2sgc2Vuc2Ugb2YgaG93IGxvbmcgYW4gb3BlcmF0aW9uIHdpbGwgdGFrZS5cclxuICpcclxuICogRm9yIG9wZXJhdGlvbnMgd2hlcmUgdGhlIHVzZXIgaXMgYXNrZWQgdG8gd2FpdCBhIG1vbWVudCB3aGlsZSBzb21ldGhpbmcgZmluaXNoZXMgdXAsIGFuZCBpdOKAmXNcclxuICogbm90IG5lY2Vzc2FyeSB0byBleHBvc2Ugd2hhdCdzIGhhcHBlbmluZyBiZWhpbmQgdGhlIHNjZW5lcyBhbmQgaG93IGxvbmcgaXQgd2lsbCB0YWtlLCB1c2UgYW5cclxuICogaW5kZXRlcm1pbmF0ZSBpbmRpY2F0b3IuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1tb2RlIFNlbGVjdCBmcm9tIG9uZSBvZiB0d28gbW9kZXM6IGRldGVybWluYXRlIGFuZCBpbmRldGVybWluYXRlLlxyXG4gKiBAcGFyYW0ge251bWJlcj19IHZhbHVlIEluIGRldGVybWluYXRlIG1vZGUsIHRoaXMgbnVtYmVyIHJlcHJlc2VudHMgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlXHJcbiAqICAgICBjaXJjdWxhciBwcm9ncmVzcy4gRGVmYXVsdDogMFxyXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLWRpYW1ldGVyIFRoaXMgc3BlY2lmaWVzIHRoZSBkaWFtdGVyIG9mIHRoZSBjaXJjdWxhciBwcm9ncmVzcy4gRGVmYXVsdDogNDhcclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1wcm9ncmVzcy1jaXJjdWxhciBtZC1tb2RlPVwiZGV0ZXJtaW5hdGVcIiB2YWx1ZT1cIi4uLlwiPjwvbWQtcHJvZ3Jlc3MtY2lyY3VsYXI+XHJcbiAqXHJcbiAqIDxtZC1wcm9ncmVzcy1jaXJjdWxhciBtZC1tb2RlPVwiZGV0ZXJtaW5hdGVcIiBuZy12YWx1ZT1cIi4uLlwiPjwvbWQtcHJvZ3Jlc3MtY2lyY3VsYXI+XHJcbiAqXHJcbiAqIDxtZC1wcm9ncmVzcy1jaXJjdWxhciBtZC1tb2RlPVwiZGV0ZXJtaW5hdGVcIiB2YWx1ZT1cIi4uLlwiIG1kLWRpYW1ldGVyPVwiMTAwXCI+PC9tZC1wcm9ncmVzcy1jaXJjdWxhcj5cclxuICpcclxuICogPG1kLXByb2dyZXNzLWNpcmN1bGFyIG1kLW1vZGU9XCJpbmRldGVybWluYXRlXCI+PC9tZC1wcm9ncmVzcy1jaXJjdWxhcj5cclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gTWRQcm9ncmVzc0NpcmN1bGFyRGlyZWN0aXZlKCRtZENvbnN0YW50LCAkbWRUaGVtaW5nKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICB0ZW1wbGF0ZTpcclxuICAgICAgICAvLyBUaGUgcHJvZ3Jlc3MgJ2NpcmNsZScgaXMgY29tcG9zZWQgb2YgdHdvIGhhbGYtY2lyY2xlczogdGhlIGxlZnQgc2lkZSBhbmQgdGhlIHJpZ2h0XHJcbiAgICAgICAgLy8gc2lkZS4gRWFjaCBzaWRlIGhhcyBDU1MgYXBwbGllZCB0byAnZmlsbC1pbicgdGhlIGhhbGYtY2lyY2xlIHRvIHRoZSBhcHByb3ByaWF0ZSBwcm9ncmVzcy5cclxuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLXNwaW5uZXItd3JhcHBlclwiPicgK1xyXG4gICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1pbm5lclwiPicgK1xyXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWdhcFwiPjwvZGl2PicgK1xyXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWxlZnRcIj4nICtcclxuICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWhhbGYtY2lyY2xlXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICc8L2Rpdj4nICtcclxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZC1yaWdodFwiPicgK1xyXG4gICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtaGFsZi1jaXJjbGVcIj48L2Rpdj4nICtcclxuICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICc8L2Rpdj4nLFxyXG4gICAgY29tcGlsZTogY29tcGlsZVxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGUodEVsZW1lbnQpIHtcclxuICAgIC8vIFRoZSBqYXZhc2NyaXB0IGluIHRoaXMgZmlsZSBpcyBtYWlubHkgcmVzcG9uc2libGUgZm9yIHNldHRpbmcgdGhlIGNvcnJlY3QgYXJpYSBhdHRyaWJ1dGVzLlxyXG4gICAgLy8gVGhlIGFuaW1hdGlvbiBvZiB0aGUgcHJvZ3Jlc3Mgc3Bpbm5lciBpcyBkb25lIGVudGlyZWx5IHdpdGgganVzdCBDU1MuXHJcbiAgICB0RWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWluJywgMCk7XHJcbiAgICB0RWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWF4JywgMTAwKTtcclxuICAgIHRFbGVtZW50LmF0dHIoJ3JvbGUnLCAncHJvZ3Jlc3NiYXInKTtcclxuXHJcbiAgICByZXR1cm4gcG9zdExpbms7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuICAgIHZhciBjaXJjbGUgPSBlbGVtZW50WzBdO1xyXG5cclxuICAgIC8vIFNjYWxlIHRoZSBwcm9ncmVzcyBjaXJjbGUgYmFzZWQgb24gdGhlIGRlZmF1bHQgZGlhbWV0ZXIuXHJcbiAgICB2YXIgZGlhbWV0ZXIgPSBhdHRyLm1kRGlhbWV0ZXIgfHwgNDg7XHJcbiAgICB2YXIgc2NhbGUgPSBkaWFtZXRlciAvIDQ4O1xyXG4gICAgY2lyY2xlLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gJ3NjYWxlKCcgKyBzY2FsZSArICcpJztcclxuXHJcbiAgICBhdHRyLiRvYnNlcnZlKCd2YWx1ZScsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgIHZhciBwZXJjZW50VmFsdWUgPSBjbGFtcCh2YWx1ZSk7XHJcbiAgICAgIGVsZW1lbnQuYXR0cignYXJpYS12YWx1ZW5vdycsIHBlcmNlbnRWYWx1ZSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsYW1wcyB0aGUgdmFsdWUgdG8gYmUgYmV0d2VlbiAwIGFuZCAxMDAuXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHZhbHVlIFRoZSB2YWx1ZSB0byBjbGFtcC5cclxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGNsYW1wKHZhbHVlKSB7XHJcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4odmFsdWUgfHwgMCwgMTAwKSk7XHJcbiAgfVxyXG59XHJcbk1kUHJvZ3Jlc3NDaXJjdWxhckRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kQ29uc3RhbnRcIiwgXCIkbWRUaGVtaW5nXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5wcm9ncmVzc0xpbmVhclxyXG4gKiBAZGVzY3JpcHRpb24gTGluZWFyIFByb2dyZXNzIG1vZHVsZSFcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzTGluZWFyJywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJ1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kUHJvZ3Jlc3NMaW5lYXInLCBNZFByb2dyZXNzTGluZWFyRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kUHJvZ3Jlc3NMaW5lYXJcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnByb2dyZXNzTGluZWFyXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgbGluZWFyIHByb2dyZXNzIGRpcmVjdGl2ZSBpcyB1c2VkIHRvIG1ha2UgbG9hZGluZyBjb250ZW50IGluIHlvdXIgYXBwIGFzIGRlbGlnaHRmdWwgYW5kIHBhaW5sZXNzIGFzIHBvc3NpYmxlIGJ5IG1pbmltaXppbmcgdGhlIGFtb3VudCBvZiB2aXN1YWwgY2hhbmdlIGEgdXNlciBzZWVzIGJlZm9yZSB0aGV5IGNhbiB2aWV3IGFuZCBpbnRlcmFjdCB3aXRoIGNvbnRlbnQuIEVhY2ggb3BlcmF0aW9uIHNob3VsZCBvbmx5IGJlIHJlcHJlc2VudGVkIGJ5IG9uZSBhY3Rpdml0eSBpbmRpY2F0b3LigJRmb3IgZXhhbXBsZSwgb25lIHJlZnJlc2ggb3BlcmF0aW9uIHNob3VsZCBub3QgZGlzcGxheSBib3RoIGEgcmVmcmVzaCBiYXIgYW5kIGFuIGFjdGl2aXR5IGNpcmNsZS5cclxuICpcclxuICogRm9yIG9wZXJhdGlvbnMgd2hlcmUgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIG9wZXJhdGlvbiBjb21wbGV0ZWQgY2FuIGJlIGRldGVybWluZWQsIHVzZSBhIGRldGVybWluYXRlIGluZGljYXRvci4gVGhleSBnaXZlIHVzZXJzIGEgcXVpY2sgc2Vuc2Ugb2YgaG93IGxvbmcgYW4gb3BlcmF0aW9uIHdpbGwgdGFrZS5cclxuICpcclxuICogRm9yIG9wZXJhdGlvbnMgd2hlcmUgdGhlIHVzZXIgaXMgYXNrZWQgdG8gd2FpdCBhIG1vbWVudCB3aGlsZSBzb21ldGhpbmcgZmluaXNoZXMgdXAsIGFuZCBpdOKAmXMgbm90IG5lY2Vzc2FyeSB0byBleHBvc2Ugd2hhdCdzIGhhcHBlbmluZyBiZWhpbmQgdGhlIHNjZW5lcyBhbmQgaG93IGxvbmcgaXQgd2lsbCB0YWtlLCB1c2UgYW4gaW5kZXRlcm1pbmF0ZSBpbmRpY2F0b3IuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZC1tb2RlIFNlbGVjdCBmcm9tIG9uZSBvZiBmb3VyIG1vZGVzOiBkZXRlcm1pbmF0ZSwgaW5kZXRlcm1pbmF0ZSwgYnVmZmVyIG9yIHF1ZXJ5LlxyXG4gKiBAcGFyYW0ge251bWJlcj19IHZhbHVlIEluIGRldGVybWluYXRlIGFuZCBidWZmZXIgbW9kZXMsIHRoaXMgbnVtYmVyIHJlcHJlc2VudHMgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIHByaW1hcnkgcHJvZ3Jlc3MgYmFyLiBEZWZhdWx0OiAwXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtYnVmZmVyLXZhbHVlIEluIHRoZSBidWZmZXIgbW9kZSwgdGhpcyBudW1iZXIgcmVwcmVzZW50cyB0aGUgcHJlY2VudGFnZSBvZiB0aGUgc2Vjb25kYXJ5IHByb2dyZXNzIGJhci4gRGVmYXVsdDogMFxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXByb2dyZXNzLWxpbmVhciBtZC1tb2RlPVwiZGV0ZXJtaW5hdGVcIiB2YWx1ZT1cIi4uLlwiPjwvbWQtcHJvZ3Jlc3MtbGluZWFyPlxyXG4gKlxyXG4gKiA8bWQtcHJvZ3Jlc3MtbGluZWFyIG1kLW1vZGU9XCJkZXRlcm1pbmF0ZVwiIG5nLXZhbHVlPVwiLi4uXCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XHJcbiAqXHJcbiAqIDxtZC1wcm9ncmVzcy1saW5lYXIgbWQtbW9kZT1cImluZGV0ZXJtaW5hdGVcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cclxuICpcclxuICogPG1kLXByb2dyZXNzLWxpbmVhciBtZC1tb2RlPVwiYnVmZmVyXCIgdmFsdWU9XCIuLi5cIiBtZC1idWZmZXItdmFsdWU9XCIuLi5cIj48L21kLXByb2dyZXNzLWxpbmVhcj5cclxuICpcclxuICogPG1kLXByb2dyZXNzLWxpbmVhciBtZC1tb2RlPVwicXVlcnlcIj48L21kLXByb2dyZXNzLWxpbmVhcj5cclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gTWRQcm9ncmVzc0xpbmVhckRpcmVjdGl2ZSgkJHJBRiwgJG1kQ29uc3RhbnQsICRtZFRoZW1pbmcpIHtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJtZC1jb250YWluZXJcIj4nICtcclxuICAgICAgJzxkaXYgY2xhc3M9XCJtZC1kYXNoZWRcIj48L2Rpdj4nICtcclxuICAgICAgJzxkaXYgY2xhc3M9XCJtZC1iYXIgbWQtYmFyMVwiPjwvZGl2PicgK1xyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1kLWJhciBtZC1iYXIyXCI+PC9kaXY+JyArXHJcbiAgICAgICc8L2Rpdj4nLFxyXG4gICAgY29tcGlsZTogY29tcGlsZVxyXG4gIH07XHJcbiAgXHJcbiAgZnVuY3Rpb24gY29tcGlsZSh0RWxlbWVudCwgdEF0dHJzLCB0cmFuc2NsdWRlKSB7XHJcbiAgICB0RWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWluJywgMCk7XHJcbiAgICB0RWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWF4JywgMTAwKTtcclxuICAgIHRFbGVtZW50LmF0dHIoJ3JvbGUnLCAncHJvZ3Jlc3NiYXInKTtcclxuXHJcbiAgICByZXR1cm4gcG9zdExpbms7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgdmFyIGJhcjFTdHlsZSA9IGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLWJhcjEnKS5zdHlsZSxcclxuICAgICAgYmFyMlN0eWxlID0gZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtYmFyMicpLnN0eWxlLFxyXG4gICAgICBjb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtY29udGFpbmVyJykpO1xyXG5cclxuICAgIGF0dHIuJG9ic2VydmUoJ3ZhbHVlJywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgaWYgKGF0dHIubWRNb2RlID09ICdxdWVyeScpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBjbGFtcGVkID0gY2xhbXAodmFsdWUpO1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVub3cnLCBjbGFtcGVkKTtcclxuICAgICAgYmFyMlN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gdHJhbnNmb3Jtc1tjbGFtcGVkXTtcclxuICAgIH0pO1xyXG5cclxuICAgIGF0dHIuJG9ic2VydmUoJ21kQnVmZmVyVmFsdWUnLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICBiYXIxU3R5bGVbJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STV0gPSB0cmFuc2Zvcm1zW2NsYW1wKHZhbHVlKV07XHJcbiAgICB9KTtcclxuXHJcbiAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgY29udGFpbmVyLmFkZENsYXNzKCdtZC1yZWFkeScpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjbGFtcCh2YWx1ZSkge1xyXG4gICAgaWYgKHZhbHVlID4gMTAwKSB7XHJcbiAgICAgIHJldHVybiAxMDA7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZhbHVlIDwgMCkge1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTWF0aC5jZWlsKHZhbHVlIHx8IDApO1xyXG4gIH1cclxufVxyXG5NZFByb2dyZXNzTGluZWFyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkJHJBRlwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiXTtcclxuXHJcblxyXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbi8vIFByaXZhdGUgTWV0aG9kc1xyXG4vLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbnZhciB0cmFuc2Zvcm1zID0gKGZ1bmN0aW9uKCkge1xyXG4gIHZhciB2YWx1ZXMgPSBuZXcgQXJyYXkoMTAxKTtcclxuICBmb3IodmFyIGkgPSAwOyBpIDwgMTAxOyBpKyspe1xyXG4gICAgdmFsdWVzW2ldID0gbWFrZVRyYW5zZm9ybShpKTtcclxuICB9XHJcblxyXG4gIHJldHVybiB2YWx1ZXM7XHJcblxyXG4gIGZ1bmN0aW9uIG1ha2VUcmFuc2Zvcm0odmFsdWUpe1xyXG4gICAgdmFyIHNjYWxlID0gdmFsdWUvMTAwO1xyXG4gICAgdmFyIHRyYW5zbGF0ZVggPSAodmFsdWUtMTAwKS8yO1xyXG4gICAgcmV0dXJuICd0cmFuc2xhdGVYKCcgKyB0cmFuc2xhdGVYLnRvU3RyaW5nKCkgKyAnJSkgc2NhbGUoJyArIHNjYWxlLnRvU3RyaW5nKCkgKyAnLCAxKSc7XHJcbiAgfVxyXG59KSgpO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5yYWRpb0J1dHRvblxyXG4gKiBAZGVzY3JpcHRpb24gcmFkaW9CdXR0b24gbW9kdWxlIVxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMucmFkaW9CdXR0b24nLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRSYWRpb0dyb3VwJywgbWRSYWRpb0dyb3VwRGlyZWN0aXZlKVxyXG4gIC5kaXJlY3RpdmUoJ21kUmFkaW9CdXR0b24nLCBtZFJhZGlvQnV0dG9uRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5yYWRpb0J1dHRvblxyXG4gKiBAbmFtZSBtZFJhZGlvR3JvdXBcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLXJhZGlvLWdyb3VwPmAgZGlyZWN0aXZlIGlkZW50aWZpZXMgYSBncm91cGluZ1xyXG4gKiBjb250YWluZXIgZm9yIHRoZSAxLi5uIGdyb3VwZWQgcmFkaW8gYnV0dG9uczsgc3BlY2lmaWVkIHVzaW5nIG5lc3RlZFxyXG4gKiBgPG1kLXJhZGlvLWJ1dHRvbj5gIHRhZ3MuXHJcbiAqXHJcbiAqIEFzIHBlciB0aGUgW21hdGVyaWFsIGRlc2lnbiBzcGVjXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvc3R5bGUvY29sb3IuaHRtbCNjb2xvci11aS1jb2xvci1hcHBsaWNhdGlvbilcclxuICogdGhlIHJhZGlvIGJ1dHRvbiBpcyBpbiB0aGUgYWNjZW50IGNvbG9yIGJ5IGRlZmF1bHQuIFRoZSBwcmltYXJ5IGNvbG9yIHBhbGV0dGUgbWF5IGJlIHVzZWQgd2l0aFxyXG4gKiB0aGUgYG1kLXByaW1hcnlgIGNsYXNzLlxyXG4gKlxyXG4gKiBOb3RlOiBgPG1kLXJhZGlvLWdyb3VwPmAgYW5kIGA8bWQtcmFkaW8tYnV0dG9uPmAgaGFuZGxlIHRhYmluZGV4IGRpZmZlcmVudGx5XHJcbiAqIHRoYW4gdGhlIG5hdGl2ZSBgPGlucHV0IHR5cGU9J3JhZGlvJz5gIGNvbnRyb2xzLiBXaGVyZWFzIHRoZSBuYXRpdmUgY29udHJvbHNcclxuICogZm9yY2UgdGhlIHVzZXIgdG8gdGFiIHRocm91Z2ggYWxsIHRoZSByYWRpbyBidXR0b25zLCBgPG1kLXJhZGlvLWdyb3VwPmBcclxuICogaXMgZm9jdXNhYmxlLCBhbmQgYnkgZGVmYXVsdCB0aGUgYDxtZC1yYWRpby1idXR0b24+YHMgYXJlIG5vdC5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IG5nLW1vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtbm8taW5rIFVzZSBvZiBhdHRyaWJ1dGUgaW5kaWNhdGVzIGZsYWcgdG8gZGlzYWJsZSBpbmsgcmlwcGxlIGVmZmVjdHMuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtcmFkaW8tZ3JvdXAgbmctbW9kZWw9XCJzZWxlY3RlZFwiPlxyXG4gKlxyXG4gKiAgIDxtZC1yYWRpby1idXR0b25cclxuICogICAgICAgIG5nLXJlcGVhdD1cImQgaW4gY29sb3JPcHRpb25zXCJcclxuICogICAgICAgIG5nLXZhbHVlPVwiZC52YWx1ZVwiIGFyaWEtbGFiZWw9XCJ7eyBkLmxhYmVsIH19XCI+XHJcbiAqXHJcbiAqICAgICAgICAgIHt7IGQubGFiZWwgfX1cclxuICpcclxuICogICA8L21kLXJhZGlvLWJ1dHRvbj5cclxuICpcclxuICogPC9tZC1yYWRpby1ncm91cD5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKi9cclxuZnVuY3Rpb24gbWRSYWRpb0dyb3VwRGlyZWN0aXZlKCRtZFV0aWwsICRtZENvbnN0YW50LCAkbWRUaGVtaW5nLCAkdGltZW91dCkge1xyXG4gIFJhZGlvR3JvdXBDb250cm9sbGVyLnByb3RvdHlwZSA9IGNyZWF0ZVJhZGlvR3JvdXBDb250cm9sbGVyUHJvdG8oKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBjb250cm9sbGVyOiBbJyRlbGVtZW50JywgUmFkaW9Hcm91cENvbnRyb2xsZXJdLFxyXG4gICAgcmVxdWlyZTogWydtZFJhZGlvR3JvdXAnLCAnP25nTW9kZWwnXSxcclxuICAgIGxpbms6IHsgcHJlOiBsaW5rUmFkaW9Hcm91cCB9XHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gbGlua1JhZGlvR3JvdXAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmxzKSB7XHJcbiAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgdmFyIHJnQ3RybCA9IGN0cmxzWzBdO1xyXG4gICAgdmFyIG5nTW9kZWxDdHJsID0gY3RybHNbMV0gfHwgJG1kVXRpbC5mYWtlTmdNb2RlbCgpO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNldEZvY3VzKCkge1xyXG4gICAgICBpZiAoIWVsZW1lbnQuaGFzQ2xhc3MoJ21kLWZvY3VzZWQnKSkgeyBlbGVtZW50LmFkZENsYXNzKCdtZC1mb2N1c2VkJyk7IH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBrZXlkb3duTGlzdGVuZXIoZXYpIHtcclxuICAgICAgdmFyIGtleUNvZGUgPSBldi53aGljaCB8fCBldi5rZXlDb2RlO1xyXG4gICAgICBzd2l0Y2goa2V5Q29kZSkge1xyXG4gICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuTEVGVF9BUlJPVzpcclxuICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlVQX0FSUk9XOlxyXG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIHJnQ3RybC5zZWxlY3RQcmV2aW91cygpO1xyXG4gICAgICAgICAgc2V0Rm9jdXMoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlJJR0hUX0FSUk9XOlxyXG4gICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRE9XTl9BUlJPVzpcclxuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICByZ0N0cmwuc2VsZWN0TmV4dCgpO1xyXG4gICAgICAgICAgc2V0Rm9jdXMoKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkVOVEVSOlxyXG4gICAgICAgICAgdmFyIGZvcm0gPSBhbmd1bGFyLmVsZW1lbnQoJG1kVXRpbC5nZXRDbG9zZXN0KGVsZW1lbnRbMF0sICdmb3JtJykpO1xyXG4gICAgICAgICAgaWYgKGZvcm0ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3JtLnRyaWdnZXJIYW5kbGVyKCdzdWJtaXQnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmdDdHJsLmluaXQobmdNb2RlbEN0cmwpO1xyXG5cclxuICAgIHNjb3BlLm1vdXNlQWN0aXZlID0gZmFsc2U7XHJcbiAgICBlbGVtZW50LmF0dHIoe1xyXG4gICAgICAgICAgICAgICdyb2xlJzogJ3JhZGlvZ3JvdXAnLFxyXG4gICAgICAgICAgICAgICd0YWJJbmRleCc6IGVsZW1lbnQuYXR0cigndGFiaW5kZXgnKSB8fCAnMCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm9uKCdrZXlkb3duJywga2V5ZG93bkxpc3RlbmVyKVxyXG4gICAgICAgICAgICAub24oJ21vdXNlZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgc2NvcGUubW91c2VBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgaWYoc2NvcGUubW91c2VBY3RpdmUgPT09IGZhbHNlKSB7IHJnQ3RybC4kZWxlbWVudC5hZGRDbGFzcygnbWQtZm9jdXNlZCcpOyB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5vbignYmx1cicsIGZ1bmN0aW9uKCkgeyByZ0N0cmwuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWZvY3VzZWQnKTsgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBSYWRpb0dyb3VwQ29udHJvbGxlcigkZWxlbWVudCkge1xyXG4gICAgdGhpcy5fcmFkaW9CdXR0b25SZW5kZXJGbnMgPSBbXTtcclxuICAgIHRoaXMuJGVsZW1lbnQgPSAkZWxlbWVudDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZVJhZGlvR3JvdXBDb250cm9sbGVyUHJvdG8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpbml0OiBmdW5jdGlvbihuZ01vZGVsQ3RybCkge1xyXG4gICAgICAgIHRoaXMuX25nTW9kZWxDdHJsID0gbmdNb2RlbEN0cmw7XHJcbiAgICAgICAgdGhpcy5fbmdNb2RlbEN0cmwuJHJlbmRlciA9IGFuZ3VsYXIuYmluZCh0aGlzLCB0aGlzLnJlbmRlcik7XHJcbiAgICAgIH0sXHJcbiAgICAgIGFkZDogZnVuY3Rpb24ocmJSZW5kZXIpIHtcclxuICAgICAgICB0aGlzLl9yYWRpb0J1dHRvblJlbmRlckZucy5wdXNoKHJiUmVuZGVyKTtcclxuICAgICAgfSxcclxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbihyYlJlbmRlcikge1xyXG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX3JhZGlvQnV0dG9uUmVuZGVyRm5zLmluZGV4T2YocmJSZW5kZXIpO1xyXG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcclxuICAgICAgICAgIHRoaXMuX3JhZGlvQnV0dG9uUmVuZGVyRm5zLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX3JhZGlvQnV0dG9uUmVuZGVyRm5zLmZvckVhY2goZnVuY3Rpb24ocmJSZW5kZXIpIHtcclxuICAgICAgICAgIHJiUmVuZGVyKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldFZpZXdWYWx1ZTogZnVuY3Rpb24odmFsdWUsIGV2ZW50VHlwZSkge1xyXG4gICAgICAgIHRoaXMuX25nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUodmFsdWUsIGV2ZW50VHlwZSk7XHJcbiAgICAgICAgLy8gdXBkYXRlIHRoZSBvdGhlciByYWRpbyBidXR0b25zIGFzIHdlbGxcclxuICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICB9LFxyXG4gICAgICBnZXRWaWV3VmFsdWU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9uZ01vZGVsQ3RybC4kdmlld1ZhbHVlO1xyXG4gICAgICB9LFxyXG4gICAgICBzZWxlY3ROZXh0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gY2hhbmdlU2VsZWN0ZWRCdXR0b24odGhpcy4kZWxlbWVudCwgMSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNlbGVjdFByZXZpb3VzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gY2hhbmdlU2VsZWN0ZWRCdXR0b24odGhpcy4kZWxlbWVudCwgLTEpO1xyXG4gICAgICB9LFxyXG4gICAgICBzZXRBY3RpdmVEZXNjZW5kYW50OiBmdW5jdGlvbiAocmFkaW9JZCkge1xyXG4gICAgICAgIHRoaXMuJGVsZW1lbnQuYXR0cignYXJpYS1hY3RpdmVkZXNjZW5kYW50JywgcmFkaW9JZCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIENoYW5nZSB0aGUgcmFkaW8gZ3JvdXAncyBzZWxlY3RlZCBidXR0b24gYnkgYSBnaXZlbiBpbmNyZW1lbnQuXHJcbiAgICogSWYgbm8gYnV0dG9uIGlzIHNlbGVjdGVkLCBzZWxlY3QgdGhlIGZpcnN0IGJ1dHRvbi5cclxuICAgKi9cclxuICBmdW5jdGlvbiBjaGFuZ2VTZWxlY3RlZEJ1dHRvbihwYXJlbnQsIGluY3JlbWVudCkge1xyXG4gICAgLy8gQ29lcmNlIGFsbCBjaGlsZCByYWRpbyBidXR0b25zIGludG8gYW4gYXJyYXksIHRoZW4gd3JhcCB0aGVuIGluIGFuIGl0ZXJhdG9yXHJcbiAgICB2YXIgYnV0dG9ucyA9ICRtZFV0aWwuaXRlcmF0b3IocGFyZW50WzBdLnF1ZXJ5U2VsZWN0b3JBbGwoJ21kLXJhZGlvLWJ1dHRvbicpLCB0cnVlKTtcclxuXHJcbiAgICBpZiAoYnV0dG9ucy5jb3VudCgpKSB7XHJcbiAgICAgIHZhciB2YWxpZGF0ZSA9IGZ1bmN0aW9uIChidXR0b24pIHtcclxuICAgICAgICAvLyBJZiBkaXNhYmxlZCwgdGhlbiBOT1QgdmFsaWRcclxuICAgICAgICByZXR1cm4gIWFuZ3VsYXIuZWxlbWVudChidXR0b24pLmF0dHIoXCJkaXNhYmxlZFwiKTtcclxuICAgICAgfTtcclxuICAgICAgdmFyIHNlbGVjdGVkID0gcGFyZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJ21kLXJhZGlvLWJ1dHRvbi5tZC1jaGVja2VkJyk7XHJcbiAgICAgIHZhciB0YXJnZXQgPSBidXR0b25zW2luY3JlbWVudCA8IDAgPyAncHJldmlvdXMnIDogJ25leHQnXShzZWxlY3RlZCwgdmFsaWRhdGUpIHx8IGJ1dHRvbnMuZmlyc3QoKTtcclxuICAgICAgLy8gQWN0aXZhdGUgcmFkaW9CdXR0b24ncyBjbGljayBsaXN0ZW5lciAodHJpZ2dlckhhbmRsZXIgd29uJ3QgY3JlYXRlIGEgcmVhbCBjbGljayBldmVudClcclxuICAgICAgYW5ndWxhci5lbGVtZW50KHRhcmdldCkudHJpZ2dlckhhbmRsZXIoJ2NsaWNrJyk7XHJcblxyXG5cclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcbm1kUmFkaW9Hcm91cERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kVXRpbFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJG1kVGhlbWluZ1wiLCBcIiR0aW1lb3V0XCJdO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnJhZGlvQnV0dG9uXHJcbiAqIEBuYW1lIG1kUmFkaW9CdXR0b25cclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLXJhZGlvLWJ1dHRvbj5gZGlyZWN0aXZlIGlzIHRoZSBjaGlsZCBkaXJlY3RpdmUgcmVxdWlyZWQgdG8gYmUgdXNlZCB3aXRoaW4gYDxtZC1yYWRpby1ncm91cD5gIGVsZW1lbnRzLlxyXG4gKlxyXG4gKiBXaGlsZSBzaW1pbGFyIHRvIHRoZSBgPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5nLW1vZGVsPVwiXCIgdmFsdWU9XCJcIj5gIGRpcmVjdGl2ZSxcclxuICogdGhlIGA8bWQtcmFkaW8tYnV0dG9uPmAgZGlyZWN0aXZlIHByb3ZpZGVzIGluayBlZmZlY3RzLCBBUklBIHN1cHBvcnQsIGFuZFxyXG4gKiBzdXBwb3J0cyB1c2Ugd2l0aGluIG5hbWVkIHJhZGlvIGdyb3Vwcy5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IG5nTW9kZWwgQXNzaWduYWJsZSBhbmd1bGFyIGV4cHJlc3Npb24gdG8gZGF0YS1iaW5kIHRvLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nQ2hhbmdlIEFuZ3VsYXIgZXhwcmVzc2lvbiB0byBiZSBleGVjdXRlZCB3aGVuIGlucHV0IGNoYW5nZXMgZHVlIHRvIHVzZXJcclxuICogICAgaW50ZXJhY3Rpb24gd2l0aCB0aGUgaW5wdXQgZWxlbWVudC5cclxuICogQHBhcmFtIHtzdHJpbmd9IG5nVmFsdWUgQW5ndWxhciBleHByZXNzaW9uIHdoaWNoIHNldHMgdGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBleHByZXNzaW9uIHNob3VsZFxyXG4gKiAgICBiZSBzZXQgd2hlbiBzZWxlY3RlZC4qXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSBUaGUgdmFsdWUgdG8gd2hpY2ggdGhlIGV4cHJlc3Npb24gc2hvdWxkIGJlIHNldCB3aGVuIHNlbGVjdGVkLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG5hbWUgUHJvcGVydHkgbmFtZSBvZiB0aGUgZm9ybSB1bmRlciB3aGljaCB0aGUgY29udHJvbCBpcyBwdWJsaXNoZWQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gYXJpYS1sYWJlbCBBZGRzIGxhYmVsIHRvIHJhZGlvIGJ1dHRvbiBmb3IgYWNjZXNzaWJpbGl0eS5cclxuICogRGVmYXVsdHMgdG8gcmFkaW8gYnV0dG9uJ3MgdGV4dC4gSWYgbm8gdGV4dCBjb250ZW50IGlzIGF2YWlsYWJsZSwgYSB3YXJuaW5nIHdpbGwgYmUgbG9nZ2VkLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICpcclxuICogPG1kLXJhZGlvLWJ1dHRvbiB2YWx1ZT1cIjFcIiBhcmlhLWxhYmVsPVwiTGFiZWwgMVwiPlxyXG4gKiAgIExhYmVsIDFcclxuICogPC9tZC1yYWRpby1idXR0b24+XHJcbiAqXHJcbiAqIDxtZC1yYWRpby1idXR0b24gbmctbW9kZWw9XCJjb2xvclwiIG5nLXZhbHVlPVwic3BlY2lhbFZhbHVlXCIgYXJpYS1sYWJlbD1cIkdyZWVuXCI+XHJcbiAqICAgR3JlZW5cclxuICogPC9tZC1yYWRpby1idXR0b24+XHJcbiAqXHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uIG1kUmFkaW9CdXR0b25EaXJlY3RpdmUoJG1kQXJpYSwgJG1kVXRpbCwgJG1kVGhlbWluZykge1xyXG5cclxuICB2YXIgQ0hFQ0tFRF9DU1MgPSAnbWQtY2hlY2tlZCc7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcmVxdWlyZTogJ15tZFJhZGlvR3JvdXAnLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cIm1kLWNvbnRhaW5lclwiIG1kLWluay1yaXBwbGUgbWQtaW5rLXJpcHBsZS1jaGVja2JveD4nICtcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWQtb2ZmXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLW9uXCI+PC9kaXY+JyArXHJcbiAgICAgICAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAgICAgICAgICc8ZGl2IG5nLXRyYW5zY2x1ZGUgY2xhc3M9XCJtZC1sYWJlbFwiPjwvZGl2PicsXHJcbiAgICBsaW5rOiBsaW5rXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgcmdDdHJsKSB7XHJcbiAgICB2YXIgbGFzdENoZWNrZWQ7XHJcblxyXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuICAgIGNvbmZpZ3VyZUFyaWEoZWxlbWVudCwgc2NvcGUpO1xyXG5cclxuICAgIHJnQ3RybC5hZGQocmVuZGVyKTtcclxuICAgIGF0dHIuJG9ic2VydmUoJ3ZhbHVlJywgcmVuZGVyKTtcclxuXHJcbiAgICBlbGVtZW50XHJcbiAgICAgIC5vbignY2xpY2snLCBsaXN0ZW5lcilcclxuICAgICAgLm9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJnQ3RybC5yZW1vdmUocmVuZGVyKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gbGlzdGVuZXIoZXYpIHtcclxuICAgICAgaWYgKGVsZW1lbnRbMF0uaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSByZXR1cm47XHJcblxyXG4gICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmdDdHJsLnNldFZpZXdWYWx1ZShhdHRyLnZhbHVlLCBldiAmJiBldi50eXBlKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVuZGVyKCkge1xyXG4gICAgICB2YXIgY2hlY2tlZCA9IChyZ0N0cmwuZ2V0Vmlld1ZhbHVlKCkgPT0gYXR0ci52YWx1ZSk7XHJcbiAgICAgIGlmIChjaGVja2VkID09PSBsYXN0Q2hlY2tlZCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBsYXN0Q2hlY2tlZCA9IGNoZWNrZWQ7XHJcbiAgICAgIGVsZW1lbnQuYXR0cignYXJpYS1jaGVja2VkJywgY2hlY2tlZCk7XHJcbiAgICAgIGlmIChjaGVja2VkKSB7XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcyhDSEVDS0VEX0NTUyk7XHJcbiAgICAgICAgcmdDdHJsLnNldEFjdGl2ZURlc2NlbmRhbnQoZWxlbWVudC5hdHRyKCdpZCcpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKENIRUNLRURfQ1NTKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbmplY3QgQVJJQS1zcGVjaWZpYyBhdHRyaWJ1dGVzIGFwcHJvcHJpYXRlIGZvciBlYWNoIHJhZGlvIGJ1dHRvblxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjb25maWd1cmVBcmlhKCBlbGVtZW50LCBzY29wZSApe1xyXG4gICAgICBzY29wZS5hcmlhSWQgPSBidWlsZEFyaWFJRCgpO1xyXG5cclxuICAgICAgZWxlbWVudC5hdHRyKHtcclxuICAgICAgICAnaWQnIDogIHNjb3BlLmFyaWFJZCxcclxuICAgICAgICAncm9sZScgOiAncmFkaW8nLFxyXG4gICAgICAgICdhcmlhLWNoZWNrZWQnIDogJ2ZhbHNlJ1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgICRtZEFyaWEuZXhwZWN0V2l0aFRleHQoZWxlbWVudCwgJ2FyaWEtbGFiZWwnKTtcclxuXHJcbiAgICAgIC8qKlxyXG4gICAgICAgKiBCdWlsZCBhIHVuaXF1ZSBJRCBmb3IgZWFjaCByYWRpbyBidXR0b24gdGhhdCB3aWxsIGJlIHVzZWQgd2l0aCBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQuXHJcbiAgICAgICAqIFByZXNlcnZlIGV4aXN0aW5nIElEIGlmIGFscmVhZHkgc3BlY2lmaWVkLlxyXG4gICAgICAgKiBAcmV0dXJucyB7KnxzdHJpbmd9XHJcbiAgICAgICAqL1xyXG4gICAgICBmdW5jdGlvbiBidWlsZEFyaWFJRCgpIHtcclxuICAgICAgICByZXR1cm4gYXR0ci5pZCB8fCAoICdyYWRpbycgKyBcIl9cIiArICRtZFV0aWwubmV4dFVpZCgpICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxubWRSYWRpb0J1dHRvbkRpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kQXJpYVwiLCBcIiRtZFV0aWxcIiwgXCIkbWRUaGVtaW5nXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5zZWxlY3RcclxuICovXHJcblxyXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcblxyXG4jIyMgVE9ETyAjIyNcclxuKipET0NVTUVOVEFUSU9OIEFORCBERU1PUyoqXHJcblxyXG4tIFsgXSBuZy1tb2RlbCB3aXRoIGNoaWxkIG1kT3B0aW9ucyAoYmFzaWMpXHJcbi0gWyBdIG5nLW1vZGVsPVwiZm9vXCIgbmctbW9kZWwtb3B0aW9ucz1cInsgdHJhY2tCeTogJyR2YWx1ZS5pZCcgfVwiIGZvciBvYmplY3RzXHJcbi0gWyBdIG1kT3B0aW9uIHdpdGggdmFsdWVcclxuLSBbIF0gVXNhZ2Ugd2l0aCBpbnB1dCBpbnNpZGVcclxuXHJcbiMjIyBUT0RPIC0gUE9TVCBSQzEgIyMjXHJcbi0gWyBdIEFic3RyYWN0IHBsYWNlbWVudCBsb2dpYyBpbiAkbWRTZWxlY3Qgc2VydmljZSB0byAkbWRNZW51IHNlcnZpY2VcclxuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cclxuXHJcbnZhciBTRUxFQ1RfRURHRV9NQVJHSU4gPSA4O1xyXG52YXIgc2VsZWN0TmV4dElkID0gMDtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnNlbGVjdCcsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuYmFja2Ryb3AnXHJcbl0pXHJcbi5kaXJlY3RpdmUoJ21kU2VsZWN0JywgU2VsZWN0RGlyZWN0aXZlKVxyXG4uZGlyZWN0aXZlKCdtZFNlbGVjdE1lbnUnLCBTZWxlY3RNZW51RGlyZWN0aXZlKVxyXG4uZGlyZWN0aXZlKCdtZE9wdGlvbicsIE9wdGlvbkRpcmVjdGl2ZSlcclxuLmRpcmVjdGl2ZSgnbWRPcHRncm91cCcsIE9wdGdyb3VwRGlyZWN0aXZlKVxyXG4ucHJvdmlkZXIoJyRtZFNlbGVjdCcsIFNlbGVjdFByb3ZpZGVyKTtcclxuXHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZFNlbGVjdFxyXG4gKiBAcmVzdHJpY3QgRVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuc2VsZWN0XHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvbiBEaXNwbGF5cyBhIHNlbGVjdCBib3gsIGJvdW5kIHRvIGFuIG5nLW1vZGVsLlxyXG4gKlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb259IG5nLW1vZGVsIFRoZSBtb2RlbCFcclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtb24tY2xvc2UgZXhwcmVzc2lvbiB0byBiZSBldmFsdWF0ZWQgd2hlbiB0aGUgc2VsZWN0IGlzIGNsb3NlZFxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtdWx0aXBsZSBXaGV0aGVyIGl0J3MgbXVsdGlwbGUuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gcGxhY2Vob2xkZXIgUGxhY2Vob2xkZXIgaGludCB0ZXh0LlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgT3B0aW9uYWwgbGFiZWwgZm9yIGFjY2Vzc2liaWxpdHkuIE9ubHkgbmVjZXNzYXJ5IGlmIG5vIHBsYWNlaG9sZGVyIG9yXHJcbiAqIGV4cGxpY2l0IGxhYmVsIGlzIHByZXNlbnQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiBXaXRoIGEgcGxhY2Vob2xkZXIgKGxhYmVsIGFuZCBhcmlhLWxhYmVsIGFyZSBhZGRlZCBkeW5hbWljYWxseSlcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogICA8bWQtc2VsZWN0XHJcbiAqICAgICBuZy1tb2RlbD1cInNvbWVNb2RlbFwiXHJcbiAqICAgICBwbGFjZWhvbGRlcj1cIlNlbGVjdCBhIHN0YXRlXCI+XHJcbiAqICAgICA8bWQtb3B0aW9uIG5nLXZhbHVlPVwib3B0XCIgbmctcmVwZWF0PVwib3B0IGluIG5laWdoYm9yaG9vZHMyXCI+e3sgb3B0IH19PC9tZC1vcHRpb24+XHJcbiAqICAgPC9tZC1zZWxlY3Q+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogV2l0aCBhbiBleHBsaWNpdCBsYWJlbFxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgIDxtZC1zZWxlY3RcclxuICogICAgIG5nLW1vZGVsPVwic29tZU1vZGVsXCI+XHJcbiAqICAgICA8bWQtc2VsZWN0LWxhYmVsPlNlbGVjdCBhIHN0YXRlPC9tZC1zZWxlY3QtbGFiZWw+XHJcbiAqICAgICA8bWQtb3B0aW9uIG5nLXZhbHVlPVwib3B0XCIgbmctcmVwZWF0PVwib3B0IGluIG5laWdoYm9yaG9vZHMyXCI+e3sgb3B0IH19PC9tZC1vcHRpb24+XHJcbiAqICAgPC9tZC1zZWxlY3Q+XHJcbiAqIDwvaGxqcz5cclxuICovXHJcbmZ1bmN0aW9uIFNlbGVjdERpcmVjdGl2ZSgkbWRTZWxlY3QsICRtZFV0aWwsICRtZFRoZW1pbmcsICRtZEFyaWEsICRpbnRlcnBvbGF0ZSwgJGNvbXBpbGUsICRwYXJzZSkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcmVxdWlyZTogWydtZFNlbGVjdCcsICduZ01vZGVsJywgJz9eZm9ybSddLFxyXG4gICAgY29tcGlsZTogY29tcGlsZSxcclxuICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCkgeyB9IC8vIGVtcHR5IHBsYWNlaG9sZGVyIGNvbnRyb2xsZXIgdG8gYmUgaW5pdGlhbGl6ZWQgaW4gbGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbWVudCwgYXR0cikge1xyXG4gICAgLy8gVGhlIHVzZXIgaXMgYWxsb3dlZCB0byBwcm92aWRlIGEgbGFiZWwgZm9yIHRoZSBzZWxlY3QgYXMgbWQtc2VsZWN0LWxhYmVsIGNoaWxkXHJcbiAgICB2YXIgbGFiZWxFbCA9IGVsZW1lbnQuZmluZCgnbWQtc2VsZWN0LWxhYmVsJykucmVtb3ZlKCk7XHJcblxyXG4gICAgLy8gSWYgbm90IHByb3ZpZGVkLCB3ZSBhdXRvbWF0aWNhbGx5IG1ha2Ugb25lXHJcbiAgICBpZiAoIWxhYmVsRWwubGVuZ3RoKSB7XHJcbiAgICAgIGxhYmVsRWwgPSBhbmd1bGFyLmVsZW1lbnQoJzxtZC1zZWxlY3QtbGFiZWw+PHNwYW4+PC9zcGFuPjwvbWQtc2VsZWN0LWxhYmVsPicpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKCFsYWJlbEVsWzBdLmZpcnN0RWxlbWVudENoaWxkKSB7XHJcbiAgICAgICAgdmFyIHNwYW5XcmFwcGVyID0gYW5ndWxhci5lbGVtZW50KCc8c3Bhbj4nKTtcclxuICAgICAgICBzcGFuV3JhcHBlci5hcHBlbmQobGFiZWxFbC5jb250ZW50cygpKTtcclxuICAgICAgICBsYWJlbEVsLmFwcGVuZChzcGFuV3JhcHBlcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGxhYmVsRWwuYXBwZW5kKCc8c3BhbiBjbGFzcz1cIm1kLXNlbGVjdC1pY29uXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9zcGFuPicpO1xyXG4gICAgbGFiZWxFbC5hZGRDbGFzcygnbWQtc2VsZWN0LWxhYmVsJyk7XHJcbiAgICBpZiAoIWxhYmVsRWxbMF0uaGFzQXR0cmlidXRlKCdpZCcpKSB7XHJcbiAgICAgIGxhYmVsRWwuYXR0cignaWQnLCAnc2VsZWN0X2xhYmVsXycgKyAkbWRVdGlsLm5leHRVaWQoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVGhlcmUncyBnb3QgdG8gYmUgYW4gbWQtY29udGVudCBpbnNpZGUuIElmIHRoZXJlJ3Mgbm90IG9uZSwgbGV0J3MgYWRkIGl0LlxyXG4gICAgaWYgKCFlbGVtZW50LmZpbmQoJ21kLWNvbnRlbnQnKS5sZW5ndGgpIHtcclxuICAgICAgZWxlbWVudC5hcHBlbmQoIGFuZ3VsYXIuZWxlbWVudCgnPG1kLWNvbnRlbnQ+JykuYXBwZW5kKGVsZW1lbnQuY29udGVudHMoKSkgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBZGQgcHJvZ3Jlc3Mgc3Bpbm5lciBmb3IgbWQtb3B0aW9ucy1sb2FkaW5nXHJcbiAgICBpZiAoYXR0ci5tZE9uT3Blbikge1xyXG4gICAgICBlbGVtZW50LmZpbmQoJ21kLWNvbnRlbnQnKS5wcmVwZW5kKFxyXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnPG1kLXByb2dyZXNzLWNpcmN1bGFyPicpXHJcbiAgICAgICAgICAgICAgIC5hdHRyKCdtZC1tb2RlJywgJ2luZGV0ZXJtaW5hdGUnKVxyXG4gICAgICAgICAgICAgICAuYXR0cignbmctaGlkZScsICckJGxvYWRpbmdBc3luY0RvbmUnKVxyXG4gICAgICAgICAgICAgICAud3JhcCgnPGRpdj4nKVxyXG4gICAgICAgICAgICAgICAucGFyZW50KClcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoYXR0ci5uYW1lKSB7XHJcbiAgICAgIHZhciBhdXRvZmlsbENsb25lID0gYW5ndWxhci5lbGVtZW50KCc8c2VsZWN0IGNsYXNzPVwibWQtdmlzdWFsbHktaGlkZGVuXCI+Jyk7XHJcbiAgICAgIGF1dG9maWxsQ2xvbmUuYXR0cih7XHJcbiAgICAgICAgJ25hbWUnOiAnLicgKyBhdHRyLm5hbWUsXHJcbiAgICAgICAgJ25nLW1vZGVsJzogYXR0ci5uZ01vZGVsLFxyXG4gICAgICAgICdhcmlhLWhpZGRlbic6ICd0cnVlJyxcclxuICAgICAgICAndGFiaW5kZXgnOiAnLTEnXHJcbiAgICAgIH0pO1xyXG4gICAgICB2YXIgb3B0cyA9IGVsZW1lbnQuZmluZCgnbWQtb3B0aW9uJyk7XHJcbiAgICAgIGFuZ3VsYXIuZm9yRWFjaChvcHRzLCBmdW5jdGlvbihlbCkge1xyXG4gICAgICAgIHZhciBuZXdFbCA9IGFuZ3VsYXIuZWxlbWVudCgnPG9wdGlvbj4nICsgZWwuaW5uZXJIVE1MICsgJzwvb3B0aW9uPicpO1xyXG4gICAgICAgIGlmIChlbC5oYXNBdHRyaWJ1dGUoJ25nLXZhbHVlJykpIG5ld0VsLmF0dHIoJ25nLXZhbHVlJywgZWwuZ2V0QXR0cmlidXRlKCduZy12YWx1ZScpKTtcclxuICAgICAgICBlbHNlIGlmIChlbC5oYXNBdHRyaWJ1dGUoJ3ZhbHVlJykpIG5ld0VsLmF0dHIoJ3ZhbHVlJywgZWwuZ2V0QXR0cmlidXRlKCd2YWx1ZScpKTtcclxuICAgICAgICBhdXRvZmlsbENsb25lLmFwcGVuZChuZXdFbCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZWxlbWVudC5wYXJlbnQoKS5hcHBlbmQoYXV0b2ZpbGxDbG9uZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXNlIGV2ZXJ5dGhpbmcgdGhhdCdzIGxlZnQgaW5zaWRlIGVsZW1lbnQuY29udGVudHMoKSBhcyB0aGUgY29udGVudHMgb2YgdGhlIG1lbnVcclxuICAgIHZhciBzZWxlY3RUZW1wbGF0ZSA9ICc8ZGl2IGNsYXNzPVwibWQtc2VsZWN0LW1lbnUtY29udGFpbmVyXCI+JyArXHJcbiAgICAgICAgJzxtZC1zZWxlY3QtbWVudSAnICtcclxuICAgICAgICAoYW5ndWxhci5pc0RlZmluZWQoYXR0ci5tdWx0aXBsZSkgPyAnbXVsdGlwbGUnIDogJycpICsgJz4nICtcclxuICAgICAgICAgIGVsZW1lbnQuaHRtbCgpICtcclxuICAgICAgICAnPC9tZC1zZWxlY3QtbWVudT48L2Rpdj4nO1xyXG5cclxuICAgIGVsZW1lbnQuZW1wdHkoKS5hcHBlbmQobGFiZWxFbCk7XHJcblxyXG4gICAgYXR0ci50YWJpbmRleCA9IGF0dHIudGFiaW5kZXggfHwgJzAnO1xyXG5cclxuICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybHMpIHtcclxuICAgICAgdmFyIGlzT3BlbjtcclxuICAgICAgdmFyIGlzRGlzYWJsZWQ7XHJcblxyXG4gICAgICB2YXIgbWRTZWxlY3RDdHJsID0gY3RybHNbMF07XHJcbiAgICAgIHZhciBuZ01vZGVsID0gY3RybHNbMV07XHJcbiAgICAgIHZhciBmb3JtQ3RybCA9IGN0cmxzWzJdO1xyXG5cclxuICAgICAgdmFyIGxhYmVsRWwgPSBlbGVtZW50LmZpbmQoJ21kLXNlbGVjdC1sYWJlbCcpO1xyXG4gICAgICB2YXIgY3VzdG9tTGFiZWwgPSBsYWJlbEVsLnRleHQoKS5sZW5ndGggIT09IDA7XHJcbiAgICAgIHZhciBzZWxlY3RDb250YWluZXIsIHNlbGVjdFNjb3BlLCBzZWxlY3RNZW51Q3RybDtcclxuICAgICAgY3JlYXRlU2VsZWN0KCk7XHJcblxyXG4gICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG5cclxuICAgICAgaWYgKGF0dHIubmFtZSAmJiBmb3JtQ3RybCkge1xyXG4gICAgICAgIHZhciBzZWxlY3RFbCA9IGVsZW1lbnQucGFyZW50KClbMF0ucXVlcnlTZWxlY3Rvcignc2VsZWN0W25hbWU9XCIuJyArIGF0dHIubmFtZSArICdcIl0nKTtcclxuICAgICAgICBmb3JtQ3RybC4kcmVtb3ZlQ29udHJvbChhbmd1bGFyLmVsZW1lbnQoc2VsZWN0RWwpLmNvbnRyb2xsZXIoKSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBvcmlnaW5hbFJlbmRlciA9IG5nTW9kZWwuJHJlbmRlcjtcclxuICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgb3JpZ2luYWxSZW5kZXIoKTtcclxuICAgICAgICBzeW5jTGFiZWxUZXh0KCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBtZFNlbGVjdEN0cmwuc2V0TGFiZWxUZXh0ID0gZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgIGlmIChjdXN0b21MYWJlbCkgcmV0dXJuOyAvLyBBc3N1bWUgdGhhdCB1c2VyIGlzIGhhbmRsaW5nIGl0IG9uIHRoZWlyIG93blxyXG4gICAgICAgIG1kU2VsZWN0Q3RybC5zZXRJc1BsYWNlaG9sZGVyKCF0ZXh0KTtcclxuICAgICAgICB0ZXh0ID0gdGV4dCB8fCBhdHRyLnBsYWNlaG9sZGVyIHx8ICcnO1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSBjdXN0b21MYWJlbCA/IGxhYmVsRWwgOiBsYWJlbEVsLmNoaWxkcmVuKCkuZXEoMCk7XHJcbiAgICAgICAgdGFyZ2V0LnRleHQodGV4dCk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBtZFNlbGVjdEN0cmwuc2V0SXNQbGFjZWhvbGRlciA9IGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgIHZhbCA/IGxhYmVsRWwuYWRkQ2xhc3MoJ21kLXBsYWNlaG9sZGVyJykgOiBsYWJlbEVsLnJlbW92ZUNsYXNzKCdtZC1wbGFjZWhvbGRlcicpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgbWRTZWxlY3RDdHJsLnRyaWdnZXJDbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRwYXJzZShhdHRyLm1kT25DbG9zZSkoc2NvcGUpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgc2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHNldEFyaWFMYWJlbCgpO1xyXG4gICAgICAgIHN5bmNMYWJlbFRleHQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBmdW5jdGlvbiBzZXRBcmlhTGFiZWwoKSB7XHJcbiAgICAgICAgdmFyIGxhYmVsVGV4dCA9IGVsZW1lbnQuYXR0cigncGxhY2Vob2xkZXInKTtcclxuICAgICAgICBpZiAoIWxhYmVsVGV4dCkge1xyXG4gICAgICAgICAgbGFiZWxUZXh0ID0gZWxlbWVudC5maW5kKCdtZC1zZWxlY3QtbGFiZWwnKS50ZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICRtZEFyaWEuZXhwZWN0KGVsZW1lbnQsICdhcmlhLWxhYmVsJywgbGFiZWxUZXh0KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gc3luY0xhYmVsVGV4dCgpIHtcclxuICAgICAgICBpZiAoc2VsZWN0Q29udGFpbmVyKSB7XHJcbiAgICAgICAgICBzZWxlY3RNZW51Q3RybCA9IHNlbGVjdE1lbnVDdHJsIHx8IHNlbGVjdENvbnRhaW5lci5maW5kKCdtZC1zZWxlY3QtbWVudScpLmNvbnRyb2xsZXIoJ21kU2VsZWN0TWVudScpO1xyXG4gICAgICAgICAgbWRTZWxlY3RDdHJsLnNldExhYmVsVGV4dChzZWxlY3RNZW51Q3RybC5zZWxlY3RlZExhYmVscygpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBkZXJlZ2lzdGVyV2F0Y2hlcjtcclxuICAgICAgYXR0ci4kb2JzZXJ2ZSgnbmdNdWx0aXBsZScsIGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgIGlmIChkZXJlZ2lzdGVyV2F0Y2hlcikgZGVyZWdpc3RlcldhdGNoZXIoKTtcclxuICAgICAgICB2YXIgcGFyc2VyID0gJHBhcnNlKHZhbCk7XHJcbiAgICAgICAgZGVyZWdpc3RlcldhdGNoZXIgPSBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBwYXJzZXIoc2NvcGUpOyB9LCBmdW5jdGlvbihtdWx0aXBsZSwgcHJldlZhbCkge1xyXG4gICAgICAgICAgaWYgKG11bHRpcGxlID09PSB1bmRlZmluZWQgJiYgcHJldlZhbCA9PT0gdW5kZWZpbmVkKSByZXR1cm47IC8vIGFzc3VtZSBjb21waWxlciBkaWQgYSBnb29kIGpvYlxyXG4gICAgICAgICAgaWYgKG11bHRpcGxlKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYXR0cignbXVsdGlwbGUnLCAnbXVsdGlwbGUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cignbXVsdGlwbGUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChzZWxlY3RDb250YWluZXIpIHtcclxuICAgICAgICAgICAgc2VsZWN0TWVudUN0cmwuc2V0TXVsdGlwbGUobXVsdGlwbGUpO1xyXG4gICAgICAgICAgICBvcmlnaW5hbFJlbmRlciA9IG5nTW9kZWwuJHJlbmRlcjtcclxuICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgb3JpZ2luYWxSZW5kZXIoKTtcclxuICAgICAgICAgICAgICBzeW5jTGFiZWxUZXh0KCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHNlbGVjdE1lbnVDdHJsLnJlZnJlc2hWaWV3VmFsdWUoKTtcclxuICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgYXR0ci4kb2JzZXJ2ZSgnZGlzYWJsZWQnLCBmdW5jdGlvbihkaXNhYmxlZCkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgZGlzYWJsZWQgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBQcmV2ZW50IGNsaWNrIGV2ZW50IGJlaW5nIHJlZ2lzdGVyZWQgdHdpY2VcclxuICAgICAgICBpZiAoaXNEaXNhYmxlZCAhPT0gdW5kZWZpbmVkICYmIGlzRGlzYWJsZWQgPT09IGRpc2FibGVkKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlzRGlzYWJsZWQgPSBkaXNhYmxlZDtcclxuICAgICAgICBpZiAoZGlzYWJsZWQpIHtcclxuICAgICAgICAgIGVsZW1lbnQuYXR0cih7J3RhYmluZGV4JzogLTEsICdhcmlhLWRpc2FibGVkJzogJ3RydWUnfSk7XHJcbiAgICAgICAgICBlbGVtZW50Lm9mZignY2xpY2snLCBvcGVuU2VsZWN0KTtcclxuICAgICAgICAgIGVsZW1lbnQub2ZmKCdrZXlkb3duJywgaGFuZGxlS2V5cHJlc3MpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBlbGVtZW50LmF0dHIoeyd0YWJpbmRleCc6IGF0dHIudGFiaW5kZXgsICdhcmlhLWRpc2FibGVkJzogJ2ZhbHNlJ30pO1xyXG4gICAgICAgICAgZWxlbWVudC5vbignY2xpY2snLCBvcGVuU2VsZWN0KTtcclxuICAgICAgICAgIGVsZW1lbnQub24oJ2tleWRvd24nLCBoYW5kbGVLZXlwcmVzcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmICghYXR0ci5kaXNhYmxlZCAmJiAhYXR0ci5uZ0Rpc2FibGVkKSB7XHJcbiAgICAgICAgZWxlbWVudC5hdHRyKHsndGFiaW5kZXgnOiBhdHRyLnRhYmluZGV4LCAnYXJpYS1kaXNhYmxlZCc6ICdmYWxzZSd9KTtcclxuICAgICAgICBlbGVtZW50Lm9uKCdjbGljaycsIG9wZW5TZWxlY3QpO1xyXG4gICAgICAgIGVsZW1lbnQub24oJ2tleWRvd24nLCBoYW5kbGVLZXlwcmVzcyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBhcmlhQXR0cnMgPSB7XHJcbiAgICAgICAgcm9sZTogJ2NvbWJvYm94JyxcclxuICAgICAgICAnYXJpYS1leHBhbmRlZCc6ICdmYWxzZSdcclxuICAgICAgfTtcclxuICAgICAgaWYgKCFlbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgnaWQnKSkge1xyXG4gICAgICAgIGFyaWFBdHRycy5pZCA9ICdzZWxlY3RfJyArICRtZFV0aWwubmV4dFVpZCgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsZW1lbnQuYXR0cihhcmlhQXR0cnMpO1xyXG5cclxuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChpc09wZW4pIHtcclxuICAgICAgICAgICRtZFNlbGVjdC5jYW5jZWwoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWxlY3RDb250YWluZXIucmVtb3ZlKCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgc2VsZWN0Q29udGFpbmVyLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgLy8gQ3JlYXRlIGEgZmFrZSBzZWxlY3QgdG8gZmluZCBvdXQgdGhlIGxhYmVsIHZhbHVlXHJcbiAgICAgIGZ1bmN0aW9uIGNyZWF0ZVNlbGVjdCgpIHtcclxuICAgICAgICBzZWxlY3RDb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoc2VsZWN0VGVtcGxhdGUpO1xyXG4gICAgICAgIHZhciBzZWxlY3RFbCA9IHNlbGVjdENvbnRhaW5lci5maW5kKCdtZC1zZWxlY3QtbWVudScpO1xyXG4gICAgICAgIHNlbGVjdEVsLmRhdGEoJyRuZ01vZGVsQ29udHJvbGxlcicsIG5nTW9kZWwpO1xyXG4gICAgICAgIHNlbGVjdEVsLmRhdGEoJyRtZFNlbGVjdENvbnRyb2xsZXInLCBtZFNlbGVjdEN0cmwpO1xyXG4gICAgICAgIHNlbGVjdFNjb3BlID0gc2NvcGUuJG5ldygpO1xyXG4gICAgICAgIHNlbGVjdENvbnRhaW5lciA9ICRjb21waWxlKHNlbGVjdENvbnRhaW5lcikoc2VsZWN0U2NvcGUpO1xyXG4gICAgICAgIHNlbGVjdE1lbnVDdHJsID0gc2VsZWN0Q29udGFpbmVyLmZpbmQoJ21kLXNlbGVjdC1tZW51JykuY29udHJvbGxlcignbWRTZWxlY3RNZW51Jyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGhhbmRsZUtleXByZXNzKGUpIHtcclxuICAgICAgICB2YXIgYWxsb3dlZENvZGVzID0gWzMyLCAxMywgMzgsIDQwXTtcclxuICAgICAgICBpZiAoYWxsb3dlZENvZGVzLmluZGV4T2YoZS5rZXlDb2RlKSAhPSAtMSApIHtcclxuICAgICAgICAgIC8vIHByZXZlbnQgcGFnZSBzY3JvbGxpbmcgb24gaW50ZXJhY3Rpb25cclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIG9wZW5TZWxlY3QoZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChlLmtleUNvZGUgPD0gOTAgJiYgZS5rZXlDb2RlID49IDMxKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdmFyIG5vZGUgPSBzZWxlY3RNZW51Q3RybC5vcHROb2RlRm9yS2V5Ym9hcmRTZWFyY2goZSk7XHJcbiAgICAgICAgICAgIGlmICghbm9kZSkgcmV0dXJuO1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9uQ3RybCA9IGFuZ3VsYXIuZWxlbWVudChub2RlKS5jb250cm9sbGVyKCdtZE9wdGlvbicpO1xyXG4gICAgICAgICAgICBpZiAoIXNlbGVjdE1lbnVDdHJsLmlzTXVsdGlwbGUpIHtcclxuICAgICAgICAgICAgICBzZWxlY3RNZW51Q3RybC5kZXNlbGVjdCggT2JqZWN0LmtleXMoc2VsZWN0TWVudUN0cmwuc2VsZWN0ZWQpWzBdICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2VsZWN0TWVudUN0cmwuc2VsZWN0KG9wdGlvbkN0cmwuaGFzaEtleSwgb3B0aW9uQ3RybC52YWx1ZSk7XHJcbiAgICAgICAgICAgIHNlbGVjdE1lbnVDdHJsLnJlZnJlc2hWaWV3VmFsdWUoKTtcclxuICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBvcGVuU2VsZWN0KCkge1xyXG4gICAgICAgIHNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpc09wZW4gPSB0cnVlO1xyXG4gICAgICAgICAgJG1kU2VsZWN0LnNob3coe1xyXG4gICAgICAgICAgICBzY29wZTogc2VsZWN0U2NvcGUsXHJcbiAgICAgICAgICAgIHByZXNlcnZlU2NvcGU6IHRydWUsXHJcbiAgICAgICAgICAgIHNraXBDb21waWxlOiB0cnVlLFxyXG4gICAgICAgICAgICBlbGVtZW50OiBzZWxlY3RDb250YWluZXIsXHJcbiAgICAgICAgICAgIHRhcmdldDogZWxlbWVudFswXSxcclxuICAgICAgICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXHJcbiAgICAgICAgICAgIGxvYWRpbmdBc3luYzogYXR0ci5tZE9uT3BlbiA/IHNjb3BlLiRldmFsKGF0dHIubWRPbk9wZW4pIHx8IHRydWUgOiBmYWxzZSxcclxuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oc2VsZWN0ZWRUZXh0KSB7XHJcbiAgICAgICAgICAgIGlzT3BlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfVxyXG59XHJcblNlbGVjdERpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJG1kU2VsZWN0XCIsIFwiJG1kVXRpbFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkbWRBcmlhXCIsIFwiJGludGVycG9sYXRlXCIsIFwiJGNvbXBpbGVcIiwgXCIkcGFyc2VcIl07XHJcblxyXG5mdW5jdGlvbiBTZWxlY3RNZW51RGlyZWN0aXZlKCRwYXJzZSwgJG1kVXRpbCwgJG1kVGhlbWluZykge1xyXG5cclxuICBTZWxlY3RNZW51Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGF0dHJzXCIsIFwiJGVsZW1lbnRcIl07XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICByZXF1aXJlOiBbJ21kU2VsZWN0TWVudScsICc/bmdNb2RlbCddLFxyXG4gICAgY29udHJvbGxlcjogU2VsZWN0TWVudUNvbnRyb2xsZXIsXHJcbiAgICBsaW5rOiB7IHByZTogcHJlTGluayB9XHJcbiAgfTtcclxuXHJcbiAgLy8gV2UgdXNlIHByZUxpbmsgaW5zdGVhZCBvZiBwb3N0TGluayB0byBlbnN1cmUgdGhhdCB0aGUgc2VsZWN0IGlzIGluaXRpYWxpemVkIGJlZm9yZVxyXG4gIC8vIGl0cyBjaGlsZCBvcHRpb25zIHJ1biBwb3N0TGluay5cclxuICBmdW5jdGlvbiBwcmVMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xyXG4gICAgdmFyIHNlbGVjdEN0cmwgPSBjdHJsc1swXTtcclxuICAgIHZhciBuZ01vZGVsID0gY3RybHNbMV07XHJcblxyXG4gICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuICAgIGVsZW1lbnQub24oJ2NsaWNrJywgY2xpY2tMaXN0ZW5lcik7XHJcbiAgICBlbGVtZW50Lm9uKCdrZXlwcmVzcycsIGtleUxpc3RlbmVyKTtcclxuICAgIGlmIChuZ01vZGVsKSBzZWxlY3RDdHJsLmluaXQobmdNb2RlbCk7XHJcbiAgICBjb25maWd1cmVBcmlhKCk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29uZmlndXJlQXJpYSgpIHtcclxuICAgICAgZWxlbWVudC5hdHRyKHtcclxuICAgICAgICAnaWQnOiAnc2VsZWN0X21lbnVfJyArICRtZFV0aWwubmV4dFVpZCgpLFxyXG4gICAgICAgICdyb2xlJzogJ2xpc3Rib3gnLFxyXG4gICAgICAgICdhcmlhLW11bHRpc2VsZWN0YWJsZSc6IChzZWxlY3RDdHJsLmlzTXVsdGlwbGUgPyAndHJ1ZScgOiAnZmFsc2UnKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBrZXlMaXN0ZW5lcihlKSB7XHJcbiAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMgfHwgZS5rZXlDb2RlID09IDMyKSB7XHJcbiAgICAgICAgY2xpY2tMaXN0ZW5lcihlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNsaWNrTGlzdGVuZXIoZXYpIHtcclxuICAgICAgdmFyIG9wdGlvbiA9ICRtZFV0aWwuZ2V0Q2xvc2VzdChldi50YXJnZXQsICdtZC1vcHRpb24nKTtcclxuICAgICAgdmFyIG9wdGlvbkN0cmwgPSBvcHRpb24gJiYgYW5ndWxhci5lbGVtZW50KG9wdGlvbikuZGF0YSgnJG1kT3B0aW9uQ29udHJvbGxlcicpO1xyXG4gICAgICBpZiAoIW9wdGlvbiB8fCAhb3B0aW9uQ3RybCkgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIG9wdGlvbkhhc2hLZXkgPSBzZWxlY3RDdHJsLmhhc2hHZXR0ZXIob3B0aW9uQ3RybC52YWx1ZSk7XHJcbiAgICAgIHZhciBpc1NlbGVjdGVkID0gYW5ndWxhci5pc0RlZmluZWQoc2VsZWN0Q3RybC5zZWxlY3RlZFtvcHRpb25IYXNoS2V5XSk7XHJcblxyXG4gICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHNlbGVjdEN0cmwuaXNNdWx0aXBsZSkge1xyXG4gICAgICAgICAgaWYgKGlzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgc2VsZWN0Q3RybC5kZXNlbGVjdChvcHRpb25IYXNoS2V5KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGVjdEN0cmwuc2VsZWN0KG9wdGlvbkhhc2hLZXksIG9wdGlvbkN0cmwudmFsdWUpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoIWlzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgc2VsZWN0Q3RybC5kZXNlbGVjdCggT2JqZWN0LmtleXMoc2VsZWN0Q3RybC5zZWxlY3RlZClbMF0gKTtcclxuICAgICAgICAgICAgc2VsZWN0Q3RybC5zZWxlY3QoIG9wdGlvbkhhc2hLZXksIG9wdGlvbkN0cmwudmFsdWUgKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZWN0Q3RybC5yZWZyZXNoVmlld1ZhbHVlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuICBmdW5jdGlvbiBTZWxlY3RNZW51Q29udHJvbGxlcigkc2NvcGUsICRhdHRycywgJGVsZW1lbnQpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuaXNNdWx0aXBsZSA9IGFuZ3VsYXIuaXNEZWZpbmVkKCRhdHRycy5tdWx0aXBsZSk7XHJcbiAgICAvLyBzZWxlY3RlZCBpcyBhbiBvYmplY3Qgd2l0aCBrZXlzIG1hdGNoaW5nIGFsbCBvZiB0aGUgc2VsZWN0ZWQgb3B0aW9ucycgaGFzaGVkIHZhbHVlc1xyXG4gICAgc2VsZi5zZWxlY3RlZCA9IHt9O1xyXG4gICAgLy8gb3B0aW9ucyBpcyBhbiBvYmplY3Qgd2l0aCBrZXlzIG1hdGNoaW5nIGV2ZXJ5IG9wdGlvbidzIGhhc2ggdmFsdWUsXHJcbiAgICAvLyBhbmQgdmFsdWVzIG1hdGNoaW5nIGV2ZXJ5IG9wdGlvbidzIGNvbnRyb2xsZXIuXHJcbiAgICBzZWxmLm9wdGlvbnMgPSB7fTtcclxuXHJcbiAgICAkc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkgeyByZXR1cm4gc2VsZi5vcHRpb25zOyB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgc2VsZi5uZ01vZGVsLiRyZW5kZXIoKTtcclxuICAgIH0sIHRydWUpO1xyXG5cclxuICAgIHZhciBkZXJlZ2lzdGVyQ29sbGVjdGlvbldhdGNoO1xyXG4gICAgc2VsZi5zZXRNdWx0aXBsZSA9IGZ1bmN0aW9uKGlzTXVsdGlwbGUpIHtcclxuICAgICAgdmFyIG5nTW9kZWwgPSBzZWxmLm5nTW9kZWw7XHJcbiAgICAgIHNlbGYuaXNNdWx0aXBsZSA9IGlzTXVsdGlwbGU7XHJcbiAgICAgIGlmIChkZXJlZ2lzdGVyQ29sbGVjdGlvbldhdGNoKSBkZXJlZ2lzdGVyQ29sbGVjdGlvbldhdGNoKCk7XHJcblxyXG4gICAgICBpZiAoc2VsZi5pc011bHRpcGxlKSB7XHJcbiAgICAgICAgbmdNb2RlbC4kdmFsaWRhdG9yc1snbWQtbXVsdGlwbGUnXSA9IHZhbGlkYXRlQXJyYXk7XHJcbiAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gcmVuZGVyTXVsdGlwbGU7XHJcblxyXG4gICAgICAgIC8vIHdhdGNoQ29sbGVjdGlvbiBvbiB0aGUgbW9kZWwgYmVjYXVzZSBieSBkZWZhdWx0IG5nTW9kZWwgb25seSB3YXRjaGVzIHRoZSBtb2RlbCdzXHJcbiAgICAgICAgLy8gcmVmZXJlbmNlLiBUaGlzIGFsbG93ZWQgdGhlIGRldmVsb3BlciB0byBhbHNvIHB1c2ggYW5kIHBvcCBmcm9tIHRoZWlyIGFycmF5LlxyXG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKCRhdHRycy5uZ01vZGVsLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgaWYgKHZhbGlkYXRlQXJyYXkodmFsdWUpKSByZW5kZXJNdWx0aXBsZSh2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZGVsZXRlIG5nTW9kZWwuJHZhbGlkYXRvcnNbJ21kLW11bHRpcGxlJ107XHJcbiAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gcmVuZGVyU2luZ3VsYXI7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIHZhbGlkYXRlQXJyYXkobW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XHJcbiAgICAgICAgLy8gSWYgYSB2YWx1ZSBpcyB0cnV0aHkgYnV0IG5vdCBhbiBhcnJheSwgcmVqZWN0IGl0LlxyXG4gICAgICAgIC8vIElmIHZhbHVlIGlzIHVuZGVmaW5lZC9mYWxzeSwgYWNjZXB0IHRoYXQgaXQncyBhbiBlbXB0eSBhcnJheS5cclxuICAgICAgICByZXR1cm4gYW5ndWxhci5pc0FycmF5KG1vZGVsVmFsdWUgfHwgdmlld1ZhbHVlIHx8IFtdKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgc2VhcmNoU3RyID0gJyc7XHJcbiAgICB2YXIgY2xlYXJTZWFyY2hUaW1lb3V0LCBvcHROb2Rlcywgb3B0VGV4dDtcclxuICAgIHZhciBDTEVBUl9TRUFSQ0hfQUZURVIgPSAzMDA7XHJcbiAgICBzZWxmLm9wdE5vZGVGb3JLZXlib2FyZFNlYXJjaCA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgY2xlYXJTZWFyY2hUaW1lb3V0ICYmIGNsZWFyVGltZW91dChjbGVhclNlYXJjaFRpbWVvdXQpO1xyXG4gICAgICBjbGVhclNlYXJjaFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNsZWFyU2VhcmNoVGltZW91dCA9IHVuZGVmaW5lZDtcclxuICAgICAgICBzZWFyY2hTdHIgPSAnJztcclxuICAgICAgICBvcHRUZXh0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIG9wdE5vZGVzID0gdW5kZWZpbmVkO1xyXG4gICAgICB9LCBDTEVBUl9TRUFSQ0hfQUZURVIpO1xyXG4gICAgICBzZWFyY2hTdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShlLmtleUNvZGUpO1xyXG4gICAgICB2YXIgc2VhcmNoID0gbmV3IFJlZ0V4cCgnXicgKyBzZWFyY2hTdHIsICdpJyk7XHJcbiAgICAgIGlmICghb3B0Tm9kZXMpIHtcclxuICAgICAgICBvcHROb2RlcyA9ICRlbGVtZW50LmZpbmQoJ21kLW9wdGlvbicpO1xyXG4gICAgICAgIG9wdFRleHQgPSBuZXcgQXJyYXkob3B0Tm9kZXMubGVuZ3RoKTtcclxuICAgICAgICBhbmd1bGFyLmZvckVhY2gob3B0Tm9kZXMsIGZ1bmN0aW9uKGVsLCBpKSB7XHJcbiAgICAgICAgICBvcHRUZXh0W2ldID0gZWwudGV4dENvbnRlbnQudHJpbSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0VGV4dC5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGlmIChzZWFyY2gudGVzdChvcHRUZXh0W2ldKSkge1xyXG4gICAgICAgICAgcmV0dXJuIG9wdE5vZGVzW2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgc2VsZi5pbml0ID0gZnVuY3Rpb24obmdNb2RlbCkge1xyXG4gICAgICBzZWxmLm5nTW9kZWwgPSBuZ01vZGVsO1xyXG5cclxuICAgICAgLy8gQWxsb3cgdXNlcnMgdG8gcHJvdmlkZSBgbmctbW9kZWw9XCJmb29cIiBuZy1tb2RlbC1vcHRpb25zPVwie3RyYWNrQnk6ICdmb28uaWQnfVwiYCBzb1xyXG4gICAgICAvLyB0aGF0IHdlIGNhbiBwcm9wZXJseSBjb21wYXJlIG9iamVjdHMgc2V0IG9uIHRoZSBtb2RlbCB0byB0aGUgYXZhaWxhYmxlIG9wdGlvbnNcclxuICAgICAgaWYgKG5nTW9kZWwuJG9wdGlvbnMgJiYgbmdNb2RlbC4kb3B0aW9ucy50cmFja0J5KSB7XHJcbiAgICAgICAgdmFyIHRyYWNrQnlMb2NhbHMgPSB7fTtcclxuICAgICAgICB2YXIgdHJhY2tCeVBhcnNlZCA9ICRwYXJzZShuZ01vZGVsLiRvcHRpb25zLnRyYWNrQnkpO1xyXG4gICAgICAgIHNlbGYuaGFzaEdldHRlciA9IGZ1bmN0aW9uKHZhbHVlLCB2YWx1ZVNjb3BlKSB7XHJcbiAgICAgICAgICB0cmFja0J5TG9jYWxzLiR2YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgcmV0dXJuIHRyYWNrQnlQYXJzZWQodmFsdWVTY29wZSB8fCAkc2NvcGUsIHRyYWNrQnlMb2NhbHMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgIC8vIElmIHRoZSB1c2VyIGRvZXNuJ3QgcHJvdmlkZSBhIHRyYWNrQnksIHdlIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGUgYW4gaWQgZm9yIGV2ZXJ5XHJcbiAgICAgIC8vIHZhbHVlIHBhc3NlZCBpblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNlbGYuaGFzaEdldHRlciA9IGZ1bmN0aW9uIGdldEhhc2hWYWx1ZSh2YWx1ZSkge1xyXG4gICAgICAgICAgaWYgKGFuZ3VsYXIuaXNPYmplY3QodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnb2JqZWN0XycgKyAodmFsdWUuJCRtZFNlbGVjdElkIHx8ICh2YWx1ZS4kJG1kU2VsZWN0SWQgPSArK3NlbGVjdE5leHRJZCkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgICAgc2VsZi5zZXRNdWx0aXBsZShzZWxmLmlzTXVsdGlwbGUpO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZWxmLnNlbGVjdGVkTGFiZWxzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBzZWxlY3RlZE9wdGlvbkVscyA9ICRtZFV0aWwubm9kZXNUb0FycmF5KCRlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3JBbGwoJ21kLW9wdGlvbltzZWxlY3RlZF0nKSk7XHJcbiAgICAgIGlmIChzZWxlY3RlZE9wdGlvbkVscy5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gc2VsZWN0ZWRPcHRpb25FbHMubWFwKGZ1bmN0aW9uKGVsKSB7IHJldHVybiBlbC50ZXh0Q29udGVudDsgfSkuam9pbignLCAnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgc2VsZi5zZWxlY3QgPSBmdW5jdGlvbihoYXNoS2V5LCBoYXNoZWRWYWx1ZSkge1xyXG4gICAgICB2YXIgb3B0aW9uID0gc2VsZi5vcHRpb25zW2hhc2hLZXldO1xyXG4gICAgICBvcHRpb24gJiYgb3B0aW9uLnNldFNlbGVjdGVkKHRydWUpO1xyXG4gICAgICBzZWxmLnNlbGVjdGVkW2hhc2hLZXldID0gaGFzaGVkVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgc2VsZi5kZXNlbGVjdCA9IGZ1bmN0aW9uKGhhc2hLZXkpIHtcclxuICAgICAgdmFyIG9wdGlvbiA9IHNlbGYub3B0aW9uc1toYXNoS2V5XTtcclxuICAgICAgb3B0aW9uICYmIG9wdGlvbi5zZXRTZWxlY3RlZChmYWxzZSk7XHJcbiAgICAgIGRlbGV0ZSBzZWxmLnNlbGVjdGVkW2hhc2hLZXldO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZWxmLmFkZE9wdGlvbiA9IGZ1bmN0aW9uKGhhc2hLZXksIG9wdGlvbkN0cmwpIHtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHNlbGYub3B0aW9uc1toYXNoS2V5XSkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0R1cGxpY2F0ZSBtZC1vcHRpb24gdmFsdWVzIGFyZSBub3QgYWxsb3dlZCBpbiBhIHNlbGVjdC4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdEdXBsaWNhdGUgdmFsdWUgXCInICsgb3B0aW9uQ3RybC52YWx1ZSArICdcIiBmb3VuZC4nKTtcclxuICAgICAgfVxyXG4gICAgICBzZWxmLm9wdGlvbnNbaGFzaEtleV0gPSBvcHRpb25DdHJsO1xyXG5cclxuICAgICAgLy8gSWYgdGhpcyBvcHRpb24ncyB2YWx1ZSB3YXMgYWxyZWFkeSBpbiBvdXIgbmdNb2RlbCwgZ28gYWhlYWQgYW5kIHNlbGVjdCBpdC5cclxuICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHNlbGYuc2VsZWN0ZWRbaGFzaEtleV0pKSB7XHJcbiAgICAgICAgc2VsZi5zZWxlY3QoaGFzaEtleSwgb3B0aW9uQ3RybC52YWx1ZSk7XHJcbiAgICAgICAgc2VsZi5yZWZyZXNoVmlld1ZhbHVlKCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICBzZWxmLnJlbW92ZU9wdGlvbiA9IGZ1bmN0aW9uKGhhc2hLZXkpIHtcclxuICAgICAgZGVsZXRlIHNlbGYub3B0aW9uc1toYXNoS2V5XTtcclxuICAgICAgLy8gRG9uJ3QgZGVzZWxlY3QgYW4gb3B0aW9uIHdoZW4gaXQncyByZW1vdmVkIC0gdGhlIHVzZXIncyBuZ01vZGVsIHNob3VsZCBiZSBhbGxvd2VkXHJcbiAgICAgIC8vIHRvIGhhdmUgdmFsdWVzIHRoYXQgZG8gbm90IG1hdGNoIGEgY3VycmVudGx5IGF2YWlsYWJsZSBvcHRpb24uXHJcbiAgICB9O1xyXG5cclxuICAgIHNlbGYucmVmcmVzaFZpZXdWYWx1ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgdmFsdWVzID0gW107XHJcbiAgICAgIHZhciBvcHRpb247XHJcbiAgICAgIGZvciAodmFyIGhhc2hLZXkgaW4gc2VsZi5zZWxlY3RlZCkge1xyXG4gICAgICAgICAvLyBJZiB0aGlzIGhhc2hLZXkgaGFzIGFuIGFzc29jaWF0ZWQgb3B0aW9uLCBwdXNoIHRoYXQgb3B0aW9uJ3MgdmFsdWUgdG8gdGhlIG1vZGVsLlxyXG4gICAgICAgICBpZiAoKG9wdGlvbiA9IHNlbGYub3B0aW9uc1toYXNoS2V5XSkpIHtcclxuICAgICAgICAgICB2YWx1ZXMucHVzaChvcHRpb24udmFsdWUpO1xyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgIC8vIE90aGVyd2lzZSwgdGhlIGdpdmVuIGhhc2hLZXkgaGFzIG5vIGFzc29jaWF0ZWQgb3B0aW9uLCBhbmQgd2UgZ290IGl0XHJcbiAgICAgICAgICAgLy8gZnJvbSBhbiBuZ01vZGVsIHZhbHVlIGF0IGFuIGVhcmxpZXIgdGltZS4gUHVzaCB0aGUgdW5oYXNoZWQgdmFsdWUgb2ZcclxuICAgICAgICAgICAvLyB0aGlzIGhhc2hLZXkgdG8gdGhlIG1vZGVsLlxyXG4gICAgICAgICAgIC8vIFRoaXMgYWxsb3dzIHRoZSBkZXZlbG9wZXIgdG8gcHV0IGEgdmFsdWUgaW4gdGhlIG1vZGVsIHRoYXQgZG9lc24ndCB5ZXQgaGF2ZVxyXG4gICAgICAgICAgIC8vIGFuIGFzc29jaWF0ZWQgb3B0aW9uLlxyXG4gICAgICAgICAgIHZhbHVlcy5wdXNoKHNlbGYuc2VsZWN0ZWRbaGFzaEtleV0pO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgc2VsZi5uZ01vZGVsLiRzZXRWaWV3VmFsdWUoc2VsZi5pc011bHRpcGxlID8gdmFsdWVzIDogdmFsdWVzWzBdKTtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gcmVuZGVyTXVsdGlwbGUoKSB7XHJcbiAgICAgIHZhciBuZXdTZWxlY3RlZFZhbHVlcyA9IHNlbGYubmdNb2RlbC4kbW9kZWxWYWx1ZSB8fCBzZWxmLm5nTW9kZWwuJHZpZXdWYWx1ZTtcclxuICAgICAgaWYgKCFhbmd1bGFyLmlzQXJyYXkobmV3U2VsZWN0ZWRWYWx1ZXMpKSByZXR1cm47XHJcblxyXG4gICAgICB2YXIgb2xkU2VsZWN0ZWQgPSBPYmplY3Qua2V5cyhzZWxmLnNlbGVjdGVkKTtcclxuXHJcbiAgICAgIHZhciBuZXdTZWxlY3RlZEhhc2hlcyA9IG5ld1NlbGVjdGVkVmFsdWVzLm1hcChzZWxmLmhhc2hHZXR0ZXIpO1xyXG4gICAgICB2YXIgZGVzZWxlY3RlZCA9IG9sZFNlbGVjdGVkLmZpbHRlcihmdW5jdGlvbihoYXNoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ld1NlbGVjdGVkSGFzaGVzLmluZGV4T2YoaGFzaCkgPT09IC0xO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGRlc2VsZWN0ZWQuZm9yRWFjaChzZWxmLmRlc2VsZWN0KTtcclxuICAgICAgbmV3U2VsZWN0ZWRIYXNoZXMuZm9yRWFjaChmdW5jdGlvbihoYXNoS2V5LCBpKSB7XHJcbiAgICAgICAgc2VsZi5zZWxlY3QoaGFzaEtleSwgbmV3U2VsZWN0ZWRWYWx1ZXNbaV0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHJlbmRlclNpbmd1bGFyKCkge1xyXG4gICAgICB2YXIgdmFsdWUgPSBzZWxmLm5nTW9kZWwuJHZpZXdWYWx1ZSB8fCBzZWxmLm5nTW9kZWwuJG1vZGVsVmFsdWU7XHJcbiAgICAgIE9iamVjdC5rZXlzKHNlbGYuc2VsZWN0ZWQpLmZvckVhY2goc2VsZi5kZXNlbGVjdCk7XHJcbiAgICAgIHNlbGYuc2VsZWN0KCBzZWxmLmhhc2hHZXR0ZXIodmFsdWUpLCB2YWx1ZSApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuU2VsZWN0TWVudURpcmVjdGl2ZS4kaW5qZWN0ID0gW1wiJHBhcnNlXCIsIFwiJG1kVXRpbFwiLCBcIiRtZFRoZW1pbmdcIl07XHJcblxyXG5mdW5jdGlvbiBPcHRpb25EaXJlY3RpdmUoJG1kQnV0dG9uSW5rUmlwcGxlLCAkbWRVdGlsKSB7XHJcblxyXG4gIE9wdGlvbkNvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRlbGVtZW50XCJdO1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcmVxdWlyZTogWydtZE9wdGlvbicsICdeXm1kU2VsZWN0TWVudSddLFxyXG4gICAgY29udHJvbGxlcjogT3B0aW9uQ29udHJvbGxlcixcclxuICAgIGNvbXBpbGU6IGNvbXBpbGVcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBjb21waWxlKGVsZW1lbnQsIGF0dHIpIHtcclxuICAgIC8vIE1hbnVhbCB0cmFuc2NsdXNpb24gdG8gYXZvaWQgdGhlIGV4dHJhIGlubmVyIDxzcGFuPiB0aGF0IG5nLXRyYW5zY2x1ZGUgZ2VuZXJhdGVzXHJcbiAgICBlbGVtZW50LmFwcGVuZCggYW5ndWxhci5lbGVtZW50KCc8ZGl2IGNsYXNzPVwibWQtdGV4dFwiPicpLmFwcGVuZChlbGVtZW50LmNvbnRlbnRzKCkpICk7XHJcblxyXG4gICAgZWxlbWVudC5hdHRyKCd0YWJpbmRleCcsIGF0dHIudGFiaW5kZXggfHwgJzAnKTtcclxuICAgIHJldHVybiBwb3N0TGluaztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJscykge1xyXG4gICAgdmFyIG9wdGlvbkN0cmwgPSBjdHJsc1swXTtcclxuICAgIHZhciBzZWxlY3RDdHJsID0gY3RybHNbMV07XHJcblxyXG4gICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubmdWYWx1ZSkpIHtcclxuICAgICAgc2NvcGUuJHdhdGNoKGF0dHIubmdWYWx1ZSwgc2V0T3B0aW9uVmFsdWUpO1xyXG4gICAgfSBlbHNlIGlmIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLnZhbHVlKSkge1xyXG4gICAgICBzZXRPcHRpb25WYWx1ZShhdHRyLnZhbHVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHsgcmV0dXJuIGVsZW1lbnQudGV4dCgpOyB9LCBzZXRPcHRpb25WYWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2NvcGUuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBhdHRyLiRvYnNlcnZlKCdzZWxlY3RlZCcsIGZ1bmN0aW9uKHNlbGVjdGVkKSB7XHJcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzRGVmaW5lZChzZWxlY3RlZCkpIHJldHVybjtcclxuICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcclxuICAgICAgICAgIGlmICghc2VsZWN0Q3RybC5pc011bHRpcGxlKSB7XHJcbiAgICAgICAgICAgIHNlbGVjdEN0cmwuZGVzZWxlY3QoIE9iamVjdC5rZXlzKHNlbGVjdEN0cmwuc2VsZWN0ZWQpWzBdICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBzZWxlY3RDdHJsLnNlbGVjdChvcHRpb25DdHJsLmhhc2hLZXksIG9wdGlvbkN0cmwudmFsdWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZWxlY3RDdHJsLmRlc2VsZWN0KG9wdGlvbkN0cmwuaGFzaEtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGVjdEN0cmwucmVmcmVzaFZpZXdWYWx1ZSgpO1xyXG4gICAgICAgIHNlbGVjdEN0cmwubmdNb2RlbC4kcmVuZGVyKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJG1kQnV0dG9uSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCk7XHJcbiAgICBjb25maWd1cmVBcmlhKCk7XHJcblxyXG4gICAgZnVuY3Rpb24gc2V0T3B0aW9uVmFsdWUobmV3VmFsdWUsIG9sZFZhbHVlKSB7XHJcbiAgICAgIHZhciBvbGRIYXNoS2V5ID0gc2VsZWN0Q3RybC5oYXNoR2V0dGVyKG9sZFZhbHVlLCBzY29wZSk7XHJcbiAgICAgIHZhciBuZXdIYXNoS2V5ID0gc2VsZWN0Q3RybC5oYXNoR2V0dGVyKG5ld1ZhbHVlLCBzY29wZSk7XHJcblxyXG4gICAgICBvcHRpb25DdHJsLmhhc2hLZXkgPSBuZXdIYXNoS2V5O1xyXG4gICAgICBvcHRpb25DdHJsLnZhbHVlID0gbmV3VmFsdWU7XHJcblxyXG4gICAgICBzZWxlY3RDdHJsLnJlbW92ZU9wdGlvbihvbGRIYXNoS2V5LCBvcHRpb25DdHJsKTtcclxuICAgICAgc2VsZWN0Q3RybC5hZGRPcHRpb24obmV3SGFzaEtleSwgb3B0aW9uQ3RybCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBzZWxlY3RDdHJsLnJlbW92ZU9wdGlvbihvcHRpb25DdHJsLmhhc2hLZXksIG9wdGlvbkN0cmwpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29uZmlndXJlQXJpYSgpIHtcclxuICAgICAgdmFyIGFyaWFBdHRycyA9IHtcclxuICAgICAgICAncm9sZSc6ICdvcHRpb24nLFxyXG4gICAgICAgICdhcmlhLXNlbGVjdGVkJzogJ2ZhbHNlJ1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWYgKCFlbGVtZW50WzBdLmhhc0F0dHJpYnV0ZSgnaWQnKSkge1xyXG4gICAgICAgIGFyaWFBdHRycy5pZCA9ICdzZWxlY3Rfb3B0aW9uXycgKyAkbWRVdGlsLm5leHRVaWQoKTtcclxuICAgICAgfVxyXG4gICAgICBlbGVtZW50LmF0dHIoYXJpYUF0dHJzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIE9wdGlvbkNvbnRyb2xsZXIoJGVsZW1lbnQpIHtcclxuICAgIHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuc2V0U2VsZWN0ZWQgPSBmdW5jdGlvbihpc1NlbGVjdGVkKSB7XHJcbiAgICAgIGlmIChpc1NlbGVjdGVkICYmICF0aGlzLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgJGVsZW1lbnQuYXR0cih7XHJcbiAgICAgICAgICAnc2VsZWN0ZWQnOiAnc2VsZWN0ZWQnLFxyXG4gICAgICAgICAgJ2FyaWEtc2VsZWN0ZWQnOiAndHJ1ZSdcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIGlmICghaXNTZWxlY3RlZCAmJiB0aGlzLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgJGVsZW1lbnQucmVtb3ZlQXR0cignc2VsZWN0ZWQnKTtcclxuICAgICAgICAkZWxlbWVudC5hdHRyKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5zZWxlY3RlZCA9IGlzU2VsZWN0ZWQ7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbn1cclxuT3B0aW9uRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRCdXR0b25JbmtSaXBwbGVcIiwgXCIkbWRVdGlsXCJdO1xyXG5cclxuZnVuY3Rpb24gT3B0Z3JvdXBEaXJlY3RpdmUoKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICBjb21waWxlOiBjb21waWxlXHJcbiAgfTtcclxuICBmdW5jdGlvbiBjb21waWxlKGVsLCBhdHRycykge1xyXG4gICAgdmFyIGxhYmVsRWxlbWVudCA9IGVsLmZpbmQoJ2xhYmVsJyk7XHJcbiAgICBpZiAoIWxhYmVsRWxlbWVudC5sZW5ndGgpIHtcclxuICAgICAgbGFiZWxFbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KCc8bGFiZWw+Jyk7XHJcbiAgICAgIGVsLnByZXBlbmQobGFiZWxFbGVtZW50KTtcclxuICAgIH1cclxuICAgIGlmIChhdHRycy5sYWJlbCkgbGFiZWxFbGVtZW50LnRleHQoYXR0cnMubGFiZWwpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gU2VsZWN0UHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XHJcbiAgc2VsZWN0RGVmYXVsdE9wdGlvbnMuJGluamVjdCA9IFtcIiRtZFNlbGVjdFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJCRyQUZcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiR0aW1lb3V0XCIsIFwiJHdpbmRvd1wiXTtcclxuICByZXR1cm4gJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKCckbWRTZWxlY3QnKVxyXG4gICAgLnNldERlZmF1bHRzKHtcclxuICAgICAgbWV0aG9kczogWyd0YXJnZXQnXSxcclxuICAgICAgb3B0aW9uczogc2VsZWN0RGVmYXVsdE9wdGlvbnNcclxuICAgIH0pO1xyXG5cclxuICAvKiBAbmdJbmplY3QgKi9cclxuICBmdW5jdGlvbiBzZWxlY3REZWZhdWx0T3B0aW9ucygkbWRTZWxlY3QsICRtZENvbnN0YW50LCAkJHJBRiwgJG1kVXRpbCwgJG1kVGhlbWluZywgJHRpbWVvdXQsICR3aW5kb3cgKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBwYXJlbnQ6ICdib2R5JyxcclxuICAgICAgb25TaG93OiBvblNob3csXHJcbiAgICAgIG9uUmVtb3ZlOiBvblJlbW92ZSxcclxuICAgICAgaGFzQmFja2Ryb3A6IHRydWUsXHJcbiAgICAgIGRpc2FibGVQYXJlbnRTY3JvbGw6IHRydWUsXHJcbiAgICAgIHRoZW1hYmxlOiB0cnVlXHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIG9uU2hvdyhzY29wZSwgZWxlbWVudCwgb3B0cykge1xyXG4gICAgICBpZiAoIW9wdHMudGFyZ2V0KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCckbWRTZWxlY3Quc2hvdygpIGV4cGVjdGVkIGEgdGFyZ2V0IGVsZW1lbnQgaW4gb3B0aW9ucy50YXJnZXQgYnV0IGdvdCAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ1wiJyArIG9wdHMudGFyZ2V0ICsgJ1wiIScpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhbmd1bGFyLmV4dGVuZChvcHRzLCB7XHJcbiAgICAgICAgaXNSZW1vdmVkOiBmYWxzZSxcclxuICAgICAgICB0YXJnZXQ6IGFuZ3VsYXIuZWxlbWVudChvcHRzLnRhcmdldCksIC8vbWFrZSBzdXJlIGl0J3Mgbm90IGEgbmFrZWQgZG9tIG5vZGVcclxuICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChvcHRzLnBhcmVudCksXHJcbiAgICAgICAgc2VsZWN0RWw6IGVsZW1lbnQuZmluZCgnbWQtc2VsZWN0LW1lbnUnKSxcclxuICAgICAgICBjb250ZW50RWw6IGVsZW1lbnQuZmluZCgnbWQtY29udGVudCcpLFxyXG4gICAgICAgIGJhY2tkcm9wOiBvcHRzLmhhc0JhY2tkcm9wICYmIGFuZ3VsYXIuZWxlbWVudCgnPG1kLWJhY2tkcm9wIGNsYXNzPVwibWQtc2VsZWN0LWJhY2tkcm9wIG1kLWNsaWNrLWNhdGNoZXJcIj4nKVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG9wdHMucmVzaXplRm4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBhbmltYXRlU2VsZWN0KHNjb3BlLCBlbGVtZW50LCBvcHRzKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdyZXNpemUnLCBvcHRzLnJlc2l6ZUZuKTtcclxuICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9uKCdvcmllbnRhdGlvbmNoYW5nZScsIG9wdHMucmVzaXplRm4pO1xyXG5cclxuXHJcbiAgICAgIGNvbmZpZ3VyZUFyaWEoKTtcclxuXHJcbiAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWxlYXZlJyk7XHJcblxyXG4gICAgICB2YXIgb3B0aW9uTm9kZXMgPSBvcHRzLnNlbGVjdEVsWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC1vcHRpb24nKTtcclxuXHJcbiAgICAgIGlmIChvcHRzLmxvYWRpbmdBc3luYyAmJiBvcHRzLmxvYWRpbmdBc3luYy50aGVuKSB7XHJcbiAgICAgICAgb3B0cy5sb2FkaW5nQXN5bmMudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgIHNjb3BlLiQkbG9hZGluZ0FzeW5jRG9uZSA9IHRydWU7XHJcbiAgICAgICAgICAvLyBHaXZlIG91cnNlbHZlcyB0d28gZnJhbWVzIGZvciB0aGUgcHJvZ3Jlc3MgbG9hZGVyIHRvIGNsZWFyIG91dC5cclxuICAgICAgICAgICQkckFGKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAvLyBEb24ndCBnbyBmb3J3YXJkIGlmIHRoZSBzZWxlY3QgaGFzIGJlZW4gcmVtb3ZlZCBpbiB0aGlzIHRpbWUuLi5cclxuICAgICAgICAgICAgICBpZiAob3B0cy5pc1JlbW92ZWQpIHJldHVybjtcclxuICAgICAgICAgICAgICBhbmltYXRlU2VsZWN0KHNjb3BlLCBlbGVtZW50LCBvcHRzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIGlmIChvcHRzLmxvYWRpbmdBc3luYykge1xyXG4gICAgICAgIHNjb3BlLiQkbG9hZGluZ0FzeW5jRG9uZSA9IHRydWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChvcHRzLmRpc2FibGVQYXJlbnRTY3JvbGwgJiYgISRtZFV0aWwuZ2V0Q2xvc2VzdChvcHRzLnRhcmdldCwgJ01ELURJQUxPRycpKSB7XHJcbiAgICAgICAgb3B0cy5yZXN0b3JlU2Nyb2xsID0gJG1kVXRpbC5kaXNhYmxlU2Nyb2xsQXJvdW5kKG9wdHMuZWxlbWVudCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgb3B0cy5kaXNhYmxlUGFyZW50U2Nyb2xsID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy8gT25seSBhY3RpdmF0ZSBjbGljayBsaXN0ZW5lcnMgYWZ0ZXIgYSBzaG9ydCB0aW1lIHRvIHN0b3AgYWNjaWRlbnRhbCBkb3VibGUgdGFwcy9jbGlja3NcclxuICAgICAgLy8gZnJvbSBjbGlja2luZyB0aGUgd3JvbmcgaXRlbVxyXG4gICAgICAkdGltZW91dChhY3RpdmF0ZUludGVyYWN0aW9uLCA3NSwgZmFsc2UpO1xyXG5cclxuICAgICAgaWYgKG9wdHMuYmFja2Ryb3ApIHtcclxuICAgICAgICAkbWRUaGVtaW5nLmluaGVyaXQob3B0cy5iYWNrZHJvcCwgb3B0cy5wYXJlbnQpO1xyXG4gICAgICAgIG9wdHMucGFyZW50LmFwcGVuZChvcHRzLmJhY2tkcm9wKTtcclxuICAgICAgfVxyXG4gICAgICBvcHRzLnBhcmVudC5hcHBlbmQoZWxlbWVudCk7XHJcblxyXG4gICAgICAvLyBHaXZlIHRoZSBzZWxlY3QgYSBmcmFtZSB0byAnaW5pdGlhbGl6ZScgaW4gdGhlIERPTSxcclxuICAgICAgLy8gc28gd2UgY2FuIHJlYWQgaXRzIGhlaWdodC93aWR0aC9wb3NpdGlvblxyXG4gICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGlmIChvcHRzLmlzUmVtb3ZlZCkgcmV0dXJuO1xyXG4gICAgICAgICAgYW5pbWF0ZVNlbGVjdChzY29wZSwgZWxlbWVudCwgb3B0cyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2Uob3B0cy5zZWxlY3RFbCwge3RpbWVvdXQ6IDM1MH0pO1xyXG5cclxuICAgICAgZnVuY3Rpb24gY29uZmlndXJlQXJpYSgpIHtcclxuICAgICAgICBvcHRzLnRhcmdldC5hdHRyKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gYWN0aXZhdGVJbnRlcmFjdGlvbigpIHtcclxuICAgICAgICBpZiAob3B0cy5pc1JlbW92ZWQpIHJldHVybjtcclxuICAgICAgICB2YXIgc2VsZWN0Q3RybCA9IG9wdHMuc2VsZWN0RWwuY29udHJvbGxlcignbWRTZWxlY3RNZW51JykgfHwge307XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtY2xpY2thYmxlJyk7XHJcblxyXG4gICAgICAgIG9wdHMuYmFja2Ryb3AgJiYgb3B0cy5iYWNrZHJvcC5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgb3B0cy5yZXN0b3JlRm9jdXMgPSBmYWxzZTtcclxuICAgICAgICAgIHNjb3BlLiRhcHBseSgkbWRTZWxlY3QuY2FuY2VsKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gRXNjYXBlIHRvIGNsb3NlXHJcbiAgICAgICAgb3B0cy5zZWxlY3RFbC5vbigna2V5ZG93bicsIGZ1bmN0aW9uKGV2KSB7XHJcbiAgICAgICAgICBzd2l0Y2ggKGV2LmtleUNvZGUpIHtcclxuICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5TUEFDRTpcclxuICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5FTlRFUjpcclxuICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gJG1kVXRpbC5nZXRDbG9zZXN0KGV2LnRhcmdldCwgJ21kLW9wdGlvbicpO1xyXG4gICAgICAgICAgICAgIGlmIChvcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIG9wdHMuc2VsZWN0RWwudHJpZ2dlckhhbmRsZXIoe1xyXG4gICAgICAgICAgICAgICAgICB0eXBlOiAnY2xpY2snLFxyXG4gICAgICAgICAgICAgICAgICB0YXJnZXQ6IG9wdGlvblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5UQUI6XHJcbiAgICAgICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFOlxyXG4gICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgb3B0cy5yZXN0b3JlRm9jdXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgkbWRTZWxlY3QuY2FuY2VsKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQ3ljbGluZyBvZiBvcHRpb25zLCBhbmQgY2xvc2luZyBvbiBlbnRlclxyXG4gICAgICAgIG9wdHMuc2VsZWN0RWwub24oJ2tleWRvd24nLCBmdW5jdGlvbihldikge1xyXG4gICAgICAgICAgc3dpdGNoIChldi5rZXlDb2RlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuVVBfQVJST1c6IHJldHVybiBmb2N1c1ByZXZPcHRpb24oKTtcclxuICAgICAgICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5ET1dOX0FSUk9XOiByZXR1cm4gZm9jdXNOZXh0T3B0aW9uKCk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgaWYgKGV2LmtleUNvZGUgPj0gMzEgJiYgZXYua2V5Q29kZSA8PSA5MCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wdE5vZGUgPSBvcHRzLnNlbGVjdEVsLmNvbnRyb2xsZXIoJ21kU2VsZWN0TWVudScpLm9wdE5vZGVGb3JLZXlib2FyZFNlYXJjaChldik7XHJcbiAgICAgICAgICAgICAgICBvcHROb2RlICYmIG9wdE5vZGUuZm9jdXMoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmb2N1c09wdGlvbihkaXJlY3Rpb24pIHtcclxuICAgICAgICAgIHZhciBvcHRpb25zQXJyYXkgPSAkbWRVdGlsLm5vZGVzVG9BcnJheShvcHRpb25Ob2Rlcyk7XHJcbiAgICAgICAgICB2YXIgaW5kZXggPSBvcHRpb25zQXJyYXkuaW5kZXhPZihvcHRzLmZvY3VzZWROb2RlKTtcclxuICAgICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgLy8gV2UgbG9zdCB0aGUgcHJldmlvdXNseSBmb2N1c2VkIGVsZW1lbnQsIHJlc2V0IHRvIGZpcnN0IG9wdGlvblxyXG4gICAgICAgICAgICBpbmRleCA9IDA7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ25leHQnICYmIGluZGV4IDwgb3B0aW9uc0FycmF5Lmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAncHJldicgJiYgaW5kZXggPiAwKSB7XHJcbiAgICAgICAgICAgIGluZGV4LS07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2YXIgbmV3T3B0aW9uID0gb3B0cy5mb2N1c2VkTm9kZSA9IG9wdGlvbnNBcnJheVtpbmRleF07XHJcbiAgICAgICAgICBuZXdPcHRpb24gJiYgbmV3T3B0aW9uLmZvY3VzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGZvY3VzTmV4dE9wdGlvbigpIHtcclxuICAgICAgICAgIGZvY3VzT3B0aW9uKCduZXh0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGZvY3VzUHJldk9wdGlvbigpIHtcclxuICAgICAgICAgIGZvY3VzT3B0aW9uKCdwcmV2Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvcHRzLnNlbGVjdEVsLm9uKCdjbGljaycsIGNoZWNrQ2xvc2VNZW51KTtcclxuICAgICAgICBvcHRzLnNlbGVjdEVsLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAzMiB8fCBlLmtleUNvZGUgPT0gMTMpIHtcclxuICAgICAgICAgICAgY2hlY2tDbG9zZU1lbnUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2hlY2tDbG9zZU1lbnUoKSB7XHJcbiAgICAgICAgICBpZiAoIXNlbGVjdEN0cmwuaXNNdWx0aXBsZSkge1xyXG4gICAgICAgICAgICBvcHRzLnJlc3RvcmVGb2N1cyA9IHRydWU7XHJcbiAgICAgICAgICAgIHNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgJG1kU2VsZWN0LmhpZGUoc2VsZWN0Q3RybC5uZ01vZGVsLiR2aWV3VmFsdWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gb25SZW1vdmUoc2NvcGUsIGVsZW1lbnQsIG9wdHMpIHtcclxuICAgICAgb3B0cy5pc1JlbW92ZWQgPSB0cnVlO1xyXG4gICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1sZWF2ZScpXHJcbiAgICAgICAgLnJlbW92ZUNsYXNzKCdtZC1jbGlja2FibGUnKTtcclxuICAgICAgb3B0cy50YXJnZXQuYXR0cignYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xyXG5cclxuXHJcbiAgICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIG9wdHMucmVzaXplRm4pO1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdvcmllbnRhdGlvbmNoYW5nZScsIG9wdHMucmVzaXplZm4pO1xyXG4gICAgICBvcHRzLnJlc2l6ZUZuID0gdW5kZWZpbmVkO1xyXG5cclxuICAgICAgdmFyIG1kU2VsZWN0ID0gb3B0cy5zZWxlY3RFbC5jb250cm9sbGVyKCdtZFNlbGVjdCcpO1xyXG4gICAgICBpZiAobWRTZWxlY3QpIHtcclxuICAgICAgICBtZFNlbGVjdC5zZXRMYWJlbFRleHQob3B0cy5zZWxlY3RFbC5jb250cm9sbGVyKCdtZFNlbGVjdE1lbnUnKS5zZWxlY3RlZExhYmVscygpKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuICRtZFV0aWwudHJhbnNpdGlvbkVuZFByb21pc2UoZWxlbWVudCwgeyB0aW1lb3V0OiAzNTAgfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1hY3RpdmUnKTtcclxuICAgICAgICBvcHRzLmJhY2tkcm9wICYmIG9wdHMuYmFja2Ryb3AucmVtb3ZlKCk7XHJcbiAgICAgICAgaWYgKGVsZW1lbnRbMF0ucGFyZW50Tm9kZSA9PT0gb3B0cy5wYXJlbnRbMF0pIHtcclxuICAgICAgICAgIG9wdHMucGFyZW50WzBdLnJlbW92ZUNoaWxkKGVsZW1lbnRbMF0pOyAvLyB1c2UgYnJvd3NlciB0byBhdm9pZCAkZGVzdHJveSBldmVudFxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0cy5kaXNhYmxlUGFyZW50U2Nyb2xsKSB7XHJcbiAgICAgICAgICBvcHRzLnJlc3RvcmVTY3JvbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9wdHMucmVzdG9yZUZvY3VzKSBvcHRzLnRhcmdldC5mb2N1cygpO1xyXG4gICAgICAgIG1kU2VsZWN0ICYmIG1kU2VsZWN0LnRyaWdnZXJDbG9zZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhbmltYXRlU2VsZWN0KHNjb3BlLCBlbGVtZW50LCBvcHRzKSB7XHJcbiAgICAgIHZhciBjb250YWluZXJOb2RlID0gZWxlbWVudFswXSxcclxuICAgICAgICAgIHRhcmdldE5vZGUgPSBvcHRzLnRhcmdldFswXS5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZCwgLy8gdGFyZ2V0IHRoZSBmaXJzdCBzcGFuLCBmdW5jdGlvbmluZyBhcyB0aGUgbGFiZWxcclxuICAgICAgICAgIHBhcmVudE5vZGUgPSBvcHRzLnBhcmVudFswXSxcclxuICAgICAgICAgIHNlbGVjdE5vZGUgPSBvcHRzLnNlbGVjdEVsWzBdLFxyXG4gICAgICAgICAgY29udGVudE5vZGUgPSBvcHRzLmNvbnRlbnRFbFswXSxcclxuICAgICAgICAgIHBhcmVudFJlY3QgPSBwYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgICAgdGFyZ2V0UmVjdCA9IHRhcmdldE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgICBzaG91bGRPcGVuQXJvdW5kVGFyZ2V0ID0gZmFsc2UsXHJcbiAgICAgICAgICBib3VuZHMgPSB7XHJcbiAgICAgICAgICAgIGxlZnQ6IHBhcmVudFJlY3QubGVmdCArIFNFTEVDVF9FREdFX01BUkdJTixcclxuICAgICAgICAgICAgdG9wOiBTRUxFQ1RfRURHRV9NQVJHSU4sXHJcbiAgICAgICAgICAgIGJvdHRvbTogcGFyZW50UmVjdC5oZWlnaHQgLSBTRUxFQ1RfRURHRV9NQVJHSU4sXHJcbiAgICAgICAgICAgIHJpZ2h0OiBwYXJlbnRSZWN0LndpZHRoIC0gU0VMRUNUX0VER0VfTUFSR0lOIC0gKCRtZFV0aWwuZmxvYXRpbmdTY3JvbGxiYXJzKCkgPyAxNiA6IDApXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc3BhY2VBdmFpbGFibGUgPSB7XHJcbiAgICAgICAgICAgIHRvcDogdGFyZ2V0UmVjdC50b3AgLSBib3VuZHMudG9wLFxyXG4gICAgICAgICAgICBsZWZ0OiB0YXJnZXRSZWN0LmxlZnQgLSBib3VuZHMubGVmdCxcclxuICAgICAgICAgICAgcmlnaHQ6IGJvdW5kcy5yaWdodCAtICh0YXJnZXRSZWN0LmxlZnQgKyB0YXJnZXRSZWN0LndpZHRoKSxcclxuICAgICAgICAgICAgYm90dG9tOiBib3VuZHMuYm90dG9tIC0gKHRhcmdldFJlY3QudG9wICsgdGFyZ2V0UmVjdC5oZWlnaHQpXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWF4V2lkdGggPSBwYXJlbnRSZWN0LndpZHRoIC0gU0VMRUNUX0VER0VfTUFSR0lOICogMixcclxuICAgICAgICAgIGlzU2Nyb2xsYWJsZSA9IGNvbnRlbnROb2RlLnNjcm9sbEhlaWdodCA+IGNvbnRlbnROb2RlLm9mZnNldEhlaWdodCxcclxuICAgICAgICAgIHNlbGVjdGVkTm9kZSA9IHNlbGVjdE5vZGUucXVlcnlTZWxlY3RvcignbWQtb3B0aW9uW3NlbGVjdGVkXScpLFxyXG4gICAgICAgICAgb3B0aW9uTm9kZXMgPSBzZWxlY3ROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC1vcHRpb24nKSxcclxuICAgICAgICAgIG9wdGdyb3VwTm9kZXMgPSBzZWxlY3ROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC1vcHRncm91cCcpO1xyXG5cclxuXHJcbiAgICAgIHZhciBjZW50ZXJlZE5vZGU7XHJcbiAgICAgIC8vIElmIGEgc2VsZWN0ZWQgbm9kZSwgY2VudGVyIGFyb3VuZCB0aGF0XHJcbiAgICAgIGlmIChzZWxlY3RlZE5vZGUpIHtcclxuICAgICAgICBjZW50ZXJlZE5vZGUgPSBzZWxlY3RlZE5vZGU7XHJcbiAgICAgIC8vIElmIHRoZXJlIGFyZSBvcHRpb24gZ3JvdXBzLCBjZW50ZXIgYXJvdW5kIHRoZSBmaXJzdCBvcHRpb24gZ3JvdXBcclxuICAgICAgfSBlbHNlIGlmIChvcHRncm91cE5vZGVzLmxlbmd0aCkge1xyXG4gICAgICAgIGNlbnRlcmVkTm9kZSA9IG9wdGdyb3VwTm9kZXNbMF07XHJcbiAgICAgIC8vIE90aGVyd2lzZSwgY2VudGVyIGFyb3VuZCB0aGUgZmlyc3Qgb3B0aW9uTm9kZVxyXG4gICAgICB9IGVsc2UgaWYgKG9wdGlvbk5vZGVzLmxlbmd0aCl7XHJcbiAgICAgICAgY2VudGVyZWROb2RlID0gb3B0aW9uTm9kZXNbMF07XHJcbiAgICAgIC8vIEluIGNhc2UgdGhlcmUgYXJlIG5vIG9wdGlvbnMsIGNlbnRlciBvbiB3aGF0ZXZlcidzIGluIHRoZXJlLi4uIChlZyBwcm9ncmVzcyBpbmRpY2F0b3IpXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2VudGVyZWROb2RlID0gY29udGVudE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgfHwgY29udGVudE5vZGU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChjb250ZW50Tm9kZS5vZmZzZXRXaWR0aCA+IG1heFdpZHRoKSB7XHJcbiAgICAgICAgY29udGVudE5vZGUuc3R5bGVbJ21heC13aWR0aCddID0gbWF4V2lkdGggKyAncHgnO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChzaG91bGRPcGVuQXJvdW5kVGFyZ2V0KSB7XHJcbiAgICAgICAgY29udGVudE5vZGUuc3R5bGVbJ21pbi13aWR0aCddID0gdGFyZ2V0UmVjdC53aWR0aCArICdweCc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFJlbW92ZSBwYWRkaW5nIGJlZm9yZSB3ZSBjb21wdXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgbWVudVxyXG4gICAgICBpZiAoaXNTY3JvbGxhYmxlKSB7XHJcbiAgICAgICAgc2VsZWN0Tm9kZS5jbGFzc0xpc3QuYWRkKCdtZC1vdmVyZmxvdycpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBHZXQgdGhlIHNlbGVjdE1lbnVSZWN0ICphZnRlciogbWF4LXdpZHRoIGlzIHBvc3NpYmx5IHNldCBhYm92ZVxyXG4gICAgICB2YXIgc2VsZWN0TWVudVJlY3QgPSBzZWxlY3ROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICB2YXIgY2VudGVyZWRSZWN0ID0gZ2V0T2Zmc2V0UmVjdChjZW50ZXJlZE5vZGUpO1xyXG5cclxuICAgICAgaWYgKGNlbnRlcmVkTm9kZSkge1xyXG4gICAgICAgIHZhciBjZW50ZXJlZFN0eWxlID0gJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGNlbnRlcmVkTm9kZSk7XHJcbiAgICAgICAgY2VudGVyZWRSZWN0LnBhZGRpbmdMZWZ0ID0gcGFyc2VJbnQoY2VudGVyZWRTdHlsZS5wYWRkaW5nTGVmdCwgMTApIHx8IDA7XHJcbiAgICAgICAgY2VudGVyZWRSZWN0LnBhZGRpbmdSaWdodCA9IHBhcnNlSW50KGNlbnRlcmVkU3R5bGUucGFkZGluZ1JpZ2h0LCAxMCkgfHwgMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGZvY3VzZWROb2RlID0gY2VudGVyZWROb2RlO1xyXG4gICAgICBpZiAoKGZvY3VzZWROb2RlLnRhZ05hbWUgfHwgJycpLnRvVXBwZXJDYXNlKCkgPT09ICdNRC1PUFRHUk9VUCcpIHtcclxuICAgICAgICBmb2N1c2VkTm9kZSA9IG9wdGlvbk5vZGVzWzBdIHx8IGNvbnRlbnROb2RlLmZpcnN0RWxlbWVudENoaWxkIHx8IGNvbnRlbnROb2RlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoaXNTY3JvbGxhYmxlKSB7XHJcbiAgICAgICAgdmFyIHNjcm9sbEJ1ZmZlciA9IGNvbnRlbnROb2RlLm9mZnNldEhlaWdodCAvIDI7XHJcbiAgICAgICAgY29udGVudE5vZGUuc2Nyb2xsVG9wID0gY2VudGVyZWRSZWN0LnRvcCArIGNlbnRlcmVkUmVjdC5oZWlnaHQgLyAyIC0gc2Nyb2xsQnVmZmVyO1xyXG5cclxuICAgICAgICBpZiAoc3BhY2VBdmFpbGFibGUudG9wIDwgc2Nyb2xsQnVmZmVyKSB7XHJcbiAgICAgICAgICBjb250ZW50Tm9kZS5zY3JvbGxUb3AgPSBNYXRoLm1pbihcclxuICAgICAgICAgICAgY2VudGVyZWRSZWN0LnRvcCxcclxuICAgICAgICAgICAgY29udGVudE5vZGUuc2Nyb2xsVG9wICsgc2Nyb2xsQnVmZmVyIC0gc3BhY2VBdmFpbGFibGUudG9wXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc3BhY2VBdmFpbGFibGUuYm90dG9tIDwgc2Nyb2xsQnVmZmVyKSB7XHJcbiAgICAgICAgICBjb250ZW50Tm9kZS5zY3JvbGxUb3AgPSBNYXRoLm1heChcclxuICAgICAgICAgICAgY2VudGVyZWRSZWN0LnRvcCArIGNlbnRlcmVkUmVjdC5oZWlnaHQgLSBzZWxlY3RNZW51UmVjdC5oZWlnaHQsXHJcbiAgICAgICAgICAgIGNvbnRlbnROb2RlLnNjcm9sbFRvcCAtIHNjcm9sbEJ1ZmZlciArIHNwYWNlQXZhaWxhYmxlLmJvdHRvbVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBsZWZ0LCB0b3AsIHRyYW5zZm9ybU9yaWdpbjtcclxuICAgICAgaWYgKHNob3VsZE9wZW5Bcm91bmRUYXJnZXQpIHtcclxuICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0O1xyXG4gICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgdGFyZ2V0UmVjdC5oZWlnaHQ7XHJcbiAgICAgICAgdHJhbnNmb3JtT3JpZ2luID0gJzUwJSAwJztcclxuICAgICAgICBpZiAodG9wICsgc2VsZWN0TWVudVJlY3QuaGVpZ2h0ID4gYm91bmRzLmJvdHRvbSkge1xyXG4gICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgLSBzZWxlY3RNZW51UmVjdC5oZWlnaHQ7XHJcbiAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW4gPSAnNTAlIDEwMCUnO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0ICsgY2VudGVyZWRSZWN0LmxlZnQgLSBjZW50ZXJlZFJlY3QucGFkZGluZ0xlZnQ7XHJcbiAgICAgICAgdG9wID0gTWF0aC5mbG9vcih0YXJnZXRSZWN0LnRvcCArIHRhcmdldFJlY3QuaGVpZ2h0IC8gMiAtIGNlbnRlcmVkUmVjdC5oZWlnaHQgLyAyIC1cclxuICAgICAgICAgIGNlbnRlcmVkUmVjdC50b3AgKyBjb250ZW50Tm9kZS5zY3JvbGxUb3ApO1xyXG5cclxuXHJcbiAgICAgICAgdHJhbnNmb3JtT3JpZ2luID0gKGNlbnRlcmVkUmVjdC5sZWZ0ICsgdGFyZ2V0UmVjdC53aWR0aCAvIDIpICsgJ3B4ICcgK1xyXG4gICAgICAgIChjZW50ZXJlZFJlY3QudG9wICsgY2VudGVyZWRSZWN0LmhlaWdodCAvIDIgLSBjb250ZW50Tm9kZS5zY3JvbGxUb3ApICsgJ3B4IDBweCc7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lck5vZGUuc3R5bGUubWluV2lkdGggPSB0YXJnZXRSZWN0LndpZHRoICsgY2VudGVyZWRSZWN0LnBhZGRpbmdMZWZ0ICtcclxuICAgICAgICAgIGNlbnRlcmVkUmVjdC5wYWRkaW5nUmlnaHQgKyAncHgnO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBLZWVwIGxlZnQgYW5kIHRvcCB3aXRoaW4gdGhlIHdpbmRvd1xyXG4gICAgICB2YXIgY29udGFpbmVyUmVjdCA9IGNvbnRhaW5lck5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgIGNvbnRhaW5lck5vZGUuc3R5bGUubGVmdCA9IGNsYW1wKGJvdW5kcy5sZWZ0LCBsZWZ0LCBib3VuZHMucmlnaHQgLSBjb250YWluZXJSZWN0LndpZHRoKSArICdweCc7XHJcbiAgICAgIGNvbnRhaW5lck5vZGUuc3R5bGUudG9wID0gY2xhbXAoYm91bmRzLnRvcCwgdG9wLCBib3VuZHMuYm90dG9tIC0gY29udGFpbmVyUmVjdC5oZWlnaHQpICsgJ3B4JztcclxuICAgICAgc2VsZWN0Tm9kZS5zdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNX09SSUdJTl0gPSB0cmFuc2Zvcm1PcmlnaW47XHJcblxyXG4gICAgICBzZWxlY3ROb2RlLnN0eWxlWyRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk1dID0gJ3NjYWxlKCcgK1xyXG4gICAgICAgIE1hdGgubWluKHRhcmdldFJlY3Qud2lkdGggLyBzZWxlY3RNZW51UmVjdC53aWR0aCwgMS4wKSArICcsJyArXHJcbiAgICAgICAgTWF0aC5taW4odGFyZ2V0UmVjdC5oZWlnaHQgLyBzZWxlY3RNZW51UmVjdC5oZWlnaHQsIDEuMCkgK1xyXG4gICAgICAnKSc7XHJcblxyXG5cclxuICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnbWQtYWN0aXZlJyk7XHJcbiAgICAgICAgc2VsZWN0Tm9kZS5zdHlsZVskbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNXSA9ICcnO1xyXG4gICAgICAgIGlmIChmb2N1c2VkTm9kZSkge1xyXG4gICAgICAgICAgb3B0cy5mb2N1c2VkTm9kZSA9IGZvY3VzZWROb2RlO1xyXG4gICAgICAgICAgZm9jdXNlZE5vZGUuZm9jdXMoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNsYW1wKG1pbiwgbiwgbWF4KSB7XHJcbiAgICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihuLCBtYXgpKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldE9mZnNldFJlY3Qobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUgPyB7XHJcbiAgICAgIGxlZnQ6IG5vZGUub2Zmc2V0TGVmdCxcclxuICAgICAgdG9wOiBub2RlLm9mZnNldFRvcCxcclxuICAgICAgd2lkdGg6IG5vZGUub2Zmc2V0V2lkdGgsXHJcbiAgICAgIGhlaWdodDogbm9kZS5vZmZzZXRIZWlnaHRcclxuICAgIH0gOiB7IGxlZnQ6IDAsIHRvcDogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9O1xyXG4gIH1cclxufVxyXG5TZWxlY3RQcm92aWRlci4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyXCJdO1xyXG5cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMuc2lkZW5hdlxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogQSBTaWRlbmF2IFFQIGNvbXBvbmVudC5cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnNpZGVuYXYnLCBbXHJcbiAgICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgICAnbWF0ZXJpYWwuY29tcG9uZW50cy5iYWNrZHJvcCdcclxuICBdKVxyXG4gIC5mYWN0b3J5KCckbWRTaWRlbmF2JywgU2lkZW5hdlNlcnZpY2UgKVxyXG4gIC5kaXJlY3RpdmUoJ21kU2lkZW5hdicsIFNpZGVuYXZEaXJlY3RpdmUpXHJcbiAgLmRpcmVjdGl2ZSgnbWRTaWRlbmF2Rm9jdXMnLCBTaWRlbmF2Rm9jdXNEaXJlY3RpdmUpXHJcbiAgLmNvbnRyb2xsZXIoJyRtZFNpZGVuYXZDb250cm9sbGVyJywgU2lkZW5hdkNvbnRyb2xsZXIpO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAbmdkb2Mgc2VydmljZVxyXG4gKiBAbmFtZSAkbWRTaWRlbmF2XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zaWRlbmF2XHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBgJG1kU2lkZW5hdmAgbWFrZXMgaXQgZWFzeSB0byBpbnRlcmFjdCB3aXRoIG11bHRpcGxlIHNpZGVuYXZzXHJcbiAqIGluIGFuIGFwcC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiAvLyBBc3luYyBsb29rdXAgZm9yIHNpZGVuYXYgaW5zdGFuY2U7IHdpbGwgcmVzb2x2ZSB3aGVuIHRoZSBpbnN0YW5jZSBpcyBhdmFpbGFibGVcclxuICogJG1kU2lkZW5hdihjb21wb25lbnRJZCkudGhlbihmdW5jdGlvbihpbnN0YW5jZSkge1xyXG4gKiAgICRsb2cuZGVidWcoIGNvbXBvbmVudElkICsgXCJpcyBub3cgcmVhZHlcIiApO1xyXG4gKiB9KTtcclxuICogLy8gQXN5bmMgdG9nZ2xlIHRoZSBnaXZlbiBzaWRlbmF2O1xyXG4gKiAvLyB3aGVuIGluc3RhbmNlIGlzIGtub3duIHJlYWR5IGFuZCBsYXp5IGxvb2t1cCBpcyBub3QgbmVlZGVkLlxyXG4gKiAkbWRTaWRlbmF2KGNvbXBvbmVudElkKVxyXG4gKiAgICAudG9nZ2xlKClcclxuICogICAgLnRoZW4oZnVuY3Rpb24oKXtcclxuICogICAgICAkbG9nLmRlYnVnKCd0b2dnbGVkJyk7XHJcbiAqICAgIH0pO1xyXG4gKiAvLyBBc3luYyBvcGVuIHRoZSBnaXZlbiBzaWRlbmF2XHJcbiAqICRtZFNpZGVuYXYoY29tcG9uZW50SWQpXHJcbiAqICAgIC5vcGVuKClcclxuICogICAgLnRoZW4oZnVuY3Rpb24oKXtcclxuICogICAgICAkbG9nLmRlYnVnKCdvcGVuZWQnKTtcclxuICogICAgfSk7XHJcbiAqIC8vIEFzeW5jIGNsb3NlIHRoZSBnaXZlbiBzaWRlbmF2XHJcbiAqICRtZFNpZGVuYXYoY29tcG9uZW50SWQpXHJcbiAqICAgIC5jbG9zZSgpXHJcbiAqICAgIC50aGVuKGZ1bmN0aW9uKCl7XHJcbiAqICAgICAgJGxvZy5kZWJ1ZygnY2xvc2VkJyk7XHJcbiAqICAgIH0pO1xyXG4gKiAvLyBTeW5jIGNoZWNrIHRvIHNlZSBpZiB0aGUgc3BlY2lmaWVkIHNpZGVuYXYgaXMgc2V0IHRvIGJlIG9wZW5cclxuICogJG1kU2lkZW5hdihjb21wb25lbnRJZCkuaXNPcGVuKCk7XHJcbiAqIC8vIFN5bmMgY2hlY2sgdG8gd2hldGhlciBnaXZlbiBzaWRlbmF2IGlzIGxvY2tlZCBvcGVuXHJcbiAqIC8vIElmIHRoaXMgaXMgdHJ1ZSwgdGhlIHNpZGVuYXYgd2lsbCBiZSBvcGVuIHJlZ2FyZGxlc3Mgb2YgY2xvc2UoKVxyXG4gKiAkbWRTaWRlbmF2KGNvbXBvbmVudElkKS5pc0xvY2tlZE9wZW4oKTtcclxuICogPC9obGpzPlxyXG4gKi9cclxuZnVuY3Rpb24gU2lkZW5hdlNlcnZpY2UoJG1kQ29tcG9uZW50UmVnaXN0cnksICRxKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKGhhbmRsZSkge1xyXG5cclxuICAgIC8vIExvb2t1cCB0aGUgY29udHJvbGxlciBpbnN0YW5jZSBmb3IgdGhlIHNwZWNpZmllZCBzaWROYXYgaW5zdGFuY2VcclxuICAgIHZhciBzZWxmO1xyXG4gICAgdmFyIGVycm9yTXNnID0gXCJTaWRlTmF2ICdcIiArIGhhbmRsZSArIFwiJyBpcyBub3QgYXZhaWxhYmxlIVwiO1xyXG4gICAgdmFyIGluc3RhbmNlID0gJG1kQ29tcG9uZW50UmVnaXN0cnkuZ2V0KGhhbmRsZSk7XHJcblxyXG4gICAgaWYoIWluc3RhbmNlKSB7XHJcbiAgICAgICRtZENvbXBvbmVudFJlZ2lzdHJ5Lm5vdEZvdW5kRXJyb3IoaGFuZGxlKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc2VsZiA9IHtcclxuICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgLy8gU3luYyBtZXRob2RzXHJcbiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgIGlzT3BlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlICYmIGluc3RhbmNlLmlzT3BlbigpO1xyXG4gICAgICB9LFxyXG4gICAgICBpc0xvY2tlZE9wZW46IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZSAmJiBpbnN0YW5jZS5pc0xvY2tlZE9wZW4oKTtcclxuICAgICAgfSxcclxuICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgLy8gQXN5bmMgbWV0aG9kc1xyXG4gICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICB0b2dnbGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZSA/IGluc3RhbmNlLnRvZ2dsZSgpIDogJHEucmVqZWN0KGVycm9yTXNnKTtcclxuICAgICAgfSxcclxuICAgICAgb3BlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlID8gaW5zdGFuY2Uub3BlbigpIDogJHEucmVqZWN0KGVycm9yTXNnKTtcclxuICAgICAgfSxcclxuICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZSA/IGluc3RhbmNlLmNsb3NlKCkgOiAkcS5yZWplY3QoZXJyb3JNc2cpO1xyXG4gICAgICB9LFxyXG4gICAgICB0aGVuIDogZnVuY3Rpb24oIGNhbGxiYWNrRm4gKSB7XHJcbiAgICAgICAgdmFyIHByb21pc2UgPSBpbnN0YW5jZSA/ICRxLndoZW4oaW5zdGFuY2UpIDogd2FpdEZvckluc3RhbmNlKCk7XHJcbiAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbiggY2FsbGJhY2tGbiB8fCBhbmd1bGFyLm5vb3AgKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmVycmVkIGxvb2t1cCBvZiBjb21wb25lbnQgaW5zdGFuY2UgdXNpbmcgJGNvbXBvbmVudCByZWdpc3RyeVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiB3YWl0Rm9ySW5zdGFuY2UoKSB7XHJcbiAgICAgIHJldHVybiAkbWRDb21wb25lbnRSZWdpc3RyeVxyXG4gICAgICAgICAgICAgICAgLndoZW4oaGFuZGxlKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oIGl0ICl7XHJcbiAgICAgICAgICAgICAgICAgIGluc3RhbmNlID0gaXQ7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiBpdDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuU2lkZW5hdlNlcnZpY2UuJGluamVjdCA9IFtcIiRtZENvbXBvbmVudFJlZ2lzdHJ5XCIsIFwiJHFcIl07XHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kU2lkZW5hdkZvY3VzXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zaWRlbmF2XHJcbiAqXHJcbiAqIEByZXN0cmljdCBBXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBgJG1kU2lkZW5hdkZvY3VzYCBwcm92aWRlcyBhIHdheSB0byBzcGVjaWZ5IHRoZSBmb2N1c2VkIGVsZW1lbnQgd2hlbiBhIHNpZGVuYXYgb3BlbnMuXHJcbiAqIFRoaXMgaXMgY29tcGxldGVseSBvcHRpb25hbCwgYXMgdGhlIHNpZGVuYXYgaXRzZWxmIGlzIGZvY3VzZWQgYnkgZGVmYXVsdC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqIDxtZC1zaWRlbmF2PlxyXG4gKiAgIDxmb3JtPlxyXG4gKiAgICAgPG1kLWlucHV0LWNvbnRhaW5lcj5cclxuICogICAgICAgPGxhYmVsIGZvcj1cInRlc3RJbnB1dFwiPkxhYmVsPC9sYWJlbD5cclxuICogICAgICAgPGlucHV0IGlkPVwidGVzdElucHV0XCIgdHlwZT1cInRleHRcIiBtZC1zaWRlbmF2LWZvY3VzPlxyXG4gKiAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgPC9mb3JtPlxyXG4gKiA8L21kLXNpZGVuYXY+XHJcbiAqIDwvaGxqcz5cclxuICoqL1xyXG5mdW5jdGlvbiBTaWRlbmF2Rm9jdXNEaXJlY3RpdmUoKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICByZXF1aXJlOiAnXm1kU2lkZW5hdicsXHJcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0ciwgc2lkZW5hdkN0cmwpIHtcclxuICAgICAgc2lkZW5hdkN0cmwuZm9jdXNFbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRTaWRlbmF2XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zaWRlbmF2XHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKlxyXG4gKiBBIFNpZGVuYXYgY29tcG9uZW50IHRoYXQgY2FuIGJlIG9wZW5lZCBhbmQgY2xvc2VkIHByb2dyYW1hdGljYWxseS5cclxuICpcclxuICogQnkgZGVmYXVsdCwgdXBvbiBvcGVuaW5nIGl0IHdpbGwgc2xpZGUgb3V0IG9uIHRvcCBvZiB0aGUgbWFpbiBjb250ZW50IGFyZWEuXHJcbiAqXHJcbiAqIEZvciBrZXlib2FyZCBhbmQgc2NyZWVuIHJlYWRlciBhY2Nlc3NpYmlsaXR5LCBmb2N1cyBpcyBzZW50IHRvIHRoZSBzaWRlbmF2IHdyYXBwZXIgYnkgZGVmYXVsdC5cclxuICogSXQgY2FuIGJlIG92ZXJyaWRkZW4gd2l0aCB0aGUgYG1kLXNpZGVuYXYtZm9jdXNgIGRpcmVjdGl2ZSBvbiB0aGUgY2hpbGQgZWxlbWVudCB5b3Ugd2FudCBmb2N1c2VkLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPGRpdiBsYXlvdXQ9XCJyb3dcIiBuZy1jb250cm9sbGVyPVwiTXlDb250cm9sbGVyXCI+XHJcbiAqICAgPG1kLXNpZGVuYXYgbWQtY29tcG9uZW50LWlkPVwibGVmdFwiIGNsYXNzPVwibWQtc2lkZW5hdi1sZWZ0XCI+XHJcbiAqICAgICBMZWZ0IE5hdiFcclxuICogICA8L21kLXNpZGVuYXY+XHJcbiAqXHJcbiAqICAgPG1kLWNvbnRlbnQ+XHJcbiAqICAgICBDZW50ZXIgQ29udGVudFxyXG4gKiAgICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cIm9wZW5MZWZ0TWVudSgpXCI+XHJcbiAqICAgICAgIE9wZW4gTGVmdCBNZW51XHJcbiAqICAgICA8L21kLWJ1dHRvbj5cclxuICogICA8L21kLWNvbnRlbnQ+XHJcbiAqXHJcbiAqICAgPG1kLXNpZGVuYXYgbWQtY29tcG9uZW50LWlkPVwicmlnaHRcIlxyXG4gKiAgICAgbWQtaXMtbG9ja2VkLW9wZW49XCIkbWRNZWRpYSgnbWluLXdpZHRoOiAzMzNweCcpXCJcclxuICogICAgIGNsYXNzPVwibWQtc2lkZW5hdi1yaWdodFwiPlxyXG4gKiAgICAgPGZvcm0+XHJcbiAqICAgICAgIDxtZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgICAgICAgPGxhYmVsIGZvcj1cInRlc3RJbnB1dFwiPlRlc3QgaW5wdXQ8L2xhYmVsPlxyXG4gKiAgICAgICAgIDxpbnB1dCBpZD1cInRlc3RJbnB1dFwiIHR5cGU9XCJ0ZXh0XCJcclxuICogICAgICAgICAgICAgICAgbmctbW9kZWw9XCJkYXRhXCIgbWQtc2lkZW5hdi1mb2N1cz5cclxuICogICAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XHJcbiAqICAgICA8L2Zvcm0+XHJcbiAqICAgPC9tZC1zaWRlbmF2PlxyXG4gKiA8L2Rpdj5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiA8aGxqcyBsYW5nPVwianNcIj5cclxuICogdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcsIFsnbmdNYXRlcmlhbCddKTtcclxuICogYXBwLmNvbnRyb2xsZXIoJ015Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1kU2lkZW5hdikge1xyXG4gKiAgICRzY29wZS5vcGVuTGVmdE1lbnUgPSBmdW5jdGlvbigpIHtcclxuICogICAgICRtZFNpZGVuYXYoJ2xlZnQnKS50b2dnbGUoKTtcclxuICogICB9O1xyXG4gKiB9KTtcclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBtZC1pcy1vcGVuIEEgbW9kZWwgYm91bmQgdG8gd2hldGhlciB0aGUgc2lkZW5hdiBpcyBvcGVuZWQuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtY29tcG9uZW50LWlkIGNvbXBvbmVudElkIHRvIHVzZSB3aXRoICRtZFNpZGVuYXYgc2VydmljZS5cclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtaXMtbG9ja2VkLW9wZW4gV2hlbiB0aGlzIGV4cHJlc3Npb24gZXZhbHV0ZXMgdG8gdHJ1ZSxcclxuICogdGhlIHNpZGVuYXYgJ2xvY2tzIG9wZW4nOiBpdCBmYWxscyBpbnRvIHRoZSBjb250ZW50J3MgZmxvdyBpbnN0ZWFkXHJcbiAqIG9mIGFwcGVhcmluZyBvdmVyIGl0LiBUaGlzIG92ZXJyaWRlcyB0aGUgYGlzLW9wZW5gIGF0dHJpYnV0ZS5cclxuICpcclxuICogVGhlICRtZE1lZGlhKCkgc2VydmljZSBpcyBleHBvc2VkIHRvIHRoZSBpcy1sb2NrZWQtb3BlbiBhdHRyaWJ1dGUsIHdoaWNoXHJcbiAqIGNhbiBiZSBnaXZlbiBhIG1lZGlhIHF1ZXJ5IG9yIG9uZSBvZiB0aGUgYHNtYCwgYGd0LXNtYCwgYG1kYCwgYGd0LW1kYCwgYGxnYCBvciBgZ3QtbGdgIHByZXNldHMuXHJcbiAqIEV4YW1wbGVzOlxyXG4gKlxyXG4gKiAgIC0gYDxtZC1zaWRlbmF2IG1kLWlzLWxvY2tlZC1vcGVuPVwic2hvdWxkTG9ja09wZW5cIj48L21kLXNpZGVuYXY+YFxyXG4gKiAgIC0gYDxtZC1zaWRlbmF2IG1kLWlzLWxvY2tlZC1vcGVuPVwiJG1kTWVkaWEoJ21pbi13aWR0aDogMTAwMHB4JylcIj48L21kLXNpZGVuYXY+YFxyXG4gKiAgIC0gYDxtZC1zaWRlbmF2IG1kLWlzLWxvY2tlZC1vcGVuPVwiJG1kTWVkaWEoJ3NtJylcIj48L21kLXNpZGVuYXY+YCAobG9ja3Mgb3BlbiBvbiBzbWFsbCBzY3JlZW5zKVxyXG4gKi9cclxuZnVuY3Rpb24gU2lkZW5hdkRpcmVjdGl2ZSgkdGltZW91dCwgJGFuaW1hdGUsICRwYXJzZSwgJGxvZywgJG1kTWVkaWEsICRtZENvbnN0YW50LCAkY29tcGlsZSwgJG1kVGhlbWluZywgJHEsICRkb2N1bWVudCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgc2NvcGU6IHtcclxuICAgICAgaXNPcGVuOiAnPT9tZElzT3BlbidcclxuICAgIH0sXHJcbiAgICBjb250cm9sbGVyOiAnJG1kU2lkZW5hdkNvbnRyb2xsZXInLFxyXG4gICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1jbG9zZWQnKTtcclxuICAgICAgZWxlbWVudC5hdHRyKCd0YWJJbmRleCcsICctMScpO1xyXG4gICAgICByZXR1cm4gcG9zdExpbms7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogRGlyZWN0aXZlIFBvc3QgTGluayBmdW5jdGlvbi4uLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBzaWRlbmF2Q3RybCkge1xyXG4gICAgdmFyIGxhc3RQYXJlbnRPdmVyRmxvdztcclxuICAgIHZhciB0cmlnZ2VyaW5nRWxlbWVudCA9IG51bGw7XHJcbiAgICB2YXIgcHJvbWlzZSA9ICRxLndoZW4odHJ1ZSk7XHJcblxyXG4gICAgdmFyIGlzTG9ja2VkT3BlblBhcnNlZCA9ICRwYXJzZShhdHRyLm1kSXNMb2NrZWRPcGVuKTtcclxuICAgIHZhciBpc0xvY2tlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICByZXR1cm4gaXNMb2NrZWRPcGVuUGFyc2VkKHNjb3BlLiRwYXJlbnQsIHtcclxuICAgICAgICAkbWVkaWE6IGZ1bmN0aW9uKGFyZykge1xyXG4gICAgICAgICAgJGxvZy53YXJuKFwiJG1lZGlhIGlzIGRlcHJlY2F0ZWQgZm9yIGlzLWxvY2tlZC1vcGVuLiBVc2UgJG1kTWVkaWEgaW5zdGVhZC5cIik7XHJcbiAgICAgICAgICByZXR1cm4gJG1kTWVkaWEoYXJnKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgICRtZE1lZGlhOiAkbWRNZWRpYVxyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgICB2YXIgYmFja2Ryb3AgPSAkY29tcGlsZShcclxuICAgICAgJzxtZC1iYWNrZHJvcCBjbGFzcz1cIm1kLXNpZGVuYXYtYmFja2Ryb3AgbWQtb3BhcXVlIG5nLWVudGVyXCI+J1xyXG4gICAgKShzY29wZSk7XHJcblxyXG4gICAgZWxlbWVudC5vbignJGRlc3Ryb3knLCBzaWRlbmF2Q3RybC5kZXN0cm95KTtcclxuICAgICRtZFRoZW1pbmcuaW5oZXJpdChiYWNrZHJvcCwgZWxlbWVudCk7XHJcblxyXG4gICAgc2NvcGUuJHdhdGNoKGlzTG9ja2VkLCB1cGRhdGVJc0xvY2tlZCk7XHJcbiAgICBzY29wZS4kd2F0Y2goJ2lzT3BlbicsIHVwZGF0ZUlzT3Blbik7XHJcblxyXG5cclxuICAgIC8vIFB1Ymxpc2ggc3BlY2lhbCBhY2Nlc3NvciBmb3IgdGhlIENvbnRyb2xsZXIgaW5zdGFuY2VcclxuICAgIHNpZGVuYXZDdHJsLiR0b2dnbGVPcGVuID0gdG9nZ2xlT3BlbjtcclxuICAgIHNpZGVuYXZDdHJsLmZvY3VzRWxlbWVudCggc2lkZW5hdkN0cmwuZm9jdXNFbGVtZW50KCkgfHwgZWxlbWVudCApO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVG9nZ2xlIHRoZSBET00gY2xhc3NlcyB0byBpbmRpY2F0ZSBgbG9ja2VkYFxyXG4gICAgICogQHBhcmFtIGlzTG9ja2VkXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZUlzTG9ja2VkKGlzTG9ja2VkLCBvbGRWYWx1ZSkge1xyXG4gICAgICBzY29wZS5pc0xvY2tlZE9wZW4gPSBpc0xvY2tlZDtcclxuICAgICAgaWYgKGlzTG9ja2VkID09PSBvbGRWYWx1ZSkge1xyXG4gICAgICAgIGVsZW1lbnQudG9nZ2xlQ2xhc3MoJ21kLWxvY2tlZC1vcGVuJywgISFpc0xvY2tlZCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJGFuaW1hdGVbaXNMb2NrZWQgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJ10oZWxlbWVudCwgJ21kLWxvY2tlZC1vcGVuJyk7XHJcbiAgICAgIH1cclxuICAgICAgYmFja2Ryb3AudG9nZ2xlQ2xhc3MoJ21kLWxvY2tlZC1vcGVuJywgISFpc0xvY2tlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUb2dnbGUgdGhlIFNpZGVOYXYgdmlldyBhbmQgYXR0YWNoL2RldGFjaCBsaXN0ZW5lcnNcclxuICAgICAqIEBwYXJhbSBpc09wZW5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdXBkYXRlSXNPcGVuKGlzT3Blbikge1xyXG4gICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcclxuXHJcbiAgICAgIHBhcmVudFtpc09wZW4gPyAnb24nIDogJ29mZiddKCdrZXlkb3duJywgb25LZXlEb3duKTtcclxuICAgICAgYmFja2Ryb3BbaXNPcGVuID8gJ29uJyA6ICdvZmYnXSgnY2xpY2snLCBjbG9zZSk7XHJcblxyXG4gICAgICBpZiAoIGlzT3BlbiApIHtcclxuICAgICAgICAvLyBDYXB0dXJlIHVwb24gb3BlbmluZy4uXHJcbiAgICAgICAgdHJpZ2dlcmluZ0VsZW1lbnQgPSAkZG9jdW1lbnRbMF0uYWN0aXZlRWxlbWVudDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgZm9jdXNFbCA9IHNpZGVuYXZDdHJsLmZvY3VzRWxlbWVudCgpO1xyXG5cclxuICAgICAgZGlzYWJsZVBhcmVudFNjcm9sbChpc09wZW4pO1xyXG5cclxuICAgICAgcmV0dXJuIHByb21pc2UgPSAkcS5hbGwoW1xyXG4gICAgICAgICAgICAgICAgaXNPcGVuID8gJGFuaW1hdGUuZW50ZXIoYmFja2Ryb3AsIHBhcmVudCkgOiAkYW5pbWF0ZS5sZWF2ZShiYWNrZHJvcCksXHJcbiAgICAgICAgICAgICAgICAkYW5pbWF0ZVtpc09wZW4gPyAncmVtb3ZlQ2xhc3MnIDogJ2FkZENsYXNzJ10oZWxlbWVudCwgJ21kLWNsb3NlZCcpXHJcbiAgICAgICAgICAgICAgXSlcclxuICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIFBlcmZvcm0gZm9jdXMgd2hlbiBhbmltYXRpb25zIGFyZSBBTEwgZG9uZS4uLlxyXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLmlzT3Blbikge1xyXG4gICAgICAgICAgICAgICAgICBmb2N1c0VsICYmIGZvY3VzRWwuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFByZXZlbnQgcGFyZW50IHNjcm9sbGluZyAod2hlbiB0aGUgU2lkZU5hdiBpcyBvcGVuKVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBkaXNhYmxlUGFyZW50U2Nyb2xsKGRpc2FibGVkKSB7XHJcbiAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudCgpO1xyXG4gICAgICBpZiAoIGRpc2FibGVkICkge1xyXG4gICAgICAgIGxhc3RQYXJlbnRPdmVyRmxvdyA9IHBhcmVudC5jc3MoJ292ZXJmbG93Jyk7XHJcbiAgICAgICAgcGFyZW50LmNzcygnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoYW5ndWxhci5pc0RlZmluZWQobGFzdFBhcmVudE92ZXJGbG93KSkge1xyXG4gICAgICAgIHBhcmVudC5jc3MoJ292ZXJmbG93JywgbGFzdFBhcmVudE92ZXJGbG93KTtcclxuICAgICAgICBsYXN0UGFyZW50T3ZlckZsb3cgPSB1bmRlZmluZWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRvZ2dsZSB0aGUgc2lkZU5hdiB2aWV3IGFuZCBwdWJsaXNoIGEgcHJvbWlzZSB0byBiZSByZXNvbHZlZCB3aGVuXHJcbiAgICAgKiB0aGUgdmlldyBhbmltYXRpb24gZmluaXNoZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlzT3BlblxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHRvZ2dsZU9wZW4oIGlzT3BlbiApIHtcclxuICAgICAgaWYgKHNjb3BlLmlzT3BlbiA9PSBpc09wZW4gKSB7XHJcblxyXG4gICAgICAgIHJldHVybiAkcS53aGVuKHRydWUpO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG5cclxuICAgICAgICAvLyBUb2dnbGUgdmFsdWUgdG8gZm9yY2UgYW4gYXN5bmMgYHVwZGF0ZUlzT3BlbigpYCB0byBydW5cclxuICAgICAgICBzY29wZS5pc09wZW4gPSBpc09wZW47XHJcblxyXG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgIC8vIFdoZW4gdGhlIGN1cnJlbnQgYHVwZGF0ZUlzT3BlbigpYCBhbmltYXRpb24gZmluaXNoZXNcclxuICAgICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICggIXNjb3BlLmlzT3BlbiApIHtcclxuICAgICAgICAgICAgICAvLyByZXNldCBmb2N1cyB0byBvcmlnaW5hdGluZyBlbGVtZW50IChpZiBhdmFpbGFibGUpIHVwb24gY2xvc2VcclxuICAgICAgICAgICAgICB0cmlnZ2VyaW5nRWxlbWVudCAmJiB0cmlnZ2VyaW5nRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgIHRyaWdnZXJpbmdFbGVtZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0sMCxmYWxzZSk7XHJcblxyXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBdXRvLWNsb3NlIHNpZGVOYXYgd2hlbiB0aGUgYGVzY2FwZWAga2V5IGlzIHByZXNzZWQuXHJcbiAgICAgKiBAcGFyYW0gZXZ0XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIG9uS2V5RG93bihldikge1xyXG4gICAgICB2YXIgaXNFc2NhcGUgPSAoZXYua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFKTtcclxuICAgICAgcmV0dXJuIGlzRXNjYXBlID8gY2xvc2UoZXYpIDogJHEud2hlbih0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFdpdGggYmFja2Ryb3AgYGNsaWNrc2Agb3IgYGVzY2FwZWAga2V5LXByZXNzLCBpbW1lZGlhdGVseVxyXG4gICAgICogYXBwbHkgdGhlIENTUyBjbG9zZSB0cmFuc2l0aW9uLi4uIFRoZW4gbm90aWZ5IHRoZSBjb250cm9sbGVyXHJcbiAgICAgKiB0byBjbG9zZSgpIGFuZCBwZXJmb3JtIGl0cyBvd24gYWN0aW9ucy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY2xvc2UoZXYpIHtcclxuICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICByZXR1cm4gc2lkZW5hdkN0cmwuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG59XHJcblNpZGVuYXZEaXJlY3RpdmUuJGluamVjdCA9IFtcIiR0aW1lb3V0XCIsIFwiJGFuaW1hdGVcIiwgXCIkcGFyc2VcIiwgXCIkbG9nXCIsIFwiJG1kTWVkaWFcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRjb21waWxlXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRxXCIsIFwiJGRvY3VtZW50XCJdO1xyXG5cclxuLypcclxuICogQHByaXZhdGVcclxuICogQG5nZG9jIGNvbnRyb2xsZXJcclxuICogQG5hbWUgU2lkZW5hdkNvbnRyb2xsZXJcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnNpZGVuYXZcclxuICpcclxuICovXHJcbmZ1bmN0aW9uIFNpZGVuYXZDb250cm9sbGVyKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJG1kQ29tcG9uZW50UmVnaXN0cnksICRxKSB7XHJcblxyXG4gIHZhciBzZWxmID0gdGhpcyxcclxuICAgICAgZm9jdXNFbGVtZW50O1xyXG5cclxuICAvLyBVc2UgRGVmYXVsdCBpbnRlcm5hbCBtZXRob2QgdW50aWwgb3ZlcnJpZGRlbiBieSBkaXJlY3RpdmUgcG9zdExpbmtcclxuXHJcbiAgLy8gU3luY2hyb25vdXMgZ2V0dGVyc1xyXG4gIHNlbGYuaXNPcGVuID0gZnVuY3Rpb24oKSB7IHJldHVybiAhISRzY29wZS5pc09wZW47IH07XHJcbiAgc2VsZi5pc0xvY2tlZE9wZW4gPSBmdW5jdGlvbigpIHsgcmV0dXJuICEhJHNjb3BlLmlzTG9ja2VkT3BlbjsgfTtcclxuXHJcbiAgLy8gQXN5bmMgYWN0aW9uc1xyXG4gIHNlbGYub3BlbiAgID0gZnVuY3Rpb24oKSB7IHJldHVybiBzZWxmLiR0b2dnbGVPcGVuKCB0cnVlICk7ICB9O1xyXG4gIHNlbGYuY2xvc2UgID0gZnVuY3Rpb24oKSB7IHJldHVybiBzZWxmLiR0b2dnbGVPcGVuKCBmYWxzZSApOyB9O1xyXG4gIHNlbGYudG9nZ2xlID0gZnVuY3Rpb24oKSB7IHJldHVybiBzZWxmLiR0b2dnbGVPcGVuKCAhJHNjb3BlLmlzT3BlbiApOyAgfTtcclxuICBzZWxmLmZvY3VzRWxlbWVudCA9IGZ1bmN0aW9uKGVsKSB7XHJcbiAgICBpZiAoIGFuZ3VsYXIuaXNEZWZpbmVkKGVsKSApIHtcclxuICAgICAgZm9jdXNFbGVtZW50ID0gZWw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZm9jdXNFbGVtZW50O1xyXG4gIH07XHJcblxyXG4gIHNlbGYuJHRvZ2dsZU9wZW4gPSBmdW5jdGlvbigpIHsgcmV0dXJuICRxLndoZW4oJHNjb3BlLmlzT3Blbik7IH07XHJcblxyXG4gIHNlbGYuZGVzdHJveSA9ICRtZENvbXBvbmVudFJlZ2lzdHJ5LnJlZ2lzdGVyKHNlbGYsICRhdHRycy5tZENvbXBvbmVudElkKTtcclxufVxyXG5TaWRlbmF2Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkYXR0cnNcIiwgXCIkbWRDb21wb25lbnRSZWdpc3RyeVwiLCBcIiRxXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuICAvKipcclxuICAgKiBAbmdkb2MgbW9kdWxlXHJcbiAgICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5zbGlkZXJcclxuICAgKi9cclxuICBhbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5zbGlkZXInLCBbXHJcbiAgICAnbWF0ZXJpYWwuY29yZSdcclxuICBdKVxyXG4gIC5kaXJlY3RpdmUoJ21kU2xpZGVyJywgU2xpZGVyRGlyZWN0aXZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kU2xpZGVyXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zbGlkZXJcclxuICogQHJlc3RyaWN0IEVcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLXNsaWRlcj5gIGNvbXBvbmVudCBhbGxvd3MgdGhlIHVzZXIgdG8gY2hvb3NlIGZyb20gYSByYW5nZSBvZlxyXG4gKiB2YWx1ZXMuXHJcbiAqXHJcbiAqIEFzIHBlciB0aGUgW21hdGVyaWFsIGRlc2lnbiBzcGVjXShodHRwOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvc3R5bGUvY29sb3IuaHRtbCNjb2xvci11aS1jb2xvci1hcHBsaWNhdGlvbilcclxuICogdGhlIHNsaWRlciBpcyBpbiB0aGUgYWNjZW50IGNvbG9yIGJ5IGRlZmF1bHQuIFRoZSBwcmltYXJ5IGNvbG9yIHBhbGV0dGUgbWF5IGJlIHVzZWQgd2l0aFxyXG4gKiB0aGUgYG1kLXByaW1hcnlgIGNsYXNzLlxyXG4gKlxyXG4gKiBJdCBoYXMgdHdvIG1vZGVzOiAnbm9ybWFsJyBtb2RlLCB3aGVyZSB0aGUgdXNlciBzbGlkZXMgYmV0d2VlbiBhIHdpZGUgcmFuZ2VcclxuICogb2YgdmFsdWVzLCBhbmQgJ2Rpc2NyZXRlJyBtb2RlLCB3aGVyZSB0aGUgdXNlciBzbGlkZXMgYmV0d2VlbiBvbmx5IGEgZmV3XHJcbiAqIHNlbGVjdCB2YWx1ZXMuXHJcbiAqXHJcbiAqIFRvIGVuYWJsZSBkaXNjcmV0ZSBtb2RlLCBhZGQgdGhlIGBtZC1kaXNjcmV0ZWAgYXR0cmlidXRlIHRvIGEgc2xpZGVyLFxyXG4gKiBhbmQgdXNlIHRoZSBgc3RlcGAgYXR0cmlidXRlIHRvIGNoYW5nZSB0aGUgZGlzdGFuY2UgYmV0d2VlblxyXG4gKiB2YWx1ZXMgdGhlIHVzZXIgaXMgYWxsb3dlZCB0byBwaWNrLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGg0Pk5vcm1hbCBNb2RlPC9oND5cclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXNsaWRlciBuZy1tb2RlbD1cIm15VmFsdWVcIiBtaW49XCI1XCIgbWF4PVwiNTAwXCI+XHJcbiAqIDwvbWQtc2xpZGVyPlxyXG4gKiA8L2hsanM+XHJcbiAqIDxoND5EaXNjcmV0ZSBNb2RlPC9oND5cclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXNsaWRlciBtZC1kaXNjcmV0ZSBuZy1tb2RlbD1cIm15RGlzY3JldGVWYWx1ZVwiIHN0ZXA9XCIxMFwiIG1pbj1cIjEwXCIgbWF4PVwiMTMwXCI+XHJcbiAqIDwvbWQtc2xpZGVyPlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWRpc2NyZXRlIFdoZXRoZXIgdG8gZW5hYmxlIGRpc2NyZXRlIG1vZGUuXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gc3RlcCBUaGUgZGlzdGFuY2UgYmV0d2VlbiB2YWx1ZXMgdGhlIHVzZXIgaXMgYWxsb3dlZCB0byBwaWNrLiBEZWZhdWx0IDEuXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWluIFRoZSBtaW5pbXVtIHZhbHVlIHRoZSB1c2VyIGlzIGFsbG93ZWQgdG8gcGljay4gRGVmYXVsdCAwLlxyXG4gKiBAcGFyYW0ge251bWJlcj19IG1heCBUaGUgbWF4aW11bSB2YWx1ZSB0aGUgdXNlciBpcyBhbGxvd2VkIHRvIHBpY2suIERlZmF1bHQgMTAwLlxyXG4gKi9cclxuZnVuY3Rpb24gU2xpZGVyRGlyZWN0aXZlKCQkckFGLCAkd2luZG93LCAkbWRBcmlhLCAkbWRVdGlsLCAkbWRDb25zdGFudCwgJG1kVGhlbWluZywgJG1kR2VzdHVyZSwgJHBhcnNlKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHNjb3BlOiB7fSxcclxuICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXHJcbiAgICB0ZW1wbGF0ZTpcclxuICAgICAgJzxkaXYgY2xhc3M9XCJtZC1zbGlkZXItd3JhcHBlclwiPlxcXHJcbiAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRyYWNrLWNvbnRhaW5lclwiPlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtdHJhY2tcIj48L2Rpdj5cXFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRyYWNrIG1kLXRyYWNrLWZpbGxcIj48L2Rpdj5cXFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRyYWNrLXRpY2tzXCI+PC9kaXY+XFxcclxuICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJtZC10aHVtYi1jb250YWluZXJcIj5cXFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXRodW1iXCI+PC9kaXY+XFxcclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1mb2N1cy10aHVtYlwiPjwvZGl2PlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtZm9jdXMtcmluZ1wiPjwvZGl2PlxcXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtc2lnblwiPlxcXHJcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibWQtdGh1bWItdGV4dFwiPjwvc3Bhbj5cXFxyXG4gICAgICAgICAgPC9kaXY+XFxcclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1kaXNhYmxlZC10aHVtYlwiPjwvZGl2PlxcXHJcbiAgICAgICAgPC9kaXY+XFxcclxuICAgICAgPC9kaXY+JyxcclxuICAgIGNvbXBpbGU6IGNvbXBpbGVcclxuICB9O1xyXG5cclxuICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAgLy8gUHJpdmF0ZSBNZXRob2RzXHJcbiAgLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5cclxuICBmdW5jdGlvbiBjb21waWxlICh0RWxlbWVudCwgdEF0dHJzKSB7XHJcbiAgICB0RWxlbWVudC5hdHRyKHtcclxuICAgICAgdGFiSW5kZXg6IDAsXHJcbiAgICAgIHJvbGU6ICdzbGlkZXInXHJcbiAgICB9KTtcclxuXHJcbiAgICAkbWRBcmlhLmV4cGVjdCh0RWxlbWVudCwgJ2FyaWEtbGFiZWwnKTtcclxuXHJcbiAgICByZXR1cm4gcG9zdExpbms7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgbmdNb2RlbEN0cmwpIHtcclxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcbiAgICBuZ01vZGVsQ3RybCA9IG5nTW9kZWxDdHJsIHx8IHtcclxuICAgICAgLy8gTW9jayBuZ01vZGVsQ29udHJvbGxlciBpZiBpdCBkb2Vzbid0IGV4aXN0IHRvIGdpdmUgdXNcclxuICAgICAgLy8gdGhlIG1pbmltdW0gZnVuY3Rpb25hbGl0eSBuZWVkZWRcclxuICAgICAgJHNldFZpZXdWYWx1ZTogZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgdGhpcy4kdmlld1ZhbHVlID0gdmFsO1xyXG4gICAgICAgIHRoaXMuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbihjYikgeyBjYigpOyB9KTtcclxuICAgICAgfSxcclxuICAgICAgJHBhcnNlcnM6IFtdLFxyXG4gICAgICAkZm9ybWF0dGVyczogW10sXHJcbiAgICAgICR2aWV3Q2hhbmdlTGlzdGVuZXJzOiBbXVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgaXNEaXNhYmxlZFBhcnNlZCA9IGF0dHIubmdEaXNhYmxlZCAmJiAkcGFyc2UoYXR0ci5uZ0Rpc2FibGVkKTtcclxuICAgIHZhciBpc0Rpc2FibGVkR2V0dGVyID0gaXNEaXNhYmxlZFBhcnNlZCA/XHJcbiAgICAgIGZ1bmN0aW9uKCkgeyByZXR1cm4gaXNEaXNhYmxlZFBhcnNlZChzY29wZS4kcGFyZW50KTsgfSA6XHJcbiAgICAgIGFuZ3VsYXIubm9vcDtcclxuICAgIHZhciB0aHVtYiA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC10aHVtYicpKTtcclxuICAgIHZhciB0aHVtYlRleHQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtdGh1bWItdGV4dCcpKTtcclxuICAgIHZhciB0aHVtYkNvbnRhaW5lciA9IHRodW1iLnBhcmVudCgpO1xyXG4gICAgdmFyIHRyYWNrQ29udGFpbmVyID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLXRyYWNrLWNvbnRhaW5lcicpKTtcclxuICAgIHZhciBhY3RpdmVUcmFjayA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC10cmFjay1maWxsJykpO1xyXG4gICAgdmFyIHRpY2tDb250YWluZXIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtdHJhY2stdGlja3MnKSk7XHJcbiAgICB2YXIgdGhyb3R0bGVkUmVmcmVzaERpbWVuc2lvbnMgPSAkbWRVdGlsLnRocm90dGxlKHJlZnJlc2hTbGlkZXJEaW1lbnNpb25zLCA1MDAwKTtcclxuXHJcbiAgICAvLyBEZWZhdWx0IHZhbHVlcywgb3ZlcnJpZGFibGUgYnkgYXR0cnNcclxuICAgIGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHIubWluKSA/IGF0dHIuJG9ic2VydmUoJ21pbicsIHVwZGF0ZU1pbikgOiB1cGRhdGVNaW4oMCk7XHJcbiAgICBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1heCkgPyBhdHRyLiRvYnNlcnZlKCdtYXgnLCB1cGRhdGVNYXgpIDogdXBkYXRlTWF4KDEwMCk7XHJcbiAgICBhbmd1bGFyLmlzRGVmaW5lZChhdHRyLnN0ZXApPyBhdHRyLiRvYnNlcnZlKCdzdGVwJywgdXBkYXRlU3RlcCkgOiB1cGRhdGVTdGVwKDEpO1xyXG5cclxuICAgIC8vIFdlIGhhdmUgdG8gbWFudWFsbHkgc3RvcCB0aGUgJHdhdGNoIG9uIG5nRGlzYWJsZWQgYmVjYXVzZSBpdCBleGlzdHNcclxuICAgIC8vIG9uIHRoZSBwYXJlbnQgc2NvcGUsIGFuZCB3b24ndCBiZSBhdXRvbWF0aWNhbGx5IGRlc3Ryb3llZCB3aGVuXHJcbiAgICAvLyB0aGUgY29tcG9uZW50IGlzIGRlc3Ryb3llZC5cclxuICAgIHZhciBzdG9wRGlzYWJsZWRXYXRjaCA9IGFuZ3VsYXIubm9vcDtcclxuICAgIGlmIChhdHRyLm5nRGlzYWJsZWQpIHtcclxuICAgICAgc3RvcERpc2FibGVkV2F0Y2ggPSBzY29wZS4kcGFyZW50LiR3YXRjaChhdHRyLm5nRGlzYWJsZWQsIHVwZGF0ZUFyaWFEaXNhYmxlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgJG1kR2VzdHVyZS5yZWdpc3RlcihlbGVtZW50LCAnZHJhZycpO1xyXG5cclxuICAgIGVsZW1lbnRcclxuICAgICAgLm9uKCdrZXlkb3duJywga2V5ZG93bkxpc3RlbmVyKVxyXG4gICAgICAub24oJyRtZC5wcmVzc2Rvd24nLCBvblByZXNzRG93bilcclxuICAgICAgLm9uKCckbWQucHJlc3N1cCcsIG9uUHJlc3NVcClcclxuICAgICAgLm9uKCckbWQuZHJhZ3N0YXJ0Jywgb25EcmFnU3RhcnQpXHJcbiAgICAgIC5vbignJG1kLmRyYWcnLCBvbkRyYWcpXHJcbiAgICAgIC5vbignJG1kLmRyYWdlbmQnLCBvbkRyYWdFbmQpO1xyXG5cclxuICAgIC8vIE9uIHJlc2l6ZSwgcmVjYWxjdWxhdGUgdGhlIHNsaWRlcidzIGRpbWVuc2lvbnMgYW5kIHJlLXJlbmRlclxyXG4gICAgZnVuY3Rpb24gdXBkYXRlQWxsKCkge1xyXG4gICAgICByZWZyZXNoU2xpZGVyRGltZW5zaW9ucygpO1xyXG4gICAgICBuZ01vZGVsUmVuZGVyKCk7XHJcbiAgICAgIHJlZHJhd1RpY2tzKCk7XHJcbiAgICB9XHJcbiAgICBzZXRUaW1lb3V0KHVwZGF0ZUFsbCk7XHJcblxyXG4gICAgdmFyIGRlYm91bmNlZFVwZGF0ZUFsbCA9ICQkckFGLnRocm90dGxlKHVwZGF0ZUFsbCk7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ3Jlc2l6ZScsIGRlYm91bmNlZFVwZGF0ZUFsbCk7XHJcblxyXG4gICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdyZXNpemUnLCBkZWJvdW5jZWRVcGRhdGVBbGwpO1xyXG4gICAgICBzdG9wRGlzYWJsZWRXYXRjaCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgbmdNb2RlbEN0cmwuJHJlbmRlciA9IG5nTW9kZWxSZW5kZXI7XHJcbiAgICBuZ01vZGVsQ3RybC4kdmlld0NoYW5nZUxpc3RlbmVycy5wdXNoKG5nTW9kZWxSZW5kZXIpO1xyXG4gICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChtaW5NYXhWYWxpZGF0b3IpO1xyXG4gICAgbmdNb2RlbEN0cmwuJGZvcm1hdHRlcnMucHVzaChzdGVwVmFsaWRhdG9yKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEF0dHJpYnV0ZXNcclxuICAgICAqL1xyXG4gICAgdmFyIG1pbjtcclxuICAgIHZhciBtYXg7XHJcbiAgICB2YXIgc3RlcDtcclxuICAgIGZ1bmN0aW9uIHVwZGF0ZU1pbih2YWx1ZSkge1xyXG4gICAgICBtaW4gPSBwYXJzZUZsb2F0KHZhbHVlKTtcclxuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWluJywgdmFsdWUpO1xyXG4gICAgICB1cGRhdGVBbGwoKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZU1heCh2YWx1ZSkge1xyXG4gICAgICBtYXggPSBwYXJzZUZsb2F0KHZhbHVlKTtcclxuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLXZhbHVlbWF4JywgdmFsdWUpO1xyXG4gICAgICB1cGRhdGVBbGwoKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZVN0ZXAodmFsdWUpIHtcclxuICAgICAgc3RlcCA9IHBhcnNlRmxvYXQodmFsdWUpO1xyXG4gICAgICByZWRyYXdUaWNrcygpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdXBkYXRlQXJpYURpc2FibGVkKGlzRGlzYWJsZWQpIHtcclxuICAgICAgZWxlbWVudC5hdHRyKCdhcmlhLWRpc2FibGVkJywgISFpc0Rpc2FibGVkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBEcmF3IHRoZSB0aWNrcyB3aXRoIGNhbnZhcy5cclxuICAgIC8vIFRoZSBhbHRlcm5hdGl2ZSB0byBkcmF3aW5nIHRpY2tzIHdpdGggY2FudmFzIGlzIHRvIGRyYXcgb25lIGVsZW1lbnQgZm9yIGVhY2ggdGljayxcclxuICAgIC8vIHdoaWNoIGNvdWxkIHF1aWNrbHkgYmVjb21lIGEgcGVyZm9ybWFuY2UgYm90dGxlbmVjay5cclxuICAgIHZhciB0aWNrQ2FudmFzLCB0aWNrQ3R4O1xyXG4gICAgZnVuY3Rpb24gcmVkcmF3VGlja3MoKSB7XHJcbiAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQoYXR0ci5tZERpc2NyZXRlKSkgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIG51bVN0ZXBzID0gTWF0aC5mbG9vciggKG1heCAtIG1pbikgLyBzdGVwICk7XHJcbiAgICAgIGlmICghdGlja0NhbnZhcykge1xyXG4gICAgICAgIHZhciB0cmFja1RpY2tzU3R5bGUgPSAkd2luZG93LmdldENvbXB1dGVkU3R5bGUodGlja0NvbnRhaW5lclswXSk7XHJcbiAgICAgICAgdGlja0NhbnZhcyA9IGFuZ3VsYXIuZWxlbWVudCgnPGNhbnZhcyBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO1wiPicpO1xyXG4gICAgICAgIHRpY2tDdHggPSB0aWNrQ2FudmFzWzBdLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgdGlja0N0eC5maWxsU3R5bGUgPSB0cmFja1RpY2tzU3R5bGUuYmFja2dyb3VuZENvbG9yIHx8ICdibGFjayc7XHJcbiAgICAgICAgdGlja0NvbnRhaW5lci5hcHBlbmQodGlja0NhbnZhcyk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGRpbWVuc2lvbnMgPSBnZXRTbGlkZXJEaW1lbnNpb25zKCk7XHJcbiAgICAgIHRpY2tDYW52YXNbMF0ud2lkdGggPSBkaW1lbnNpb25zLndpZHRoO1xyXG4gICAgICB0aWNrQ2FudmFzWzBdLmhlaWdodCA9IGRpbWVuc2lvbnMuaGVpZ2h0O1xyXG5cclxuICAgICAgdmFyIGRpc3RhbmNlO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBudW1TdGVwczsgaSsrKSB7XHJcbiAgICAgICAgZGlzdGFuY2UgPSBNYXRoLmZsb29yKGRpbWVuc2lvbnMud2lkdGggKiAoaSAvIG51bVN0ZXBzKSk7XHJcbiAgICAgICAgdGlja0N0eC5maWxsUmVjdChkaXN0YW5jZSAtIDEsIDAsIDIsIGRpbWVuc2lvbnMuaGVpZ2h0KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlZnJlc2hpbmcgRGltZW5zaW9uc1xyXG4gICAgICovXHJcbiAgICB2YXIgc2xpZGVyRGltZW5zaW9ucyA9IHt9O1xyXG4gICAgcmVmcmVzaFNsaWRlckRpbWVuc2lvbnMoKTtcclxuICAgIGZ1bmN0aW9uIHJlZnJlc2hTbGlkZXJEaW1lbnNpb25zKCkge1xyXG4gICAgICBzbGlkZXJEaW1lbnNpb25zID0gdHJhY2tDb250YWluZXJbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZXRTbGlkZXJEaW1lbnNpb25zKCkge1xyXG4gICAgICB0aHJvdHRsZWRSZWZyZXNoRGltZW5zaW9ucygpO1xyXG4gICAgICByZXR1cm4gc2xpZGVyRGltZW5zaW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIGxlZnQvcmlnaHQgYXJyb3cgbGlzdGVuZXJcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24ga2V5ZG93bkxpc3RlbmVyKGV2KSB7XHJcbiAgICAgIGlmKGVsZW1lbnRbMF0uaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgY2hhbmdlQW1vdW50O1xyXG4gICAgICBpZiAoZXYua2V5Q29kZSA9PT0gJG1kQ29uc3RhbnQuS0VZX0NPREUuTEVGVF9BUlJPVykge1xyXG4gICAgICAgIGNoYW5nZUFtb3VudCA9IC1zdGVwO1xyXG4gICAgICB9IGVsc2UgaWYgKGV2LmtleUNvZGUgPT09ICRtZENvbnN0YW50LktFWV9DT0RFLlJJR0hUX0FSUk9XKSB7XHJcbiAgICAgICAgY2hhbmdlQW1vdW50ID0gc3RlcDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoY2hhbmdlQW1vdW50KSB7XHJcbiAgICAgICAgaWYgKGV2Lm1ldGFLZXkgfHwgZXYuY3RybEtleSB8fCBldi5hbHRLZXkpIHtcclxuICAgICAgICAgIGNoYW5nZUFtb3VudCAqPSA0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIHNjb3BlLiRldmFsQXN5bmMoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBzZXRNb2RlbFZhbHVlKG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgKyBjaGFuZ2VBbW91bnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBuZ01vZGVsIHNldHRlcnMgYW5kIHZhbGlkYXRvcnNcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gc2V0TW9kZWxWYWx1ZSh2YWx1ZSkge1xyXG4gICAgICBuZ01vZGVsQ3RybC4kc2V0Vmlld1ZhbHVlKCBtaW5NYXhWYWxpZGF0b3Ioc3RlcFZhbGlkYXRvcih2YWx1ZSkpICk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBuZ01vZGVsUmVuZGVyKCkge1xyXG4gICAgICBpZiAoaXNOYU4obmdNb2RlbEN0cmwuJHZpZXdWYWx1ZSkpIHtcclxuICAgICAgICBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlID0gbmdNb2RlbEN0cmwuJG1vZGVsVmFsdWU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBwZXJjZW50ID0gKG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgLSBtaW4pIC8gKG1heCAtIG1pbik7XHJcbiAgICAgIHNjb3BlLm1vZGVsVmFsdWUgPSBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlO1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ2FyaWEtdmFsdWVub3cnLCBuZ01vZGVsQ3RybC4kdmlld1ZhbHVlKTtcclxuICAgICAgc2V0U2xpZGVyUGVyY2VudChwZXJjZW50KTtcclxuICAgICAgdGh1bWJUZXh0LnRleHQoIG5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBtaW5NYXhWYWxpZGF0b3IodmFsdWUpIHtcclxuICAgICAgaWYgKGFuZ3VsYXIuaXNOdW1iZXIodmFsdWUpKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCB2YWx1ZSkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBzdGVwVmFsaWRhdG9yKHZhbHVlKSB7XHJcbiAgICAgIGlmIChhbmd1bGFyLmlzTnVtYmVyKHZhbHVlKSkge1xyXG4gICAgICAgIHZhciBmb3JtYXR0ZWRWYWx1ZSA9IChNYXRoLnJvdW5kKHZhbHVlIC8gc3RlcCkgKiBzdGVwKTtcclxuICAgICAgICAvLyBGb3JtYXQgdG8gMyBkaWdpdHMgYWZ0ZXIgdGhlIGRlY2ltYWwgcG9pbnQgLSBmaXhlcyAjMjAxNS5cclxuICAgICAgICByZXR1cm4gKE1hdGgucm91bmQoZm9ybWF0dGVkVmFsdWUgKiAxMDAwKSAvIDEwMDApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gcGVyY2VudCAwLTFcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gc2V0U2xpZGVyUGVyY2VudChwZXJjZW50KSB7XHJcbiAgICAgIGFjdGl2ZVRyYWNrLmNzcygnd2lkdGgnLCAocGVyY2VudCAqIDEwMCkgKyAnJScpO1xyXG4gICAgICB0aHVtYkNvbnRhaW5lci5jc3MoXHJcbiAgICAgICAgJ2xlZnQnLFxyXG4gICAgICAgIChwZXJjZW50ICogMTAwKSArICclJ1xyXG4gICAgICApO1xyXG4gICAgICBlbGVtZW50LnRvZ2dsZUNsYXNzKCdtZC1taW4nLCBwZXJjZW50ID09PSAwKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTbGlkZSBsaXN0ZW5lcnNcclxuICAgICAqL1xyXG4gICAgdmFyIGlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgIHZhciBpc0Rpc2NyZXRlID0gYW5ndWxhci5pc0RlZmluZWQoYXR0ci5tZERpc2NyZXRlKTtcclxuXHJcbiAgICBmdW5jdGlvbiBvblByZXNzRG93bihldikge1xyXG4gICAgICBpZiAoaXNEaXNhYmxlZEdldHRlcigpKSByZXR1cm47XHJcblxyXG4gICAgICBlbGVtZW50LmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgZWxlbWVudFswXS5mb2N1cygpO1xyXG4gICAgICByZWZyZXNoU2xpZGVyRGltZW5zaW9ucygpO1xyXG5cclxuICAgICAgdmFyIGV4YWN0VmFsID0gcGVyY2VudFRvVmFsdWUoIHBvc2l0aW9uVG9QZXJjZW50KCBldi5wb2ludGVyLnggKSk7XHJcbiAgICAgIHZhciBjbG9zZXN0VmFsID0gbWluTWF4VmFsaWRhdG9yKCBzdGVwVmFsaWRhdG9yKGV4YWN0VmFsKSApO1xyXG4gICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc2V0TW9kZWxWYWx1ZSggY2xvc2VzdFZhbCApO1xyXG4gICAgICAgIHNldFNsaWRlclBlcmNlbnQoIHZhbHVlVG9QZXJjZW50KGNsb3Nlc3RWYWwpKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBvblByZXNzVXAoZXYpIHtcclxuICAgICAgaWYgKGlzRGlzYWJsZWRHZXR0ZXIoKSkgcmV0dXJuO1xyXG5cclxuICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZHJhZ2dpbmcgYWN0aXZlJyk7XHJcblxyXG4gICAgICB2YXIgZXhhY3RWYWwgPSBwZXJjZW50VG9WYWx1ZSggcG9zaXRpb25Ub1BlcmNlbnQoIGV2LnBvaW50ZXIueCApKTtcclxuICAgICAgdmFyIGNsb3Nlc3RWYWwgPSBtaW5NYXhWYWxpZGF0b3IoIHN0ZXBWYWxpZGF0b3IoZXhhY3RWYWwpICk7XHJcbiAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICBzZXRNb2RlbFZhbHVlKGNsb3Nlc3RWYWwpO1xyXG4gICAgICAgIG5nTW9kZWxSZW5kZXIoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBvbkRyYWdTdGFydChldikge1xyXG4gICAgICBpZiAoaXNEaXNhYmxlZEdldHRlcigpKSByZXR1cm47XHJcbiAgICAgIGlzRHJhZ2dpbmcgPSB0cnVlO1xyXG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2RyYWdnaW5nJyk7XHJcbiAgICAgIHNldFNsaWRlckZyb21FdmVudChldik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBvbkRyYWcoZXYpIHtcclxuICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XHJcbiAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICBzZXRTbGlkZXJGcm9tRXZlbnQoZXYpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gb25EcmFnRW5kKGV2KSB7XHJcbiAgICAgIGlmICghaXNEcmFnZ2luZykgcmV0dXJuO1xyXG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgaXNEcmFnZ2luZyA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldFNsaWRlckZyb21FdmVudChldikge1xyXG4gICAgICAvLyBXaGlsZSBwYW5uaW5nIGRpc2NyZXRlLCB1cGRhdGUgb25seSB0aGVcclxuICAgICAgLy8gdmlzdWFsIHBvc2l0aW9uaW5nIGJ1dCBub3QgdGhlIG1vZGVsIHZhbHVlLlxyXG4gICAgICBpZiAoIGlzRGlzY3JldGUgKSBhZGp1c3RUaHVtYlBvc2l0aW9uKCBldi5wb2ludGVyLnggKTtcclxuICAgICAgZWxzZSAgICAgICAgICAgICAgZG9TbGlkZSggZXYucG9pbnRlci54ICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTbGlkZSB0aGUgVUkgYnkgY2hhbmdpbmcgdGhlIG1vZGVsIHZhbHVlXHJcbiAgICAgKiBAcGFyYW0geFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBkb1NsaWRlKCB4ICkge1xyXG4gICAgICBzY29wZS4kZXZhbEFzeW5jKCBmdW5jdGlvbigpIHtcclxuICAgICAgICBzZXRNb2RlbFZhbHVlKCBwZXJjZW50VG9WYWx1ZSggcG9zaXRpb25Ub1BlcmNlbnQoeCkgKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2xpZGUgdGhlIFVJIHdpdGhvdXQgY2hhbmdpbmcgdGhlIG1vZGVsICh3aGlsZSBkcmFnZ2luZy9wYW5uaW5nKVxyXG4gICAgICogQHBhcmFtIHhcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gYWRqdXN0VGh1bWJQb3NpdGlvbiggeCApIHtcclxuICAgICAgdmFyIGV4YWN0VmFsID0gcGVyY2VudFRvVmFsdWUoIHBvc2l0aW9uVG9QZXJjZW50KCB4ICkpO1xyXG4gICAgICB2YXIgY2xvc2VzdFZhbCA9IG1pbk1heFZhbGlkYXRvciggc3RlcFZhbGlkYXRvcihleGFjdFZhbCkgKTtcclxuICAgICAgc2V0U2xpZGVyUGVyY2VudCggcG9zaXRpb25Ub1BlcmNlbnQoeCkgKTtcclxuICAgICAgdGh1bWJUZXh0LnRleHQoIGNsb3Nlc3RWYWwgKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnQgaG9yaXpvbnRhbCBwb3NpdGlvbiBvbiBzbGlkZXIgdG8gcGVyY2VudGFnZSB2YWx1ZSBvZiBvZmZzZXQgZnJvbSBiZWdpbm5pbmcuLi5cclxuICAgICAqIEBwYXJhbSB4XHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBwb3NpdGlvblRvUGVyY2VudCggeCApIHtcclxuICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEsICh4IC0gc2xpZGVyRGltZW5zaW9ucy5sZWZ0KSAvIChzbGlkZXJEaW1lbnNpb25zLndpZHRoKSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydCBwZXJjZW50YWdlIG9mZnNldCBvbiBzbGlkZSB0byBlcXVpdmFsZW50IG1vZGVsIHZhbHVlXHJcbiAgICAgKiBAcGFyYW0gcGVyY2VudFxyXG4gICAgICogQHJldHVybnMgeyp9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHBlcmNlbnRUb1ZhbHVlKCBwZXJjZW50ICkge1xyXG4gICAgICByZXR1cm4gKG1pbiArIHBlcmNlbnQgKiAobWF4IC0gbWluKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdmFsdWVUb1BlcmNlbnQoIHZhbCApIHtcclxuICAgICAgcmV0dXJuICh2YWwgLSBtaW4pLyhtYXggLSBtaW4pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5TbGlkZXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiQkckFGXCIsIFwiJHdpbmRvd1wiLCBcIiRtZEFyaWFcIiwgXCIkbWRVdGlsXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbWRUaGVtaW5nXCIsIFwiJG1kR2VzdHVyZVwiLCBcIiRwYXJzZVwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy5zdGlja3lcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqXHJcbiAqIFN0aWNreSBlZmZlY3RzIGZvciBtZFxyXG4gKi9cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnN0aWNreScsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuY29udGVudCdcclxuXSlcclxuICAuZmFjdG9yeSgnJG1kU3RpY2t5JywgTWRTdGlja3kpO1xyXG5cclxuLypcclxuICogQG5nZG9jIHNlcnZpY2VcclxuICogQG5hbWUgJG1kU3RpY2t5XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5zdGlja3lcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgJG1kU3RpY2t5YHNlcnZpY2UgcHJvdmlkZXMgYSBtaXhpbiB0byBtYWtlIGVsZW1lbnRzIHN0aWNreS5cclxuICpcclxuICogQHJldHVybnMgQSBgJG1kU3RpY2t5YCBmdW5jdGlvbiB0aGF0IHRha2VzIHRocmVlIGFyZ3VtZW50czpcclxuICogICAtIGBzY29wZWBcclxuICogICAtIGBlbGVtZW50YDogVGhlIGVsZW1lbnQgdGhhdCB3aWxsIGJlICdzdGlja3knXHJcbiAqICAgLSBgZWxlbWVudENsb25lYDogQSBjbG9uZSBvZiB0aGUgZWxlbWVudCwgdGhhdCB3aWxsIGJlIHNob3duXHJcbiAqICAgICB3aGVuIHRoZSB1c2VyIHN0YXJ0cyBzY3JvbGxpbmcgcGFzdCB0aGUgb3JpZ2luYWwgZWxlbWVudC5cclxuICogICAgIElmIG5vdCBwcm92aWRlZCwgaXQgd2lsbCB1c2UgdGhlIHJlc3VsdCBvZiBgZWxlbWVudC5jbG9uZSgpYC5cclxuICovXHJcblxyXG5mdW5jdGlvbiBNZFN0aWNreSgkZG9jdW1lbnQsICRtZENvbnN0YW50LCAkY29tcGlsZSwgJCRyQUYsICRtZFV0aWwpIHtcclxuXHJcbiAgdmFyIGJyb3dzZXJTdGlja3lTdXBwb3J0ID0gY2hlY2tTdGlja3lTdXBwb3J0KCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlZ2lzdGVycyBhbiBlbGVtZW50IGFzIHN0aWNreSwgdXNlZCBpbnRlcm5hbGx5IGJ5IGRpcmVjdGl2ZXMgdG8gcmVnaXN0ZXIgdGhlbXNlbHZlc1xyXG4gICAqL1xyXG4gIHJldHVybiBmdW5jdGlvbiByZWdpc3RlclN0aWNreUVsZW1lbnQoc2NvcGUsIGVsZW1lbnQsIHN0aWNreUNsb25lKSB7XHJcbiAgICB2YXIgY29udGVudEN0cmwgPSBlbGVtZW50LmNvbnRyb2xsZXIoJ21kQ29udGVudCcpO1xyXG4gICAgaWYgKCFjb250ZW50Q3RybCkgcmV0dXJuO1xyXG5cclxuICAgIGlmIChicm93c2VyU3RpY2t5U3VwcG9ydCkge1xyXG4gICAgICBlbGVtZW50LmNzcyh7XHJcbiAgICAgICAgcG9zaXRpb246IGJyb3dzZXJTdGlja3lTdXBwb3J0LFxyXG4gICAgICAgIHRvcDogMCxcclxuICAgICAgICAnei1pbmRleCc6IDJcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB2YXIgJCRzdGlja3kgPSBjb250ZW50Q3RybC4kZWxlbWVudC5kYXRhKCckJHN0aWNreScpO1xyXG4gICAgICBpZiAoISQkc3RpY2t5KSB7XHJcbiAgICAgICAgJCRzdGlja3kgPSBzZXR1cFN0aWNreShjb250ZW50Q3RybCk7XHJcbiAgICAgICAgY29udGVudEN0cmwuJGVsZW1lbnQuZGF0YSgnJCRzdGlja3knLCAkJHN0aWNreSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBkZXJlZ2lzdGVyID0gJCRzdGlja3kuYWRkKGVsZW1lbnQsIHN0aWNreUNsb25lIHx8IGVsZW1lbnQuY2xvbmUoKSk7XHJcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBkZXJlZ2lzdGVyKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBzZXR1cFN0aWNreShjb250ZW50Q3RybCkge1xyXG4gICAgdmFyIGNvbnRlbnRFbCA9IGNvbnRlbnRDdHJsLiRlbGVtZW50O1xyXG5cclxuICAgIC8vIFJlZnJlc2ggZWxlbWVudHMgaXMgdmVyeSBleHBlbnNpdmUsIHNvIHdlIHVzZSB0aGUgZGVib3VuY2VkXHJcbiAgICAvLyB2ZXJzaW9uIHdoZW4gcG9zc2libGUuXHJcbiAgICB2YXIgZGVib3VuY2VkUmVmcmVzaEVsZW1lbnRzID0gJCRyQUYudGhyb3R0bGUocmVmcmVzaEVsZW1lbnRzKTtcclxuXHJcbiAgICAvLyBzZXR1cEF1Z21lbnRlZFNjcm9sbEV2ZW50cyBnaXZlcyB1cyBgJHNjcm9sbHN0YXJ0YCBhbmQgYCRzY3JvbGxgLFxyXG4gICAgLy8gbW9yZSByZWxpYWJsZSB0aGFuIGBzY3JvbGxgIG9uIGFuZHJvaWQuXHJcbiAgICBzZXR1cEF1Z21lbnRlZFNjcm9sbEV2ZW50cyhjb250ZW50RWwpO1xyXG4gICAgY29udGVudEVsLm9uKCckc2Nyb2xsc3RhcnQnLCBkZWJvdW5jZWRSZWZyZXNoRWxlbWVudHMpO1xyXG4gICAgY29udGVudEVsLm9uKCckc2Nyb2xsJywgb25TY3JvbGwpO1xyXG5cclxuICAgIHZhciBzZWxmO1xyXG4gICAgdmFyIHN0aWNreUJhc2VvZmZzZXQgPSBjb250ZW50RWwucHJvcCgnb2Zmc2V0VG9wJyk7XHJcbiAgICByZXR1cm4gc2VsZiA9IHtcclxuICAgICAgcHJldjogbnVsbCxcclxuICAgICAgY3VycmVudDogbnVsbCwgLy90aGUgY3VycmVudGx5IHN0aWNraWVkIGl0ZW1cclxuICAgICAgbmV4dDogbnVsbCxcclxuICAgICAgaXRlbXM6IFtdLFxyXG4gICAgICBhZGQ6IGFkZCxcclxuICAgICAgcmVmcmVzaEVsZW1lbnRzOiByZWZyZXNoRWxlbWVudHNcclxuICAgIH07XHJcblxyXG4gICAgLyoqKioqKioqKioqKioqKlxyXG4gICAgICogUHVibGljXHJcbiAgICAgKioqKioqKioqKioqKioqL1xyXG4gICAgLy8gQWRkIGFuIGVsZW1lbnQgYW5kIGl0cyBzdGlja3kgY2xvbmUgdG8gdGhpcyBjb250ZW50J3Mgc3RpY2t5IGNvbGxlY3Rpb25cclxuICAgIGZ1bmN0aW9uIGFkZChlbGVtZW50LCBzdGlja3lDbG9uZSkge1xyXG4gICAgICBzdGlja3lDbG9uZS5hZGRDbGFzcygnbWQtc3RpY2t5LWNsb25lJyk7XHJcbiAgICAgIHN0aWNreUNsb25lLmNzcygndG9wJywgc3RpY2t5QmFzZW9mZnNldCArICdweCcpO1xyXG5cclxuICAgICAgdmFyIGl0ZW0gPSB7XHJcbiAgICAgICAgZWxlbWVudDogZWxlbWVudCxcclxuICAgICAgICBjbG9uZTogc3RpY2t5Q2xvbmVcclxuICAgICAgfTtcclxuICAgICAgc2VsZi5pdGVtcy5wdXNoKGl0ZW0pO1xyXG5cclxuICAgICAgY29udGVudEVsLnBhcmVudCgpLnByZXBlbmQoaXRlbS5jbG9uZSk7XHJcblxyXG4gICAgICBkZWJvdW5jZWRSZWZyZXNoRWxlbWVudHMoKTtcclxuXHJcbiAgICAgIHJldHVybiBmdW5jdGlvbiByZW1vdmUoKSB7XHJcbiAgICAgICAgc2VsZi5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XHJcbiAgICAgICAgICBpZiAoaXRlbS5lbGVtZW50WzBdID09PSBlbGVtZW50WzBdKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgaXRlbS5jbG9uZS5yZW1vdmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBkZWJvdW5jZWRSZWZyZXNoRWxlbWVudHMoKTtcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZWZyZXNoRWxlbWVudHMoKSB7XHJcbiAgICAgIC8vIFNvcnQgb3VyIGNvbGxlY3Rpb24gb2YgZWxlbWVudHMgYnkgdGhlaXIgY3VycmVudCBwb3NpdGlvbiBpbiB0aGUgRE9NLlxyXG4gICAgICAvLyBXZSBuZWVkIHRvIGRvIHRoaXMgYmVjYXVzZSBvdXIgZWxlbWVudHMnIG9yZGVyIG9mIGJlaW5nIGFkZGVkIG1heSBub3RcclxuICAgICAgLy8gYmUgdGhlIHNhbWUgYXMgdGhlaXIgb3JkZXIgb2YgZGlzcGxheS5cclxuICAgICAgc2VsZi5pdGVtcy5mb3JFYWNoKHJlZnJlc2hQb3NpdGlvbik7XHJcbiAgICAgIHNlbGYuaXRlbXMgPSBzZWxmLml0ZW1zLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgIHJldHVybiBhLnRvcCA8IGIudG9wID8gLTEgOiAxO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIEZpbmQgd2hpY2ggaXRlbSBpbiB0aGUgbGlzdCBzaG91bGQgYmUgYWN0aXZlLCBcclxuICAgICAgLy8gYmFzZWQgdXBvbiB0aGUgY29udGVudCdzIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uXHJcbiAgICAgIHZhciBpdGVtO1xyXG4gICAgICB2YXIgY3VycmVudFNjcm9sbFRvcCA9IGNvbnRlbnRFbC5wcm9wKCdzY3JvbGxUb3AnKTtcclxuICAgICAgZm9yICh2YXIgaSA9IHNlbGYuaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICBpZiAoY3VycmVudFNjcm9sbFRvcCA+IHNlbGYuaXRlbXNbaV0udG9wKSB7XHJcbiAgICAgICAgICBpdGVtID0gc2VsZi5pdGVtc1tpXTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBzZXRDdXJyZW50SXRlbShpdGVtKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqKioqKioqKioqKioqKlxyXG4gICAgICogUHJpdmF0ZVxyXG4gICAgICoqKioqKioqKioqKioqKi9cclxuXHJcbiAgICAvLyBGaW5kIHRoZSBgdG9wYCBvZiBhbiBpdGVtIHJlbGF0aXZlIHRvIHRoZSBjb250ZW50IGVsZW1lbnQsXHJcbiAgICAvLyBhbmQgYWxzbyB0aGUgaGVpZ2h0LlxyXG4gICAgZnVuY3Rpb24gcmVmcmVzaFBvc2l0aW9uKGl0ZW0pIHtcclxuICAgICAgLy8gRmluZCB0aGUgdG9wIG9mIGFuIGl0ZW0gYnkgYWRkaW5nIHRvIHRoZSBvZmZzZXRIZWlnaHQgdW50aWwgd2UgcmVhY2ggdGhlIFxyXG4gICAgICAvLyBjb250ZW50IGVsZW1lbnQuXHJcbiAgICAgIHZhciBjdXJyZW50ID0gaXRlbS5lbGVtZW50WzBdO1xyXG4gICAgICBpdGVtLnRvcCA9IDA7XHJcbiAgICAgIGl0ZW0ubGVmdCA9IDA7XHJcbiAgICAgIHdoaWxlIChjdXJyZW50ICYmIGN1cnJlbnQgIT09IGNvbnRlbnRFbFswXSkge1xyXG4gICAgICAgIGl0ZW0udG9wICs9IGN1cnJlbnQub2Zmc2V0VG9wO1xyXG4gICAgICAgIGl0ZW0ubGVmdCArPSBjdXJyZW50Lm9mZnNldExlZnQ7XHJcbiAgICAgICAgY3VycmVudCA9IGN1cnJlbnQub2Zmc2V0UGFyZW50O1xyXG4gICAgICB9XHJcbiAgICAgIGl0ZW0uaGVpZ2h0ID0gaXRlbS5lbGVtZW50LnByb3AoJ29mZnNldEhlaWdodCcpO1xyXG4gICAgICBpdGVtLmNsb25lLmNzcygnbWFyZ2luLWxlZnQnLCBpdGVtLmxlZnQgKyAncHgnKTtcclxuICAgICAgaWYgKCRtZFV0aWwuZmxvYXRpbmdTY3JvbGxiYXJzKCkpIHtcclxuICAgICAgICBpdGVtLmNsb25lLmNzcygnbWFyZ2luLXJpZ2h0JywgJzAnKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyBBcyB3ZSBzY3JvbGwsIHB1c2ggaW4gYW5kIHNlbGVjdCB0aGUgY29ycmVjdCBzdGlja3kgZWxlbWVudC5cclxuICAgIGZ1bmN0aW9uIG9uU2Nyb2xsKCkge1xyXG4gICAgICB2YXIgc2Nyb2xsVG9wID0gY29udGVudEVsLnByb3AoJ3Njcm9sbFRvcCcpO1xyXG4gICAgICB2YXIgaXNTY3JvbGxpbmdEb3duID0gc2Nyb2xsVG9wID4gKG9uU2Nyb2xsLnByZXZTY3JvbGxUb3AgfHwgMCk7XHJcbiAgICAgIG9uU2Nyb2xsLnByZXZTY3JvbGxUb3AgPSBzY3JvbGxUb3A7XHJcblxyXG4gICAgICAvLyBBdCB0aGUgdG9wP1xyXG4gICAgICBpZiAoc2Nyb2xsVG9wID09PSAwKSB7XHJcbiAgICAgICAgc2V0Q3VycmVudEl0ZW0obnVsbCk7XHJcblxyXG4gICAgICAvLyBHb2luZyB0byBuZXh0IGl0ZW0/XHJcbiAgICAgIH0gZWxzZSBpZiAoaXNTY3JvbGxpbmdEb3duICYmIHNlbGYubmV4dCkge1xyXG4gICAgICAgIGlmIChzZWxmLm5leHQudG9wIC0gc2Nyb2xsVG9wIDw9IDApIHtcclxuICAgICAgICAgIC8vIFN0aWNreSB0aGUgbmV4dCBpdGVtIGlmIHdlJ3ZlIHNjcm9sbGVkIHBhc3QgaXRzIHBvc2l0aW9uLlxyXG4gICAgICAgICAgc2V0Q3VycmVudEl0ZW0oc2VsZi5uZXh0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNlbGYuY3VycmVudCkge1xyXG4gICAgICAgICAgLy8gUHVzaCB0aGUgY3VycmVudCBpdGVtIHVwIHdoZW4gd2UncmUgYWxtb3N0IGF0IHRoZSBuZXh0IGl0ZW0uXHJcbiAgICAgICAgICBpZiAoc2VsZi5uZXh0LnRvcCAtIHNjcm9sbFRvcCA8PSBzZWxmLm5leHQuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRyYW5zbGF0ZShzZWxmLmN1cnJlbnQsIHNlbGYubmV4dC50b3AgLSBzZWxmLm5leHQuaGVpZ2h0IC0gc2Nyb2xsVG9wKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRyYW5zbGF0ZShzZWxmLmN1cnJlbnQsIG51bGwpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgLy8gU2Nyb2xsaW5nIHVwIHdpdGggYSBjdXJyZW50IHN0aWNreSBpdGVtP1xyXG4gICAgICB9IGVsc2UgaWYgKCFpc1Njcm9sbGluZ0Rvd24gJiYgc2VsZi5jdXJyZW50KSB7XHJcbiAgICAgICAgaWYgKHNjcm9sbFRvcCA8IHNlbGYuY3VycmVudC50b3ApIHtcclxuICAgICAgICAgIC8vIFN0aWNreSB0aGUgcHJldmlvdXMgaXRlbSBpZiB3ZSd2ZSBzY3JvbGxlZCB1cCBwYXN0XHJcbiAgICAgICAgICAvLyB0aGUgb3JpZ2luYWwgcG9zaXRpb24gb2YgdGhlIGN1cnJlbnRseSBzdGlja2llZCBpdGVtLlxyXG4gICAgICAgICAgc2V0Q3VycmVudEl0ZW0oc2VsZi5wcmV2KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2Nyb2xsaW5nIHVwLCBhbmQganVzdCBidW1waW5nIGludG8gdGhlIGl0ZW0gYWJvdmUgKGp1c3Qgc2V0IHRvIGN1cnJlbnQpP1xyXG4gICAgICAgIC8vIElmIHdlIGhhdmUgYSBuZXh0IGl0ZW0gYnVtcGluZyBpbnRvIHRoZSBjdXJyZW50IGl0ZW0sIHRyYW5zbGF0ZVxyXG4gICAgICAgIC8vIHRoZSBjdXJyZW50IGl0ZW0gdXAgZnJvbSB0aGUgdG9wIGFzIGl0IHNjcm9sbHMgaW50byB2aWV3LlxyXG4gICAgICAgIGlmIChzZWxmLmN1cnJlbnQgJiYgc2VsZi5uZXh0KSB7XHJcbiAgICAgICAgICBpZiAoc2Nyb2xsVG9wID49IHNlbGYubmV4dC50b3AgLSBzZWxmLmN1cnJlbnQuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRyYW5zbGF0ZShzZWxmLmN1cnJlbnQsIHNlbGYubmV4dC50b3AgLSBzY3JvbGxUb3AgLSBzZWxmLmN1cnJlbnQuaGVpZ2h0KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRyYW5zbGF0ZShzZWxmLmN1cnJlbnQsIG51bGwpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgIFxyXG4gICBmdW5jdGlvbiBzZXRDdXJyZW50SXRlbShpdGVtKSB7XHJcbiAgICAgaWYgKHNlbGYuY3VycmVudCA9PT0gaXRlbSkgcmV0dXJuO1xyXG4gICAgIC8vIERlYWN0aXZhdGUgY3VycmVudGx5IGFjdGl2ZSBpdGVtXHJcbiAgICAgaWYgKHNlbGYuY3VycmVudCkge1xyXG4gICAgICAgdHJhbnNsYXRlKHNlbGYuY3VycmVudCwgbnVsbCk7XHJcbiAgICAgICBzZXRTdGlja3lTdGF0ZShzZWxmLmN1cnJlbnQsIG51bGwpO1xyXG4gICAgIH1cclxuXHJcbiAgICAgLy8gQWN0aXZhdGUgbmV3IGl0ZW0gaWYgZ2l2ZW5cclxuICAgICBpZiAoaXRlbSkge1xyXG4gICAgICAgc2V0U3RpY2t5U3RhdGUoaXRlbSwgJ2FjdGl2ZScpO1xyXG4gICAgIH1cclxuXHJcbiAgICAgc2VsZi5jdXJyZW50ID0gaXRlbTtcclxuICAgICB2YXIgaW5kZXggPSBzZWxmLml0ZW1zLmluZGV4T2YoaXRlbSk7XHJcbiAgICAgLy8gSWYgaW5kZXggPT09IC0xLCBpbmRleCArIDEgPSAwLiBJdCB3b3JrcyBvdXQuXHJcbiAgICAgc2VsZi5uZXh0ID0gc2VsZi5pdGVtc1tpbmRleCArIDFdO1xyXG4gICAgIHNlbGYucHJldiA9IHNlbGYuaXRlbXNbaW5kZXggLSAxXTtcclxuICAgICBzZXRTdGlja3lTdGF0ZShzZWxmLm5leHQsICduZXh0Jyk7XHJcbiAgICAgc2V0U3RpY2t5U3RhdGUoc2VsZi5wcmV2LCAncHJldicpO1xyXG4gICB9XHJcblxyXG4gICBmdW5jdGlvbiBzZXRTdGlja3lTdGF0ZShpdGVtLCBzdGF0ZSkge1xyXG4gICAgIGlmICghaXRlbSB8fCBpdGVtLnN0YXRlID09PSBzdGF0ZSkgcmV0dXJuO1xyXG4gICAgIGlmIChpdGVtLnN0YXRlKSB7XHJcbiAgICAgICBpdGVtLmNsb25lLmF0dHIoJ3N0aWNreS1wcmV2LXN0YXRlJywgaXRlbS5zdGF0ZSk7XHJcbiAgICAgICBpdGVtLmVsZW1lbnQuYXR0cignc3RpY2t5LXByZXYtc3RhdGUnLCBpdGVtLnN0YXRlKTtcclxuICAgICB9XHJcbiAgICAgaXRlbS5jbG9uZS5hdHRyKCdzdGlja3ktc3RhdGUnLCBzdGF0ZSk7XHJcbiAgICAgaXRlbS5lbGVtZW50LmF0dHIoJ3N0aWNreS1zdGF0ZScsIHN0YXRlKTtcclxuICAgICBpdGVtLnN0YXRlID0gc3RhdGU7XHJcbiAgIH1cclxuXHJcbiAgIGZ1bmN0aW9uIHRyYW5zbGF0ZShpdGVtLCBhbW91bnQpIHtcclxuICAgICBpZiAoIWl0ZW0pIHJldHVybjtcclxuICAgICBpZiAoYW1vdW50ID09PSBudWxsIHx8IGFtb3VudCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICBpZiAoaXRlbS50cmFuc2xhdGVZKSB7XHJcbiAgICAgICAgIGl0ZW0udHJhbnNsYXRlWSA9IG51bGw7XHJcbiAgICAgICAgIGl0ZW0uY2xvbmUuY3NzKCRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sICcnKTtcclxuICAgICAgIH1cclxuICAgICB9IGVsc2Uge1xyXG4gICAgICAgaXRlbS50cmFuc2xhdGVZID0gYW1vdW50O1xyXG4gICAgICAgaXRlbS5jbG9uZS5jc3MoXHJcbiAgICAgICAgICRtZENvbnN0YW50LkNTUy5UUkFOU0ZPUk0sIFxyXG4gICAgICAgICAndHJhbnNsYXRlM2QoJyArIGl0ZW0ubGVmdCArICdweCwnICsgYW1vdW50ICsgJ3B4LDApJ1xyXG4gICAgICAgKTtcclxuICAgICB9XHJcbiAgIH1cclxuICB9XHJcblxyXG4gIC8vIEZ1bmN0aW9uIHRvIGNoZWNrIGZvciBicm93c2VyIHN0aWNreSBzdXBwb3J0XHJcbiAgZnVuY3Rpb24gY2hlY2tTdGlja3lTdXBwb3J0KCRlbCkge1xyXG4gICAgdmFyIHN0aWNreVByb3A7XHJcbiAgICB2YXIgdGVzdEVsID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2PicpO1xyXG4gICAgJGRvY3VtZW50WzBdLmJvZHkuYXBwZW5kQ2hpbGQodGVzdEVsWzBdKTtcclxuXHJcbiAgICB2YXIgc3RpY2t5UHJvcHMgPSBbJ3N0aWNreScsICctd2Via2l0LXN0aWNreSddO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGlja3lQcm9wcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICB0ZXN0RWwuY3NzKHtwb3NpdGlvbjogc3RpY2t5UHJvcHNbaV0sIHRvcDogMCwgJ3otaW5kZXgnOiAyfSk7XHJcbiAgICAgIGlmICh0ZXN0RWwuY3NzKCdwb3NpdGlvbicpID09IHN0aWNreVByb3BzW2ldKSB7XHJcbiAgICAgICAgc3RpY2t5UHJvcCA9IHN0aWNreVByb3BzW2ldO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0ZXN0RWwucmVtb3ZlKCk7XHJcbiAgICByZXR1cm4gc3RpY2t5UHJvcDtcclxuICB9XHJcblxyXG4gIC8vIEFuZHJvaWQgNC40IGRvbid0IGFjY3VyYXRlbHkgZ2l2ZSBzY3JvbGwgZXZlbnRzLlxyXG4gIC8vIFRvIGZpeCB0aGlzIHByb2JsZW0sIHdlIHNldHVwIGEgZmFrZSBzY3JvbGwgZXZlbnQuIFdlIHNheTpcclxuICAvLyA+IElmIGEgc2Nyb2xsIG9yIHRvdWNobW92ZSBldmVudCBoYXMgaGFwcGVuZWQgaW4gdGhlIGxhc3QgREVMQVkgbWlsbGlzZWNvbmRzLCBcclxuICAvLyAgIHRoZW4gc2VuZCBhIGAkc2Nyb2xsYCBldmVudCBldmVyeSBhbmltYXRpb25GcmFtZS5cclxuICAvLyBBZGRpdGlvbmFsbHksIHdlIGFkZCAkc2Nyb2xsc3RhcnQgYW5kICRzY3JvbGxlbmQgZXZlbnRzLlxyXG4gIGZ1bmN0aW9uIHNldHVwQXVnbWVudGVkU2Nyb2xsRXZlbnRzKGVsZW1lbnQpIHtcclxuICAgIHZhciBTQ1JPTExfRU5EX0RFTEFZID0gMjAwO1xyXG4gICAgdmFyIGlzU2Nyb2xsaW5nO1xyXG4gICAgdmFyIGxhc3RTY3JvbGxUaW1lO1xyXG4gICAgZWxlbWVudC5vbignc2Nyb2xsIHRvdWNobW92ZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICBpZiAoIWlzU2Nyb2xsaW5nKSB7XHJcbiAgICAgICAgaXNTY3JvbGxpbmcgPSB0cnVlO1xyXG4gICAgICAgICQkckFGKGxvb3BTY3JvbGxFdmVudCk7XHJcbiAgICAgICAgZWxlbWVudC50cmlnZ2VySGFuZGxlcignJHNjcm9sbHN0YXJ0Jyk7XHJcbiAgICAgIH1cclxuICAgICAgZWxlbWVudC50cmlnZ2VySGFuZGxlcignJHNjcm9sbCcpO1xyXG4gICAgICBsYXN0U2Nyb2xsVGltZSA9ICskbWRVdGlsLm5vdygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gbG9vcFNjcm9sbEV2ZW50KCkge1xyXG4gICAgICBpZiAoKyRtZFV0aWwubm93KCkgLSBsYXN0U2Nyb2xsVGltZSA+IFNDUk9MTF9FTkRfREVMQVkpIHtcclxuICAgICAgICBpc1Njcm9sbGluZyA9IGZhbHNlO1xyXG4gICAgICAgIGVsZW1lbnQudHJpZ2dlckhhbmRsZXIoJyRzY3JvbGxlbmQnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBlbGVtZW50LnRyaWdnZXJIYW5kbGVyKCckc2Nyb2xsJyk7XHJcbiAgICAgICAgJCRyQUYobG9vcFNjcm9sbEV2ZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbn1cclxuTWRTdGlja3kuJGluamVjdCA9IFtcIiRkb2N1bWVudFwiLCBcIiRtZENvbnN0YW50XCIsIFwiJGNvbXBpbGVcIiwgXCIkJHJBRlwiLCBcIiRtZFV0aWxcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnN1YmhlYWRlclxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogU3ViSGVhZGVyIG1vZHVsZVxyXG4gKlxyXG4gKiAgU3ViaGVhZGVycyBhcmUgc3BlY2lhbCBsaXN0IHRpbGVzIHRoYXQgZGVsaW5lYXRlIGRpc3RpbmN0IHNlY3Rpb25zIG9mIGFcclxuICogIGxpc3Qgb3IgZ3JpZCBsaXN0IGFuZCBhcmUgdHlwaWNhbGx5IHJlbGF0ZWQgdG8gdGhlIGN1cnJlbnQgZmlsdGVyaW5nIG9yXHJcbiAqICBzb3J0aW5nIGNyaXRlcmlhLiBTdWJoZWFkZXIgdGlsZXMgYXJlIGVpdGhlciBkaXNwbGF5ZWQgaW5saW5lIHdpdGggdGlsZXMgb3JcclxuICogIGNhbiBiZSBhc3NvY2lhdGVkIHdpdGggY29udGVudCwgZm9yIGV4YW1wbGUsIGluIGFuIGFkamFjZW50IGNvbHVtbi5cclxuICpcclxuICogIFVwb24gc2Nyb2xsaW5nLCBzdWJoZWFkZXJzIHJlbWFpbiBwaW5uZWQgdG8gdGhlIHRvcCBvZiB0aGUgc2NyZWVuIGFuZCByZW1haW5cclxuICogIHBpbm5lZCB1bnRpbCBwdXNoZWQgb24gb3Igb2ZmIHNjcmVlbiBieSB0aGUgbmV4dCBzdWJoZWFkZXIuIEBzZWUgW01hdGVyaWFsXHJcbiAqICBEZXNpZ24gU3BlY2lmaWNhdGlvbnNdKGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vZGVzaWduL3NwZWMvY29tcG9uZW50cy9zdWJoZWFkZXJzLmh0bWwpXHJcbiAqXHJcbiAqICA+IFRvIGltcHJvdmUgdGhlIHZpc3VhbCBncm91cGluZyBvZiBjb250ZW50LCB1c2UgdGhlIHN5c3RlbSBjb2xvciBmb3IgeW91ciBzdWJoZWFkZXJzLlxyXG4gKlxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuc3ViaGVhZGVyJywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5zdGlja3knXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRTdWJoZWFkZXInLCBNZFN1YmhlYWRlckRpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZFN1YmhlYWRlclxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuc3ViaGVhZGVyXHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUaGUgYDxtZC1zdWJoZWFkZXI+YCBkaXJlY3RpdmUgaXMgYSBzdWJoZWFkZXIgZm9yIGEgc2VjdGlvbi4gQnkgZGVmYXVsdCBpdCBpcyBzdGlja3kuXHJcbiAqIFlvdSBjYW4gbWFrZSBpdCBub3Qgc3RpY2t5IGJ5IGFwcGx5aW5nIHRoZSBgbWQtbm8tc3RpY2t5YCBjbGFzcyB0byB0aGUgc3ViaGVhZGVyLlxyXG4gKlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXN1YmhlYWRlcj5PbmxpbmUgRnJpZW5kczwvbWQtc3ViaGVhZGVyPlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gTWRTdWJoZWFkZXJEaXJlY3RpdmUoJG1kU3RpY2t5LCAkY29tcGlsZSwgJG1kVGhlbWluZykge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcmVwbGFjZTogdHJ1ZSxcclxuICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZTogXHJcbiAgICAgICc8aDIgY2xhc3M9XCJtZC1zdWJoZWFkZXJcIj4nICtcclxuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLXN1YmhlYWRlci1pbm5lclwiPicgK1xyXG4gICAgICAgICAgJzxzcGFuIGNsYXNzPVwibWQtc3ViaGVhZGVyLWNvbnRlbnRcIj48L3NwYW4+JyArXHJcbiAgICAgICAgJzwvZGl2PicgK1xyXG4gICAgICAnPC9oMj4nLFxyXG4gICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbWVudCwgYXR0ciwgdHJhbnNjbHVkZSkge1xyXG4gICAgICByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgICAgIHZhciBvdXRlckhUTUwgPSBlbGVtZW50WzBdLm91dGVySFRNTDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0Q29udGVudChlbCkge1xyXG4gICAgICAgICAgcmV0dXJuIGFuZ3VsYXIuZWxlbWVudChlbFswXS5xdWVyeVNlbGVjdG9yKCcubWQtc3ViaGVhZGVyLWNvbnRlbnQnKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBUcmFuc2NsdWRlIHRoZSB1c2VyLWdpdmVuIGNvbnRlbnRzIG9mIHRoZSBzdWJoZWFkZXJcclxuICAgICAgICAvLyB0aGUgY29udmVudGlvbmFsIHdheS5cclxuICAgICAgICB0cmFuc2NsdWRlKHNjb3BlLCBmdW5jdGlvbihjbG9uZSkge1xyXG4gICAgICAgICAgZ2V0Q29udGVudChlbGVtZW50KS5hcHBlbmQoY2xvbmUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgYW5vdGhlciBjbG9uZSwgdGhhdCB1c2VzIHRoZSBvdXRlciBhbmQgaW5uZXIgY29udGVudHNcclxuICAgICAgICAvLyBvZiB0aGUgZWxlbWVudCwgdGhhdCB3aWxsIGJlICdzdGlja2llZCcgYXMgdGhlIHVzZXIgc2Nyb2xscy5cclxuICAgICAgICBpZiAoIWVsZW1lbnQuaGFzQ2xhc3MoJ21kLW5vLXN0aWNreScpKSB7XHJcbiAgICAgICAgICB0cmFuc2NsdWRlKHNjb3BlLCBmdW5jdGlvbihjbG9uZSkge1xyXG4gICAgICAgICAgICB2YXIgc3RpY2t5Q2xvbmUgPSAkY29tcGlsZShhbmd1bGFyLmVsZW1lbnQob3V0ZXJIVE1MKSkoc2NvcGUpO1xyXG4gICAgICAgICAgICBnZXRDb250ZW50KHN0aWNreUNsb25lKS5hcHBlbmQoY2xvbmUpO1xyXG4gICAgICAgICAgICAkbWRTdGlja3koc2NvcGUsIGVsZW1lbnQsIHN0aWNreUNsb25lKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbk1kU3ViaGVhZGVyRGlyZWN0aXZlLiRpbmplY3QgPSBbXCIkbWRTdGlja3lcIiwgXCIkY29tcGlsZVwiLCBcIiRtZFRoZW1pbmdcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnN3aXBlXHJcbiAqIEBkZXNjcmlwdGlvbiBTd2lwZSBtb2R1bGUhXHJcbiAqL1xyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuc3dpcGVcclxuICogQG5hbWUgbWRTd2lwZUxlZnRcclxuICpcclxuICogQHJlc3RyaWN0IEFcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBtZC1zd2lwZS1sZWZ0IGRpcmVjdGl2ZXMgYWxsb3dzIHlvdSB0byBzcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciB3aGVuIGFuIGVsZW1lbnQgaXMgc3dpcGVkXHJcbiAqIGxlZnQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8ZGl2IG1kLXN3aXBlLWxlZnQ9XCJvblN3aXBlTGVmdCgpXCI+U3dpcGUgbWUgbGVmdCE8L2Rpdj5cclxuICogPC9obGpzPlxyXG4gKi9cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnN3aXBlXHJcbiAqIEBuYW1lIG1kU3dpcGVSaWdodFxyXG4gKlxyXG4gKiBAcmVzdHJpY3QgQVxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhlIG1kLXN3aXBlLXJpZ2h0IGRpcmVjdGl2ZXMgYWxsb3dzIHlvdSB0byBzcGVjaWZ5IGN1c3RvbSBiZWhhdmlvciB3aGVuIGFuIGVsZW1lbnQgaXMgc3dpcGVkXHJcbiAqIHJpZ2h0LlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPGRpdiBtZC1zd2lwZS1yaWdodD1cIm9uU3dpcGVSaWdodCgpXCI+U3dpcGUgbWUgcmlnaHQhPC9kaXY+XHJcbiAqIDwvaGxqcz5cclxuICovXHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5zd2lwZScsIFsnbWF0ZXJpYWwuY29yZSddKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRTd2lwZUxlZnQnLCBnZXREaXJlY3RpdmUoJ1N3aXBlTGVmdCcpKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRTd2lwZVJpZ2h0JywgZ2V0RGlyZWN0aXZlKCdTd2lwZVJpZ2h0JykpO1xyXG5cclxuZnVuY3Rpb24gZ2V0RGlyZWN0aXZlKG5hbWUpIHtcclxuICB2YXIgZGlyZWN0aXZlTmFtZSA9ICdtZCcgKyBuYW1lO1xyXG4gIHZhciBldmVudE5hbWUgPSAnJG1kLicgKyBuYW1lLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgRGlyZWN0aXZlRmFjdG9yeS4kaW5qZWN0ID0gW1wiJHBhcnNlXCJdO1xyXG4gIHJldHVybiBEaXJlY3RpdmVGYWN0b3J5O1xyXG5cclxuICAvKiBAbmdJbmplY3QgKi9cclxuICBmdW5jdGlvbiBEaXJlY3RpdmVGYWN0b3J5KCRwYXJzZSkge1xyXG4gICAgICByZXR1cm4geyByZXN0cmljdDogJ0EnLCBsaW5rOiBwb3N0TGluayB9O1xyXG4gICAgICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgIHZhciBmbiA9ICRwYXJzZShhdHRyW2RpcmVjdGl2ZU5hbWVdKTtcclxuICAgICAgICBlbGVtZW50Lm9uKGV2ZW50TmFtZSwgZnVuY3Rpb24oZXYpIHtcclxuICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHsgZm4oc2NvcGUsIHsgJGV2ZW50OiBldiB9KTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQHByaXZhdGVcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnN3aXRjaFxyXG4gKi9cclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnN3aXRjaCcsIFtcclxuICAnbWF0ZXJpYWwuY29yZScsXHJcbiAgJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hlY2tib3gnXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRTd2l0Y2gnLCBNZFN3aXRjaCk7XHJcblxyXG4vKipcclxuICogQHByaXZhdGVcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuc3dpdGNoXHJcbiAqIEBuYW1lIG1kU3dpdGNoXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIFRoZSBzd2l0Y2ggZGlyZWN0aXZlIGlzIHVzZWQgdmVyeSBtdWNoIGxpa2UgdGhlIG5vcm1hbCBbYW5ndWxhciBjaGVja2JveF0oaHR0cHM6Ly9kb2NzLmFuZ3VsYXJqcy5vcmcvYXBpL25nL2lucHV0L2lucHV0JTVCY2hlY2tib3glNUQpLlxyXG4gKlxyXG4gKiBBcyBwZXIgdGhlIFttYXRlcmlhbCBkZXNpZ24gc3BlY10oaHR0cDovL3d3dy5nb29nbGUuY29tL2Rlc2lnbi9zcGVjL3N0eWxlL2NvbG9yLmh0bWwjY29sb3ItdWktY29sb3ItYXBwbGljYXRpb24pXHJcbiAqIHRoZSBzd2l0Y2ggaXMgaW4gdGhlIGFjY2VudCBjb2xvciBieSBkZWZhdWx0LiBUaGUgcHJpbWFyeSBjb2xvciBwYWxldHRlIG1heSBiZSB1c2VkIHdpdGhcclxuICogdGhlIGBtZC1wcmltYXJ5YCBjbGFzcy5cclxuICpcclxuICogQHBhcmFtIHtzdHJpbmd9IG5nLW1vZGVsIEFzc2lnbmFibGUgYW5ndWxhciBleHByZXNzaW9uIHRvIGRhdGEtYmluZCB0by5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBuYW1lIFByb3BlcnR5IG5hbWUgb2YgdGhlIGZvcm0gdW5kZXIgd2hpY2ggdGhlIGNvbnRyb2wgaXMgcHVibGlzaGVkLlxyXG4gKiBAcGFyYW0ge2V4cHJlc3Npb249fSBuZy10cnVlLXZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gc2VsZWN0ZWQuXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG5nLWZhbHNlLXZhbHVlIFRoZSB2YWx1ZSB0byB3aGljaCB0aGUgZXhwcmVzc2lvbiBzaG91bGQgYmUgc2V0IHdoZW4gbm90IHNlbGVjdGVkLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG5nLWNoYW5nZSBBbmd1bGFyIGV4cHJlc3Npb24gdG8gYmUgZXhlY3V0ZWQgd2hlbiBpbnB1dCBjaGFuZ2VzIGR1ZSB0byB1c2VyIGludGVyYWN0aW9uIHdpdGggdGhlIGlucHV0IGVsZW1lbnQuXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWluayBVc2Ugb2YgYXR0cmlidXRlIGluZGljYXRlcyB1c2Ugb2YgcmlwcGxlIGluayBlZmZlY3RzLlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IGFyaWEtbGFiZWwgUHVibGlzaCB0aGUgYnV0dG9uIGxhYmVsIHVzZWQgYnkgc2NyZWVuLXJlYWRlcnMgZm9yIGFjY2Vzc2liaWxpdHkuIERlZmF1bHRzIHRvIHRoZSBzd2l0Y2gncyB0ZXh0LlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXN3aXRjaCBuZy1tb2RlbD1cImlzQWN0aXZlXCIgYXJpYS1sYWJlbD1cIkZpbmlzaGVkP1wiPlxyXG4gKiAgIEZpbmlzaGVkID9cclxuICogPC9tZC1zd2l0Y2g+XHJcbiAqXHJcbiAqIDxtZC1zd2l0Y2ggbWQtbm8taW5rIG5nLW1vZGVsPVwiaGFzSW5rXCIgYXJpYS1sYWJlbD1cIk5vIEluayBFZmZlY3RzXCI+XHJcbiAqICAgTm8gSW5rIEVmZmVjdHNcclxuICogPC9tZC1zd2l0Y2g+XHJcbiAqXHJcbiAqIDxtZC1zd2l0Y2ggbmctZGlzYWJsZWQ9XCJ0cnVlXCIgbmctbW9kZWw9XCJpc0Rpc2FibGVkXCIgYXJpYS1sYWJlbD1cIkRpc2FibGVkXCI+XHJcbiAqICAgRGlzYWJsZWRcclxuICogPC9tZC1zd2l0Y2g+XHJcbiAqXHJcbiAqIDwvaGxqcz5cclxuICovXHJcbmZ1bmN0aW9uIE1kU3dpdGNoKG1kQ2hlY2tib3hEaXJlY3RpdmUsICRtZFRoZW1pbmcsICRtZFV0aWwsICRkb2N1bWVudCwgJG1kQ29uc3RhbnQsICRwYXJzZSwgJCRyQUYsICRtZEdlc3R1cmUpIHtcclxuICB2YXIgY2hlY2tib3hEaXJlY3RpdmUgPSBtZENoZWNrYm94RGlyZWN0aXZlWzBdO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgIHByaW9yaXR5OjIxMCwgLy8gUnVuIGJlZm9yZSBuZ0FyaWFcclxuICAgIHRyYW5zY2x1ZGU6IHRydWUsXHJcbiAgICB0ZW1wbGF0ZTpcclxuICAgICAgJzxkaXYgY2xhc3M9XCJtZC1jb250YWluZXJcIj4nICtcclxuICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLWJhclwiPjwvZGl2PicgK1xyXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibWQtdGh1bWItY29udGFpbmVyXCI+JyArXHJcbiAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1kLXRodW1iXCIgbWQtaW5rLXJpcHBsZSBtZC1pbmstcmlwcGxlLWNoZWNrYm94PjwvZGl2PicgK1xyXG4gICAgICAgICc8L2Rpdj4nK1xyXG4gICAgICAnPC9kaXY+JyArXHJcbiAgICAgICc8ZGl2IG5nLXRyYW5zY2x1ZGUgY2xhc3M9XCJtZC1sYWJlbFwiPicgK1xyXG4gICAgICAnPC9kaXY+JyxcclxuICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXHJcbiAgICBjb21waWxlOiBjb21waWxlXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gY29tcGlsZShlbGVtZW50LCBhdHRyKSB7XHJcbiAgICB2YXIgY2hlY2tib3hMaW5rID0gY2hlY2tib3hEaXJlY3RpdmUuY29tcGlsZShlbGVtZW50LCBhdHRyKTtcclxuICAgIC8vIG5vIHRyYW5zaXRpb24gb24gaW5pdGlhbCBsb2FkXHJcbiAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1kcmFnZ2luZycpO1xyXG5cclxuICAgIHJldHVybiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIG5nTW9kZWwpIHtcclxuICAgICAgbmdNb2RlbCA9IG5nTW9kZWwgfHwgJG1kVXRpbC5mYWtlTmdNb2RlbCgpO1xyXG4gICAgICB2YXIgZGlzYWJsZWRHZXR0ZXIgPSAkcGFyc2UoYXR0ci5uZ0Rpc2FibGVkKTtcclxuICAgICAgdmFyIHRodW1iQ29udGFpbmVyID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLm1kLXRodW1iLWNvbnRhaW5lcicpKTtcclxuICAgICAgdmFyIHN3aXRjaENvbnRhaW5lciA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5tZC1jb250YWluZXInKSk7XHJcblxyXG4gICAgICAvLyBubyB0cmFuc2l0aW9uIG9uIGluaXRpYWwgbG9hZFxyXG4gICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1kcmFnZ2luZycpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNoZWNrYm94TGluayhzY29wZSwgZWxlbWVudCwgYXR0ciwgbmdNb2RlbCk7XHJcblxyXG4gICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoYXR0ci5uZ0Rpc2FibGVkKSkge1xyXG4gICAgICAgIHNjb3BlLiR3YXRjaChkaXNhYmxlZEdldHRlciwgZnVuY3Rpb24oaXNEaXNhYmxlZCkge1xyXG4gICAgICAgICAgZWxlbWVudC5hdHRyKCd0YWJpbmRleCcsIGlzRGlzYWJsZWQgPyAtMSA6IDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBUaGVzZSBldmVudHMgYXJlIHRyaWdnZXJlZCBieSBzZXR1cCBkcmFnXHJcbiAgICAgICRtZEdlc3R1cmUucmVnaXN0ZXIoc3dpdGNoQ29udGFpbmVyLCAnZHJhZycpO1xyXG4gICAgICBzd2l0Y2hDb250YWluZXJcclxuICAgICAgICAub24oJyRtZC5kcmFnc3RhcnQnLCBvbkRyYWdTdGFydClcclxuICAgICAgICAub24oJyRtZC5kcmFnJywgb25EcmFnKVxyXG4gICAgICAgIC5vbignJG1kLmRyYWdlbmQnLCBvbkRyYWdFbmQpO1xyXG5cclxuICAgICAgdmFyIGRyYWc7XHJcbiAgICAgIGZ1bmN0aW9uIG9uRHJhZ1N0YXJ0KGV2KSB7XHJcbiAgICAgICAgLy8gRG9uJ3QgZ28gaWYgbmctZGlzYWJsZWQ9PT10cnVlXHJcbiAgICAgICAgaWYgKGRpc2FibGVkR2V0dGVyKHNjb3BlKSkgcmV0dXJuO1xyXG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdtZC1kcmFnZ2luZycpO1xyXG4gICAgICAgIGRyYWcgPSB7XHJcbiAgICAgICAgICB3aWR0aDogdGh1bWJDb250YWluZXIucHJvcCgnb2Zmc2V0V2lkdGgnKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygndHJhbnNpdGlvbicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBvbkRyYWcoZXYpIHtcclxuICAgICAgICBpZiAoIWRyYWcpIHJldHVybjtcclxuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBldi5zcmNFdmVudCAmJiBldi5zcmNFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB2YXIgcGVyY2VudCA9IGV2LnBvaW50ZXIuZGlzdGFuY2VYIC8gZHJhZy53aWR0aDtcclxuXHJcbiAgICAgICAgLy9pZiBjaGVja2VkLCBzdGFydCBmcm9tIHJpZ2h0LiBlbHNlLCBzdGFydCBmcm9tIGxlZnRcclxuICAgICAgICB2YXIgdHJhbnNsYXRlID0gbmdNb2RlbC4kdmlld1ZhbHVlID8gIDEgKyBwZXJjZW50IDogcGVyY2VudDtcclxuICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIHN3aXRjaCBzdGF5cyBpbnNpZGUgaXRzIGJvdW5kcywgMC0xJVxyXG4gICAgICAgIHRyYW5zbGF0ZSA9IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHRyYW5zbGF0ZSkpO1xyXG5cclxuICAgICAgICB0aHVtYkNvbnRhaW5lci5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJ3RyYW5zbGF0ZTNkKCcgKyAoMTAwKnRyYW5zbGF0ZSkgKyAnJSwwLDApJyk7XHJcbiAgICAgICAgZHJhZy50cmFuc2xhdGUgPSB0cmFuc2xhdGU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIG9uRHJhZ0VuZChldikge1xyXG4gICAgICAgIGlmICghZHJhZykgcmV0dXJuO1xyXG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdtZC1kcmFnZ2luZycpO1xyXG4gICAgICAgIHRodW1iQ29udGFpbmVyLmNzcygkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLCAnJyk7XHJcblxyXG4gICAgICAgIC8vIFdlIGNoYW5nZWQgaWYgdGhlcmUgaXMgbm8gZGlzdGFuY2UgKHRoaXMgaXMgYSBjbGljayBhIGNsaWNrKSxcclxuICAgICAgICAvLyBvciBpZiB0aGUgZHJhZyBkaXN0YW5jZSBpcyA+NTAlIG9mIHRoZSB0b3RhbC5cclxuICAgICAgICB2YXIgaXNDaGFuZ2VkID0gbmdNb2RlbC4kdmlld1ZhbHVlID8gZHJhZy50cmFuc2xhdGUgPCAwLjUgOiBkcmFnLnRyYW5zbGF0ZSA+IDAuNTtcclxuICAgICAgICBpZiAoaXNDaGFuZ2VkKSB7XHJcbiAgICAgICAgICBhcHBseU1vZGVsVmFsdWUoIW5nTW9kZWwuJHZpZXdWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRyYWcgPSBudWxsO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBhcHBseU1vZGVsVmFsdWUobmV3VmFsdWUpIHtcclxuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUobmV3VmFsdWUpO1xyXG4gICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcblxyXG59XHJcbk1kU3dpdGNoLiRpbmplY3QgPSBbXCJtZENoZWNrYm94RGlyZWN0aXZlXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRtZFV0aWxcIiwgXCIkZG9jdW1lbnRcIiwgXCIkbWRDb25zdGFudFwiLCBcIiRwYXJzZVwiLCBcIiQkckFGXCIsIFwiJG1kR2VzdHVyZVwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbW9kdWxlXHJcbiAqIEBuYW1lIG1hdGVyaWFsLmNvbXBvbmVudHMudGFic1xyXG4gKiBAZGVzY3JpcHRpb25cclxuICpcclxuICogIFRhYnMsIGNyZWF0ZWQgd2l0aCB0aGUgYDxtZC10YWJzPmAgZGlyZWN0aXZlIHByb3ZpZGUgKnRhYmJlZCogbmF2aWdhdGlvbiB3aXRoIGRpZmZlcmVudCBzdHlsZXMuXHJcbiAqICBUaGUgVGFicyBjb21wb25lbnQgY29uc2lzdHMgb2YgY2xpY2thYmxlIHRhYnMgdGhhdCBhcmUgYWxpZ25lZCBob3Jpem9udGFsbHkgc2lkZS1ieS1zaWRlLlxyXG4gKlxyXG4gKiAgRmVhdHVyZXMgaW5jbHVkZSBzdXBwb3J0IGZvcjpcclxuICpcclxuICogIC0gc3RhdGljIG9yIGR5bmFtaWMgdGFicyxcclxuICogIC0gcmVzcG9uc2l2ZSBkZXNpZ25zLFxyXG4gKiAgLSBhY2Nlc3NpYmlsaXR5IHN1cHBvcnQgKEFSSUEpLFxyXG4gKiAgLSB0YWIgcGFnaW5hdGlvbixcclxuICogIC0gZXh0ZXJuYWwgb3IgaW50ZXJuYWwgdGFiIGNvbnRlbnQsXHJcbiAqICAtIGZvY3VzIGluZGljYXRvcnMgYW5kIGFycm93LWtleSBuYXZpZ2F0aW9ucyxcclxuICogIC0gcHJvZ3JhbW1hdGljIGxvb2t1cCBhbmQgYWNjZXNzIHRvIHRhYiBjb250cm9sbGVycywgYW5kXHJcbiAqICAtIGR5bmFtaWMgdHJhbnNpdGlvbnMgdGhyb3VnaCBkaWZmZXJlbnQgdGFiIGNvbnRlbnRzLlxyXG4gKlxyXG4gKi9cclxuLypcclxuICogQHNlZSBqcyBmb2xkZXIgZm9yIHRhYnMgaW1wbGVtZW50YXRpb25cclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnLCBbXHJcbiAgJ21hdGVyaWFsLmNvcmUnLFxyXG4gICdtYXRlcmlhbC5jb21wb25lbnRzLmljb24nXHJcbl0pO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy50b2FzdFxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVG9hc3RcclxuICovXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRvYXN0JywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5idXR0b24nXHJcbl0pXHJcbiAgLmRpcmVjdGl2ZSgnbWRUb2FzdCcsIE1kVG9hc3REaXJlY3RpdmUpXHJcbiAgLnByb3ZpZGVyKCckbWRUb2FzdCcsIE1kVG9hc3RQcm92aWRlcik7XHJcblxyXG5mdW5jdGlvbiBNZFRvYXN0RGlyZWN0aXZlKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBzZXJ2aWNlXHJcbiAqIEBuYW1lICRtZFRvYXN0XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50b2FzdFxyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYCRtZFRvYXN0YCBpcyBhIHNlcnZpY2UgdG8gYnVpbGQgYSB0b2FzdCBub3RpZmljYXRpb24gb24gYW55IHBvc2l0aW9uXHJcbiAqIG9uIHRoZSBzY3JlZW4gd2l0aCBhbiBvcHRpb25hbCBkdXJhdGlvbiwgYW5kIHByb3ZpZGVzIGEgc2ltcGxlIHByb21pc2UgQVBJLlxyXG4gKlxyXG4gKlxyXG4gKiAjIyBSZXN0cmljdGlvbnMgb24gY3VzdG9tIHRvYXN0c1xyXG4gKiAtIFRoZSB0b2FzdCdzIHRlbXBsYXRlIG11c3QgaGF2ZSBhbiBvdXRlciBgPG1kLXRvYXN0PmAgZWxlbWVudC5cclxuICogLSBGb3IgYSB0b2FzdCBhY3Rpb24sIHVzZSBlbGVtZW50IHdpdGggY2xhc3MgYG1kLWFjdGlvbmAuXHJcbiAqIC0gQWRkIHRoZSBjbGFzcyBgbWQtY2Fwc3VsZWAgZm9yIGN1cnZlZCBjb3JuZXJzLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPGRpdiBuZy1jb250cm9sbGVyPVwiTXlDb250cm9sbGVyXCI+XHJcbiAqICAgPG1kLWJ1dHRvbiBuZy1jbGljaz1cIm9wZW5Ub2FzdCgpXCI+XHJcbiAqICAgICBPcGVuIGEgVG9hc3QhXHJcbiAqICAgPC9tZC1idXR0b24+XHJcbiAqIDwvZGl2PlxyXG4gKiA8L2hsanM+XHJcbiAqXHJcbiAqIDxobGpzIGxhbmc9XCJqc1wiPlxyXG4gKiB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdNYXRlcmlhbCddKTtcclxuICogYXBwLmNvbnRyb2xsZXIoJ015Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1kVG9hc3QpIHtcclxuICogICAkc2NvcGUub3BlblRvYXN0ID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAqICAgICAkbWRUb2FzdC5zaG93KCRtZFRvYXN0LnNpbXBsZSgpLmNvbnRlbnQoJ0hlbGxvIScpKTtcclxuICogICAgIC8vIENvdWxkIGFsc28gZG8gJG1kVG9hc3Quc2hvd1NpbXBsZSgnSGVsbG8nKTtcclxuICogICB9O1xyXG4gKiB9KTtcclxuICogPC9obGpzPlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZFRvYXN0I3Nob3dTaW1wbGVcclxuICogXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBDb252ZW5pZW5jZSBtZXRob2Qgd2hpY2ggYnVpbGRzIGFuZCBzaG93cyBhIHNpbXBsZSB0b2FzdC5cclxuICpcclxuICogQHJldHVybnMge3Byb21pc2V9IEEgcHJvbWlzZSB0aGF0IGNhbiBiZSByZXNvbHZlZCB3aXRoIGAkbWRUb2FzdC5oaWRlKClgIG9yXHJcbiAqIHJlamVjdGVkIHdpdGggYCRtZFRvYXN0LmNhbmNlbCgpYC5cclxuICpcclxuICovXHJcblxyXG4gLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kVG9hc3Qjc2ltcGxlXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBCdWlsZHMgYSBwcmVjb25maWd1cmVkIHRvYXN0LlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7b2JqfSBhIGAkbWRUb2FzdFByZXNldGAgd2l0aCB0aGUgY2hhaW5hYmxlIGNvbmZpZ3VyYXRpb24gbWV0aG9kczpcclxuICpcclxuICogLSAkbWRUb2FzdFByZXNldCNjb250ZW50KHN0cmluZykgLSBzZXRzIHRvYXN0IGNvbnRlbnQgdG8gc3RyaW5nXHJcbiAqIC0gJG1kVG9hc3RQcmVzZXQjYWN0aW9uKHN0cmluZykgLSBhZGRzIGFuIGFjdGlvbiBidXR0b24sIHdoaWNoIHJlc29sdmVzIHRoZSBwcm9taXNlIHJldHVybmVkIGZyb20gYHNob3coKWAgaWYgY2xpY2tlZC5cclxuICogLSAkbWRUb2FzdFByZXNldCNoaWdobGlnaHRBY3Rpb24oYm9vbGVhbikgLSBzZXRzIGFjdGlvbiBidXR0b24gdG8gYmUgaGlnaGxpZ2h0ZWRcclxuICogLSAkbWRUb2FzdFByZXNldCNjYXBzdWxlKGJvb2xlYW4pIC0gYWRkcyAnbWQtY2Fwc3VsZScgY2xhc3MgdG8gdGhlIHRvYXN0IChjdXJ2ZWQgY29ybmVycylcclxuICogLSAkbWRUb2FzdFByZXNldCN0aGVtZShzdHJpbmcpIC0gc2V0cyB0aGUgdGhlbWUgb24gdGhlIHRvYXN0IHRvIHRoZW1lIChkZWZhdWx0IGlzIGAkbWRUaGVtaW5nUHJvdmlkZXJgJ3MgZGVmYXVsdCB0aGVtZSlcclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRUb2FzdCN1cGRhdGVDb250ZW50XHJcbiAqIFxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVXBkYXRlcyB0aGUgY29udGVudCBvZiBhbiBleGlzdGluZyB0b2FzdC4gVXNlZnVsIGZvciB1cGRhdGluZyB0aGluZ3MgbGlrZSBjb3VudHMsIGV0Yy5cclxuICpcclxuICovXHJcblxyXG4gLyoqXHJcbiAqIEBuZ2RvYyBtZXRob2RcclxuICogQG5hbWUgJG1kVG9hc3QjYnVpbGRcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIENyZWF0ZXMgYSBjdXN0b20gYCRtZFRvYXN0UHJlc2V0YCB0aGF0IHlvdSBjYW4gY29uZmlndXJlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7b2JqfSBhIGAkbWRUb2FzdFByZXNldGAgd2l0aCB0aGUgY2hhaW5hYmxlIGNvbmZpZ3VyYXRpb24gbWV0aG9kcyBmb3Igc2hvd3MnIG9wdGlvbnMgKHNlZSBiZWxvdykuXHJcbiAqL1xyXG5cclxuIC8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZFRvYXN0I3Nob3dcclxuICpcclxuICogQGRlc2NyaXB0aW9uIFNob3dzIHRoZSB0b2FzdC5cclxuICpcclxuICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnNPclByZXNldCBFaXRoZXIgcHJvdmlkZSBhbiBgJG1kVG9hc3RQcmVzZXRgIHJldHVybmVkIGZyb20gYHNpbXBsZSgpYFxyXG4gKiBhbmQgYGJ1aWxkKClgLCBvciBhbiBvcHRpb25zIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcclxuICpcclxuICogICAtIGB0ZW1wbGF0ZVVybGAgLSBge3N0cmluZz19YDogVGhlIHVybCBvZiBhbiBodG1sIHRlbXBsYXRlIGZpbGUgdGhhdCB3aWxsXHJcbiAqICAgICBiZSB1c2VkIGFzIHRoZSBjb250ZW50IG9mIHRoZSB0b2FzdC4gUmVzdHJpY3Rpb25zOiB0aGUgdGVtcGxhdGUgbXVzdFxyXG4gKiAgICAgaGF2ZSBhbiBvdXRlciBgbWQtdG9hc3RgIGVsZW1lbnQuXHJcbiAqICAgLSBgdGVtcGxhdGVgIC0gYHtzdHJpbmc9fWA6IFNhbWUgYXMgdGVtcGxhdGVVcmwsIGV4Y2VwdCB0aGlzIGlzIGFuIGFjdHVhbFxyXG4gKiAgICAgdGVtcGxhdGUgc3RyaW5nLlxyXG4gKiAgIC0gYHNjb3BlYCAtIGB7b2JqZWN0PX1gOiB0aGUgc2NvcGUgdG8gbGluayB0aGUgdGVtcGxhdGUgLyBjb250cm9sbGVyIHRvLiBJZiBub25lIGlzIHNwZWNpZmllZCwgaXQgd2lsbCBjcmVhdGUgYSBuZXcgY2hpbGQgc2NvcGUuXHJcbiAqICAgICBUaGlzIHNjb3BlIHdpbGwgYmUgZGVzdHJveWVkIHdoZW4gdGhlIHRvYXN0IGlzIHJlbW92ZWQgdW5sZXNzIGBwcmVzZXJ2ZVNjb3BlYCBpcyBzZXQgdG8gdHJ1ZS5cclxuICogICAtIGBwcmVzZXJ2ZVNjb3BlYCAtIGB7Ym9vbGVhbj19YDogd2hldGhlciB0byBwcmVzZXJ2ZSB0aGUgc2NvcGUgd2hlbiB0aGUgZWxlbWVudCBpcyByZW1vdmVkLiBEZWZhdWx0IGlzIGZhbHNlXHJcbiAqICAgLSBgaGlkZURlbGF5YCAtIGB7bnVtYmVyPX1gOiBIb3cgbWFueSBtaWxsaXNlY29uZHMgdGhlIHRvYXN0IHNob3VsZCBzdGF5XHJcbiAqICAgICBhY3RpdmUgYmVmb3JlIGF1dG9tYXRpY2FsbHkgY2xvc2luZy4gIFNldCB0byAwIG9yIGZhbHNlIHRvIGhhdmUgdGhlIHRvYXN0IHN0YXkgb3BlbiB1bnRpbFxyXG4gKiAgICAgY2xvc2VkIG1hbnVhbGx5LiBEZWZhdWx0OiAzMDAwLlxyXG4gKiAgIC0gYHBvc2l0aW9uYCAtIGB7c3RyaW5nPX1gOiBXaGVyZSB0byBwbGFjZSB0aGUgdG9hc3QuIEF2YWlsYWJsZTogYW55IGNvbWJpbmF0aW9uXHJcbiAqICAgICBvZiAnYm90dG9tJywgJ2xlZnQnLCAndG9wJywgJ3JpZ2h0JywgJ2ZpdCcuIERlZmF1bHQ6ICdib3R0b20gbGVmdCcuXHJcbiAqICAgLSBgY29udHJvbGxlcmAgLSBge3N0cmluZz19YDogVGhlIGNvbnRyb2xsZXIgdG8gYXNzb2NpYXRlIHdpdGggdGhpcyB0b2FzdC5cclxuICogICAgIFRoZSBjb250cm9sbGVyIHdpbGwgYmUgaW5qZWN0ZWQgdGhlIGxvY2FsIGAkaGlkZVRvYXN0YCwgd2hpY2ggaXMgYSBmdW5jdGlvblxyXG4gKiAgICAgdXNlZCB0byBoaWRlIHRoZSB0b2FzdC5cclxuICogICAtIGBsb2NhbHNgIC0gYHtzdHJpbmc9fWA6IEFuIG9iamVjdCBjb250YWluaW5nIGtleS92YWx1ZSBwYWlycy4gVGhlIGtleXMgd2lsbFxyXG4gKiAgICAgYmUgdXNlZCBhcyBuYW1lcyBvZiB2YWx1ZXMgdG8gaW5qZWN0IGludG8gdGhlIGNvbnRyb2xsZXIuIEZvciBleGFtcGxlLFxyXG4gKiAgICAgYGxvY2Fsczoge3RocmVlOiAzfWAgd291bGQgaW5qZWN0IGB0aHJlZWAgaW50byB0aGUgY29udHJvbGxlciB3aXRoIHRoZSB2YWx1ZVxyXG4gKiAgICAgb2YgMy5cclxuICogICAtIGBiaW5kVG9Db250cm9sbGVyYCAtIGBib29sYDogYmluZCB0aGUgbG9jYWxzIHRvIHRoZSBjb250cm9sbGVyLCBpbnN0ZWFkIG9mIHBhc3NpbmcgdGhlbSBpbi4gVGhlc2UgdmFsdWVzIHdpbGwgbm90IGJlIGF2YWlsYWJsZSB1bnRpbCBhZnRlciBpbml0aWFsaXphdGlvbi5cclxuICogICAtIGByZXNvbHZlYCAtIGB7b2JqZWN0PX1gOiBTaW1pbGFyIHRvIGxvY2FscywgZXhjZXB0IGl0IHRha2VzIHByb21pc2VzIGFzIHZhbHVlc1xyXG4gKiAgICAgYW5kIHRoZSB0b2FzdCB3aWxsIG5vdCBvcGVuIHVudGlsIHRoZSBwcm9taXNlcyByZXNvbHZlLlxyXG4gKiAgIC0gYGNvbnRyb2xsZXJBc2AgLSBge3N0cmluZz19YDogQW4gYWxpYXMgdG8gYXNzaWduIHRoZSBjb250cm9sbGVyIHRvIG9uIHRoZSBzY29wZS5cclxuICogICAtIGBwYXJlbnRgIC0gYHtlbGVtZW50PX1gOiBUaGUgZWxlbWVudCB0byBhcHBlbmQgdGhlIHRvYXN0IHRvLiBEZWZhdWx0cyB0byBhcHBlbmRpbmdcclxuICogICAgIHRvIHRoZSByb290IGVsZW1lbnQgb2YgdGhlIGFwcGxpY2F0aW9uLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gQSBwcm9taXNlIHRoYXQgY2FuIGJlIHJlc29sdmVkIHdpdGggYCRtZFRvYXN0LmhpZGUoKWAgb3JcclxuICogcmVqZWN0ZWQgd2l0aCBgJG1kVG9hc3QuY2FuY2VsKClgLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgbWV0aG9kXHJcbiAqIEBuYW1lICRtZFRvYXN0I2hpZGVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEhpZGUgYW4gZXhpc3RpbmcgdG9hc3QgYW5kIHJlc29sdmUgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbSBgJG1kVG9hc3Quc2hvdygpYC5cclxuICpcclxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZXNvbHZlZCBwcm9taXNlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gYSBwcm9taXNlIHRoYXQgaXMgY2FsbGVkIHdoZW4gdGhlIGV4aXN0aW5nIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET01cclxuICpcclxuICovXHJcblxyXG4vKipcclxuICogQG5nZG9jIG1ldGhvZFxyXG4gKiBAbmFtZSAkbWRUb2FzdCNjYW5jZWxcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIEhpZGUgdGhlIGV4aXN0aW5nIHRvYXN0IGFuZCByZWplY3QgdGhlIHByb21pc2UgcmV0dXJuZWQgZnJvbVxyXG4gKiBgJG1kVG9hc3Quc2hvdygpYC5cclxuICpcclxuICogQHBhcmFtIHsqPX0gcmVzcG9uc2UgQW4gYXJndW1lbnQgZm9yIHRoZSByZWplY3RlZCBwcm9taXNlLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB7cHJvbWlzZX0gYSBwcm9taXNlIHRoYXQgaXMgY2FsbGVkIHdoZW4gdGhlIGV4aXN0aW5nIGVsZW1lbnQgaXMgcmVtb3ZlZCBmcm9tIHRoZSBET01cclxuICpcclxuICovXHJcblxyXG5mdW5jdGlvbiBNZFRvYXN0UHJvdmlkZXIoJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyKSB7XHJcbiAgdmFyIGFjdGl2ZVRvYXN0Q29udGVudDtcclxuICB2YXIgJG1kVG9hc3QgPSAkJGludGVyaW1FbGVtZW50UHJvdmlkZXIoJyRtZFRvYXN0JylcclxuICAgIC5zZXREZWZhdWx0cyh7XHJcbiAgICAgIG1ldGhvZHM6IFsncG9zaXRpb24nLCAnaGlkZURlbGF5JywgJ2NhcHN1bGUnIF0sXHJcbiAgICAgIG9wdGlvbnM6IHRvYXN0RGVmYXVsdE9wdGlvbnNcclxuICAgIH0pXHJcbiAgICAuYWRkUHJlc2V0KCdzaW1wbGUnLCB7XHJcbiAgICAgIGFyZ09wdGlvbjogJ2NvbnRlbnQnLFxyXG4gICAgICBtZXRob2RzOiBbJ2NvbnRlbnQnLCAnYWN0aW9uJywgJ2hpZ2hsaWdodEFjdGlvbicsICd0aGVtZScsICdwYXJlbnQnXSxcclxuICAgICAgb3B0aW9uczogLyogQG5nSW5qZWN0ICovIFtcIiRtZFRvYXN0XCIsIFwiJG1kVGhlbWluZ1wiLCBmdW5jdGlvbigkbWRUb2FzdCwgJG1kVGhlbWluZykge1xyXG4gICAgICAgIHZhciBvcHRzID0ge1xyXG4gICAgICAgICAgdGVtcGxhdGU6IFtcclxuICAgICAgICAgICAgJzxtZC10b2FzdCBtZC10aGVtZT1cInt7IHRvYXN0LnRoZW1lIH19XCIgbmctY2xhc3M9XCJ7XFwnbWQtY2Fwc3VsZVxcJzogdG9hc3QuY2Fwc3VsZX1cIj4nLFxyXG4gICAgICAgICAgICAgICc8c3BhbiBmbGV4Pnt7IHRvYXN0LmNvbnRlbnQgfX08L3NwYW4+JyxcclxuICAgICAgICAgICAgICAnPG1kLWJ1dHRvbiBjbGFzcz1cIm1kLWFjdGlvblwiIG5nLWlmPVwidG9hc3QuYWN0aW9uXCIgbmctY2xpY2s9XCJ0b2FzdC5yZXNvbHZlKClcIiBuZy1jbGFzcz1cIntcXCdtZC1oaWdobGlnaHRcXCc6IHRvYXN0LmhpZ2hsaWdodEFjdGlvbn1cIj4nLFxyXG4gICAgICAgICAgICAgICAgJ3t7IHRvYXN0LmFjdGlvbiB9fScsXHJcbiAgICAgICAgICAgICAgJzwvbWQtYnV0dG9uPicsXHJcbiAgICAgICAgICAgICc8L21kLXRvYXN0PidcclxuICAgICAgICAgIF0uam9pbignJyksXHJcbiAgICAgICAgICBjb250cm9sbGVyOiAvKiBAbmdJbmplY3QgKi8gW1wiJHNjb3BlXCIsIGZ1bmN0aW9uIG1kVG9hc3RDdHJsKCRzY29wZSkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7IHJldHVybiBhY3RpdmVUb2FzdENvbnRlbnQ7IH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgIHNlbGYuY29udGVudCA9IGFjdGl2ZVRvYXN0Q29udGVudDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICRtZFRvYXN0LmhpZGUoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgdGhlbWU6ICRtZFRoZW1pbmcuZGVmYXVsdFRoZW1lKCksXHJcbiAgICAgICAgICBjb250cm9sbGVyQXM6ICd0b2FzdCcsXHJcbiAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gb3B0cztcclxuICAgICAgfV1cclxuICAgIH0pXHJcbiAgICAuYWRkTWV0aG9kKCd1cGRhdGVDb250ZW50JywgZnVuY3Rpb24obmV3Q29udGVudCkge1xyXG4gICAgICBhY3RpdmVUb2FzdENvbnRlbnQgPSBuZXdDb250ZW50O1xyXG4gICAgfSk7XHJcblxyXG4gIHRvYXN0RGVmYXVsdE9wdGlvbnMuJGluamVjdCA9IFtcIiR0aW1lb3V0XCIsIFwiJGFuaW1hdGVcIiwgXCIkbWRUb2FzdFwiLCBcIiRtZFV0aWxcIl07XHJcbiAgICByZXR1cm4gJG1kVG9hc3Q7XHJcblxyXG4gIC8qIEBuZ0luamVjdCAqL1xyXG4gIGZ1bmN0aW9uIHRvYXN0RGVmYXVsdE9wdGlvbnMoJHRpbWVvdXQsICRhbmltYXRlLCAkbWRUb2FzdCwgJG1kVXRpbCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgb25TaG93OiBvblNob3csXHJcbiAgICAgIG9uUmVtb3ZlOiBvblJlbW92ZSxcclxuICAgICAgcG9zaXRpb246ICdib3R0b20gbGVmdCcsXHJcbiAgICAgIHRoZW1hYmxlOiB0cnVlLFxyXG4gICAgICBoaWRlRGVsYXk6IDMwMDBcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gb25TaG93KHNjb3BlLCBlbGVtZW50LCBvcHRpb25zKSB7XHJcbiAgICAgIGVsZW1lbnQgPSAkbWRVdGlsLmV4dHJhY3RFbGVtZW50QnlOYW1lKGVsZW1lbnQsICdtZC10b2FzdCcpO1xyXG5cclxuICAgICAgLy8gJ3RvcCBsZWZ0JyAtPiAnbWQtdG9wIG1kLWxlZnQnXHJcbiAgICAgIGFjdGl2ZVRvYXN0Q29udGVudCA9IG9wdGlvbnMuY29udGVudDtcclxuICAgICAgZWxlbWVudC5hZGRDbGFzcyhvcHRpb25zLnBvc2l0aW9uLnNwbGl0KCcgJykubWFwKGZ1bmN0aW9uKHBvcykge1xyXG4gICAgICAgIHJldHVybiAnbWQtJyArIHBvcztcclxuICAgICAgfSkuam9pbignICcpKTtcclxuICAgICAgb3B0aW9ucy5wYXJlbnQuYWRkQ2xhc3ModG9hc3RPcGVuQ2xhc3Mob3B0aW9ucy5wb3NpdGlvbikpO1xyXG5cclxuICAgICAgb3B0aW9ucy5vblN3aXBlID0gZnVuY3Rpb24oZXYsIGdlc3R1cmUpIHtcclxuICAgICAgICAvL0FkZCBzd2lwZWxlZnQvc3dpcGVyaWdodCBjbGFzcyB0byBlbGVtZW50IHNvIGl0IGNhbiBhbmltYXRlIGNvcnJlY3RseVxyXG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLScgKyBldi50eXBlLnJlcGxhY2UoJyRtZC4nLCcnKSk7XHJcbiAgICAgICAgJHRpbWVvdXQoJG1kVG9hc3QuY2FuY2VsKTtcclxuICAgICAgfTtcclxuICAgICAgZWxlbWVudC5vbignJG1kLnN3aXBlbGVmdCAkbWQuc3dpcGVyaWdodCcsIG9wdGlvbnMub25Td2lwZSk7XHJcbiAgICAgIHJldHVybiAkYW5pbWF0ZS5lbnRlcihlbGVtZW50LCBvcHRpb25zLnBhcmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gb25SZW1vdmUoc2NvcGUsIGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuICAgICAgZWxlbWVudC5vZmYoJyRtZC5zd2lwZWxlZnQgJG1kLnN3aXBlcmlnaHQnLCBvcHRpb25zLm9uU3dpcGUpO1xyXG4gICAgICBvcHRpb25zLnBhcmVudC5yZW1vdmVDbGFzcyh0b2FzdE9wZW5DbGFzcyhvcHRpb25zLnBvc2l0aW9uKSk7XHJcbiAgICAgIHJldHVybiAkYW5pbWF0ZS5sZWF2ZShlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB0b2FzdE9wZW5DbGFzcyhwb3NpdGlvbikge1xyXG4gICAgICByZXR1cm4gJ21kLXRvYXN0LW9wZW4tJyArXHJcbiAgICAgICAgKHBvc2l0aW9uLmluZGV4T2YoJ3RvcCcpID4gLTEgPyAndG9wJyA6ICdib3R0b20nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcbk1kVG9hc3RQcm92aWRlci4kaW5qZWN0ID0gW1wiJCRpbnRlcmltRWxlbWVudFByb3ZpZGVyXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy50b29sYmFyXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy50b29sYmFyJywgW1xyXG4gICdtYXRlcmlhbC5jb3JlJyxcclxuICAnbWF0ZXJpYWwuY29tcG9uZW50cy5jb250ZW50J1xyXG5dKVxyXG4gIC5kaXJlY3RpdmUoJ21kVG9vbGJhcicsIG1kVG9vbGJhckRpcmVjdGl2ZSk7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZFRvb2xiYXJcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvb2xiYXJcclxuICogQHJlc3RyaWN0IEVcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGBtZC10b29sYmFyYCBpcyB1c2VkIHRvIHBsYWNlIGEgdG9vbGJhciBpbiB5b3VyIGFwcC5cclxuICpcclxuICogVG9vbGJhcnMgYXJlIHVzdWFsbHkgdXNlZCBhYm92ZSBhIGNvbnRlbnQgYXJlYSB0byBkaXNwbGF5IHRoZSB0aXRsZSBvZiB0aGVcclxuICogY3VycmVudCBwYWdlLCBhbmQgc2hvdyByZWxldmFudCBhY3Rpb24gYnV0dG9ucyBmb3IgdGhhdCBwYWdlLlxyXG4gKlxyXG4gKiBZb3UgY2FuIGNoYW5nZSB0aGUgaGVpZ2h0IG9mIHRoZSB0b29sYmFyIGJ5IGFkZGluZyBlaXRoZXIgdGhlXHJcbiAqIGBtZC1tZWRpdW0tdGFsbGAgb3IgYG1kLXRhbGxgIGNsYXNzIHRvIHRoZSB0b29sYmFyLlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPGRpdiBsYXlvdXQ9XCJjb2x1bW5cIiBsYXlvdXQtZmlsbD5cclxuICogICA8bWQtdG9vbGJhcj5cclxuICpcclxuICogICAgIDxkaXYgY2xhc3M9XCJtZC10b29sYmFyLXRvb2xzXCI+XHJcbiAqICAgICAgIDxzcGFuPk15IEFwcCdzIFRpdGxlPC9zcGFuPlxyXG4gKlxyXG4gKiAgICAgICA8IS0tIGZpbGwgdXAgdGhlIHNwYWNlIGJldHdlZW4gbGVmdCBhbmQgcmlnaHQgYXJlYSAtLT5cclxuICogICAgICAgPHNwYW4gZmxleD48L3NwYW4+XHJcbiAqXHJcbiAqICAgICAgIDxtZC1idXR0b24+XHJcbiAqICAgICAgICAgUmlnaHQgQmFyIEJ1dHRvblxyXG4gKiAgICAgICA8L21kLWJ1dHRvbj5cclxuICogICAgIDwvZGl2PlxyXG4gKlxyXG4gKiAgIDwvbWQtdG9vbGJhcj5cclxuICogICA8bWQtY29udGVudD5cclxuICogICAgIEhlbGxvIVxyXG4gKiAgIDwvbWQtY29udGVudD5cclxuICogPC9kaXY+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogQHBhcmFtIHtib29sZWFuPX0gbWQtc2Nyb2xsLXNocmluayBXaGV0aGVyIHRoZSBoZWFkZXIgc2hvdWxkIHNocmluayBhd2F5IGFzXHJcbiAqIHRoZSB1c2VyIHNjcm9sbHMgZG93biwgYW5kIHJldmVhbCBpdHNlbGYgYXMgdGhlIHVzZXIgc2Nyb2xscyB1cC5cclxuICogTm90ZTogZm9yIHNjcm9sbFNocmluayB0byB3b3JrLCB0aGUgdG9vbGJhciBtdXN0IGJlIGEgc2libGluZyBvZiBhXHJcbiAqIGBtZC1jb250ZW50YCBlbGVtZW50LCBwbGFjZWQgYmVmb3JlIGl0LiBTZWUgdGhlIHNjcm9sbCBzaHJpbmsgZGVtby5cclxuICpcclxuICpcclxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1zaHJpbmstc3BlZWQtZmFjdG9yIEhvdyBtdWNoIHRvIGNoYW5nZSB0aGUgc3BlZWQgb2YgdGhlIHRvb2xiYXInc1xyXG4gKiBzaHJpbmtpbmcgYnkuIEZvciBleGFtcGxlLCBpZiAwLjI1IGlzIGdpdmVuIHRoZW4gdGhlIHRvb2xiYXIgd2lsbCBzaHJpbmtcclxuICogYXQgb25lIGZvdXJ0aCB0aGUgcmF0ZSBhdCB3aGljaCB0aGUgdXNlciBzY3JvbGxzIGRvd24uIERlZmF1bHQgMC41LlxyXG4gKi9cclxuZnVuY3Rpb24gbWRUb29sYmFyRGlyZWN0aXZlKCQkckFGLCAkbWRDb25zdGFudCwgJG1kVXRpbCwgJG1kVGhlbWluZywgJGFuaW1hdGUsICR0aW1lb3V0KSB7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgY29udHJvbGxlcjogYW5ndWxhci5ub29wLFxyXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuXHJcbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChhdHRyLm1kU2Nyb2xsU2hyaW5rKSkge1xyXG4gICAgICAgIHNldHVwU2Nyb2xsU2hyaW5rKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIHNldHVwU2Nyb2xsU2hyaW5rKCkge1xyXG4gICAgICAgIC8vIEN1cnJlbnQgXCJ5XCIgcG9zaXRpb24gb2Ygc2Nyb2xsXHJcbiAgICAgICAgdmFyIHkgPSAwO1xyXG4gICAgICAgIC8vIFN0b3JlIHRoZSBsYXN0IHNjcm9sbCB0b3AgcG9zaXRpb25cclxuICAgICAgICB2YXIgcHJldlNjcm9sbFRvcCA9IDA7XHJcblxyXG4gICAgICAgIHZhciBzaHJpbmtTcGVlZEZhY3RvciA9IGF0dHIubWRTaHJpbmtTcGVlZEZhY3RvciB8fCAwLjU7XHJcblxyXG4gICAgICAgIHZhciB0b29sYmFySGVpZ2h0O1xyXG4gICAgICAgIHZhciBjb250ZW50RWxlbWVudDtcclxuXHJcbiAgICAgICAgdmFyIGRlYm91bmNlZENvbnRlbnRTY3JvbGwgPSAkJHJBRi50aHJvdHRsZShvbkNvbnRlbnRTY3JvbGwpO1xyXG4gICAgICAgIHZhciBkZWJvdW5jZWRVcGRhdGVIZWlnaHQgPSAkbWRVdGlsLmRlYm91bmNlKHVwZGF0ZVRvb2xiYXJIZWlnaHQsIDUgKiAxMDAwKTtcclxuXHJcbiAgICAgICAgLy8gV2FpdCBmb3IgJG1kQ29udGVudExvYWRlZCBldmVudCBmcm9tIG1kQ29udGVudCBkaXJlY3RpdmUuXHJcbiAgICAgICAgLy8gSWYgdGhlIG1kQ29udGVudCBlbGVtZW50IGlzIGEgc2libGluZyBvZiBvdXIgdG9vbGJhciwgaG9vayBpdCB1cFxyXG4gICAgICAgIC8vIHRvIHNjcm9sbCBldmVudHMuXHJcbiAgICAgICAgc2NvcGUuJG9uKCckbWRDb250ZW50TG9hZGVkJywgb25NZENvbnRlbnRMb2FkKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25NZENvbnRlbnRMb2FkKCRldmVudCwgbmV3Q29udGVudEVsKSB7XHJcbiAgICAgICAgICAvLyBUb29sYmFyIGFuZCBjb250ZW50IG11c3QgYmUgc2libGluZ3NcclxuICAgICAgICAgIGlmIChlbGVtZW50LnBhcmVudCgpWzBdID09PSBuZXdDb250ZW50RWwucGFyZW50KClbMF0pIHtcclxuICAgICAgICAgICAgLy8gdW5ob29rIG9sZCBjb250ZW50IGV2ZW50IGxpc3RlbmVyIGlmIGV4aXN0c1xyXG4gICAgICAgICAgICBpZiAoY29udGVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICBjb250ZW50RWxlbWVudC5vZmYoJ3Njcm9sbCcsIGRlYm91bmNlZENvbnRlbnRTY3JvbGwpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBuZXdDb250ZW50RWwub24oJ3Njcm9sbCcsIGRlYm91bmNlZENvbnRlbnRTY3JvbGwpO1xyXG4gICAgICAgICAgICBuZXdDb250ZW50RWwuYXR0cignc2Nyb2xsLXNocmluaycsICd0cnVlJyk7XHJcblxyXG4gICAgICAgICAgICBjb250ZW50RWxlbWVudCA9IG5ld0NvbnRlbnRFbDtcclxuICAgICAgICAgICAgJCRyQUYodXBkYXRlVG9vbGJhckhlaWdodCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVUb29sYmFySGVpZ2h0KCkge1xyXG4gICAgICAgICAgdG9vbGJhckhlaWdodCA9IGVsZW1lbnQucHJvcCgnb2Zmc2V0SGVpZ2h0Jyk7XHJcbiAgICAgICAgICAvLyBBZGQgYSBuZWdhdGl2ZSBtYXJnaW4tdG9wIHRoZSBzaXplIG9mIHRoZSB0b29sYmFyIHRvIHRoZSBjb250ZW50IGVsLlxyXG4gICAgICAgICAgLy8gVGhlIGNvbnRlbnQgd2lsbCBzdGFydCB0cmFuc2Zvcm1lZCBkb3duIHRoZSB0b29sYmFySGVpZ2h0IGFtb3VudCxcclxuICAgICAgICAgIC8vIHNvIGV2ZXJ5dGhpbmcgbG9va3Mgbm9ybWFsLlxyXG4gICAgICAgICAgLy9cclxuICAgICAgICAgIC8vIEFzIHRoZSB1c2VyIHNjcm9sbHMgZG93biwgdGhlIGNvbnRlbnQgd2lsbCBiZSB0cmFuc2Zvcm1lZCB1cCBzbG93bHlcclxuICAgICAgICAgIC8vIHRvIHB1dCB0aGUgY29udGVudCB1bmRlcm5lYXRoIHdoZXJlIHRoZSB0b29sYmFyIHdhcy5cclxuICAgICAgICAgIHZhciBtYXJnaW4gPSAgKC10b29sYmFySGVpZ2h0ICogc2hyaW5rU3BlZWRGYWN0b3IpICsgJ3B4JztcclxuICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmNzcygnbWFyZ2luLXRvcCcsIG1hcmdpbik7XHJcbiAgICAgICAgICBjb250ZW50RWxlbWVudC5jc3MoJ21hcmdpbi1ib3R0b20nLCBtYXJnaW4pO1xyXG5cclxuICAgICAgICAgIG9uQ29udGVudFNjcm9sbCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25Db250ZW50U2Nyb2xsKGUpIHtcclxuICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBlID8gZS50YXJnZXQuc2Nyb2xsVG9wIDogcHJldlNjcm9sbFRvcDtcclxuXHJcbiAgICAgICAgICBkZWJvdW5jZWRVcGRhdGVIZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICB5ID0gTWF0aC5taW4oXHJcbiAgICAgICAgICAgIHRvb2xiYXJIZWlnaHQgLyBzaHJpbmtTcGVlZEZhY3RvcixcclxuICAgICAgICAgICAgTWF0aC5tYXgoMCwgeSArIHNjcm9sbFRvcCAtIHByZXZTY3JvbGxUb3ApXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIGVsZW1lbnQuY3NzKFxyXG4gICAgICAgICAgICAkbWRDb25zdGFudC5DU1MuVFJBTlNGT1JNLFxyXG4gICAgICAgICAgICAndHJhbnNsYXRlM2QoMCwnICsgKC15ICogc2hyaW5rU3BlZWRGYWN0b3IpICsgJ3B4LDApJ1xyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIGNvbnRlbnRFbGVtZW50LmNzcyhcclxuICAgICAgICAgICAgJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSxcclxuICAgICAgICAgICAgJ3RyYW5zbGF0ZTNkKDAsJyArICgodG9vbGJhckhlaWdodCAtIHkpICogc2hyaW5rU3BlZWRGYWN0b3IpICsgJ3B4LDApJ1xyXG4gICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICBwcmV2U2Nyb2xsVG9wID0gc2Nyb2xsVG9wO1xyXG5cclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ21kLXdoaXRlZnJhbWUtejEnKSkge1xyXG4gICAgICAgICAgICAgIGlmICgheSkge1xyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkgeyAkYW5pbWF0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCAnbWQtd2hpdGVmcmFtZS16MScpOyB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYgKHkpIHtcclxuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgJGFuaW1hdGUuYWRkQ2xhc3MoZWxlbWVudCwgJ21kLXdoaXRlZnJhbWUtejEnKTsgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuICB9O1xyXG5cclxufVxyXG5tZFRvb2xiYXJEaXJlY3RpdmUuJGluamVjdCA9IFtcIiQkckFGXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbWRVdGlsXCIsIFwiJG1kVGhlbWluZ1wiLCBcIiRhbmltYXRlXCIsIFwiJHRpbWVvdXRcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIG1vZHVsZVxyXG4gKiBAbmFtZSBtYXRlcmlhbC5jb21wb25lbnRzLnRvb2x0aXBcclxuICovXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudG9vbHRpcCcsIFsgJ21hdGVyaWFsLmNvcmUnIF0pXHJcbiAgICAuZGlyZWN0aXZlKCdtZFRvb2x0aXAnLCBNZFRvb2x0aXBEaXJlY3RpdmUpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRUb29sdGlwXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50b29sdGlwXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBUb29sdGlwcyBhcmUgdXNlZCB0byBkZXNjcmliZSBlbGVtZW50cyB0aGF0IGFyZSBpbnRlcmFjdGl2ZSBhbmQgcHJpbWFyaWx5IGdyYXBoaWNhbCAobm90IHRleHR1YWwpLlxyXG4gKlxyXG4gKiBQbGFjZSBhIGA8bWQtdG9vbHRpcD5gIGFzIGEgY2hpbGQgb2YgdGhlIGVsZW1lbnQgaXQgZGVzY3JpYmVzLlxyXG4gKlxyXG4gKiBBIHRvb2x0aXAgd2lsbCBhY3RpdmF0ZSB3aGVuIHRoZSB1c2VyIGZvY3VzZXMsIGhvdmVycyBvdmVyLCBvciB0b3VjaGVzIHRoZSBwYXJlbnQuXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtYnV0dG9uIGNsYXNzPVwibWQtZmFiIG1kLWFjY2VudFwiIGFyaWEtbGFiZWw9XCJQbGF5XCI+XHJcbiAqICAgPG1kLXRvb2x0aXA+XHJcbiAqICAgICBQbGF5IE11c2ljXHJcbiAqICAgPC9tZC10b29sdGlwPlxyXG4gKiAgIDxtZC1pY29uIGljb249XCJpbWcvaWNvbnMvaWNfcGxheV9hcnJvd18yNHB4LnN2Z1wiPjwvbWQtaWNvbj5cclxuICogPC9tZC1idXR0b24+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtdmlzaWJsZSBCb29sZWFuIGJvdW5kIHRvIHdoZXRoZXIgdGhlIHRvb2x0aXAgaXNcclxuICogY3VycmVudGx5IHZpc2libGUuXHJcbiAqIEBwYXJhbSB7bnVtYmVyPX0gbWQtZGVsYXkgSG93IG1hbnkgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdG8gc2hvdyB0aGUgdG9vbHRpcCBhZnRlciB0aGUgdXNlciBmb2N1c2VzLCBob3ZlcnMsIG9yIHRvdWNoZXMgdGhlIHBhcmVudC4gRGVmYXVsdHMgdG8gNDAwbXMuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWQtZGlyZWN0aW9uIFdoaWNoIGRpcmVjdGlvbiB3b3VsZCB5b3UgbGlrZSB0aGUgdG9vbHRpcCB0byBnbz8gIFN1cHBvcnRzIGxlZnQsIHJpZ2h0LCB0b3AsIGFuZCBib3R0b20uICBEZWZhdWx0cyB0byBib3R0b20uXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWF1dG9oaWRlIElmIHByZXNlbnQgb3IgcHJvdmlkZWQgd2l0aCBhIGJvb2xlYW4gdmFsdWUsIHRoZSB0b29sdGlwIHdpbGwgaGlkZSBvbiBtb3VzZSBsZWF2ZSwgcmVnYXJkbGVzcyBvZiBmb2N1c1xyXG4gKi9cclxuZnVuY3Rpb24gTWRUb29sdGlwRGlyZWN0aXZlKCR0aW1lb3V0LCAkd2luZG93LCAkJHJBRiwgJGRvY3VtZW50LCAkbWRVdGlsLCAkbWRUaGVtaW5nLCAkcm9vdEVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYW5pbWF0ZSwgJHEpIHtcclxuXHJcbiAgdmFyIFRPT0xUSVBfU0hPV19ERUxBWSA9IDMwMDtcclxuICB2YXIgVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSA9IDg7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgdHJhbnNjbHVkZTogdHJ1ZSxcclxuICAgIHByaW9yaXR5OjIxMCwgLy8gQmVmb3JlIG5nQXJpYVxyXG4gICAgdGVtcGxhdGU6ICdcXFxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJtZC1iYWNrZ3JvdW5kXCI+PC9kaXY+XFxcclxuICAgICAgICA8ZGl2IGNsYXNzPVwibWQtY29udGVudFwiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+JyxcclxuICAgIHNjb3BlOiB7XHJcbiAgICAgIHZpc2libGU6ICc9P21kVmlzaWJsZScsXHJcbiAgICAgIGRlbGF5OiAnPT9tZERlbGF5JyxcclxuICAgICAgYXV0b2hpZGU6ICc9P21kQXV0b2hpZGUnXHJcbiAgICB9LFxyXG4gICAgbGluazogcG9zdExpbmtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cikge1xyXG5cclxuICAgICRtZFRoZW1pbmcoZWxlbWVudCk7XHJcblxyXG4gICAgdmFyIHBhcmVudCAgICAgICAgPSBnZXRQYXJlbnRXaXRoUG9pbnRlckV2ZW50cygpLFxyXG4gICAgICAgIGJhY2tncm91bmQgICAgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtZC1iYWNrZ3JvdW5kJylbMF0pLFxyXG4gICAgICAgIGNvbnRlbnQgICAgICAgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtZC1jb250ZW50JylbMF0pLFxyXG4gICAgICAgIGRpcmVjdGlvbiAgICAgPSBhdHRyLm1kRGlyZWN0aW9uLFxyXG4gICAgICAgIGN1cnJlbnQgICAgICAgPSBnZXROZWFyZXN0Q29udGVudEVsZW1lbnQoKSxcclxuICAgICAgICB0b29sdGlwUGFyZW50ID0gYW5ndWxhci5lbGVtZW50KGN1cnJlbnQgfHwgZG9jdW1lbnQuYm9keSksXHJcbiAgICAgICAgZGVib3VuY2VkT25SZXNpemUgPSAkJHJBRi50aHJvdHRsZShmdW5jdGlvbiAoKSB7IGlmIChzY29wZS52aXNpYmxlKSBwb3NpdGlvblRvb2x0aXAoKTsgfSk7XHJcblxyXG4gICAgcmV0dXJuIGluaXQoKTtcclxuXHJcbiAgICBmdW5jdGlvbiBpbml0ICgpIHtcclxuICAgICAgc2V0RGVmYXVsdHMoKTtcclxuICAgICAgbWFuaXB1bGF0ZUVsZW1lbnQoKTtcclxuICAgICAgYmluZEV2ZW50cygpO1xyXG4gICAgICBjb25maWd1cmVXYXRjaGVycygpO1xyXG4gICAgICBhZGRBcmlhTGFiZWwoKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZXREZWZhdWx0cyAoKSB7XHJcbiAgICAgIGlmICghYW5ndWxhci5pc0RlZmluZWQoYXR0ci5tZERlbGF5KSkgc2NvcGUuZGVsYXkgPSBUT09MVElQX1NIT1dfREVMQVk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gY29uZmlndXJlV2F0Y2hlcnMgKCkge1xyXG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc2NvcGUudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLm9mZigncmVzaXplJywgZGVib3VuY2VkT25SZXNpemUpO1xyXG4gICAgICB9KTtcclxuICAgICAgc2NvcGUuJHdhdGNoKCd2aXNpYmxlJywgZnVuY3Rpb24gKGlzVmlzaWJsZSkge1xyXG4gICAgICAgIGlmIChpc1Zpc2libGUpIHNob3dUb29sdGlwKCk7XHJcbiAgICAgICAgZWxzZSBoaWRlVG9vbHRpcCgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZGRBcmlhTGFiZWwgKCkge1xyXG4gICAgICBpZiAoIXBhcmVudC5hdHRyKCdhcmlhLWxhYmVsJykgJiYgIXBhcmVudC50ZXh0KCkudHJpbSgpKSB7XHJcbiAgICAgICAgcGFyZW50LmF0dHIoJ2FyaWEtbGFiZWwnLCBlbGVtZW50LnRleHQoKS50cmltKCkpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbWFuaXB1bGF0ZUVsZW1lbnQgKCkge1xyXG4gICAgICBlbGVtZW50LmRldGFjaCgpO1xyXG4gICAgICBlbGVtZW50LmF0dHIoJ3JvbGUnLCAndG9vbHRpcCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdldFBhcmVudFdpdGhQb2ludGVyRXZlbnRzICgpIHtcclxuICAgICAgdmFyIHBhcmVudCA9IGVsZW1lbnQucGFyZW50KCk7XHJcbiAgICAgIHdoaWxlIChwYXJlbnQgJiYgJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHBhcmVudFswXSlbJ3BvaW50ZXItZXZlbnRzJ10gPT0gJ25vbmUnKSB7XHJcbiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudCgpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBwYXJlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgIGZ1bmN0aW9uIGdldE5lYXJlc3RDb250ZW50RWxlbWVudCAoKSB7XHJcbiAgICAgICB2YXIgY3VycmVudCA9IGVsZW1lbnQucGFyZW50KClbMF07XHJcbiAgICAgICAvLyBMb29rIGZvciB0aGUgbmVhcmVzdCBwYXJlbnQgbWQtY29udGVudCwgc3RvcHBpbmcgYXQgdGhlIHJvb3RFbGVtZW50LlxyXG4gICAgICAgd2hpbGUgKGN1cnJlbnQgJiYgY3VycmVudCAhPT0gJHJvb3RFbGVtZW50WzBdICYmIGN1cnJlbnQgIT09IGRvY3VtZW50LmJvZHkpIHtcclxuICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50Tm9kZTtcclxuICAgICAgIH1cclxuICAgICAgIHJldHVybiBjdXJyZW50O1xyXG4gICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoYXNDb21wdXRlZFN0eWxlVmFsdWUoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIHdlIHNob3VsZCBzaG93IGl0IG9yIG5vdC4uLlxyXG4gICAgICAgIHZhciBjb21wdXRlZFN0eWxlcyA9ICR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50WzBdKTtcclxuICAgICAgICByZXR1cm4gYW5ndWxhci5pc0RlZmluZWQoY29tcHV0ZWRTdHlsZXNba2V5XSkgJiYgKGNvbXB1dGVkU3R5bGVzW2tleV0gPT0gdmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGJpbmRFdmVudHMgKCkge1xyXG4gICAgICB2YXIgbW91c2VBY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdmFyIGVudGVySGFuZGxlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghaGFzQ29tcHV0ZWRTdHlsZVZhbHVlKCdwb2ludGVyLWV2ZW50cycsJ25vbmUnKSkge1xyXG4gICAgICAgICAgc2V0VmlzaWJsZSh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIHZhciBsZWF2ZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGF1dG9oaWRlID0gc2NvcGUuaGFzT3duUHJvcGVydHkoJ2F1dG9oaWRlJykgPyBzY29wZS5hdXRvaGlkZSA6IGF0dHIuaGFzT3duUHJvcGVydHkoJ21kQXV0b2hpZGUnKTtcclxuICAgICAgICBpZiAoYXV0b2hpZGUgfHwgbW91c2VBY3RpdmUgfHwgKCRkb2N1bWVudFswXS5hY3RpdmVFbGVtZW50ICE9PSBwYXJlbnRbMF0pICkge1xyXG4gICAgICAgICAgc2V0VmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1vdXNlQWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyB0byBhdm9pZCBgc3ludGhldGljIGNsaWNrc2Agd2UgbGlzdGVuIHRvIG1vdXNlZG93biBpbnN0ZWFkIG9mIGBjbGlja2BcclxuICAgICAgcGFyZW50Lm9uKCdtb3VzZWRvd24nLCBmdW5jdGlvbigpIHsgbW91c2VBY3RpdmUgPSB0cnVlOyB9KTtcclxuICAgICAgcGFyZW50Lm9uKCdmb2N1cyBtb3VzZWVudGVyIHRvdWNoc3RhcnQnLCBlbnRlckhhbmRsZXIgKTtcclxuICAgICAgcGFyZW50Lm9uKCdibHVyIG1vdXNlbGVhdmUgdG91Y2hlbmQgdG91Y2hjYW5jZWwnLCBsZWF2ZUhhbmRsZXIgKTtcclxuXHJcblxyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub24oJ3Jlc2l6ZScsIGRlYm91bmNlZE9uUmVzaXplKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZXRWaXNpYmxlICh2YWx1ZSkge1xyXG4gICAgICBzZXRWaXNpYmxlLnZhbHVlID0gISF2YWx1ZTtcclxuICAgICAgaWYgKCFzZXRWaXNpYmxlLnF1ZXVlZCkge1xyXG4gICAgICAgIGlmICh2YWx1ZSkge1xyXG4gICAgICAgICAgc2V0VmlzaWJsZS5xdWV1ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNjb3BlLnZpc2libGUgPSBzZXRWaXNpYmxlLnZhbHVlO1xyXG4gICAgICAgICAgICBzZXRWaXNpYmxlLnF1ZXVlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgfSwgc2NvcGUuZGVsYXkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHsgc2NvcGUudmlzaWJsZSA9IGZhbHNlOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzaG93VG9vbHRpcCgpIHtcclxuICAgICAgLy8gSW5zZXJ0IHRoZSBlbGVtZW50IGJlZm9yZSBwb3NpdGlvbmluZyBpdCwgc28gd2UgY2FuIGdldCB0aGUgcG9zaXRpb25cclxuICAgICAgLy8gYW5kIGNoZWNrIGlmIHdlIHNob3VsZCBkaXNwbGF5IGl0XHJcbiAgICAgIHRvb2x0aXBQYXJlbnQuYXBwZW5kKGVsZW1lbnQpO1xyXG5cclxuICAgICAgLy8gQ2hlY2sgaWYgd2Ugc2hvdWxkIGRpc3BsYXkgaXQgb3Igbm90LlxyXG4gICAgICAvLyBUaGlzIGhhbmRsZXMgaGlkZS0qIGFuZCBzaG93LSogYWxvbmcgd2l0aCBhbnkgdXNlciBkZWZpbmVkIGNzc1xyXG4gICAgICBpZiAoIGhhc0NvbXB1dGVkU3R5bGVWYWx1ZSgnZGlzcGxheScsJ25vbmUnKSApIHtcclxuICAgICAgICBzY29wZS52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgZWxlbWVudC5kZXRhY2goKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHBvc2l0aW9uVG9vbHRpcCgpO1xyXG4gICAgICBhbmd1bGFyLmZvckVhY2goW2VsZW1lbnQsIGJhY2tncm91bmQsIGNvbnRlbnRdLCBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgICRhbmltYXRlLmFkZENsYXNzKGVsZW1lbnQsICdtZC1zaG93Jyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhpZGVUb29sdGlwKCkge1xyXG4gICAgICAkcS5hbGwoW1xyXG4gICAgICAgICRhbmltYXRlLnJlbW92ZUNsYXNzKGNvbnRlbnQsICdtZC1zaG93JyksXHJcbiAgICAgICAgJGFuaW1hdGUucmVtb3ZlQ2xhc3MoYmFja2dyb3VuZCwgJ21kLXNob3cnKSxcclxuICAgICAgICAkYW5pbWF0ZS5yZW1vdmVDbGFzcyhlbGVtZW50LCAnbWQtc2hvdycpXHJcbiAgICAgIF0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghc2NvcGUudmlzaWJsZSkgZWxlbWVudC5kZXRhY2goKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcG9zaXRpb25Ub29sdGlwKCkge1xyXG4gICAgICB2YXIgdGlwUmVjdCA9ICRtZFV0aWwub2Zmc2V0UmVjdChlbGVtZW50LCB0b29sdGlwUGFyZW50KTtcclxuICAgICAgdmFyIHBhcmVudFJlY3QgPSAkbWRVdGlsLm9mZnNldFJlY3QocGFyZW50LCB0b29sdGlwUGFyZW50KTtcclxuICAgICAgdmFyIG5ld1Bvc2l0aW9uID0gZ2V0UG9zaXRpb24oZGlyZWN0aW9uKTtcclxuXHJcbiAgICAgIC8vIElmIHRoZSB1c2VyIHByb3ZpZGVkIGEgZGlyZWN0aW9uLCBqdXN0IG51ZGdlIHRoZSB0b29sdGlwIG9udG8gdGhlIHNjcmVlblxyXG4gICAgICAvLyBPdGhlcndpc2UsIHJlY2FsY3VsYXRlIGJhc2VkIG9uICd0b3AnIHNpbmNlIGRlZmF1bHQgaXMgJ2JvdHRvbSdcclxuICAgICAgaWYgKGRpcmVjdGlvbikge1xyXG4gICAgICAgIG5ld1Bvc2l0aW9uID0gZml0SW5QYXJlbnQobmV3UG9zaXRpb24pO1xyXG4gICAgICB9IGVsc2UgaWYgKG5ld1Bvc2l0aW9uLnRvcCA+IGVsZW1lbnQucHJvcCgnb2Zmc2V0UGFyZW50Jykuc2Nyb2xsSGVpZ2h0IC0gdGlwUmVjdC5oZWlnaHQgLSBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFKSB7XHJcbiAgICAgICAgbmV3UG9zaXRpb24gPSBmaXRJblBhcmVudChnZXRQb3NpdGlvbigndG9wJykpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBlbGVtZW50LmNzcyh7dG9wOiBuZXdQb3NpdGlvbi50b3AgKyAncHgnLCBsZWZ0OiBuZXdQb3NpdGlvbi5sZWZ0ICsgJ3B4J30pO1xyXG5cclxuICAgICAgcG9zaXRpb25CYWNrZ3JvdW5kKCk7XHJcblxyXG4gICAgICBmdW5jdGlvbiBwb3NpdGlvbkJhY2tncm91bmQgKCkge1xyXG4gICAgICAgIHZhciBzaXplID0gZGlyZWN0aW9uID09PSAnbGVmdCcgfHwgZGlyZWN0aW9uID09PSAncmlnaHQnXHJcbiAgICAgICAgICAgICAgPyBNYXRoLnNxcnQoTWF0aC5wb3codGlwUmVjdC53aWR0aCwgMikgKyBNYXRoLnBvdyh0aXBSZWN0LmhlaWdodCAvIDIsIDIpKSAqIDJcclxuICAgICAgICAgICAgICA6IE1hdGguc3FydChNYXRoLnBvdyh0aXBSZWN0LndpZHRoIC8gMiwgMikgKyBNYXRoLnBvdyh0aXBSZWN0LmhlaWdodCwgMikpICogMixcclxuICAgICAgICAgICAgcG9zaXRpb24gPSBkaXJlY3Rpb24gPT09ICdsZWZ0JyA/IHsgbGVmdDogMTAwLCB0b3A6IDUwIH1cclxuICAgICAgICAgICAgICA6IGRpcmVjdGlvbiA9PT0gJ3JpZ2h0JyA/IHsgbGVmdDogMCwgdG9wOiA1MCB9XHJcbiAgICAgICAgICAgICAgOiBkaXJlY3Rpb24gPT09ICd0b3AnID8geyBsZWZ0OiA1MCwgdG9wOiAxMDAgfVxyXG4gICAgICAgICAgICAgIDogeyBsZWZ0OiA1MCwgdG9wOiAwIH07XHJcbiAgICAgICAgYmFja2dyb3VuZC5jc3Moe1xyXG4gICAgICAgICAgd2lkdGg6IHNpemUgKyAncHgnLFxyXG4gICAgICAgICAgaGVpZ2h0OiBzaXplICsgJ3B4JyxcclxuICAgICAgICAgIGxlZnQ6IHBvc2l0aW9uLmxlZnQgKyAnJScsXHJcbiAgICAgICAgICB0b3A6IHBvc2l0aW9uLnRvcCArICclJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBmaXRJblBhcmVudCAocG9zKSB7XHJcbiAgICAgICAgdmFyIG5ld1Bvc2l0aW9uID0geyBsZWZ0OiBwb3MubGVmdCwgdG9wOiBwb3MudG9wIH07XHJcbiAgICAgICAgbmV3UG9zaXRpb24ubGVmdCA9IE1hdGgubWluKCBuZXdQb3NpdGlvbi5sZWZ0LCB0b29sdGlwUGFyZW50LnByb3AoJ3Njcm9sbFdpZHRoJykgLSB0aXBSZWN0LndpZHRoIC0gVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSApO1xyXG4gICAgICAgIG5ld1Bvc2l0aW9uLmxlZnQgPSBNYXRoLm1heCggbmV3UG9zaXRpb24ubGVmdCwgVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSApO1xyXG4gICAgICAgIG5ld1Bvc2l0aW9uLnRvcCAgPSBNYXRoLm1pbiggbmV3UG9zaXRpb24udG9wLCAgdG9vbHRpcFBhcmVudC5wcm9wKCdzY3JvbGxIZWlnaHQnKSAtIHRpcFJlY3QuaGVpZ2h0IC0gVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSApO1xyXG4gICAgICAgIG5ld1Bvc2l0aW9uLnRvcCAgPSBNYXRoLm1heCggbmV3UG9zaXRpb24udG9wLCAgVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSApO1xyXG4gICAgICAgIHJldHVybiBuZXdQb3NpdGlvbjtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0UG9zaXRpb24gKGRpcikge1xyXG4gICAgICAgIHJldHVybiBkaXIgPT09ICdsZWZ0J1xyXG4gICAgICAgICAgPyB7IGxlZnQ6IHBhcmVudFJlY3QubGVmdCAtIHRpcFJlY3Qud2lkdGggLSBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFLFxyXG4gICAgICAgICAgICAgIHRvcDogcGFyZW50UmVjdC50b3AgKyBwYXJlbnRSZWN0LmhlaWdodCAvIDIgLSB0aXBSZWN0LmhlaWdodCAvIDIgfVxyXG4gICAgICAgICAgOiBkaXIgPT09ICdyaWdodCdcclxuICAgICAgICAgID8geyBsZWZ0OiBwYXJlbnRSZWN0LmxlZnQgKyBwYXJlbnRSZWN0LndpZHRoICsgVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSxcclxuICAgICAgICAgICAgICB0b3A6IHBhcmVudFJlY3QudG9wICsgcGFyZW50UmVjdC5oZWlnaHQgLyAyIC0gdGlwUmVjdC5oZWlnaHQgLyAyIH1cclxuICAgICAgICAgIDogZGlyID09PSAndG9wJ1xyXG4gICAgICAgICAgPyB7IGxlZnQ6IHBhcmVudFJlY3QubGVmdCArIHBhcmVudFJlY3Qud2lkdGggLyAyIC0gdGlwUmVjdC53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgdG9wOiBwYXJlbnRSZWN0LnRvcCAtIHRpcFJlY3QuaGVpZ2h0IC0gVE9PTFRJUF9XSU5ET1dfRURHRV9TUEFDRSB9XHJcbiAgICAgICAgICA6IHsgbGVmdDogcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50UmVjdC53aWR0aCAvIDIgLSB0aXBSZWN0LndpZHRoIC8gMixcclxuICAgICAgICAgICAgICB0b3A6IHBhcmVudFJlY3QudG9wICsgcGFyZW50UmVjdC5oZWlnaHQgKyBUT09MVElQX1dJTkRPV19FREdFX1NQQUNFIH07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxufVxyXG5NZFRvb2x0aXBEaXJlY3RpdmUuJGluamVjdCA9IFtcIiR0aW1lb3V0XCIsIFwiJHdpbmRvd1wiLCBcIiQkckFGXCIsIFwiJGRvY3VtZW50XCIsIFwiJG1kVXRpbFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkcm9vdEVsZW1lbnRcIiwgXCIkYW5pbWF0ZVwiLCBcIiRxXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBtb2R1bGVcclxuICogQG5hbWUgbWF0ZXJpYWwuY29tcG9uZW50cy53aGl0ZWZyYW1lXHJcbiAqL1xyXG5hbmd1bGFyLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy53aGl0ZWZyYW1lJywgW10pO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ01kQXV0b2NvbXBsZXRlQ3RybCcsIE1kQXV0b2NvbXBsZXRlQ3RybCk7XHJcblxyXG52YXIgSVRFTV9IRUlHSFQgPSA0MSxcclxuICAgIE1BWF9IRUlHSFQgPSA1LjUgKiBJVEVNX0hFSUdIVCxcclxuICAgIE1FTlVfUEFERElORyA9IDg7XHJcblxyXG5mdW5jdGlvbiBNZEF1dG9jb21wbGV0ZUN0cmwgKCRzY29wZSwgJGVsZW1lbnQsICRtZFV0aWwsICRtZENvbnN0YW50LCAkdGltZW91dCwgJG1kVGhlbWluZywgJHdpbmRvdyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYW5pbWF0ZSwgJHJvb3RFbGVtZW50LCAkYXR0cnMpIHtcclxuICAvLy0tIHByaXZhdGUgdmFyaWFibGVzXHJcbiAgdmFyIGN0cmwgICAgICA9IHRoaXMsXHJcbiAgICAgIGl0ZW1QYXJ0cyA9ICRzY29wZS5pdGVtc0V4cHIuc3BsaXQoLyBpbiAvaSksXHJcbiAgICAgIGl0ZW1FeHByICA9IGl0ZW1QYXJ0c1sxXSxcclxuICAgICAgZWxlbWVudHMgID0gbnVsbCxcclxuICAgICAgcHJvbWlzZSAgID0gbnVsbCxcclxuICAgICAgY2FjaGUgICAgID0ge30sXHJcbiAgICAgIG5vQmx1ciAgICA9IGZhbHNlLFxyXG4gICAgICBzZWxlY3RlZEl0ZW1XYXRjaGVycyA9IFtdLFxyXG4gICAgICBoYXNGb2N1cyAgPSBmYWxzZSxcclxuICAgICAgbGFzdENvdW50ID0gMDtcclxuXHJcbiAgLy8tLSBwdWJsaWMgdmFyaWFibGVzIHdpdGggaGFuZGxlcnNcclxuICBkZWZpbmVQcm9wZXJ0eSgnaGlkZGVuJywgaGFuZGxlSGlkZGVuQ2hhbmdlLCB0cnVlKTtcclxuXHJcbiAgLy8tLSBwdWJsaWMgdmFyaWFibGVzXHJcbiAgY3RybC5zY29wZSAgICAgID0gJHNjb3BlO1xyXG4gIGN0cmwucGFyZW50ICAgICA9ICRzY29wZS4kcGFyZW50O1xyXG4gIGN0cmwuaXRlbU5hbWUgICA9IGl0ZW1QYXJ0c1swXTtcclxuICBjdHJsLm1hdGNoZXMgICAgPSBbXTtcclxuICBjdHJsLmxvYWRpbmcgICAgPSBmYWxzZTtcclxuICBjdHJsLmhpZGRlbiAgICAgPSB0cnVlO1xyXG4gIGN0cmwuaW5kZXggICAgICA9IG51bGw7XHJcbiAgY3RybC5tZXNzYWdlcyAgID0gW107XHJcbiAgY3RybC5pZCAgICAgICAgID0gJG1kVXRpbC5uZXh0VWlkKCk7XHJcbiAgY3RybC5pc0Rpc2FibGVkID0gbnVsbDtcclxuICBjdHJsLmlzUmVxdWlyZWQgPSBudWxsO1xyXG5cclxuICAvLy0tIHB1YmxpYyBtZXRob2RzXHJcbiAgY3RybC5rZXlkb3duICAgID0ga2V5ZG93bjtcclxuICBjdHJsLmJsdXIgICAgICAgPSBibHVyO1xyXG4gIGN0cmwuZm9jdXMgICAgICA9IGZvY3VzO1xyXG4gIGN0cmwuY2xlYXIgICAgICA9IGNsZWFyVmFsdWU7XHJcbiAgY3RybC5zZWxlY3QgICAgID0gc2VsZWN0O1xyXG4gIGN0cmwubGlzdEVudGVyICA9IG9uTGlzdEVudGVyO1xyXG4gIGN0cmwubGlzdExlYXZlICA9IG9uTGlzdExlYXZlO1xyXG4gIGN0cmwubW91c2VVcCAgICA9IG9uTW91c2V1cDtcclxuICBjdHJsLmdldEN1cnJlbnREaXNwbGF5VmFsdWUgICAgICAgICA9IGdldEN1cnJlbnREaXNwbGF5VmFsdWU7XHJcbiAgY3RybC5yZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXIgICAgPSByZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXI7XHJcbiAgY3RybC51bnJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlciAgPSB1bnJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcjtcclxuXHJcbiAgcmV0dXJuIGluaXQoKTtcclxuXHJcbiAgLy8tLSBpbml0aWFsaXphdGlvbiBtZXRob2RzXHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgdGhlIGNvbnRyb2xsZXIsIHNldHVwIHdhdGNoZXJzLCBnYXRoZXIgZWxlbWVudHNcclxuICAgKi9cclxuICBmdW5jdGlvbiBpbml0ICgpIHtcclxuICAgICRtZFV0aWwuaW5pdE9wdGlvbmFsUHJvcGVydGllcygkc2NvcGUsICRhdHRycywgeyBzZWFyY2hUZXh0OiBudWxsLCBzZWxlY3RlZEl0ZW06IG51bGwgfSApO1xyXG4gICAgJG1kVGhlbWluZygkZWxlbWVudCk7XHJcbiAgICBjb25maWd1cmVXYXRjaGVycygpO1xyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICBnYXRoZXJFbGVtZW50cygpO1xyXG4gICAgICBmb2N1c0VsZW1lbnQoKTtcclxuICAgICAgbW92ZURyb3Bkb3duKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGN1bGF0ZXMgdGhlIGRyb3Bkb3duJ3MgcG9zaXRpb24gYW5kIGFwcGxpZXMgdGhlIG5ldyBzdHlsZXMgdG8gdGhlIG1lbnUgZWxlbWVudFxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHBvc2l0aW9uRHJvcGRvd24gKCkge1xyXG4gICAgaWYgKCFlbGVtZW50cykgcmV0dXJuICR0aW1lb3V0KHBvc2l0aW9uRHJvcGRvd24sIDAsIGZhbHNlKTtcclxuICAgIHZhciBocmVjdCAgPSBlbGVtZW50cy53cmFwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxyXG4gICAgICAgIHZyZWN0ICA9IGVsZW1lbnRzLnNuYXAuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXHJcbiAgICAgICAgcm9vdCAgID0gZWxlbWVudHMucm9vdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICB0b3AgICAgPSB2cmVjdC5ib3R0b20gLSByb290LnRvcCxcclxuICAgICAgICBib3QgICAgPSByb290LmJvdHRvbSAtIHZyZWN0LnRvcCxcclxuICAgICAgICBsZWZ0ICAgPSBocmVjdC5sZWZ0IC0gcm9vdC5sZWZ0LFxyXG4gICAgICAgIHdpZHRoICA9IGhyZWN0LndpZHRoLFxyXG4gICAgICAgIHN0eWxlcyA9IHtcclxuICAgICAgICAgIGxlZnQ6ICAgICBsZWZ0ICsgJ3B4JyxcclxuICAgICAgICAgIG1pbldpZHRoOiB3aWR0aCArICdweCcsXHJcbiAgICAgICAgICBtYXhXaWR0aDogTWF0aC5tYXgoaHJlY3QucmlnaHQgLSByb290LmxlZnQsIHJvb3QucmlnaHQgLSBocmVjdC5sZWZ0KSAtIE1FTlVfUEFERElORyArICdweCdcclxuICAgICAgICB9O1xyXG4gICAgaWYgKHRvcCA+IGJvdCAmJiByb290LmhlaWdodCAtIGhyZWN0LmJvdHRvbSAtIE1FTlVfUEFERElORyA8IE1BWF9IRUlHSFQpIHtcclxuICAgICAgc3R5bGVzLnRvcCA9ICdhdXRvJztcclxuICAgICAgc3R5bGVzLmJvdHRvbSA9IGJvdCArICdweCc7XHJcbiAgICAgIHN0eWxlcy5tYXhIZWlnaHQgPSBNYXRoLm1pbihNQVhfSEVJR0hULCBocmVjdC50b3AgLSByb290LnRvcCAtIE1FTlVfUEFERElORykgKyAncHgnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc3R5bGVzLnRvcCA9IHRvcCArICdweCc7XHJcbiAgICAgIHN0eWxlcy5ib3R0b20gPSAnYXV0byc7XHJcbiAgICAgIHN0eWxlcy5tYXhIZWlnaHQgPSBNYXRoLm1pbihNQVhfSEVJR0hULCByb290LmJvdHRvbSAtIGhyZWN0LmJvdHRvbSAtIE1FTlVfUEFERElORykgKyAncHgnO1xyXG4gICAgfVxyXG4gICAgZWxlbWVudHMuJC51bC5jc3Moc3R5bGVzKTtcclxuICAgICR0aW1lb3V0KGNvcnJlY3RIb3Jpem9udGFsQWxpZ25tZW50LCAwLCBmYWxzZSk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYWtlcyBzdXJlIHRoYXQgdGhlIG1lbnUgZG9lc24ndCBnbyBvZmYgb2YgdGhlIHNjcmVlbiBvbiBlaXRoZXIgc2lkZS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY29ycmVjdEhvcml6b250YWxBbGlnbm1lbnQgKCkge1xyXG4gICAgICB2YXIgZHJvcGRvd24gPSBlbGVtZW50cy51bC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcclxuICAgICAgICAgIHN0eWxlcyAgID0ge307XHJcbiAgICAgIGlmIChkcm9wZG93bi5yaWdodCA+IHJvb3QucmlnaHQgLSBNRU5VX1BBRERJTkcpIHtcclxuICAgICAgICBzdHlsZXMubGVmdCA9IChocmVjdC5yaWdodCAtIGRyb3Bkb3duLndpZHRoKSArICdweCc7XHJcbiAgICAgIH1cclxuICAgICAgZWxlbWVudHMuJC51bC5jc3Moc3R5bGVzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1vdmVzIHRoZSBkcm9wZG93biBtZW51IHRvIHRoZSBib2R5IHRhZyBpbiBvcmRlciB0byBhdm9pZCB6LWluZGV4IGFuZCBvdmVyZmxvdyBpc3N1ZXMuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gbW92ZURyb3Bkb3duICgpIHtcclxuICAgIGlmICghZWxlbWVudHMuJC5yb290Lmxlbmd0aCkgcmV0dXJuO1xyXG4gICAgJG1kVGhlbWluZyhlbGVtZW50cy4kLnVsKTtcclxuICAgIGVsZW1lbnRzLiQudWwuZGV0YWNoKCk7XHJcbiAgICBlbGVtZW50cy4kLnJvb3QuYXBwZW5kKGVsZW1lbnRzLiQudWwpO1xyXG4gICAgaWYgKCRhbmltYXRlLnBpbikgJGFuaW1hdGUucGluKGVsZW1lbnRzLiQudWwsICRyb290RWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZW5kcyBmb2N1cyB0byB0aGUgaW5wdXQgZWxlbWVudC5cclxuICAgKi9cclxuICBmdW5jdGlvbiBmb2N1c0VsZW1lbnQgKCkge1xyXG4gICAgaWYgKCRzY29wZS5hdXRvZm9jdXMpIGVsZW1lbnRzLmlucHV0LmZvY3VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXRzIHVwIGFueSB3YXRjaGVycyB1c2VkIGJ5IGF1dG9jb21wbGV0ZVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGNvbmZpZ3VyZVdhdGNoZXJzICgpIHtcclxuICAgIHZhciB3YWl0ID0gcGFyc2VJbnQoJHNjb3BlLmRlbGF5LCAxMCkgfHwgMDtcclxuICAgICRhdHRycy4kb2JzZXJ2ZSgnZGlzYWJsZWQnLCBmdW5jdGlvbiAodmFsdWUpIHsgY3RybC5pc0Rpc2FibGVkID0gdmFsdWU7IH0pO1xyXG4gICAgJGF0dHJzLiRvYnNlcnZlKCdyZXF1aXJlZCcsIGZ1bmN0aW9uICh2YWx1ZSkgeyBjdHJsLmlzUmVxdWlyZWQgPSB2YWx1ZSAhPT0gbnVsbDsgfSk7XHJcbiAgICAkc2NvcGUuJHdhdGNoKCdzZWFyY2hUZXh0Jywgd2FpdCA/ICRtZFV0aWwuZGVib3VuY2UoaGFuZGxlU2VhcmNoVGV4dCwgd2FpdCkgOiBoYW5kbGVTZWFyY2hUZXh0KTtcclxuICAgIHJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcihzZWxlY3RlZEl0ZW1DaGFuZ2UpO1xyXG4gICAgJHNjb3BlLiR3YXRjaCgnc2VsZWN0ZWRJdGVtJywgaGFuZGxlU2VsZWN0ZWRJdGVtQ2hhbmdlKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgcG9zaXRpb25Ecm9wZG93bik7XHJcbiAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGNsZWFudXApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlcyBhbnkgZXZlbnRzIG9yIGxlZnRvdmVyIGVsZW1lbnRzIGNyZWF0ZWQgYnkgdGhpcyBjb250cm9sbGVyXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY2xlYW51cCAoKSB7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykub2ZmKCdyZXNpemUnLCBwb3NpdGlvbkRyb3Bkb3duKTtcclxuICAgIGVsZW1lbnRzLiQudWwucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHYXRoZXJzIGFsbCBvZiB0aGUgZWxlbWVudHMgbmVlZGVkIGZvciB0aGlzIGNvbnRyb2xsZXJcclxuICAgKi9cclxuICBmdW5jdGlvbiBnYXRoZXJFbGVtZW50cyAoKSB7XHJcbiAgICBlbGVtZW50cyA9IHtcclxuICAgICAgbWFpbjogICRlbGVtZW50WzBdLFxyXG4gICAgICB1bDogICAgJGVsZW1lbnQuZmluZCgndWwnKVswXSxcclxuICAgICAgaW5wdXQ6ICRlbGVtZW50LmZpbmQoJ2lucHV0JylbMF0sXHJcbiAgICAgIHdyYXA6ICAkZWxlbWVudC5maW5kKCdtZC1hdXRvY29tcGxldGUtd3JhcCcpWzBdLFxyXG4gICAgICByb290OiAgZG9jdW1lbnQuYm9keVxyXG4gICAgfTtcclxuICAgIGVsZW1lbnRzLmxpID0gZWxlbWVudHMudWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2xpJyk7XHJcbiAgICBlbGVtZW50cy5zbmFwID0gZ2V0U25hcFRhcmdldCgpO1xyXG4gICAgZWxlbWVudHMuJCA9IGdldEFuZ3VsYXJFbGVtZW50cyhlbGVtZW50cyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGaW5kcyB0aGUgZWxlbWVudCB0aGF0IHRoZSBtZW51IHdpbGwgYmFzZSBpdHMgcG9zaXRpb24gb25cclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXRTbmFwVGFyZ2V0ICgpIHtcclxuICAgIGZvciAodmFyIGVsZW1lbnQgPSAkZWxlbWVudDsgZWxlbWVudC5sZW5ndGg7IGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudCgpKSB7XHJcbiAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChlbGVtZW50LmF0dHIoJ21kLWF1dG9jb21wbGV0ZS1zbmFwJykpKSByZXR1cm4gZWxlbWVudFswXTtcclxuICAgIH1cclxuICAgIHJldHVybiBlbGVtZW50cy53cmFwO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2F0aGVycyBhbmd1bGFyLXdyYXBwZWQgdmVyc2lvbnMgb2YgZWFjaCBlbGVtZW50XHJcbiAgICogQHBhcmFtIGVsZW1lbnRzXHJcbiAgICogQHJldHVybnMge3t9fVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldEFuZ3VsYXJFbGVtZW50cyAoZWxlbWVudHMpIHtcclxuICAgIHZhciBvYmogPSB7fTtcclxuICAgIGZvciAodmFyIGtleSBpbiBlbGVtZW50cykge1xyXG4gICAgICBvYmpba2V5XSA9IGFuZ3VsYXIuZWxlbWVudChlbGVtZW50c1trZXldKTtcclxuICAgIH1cclxuICAgIHJldHVybiBvYmo7XHJcbiAgfVxyXG5cclxuICAvLy0tIGV2ZW50L2NoYW5nZSBoYW5kbGVyc1xyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGVzIGNoYW5nZXMgdG8gdGhlIGBoaWRkZW5gIHByb3BlcnR5LlxyXG4gICAqIEBwYXJhbSBoaWRkZW5cclxuICAgKiBAcGFyYW0gb2xkSGlkZGVuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlSGlkZGVuQ2hhbmdlIChoaWRkZW4sIG9sZEhpZGRlbikge1xyXG4gICAgaWYgKCFoaWRkZW4gJiYgb2xkSGlkZGVuKSBwb3NpdGlvbkRyb3Bkb3duKCk7XHJcbiAgICBpZiAoIWhpZGRlbikge1xyXG4gICAgICBpZiAoZWxlbWVudHMpICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgJG1kVXRpbC5kaXNhYmxlU2Nyb2xsQXJvdW5kKGVsZW1lbnRzLnVsKTsgfSwgMCwgZmFsc2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJG1kVXRpbC5lbmFibGVTY3JvbGxpbmcoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdoZW4gdGhlIHVzZXIgbW91c2VzIG92ZXIgdGhlIGRyb3Bkb3duIG1lbnUsIGlnbm9yZSBibHVyIGV2ZW50cy5cclxuICAgKi9cclxuICBmdW5jdGlvbiBvbkxpc3RFbnRlciAoKSB7XHJcbiAgICBub0JsdXIgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogV2hlbiB0aGUgdXNlcidzIG1vdXNlIGxlYXZlcyB0aGUgbWVudSwgYmx1ciBldmVudHMgbWF5IGhpZGUgdGhlIG1lbnUgYWdhaW4uXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gb25MaXN0TGVhdmUgKCkge1xyXG4gICAgbm9CbHVyID0gZmFsc2U7XHJcbiAgICBpZiAoIWhhc0ZvY3VzKSBjdHJsLmhpZGRlbiA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRoZSBtb3VzZSBidXR0b24gaXMgcmVsZWFzZWQsIHNlbmQgZm9jdXMgYmFjayB0byB0aGUgaW5wdXQgZmllbGQuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gb25Nb3VzZXVwICgpIHtcclxuICAgIGVsZW1lbnRzLmlucHV0LmZvY3VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGVzIGNoYW5nZXMgdG8gdGhlIHNlbGVjdGVkIGl0ZW0uXHJcbiAgICogQHBhcmFtIHNlbGVjdGVkSXRlbVxyXG4gICAqIEBwYXJhbSBwcmV2aW91c1NlbGVjdGVkSXRlbVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZSAoc2VsZWN0ZWRJdGVtLCBwcmV2aW91c1NlbGVjdGVkSXRlbSkge1xyXG4gICAgaWYgKHNlbGVjdGVkSXRlbSkge1xyXG4gICAgICAkc2NvcGUuc2VhcmNoVGV4dCA9IGdldERpc3BsYXlWYWx1ZShzZWxlY3RlZEl0ZW0pO1xyXG4gICAgfVxyXG4gICAgaWYgKGFuZ3VsYXIuaXNGdW5jdGlvbigkc2NvcGUuaXRlbUNoYW5nZSkgJiYgc2VsZWN0ZWRJdGVtICE9PSBwcmV2aW91c1NlbGVjdGVkSXRlbSlcclxuICAgICAgJHNjb3BlLml0ZW1DaGFuZ2UoZ2V0SXRlbVNjb3BlKHNlbGVjdGVkSXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2FsbHMgYW55IGV4dGVybmFsIHdhdGNoZXJzIGxpc3RlbmluZyBmb3IgdGhlIHNlbGVjdGVkIGl0ZW0uICBVc2VkIGluIGNvbmp1bmN0aW9uIHdpdGhcclxuICAgKiBgcmVnaXN0ZXJTZWxlY3RlZEl0ZW1XYXRjaGVyYC5cclxuICAgKiBAcGFyYW0gc2VsZWN0ZWRJdGVtXHJcbiAgICogQHBhcmFtIHByZXZpb3VzU2VsZWN0ZWRJdGVtXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlU2VsZWN0ZWRJdGVtQ2hhbmdlKHNlbGVjdGVkSXRlbSwgcHJldmlvdXNTZWxlY3RlZEl0ZW0pIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZWN0ZWRJdGVtV2F0Y2hlcnMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgc2VsZWN0ZWRJdGVtV2F0Y2hlcnNbaV0oc2VsZWN0ZWRJdGVtLCBwcmV2aW91c1NlbGVjdGVkSXRlbSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWdpc3RlciBhIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIHRoZSBzZWxlY3RlZCBpdGVtIGNoYW5nZXMuXHJcbiAgICogQHBhcmFtIGNiXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcmVnaXN0ZXJTZWxlY3RlZEl0ZW1XYXRjaGVyKGNiKSB7XHJcbiAgICBpZiAoc2VsZWN0ZWRJdGVtV2F0Y2hlcnMuaW5kZXhPZihjYikgPT0gLTEpIHtcclxuICAgICAgc2VsZWN0ZWRJdGVtV2F0Y2hlcnMucHVzaChjYik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVbnJlZ2lzdGVyIGEgZnVuY3Rpb24gcHJldmlvdXNseSByZWdpc3RlcmVkIGZvciBzZWxlY3RlZCBpdGVtIGNoYW5nZXMuXHJcbiAgICogQHBhcmFtIGNiXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gdW5yZWdpc3RlclNlbGVjdGVkSXRlbVdhdGNoZXIoY2IpIHtcclxuICAgIHZhciBpID0gc2VsZWN0ZWRJdGVtV2F0Y2hlcnMuaW5kZXhPZihjYik7XHJcbiAgICBpZiAoaSAhPSAtMSkge1xyXG4gICAgICBzZWxlY3RlZEl0ZW1XYXRjaGVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGVzIGNoYW5nZXMgdG8gdGhlIHNlYXJjaFRleHQgcHJvcGVydHkuXHJcbiAgICogQHBhcmFtIHNlYXJjaFRleHRcclxuICAgKiBAcGFyYW0gcHJldmlvdXNTZWFyY2hUZXh0XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlU2VhcmNoVGV4dCAoc2VhcmNoVGV4dCwgcHJldmlvdXNTZWFyY2hUZXh0KSB7XHJcbiAgICBjdHJsLmluZGV4ID0gZ2V0RGVmYXVsdEluZGV4KCk7XHJcbiAgICAvLy0tIGRvIG5vdGhpbmcgb24gaW5pdFxyXG4gICAgaWYgKHNlYXJjaFRleHQgPT09IHByZXZpb3VzU2VhcmNoVGV4dCkgcmV0dXJuO1xyXG4gICAgLy8tLSBjbGVhciBzZWxlY3RlZCBpdGVtIGlmIHNlYXJjaCB0ZXh0IG5vIGxvbmdlciBtYXRjaGVzIGl0XHJcbiAgICBpZiAoc2VhcmNoVGV4dCAhPT0gZ2V0RGlzcGxheVZhbHVlKCRzY29wZS5zZWxlY3RlZEl0ZW0pKSAkc2NvcGUuc2VsZWN0ZWRJdGVtID0gbnVsbDtcclxuICAgIGVsc2UgcmV0dXJuO1xyXG4gICAgLy8tLSB0cmlnZ2VyIGNoYW5nZSBldmVudCBpZiBhdmFpbGFibGVcclxuICAgIGlmIChhbmd1bGFyLmlzRnVuY3Rpb24oJHNjb3BlLnRleHRDaGFuZ2UpICYmIHNlYXJjaFRleHQgIT09IHByZXZpb3VzU2VhcmNoVGV4dClcclxuICAgICAgJHNjb3BlLnRleHRDaGFuZ2UoZ2V0SXRlbVNjb3BlKCRzY29wZS5zZWxlY3RlZEl0ZW0pKTtcclxuICAgIC8vLS0gY2FuY2VsIHJlc3VsdHMgaWYgc2VhcmNoIHRleHQgaXMgbm90IGxvbmcgZW5vdWdoXHJcbiAgICBpZiAoIWlzTWluTGVuZ3RoTWV0KCkpIHtcclxuICAgICAgY3RybC5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgIGN0cmwubWF0Y2hlcyA9IFtdO1xyXG4gICAgICBjdHJsLmhpZGRlbiA9IHNob3VsZEhpZGUoKTtcclxuICAgICAgdXBkYXRlTWVzc2FnZXMoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGhhbmRsZVF1ZXJ5KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGVzIGlucHV0IGJsdXIgZXZlbnQsIGRldGVybWluZXMgaWYgdGhlIGRyb3Bkb3duIHNob3VsZCBoaWRlLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGJsdXIgKCkge1xyXG4gICAgaGFzRm9jdXMgPSBmYWxzZTtcclxuICAgIGlmICghbm9CbHVyKSBjdHJsLmhpZGRlbiA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGVzIGlucHV0IGZvY3VzIGV2ZW50LCBkZXRlcm1pbmVzIGlmIHRoZSBkcm9wZG93biBzaG91bGQgc2hvdy5cclxuICAgKi9cclxuICBmdW5jdGlvbiBmb2N1cyAoKSB7XHJcbiAgICBoYXNGb2N1cyA9IHRydWU7XHJcbiAgICAvLy0tIGlmIHNlYXJjaFRleHQgaXMgbnVsbCwgbGV0J3MgZm9yY2UgaXQgdG8gYmUgYSBzdHJpbmdcclxuICAgIGlmICghYW5ndWxhci5pc1N0cmluZygkc2NvcGUuc2VhcmNoVGV4dCkpICRzY29wZS5zZWFyY2hUZXh0ID0gJyc7XHJcbiAgICBpZiAoJHNjb3BlLm1pbkxlbmd0aCA+IDApIHJldHVybjtcclxuICAgIGN0cmwuaGlkZGVuID0gc2hvdWxkSGlkZSgpO1xyXG4gICAgaWYgKCFjdHJsLmhpZGRlbikgaGFuZGxlUXVlcnkoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZXMga2V5Ym9hcmQgaW5wdXQuXHJcbiAgICogQHBhcmFtIGV2ZW50XHJcbiAgICovXHJcbiAgZnVuY3Rpb24ga2V5ZG93biAoZXZlbnQpIHtcclxuICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xyXG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLkRPV05fQVJST1c6XHJcbiAgICAgICAgaWYgKGN0cmwubG9hZGluZykgcmV0dXJuO1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgY3RybC5pbmRleCA9IE1hdGgubWluKGN0cmwuaW5kZXggKyAxLCBjdHJsLm1hdGNoZXMubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgdXBkYXRlU2Nyb2xsKCk7XHJcbiAgICAgICAgdXBkYXRlTWVzc2FnZXMoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5VUF9BUlJPVzpcclxuICAgICAgICBpZiAoY3RybC5sb2FkaW5nKSByZXR1cm47XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBjdHJsLmluZGV4ID0gY3RybC5pbmRleCA8IDAgPyBjdHJsLm1hdGNoZXMubGVuZ3RoIC0gMSA6IE1hdGgubWF4KDAsIGN0cmwuaW5kZXggLSAxKTtcclxuICAgICAgICB1cGRhdGVTY3JvbGwoKTtcclxuICAgICAgICB1cGRhdGVNZXNzYWdlcygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlRBQjpcclxuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5FTlRFUjpcclxuICAgICAgICBpZiAoY3RybC5oaWRkZW4gfHwgY3RybC5sb2FkaW5nIHx8IGN0cmwuaW5kZXggPCAwIHx8IGN0cmwubWF0Y2hlcy5sZW5ndGggPCAxKSByZXR1cm47XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBzZWxlY3QoY3RybC5pbmRleCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFOlxyXG4gICAgICAgIGN0cmwubWF0Y2hlcyA9IFtdO1xyXG4gICAgICAgIGN0cmwuaGlkZGVuID0gdHJ1ZTtcclxuICAgICAgICBjdHJsLmluZGV4ID0gZ2V0RGVmYXVsdEluZGV4KCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLy0tIGdldHRlcnNcclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgbWluaW11bSBsZW5ndGggbmVlZGVkIHRvIGRpc3BsYXkgdGhlIGRyb3Bkb3duLlxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldE1pbkxlbmd0aCAoKSB7XHJcbiAgICByZXR1cm4gYW5ndWxhci5pc051bWJlcigkc2NvcGUubWluTGVuZ3RoKSA/ICRzY29wZS5taW5MZW5ndGggOiAxO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgZGlzcGxheSB2YWx1ZSBmb3IgYW4gaXRlbS5cclxuICAgKiBAcGFyYW0gaXRlbVxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldERpc3BsYXlWYWx1ZSAoaXRlbSkge1xyXG4gICAgcmV0dXJuIChpdGVtICYmICRzY29wZS5pdGVtVGV4dCkgPyAkc2NvcGUuaXRlbVRleHQoZ2V0SXRlbVNjb3BlKGl0ZW0pKSA6IGl0ZW07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBsb2NhbHMgb2JqZWN0IGZvciBjb21waWxpbmcgaXRlbSB0ZW1wbGF0ZXMuXHJcbiAgICogQHBhcmFtIGl0ZW1cclxuICAgKiBAcmV0dXJucyB7e319XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0SXRlbVNjb3BlIChpdGVtKSB7XHJcbiAgICBpZiAoIWl0ZW0pIHJldHVybjtcclxuICAgIHZhciBsb2NhbHMgPSB7fTtcclxuICAgIGlmIChjdHJsLml0ZW1OYW1lKSBsb2NhbHNbY3RybC5pdGVtTmFtZV0gPSBpdGVtO1xyXG4gICAgcmV0dXJuIGxvY2FscztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHVybnMgdGhlIGRlZmF1bHQgaW5kZXggYmFzZWQgb24gd2hldGhlciBvciBub3QgYXV0b3NlbGVjdCBpcyBlbmFibGVkLlxyXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0RGVmYXVsdEluZGV4ICgpIHtcclxuICAgIHJldHVybiAkc2NvcGUuYXV0b3NlbGVjdCA/IDAgOiAtMTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERldGVybWluZXMgaWYgdGhlIG1lbnUgc2hvdWxkIGJlIGhpZGRlbi5cclxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBzaG91bGRIaWRlICgpIHtcclxuICAgIGlmICghaXNNaW5MZW5ndGhNZXQoKSkgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBkaXNwbGF5IHZhbHVlIG9mIHRoZSBjdXJyZW50IGl0ZW0uXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0Q3VycmVudERpc3BsYXlWYWx1ZSAoKSB7XHJcbiAgICByZXR1cm4gZ2V0RGlzcGxheVZhbHVlKGN0cmwubWF0Y2hlc1tjdHJsLmluZGV4XSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBtaW5pbXVtIGxlbmd0aCBpcyBtZXQgYnkgdGhlIHNlYXJjaCB0ZXh0LlxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGlzTWluTGVuZ3RoTWV0ICgpIHtcclxuICAgIHJldHVybiBhbmd1bGFyLmlzRGVmaW5lZCgkc2NvcGUuc2VhcmNoVGV4dCkgJiYgJHNjb3BlLnNlYXJjaFRleHQubGVuZ3RoID49IGdldE1pbkxlbmd0aCgpO1xyXG4gIH1cclxuXHJcbiAgLy8tLSBhY3Rpb25zXHJcblxyXG4gIC8qKlxyXG4gICAqIERlZmluZXMgYSBwdWJsaWMgcHJvcGVydHkgd2l0aCBhIGhhbmRsZXIgYW5kIGEgZGVmYXVsdCB2YWx1ZS5cclxuICAgKiBAcGFyYW0ga2V5XHJcbiAgICogQHBhcmFtIGhhbmRsZXJcclxuICAgKiBAcGFyYW0gdmFsdWVcclxuICAgKi9cclxuICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eSAoa2V5LCBoYW5kbGVyLCB2YWx1ZSkge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0cmwsIGtleSwge1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHZhbHVlOyB9LFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xyXG4gICAgICAgIHZhciBvbGRWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgaGFuZGxlcihuZXdWYWx1ZSwgb2xkVmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbGVjdHMgdGhlIGl0ZW0gYXQgdGhlIGdpdmVuIGluZGV4LlxyXG4gICAqIEBwYXJhbSBpbmRleFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHNlbGVjdCAoaW5kZXgpIHtcclxuICAgICRzY29wZS5zZWxlY3RlZEl0ZW0gPSBjdHJsLm1hdGNoZXNbaW5kZXhdO1xyXG4gICAgY3RybC5oaWRkZW4gPSB0cnVlO1xyXG4gICAgY3RybC5pbmRleCA9IDA7XHJcbiAgICBjdHJsLm1hdGNoZXMgPSBbXTtcclxuICAgIC8vLS0gZm9yY2UgZm9ybSB0byB1cGRhdGUgc3RhdGUgZm9yIHZhbGlkYXRpb25cclxuICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgZWxlbWVudHMuJC5pbnB1dC5jb250cm9sbGVyKCduZ01vZGVsJykuJHNldFZpZXdWYWx1ZShnZXREaXNwbGF5VmFsdWUoJHNjb3BlLnNlbGVjdGVkSXRlbSkgfHxcclxuICAgICAgICAgICRzY29wZS5zZWFyY2hUZXh0KTtcclxuICAgICAgY3RybC5oaWRkZW4gPSB0cnVlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGVhcnMgdGhlIHNlYXJjaFRleHQgdmFsdWUgYW5kIHNlbGVjdGVkIGl0ZW0uXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY2xlYXJWYWx1ZSAoKSB7XHJcbiAgICAkc2NvcGUuc2VhcmNoVGV4dCA9ICcnO1xyXG4gICAgc2VsZWN0KC0xKTtcclxuXHJcbiAgICAvLyBQZXIgaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL2pzcmVmL2V2ZW50X29uaW5wdXQuYXNwXHJcbiAgICB2YXIgZXZlbnRPYmogPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcclxuICAgIGV2ZW50T2JqLmluaXRDdXN0b21FdmVudCgnaW5wdXQnLCB0cnVlLCB0cnVlLCB7dmFsdWU6ICRzY29wZS5zZWFyY2hUZXh0fSk7XHJcbiAgICBlbGVtZW50cy5pbnB1dC5kaXNwYXRjaEV2ZW50KGV2ZW50T2JqKTtcclxuXHJcbiAgICBlbGVtZW50cy5pbnB1dC5mb2N1cygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2hlcyB0aGUgcmVzdWx0cyBmb3IgdGhlIHByb3ZpZGVkIHNlYXJjaCB0ZXh0LlxyXG4gICAqIEBwYXJhbSBzZWFyY2hUZXh0XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZmV0Y2hSZXN1bHRzIChzZWFyY2hUZXh0KSB7XHJcbiAgICB2YXIgaXRlbXMgPSAkc2NvcGUuJHBhcmVudC4kZXZhbChpdGVtRXhwciksXHJcbiAgICAgICAgdGVybSA9IHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgIGlmIChhbmd1bGFyLmlzQXJyYXkoaXRlbXMpKSB7XHJcbiAgICAgIGhhbmRsZVJlc3VsdHMoaXRlbXMpO1xyXG4gICAgfSBlbHNlIGlmIChpdGVtcykge1xyXG4gICAgICBjdHJsLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICBpZiAoaXRlbXMuc3VjY2VzcykgaXRlbXMuc3VjY2VzcyhoYW5kbGVSZXN1bHRzKTtcclxuICAgICAgaWYgKGl0ZW1zLnRoZW4pICAgIGl0ZW1zLnRoZW4oaGFuZGxlUmVzdWx0cyk7XHJcbiAgICAgIGlmIChpdGVtcy5lcnJvcikgICBpdGVtcy5lcnJvcihmdW5jdGlvbiAoKSB7IGN0cmwubG9hZGluZyA9IGZhbHNlOyB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGhhbmRsZVJlc3VsdHMgKG1hdGNoZXMpIHtcclxuICAgICAgY2FjaGVbdGVybV0gPSBtYXRjaGVzO1xyXG4gICAgICBpZiAoc2VhcmNoVGV4dCAhPT0gJHNjb3BlLnNlYXJjaFRleHQpIHJldHVybjsgLy8tLSBqdXN0IGNhY2hlIHRoZSByZXN1bHRzIGlmIG9sZCByZXF1ZXN0XHJcbiAgICAgIGN0cmwubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICBwcm9taXNlID0gbnVsbDtcclxuICAgICAgY3RybC5tYXRjaGVzID0gbWF0Y2hlcztcclxuICAgICAgY3RybC5oaWRkZW4gPSBzaG91bGRIaWRlKCk7XHJcbiAgICAgIHVwZGF0ZU1lc3NhZ2VzKCk7XHJcbiAgICAgIHBvc2l0aW9uRHJvcGRvd24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgdGhlIEFSSUEgbWVzc2FnZXNcclxuICAgKi9cclxuICBmdW5jdGlvbiB1cGRhdGVNZXNzYWdlcyAoKSB7XHJcbiAgICBjdHJsLm1lc3NhZ2VzID0gWyBnZXRDb3VudE1lc3NhZ2UoKSwgZ2V0Q3VycmVudERpc3BsYXlWYWx1ZSgpIF07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBBUklBIG1lc3NhZ2UgZm9yIGhvdyBtYW55IHJlc3VsdHMgbWF0Y2ggdGhlIGN1cnJlbnQgcXVlcnkuXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0Q291bnRNZXNzYWdlICgpIHtcclxuICAgIGlmIChsYXN0Q291bnQgPT09IGN0cmwubWF0Y2hlcy5sZW5ndGgpIHJldHVybiAnJztcclxuICAgIGxhc3RDb3VudCA9IGN0cmwubWF0Y2hlcy5sZW5ndGg7XHJcbiAgICBzd2l0Y2ggKGN0cmwubWF0Y2hlcy5sZW5ndGgpIHtcclxuICAgICAgY2FzZSAwOiAgcmV0dXJuICdUaGVyZSBhcmUgbm8gbWF0Y2hlcyBhdmFpbGFibGUuJztcclxuICAgICAgY2FzZSAxOiAgcmV0dXJuICdUaGVyZSBpcyAxIG1hdGNoIGF2YWlsYWJsZS4nO1xyXG4gICAgICBkZWZhdWx0OiByZXR1cm4gJ1RoZXJlIGFyZSAnICsgY3RybC5tYXRjaGVzLmxlbmd0aCArICcgbWF0Y2hlcyBhdmFpbGFibGUuJztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE1ha2VzIHN1cmUgdGhhdCB0aGUgZm9jdXNlZCBlbGVtZW50IGlzIHdpdGhpbiB2aWV3LlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHVwZGF0ZVNjcm9sbCAoKSB7XHJcbiAgICBpZiAoIWVsZW1lbnRzLmxpW2N0cmwuaW5kZXhdKSByZXR1cm47XHJcbiAgICB2YXIgbGkgID0gZWxlbWVudHMubGlbY3RybC5pbmRleF0sXHJcbiAgICAgICAgdG9wID0gbGkub2Zmc2V0VG9wLFxyXG4gICAgICAgIGJvdCA9IHRvcCArIGxpLm9mZnNldEhlaWdodCxcclxuICAgICAgICBoZ3QgPSBlbGVtZW50cy51bC5jbGllbnRIZWlnaHQ7XHJcbiAgICBpZiAodG9wIDwgZWxlbWVudHMudWwuc2Nyb2xsVG9wKSB7XHJcbiAgICAgIGVsZW1lbnRzLnVsLnNjcm9sbFRvcCA9IHRvcDtcclxuICAgIH0gZWxzZSBpZiAoYm90ID4gZWxlbWVudHMudWwuc2Nyb2xsVG9wICsgaGd0KSB7XHJcbiAgICAgIGVsZW1lbnRzLnVsLnNjcm9sbFRvcCA9IGJvdCAtIGhndDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0cyB0aGUgcXVlcnkgdG8gZ2F0aGVyIHRoZSByZXN1bHRzIGZvciB0aGUgY3VycmVudCBzZWFyY2hUZXh0LiAgQXR0ZW1wdHMgdG8gcmV0dXJuIGNhY2hlZFxyXG4gICAqIHJlc3VsdHMgZmlyc3QsIHRoZW4gZm9yd2FyZHMgdGhlIHByb2Nlc3MgdG8gYGZldGNoUmVzdWx0c2AgaWYgbmVjZXNzYXJ5LlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGhhbmRsZVF1ZXJ5ICgpIHtcclxuICAgIHZhciBzZWFyY2hUZXh0ID0gJHNjb3BlLnNlYXJjaFRleHQsXHJcbiAgICAgICAgdGVybSA9IHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgIC8vLS0gY2FuY2VsIHByb21pc2UgaWYgYSBwcm9taXNlIGlzIGluIHByb2dyZXNzXHJcbiAgICBpZiAocHJvbWlzZSAmJiBwcm9taXNlLmNhbmNlbCkge1xyXG4gICAgICBwcm9taXNlLmNhbmNlbCgpO1xyXG4gICAgICBwcm9taXNlID0gbnVsbDtcclxuICAgIH1cclxuICAgIC8vLS0gaWYgcmVzdWx0cyBhcmUgY2FjaGVkLCBwdWxsIGluIGNhY2hlZCByZXN1bHRzXHJcbiAgICBpZiAoISRzY29wZS5ub0NhY2hlICYmIGNhY2hlW3Rlcm1dKSB7XHJcbiAgICAgIGN0cmwubWF0Y2hlcyA9IGNhY2hlW3Rlcm1dO1xyXG4gICAgICB1cGRhdGVNZXNzYWdlcygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmV0Y2hSZXN1bHRzKHNlYXJjaFRleHQpO1xyXG4gICAgfVxyXG4gICAgaWYgKGhhc0ZvY3VzKSBjdHJsLmhpZGRlbiA9IHNob3VsZEhpZGUoKTtcclxuICB9XHJcblxyXG59XHJcbk1kQXV0b2NvbXBsZXRlQ3RybC4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGVsZW1lbnRcIiwgXCIkbWRVdGlsXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkdGltZW91dFwiLCBcIiRtZFRoZW1pbmdcIiwgXCIkd2luZG93XCIsIFwiJGFuaW1hdGVcIiwgXCIkcm9vdEVsZW1lbnRcIiwgXCIkYXR0cnNcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmF1dG9jb21wbGV0ZScpXHJcbiAgICAuZGlyZWN0aXZlKCdtZEF1dG9jb21wbGV0ZScsIE1kQXV0b2NvbXBsZXRlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kQXV0b2NvbXBsZXRlXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGA8bWQtYXV0b2NvbXBsZXRlPmAgaXMgYSBzcGVjaWFsIGlucHV0IGNvbXBvbmVudCB3aXRoIGEgZHJvcC1kb3duIG9mIGFsbCBwb3NzaWJsZSBtYXRjaGVzIHRvIGEgY3VzdG9tIHF1ZXJ5LlxyXG4gKiBUaGlzIGNvbXBvbmVudCBhbGxvd3MgeW91IHRvIHByb3ZpZGUgcmVhbC10aW1lIHN1Z2dlc3Rpb25zIGFzIHRoZSB1c2VyIHR5cGVzIGluIHRoZSBpbnB1dCBhcmVhLlxyXG4gKlxyXG4gKiBUbyBzdGFydCwgeW91IHdpbGwgbmVlZCB0byBzcGVjaWZ5IHRoZSByZXF1aXJlZCBwYXJhbWV0ZXJzIGFuZCBwcm92aWRlIGEgdGVtcGxhdGUgZm9yIHlvdXIgcmVzdWx0cy5cclxuICogVGhlIGNvbnRlbnQgaW5zaWRlIGBtZC1hdXRvY29tcGxldGVgIHdpbGwgYmUgdHJlYXRlZCBhcyBhIHRlbXBsYXRlLlxyXG4gKlxyXG4gKiBJbiBtb3JlIGNvbXBsZXggY2FzZXMsIHlvdSBtYXkgd2FudCB0byBpbmNsdWRlIG90aGVyIGNvbnRlbnQgc3VjaCBhcyBhIG1lc3NhZ2UgdG8gZGlzcGxheSB3aGVuXHJcbiAqIG5vIG1hdGNoZXMgd2VyZSBmb3VuZC4gIFlvdSBjYW4gZG8gdGhpcyBieSB3cmFwcGluZyB5b3VyIHRlbXBsYXRlIGluIGBtZC1pdGVtLXRlbXBsYXRlYCBhbmQgYWRkaW5nXHJcbiAqIGEgdGFnIGZvciBgbWQtbm90LWZvdW5kYC4gIEFuIGV4YW1wbGUgb2YgdGhpcyBpcyBzaG93biBiZWxvdy5cclxuICogIyMjIFZhbGlkYXRpb25cclxuICpcclxuICogWW91IGNhbiB1c2UgYG5nLW1lc3NhZ2VzYCB0byBpbmNsdWRlIHZhbGlkYXRpb24gdGhlIHNhbWUgd2F5IHRoYXQgeW91IHdvdWxkIG5vcm1hbGx5IHZhbGlkYXRlO1xyXG4gKiBob3dldmVyLCBpZiB5b3Ugd2FudCB0byByZXBsaWNhdGUgYSBzdGFuZGFyZCBpbnB1dCB3aXRoIGEgZmxvYXRpbmcgbGFiZWwsIHlvdSB3aWxsIGhhdmUgdG8gZG8gdGhlXHJcbiAqIGZvbGxvd2luZzpcclxuICpcclxuICogLSBNYWtlIHN1cmUgdGhhdCB5b3VyIHRlbXBsYXRlIGlzIHdyYXBwZWQgaW4gYG1kLWl0ZW0tdGVtcGxhdGVgXHJcbiAqIC0gQWRkIHlvdXIgYG5nLW1lc3NhZ2VzYCBjb2RlIGluc2lkZSBvZiBgbWQtYXV0b2NvbXBsZXRlYFxyXG4gKiAtIEFkZCB5b3VyIHZhbGlkYXRpb24gcHJvcGVydGllcyB0byBgbWQtYXV0b2NvbXBsZXRlYCAoaWUuIGByZXF1aXJlZGApXHJcbiAqIC0gQWRkIGEgYG5hbWVgIHRvIGBtZC1hdXRvY29tcGxldGVgICh0byBiZSB1c2VkIG9uIHRoZSBnZW5lcmF0ZWQgYGlucHV0YClcclxuICpcclxuICogVGhlcmUgaXMgYW4gZXhhbXBsZSBiZWxvdyBvZiBob3cgdGhpcyBzaG91bGQgbG9vay5cclxuICpcclxuICpcclxuICogQHBhcmFtIHtleHByZXNzaW9ufSBtZC1pdGVtcyBBbiBleHByZXNzaW9uIGluIHRoZSBmb3JtYXQgb2YgYGl0ZW0gaW4gaXRlbXNgIHRvIGl0ZXJhdGUgb3ZlciBtYXRjaGVzIGZvciB5b3VyIHNlYXJjaC5cclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtc2VsZWN0ZWQtaXRlbS1jaGFuZ2UgQW4gZXhwcmVzc2lvbiB0byBiZSBydW4gZWFjaCB0aW1lIGEgbmV3IGl0ZW0gaXMgc2VsZWN0ZWRcclxuICogQHBhcmFtIHtleHByZXNzaW9uPX0gbWQtc2VhcmNoLXRleHQtY2hhbmdlIEFuIGV4cHJlc3Npb24gdG8gYmUgcnVuIGVhY2ggdGltZSB0aGUgc2VhcmNoIHRleHQgdXBkYXRlc1xyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLXNlYXJjaC10ZXh0IEEgbW9kZWwgdG8gYmluZCB0aGUgc2VhcmNoIHF1ZXJ5IHRleHQgdG9cclxuICogQHBhcmFtIHtvYmplY3Q9fSBtZC1zZWxlY3RlZC1pdGVtIEEgbW9kZWwgdG8gYmluZCB0aGUgc2VsZWN0ZWQgaXRlbSB0b1xyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLWl0ZW0tdGV4dCBBbiBleHByZXNzaW9uIHRoYXQgd2lsbCBjb252ZXJ0IHlvdXIgb2JqZWN0IHRvIGEgc2luZ2xlIHN0cmluZy5cclxuICogQHBhcmFtIHtzdHJpbmc9fSBwbGFjZWhvbGRlciBQbGFjZWhvbGRlciB0ZXh0IHRoYXQgd2lsbCBiZSBmb3J3YXJkZWQgdG8gdGhlIGlucHV0LlxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1uby1jYWNoZSBEaXNhYmxlcyB0aGUgaW50ZXJuYWwgY2FjaGluZyB0aGF0IGhhcHBlbnMgaW4gYXV0b2NvbXBsZXRlXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG5nLWRpc2FibGVkIERldGVybWluZXMgd2hldGhlciBvciBub3QgdG8gZGlzYWJsZSB0aGUgaW5wdXQgZmllbGRcclxuICogQHBhcmFtIHtudW1iZXI9fSBtZC1taW4tbGVuZ3RoIFNwZWNpZmllcyB0aGUgbWluaW11bSBsZW5ndGggb2YgdGV4dCBiZWZvcmUgYXV0b2NvbXBsZXRlIHdpbGwgbWFrZSBzdWdnZXN0aW9uc1xyXG4gKiBAcGFyYW0ge251bWJlcj19IG1kLWRlbGF5IFNwZWNpZmllcyB0aGUgYW1vdW50IG9mIHRpbWUgKGluIG1pbGxpc2Vjb25kcykgdG8gd2FpdCBiZWZvcmUgbG9va2luZyBmb3IgcmVzdWx0c1xyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1hdXRvZm9jdXMgSWYgdHJ1ZSwgd2lsbCBpbW1lZGlhdGVseSBmb2N1cyB0aGUgaW5wdXQgZWxlbWVudFxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1hdXRvc2VsZWN0IElmIHRydWUsIHRoZSBmaXJzdCBpdGVtIHdpbGwgYmUgc2VsZWN0ZWQgYnkgZGVmYXVsdFxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLW1lbnUtY2xhc3MgVGhpcyB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGRyb3Bkb3duIG1lbnUgZm9yIHN0eWxpbmdcclxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1mbG9hdGluZy1sYWJlbCBUaGlzIHdpbGwgYWRkIGEgZmxvYXRpbmcgbGFiZWwgdG8gYXV0b2NvbXBsZXRlIGFuZCB3cmFwIGl0IGluIGBtZC1pbnB1dC1jb250YWluZXJgXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiAjIyNCYXNpYyBFeGFtcGxlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICAgPG1kLWF1dG9jb21wbGV0ZVxyXG4gKiAgICAgICBtZC1zZWxlY3RlZC1pdGVtPVwic2VsZWN0ZWRJdGVtXCJcclxuICogICAgICAgbWQtc2VhcmNoLXRleHQ9XCJzZWFyY2hUZXh0XCJcclxuICogICAgICAgbWQtaXRlbXM9XCJpdGVtIGluIGdldE1hdGNoZXMoc2VhcmNoVGV4dClcIlxyXG4gKiAgICAgICBtZC1pdGVtLXRleHQ9XCJpdGVtLmRpc3BsYXlcIj5cclxuICogICAgIDxzcGFuIG1kLWhpZ2hsaWdodC10ZXh0PVwic2VhcmNoVGV4dFwiPnt7aXRlbS5kaXNwbGF5fX08L3NwYW4+XHJcbiAqICAgPC9tZC1hdXRvY29tcGxldGU+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogIyMjRXhhbXBsZSB3aXRoIFwibm90IGZvdW5kXCIgbWVzc2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8bWQtYXV0b2NvbXBsZXRlXHJcbiAqICAgICBtZC1zZWxlY3RlZC1pdGVtPVwic2VsZWN0ZWRJdGVtXCJcclxuICogICAgIG1kLXNlYXJjaC10ZXh0PVwic2VhcmNoVGV4dFwiXHJcbiAqICAgICBtZC1pdGVtcz1cIml0ZW0gaW4gZ2V0TWF0Y2hlcyhzZWFyY2hUZXh0KVwiXHJcbiAqICAgICBtZC1pdGVtLXRleHQ9XCJpdGVtLmRpc3BsYXlcIj5cclxuICogICA8bWQtaXRlbS10ZW1wbGF0ZT5cclxuICogICAgIDxzcGFuIG1kLWhpZ2hsaWdodC10ZXh0PVwic2VhcmNoVGV4dFwiPnt7aXRlbS5kaXNwbGF5fX08L3NwYW4+XHJcbiAqICAgPC9tZC1pdGVtLXRlbXBsYXRlPlxyXG4gKiAgIDxtZC1ub3QtZm91bmQ+XHJcbiAqICAgICBObyBtYXRjaGVzIGZvdW5kLlxyXG4gKiAgIDwvbWQtbm90LWZvdW5kPlxyXG4gKiA8L21kLWF1dG9jb21wbGV0ZT5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKiBJbiB0aGlzIGV4YW1wbGUsIG91ciBjb2RlIHV0aWxpemVzIGBtZC1pdGVtLXRlbXBsYXRlYCBhbmQgYG1kLW5vdC1mb3VuZGAgdG8gc3BlY2lmeSB0aGUgZGlmZmVyZW50XHJcbiAqIHBhcnRzIHRoYXQgbWFrZSB1cCBvdXIgY29tcG9uZW50LlxyXG4gKlxyXG4gKiAjIyMgRXhhbXBsZSB3aXRoIHZhbGlkYXRpb25cclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPGZvcm0gbmFtZT1cImF1dG9jb21wbGV0ZUZvcm1cIj5cclxuICogICA8bWQtYXV0b2NvbXBsZXRlXHJcbiAqICAgICAgIHJlcXVpcmVkXHJcbiAqICAgICAgIGlucHV0LW5hbWU9XCJhdXRvY29tcGxldGVcIlxyXG4gKiAgICAgICBtZC1zZWxlY3RlZC1pdGVtPVwic2VsZWN0ZWRJdGVtXCJcclxuICogICAgICAgbWQtc2VhcmNoLXRleHQ9XCJzZWFyY2hUZXh0XCJcclxuICogICAgICAgbWQtaXRlbXM9XCJpdGVtIGluIGdldE1hdGNoZXMoc2VhcmNoVGV4dClcIlxyXG4gKiAgICAgICBtZC1pdGVtLXRleHQ9XCJpdGVtLmRpc3BsYXlcIj5cclxuICogICAgIDxtZC1pdGVtLXRlbXBsYXRlPlxyXG4gKiAgICAgICA8c3BhbiBtZC1oaWdobGlnaHQtdGV4dD1cInNlYXJjaFRleHRcIj57e2l0ZW0uZGlzcGxheX19PC9zcGFuPlxyXG4gKiAgICAgPC9tZC1pdGVtLXRlbXBsYXRlPlxyXG4gKiAgICAgPGRpdiBuZy1tZXNzYWdlcz1cImF1dG9jb21wbGV0ZUZvcm0uYXV0b2NvbXBsZXRlLiRlcnJvclwiPlxyXG4gKiAgICAgICA8ZGl2IG5nLW1lc3NhZ2U9XCJyZXF1aXJlZFwiPlRoaXMgZmllbGQgaXMgcmVxdWlyZWQ8L2Rpdj5cclxuICogICAgIDwvZGl2PlxyXG4gKiAgIDwvbWQtYXV0b2NvbXBsZXRlPlxyXG4gKiA8L2Zvcm0+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICogSW4gdGhpcyBleGFtcGxlLCBvdXIgY29kZSB1dGlsaXplcyBgbWQtaXRlbS10ZW1wbGF0ZWAgYW5kIGBtZC1ub3QtZm91bmRgIHRvIHNwZWNpZnkgdGhlIGRpZmZlcmVudFxyXG4gKiBwYXJ0cyB0aGF0IG1ha2UgdXAgb3VyIGNvbXBvbmVudC5cclxuICovXHJcblxyXG5mdW5jdGlvbiBNZEF1dG9jb21wbGV0ZSAoJG1kVGhlbWluZywgJG1kVXRpbCkge1xyXG4gIHJldHVybiB7XHJcbiAgICBjb250cm9sbGVyOiAgICdNZEF1dG9jb21wbGV0ZUN0cmwnLFxyXG4gICAgY29udHJvbGxlckFzOiAnJG1kQXV0b2NvbXBsZXRlQ3RybCcsXHJcbiAgICBzY29wZTogICAgICAgIHtcclxuICAgICAgaW5wdXROYW1lOiAgICAgICdAbWRJbnB1dE5hbWUnLFxyXG4gICAgICBpbnB1dE1pbmxlbmd0aDogJ0BtZElucHV0TWlubGVuZ3RoJyxcclxuICAgICAgaW5wdXRNYXhsZW5ndGg6ICdAbWRJbnB1dE1heGxlbmd0aCcsXHJcbiAgICAgIHNlYXJjaFRleHQ6ICAgICAnPT9tZFNlYXJjaFRleHQnLFxyXG4gICAgICBzZWxlY3RlZEl0ZW06ICAgJz0/bWRTZWxlY3RlZEl0ZW0nLFxyXG4gICAgICBpdGVtc0V4cHI6ICAgICAgJ0BtZEl0ZW1zJyxcclxuICAgICAgaXRlbVRleHQ6ICAgICAgICcmbWRJdGVtVGV4dCcsXHJcbiAgICAgIHBsYWNlaG9sZGVyOiAgICAnQHBsYWNlaG9sZGVyJyxcclxuICAgICAgbm9DYWNoZTogICAgICAgICc9P21kTm9DYWNoZScsXHJcbiAgICAgIGl0ZW1DaGFuZ2U6ICAgICAnJj9tZFNlbGVjdGVkSXRlbUNoYW5nZScsXHJcbiAgICAgIHRleHRDaGFuZ2U6ICAgICAnJj9tZFNlYXJjaFRleHRDaGFuZ2UnLFxyXG4gICAgICBtaW5MZW5ndGg6ICAgICAgJz0/bWRNaW5MZW5ndGgnLFxyXG4gICAgICBkZWxheTogICAgICAgICAgJz0/bWREZWxheScsXHJcbiAgICAgIGF1dG9mb2N1czogICAgICAnPT9tZEF1dG9mb2N1cycsXHJcbiAgICAgIGZsb2F0aW5nTGFiZWw6ICAnQD9tZEZsb2F0aW5nTGFiZWwnLFxyXG4gICAgICBhdXRvc2VsZWN0OiAgICAgJz0/bWRBdXRvc2VsZWN0JyxcclxuICAgICAgbWVudUNsYXNzOiAgICAgICdAP21kTWVudUNsYXNzJ1xyXG4gICAgfSxcclxuICAgIHRlbXBsYXRlOiBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cikge1xyXG4gICAgICB2YXIgbm9JdGVtc1RlbXBsYXRlID0gZ2V0Tm9JdGVtc1RlbXBsYXRlKCksXHJcbiAgICAgICAgICBpdGVtVGVtcGxhdGUgPSBnZXRJdGVtVGVtcGxhdGUoKSxcclxuICAgICAgICAgIGxlZnRvdmVyID0gZWxlbWVudC5odG1sKCk7XHJcbiAgICAgIHJldHVybiAnXFxcclxuICAgICAgICA8bWQtYXV0b2NvbXBsZXRlLXdyYXBcXFxyXG4gICAgICAgICAgICBsYXlvdXQ9XCJyb3dcIlxcXHJcbiAgICAgICAgICAgIG5nLWNsYXNzPVwieyBcXCdtZC13aGl0ZWZyYW1lLXoxXFwnOiAhZmxvYXRpbmdMYWJlbCB9XCJcXFxyXG4gICAgICAgICAgICByb2xlPVwibGlzdGJveFwiPlxcXHJcbiAgICAgICAgICAnICsgZ2V0SW5wdXRFbGVtZW50KCkgKyAnXFxcclxuICAgICAgICAgIDxtZC1wcm9ncmVzcy1saW5lYXJcXFxyXG4gICAgICAgICAgICAgIG5nLWlmPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5sb2FkaW5nXCJcXFxyXG4gICAgICAgICAgICAgIG1kLW1vZGU9XCJpbmRldGVybWluYXRlXCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XFxcclxuICAgICAgICAgIDx1bCByb2xlPVwicHJlc2VudGF0aW9uXCJcXFxyXG4gICAgICAgICAgICAgIGNsYXNzPVwibWQtYXV0b2NvbXBsZXRlLXN1Z2dlc3Rpb25zIG1kLXdoaXRlZnJhbWUtejEge3ttZW51Q2xhc3MgfHwgXFwnXFwnfX1cIlxcXHJcbiAgICAgICAgICAgICAgaWQ9XCJ1bC17eyRtZEF1dG9jb21wbGV0ZUN0cmwuaWR9fVwiXFxcclxuICAgICAgICAgICAgICBuZy1oaWRlPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5oaWRkZW5cIlxcXHJcbiAgICAgICAgICAgICAgbmctbW91c2VlbnRlcj1cIiRtZEF1dG9jb21wbGV0ZUN0cmwubGlzdEVudGVyKClcIlxcXHJcbiAgICAgICAgICAgICAgbmctbW91c2VsZWF2ZT1cIiRtZEF1dG9jb21wbGV0ZUN0cmwubGlzdExlYXZlKClcIlxcXHJcbiAgICAgICAgICAgICAgbmctbW91c2V1cD1cIiRtZEF1dG9jb21wbGV0ZUN0cmwubW91c2VVcCgpXCI+XFxcclxuICAgICAgICAgICAgPGxpIG5nLXJlcGVhdD1cIihpbmRleCwgaXRlbSkgaW4gJG1kQXV0b2NvbXBsZXRlQ3RybC5tYXRjaGVzXCJcXFxyXG4gICAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7IHNlbGVjdGVkOiBpbmRleCA9PT0gJG1kQXV0b2NvbXBsZXRlQ3RybC5pbmRleCB9XCJcXFxyXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCIkbWRBdXRvY29tcGxldGVDdHJsLnNlbGVjdChpbmRleClcIlxcXHJcbiAgICAgICAgICAgICAgICBtZC1hdXRvY29tcGxldGUtbGlzdC1pdGVtPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5pdGVtTmFtZVwiPlxcXHJcbiAgICAgICAgICAgICAgICAnICsgaXRlbVRlbXBsYXRlICsgJ1xcXHJcbiAgICAgICAgICAgIDwvbGk+XFxcclxuICAgICAgICAgICAgJyArIG5vSXRlbXNUZW1wbGF0ZSArICdcXFxyXG4gICAgICAgICAgPC91bD5cXFxyXG4gICAgICAgIDwvbWQtYXV0b2NvbXBsZXRlLXdyYXA+XFxcclxuICAgICAgICA8YXJpYS1zdGF0dXNcXFxyXG4gICAgICAgICAgICBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlblwiXFxcclxuICAgICAgICAgICAgcm9sZT1cInN0YXR1c1wiXFxcclxuICAgICAgICAgICAgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCI+XFxcclxuICAgICAgICAgIDxwIG5nLXJlcGVhdD1cIm1lc3NhZ2UgaW4gJG1kQXV0b2NvbXBsZXRlQ3RybC5tZXNzYWdlc1wiIG5nLWlmPVwibWVzc2FnZVwiPnt7bWVzc2FnZX19PC9wPlxcXHJcbiAgICAgICAgPC9hcmlhLXN0YXR1cz4nO1xyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0SXRlbVRlbXBsYXRlKCkge1xyXG4gICAgICAgIHZhciB0ZW1wbGF0ZVRhZyA9IGVsZW1lbnQuZmluZCgnbWQtaXRlbS10ZW1wbGF0ZScpLnJlbW92ZSgpLFxyXG4gICAgICAgICAgICBodG1sID0gdGVtcGxhdGVUYWcubGVuZ3RoID8gdGVtcGxhdGVUYWcuaHRtbCgpIDogZWxlbWVudC5odG1sKCk7XHJcbiAgICAgICAgaWYgKCF0ZW1wbGF0ZVRhZy5sZW5ndGgpIGVsZW1lbnQuZW1wdHkoKTtcclxuICAgICAgICByZXR1cm4gaHRtbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gZ2V0Tm9JdGVtc1RlbXBsYXRlKCkge1xyXG4gICAgICAgIHZhciB0ZW1wbGF0ZVRhZyA9IGVsZW1lbnQuZmluZCgnbWQtbm90LWZvdW5kJykucmVtb3ZlKCksXHJcbiAgICAgICAgICAgIHRlbXBsYXRlID0gdGVtcGxhdGVUYWcubGVuZ3RoID8gdGVtcGxhdGVUYWcuaHRtbCgpIDogJyc7XHJcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlXHJcbiAgICAgICAgICAgID8gJzxsaSBuZy1pZj1cIiEkbWRBdXRvY29tcGxldGVDdHJsLm1hdGNoZXMubGVuZ3RoICYmICEkbWRBdXRvY29tcGxldGVDdHJsLmxvYWRpbmdcXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgJiYgISRtZEF1dG9jb21wbGV0ZUN0cmwuaGlkZGVuXCJcXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgbmctaGlkZT1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuaGlkZGVuXCJcXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgbWQtYXV0b2NvbXBsZXRlLXBhcmVudC1zY29wZT4nICsgdGVtcGxhdGUgKyAnPC9saT4nXHJcbiAgICAgICAgICAgIDogJyc7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRJbnB1dEVsZW1lbnQoKSB7XHJcbiAgICAgICAgaWYgKGF0dHIubWRGbG9hdGluZ0xhYmVsKSB7XHJcbiAgICAgICAgICByZXR1cm4gJ1xcXHJcbiAgICAgICAgICAgIDxtZC1pbnB1dC1jb250YWluZXIgZmxleCBuZy1pZj1cImZsb2F0aW5nTGFiZWxcIj5cXFxyXG4gICAgICAgICAgICAgIDxsYWJlbD57e2Zsb2F0aW5nTGFiZWx9fTwvbGFiZWw+XFxcclxuICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInNlYXJjaFwiXFxcclxuICAgICAgICAgICAgICAgICAgaWQ9XCJmbC1pbnB1dC17eyRtZEF1dG9jb21wbGV0ZUN0cmwuaWR9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgbmFtZT1cInt7aW5wdXROYW1lfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIGF1dG9jb21wbGV0ZT1cIm9mZlwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctcmVxdWlyZWQ9XCJpc1JlcXVpcmVkXCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1taW5sZW5ndGg9XCJpbnB1dE1pbmxlbmd0aFwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctbWF4bGVuZ3RoPVwiaW5wdXRNYXhsZW5ndGhcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5pc0Rpc2FibGVkXCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1tb2RlbD1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuc2NvcGUuc2VhcmNoVGV4dFwiXFxcclxuICAgICAgICAgICAgICAgICAgbmcta2V5ZG93bj1cIiRtZEF1dG9jb21wbGV0ZUN0cmwua2V5ZG93bigkZXZlbnQpXCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1ibHVyPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5ibHVyKClcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLWZvY3VzPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5mb2N1cygpXCJcXFxyXG4gICAgICAgICAgICAgICAgICBhcmlhLW93bnM9XCJ1bC17eyRtZEF1dG9jb21wbGV0ZUN0cmwuaWR9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cInt7ZmxvYXRpbmdMYWJlbH19XCJcXFxyXG4gICAgICAgICAgICAgICAgICBhcmlhLWF1dG9jb21wbGV0ZT1cImxpc3RcIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtaGFzcG9wdXA9XCJ0cnVlXCJcXFxyXG4gICAgICAgICAgICAgICAgICBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQ9XCJcIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJ7eyEkbWRBdXRvY29tcGxldGVDdHJsLmhpZGRlbn19XCIvPlxcXHJcbiAgICAgICAgICAgICAgPGRpdiBtZC1hdXRvY29tcGxldGUtcGFyZW50LXNjb3BlIG1kLWF1dG9jb21wbGV0ZS1yZXBsYWNlPicgKyBsZWZ0b3ZlciArICc8L2Rpdj5cXFxyXG4gICAgICAgICAgICA8L21kLWlucHV0LWNvbnRhaW5lcj4nO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gJ1xcXHJcbiAgICAgICAgICAgIDxpbnB1dCBmbGV4IHR5cGU9XCJzZWFyY2hcIlxcXHJcbiAgICAgICAgICAgICAgICBpZD1cImlucHV0LXt7JG1kQXV0b2NvbXBsZXRlQ3RybC5pZH19XCJcXFxyXG4gICAgICAgICAgICAgICAgbmFtZT1cInt7aW5wdXROYW1lfX1cIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1pZj1cIiFmbG9hdGluZ0xhYmVsXCJcXFxyXG4gICAgICAgICAgICAgICAgYXV0b2NvbXBsZXRlPVwib2ZmXCJcXFxyXG4gICAgICAgICAgICAgICAgbmctcmVxdWlyZWQ9XCJpc1JlcXVpcmVkXCJcXFxyXG4gICAgICAgICAgICAgICAgbmctZGlzYWJsZWQ9XCIkbWRBdXRvY29tcGxldGVDdHJsLmlzRGlzYWJsZWRcIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1tb2RlbD1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuc2NvcGUuc2VhcmNoVGV4dFwiXFxcclxuICAgICAgICAgICAgICAgIG5nLWtleWRvd249XCIkbWRBdXRvY29tcGxldGVDdHJsLmtleWRvd24oJGV2ZW50KVwiXFxcclxuICAgICAgICAgICAgICAgIG5nLWJsdXI9XCIkbWRBdXRvY29tcGxldGVDdHJsLmJsdXIoKVwiXFxcclxuICAgICAgICAgICAgICAgIG5nLWZvY3VzPVwiJG1kQXV0b2NvbXBsZXRlQ3RybC5mb2N1cygpXCJcXFxyXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ7e3BsYWNlaG9sZGVyfX1cIlxcXHJcbiAgICAgICAgICAgICAgICBhcmlhLW93bnM9XCJ1bC17eyRtZEF1dG9jb21wbGV0ZUN0cmwuaWR9fVwiXFxcclxuICAgICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJ7e3BsYWNlaG9sZGVyfX1cIlxcXHJcbiAgICAgICAgICAgICAgICBhcmlhLWF1dG9jb21wbGV0ZT1cImxpc3RcIlxcXHJcbiAgICAgICAgICAgICAgICBhcmlhLWhhc3BvcHVwPVwidHJ1ZVwiXFxcclxuICAgICAgICAgICAgICAgIGFyaWEtYWN0aXZlZGVzY2VuZGFudD1cIlwiXFxcclxuICAgICAgICAgICAgICAgIGFyaWEtZXhwYW5kZWQ9XCJ7eyEkbWRBdXRvY29tcGxldGVDdHJsLmhpZGRlbn19XCIvPlxcXHJcbiAgICAgICAgICAgIDxidXR0b25cXFxyXG4gICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXFxcclxuICAgICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxcXHJcbiAgICAgICAgICAgICAgICBuZy1pZj1cIiRtZEF1dG9jb21wbGV0ZUN0cmwuc2NvcGUuc2VhcmNoVGV4dCAmJiAhJG1kQXV0b2NvbXBsZXRlQ3RybC5pc0Rpc2FibGVkXCJcXFxyXG4gICAgICAgICAgICAgICAgbmctY2xpY2s9XCIkbWRBdXRvY29tcGxldGVDdHJsLmNsZWFyKClcIj5cXFxyXG4gICAgICAgICAgICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwibWQtY2xvc2VcIj48L21kLWljb24+XFxcclxuICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlblwiPkNsZWFyPC9zcGFuPlxcXHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxcXHJcbiAgICAgICAgICAgICAgICAnO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuTWRBdXRvY29tcGxldGUuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIiwgXCIkbWRVdGlsXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ01kSGlnaGxpZ2h0Q3RybCcsIE1kSGlnaGxpZ2h0Q3RybCk7XHJcblxyXG5mdW5jdGlvbiBNZEhpZ2hsaWdodEN0cmwgKCRzY29wZSwgJGVsZW1lbnQsICRpbnRlcnBvbGF0ZSkge1xyXG4gIHRoaXMuaW5pdCA9IGluaXQ7XHJcblxyXG4gIHJldHVybiBpbml0KCk7XHJcblxyXG4gIGZ1bmN0aW9uIGluaXQgKHRlcm0pIHtcclxuICAgIHZhciB1bnNhZmVUZXh0ID0gJGludGVycG9sYXRlKCRlbGVtZW50Lmh0bWwoKSkoJHNjb3BlKSxcclxuICAgICAgICB0ZXh0ID0gYW5ndWxhci5lbGVtZW50KCc8ZGl2PicpLnRleHQodW5zYWZlVGV4dCkuaHRtbCgpLFxyXG4gICAgICAgIGZsYWdzID0gJGVsZW1lbnQuYXR0cignbWQtaGlnaGxpZ2h0LWZsYWdzJykgfHwgJycsXHJcbiAgICAgICAgd2F0Y2hlciA9ICRzY29wZS4kd2F0Y2godGVybSwgZnVuY3Rpb24gKHRlcm0pIHtcclxuICAgICAgICAgIHZhciByZWdleCA9IGdldFJlZ0V4cCh0ZXJtLCBmbGFncyksXHJcbiAgICAgICAgICAgICAgaHRtbCA9IHRleHQucmVwbGFjZShyZWdleCwgJzxzcGFuIGNsYXNzPVwiaGlnaGxpZ2h0XCI+JCY8L3NwYW4+Jyk7XHJcbiAgICAgICAgICAkZWxlbWVudC5odG1sKGh0bWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgJGVsZW1lbnQub24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyB3YXRjaGVyKCk7IH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2FuaXRpemUgKHRlcm0pIHtcclxuICAgIGlmICghdGVybSkgcmV0dXJuIHRlcm07XHJcbiAgICByZXR1cm4gdGVybS5yZXBsYWNlKC9bXFxcXFxcXlxcJFxcKlxcK1xcP1xcLlxcKFxcKVxcfFxce1xcfVxcW1xcXV0vZywgJ1xcXFwkJicpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0UmVnRXhwICh0ZXh0LCBmbGFncykge1xyXG4gICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgaWYgKGZsYWdzLmluZGV4T2YoJ14nKSA+PSAxKSBzdHIgKz0gJ14nO1xyXG4gICAgc3RyICs9IHRleHQ7XHJcbiAgICBpZiAoZmxhZ3MuaW5kZXhPZignJCcpID49IDEpIHN0ciArPSAnJCc7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChzYW5pdGl6ZShzdHIpLCBmbGFncy5yZXBsYWNlKC9bXFwkXFxeXS9nLCAnJykpO1xyXG4gIH1cclxufVxyXG5NZEhpZ2hsaWdodEN0cmwuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJGludGVycG9sYXRlXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRIaWdobGlnaHRUZXh0JywgTWRIaWdobGlnaHQpO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRIaWdobGlnaHRUZXh0XHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgbWQtaGlnaGxpZ2h0LXRleHRgIGRpcmVjdGl2ZSBhbGxvd3MgeW91IHRvIHNwZWNpZnkgdGV4dCB0aGF0IHNob3VsZCBiZSBoaWdobGlnaHRlZCB3aXRoaW5cclxuICogYW4gZWxlbWVudC4gIEhpZ2hsaWdodGVkIHRleHQgd2lsbCBiZSB3cmFwcGVkIGluIGA8c3BhbiBjbGFzcz1cImhpZ2hsaWdodFwiPjwvc3Bhbj5gIHdoaWNoIGNhblxyXG4gKiBiZSBzdHlsZWQgdGhyb3VnaCBDU1MuICBQbGVhc2Ugbm90ZSB0aGF0IGNoaWxkIGVsZW1lbnRzIG1heSBub3QgYmUgdXNlZCB3aXRoIHRoaXMgZGlyZWN0aXZlLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gbWQtaGlnaGxpZ2h0LXRleHQgQSBtb2RlbCB0byBiZSBzZWFyY2hlZCBmb3JcclxuICogQHBhcmFtIHtzdHJpbmc9fSBtZC1oaWdobGlnaHQtZmxhZ3MgQSBsaXN0IG9mIGZsYWdzIChsb29zZWx5IGJhc2VkIG9uIEphdmFTY3JpcHQgUmV4RXhwIGZsYWdzKS5cclxuICogICAgIyMjIyAqKlN1cHBvcnRlZCBmbGFncyoqOlxyXG4gKiAgICAtIGBnYDogRmluZCBhbGwgbWF0Y2hlcyB3aXRoaW4gdGhlIHByb3ZpZGVkIHRleHRcclxuICogICAgLSBgaWA6IElnbm9yZSBjYXNlIHdoZW4gc2VhcmNoaW5nIGZvciBtYXRjaGVzXHJcbiAqICAgIC0gYCRgOiBPbmx5IG1hdGNoIGlmIHRoZSB0ZXh0IGVuZHMgd2l0aCB0aGUgc2VhcmNoIHRlcm1cclxuICogICAgLSBgXmA6IE9ubHkgbWF0Y2ggaWYgdGhlIHRleHQgYmVnaW5zIHdpdGggdGhlIHNlYXJjaCB0ZXJtXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiA8aW5wdXQgcGxhY2Vob2xkZXI9XCJFbnRlciBhIHNlYXJjaCB0ZXJtLi4uXCIgbmctbW9kZWw9XCJzZWFyY2hUZXJtXCIgdHlwZT1cInRleHRcIiAvPlxyXG4gKiA8dWw+XHJcbiAqICAgPGxpIG5nLXJlcGVhdD1cInJlc3VsdCBpbiByZXN1bHRzXCIgbWQtaGlnaGxpZ2h0LXRleHQ9XCJzZWFyY2hUZXJtXCI+XHJcbiAqICAgICB7e3Jlc3VsdC50ZXh0fX1cclxuICogICA8L2xpPlxyXG4gKiA8L3VsPlxyXG4gKiA8L2hsanM+XHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gTWRIaWdobGlnaHQgKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICB0ZXJtaW5hbDogdHJ1ZSxcclxuICAgIHNjb3BlOiBmYWxzZSxcclxuICAgIGNvbnRyb2xsZXI6ICdNZEhpZ2hsaWdodEN0cmwnLFxyXG4gICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgIGN0cmwuaW5pdChhdHRyLm1kSGlnaGxpZ2h0VGV4dCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5hdXRvY29tcGxldGUnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRBdXRvY29tcGxldGVMaXN0SXRlbScsIE1kQXV0b2NvbXBsZXRlTGlzdEl0ZW0pO1xyXG5cclxuZnVuY3Rpb24gTWRBdXRvY29tcGxldGVMaXN0SXRlbSAoJGNvbXBpbGUsICRtZFV0aWwpIHtcclxuICByZXR1cm4ge1xyXG4gICAgdGVybWluYWw6IHRydWUsXHJcbiAgICBsaW5rOiBwb3N0TGluayxcclxuICAgIHNjb3BlOiBmYWxzZVxyXG4gIH07XHJcbiAgZnVuY3Rpb24gcG9zdExpbmsgKHNjb3BlLCBlbGVtZW50LCBhdHRyKSB7XHJcbiAgICB2YXIgY3RybCAgICAgPSBzY29wZS4kcGFyZW50LiRtZEF1dG9jb21wbGV0ZUN0cmwsXHJcbiAgICAgICAgbmV3U2NvcGUgPSBjdHJsLnBhcmVudC4kbmV3KGZhbHNlLCBjdHJsLnBhcmVudCksXHJcbiAgICAgICAgaXRlbU5hbWUgPSBjdHJsLnNjb3BlLiRldmFsKGF0dHIubWRBdXRvY29tcGxldGVMaXN0SXRlbSk7XHJcbiAgICBuZXdTY29wZVtpdGVtTmFtZV0gPSBzY29wZS5pdGVtO1xyXG4gICAgJGNvbXBpbGUoZWxlbWVudC5jb250ZW50cygpKShuZXdTY29wZSk7XHJcbiAgICBlbGVtZW50LmF0dHIoe1xyXG4gICAgICByb2xlOiAnb3B0aW9uJyxcclxuICAgICAgaWQ6ICdpdGVtXycgKyAkbWRVdGlsLm5leHRVaWQoKVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbk1kQXV0b2NvbXBsZXRlTGlzdEl0ZW0uJGluamVjdCA9IFtcIiRjb21waWxlXCIsIFwiJG1kVXRpbFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuYXV0b2NvbXBsZXRlJylcclxuICAgIC5kaXJlY3RpdmUoJ21kQXV0b2NvbXBsZXRlUGFyZW50U2NvcGUnLCBNZEF1dG9jb21wbGV0ZVBhcmVudFNjb3BlKTtcclxuXHJcbmZ1bmN0aW9uIE1kQXV0b2NvbXBsZXRlUGFyZW50U2NvcGUgKCRjb21waWxlLCAkbWRVdGlsKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICB0ZXJtaW5hbDogdHJ1ZSxcclxuICAgIGxpbms6IHBvc3RMaW5rLFxyXG4gICAgc2NvcGU6IGZhbHNlXHJcbiAgfTtcclxuICBmdW5jdGlvbiBwb3N0TGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgIHZhciBjdHJsICAgICA9IHNjb3BlLiRwYXJlbnQuJG1kQXV0b2NvbXBsZXRlQ3RybDtcclxuICAgICRjb21waWxlKGVsZW1lbnQuY29udGVudHMoKSkoY3RybC5wYXJlbnQpO1xyXG4gICAgaWYgKGF0dHIuaGFzT3duUHJvcGVydHkoJ21kQXV0b2NvbXBsZXRlUmVwbGFjZScpKSB7XHJcbiAgICAgIGVsZW1lbnQuYWZ0ZXIoZWxlbWVudC5jb250ZW50cygpKTtcclxuICAgICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuTWRBdXRvY29tcGxldGVQYXJlbnRTY29wZS4kaW5qZWN0ID0gW1wiJGNvbXBpbGVcIiwgXCIkbWRVdGlsXCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZENoaXAnLCBNZENoaXApO1xyXG5cclxuLyoqXHJcbiAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICogQG5hbWUgbWRDaGlwXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1xyXG4gKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogYDxtZC1jaGlwPmAgaXMgYSBjb21wb25lbnQgdXNlZCB3aXRoaW4gYDxtZC1jaGlwcz5gIGFuZCBpcyByZXNwb25zaWJsZSBmb3IgcmVuZGVyaW5nIGluZGl2aWR1YWxcclxuICogY2hpcHMuXHJcbiAqXHJcbiAqXHJcbiAqIEB1c2FnZVxyXG4gKiA8aGxqcyBsYW5nPVwiaHRtbFwiPlxyXG4gKiAgIDxtZC1jaGlwPnt7JGNoaXB9fTwvbWQtY2hpcD5cclxuICogPC9obGpzPlxyXG4gKlxyXG4gKi9cclxuXHJcbi8vIFRoaXMgaGludCB0ZXh0IGlzIGhpZGRlbiB3aXRoaW4gYSBjaGlwIGJ1dCB1c2VkIGJ5IHNjcmVlbiByZWFkZXJzIHRvXHJcbi8vIGluZm9ybSB0aGUgdXNlciBob3cgdGhleSBjYW4gaW50ZXJhY3Qgd2l0aCBhIGNoaXAuXHJcbnZhciBERUxFVEVfSElOVF9URU1QTEFURSA9ICdcXFxyXG4gICAgPHNwYW4gbmctaWY9XCIhJG1kQ2hpcHNDdHJsLnJlYWRvbmx5XCIgY2xhc3M9XCJtZC12aXN1YWxseS1oaWRkZW5cIj5cXFxyXG4gICAgICB7eyRtZENoaXBzQ3RybC5kZWxldGVIaW50fX1cXFxyXG4gICAgPC9zcGFuPic7XHJcblxyXG4vKipcclxuICogTURDaGlwIERpcmVjdGl2ZSBEZWZpbml0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSAkbWRUaGVtaW5nXHJcbiAqIEBwYXJhbSAkbWRJbmtSaXBwbGVcclxuICogQG5nSW5qZWN0XHJcbiAqL1xyXG5mdW5jdGlvbiBNZENoaXAoJG1kVGhlbWluZykge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgcmVxdWlyZTogJ14/bWRDaGlwcycsXHJcbiAgICBjb21waWxlOiAgY29tcGlsZVxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGUoZWxlbWVudCwgYXR0cikge1xyXG4gICAgZWxlbWVudC5hcHBlbmQoREVMRVRFX0hJTlRfVEVNUExBVEUpO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWNoaXAnKTtcclxuICAgICAgJG1kVGhlbWluZyhlbGVtZW50KTtcclxuXHJcbiAgICAgIGlmIChjdHJsKSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcubWQtY2hpcC1jb250ZW50JykpXHJcbiAgICAgICAgICAub24oJ2JsdXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGN0cmwuc2VsZWN0ZWRDaGlwID0gLTE7XHJcbiAgICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbk1kQ2hpcC4kaW5qZWN0ID0gW1wiJG1kVGhlbWluZ1wiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHMnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRDaGlwUmVtb3ZlJywgTWRDaGlwUmVtb3ZlKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kQ2hpcFJlbW92ZVxyXG4gKiBAbW9kdWxlIG1hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHNcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIGA8bWQtY2hpcC1yZW1vdmU+YFxyXG4gKiBEZXNpZ25hdGVzIGFuIGVsZW1lbnQgdG8gYmUgdXNlZCBhcyB0aGUgZGVsZXRlIGJ1dHRvbiBmb3IgYSBjaGlwLiBUaGlzXHJcbiAqIGVsZW1lbnQgaXMgcGFzc2VkIGFzIGEgY2hpbGQgb2YgdGhlIGBtZC1jaGlwc2AgZWxlbWVudC5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAqICAgPG1kLWNoaXBzPjxidXR0b24gbWQtY2hpcC1yZW1vdmU+REVMPC9idXR0b24+PC9tZC1jaGlwcz5cclxuICogPC9obGpzPlxyXG4gKi9cclxuXHJcblxyXG4vKipcclxuICogTWRDaGlwUmVtb3ZlIERpcmVjdGl2ZSBEZWZpbml0aW9uLlxyXG4gKiBcclxuICogQHBhcmFtICRjb21waWxlXHJcbiAqIEBwYXJhbSAkdGltZW91dFxyXG4gKiBAcmV0dXJucyB7e3Jlc3RyaWN0OiBzdHJpbmcsIHJlcXVpcmU6IHN0cmluZ1tdLCBsaW5rOiBGdW5jdGlvbiwgc2NvcGU6IGJvb2xlYW59fVxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE1kQ2hpcFJlbW92ZSAoJHRpbWVvdXQpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgIHJlcXVpcmU6ICdebWRDaGlwcycsXHJcbiAgICBzY29wZTogZmFsc2UsXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICBlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICBjdHJsLnJlbW92ZUNoaXAoc2NvcGUuJCRyZXBsYWNlZFNjb3BlLiRpbmRleCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2hpbGQgZWxlbWVudHMgYXJlbid0IGF2YWlsYWJsZSB1bnRpbCBhZnRlciBhICR0aW1lb3V0IHRpY2sgYXMgdGhleSBhcmUgaGlkZGVuIGJ5IGFuXHJcbiAgICAvLyBgbmctaWZgLiBzZWUgaHR0cDovL2dvby5nbC96SVdmdXdcclxuICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICBlbGVtZW50LmF0dHIoeyB0YWJpbmRleDogLTEsIGFyaWFIaWRkZW46IHRydWUgfSk7XHJcbiAgICAgIGVsZW1lbnQuZmluZCgnYnV0dG9uJykuYXR0cigndGFiaW5kZXgnLCAnLTEnKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5NZENoaXBSZW1vdmUuJGluamVjdCA9IFtcIiR0aW1lb3V0XCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZENoaXBUcmFuc2NsdWRlJywgTWRDaGlwVHJhbnNjbHVkZSk7XHJcblxyXG5mdW5jdGlvbiBNZENoaXBUcmFuc2NsdWRlICgkY29tcGlsZSwgJG1kVXRpbCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXN0cmljdDogJ0VBJyxcclxuICAgIHRlcm1pbmFsOiB0cnVlLFxyXG4gICAgbGluazogbGluayxcclxuICAgIHNjb3BlOiBmYWxzZVxyXG4gIH07XHJcbiAgZnVuY3Rpb24gbGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcclxuICAgIHZhciBjdHJsID0gc2NvcGUuJHBhcmVudC4kbWRDaGlwc0N0cmwsXHJcbiAgICAgICAgbmV3U2NvcGUgPSBjdHJsLnBhcmVudC4kbmV3KGZhbHNlLCBjdHJsLnBhcmVudCk7XHJcbiAgICBuZXdTY29wZS4kJHJlcGxhY2VkU2NvcGUgPSBzY29wZTtcclxuICAgIG5ld1Njb3BlLiRjaGlwID0gc2NvcGUuJGNoaXA7XHJcbiAgICBuZXdTY29wZS4kbWRDaGlwc0N0cmwgPSBjdHJsO1xyXG4gICAgZWxlbWVudC5odG1sKGN0cmwuJHNjb3BlLiRldmFsKGF0dHIubWRDaGlwVHJhbnNjbHVkZSkpO1xyXG4gICAgJGNvbXBpbGUoZWxlbWVudC5jb250ZW50cygpKShuZXdTY29wZSk7XHJcbiAgfVxyXG59XHJcbk1kQ2hpcFRyYW5zY2x1ZGUuJGluamVjdCA9IFtcIiRjb21waWxlXCIsIFwiJG1kVXRpbFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHMnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ01kQ2hpcHNDdHJsJywgTWRDaGlwc0N0cmwpO1xyXG5cclxuLyoqXHJcbiAqIENvbnRyb2xsZXIgZm9yIHRoZSBNZENoaXBzIGNvbXBvbmVudC4gUmVzcG9uc2libGUgZm9yIGFkZGluZyB0byBhbmRcclxuICogcmVtb3ZpbmcgZnJvbSB0aGUgbGlzdCBvZiBjaGlwcywgbWFya2luZyBjaGlwcyBhcyBzZWxlY3RlZCwgYW5kIGJpbmRpbmcgdG9cclxuICogdGhlIG1vZGVscyBvZiB2YXJpb3VzIGlucHV0IGNvbXBvbmVudHMuXHJcbiAqXHJcbiAqIEBwYXJhbSAkc2NvcGVcclxuICogQHBhcmFtICRtZENvbnN0YW50XHJcbiAqIEBwYXJhbSAkbG9nXHJcbiAqIEBwYXJhbSAkZWxlbWVudFxyXG4gKiBAY29uc3RydWN0b3JcclxuICovXHJcbmZ1bmN0aW9uIE1kQ2hpcHNDdHJsICgkc2NvcGUsICRtZENvbnN0YW50LCAkbG9nLCAkZWxlbWVudCwgJHRpbWVvdXQpIHtcclxuICAvKiogQHR5cGUgeyR0aW1lb3V0fSAqKi9cclxuICB0aGlzLiR0aW1lb3V0ID0gJHRpbWVvdXQ7XHJcblxyXG4gIC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xyXG4gIHRoaXMuJG1kQ29uc3RhbnQgPSAkbWRDb25zdGFudDtcclxuXHJcbiAgLyoqIEB0eXBlIHthbmd1bGFyLiRzY29wZX0gKi9cclxuICB0aGlzLiRzY29wZSA9ICRzY29wZTtcclxuXHJcbiAgLyoqIEB0eXBlIHthbmd1bGFyLiRzY29wZX0gKi9cclxuICB0aGlzLnBhcmVudCA9ICRzY29wZS4kcGFyZW50O1xyXG5cclxuICAvKiogQHR5cGUgeyRsb2d9ICovXHJcbiAgdGhpcy4kbG9nID0gJGxvZztcclxuXHJcbiAgLyoqIEB0eXBlIHskZWxlbWVudH0gKi9cclxuICB0aGlzLiRlbGVtZW50ID0gJGVsZW1lbnQ7XHJcblxyXG4gIC8qKiBAdHlwZSB7YW5ndWxhci5OZ01vZGVsQ29udHJvbGxlcn0gKi9cclxuICB0aGlzLm5nTW9kZWxDdHJsID0gbnVsbDtcclxuXHJcbiAgLyoqIEB0eXBlIHthbmd1bGFyLk5nTW9kZWxDb250cm9sbGVyfSAqL1xyXG4gIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwgPSBudWxsO1xyXG5cclxuICAvKiogQHR5cGUge0VsZW1lbnR9ICovXHJcbiAgdGhpcy51c2VySW5wdXRFbGVtZW50ID0gbnVsbDtcclxuXHJcbiAgLyoqIEB0eXBlIHtBcnJheS48T2JqZWN0Pn0gKi9cclxuICB0aGlzLml0ZW1zID0gW107XHJcblxyXG4gIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG4gIHRoaXMuc2VsZWN0ZWRDaGlwID0gLTE7XHJcblxyXG5cclxuICAvKipcclxuICAgKiBIaWRkZW4gaGludCB0ZXh0IGZvciBob3cgdG8gZGVsZXRlIGEgY2hpcC4gVXNlZCB0byBnaXZlIGNvbnRleHQgdG8gc2NyZWVuIHJlYWRlcnMuXHJcbiAgICogQHR5cGUge3N0cmluZ31cclxuICAgKi9cclxuICB0aGlzLmRlbGV0ZUhpbnQgPSAnUHJlc3MgZGVsZXRlIHRvIHJlbW92ZSB0aGlzIGNoaXAuJztcclxuXHJcbiAgLyoqXHJcbiAgICogSGlkZGVuIGxhYmVsIGZvciB0aGUgZGVsZXRlIGJ1dHRvbi4gVXNlZCB0byBnaXZlIGNvbnRleHQgdG8gc2NyZWVuIHJlYWRlcnMuXHJcbiAgICogQHR5cGUge3N0cmluZ31cclxuICAgKi9cclxuICB0aGlzLmRlbGV0ZUJ1dHRvbkxhYmVsID0gJ1JlbW92ZSc7XHJcblxyXG4gIC8qKlxyXG4gICAqIE1vZGVsIHVzZWQgYnkgdGhlIGlucHV0IGVsZW1lbnQuXHJcbiAgICogQHR5cGUge3N0cmluZ31cclxuICAgKi9cclxuICB0aGlzLmNoaXBCdWZmZXIgPSAnJztcclxuXHJcbiAgLyoqXHJcbiAgICogV2hldGhlciB0byB1c2UgdGhlIG1kT25BcHBlbmQgZXhwcmVzc2lvbiB0byB0cmFuc2Zvcm0gdGhlIGNoaXAgYnVmZmVyXHJcbiAgICogYmVmb3JlIGFwcGVuZGluZyBpdCB0byB0aGUgbGlzdC5cclxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgKi9cclxuICB0aGlzLnVzZU1kT25BcHBlbmQgPSBmYWxzZTtcclxufVxyXG5NZENoaXBzQ3RybC4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbG9nXCIsIFwiJGVsZW1lbnRcIiwgXCIkdGltZW91dFwiXTtcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGVzIHRoZSBrZXlkb3duIGV2ZW50IG9uIHRoZSBpbnB1dCBlbGVtZW50OiA8ZW50ZXI+IGFwcGVuZHMgdGhlXHJcbiAqIGJ1ZmZlciB0byB0aGUgY2hpcCBsaXN0LCB3aGlsZSBiYWNrc3BhY2UgcmVtb3ZlcyB0aGUgbGFzdCBjaGlwIGluIHRoZSBsaXN0XHJcbiAqIGlmIHRoZSBjdXJyZW50IGJ1ZmZlciBpcyBlbXB0eS5cclxuICogQHBhcmFtIGV2ZW50XHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuaW5wdXRLZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuICB2YXIgY2hpcEJ1ZmZlciA9IHRoaXMuZ2V0Q2hpcEJ1ZmZlcigpO1xyXG4gIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xyXG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLkVOVEVSOlxyXG4gICAgICBpZiAodGhpcy4kc2NvcGUucmVxdWlyZU1hdGNoIHx8ICFjaGlwQnVmZmVyKSBicmVhaztcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5hcHBlbmRDaGlwKGNoaXBCdWZmZXIpO1xyXG4gICAgICB0aGlzLnJlc2V0Q2hpcEJ1ZmZlcigpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgdGhpcy4kbWRDb25zdGFudC5LRVlfQ09ERS5CQUNLU1BBQ0U6XHJcbiAgICAgIGlmIChjaGlwQnVmZmVyKSBicmVhaztcclxuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCkgdGhpcy5zZWxlY3RBbmRGb2N1c0NoaXBTYWZlKHRoaXMuaXRlbXMubGVuZ3RoIC0gMSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGVzIHRoZSBrZXlkb3duIGV2ZW50IG9uIHRoZSBjaGlwIGVsZW1lbnRzOiBiYWNrc3BhY2UgcmVtb3ZlcyB0aGUgc2VsZWN0ZWQgY2hpcCwgYXJyb3dcclxuICoga2V5cyBzd2l0Y2ggd2hpY2ggY2hpcHMgaXMgYWN0aXZlXHJcbiAqIEBwYXJhbSBldmVudFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLmNoaXBLZXlkb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgaWYgKHRoaXMuZ2V0Q2hpcEJ1ZmZlcigpKSByZXR1cm47XHJcbiAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XHJcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuQkFDS1NQQUNFOlxyXG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLkRFTEVURTpcclxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDaGlwIDwgMCkgcmV0dXJuO1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLnJlbW92ZUFuZFNlbGVjdEFkamFjZW50Q2hpcCh0aGlzLnNlbGVjdGVkQ2hpcCk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLkxFRlRfQVJST1c6XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGlmICh0aGlzLnNlbGVjdGVkQ2hpcCA8IDApIHRoaXMuc2VsZWN0ZWRDaGlwID0gdGhpcy5pdGVtcy5sZW5ndGg7XHJcbiAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCkgdGhpcy5zZWxlY3RBbmRGb2N1c0NoaXBTYWZlKHRoaXMuc2VsZWN0ZWRDaGlwIC0gMSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLlJJR0hUX0FSUk9XOlxyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLnNlbGVjdEFuZEZvY3VzQ2hpcFNhZmUodGhpcy5zZWxlY3RlZENoaXAgKyAxKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIHRoaXMuJG1kQ29uc3RhbnQuS0VZX0NPREUuRVNDQVBFOlxyXG4gICAgY2FzZSB0aGlzLiRtZENvbnN0YW50LktFWV9DT0RFLlRBQjpcclxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDaGlwIDwgMCkgcmV0dXJuO1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLm9uRm9jdXMoKTtcclxuICAgICAgYnJlYWs7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgaW5wdXQncyBwbGFjZWhvbGRlciAtIHVzZXMgYHBsYWNlaG9sZGVyYCB3aGVuIGxpc3QgaXMgZW1wdHkgYW5kIGBzZWNvbmRhcnktcGxhY2Vob2xkZXJgXHJcbiAqIHdoZW4gdGhlIGxpc3QgaXMgbm9uLWVtcHR5LiBJZiBgc2Vjb25kYXJ5LXBsYWNlaG9sZGVyYCBpcyBub3QgcHJvdmlkZWQsIGBwbGFjZWhvbGRlcmAgaXMgdXNlZFxyXG4gKiBhbHdheXMuXHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuZ2V0UGxhY2Vob2xkZXIgPSBmdW5jdGlvbigpIHtcclxuICAvLyBBbGxvdyBgc2Vjb25kYXJ5LXBsYWNlaG9sZGVyYCB0byBiZSBibGFuay5cclxuICB2YXIgdXNlU2Vjb25kYXJ5ID0gKHRoaXMuaXRlbXMubGVuZ3RoICYmXHJcbiAgICAgICh0aGlzLnNlY29uZGFyeVBsYWNlaG9sZGVyID09ICcnIHx8IHRoaXMuc2Vjb25kYXJ5UGxhY2Vob2xkZXIpKTtcclxuICByZXR1cm4gdXNlU2Vjb25kYXJ5ID8gdGhpcy5wbGFjZWhvbGRlciA6IHRoaXMuc2Vjb25kYXJ5UGxhY2Vob2xkZXI7XHJcbn07XHJcblxyXG4vKipcclxuICogUmVtb3ZlcyBjaGlwIGF0IHtAY29kZSBpbmRleH0gYW5kIHNlbGVjdHMgdGhlIGFkamFjZW50IGNoaXAuXHJcbiAqIEBwYXJhbSBpbmRleFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnJlbW92ZUFuZFNlbGVjdEFkamFjZW50Q2hpcCA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgdmFyIHNlbEluZGV4ID0gdGhpcy5nZXRBZGphY2VudENoaXBJbmRleChpbmRleCk7XHJcbiAgdGhpcy5yZW1vdmVDaGlwKGluZGV4KTtcclxuICB0aGlzLiR0aW1lb3V0KGFuZ3VsYXIuYmluZCh0aGlzLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0QW5kRm9jdXNDaGlwU2FmZShzZWxJbmRleCk7XHJcbiAgfSkpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNldHMgdGhlIHNlbGVjdGVkIGNoaXAgaW5kZXggdG8gLTEuXHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUucmVzZXRTZWxlY3RlZENoaXAgPSBmdW5jdGlvbigpIHtcclxuICB0aGlzLnNlbGVjdGVkQ2hpcCA9IC0xO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEdldHMgdGhlIGluZGV4IG9mIGFuIGFkamFjZW50IGNoaXAgdG8gc2VsZWN0IGFmdGVyIGRlbGV0aW9uLiBBZGphY2VuY3kgaXNcclxuICogZGV0ZXJtaW5lZCBhcyB0aGUgbmV4dCBjaGlwIGluIHRoZSBsaXN0LCB1bmxlc3MgdGhlIHRhcmdldCBjaGlwIGlzIHRoZVxyXG4gKiBsYXN0IGluIHRoZSBsaXN0LCB0aGVuIGl0IGlzIHRoZSBjaGlwIGltbWVkaWF0ZWx5IHByZWNlZGluZyB0aGUgdGFyZ2V0LiBJZlxyXG4gKiB0aGVyZSBpcyBvbmx5IG9uZSBpdGVtIGluIHRoZSBsaXN0LCAtMSBpcyByZXR1cm5lZCAoc2VsZWN0IG5vbmUpLlxyXG4gKiBUaGUgbnVtYmVyIHJldHVybmVkIGlzIHRoZSBpbmRleCB0byBzZWxlY3QgQUZURVIgdGhlIHRhcmdldCBoYXMgYmVlblxyXG4gKiByZW1vdmVkLlxyXG4gKiBJZiB0aGUgY3VycmVudCBjaGlwIGlzIG5vdCBzZWxlY3RlZCwgdGhlbiAtMSBpcyByZXR1cm5lZCB0byBzZWxlY3Qgbm9uZS5cclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5nZXRBZGphY2VudENoaXBJbmRleCA9IGZ1bmN0aW9uKGluZGV4KSB7XHJcbiAgdmFyIGxlbiA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTtcclxuICByZXR1cm4gKGxlbiA9PSAwKSA/IC0xIDpcclxuICAgICAgKGluZGV4ID09IGxlbikgPyBpbmRleCAtMSA6IGluZGV4O1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEFwcGVuZCB0aGUgY29udGVudHMgb2YgdGhlIGJ1ZmZlciB0byB0aGUgY2hpcCBsaXN0LiBUaGlzIG1ldGhvZCB3aWxsIGZpcnN0XHJcbiAqIGNhbGwgb3V0IHRvIHRoZSBtZC1vbi1hcHBlbmQgbWV0aG9kLCBpZiBwcm92aWRlZFxyXG4gKiBAcGFyYW0gbmV3Q2hpcFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLmFwcGVuZENoaXAgPSBmdW5jdGlvbihuZXdDaGlwKSB7XHJcbiAgaWYgKHRoaXMuaXRlbXMuaW5kZXhPZihuZXdDaGlwKSArIDEpIHJldHVybjtcclxuICBpZiAodGhpcy51c2VNZE9uQXBwZW5kICYmIHRoaXMubWRPbkFwcGVuZCkge1xyXG4gICAgbmV3Q2hpcCA9IHRoaXMubWRPbkFwcGVuZCh7JyRjaGlwJzogbmV3Q2hpcH0pO1xyXG4gIH1cclxuICB0aGlzLml0ZW1zLnB1c2gobmV3Q2hpcCk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2V0cyB3aGV0aGVyIHRvIHVzZSB0aGUgbWQtb24tYXBwZW5kIGV4cHJlc3Npb24uIFRoaXMgZXhwcmVzc2lvbiBpc1xyXG4gKiBib3VuZCB0byBzY29wZSBhbmQgY29udHJvbGxlciBpbiB7QGNvZGUgTWRDaGlwc0RpcmVjdGl2ZX0gYXNcclxuICoge0Bjb2RlIG1kT25BcHBlbmR9LiBEdWUgdG8gdGhlIG5hdHVyZSBvZiBkaXJlY3RpdmUgc2NvcGUgYmluZGluZ3MsIHRoZVxyXG4gKiBjb250cm9sbGVyIGNhbm5vdCBrbm93IG9uIGl0cyBvd24vZnJvbSB0aGUgc2NvcGUgd2hldGhlciBhbiBleHByZXNzaW9uIHdhc1xyXG4gKiBhY3R1YWxseSBwcm92aWRlZC5cclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS51c2VNZE9uQXBwZW5kRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCkge1xyXG4gIHRoaXMudXNlTWRPbkFwcGVuZCA9IHRydWU7XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgaW5wdXQgYnVmZmVyLiBUaGUgaW5wdXQgYnVmZmVyIGNhbiBiZSB0aGUgbW9kZWwgYm91bmQgdG8gdGhlXHJcbiAqIGRlZmF1bHQgaW5wdXQgaXRlbSB7QGNvZGUgdGhpcy5jaGlwQnVmZmVyfSwgdGhlIHtAY29kZSBzZWxlY3RlZEl0ZW19XHJcbiAqIG1vZGVsIG9mIGFuIHtAY29kZSBtZC1hdXRvY29tcGxldGV9LCBvciwgdGhyb3VnaCBzb21lIG1hZ2ljLCB0aGUgbW9kZWxcclxuICogYm91bmQgdG8gYW55IGlucHB1dCBvciB0ZXh0IGFyZWEgZWxlbWVudCBmb3VuZCB3aXRoaW4gYVxyXG4gKiB7QGNvZGUgbWQtaW5wdXQtY29udGFpbmVyfSBlbGVtZW50LlxyXG4gKiBAcmV0dXJuIHtPYmplY3R8c3RyaW5nfVxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLmdldENoaXBCdWZmZXIgPSBmdW5jdGlvbigpIHtcclxuICByZXR1cm4gIXRoaXMudXNlcklucHV0RWxlbWVudCA/IHRoaXMuY2hpcEJ1ZmZlciA6XHJcbiAgICAgIHRoaXMudXNlcklucHV0TmdNb2RlbEN0cmwgPyB0aGlzLnVzZXJJbnB1dE5nTW9kZWxDdHJsLiR2aWV3VmFsdWUgOlxyXG4gICAgICAgICAgdGhpcy51c2VySW5wdXRFbGVtZW50WzBdLnZhbHVlO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFJlc2V0cyB0aGUgaW5wdXQgYnVmZmVyIGZvciBlaXRoZXIgdGhlIGludGVybmFsIGlucHV0IG9yIHVzZXIgcHJvdmlkZWQgaW5wdXQgZWxlbWVudC5cclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5yZXNldENoaXBCdWZmZXIgPSBmdW5jdGlvbigpIHtcclxuICBpZiAodGhpcy51c2VySW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAodGhpcy51c2VySW5wdXROZ01vZGVsQ3RybCkge1xyXG4gICAgICB0aGlzLnVzZXJJbnB1dE5nTW9kZWxDdHJsLiRzZXRWaWV3VmFsdWUoJycpO1xyXG4gICAgICB0aGlzLnVzZXJJbnB1dE5nTW9kZWxDdHJsLiRyZW5kZXIoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudXNlcklucHV0RWxlbWVudFswXS52YWx1ZSA9ICcnO1xyXG4gICAgfVxyXG4gIH0gZWxzZSB7XHJcbiAgICB0aGlzLmNoaXBCdWZmZXIgPSAnJztcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogUmVtb3ZlcyB0aGUgY2hpcCBhdCB0aGUgZ2l2ZW4gaW5kZXguXHJcbiAqIEBwYXJhbSBpbmRleFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnJlbW92ZUNoaXAgPSBmdW5jdGlvbihpbmRleCkge1xyXG4gIHRoaXMuaXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcclxufTtcclxuXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5yZW1vdmVDaGlwQW5kRm9jdXNJbnB1dCA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gIHRoaXMucmVtb3ZlQ2hpcChpbmRleCk7XHJcbiAgdGhpcy5vbkZvY3VzKCk7XHJcbn07XHJcbi8qKlxyXG4gKiBTZWxlY3RzIHRoZSBjaGlwIGF0IGBpbmRleGAsXHJcbiAqIEBwYXJhbSBpbmRleFxyXG4gKi9cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLnNlbGVjdEFuZEZvY3VzQ2hpcFNhZmUgPSBmdW5jdGlvbihpbmRleCkge1xyXG4gIGlmICghdGhpcy5pdGVtcy5sZW5ndGgpIHtcclxuICAgIHRoaXMuc2VsZWN0Q2hpcCgtMSk7XHJcbiAgICB0aGlzLm9uRm9jdXMoKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgaWYgKGluZGV4ID09PSB0aGlzLml0ZW1zLmxlbmd0aCkgcmV0dXJuIHRoaXMub25Gb2N1cygpO1xyXG4gIGluZGV4ID0gTWF0aC5tYXgoaW5kZXgsIDApO1xyXG4gIGluZGV4ID0gTWF0aC5taW4oaW5kZXgsIHRoaXMuaXRlbXMubGVuZ3RoIC0gMSk7XHJcbiAgdGhpcy5zZWxlY3RDaGlwKGluZGV4KTtcclxuICB0aGlzLmZvY3VzQ2hpcChpbmRleCk7XHJcbn07XHJcblxyXG4vKipcclxuICogTWFya3MgdGhlIGNoaXAgYXQgdGhlIGdpdmVuIGluZGV4IGFzIHNlbGVjdGVkLlxyXG4gKiBAcGFyYW0gaW5kZXhcclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5zZWxlY3RDaGlwID0gZnVuY3Rpb24oaW5kZXgpIHtcclxuICBpZiAoaW5kZXggPj0gLTEgJiYgaW5kZXggPD0gdGhpcy5pdGVtcy5sZW5ndGgpIHtcclxuICAgIHRoaXMuc2VsZWN0ZWRDaGlwID0gaW5kZXg7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRoaXMuJGxvZy53YXJuKCdTZWxlY3RlZCBDaGlwIGluZGV4IG91dCBvZiBib3VuZHM7IGlnbm9yaW5nLicpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZWxlY3RzIHRoZSBjaGlwIGF0IGBpbmRleGAgYW5kIGdpdmVzIGl0IGZvY3VzLlxyXG4gKiBAcGFyYW0gaW5kZXhcclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5zZWxlY3RBbmRGb2N1c0NoaXAgPSBmdW5jdGlvbihpbmRleCkge1xyXG4gIHRoaXMuc2VsZWN0Q2hpcChpbmRleCk7XHJcbiAgaWYgKGluZGV4ICE9IC0xKSB7XHJcbiAgICB0aGlzLmZvY3VzQ2hpcChpbmRleCk7XHJcbiAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENhbGwgYGZvY3VzKClgIG9uIHRoZSBjaGlwIGF0IGBpbmRleGBcclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5mb2N1c0NoaXAgPSBmdW5jdGlvbihpbmRleCkge1xyXG4gIHRoaXMuJGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignbWQtY2hpcFtpbmRleD1cIicgKyBpbmRleCArICdcIl0gLm1kLWNoaXAtY29udGVudCcpLmZvY3VzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogQ29uZmlndXJlcyB0aGUgcmVxdWlyZWQgaW50ZXJhY3Rpb25zIHdpdGggdGhlIG5nTW9kZWwgQ29udHJvbGxlci5cclxuICogU3BlY2lmaWNhbGx5LCBzZXQge0Bjb2RlIHRoaXMuaXRlbXN9IHRvIHRoZSB7QGNvZGUgTmdNb2RlbEN0cmwjJHZpZXdWYWxlfS5cclxuICogQHBhcmFtIG5nTW9kZWxDdHJsXHJcbiAqL1xyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuY29uZmlndXJlTmdNb2RlbCA9IGZ1bmN0aW9uKG5nTW9kZWxDdHJsKSB7XHJcbiAgdGhpcy5uZ01vZGVsQ3RybCA9IG5nTW9kZWxDdHJsO1xyXG5cclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgbmdNb2RlbEN0cmwuJHJlbmRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gbW9kZWwgaXMgdXBkYXRlZC4gZG8gc29tZXRoaW5nLlxyXG4gICAgc2VsZi5pdGVtcyA9IHNlbGYubmdNb2RlbEN0cmwuJHZpZXdWYWx1ZTtcclxuICB9O1xyXG59O1xyXG5cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLm9uRm9jdXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdmFyIGlucHV0ID0gdGhpcy4kZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xyXG4gIGlucHV0ICYmIGlucHV0LmZvY3VzKCk7XHJcbiAgdGhpcy5yZXNldFNlbGVjdGVkQ2hpcCgpO1xyXG59O1xyXG5cclxuTWRDaGlwc0N0cmwucHJvdG90eXBlLm9uSW5wdXRGb2N1cyA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLmlucHV0SGFzRm9jdXMgPSB0cnVlO1xyXG4gIHRoaXMucmVzZXRTZWxlY3RlZENoaXAoKTtcclxufTtcclxuXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5vbklucHV0Qmx1ciA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLmlucHV0SGFzRm9jdXMgPSBmYWxzZTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDb25maWd1cmUgZXZlbnQgYmluZGluZ3Mgb24gYSB1c2VyLXByb3ZpZGVkIGlucHV0IGVsZW1lbnQuXHJcbiAqIEBwYXJhbSBpbnB1dEVsZW1lbnRcclxuICovXHJcbk1kQ2hpcHNDdHJsLnByb3RvdHlwZS5jb25maWd1cmVVc2VySW5wdXQgPSBmdW5jdGlvbihpbnB1dEVsZW1lbnQpIHtcclxuICB0aGlzLnVzZXJJbnB1dEVsZW1lbnQgPSBpbnB1dEVsZW1lbnQ7XHJcblxyXG4gIC8vIEZpbmQgdGhlIE5nTW9kZWxDdHJsIGZvciB0aGUgaW5wdXQgZWxlbWVudFxyXG4gIHZhciBuZ01vZGVsQ3RybCA9IGlucHV0RWxlbWVudC5jb250cm9sbGVyKCduZ01vZGVsJyk7XHJcbiAgLy8gYC5jb250cm9sbGVyYCB3aWxsIGxvb2sgaW4gdGhlIHBhcmVudCBhcyB3ZWxsLlxyXG4gIGlmIChuZ01vZGVsQ3RybCAhPSB0aGlzLm5nTW9kZWxDdHJsKSB7XHJcbiAgICB0aGlzLnVzZXJJbnB1dE5nTW9kZWxDdHJsID0gbmdNb2RlbEN0cmw7XHJcbiAgfVxyXG5cclxuICAvLyBCaW5kIHRvIGtleWRvd24gYW5kIGZvY3VzIGV2ZW50cyBvZiBpbnB1dFxyXG4gIHZhciBzY29wZSA9IHRoaXMuJHNjb3BlO1xyXG4gIHZhciBjdHJsID0gdGhpcztcclxuICBpbnB1dEVsZW1lbnRcclxuICAgICAgLmF0dHIoeyB0YWJpbmRleDogMCB9KVxyXG4gICAgICAub24oJ2tleWRvd24nLCBmdW5jdGlvbihldmVudCkgeyBzY29wZS4kYXBwbHkoIGFuZ3VsYXIuYmluZChjdHJsLCBmdW5jdGlvbigpIHsgY3RybC5pbnB1dEtleWRvd24oZXZlbnQpOyB9KSkgfSlcclxuICAgICAgLm9uKCdmb2N1cycsIGFuZ3VsYXIuYmluZChjdHJsLCBjdHJsLm9uSW5wdXRGb2N1cykpXHJcbiAgICAgIC5vbignYmx1cicsIGFuZ3VsYXIuYmluZChjdHJsLCBjdHJsLm9uSW5wdXRCbHVyKSk7XHJcbn07XHJcblxyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuY29uZmlndXJlQXV0b2NvbXBsZXRlID0gZnVuY3Rpb24oY3RybCkge1xyXG5cclxuICBjdHJsLnJlZ2lzdGVyU2VsZWN0ZWRJdGVtV2F0Y2hlcihhbmd1bGFyLmJpbmQodGhpcywgZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgIGlmIChpdGVtKSB7XHJcbiAgICAgIHRoaXMuYXBwZW5kQ2hpcChpdGVtKTtcclxuICAgICAgdGhpcy5yZXNldENoaXBCdWZmZXIoKTtcclxuICAgIH1cclxuICB9KSk7XHJcblxyXG4gIHRoaXMuJGVsZW1lbnQuZmluZCgnaW5wdXQnKVxyXG4gICAgICAub24oJ2ZvY3VzJyxhbmd1bGFyLmJpbmQodGhpcywgdGhpcy5vbklucHV0Rm9jdXMpIClcclxuICAgICAgLm9uKCdibHVyJywgYW5ndWxhci5iaW5kKHRoaXMsIHRoaXMub25JbnB1dEJsdXIpICk7XHJcbn07XHJcblxyXG5NZENoaXBzQ3RybC5wcm90b3R5cGUuaGFzRm9jdXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgcmV0dXJuIHRoaXMuaW5wdXRIYXNGb2N1cyB8fCB0aGlzLnNlbGVjdGVkQ2hpcCA+PSAwO1xyXG59O1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuICBhbmd1bGFyXHJcbiAgICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMuY2hpcHMnKVxyXG4gICAgICAuZGlyZWN0aXZlKCdtZENoaXBzJywgTWRDaGlwcyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICAgKiBAbmFtZSBtZENoaXBzXHJcbiAgICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzXHJcbiAgICpcclxuICAgKiBAZGVzY3JpcHRpb25cclxuICAgKiBgPG1kLWNoaXBzPmAgaXMgYW4gaW5wdXQgY29tcG9uZW50IGZvciBidWlsZGluZyBsaXN0cyBvZiBzdHJpbmdzIG9yIG9iamVjdHMuIFRoZSBsaXN0IGl0ZW1zIGFyZVxyXG4gICAqIGRpc3BsYXllZCBhcyAnY2hpcHMnLiBUaGlzIGNvbXBvbmVudCBjYW4gbWFrZSB1c2Ugb2YgYW4gYDxpbnB1dD5gIGVsZW1lbnQgb3IgYW5cclxuICAgKiBgPG1kLWF1dG9jb21wbGV0ZT5gIGVsZW1lbnQuXHJcbiAgICpcclxuICAgKiA8c3Ryb25nPkN1c3RvbSBgPG1kLWNoaXAtdGVtcGxhdGU+YCB0ZW1wbGF0ZTwvc3Ryb25nPlxyXG4gICAqIEEgY3VzdG9tIHRlbXBsYXRlIG1heSBiZSBwcm92aWRlZCB0byByZW5kZXIgdGhlIGNvbnRlbnQgb2YgZWFjaCBjaGlwLiBUaGlzIGlzIGFjaGlldmVkIGJ5XHJcbiAgICogc3BlY2lmeWluZyBhbiBgPG1kLWNoaXAtdGVtcGxhdGU+YCBlbGVtZW50IGFzIGEgY2hpbGQgb2YgYDxtZC1jaGlwcz5gLiBOb3RlOiBBbnkgYXR0cmlidXRlcyBvblxyXG4gICAqIGA8bWQtY2hpcC10ZW1wbGF0ZT5gIHdpbGwgYmUgZHJvcHBlZCBhcyBvbmx5IHRoZSBpbm5lckhUTUwgaXMgdXNlZCBmb3IgdGhlIGNoaXAgdGVtcGxhdGUuIFRoZVxyXG4gICAqIHZhcmlhYmxlcyBgJGNoaXBgIGFuZCBgJGluZGV4YCBhcmUgYXZhaWxhYmxlIGluIHRoZSBzY29wZSBvZiBgPG1kLWNoaXAtdGVtcGxhdGU+YCwgcmVwcmVzZW50aW5nXHJcbiAgICogdGhlIGNoaXAgb2JqZWN0IGFuZCBpdHMgaW5kZXggaW4gdGhlIGxpc3Qgb2YgY2hpcHMsIHJlc3BlY3RpdmVseS5cclxuICAgKiBUbyBvdmVycmlkZSB0aGUgY2hpcCBkZWxldGUgY29udHJvbCwgaW5jbHVkZSBhbiBlbGVtZW50IChpZGVhbGx5IGEgYnV0dG9uKSB3aXRoIHRoZSBhdHRyaWJ1dGVcclxuICAgKiBgbWQtY2hpcC1yZW1vdmVgLiBBIGNsaWNrIGxpc3RlbmVyIHRvIHJlbW92ZSB0aGUgY2hpcCB3aWxsIGJlIGFkZGVkIGF1dG9tYXRpY2FsbHkuIFRoZSBlbGVtZW50XHJcbiAgICogaXMgYWxzbyBwbGFjZWQgYXMgYSBzaWJsaW5nIHRvIHRoZSBjaGlwIGNvbnRlbnQgKG9uIHdoaWNoIHRoZXJlIGFyZSBhbHNvIGNsaWNrIGxpc3RlbmVycykgdG9cclxuICAgKiBhdm9pZCBhIG5lc3RlZCBuZy1jbGljayBzaXR1YXRpb24uXHJcbiAgICpcclxuICAgKiA8aDM+IFBlbmRpbmcgRmVhdHVyZXMgPC9oMz5cclxuICAgKiA8dWwgc3R5bGU9XCJwYWRkaW5nLWxlZnQ6MjBweDtcIj5cclxuICAgKlxyXG4gICAqICAgPHVsPlN0eWxlXHJcbiAgICogICAgIDxsaT5Db2xvdXJzIGZvciBob3ZlciwgcHJlc3Mgc3RhdGVzIChyaXBwbGU/KS48L2xpPlxyXG4gICAqICAgPC91bD5cclxuICAgKlxyXG4gICAqICAgPHVsPkxpc3QgTWFuaXB1bGF0aW9uXHJcbiAgICogICAgIDxsaT5kZWxldGUgaXRlbSB2aWEgREVMIG9yIGJhY2tzcGFjZSBrZXlzIHdoZW4gc2VsZWN0ZWQ8L2xpPlxyXG4gICAqICAgPC91bD5cclxuICAgKlxyXG4gICAqICAgPHVsPlZhbGlkYXRpb25cclxuICAgKiAgICAgPGxpPmRlLWR1cGUgdmFsdWVzIChvciBzdXBwb3J0IGR1cGxpY2F0ZXMsIGJ1dCBmaXggdGhlIG5nLXJlcGVhdCBkdXBsaWNhdGUga2V5IGlzc3VlKTwvbGk+XHJcbiAgICogICAgIDxsaT5hbGxvdyBhIHZhbGlkYXRpb24gY2FsbGJhY2s8L2xpPlxyXG4gICAqICAgICA8bGk+aGlsaWdodGluZyBzdHlsZSBmb3IgaW52YWxpZCBjaGlwczwvbGk+XHJcbiAgICogICA8L3VsPlxyXG4gICAqXHJcbiAgICogICA8dWw+SXRlbSBtdXRhdGlvblxyXG4gICAqICAgICA8bGk+U3VwcG9ydCBgXHJcbiAgICogICAgICAgPG1kLWNoaXAtZWRpdD5gIHRlbXBsYXRlLCBzaG93L2hpZGUgdGhlIGVkaXQgZWxlbWVudCBvbiB0YXAvY2xpY2s/IGRvdWJsZSB0YXAvZG91YmxlXHJcbiAgICogICAgICAgY2xpY2s/XHJcbiAgICogICAgIDwvbGk+XHJcbiAgICogICA8L3VsPlxyXG4gICAqXHJcbiAgICogICA8dWw+VHJ1bmNhdGlvbiBhbmQgRGlzYW1iaWd1YXRpb24gKD8pXHJcbiAgICogICAgIDxsaT5UcnVuY2F0ZSBjaGlwIHRleHQgd2hlcmUgcG9zc2libGUsIGJ1dCBkbyBub3QgdHJ1bmNhdGUgZW50cmllcyBzdWNoIHRoYXQgdHdvIGFyZVxyXG4gICAqICAgICBpbmRpc3Rpbmd1aXNoYWJsZS48L2xpPlxyXG4gICAqICAgPC91bD5cclxuICAgKlxyXG4gICAqICAgPHVsPkRyYWcgYW5kIERyb3BcclxuICAgKiAgICAgPGxpPkRyYWcgYW5kIGRyb3AgY2hpcHMgYmV0d2VlbiByZWxhdGVkIGA8bWQtY2hpcHM+YCBlbGVtZW50cy5cclxuICAgKiAgICAgPC9saT5cclxuICAgKiAgIDwvdWw+XHJcbiAgICogPC91bD5cclxuICAgKlxyXG4gICAqICA8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTouOGVtO3RleHQtYWxpZ246Y2VudGVyXCI+XHJcbiAgICogICAgV2FybmluZzogVGhpcyBjb21wb25lbnQgaXMgYSBXT1JLIElOIFBST0dSRVNTLiBJZiB5b3UgdXNlIGl0IG5vdyxcclxuICAgKiAgICBpdCB3aWxsIHByb2JhYmx5IGJyZWFrIG9uIHlvdSBpbiB0aGUgZnV0dXJlLlxyXG4gICAqICA8L3NwYW4+XHJcbiAgICpcclxuICAgKiBAcGFyYW0ge3N0cmluZz18b2JqZWN0PX0gbmctbW9kZWwgQSBtb2RlbCB0byBiaW5kIHRoZSBsaXN0IG9mIGl0ZW1zIHRvXHJcbiAgICogQHBhcmFtIHtzdHJpbmc9fSBwbGFjZWhvbGRlciBQbGFjZWhvbGRlciB0ZXh0IHRoYXQgd2lsbCBiZSBmb3J3YXJkZWQgdG8gdGhlIGlucHV0LlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gc2Vjb25kYXJ5LXBsYWNlaG9sZGVyIFBsYWNlaG9sZGVyIHRleHQgdGhhdCB3aWxsIGJlIGZvcndhcmRlZCB0byB0aGUgaW5wdXQsXHJcbiAgICogICAgZGlzcGxheWVkIHdoZW4gdGhlcmUgaXMgYXQgbGVhc3Qgb24gaXRlbSBpbiB0aGUgbGlzdFxyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbj19IHJlYWRvbmx5IERpc2FibGVzIGxpc3QgbWFuaXB1bGF0aW9uIChkZWxldGluZyBvciBhZGRpbmcgbGlzdCBpdGVtcyksIGhpZGluZ1xyXG4gICAqICAgIHRoZSBpbnB1dCBhbmQgZGVsZXRlIGJ1dHRvbnNcclxuICAgKiBAcGFyYW0ge2V4cHJlc3Npb259IG1kLW9uLWFwcGVuZCBBbiBleHByZXNzaW9uIGV4cGVjdGVkIHRvIGNvbnZlcnQgdGhlIGlucHV0IHN0cmluZyBpbnRvIGFuXHJcbiAgICogICAgb2JqZWN0IHdoZW4gYWRkaW5nIGEgY2hpcC5cclxuICAgKiBAcGFyYW0ge3N0cmluZz19IGRlbGV0ZS1oaW50IEEgc3RyaW5nIHJlYWQgYnkgc2NyZWVuIHJlYWRlcnMgaW5zdHJ1Y3RpbmcgdXNlcnMgdGhhdCBwcmVzc2luZ1xyXG4gICAqICAgIHRoZSBkZWxldGUga2V5IHdpbGwgcmVtb3ZlIHRoZSBjaGlwLlxyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gZGVsZXRlLWJ1dHRvbi1sYWJlbCBBIGxhYmVsIGZvciB0aGUgZGVsZXRlIGJ1dHRvbi4gQWxzbyBoaWRkZW4gYW5kIHJlYWQgYnlcclxuICAgKiAgICBzY3JlZW4gcmVhZGVycy5cclxuICAgKlxyXG4gICAqIEB1c2FnZVxyXG4gICAqIDxobGpzIGxhbmc9XCJodG1sXCI+XHJcbiAgICogICA8bWQtY2hpcHNcclxuICAgKiAgICAgICBuZy1tb2RlbD1cIm15SXRlbXNcIlxyXG4gICAqICAgICAgIHBsYWNlaG9sZGVyPVwiQWRkIGFuIGl0ZW1cIlxyXG4gICAqICAgICAgIHJlYWRvbmx5PVwiaXNSZWFkT25seVwiPlxyXG4gICAqICAgPC9tZC1jaGlwcz5cclxuICAgKiA8L2hsanM+XHJcbiAgICpcclxuICAgKi9cclxuXHJcblxyXG4gIHZhciBNRF9DSElQU19URU1QTEFURSA9ICdcXFxyXG4gICAgICA8bWQtY2hpcHMtd3JhcFxcXHJcbiAgICAgICAgICBuZy1pZj1cIiEkbWRDaGlwc0N0cmwucmVhZG9ubHkgfHwgJG1kQ2hpcHNDdHJsLml0ZW1zLmxlbmd0aCA+IDBcIlxcXHJcbiAgICAgICAgICBuZy1rZXlkb3duPVwiJG1kQ2hpcHNDdHJsLmNoaXBLZXlkb3duKCRldmVudClcIlxcXHJcbiAgICAgICAgICBuZy1jbGFzcz1cInsgXFwnbWQtZm9jdXNlZFxcJzogJG1kQ2hpcHNDdHJsLmhhc0ZvY3VzKCkgfVwiXFxcclxuICAgICAgICAgIGNsYXNzPVwibWQtY2hpcHNcIj5cXFxyXG4gICAgICAgIDxtZC1jaGlwIG5nLXJlcGVhdD1cIiRjaGlwIGluICRtZENoaXBzQ3RybC5pdGVtc1wiXFxcclxuICAgICAgICAgICAgaW5kZXg9XCJ7eyRpbmRleH19XCJcXFxyXG4gICAgICAgICAgICBuZy1jbGFzcz1cIntcXCdtZC1mb2N1c2VkXFwnOiAkbWRDaGlwc0N0cmwuc2VsZWN0ZWRDaGlwID09ICRpbmRleH1cIj5cXFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWNoaXAtY29udGVudFwiXFxcclxuICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcXFxyXG4gICAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXFxcclxuICAgICAgICAgICAgICBuZy1mb2N1cz1cIiEkbWRDaGlwc0N0cmwucmVhZG9ubHkgJiYgJG1kQ2hpcHNDdHJsLnNlbGVjdENoaXAoJGluZGV4KVwiXFxcclxuICAgICAgICAgICAgICBtZC1jaGlwLXRyYW5zY2x1ZGU9XCIkbWRDaGlwc0N0cmwuY2hpcENvbnRlbnRzVGVtcGxhdGVcIj48L2Rpdj5cXFxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLWNoaXAtcmVtb3ZlLWNvbnRhaW5lclwiXFxcclxuICAgICAgICAgICAgICBtZC1jaGlwLXRyYW5zY2x1ZGU9XCIkbWRDaGlwc0N0cmwuY2hpcFJlbW92ZVRlbXBsYXRlXCI+PC9kaXY+XFxcclxuICAgICAgICA8L21kLWNoaXA+XFxcclxuICAgICAgICA8ZGl2IG5nLWlmPVwiISRtZENoaXBzQ3RybC5yZWFkb25seSAmJiAkbWRDaGlwc0N0cmwubmdNb2RlbEN0cmxcIlxcXHJcbiAgICAgICAgICAgIGNsYXNzPVwibWQtY2hpcC1pbnB1dC1jb250YWluZXJcIlxcXHJcbiAgICAgICAgICAgIG1kLWNoaXAtdHJhbnNjbHVkZT1cIiRtZENoaXBzQ3RybC5jaGlwSW5wdXRUZW1wbGF0ZVwiPjwvZGl2PlxcXHJcbiAgICAgICAgPC9kaXY+XFxcclxuICAgICAgPC9tZC1jaGlwcy13cmFwPic7XHJcblxyXG4gIHZhciBDSElQX0lOUFVUX1RFTVBMQVRFID0gJ1xcXHJcbiAgICAgICAgPGlucHV0XFxcclxuICAgICAgICAgICAgdGFiaW5kZXg9XCIwXCJcXFxyXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cInt7JG1kQ2hpcHNDdHJsLmdldFBsYWNlaG9sZGVyKCl9fVwiXFxcclxuICAgICAgICAgICAgYXJpYS1sYWJlbD1cInt7JG1kQ2hpcHNDdHJsLmdldFBsYWNlaG9sZGVyKCl9fVwiXFxcclxuICAgICAgICAgICAgbmctbW9kZWw9XCIkbWRDaGlwc0N0cmwuY2hpcEJ1ZmZlclwiXFxcclxuICAgICAgICAgICAgbmctZm9jdXM9XCIkbWRDaGlwc0N0cmwub25JbnB1dEZvY3VzKClcIlxcXHJcbiAgICAgICAgICAgIG5nLWJsdXI9XCIkbWRDaGlwc0N0cmwub25JbnB1dEJsdXIoKVwiXFxcclxuICAgICAgICAgICAgbmcta2V5ZG93bj1cIiRtZENoaXBzQ3RybC5pbnB1dEtleWRvd24oJGV2ZW50KVwiPic7XHJcblxyXG4gIHZhciBDSElQX0RFRkFVTFRfVEVNUExBVEUgPSAnXFxcclxuICAgICAgPHNwYW4+e3skY2hpcH19PC9zcGFuPic7XHJcblxyXG4gIHZhciBDSElQX1JFTU9WRV9URU1QTEFURSA9ICdcXFxyXG4gICAgICA8YnV0dG9uXFxcclxuICAgICAgICAgIGNsYXNzPVwibWQtY2hpcC1yZW1vdmVcIlxcXHJcbiAgICAgICAgICBuZy1pZj1cIiEkbWRDaGlwc0N0cmwucmVhZG9ubHlcIlxcXHJcbiAgICAgICAgICBuZy1jbGljaz1cIiRtZENoaXBzQ3RybC5yZW1vdmVDaGlwQW5kRm9jdXNJbnB1dCgkJHJlcGxhY2VkU2NvcGUuJGluZGV4KVwiXFxcclxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxcXHJcbiAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxcXHJcbiAgICAgICAgICB0YWJpbmRleD1cIi0xXCI+XFxcclxuICAgICAgICA8bWQtaWNvbiBtZC1zdmctaWNvbj1cIm1kLWNsb3NlXCI+PC9tZC1pY29uPlxcXHJcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJtZC12aXN1YWxseS1oaWRkZW5cIj5cXFxyXG4gICAgICAgICAge3skbWRDaGlwc0N0cmwuZGVsZXRlQnV0dG9uTGFiZWx9fVxcXHJcbiAgICAgICAgPC9zcGFuPlxcXHJcbiAgICAgIDwvYnV0dG9uPic7XHJcblxyXG4gIC8qKlxyXG4gICAqIE1EQ2hpcHMgRGlyZWN0aXZlIERlZmluaXRpb25cclxuICAgKi9cclxuICBmdW5jdGlvbiBNZENoaXBzICgkbWRUaGVtaW5nLCAkbWRVdGlsLCAkY29tcGlsZSwgJGxvZywgJHRpbWVvdXQpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRlbXBsYXRlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgIC8vIENsb25lIHRoZSBlbGVtZW50IGludG8gYW4gYXR0cmlidXRlLiBCeSBwcmVwZW5kaW5nIHRoZSBhdHRyaWJ1dGVcclxuICAgICAgICAvLyBuYW1lIHdpdGggJyQnLCBBbmd1bGFyIHdvbid0IHdyaXRlIGl0IGludG8gdGhlIERPTS4gVGhlIGNsb25lZFxyXG4gICAgICAgIC8vIGVsZW1lbnQgcHJvcGFnYXRlcyB0byB0aGUgbGluayBmdW5jdGlvbiB2aWEgdGhlIGF0dHJzIGFyZ3VtZW50LFxyXG4gICAgICAgIC8vIHdoZXJlIHZhcmlvdXMgY29udGFpbmVkLWVsZW1lbnRzIGNhbiBiZSBjb25zdW1lZC5cclxuICAgICAgICB2YXIgY29udGVudCA9IGF0dHJzWyckbWRVc2VyVGVtcGxhdGUnXSA9IGVsZW1lbnQuY2xvbmUoKTtcclxuICAgICAgICByZXR1cm4gTURfQ0hJUFNfVEVNUExBVEU7XHJcbiAgICAgIH0sXHJcbiAgICAgIHJlcXVpcmU6IFsnbWRDaGlwcyddLFxyXG4gICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICBjb250cm9sbGVyOiAnTWRDaGlwc0N0cmwnLFxyXG4gICAgICBjb250cm9sbGVyQXM6ICckbWRDaGlwc0N0cmwnLFxyXG4gICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxyXG4gICAgICBjb21waWxlOiBjb21waWxlLFxyXG4gICAgICBzY29wZToge1xyXG4gICAgICAgIHJlYWRvbmx5OiAnPXJlYWRvbmx5JyxcclxuICAgICAgICBwbGFjZWhvbGRlcjogJ0AnLFxyXG4gICAgICAgIHNlY29uZGFyeVBsYWNlaG9sZGVyOiAnQCcsXHJcbiAgICAgICAgbWRPbkFwcGVuZDogJyYnLFxyXG4gICAgICAgIGRlbGV0ZUhpbnQ6ICdAJyxcclxuICAgICAgICBkZWxldGVCdXR0b25MYWJlbDogJ0AnLFxyXG4gICAgICAgIHJlcXVpcmVNYXRjaDogJz0/bWRSZXF1aXJlTWF0Y2gnXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCdWlsZHMgdGhlIGZpbmFsIHRlbXBsYXRlIGZvciBgbWQtY2hpcHNgIGFuZCByZXR1cm5zIHRoZSBwb3N0TGluayBmdW5jdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBCdWlsZGluZyB0aGUgdGVtcGxhdGUgaW52b2x2ZXMgMyBrZXkgY29tcG9uZW50czpcclxuICAgICAqIHN0YXRpYyBjaGlwc1xyXG4gICAgICogY2hpcCB0ZW1wbGF0ZVxyXG4gICAgICogaW5wdXQgY29udHJvbFxyXG4gICAgICpcclxuICAgICAqIElmIG5vIGBuZy1tb2RlbGAgaXMgcHJvdmlkZWQsIG9ubHkgdGhlIHN0YXRpYyBjaGlwIHdvcmsgbmVlZHMgdG8gYmUgZG9uZS5cclxuICAgICAqXHJcbiAgICAgKiBJZiBubyB1c2VyLXBhc3NlZCBgbWQtY2hpcC10ZW1wbGF0ZWAgZXhpc3RzLCB0aGUgZGVmYXVsdCB0ZW1wbGF0ZSBpcyB1c2VkLiBUaGlzIHJlc3VsdGluZ1xyXG4gICAgICogdGVtcGxhdGUgaXMgYXBwZW5kZWQgdG8gdGhlIGNoaXAgY29udGVudCBlbGVtZW50LlxyXG4gICAgICpcclxuICAgICAqIFRoZSByZW1vdmUgYnV0dG9uIG1heSBiZSBvdmVycmlkZGVuIGJ5IHBhc3NpbmcgYW4gZWxlbWVudCB3aXRoIGFuIG1kLWNoaXAtcmVtb3ZlIGF0dHJpYnV0ZS5cclxuICAgICAqXHJcbiAgICAgKiBJZiBhbiBgaW5wdXRgIG9yIGBtZC1hdXRvY29tcGxldGVgIGVsZW1lbnQgaXMgcHJvdmlkZWQgYnkgdGhlIGNhbGxlciwgaXQgaXMgc2V0IGFzaWRlIGZvclxyXG4gICAgICogdHJhbnNjbHVzaW9uIGxhdGVyLiBUaGUgdHJhbnNjbHVzaW9uIGhhcHBlbnMgaW4gYHBvc3RMaW5rYCBhcyB0aGUgcGFyZW50IHNjb3BlIGlzIHJlcXVpcmVkLlxyXG4gICAgICogSWYgbm8gdXNlciBpbnB1dCBpcyBwcm92aWRlZCwgYSBkZWZhdWx0IG9uZSBpcyBhcHBlbmRlZCB0byB0aGUgaW5wdXQgY29udGFpbmVyIG5vZGUgaW4gdGhlXHJcbiAgICAgKiB0ZW1wbGF0ZS5cclxuICAgICAqXHJcbiAgICAgKiBTdGF0aWMgQ2hpcHMgKGkuZS4gYG1kLWNoaXBgIGVsZW1lbnRzIHBhc3NlZCBmcm9tIHRoZSBjYWxsZXIpIGFyZSBnYXRoZXJlZCBhbmQgc2V0IGFzaWRlIGZvclxyXG4gICAgICogdHJhbnNjbHVzaW9uIGluIHRoZSBgcG9zdExpbmtgIGZ1bmN0aW9uLlxyXG4gICAgICpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZWxlbWVudFxyXG4gICAgICogQHBhcmFtIGF0dHJcclxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY29tcGlsZShlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAgIC8vIEdyYWIgdGhlIHVzZXIgdGVtcGxhdGUgZnJvbSBhdHRyIGFuZCByZXNldCB0aGUgYXR0cmlidXRlIHRvIG51bGwuXHJcbiAgICAgIHZhciB1c2VyVGVtcGxhdGUgPSBhdHRyWyckbWRVc2VyVGVtcGxhdGUnXTtcclxuICAgICAgYXR0clsnJG1kVXNlclRlbXBsYXRlJ10gPSBudWxsO1xyXG5cclxuICAgICAgLy8gU2V0IHRoZSBjaGlwIHJlbW92ZSwgY2hpcCBjb250ZW50cyBhbmQgY2hpcCBpbnB1dCB0ZW1wbGF0ZXMuIFRoZSBsaW5rIGZ1bmN0aW9uIHdpbGwgcHV0XHJcbiAgICAgIC8vIHRoZW0gb24gdGhlIHNjb3BlIGZvciB0cmFuc2NsdXNpb24gbGF0ZXIuXHJcbiAgICAgIHZhciBjaGlwUmVtb3ZlVGVtcGxhdGUgICA9IGdldFRlbXBsYXRlQnlRdWVyeSgnbWQtY2hpcHM+KlttZC1jaGlwLXJlbW92ZV0nKSB8fCBDSElQX1JFTU9WRV9URU1QTEFURSxcclxuICAgICAgICAgIGNoaXBDb250ZW50c1RlbXBsYXRlID0gZ2V0VGVtcGxhdGVCeVF1ZXJ5KCdtZC1jaGlwcz5tZC1jaGlwLXRlbXBsYXRlJykgfHwgQ0hJUF9ERUZBVUxUX1RFTVBMQVRFLFxyXG4gICAgICAgICAgY2hpcElucHV0VGVtcGxhdGUgICAgPSBnZXRUZW1wbGF0ZUJ5UXVlcnkoJ21kLWNoaXBzPm1kLWF1dG9jb21wbGV0ZScpXHJcbiAgICAgICAgICAgICAgfHwgZ2V0VGVtcGxhdGVCeVF1ZXJ5KCdtZC1jaGlwcz5pbnB1dCcpXHJcbiAgICAgICAgICAgICAgfHwgQ0hJUF9JTlBVVF9URU1QTEFURSxcclxuICAgICAgICAgIHN0YXRpY0NoaXBzID0gdXNlclRlbXBsYXRlLmZpbmQoJ21kLWNoaXAnKTtcclxuXHJcbiAgICAgIC8vIFdhcm4gb2YgbWFsZm9ybWVkIHRlbXBsYXRlLiBTZWUgIzI1NDVcclxuICAgICAgaWYgKHVzZXJUZW1wbGF0ZVswXS5xdWVyeVNlbGVjdG9yKCdtZC1jaGlwLXRlbXBsYXRlPipbbWQtY2hpcC1yZW1vdmVdJykpIHtcclxuICAgICAgICAkbG9nLndhcm4oJ2ludmFsaWQgcGxhY2VtZW50IG9mIG1kLWNoaXAtcmVtb3ZlIHdpdGhpbiBtZC1jaGlwLXRlbXBsYXRlLicpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmdW5jdGlvbiBnZXRUZW1wbGF0ZUJ5UXVlcnkgKHF1ZXJ5KSB7XHJcbiAgICAgICAgaWYgKCFhdHRyLm5nTW9kZWwpIHJldHVybjtcclxuICAgICAgICB2YXIgZWxlbWVudCA9IHVzZXJUZW1wbGF0ZVswXS5xdWVyeVNlbGVjdG9yKHF1ZXJ5KTtcclxuICAgICAgICByZXR1cm4gZWxlbWVudCAmJiBlbGVtZW50Lm91dGVySFRNTDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLyoqXHJcbiAgICAgICAqIENvbmZpZ3VyZXMgY29udHJvbGxlciBhbmQgdHJhbnNjbHVkZXMuXHJcbiAgICAgICAqL1xyXG4gICAgICByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVycykge1xyXG5cclxuICAgICAgICAkbWRVdGlsLmluaXRPcHRpb25hbFByb3BlcnRpZXMoc2NvcGUsIGF0dHIpO1xyXG5cclxuICAgICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG4gICAgICAgIHZhciBtZENoaXBzQ3RybCA9IGNvbnRyb2xsZXJzWzBdO1xyXG4gICAgICAgIG1kQ2hpcHNDdHJsLmNoaXBDb250ZW50c1RlbXBsYXRlID0gY2hpcENvbnRlbnRzVGVtcGxhdGU7XHJcbiAgICAgICAgbWRDaGlwc0N0cmwuY2hpcFJlbW92ZVRlbXBsYXRlICAgPSBjaGlwUmVtb3ZlVGVtcGxhdGU7XHJcbiAgICAgICAgbWRDaGlwc0N0cmwuY2hpcElucHV0VGVtcGxhdGUgICAgPSBjaGlwSW5wdXRUZW1wbGF0ZTtcclxuXHJcbiAgICAgICAgZWxlbWVudFxyXG4gICAgICAgICAgICAuYXR0cih7IGFyaWFIaWRkZW46IHRydWUsIHRhYmluZGV4OiAtMSB9KVxyXG4gICAgICAgICAgICAub24oJ2ZvY3VzJywgZnVuY3Rpb24gKCkgeyBtZENoaXBzQ3RybC5vbkZvY3VzKCk7IH0pO1xyXG5cclxuICAgICAgICBpZiAoYXR0ci5uZ01vZGVsKSB7XHJcbiAgICAgICAgICBtZENoaXBzQ3RybC5jb25maWd1cmVOZ01vZGVsKGVsZW1lbnQuY29udHJvbGxlcignbmdNb2RlbCcpKTtcclxuXHJcbiAgICAgICAgICAvLyBJZiBhbiBgbWQtb24tYXBwZW5kYCBhdHRyaWJ1dGUgd2FzIHNldCwgdGVsbCB0aGUgY29udHJvbGxlciB0byB1c2UgdGhlIGV4cHJlc3Npb25cclxuICAgICAgICAgIC8vIHdoZW4gYXBwZW5kaW5nIGNoaXBzLlxyXG4gICAgICAgICAgaWYgKGF0dHJzLm1kT25BcHBlbmQpIG1kQ2hpcHNDdHJsLnVzZU1kT25BcHBlbmRFeHByZXNzaW9uKCk7XHJcblxyXG4gICAgICAgICAgLy8gVGhlIG1kLWF1dG9jb21wbGV0ZSBhbmQgaW5wdXQgZWxlbWVudHMgd29uJ3QgYmUgY29tcGlsZWQgdW50aWwgYWZ0ZXIgdGhpcyBkaXJlY3RpdmVcclxuICAgICAgICAgIC8vIGlzIGNvbXBsZXRlIChkdWUgdG8gdGhlaXIgbmVzdGVkIG5hdHVyZSkuIFdhaXQgYSB0aWNrIGJlZm9yZSBsb29raW5nIGZvciB0aGVtIHRvXHJcbiAgICAgICAgICAvLyBjb25maWd1cmUgdGhlIGNvbnRyb2xsZXIuXHJcbiAgICAgICAgICBpZiAoY2hpcElucHV0VGVtcGxhdGUgIT0gQ0hJUF9JTlBVVF9URU1QTEFURSkge1xyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICBpZiAoY2hpcElucHV0VGVtcGxhdGUuaW5kZXhPZignPG1kLWF1dG9jb21wbGV0ZScpID09PSAwKVxyXG4gICAgICAgICAgICAgICAgbWRDaGlwc0N0cmxcclxuICAgICAgICAgICAgICAgICAgICAuY29uZmlndXJlQXV0b2NvbXBsZXRlKGVsZW1lbnQuZmluZCgnbWQtYXV0b2NvbXBsZXRlJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbnRyb2xsZXIoJ21kQXV0b2NvbXBsZXRlJykpO1xyXG4gICAgICAgICAgICAgIG1kQ2hpcHNDdHJsLmNvbmZpZ3VyZVVzZXJJbnB1dChlbGVtZW50LmZpbmQoJ2lucHV0JykpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENvbXBpbGUgd2l0aCB0aGUgcGFyZW50J3Mgc2NvcGUgYW5kIHByZXBlbmQgYW55IHN0YXRpYyBjaGlwcyB0byB0aGUgd3JhcHBlci5cclxuICAgICAgICBpZiAoc3RhdGljQ2hpcHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgdmFyIGNvbXBpbGVkU3RhdGljQ2hpcHMgPSAkY29tcGlsZShzdGF0aWNDaGlwcykoc2NvcGUuJHBhcmVudCk7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHsgZWxlbWVudC5maW5kKCdtZC1jaGlwcy13cmFwJykucHJlcGVuZChjb21waWxlZFN0YXRpY0NoaXBzKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH1cclxuICBNZENoaXBzLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCIsIFwiJG1kVXRpbFwiLCBcIiRjb21waWxlXCIsIFwiJGxvZ1wiLCBcIiR0aW1lb3V0XCJdO1xyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwcycpXHJcbiAgICAuY29udHJvbGxlcignTWRDb250YWN0Q2hpcHNDdHJsJywgTWRDb250YWN0Q2hpcHNDdHJsKTtcclxuXHJcblxyXG5cclxuLyoqXHJcbiAqIENvbnRyb2xsZXIgZm9yIHRoZSBNZENvbnRhY3RDaGlwcyBjb21wb25lbnRcclxuICogQGNvbnN0cnVjdG9yXHJcbiAqL1xyXG5mdW5jdGlvbiBNZENvbnRhY3RDaGlwc0N0cmwgKCkge1xyXG4gIC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xyXG4gIHRoaXMuc2VsZWN0ZWRJdGVtID0gbnVsbDtcclxuXHJcbiAgLyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcbiAgdGhpcy5zZWFyY2hUZXh0ID0gJyc7XHJcbn1cclxuXHJcblxyXG5NZENvbnRhY3RDaGlwc0N0cmwucHJvdG90eXBlLnF1ZXJ5Q29udGFjdCA9IGZ1bmN0aW9uKHNlYXJjaFRleHQpIHtcclxuICB2YXIgcmVzdWx0cyA9IHRoaXMuY29udGFjdFF1ZXJ5KHsnJHF1ZXJ5Jzogc2VhcmNoVGV4dH0pO1xyXG4gIHJldHVybiB0aGlzLmZpbHRlclNlbGVjdGVkID9cclxuICAgICAgcmVzdWx0cy5maWx0ZXIoYW5ndWxhci5iaW5kKHRoaXMsIHRoaXMuZmlsdGVyU2VsZWN0ZWRDb250YWN0cykpIDogcmVzdWx0cztcclxufTtcclxuXHJcblxyXG5NZENvbnRhY3RDaGlwc0N0cmwucHJvdG90eXBlLmZpbHRlclNlbGVjdGVkQ29udGFjdHMgPSBmdW5jdGlvbihjb250YWN0KSB7XHJcbiAgcmV0dXJuIHRoaXMuY29udGFjdHMuaW5kZXhPZihjb250YWN0KSA9PSAtMTtcclxufTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgYW5ndWxhclxyXG4gICAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLmNoaXBzJylcclxuICAgICAgLmRpcmVjdGl2ZSgnbWRDb250YWN0Q2hpcHMnLCBNZENvbnRhY3RDaGlwcyk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEBuZ2RvYyBkaXJlY3RpdmVcclxuICAgKiBAbmFtZSBtZENvbnRhY3RDaGlwc1xyXG4gICAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy5jaGlwc1xyXG4gICAqXHJcbiAgICogQGRlc2NyaXB0aW9uXHJcbiAgICogYDxtZC1jb250YWN0LWNoaXBzPmAgaXMgYW4gaW5wdXQgY29tcG9uZW50IGJhc2VkIG9uIGBtZC1jaGlwc2AgYW5kIG1ha2VzIHVzZSBvZiBhblxyXG4gICAqICAgIGBtZC1hdXRvY29tcGxldGVgIGVsZW1lbnQuIFRoZSBjb21wb25lbnQgYWxsb3dzIHRoZSBjYWxsZXIgdG8gc3VwcGx5IGEgcXVlcnkgZXhwcmVzc2lvblxyXG4gICAqICAgIHdoaWNoIHJldHVybnMgIGEgbGlzdCBvZiBwb3NzaWJsZSBjb250YWN0cy4gVGhlIHVzZXIgY2FuIHNlbGVjdCBvbmUgb2YgdGhlc2UgYW5kIGFkZCBpdCB0b1xyXG4gICAqICAgIHRoZSBsaXN0IG9mIGNoaXBzLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtzdHJpbmc9fG9iamVjdD19IG5nLW1vZGVsIEEgbW9kZWwgdG8gYmluZCB0aGUgbGlzdCBvZiBpdGVtcyB0b1xyXG4gICAqIEBwYXJhbSB7c3RyaW5nPX0gcGxhY2Vob2xkZXIgUGxhY2Vob2xkZXIgdGV4dCB0aGF0IHdpbGwgYmUgZm9yd2FyZGVkIHRvIHRoZSBpbnB1dC5cclxuICAgKiBAcGFyYW0ge3N0cmluZz19IHNlY29uZGFyeS1wbGFjZWhvbGRlciBQbGFjZWhvbGRlciB0ZXh0IHRoYXQgd2lsbCBiZSBmb3J3YXJkZWQgdG8gdGhlIGlucHV0LFxyXG4gICAqICAgIGRpc3BsYXllZCB3aGVuIHRoZXJlIGlzIGF0IGxlYXN0IG9uIGl0ZW0gaW4gdGhlIGxpc3RcclxuICAgKiBAcGFyYW0ge2V4cHJlc3Npb259IG1kLWNvbnRhY3RzIEFuIGV4cHJlc3Npb24gZXhwZWN0ZWQgdG8gcmV0dXJuIGNvbnRhY3RzIG1hdGNoaW5nIHRoZSBzZWFyY2hcclxuICAgKiAgICB0ZXN0LCBgJHF1ZXJ5YC5cclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWQtY29udGFjdC1uYW1lIFRoZSBmaWVsZCBuYW1lIG9mIHRoZSBjb250YWN0IG9iamVjdCByZXByZXNlbnRpbmcgdGhlXHJcbiAgICogICAgY29udGFjdCdzIG5hbWUuXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1kLWNvbnRhY3QtZW1haWwgVGhlIGZpZWxkIG5hbWUgb2YgdGhlIGNvbnRhY3Qgb2JqZWN0IHJlcHJlc2VudGluZyB0aGVcclxuICAgKiAgICBjb250YWN0J3MgZW1haWwgYWRkcmVzcy5cclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWQtY29udGFjdC1pbWFnZSBUaGUgZmllbGQgbmFtZSBvZiB0aGUgY29udGFjdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZVxyXG4gICAqICAgIGNvbnRhY3QncyBpbWFnZS5cclxuICAgKlxyXG4gICAqXHJcbiAgICogLy8gVGhlIGZvbGxvd2luZyBhdHRyaWJ1dGUgaGFzIGJlZW4gcmVtb3ZlZCBidXQgbWF5IGNvbWUgYmFjay5cclxuICAgKiBAcGFyYW0ge2V4cHJlc3Npb249fSBmaWx0ZXItc2VsZWN0ZWQgV2hldGhlciB0byBmaWx0ZXIgc2VsZWN0ZWQgY29udGFjdHMgZnJvbSB0aGUgbGlzdCBvZlxyXG4gICAqICAgIHN1Z2dlc3Rpb25zIHNob3duIGluIHRoZSBhdXRvY29tcGxldGUuXHJcbiAgICpcclxuICAgKlxyXG4gICAqXHJcbiAgICogQHVzYWdlXHJcbiAgICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICAgKiAgIDxtZC1jb250YWN0LWNoaXBzXHJcbiAgICogICAgICAgbmctbW9kZWw9XCJjdHJsLmNvbnRhY3RzXCJcclxuICAgKiAgICAgICBtZC1jb250YWN0cz1cImN0cmwucXVlcnlTZWFyY2goJHF1ZXJ5KVwiXHJcbiAgICogICAgICAgbWQtY29udGFjdC1uYW1lPVwibmFtZVwiXHJcbiAgICogICAgICAgbWQtY29udGFjdC1pbWFnZT1cImltYWdlXCJcclxuICAgKiAgICAgICBtZC1jb250YWN0LWVtYWlsPVwiZW1haWxcIlxyXG4gICAqICAgICAgIHBsYWNlaG9sZGVyPVwiVG9cIj5cclxuICAgKiAgIDwvbWQtY29udGFjdC1jaGlwcz5cclxuICAgKiA8L2hsanM+XHJcbiAgICpcclxuICAgKi9cclxuXHJcblxyXG4gIHZhciBNRF9DT05UQUNUX0NISVBTX1RFTVBMQVRFID0gJ1xcXHJcbiAgICAgIDxtZC1jaGlwcyBjbGFzcz1cIm1kLWNvbnRhY3QtY2hpcHNcIlxcXHJcbiAgICAgICAgICBuZy1tb2RlbD1cIiRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdHNcIlxcXHJcbiAgICAgICAgICBtZC1yZXF1aXJlLW1hdGNoPVwiJG1kQ29udGFjdENoaXBzQ3RybC5yZXF1aXJlTWF0Y2hcIlxcXHJcbiAgICAgICAgICBtZC1hdXRvY29tcGxldGUtc25hcD5cXFxyXG4gICAgICAgICAgPG1kLWF1dG9jb21wbGV0ZVxcXHJcbiAgICAgICAgICAgICAgbWQtbWVudS1jbGFzcz1cIm1kLWNvbnRhY3QtY2hpcHMtc3VnZ2VzdGlvbnNcIlxcXHJcbiAgICAgICAgICAgICAgbWQtc2VsZWN0ZWQtaXRlbT1cIiRtZENvbnRhY3RDaGlwc0N0cmwuc2VsZWN0ZWRJdGVtXCJcXFxyXG4gICAgICAgICAgICAgIG1kLXNlYXJjaC10ZXh0PVwiJG1kQ29udGFjdENoaXBzQ3RybC5zZWFyY2hUZXh0XCJcXFxyXG4gICAgICAgICAgICAgIG1kLWl0ZW1zPVwiaXRlbSBpbiAkbWRDb250YWN0Q2hpcHNDdHJsLnF1ZXJ5Q29udGFjdCgkbWRDb250YWN0Q2hpcHNDdHJsLnNlYXJjaFRleHQpXCJcXFxyXG4gICAgICAgICAgICAgIG1kLWl0ZW0tdGV4dD1cIiRtZENvbnRhY3RDaGlwc0N0cmwubWRDb250YWN0TmFtZVwiXFxcclxuICAgICAgICAgICAgICBtZC1uby1jYWNoZT1cInRydWVcIlxcXHJcbiAgICAgICAgICAgICAgbWQtYXV0b3NlbGVjdFxcXHJcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ7eyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdHMubGVuZ3RoID09IDAgP1xcXHJcbiAgICAgICAgICAgICAgICAgICRtZENvbnRhY3RDaGlwc0N0cmwucGxhY2Vob2xkZXIgOiAkbWRDb250YWN0Q2hpcHNDdHJsLnNlY29uZGFyeVBsYWNlaG9sZGVyfX1cIj5cXFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWQtY29udGFjdC1zdWdnZXN0aW9uXCI+XFxcclxuICAgICAgICAgICAgICA8aW1nIFxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLXNyYz1cInt7aXRlbVskbWRDb250YWN0Q2hpcHNDdHJsLmNvbnRhY3RJbWFnZV19fVwiXFxcclxuICAgICAgICAgICAgICAgICAgYWx0PVwie3tpdGVtWyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdE5hbWVdfX1cIiAvPlxcXHJcbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtZC1jb250YWN0LW5hbWVcIiBtZC1oaWdobGlnaHQtdGV4dD1cIiRtZENvbnRhY3RDaGlwc0N0cmwuc2VhcmNoVGV4dFwiPlxcXHJcbiAgICAgICAgICAgICAgICB7e2l0ZW1bJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0TmFtZV19fVxcXHJcbiAgICAgICAgICAgICAgPC9zcGFuPlxcXHJcbiAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtZC1jb250YWN0LWVtYWlsXCIgPnt7aXRlbVskbWRDb250YWN0Q2hpcHNDdHJsLmNvbnRhY3RFbWFpbF19fTwvc3Bhbj5cXFxyXG4gICAgICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgICAgPC9tZC1hdXRvY29tcGxldGU+XFxcclxuICAgICAgICAgIDxtZC1jaGlwLXRlbXBsYXRlPlxcXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1jb250YWN0LWF2YXRhclwiPlxcXHJcbiAgICAgICAgICAgICAgPGltZyBcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1zcmM9XCJ7eyRjaGlwWyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdEltYWdlXX19XCJcXFxyXG4gICAgICAgICAgICAgICAgICBhbHQ9XCJ7eyRjaGlwWyRtZENvbnRhY3RDaGlwc0N0cmwuY29udGFjdE5hbWVdfX1cIiAvPlxcXHJcbiAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZC1jb250YWN0LW5hbWVcIj5cXFxyXG4gICAgICAgICAgICAgIHt7JGNoaXBbJG1kQ29udGFjdENoaXBzQ3RybC5jb250YWN0TmFtZV19fVxcXHJcbiAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICA8L21kLWNoaXAtdGVtcGxhdGU+XFxcclxuICAgICAgPC9tZC1jaGlwcz4nO1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogTURDb250YWN0Q2hpcHMgRGlyZWN0aXZlIERlZmluaXRpb25cclxuICAgKlxyXG4gICAqIEBwYXJhbSAkbWRUaGVtaW5nXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICogQG5nSW5qZWN0XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gTWRDb250YWN0Q2hpcHMgKCRtZFRoZW1pbmcsICRtZFV0aWwpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRlbXBsYXRlOiBmdW5jdGlvbihlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgIHJldHVybiBNRF9DT05UQUNUX0NISVBTX1RFTVBMQVRFO1xyXG4gICAgICB9LFxyXG4gICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICBjb250cm9sbGVyOiAnTWRDb250YWN0Q2hpcHNDdHJsJyxcclxuICAgICAgY29udHJvbGxlckFzOiAnJG1kQ29udGFjdENoaXBzQ3RybCcsXHJcbiAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXHJcbiAgICAgIGNvbXBpbGU6IGNvbXBpbGUsXHJcbiAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgY29udGFjdFF1ZXJ5OiAnJm1kQ29udGFjdHMnLFxyXG4gICAgICAgIHBsYWNlaG9sZGVyOiAnQCcsXHJcbiAgICAgICAgc2Vjb25kYXJ5UGxhY2Vob2xkZXI6ICdAJyxcclxuICAgICAgICBjb250YWN0TmFtZTogJ0BtZENvbnRhY3ROYW1lJyxcclxuICAgICAgICBjb250YWN0SW1hZ2U6ICdAbWRDb250YWN0SW1hZ2UnLFxyXG4gICAgICAgIGNvbnRhY3RFbWFpbDogJ0BtZENvbnRhY3RFbWFpbCcsXHJcbiAgICAgICAgY29udGFjdHM6ICc9bmdNb2RlbCcsXHJcbiAgICAgICAgcmVxdWlyZU1hdGNoOiAnPT9tZFJlcXVpcmVNYXRjaCdcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb21waWxlKGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY29udHJvbGxlcnMpIHtcclxuXHJcbiAgICAgICAgJG1kVXRpbC5pbml0T3B0aW9uYWxQcm9wZXJ0aWVzKHNjb3BlLCBhdHRyKTtcclxuICAgICAgICAkbWRUaGVtaW5nKGVsZW1lbnQpO1xyXG5cclxuICAgICAgICBlbGVtZW50LmF0dHIoJ3RhYmluZGV4JywgJy0xJyk7XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG4gIE1kQ29udGFjdENoaXBzLiRpbmplY3QgPSBbXCIkbWRUaGVtaW5nXCIsIFwiJG1kVXRpbFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qKlxyXG4gKiBAbmdkb2MgZGlyZWN0aXZlXHJcbiAqIEBuYW1lIG1kVGFiXHJcbiAqIEBtb2R1bGUgbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzXHJcbiAqXHJcbiAqIEByZXN0cmljdCBFXHJcbiAqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBVc2UgdGhlIGA8bWQtdGFiPmAgYSBuZXN0ZWQgZGlyZWN0aXZlIHVzZWQgd2l0aGluIGA8bWQtdGFicz5gIHRvIHNwZWNpZnkgYSB0YWIgd2l0aCBhICoqbGFiZWwqKiBhbmQgb3B0aW9uYWwgKnZpZXcgY29udGVudCouXHJcbiAqXHJcbiAqIElmIHRoZSBgbGFiZWxgIGF0dHJpYnV0ZSBpcyBub3Qgc3BlY2lmaWVkLCB0aGVuIGFuIG9wdGlvbmFsIGA8bWQtdGFiLWxhYmVsPmAgdGFnIGNhbiBiZSB1c2VkIHRvIHNwZWNpZnkgbW9yZVxyXG4gKiBjb21wbGV4IHRhYiBoZWFkZXIgbWFya3VwLiBJZiBuZWl0aGVyIHRoZSAqKmxhYmVsKiogbm9yIHRoZSAqKm1kLXRhYi1sYWJlbCoqIGFyZSBzcGVjaWZpZWQsIHRoZW4gdGhlIG5lc3RlZFxyXG4gKiBtYXJrdXAgb2YgdGhlIGA8bWQtdGFiPmAgaXMgdXNlZCBhcyB0aGUgdGFiIGhlYWRlciBtYXJrdXAuXHJcbiAqXHJcbiAqIFBsZWFzZSBub3RlIHRoYXQgaWYgeW91IHVzZSBgPG1kLXRhYi1sYWJlbD5gLCB5b3VyIGNvbnRlbnQgKipNVVNUKiogYmUgd3JhcHBlZCBpbiB0aGUgYDxtZC10YWItYm9keT5gIHRhZy4gIFRoaXNcclxuICogaXMgdG8gZGVmaW5lIGEgY2xlYXIgc2VwYXJhdGlvbiBiZXR3ZWVuIHRoZSB0YWIgY29udGVudCBhbmQgdGhlIHRhYiBsYWJlbC5cclxuICpcclxuICogSWYgYSB0YWIgKipsYWJlbCoqIGhhcyBiZWVuIGlkZW50aWZpZWQsIHRoZW4gYW55ICoqbm9uLSoqYDxtZC10YWItbGFiZWw+YCBtYXJrdXBcclxuICogd2lsbCBiZSBjb25zaWRlcmVkIHRhYiBjb250ZW50IGFuZCB3aWxsIGJlIHRyYW5zY2x1ZGVkIHRvIHRoZSBpbnRlcm5hbCBgPGRpdiBjbGFzcz1cIm1kLXRhYnMtY29udGVudFwiPmAgY29udGFpbmVyLlxyXG4gKlxyXG4gKiBUaGlzIGNvbnRhaW5lciBpcyB1c2VkIGJ5IHRoZSBUYWJzQ29udHJvbGxlciB0byBzaG93L2hpZGUgdGhlIGFjdGl2ZSB0YWIncyBjb250ZW50IHZpZXcuIFRoaXMgc3luY2hyb25pemF0aW9uIGlzXHJcbiAqIGF1dG9tYXRpY2FsbHkgbWFuYWdlZCBieSB0aGUgaW50ZXJuYWwgVGFic0NvbnRyb2xsZXIgd2hlbmV2ZXIgdGhlIHRhYiBzZWxlY3Rpb24gY2hhbmdlcy4gU2VsZWN0aW9uIGNoYW5nZXMgY2FuXHJcbiAqIGJlIGluaXRpYXRlZCB2aWEgZGF0YSBiaW5kaW5nIGNoYW5nZXMsIHByb2dyYW1tYXRpYyBpbnZvY2F0aW9uLCBvciB1c2VyIGdlc3R1cmVzLlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZz19IGxhYmVsIE9wdGlvbmFsIGF0dHJpYnV0ZSB0byBzcGVjaWZ5IGEgc2ltcGxlIHN0cmluZyBhcyB0aGUgdGFiIGxhYmVsXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IGRpc2FibGVkIElmIHByZXNlbnQsIGRpc2FibGVkIHRhYiBzZWxlY3Rpb24uXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLW9uLWRlc2VsZWN0IEV4cHJlc3Npb24gdG8gYmUgZXZhbHVhdGVkIGFmdGVyIHRoZSB0YWIgaGFzIGJlZW4gZGUtc2VsZWN0ZWQuXHJcbiAqIEBwYXJhbSB7ZXhwcmVzc2lvbj19IG1kLW9uLXNlbGVjdCBFeHByZXNzaW9uIHRvIGJlIGV2YWx1YXRlZCBhZnRlciB0aGUgdGFiIGhhcyBiZWVuIHNlbGVjdGVkLlxyXG4gKlxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICpcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXRhYiBsYWJlbD1cIlwiIGRpc2FibGVkPVwiXCIgbWQtb24tc2VsZWN0PVwiXCIgbWQtb24tZGVzZWxlY3Q9XCJcIiA+XHJcbiAqICAgPGgzPk15IFRhYiBjb250ZW50PC9oMz5cclxuICogPC9tZC10YWI+XHJcbiAqXHJcbiAqIDxtZC10YWIgPlxyXG4gKiAgIDxtZC10YWItbGFiZWw+XHJcbiAqICAgICA8aDM+TXkgVGFiIGNvbnRlbnQ8L2gzPlxyXG4gKiAgIDwvbWQtdGFiLWxhYmVsPlxyXG4gKiAgIDxtZC10YWItYm9keT5cclxuICogICAgIDxwPlxyXG4gKiAgICAgICBTZWQgdXQgcGVyc3BpY2lhdGlzIHVuZGUgb21uaXMgaXN0ZSBuYXR1cyBlcnJvciBzaXQgdm9sdXB0YXRlbSBhY2N1c2FudGl1bSBkb2xvcmVtcXVlIGxhdWRhbnRpdW0sXHJcbiAqICAgICAgIHRvdGFtIHJlbSBhcGVyaWFtLCBlYXF1ZSBpcHNhIHF1YWUgYWIgaWxsbyBpbnZlbnRvcmUgdmVyaXRhdGlzIGV0IHF1YXNpIGFyY2hpdGVjdG8gYmVhdGFlIHZpdGFlXHJcbiAqICAgICAgIGRpY3RhIHN1bnQgZXhwbGljYWJvLiBOZW1vIGVuaW0gaXBzYW0gdm9sdXB0YXRlbSBxdWlhIHZvbHVwdGFzIHNpdCBhc3Blcm5hdHVyIGF1dCBvZGl0IGF1dCBmdWdpdCxcclxuICogICAgICAgc2VkIHF1aWEgY29uc2VxdXVudHVyIG1hZ25pIGRvbG9yZXMgZW9zIHF1aSByYXRpb25lIHZvbHVwdGF0ZW0gc2VxdWkgbmVzY2l1bnQuXHJcbiAqICAgICA8L3A+XHJcbiAqICAgPC9tZC10YWItYm9keT5cclxuICogPC9tZC10YWI+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZFRhYicsIE1kVGFiKTtcclxuXHJcbmZ1bmN0aW9uIE1kVGFiICgpIHtcclxuICByZXR1cm4ge1xyXG4gICAgcmVxdWlyZTogJ14/bWRUYWJzJyxcclxuICAgIHRlcm1pbmFsOiB0cnVlLFxyXG4gICAgdGVtcGxhdGU6IGZ1bmN0aW9uIChlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAgIHZhciBsYWJlbCA9IGdldExhYmVsKCksXHJcbiAgICAgICAgICBib2R5ICA9IGdldFRlbXBsYXRlKCk7XHJcbiAgICAgIHJldHVybiAnJyArXHJcbiAgICAgICAgICAnPG1kLXRhYi1sYWJlbD4nICsgbGFiZWwgKyAnPC9tZC10YWItbGFiZWw+JyArXHJcbiAgICAgICAgICAnPG1kLXRhYi1ib2R5PicgKyBib2R5ICsgJzwvbWQtdGFiLWJvZHk+JztcclxuICAgICAgZnVuY3Rpb24gZ2V0TGFiZWwgKCkge1xyXG4gICAgICAgIHJldHVybiBnZXRMYWJlbEVsZW1lbnQoKSB8fCBnZXRMYWJlbEF0dHJpYnV0ZSgpIHx8IGdldEVsZW1lbnRDb250ZW50cygpO1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldExhYmVsQXR0cmlidXRlICgpIHsgcmV0dXJuIGF0dHIubGFiZWw7IH1cclxuICAgICAgICBmdW5jdGlvbiBnZXRMYWJlbEVsZW1lbnQgKCkge1xyXG4gICAgICAgICAgdmFyIGxhYmVsID0gZWxlbWVudC5maW5kKCdtZC10YWItbGFiZWwnKS5lcSgwKTtcclxuICAgICAgICAgIGlmIChsYWJlbC5sZW5ndGgpIHJldHVybiBsYWJlbC5yZW1vdmUoKS5odG1sKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGdldEVsZW1lbnRDb250ZW50cyAoKSB7XHJcbiAgICAgICAgICB2YXIgaHRtbCA9IGVsZW1lbnQuaHRtbCgpO1xyXG4gICAgICAgICAgZWxlbWVudC5lbXB0eSgpO1xyXG4gICAgICAgICAgcmV0dXJuIGh0bWw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGZ1bmN0aW9uIGdldFRlbXBsYXRlICgpIHtcclxuICAgICAgICB2YXIgY29udGVudCA9IGVsZW1lbnQuZmluZCgnbWQtdGFiLWJvZHknKS5lcSgwKSxcclxuICAgICAgICAgICAgdGVtcGxhdGUgPSBjb250ZW50Lmxlbmd0aCA/IGNvbnRlbnQuaHRtbCgpIDogYXR0ci5sYWJlbCA/IGVsZW1lbnQuaHRtbCgpIDogJyc7XHJcbiAgICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoKSBjb250ZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIGVsc2UgaWYgKGF0dHIubGFiZWwpIGVsZW1lbnQuZW1wdHkoKTtcclxuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzY29wZToge1xyXG4gICAgICBhY3RpdmU6ICAgJz0/bWRBY3RpdmUnLFxyXG4gICAgICBkaXNhYmxlZDogJz0/bmdEaXNhYmxlZCcsXHJcbiAgICAgIHNlbGVjdDogICAnJj9tZE9uU2VsZWN0JyxcclxuICAgICAgZGVzZWxlY3Q6ICcmP21kT25EZXNlbGVjdCdcclxuICAgIH0sXHJcbiAgICBsaW5rOiBwb3N0TGlua1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHBvc3RMaW5rIChzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xyXG4gICAgaWYgKCFjdHJsKSByZXR1cm47XHJcbiAgICB2YXIgdGFicyA9IGVsZW1lbnQucGFyZW50KClbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYicpLFxyXG4gICAgICAgIGluZGV4ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0YWJzLCBlbGVtZW50WzBdKSxcclxuICAgICAgICBib2R5ID0gZWxlbWVudC5maW5kKCdtZC10YWItYm9keScpLmVxKDApLnJlbW92ZSgpLFxyXG4gICAgICAgIGxhYmVsID0gZWxlbWVudC5maW5kKCdtZC10YWItbGFiZWwnKS5lcSgwKS5yZW1vdmUoKSxcclxuICAgICAgICBkYXRhID0gY3RybC5pbnNlcnRUYWIoe1xyXG4gICAgICAgICAgc2NvcGU6ICAgIHNjb3BlLFxyXG4gICAgICAgICAgcGFyZW50OiAgIHNjb3BlLiRwYXJlbnQsXHJcbiAgICAgICAgICBpbmRleDogICAgaW5kZXgsXHJcbiAgICAgICAgICBlbGVtZW50OiAgZWxlbWVudCxcclxuICAgICAgICAgIHRlbXBsYXRlOiBib2R5Lmh0bWwoKSxcclxuICAgICAgICAgIGxhYmVsOiAgICBsYWJlbC5odG1sKClcclxuICAgICAgICB9LCBpbmRleCk7XHJcblxyXG4gICAgc2NvcGUuc2VsZWN0ICAgPSBzY29wZS5zZWxlY3QgICB8fCBhbmd1bGFyLm5vb3A7XHJcbiAgICBzY29wZS5kZXNlbGVjdCA9IHNjb3BlLmRlc2VsZWN0IHx8IGFuZ3VsYXIubm9vcDtcclxuXHJcbiAgICBzY29wZS4kd2F0Y2goJ2FjdGl2ZScsIGZ1bmN0aW9uIChhY3RpdmUpIHsgaWYgKGFjdGl2ZSkgY3RybC5zZWxlY3QoZGF0YS5nZXRJbmRleCgpKTsgfSk7XHJcbiAgICBzY29wZS4kd2F0Y2goJ2Rpc2FibGVkJywgZnVuY3Rpb24gKCkgeyBjdHJsLnJlZnJlc2hJbmRleCgpOyB9KTtcclxuICAgIHNjb3BlLiR3YXRjaChcclxuICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbCh0YWJzLCBlbGVtZW50WzBdKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZ1bmN0aW9uIChuZXdJbmRleCkge1xyXG4gICAgICAgICAgZGF0YS5pbmRleCA9IG5ld0luZGV4O1xyXG4gICAgICAgICAgY3RybC51cGRhdGVUYWJPcmRlcigpO1xyXG4gICAgICAgIH1cclxuICAgICk7XHJcbiAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkgeyBjdHJsLnJlbW92ZVRhYihkYXRhKTsgfSk7XHJcblxyXG4gIH1cclxufVxyXG5cclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7XHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWF0ZXJpYWwuY29tcG9uZW50cy50YWJzJylcclxuICAgIC5kaXJlY3RpdmUoJ21kVGFiSXRlbScsIE1kVGFiSXRlbSk7XHJcblxyXG5mdW5jdGlvbiBNZFRhYkl0ZW0gKCkge1xyXG4gIHJldHVybiB7XHJcbiAgICByZXF1aXJlOiAnXj9tZFRhYnMnLFxyXG4gICAgbGluazogZnVuY3Rpb24gbGluayAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIGN0cmwpIHtcclxuICAgICAgaWYgKCFjdHJsKSByZXR1cm47XHJcbiAgICAgIGN0cmwuYXR0YWNoUmlwcGxlKHNjb3BlLCBlbGVtZW50KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRUYWJMYWJlbCcsIE1kVGFiTGFiZWwpO1xyXG5cclxuZnVuY3Rpb24gTWRUYWJMYWJlbCAoKSB7XHJcbiAgcmV0dXJuIHsgdGVybWluYWw6IHRydWUgfTtcclxufVxyXG5cclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRUYWJTY3JvbGwnLCBNZFRhYlNjcm9sbCk7XHJcblxyXG5mdW5jdGlvbiBNZFRhYlNjcm9sbCAoJHBhcnNlKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICBjb21waWxlOiBmdW5jdGlvbiAoJGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgdmFyIGZuID0gJHBhcnNlKGF0dHIubWRUYWJTY3JvbGwsIG51bGwsIHRydWUpO1xyXG4gICAgICByZXR1cm4gZnVuY3Rpb24gbmdFdmVudEhhbmRsZXIgKHNjb3BlLCBlbGVtZW50KSB7XHJcbiAgICAgICAgZWxlbWVudC5vbignbW91c2V3aGVlbCcsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHsgZm4oc2NvcGUsIHsgJGV2ZW50OiBldmVudCB9KTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbk1kVGFiU2Nyb2xsLiRpbmplY3QgPSBbXCIkcGFyc2VcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ01kVGFic0NvbnRyb2xsZXInLCBNZFRhYnNDb250cm9sbGVyKTtcclxuXHJcbi8qKlxyXG4gKiBAbmdJbmplY3RcclxuICovXHJcbmZ1bmN0aW9uIE1kVGFic0NvbnRyb2xsZXIgKCRzY29wZSwgJGVsZW1lbnQsICR3aW5kb3csICR0aW1lb3V0LCAkbWRDb25zdGFudCwgJG1kVGFiSW5rUmlwcGxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAkbWRVdGlsLCAkYW5pbWF0ZSwgJGF0dHJzLCAkY29tcGlsZSwgJG1kVGhlbWluZykge1xyXG4gIC8vLS0gZGVmaW5lIHByaXZhdGUgcHJvcGVydGllc1xyXG4gIHZhciBjdHJsICAgICAgID0gdGhpcyxcclxuICAgICAgbG9ja2VkICAgICA9IGZhbHNlLFxyXG4gICAgICBlbGVtZW50cyAgID0gZ2V0RWxlbWVudHMoKSxcclxuICAgICAgcXVldWUgICAgICA9IFtdLFxyXG4gICAgICBkZXN0cm95ZWQgID0gZmFsc2UsXHJcbiAgICAgIGxvYWRlZCAgICAgPSBmYWxzZTtcclxuXHJcbiAgLy8tLSBkZWZpbmUgcHVibGljIHByb3BlcnRpZXMgd2l0aCBjaGFuZ2UgaGFuZGxlcnNcclxuICBkZWZpbmVQcm9wZXJ0eSgnZm9jdXNJbmRleCcsIGhhbmRsZUZvY3VzSW5kZXhDaGFuZ2UsICRzY29wZS5zZWxlY3RlZEluZGV4IHx8IDApO1xyXG4gIGRlZmluZVByb3BlcnR5KCdvZmZzZXRMZWZ0JywgaGFuZGxlT2Zmc2V0Q2hhbmdlLCAwKTtcclxuICBkZWZpbmVQcm9wZXJ0eSgnaGFzQ29udGVudCcsIGhhbmRsZUhhc0NvbnRlbnQsIGZhbHNlKTtcclxuXHJcbiAgLy8tLSBkZWZpbmUgcHVibGljIHByb3BlcnRpZXNcclxuICBjdHJsLnNjb3BlID0gJHNjb3BlO1xyXG4gIGN0cmwucGFyZW50ID0gJHNjb3BlLiRwYXJlbnQ7XHJcbiAgY3RybC50YWJzID0gW107XHJcbiAgY3RybC5sYXN0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcbiAgY3RybC5oYXNGb2N1cyA9IGZhbHNlO1xyXG4gIGN0cmwubGFzdENsaWNrID0gdHJ1ZTtcclxuICBjdHJsLnNob3VsZFBhZ2luYXRlID0gZmFsc2U7XHJcbiAgY3RybC5zaG91bGRDZW50ZXJUYWJzID0gc2hvdWxkQ2VudGVyVGFicygpO1xyXG5cclxuICAvLy0tIGRlZmluZSBwdWJsaWMgbWV0aG9kc1xyXG4gIGN0cmwucmVkaXJlY3RGb2N1cyA9IHJlZGlyZWN0Rm9jdXM7XHJcbiAgY3RybC5hdHRhY2hSaXBwbGUgPSBhdHRhY2hSaXBwbGU7XHJcbiAgY3RybC5zaG91bGRTdHJldGNoVGFicyA9IHNob3VsZFN0cmV0Y2hUYWJzO1xyXG4gIGN0cmwuaW5zZXJ0VGFiID0gaW5zZXJ0VGFiO1xyXG4gIGN0cmwucmVtb3ZlVGFiID0gcmVtb3ZlVGFiO1xyXG4gIGN0cmwuc2VsZWN0ID0gc2VsZWN0O1xyXG4gIGN0cmwuc2Nyb2xsID0gc2Nyb2xsO1xyXG4gIGN0cmwubmV4dFBhZ2UgPSBuZXh0UGFnZTtcclxuICBjdHJsLnByZXZpb3VzUGFnZSA9IHByZXZpb3VzUGFnZTtcclxuICBjdHJsLmtleWRvd24gPSBrZXlkb3duO1xyXG4gIGN0cmwuY2FuUGFnZUZvcndhcmQgPSBjYW5QYWdlRm9yd2FyZDtcclxuICBjdHJsLmNhblBhZ2VCYWNrID0gY2FuUGFnZUJhY2s7XHJcbiAgY3RybC5yZWZyZXNoSW5kZXggPSByZWZyZXNoSW5kZXg7XHJcbiAgY3RybC5pbmNyZW1lbnRTZWxlY3RlZEluZGV4ID0gaW5jcmVtZW50U2VsZWN0ZWRJbmRleDtcclxuICBjdHJsLnVwZGF0ZUlua0JhclN0eWxlcyA9ICRtZFV0aWwuZGVib3VuY2UodXBkYXRlSW5rQmFyU3R5bGVzLCAxMDApO1xyXG4gIGN0cmwudXBkYXRlVGFiT3JkZXIgPSAkbWRVdGlsLmRlYm91bmNlKHVwZGF0ZVRhYk9yZGVyLCAxMDApO1xyXG5cclxuICBpbml0KCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFBlcmZvcm0gaW5pdGlhbGl6YXRpb24gZm9yIHRoZSBjb250cm9sbGVyLCBzZXR1cCBldmVudHMgYW5kIHdhdGNoZXIocylcclxuICAgKi9cclxuICBmdW5jdGlvbiBpbml0ICgpIHtcclxuICAgICRzY29wZS5zZWxlY3RlZEluZGV4ID0gJHNjb3BlLnNlbGVjdGVkSW5kZXggfHwgMDtcclxuICAgIGNvbXBpbGVUZW1wbGF0ZSgpO1xyXG4gICAgY29uZmlndXJlV2F0Y2hlcnMoKTtcclxuICAgIGJpbmRFdmVudHMoKTtcclxuICAgICRtZFRoZW1pbmcoJGVsZW1lbnQpO1xyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICB1cGRhdGVIZWlnaHRGcm9tQ29udGVudCgpO1xyXG4gICAgICBhZGp1c3RPZmZzZXQoKTtcclxuICAgICAgdXBkYXRlUGFnaW5hdGlvbigpO1xyXG4gICAgICBjdHJsLnRhYnNbJHNjb3BlLnNlbGVjdGVkSW5kZXhdICYmIGN0cmwudGFic1skc2NvcGUuc2VsZWN0ZWRJbmRleF0uc2NvcGUuc2VsZWN0KCk7XHJcbiAgICAgIGxvYWRlZCA9IHRydWU7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNvbXBpbGVUZW1wbGF0ZSAoKSB7XHJcbiAgICB2YXIgdGVtcGxhdGUgPSAkYXR0cnMuJG1kVGFic1RlbXBsYXRlLFxyXG4gICAgICAgIGVsZW1lbnQgID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRzLmRhdGEpO1xyXG4gICAgZWxlbWVudC5odG1sKHRlbXBsYXRlKTtcclxuICAgICRjb21waWxlKGVsZW1lbnQuY29udGVudHMoKSkoY3RybC5wYXJlbnQpO1xyXG4gICAgZGVsZXRlICRhdHRycy4kbWRUYWJzVGVtcGxhdGU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBiaW5kRXZlbnRzICgpIHtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vbigncmVzaXplJywgaGFuZGxlV2luZG93UmVzaXplKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5wYWdpbmcpLm9uKCdET01TdWJ0cmVlTW9kaWZpZWQnLCBjdHJsLnVwZGF0ZUlua0JhclN0eWxlcyk7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMucGFnaW5nKS5vbignRE9NU3VidHJlZU1vZGlmaWVkJywgdXBkYXRlUGFnaW5hdGlvbik7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjb25maWd1cmVXYXRjaGVycyAoKSB7XHJcbiAgICAkbWRVdGlsLmluaXRPcHRpb25hbFByb3BlcnRpZXMoJHNjb3BlLCAkYXR0cnMpO1xyXG4gICAgJGF0dHJzLiRvYnNlcnZlKCdtZE5vQmFyJywgZnVuY3Rpb24gKHZhbHVlKSB7ICRzY29wZS5ub0lua0JhciA9IGFuZ3VsYXIuaXNEZWZpbmVkKHZhbHVlKTsgfSk7XHJcbiAgICAkc2NvcGUuJHdhdGNoKCdzZWxlY3RlZEluZGV4JywgaGFuZGxlU2VsZWN0ZWRJbmRleENoYW5nZSk7XHJcbiAgICAkc2NvcGUuJHdhdGNoKCdkeW5hbWljSGVpZ2h0JywgZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgIGlmICh2YWx1ZSkgJGVsZW1lbnQuYWRkQ2xhc3MoJ21kLWR5bmFtaWMtaGVpZ2h0Jyk7XHJcbiAgICAgIGVsc2UgJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kLWR5bmFtaWMtaGVpZ2h0Jyk7XHJcbiAgICB9KTtcclxuICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgY2xlYW51cCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmUgYW55IGV2ZW50cyBkZWZpbmVkIGJ5IHRoaXMgY29udHJvbGxlclxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGNsZWFudXAgKCkge1xyXG4gICAgZGVzdHJveWVkID0gdHJ1ZTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KS5vZmYoJ3Jlc2l6ZScsIGhhbmRsZVdpbmRvd1Jlc2l6ZSk7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMucGFnaW5nKS5vZmYoJ0RPTVN1YnRyZWVNb2RpZmllZCcsIGN0cmwudXBkYXRlSW5rQmFyU3R5bGVzKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5wYWdpbmcpLm9mZignRE9NU3VidHJlZU1vZGlmaWVkJywgdXBkYXRlUGFnaW5hdGlvbik7XHJcbiAgfVxyXG5cclxuICAvLy0tIENoYW5nZSBoYW5kbGVyc1xyXG5cclxuICAvKipcclxuICAgKiBBZGQvcmVtb3ZlIHRoZSBgbWQtbm8tdGFiLWNvbnRlbnRgIGNsYXNzIGRlcGVuZGluZyBvbiBgY3RybC5oYXNDb250ZW50YFxyXG4gICAqIEBwYXJhbSBoYXNDb250ZW50XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlSGFzQ29udGVudCAoaGFzQ29udGVudCkge1xyXG4gICAgJGVsZW1lbnRbaGFzQ29udGVudCA/ICdyZW1vdmVDbGFzcycgOiAnYWRkQ2xhc3MnXSgnbWQtbm8tdGFiLWNvbnRlbnQnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFwcGx5IGN0cmwub2Zmc2V0TGVmdCB0byB0aGUgcGFnaW5nIGVsZW1lbnQgd2hlbiBpdCBjaGFuZ2VzXHJcbiAgICogQHBhcmFtIGxlZnRcclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVPZmZzZXRDaGFuZ2UgKGxlZnQpIHtcclxuICAgIHZhciBuZXdWYWx1ZSA9IGN0cmwuc2hvdWxkQ2VudGVyVGFicyA/ICcnIDogJy0nICsgbGVmdCArICdweCc7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMucGFnaW5nKS5jc3MoJG1kQ29uc3RhbnQuQ1NTLlRSQU5TRk9STSwgJ3RyYW5zbGF0ZTNkKCcgKyBuZXdWYWx1ZSArICcsIDAsIDApJyk7XHJcbiAgICAkc2NvcGUuJGJyb2FkY2FzdCgnJG1kVGFic1BhZ2luYXRpb25DaGFuZ2VkJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgdGhlIFVJIHdoZW5ldmVyIGBjdHJsLmZvY3VzSW5kZXhgIGlzIHVwZGF0ZWRcclxuICAgKiBAcGFyYW0gbmV3SW5kZXhcclxuICAgKiBAcGFyYW0gb2xkSW5kZXhcclxuICAgKi9cclxuICBmdW5jdGlvbiBoYW5kbGVGb2N1c0luZGV4Q2hhbmdlIChuZXdJbmRleCwgb2xkSW5kZXgpIHtcclxuICAgIGlmIChuZXdJbmRleCA9PT0gb2xkSW5kZXgpIHJldHVybjtcclxuICAgIGlmICghZWxlbWVudHMudGFic1tuZXdJbmRleF0pIHJldHVybjtcclxuICAgIGFkanVzdE9mZnNldCgpO1xyXG4gICAgcmVkaXJlY3RGb2N1cygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIHRoZSBVSSB3aGVuZXZlciB0aGUgc2VsZWN0ZWQgaW5kZXggY2hhbmdlcy4gQ2FsbHMgdXNlci1kZWZpbmVkIHNlbGVjdC9kZXNlbGVjdCBtZXRob2RzLlxyXG4gICAqIEBwYXJhbSBuZXdWYWx1ZVxyXG4gICAqIEBwYXJhbSBvbGRWYWx1ZVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGhhbmRsZVNlbGVjdGVkSW5kZXhDaGFuZ2UgKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgaWYgKG5ld1ZhbHVlID09PSBvbGRWYWx1ZSkgcmV0dXJuO1xyXG5cclxuICAgICRzY29wZS5zZWxlY3RlZEluZGV4ID0gZ2V0TmVhcmVzdFNhZmVJbmRleChuZXdWYWx1ZSk7XHJcbiAgICBjdHJsLmxhc3RTZWxlY3RlZEluZGV4ID0gb2xkVmFsdWU7XHJcbiAgICBjdHJsLnVwZGF0ZUlua0JhclN0eWxlcygpO1xyXG4gICAgdXBkYXRlSGVpZ2h0RnJvbUNvbnRlbnQoKTtcclxuICAgIGFkanVzdE9mZnNldChuZXdWYWx1ZSk7XHJcbiAgICAkc2NvcGUuJGJyb2FkY2FzdCgnJG1kVGFic0NoYW5nZWQnKTtcclxuICAgIGN0cmwudGFic1tvbGRWYWx1ZV0gJiYgY3RybC50YWJzW29sZFZhbHVlXS5zY29wZS5kZXNlbGVjdCgpO1xyXG4gICAgY3RybC50YWJzW25ld1ZhbHVlXSAmJiBjdHJsLnRhYnNbbmV3VmFsdWVdLnNjb3BlLnNlbGVjdCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUXVldWVzIHVwIGEgY2FsbCB0byBgaGFuZGxlV2luZG93UmVzaXplYCB3aGVuIGEgcmVzaXplIG9jY3VycyB3aGlsZSB0aGUgdGFicyBjb21wb25lbnQgaXNcclxuICAgKiBoaWRkZW4uXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlUmVzaXplV2hlblZpc2libGUgKCkge1xyXG4gICAgLy8tLSBpZiB0aGVyZSBpcyBhbHJlYWR5IGEgd2F0Y2hlciB3YWl0aW5nIGZvciByZXNpemUsIGRvIG5vdGhpbmdcclxuICAgIGlmIChoYW5kbGVSZXNpemVXaGVuVmlzaWJsZS53YXRjaGVyKSByZXR1cm47XHJcbiAgICAvLy0tIG90aGVyd2lzZSwgd2Ugd2lsbCBhYnVzZSB0aGUgJHdhdGNoIGZ1bmN0aW9uIHRvIGNoZWNrIGZvciB2aXNpYmxlXHJcbiAgICBoYW5kbGVSZXNpemVXaGVuVmlzaWJsZS53YXRjaGVyID0gJHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIC8vLS0gc2luY2Ugd2UgYXJlIGNoZWNraW5nIGZvciBET00gc2l6ZSwgd2UgdXNlICR0aW1lb3V0IHRvIHdhaXQgZm9yIGFmdGVyIHRoZSBET00gdXBkYXRlc1xyXG4gICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8tLSBpZiB0aGUgd2F0Y2hlciBoYXMgYWxyZWFkeSBydW4gKGllLiBtdWx0aXBsZSBkaWdlc3RzIGluIG9uZSBjeWNsZSksIGRvIG5vdGhpbmdcclxuICAgICAgICBpZiAoIWhhbmRsZVJlc2l6ZVdoZW5WaXNpYmxlLndhdGNoZXIpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYgKCRlbGVtZW50LnByb3AoJ29mZnNldFBhcmVudCcpKSB7XHJcbiAgICAgICAgICBoYW5kbGVSZXNpemVXaGVuVmlzaWJsZS53YXRjaGVyKCk7XHJcbiAgICAgICAgICBoYW5kbGVSZXNpemVXaGVuVmlzaWJsZS53YXRjaGVyID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAvLy0tIHdlIGhhdmUgdG8gdHJpZ2dlciBvdXIgb3duICRhcHBseSBzbyB0aGF0IHRoZSBET00gYmluZGluZ3Mgd2lsbCB1cGRhdGVcclxuICAgICAgICAgIGhhbmRsZVdpbmRvd1Jlc2l6ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgMCwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLy0tIEV2ZW50IGhhbmRsZXJzIC8gYWN0aW9uc1xyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgdXNlciBrZXlib2FyZCBpbnRlcmFjdGlvbnNcclxuICAgKiBAcGFyYW0gZXZlbnRcclxuICAgKi9cclxuICBmdW5jdGlvbiBrZXlkb3duIChldmVudCkge1xyXG4gICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XHJcbiAgICAgIGNhc2UgJG1kQ29uc3RhbnQuS0VZX0NPREUuTEVGVF9BUlJPVzpcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGluY3JlbWVudFNlbGVjdGVkSW5kZXgoLTEsIHRydWUpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICRtZENvbnN0YW50LktFWV9DT0RFLlJJR0hUX0FSUk9XOlxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaW5jcmVtZW50U2VsZWN0ZWRJbmRleCgxLCB0cnVlKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5TUEFDRTpcclxuICAgICAgY2FzZSAkbWRDb25zdGFudC5LRVlfQ09ERS5FTlRFUjpcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGlmICghbG9ja2VkKSAkc2NvcGUuc2VsZWN0ZWRJbmRleCA9IGN0cmwuZm9jdXNJbmRleDtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIGN0cmwubGFzdENsaWNrID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgdGhlIHNlbGVjdGVkIGluZGV4IGFuZCB0cmlnZ2VyIGEgY2xpY2sgZXZlbnQgb24gdGhlIG9yaWdpbmFsIGBtZC10YWJgIGVsZW1lbnQgaW4gb3JkZXJcclxuICAgKiB0byBmaXJlIHVzZXItYWRkZWQgY2xpY2sgZXZlbnRzLlxyXG4gICAqIEBwYXJhbSBpbmRleFxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHNlbGVjdCAoaW5kZXgpIHtcclxuICAgIGlmICghbG9ja2VkKSBjdHJsLmZvY3VzSW5kZXggPSAkc2NvcGUuc2VsZWN0ZWRJbmRleCA9IGluZGV4O1xyXG4gICAgY3RybC5sYXN0Q2xpY2sgPSB0cnVlO1xyXG4gICAgY3RybC50YWJzW2luZGV4XS5lbGVtZW50LnRyaWdnZXJIYW5kbGVyKCdjbGljaycpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogV2hlbiBwYWdpbmF0aW9uIGlzIG9uLCB0aGlzIG1ha2VzIHN1cmUgdGhlIHNlbGVjdGVkIGluZGV4IGlzIGluIHZpZXcuXHJcbiAgICogQHBhcmFtIGV2ZW50XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gc2Nyb2xsIChldmVudCkge1xyXG4gICAgaWYgKCFjdHJsLnNob3VsZFBhZ2luYXRlKSByZXR1cm47XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY3RybC5vZmZzZXRMZWZ0ID0gZml4T2Zmc2V0KGN0cmwub2Zmc2V0TGVmdCAtIGV2ZW50LndoZWVsRGVsdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2xpZGVzIHRoZSB0YWJzIG92ZXIgYXBwcm94aW1hdGVseSBvbmUgcGFnZSBmb3J3YXJkLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIG5leHRQYWdlICgpIHtcclxuICAgIHZhciB2aWV3cG9ydFdpZHRoID0gZWxlbWVudHMuY2FudmFzLmNsaWVudFdpZHRoLFxyXG4gICAgICAgIHRvdGFsV2lkdGggPSB2aWV3cG9ydFdpZHRoICsgY3RybC5vZmZzZXRMZWZ0LFxyXG4gICAgICAgIGksIHRhYjtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBlbGVtZW50cy50YWJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHRhYiA9IGVsZW1lbnRzLnRhYnNbaV07XHJcbiAgICAgIGlmICh0YWIub2Zmc2V0TGVmdCArIHRhYi5vZmZzZXRXaWR0aCA+IHRvdGFsV2lkdGgpIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgY3RybC5vZmZzZXRMZWZ0ID0gZml4T2Zmc2V0KHRhYi5vZmZzZXRMZWZ0KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNsaWRlcyB0aGUgdGFicyBvdmVyIGFwcHJveGltYXRlbHkgb25lIHBhZ2UgYmFja3dhcmQuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcHJldmlvdXNQYWdlICgpIHtcclxuICAgIHZhciBpLCB0YWI7XHJcbiAgICBmb3IgKGkgPSAwOyBpIDwgZWxlbWVudHMudGFicy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB0YWIgPSBlbGVtZW50cy50YWJzW2ldO1xyXG4gICAgICBpZiAodGFiLm9mZnNldExlZnQgKyB0YWIub2Zmc2V0V2lkdGggPj0gY3RybC5vZmZzZXRMZWZ0KSBicmVhaztcclxuICAgIH1cclxuICAgIGN0cmwub2Zmc2V0TGVmdCA9IGZpeE9mZnNldCh0YWIub2Zmc2V0TGVmdCArIHRhYi5vZmZzZXRXaWR0aCAtIGVsZW1lbnRzLmNhbnZhcy5jbGllbnRXaWR0aCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgc2l6ZSBjYWxjdWxhdGlvbnMgd2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWQuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGFuZGxlV2luZG93UmVzaXplICgpIHtcclxuICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICBjdHJsLmxhc3RTZWxlY3RlZEluZGV4ID0gJHNjb3BlLnNlbGVjdGVkSW5kZXg7XHJcbiAgICAgIGN0cmwub2Zmc2V0TGVmdCA9IGZpeE9mZnNldChjdHJsLm9mZnNldExlZnQpO1xyXG4gICAgICAkdGltZW91dChjdHJsLnVwZGF0ZUlua0JhclN0eWxlcywgMCwgZmFsc2UpO1xyXG4gICAgICAkdGltZW91dCh1cGRhdGVQYWdpbmF0aW9uKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlIGEgdGFiIGZyb20gdGhlIGRhdGEgYW5kIHNlbGVjdCB0aGUgbmVhcmVzdCB2YWxpZCB0YWIuXHJcbiAgICogQHBhcmFtIHRhYkRhdGFcclxuICAgKi9cclxuICBmdW5jdGlvbiByZW1vdmVUYWIgKHRhYkRhdGEpIHtcclxuICAgIHZhciBzZWxlY3RlZEluZGV4ID0gJHNjb3BlLnNlbGVjdGVkSW5kZXgsXHJcbiAgICAgICAgdGFiID0gY3RybC50YWJzLnNwbGljZSh0YWJEYXRhLmdldEluZGV4KCksIDEpWzBdO1xyXG4gICAgcmVmcmVzaEluZGV4KCk7XHJcbiAgICAvLy0tIHdoZW4gcmVtb3ZpbmcgYSB0YWIsIGlmIHRoZSBzZWxlY3RlZCBpbmRleCBkaWQgbm90IGNoYW5nZSwgd2UgaGF2ZSB0byBtYW51YWxseSB0cmlnZ2VyIHRoZVxyXG4gICAgLy8gICB0YWIgc2VsZWN0L2Rlc2VsZWN0IGV2ZW50c1xyXG4gICAgaWYgKCRzY29wZS5zZWxlY3RlZEluZGV4ID09PSBzZWxlY3RlZEluZGV4ICYmICFkZXN0cm95ZWQpIHtcclxuICAgICAgdGFiLnNjb3BlLmRlc2VsZWN0KCk7XHJcbiAgICAgIGN0cmwudGFic1skc2NvcGUuc2VsZWN0ZWRJbmRleF0gJiYgY3RybC50YWJzWyRzY29wZS5zZWxlY3RlZEluZGV4XS5zY29wZS5zZWxlY3QoKTtcclxuICAgIH1cclxuICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgdXBkYXRlUGFnaW5hdGlvbigpO1xyXG4gICAgICBjdHJsLm9mZnNldExlZnQgPSBmaXhPZmZzZXQoY3RybC5vZmZzZXRMZWZ0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIGFuIGVudHJ5IGluIHRoZSB0YWJzIGFycmF5IGZvciBhIG5ldyB0YWIgYXQgdGhlIHNwZWNpZmllZCBpbmRleC5cclxuICAgKiBAcGFyYW0gdGFiRGF0YVxyXG4gICAqIEBwYXJhbSBpbmRleFxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGluc2VydFRhYiAodGFiRGF0YSwgaW5kZXgpIHtcclxuICAgIHZhciBwcm90byA9IHtcclxuICAgICAgICAgIGdldEluZGV4OiBmdW5jdGlvbiAoKSB7IHJldHVybiBjdHJsLnRhYnMuaW5kZXhPZih0YWIpOyB9LFxyXG4gICAgICAgICAgaXNBY3RpdmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZ2V0SW5kZXgoKSA9PT0gJHNjb3BlLnNlbGVjdGVkSW5kZXg7IH0sXHJcbiAgICAgICAgICBpc0xlZnQ6ICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5nZXRJbmRleCgpIDwgJHNjb3BlLnNlbGVjdGVkSW5kZXg7IH0sXHJcbiAgICAgICAgICBpc1JpZ2h0OiAgZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5nZXRJbmRleCgpID4gJHNjb3BlLnNlbGVjdGVkSW5kZXg7IH0sXHJcbiAgICAgICAgICBzaG91bGRSZW5kZXI6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICEkc2NvcGUubm9EaXNjb25uZWN0IHx8IHRoaXMuaXNBY3RpdmUoKTsgfSxcclxuICAgICAgICAgIGhhc0ZvY3VzOiBmdW5jdGlvbiAoKSB7IHJldHVybiAhY3RybC5sYXN0Q2xpY2tcclxuICAgICAgICAgICAgICAmJiBjdHJsLmhhc0ZvY3VzICYmIHRoaXMuZ2V0SW5kZXgoKSA9PT0gY3RybC5mb2N1c0luZGV4OyB9LFxyXG4gICAgICAgICAgaWQ6ICAgICAgICRtZFV0aWwubmV4dFVpZCgpXHJcbiAgICAgICAgfSxcclxuICAgICAgICB0YWIgPSBhbmd1bGFyLmV4dGVuZChwcm90bywgdGFiRGF0YSk7XHJcbiAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoaW5kZXgpKSB7XHJcbiAgICAgIGN0cmwudGFicy5zcGxpY2UoaW5kZXgsIDAsIHRhYik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjdHJsLnRhYnMucHVzaCh0YWIpO1xyXG4gICAgfVxyXG4gICAgcHJvY2Vzc1F1ZXVlKCk7XHJcbiAgICB1cGRhdGVIYXNDb250ZW50KCk7XHJcbiAgICAvLy0tIGlmIGF1dG9zZWxlY3QgaXMgZW5hYmxlZCwgc2VsZWN0IHRoZSBuZXdseSBhZGRlZCB0YWJcclxuICAgIGlmIChsb2FkZWQgJiYgJHNjb3BlLmF1dG9zZWxlY3QpICR0aW1lb3V0KGZ1bmN0aW9uICgpIHsgc2VsZWN0KGN0cmwudGFicy5pbmRleE9mKHRhYikpOyB9KTtcclxuICAgICR0aW1lb3V0KHVwZGF0ZVBhZ2luYXRpb24pO1xyXG4gICAgcmV0dXJuIHRhYjtcclxuICB9XHJcblxyXG4gIC8vLS0gR2V0dGVyIG1ldGhvZHNcclxuXHJcbiAgLyoqXHJcbiAgICogR2F0aGVycyByZWZlcmVuY2VzIHRvIGFsbCBvZiB0aGUgRE9NIGVsZW1lbnRzIHVzZWQgYnkgdGhpcyBjb250cm9sbGVyLlxyXG4gICAqIEByZXR1cm5zIHt7fX1cclxuICAgKi9cclxuICBmdW5jdGlvbiBnZXRFbGVtZW50cyAoKSB7XHJcbiAgICB2YXIgZWxlbWVudHMgICAgICA9IHt9O1xyXG5cclxuICAgIC8vLS0gZ2F0aGVyIHRhYiBiYXIgZWxlbWVudHNcclxuICAgIGVsZW1lbnRzLndyYXBwZXIgID0gJGVsZW1lbnRbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYnMtd3JhcHBlcicpWzBdO1xyXG4gICAgZWxlbWVudHMuZGF0YSAgICAgPSAkZWxlbWVudFswXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtdGFiLWRhdGEnKVswXTtcclxuICAgIGVsZW1lbnRzLmNhbnZhcyAgID0gZWxlbWVudHMud3JhcHBlci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtdGFicy1jYW52YXMnKVswXTtcclxuICAgIGVsZW1lbnRzLnBhZ2luZyAgID0gZWxlbWVudHMuY2FudmFzLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC1wYWdpbmF0aW9uLXdyYXBwZXInKVswXTtcclxuICAgIGVsZW1lbnRzLnRhYnMgICAgID0gZWxlbWVudHMucGFnaW5nLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdtZC10YWItaXRlbScpO1xyXG4gICAgZWxlbWVudHMuZHVtbWllcyAgPSBlbGVtZW50cy5jYW52YXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLWR1bW15LXRhYicpO1xyXG4gICAgZWxlbWVudHMuaW5rQmFyICAgPSBlbGVtZW50cy5wYWdpbmcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLWluay1iYXInKVswXTtcclxuXHJcbiAgICAvLy0tIGdhdGhlciB0YWIgY29udGVudCBlbGVtZW50c1xyXG4gICAgZWxlbWVudHMuY29udGVudHNXcmFwcGVyID0gJGVsZW1lbnRbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ21kLXRhYnMtY29udGVudC13cmFwcGVyJylbMF07XHJcbiAgICBlbGVtZW50cy5jb250ZW50cyA9IGVsZW1lbnRzLmNvbnRlbnRzV3JhcHBlci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnbWQtdGFiLWNvbnRlbnQnKTtcclxuXHJcbiAgICByZXR1cm4gZWxlbWVudHM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgb3Igbm90IHRoZSBsZWZ0IHBhZ2luYXRpb24gYXJyb3cgc2hvdWxkIGJlIGVuYWJsZWQuXHJcbiAgICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY2FuUGFnZUJhY2sgKCkge1xyXG4gICAgcmV0dXJuIGN0cmwub2Zmc2V0TGVmdCA+IDA7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgb3Igbm90IHRoZSByaWdodCBwYWdpbmF0aW9uIGFycm93IHNob3VsZCBiZSBlbmFibGVkLlxyXG4gICAqIEByZXR1cm5zIHsqfGJvb2xlYW59XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gY2FuUGFnZUZvcndhcmQgKCkge1xyXG4gICAgdmFyIGxhc3RUYWIgPSBlbGVtZW50cy50YWJzW2VsZW1lbnRzLnRhYnMubGVuZ3RoIC0gMV07XHJcbiAgICByZXR1cm4gbGFzdFRhYiAmJiBsYXN0VGFiLm9mZnNldExlZnQgKyBsYXN0VGFiLm9mZnNldFdpZHRoID4gZWxlbWVudHMuY2FudmFzLmNsaWVudFdpZHRoICtcclxuICAgICAgICBjdHJsLm9mZnNldExlZnQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBVSSBzaG91bGQgc3RyZXRjaCB0aGUgdGFicyB0byBmaWxsIHRoZSBhdmFpbGFibGUgc3BhY2UuXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gc2hvdWxkU3RyZXRjaFRhYnMgKCkge1xyXG4gICAgc3dpdGNoICgkc2NvcGUuc3RyZXRjaFRhYnMpIHtcclxuICAgICAgY2FzZSAnYWx3YXlzJzogcmV0dXJuIHRydWU7XHJcbiAgICAgIGNhc2UgJ25ldmVyJzogIHJldHVybiBmYWxzZTtcclxuICAgICAgZGVmYXVsdDogICAgICAgcmV0dXJuICFjdHJsLnNob3VsZFBhZ2luYXRlXHJcbiAgICAgICAgICAmJiAkd2luZG93Lm1hdGNoTWVkaWEoJyhtYXgtd2lkdGg6IDYwMHB4KScpLm1hdGNoZXM7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSB0YWJzIHNob3VsZCBhcHBlYXIgY2VudGVyZWQuXHJcbiAgICogQHJldHVybnMge3N0cmluZ3xib29sZWFufVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHNob3VsZENlbnRlclRhYnMgKCkge1xyXG4gICAgcmV0dXJuICRzY29wZS5jZW50ZXJUYWJzICYmICFjdHJsLnNob3VsZFBhZ2luYXRlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGV0ZXJtaW5lcyBpZiBwYWdpbmF0aW9uIGlzIG5lY2Vzc2FyeSB0byBkaXNwbGF5IHRoZSB0YWJzIHdpdGhpbiB0aGUgYXZhaWxhYmxlIHNwYWNlLlxyXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHNob3VsZFBhZ2luYXRlICgpIHtcclxuICAgIGlmICgkc2NvcGUubm9QYWdpbmF0aW9uIHx8ICFsb2FkZWQpIHJldHVybiBmYWxzZTtcclxuICAgIHZhciBjYW52YXNXaWR0aCA9ICRlbGVtZW50LnByb3AoJ2NsaWVudFdpZHRoJyk7XHJcbiAgICBhbmd1bGFyLmZvckVhY2goZWxlbWVudHMuZHVtbWllcywgZnVuY3Rpb24gKHRhYikgeyBjYW52YXNXaWR0aCAtPSB0YWIub2Zmc2V0V2lkdGg7IH0pO1xyXG4gICAgcmV0dXJuIGNhbnZhc1dpZHRoIDwgMDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZpbmRzIHRoZSBuZWFyZXN0IHRhYiBpbmRleCB0aGF0IGlzIGF2YWlsYWJsZS4gIFRoaXMgaXMgcHJpbWFyaWx5IHVzZWQgZm9yIHdoZW4gdGhlIGFjdGl2ZVxyXG4gICAqIHRhYiBpcyByZW1vdmVkLlxyXG4gICAqIEBwYXJhbSBuZXdJbmRleFxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGdldE5lYXJlc3RTYWZlSW5kZXgobmV3SW5kZXgpIHtcclxuICAgIHZhciBtYXhPZmZzZXQgPSBNYXRoLm1heChjdHJsLnRhYnMubGVuZ3RoIC0gbmV3SW5kZXgsIG5ld0luZGV4KSxcclxuICAgICAgICBpLCB0YWI7XHJcbiAgICBmb3IgKGkgPSAwOyBpIDw9IG1heE9mZnNldDsgaSsrKSB7XHJcbiAgICAgIHRhYiA9IGN0cmwudGFic1tuZXdJbmRleCArIGldO1xyXG4gICAgICBpZiAodGFiICYmICh0YWIuc2NvcGUuZGlzYWJsZWQgIT09IHRydWUpKSByZXR1cm4gdGFiLmdldEluZGV4KCk7XHJcbiAgICAgIHRhYiA9IGN0cmwudGFic1tuZXdJbmRleCAtIGldO1xyXG4gICAgICBpZiAodGFiICYmICh0YWIuc2NvcGUuZGlzYWJsZWQgIT09IHRydWUpKSByZXR1cm4gdGFiLmdldEluZGV4KCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3SW5kZXg7XHJcbiAgfVxyXG5cclxuICAvLy0tIFV0aWxpdHkgbWV0aG9kc1xyXG5cclxuICAvKipcclxuICAgKiBEZWZpbmVzIGEgcHJvcGVydHkgdXNpbmcgYSBnZXR0ZXIgYW5kIHNldHRlciBpbiBvcmRlciB0byB0cmlnZ2VyIGEgY2hhbmdlIGhhbmRsZXIgd2l0aG91dFxyXG4gICAqIHVzaW5nIGAkd2F0Y2hgIHRvIG9ic2VydmUgY2hhbmdlcy5cclxuICAgKiBAcGFyYW0ga2V5XHJcbiAgICogQHBhcmFtIGhhbmRsZXJcclxuICAgKiBAcGFyYW0gdmFsdWVcclxuICAgKi9cclxuICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eSAoa2V5LCBoYW5kbGVyLCB2YWx1ZSkge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN0cmwsIGtleSwge1xyXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHZhbHVlOyB9LFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xyXG4gICAgICAgIHZhciBvbGRWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgaGFuZGxlcihuZXdWYWx1ZSwgb2xkVmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgd2hldGhlciBvciBub3QgcGFnaW5hdGlvbiBzaG91bGQgYmUgZGlzcGxheWVkLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHVwZGF0ZVBhZ2luYXRpb24gKCkge1xyXG4gICAgY3RybC5zaG91bGRQYWdpbmF0ZSA9IHNob3VsZFBhZ2luYXRlKCk7XHJcbiAgICBjdHJsLnNob3VsZENlbnRlclRhYnMgPSBzaG91bGRDZW50ZXJUYWJzKCk7XHJcbiAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGFkanVzdE9mZnNldCgkc2NvcGUuc2VsZWN0ZWRJbmRleCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlLW9yZGVycyB0aGUgdGFicyBhbmQgdXBkYXRlcyB0aGUgc2VsZWN0ZWQgYW5kIGZvY3VzIGluZGV4ZXMgdG8gdGhlaXIgbmV3IHBvc2l0aW9ucy5cclxuICAgKiBUaGlzIGlzIHRyaWdnZXJlZCBieSBgdGFiRGlyZWN0aXZlLmpzYCB3aGVuIHRoZSB1c2VyJ3MgdGFicyBoYXZlIGJlZW4gcmUtb3JkZXJlZC5cclxuICAgKi9cclxuICBmdW5jdGlvbiB1cGRhdGVUYWJPcmRlciAoKSB7XHJcbiAgICB2YXIgc2VsZWN0ZWRJdGVtID0gY3RybC50YWJzWyRzY29wZS5zZWxlY3RlZEluZGV4XSxcclxuICAgICAgICBmb2N1c0l0ZW0gPSBjdHJsLnRhYnNbY3RybC5mb2N1c0luZGV4XTtcclxuICAgIGN0cmwudGFicyA9IGN0cmwudGFicy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHJldHVybiBhLmluZGV4IC0gYi5pbmRleDtcclxuICAgIH0pO1xyXG4gICAgJHNjb3BlLnNlbGVjdGVkSW5kZXggPSBjdHJsLnRhYnMuaW5kZXhPZihzZWxlY3RlZEl0ZW0pO1xyXG4gICAgY3RybC5mb2N1c0luZGV4ID0gY3RybC50YWJzLmluZGV4T2YoZm9jdXNJdGVtKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgbW92ZXMgdGhlIHNlbGVjdGVkIG9yIGZvY3VzIGluZGV4IGxlZnQgb3IgcmlnaHQuICBUaGlzIGlzIHVzZWQgYnkgdGhlIGtleWRvd24gaGFuZGxlci5cclxuICAgKiBAcGFyYW0gaW5jXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaW5jcmVtZW50U2VsZWN0ZWRJbmRleCAoaW5jKSB7XHJcbiAgICB2YXIgbmV3SW5kZXgsXHJcbiAgICAgICAgaW5kZXggPSBjdHJsLmZvY3VzSW5kZXg7XHJcbiAgICBmb3IgKG5ld0luZGV4ID0gaW5kZXggKyBpbmM7XHJcbiAgICAgICAgIGN0cmwudGFic1tuZXdJbmRleF0gJiYgY3RybC50YWJzW25ld0luZGV4XS5zY29wZS5kaXNhYmxlZDtcclxuICAgICAgICAgbmV3SW5kZXggKz0gaW5jKSB7fVxyXG4gICAgaWYgKGN0cmwudGFic1tuZXdJbmRleF0pIHtcclxuICAgICAgY3RybC5mb2N1c0luZGV4ID0gbmV3SW5kZXg7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIGlzIHVzZWQgdG8gZm9yd2FyZCBmb2N1cyB0byBkdW1teSBlbGVtZW50cy4gIFRoaXMgbWV0aG9kIGlzIG5lY2Vzc2FyeSB0byBhdm9pZCBhbmlhdGlvblxyXG4gICAqIGlzc3VlcyB3aGVuIGF0dGVtcHRpbmcgdG8gZm9jdXMgYW4gaXRlbSB0aGF0IGlzIG91dCBvZiB2aWV3LlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHJlZGlyZWN0Rm9jdXMgKCkge1xyXG4gICAgZWxlbWVudHMuZHVtbWllc1tjdHJsLmZvY3VzSW5kZXhdLmZvY3VzKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGb3JjZXMgdGhlIHBhZ2luYXRpb24gdG8gbW92ZSB0aGUgZm9jdXNlZCB0YWIgaW50byB2aWV3LlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGFkanVzdE9mZnNldCAoaW5kZXgpIHtcclxuICAgIGlmICghZWxlbWVudHMudGFic1tpbmRleF0pIHJldHVybjtcclxuICAgIGlmIChjdHJsLnNob3VsZENlbnRlclRhYnMpIHJldHVybjtcclxuICAgIGlmIChpbmRleCA9PSBudWxsKSBpbmRleCA9IGN0cmwuZm9jdXNJbmRleDtcclxuICAgIHZhciB0YWIgPSBlbGVtZW50cy50YWJzW2luZGV4XSxcclxuICAgICAgICBsZWZ0ID0gdGFiLm9mZnNldExlZnQsXHJcbiAgICAgICAgcmlnaHQgPSB0YWIub2Zmc2V0V2lkdGggKyBsZWZ0O1xyXG4gICAgY3RybC5vZmZzZXRMZWZ0ID0gTWF0aC5tYXgoY3RybC5vZmZzZXRMZWZ0LCBmaXhPZmZzZXQocmlnaHQgLSBlbGVtZW50cy5jYW52YXMuY2xpZW50V2lkdGgpKTtcclxuICAgIGN0cmwub2Zmc2V0TGVmdCA9IE1hdGgubWluKGN0cmwub2Zmc2V0TGVmdCwgZml4T2Zmc2V0KGxlZnQpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEl0ZXJhdGVzIHRocm91Z2ggYWxsIHF1ZXVlZCBmdW5jdGlvbnMgYW5kIGNsZWFycyB0aGUgcXVldWUuICBUaGlzIGlzIHVzZWQgZm9yIGZ1bmN0aW9ucyB0aGF0XHJcbiAgICogYXJlIGNhbGxlZCBiZWZvcmUgdGhlIFVJIGlzIHJlYWR5LCBzdWNoIGFzIHNpemUgY2FsY3VsYXRpb25zLlxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIHByb2Nlc3NRdWV1ZSAoKSB7XHJcbiAgICBxdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uIChmdW5jKSB7ICR0aW1lb3V0KGZ1bmMpOyB9KTtcclxuICAgIHF1ZXVlID0gW107XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSB0YWIgY29udGVudCBhcmVhIGlzIG5lZWRlZC5cclxuICAgKi9cclxuICBmdW5jdGlvbiB1cGRhdGVIYXNDb250ZW50ICgpIHtcclxuICAgIHZhciBoYXNDb250ZW50ID0gZmFsc2U7XHJcbiAgICBhbmd1bGFyLmZvckVhY2goY3RybC50YWJzLCBmdW5jdGlvbiAodGFiKSB7XHJcbiAgICAgIGlmICh0YWIudGVtcGxhdGUpIGhhc0NvbnRlbnQgPSB0cnVlO1xyXG4gICAgfSk7XHJcbiAgICBjdHJsLmhhc0NvbnRlbnQgPSBoYXNDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTW92ZXMgdGhlIGluZGV4ZXMgdG8gdGhlaXIgbmVhcmVzdCB2YWxpZCB2YWx1ZXMuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gcmVmcmVzaEluZGV4ICgpIHtcclxuICAgICRzY29wZS5zZWxlY3RlZEluZGV4ID0gZ2V0TmVhcmVzdFNhZmVJbmRleCgkc2NvcGUuc2VsZWN0ZWRJbmRleCk7XHJcbiAgICBjdHJsLmZvY3VzSW5kZXggPSBnZXROZWFyZXN0U2FmZUluZGV4KGN0cmwuZm9jdXNJbmRleCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxjdWxhdGVzIHRoZSBjb250ZW50IGhlaWdodCBvZiB0aGUgY3VycmVudCB0YWIuXHJcbiAgICogQHJldHVybnMgeyp9XHJcbiAgICovXHJcbiAgZnVuY3Rpb24gdXBkYXRlSGVpZ2h0RnJvbUNvbnRlbnQgKCkge1xyXG4gICAgaWYgKCEkc2NvcGUuZHluYW1pY0hlaWdodCkgcmV0dXJuICRlbGVtZW50LmNzcygnaGVpZ2h0JywgJycpO1xyXG4gICAgaWYgKCFjdHJsLnRhYnMubGVuZ3RoKSByZXR1cm4gcXVldWUucHVzaCh1cGRhdGVIZWlnaHRGcm9tQ29udGVudCk7XHJcbiAgICB2YXIgdGFiQ29udGVudCAgICA9IGVsZW1lbnRzLmNvbnRlbnRzWyRzY29wZS5zZWxlY3RlZEluZGV4XSxcclxuICAgICAgICBjb250ZW50SGVpZ2h0ID0gdGFiQ29udGVudCA/IHRhYkNvbnRlbnQub2Zmc2V0SGVpZ2h0IDogMCxcclxuICAgICAgICB0YWJzSGVpZ2h0ICAgID0gZWxlbWVudHMud3JhcHBlci5vZmZzZXRIZWlnaHQsXHJcbiAgICAgICAgbmV3SGVpZ2h0ICAgICA9IGNvbnRlbnRIZWlnaHQgKyB0YWJzSGVpZ2h0LFxyXG4gICAgICAgIGN1cnJlbnRIZWlnaHQgPSAkZWxlbWVudC5wcm9wKCdjbGllbnRIZWlnaHQnKTtcclxuICAgIGlmIChjdXJyZW50SGVpZ2h0ID09PSBuZXdIZWlnaHQpIHJldHVybjtcclxuICAgIGxvY2tlZCA9IHRydWU7XHJcbiAgICAkYW5pbWF0ZVxyXG4gICAgICAgIC5hbmltYXRlKFxyXG4gICAgICAgICAgJGVsZW1lbnQsXHJcbiAgICAgICAgICB7IGhlaWdodDogY3VycmVudEhlaWdodCArICdweCcgfSxcclxuICAgICAgICAgIHsgaGVpZ2h0OiBuZXdIZWlnaHQgKyAncHgnfVxyXG4gICAgICAgIClcclxuICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAkZWxlbWVudC5jc3MoJ2hlaWdodCcsICcnKTtcclxuICAgICAgICAgIGxvY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVwb3NpdGlvbnMgdGhlIGluayBiYXIgdG8gdGhlIHNlbGVjdGVkIHRhYi5cclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKi9cclxuICBmdW5jdGlvbiB1cGRhdGVJbmtCYXJTdHlsZXMgKCkge1xyXG4gICAgaWYgKCFlbGVtZW50cy50YWJzWyRzY29wZS5zZWxlY3RlZEluZGV4XSkgcmV0dXJuO1xyXG4gICAgaWYgKCFjdHJsLnRhYnMubGVuZ3RoKSByZXR1cm4gcXVldWUucHVzaChjdHJsLnVwZGF0ZUlua0JhclN0eWxlcyk7XHJcbiAgICAvLy0tIGlmIHRoZSBlbGVtZW50IGlzIG5vdCB2aXNpYmxlLCB3ZSB3aWxsIG5vdCBiZSBhYmxlIHRvIGNhbGN1bGF0ZSBzaXplcyB1bnRpbCBpdCBpc1xyXG4gICAgLy8tLSB3ZSBzaG91bGQgdHJlYXQgdGhhdCBhcyBhIHJlc2l6ZSBldmVudCByYXRoZXIgdGhhbiBqdXN0IHVwZGF0aW5nIHRoZSBpbmsgYmFyXHJcbiAgICBpZiAoISRlbGVtZW50LnByb3AoJ29mZnNldFBhcmVudCcpKSByZXR1cm4gaGFuZGxlUmVzaXplV2hlblZpc2libGUoKTtcclxuICAgIHZhciBpbmRleCA9ICRzY29wZS5zZWxlY3RlZEluZGV4LFxyXG4gICAgICAgIHRvdGFsV2lkdGggPSBlbGVtZW50cy5wYWdpbmcub2Zmc2V0V2lkdGgsXHJcbiAgICAgICAgdGFiID0gZWxlbWVudHMudGFic1tpbmRleF0sXHJcbiAgICAgICAgbGVmdCA9IHRhYi5vZmZzZXRMZWZ0LFxyXG4gICAgICAgIHJpZ2h0ID0gdG90YWxXaWR0aCAtIGxlZnQgLSB0YWIub2Zmc2V0V2lkdGg7XHJcbiAgICB1cGRhdGVJbmtCYXJDbGFzc05hbWUoKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50cy5pbmtCYXIpLmNzcyh7IGxlZnQ6IGxlZnQgKyAncHgnLCByaWdodDogcmlnaHQgKyAncHgnIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkcyBsZWZ0L3JpZ2h0IGNsYXNzZXMgc28gdGhhdCB0aGUgaW5rIGJhciB3aWxsIGFuaW1hdGUgcHJvcGVybHkuXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gdXBkYXRlSW5rQmFyQ2xhc3NOYW1lICgpIHtcclxuICAgIHZhciBuZXdJbmRleCA9ICRzY29wZS5zZWxlY3RlZEluZGV4LFxyXG4gICAgICAgIG9sZEluZGV4ID0gY3RybC5sYXN0U2VsZWN0ZWRJbmRleCxcclxuICAgICAgICBpbmsgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMuaW5rQmFyKTtcclxuICAgIGlmICghYW5ndWxhci5pc051bWJlcihvbGRJbmRleCkpIHJldHVybjtcclxuICAgIGlmIChuZXdJbmRleCA8IG9sZEluZGV4KSB7XHJcbiAgICAgIGluay5hZGRDbGFzcygnbWQtbGVmdCcpLnJlbW92ZUNsYXNzKCdtZC1yaWdodCcpO1xyXG4gICAgfSBlbHNlIGlmIChuZXdJbmRleCA+IG9sZEluZGV4KSB7XHJcbiAgICAgIGluay5hZGRDbGFzcygnbWQtcmlnaHQnKS5yZW1vdmVDbGFzcygnbWQtbGVmdCcpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGFrZXMgYW4gb2Zmc2V0IHZhbHVlIGFuZCBtYWtlcyBzdXJlIHRoYXQgaXQgaXMgd2l0aGluIHRoZSBtaW4vbWF4IGFsbG93ZWQgdmFsdWVzLlxyXG4gICAqIEBwYXJhbSB2YWx1ZVxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIGZpeE9mZnNldCAodmFsdWUpIHtcclxuICAgIGlmICghZWxlbWVudHMudGFicy5sZW5ndGggfHwgIWN0cmwuc2hvdWxkUGFnaW5hdGUpIHJldHVybiAwO1xyXG4gICAgdmFyIGxhc3RUYWIgPSBlbGVtZW50cy50YWJzW2VsZW1lbnRzLnRhYnMubGVuZ3RoIC0gMV0sXHJcbiAgICAgICAgdG90YWxXaWR0aCA9IGxhc3RUYWIub2Zmc2V0TGVmdCArIGxhc3RUYWIub2Zmc2V0V2lkdGg7XHJcbiAgICB2YWx1ZSA9IE1hdGgubWF4KDAsIHZhbHVlKTtcclxuICAgIHZhbHVlID0gTWF0aC5taW4odG90YWxXaWR0aCAtIGVsZW1lbnRzLmNhbnZhcy5jbGllbnRXaWR0aCwgdmFsdWUpO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQXR0YWNoZXMgYSByaXBwbGUgdG8gdGhlIHRhYiBpdGVtIGVsZW1lbnQuXHJcbiAgICogQHBhcmFtIHNjb3BlXHJcbiAgICogQHBhcmFtIGVsZW1lbnRcclxuICAgKi9cclxuICBmdW5jdGlvbiBhdHRhY2hSaXBwbGUgKHNjb3BlLCBlbGVtZW50KSB7XHJcbiAgICB2YXIgb3B0aW9ucyA9IHsgY29sb3JFbGVtZW50OiBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudHMuaW5rQmFyKSB9O1xyXG4gICAgJG1kVGFiSW5rUmlwcGxlLmF0dGFjaChzY29wZSwgZWxlbWVudCwgb3B0aW9ucyk7XHJcbiAgfVxyXG59XHJcbk1kVGFic0NvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRlbGVtZW50XCIsIFwiJHdpbmRvd1wiLCBcIiR0aW1lb3V0XCIsIFwiJG1kQ29uc3RhbnRcIiwgXCIkbWRUYWJJbmtSaXBwbGVcIiwgXCIkbWRVdGlsXCIsIFwiJGFuaW1hdGVcIiwgXCIkYXR0cnNcIiwgXCIkY29tcGlsZVwiLCBcIiRtZFRoZW1pbmdcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKipcclxuICogQG5nZG9jIGRpcmVjdGl2ZVxyXG4gKiBAbmFtZSBtZFRhYnNcclxuICogQG1vZHVsZSBtYXRlcmlhbC5jb21wb25lbnRzLnRhYnNcclxuICpcclxuICogQHJlc3RyaWN0IEVcclxuICpcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoZSBgPG1kLXRhYnM+YCBkaXJlY3RpdmUgc2VydmVzIGFzIHRoZSBjb250YWluZXIgZm9yIDEuLm4gYDxtZC10YWI+YCBjaGlsZCBkaXJlY3RpdmVzIHRvIHByb2R1Y2VzIGEgVGFicyBjb21wb25lbnRzLlxyXG4gKiBJbiB0dXJuLCB0aGUgbmVzdGVkIGA8bWQtdGFiPmAgZGlyZWN0aXZlIGlzIHVzZWQgdG8gc3BlY2lmeSBhIHRhYiBsYWJlbCBmb3IgdGhlICoqaGVhZGVyIGJ1dHRvbioqIGFuZCBhIFtvcHRpb25hbF0gdGFiIHZpZXdcclxuICogY29udGVudCB0aGF0IHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRoIGVhY2ggdGFiIGJ1dHRvbi5cclxuICpcclxuICogQmVsb3cgaXMgdGhlIG1hcmt1cCBmb3IgaXRzIHNpbXBsZXN0IHVzYWdlOlxyXG4gKlxyXG4gKiAgPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogIDxtZC10YWJzPlxyXG4gKiAgICA8bWQtdGFiIGxhYmVsPVwiVGFiICMxXCI+PC9tZC10YWI+XHJcbiAqICAgIDxtZC10YWIgbGFiZWw9XCJUYWIgIzJcIj48L21kLXRhYj5cclxuICogICAgPG1kLXRhYiBsYWJlbD1cIlRhYiAjM1wiPjwvbWQtdGFiPlxyXG4gKiAgPC9tZC10YWJzPlxyXG4gKiAgPC9obGpzPlxyXG4gKlxyXG4gKiBUYWJzIHN1cHBvcnRzIHRocmVlICgzKSB1c2FnZSBzY2VuYXJpb3M6XHJcbiAqXHJcbiAqICAxLiBUYWJzIChidXR0b25zIG9ubHkpXHJcbiAqICAyLiBUYWJzIHdpdGggaW50ZXJuYWwgdmlldyBjb250ZW50XHJcbiAqICAzLiBUYWJzIHdpdGggZXh0ZXJuYWwgdmlldyBjb250ZW50XHJcbiAqXHJcbiAqICoqVGFiLW9ubHkqKiBzdXBwb3J0IGlzIHVzZWZ1bCB3aGVuIHRhYiBidXR0b25zIGFyZSB1c2VkIGZvciBjdXN0b20gbmF2aWdhdGlvbiByZWdhcmRsZXNzIG9mIGFueSBvdGhlciBjb21wb25lbnRzLCBjb250ZW50LCBvciB2aWV3cy5cclxuICogKipUYWJzIHdpdGggaW50ZXJuYWwgdmlld3MqKiBhcmUgdGhlIHRyYWRpdGlvbmFsIHVzYWdlcyB3aGVyZSBlYWNoIHRhYiBoYXMgYXNzb2NpYXRlZCB2aWV3IGNvbnRlbnQgYW5kIHRoZSB2aWV3IHN3aXRjaGluZyBpcyBtYW5hZ2VkIGludGVybmFsbHkgYnkgdGhlIFRhYnMgY29tcG9uZW50LlxyXG4gKiAqKlRhYnMgd2l0aCBleHRlcm5hbCB2aWV3IGNvbnRlbnQqKiBpcyBvZnRlbiB1c2VmdWwgd2hlbiBjb250ZW50IGFzc29jaWF0ZWQgd2l0aCBlYWNoIHRhYiBpcyBpbmRlcGVuZGVudGx5IG1hbmFnZWQgYW5kIGRhdGEtYmluZGluZyBub3RpZmljYXRpb25zIGFubm91bmNlIHRhYiBzZWxlY3Rpb24gY2hhbmdlcy5cclxuICpcclxuICogQWRkaXRpb25hbCBmZWF0dXJlcyBhbHNvIGluY2x1ZGU6XHJcbiAqXHJcbiAqICogIENvbnRlbnQgY2FuIGluY2x1ZGUgYW55IG1hcmt1cC5cclxuICogKiAgSWYgYSB0YWIgaXMgZGlzYWJsZWQgd2hpbGUgYWN0aXZlL3NlbGVjdGVkLCB0aGVuIHRoZSBuZXh0IHRhYiB3aWxsIGJlIGF1dG8tc2VsZWN0ZWQuXHJcbiAqXHJcbiAqICMjIyBFeHBsYW5hdGlvbiBvZiB0YWIgc3RyZXRjaGluZ1xyXG4gKlxyXG4gKiBJbml0aWFsbHksIHRhYnMgd2lsbCBoYXZlIGFuIGluaGVyZW50IHNpemUuICBUaGlzIHNpemUgd2lsbCBlaXRoZXIgYmUgZGVmaW5lZCBieSBob3cgbXVjaCBzcGFjZSBpcyBuZWVkZWQgdG8gYWNjb21tb2RhdGUgdGhlaXIgdGV4dCBvciBzZXQgYnkgdGhlIHVzZXIgdGhyb3VnaCBDU1MuICBDYWxjdWxhdGlvbnMgd2lsbCBiZSBiYXNlZCBvbiB0aGlzIHNpemUuXHJcbiAqXHJcbiAqIE9uIG1vYmlsZSBkZXZpY2VzLCB0YWJzIHdpbGwgYmUgZXhwYW5kZWQgdG8gZmlsbCB0aGUgYXZhaWxhYmxlIGhvcml6b250YWwgc3BhY2UuICBXaGVuIHRoaXMgaGFwcGVucywgYWxsIHRhYnMgd2lsbCBiZWNvbWUgdGhlIHNhbWUgc2l6ZS5cclxuICpcclxuICogT24gZGVza3RvcHMsIGJ5IGRlZmF1bHQsIHN0cmV0Y2hpbmcgd2lsbCBuZXZlciBvY2N1ci5cclxuICpcclxuICogVGhpcyBkZWZhdWx0IGJlaGF2aW9yIGNhbiBiZSBvdmVycmlkZGVuIHRocm91Z2ggdGhlIGBtZC1zdHJldGNoLXRhYnNgIGF0dHJpYnV0ZS4gIEhlcmUgaXMgYSB0YWJsZSBzaG93aW5nIHdoZW4gc3RyZXRjaGluZyB3aWxsIG9jY3VyOlxyXG4gKlxyXG4gKiBgbWQtc3RyZXRjaC10YWJzYCB8IG1vYmlsZSAgICB8IGRlc2t0b3BcclxuICogLS0tLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tfC0tLS0tLS0tXHJcbiAqIGBhdXRvYCAgICAgICAgICAgIHwgc3RyZXRjaGVkIHwgLS0tXHJcbiAqIGBhbHdheXNgICAgICAgICAgIHwgc3RyZXRjaGVkIHwgc3RyZXRjaGVkXHJcbiAqIGBuZXZlcmAgICAgICAgICAgIHwgLS0tICAgICAgIHwgLS0tXHJcbiAqXHJcbiAqIEBwYXJhbSB7aW50ZWdlcj19IG1kLXNlbGVjdGVkIEluZGV4IG9mIHRoZSBhY3RpdmUvc2VsZWN0ZWQgdGFiXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWluayBJZiBwcmVzZW50LCBkaXNhYmxlcyBpbmsgcmlwcGxlIGVmZmVjdHMuXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWJhciBJZiBwcmVzZW50LCBkaXNhYmxlcyB0aGUgc2VsZWN0aW9uIGluayBiYXIuXHJcbiAqIEBwYXJhbSB7c3RyaW5nPX0gIG1kLWFsaWduLXRhYnMgQXR0cmlidXRlIHRvIGluZGljYXRlIHBvc2l0aW9uIG9mIHRhYiBidXR0b25zOiBgYm90dG9tYCBvciBgdG9wYDsgZGVmYXVsdCBpcyBgdG9wYFxyXG4gKiBAcGFyYW0ge3N0cmluZz19IG1kLXN0cmV0Y2gtdGFicyBBdHRyaWJ1dGUgdG8gaW5kaWNhdGUgd2hldGhlciBvciBub3QgdG8gc3RyZXRjaCB0YWJzOiBgYXV0b2AsIGBhbHdheXNgLCBvciBgbmV2ZXJgOyBkZWZhdWx0IGlzIGBhdXRvYFxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1keW5hbWljLWhlaWdodCBXaGVuIGVuYWJsZWQsIHRoZSB0YWIgd3JhcHBlciB3aWxsIHJlc2l6ZSBiYXNlZCBvbiB0aGUgY29udGVudHMgb2YgdGhlIHNlbGVjdGVkIHRhYlxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1jZW50ZXItdGFicyBXaGVuIGVuYWJsZWQsIHRhYnMgd2lsbCBiZSBjZW50ZXJlZCBwcm92aWRlZCB0aGVyZSBpcyBubyBuZWVkIGZvciBwYWdpbmF0aW9uXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLXBhZ2luYXRpb24gV2hlbiBlbmFibGVkLCBwYWdpbmF0aW9uIHdpbGwgcmVtYWluIG9mZlxyXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSBtZC1zd2lwZS1jb250ZW50IFdoZW4gZW5hYmxlZCwgc3dpcGUgZ2VzdHVyZXMgd2lsbCBiZSBlbmFibGVkIGZvciB0aGUgY29udGVudCBhcmVhIHRvIGp1bXAgYmV0d2VlbiB0YWJzXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLW5vLWRpc2Nvbm5lY3QgSWYgeW91ciB0YWIgY29udGVudCBoYXMgYmFja2dyb3VuZCB0YXNrcyAoaWUuIGV2ZW50IGxpc3RlbmVycyksIHlvdSB3aWxsIHdhbnQgdG8gaW5jbHVkZSB0aGlzIHRvIHByZXZlbnQgdGhlIHNjb3BlIGZyb20gYmVpbmcgZGlzY29ubmVjdGVkXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IG1kLWF1dG9zZWxlY3QgV2hlbiBwcmVzZW50LCBhbnkgdGFicyBhZGRlZCBhZnRlciB0aGUgaW5pdGlhbCBsb2FkIHdpbGwgYmUgYXV0b21hdGljYWxseSBzZWxlY3RlZFxyXG4gKlxyXG4gKiBAdXNhZ2VcclxuICogPGhsanMgbGFuZz1cImh0bWxcIj5cclxuICogPG1kLXRhYnMgbWQtc2VsZWN0ZWQ9XCJzZWxlY3RlZEluZGV4XCIgPlxyXG4gKiAgIDxpbWcgbmctc3JjPVwiaW1nL2FuZ3VsYXIucG5nXCIgY2xhc3M9XCJjZW50ZXJlZFwiPlxyXG4gKiAgIDxtZC10YWJcclxuICogICAgICAgbmctcmVwZWF0PVwidGFiIGluIHRhYnMgfCBvcmRlckJ5OnByZWRpY2F0ZTpyZXZlcnNlZFwiXHJcbiAqICAgICAgIG1kLW9uLXNlbGVjdD1cIm9uVGFiU2VsZWN0ZWQodGFiKVwiXHJcbiAqICAgICAgIG1kLW9uLWRlc2VsZWN0PVwiYW5ub3VuY2VEZXNlbGVjdGVkKHRhYilcIlxyXG4gKiAgICAgICBuZy1kaXNhYmxlZD1cInRhYi5kaXNhYmxlZFwiPlxyXG4gKiAgICAgPG1kLXRhYi1sYWJlbD5cclxuICogICAgICAge3t0YWIudGl0bGV9fVxyXG4gKiAgICAgICA8aW1nIHNyYz1cImltZy9yZW1vdmVUYWIucG5nXCIgbmctY2xpY2s9XCJyZW1vdmVUYWIodGFiKVwiIGNsYXNzPVwiZGVsZXRlXCI+XHJcbiAqICAgICA8L21kLXRhYi1sYWJlbD5cclxuICogICAgIDxtZC10YWItYm9keT5cclxuICogICAgICAge3t0YWIuY29udGVudH19XHJcbiAqICAgICA8L21kLXRhYi1ib2R5PlxyXG4gKiAgIDwvbWQtdGFiPlxyXG4gKiA8L21kLXRhYnM+XHJcbiAqIDwvaGxqcz5cclxuICpcclxuICovXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hdGVyaWFsLmNvbXBvbmVudHMudGFicycpXHJcbiAgICAuZGlyZWN0aXZlKCdtZFRhYnMnLCBNZFRhYnMpO1xyXG5cclxuZnVuY3Rpb24gTWRUYWJzICgkbWRUaGVtaW5nLCAkbWRVdGlsLCAkY29tcGlsZSkge1xyXG4gIHJldHVybiB7XHJcbiAgICBzY29wZToge1xyXG4gICAgICBub1BhZ2luYXRpb246ICAnPT9tZE5vUGFnaW5hdGlvbicsXHJcbiAgICAgIGR5bmFtaWNIZWlnaHQ6ICc9P21kRHluYW1pY0hlaWdodCcsXHJcbiAgICAgIGNlbnRlclRhYnM6ICAgICc9P21kQ2VudGVyVGFicycsXHJcbiAgICAgIHNlbGVjdGVkSW5kZXg6ICc9P21kU2VsZWN0ZWQnLFxyXG4gICAgICBzdHJldGNoVGFiczogICAnQD9tZFN0cmV0Y2hUYWJzJyxcclxuICAgICAgc3dpcGVDb250ZW50OiAgJz0/bWRTd2lwZUNvbnRlbnQnLFxyXG4gICAgICBub0Rpc2Nvbm5lY3Q6ICAnPT9tZE5vRGlzY29ubmVjdCcsXHJcbiAgICAgIGF1dG9zZWxlY3Q6ICAgICc9P21kQXV0b3NlbGVjdCdcclxuICAgIH0sXHJcbiAgICB0ZW1wbGF0ZTogZnVuY3Rpb24gKGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgYXR0cltcIiRtZFRhYnNUZW1wbGF0ZVwiXSA9IGVsZW1lbnQuaHRtbCgpO1xyXG4gICAgICByZXR1cm4gJ1xcXHJcbiAgICAgICAgPG1kLXRhYnMtd3JhcHBlciBuZy1jbGFzcz1cInsgXFwnbWQtc3RyZXRjaC10YWJzXFwnOiAkbWRUYWJzQ3RybC5zaG91bGRTdHJldGNoVGFicygpIH1cIj5cXFxyXG4gICAgICAgICAgPG1kLXRhYi1kYXRhPjwvbWQtdGFiLWRhdGE+XFxcclxuICAgICAgICAgIDxtZC1wcmV2LWJ1dHRvblxcXHJcbiAgICAgICAgICAgICAgdGFiaW5kZXg9XCItMVwiXFxcclxuICAgICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcXFxyXG4gICAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJQcmV2aW91cyBQYWdlXCJcXFxyXG4gICAgICAgICAgICAgIGFyaWEtZGlzYWJsZWQ9XCJ7eyEkbWRUYWJzQ3RybC5jYW5QYWdlQmFjaygpfX1cIlxcXHJcbiAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7IFxcJ21kLWRpc2FibGVkXFwnOiAhJG1kVGFic0N0cmwuY2FuUGFnZUJhY2soKSB9XCJcXFxyXG4gICAgICAgICAgICAgIG5nLWlmPVwiJG1kVGFic0N0cmwuc2hvdWxkUGFnaW5hdGVcIlxcXHJcbiAgICAgICAgICAgICAgbmctY2xpY2s9XCIkbWRUYWJzQ3RybC5wcmV2aW91c1BhZ2UoKVwiPlxcXHJcbiAgICAgICAgICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwibWQtdGFicy1hcnJvd1wiPjwvbWQtaWNvbj5cXFxyXG4gICAgICAgICAgPC9tZC1wcmV2LWJ1dHRvbj5cXFxyXG4gICAgICAgICAgPG1kLW5leHQtYnV0dG9uXFxcclxuICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcXFxyXG4gICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcXHJcbiAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIk5leHQgUGFnZVwiXFxcclxuICAgICAgICAgICAgICBhcmlhLWRpc2FibGVkPVwie3shJG1kVGFic0N0cmwuY2FuUGFnZUZvcndhcmQoKX19XCJcXFxyXG4gICAgICAgICAgICAgIG5nLWNsYXNzPVwieyBcXCdtZC1kaXNhYmxlZFxcJzogISRtZFRhYnNDdHJsLmNhblBhZ2VGb3J3YXJkKCkgfVwiXFxcclxuICAgICAgICAgICAgICBuZy1pZj1cIiRtZFRhYnNDdHJsLnNob3VsZFBhZ2luYXRlXCJcXFxyXG4gICAgICAgICAgICAgIG5nLWNsaWNrPVwiJG1kVGFic0N0cmwubmV4dFBhZ2UoKVwiPlxcXHJcbiAgICAgICAgICAgIDxtZC1pY29uIG1kLXN2Zy1pY29uPVwibWQtdGFicy1hcnJvd1wiPjwvbWQtaWNvbj5cXFxyXG4gICAgICAgICAgPC9tZC1uZXh0LWJ1dHRvbj5cXFxyXG4gICAgICAgICAgPG1kLXRhYnMtY2FudmFzXFxcclxuICAgICAgICAgICAgICB0YWJpbmRleD1cIjBcIlxcXHJcbiAgICAgICAgICAgICAgYXJpYS1hY3RpdmVkZXNjZW5kYW50PVwidGFiLWl0ZW0te3skbWRUYWJzQ3RybC50YWJzWyRtZFRhYnNDdHJsLmZvY3VzSW5kZXhdLmlkfX1cIlxcXHJcbiAgICAgICAgICAgICAgbmctZm9jdXM9XCIkbWRUYWJzQ3RybC5yZWRpcmVjdEZvY3VzKClcIlxcXHJcbiAgICAgICAgICAgICAgbmctY2xhc3M9XCJ7XFxcclxuICAgICAgICAgICAgICAgICAgXFwnbWQtcGFnaW5hdGVkXFwnOiAkbWRUYWJzQ3RybC5zaG91bGRQYWdpbmF0ZSxcXFxyXG4gICAgICAgICAgICAgICAgICBcXCdtZC1jZW50ZXItdGFic1xcJzogJG1kVGFic0N0cmwuc2hvdWxkQ2VudGVyVGFic1xcXHJcbiAgICAgICAgICAgICAgfVwiXFxcclxuICAgICAgICAgICAgICBuZy1rZXlkb3duPVwiJG1kVGFic0N0cmwua2V5ZG93bigkZXZlbnQpXCJcXFxyXG4gICAgICAgICAgICAgIHJvbGU9XCJ0YWJsaXN0XCI+XFxcclxuICAgICAgICAgICAgPG1kLXBhZ2luYXRpb24td3JhcHBlclxcXHJcbiAgICAgICAgICAgICAgICBuZy1jbGFzcz1cInsgXFwnbWQtY2VudGVyLXRhYnNcXCc6ICRtZFRhYnNDdHJsLnNob3VsZENlbnRlclRhYnMgfVwiXFxcclxuICAgICAgICAgICAgICAgIG1kLXRhYi1zY3JvbGw9XCIkbWRUYWJzQ3RybC5zY3JvbGwoJGV2ZW50KVwiPlxcXHJcbiAgICAgICAgICAgICAgPG1kLXRhYi1pdGVtXFxcclxuICAgICAgICAgICAgICAgICAgdGFiaW5kZXg9XCItMVwiXFxcclxuICAgICAgICAgICAgICAgICAgY2xhc3M9XCJtZC10YWJcIlxcXHJcbiAgICAgICAgICAgICAgICAgIHN0eWxlPVwibWF4LXdpZHRoOiB7eyB0YWJXaWR0aCA/IHRhYldpZHRoICsgXFwncHhcXCcgOiBcXCdub25lXFwnIH19XCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1yZXBlYXQ9XCJ0YWIgaW4gJG1kVGFic0N0cmwudGFic1wiXFxcclxuICAgICAgICAgICAgICAgICAgcm9sZT1cInRhYlwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1jb250cm9scz1cInRhYi1jb250ZW50LXt7dGFiLmlkfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtc2VsZWN0ZWQ9XCJ7e3RhYi5pc0FjdGl2ZSgpfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtZGlzYWJsZWQ9XCJ7e3RhYi5zY29wZS5kaXNhYmxlZCB8fCBcXCdmYWxzZVxcJ319XCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1jbGljaz1cIiRtZFRhYnNDdHJsLnNlbGVjdCh0YWIuZ2V0SW5kZXgoKSlcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLWNsYXNzPVwie1xcXHJcbiAgICAgICAgICAgICAgICAgICAgICBcXCdtZC1hY3RpdmVcXCc6ICAgIHRhYi5pc0FjdGl2ZSgpLFxcXHJcbiAgICAgICAgICAgICAgICAgICAgICBcXCdtZC1mb2N1c2VkXFwnOiAgIHRhYi5oYXNGb2N1cygpLFxcXHJcbiAgICAgICAgICAgICAgICAgICAgICBcXCdtZC1kaXNhYmxlZFxcJzogIHRhYi5zY29wZS5kaXNhYmxlZFxcXHJcbiAgICAgICAgICAgICAgICAgIH1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLWRpc2FibGVkPVwidGFiLnNjb3BlLmRpc2FibGVkXCJcXFxyXG4gICAgICAgICAgICAgICAgICBtZC1zd2lwZS1sZWZ0PVwiJG1kVGFic0N0cmwubmV4dFBhZ2UoKVwiXFxcclxuICAgICAgICAgICAgICAgICAgbWQtc3dpcGUtcmlnaHQ9XCIkbWRUYWJzQ3RybC5wcmV2aW91c1BhZ2UoKVwiXFxcclxuICAgICAgICAgICAgICAgICAgbWQtdGVtcGxhdGU9XCJ0YWIubGFiZWxcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG1kLXNjb3BlPVwidGFiLnBhcmVudFwiPjwvbWQtdGFiLWl0ZW0+XFxcclxuICAgICAgICAgICAgICA8bWQtaW5rLWJhciBuZy1oaWRlPVwibm9JbmtCYXJcIj48L21kLWluay1iYXI+XFxcclxuICAgICAgICAgICAgPC9tZC1wYWdpbmF0aW9uLXdyYXBwZXI+XFxcclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1kLXZpc3VhbGx5LWhpZGRlbiBtZC1kdW1teS13cmFwcGVyXCI+XFxcclxuICAgICAgICAgICAgICA8bWQtZHVtbXktdGFiXFxcclxuICAgICAgICAgICAgICAgICAgY2xhc3M9XCJtZC10YWJcIlxcXHJcbiAgICAgICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxcXHJcbiAgICAgICAgICAgICAgICAgIGlkPVwidGFiLWl0ZW0te3t0YWIuaWR9fVwiXFxcclxuICAgICAgICAgICAgICAgICAgcm9sZT1cInRhYlwiXFxcclxuICAgICAgICAgICAgICAgICAgYXJpYS1jb250cm9scz1cInRhYi1jb250ZW50LXt7dGFiLmlkfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtc2VsZWN0ZWQ9XCJ7e3RhYi5pc0FjdGl2ZSgpfX1cIlxcXHJcbiAgICAgICAgICAgICAgICAgIGFyaWEtZGlzYWJsZWQ9XCJ7e3RhYi5zY29wZS5kaXNhYmxlZCB8fCBcXCdmYWxzZVxcJ319XCJcXFxyXG4gICAgICAgICAgICAgICAgICBuZy1mb2N1cz1cIiRtZFRhYnNDdHJsLmhhc0ZvY3VzID0gdHJ1ZVwiXFxcclxuICAgICAgICAgICAgICAgICAgbmctYmx1cj1cIiRtZFRhYnNDdHJsLmhhc0ZvY3VzID0gZmFsc2VcIlxcXHJcbiAgICAgICAgICAgICAgICAgIG5nLXJlcGVhdD1cInRhYiBpbiAkbWRUYWJzQ3RybC50YWJzXCJcXFxyXG4gICAgICAgICAgICAgICAgICBtZC10ZW1wbGF0ZT1cInRhYi5sYWJlbFwiXFxcclxuICAgICAgICAgICAgICAgICAgbWQtc2NvcGU9XCJ0YWIucGFyZW50XCI+PC9tZC1kdW1teS10YWI+XFxcclxuICAgICAgICAgICAgPC9kaXY+XFxcclxuICAgICAgICAgIDwvbWQtdGFicy1jYW52YXM+XFxcclxuICAgICAgICA8L21kLXRhYnMtd3JhcHBlcj5cXFxyXG4gICAgICAgIDxtZC10YWJzLWNvbnRlbnQtd3JhcHBlciBuZy1zaG93PVwiJG1kVGFic0N0cmwuaGFzQ29udGVudFwiPlxcXHJcbiAgICAgICAgICA8bWQtdGFiLWNvbnRlbnRcXFxyXG4gICAgICAgICAgICAgIGlkPVwidGFiLWNvbnRlbnQte3t0YWIuaWR9fVwiXFxcclxuICAgICAgICAgICAgICByb2xlPVwidGFicGFuZWxcIlxcXHJcbiAgICAgICAgICAgICAgYXJpYS1sYWJlbGxlZGJ5PVwidGFiLWl0ZW0te3t0YWIuaWR9fVwiXFxcclxuICAgICAgICAgICAgICBtZC1zd2lwZS1sZWZ0PVwic3dpcGVDb250ZW50ICYmICRtZFRhYnNDdHJsLmluY3JlbWVudFNlbGVjdGVkSW5kZXgoMSlcIlxcXHJcbiAgICAgICAgICAgICAgbWQtc3dpcGUtcmlnaHQ9XCJzd2lwZUNvbnRlbnQgJiYgJG1kVGFic0N0cmwuaW5jcmVtZW50U2VsZWN0ZWRJbmRleCgtMSlcIlxcXHJcbiAgICAgICAgICAgICAgbmctaWY9XCIkbWRUYWJzQ3RybC5oYXNDb250ZW50XCJcXFxyXG4gICAgICAgICAgICAgIG5nLXJlcGVhdD1cIihpbmRleCwgdGFiKSBpbiAkbWRUYWJzQ3RybC50YWJzXCJcXFxyXG4gICAgICAgICAgICAgIG1kLWNvbm5lY3RlZC1pZj1cInRhYi5pc0FjdGl2ZSgpXCJcXFxyXG4gICAgICAgICAgICAgIG5nLWNsYXNzPVwie1xcXHJcbiAgICAgICAgICAgICAgICBcXCdtZC1uby10cmFuc2l0aW9uXFwnOiAkbWRUYWJzQ3RybC5sYXN0U2VsZWN0ZWRJbmRleCA9PSBudWxsLFxcXHJcbiAgICAgICAgICAgICAgICBcXCdtZC1hY3RpdmVcXCc6ICAgICAgICB0YWIuaXNBY3RpdmUoKSxcXFxyXG4gICAgICAgICAgICAgICAgXFwnbWQtbGVmdFxcJzogICAgICAgICAgdGFiLmlzTGVmdCgpLFxcXHJcbiAgICAgICAgICAgICAgICBcXCdtZC1yaWdodFxcJzogICAgICAgICB0YWIuaXNSaWdodCgpLFxcXHJcbiAgICAgICAgICAgICAgICBcXCdtZC1uby1zY3JvbGxcXCc6ICAgICBkeW5hbWljSGVpZ2h0XFxcclxuICAgICAgICAgICAgICB9XCI+XFxcclxuICAgICAgICAgICAgPGRpdlxcXHJcbiAgICAgICAgICAgICAgICBtZC10ZW1wbGF0ZT1cInRhYi50ZW1wbGF0ZVwiXFxcclxuICAgICAgICAgICAgICAgIG1kLXNjb3BlPVwidGFiLnBhcmVudFwiXFxcclxuICAgICAgICAgICAgICAgIG5nLWlmPVwidGFiLnNob3VsZFJlbmRlcigpXCI+PC9kaXY+XFxcclxuICAgICAgICAgIDwvbWQtdGFiLWNvbnRlbnQ+XFxcclxuICAgICAgICA8L21kLXRhYnMtY29udGVudC13cmFwcGVyPlxcXHJcbiAgICAgICc7XHJcbiAgICB9LFxyXG4gICAgY29udHJvbGxlcjogJ01kVGFic0NvbnRyb2xsZXInLFxyXG4gICAgY29udHJvbGxlckFzOiAnJG1kVGFic0N0cmwnXHJcbiAgfTtcclxufVxyXG5NZFRhYnMuJGluamVjdCA9IFtcIiRtZFRoZW1pbmdcIiwgXCIkbWRVdGlsXCIsIFwiJGNvbXBpbGVcIl07XHJcblxyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtcclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYXRlcmlhbC5jb21wb25lbnRzLnRhYnMnKVxyXG4gICAgLmRpcmVjdGl2ZSgnbWRUZW1wbGF0ZScsIE1kVGVtcGxhdGUpO1xyXG5cclxuZnVuY3Rpb24gTWRUZW1wbGF0ZSAoJGNvbXBpbGUsICRtZFV0aWwsICR0aW1lb3V0KSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICBsaW5rOiBsaW5rLFxyXG4gICAgc2NvcGU6IHtcclxuICAgICAgdGVtcGxhdGU6ICc9bWRUZW1wbGF0ZScsXHJcbiAgICAgIGNvbXBpbGVTY29wZTogJz1tZFNjb3BlJyxcclxuICAgICAgY29ubmVjdGVkOiAnPT9tZENvbm5lY3RlZElmJ1xyXG4gICAgfSxcclxuICAgIHJlcXVpcmU6ICdeP21kVGFicydcclxuICB9O1xyXG4gIGZ1bmN0aW9uIGxpbmsgKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICBpZiAoIWN0cmwpIHJldHVybjtcclxuICAgIHZhciBjb21waWxlU2NvcGUgPSBzY29wZS5jb21waWxlU2NvcGUuJG5ldygpO1xyXG4gICAgZWxlbWVudC5odG1sKHNjb3BlLnRlbXBsYXRlKTtcclxuICAgICRjb21waWxlKGVsZW1lbnQuY29udGVudHMoKSkoY29tcGlsZVNjb3BlKTtcclxuICAgIHJldHVybiAkdGltZW91dChoYW5kbGVTY29wZSk7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVTY29wZSAoKSB7XHJcbiAgICAgIHNjb3BlLiR3YXRjaCgnY29ubmVjdGVkJywgZnVuY3Rpb24gKHZhbHVlKSB7IHZhbHVlID09PSBmYWxzZSA/IGRpc2Nvbm5lY3QoKSA6IHJlY29ubmVjdCgpOyB9KTtcclxuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIHJlY29ubmVjdCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBkaXNjb25uZWN0ICgpIHtcclxuICAgICAgaWYgKGN0cmwuc2NvcGUubm9EaXNjb25uZWN0KSByZXR1cm47XHJcbiAgICAgICRtZFV0aWwuZGlzY29ubmVjdFNjb3BlKGNvbXBpbGVTY29wZSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZWNvbm5lY3QgKCkge1xyXG4gICAgICBpZiAoY3RybC5zY29wZS5ub0Rpc2Nvbm5lY3QpIHJldHVybjtcclxuICAgICAgJG1kVXRpbC5yZWNvbm5lY3RTY29wZShjb21waWxlU2NvcGUpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5NZFRlbXBsYXRlLiRpbmplY3QgPSBbXCIkY29tcGlsZVwiLCBcIiRtZFV0aWxcIiwgXCIkdGltZW91dFwiXTtcclxuXHJcbn0pKCk7XHJcbihmdW5jdGlvbigpeyBcclxuYW5ndWxhci5tb2R1bGUoXCJtYXRlcmlhbC5jb3JlXCIpLmNvbnN0YW50KFwiJE1EX1RIRU1FX0NTU1wiLCBcIi8qIG1peGluIGRlZmluaXRpb24gOyBzZXRzIExUUiBhbmQgUlRMIHdpdGhpbiB0aGUgc2FtZSBzdHlsZSBjYWxsICovbWQtYXV0b2NvbXBsZXRlLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZDogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgbWQtYXV0b2NvbXBsZXRlLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIHsgICAgYmFja2dyb3VuZDogJ3t7YmFja2dyb3VuZC0xMDB9fSc7IH0gIG1kLWF1dG9jb21wbGV0ZS5tZC1USEVNRV9OQU1FLXRoZW1lIGJ1dHRvbiBtZC1pY29uIHBhdGggeyAgICBmaWxsOiAne3tiYWNrZ3JvdW5kLTYwMH19JzsgfSAgbWQtYXV0b2NvbXBsZXRlLm1kLVRIRU1FX05BTUUtdGhlbWUgYnV0dG9uOmFmdGVyIHsgICAgYmFja2dyb3VuZDogJ3t7YmFja2dyb3VuZC02MDAtMC4zfX0nOyB9Lm1kLWF1dG9jb21wbGV0ZS1zdWdnZXN0aW9ucy5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQ6ICd7e2JhY2tncm91bmQtNTB9fSc7IH0gIC5tZC1hdXRvY29tcGxldGUtc3VnZ2VzdGlvbnMubWQtVEhFTUVfTkFNRS10aGVtZSBsaSB7ICAgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLTkwMH19JzsgfSAgICAubWQtYXV0b2NvbXBsZXRlLXN1Z2dlc3Rpb25zLm1kLVRIRU1FX05BTUUtdGhlbWUgbGkgLmhpZ2hsaWdodCB7ICAgICAgY29sb3I6ICd7e2JhY2tncm91bmQtNjAwfX0nOyB9ICAgIC5tZC1hdXRvY29tcGxldGUtc3VnZ2VzdGlvbnMubWQtVEhFTUVfTkFNRS10aGVtZSBsaTpob3ZlciwgLm1kLWF1dG9jb21wbGV0ZS1zdWdnZXN0aW9ucy5tZC1USEVNRV9OQU1FLXRoZW1lIGxpLnNlbGVjdGVkIHsgICAgICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTIwMH19JzsgfW1kLWJhY2tkcm9wLm1kLW9wYXF1ZS5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtNC0wLjV9fSc7IH1tZC1ib3R0b20tc2hlZXQubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7YmFja2dyb3VuZC0zMDB9fSc7IH0gIG1kLWJvdHRvbS1zaGVldC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWxpc3QgbWQtbGlzdC1pdGVtIHsgICAgY29sb3I6ICd7e2ZvcmVncm91bmQtMX19JzsgfSAgbWQtYm90dG9tLXNoZWV0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXN1YmhlYWRlciB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTB9fSc7IH0gIG1kLWJvdHRvbS1zaGVldC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1zdWJoZWFkZXIgeyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0xfX0nOyB9YS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJvcmRlci1yYWRpdXM6IDNweDsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6aG92ZXIgeyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwMC0wLjJ9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTAwLTAuMn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtaWNvbi1idXR0b246aG92ZXIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtaWNvbi1idXR0b246aG92ZXIgeyAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWIgeyAgICBib3JkZXItcmFkaXVzOiA1MCU7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYiBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiIG1kLWljb24geyAgICAgIGNvbG9yOiAne3thY2NlbnQtY29udHJhc3R9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtQTcwMH19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1pY29uLWJ1dHRvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWljb24tYnV0dG9uIHsgICAgYm9yZGVyLXJhZGl1czogNTAlOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnksIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IHsgICAgY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLXJhaXNlZCwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLWZhYiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWIgeyAgICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gICAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiB7ICAgICAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS02MDB9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5Om5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeTpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiIHsgICAgYm9yZGVyLXJhZGl1czogNTAlOyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7ICAgIGNvbG9yOiAne3thY2NlbnQtY29udHJhc3R9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIC5tZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiOm5vdChbZGlzYWJsZWRdKSAubWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1BNzAwfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZCB7ICAgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbnRyYXN0fX0nOyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTUwfX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSAubWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkgLm1kLWljb24geyAgICAgIGNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbnRyYXN0fX0nOyB9ICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSk6aG92ZXIgeyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNTB9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtMjAwfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIHsgICAgY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLXJhaXNlZCwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLWZhYiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWIgeyAgICAgIGNvbG9yOiAne3t3YXJuLWNvbnRyYXN0fX0nOyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gICAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiB7ICAgICAgICBjb2xvcjogJ3t7d2Fybi1jb250cmFzdH19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1yYWlzZWQ6bm90KFtkaXNhYmxlZF0pOmhvdmVyLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtZmFiOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9ICAgICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuLm1kLWZhYjpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4ubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybi5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi03MDB9fSc7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2Fybjpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50LCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IHsgICAgY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1yYWlzZWQsIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1yYWlzZWQsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtZmFiIHsgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbnRyYXN0fX0nOyAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtZmFiOm5vdChbZGlzYWJsZWRdKSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWI6bm90KFtkaXNhYmxlZF0pIG1kLWljb24geyAgICAgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLWZhYjpub3QoW2Rpc2FibGVkXSk6aG92ZXIsIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtcmFpc2VkOm5vdChbZGlzYWJsZWRdKTpob3ZlciwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWI6bm90KFtkaXNhYmxlZF0pOmhvdmVyIHsgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgICAgIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQubWQtZmFiOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50Lm1kLXJhaXNlZDpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudC5tZC1mYWI6bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LTcwMH19JzsgfSAgICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudDpub3QoW2Rpc2FibGVkXSkgbWQtaWNvbiB7ICAgICAgY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfSAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcmFpc2VkW2Rpc2FibGVkXSwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudFtkaXNhYmxlZF0sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybltkaXNhYmxlZF0sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWRbZGlzYWJsZWRdLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudFtkaXNhYmxlZF0sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuW2Rpc2FibGVkXSB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7ICAgIGN1cnNvcjogbm90LWFsbG93ZWQ7IH0gICAgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gbWQtaWNvbiwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWRbZGlzYWJsZWRdIG1kLWljb24sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiW2Rpc2FibGVkXSBtZC1pY29uLCBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudFtkaXNhYmxlZF0gbWQtaWNvbiwgYS5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuW2Rpc2FibGVkXSBtZC1pY29uLCAubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1yYWlzZWRbZGlzYWJsZWRdIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnRbZGlzYWJsZWRdIG1kLWljb24sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuW2Rpc2FibGVkXSBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0sIGEubWQtYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZmFiW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXJhaXNlZFtkaXNhYmxlZF0sIC5tZC1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1mYWJbZGlzYWJsZWRdIHsgICAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00fX0nOyB9ICBhLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSwgLm1kLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSB7ICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyB9bWQtY2FyZC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7ICBib3JkZXItcmFkaXVzOiAycHg7IH0gIG1kLWNhcmQubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtY2FyZC1pbWFnZSB7ICAgIGJvcmRlci1yYWRpdXM6IDJweCAycHggMCAwOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtcmlwcGxlIHsgIGNvbG9yOiAne3thY2NlbnQtNjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e2JhY2tncm91bmQtNjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLWZvY3VzZWQgLm1kLWNvbnRhaW5lcjpiZWZvcmUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuMjZ9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pY29uIHsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC1pY29uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvci0wLjg3fX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC1pY29uOmFmdGVyIHsgIGJvcmRlci1jb2xvcjogJ3t7YmFja2dyb3VuZC0yMDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e3ByaW1hcnktNjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1yaXBwbGUgeyAgY29sb3I6ICd7e2JhY2tncm91bmQtNjAwfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtaWNvbiB7ICBib3JkZXItY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkubWQtY2hlY2tlZCAubWQtaWNvbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuODd9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQubWQtZm9jdXNlZCAubWQtY29udGFpbmVyOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuMjZ9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5Lm1kLWNoZWNrZWQgLm1kLWljb246YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTIwMH19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7d2Fybi02MDB9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1pY29uIHsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1pY29uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC44N319JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4ubWQtY2hlY2tlZC5tZC1mb2N1c2VkOm5vdChbZGlzYWJsZWRdKSAubWQtY29udGFpbmVyOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yLTAuMjZ9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuLm1kLWNoZWNrZWQgLm1kLWljb246YWZ0ZXIgeyAgYm9yZGVyLWNvbG9yOiAne3tiYWNrZ3JvdW5kLTIwMH19JzsgfW1kLWNoZWNrYm94Lm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIC5tZC1pY29uIHsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtY2hlY2tib3gubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0ubWQtY2hlY2tlZCAubWQtaWNvbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH1tZC1jaGVja2JveC5tZC1USEVNRV9OQU1FLXRoZW1lW2Rpc2FibGVkXSAubWQtbGFiZWwgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfW1kLWNoaXBzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNoaXBzIHsgIGJveC1zaGFkb3c6IDAgMXB4ICd7e2JhY2tncm91bmQtMzAwfX0nOyB9ICBtZC1jaGlwcy5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1jaGlwcy5tZC1mb2N1c2VkIHsgICAgYm94LXNoYWRvdzogMCAycHggJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLWNoaXBzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNoaXAgeyAgYmFja2dyb3VuZDogJ3t7YmFja2dyb3VuZC0zMDB9fSc7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC04MDB9fSc7IH0gIG1kLWNoaXBzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNoaXAubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e3ByaW1hcnktY29sb3J9fSc7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICAgIG1kLWNoaXBzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWNoaXAubWQtZm9jdXNlZCBtZC1pY29uIHsgICAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfW1kLWNoaXBzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtY2hpcC1yZW1vdmUgLm1kLWJ1dHRvbiBtZC1pY29uIHBhdGggeyAgZmlsbDogJ3t7YmFja2dyb3VuZC01MDB9fSc7IH0ubWQtY29udGFjdC1zdWdnZXN0aW9uIHNwYW4ubWQtY29udGFjdC1lbWFpbCB7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC00MDB9fSc7IH1tZC1jb250ZW50Lm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgfW1kLWRpYWxvZy5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJvcmRlci1yYWRpdXM6IDRweDsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH0gIG1kLWRpYWxvZy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNvbnRlbnQtb3ZlcmZsb3cgLm1kLWFjdGlvbnMgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC1kaXZpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgeyAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00fX0nOyB9bWQtaWNvbi5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH0gIG1kLWljb24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IHsgICAgY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gIG1kLWljb24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgeyAgICBjb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICBtZC1pY29uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiB7ICAgIGNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlucHV0IHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTF9fSc7ICBib3JkZXItY29sb3I6ICd7e2ZvcmVncm91bmQtNH19JzsgIHRleHQtc2hhZG93OiAne3tmb3JlZ3JvdW5kLXNoYWRvd319JzsgfSAgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWlucHV0Ojotd2Via2l0LWlucHV0LXBsYWNlaG9sZGVyLCBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5wdXQ6Oi1tb3otcGxhY2Vob2xkZXIsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dDotbW96LXBsYWNlaG9sZGVyLCBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5wdXQ6LW1zLWlucHV0LXBsYWNlaG9sZGVyIHsgICAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lID4gbWQtaWNvbiB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0xfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgbGFiZWwsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1wbGFjZWhvbGRlciB7ICB0ZXh0LXNoYWRvdzogJ3t7Zm9yZWdyb3VuZC1zaGFkb3d9fSc7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgbmctbWVzc2FnZXMsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIFtuZy1tZXNzYWdlXSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUgW2RhdGEtbmctbWVzc2FnZV0sIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIFt4LW5nLW1lc3NhZ2VdIHsgIGNvbG9yOiAne3t3YXJuLTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdCgubWQtaW5wdXQtaW52YWxpZCkubWQtaW5wdXQtaGFzLXZhbHVlIGxhYmVsIHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQgLm1kLWlucHV0IHsgIGJvcmRlci1jb2xvcjogJ3t7cHJpbWFyeS01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoLm1kLWlucHV0LWludmFsaWQpLm1kLWlucHV0LWZvY3VzZWQgbGFiZWwgeyAgY29sb3I6ICd7e3ByaW1hcnktNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1mb2N1c2VkIG1kLWljb24geyAgY29sb3I6ICd7e3ByaW1hcnktNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1mb2N1c2VkLm1kLWFjY2VudCAubWQtaW5wdXQgeyAgYm9yZGVyLWNvbG9yOiAne3thY2NlbnQtNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1mb2N1c2VkLm1kLWFjY2VudCBsYWJlbCB7ICBjb2xvcjogJ3t7YWNjZW50LTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdCgubWQtaW5wdXQtaW52YWxpZCkubWQtaW5wdXQtZm9jdXNlZC5tZC13YXJuIC5tZC1pbnB1dCB7ICBib3JkZXItY29sb3I6ICd7e3dhcm4tNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KC5tZC1pbnB1dC1pbnZhbGlkKS5tZC1pbnB1dC1mb2N1c2VkLm1kLXdhcm4gbGFiZWwgeyAgY29sb3I6ICd7e3dhcm4tNTAwfX0nOyB9bWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCAubWQtaW5wdXQgeyAgYm9yZGVyLWNvbG9yOiAne3t3YXJuLTUwMH19JzsgfW1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQubWQtaW5wdXQtZm9jdXNlZCBsYWJlbCB7ICBjb2xvcjogJ3t7d2Fybi01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1pbnB1dC1pbnZhbGlkIG5nLW1lc3NhZ2UsIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgZGF0YS1uZy1tZXNzYWdlLCBtZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1pbnB1dC1pbnZhbGlkIHgtbmctbWVzc2FnZSwgbWQtaW5wdXQtY29udGFpbmVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtaW5wdXQtaW52YWxpZCBbbmctbWVzc2FnZV0sIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgW2RhdGEtbmctbWVzc2FnZV0sIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgW3gtbmctbWVzc2FnZV0sIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWlucHV0LWludmFsaWQgLm1kLWNoYXItY291bnRlciB7ICBjb2xvcjogJ3t7d2Fybi01MDB9fSc7IH1tZC1pbnB1dC1jb250YWluZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5wdXRbZGlzYWJsZWRdLCBbZGlzYWJsZWRdIG1kLWlucHV0LWNvbnRhaW5lci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbnB1dCB7ICBib3JkZXItYm90dG9tLWNvbG9yOiB0cmFuc3BhcmVudDsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7ICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gcmlnaHQsICd7e2ZvcmVncm91bmQtM319JyAwJSwgJ3t7Zm9yZWdyb3VuZC0zfX0nIDMzJSwgdHJhbnNwYXJlbnQgMCUpOyAgYmFja2dyb3VuZC1pbWFnZTogLW1zLWxpbmVhci1ncmFkaWVudChsZWZ0LCB0cmFuc3BhcmVudCAwJSwgJ3t7Zm9yZWdyb3VuZC0zfX0nIDEwMCUpOyB9bWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWxpc3QtaXRlbS5tZC0yLWxpbmUgLm1kLWxpc3QtaXRlbS10ZXh0IGgzLCBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTItbGluZSAubWQtbGlzdC1pdGVtLXRleHQgaDQsIG1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1saXN0LWl0ZW0ubWQtMy1saW5lIC5tZC1saXN0LWl0ZW0tdGV4dCBoMywgbWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWxpc3QtaXRlbS5tZC0zLWxpbmUgLm1kLWxpc3QtaXRlbS10ZXh0IGg0IHsgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTF9fSc7IH1tZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtLm1kLTItbGluZSAubWQtbGlzdC1pdGVtLXRleHQgcCwgbWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWxpc3QtaXRlbS5tZC0zLWxpbmUgLm1kLWxpc3QtaXRlbS10ZXh0IHAgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtMn19JzsgfW1kLWxpc3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtcHJveHktZm9jdXMubWQtZm9jdXNlZCBkaXYubWQtbm8tc3R5bGUgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC0xMDB9fSc7IH1tZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtID4gbWQtaWNvbiB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9ICBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtID4gbWQtaWNvbi5tZC1oaWdobGlnaHQgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgICBtZC1saXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtbGlzdC1pdGVtID4gbWQtaWNvbi5tZC1oaWdobGlnaHQubWQtYWNjZW50IHsgICAgICBjb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWxpc3QtaXRlbSBidXR0b24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgfSAgbWQtbGlzdC5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWxpc3QtaXRlbSBidXR0b24ubWQtYnV0dG9uOm5vdChbZGlzYWJsZWRdKTpob3ZlciB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtY29sb3J9fSc7IH1tZC1tZW51LWNvbnRlbnQubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9ICBtZC1tZW51LWNvbnRlbnQubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1tZW51LWRpdmlkZXIgeyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50OyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtZ2FwIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5uZXIgLm1kLWxlZnQgLm1kLWhhbGYtY2lyY2xlLCBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1pbm5lciAubWQtcmlnaHQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5uZXIgLm1kLXJpZ2h0IC5tZC1oYWxmLWNpcmNsZSB7ICAgIGJvcmRlci1yaWdodC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtcHJvZ3Jlc3MtY2lyY3VsYXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtaW5uZXIgLm1kLWxlZnQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLWxlZnQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtaW5uZXIgLm1kLWdhcCB7ICAgIGJvcmRlci10b3AtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7ICAgIGJvcmRlci1ib3R0b20tY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtaW5uZXIgLm1kLWxlZnQgLm1kLWhhbGYtY2lyY2xlLCBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLWlubmVyIC5tZC1yaWdodCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItdG9wLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLWlubmVyIC5tZC1yaWdodCAubWQtaGFsZi1jaXJjbGUgeyAgICBib3JkZXItcmlnaHQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtaW5uZXIgLm1kLWxlZnQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLWxlZnQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1pbm5lciAubWQtZ2FwIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyAgICBib3JkZXItYm90dG9tLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1pbm5lciAubWQtbGVmdCAubWQtaGFsZi1jaXJjbGUsIG1kLXByb2dyZXNzLWNpcmN1bGFyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtYWNjZW50IC5tZC1pbm5lciAubWQtcmlnaHQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCAubWQtaW5uZXIgLm1kLXJpZ2h0IC5tZC1oYWxmLWNpcmNsZSB7ICAgIGJvcmRlci1yaWdodC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICBtZC1wcm9ncmVzcy1jaXJjdWxhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCAubWQtaW5uZXIgLm1kLWxlZnQgLm1kLWhhbGYtY2lyY2xlIHsgICAgYm9yZGVyLWxlZnQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1jb250YWluZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS0xMDB9fSc7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYmFyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1jb250YWluZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi0xMDB9fSc7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCAubWQtY29udGFpbmVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgLm1kLWJhciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1wcm9ncmVzcy1saW5lYXIubWQtVEhFTUVfTkFNRS10aGVtZVttZC1tb2RlPWJ1ZmZlcl0ubWQtd2FybiAubWQtYmFyMSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLTEwMH19JzsgfW1kLXByb2dyZXNzLWxpbmVhci5tZC1USEVNRV9OQU1FLXRoZW1lW21kLW1vZGU9YnVmZmVyXS5tZC13YXJuIC5tZC1kYXNoZWQ6YmVmb3JlIHsgIGJhY2tncm91bmQ6IHJhZGlhbC1ncmFkaWVudCgne3t3YXJuLTEwMH19JyAwJSwgJ3t7d2Fybi0xMDB9fScgMTYlLCB0cmFuc3BhcmVudCA0MiUpOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWVbbWQtbW9kZT1idWZmZXJdLm1kLWFjY2VudCAubWQtYmFyMSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtMTAwfX0nOyB9bWQtcHJvZ3Jlc3MtbGluZWFyLm1kLVRIRU1FX05BTUUtdGhlbWVbbWQtbW9kZT1idWZmZXJdLm1kLWFjY2VudCAubWQtZGFzaGVkOmJlZm9yZSB7ICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoJ3t7YWNjZW50LTEwMH19JyAwJSwgJ3t7YWNjZW50LTEwMH19JyAxNiUsIHRyYW5zcGFyZW50IDQyJSk7IH1tZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtb2ZmIHsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLW9uIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvci0wLjg3fX0nOyB9bWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZCAubWQtb2ZmIHsgIGJvcmRlci1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlIHsgIGNvbG9yOiAne3thY2NlbnQtY29sb3ItMC44N319JzsgfW1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1jb250YWluZXIgLm1kLXJpcHBsZSB7ICBjb2xvcjogJ3t7YWNjZW50LTYwMH19JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1vbiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtb24sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtb24sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1vbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1vZmYgeyAgYm9yZGVyLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkgLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtcHJpbWFyeS5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSB7ICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvci0wLjg3fX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXByaW1hcnkgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC1wcmltYXJ5IC5tZC1jb250YWluZXIgLm1kLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC1wcmltYXJ5IC5tZC1jb250YWluZXIgLm1kLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXByaW1hcnkgLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlIHsgIGNvbG9yOiAne3twcmltYXJ5LTYwMH19JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1vbiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtb24sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtb24sIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1vbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLWNoZWNrZWQgLm1kLW9mZiwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1vZmYsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4ubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtY2hlY2tlZCAubWQtb2ZmLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1vZmYgeyAgYm9yZGVyLWNvbG9yOiAne3t3YXJuLWNvbG9yLTAuODd9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2FybiAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4ubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4gLm1kLWNoZWNrZWQgLm1kLWluay1yaXBwbGUsIG1kLXJhZGlvLWJ1dHRvbi5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKSAubWQtd2Fybi5tZC1jaGVja2VkIC5tZC1pbmstcmlwcGxlLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkubWQtd2FybiAubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4ubWQtY2hlY2tlZCAubWQtaW5rLXJpcHBsZSB7ICBjb2xvcjogJ3t7d2Fybi1jb2xvci0wLjg3fX0nOyB9bWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSkgLm1kLXdhcm4gLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlLCBtZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lOm5vdChbZGlzYWJsZWRdKS5tZC13YXJuIC5tZC1jb250YWluZXIgLm1kLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pIC5tZC13YXJuIC5tZC1jb250YWluZXIgLm1kLXJpcHBsZSwgbWQtcmFkaW8tYnV0dG9uLm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pLm1kLXdhcm4gLm1kLWNvbnRhaW5lciAubWQtcmlwcGxlIHsgIGNvbG9yOiAne3t3YXJuLTYwMH19JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0geyAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfSAgbWQtcmFkaW8tZ3JvdXAubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWNvbnRhaW5lciAubWQtb2ZmLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWNvbnRhaW5lciAubWQtb2ZmIHsgICAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTN9fSc7IH0gIG1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIC5tZC1jb250YWluZXIgLm1kLW9uLCBtZC1yYWRpby1idXR0b24ubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLWNvbnRhaW5lciAubWQtb24geyAgICBib3JkZXItY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZm9jdXNlZDpub3QoOmVtcHR5KSAubWQtY2hlY2tlZCAubWQtY29udGFpbmVyOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3ItMC4yNn19JzsgfW1kLXJhZGlvLWdyb3VwLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtZm9jdXNlZDpub3QoOmVtcHR5KSAubWQtY2hlY2tlZDpub3QoW2Rpc2FibGVkXSkubWQtcHJpbWFyeSAubWQtY29udGFpbmVyOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yLTAuMjZ9fSc7IH1tZC1yYWRpby1ncm91cC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWZvY3VzZWQ6bm90KDplbXB0eSkgLm1kLWNoZWNrZWQubWQtcHJpbWFyeSAubWQtY29udGFpbmVyOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yLTAuMjZ9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZS5uZy1pbnZhbGlkLm5nLWRpcnR5IC5tZC1zZWxlY3QtbGFiZWwgeyAgY29sb3I6ICd7e3dhcm4tNTAwfX0nICFpbXBvcnRhbnQ7ICBib3JkZXItYm90dG9tLWNvbG9yOiAne3t3YXJuLTUwMH19JyAhaW1wb3J0YW50OyB9bWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pOmZvY3VzIC5tZC1zZWxlY3QtbGFiZWwgeyAgYm9yZGVyLWJvdHRvbS1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgIGNvbG9yOiAne3sgZm9yZWdyb3VuZC0xIH19JzsgfSAgbWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pOmZvY3VzIC5tZC1zZWxlY3QtbGFiZWwubWQtcGxhY2Vob2xkZXIgeyAgICBjb2xvcjogJ3t7IGZvcmVncm91bmQtMSB9fSc7IH1tZC1zZWxlY3QubWQtVEhFTUVfTkFNRS10aGVtZTpub3QoW2Rpc2FibGVkXSk6Zm9jdXMubWQtYWNjZW50IC5tZC1zZWxlY3QtbGFiZWwgeyAgYm9yZGVyLWJvdHRvbS1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWU6bm90KFtkaXNhYmxlZF0pOmZvY3VzLm1kLXdhcm4gLm1kLXNlbGVjdC1sYWJlbCB7ICBib3JkZXItYm90dG9tLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIC5tZC1zZWxlY3QtbGFiZWwgeyAgY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfSAgbWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIC5tZC1zZWxlY3QtbGFiZWwubWQtcGxhY2Vob2xkZXIgeyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtc2VsZWN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXNlbGVjdC1sYWJlbCB7ICBib3JkZXItYm90dG9tLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH0gIG1kLXNlbGVjdC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1zZWxlY3QtbGFiZWwubWQtcGxhY2Vob2xkZXIgeyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtc2VsZWN0LW1lbnUubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1vcHRncm91cCB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9ICBtZC1zZWxlY3QtbWVudS5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW9wdGdyb3VwIG1kLW9wdGlvbiB7ICAgIGNvbG9yOiAne3tmb3JlZ3JvdW5kLTF9fSc7IH1tZC1zZWxlY3QtbWVudS5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW9wdGlvbltzZWxlY3RlZF0geyAgY29sb3I6ICd7e3ByaW1hcnktNTAwfX0nOyB9ICBtZC1zZWxlY3QtbWVudS5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW9wdGlvbltzZWxlY3RlZF06Zm9jdXMgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS02MDB9fSc7IH0gIG1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uW3NlbGVjdGVkXS5tZC1hY2NlbnQgeyAgICBjb2xvcjogJ3t7YWNjZW50LTUwMH19JzsgfSAgICBtZC1zZWxlY3QtbWVudS5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLW9wdGlvbltzZWxlY3RlZF0ubWQtYWNjZW50OmZvY3VzIHsgICAgICBjb2xvcjogJ3t7YWNjZW50LTYwMH19JzsgfW1kLXNlbGVjdC1tZW51Lm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtb3B0aW9uOmZvY3VzOm5vdChbc2VsZWN0ZWRdKSB7ICBiYWNrZ3JvdW5kOiAne3tiYWNrZ3JvdW5kLTIwMH19JzsgfW1kLXNpZGVuYXYubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRyYWNrIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2ZvcmVncm91bmQtM319JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC10cmFjay10aWNrcyB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtZm9jdXMtdGh1bWIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWZvY3VzLXJpbmcgeyAgYm9yZGVyLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTR9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtZGlzYWJsZWQtdGh1bWIgeyAgYm9yZGVyLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtbWluIC5tZC10aHVtYjphZnRlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tiYWNrZ3JvdW5kLWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRyYWNrLm1kLXRyYWNrLWZpbGwgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRodW1iOmFmdGVyIHsgIGJvcmRlci1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXNpZ24geyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9ICBtZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtc2lnbjphZnRlciB7ICAgIGJvcmRlci10b3AtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC10aHVtYi10ZXh0IHsgIGNvbG9yOiAne3thY2NlbnQtY29udHJhc3R9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC10cmFjay5tZC10cmFjay1maWxsIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC10aHVtYjphZnRlciB7ICBib3JkZXItY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtd2FybiAubWQtc2lnbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9ICBtZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIC5tZC1zaWduOmFmdGVyIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gLm1kLXRodW1iLXRleHQgeyAgY29sb3I6ICd7e3dhcm4tY29udHJhc3R9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IC5tZC10cmFjay5tZC10cmFjay1maWxsIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IC5tZC10aHVtYjphZnRlciB7ICBib3JkZXItY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtcHJpbWFyeSAubWQtc2lnbiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9ICBtZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IC5tZC1zaWduOmFmdGVyIHsgICAgYm9yZGVyLXRvcC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXNsaWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgLm1kLXRodW1iLXRleHQgeyAgY29sb3I6ICd7e3ByaW1hcnktY29udHJhc3R9fSc7IH1tZC1zbGlkZXIubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLXRodW1iOmFmdGVyIHsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9bWQtc2xpZGVyLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdOm5vdCgubWQtbWluKSAubWQtdGh1bWI6YWZ0ZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9Lm1kLXN1YmhlYWRlci5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGNvbG9yOiAne3sgZm9yZWdyb3VuZC0yLTAuMjMgfX0nOyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC1jb2xvcn19JzsgfSAgLm1kLXN1YmhlYWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgLm1kLXN1YmhlYWRlci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCB7ICAgIGNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH0gIC5tZC1zdWJoZWFkZXIubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIHsgICAgY29sb3I6ICd7e3dhcm4tY29sb3J9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGh1bWIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YmFja2dyb3VuZC01MDB9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yLTAuNX19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQubWQtZm9jdXNlZCAubWQtdGh1bWI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvci0wLjI2fX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC1wcmltYXJ5IC5tZC10aHVtYiB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC1wcmltYXJ5IC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7cHJpbWFyeS1jb2xvci0wLjV9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1jaGVja2VkLm1kLXByaW1hcnkubWQtZm9jdXNlZCAubWQtdGh1bWI6YmVmb3JlIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3ItMC4yNn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQubWQtd2FybiAubWQtdGh1bWIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7d2Fybi1jb2xvcn19JzsgfW1kLXN3aXRjaC5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWNoZWNrZWQubWQtd2FybiAubWQtYmFyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3dhcm4tY29sb3ItMC41fX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWUubWQtY2hlY2tlZC5tZC13YXJuLm1kLWZvY3VzZWQgLm1kLXRodW1iOmJlZm9yZSB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yLTAuMjZ9fSc7IH1tZC1zd2l0Y2gubWQtVEhFTUVfTkFNRS10aGVtZVtkaXNhYmxlZF0gLm1kLXRodW1iIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e2JhY2tncm91bmQtNDAwfX0nOyB9bWQtc3dpdGNoLm1kLVRIRU1FX05BTUUtdGhlbWVbZGlzYWJsZWRdIC5tZC1iYXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00fX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgIGJvcmRlci1jb2xvcjogJ3t7Zm9yZWdyb3VuZC00fX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1wYWdpbmF0b3IgbWQtaWNvbiB7ICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfW1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC1pbmstYmFyIHsgIGNvbG9yOiAne3thY2NlbnQtY29sb3J9fSc7ICBiYWNrZ3JvdW5kOiAne3thY2NlbnQtY29sb3J9fSc7IH1tZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRhYiB7ICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0yfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRhYltkaXNhYmxlZF0geyAgICBjb2xvcjogJ3t7Zm9yZWdyb3VuZC0zfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRhYi5tZC1hY3RpdmUsIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtdGFiLm1kLWZvY3VzZWQgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb2xvcn19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC10YWIubWQtZm9jdXNlZCB7ICAgIGJhY2tncm91bmQ6ICd7e3ByaW1hcnktY29sb3ItMC4xfX0nOyB9ICBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLXRhYiAubWQtcmlwcGxlLWNvbnRhaW5lciB7ICAgIGNvbG9yOiAne3thY2NlbnQtMTAwfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC10YWJzLXdyYXBwZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkgeyAgY29sb3I6ICd7e2FjY2VudC0xMDB9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWFjdGl2ZSwgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3thY2NlbnQtY29udHJhc3R9fSc7IH0gIG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1hY2NlbnQgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3thY2NlbnQtY29udHJhc3QtMC4xfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCBtZC1pbmstYmFyIHsgIGNvbG9yOiAne3twcmltYXJ5LTYwMC0xfX0nOyAgYmFja2dyb3VuZDogJ3t7cHJpbWFyeS02MDAtMX19JzsgfW1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZS5tZC1wcmltYXJ5IG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3twcmltYXJ5LWNvbG9yfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pIHsgIGNvbG9yOiAne3twcmltYXJ5LTEwMH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWFjdGl2ZSwgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXByaW1hcnkgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3twcmltYXJ5LWNvbnRyYXN0LTAuMX19JzsgfW1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZS5tZC13YXJuIG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pIHsgIGNvbG9yOiAne3t3YXJuLTEwMH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWFjdGl2ZSwgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBjb2xvcjogJ3t7d2Fybi1jb250cmFzdH19JzsgfSAgbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4gbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBiYWNrZ3JvdW5kOiAne3t3YXJuLWNvbnRyYXN0LTAuMX19JzsgfW1kLXRvb2xiYXIgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFicy13cmFwcGVyIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7IH1tZC10b29sYmFyID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKSB7ICBjb2xvcjogJ3t7cHJpbWFyeS0xMDB9fSc7IH0gIG1kLXRvb2xiYXIgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWFjdGl2ZSwgbWQtdG9vbGJhciA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3twcmltYXJ5LWNvbnRyYXN0fX0nOyB9ICBtZC10b29sYmFyID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZDogJ3t7cHJpbWFyeS1jb250cmFzdC0wLjF9fSc7IH1tZC10b29sYmFyLm1kLWFjY2VudCA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWJzLXdyYXBwZXIgeyAgYmFja2dyb3VuZC1jb2xvcjogJ3t7YWNjZW50LWNvbG9yfX0nOyB9bWQtdG9vbGJhci5tZC1hY2NlbnQgPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pIHsgIGNvbG9yOiAne3thY2NlbnQtMTAwfX0nOyB9ICBtZC10b29sYmFyLm1kLWFjY2VudCA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10b29sYmFyLm1kLWFjY2VudCA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtZm9jdXNlZCB7ICAgIGNvbG9yOiAne3thY2NlbnQtY29udHJhc3R9fSc7IH0gIG1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZDogJ3t7YWNjZW50LWNvbnRyYXN0LTAuMX19JzsgfW1kLXRvb2xiYXIubWQtYWNjZW50ID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWluay1iYXIgeyAgY29sb3I6ICd7e3ByaW1hcnktNjAwLTF9fSc7ICBiYWNrZ3JvdW5kOiAne3twcmltYXJ5LTYwMC0xfX0nOyB9bWQtdG9vbGJhci5tZC13YXJuID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYnMtd3JhcHBlciB7ICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyB9bWQtdG9vbGJhci5tZC13YXJuID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKSB7ICBjb2xvcjogJ3t7d2Fybi0xMDB9fSc7IH0gIG1kLXRvb2xiYXIubWQtd2FybiA+IG1kLXRhYnMubWQtVEhFTUVfTkFNRS10aGVtZSBtZC10YWItaXRlbTpub3QoW2Rpc2FibGVkXSkubWQtYWN0aXZlLCBtZC10b29sYmFyLm1kLXdhcm4gPiBtZC10YWJzLm1kLVRIRU1FX05BTUUtdGhlbWUgbWQtdGFiLWl0ZW06bm90KFtkaXNhYmxlZF0pLm1kLWZvY3VzZWQgeyAgICBjb2xvcjogJ3t7d2Fybi1jb250cmFzdH19JzsgfSAgbWQtdG9vbGJhci5tZC13YXJuID4gbWQtdGFicy5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLXRhYi1pdGVtOm5vdChbZGlzYWJsZWRdKS5tZC1mb2N1c2VkIHsgICAgYmFja2dyb3VuZDogJ3t7d2Fybi1jb250cmFzdC0wLjF9fSc7IH1tZC10b2FzdC5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICMzMjMyMzI7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC01MH19JzsgfSAgbWQtdG9hc3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYnV0dG9uIHsgICAgY29sb3I6ICd7e2JhY2tncm91bmQtNTB9fSc7IH0gICAgbWQtdG9hc3QubWQtVEhFTUVfTkFNRS10aGVtZSAubWQtYnV0dG9uLm1kLWhpZ2hsaWdodCB7ICAgICAgY29sb3I6ICd7e3ByaW1hcnktQTIwMH19JzsgfSAgICAgIG1kLXRvYXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWJ1dHRvbi5tZC1oaWdobGlnaHQubWQtYWNjZW50IHsgICAgICAgIGNvbG9yOiAne3thY2NlbnQtQTIwMH19JzsgfSAgICAgIG1kLXRvYXN0Lm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWJ1dHRvbi5tZC1oaWdobGlnaHQubWQtd2FybiB7ICAgICAgICBjb2xvcjogJ3t7d2Fybi1BMjAwfX0nOyB9bWQtdG9vbGJhci5tZC1USEVNRV9OQU1FLXRoZW1lIHsgIGJhY2tncm91bmQtY29sb3I6ICd7e3ByaW1hcnktY29sb3J9fSc7ICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfSAgbWQtdG9vbGJhci5tZC1USEVNRV9OQU1FLXRoZW1lIG1kLWljb24geyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfSAgbWQtdG9vbGJhci5tZC1USEVNRV9OQU1FLXRoZW1lIC5tZC1idXR0b24geyAgICBjb2xvcjogJ3t7cHJpbWFyeS1jb250cmFzdH19JzsgfSAgbWQtdG9vbGJhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLWFjY2VudCB7ICAgIGJhY2tncm91bmQtY29sb3I6ICd7e2FjY2VudC1jb2xvcn19JzsgICAgY29sb3I6ICd7e2FjY2VudC1jb250cmFzdH19JzsgfSAgbWQtdG9vbGJhci5tZC1USEVNRV9OQU1FLXRoZW1lLm1kLXdhcm4geyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3t3YXJuLWNvbG9yfX0nOyAgICBjb2xvcjogJ3t7d2Fybi1jb250cmFzdH19JzsgfW1kLXRvb2x0aXAubWQtVEhFTUVfTkFNRS10aGVtZSB7ICBjb2xvcjogJ3t7YmFja2dyb3VuZC1BMTAwfX0nOyB9ICBtZC10b29sdGlwLm1kLVRIRU1FX05BTUUtdGhlbWUgLm1kLWJhY2tncm91bmQgeyAgICBiYWNrZ3JvdW5kLWNvbG9yOiAne3tmb3JlZ3JvdW5kLTJ9fSc7IH1cIik7IFxyXG59KSgpO1xyXG5cclxuXHJcbn0pKHdpbmRvdywgd2luZG93LmFuZ3VsYXIpOyIsIi8qXHJcbiBqUXVlcnkgVUkgU29ydGFibGUgcGx1Z2luIHdyYXBwZXJcclxuXHJcbiBAcGFyYW0gW3VpLXNvcnRhYmxlXSB7b2JqZWN0fSBPcHRpb25zIHRvIHBhc3MgdG8gJC5mbi5zb3J0YWJsZSgpIG1lcmdlZCBvbnRvIHVpLmNvbmZpZ1xyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ3VpLnNvcnRhYmxlJywgW10pXHJcbiAgLnZhbHVlKCd1aVNvcnRhYmxlQ29uZmlnJyx7fSlcclxuICAuZGlyZWN0aXZlKCd1aVNvcnRhYmxlJywgW1xyXG4gICAgJ3VpU29ydGFibGVDb25maWcnLCAnJHRpbWVvdXQnLCAnJGxvZycsXHJcbiAgICBmdW5jdGlvbih1aVNvcnRhYmxlQ29uZmlnLCAkdGltZW91dCwgJGxvZykge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlcXVpcmU6ICc/bmdNb2RlbCcsXHJcbiAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgIG5nTW9kZWw6ICc9JyxcclxuICAgICAgICAgIHVpU29ydGFibGU6ICc9J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsKSB7XHJcbiAgICAgICAgICB2YXIgc2F2ZWROb2RlcztcclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBjb21iaW5lQ2FsbGJhY2tzKGZpcnN0LHNlY29uZCl7XHJcbiAgICAgICAgICAgIGlmKHNlY29uZCAmJiAodHlwZW9mIHNlY29uZCA9PT0gJ2Z1bmN0aW9uJykpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBmaXJzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgc2Vjb25kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmlyc3Q7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0U29ydGFibGVXaWRnZXRJbnN0YW5jZShlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBmaXggdG8gc3VwcG9ydCBqcXVlcnktdWkgcHJpb3IgdG8gdjEuMTEueFxyXG4gICAgICAgICAgICAvLyBvdGhlcndpc2Ugd2Ugc2hvdWxkIGJlIHVzaW5nIGBlbGVtZW50LnNvcnRhYmxlKCdpbnN0YW5jZScpYFxyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IGVsZW1lbnQuZGF0YSgndWktc29ydGFibGUnKTtcclxuICAgICAgICAgICAgaWYgKGRhdGEgJiYgdHlwZW9mIGRhdGEgPT09ICdvYmplY3QnICYmIGRhdGEud2lkZ2V0RnVsbE5hbWUgPT09ICd1aS1zb3J0YWJsZScpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBmdW5jdGlvbiBoYXNTb3J0aW5nSGVscGVyIChlbGVtZW50LCB1aSkge1xyXG4gICAgICAgICAgICB2YXIgaGVscGVyT3B0aW9uID0gZWxlbWVudC5zb3J0YWJsZSgnb3B0aW9uJywnaGVscGVyJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBoZWxwZXJPcHRpb24gPT09ICdjbG9uZScgfHwgKHR5cGVvZiBoZWxwZXJPcHRpb24gPT09ICdmdW5jdGlvbicgJiYgdWkuaXRlbS5zb3J0YWJsZS5pc0N1c3RvbUhlbHBlclVzZWQoKSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gdGhhbmtzIGpxdWVyeS11aVxyXG4gICAgICAgICAgZnVuY3Rpb24gaXNGbG9hdGluZyAoaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKC9sZWZ0fHJpZ2h0LykudGVzdChpdGVtLmNzcygnZmxvYXQnKSkgfHwgKC9pbmxpbmV8dGFibGUtY2VsbC8pLnRlc3QoaXRlbS5jc3MoJ2Rpc3BsYXknKSk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZnVuY3Rpb24gZ2V0RWxlbWVudFNjb3BlKGVsZW1lbnRTY29wZXMsIGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudFNjb3Blcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgIHZhciB4ID0gZWxlbWVudFNjb3Blc1tpXTtcclxuICAgICAgICAgICAgICBpZiAoeC5lbGVtZW50WzBdID09PSBlbGVtZW50WzBdKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB4LnNjb3BlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZnVuY3Rpb24gYWZ0ZXJTdG9wKGUsIHVpKSB7XHJcbiAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuX2Rlc3Ryb3koKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB2YXIgb3B0cyA9IHt9O1xyXG5cclxuICAgICAgICAgIC8vIGRpcmVjdGl2ZSBzcGVjaWZpYyBvcHRpb25zXHJcbiAgICAgICAgICB2YXIgZGlyZWN0aXZlT3B0cyA9IHtcclxuICAgICAgICAgICAgJ3VpLWZsb2F0aW5nJzogdW5kZWZpbmVkXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIHZhciBjYWxsYmFja3MgPSB7XHJcbiAgICAgICAgICAgIHJlY2VpdmU6IG51bGwsXHJcbiAgICAgICAgICAgIHJlbW92ZTpudWxsLFxyXG4gICAgICAgICAgICBzdGFydDpudWxsLFxyXG4gICAgICAgICAgICBzdG9wOm51bGwsXHJcbiAgICAgICAgICAgIHVwZGF0ZTpudWxsXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIHZhciB3cmFwcGVycyA9IHtcclxuICAgICAgICAgICAgaGVscGVyOiBudWxsXHJcbiAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdHMsIGRpcmVjdGl2ZU9wdHMsIHVpU29ydGFibGVDb25maWcsIHNjb3BlLnVpU29ydGFibGUpO1xyXG5cclxuICAgICAgICAgIGlmICghYW5ndWxhci5lbGVtZW50LmZuIHx8ICFhbmd1bGFyLmVsZW1lbnQuZm4uanF1ZXJ5KSB7XHJcbiAgICAgICAgICAgICRsb2cuZXJyb3IoJ3VpLnNvcnRhYmxlOiBqUXVlcnkgc2hvdWxkIGJlIGluY2x1ZGVkIGJlZm9yZSBBbmd1bGFySlMhJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAobmdNb2RlbCkge1xyXG5cclxuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhZGQgb3IgcmVtb3ZlIGVsZW1lbnRzLCB3ZSBuZWVkIHRoZSBzb3J0YWJsZSB0byAncmVmcmVzaCdcclxuICAgICAgICAgICAgLy8gc28gaXQgY2FuIGZpbmQgdGhlIG5ldy9yZW1vdmVkIGVsZW1lbnRzLlxyXG4gICAgICAgICAgICBzY29wZS4kd2F0Y2goJ25nTW9kZWwubGVuZ3RoJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgLy8gVGltZW91dCB0byBsZXQgbmctcmVwZWF0IG1vZGlmeSB0aGUgRE9NXHJcbiAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBlbnN1cmUgdGhhdCB0aGUganF1ZXJ5LXVpLXNvcnRhYmxlIHdpZGdldCBpbnN0YW5jZVxyXG4gICAgICAgICAgICAgICAgLy8gaXMgc3RpbGwgYm91bmQgdG8gdGhlIGRpcmVjdGl2ZSdzIGVsZW1lbnRcclxuICAgICAgICAgICAgICAgIGlmICghIWdldFNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UoZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgICAgZWxlbWVudC5zb3J0YWJsZSgncmVmcmVzaCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0sIDAsIGZhbHNlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjYWxsYmFja3Muc3RhcnQgPSBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICAgIGlmIChvcHRzWyd1aS1mbG9hdGluZyddID09PSAnYXV0bycpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBkcmFnIGhhcyBzdGFydGVkLCB0aGUgZWxlbWVudCB3aWxsIGJlXHJcbiAgICAgICAgICAgICAgICAvLyBhYnNvbHV0ZWx5IHBvc2l0aW9uZWQsIHNvIHdlIGNoZWNrIGl0cyBzaWJsaW5nc1xyXG4gICAgICAgICAgICAgICAgdmFyIHNpYmxpbmdzID0gdWkuaXRlbS5zaWJsaW5ncygpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UgPSBnZXRTb3J0YWJsZVdpZGdldEluc3RhbmNlKGFuZ3VsYXIuZWxlbWVudChlLnRhcmdldCkpO1xyXG4gICAgICAgICAgICAgICAgc29ydGFibGVXaWRnZXRJbnN0YW5jZS5mbG9hdGluZyA9IGlzRmxvYXRpbmcoc2libGluZ3MpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gU2F2ZSB0aGUgc3RhcnRpbmcgcG9zaXRpb24gb2YgZHJhZ2dlZCBpdGVtXHJcbiAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZSA9IHtcclxuICAgICAgICAgICAgICAgIG1vZGVsOiBuZ01vZGVsLiRtb2RlbFZhbHVlW3VpLml0ZW0uaW5kZXgoKV0sXHJcbiAgICAgICAgICAgICAgICBpbmRleDogdWkuaXRlbS5pbmRleCgpLFxyXG4gICAgICAgICAgICAgICAgc291cmNlOiB1aS5pdGVtLnBhcmVudCgpLFxyXG4gICAgICAgICAgICAgICAgc291cmNlTW9kZWw6IG5nTW9kZWwuJG1vZGVsVmFsdWUsXHJcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5faXNDYW5jZWxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgaXNDYW5jZWxlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gdWkuaXRlbS5zb3J0YWJsZS5faXNDYW5jZWxlZDtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBpc0N1c3RvbUhlbHBlclVzZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuICEhdWkuaXRlbS5zb3J0YWJsZS5faXNDdXN0b21IZWxwZXJVc2VkO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIF9pc0NhbmNlbGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIF9pc0N1c3RvbUhlbHBlclVzZWQ6IHVpLml0ZW0uc29ydGFibGUuX2lzQ3VzdG9tSGVscGVyVXNlZCxcclxuICAgICAgICAgICAgICAgIF9kZXN0cm95OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh1aS5pdGVtLnNvcnRhYmxlLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZVtrZXldID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgY2FsbGJhY2tzLmFjdGl2YXRlID0gZnVuY3Rpb24oZSwgdWkpIHtcclxuICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIG1ha2UgYSBjb3B5IG9mIHRoZSBjdXJyZW50IGVsZW1lbnQncyBjb250ZW50cyBzb1xyXG4gICAgICAgICAgICAgIC8vIHdlIGNhbiByZXN0b3JlIGl0IGFmdGVyIHNvcnRhYmxlIGhhcyBtZXNzZWQgaXQgdXAuXHJcbiAgICAgICAgICAgICAgLy8gVGhpcyBpcyBpbnNpZGUgYWN0aXZhdGUgKGluc3RlYWQgb2Ygc3RhcnQpIGluIG9yZGVyIHRvIHNhdmVcclxuICAgICAgICAgICAgICAvLyBib3RoIGxpc3RzIHdoZW4gZHJhZ2dpbmcgYmV0d2VlbiBjb25uZWN0ZWQgbGlzdHMuXHJcbiAgICAgICAgICAgICAgc2F2ZWROb2RlcyA9IGVsZW1lbnQuY29udGVudHMoKTtcclxuXHJcbiAgICAgICAgICAgICAgLy8gSWYgdGhpcyBsaXN0IGhhcyBhIHBsYWNlaG9sZGVyICh0aGUgY29ubmVjdGVkIGxpc3RzIHdvbid0KSxcclxuICAgICAgICAgICAgICAvLyBkb24ndCBpbmxjdWRlIGl0IGluIHNhdmVkIG5vZGVzLlxyXG4gICAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlciA9IGVsZW1lbnQuc29ydGFibGUoJ29wdGlvbicsJ3BsYWNlaG9sZGVyJyk7XHJcblxyXG4gICAgICAgICAgICAgIC8vIHBsYWNlaG9sZGVyLmVsZW1lbnQgd2lsbCBiZSBhIGZ1bmN0aW9uIGlmIHRoZSBwbGFjZWhvbGRlciwgaGFzXHJcbiAgICAgICAgICAgICAgLy8gYmVlbiBjcmVhdGVkIChwbGFjZWhvbGRlciB3aWxsIGJlIGFuIG9iamVjdCkuICBJZiBpdCBoYXNuJ3RcclxuICAgICAgICAgICAgICAvLyBiZWVuIGNyZWF0ZWQsIGVpdGhlciBwbGFjZWhvbGRlciB3aWxsIGJlIGZhbHNlIGlmIG5vXHJcbiAgICAgICAgICAgICAgLy8gcGxhY2Vob2xkZXIgY2xhc3Mgd2FzIGdpdmVuIG9yIHBsYWNlaG9sZGVyLmVsZW1lbnQgd2lsbCBiZVxyXG4gICAgICAgICAgICAgIC8vIHVuZGVmaW5lZCBpZiBhIGNsYXNzIHdhcyBnaXZlbiAocGxhY2Vob2xkZXIgd2lsbCBiZSBhIHN0cmluZylcclxuICAgICAgICAgICAgICBpZiAocGxhY2Vob2xkZXIgJiYgcGxhY2Vob2xkZXIuZWxlbWVudCAmJiB0eXBlb2YgcGxhY2Vob2xkZXIuZWxlbWVudCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBoRWxlbWVudCA9IHBsYWNlaG9sZGVyLmVsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgIC8vIHdvcmthcm91bmQgZm9yIGpxdWVyeSB1aSAxLjkueCxcclxuICAgICAgICAgICAgICAgIC8vIG5vdCByZXR1cm5pbmcganF1ZXJ5IGNvbGxlY3Rpb25cclxuICAgICAgICAgICAgICAgIHBoRWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudChwaEVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGV4YWN0IG1hdGNoIHdpdGggdGhlIHBsYWNlaG9sZGVyJ3MgY2xhc3MgYXR0cmlidXRlIHRvIGhhbmRsZVxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIGNhc2UgdGhhdCBtdWx0aXBsZSBjb25uZWN0ZWQgc29ydGFibGVzIGV4aXN0IGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIHBsYWNlaG9pbGRlciBvcHRpb24gZXF1YWxzIHRoZSBjbGFzcyBvZiBzb3J0YWJsZSBpdGVtc1xyXG4gICAgICAgICAgICAgICAgdmFyIGV4Y2x1ZGVzID0gZWxlbWVudC5maW5kKCdbY2xhc3M9XCInICsgcGhFbGVtZW50LmF0dHIoJ2NsYXNzJykgKyAnXCJdOm5vdChbbmctcmVwZWF0XSwgW2RhdGEtbmctcmVwZWF0XSknKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzYXZlZE5vZGVzID0gc2F2ZWROb2Rlcy5ub3QoZXhjbHVkZXMpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gc2F2ZSB0aGUgZGlyZWN0aXZlJ3Mgc2NvcGUgc28gdGhhdCBpdCBpcyBhY2Nlc3NpYmxlIGZyb20gdWkuaXRlbS5zb3J0YWJsZVxyXG4gICAgICAgICAgICAgIHZhciBjb25uZWN0ZWRTb3J0YWJsZXMgPSB1aS5pdGVtLnNvcnRhYmxlLl9jb25uZWN0ZWRTb3J0YWJsZXMgfHwgW107XHJcblxyXG4gICAgICAgICAgICAgIGNvbm5lY3RlZFNvcnRhYmxlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBzY29wZTogc2NvcGVcclxuICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5fY29ubmVjdGVkU29ydGFibGVzID0gY29ubmVjdGVkU29ydGFibGVzO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgY2FsbGJhY2tzLnVwZGF0ZSA9IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgICAgLy8gU2F2ZSBjdXJyZW50IGRyb3AgcG9zaXRpb24gYnV0IG9ubHkgaWYgdGhpcyBpcyBub3QgYSBzZWNvbmRcclxuICAgICAgICAgICAgICAvLyB1cGRhdGUgdGhhdCBoYXBwZW5zIHdoZW4gbW92aW5nIGJldHdlZW4gbGlzdHMgYmVjYXVzZSB0aGVuXHJcbiAgICAgICAgICAgICAgLy8gdGhlIHZhbHVlIHdpbGwgYmUgb3ZlcndyaXR0ZW4gd2l0aCB0aGUgb2xkIHZhbHVlXHJcbiAgICAgICAgICAgICAgaWYoIXVpLml0ZW0uc29ydGFibGUucmVjZWl2ZWQpIHtcclxuICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuZHJvcGluZGV4ID0gdWkuaXRlbS5pbmRleCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRyb3B0YXJnZXQgPSB1aS5pdGVtLnBhcmVudCgpO1xyXG4gICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5kcm9wdGFyZ2V0ID0gZHJvcHRhcmdldDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZHJvcHRhcmdldFNjb3BlID0gZ2V0RWxlbWVudFNjb3BlKHVpLml0ZW0uc29ydGFibGUuX2Nvbm5lY3RlZFNvcnRhYmxlcywgZHJvcHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLmRyb3B0YXJnZXRNb2RlbCA9IGRyb3B0YXJnZXRTY29wZS5uZ01vZGVsO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIENhbmNlbCB0aGUgc29ydCAobGV0IG5nLXJlcGVhdCBkbyB0aGUgc29ydCBmb3IgdXMpXHJcbiAgICAgICAgICAgICAgICAvLyBEb24ndCBjYW5jZWwgaWYgdGhpcyBpcyB0aGUgcmVjZWl2ZWQgbGlzdCBiZWNhdXNlIGl0IGhhc1xyXG4gICAgICAgICAgICAgICAgLy8gYWxyZWFkeSBiZWVuIGNhbmNlbGVkIGluIHRoZSBvdGhlciBsaXN0LCBhbmQgdHJ5aW5nIHRvIGNhbmNlbFxyXG4gICAgICAgICAgICAgICAgLy8gaGVyZSB3aWxsIG1lc3MgdXAgdGhlIERPTS5cclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc29ydGFibGUoJ2NhbmNlbCcpO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgLy8gUHV0IHRoZSBub2RlcyBiYWNrIGV4YWN0bHkgdGhlIHdheSB0aGV5IHN0YXJ0ZWQgKHRoaXMgaXMgdmVyeVxyXG4gICAgICAgICAgICAgIC8vIGltcG9ydGFudCBiZWNhdXNlIG5nLXJlcGVhdCB1c2VzIGNvbW1lbnQgZWxlbWVudHMgdG8gZGVsaW5lYXRlXHJcbiAgICAgICAgICAgICAgLy8gdGhlIHN0YXJ0IGFuZCBzdG9wIG9mIHJlcGVhdCBzZWN0aW9ucyBhbmQgc29ydGFibGUgZG9lc24ndFxyXG4gICAgICAgICAgICAgIC8vIHJlc3BlY3QgdGhlaXIgb3JkZXIgKGV2ZW4gaWYgd2UgY2FuY2VsLCB0aGUgb3JkZXIgb2YgdGhlXHJcbiAgICAgICAgICAgICAgLy8gY29tbWVudHMgYXJlIHN0aWxsIG1lc3NlZCB1cCkuXHJcbiAgICAgICAgICAgICAgaWYgKGhhc1NvcnRpbmdIZWxwZXIoZWxlbWVudCwgdWkpICYmICF1aS5pdGVtLnNvcnRhYmxlLnJlY2VpdmVkICYmXHJcbiAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc29ydGFibGUoICdvcHRpb24nLCAnYXBwZW5kVG8nICkgPT09ICdwYXJlbnQnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXN0b3JlIGFsbCB0aGUgc2F2ZWROb2RlcyBleGNlcHQgLnVpLXNvcnRhYmxlLWhlbHBlciBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICAvLyAod2hpY2ggaXMgcGxhY2VkIGxhc3QpLiBUaGF0IHdheSBpdCB3aWxsIGJlIGdhcmJhZ2UgY29sbGVjdGVkLlxyXG4gICAgICAgICAgICAgICAgc2F2ZWROb2RlcyA9IHNhdmVkTm9kZXMubm90KHNhdmVkTm9kZXMubGFzdCgpKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgc2F2ZWROb2Rlcy5hcHBlbmRUbyhlbGVtZW50KTtcclxuXHJcbiAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyB0aGUgdGFyZ2V0IGNvbm5lY3RlZCBsaXN0IHRoZW5cclxuICAgICAgICAgICAgICAvLyBpdCdzIHNhZmUgdG8gY2xlYXIgdGhlIHJlc3RvcmVkIG5vZGVzIHNpbmNlOlxyXG4gICAgICAgICAgICAgIC8vIHVwZGF0ZSBpcyBjdXJyZW50bHkgcnVubmluZyBhbmRcclxuICAgICAgICAgICAgICAvLyBzdG9wIGlzIG5vdCBjYWxsZWQgZm9yIHRoZSB0YXJnZXQgbGlzdC5cclxuICAgICAgICAgICAgICBpZih1aS5pdGVtLnNvcnRhYmxlLnJlY2VpdmVkKSB7XHJcbiAgICAgICAgICAgICAgICBzYXZlZE5vZGVzID0gbnVsbDtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIElmIHJlY2VpdmVkIGlzIHRydWUgKGFuIGl0ZW0gd2FzIGRyb3BwZWQgaW4gZnJvbSBhbm90aGVyIGxpc3QpXHJcbiAgICAgICAgICAgICAgLy8gdGhlbiB3ZSBhZGQgdGhlIG5ldyBpdGVtIHRvIHRoaXMgbGlzdCBvdGhlcndpc2Ugd2FpdCB1bnRpbCB0aGVcclxuICAgICAgICAgICAgICAvLyBzdG9wIGV2ZW50IHdoZXJlIHdlIHdpbGwga25vdyBpZiBpdCB3YXMgYSBzb3J0IG9yIGl0ZW0gd2FzXHJcbiAgICAgICAgICAgICAgLy8gbW92ZWQgaGVyZSBmcm9tIGFub3RoZXIgbGlzdFxyXG4gICAgICAgICAgICAgIGlmKHVpLml0ZW0uc29ydGFibGUucmVjZWl2ZWQgJiYgIXVpLml0ZW0uc29ydGFibGUuaXNDYW5jZWxlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICBuZ01vZGVsLiRtb2RlbFZhbHVlLnNwbGljZSh1aS5pdGVtLnNvcnRhYmxlLmRyb3BpbmRleCwgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5tb3ZlZCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBjYWxsYmFja3Muc3RvcCA9IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgICAgLy8gSWYgdGhlIHJlY2VpdmVkIGZsYWcgaGFzbid0IGJlIHNldCBvbiB0aGUgaXRlbSwgdGhpcyBpcyBhXHJcbiAgICAgICAgICAgICAgLy8gbm9ybWFsIHNvcnQsIGlmIGRyb3BpbmRleCBpcyBzZXQsIHRoZSBpdGVtIHdhcyBtb3ZlZCwgc28gbW92ZVxyXG4gICAgICAgICAgICAgIC8vIHRoZSBpdGVtcyBpbiB0aGUgbGlzdC5cclxuICAgICAgICAgICAgICBpZighdWkuaXRlbS5zb3J0YWJsZS5yZWNlaXZlZCAmJlxyXG4gICAgICAgICAgICAgICAgICgnZHJvcGluZGV4JyBpbiB1aS5pdGVtLnNvcnRhYmxlKSAmJlxyXG4gICAgICAgICAgICAgICAgICF1aS5pdGVtLnNvcnRhYmxlLmlzQ2FuY2VsZWQoKSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJG1vZGVsVmFsdWUuc3BsaWNlKFxyXG4gICAgICAgICAgICAgICAgICAgIHVpLml0ZW0uc29ydGFibGUuZHJvcGluZGV4LCAwLFxyXG4gICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJG1vZGVsVmFsdWUuc3BsaWNlKHVpLml0ZW0uc29ydGFibGUuaW5kZXgsIDEpWzBdKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgaXRlbSB3YXMgbm90IG1vdmVkLCB0aGVuIHJlc3RvcmUgdGhlIGVsZW1lbnRzXHJcbiAgICAgICAgICAgICAgICAvLyBzbyB0aGF0IHRoZSBuZ1JlcGVhdCdzIGNvbW1lbnQgYXJlIGNvcnJlY3QuXHJcbiAgICAgICAgICAgICAgICBpZiAoKCEoJ2Ryb3BpbmRleCcgaW4gdWkuaXRlbS5zb3J0YWJsZSkgfHwgdWkuaXRlbS5zb3J0YWJsZS5pc0NhbmNlbGVkKCkpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIWhhc1NvcnRpbmdIZWxwZXIoZWxlbWVudCwgdWkpKSB7XHJcbiAgICAgICAgICAgICAgICAgIHNhdmVkTm9kZXMuYXBwZW5kVG8oZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyBJdCdzIG5vdyBzYWZlIHRvIGNsZWFyIHRoZSBzYXZlZE5vZGVzXHJcbiAgICAgICAgICAgICAgLy8gc2luY2Ugc3RvcCBpcyB0aGUgbGFzdCBjYWxsYmFjay5cclxuICAgICAgICAgICAgICBzYXZlZE5vZGVzID0gbnVsbDtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNhbGxiYWNrcy5yZWNlaXZlID0gZnVuY3Rpb24oZSwgdWkpIHtcclxuICAgICAgICAgICAgICAvLyBBbiBpdGVtIHdhcyBkcm9wcGVkIGhlcmUgZnJvbSBhbm90aGVyIGxpc3QsIHNldCBhIGZsYWcgb24gdGhlXHJcbiAgICAgICAgICAgICAgLy8gaXRlbS5cclxuICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLnJlY2VpdmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNhbGxiYWNrcy5yZW1vdmUgPSBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGEgcHJvYmxlbSBvYnNlcnZlZCBpbiBuZXN0ZWQgY29ubmVjdGVkIGxpc3RzLlxyXG4gICAgICAgICAgICAgIC8vIFRoZXJlIHNob3VsZCBiZSBhbiAndXBkYXRlJyBldmVudCBiZWZvcmUgJ3JlbW92ZScgd2hlbiBtb3ZpbmdcclxuICAgICAgICAgICAgICAvLyBlbGVtZW50cy4gSWYgdGhlIGV2ZW50IGRpZCBub3QgZmlyZSwgY2FuY2VsIHNvcnRpbmcuXHJcbiAgICAgICAgICAgICAgaWYgKCEoJ2Ryb3BpbmRleCcgaW4gdWkuaXRlbS5zb3J0YWJsZSkpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc29ydGFibGUoJ2NhbmNlbCcpO1xyXG4gICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgaXRlbSBmcm9tIHRoaXMgbGlzdCdzIG1vZGVsIGFuZCBjb3B5IGRhdGEgaW50byBpdGVtLFxyXG4gICAgICAgICAgICAgIC8vIHNvIHRoZSBuZXh0IGxpc3QgY2FuIHJldHJpdmUgaXRcclxuICAgICAgICAgICAgICBpZiAoIXVpLml0ZW0uc29ydGFibGUuaXNDYW5jZWxlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICB1aS5pdGVtLnNvcnRhYmxlLm1vdmVkID0gbmdNb2RlbC4kbW9kZWxWYWx1ZS5zcGxpY2UoXHJcbiAgICAgICAgICAgICAgICAgICAgdWkuaXRlbS5zb3J0YWJsZS5pbmRleCwgMSlbMF07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB3cmFwcGVycy5oZWxwZXIgPSBmdW5jdGlvbiAoaW5uZXIpIHtcclxuICAgICAgICAgICAgICBpZiAoaW5uZXIgJiYgdHlwZW9mIGlubmVyID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUsIGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIGlubmVyUmVzdWx0ID0gaW5uZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgICAgICAgaXRlbS5zb3J0YWJsZS5faXNDdXN0b21IZWxwZXJVc2VkID0gaXRlbSAhPT0gaW5uZXJSZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiBpbm5lclJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIHJldHVybiBpbm5lcjtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHNjb3BlLiR3YXRjaCgndWlTb3J0YWJsZScsIGZ1bmN0aW9uKG5ld1ZhbCAvKiwgb2xkVmFsKi8pIHtcclxuICAgICAgICAgICAgICAvLyBlbnN1cmUgdGhhdCB0aGUganF1ZXJ5LXVpLXNvcnRhYmxlIHdpZGdldCBpbnN0YW5jZVxyXG4gICAgICAgICAgICAgIC8vIGlzIHN0aWxsIGJvdW5kIHRvIHRoZSBkaXJlY3RpdmUncyBlbGVtZW50XHJcbiAgICAgICAgICAgICAgdmFyIHNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UgPSBnZXRTb3J0YWJsZVdpZGdldEluc3RhbmNlKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgIGlmICghIXNvcnRhYmxlV2lkZ2V0SW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChuZXdWYWwsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBhIGN1c3RvbSBvcHRpb24gb2YgdGhlIGRpcmVjdGl2ZSxcclxuICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIGl0IGFwcHJvcHJpZXRseVxyXG4gICAgICAgICAgICAgICAgICBpZiAoa2V5IGluIGRpcmVjdGl2ZU9wdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAndWktZmxvYXRpbmcnICYmICh2YWx1ZSA9PT0gZmFsc2UgfHwgdmFsdWUgPT09IHRydWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZVdpZGdldEluc3RhbmNlLmZsb2F0aW5nID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBvcHRzW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgIGlmIChjYWxsYmFja3Nba2V5XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBrZXkgPT09ICdzdG9wJyApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgLy8gY2FsbCBhcHBseSBhZnRlciBzdG9wXHJcbiAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGNvbWJpbmVDYWxsYmFja3MoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLCBmdW5jdGlvbigpIHsgc2NvcGUuJGFwcGx5KCk7IH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gY29tYmluZUNhbGxiYWNrcyh2YWx1ZSwgYWZ0ZXJTdG9wKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd3JhcCB0aGUgY2FsbGJhY2tcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGNvbWJpbmVDYWxsYmFja3MoY2FsbGJhY2tzW2tleV0sIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3cmFwcGVyc1trZXldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwcGVyc1trZXldKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgb3B0c1trZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc29ydGFibGUoJ29wdGlvbicsIGtleSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjYWxsYmFja3MsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICBvcHRzW2tleV0gPSBjb21iaW5lQ2FsbGJhY2tzKHZhbHVlLCBvcHRzW2tleV0pO1xyXG4gICAgICAgICAgICAgIGlmKCBrZXkgPT09ICdzdG9wJyApe1xyXG4gICAgICAgICAgICAgICAgb3B0c1trZXldID0gY29tYmluZUNhbGxiYWNrcyhvcHRzW2tleV0sIGFmdGVyU3RvcCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkbG9nLmluZm8oJ3VpLnNvcnRhYmxlOiBuZ01vZGVsIG5vdCBwcm92aWRlZCEnLCBlbGVtZW50KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAvLyBDcmVhdGUgc29ydGFibGVcclxuICAgICAgICAgIGVsZW1lbnQuc29ydGFibGUob3B0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIF0pO1xyXG4iLCJ2YXIgZmFicmljPWZhYnJpY3x8e3ZlcnNpb246XCIxLjUuMFwifTtcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cyYmKGV4cG9ydHMuZmFicmljPWZhYnJpYyksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGRvY3VtZW50JiZcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93PyhmYWJyaWMuZG9jdW1lbnQ9ZG9jdW1lbnQsZmFicmljLndpbmRvdz13aW5kb3csd2luZG93LmZhYnJpYz1mYWJyaWMpOihmYWJyaWMuZG9jdW1lbnQ9cmVxdWlyZShcImpzZG9tXCIpLmpzZG9tKFwiPCFET0NUWVBFIGh0bWw+PGh0bWw+PGhlYWQ+PC9oZWFkPjxib2R5PjwvYm9keT48L2h0bWw+XCIpLGZhYnJpYy5kb2N1bWVudC5jcmVhdGVXaW5kb3c/ZmFicmljLndpbmRvdz1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlV2luZG93KCk6ZmFicmljLndpbmRvdz1mYWJyaWMuZG9jdW1lbnQucGFyZW50V2luZG93KSxmYWJyaWMuaXNUb3VjaFN1cHBvcnRlZD1cIm9udG91Y2hzdGFydFwiaW4gZmFicmljLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxmYWJyaWMuaXNMaWtlbHlOb2RlPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBCdWZmZXImJlwidW5kZWZpbmVkXCI9PXR5cGVvZiB3aW5kb3csZmFicmljLlNIQVJFRF9BVFRSSUJVVEVTPVtcImRpc3BsYXlcIixcInRyYW5zZm9ybVwiLFwiZmlsbFwiLFwiZmlsbC1vcGFjaXR5XCIsXCJmaWxsLXJ1bGVcIixcIm9wYWNpdHlcIixcInN0cm9rZVwiLFwic3Ryb2tlLWRhc2hhcnJheVwiLFwic3Ryb2tlLWxpbmVjYXBcIixcInN0cm9rZS1saW5lam9pblwiLFwic3Ryb2tlLW1pdGVybGltaXRcIixcInN0cm9rZS1vcGFjaXR5XCIsXCJzdHJva2Utd2lkdGhcIl0sZmFicmljLkRQST05NixmYWJyaWMucmVOdW09XCIoPzpbLStdPyg/OlxcXFxkK3xcXFxcZCpcXFxcLlxcXFxkKykoPzplWy0rXT9cXFxcZCspPylcIixmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt0aGlzLl9fZXZlbnRMaXN0ZW5lcnNbdF0mJihlP2ZhYnJpYy51dGlsLnJlbW92ZUZyb21BcnJheSh0aGlzLl9fZXZlbnRMaXN0ZW5lcnNbdF0sZSk6dGhpcy5fX2V2ZW50TGlzdGVuZXJzW3RdLmxlbmd0aD0wKX1mdW5jdGlvbiBlKHQsZSl7aWYodGhpcy5fX2V2ZW50TGlzdGVuZXJzfHwodGhpcy5fX2V2ZW50TGlzdGVuZXJzPXt9KSwxPT09YXJndW1lbnRzLmxlbmd0aClmb3IodmFyIGkgaW4gdCl0aGlzLm9uKGksdFtpXSk7ZWxzZSB0aGlzLl9fZXZlbnRMaXN0ZW5lcnNbdF18fCh0aGlzLl9fZXZlbnRMaXN0ZW5lcnNbdF09W10pLHRoaXMuX19ldmVudExpc3RlbmVyc1t0XS5wdXNoKGUpO3JldHVybiB0aGlzfWZ1bmN0aW9uIGkoZSxpKXtpZih0aGlzLl9fZXZlbnRMaXN0ZW5lcnMpe2lmKDA9PT1hcmd1bWVudHMubGVuZ3RoKXRoaXMuX19ldmVudExpc3RlbmVycz17fTtlbHNlIGlmKDE9PT1hcmd1bWVudHMubGVuZ3RoJiZcIm9iamVjdFwiPT10eXBlb2YgYXJndW1lbnRzWzBdKWZvcih2YXIgciBpbiBlKXQuY2FsbCh0aGlzLHIsZVtyXSk7ZWxzZSB0LmNhbGwodGhpcyxlLGkpO3JldHVybiB0aGlzfX1mdW5jdGlvbiByKHQsZSl7aWYodGhpcy5fX2V2ZW50TGlzdGVuZXJzKXt2YXIgaT10aGlzLl9fZXZlbnRMaXN0ZW5lcnNbdF07aWYoaSl7Zm9yKHZhciByPTAscz1pLmxlbmd0aDtzPnI7cisrKWlbcl0uY2FsbCh0aGlzLGV8fHt9KTtyZXR1cm4gdGhpc319fWZhYnJpYy5PYnNlcnZhYmxlPXtvYnNlcnZlOmUsc3RvcE9ic2VydmluZzppLGZpcmU6cixvbjplLG9mZjppLHRyaWdnZXI6cn19KCksZmFicmljLkNvbGxlY3Rpb249e2FkZDpmdW5jdGlvbigpe3RoaXMuX29iamVjdHMucHVzaC5hcHBseSh0aGlzLl9vYmplY3RzLGFyZ3VtZW50cyk7Zm9yKHZhciB0PTAsZT1hcmd1bWVudHMubGVuZ3RoO2U+dDt0KyspdGhpcy5fb25PYmplY3RBZGRlZChhcmd1bWVudHNbdF0pO3JldHVybiB0aGlzLnJlbmRlck9uQWRkUmVtb3ZlJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXN9LGluc2VydEF0OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj10aGlzLmdldE9iamVjdHMoKTtyZXR1cm4gaT9yW2VdPXQ6ci5zcGxpY2UoZSwwLHQpLHRoaXMuX29uT2JqZWN0QWRkZWQodCksdGhpcy5yZW5kZXJPbkFkZFJlbW92ZSYmdGhpcy5yZW5kZXJBbGwoKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtmb3IodmFyIHQsZT10aGlzLmdldE9iamVjdHMoKSxpPTAscj1hcmd1bWVudHMubGVuZ3RoO3I+aTtpKyspdD1lLmluZGV4T2YoYXJndW1lbnRzW2ldKSwtMSE9PXQmJihlLnNwbGljZSh0LDEpLHRoaXMuX29uT2JqZWN0UmVtb3ZlZChhcmd1bWVudHNbaV0pKTtyZXR1cm4gdGhpcy5yZW5kZXJPbkFkZFJlbW92ZSYmdGhpcy5yZW5kZXJBbGwoKSx0aGlzfSxmb3JFYWNoT2JqZWN0OmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPXRoaXMuZ2V0T2JqZWN0cygpLHI9aS5sZW5ndGg7ci0tOyl0LmNhbGwoZSxpW3JdLHIsaSk7cmV0dXJuIHRoaXN9LGdldE9iamVjdHM6ZnVuY3Rpb24odCl7cmV0dXJuXCJ1bmRlZmluZWRcIj09dHlwZW9mIHQ/dGhpcy5fb2JqZWN0czp0aGlzLl9vYmplY3RzLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4gZS50eXBlPT09dH0pfSxpdGVtOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldE9iamVjdHMoKVt0XX0saXNFbXB0eTpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5nZXRPYmplY3RzKCkubGVuZ3RofSxzaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0T2JqZWN0cygpLmxlbmd0aH0sY29udGFpbnM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0T2JqZWN0cygpLmluZGV4T2YodCk+LTF9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkucmVkdWNlKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrPWUuY29tcGxleGl0eT9lLmNvbXBsZXhpdHkoKTowfSwwKX19LGZ1bmN0aW9uKHQpe3ZhciBlPU1hdGguc3FydCxpPU1hdGguYXRhbjIscj1NYXRoLlBJLzE4MDtmYWJyaWMudXRpbD17cmVtb3ZlRnJvbUFycmF5OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5pbmRleE9mKGUpO3JldHVybi0xIT09aSYmdC5zcGxpY2UoaSwxKSx0fSxnZXRSYW5kb21JbnQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihlLXQrMSkpK3R9LGRlZ3JlZXNUb1JhZGlhbnM6ZnVuY3Rpb24odCl7cmV0dXJuIHQqcn0scmFkaWFuc1RvRGVncmVlczpmdW5jdGlvbih0KXtyZXR1cm4gdC9yfSxyb3RhdGVQb2ludDpmdW5jdGlvbih0LGUsaSl7dmFyIHI9TWF0aC5zaW4oaSkscz1NYXRoLmNvcyhpKTt0LnN1YnRyYWN0RXF1YWxzKGUpO3ZhciBuPXQueCpzLXQueSpyLG89dC54KnIrdC55KnM7cmV0dXJuIG5ldyBmYWJyaWMuUG9pbnQobixvKS5hZGRFcXVhbHMoZSl9LHRyYW5zZm9ybVBvaW50OmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gaT9uZXcgZmFicmljLlBvaW50KGVbMF0qdC54K2VbMl0qdC55LGVbMV0qdC54K2VbM10qdC55KTpuZXcgZmFicmljLlBvaW50KGVbMF0qdC54K2VbMl0qdC55K2VbNF0sZVsxXSp0LngrZVszXSp0LnkrZVs1XSl9LGludmVydFRyYW5zZm9ybTpmdW5jdGlvbih0KXt2YXIgZT10LnNsaWNlKCksaT0xLyh0WzBdKnRbM10tdFsxXSp0WzJdKTtlPVtpKnRbM10sLWkqdFsxXSwtaSp0WzJdLGkqdFswXSwwLDBdO3ZhciByPWZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KHt4OnRbNF0seTp0WzVdfSxlKTtyZXR1cm4gZVs0XT0tci54LGVbNV09LXIueSxlfSx0b0ZpeGVkOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHBhcnNlRmxvYXQoTnVtYmVyKHQpLnRvRml4ZWQoZSkpfSxwYXJzZVVuaXQ6ZnVuY3Rpb24odCxlKXt2YXIgaT0vXFxEezAsMn0kLy5leGVjKHQpLHI9cGFyc2VGbG9hdCh0KTtzd2l0Y2goZXx8KGU9ZmFicmljLlRleHQuREVGQVVMVF9TVkdfRk9OVF9TSVpFKSxpWzBdKXtjYXNlXCJtbVwiOnJldHVybiByKmZhYnJpYy5EUEkvMjUuNDtjYXNlXCJjbVwiOnJldHVybiByKmZhYnJpYy5EUEkvMi41NDtjYXNlXCJpblwiOnJldHVybiByKmZhYnJpYy5EUEk7Y2FzZVwicHRcIjpyZXR1cm4gcipmYWJyaWMuRFBJLzcyO2Nhc2VcInBjXCI6cmV0dXJuIHIqZmFicmljLkRQSS83MioxMjtjYXNlXCJlbVwiOnJldHVybiByKmU7ZGVmYXVsdDpyZXR1cm4gcn19LGZhbHNlRnVuY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZ2V0S2xhc3M6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD1mYWJyaWMudXRpbC5zdHJpbmcuY2FtZWxpemUodC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpKSxmYWJyaWMudXRpbC5yZXNvbHZlTmFtZXNwYWNlKGUpW3RdfSxyZXNvbHZlTmFtZXNwYWNlOmZ1bmN0aW9uKGUpe2lmKCFlKXJldHVybiBmYWJyaWM7Zm9yKHZhciBpPWUuc3BsaXQoXCIuXCIpLHI9aS5sZW5ndGgscz10fHxmYWJyaWMud2luZG93LG49MDtyPm47KytuKXM9c1tpW25dXTtyZXR1cm4gc30sbG9hZEltYWdlOmZ1bmN0aW9uKHQsZSxpLHIpe2lmKCF0KXJldHVybiB2b2lkKGUmJmUuY2FsbChpLHQpKTt2YXIgcz1mYWJyaWMudXRpbC5jcmVhdGVJbWFnZSgpO3Mub25sb2FkPWZ1bmN0aW9uKCl7ZSYmZS5jYWxsKGkscykscz1zLm9ubG9hZD1zLm9uZXJyb3I9bnVsbH0scy5vbmVycm9yPWZ1bmN0aW9uKCl7ZmFicmljLmxvZyhcIkVycm9yIGxvYWRpbmcgXCIrcy5zcmMpLGUmJmUuY2FsbChpLG51bGwsITApLHM9cy5vbmxvYWQ9cy5vbmVycm9yPW51bGx9LDAhPT10LmluZGV4T2YoXCJkYXRhXCIpJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgciYmKHMuY3Jvc3NPcmlnaW49cikscy5zcmM9dH0sZW5saXZlbk9iamVjdHM6ZnVuY3Rpb24odCxlLGkscil7ZnVuY3Rpb24gcygpeysrbz09PWEmJmUmJmUobil9dD10fHxbXTt2YXIgbj1bXSxvPTAsYT10Lmxlbmd0aDtyZXR1cm4gYT92b2lkIHQuZm9yRWFjaChmdW5jdGlvbih0LGUpe2lmKCF0fHwhdC50eXBlKXJldHVybiB2b2lkIHMoKTt2YXIgbz1mYWJyaWMudXRpbC5nZXRLbGFzcyh0LnR5cGUsaSk7by5hc3luYz9vLmZyb21PYmplY3QodCxmdW5jdGlvbihpLG8pe298fChuW2VdPWksciYmcih0LG5bZV0pKSxzKCl9KToobltlXT1vLmZyb21PYmplY3QodCksciYmcih0LG5bZV0pLHMoKSl9KTp2b2lkKGUmJmUobikpfSxncm91cFNWR0VsZW1lbnRzOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcjtyZXR1cm4gcj1uZXcgZmFicmljLlBhdGhHcm91cCh0LGUpLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBpJiZyLnNldFNvdXJjZVBhdGgoaSkscn0scG9wdWxhdGVXaXRoUHJvcGVydGllczpmdW5jdGlvbih0LGUsaSl7aWYoaSYmXCJbb2JqZWN0IEFycmF5XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGkpKWZvcih2YXIgcj0wLHM9aS5sZW5ndGg7cz5yO3IrKylpW3JdaW4gdCYmKGVbaVtyXV09dFtpW3JdXSl9LGRyYXdEYXNoZWRMaW5lOmZ1bmN0aW9uKHQscixzLG4sbyxhKXt2YXIgaD1uLXIsYz1vLXMsbD1lKGgqaCtjKmMpLHU9aShjLGgpLGY9YS5sZW5ndGgsZD0wLGc9ITA7Zm9yKHQuc2F2ZSgpLHQudHJhbnNsYXRlKHIscyksdC5tb3ZlVG8oMCwwKSx0LnJvdGF0ZSh1KSxyPTA7bD5yOylyKz1hW2QrKyVmXSxyPmwmJihyPWwpLHRbZz9cImxpbmVUb1wiOlwibW92ZVRvXCJdKHIsMCksZz0hZzt0LnJlc3RvcmUoKX0sY3JlYXRlQ2FudmFzRWxlbWVudDpmdW5jdGlvbih0KXtyZXR1cm4gdHx8KHQ9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikpLHQuZ2V0Q29udGV4dHx8XCJ1bmRlZmluZWRcIj09dHlwZW9mIEdfdm1sQ2FudmFzTWFuYWdlcnx8R192bWxDYW52YXNNYW5hZ2VyLmluaXRFbGVtZW50KHQpLHR9LGNyZWF0ZUltYWdlOmZ1bmN0aW9uKCl7cmV0dXJuIGZhYnJpYy5pc0xpa2VseU5vZGU/bmV3KHJlcXVpcmUoXCJjYW52YXNcIikuSW1hZ2UpOmZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpfSxjcmVhdGVBY2Nlc3NvcnM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQucHJvdG90eXBlLGk9ZS5zdGF0ZVByb3BlcnRpZXMubGVuZ3RoO2ktLTspe3ZhciByPWUuc3RhdGVQcm9wZXJ0aWVzW2ldLHM9ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStyLnNsaWNlKDEpLG49XCJzZXRcIitzLG89XCJnZXRcIitzO2Vbb118fChlW29dPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzLmdldChcIicrdCsnXCIpJyl9KHIpKSxlW25dfHwoZVtuXT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IEZ1bmN0aW9uKFwidmFsdWVcIiwncmV0dXJuIHRoaXMuc2V0KFwiJyt0KydcIiwgdmFsdWUpJyl9KHIpKX19LGNsaXBDb250ZXh0OmZ1bmN0aW9uKHQsZSl7ZS5zYXZlKCksZS5iZWdpblBhdGgoKSx0LmNsaXBUbyhlKSxlLmNsaXAoKX0sbXVsdGlwbHlUcmFuc2Zvcm1NYXRyaWNlczpmdW5jdGlvbih0LGUpe3JldHVyblt0WzBdKmVbMF0rdFsyXSplWzFdLHRbMV0qZVswXSt0WzNdKmVbMV0sdFswXSplWzJdK3RbMl0qZVszXSx0WzFdKmVbMl0rdFszXSplWzNdLHRbMF0qZVs0XSt0WzJdKmVbNV0rdFs0XSx0WzFdKmVbNF0rdFszXSplWzVdK3RbNV1dfSxnZXRGdW5jdGlvbkJvZHk6ZnVuY3Rpb24odCl7cmV0dXJuKFN0cmluZyh0KS5tYXRjaCgvZnVuY3Rpb25bXntdKlxceyhbXFxzXFxTXSopXFx9Lyl8fHt9KVsxXX0saXNUcmFuc3BhcmVudDpmdW5jdGlvbih0LGUsaSxyKXtyPjAmJihlPnI/ZS09cjplPTAsaT5yP2ktPXI6aT0wKTtmb3IodmFyIHM9ITAsbj10LmdldEltYWdlRGF0YShlLGksMipyfHwxLDIqcnx8MSksbz0zLGE9bi5kYXRhLmxlbmd0aDthPm87bys9NCl7dmFyIGg9bi5kYXRhW29dO2lmKHM9MD49aCxzPT09ITEpYnJlYWt9cmV0dXJuIG49bnVsbCxzfX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQscixuLG8saCxjLGwpe3ZhciB1PWEuY2FsbChhcmd1bWVudHMpO2lmKHNbdV0pcmV0dXJuIHNbdV07dmFyIGY9TWF0aC5QSSxkPWwqZi8xODAsZz1NYXRoLnNpbihkKSxwPU1hdGguY29zKGQpLHY9MCxiPTA7bj1NYXRoLmFicyhuKSxvPU1hdGguYWJzKG8pO3ZhciBtPS1wKnQqLjUtZypyKi41LHk9LXAqciouNStnKnQqLjUsXz1uKm4seD1vKm8sQz15KnksUz1tKm0sdz1fKngtXypDLXgqUyxPPTA7aWYoMD53KXt2YXIgVD1NYXRoLnNxcnQoMS13LyhfKngpKTtuKj1ULG8qPVR9ZWxzZSBPPShoPT09Yz8tMToxKSpNYXRoLnNxcnQody8oXypDK3gqUykpO3ZhciBrPU8qbip5L28saj0tTypvKm0vbixBPXAqay1nKmorLjUqdCxQPWcqaytwKmorLjUqcixFPWkoMSwwLChtLWspL24sKHktaikvbyksTT1pKChtLWspL24sKHktaikvbywoLW0taykvbiwoLXktaikvbyk7MD09PWMmJk0+MD9NLT0yKmY6MT09PWMmJjA+TSYmKE0rPTIqZik7Zm9yKHZhciBJPU1hdGguY2VpbChNYXRoLmFicyhNL2YqMikpLEQ9W10sTD1NL0ksRj04LzMqTWF0aC5zaW4oTC80KSpNYXRoLnNpbihMLzQpL01hdGguc2luKEwvMiksUj1FK0wsQj0wO0k+QjtCKyspRFtCXT1lKEUsUixwLGcsbixvLEEsUCxGLHYsYiksdj1EW0JdWzRdLGI9RFtCXVs1XSxFPVIsUis9TDtyZXR1cm4gc1t1XT1ELER9ZnVuY3Rpb24gZSh0LGUsaSxyLHMsbyxoLGMsbCx1LGYpe3ZhciBkPWEuY2FsbChhcmd1bWVudHMpO2lmKG5bZF0pcmV0dXJuIG5bZF07dmFyIGc9TWF0aC5jb3ModCkscD1NYXRoLnNpbih0KSx2PU1hdGguY29zKGUpLGI9TWF0aC5zaW4oZSksbT1pKnMqdi1yKm8qYitoLHk9cipzKnYraSpvKmIrYyxfPXUrbCooLWkqcypwLXIqbypnKSx4PWYrbCooLXIqcypwK2kqbypnKSxDPW0rbCooaSpzKmIrcipvKnYpLFM9eStsKihyKnMqYi1pKm8qdik7cmV0dXJuIG5bZF09W18seCxDLFMsbSx5XSxuW2RdfWZ1bmN0aW9uIGkodCxlLGkscil7dmFyIHM9TWF0aC5hdGFuMihlLHQpLG49TWF0aC5hdGFuMihyLGkpO3JldHVybiBuPj1zP24tczoyKk1hdGguUEktKHMtbil9ZnVuY3Rpb24gcih0LGUsaSxyLHMsbixoLGMpe3ZhciBsPWEuY2FsbChhcmd1bWVudHMpO2lmKG9bbF0pcmV0dXJuIG9bbF07dmFyIHUsZixkLGcscCx2LGIsbSx5PU1hdGguc3FydCxfPU1hdGgubWluLHg9TWF0aC5tYXgsQz1NYXRoLmFicyxTPVtdLHc9W1tdLFtdXTtmPTYqdC0xMippKzYqcyx1PS0zKnQrOSppLTkqcyszKmgsZD0zKmktMyp0O2Zvcih2YXIgTz0wOzI+TzsrK08paWYoTz4wJiYoZj02KmUtMTIqcis2Km4sdT0tMyplKzkqci05Km4rMypjLGQ9MypyLTMqZSksQyh1KTwxZS0xMil7aWYoQyhmKTwxZS0xMiljb250aW51ZTtnPS1kL2YsZz4wJiYxPmcmJlMucHVzaChnKX1lbHNlIGI9ZipmLTQqZCp1LDA+Ynx8KG09eShiKSxwPSgtZittKS8oMip1KSxwPjAmJjE+cCYmUy5wdXNoKHApLHY9KC1mLW0pLygyKnUpLHY+MCYmMT52JiZTLnB1c2godikpO2Zvcih2YXIgVCxrLGosQT1TLmxlbmd0aCxQPUE7QS0tOylnPVNbQV0saj0xLWcsVD1qKmoqaip0KzMqaipqKmcqaSszKmoqZypnKnMrZypnKmcqaCx3WzBdW0FdPVQsaz1qKmoqaiplKzMqaipqKmcqciszKmoqZypnKm4rZypnKmcqYyx3WzFdW0FdPWs7d1swXVtQXT10LHdbMV1bUF09ZSx3WzBdW1ArMV09aCx3WzFdW1ArMV09Yzt2YXIgRT1be3g6Xy5hcHBseShudWxsLHdbMF0pLHk6Xy5hcHBseShudWxsLHdbMV0pfSx7eDp4LmFwcGx5KG51bGwsd1swXSkseTp4LmFwcGx5KG51bGwsd1sxXSl9XTtyZXR1cm4gb1tsXT1FLEV9dmFyIHM9e30sbj17fSxvPXt9LGE9QXJyYXkucHJvdG90eXBlLmpvaW47ZmFicmljLnV0aWwuZHJhd0FyYz1mdW5jdGlvbihlLGkscixzKXtmb3IodmFyIG49c1swXSxvPXNbMV0sYT1zWzJdLGg9c1szXSxjPXNbNF0sbD1zWzVdLHU9c1s2XSxmPVtbXSxbXSxbXSxbXV0sZD10KGwtaSx1LXIsbixvLGgsYyxhKSxnPTAscD1kLmxlbmd0aDtwPmc7ZysrKWZbZ11bMF09ZFtnXVswXStpLGZbZ11bMV09ZFtnXVsxXStyLGZbZ11bMl09ZFtnXVsyXStpLGZbZ11bM109ZFtnXVszXStyLGZbZ11bNF09ZFtnXVs0XStpLGZbZ11bNV09ZFtnXVs1XStyLGUuYmV6aWVyQ3VydmVUby5hcHBseShlLGZbZ10pfSxmYWJyaWMudXRpbC5nZXRCb3VuZHNPZkFyYz1mdW5jdGlvbihlLGkscyxuLG8sYSxoLGMsbCl7Zm9yKHZhciB1PTAsZj0wLGQ9W10sZz1bXSxwPXQoYy1lLGwtaSxzLG4sYSxoLG8pLHY9W1tdLFtdXSxiPTAsbT1wLmxlbmd0aDttPmI7YisrKWQ9cih1LGYscFtiXVswXSxwW2JdWzFdLHBbYl1bMl0scFtiXVszXSxwW2JdWzRdLHBbYl1bNV0pLHZbMF0ueD1kWzBdLngrZSx2WzBdLnk9ZFswXS55K2ksdlsxXS54PWRbMV0ueCtlLHZbMV0ueT1kWzFdLnkraSxnLnB1c2godlswXSksZy5wdXNoKHZbMV0pLHU9cFtiXVs0XSxmPXBbYl1bNV07cmV0dXJuIGd9LGZhYnJpYy51dGlsLmdldEJvdW5kc09mQ3VydmU9cn0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXtmb3IodmFyIGk9cy5jYWxsKGFyZ3VtZW50cywyKSxyPVtdLG49MCxvPXQubGVuZ3RoO28+bjtuKyspcltuXT1pLmxlbmd0aD90W25dW2VdLmFwcGx5KHRbbl0saSk6dFtuXVtlXS5jYWxsKHRbbl0pO3JldHVybiByfWZ1bmN0aW9uIGUodCxlKXtyZXR1cm4gcih0LGUsZnVuY3Rpb24odCxlKXtyZXR1cm4gdD49ZX0pfWZ1bmN0aW9uIGkodCxlKXtyZXR1cm4gcih0LGUsZnVuY3Rpb24odCxlKXtyZXR1cm4gZT50fSl9ZnVuY3Rpb24gcih0LGUsaSl7aWYodCYmMCE9PXQubGVuZ3RoKXt2YXIgcj10Lmxlbmd0aC0xLHM9ZT90W3JdW2VdOnRbcl07aWYoZSlmb3IoO3ItLTspaSh0W3JdW2VdLHMpJiYocz10W3JdW2VdKTtlbHNlIGZvcig7ci0tOylpKHRbcl0scykmJihzPXRbcl0pO3JldHVybiBzfX12YXIgcz1BcnJheS5wcm90b3R5cGUuc2xpY2U7QXJyYXkucHJvdG90eXBlLmluZGV4T2Z8fChBcnJheS5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbih0KXtpZih2b2lkIDA9PT10aGlzfHxudWxsPT09dGhpcyl0aHJvdyBuZXcgVHlwZUVycm9yO3ZhciBlPU9iamVjdCh0aGlzKSxpPWUubGVuZ3RoPj4+MDtpZigwPT09aSlyZXR1cm4tMTt2YXIgcj0wO2lmKGFyZ3VtZW50cy5sZW5ndGg+MCYmKHI9TnVtYmVyKGFyZ3VtZW50c1sxXSksciE9PXI/cj0wOjAhPT1yJiZyIT09TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZJiZyIT09TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZJiYocj0ocj4wfHwtMSkqTWF0aC5mbG9vcihNYXRoLmFicyhyKSkpKSxyPj1pKXJldHVybi0xO2Zvcih2YXIgcz1yPj0wP3I6TWF0aC5tYXgoaS1NYXRoLmFicyhyKSwwKTtpPnM7cysrKWlmKHMgaW4gZSYmZVtzXT09PXQpcmV0dXJuIHM7cmV0dXJuLTF9KSxBcnJheS5wcm90b3R5cGUuZm9yRWFjaHx8KEFycmF5LnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPTAscj10aGlzLmxlbmd0aD4+PjA7cj5pO2krKylpIGluIHRoaXMmJnQuY2FsbChlLHRoaXNbaV0saSx0aGlzKX0pLEFycmF5LnByb3RvdHlwZS5tYXB8fChBcnJheS5wcm90b3R5cGUubWFwPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPVtdLHI9MCxzPXRoaXMubGVuZ3RoPj4+MDtzPnI7cisrKXIgaW4gdGhpcyYmKGlbcl09dC5jYWxsKGUsdGhpc1tyXSxyLHRoaXMpKTtyZXR1cm4gaX0pLEFycmF5LnByb3RvdHlwZS5ldmVyeXx8KEFycmF5LnByb3RvdHlwZS5ldmVyeT1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0wLHI9dGhpcy5sZW5ndGg+Pj4wO3I+aTtpKyspaWYoaSBpbiB0aGlzJiYhdC5jYWxsKGUsdGhpc1tpXSxpLHRoaXMpKXJldHVybiExO3JldHVybiEwfSksQXJyYXkucHJvdG90eXBlLnNvbWV8fChBcnJheS5wcm90b3R5cGUuc29tZT1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaT0wLHI9dGhpcy5sZW5ndGg+Pj4wO3I+aTtpKyspaWYoaSBpbiB0aGlzJiZ0LmNhbGwoZSx0aGlzW2ldLGksdGhpcykpcmV0dXJuITA7cmV0dXJuITF9KSxBcnJheS5wcm90b3R5cGUuZmlsdGVyfHwoQXJyYXkucHJvdG90eXBlLmZpbHRlcj1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaSxyPVtdLHM9MCxuPXRoaXMubGVuZ3RoPj4+MDtuPnM7cysrKXMgaW4gdGhpcyYmKGk9dGhpc1tzXSx0LmNhbGwoZSxpLHMsdGhpcykmJnIucHVzaChpKSk7cmV0dXJuIHJ9KSxBcnJheS5wcm90b3R5cGUucmVkdWNlfHwoQXJyYXkucHJvdG90eXBlLnJlZHVjZT1mdW5jdGlvbih0KXt2YXIgZSxpPXRoaXMubGVuZ3RoPj4+MCxyPTA7aWYoYXJndW1lbnRzLmxlbmd0aD4xKWU9YXJndW1lbnRzWzFdO2Vsc2UgZm9yKDs7KXtpZihyIGluIHRoaXMpe2U9dGhpc1tyKytdO2JyZWFrfWlmKCsrcj49aSl0aHJvdyBuZXcgVHlwZUVycm9yfWZvcig7aT5yO3IrKylyIGluIHRoaXMmJihlPXQuY2FsbChudWxsLGUsdGhpc1tyXSxyLHRoaXMpKTtyZXR1cm4gZX0pLGZhYnJpYy51dGlsLmFycmF5PXtpbnZva2U6dCxtaW46aSxtYXg6ZX19KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7Zm9yKHZhciBpIGluIGUpdFtpXT1lW2ldO3JldHVybiB0fWZ1bmN0aW9uIGUoZSl7cmV0dXJuIHQoe30sZSl9ZmFicmljLnV0aWwub2JqZWN0PXtleHRlbmQ6dCxjbG9uZTplfX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7cmV0dXJuIHQucmVwbGFjZSgvLSsoLik/L2csZnVuY3Rpb24odCxlKXtyZXR1cm4gZT9lLnRvVXBwZXJDYXNlKCk6XCJcIn0pfWZ1bmN0aW9uIGUodCxlKXtyZXR1cm4gdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSsoZT90LnNsaWNlKDEpOnQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKSl9ZnVuY3Rpb24gaSh0KXtyZXR1cm4gdC5yZXBsYWNlKC8mL2csXCImYW1wO1wiKS5yZXBsYWNlKC9cIi9nLFwiJnF1b3Q7XCIpLnJlcGxhY2UoLycvZyxcIiZhcG9zO1wiKS5yZXBsYWNlKC88L2csXCImbHQ7XCIpLnJlcGxhY2UoLz4vZyxcIiZndDtcIil9U3RyaW5nLnByb3RvdHlwZS50cmltfHwoU3RyaW5nLnByb3RvdHlwZS50cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXltcXHNcXHhBMF0rLyxcIlwiKS5yZXBsYWNlKC9bXFxzXFx4QTBdKyQvLFwiXCIpfSksZmFicmljLnV0aWwuc3RyaW5nPXtjYW1lbGl6ZTp0LGNhcGl0YWxpemU6ZSxlc2NhcGVYbWw6aX19KCksZnVuY3Rpb24oKXt2YXIgdD1BcnJheS5wcm90b3R5cGUuc2xpY2UsZT1GdW5jdGlvbi5wcm90b3R5cGUuYXBwbHksaT1mdW5jdGlvbigpe307RnVuY3Rpb24ucHJvdG90eXBlLmJpbmR8fChGdW5jdGlvbi5wcm90b3R5cGUuYmluZD1mdW5jdGlvbihyKXt2YXIgcyxuPXRoaXMsbz10LmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiBzPW8ubGVuZ3RoP2Z1bmN0aW9uKCl7cmV0dXJuIGUuY2FsbChuLHRoaXMgaW5zdGFuY2VvZiBpP3RoaXM6cixvLmNvbmNhdCh0LmNhbGwoYXJndW1lbnRzKSkpfTpmdW5jdGlvbigpe3JldHVybiBlLmNhbGwobix0aGlzIGluc3RhbmNlb2YgaT90aGlzOnIsYXJndW1lbnRzKX0saS5wcm90b3R5cGU9dGhpcy5wcm90b3R5cGUscy5wcm90b3R5cGU9bmV3IGksc30pfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31mdW5jdGlvbiBlKHQpe3ZhciBlPXRoaXMuY29uc3RydWN0b3Iuc3VwZXJjbGFzcy5wcm90b3R5cGVbdF07cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg+MT9lLmFwcGx5KHRoaXMsci5jYWxsKGFyZ3VtZW50cywxKSk6ZS5jYWxsKHRoaXMpfWZ1bmN0aW9uIGkoKXtmdW5jdGlvbiBpKCl7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKX12YXIgbj1udWxsLGE9ci5jYWxsKGFyZ3VtZW50cywwKTtcImZ1bmN0aW9uXCI9PXR5cGVvZiBhWzBdJiYobj1hLnNoaWZ0KCkpLGkuc3VwZXJjbGFzcz1uLGkuc3ViY2xhc3Nlcz1bXSxuJiYodC5wcm90b3R5cGU9bi5wcm90b3R5cGUsaS5wcm90b3R5cGU9bmV3IHQsbi5zdWJjbGFzc2VzLnB1c2goaSkpO2Zvcih2YXIgaD0wLGM9YS5sZW5ndGg7Yz5oO2grKylvKGksYVtoXSxuKTtyZXR1cm4gaS5wcm90b3R5cGUuaW5pdGlhbGl6ZXx8KGkucHJvdG90eXBlLmluaXRpYWxpemU9cyksaS5wcm90b3R5cGUuY29uc3RydWN0b3I9aSxpLnByb3RvdHlwZS5jYWxsU3VwZXI9ZSxpfXZhciByPUFycmF5LnByb3RvdHlwZS5zbGljZSxzPWZ1bmN0aW9uKCl7fSxuPWZ1bmN0aW9uKCl7Zm9yKHZhciB0IGlue3RvU3RyaW5nOjF9KWlmKFwidG9TdHJpbmdcIj09PXQpcmV0dXJuITE7cmV0dXJuITB9KCksbz1mdW5jdGlvbih0LGUsaSl7Zm9yKHZhciByIGluIGUpciBpbiB0LnByb3RvdHlwZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5wcm90b3R5cGVbcl0mJihlW3JdK1wiXCIpLmluZGV4T2YoXCJjYWxsU3VwZXJcIik+LTE/dC5wcm90b3R5cGVbcl09ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHI9dGhpcy5jb25zdHJ1Y3Rvci5zdXBlcmNsYXNzO3RoaXMuY29uc3RydWN0b3Iuc3VwZXJjbGFzcz1pO3ZhciBzPWVbdF0uYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0aGlzLmNvbnN0cnVjdG9yLnN1cGVyY2xhc3M9cixcImluaXRpYWxpemVcIiE9PXQ/czp2b2lkIDB9fShyKTp0LnByb3RvdHlwZVtyXT1lW3JdLG4mJihlLnRvU3RyaW5nIT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyYmKHQucHJvdG90eXBlLnRvU3RyaW5nPWUudG9TdHJpbmcpLGUudmFsdWVPZiE9PU9iamVjdC5wcm90b3R5cGUudmFsdWVPZiYmKHQucHJvdG90eXBlLnZhbHVlT2Y9ZS52YWx1ZU9mKSl9O2ZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzPWl9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3ZhciBlLGkscj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSkscz1yLmxlbmd0aDtmb3IoaT0wO3M+aTtpKyspaWYoZT10eXBlb2YgdFtyW2ldXSwhL14oPzpmdW5jdGlvbnxvYmplY3R8dW5rbm93bikkLy50ZXN0KGUpKXJldHVybiExO3JldHVybiEwfWZ1bmN0aW9uIGUodCxlKXtyZXR1cm57aGFuZGxlcjplLHdyYXBwZWRIYW5kbGVyOmkodCxlKX19ZnVuY3Rpb24gaSh0LGUpe3JldHVybiBmdW5jdGlvbihpKXtlLmNhbGwobyh0KSxpfHxmYWJyaWMud2luZG93LmV2ZW50KX19ZnVuY3Rpb24gcih0LGUpe3JldHVybiBmdW5jdGlvbihpKXtpZihwW3RdJiZwW3RdW2VdKWZvcih2YXIgcj1wW3RdW2VdLHM9MCxuPXIubGVuZ3RoO24+cztzKyspcltzXS5jYWxsKHRoaXMsaXx8ZmFicmljLndpbmRvdy5ldmVudCl9fWZ1bmN0aW9uIHModCxlKXt0fHwodD1mYWJyaWMud2luZG93LmV2ZW50KTt2YXIgaT10LnRhcmdldHx8KHR5cGVvZiB0LnNyY0VsZW1lbnQhPT1oP3Quc3JjRWxlbWVudDpudWxsKSxyPWZhYnJpYy51dGlsLmdldFNjcm9sbExlZnRUb3AoaSxlKTtyZXR1cm57eDp2KHQpK3IubGVmdCx5OmIodCkrci50b3B9fWZ1bmN0aW9uIG4odCxlLGkpe3ZhciByPVwidG91Y2hlbmRcIj09PXQudHlwZT9cImNoYW5nZWRUb3VjaGVzXCI6XCJ0b3VjaGVzXCI7cmV0dXJuIHRbcl0mJnRbcl1bMF0/dFtyXVswXVtlXS0odFtyXVswXVtlXS10W3JdWzBdW2ldKXx8dFtpXTp0W2ldfXZhciBvLGEsaD1cInVua25vd25cIixjPWZ1bmN0aW9uKCl7dmFyIHQ9MDtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIGUuX191bmlxdWVJRHx8KGUuX191bmlxdWVJRD1cInVuaXF1ZUlEX19cIit0KyspfX0oKTshZnVuY3Rpb24oKXt2YXIgdD17fTtvPWZ1bmN0aW9uKGUpe3JldHVybiB0W2VdfSxhPWZ1bmN0aW9uKGUsaSl7dFtlXT1pfX0oKTt2YXIgbCx1LGY9dChmYWJyaWMuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFwiYWRkRXZlbnRMaXN0ZW5lclwiLFwicmVtb3ZlRXZlbnRMaXN0ZW5lclwiKSYmdChmYWJyaWMud2luZG93LFwiYWRkRXZlbnRMaXN0ZW5lclwiLFwicmVtb3ZlRXZlbnRMaXN0ZW5lclwiKSxkPXQoZmFicmljLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxcImF0dGFjaEV2ZW50XCIsXCJkZXRhY2hFdmVudFwiKSYmdChmYWJyaWMud2luZG93LFwiYXR0YWNoRXZlbnRcIixcImRldGFjaEV2ZW50XCIpLGc9e30scD17fTtmPyhsPWZ1bmN0aW9uKHQsZSxpKXt0LmFkZEV2ZW50TGlzdGVuZXIoZSxpLCExKX0sdT1mdW5jdGlvbih0LGUsaSl7dC5yZW1vdmVFdmVudExpc3RlbmVyKGUsaSwhMSl9KTpkPyhsPWZ1bmN0aW9uKHQsaSxyKXt2YXIgcz1jKHQpO2Eocyx0KSxnW3NdfHwoZ1tzXT17fSksZ1tzXVtpXXx8KGdbc11baV09W10pO3ZhciBuPWUocyxyKTtnW3NdW2ldLnB1c2gobiksdC5hdHRhY2hFdmVudChcIm9uXCIraSxuLndyYXBwZWRIYW5kbGVyKX0sdT1mdW5jdGlvbih0LGUsaSl7dmFyIHIscz1jKHQpO2lmKGdbc10mJmdbc11bZV0pZm9yKHZhciBuPTAsbz1nW3NdW2VdLmxlbmd0aDtvPm47bisrKXI9Z1tzXVtlXVtuXSxyJiZyLmhhbmRsZXI9PT1pJiYodC5kZXRhY2hFdmVudChcIm9uXCIrZSxyLndyYXBwZWRIYW5kbGVyKSxnW3NdW2VdW25dPW51bGwpfSk6KGw9ZnVuY3Rpb24odCxlLGkpe3ZhciBzPWModCk7aWYocFtzXXx8KHBbc109e30pLCFwW3NdW2VdKXtwW3NdW2VdPVtdO3ZhciBuPXRbXCJvblwiK2VdO24mJnBbc11bZV0ucHVzaChuKSx0W1wib25cIitlXT1yKHMsZSl9cFtzXVtlXS5wdXNoKGkpfSx1PWZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1jKHQpO2lmKHBbcl0mJnBbcl1bZV0pZm9yKHZhciBzPXBbcl1bZV0sbj0wLG89cy5sZW5ndGg7bz5uO24rKylzW25dPT09aSYmcy5zcGxpY2UobiwxKX0pLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyPWwsZmFicmljLnV0aWwucmVtb3ZlTGlzdGVuZXI9dTt2YXIgdj1mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHQuY2xpZW50WCE9PWg/dC5jbGllbnRYOjB9LGI9ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0LmNsaWVudFkhPT1oP3QuY2xpZW50WTowfTtmYWJyaWMuaXNUb3VjaFN1cHBvcnRlZCYmKHY9ZnVuY3Rpb24odCl7cmV0dXJuIG4odCxcInBhZ2VYXCIsXCJjbGllbnRYXCIpfSxiPWZ1bmN0aW9uKHQpe3JldHVybiBuKHQsXCJwYWdlWVwiLFwiY2xpZW50WVwiKX0pLGZhYnJpYy51dGlsLmdldFBvaW50ZXI9cyxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy51dGlsLGZhYnJpYy5PYnNlcnZhYmxlKX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt2YXIgaT10LnN0eWxlO2lmKCFpKXJldHVybiB0O2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXJldHVybiB0LnN0eWxlLmNzc1RleHQrPVwiO1wiK2UsZS5pbmRleE9mKFwib3BhY2l0eVwiKT4tMT9uKHQsZS5tYXRjaCgvb3BhY2l0eTpcXHMqKFxcZD9cXC4/XFxkKikvKVsxXSk6dDtmb3IodmFyIHIgaW4gZSlpZihcIm9wYWNpdHlcIj09PXIpbih0LGVbcl0pO2Vsc2V7dmFyIHM9XCJmbG9hdFwiPT09cnx8XCJjc3NGbG9hdFwiPT09cj9cInVuZGVmaW5lZFwiPT10eXBlb2YgaS5zdHlsZUZsb2F0P1wiY3NzRmxvYXRcIjpcInN0eWxlRmxvYXRcIjpyO2lbc109ZVtyXX1yZXR1cm4gdH12YXIgZT1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxpPVwic3RyaW5nXCI9PXR5cGVvZiBlLnN0eWxlLm9wYWNpdHkscj1cInN0cmluZ1wiPT10eXBlb2YgZS5zdHlsZS5maWx0ZXIscz0vYWxwaGFcXHMqXFwoXFxzKm9wYWNpdHlcXHMqPVxccyooW15cXCldKylcXCkvLG49ZnVuY3Rpb24odCl7cmV0dXJuIHR9O2k/bj1mdW5jdGlvbih0LGUpe3JldHVybiB0LnN0eWxlLm9wYWNpdHk9ZSx0fTpyJiYobj1mdW5jdGlvbih0LGUpe3ZhciBpPXQuc3R5bGU7cmV0dXJuIHQuY3VycmVudFN0eWxlJiYhdC5jdXJyZW50U3R5bGUuaGFzTGF5b3V0JiYoaS56b29tPTEpLHMudGVzdChpLmZpbHRlcik/KGU9ZT49Ljk5OTk/XCJcIjpcImFscGhhKG9wYWNpdHk9XCIrMTAwKmUrXCIpXCIsaS5maWx0ZXI9aS5maWx0ZXIucmVwbGFjZShzLGUpKTppLmZpbHRlcis9XCIgYWxwaGEob3BhY2l0eT1cIisxMDAqZStcIilcIix0fSksZmFicmljLnV0aWwuc2V0U3R5bGU9dH0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIHQ/ZmFicmljLmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQpOnR9ZnVuY3Rpb24gZSh0LGUpe3ZhciBpPWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KHQpO2Zvcih2YXIgciBpbiBlKVwiY2xhc3NcIj09PXI/aS5jbGFzc05hbWU9ZVtyXTpcImZvclwiPT09cj9pLmh0bWxGb3I9ZVtyXTppLnNldEF0dHJpYnV0ZShyLGVbcl0pO3JldHVybiBpfWZ1bmN0aW9uIGkodCxlKXt0JiYtMT09PShcIiBcIit0LmNsYXNzTmFtZStcIiBcIikuaW5kZXhPZihcIiBcIitlK1wiIFwiKSYmKHQuY2xhc3NOYW1lKz0odC5jbGFzc05hbWU/XCIgXCI6XCJcIikrZSl9ZnVuY3Rpb24gcih0LGkscil7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGkmJihpPWUoaSxyKSksdC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGksdCksaS5hcHBlbmRDaGlsZCh0KSxpfWZ1bmN0aW9uIHModCxlKXt2YXIgaSxyLHM9MCxuPTAsbz1mYWJyaWMuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGE9ZmFicmljLmRvY3VtZW50LmJvZHl8fHtzY3JvbGxMZWZ0OjAsc2Nyb2xsVG9wOjB9O2ZvcihyPXQ7dCYmdC5wYXJlbnROb2RlJiYhaTspdD10LnBhcmVudE5vZGUsMT09PXQubm9kZVR5cGUmJlwiZml4ZWRcIj09PWZhYnJpYy51dGlsLmdldEVsZW1lbnRTdHlsZSh0LFwicG9zaXRpb25cIikmJihpPXQpLDE9PT10Lm5vZGVUeXBlJiZyIT09ZSYmXCJhYnNvbHV0ZVwiPT09ZmFicmljLnV0aWwuZ2V0RWxlbWVudFN0eWxlKHQsXCJwb3NpdGlvblwiKT8ocz0wLG49MCk6dD09PWZhYnJpYy5kb2N1bWVudD8ocz1hLnNjcm9sbExlZnR8fG8uc2Nyb2xsTGVmdHx8MCxuPWEuc2Nyb2xsVG9wfHxvLnNjcm9sbFRvcHx8MCk6KHMrPXQuc2Nyb2xsTGVmdHx8MCxuKz10LnNjcm9sbFRvcHx8MCk7cmV0dXJue2xlZnQ6cyx0b3A6bn19ZnVuY3Rpb24gbih0KXt2YXIgZSxpLHI9dCYmdC5vd25lckRvY3VtZW50LHM9e2xlZnQ6MCx0b3A6MH0sbj17bGVmdDowLHRvcDowfSxvPXtib3JkZXJMZWZ0V2lkdGg6XCJsZWZ0XCIsYm9yZGVyVG9wV2lkdGg6XCJ0b3BcIixwYWRkaW5nTGVmdDpcImxlZnRcIixwYWRkaW5nVG9wOlwidG9wXCJ9O2lmKCFyKXJldHVybntsZWZ0OjAsdG9wOjB9O2Zvcih2YXIgYSBpbiBvKW5bb1thXV0rPXBhcnNlSW50KGwodCxhKSwxMCl8fDA7cmV0dXJuIGU9ci5kb2N1bWVudEVsZW1lbnQsXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0JiYocz10LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKSxpPWZhYnJpYy51dGlsLmdldFNjcm9sbExlZnRUb3AodCxudWxsKSx7bGVmdDpzLmxlZnQraS5sZWZ0LShlLmNsaWVudExlZnR8fDApK24ubGVmdCx0b3A6cy50b3AraS50b3AtKGUuY2xpZW50VG9wfHwwKStuLnRvcH19dmFyIG8sYT1BcnJheS5wcm90b3R5cGUuc2xpY2UsaD1mdW5jdGlvbih0KXtyZXR1cm4gYS5jYWxsKHQsMCl9O3RyeXtvPWgoZmFicmljLmRvY3VtZW50LmNoaWxkTm9kZXMpaW5zdGFuY2VvZiBBcnJheX1jYXRjaChjKXt9b3x8KGg9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPW5ldyBBcnJheSh0Lmxlbmd0aCksaT10Lmxlbmd0aDtpLS07KWVbaV09dFtpXTtyZXR1cm4gZX0pO3ZhciBsO2w9ZmFicmljLmRvY3VtZW50LmRlZmF1bHRWaWV3JiZmYWJyaWMuZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZT9mdW5jdGlvbih0LGUpe3ZhciBpPWZhYnJpYy5kb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKHQsbnVsbCk7cmV0dXJuIGk/aVtlXTp2b2lkIDB9OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5zdHlsZVtlXTtyZXR1cm4haSYmdC5jdXJyZW50U3R5bGUmJihpPXQuY3VycmVudFN0eWxlW2VdKSxpfSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQub25zZWxlY3RzdGFydCYmKHQub25zZWxlY3RzdGFydD1mYWJyaWMudXRpbC5mYWxzZUZ1bmN0aW9uKSxyP3Quc3R5bGVbcl09XCJub25lXCI6XCJzdHJpbmdcIj09dHlwZW9mIHQudW5zZWxlY3RhYmxlJiYodC51bnNlbGVjdGFibGU9XCJvblwiKSx0fWZ1bmN0aW9uIGUodCl7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQub25zZWxlY3RzdGFydCYmKHQub25zZWxlY3RzdGFydD1udWxsKSxyP3Quc3R5bGVbcl09XCJcIjpcInN0cmluZ1wiPT10eXBlb2YgdC51bnNlbGVjdGFibGUmJih0LnVuc2VsZWN0YWJsZT1cIlwiKSx0fXZhciBpPWZhYnJpYy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUscj1cInVzZXJTZWxlY3RcImluIGk/XCJ1c2VyU2VsZWN0XCI6XCJNb3pVc2VyU2VsZWN0XCJpbiBpP1wiTW96VXNlclNlbGVjdFwiOlwiV2Via2l0VXNlclNlbGVjdFwiaW4gaT9cIldlYmtpdFVzZXJTZWxlY3RcIjpcIktodG1sVXNlclNlbGVjdFwiaW4gaT9cIktodG1sVXNlclNlbGVjdFwiOlwiXCI7ZmFicmljLnV0aWwubWFrZUVsZW1lbnRVbnNlbGVjdGFibGU9dCxmYWJyaWMudXRpbC5tYWtlRWxlbWVudFNlbGVjdGFibGU9ZX0oKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt2YXIgaT1mYWJyaWMuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLHI9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIikscz0hMDtyLm9ubG9hZD1yLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbih0KXtpZihzKXtpZihcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5yZWFkeVN0YXRlJiZcImxvYWRlZFwiIT09dGhpcy5yZWFkeVN0YXRlJiZcImNvbXBsZXRlXCIhPT10aGlzLnJlYWR5U3RhdGUpcmV0dXJuO3M9ITEsZSh0fHxmYWJyaWMud2luZG93LmV2ZW50KSxyPXIub25sb2FkPXIub25yZWFkeXN0YXRlY2hhbmdlPW51bGx9fSxyLnNyYz10LGkuYXBwZW5kQ2hpbGQocil9ZmFicmljLnV0aWwuZ2V0U2NyaXB0PXR9KCksZmFicmljLnV0aWwuZ2V0QnlJZD10LGZhYnJpYy51dGlsLnRvQXJyYXk9aCxmYWJyaWMudXRpbC5tYWtlRWxlbWVudD1lLGZhYnJpYy51dGlsLmFkZENsYXNzPWksZmFicmljLnV0aWwud3JhcEVsZW1lbnQ9cixmYWJyaWMudXRpbC5nZXRTY3JvbGxMZWZ0VG9wPXMsZmFicmljLnV0aWwuZ2V0RWxlbWVudE9mZnNldD1uLGZhYnJpYy51dGlsLmdldEVsZW1lbnRTdHlsZT1sfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3JldHVybiB0KygvXFw/Ly50ZXN0KHQpP1wiJlwiOlwiP1wiKStlfWZ1bmN0aW9uIGUoKXt9ZnVuY3Rpb24gaShpLHMpe3N8fChzPXt9KTt2YXIgbixvPXMubWV0aG9kP3MubWV0aG9kLnRvVXBwZXJDYXNlKCk6XCJHRVRcIixhPXMub25Db21wbGV0ZXx8ZnVuY3Rpb24oKXt9LGg9cigpO3JldHVybiBoLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpezQ9PT1oLnJlYWR5U3RhdGUmJihhKGgpLGgub25yZWFkeXN0YXRlY2hhbmdlPWUpfSxcIkdFVFwiPT09byYmKG49bnVsbCxcInN0cmluZ1wiPT10eXBlb2Ygcy5wYXJhbWV0ZXJzJiYoaT10KGkscy5wYXJhbWV0ZXJzKSkpLGgub3BlbihvLGksITApLChcIlBPU1RcIj09PW98fFwiUFVUXCI9PT1vKSYmaC5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIiksaC5zZW5kKG4pLGh9dmFyIHI9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9W2Z1bmN0aW9uKCl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTEhUVFBcIil9LGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KFwiTXN4bWwyLlhNTEhUVFBcIil9LGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KFwiTXN4bWwyLlhNTEhUVFAuMy4wXCIpfSxmdW5jdGlvbigpe3JldHVybiBuZXcgWE1MSHR0cFJlcXVlc3R9XSxlPXQubGVuZ3RoO2UtLTspdHJ5e3ZhciBpPXRbZV0oKTtpZihpKXJldHVybiB0W2VdfWNhdGNoKHIpe319KCk7ZmFicmljLnV0aWwucmVxdWVzdD1pfSgpLGZhYnJpYy5sb2c9ZnVuY3Rpb24oKXt9LGZhYnJpYy53YXJuPWZ1bmN0aW9uKCl7fSxcInVuZGVmaW5lZFwiIT10eXBlb2YgY29uc29sZSYmW1wibG9nXCIsXCJ3YXJuXCJdLmZvckVhY2goZnVuY3Rpb24odCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGNvbnNvbGVbdF0mJlwiZnVuY3Rpb25cIj09dHlwZW9mIGNvbnNvbGVbdF0uYXBwbHkmJihmYWJyaWNbdF09ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZVt0XS5hcHBseShjb25zb2xlLGFyZ3VtZW50cyl9KX0pLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtlKGZ1bmN0aW9uKGkpe3R8fCh0PXt9KTt2YXIgcixzPWl8fCtuZXcgRGF0ZSxuPXQuZHVyYXRpb258fDUwMCxvPXMrbixhPXQub25DaGFuZ2V8fGZ1bmN0aW9uKCl7fSxoPXQuYWJvcnR8fGZ1bmN0aW9uKCl7cmV0dXJuITF9LGM9dC5lYXNpbmd8fGZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybi1pKk1hdGguY29zKHQvciooTWF0aC5QSS8yKSkraStlfSxsPVwic3RhcnRWYWx1ZVwiaW4gdD90LnN0YXJ0VmFsdWU6MCx1PVwiZW5kVmFsdWVcImluIHQ/dC5lbmRWYWx1ZToxMDAsZj10LmJ5VmFsdWV8fHUtbDt0Lm9uU3RhcnQmJnQub25TdGFydCgpLGZ1bmN0aW9uIGQoaSl7cj1pfHwrbmV3IERhdGU7dmFyIHU9cj5vP246ci1zO3JldHVybiBoKCk/dm9pZCh0Lm9uQ29tcGxldGUmJnQub25Db21wbGV0ZSgpKTooYShjKHUsbCxmLG4pKSxyPm8/dm9pZCh0Lm9uQ29tcGxldGUmJnQub25Db21wbGV0ZSgpKTp2b2lkIGUoZCkpfShzKX0pfWZ1bmN0aW9uIGUoKXtyZXR1cm4gaS5hcHBseShmYWJyaWMud2luZG93LGFyZ3VtZW50cyl9dmFyIGk9ZmFicmljLndpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZhYnJpYy53aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmYWJyaWMud2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZXx8ZmFicmljLndpbmRvdy5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmYWJyaWMud2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmdW5jdGlvbih0KXtmYWJyaWMud2luZG93LnNldFRpbWVvdXQodCwxZTMvNjApfTtmYWJyaWMudXRpbC5hbmltYXRlPXQsZmFicmljLnV0aWwucmVxdWVzdEFuaW1GcmFtZT1lfSgpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSxyKXtyZXR1cm4gdDxNYXRoLmFicyhlKT8odD1lLHI9aS80KTpyPWkvKDIqTWF0aC5QSSkqTWF0aC5hc2luKGUvdCkse2E6dCxjOmUscDppLHM6cn19ZnVuY3Rpb24gZSh0LGUsaSl7cmV0dXJuIHQuYSpNYXRoLnBvdygyLDEwKihlLT0xKSkqTWF0aC5zaW4oMiooZSppLXQucykqTWF0aC5QSS90LnApfWZ1bmN0aW9uIGkodCxlLGkscil7cmV0dXJuIGkqKCh0PXQvci0xKSp0KnQrMSkrZX1mdW5jdGlvbiByKHQsZSxpLHIpe3JldHVybiB0Lz1yLzIsMT50P2kvMip0KnQqdCtlOmkvMiooKHQtPTIpKnQqdCsyKStlfWZ1bmN0aW9uIHModCxlLGkscil7cmV0dXJuIGkqKHQvPXIpKnQqdCp0K2V9ZnVuY3Rpb24gbih0LGUsaSxyKXtyZXR1cm4taSooKHQ9dC9yLTEpKnQqdCp0LTEpK2V9ZnVuY3Rpb24gbyh0LGUsaSxyKXtyZXR1cm4gdC89ci8yLDE+dD9pLzIqdCp0KnQqdCtlOi1pLzIqKCh0LT0yKSp0KnQqdC0yKStlfWZ1bmN0aW9uIGEodCxlLGkscil7cmV0dXJuIGkqKHQvPXIpKnQqdCp0KnQrZX1mdW5jdGlvbiBoKHQsZSxpLHIpe3JldHVybiBpKigodD10L3ItMSkqdCp0KnQqdCsxKStlfWZ1bmN0aW9uIGModCxlLGkscil7cmV0dXJuIHQvPXIvMiwxPnQ/aS8yKnQqdCp0KnQqdCtlOmkvMiooKHQtPTIpKnQqdCp0KnQrMikrZX1mdW5jdGlvbiBsKHQsZSxpLHIpe3JldHVybi1pKk1hdGguY29zKHQvciooTWF0aC5QSS8yKSkraStlfWZ1bmN0aW9uIHUodCxlLGkscil7cmV0dXJuIGkqTWF0aC5zaW4odC9yKihNYXRoLlBJLzIpKStlfWZ1bmN0aW9uIGYodCxlLGkscil7cmV0dXJuLWkvMiooTWF0aC5jb3MoTWF0aC5QSSp0L3IpLTEpK2V9ZnVuY3Rpb24gZCh0LGUsaSxyKXtyZXR1cm4gMD09PXQ/ZTppKk1hdGgucG93KDIsMTAqKHQvci0xKSkrZX1mdW5jdGlvbiBnKHQsZSxpLHIpe3JldHVybiB0PT09cj9lK2k6aSooLU1hdGgucG93KDIsLTEwKnQvcikrMSkrZX1mdW5jdGlvbiBwKHQsZSxpLHIpe3JldHVybiAwPT09dD9lOnQ9PT1yP2UraToodC89ci8yLDE+dD9pLzIqTWF0aC5wb3coMiwxMCoodC0xKSkrZTppLzIqKC1NYXRoLnBvdygyLC0xMCotLXQpKzIpK2UpfWZ1bmN0aW9uIHYodCxlLGkscil7cmV0dXJuLWkqKE1hdGguc3FydCgxLSh0Lz1yKSp0KS0xKStlfWZ1bmN0aW9uIGIodCxlLGkscil7cmV0dXJuIGkqTWF0aC5zcXJ0KDEtKHQ9dC9yLTEpKnQpK2V9ZnVuY3Rpb24gbSh0LGUsaSxyKXtyZXR1cm4gdC89ci8yLDE+dD8taS8yKihNYXRoLnNxcnQoMS10KnQpLTEpK2U6aS8yKihNYXRoLnNxcnQoMS0odC09MikqdCkrMSkrZX1mdW5jdGlvbiB5KGkscixzLG4pe3ZhciBvPTEuNzAxNTgsYT0wLGg9cztpZigwPT09aSlyZXR1cm4gcjtpZihpLz1uLDE9PT1pKXJldHVybiByK3M7YXx8KGE9LjMqbik7dmFyIGM9dChoLHMsYSxvKTtyZXR1cm4tZShjLGksbikrcn1mdW5jdGlvbiBfKGUsaSxyLHMpe3ZhciBuPTEuNzAxNTgsbz0wLGE9cjtpZigwPT09ZSlyZXR1cm4gaTtpZihlLz1zLDE9PT1lKXJldHVybiBpK3I7b3x8KG89LjMqcyk7dmFyIGg9dChhLHIsbyxuKTtyZXR1cm4gaC5hKk1hdGgucG93KDIsLTEwKmUpKk1hdGguc2luKDIqKGUqcy1oLnMpKk1hdGguUEkvaC5wKStoLmMraX1mdW5jdGlvbiB4KGkscixzLG4pe3ZhciBvPTEuNzAxNTgsYT0wLGg9cztpZigwPT09aSlyZXR1cm4gcjtpZihpLz1uLzIsMj09PWkpcmV0dXJuIHIrczthfHwoYT0uMypuKjEuNSk7dmFyIGM9dChoLHMsYSxvKTtyZXR1cm4gMT5pPy0uNSplKGMsaSxuKStyOmMuYSpNYXRoLnBvdygyLC0xMCooaS09MSkpKk1hdGguc2luKDIqKGkqbi1jLnMpKk1hdGguUEkvYy5wKSouNStjLmMrcn1mdW5jdGlvbiBDKHQsZSxpLHIscyl7cmV0dXJuIHZvaWQgMD09PXMmJihzPTEuNzAxNTgpLGkqKHQvPXIpKnQqKChzKzEpKnQtcykrZX1mdW5jdGlvbiBTKHQsZSxpLHIscyl7cmV0dXJuIHZvaWQgMD09PXMmJihzPTEuNzAxNTgpLGkqKCh0PXQvci0xKSp0KigocysxKSp0K3MpKzEpK2V9ZnVuY3Rpb24gdyh0LGUsaSxyLHMpe3JldHVybiB2b2lkIDA9PT1zJiYocz0xLjcwMTU4KSx0Lz1yLzIsMT50P2kvMip0KnQqKCgocyo9MS41MjUpKzEpKnQtcykrZTppLzIqKCh0LT0yKSp0KigoKHMqPTEuNTI1KSsxKSp0K3MpKzIpK2V9ZnVuY3Rpb24gTyh0LGUsaSxyKXtyZXR1cm4gaS1UKHItdCwwLGkscikrZX1mdW5jdGlvbiBUKHQsZSxpLHIpe3JldHVybih0Lz1yKTwxLzIuNzU/Ny41NjI1KmkqdCp0K2U6Mi8yLjc1PnQ/aSooNy41NjI1Kih0LT0xLjUvMi43NSkqdCsuNzUpK2U6Mi41LzIuNzU+dD9pKig3LjU2MjUqKHQtPTIuMjUvMi43NSkqdCsuOTM3NSkrZTppKig3LjU2MjUqKHQtPTIuNjI1LzIuNzUpKnQrLjk4NDM3NSkrZX1mdW5jdGlvbiBrKHQsZSxpLHIpe3JldHVybiByLzI+dD8uNSpPKDIqdCwwLGkscikrZTouNSpUKDIqdC1yLDAsaSxyKSsuNSppK2V9ZmFicmljLnV0aWwuZWFzZT17ZWFzZUluUXVhZDpmdW5jdGlvbih0LGUsaSxyKXtyZXR1cm4gaSoodC89cikqdCtlfSxlYXNlT3V0UXVhZDpmdW5jdGlvbih0LGUsaSxyKXtyZXR1cm4taSoodC89cikqKHQtMikrZX0sZWFzZUluT3V0UXVhZDpmdW5jdGlvbih0LGUsaSxyKXtyZXR1cm4gdC89ci8yLDE+dD9pLzIqdCp0K2U6LWkvMiooLS10Kih0LTIpLTEpK2V9LGVhc2VJbkN1YmljOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVybiBpKih0Lz1yKSp0KnQrZX0sZWFzZU91dEN1YmljOmksZWFzZUluT3V0Q3ViaWM6cixlYXNlSW5RdWFydDpzLGVhc2VPdXRRdWFydDpuLGVhc2VJbk91dFF1YXJ0Om8sZWFzZUluUXVpbnQ6YSxlYXNlT3V0UXVpbnQ6aCxlYXNlSW5PdXRRdWludDpjLGVhc2VJblNpbmU6bCxlYXNlT3V0U2luZTp1LGVhc2VJbk91dFNpbmU6ZixlYXNlSW5FeHBvOmQsZWFzZU91dEV4cG86ZyxlYXNlSW5PdXRFeHBvOnAsZWFzZUluQ2lyYzp2LGVhc2VPdXRDaXJjOmIsZWFzZUluT3V0Q2lyYzptLGVhc2VJbkVsYXN0aWM6eSxlYXNlT3V0RWxhc3RpYzpfLGVhc2VJbk91dEVsYXN0aWM6eCxlYXNlSW5CYWNrOkMsZWFzZU91dEJhY2s6UyxlYXNlSW5PdXRCYWNrOncsZWFzZUluQm91bmNlOk8sZWFzZU91dEJvdW5jZTpULGVhc2VJbk91dEJvdW5jZTprfX0oKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKHQpe3JldHVybiB0IGluIEM/Q1t0XTp0fWZ1bmN0aW9uIGkodCxlLGkscil7dmFyIHMsbj1cIltvYmplY3QgQXJyYXldXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZSk7cmV0dXJuXCJmaWxsXCIhPT10JiZcInN0cm9rZVwiIT09dHx8XCJub25lXCIhPT1lP1wic3Ryb2tlRGFzaEFycmF5XCI9PT10P2U9ZS5yZXBsYWNlKC8sL2csXCIgXCIpLnNwbGl0KC9cXHMrLykubWFwKGZ1bmN0aW9uKHQpe3JldHVybiBwYXJzZUZsb2F0KHQpfSk6XCJ0cmFuc2Zvcm1NYXRyaXhcIj09PXQ/ZT1pJiZpLnRyYW5zZm9ybU1hdHJpeD94KGkudHJhbnNmb3JtTWF0cml4LHAucGFyc2VUcmFuc2Zvcm1BdHRyaWJ1dGUoZSkpOnAucGFyc2VUcmFuc2Zvcm1BdHRyaWJ1dGUoZSk6XCJ2aXNpYmxlXCI9PT10PyhlPVwibm9uZVwiPT09ZXx8XCJoaWRkZW5cIj09PWU/ITE6ITAsaSYmaS52aXNpYmxlPT09ITEmJihlPSExKSk6XCJvcmlnaW5YXCI9PT10P2U9XCJzdGFydFwiPT09ZT9cImxlZnRcIjpcImVuZFwiPT09ZT9cInJpZ2h0XCI6XCJjZW50ZXJcIjpzPW4/ZS5tYXAoXyk6XyhlLHIpOmU9XCJcIiwhbiYmaXNOYU4ocyk/ZTpzfWZ1bmN0aW9uIHIodCl7Zm9yKHZhciBlIGluIFMpaWYodFtlXSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRbU1tlXV0mJjAhPT10W2VdLmluZGV4T2YoXCJ1cmwoXCIpKXt2YXIgaT1uZXcgcC5Db2xvcih0W2VdKTt0W2VdPWkuc2V0QWxwaGEoeShpLmdldEFscGhhKCkqdFtTW2VdXSwyKSkudG9SZ2JhKCl9cmV0dXJuIHR9ZnVuY3Rpb24gcyh0LHIpe3ZhciBzLG47dC5yZXBsYWNlKC87JC8sXCJcIikuc3BsaXQoXCI7XCIpLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIG89dC5zcGxpdChcIjpcIik7cz1lKG9bMF0udHJpbSgpLnRvTG93ZXJDYXNlKCkpLG49aShzLG9bMV0udHJpbSgpKSxyW3NdPW59KX1mdW5jdGlvbiBuKHQscil7dmFyIHMsbjtmb3IodmFyIG8gaW4gdClcInVuZGVmaW5lZFwiIT10eXBlb2YgdFtvXSYmKHM9ZShvLnRvTG93ZXJDYXNlKCkpLG49aShzLHRbb10pLHJbc109bil9ZnVuY3Rpb24gbyh0LGUpe3ZhciBpPXt9O2Zvcih2YXIgciBpbiBwLmNzc1J1bGVzW2VdKWlmKGEodCxyLnNwbGl0KFwiIFwiKSkpZm9yKHZhciBzIGluIHAuY3NzUnVsZXNbZV1bcl0paVtzXT1wLmNzc1J1bGVzW2VdW3JdW3NdO3JldHVybiBpfWZ1bmN0aW9uIGEodCxlKXt2YXIgaSxyPSEwO3JldHVybiBpPWModCxlLnBvcCgpKSxpJiZlLmxlbmd0aCYmKHI9aCh0LGUpKSxpJiZyJiYwPT09ZS5sZW5ndGh9ZnVuY3Rpb24gaCh0LGUpe2Zvcih2YXIgaSxyPSEwO3QucGFyZW50Tm9kZSYmMT09PXQucGFyZW50Tm9kZS5ub2RlVHlwZSYmZS5sZW5ndGg7KXImJihpPWUucG9wKCkpLHQ9dC5wYXJlbnROb2RlLHI9Yyh0LGkpO3JldHVybiAwPT09ZS5sZW5ndGh9ZnVuY3Rpb24gYyh0LGUpe3ZhciBpLHI9dC5ub2RlTmFtZSxzPXQuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIiksbj10LmdldEF0dHJpYnV0ZShcImlkXCIpO2lmKGk9bmV3IFJlZ0V4cChcIl5cIityLFwiaVwiKSxlPWUucmVwbGFjZShpLFwiXCIpLG4mJmUubGVuZ3RoJiYoaT1uZXcgUmVnRXhwKFwiI1wiK24rXCIoPyFbYS16QS1aXFxcXC1dKylcIixcImlcIiksZT1lLnJlcGxhY2UoaSxcIlwiKSkscyYmZS5sZW5ndGgpe3M9cy5zcGxpdChcIiBcIik7Zm9yKHZhciBvPXMubGVuZ3RoO28tLTspaT1uZXcgUmVnRXhwKFwiXFxcXC5cIitzW29dK1wiKD8hW2EtekEtWlxcXFwtXSspXCIsXCJpXCIpLGU9ZS5yZXBsYWNlKGksXCJcIil9cmV0dXJuIDA9PT1lLmxlbmd0aH1mdW5jdGlvbiBsKHQsZSl7dmFyIGk7aWYodC5nZXRFbGVtZW50QnlJZCYmKGk9dC5nZXRFbGVtZW50QnlJZChlKSksaSlyZXR1cm4gaTt2YXIgcixzLG4sbz10LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiKlwiKTtmb3Iocz0wO3M8by5sZW5ndGg7cysrKWlmKHI9b1tzXSxuPT09ci5nZXRBdHRyaWJ1dGUoXCJpZFwiKSlyZXR1cm4gcn1mdW5jdGlvbiB1KHQpe2Zvcih2YXIgZT10LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidXNlXCIpLGk9MDtlLmxlbmd0aCYmaTxlLmxlbmd0aDspe2Zvcih2YXIgcixzPWVbaV0sbj1zLmdldEF0dHJpYnV0ZShcInhsaW5rOmhyZWZcIikuc3Vic3RyKDEpLG89cy5nZXRBdHRyaWJ1dGUoXCJ4XCIpfHwwLGE9cy5nZXRBdHRyaWJ1dGUoXCJ5XCIpfHwwLGg9bCh0LG4pLmNsb25lTm9kZSghMCksYz0oaC5nZXRBdHRyaWJ1dGUoXCJ0cmFuc2Zvcm1cIil8fFwiXCIpK1wiIHRyYW5zbGF0ZShcIitvK1wiLCBcIithK1wiKVwiLHU9ZS5sZW5ndGgsZj0wLGQ9cy5hdHRyaWJ1dGVzLGc9ZC5sZW5ndGg7Zz5mO2YrKyl7dmFyIHA9ZC5pdGVtKGYpO1wieFwiIT09cC5ub2RlTmFtZSYmXCJ5XCIhPT1wLm5vZGVOYW1lJiZcInhsaW5rOmhyZWZcIiE9PXAubm9kZU5hbWUmJihcInRyYW5zZm9ybVwiPT09cC5ub2RlTmFtZT9jPXAubm9kZVZhbHVlK1wiIFwiK2M6aC5zZXRBdHRyaWJ1dGUocC5ub2RlTmFtZSxwLm5vZGVWYWx1ZSkpfWguc2V0QXR0cmlidXRlKFwidHJhbnNmb3JtXCIsYyksaC5zZXRBdHRyaWJ1dGUoXCJpbnN0YW50aWF0ZWRfYnlfdXNlXCIsXCIxXCIpLGgucmVtb3ZlQXR0cmlidXRlKFwiaWRcIikscj1zLnBhcmVudE5vZGUsci5yZXBsYWNlQ2hpbGQoaCxzKSxlLmxlbmd0aD09PXUmJmkrK319ZnVuY3Rpb24gZih0LGUsaSl7dmFyIHIscyxuLG8sYT10LmdldEF0dHJpYnV0ZShcInZpZXdCb3hcIiksaD0xLGM9MSxsPTAsdT0wO2lmKGEmJihhPWEubWF0Y2godykpJiYobD0tcGFyc2VGbG9hdChhWzFdKSx1PS1wYXJzZUZsb2F0KGFbMl0pLHI9cGFyc2VGbG9hdChhWzNdKSxzPXBhcnNlRmxvYXQoYVs0XSksZSYmZSE9PXImJihoPWUvciksaSYmaSE9PXMmJihjPWkvcyksYz1oPWg+Yz9jOmgsMSE9PWh8fDEhPT1jfHwwIT09bHx8MCE9PXUpKXtpZihuPVwiIG1hdHJpeChcIitoK1wiIDAgMCBcIitjK1wiIFwiK2wqaCtcIiBcIit1KmMrXCIpIFwiLFwic3ZnXCI9PT10LnRhZ05hbWUpe2ZvcihvPXQub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZ1wiKTtudWxsIT10LmZpcnN0Q2hpbGQ7KW8uYXBwZW5kQ2hpbGQodC5maXJzdENoaWxkKTt0LmFwcGVuZENoaWxkKG8pfWVsc2Ugbz10LG49by5nZXRBdHRyaWJ1dGUoXCJ0cmFuc2Zvcm1cIikrbjtvLnNldEF0dHJpYnV0ZShcInRyYW5zZm9ybVwiLG4pfX1mdW5jdGlvbiBkKHQpe3ZhciBlPXQub2JqZWN0cyxpPXQub3B0aW9ucztyZXR1cm4gZT1lLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gcFtiKHQudHlwZSldLmZyb21PYmplY3QodCl9KSx7b2JqZWN0czplLG9wdGlvbnM6aX19ZnVuY3Rpb24gZyh0LGUsaSl7ZVtpXSYmZVtpXS50b1NWRyYmdC5wdXNoKCc8cGF0dGVybiB4PVwiMFwiIHk9XCIwXCIgaWQ9XCInLGksJ1BhdHRlcm5cIiAnLCd3aWR0aD1cIicsZVtpXS5zb3VyY2Uud2lkdGgsJ1wiIGhlaWdodD1cIicsZVtpXS5zb3VyY2UuaGVpZ2h0LCdcIiBwYXR0ZXJuVW5pdHM9XCJ1c2VyU3BhY2VPblVzZVwiPicsJzxpbWFnZSB4PVwiMFwiIHk9XCIwXCIgJywnd2lkdGg9XCInLGVbaV0uc291cmNlLndpZHRoLCdcIiBoZWlnaHQ9XCInLGVbaV0uc291cmNlLmhlaWdodCwnXCIgeGxpbms6aHJlZj1cIicsZVtpXS5zb3VyY2Uuc3JjLCdcIj48L2ltYWdlPjwvcGF0dGVybj4nKX12YXIgcD10LmZhYnJpY3x8KHQuZmFicmljPXt9KSx2PXAudXRpbC5vYmplY3QuZXh0ZW5kLGI9cC51dGlsLnN0cmluZy5jYXBpdGFsaXplLG09cC51dGlsLm9iamVjdC5jbG9uZSx5PXAudXRpbC50b0ZpeGVkLF89cC51dGlsLnBhcnNlVW5pdCx4PXAudXRpbC5tdWx0aXBseVRyYW5zZm9ybU1hdHJpY2VzLEM9e2N4OlwibGVmdFwiLHg6XCJsZWZ0XCIscjpcInJhZGl1c1wiLGN5OlwidG9wXCIseTpcInRvcFwiLGRpc3BsYXk6XCJ2aXNpYmxlXCIsdmlzaWJpbGl0eTpcInZpc2libGVcIix0cmFuc2Zvcm06XCJ0cmFuc2Zvcm1NYXRyaXhcIixcImZpbGwtb3BhY2l0eVwiOlwiZmlsbE9wYWNpdHlcIixcImZpbGwtcnVsZVwiOlwiZmlsbFJ1bGVcIixcImZvbnQtZmFtaWx5XCI6XCJmb250RmFtaWx5XCIsXCJmb250LXNpemVcIjpcImZvbnRTaXplXCIsXCJmb250LXN0eWxlXCI6XCJmb250U3R5bGVcIixcImZvbnQtd2VpZ2h0XCI6XCJmb250V2VpZ2h0XCIsXCJzdHJva2UtZGFzaGFycmF5XCI6XCJzdHJva2VEYXNoQXJyYXlcIixcInN0cm9rZS1saW5lY2FwXCI6XCJzdHJva2VMaW5lQ2FwXCIsXCJzdHJva2UtbGluZWpvaW5cIjpcInN0cm9rZUxpbmVKb2luXCIsXCJzdHJva2UtbWl0ZXJsaW1pdFwiOlwic3Ryb2tlTWl0ZXJMaW1pdFwiLFwic3Ryb2tlLW9wYWNpdHlcIjpcInN0cm9rZU9wYWNpdHlcIixcInN0cm9rZS13aWR0aFwiOlwic3Ryb2tlV2lkdGhcIixcInRleHQtZGVjb3JhdGlvblwiOlwidGV4dERlY29yYXRpb25cIixcInRleHQtYW5jaG9yXCI6XCJvcmlnaW5YXCJ9LFM9e3N0cm9rZTpcInN0cm9rZU9wYWNpdHlcIixmaWxsOlwiZmlsbE9wYWNpdHlcIn07cC5jc3NSdWxlcz17fSxwLmdyYWRpZW50RGVmcz17fSxwLnBhcnNlVHJhbnNmb3JtQXR0cmlidXRlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3ZhciBpPWVbMF07dFswXT1NYXRoLmNvcyhpKSx0WzFdPU1hdGguc2luKGkpLHRbMl09LU1hdGguc2luKGkpLHRbM109TWF0aC5jb3MoaSl9ZnVuY3Rpb24gZSh0LGUpe3ZhciBpPWVbMF0scj0yPT09ZS5sZW5ndGg/ZVsxXTplWzBdO3RbMF09aSx0WzNdPXJ9ZnVuY3Rpb24gaSh0LGUpe3RbMl09TWF0aC50YW4ocC51dGlsLmRlZ3JlZXNUb1JhZGlhbnMoZVswXSkpfWZ1bmN0aW9uIHIodCxlKXt0WzFdPU1hdGgudGFuKHAudXRpbC5kZWdyZWVzVG9SYWRpYW5zKGVbMF0pKX1mdW5jdGlvbiBzKHQsZSl7dFs0XT1lWzBdLDI9PT1lLmxlbmd0aCYmKHRbNV09ZVsxXSl9dmFyIG49WzEsMCwwLDEsMCwwXSxvPXAucmVOdW0sYT1cIig/OlxcXFxzKyw/XFxcXHMqfCxcXFxccyopXCIsaD1cIig/Oihza2V3WClcXFxccypcXFxcKFxcXFxzKihcIitvK1wiKVxcXFxzKlxcXFwpKVwiLGM9XCIoPzooc2tld1kpXFxcXHMqXFxcXChcXFxccyooXCIrbytcIilcXFxccypcXFxcKSlcIixsPVwiKD86KHJvdGF0ZSlcXFxccypcXFxcKFxcXFxzKihcIitvK1wiKSg/OlwiK2ErXCIoXCIrbytcIilcIithK1wiKFwiK28rXCIpKT9cXFxccypcXFxcKSlcIix1PVwiKD86KHNjYWxlKVxcXFxzKlxcXFwoXFxcXHMqKFwiK28rXCIpKD86XCIrYStcIihcIitvK1wiKSk/XFxcXHMqXFxcXCkpXCIsZj1cIig/Oih0cmFuc2xhdGUpXFxcXHMqXFxcXChcXFxccyooXCIrbytcIikoPzpcIithK1wiKFwiK28rXCIpKT9cXFxccypcXFxcKSlcIixkPVwiKD86KG1hdHJpeClcXFxccypcXFxcKFxcXFxzKihcIitvK1wiKVwiK2ErXCIoXCIrbytcIilcIithK1wiKFwiK28rXCIpXCIrYStcIihcIitvK1wiKVwiK2ErXCIoXCIrbytcIilcIithK1wiKFwiK28rXCIpXFxcXHMqXFxcXCkpXCIsZz1cIig/OlwiK2QrXCJ8XCIrZitcInxcIit1K1wifFwiK2wrXCJ8XCIraCtcInxcIitjK1wiKVwiLHY9XCIoPzpcIitnK1wiKD86XCIrYStnK1wiKSopXCIsYj1cIl5cXFxccyooPzpcIit2K1wiPylcXFxccyokXCIsbT1uZXcgUmVnRXhwKGIpLHk9bmV3IFJlZ0V4cChnLFwiZ1wiKTtyZXR1cm4gZnVuY3Rpb24obyl7dmFyIGE9bi5jb25jYXQoKSxoPVtdO2lmKCFvfHxvJiYhbS50ZXN0KG8pKXJldHVybiBhO28ucmVwbGFjZSh5LGZ1bmN0aW9uKG8pe3ZhciBjPW5ldyBSZWdFeHAoZykuZXhlYyhvKS5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuXCJcIiE9PXQmJm51bGwhPXR9KSxsPWNbMV0sdT1jLnNsaWNlKDIpLm1hcChwYXJzZUZsb2F0KTtzd2l0Y2gobCl7Y2FzZVwidHJhbnNsYXRlXCI6cyhhLHUpO2JyZWFrO2Nhc2VcInJvdGF0ZVwiOnVbMF09cC51dGlsLmRlZ3JlZXNUb1JhZGlhbnModVswXSksdChhLHUpO2JyZWFrO2Nhc2VcInNjYWxlXCI6ZShhLHUpO2JyZWFrO2Nhc2VcInNrZXdYXCI6aShhLHUpO2JyZWFrO2Nhc2VcInNrZXdZXCI6cihhLHUpO2JyZWFrO2Nhc2VcIm1hdHJpeFwiOmE9dX1oLnB1c2goYS5jb25jYXQoKSksYT1uLmNvbmNhdCgpfSk7Zm9yKHZhciBjPWhbMF07aC5sZW5ndGg+MTspaC5zaGlmdCgpLGM9cC51dGlsLm11bHRpcGx5VHJhbnNmb3JtTWF0cmljZXMoYyxoWzBdKTtyZXR1cm4gY319KCk7dmFyIHc9bmV3IFJlZ0V4cChcIl5cXFxccyooXCIrcC5yZU51bStcIispXFxcXHMqLD9cXFxccyooXCIrcC5yZU51bStcIispXFxcXHMqLD9cXFxccyooXCIrcC5yZU51bStcIispXFxcXHMqLD9cXFxccyooXCIrcC5yZU51bStcIispXFxcXHMqJFwiKTtwLnBhcnNlU1ZHRG9jdW1lbnQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7Zm9yKDt0JiYodD10LnBhcmVudE5vZGUpOylpZihlLnRlc3QodC5ub2RlTmFtZSkmJiF0LmdldEF0dHJpYnV0ZShcImluc3RhbnRpYXRlZF9ieV91c2VcIikpcmV0dXJuITA7cmV0dXJuITF9dmFyIGU9L14ocGF0aHxjaXJjbGV8cG9seWdvbnxwb2x5bGluZXxlbGxpcHNlfHJlY3R8bGluZXxpbWFnZXx0ZXh0KSQvLGk9L14oc3ltYm9sfGltYWdlfG1hcmtlcnxwYXR0ZXJufHZpZXcpJC87cmV0dXJuIGZ1bmN0aW9uKHIscyxuKXtpZihyKXt1KHIpO3ZhciBvLGEsaD1uZXcgRGF0ZSxjPXAuT2JqZWN0Ll9fdWlkKyssbD0hMTtpZihyLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpJiZcIjEwMCVcIiE9PXIuZ2V0QXR0cmlidXRlKFwid2lkdGhcIikmJihvPV8oci5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSkpLHIuZ2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIpJiZcIjEwMCVcIiE9PXIuZ2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIpJiYoYT1fKHIuZ2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIpKSksIW98fCFhKXt2YXIgZD1yLmdldEF0dHJpYnV0ZShcInZpZXdCb3hcIik7ZCYmKGQ9ZC5tYXRjaCh3KSk/KG89cGFyc2VGbG9hdChkWzNdKSxhPXBhcnNlRmxvYXQoZFs0XSkpOmw9ITB9ZihyLG8sYSk7dmFyIGc9cC51dGlsLnRvQXJyYXkoci5nZXRFbGVtZW50c0J5VGFnTmFtZShcIipcIikpO2lmKDA9PT1nLmxlbmd0aCYmcC5pc0xpa2VseU5vZGUpe2c9ci5zZWxlY3ROb2RlcygnLy8qW25hbWUoLikhPVwic3ZnXCJdJyk7Zm9yKHZhciB2PVtdLGI9MCx5PWcubGVuZ3RoO3k+YjtiKyspdltiXT1nW2JdO2c9dn12YXIgeD1nLmZpbHRlcihmdW5jdGlvbihyKXtyZXR1cm4gaS50ZXN0KHIudGFnTmFtZSkmJmYociwwLDApLGUudGVzdChyLnRhZ05hbWUpJiYhdChyLC9eKD86cGF0dGVybnxkZWZzfHN5bWJvbHxtZXRhZGF0YSkkLyl9KTtpZigheHx8eCYmIXgubGVuZ3RoKXJldHVybiB2b2lkKHMmJnMoW10se30pKTt2YXIgQz17d2lkdGg6byxoZWlnaHQ6YSxzdmdVaWQ6Yyx0b0JlUGFyc2VkOmx9O3AuZ3JhZGllbnREZWZzW2NdPXAuZ2V0R3JhZGllbnREZWZzKHIpLHAuY3NzUnVsZXNbY109cC5nZXRDU1NSdWxlcyhyKSxwLnBhcnNlRWxlbWVudHMoeCxmdW5jdGlvbih0KXtwLmRvY3VtZW50UGFyc2luZ1RpbWU9bmV3IERhdGUtaCxzJiZzKHQsQyl9LG0oQyksbil9fX0oKTt2YXIgTz17aGFzOmZ1bmN0aW9uKHQsZSl7ZSghMSl9LGdldDpmdW5jdGlvbigpe30sc2V0OmZ1bmN0aW9uKCl7fX0sVD1uZXcgUmVnRXhwKFwiKG5vcm1hbHxpdGFsaWMpP1xcXFxzKihub3JtYWx8c21hbGwtY2Fwcyk/XFxcXHMqKG5vcm1hbHxib2xkfGJvbGRlcnxsaWdodGVyfDEwMHwyMDB8MzAwfDQwMHw1MDB8NjAwfDcwMHw4MDB8OTAwKT9cXFxccyooXCIrcC5yZU51bStcIig/OnB4fGNtfG1tfGVtfHB0fHBjfGluKSopKD86XFxcXC8obm9ybWFsfFwiK3AucmVOdW0rXCIpKT9cXFxccysoLiopXCIpO3YocCx7cGFyc2VGb250RGVjbGFyYXRpb246ZnVuY3Rpb24odCxlKXt2YXIgaT10Lm1hdGNoKFQpO2lmKGkpe3ZhciByPWlbMV0scz1pWzNdLG49aVs0XSxvPWlbNV0sYT1pWzZdO3ImJihlLmZvbnRTdHlsZT1yKSxzJiYoZS5mb250V2VpZ2h0PWlzTmFOKHBhcnNlRmxvYXQocykpP3M6cGFyc2VGbG9hdChzKSksbiYmKGUuZm9udFNpemU9XyhuKSksXHJcbmEmJihlLmZvbnRGYW1pbHk9YSksbyYmKGUubGluZUhlaWdodD1cIm5vcm1hbFwiPT09bz8xOm8pfX0sZ2V0R3JhZGllbnREZWZzOmZ1bmN0aW9uKHQpe3ZhciBlLGkscixzLG49dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImxpbmVhckdyYWRpZW50XCIpLG89dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInJhZGlhbEdyYWRpZW50XCIpLGE9MCxoPVtdLGM9e30sbD17fTtmb3IoaC5sZW5ndGg9bi5sZW5ndGgrby5sZW5ndGgsaT1uLmxlbmd0aDtpLS07KWhbYSsrXT1uW2ldO2ZvcihpPW8ubGVuZ3RoO2ktLTspaFthKytdPW9baV07Zm9yKDthLS07KWU9aFthXSxzPWUuZ2V0QXR0cmlidXRlKFwieGxpbms6aHJlZlwiKSxyPWUuZ2V0QXR0cmlidXRlKFwiaWRcIikscyYmKGxbcl09cy5zdWJzdHIoMSkpLGNbcl09ZTtmb3IociBpbiBsKXt2YXIgdT1jW2xbcl1dLmNsb25lTm9kZSghMCk7Zm9yKGU9Y1tyXTt1LmZpcnN0Q2hpbGQ7KWUuYXBwZW5kQ2hpbGQodS5maXJzdENoaWxkKX1yZXR1cm4gY30scGFyc2VBdHRyaWJ1dGVzOmZ1bmN0aW9uKHQscyxuKXtpZih0KXt2YXIgYSxoLGM9e307XCJ1bmRlZmluZWRcIj09dHlwZW9mIG4mJihuPXQuZ2V0QXR0cmlidXRlKFwic3ZnVWlkXCIpKSx0LnBhcmVudE5vZGUmJi9ec3ltYm9sfFtnfGFdJC9pLnRlc3QodC5wYXJlbnROb2RlLm5vZGVOYW1lKSYmKGM9cC5wYXJzZUF0dHJpYnV0ZXModC5wYXJlbnROb2RlLHMsbikpLGg9YyYmYy5mb250U2l6ZXx8dC5nZXRBdHRyaWJ1dGUoXCJmb250LXNpemVcIil8fHAuVGV4dC5ERUZBVUxUX1NWR19GT05UX1NJWkU7dmFyIGw9cy5yZWR1Y2UoZnVuY3Rpb24ocixzKXtyZXR1cm4gYT10LmdldEF0dHJpYnV0ZShzKSxhJiYocz1lKHMpLGE9aShzLGEsYyxoKSxyW3NdPWEpLHJ9LHt9KTtyZXR1cm4gbD12KGwsdihvKHQsbikscC5wYXJzZVN0eWxlQXR0cmlidXRlKHQpKSksbC5mb250JiZwLnBhcnNlRm9udERlY2xhcmF0aW9uKGwuZm9udCxsKSxyKHYoYyxsKSl9fSxwYXJzZUVsZW1lbnRzOmZ1bmN0aW9uKHQsZSxpLHIpe25ldyBwLkVsZW1lbnRzUGFyc2VyKHQsZSxpLHIpLnBhcnNlKCl9LHBhcnNlU3R5bGVBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7dmFyIGU9e30saT10LmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO3JldHVybiBpPyhcInN0cmluZ1wiPT10eXBlb2YgaT9zKGksZSk6bihpLGUpLGUpOmV9LHBhcnNlUG9pbnRzQXR0cmlidXRlOmZ1bmN0aW9uKHQpe2lmKCF0KXJldHVybiBudWxsO3Q9dC5yZXBsYWNlKC8sL2csXCIgXCIpLnRyaW0oKSx0PXQuc3BsaXQoL1xccysvKTt2YXIgZSxpLHI9W107Zm9yKGU9MCxpPXQubGVuZ3RoO2k+ZTtlKz0yKXIucHVzaCh7eDpwYXJzZUZsb2F0KHRbZV0pLHk6cGFyc2VGbG9hdCh0W2UrMV0pfSk7cmV0dXJuIHJ9LGdldENTU1J1bGVzOmZ1bmN0aW9uKHQpe2Zvcih2YXIgcixzPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdHlsZVwiKSxuPXt9LG89MCxhPXMubGVuZ3RoO2E+bztvKyspe3ZhciBoPXNbb10udGV4dENvbnRlbnQ7aD1oLnJlcGxhY2UoL1xcL1xcKltcXHNcXFNdKj9cXCpcXC8vZyxcIlwiKSxcIlwiIT09aC50cmltKCkmJihyPWgubWF0Y2goL1tee10qXFx7W1xcc1xcU10qP1xcfS9nKSxyPXIubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0LnRyaW0oKX0pLHIuZm9yRWFjaChmdW5jdGlvbih0KXtmb3IodmFyIHI9dC5tYXRjaCgvKFtcXHNcXFNdKj8pXFxzKlxceyhbXn1dKilcXH0vKSxzPXt9LG89clsyXS50cmltKCksYT1vLnJlcGxhY2UoLzskLyxcIlwiKS5zcGxpdCgvXFxzKjtcXHMqLyksaD0wLGM9YS5sZW5ndGg7Yz5oO2grKyl7dmFyIGw9YVtoXS5zcGxpdCgvXFxzKjpcXHMqLyksdT1lKGxbMF0pLGY9aSh1LGxbMV0sbFswXSk7c1t1XT1mfXQ9clsxXSx0LnNwbGl0KFwiLFwiKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3Q9dC5yZXBsYWNlKC9ec3ZnL2ksXCJcIikudHJpbSgpLFwiXCIhPT10JiYoblt0XT1wLnV0aWwub2JqZWN0LmNsb25lKHMpKX0pfSkpfXJldHVybiBufSxsb2FkU1ZHRnJvbVVSTDpmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gcihyKXt2YXIgcz1yLnJlc3BvbnNlWE1MO3MmJiFzLmRvY3VtZW50RWxlbWVudCYmcC53aW5kb3cuQWN0aXZlWE9iamVjdCYmci5yZXNwb25zZVRleHQmJihzPW5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTERPTVwiKSxzLmFzeW5jPVwiZmFsc2VcIixzLmxvYWRYTUwoci5yZXNwb25zZVRleHQucmVwbGFjZSgvPCFET0NUWVBFW1xcc1xcU10qPyhcXFtbXFxzXFxTXSpcXF0pKj8+L2ksXCJcIikpKSxzJiZzLmRvY3VtZW50RWxlbWVudCYmcC5wYXJzZVNWR0RvY3VtZW50KHMuZG9jdW1lbnRFbGVtZW50LGZ1bmN0aW9uKGkscil7Ty5zZXQodCx7b2JqZWN0czpwLnV0aWwuYXJyYXkuaW52b2tlKGksXCJ0b09iamVjdFwiKSxvcHRpb25zOnJ9KSxlKGkscil9LGkpfXQ9dC5yZXBsYWNlKC9eXFxuXFxzKi8sXCJcIikudHJpbSgpLE8uaGFzKHQsZnVuY3Rpb24oaSl7aT9PLmdldCh0LGZ1bmN0aW9uKHQpe3ZhciBpPWQodCk7ZShpLm9iamVjdHMsaS5vcHRpb25zKX0pOm5ldyBwLnV0aWwucmVxdWVzdCh0LHttZXRob2Q6XCJnZXRcIixvbkNvbXBsZXRlOnJ9KX0pfSxsb2FkU1ZHRnJvbVN0cmluZzpmdW5jdGlvbih0LGUsaSl7dD10LnRyaW0oKTt2YXIgcjtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgRE9NUGFyc2VyKXt2YXIgcz1uZXcgRE9NUGFyc2VyO3MmJnMucGFyc2VGcm9tU3RyaW5nJiYocj1zLnBhcnNlRnJvbVN0cmluZyh0LFwidGV4dC94bWxcIikpfWVsc2UgcC53aW5kb3cuQWN0aXZlWE9iamVjdCYmKHI9bmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MRE9NXCIpLHIuYXN5bmM9XCJmYWxzZVwiLHIubG9hZFhNTCh0LnJlcGxhY2UoLzwhRE9DVFlQRVtcXHNcXFNdKj8oXFxbW1xcc1xcU10qXFxdKSo/Pi9pLFwiXCIpKSk7cC5wYXJzZVNWR0RvY3VtZW50KHIuZG9jdW1lbnRFbGVtZW50LGZ1bmN0aW9uKHQsaSl7ZSh0LGkpfSxpKX0sY3JlYXRlU1ZHRm9udEZhY2VzTWFya3VwOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1cIlwiLGk9MCxyPXQubGVuZ3RoO3I+aTtpKyspXCJ0ZXh0XCI9PT10W2ldLnR5cGUmJnRbaV0ucGF0aCYmKGUrPVtcIkBmb250LWZhY2Uge1wiLFwiZm9udC1mYW1pbHk6IFwiLHRbaV0uZm9udEZhbWlseSxcIjsgXCIsXCJzcmM6IHVybCgnXCIsdFtpXS5wYXRoLFwiJylcIixcIn1cIl0uam9pbihcIlwiKSk7cmV0dXJuIGUmJihlPVsnPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPicsXCI8IVtDREFUQVtcIixlLFwiXV0+XCIsXCI8L3N0eWxlPlwiXS5qb2luKFwiXCIpKSxlfSxjcmVhdGVTVkdSZWZFbGVtZW50c01hcmt1cDpmdW5jdGlvbih0KXt2YXIgZT1bXTtyZXR1cm4gZyhlLHQsXCJiYWNrZ3JvdW5kQ29sb3JcIiksZyhlLHQsXCJvdmVybGF5Q29sb3JcIiksZS5qb2luKFwiXCIpfX0pfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZhYnJpYy5FbGVtZW50c1BhcnNlcj1mdW5jdGlvbih0LGUsaSxyKXt0aGlzLmVsZW1lbnRzPXQsdGhpcy5jYWxsYmFjaz1lLHRoaXMub3B0aW9ucz1pLHRoaXMucmV2aXZlcj1yLHRoaXMuc3ZnVWlkPWkmJmkuc3ZnVWlkfHwwfSxmYWJyaWMuRWxlbWVudHNQYXJzZXIucHJvdG90eXBlLnBhcnNlPWZ1bmN0aW9uKCl7dGhpcy5pbnN0YW5jZXM9bmV3IEFycmF5KHRoaXMuZWxlbWVudHMubGVuZ3RoKSx0aGlzLm51bUVsZW1lbnRzPXRoaXMuZWxlbWVudHMubGVuZ3RoLHRoaXMuY3JlYXRlT2JqZWN0cygpfSxmYWJyaWMuRWxlbWVudHNQYXJzZXIucHJvdG90eXBlLmNyZWF0ZU9iamVjdHM9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MCxlPXRoaXMuZWxlbWVudHMubGVuZ3RoO2U+dDt0KyspdGhpcy5lbGVtZW50c1t0XS5zZXRBdHRyaWJ1dGUoXCJzdmdVaWRcIix0aGlzLnN2Z1VpZCksZnVuY3Rpb24odCxlKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dC5jcmVhdGVPYmplY3QodC5lbGVtZW50c1tlXSxlKX0sMCl9KHRoaXMsdCl9LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUuY3JlYXRlT2JqZWN0PWZ1bmN0aW9uKHQsZSl7dmFyIGk9ZmFicmljW2ZhYnJpYy51dGlsLnN0cmluZy5jYXBpdGFsaXplKHQudGFnTmFtZSldO2lmKGkmJmkuZnJvbUVsZW1lbnQpdHJ5e3RoaXMuX2NyZWF0ZU9iamVjdChpLHQsZSl9Y2F0Y2gocil7ZmFicmljLmxvZyhyKX1lbHNlIHRoaXMuY2hlY2tJZkRvbmUoKX0sZmFicmljLkVsZW1lbnRzUGFyc2VyLnByb3RvdHlwZS5fY3JlYXRlT2JqZWN0PWZ1bmN0aW9uKHQsZSxpKXtpZih0LmFzeW5jKXQuZnJvbUVsZW1lbnQoZSx0aGlzLmNyZWF0ZUNhbGxiYWNrKGksZSksdGhpcy5vcHRpb25zKTtlbHNle3ZhciByPXQuZnJvbUVsZW1lbnQoZSx0aGlzLm9wdGlvbnMpO3RoaXMucmVzb2x2ZUdyYWRpZW50KHIsXCJmaWxsXCIpLHRoaXMucmVzb2x2ZUdyYWRpZW50KHIsXCJzdHJva2VcIiksdGhpcy5yZXZpdmVyJiZ0aGlzLnJldml2ZXIoZSxyKSx0aGlzLmluc3RhbmNlc1tpXT1yLHRoaXMuY2hlY2tJZkRvbmUoKX19LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUuY3JlYXRlQ2FsbGJhY2s9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzO3JldHVybiBmdW5jdGlvbihyKXtpLnJlc29sdmVHcmFkaWVudChyLFwiZmlsbFwiKSxpLnJlc29sdmVHcmFkaWVudChyLFwic3Ryb2tlXCIpLGkucmV2aXZlciYmaS5yZXZpdmVyKGUsciksaS5pbnN0YW5jZXNbdF09cixpLmNoZWNrSWZEb25lKCl9fSxmYWJyaWMuRWxlbWVudHNQYXJzZXIucHJvdG90eXBlLnJlc29sdmVHcmFkaWVudD1mdW5jdGlvbih0LGUpe3ZhciBpPXQuZ2V0KGUpO2lmKC9edXJsXFwoLy50ZXN0KGkpKXt2YXIgcj1pLnNsaWNlKDUsaS5sZW5ndGgtMSk7ZmFicmljLmdyYWRpZW50RGVmc1t0aGlzLnN2Z1VpZF1bcl0mJnQuc2V0KGUsZmFicmljLkdyYWRpZW50LmZyb21FbGVtZW50KGZhYnJpYy5ncmFkaWVudERlZnNbdGhpcy5zdmdVaWRdW3JdLHQpKX19LGZhYnJpYy5FbGVtZW50c1BhcnNlci5wcm90b3R5cGUuY2hlY2tJZkRvbmU9ZnVuY3Rpb24oKXswPT09LS10aGlzLm51bUVsZW1lbnRzJiYodGhpcy5pbnN0YW5jZXM9dGhpcy5pbnN0YW5jZXMuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiBudWxsIT10fSksdGhpcy5jYWxsYmFjayh0aGlzLmluc3RhbmNlcykpfSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKHQsZSl7dGhpcy54PXQsdGhpcy55PWV9dmFyIGk9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7cmV0dXJuIGkuUG9pbnQ/dm9pZCBpLndhcm4oXCJmYWJyaWMuUG9pbnQgaXMgYWxyZWFkeSBkZWZpbmVkXCIpOihpLlBvaW50PWUsdm9pZChlLnByb3RvdHlwZT17Y29uc3RydWN0b3I6ZSxhZGQ6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKHRoaXMueCt0LngsdGhpcy55K3QueSl9LGFkZEVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Kz10LngsdGhpcy55Kz10LnksdGhpc30sc2NhbGFyQWRkOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngrdCx0aGlzLnkrdCl9LHNjYWxhckFkZEVxdWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54Kz10LHRoaXMueSs9dCx0aGlzfSxzdWJ0cmFjdDpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy54LXQueCx0aGlzLnktdC55KX0sc3VidHJhY3RFcXVhbHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueC09dC54LHRoaXMueS09dC55LHRoaXN9LHNjYWxhclN1YnRyYWN0OmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngtdCx0aGlzLnktdCl9LHNjYWxhclN1YnRyYWN0RXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngtPXQsdGhpcy55LT10LHRoaXN9LG11bHRpcGx5OmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0aGlzLngqdCx0aGlzLnkqdCl9LG11bHRpcGx5RXF1YWxzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngqPXQsdGhpcy55Kj10LHRoaXN9LGRpdmlkZTpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy54L3QsdGhpcy55L3QpfSxkaXZpZGVFcXVhbHM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueC89dCx0aGlzLnkvPXQsdGhpc30sZXE6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueD09PXQueCYmdGhpcy55PT09dC55fSxsdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy54PHQueCYmdGhpcy55PHQueX0sbHRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLng8PXQueCYmdGhpcy55PD10Lnl9LGd0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLng+dC54JiZ0aGlzLnk+dC55fSxndGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMueD49dC54JiZ0aGlzLnk+PXQueX0sbGVycDpmdW5jdGlvbih0LGkpe3JldHVybiBuZXcgZSh0aGlzLngrKHQueC10aGlzLngpKmksdGhpcy55Kyh0LnktdGhpcy55KSppKX0sZGlzdGFuY2VGcm9tOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMueC10LngsaT10aGlzLnktdC55O3JldHVybiBNYXRoLnNxcnQoZSplK2kqaSl9LG1pZFBvaW50RnJvbTpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodGhpcy54Kyh0LngtdGhpcy54KS8yLHRoaXMueSsodC55LXRoaXMueSkvMil9LG1pbjpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUoTWF0aC5taW4odGhpcy54LHQueCksTWF0aC5taW4odGhpcy55LHQueSkpfSxtYXg6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlKE1hdGgubWF4KHRoaXMueCx0LngpLE1hdGgubWF4KHRoaXMueSx0LnkpKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54K1wiLFwiK3RoaXMueX0sc2V0WFk6ZnVuY3Rpb24odCxlKXt0aGlzLng9dCx0aGlzLnk9ZX0sc2V0RnJvbVBvaW50OmZ1bmN0aW9uKHQpe3RoaXMueD10LngsdGhpcy55PXQueX0sc3dhcDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLngsaT10aGlzLnk7dGhpcy54PXQueCx0aGlzLnk9dC55LHQueD1lLHQueT1pfX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKHQpe3RoaXMuc3RhdHVzPXQsdGhpcy5wb2ludHM9W119dmFyIGk9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7cmV0dXJuIGkuSW50ZXJzZWN0aW9uP3ZvaWQgaS53YXJuKFwiZmFicmljLkludGVyc2VjdGlvbiBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGkuSW50ZXJzZWN0aW9uPWUsaS5JbnRlcnNlY3Rpb24ucHJvdG90eXBlPXthcHBlbmRQb2ludDpmdW5jdGlvbih0KXt0aGlzLnBvaW50cy5wdXNoKHQpfSxhcHBlbmRQb2ludHM6ZnVuY3Rpb24odCl7dGhpcy5wb2ludHM9dGhpcy5wb2ludHMuY29uY2F0KHQpfX0saS5JbnRlcnNlY3Rpb24uaW50ZXJzZWN0TGluZUxpbmU9ZnVuY3Rpb24odCxyLHMsbil7dmFyIG8sYT0obi54LXMueCkqKHQueS1zLnkpLShuLnktcy55KSoodC54LXMueCksaD0oci54LXQueCkqKHQueS1zLnkpLShyLnktdC55KSoodC54LXMueCksYz0obi55LXMueSkqKHIueC10LngpLShuLngtcy54KSooci55LXQueSk7aWYoMCE9PWMpe3ZhciBsPWEvYyx1PWgvYztsPj0wJiYxPj1sJiZ1Pj0wJiYxPj11PyhvPW5ldyBlKFwiSW50ZXJzZWN0aW9uXCIpLG8ucG9pbnRzLnB1c2gobmV3IGkuUG9pbnQodC54K2wqKHIueC10LngpLHQueStsKihyLnktdC55KSkpKTpvPW5ldyBlfWVsc2Ugbz1uZXcgZSgwPT09YXx8MD09PWg/XCJDb2luY2lkZW50XCI6XCJQYXJhbGxlbFwiKTtyZXR1cm4gb30saS5JbnRlcnNlY3Rpb24uaW50ZXJzZWN0TGluZVBvbHlnb249ZnVuY3Rpb24odCxpLHIpe2Zvcih2YXIgcz1uZXcgZSxuPXIubGVuZ3RoLG89MDtuPm87bysrKXt2YXIgYT1yW29dLGg9clsobysxKSVuXSxjPWUuaW50ZXJzZWN0TGluZUxpbmUodCxpLGEsaCk7cy5hcHBlbmRQb2ludHMoYy5wb2ludHMpfXJldHVybiBzLnBvaW50cy5sZW5ndGg+MCYmKHMuc3RhdHVzPVwiSW50ZXJzZWN0aW9uXCIpLHN9LGkuSW50ZXJzZWN0aW9uLmludGVyc2VjdFBvbHlnb25Qb2x5Z29uPWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciByPW5ldyBlLHM9dC5sZW5ndGgsbj0wO3M+bjtuKyspe3ZhciBvPXRbbl0sYT10WyhuKzEpJXNdLGg9ZS5pbnRlcnNlY3RMaW5lUG9seWdvbihvLGEsaSk7ci5hcHBlbmRQb2ludHMoaC5wb2ludHMpfXJldHVybiByLnBvaW50cy5sZW5ndGg+MCYmKHIuc3RhdHVzPVwiSW50ZXJzZWN0aW9uXCIpLHJ9LHZvaWQoaS5JbnRlcnNlY3Rpb24uaW50ZXJzZWN0UG9seWdvblJlY3RhbmdsZT1mdW5jdGlvbih0LHIscyl7dmFyIG49ci5taW4ocyksbz1yLm1heChzKSxhPW5ldyBpLlBvaW50KG8ueCxuLnkpLGg9bmV3IGkuUG9pbnQobi54LG8ueSksYz1lLmludGVyc2VjdExpbmVQb2x5Z29uKG4sYSx0KSxsPWUuaW50ZXJzZWN0TGluZVBvbHlnb24oYSxvLHQpLHU9ZS5pbnRlcnNlY3RMaW5lUG9seWdvbihvLGgsdCksZj1lLmludGVyc2VjdExpbmVQb2x5Z29uKGgsbix0KSxkPW5ldyBlO3JldHVybiBkLmFwcGVuZFBvaW50cyhjLnBvaW50cyksZC5hcHBlbmRQb2ludHMobC5wb2ludHMpLGQuYXBwZW5kUG9pbnRzKHUucG9pbnRzKSxkLmFwcGVuZFBvaW50cyhmLnBvaW50cyksZC5wb2ludHMubGVuZ3RoPjAmJihkLnN0YXR1cz1cIkludGVyc2VjdGlvblwiKSxkfSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCl7dD90aGlzLl90cnlQYXJzaW5nQ29sb3IodCk6dGhpcy5zZXRTb3VyY2UoWzAsMCwwLDFdKX1mdW5jdGlvbiBpKHQsZSxpKXtyZXR1cm4gMD5pJiYoaSs9MSksaT4xJiYoaS09MSksMS82Pmk/dCs2KihlLXQpKmk6LjU+aT9lOjIvMz5pP3QrKGUtdCkqKDIvMy1pKSo2OnR9dmFyIHI9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7cmV0dXJuIHIuQ29sb3I/dm9pZCByLndhcm4oXCJmYWJyaWMuQ29sb3IgaXMgYWxyZWFkeSBkZWZpbmVkLlwiKTooci5Db2xvcj1lLHIuQ29sb3IucHJvdG90eXBlPXtfdHJ5UGFyc2luZ0NvbG9yOmZ1bmN0aW9uKHQpe3ZhciBpO3JldHVybiB0IGluIGUuY29sb3JOYW1lTWFwJiYodD1lLmNvbG9yTmFtZU1hcFt0XSksXCJ0cmFuc3BhcmVudFwiPT09dD92b2lkIHRoaXMuc2V0U291cmNlKFsyNTUsMjU1LDI1NSwwXSk6KGk9ZS5zb3VyY2VGcm9tSGV4KHQpLGl8fChpPWUuc291cmNlRnJvbVJnYih0KSksaXx8KGk9ZS5zb3VyY2VGcm9tSHNsKHQpKSx2b2lkKGkmJnRoaXMuc2V0U291cmNlKGkpKSl9LF9yZ2JUb0hzbDpmdW5jdGlvbih0LGUsaSl7dC89MjU1LGUvPTI1NSxpLz0yNTU7dmFyIHMsbixvLGE9ci51dGlsLmFycmF5Lm1heChbdCxlLGldKSxoPXIudXRpbC5hcnJheS5taW4oW3QsZSxpXSk7aWYobz0oYStoKS8yLGE9PT1oKXM9bj0wO2Vsc2V7dmFyIGM9YS1oO3N3aXRjaChuPW8+LjU/Yy8oMi1hLWgpOmMvKGEraCksYSl7Y2FzZSB0OnM9KGUtaSkvYysoaT5lPzY6MCk7YnJlYWs7Y2FzZSBlOnM9KGktdCkvYysyO2JyZWFrO2Nhc2UgaTpzPSh0LWUpL2MrNH1zLz02fXJldHVybltNYXRoLnJvdW5kKDM2MCpzKSxNYXRoLnJvdW5kKDEwMCpuKSxNYXRoLnJvdW5kKDEwMCpvKV19LGdldFNvdXJjZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zb3VyY2V9LHNldFNvdXJjZTpmdW5jdGlvbih0KXt0aGlzLl9zb3VyY2U9dH0sdG9SZ2I6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFNvdXJjZSgpO3JldHVyblwicmdiKFwiK3RbMF0rXCIsXCIrdFsxXStcIixcIit0WzJdK1wiKVwifSx0b1JnYmE6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFNvdXJjZSgpO3JldHVyblwicmdiYShcIit0WzBdK1wiLFwiK3RbMV0rXCIsXCIrdFsyXStcIixcIit0WzNdK1wiKVwifSx0b0hzbDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0U291cmNlKCksZT10aGlzLl9yZ2JUb0hzbCh0WzBdLHRbMV0sdFsyXSk7cmV0dXJuXCJoc2woXCIrZVswXStcIixcIitlWzFdK1wiJSxcIitlWzJdK1wiJSlcIn0sdG9Ic2xhOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRTb3VyY2UoKSxlPXRoaXMuX3JnYlRvSHNsKHRbMF0sdFsxXSx0WzJdKTtyZXR1cm5cImhzbGEoXCIrZVswXStcIixcIitlWzFdK1wiJSxcIitlWzJdK1wiJSxcIit0WzNdK1wiKVwifSx0b0hleDpmdW5jdGlvbigpe3ZhciB0LGUsaSxyPXRoaXMuZ2V0U291cmNlKCk7cmV0dXJuIHQ9clswXS50b1N0cmluZygxNiksdD0xPT09dC5sZW5ndGg/XCIwXCIrdDp0LGU9clsxXS50b1N0cmluZygxNiksZT0xPT09ZS5sZW5ndGg/XCIwXCIrZTplLGk9clsyXS50b1N0cmluZygxNiksaT0xPT09aS5sZW5ndGg/XCIwXCIraTppLHQudG9VcHBlckNhc2UoKStlLnRvVXBwZXJDYXNlKCkraS50b1VwcGVyQ2FzZSgpfSxnZXRBbHBoYTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNvdXJjZSgpWzNdfSxzZXRBbHBoYTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFNvdXJjZSgpO3JldHVybiBlWzNdPXQsdGhpcy5zZXRTb3VyY2UoZSksdGhpc30sdG9HcmF5c2NhbGU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFNvdXJjZSgpLGU9cGFyc2VJbnQoKC4zKnRbMF0rLjU5KnRbMV0rLjExKnRbMl0pLnRvRml4ZWQoMCksMTApLGk9dFszXTtyZXR1cm4gdGhpcy5zZXRTb3VyY2UoW2UsZSxlLGldKSx0aGlzfSx0b0JsYWNrV2hpdGU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRTb3VyY2UoKSxpPSguMyplWzBdKy41OSplWzFdKy4xMSplWzJdKS50b0ZpeGVkKDApLHI9ZVszXTtyZXR1cm4gdD10fHwxMjcsaT1OdW1iZXIoaSk8TnVtYmVyKHQpPzA6MjU1LHRoaXMuc2V0U291cmNlKFtpLGksaSxyXSksdGhpc30sb3ZlcmxheVdpdGg6ZnVuY3Rpb24odCl7dCBpbnN0YW5jZW9mIGV8fCh0PW5ldyBlKHQpKTtmb3IodmFyIGk9W10scj10aGlzLmdldEFscGhhKCkscz0uNSxuPXRoaXMuZ2V0U291cmNlKCksbz10LmdldFNvdXJjZSgpLGE9MDszPmE7YSsrKWkucHVzaChNYXRoLnJvdW5kKG5bYV0qKDEtcykrb1thXSpzKSk7cmV0dXJuIGlbM109cix0aGlzLnNldFNvdXJjZShpKSx0aGlzfX0sci5Db2xvci5yZVJHQmE9L15yZ2JhP1xcKFxccyooXFxkezEsM30oPzpcXC5cXGQrKT9cXCU/KVxccyosXFxzKihcXGR7MSwzfSg/OlxcLlxcZCspP1xcJT8pXFxzKixcXHMqKFxcZHsxLDN9KD86XFwuXFxkKyk/XFwlPylcXHMqKD86XFxzKixcXHMqKFxcZCsoPzpcXC5cXGQrKT8pXFxzKik/XFwpJC8sci5Db2xvci5yZUhTTGE9L15oc2xhP1xcKFxccyooXFxkezEsM30pXFxzKixcXHMqKFxcZHsxLDN9XFwlKVxccyosXFxzKihcXGR7MSwzfVxcJSlcXHMqKD86XFxzKixcXHMqKFxcZCsoPzpcXC5cXGQrKT8pXFxzKik/XFwpJC8sci5Db2xvci5yZUhleD0vXiM/KFswLTlhLWZdezZ9fFswLTlhLWZdezN9KSQvaSxyLkNvbG9yLmNvbG9yTmFtZU1hcD17YXF1YTpcIiMwMEZGRkZcIixibGFjazpcIiMwMDAwMDBcIixibHVlOlwiIzAwMDBGRlwiLGZ1Y2hzaWE6XCIjRkYwMEZGXCIsZ3JheTpcIiM4MDgwODBcIixncmVlbjpcIiMwMDgwMDBcIixsaW1lOlwiIzAwRkYwMFwiLG1hcm9vbjpcIiM4MDAwMDBcIixuYXZ5OlwiIzAwMDA4MFwiLG9saXZlOlwiIzgwODAwMFwiLG9yYW5nZTpcIiNGRkE1MDBcIixwdXJwbGU6XCIjODAwMDgwXCIscmVkOlwiI0ZGMDAwMFwiLHNpbHZlcjpcIiNDMEMwQzBcIix0ZWFsOlwiIzAwODA4MFwiLHdoaXRlOlwiI0ZGRkZGRlwiLHllbGxvdzpcIiNGRkZGMDBcIn0sci5Db2xvci5mcm9tUmdiPWZ1bmN0aW9uKHQpe3JldHVybiBlLmZyb21Tb3VyY2UoZS5zb3VyY2VGcm9tUmdiKHQpKX0sci5Db2xvci5zb3VyY2VGcm9tUmdiPWZ1bmN0aW9uKHQpe3ZhciBpPXQubWF0Y2goZS5yZVJHQmEpO2lmKGkpe3ZhciByPXBhcnNlSW50KGlbMV0sMTApLygvJSQvLnRlc3QoaVsxXSk/MTAwOjEpKigvJSQvLnRlc3QoaVsxXSk/MjU1OjEpLHM9cGFyc2VJbnQoaVsyXSwxMCkvKC8lJC8udGVzdChpWzJdKT8xMDA6MSkqKC8lJC8udGVzdChpWzJdKT8yNTU6MSksbj1wYXJzZUludChpWzNdLDEwKS8oLyUkLy50ZXN0KGlbM10pPzEwMDoxKSooLyUkLy50ZXN0KGlbM10pPzI1NToxKTtyZXR1cm5bcGFyc2VJbnQociwxMCkscGFyc2VJbnQocywxMCkscGFyc2VJbnQobiwxMCksaVs0XT9wYXJzZUZsb2F0KGlbNF0pOjFdfX0sci5Db2xvci5mcm9tUmdiYT1lLmZyb21SZ2Isci5Db2xvci5mcm9tSHNsPWZ1bmN0aW9uKHQpe3JldHVybiBlLmZyb21Tb3VyY2UoZS5zb3VyY2VGcm9tSHNsKHQpKX0sci5Db2xvci5zb3VyY2VGcm9tSHNsPWZ1bmN0aW9uKHQpe3ZhciByPXQubWF0Y2goZS5yZUhTTGEpO2lmKHIpe3ZhciBzLG4sbyxhPShwYXJzZUZsb2F0KHJbMV0pJTM2MCszNjApJTM2MC8zNjAsaD1wYXJzZUZsb2F0KHJbMl0pLygvJSQvLnRlc3QoclsyXSk/MTAwOjEpLGM9cGFyc2VGbG9hdChyWzNdKS8oLyUkLy50ZXN0KHJbM10pPzEwMDoxKTtpZigwPT09aClzPW49bz1jO2Vsc2V7dmFyIGw9LjU+PWM/YyooaCsxKTpjK2gtYypoLHU9MipjLWw7cz1pKHUsbCxhKzEvMyksbj1pKHUsbCxhKSxvPWkodSxsLGEtMS8zKX1yZXR1cm5bTWF0aC5yb3VuZCgyNTUqcyksTWF0aC5yb3VuZCgyNTUqbiksTWF0aC5yb3VuZCgyNTUqbykscls0XT9wYXJzZUZsb2F0KHJbNF0pOjFdfX0sci5Db2xvci5mcm9tSHNsYT1lLmZyb21Ic2wsci5Db2xvci5mcm9tSGV4PWZ1bmN0aW9uKHQpe3JldHVybiBlLmZyb21Tb3VyY2UoZS5zb3VyY2VGcm9tSGV4KHQpKX0sci5Db2xvci5zb3VyY2VGcm9tSGV4PWZ1bmN0aW9uKHQpe2lmKHQubWF0Y2goZS5yZUhleCkpe3ZhciBpPXQuc2xpY2UodC5pbmRleE9mKFwiI1wiKSsxKSxyPTM9PT1pLmxlbmd0aCxzPXI/aS5jaGFyQXQoMCkraS5jaGFyQXQoMCk6aS5zdWJzdHJpbmcoMCwyKSxuPXI/aS5jaGFyQXQoMSkraS5jaGFyQXQoMSk6aS5zdWJzdHJpbmcoMiw0KSxvPXI/aS5jaGFyQXQoMikraS5jaGFyQXQoMik6aS5zdWJzdHJpbmcoNCw2KTtyZXR1cm5bcGFyc2VJbnQocywxNikscGFyc2VJbnQobiwxNikscGFyc2VJbnQobywxNiksMV19fSx2b2lkKHIuQ29sb3IuZnJvbVNvdXJjZT1mdW5jdGlvbih0KXt2YXIgaT1uZXcgZTtyZXR1cm4gaS5zZXRTb3VyY2UodCksaX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dmFyIGUsaSxyLHM9dC5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKSxuPXQuZ2V0QXR0cmlidXRlKFwib2Zmc2V0XCIpO2lmKG49cGFyc2VGbG9hdChuKS8oLyUkLy50ZXN0KG4pPzEwMDoxKSxuPTA+bj8wOm4+MT8xOm4scyl7dmFyIG89cy5zcGxpdCgvXFxzKjtcXHMqLyk7XCJcIj09PW9bby5sZW5ndGgtMV0mJm8ucG9wKCk7Zm9yKHZhciBhPW8ubGVuZ3RoO2EtLTspe3ZhciBoPW9bYV0uc3BsaXQoL1xccyo6XFxzKi8pLGM9aFswXS50cmltKCksbD1oWzFdLnRyaW0oKTtcInN0b3AtY29sb3JcIj09PWM/ZT1sOlwic3RvcC1vcGFjaXR5XCI9PT1jJiYocj1sKX19cmV0dXJuIGV8fChlPXQuZ2V0QXR0cmlidXRlKFwic3RvcC1jb2xvclwiKXx8XCJyZ2IoMCwwLDApXCIpLHJ8fChyPXQuZ2V0QXR0cmlidXRlKFwic3RvcC1vcGFjaXR5XCIpKSxlPW5ldyBmYWJyaWMuQ29sb3IoZSksaT1lLmdldEFscGhhKCkscj1pc05hTihwYXJzZUZsb2F0KHIpKT8xOnBhcnNlRmxvYXQocikscio9aSx7b2Zmc2V0Om4sY29sb3I6ZS50b1JnYigpLG9wYWNpdHk6cn19ZnVuY3Rpb24gZSh0KXtyZXR1cm57eDE6dC5nZXRBdHRyaWJ1dGUoXCJ4MVwiKXx8MCx5MTp0LmdldEF0dHJpYnV0ZShcInkxXCIpfHwwLHgyOnQuZ2V0QXR0cmlidXRlKFwieDJcIil8fFwiMTAwJVwiLHkyOnQuZ2V0QXR0cmlidXRlKFwieTJcIil8fDB9fWZ1bmN0aW9uIGkodCl7cmV0dXJue3gxOnQuZ2V0QXR0cmlidXRlKFwiZnhcIil8fHQuZ2V0QXR0cmlidXRlKFwiY3hcIil8fFwiNTAlXCIseTE6dC5nZXRBdHRyaWJ1dGUoXCJmeVwiKXx8dC5nZXRBdHRyaWJ1dGUoXCJjeVwiKXx8XCI1MCVcIixyMTowLHgyOnQuZ2V0QXR0cmlidXRlKFwiY3hcIil8fFwiNTAlXCIseTI6dC5nZXRBdHRyaWJ1dGUoXCJjeVwiKXx8XCI1MCVcIixyMjp0LmdldEF0dHJpYnV0ZShcInJcIil8fFwiNTAlXCJ9fWZ1bmN0aW9uIHIodCxlLGkpe3ZhciByLHM9MCxuPTEsbz1cIlwiO2Zvcih2YXIgYSBpbiBlKXI9cGFyc2VGbG9hdChlW2FdLDEwKSxuPVwic3RyaW5nXCI9PXR5cGVvZiBlW2FdJiYvXlxcZCslJC8udGVzdChlW2FdKT8uMDE6MSxcIngxXCI9PT1hfHxcIngyXCI9PT1hfHxcInIyXCI9PT1hPyhuKj1cIm9iamVjdEJvdW5kaW5nQm94XCI9PT1pP3Qud2lkdGg6MSxzPVwib2JqZWN0Qm91bmRpbmdCb3hcIj09PWk/dC5sZWZ0fHwwOjApOihcInkxXCI9PT1hfHxcInkyXCI9PT1hKSYmKG4qPVwib2JqZWN0Qm91bmRpbmdCb3hcIj09PWk/dC5oZWlnaHQ6MSxzPVwib2JqZWN0Qm91bmRpbmdCb3hcIj09PWk/dC50b3B8fDA6MCksZVthXT1yKm4rcztpZihcImVsbGlwc2VcIj09PXQudHlwZSYmbnVsbCE9PWUucjImJlwib2JqZWN0Qm91bmRpbmdCb3hcIj09PWkmJnQucnghPT10LnJ5KXt2YXIgaD10LnJ5L3Qucng7bz1cIiBzY2FsZSgxLCBcIitoK1wiKVwiLGUueTEmJihlLnkxLz1oKSxlLnkyJiYoZS55Mi89aCl9cmV0dXJuIG99ZmFicmljLkdyYWRpZW50PWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKHtvZmZzZXRYOjAsb2Zmc2V0WTowLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dHx8KHQ9e30pO3ZhciBlPXt9O3RoaXMuaWQ9ZmFicmljLk9iamVjdC5fX3VpZCsrLHRoaXMudHlwZT10LnR5cGV8fFwibGluZWFyXCIsZT17eDE6dC5jb29yZHMueDF8fDAseTE6dC5jb29yZHMueTF8fDAseDI6dC5jb29yZHMueDJ8fDAseTI6dC5jb29yZHMueTJ8fDB9LFwicmFkaWFsXCI9PT10aGlzLnR5cGUmJihlLnIxPXQuY29vcmRzLnIxfHwwLGUucjI9dC5jb29yZHMucjJ8fDApLHRoaXMuY29vcmRzPWUsdGhpcy5jb2xvclN0b3BzPXQuY29sb3JTdG9wcy5zbGljZSgpLHQuZ3JhZGllbnRUcmFuc2Zvcm0mJih0aGlzLmdyYWRpZW50VHJhbnNmb3JtPXQuZ3JhZGllbnRUcmFuc2Zvcm0pLHRoaXMub2Zmc2V0WD10Lm9mZnNldFh8fHRoaXMub2Zmc2V0WCx0aGlzLm9mZnNldFk9dC5vZmZzZXRZfHx0aGlzLm9mZnNldFl9LGFkZENvbG9yU3RvcDpmdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdCl7dmFyIGk9bmV3IGZhYnJpYy5Db2xvcih0W2VdKTt0aGlzLmNvbG9yU3RvcHMucHVzaCh7b2Zmc2V0OmUsY29sb3I6aS50b1JnYigpLG9wYWNpdHk6aS5nZXRBbHBoYSgpfSl9cmV0dXJuIHRoaXN9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJue3R5cGU6dGhpcy50eXBlLGNvb3Jkczp0aGlzLmNvb3Jkcyxjb2xvclN0b3BzOnRoaXMuY29sb3JTdG9wcyxvZmZzZXRYOnRoaXMub2Zmc2V0WCxvZmZzZXRZOnRoaXMub2Zmc2V0WX19LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlLGkscj1mYWJyaWMudXRpbC5vYmplY3QuY2xvbmUodGhpcy5jb29yZHMpO2lmKHRoaXMuY29sb3JTdG9wcy5zb3J0KGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQub2Zmc2V0LWUub2Zmc2V0fSksIXQuZ3JvdXB8fFwicGF0aC1ncm91cFwiIT09dC5ncm91cC50eXBlKWZvcih2YXIgcyBpbiByKVwieDFcIj09PXN8fFwieDJcIj09PXN8fFwicjJcIj09PXM/cltzXSs9dGhpcy5vZmZzZXRYLXQud2lkdGgvMjooXCJ5MVwiPT09c3x8XCJ5MlwiPT09cykmJihyW3NdKz10aGlzLm9mZnNldFktdC5oZWlnaHQvMik7aT0naWQ9XCJTVkdJRF8nK3RoaXMuaWQrJ1wiIGdyYWRpZW50VW5pdHM9XCJ1c2VyU3BhY2VPblVzZVwiJyx0aGlzLmdyYWRpZW50VHJhbnNmb3JtJiYoaSs9JyBncmFkaWVudFRyYW5zZm9ybT1cIm1hdHJpeCgnK3RoaXMuZ3JhZGllbnRUcmFuc2Zvcm0uam9pbihcIiBcIikrJylcIiAnKSxcImxpbmVhclwiPT09dGhpcy50eXBlP2U9W1wiPGxpbmVhckdyYWRpZW50IFwiLGksJyB4MT1cIicsci54MSwnXCIgeTE9XCInLHIueTEsJ1wiIHgyPVwiJyxyLngyLCdcIiB5Mj1cIicsci55MiwnXCI+XFxuJ106XCJyYWRpYWxcIj09PXRoaXMudHlwZSYmKGU9W1wiPHJhZGlhbEdyYWRpZW50IFwiLGksJyBjeD1cIicsci54MiwnXCIgY3k9XCInLHIueTIsJ1wiIHI9XCInLHIucjIsJ1wiIGZ4PVwiJyxyLngxLCdcIiBmeT1cIicsci55MSwnXCI+XFxuJ10pO2Zvcih2YXIgbj0wO248dGhpcy5jb2xvclN0b3BzLmxlbmd0aDtuKyspZS5wdXNoKFwiPHN0b3AgXCIsJ29mZnNldD1cIicsMTAwKnRoaXMuY29sb3JTdG9wc1tuXS5vZmZzZXQrXCIlXCIsJ1wiIHN0eWxlPVwic3RvcC1jb2xvcjonLHRoaXMuY29sb3JTdG9wc1tuXS5jb2xvcixudWxsIT10aGlzLmNvbG9yU3RvcHNbbl0ub3BhY2l0eT9cIjtzdG9wLW9wYWNpdHk6IFwiK3RoaXMuY29sb3JTdG9wc1tuXS5vcGFjaXR5OlwiO1wiLCdcIi8+XFxuJyk7cmV0dXJuIGUucHVzaChcImxpbmVhclwiPT09dGhpcy50eXBlP1wiPC9saW5lYXJHcmFkaWVudD5cXG5cIjpcIjwvcmFkaWFsR3JhZGllbnQ+XFxuXCIpLGUuam9pbihcIlwiKX0sdG9MaXZlOmZ1bmN0aW9uKHQsZSl7dmFyIGkscixzPWZhYnJpYy51dGlsLm9iamVjdC5jbG9uZSh0aGlzLmNvb3Jkcyk7aWYodGhpcy50eXBlKXtpZihlLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PWUuZ3JvdXAudHlwZSlmb3IociBpbiBzKVwieDFcIj09PXJ8fFwieDJcIj09PXI/c1tyXSs9LXRoaXMub2Zmc2V0WCtlLndpZHRoLzI6KFwieTFcIj09PXJ8fFwieTJcIj09PXIpJiYoc1tyXSs9LXRoaXMub2Zmc2V0WStlLmhlaWdodC8yKTtcImxpbmVhclwiPT09dGhpcy50eXBlP2k9dC5jcmVhdGVMaW5lYXJHcmFkaWVudChzLngxLHMueTEscy54MixzLnkyKTpcInJhZGlhbFwiPT09dGhpcy50eXBlJiYoaT10LmNyZWF0ZVJhZGlhbEdyYWRpZW50KHMueDEscy55MSxzLnIxLHMueDIscy55MixzLnIyKSk7Zm9yKHZhciBuPTAsbz10aGlzLmNvbG9yU3RvcHMubGVuZ3RoO28+bjtuKyspe3ZhciBhPXRoaXMuY29sb3JTdG9wc1tuXS5jb2xvcixoPXRoaXMuY29sb3JTdG9wc1tuXS5vcGFjaXR5LGM9dGhpcy5jb2xvclN0b3BzW25dLm9mZnNldDtcInVuZGVmaW5lZFwiIT10eXBlb2YgaCYmKGE9bmV3IGZhYnJpYy5Db2xvcihhKS5zZXRBbHBoYShoKS50b1JnYmEoKSksaS5hZGRDb2xvclN0b3AocGFyc2VGbG9hdChjKSxhKX1yZXR1cm4gaX19fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuR3JhZGllbnQse2Zyb21FbGVtZW50OmZ1bmN0aW9uKHMsbil7dmFyIG8sYT1zLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3RvcFwiKSxoPVwibGluZWFyR3JhZGllbnRcIj09PXMubm9kZU5hbWU/XCJsaW5lYXJcIjpcInJhZGlhbFwiLGM9cy5nZXRBdHRyaWJ1dGUoXCJncmFkaWVudFVuaXRzXCIpfHxcIm9iamVjdEJvdW5kaW5nQm94XCIsbD1zLmdldEF0dHJpYnV0ZShcImdyYWRpZW50VHJhbnNmb3JtXCIpLHU9W10sZj17fTtcImxpbmVhclwiPT09aD9mPWUocyk6XCJyYWRpYWxcIj09PWgmJihmPWkocykpO2Zvcih2YXIgZD1hLmxlbmd0aDtkLS07KXUucHVzaCh0KGFbZF0pKTtvPXIobixmLGMpO3ZhciBnPW5ldyBmYWJyaWMuR3JhZGllbnQoe3R5cGU6aCxjb29yZHM6Zixjb2xvclN0b3BzOnUsb2Zmc2V0WDotbi5sZWZ0LG9mZnNldFk6LW4udG9wfSk7cmV0dXJuKGx8fFwiXCIhPT1vKSYmKGcuZ3JhZGllbnRUcmFuc2Zvcm09ZmFicmljLnBhcnNlVHJhbnNmb3JtQXR0cmlidXRlKChsfHxcIlwiKStvKSksZ30sZm9yT2JqZWN0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGV8fChlPXt9KSxyKHQsZS5jb29yZHMsXCJ1c2VyU3BhY2VPblVzZVwiKSxuZXcgZmFicmljLkdyYWRpZW50KGUpfX0pfSgpLGZhYnJpYy5QYXR0ZXJuPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKHtyZXBlYXQ6XCJyZXBlYXRcIixvZmZzZXRYOjAsb2Zmc2V0WTowLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7aWYodHx8KHQ9e30pLHRoaXMuaWQ9ZmFicmljLk9iamVjdC5fX3VpZCsrLHQuc291cmNlKWlmKFwic3RyaW5nXCI9PXR5cGVvZiB0LnNvdXJjZSlpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgZmFicmljLnV0aWwuZ2V0RnVuY3Rpb25Cb2R5KHQuc291cmNlKSl0aGlzLnNvdXJjZT1uZXcgRnVuY3Rpb24oZmFicmljLnV0aWwuZ2V0RnVuY3Rpb25Cb2R5KHQuc291cmNlKSk7ZWxzZXt2YXIgZT10aGlzO3RoaXMuc291cmNlPWZhYnJpYy51dGlsLmNyZWF0ZUltYWdlKCksZmFicmljLnV0aWwubG9hZEltYWdlKHQuc291cmNlLGZ1bmN0aW9uKHQpe2Uuc291cmNlPXR9KX1lbHNlIHRoaXMuc291cmNlPXQuc291cmNlO3QucmVwZWF0JiYodGhpcy5yZXBlYXQ9dC5yZXBlYXQpLHQub2Zmc2V0WCYmKHRoaXMub2Zmc2V0WD10Lm9mZnNldFgpLHQub2Zmc2V0WSYmKHRoaXMub2Zmc2V0WT10Lm9mZnNldFkpfSx0b09iamVjdDpmdW5jdGlvbigpe3ZhciB0O3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMuc291cmNlP3Q9U3RyaW5nKHRoaXMuc291cmNlKTpcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5zb3VyY2Uuc3JjJiYodD10aGlzLnNvdXJjZS5zcmMpLHtzb3VyY2U6dCxyZXBlYXQ6dGhpcy5yZXBlYXQsb2Zmc2V0WDp0aGlzLm9mZnNldFgsb2Zmc2V0WTp0aGlzLm9mZnNldFl9fSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLnNvdXJjZT90aGlzLnNvdXJjZSgpOnRoaXMuc291cmNlLGk9ZS53aWR0aC90LmdldFdpZHRoKCkscj1lLmhlaWdodC90LmdldEhlaWdodCgpLHM9dGhpcy5vZmZzZXRYL3QuZ2V0V2lkdGgoKSxuPXRoaXMub2Zmc2V0WS90LmdldEhlaWdodCgpLG89XCJcIjtyZXR1cm4oXCJyZXBlYXQteFwiPT09dGhpcy5yZXBlYXR8fFwibm8tcmVwZWF0XCI9PT10aGlzLnJlcGVhdCkmJihyPTEpLChcInJlcGVhdC15XCI9PT10aGlzLnJlcGVhdHx8XCJuby1yZXBlYXRcIj09PXRoaXMucmVwZWF0KSYmKGk9MSksZS5zcmM/bz1lLnNyYzplLnRvRGF0YVVSTCYmKG89ZS50b0RhdGFVUkwoKSksJzxwYXR0ZXJuIGlkPVwiU1ZHSURfJyt0aGlzLmlkKydcIiB4PVwiJytzKydcIiB5PVwiJytuKydcIiB3aWR0aD1cIicraSsnXCIgaGVpZ2h0PVwiJytyKydcIj5cXG48aW1hZ2UgeD1cIjBcIiB5PVwiMFwiIHdpZHRoPVwiJytlLndpZHRoKydcIiBoZWlnaHQ9XCInK2UuaGVpZ2h0KydcIiB4bGluazpocmVmPVwiJytvKydcIj48L2ltYWdlPlxcbjwvcGF0dGVybj5cXG4nfSx0b0xpdmU6ZnVuY3Rpb24odCl7dmFyIGU9XCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5zb3VyY2U/dGhpcy5zb3VyY2UoKTp0aGlzLnNvdXJjZTtpZighZSlyZXR1cm5cIlwiO2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBlLnNyYyl7aWYoIWUuY29tcGxldGUpcmV0dXJuXCJcIjtpZigwPT09ZS5uYXR1cmFsV2lkdGh8fDA9PT1lLm5hdHVyYWxIZWlnaHQpcmV0dXJuXCJcIn1yZXR1cm4gdC5jcmVhdGVQYXR0ZXJuKGUsdGhpcy5yZXBlYXQpfX0pLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLnRvRml4ZWQ7cmV0dXJuIGUuU2hhZG93P3ZvaWQgZS53YXJuKFwiZmFicmljLlNoYWRvdyBpcyBhbHJlYWR5IGRlZmluZWQuXCIpOihlLlNoYWRvdz1lLnV0aWwuY3JlYXRlQ2xhc3Moe2NvbG9yOlwicmdiKDAsMCwwKVwiLGJsdXI6MCxvZmZzZXRYOjAsb2Zmc2V0WTowLGFmZmVjdFN0cm9rZTohMSxpbmNsdWRlRGVmYXVsdFZhbHVlczohMCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe1wic3RyaW5nXCI9PXR5cGVvZiB0JiYodD10aGlzLl9wYXJzZVNoYWRvdyh0KSk7Zm9yKHZhciBpIGluIHQpdGhpc1tpXT10W2ldO3RoaXMuaWQ9ZS5PYmplY3QuX191aWQrK30sX3BhcnNlU2hhZG93OmZ1bmN0aW9uKHQpe3ZhciBpPXQudHJpbSgpLHI9ZS5TaGFkb3cucmVPZmZzZXRzQW5kQmx1ci5leGVjKGkpfHxbXSxzPWkucmVwbGFjZShlLlNoYWRvdy5yZU9mZnNldHNBbmRCbHVyLFwiXCIpfHxcInJnYigwLDAsMClcIjtyZXR1cm57Y29sb3I6cy50cmltKCksb2Zmc2V0WDpwYXJzZUludChyWzFdLDEwKXx8MCxvZmZzZXRZOnBhcnNlSW50KHJbMl0sMTApfHwwLGJsdXI6cGFyc2VJbnQoclszXSwxMCl8fDB9fSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblt0aGlzLm9mZnNldFgsdGhpcy5vZmZzZXRZLHRoaXMuYmx1cix0aGlzLmNvbG9yXS5qb2luKFwicHggXCIpfSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT1cIlNvdXJjZUFscGhhXCIscj00MCxzPTQwO3JldHVybiF0fHx0LmZpbGwhPT10aGlzLmNvbG9yJiZ0LnN0cm9rZSE9PXRoaXMuY29sb3J8fChlPVwiU291cmNlR3JhcGhpY1wiKSx0LndpZHRoJiZ0LmhlaWdodCYmKHI9MTAwKmkoTWF0aC5hYnModGhpcy5vZmZzZXRYL3QuZ2V0V2lkdGgoKSksMikrMjAscz0xMDAqaShNYXRoLmFicyh0aGlzLm9mZnNldFkvdC5nZXRIZWlnaHQoKSksMikrMjApLCc8ZmlsdGVyIGlkPVwiU1ZHSURfJyt0aGlzLmlkKydcIiB5PVwiLScrcysnJVwiIGhlaWdodD1cIicrKDEwMCsyKnMpKyclXCIgeD1cIi0nK3IrJyVcIiB3aWR0aD1cIicrKDEwMCsyKnIpKyclXCIgPlxcblx0PGZlR2F1c3NpYW5CbHVyIGluPVwiJytlKydcIiBzdGREZXZpYXRpb249XCInK2kodGhpcy5ibHVyP3RoaXMuYmx1ci8yOjAsMykrJ1wiIHJlc3VsdD1cImJsdXJPdXRcIj48L2ZlR2F1c3NpYW5CbHVyPlxcblx0PGZlQ29sb3JNYXRyaXggcmVzdWx0PVwibWF0cml4T3V0XCIgaW49XCJibHVyT3V0XCIgdHlwZT1cIm1hdHJpeFwiIHZhbHVlcz1cIjEgMCAwIDAgMCAwIDEgMCAwIDAgMCAwIDEgMCAwIDAgMCAwIDAuMzAgMFwiID48L2ZlQ29sb3JNYXRyaXggPlxcblx0PGZlT2Zmc2V0IGR4PVwiJyt0aGlzLm9mZnNldFgrJ1wiIGR5PVwiJyt0aGlzLm9mZnNldFkrJ1wiPjwvZmVPZmZzZXQ+XFxuXHQ8ZmVNZXJnZT5cXG5cdFx0PGZlTWVyZ2VOb2RlPjwvZmVNZXJnZU5vZGU+XFxuXHRcdDxmZU1lcmdlTm9kZSBpbj1cIlNvdXJjZUdyYXBoaWNcIj48L2ZlTWVyZ2VOb2RlPlxcblx0PC9mZU1lcmdlPlxcbjwvZmlsdGVyPlxcbid9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7aWYodGhpcy5pbmNsdWRlRGVmYXVsdFZhbHVlcylyZXR1cm57Y29sb3I6dGhpcy5jb2xvcixibHVyOnRoaXMuYmx1cixvZmZzZXRYOnRoaXMub2Zmc2V0WCxvZmZzZXRZOnRoaXMub2Zmc2V0WX07dmFyIHQ9e30saT1lLlNoYWRvdy5wcm90b3R5cGU7cmV0dXJuIHRoaXMuY29sb3IhPT1pLmNvbG9yJiYodC5jb2xvcj10aGlzLmNvbG9yKSx0aGlzLmJsdXIhPT1pLmJsdXImJih0LmJsdXI9dGhpcy5ibHVyKSx0aGlzLm9mZnNldFghPT1pLm9mZnNldFgmJih0Lm9mZnNldFg9dGhpcy5vZmZzZXRYKSx0aGlzLm9mZnNldFkhPT1pLm9mZnNldFkmJih0Lm9mZnNldFk9dGhpcy5vZmZzZXRZKSx0fX0pLHZvaWQoZS5TaGFkb3cucmVPZmZzZXRzQW5kQmx1cj0vKD86XFxzfF4pKC0/XFxkKyg/OnB4KT8oPzpcXHM/fCQpKT8oLT9cXGQrKD86cHgpPyg/Olxccz98JCkpPyhcXGQrKD86cHgpPyk/KD86XFxzP3wkKSg/OiR8XFxzKS8pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO2lmKGZhYnJpYy5TdGF0aWNDYW52YXMpcmV0dXJuIHZvaWQgZmFicmljLndhcm4oXCJmYWJyaWMuU3RhdGljQ2FudmFzIGlzIGFscmVhZHkgZGVmaW5lZC5cIik7dmFyIHQ9ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZCxlPWZhYnJpYy51dGlsLmdldEVsZW1lbnRPZmZzZXQsaT1mYWJyaWMudXRpbC5yZW1vdmVGcm9tQXJyYXkscj1uZXcgRXJyb3IoXCJDb3VsZCBub3QgaW5pdGlhbGl6ZSBgY2FudmFzYCBlbGVtZW50XCIpO2ZhYnJpYy5TdGF0aWNDYW52YXM9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3Moe2luaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlfHwoZT17fSksdGhpcy5faW5pdFN0YXRpYyh0LGUpLGZhYnJpYy5TdGF0aWNDYW52YXMuYWN0aXZlSW5zdGFuY2U9dGhpc30sYmFja2dyb3VuZENvbG9yOlwiXCIsYmFja2dyb3VuZEltYWdlOm51bGwsb3ZlcmxheUNvbG9yOlwiXCIsb3ZlcmxheUltYWdlOm51bGwsaW5jbHVkZURlZmF1bHRWYWx1ZXM6ITAsc3RhdGVmdWw6ITAscmVuZGVyT25BZGRSZW1vdmU6ITAsY2xpcFRvOm51bGwsY29udHJvbHNBYm92ZU92ZXJsYXk6ITEsYWxsb3dUb3VjaFNjcm9sbGluZzohMSxpbWFnZVNtb290aGluZ0VuYWJsZWQ6ITAscHJlc2VydmVPYmplY3RTdGFja2luZzohMSx2aWV3cG9ydFRyYW5zZm9ybTpbMSwwLDAsMSwwLDBdLG9uQmVmb3JlU2NhbGVSb3RhdGU6ZnVuY3Rpb24oKXt9LF9pbml0U3RhdGljOmZ1bmN0aW9uKHQsZSl7dGhpcy5fb2JqZWN0cz1bXSx0aGlzLl9jcmVhdGVMb3dlckNhbnZhcyh0KSx0aGlzLl9pbml0T3B0aW9ucyhlKSx0aGlzLl9zZXRJbWFnZVNtb290aGluZygpLGUub3ZlcmxheUltYWdlJiZ0aGlzLnNldE92ZXJsYXlJbWFnZShlLm92ZXJsYXlJbWFnZSx0aGlzLnJlbmRlckFsbC5iaW5kKHRoaXMpKSxlLmJhY2tncm91bmRJbWFnZSYmdGhpcy5zZXRCYWNrZ3JvdW5kSW1hZ2UoZS5iYWNrZ3JvdW5kSW1hZ2UsdGhpcy5yZW5kZXJBbGwuYmluZCh0aGlzKSksZS5iYWNrZ3JvdW5kQ29sb3ImJnRoaXMuc2V0QmFja2dyb3VuZENvbG9yKGUuYmFja2dyb3VuZENvbG9yLHRoaXMucmVuZGVyQWxsLmJpbmQodGhpcykpLGUub3ZlcmxheUNvbG9yJiZ0aGlzLnNldE92ZXJsYXlDb2xvcihlLm92ZXJsYXlDb2xvcix0aGlzLnJlbmRlckFsbC5iaW5kKHRoaXMpKSx0aGlzLmNhbGNPZmZzZXQoKX0sY2FsY09mZnNldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vZmZzZXQ9ZSh0aGlzLmxvd2VyQ2FudmFzRWwpLHRoaXN9LHNldE92ZXJsYXlJbWFnZTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuX19zZXRCZ092ZXJsYXlJbWFnZShcIm92ZXJsYXlJbWFnZVwiLHQsZSxpKX0sc2V0QmFja2dyb3VuZEltYWdlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5fX3NldEJnT3ZlcmxheUltYWdlKFwiYmFja2dyb3VuZEltYWdlXCIsdCxlLGkpfSxzZXRPdmVybGF5Q29sb3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fX3NldEJnT3ZlcmxheUNvbG9yKFwib3ZlcmxheUNvbG9yXCIsdCxlKX0sc2V0QmFja2dyb3VuZENvbG9yOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX19zZXRCZ092ZXJsYXlDb2xvcihcImJhY2tncm91bmRDb2xvclwiLHQsZSl9LF9zZXRJbWFnZVNtb290aGluZzpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0Q29udGV4dCgpO3QuaW1hZ2VTbW9vdGhpbmdFbmFibGVkPXRoaXMuaW1hZ2VTbW9vdGhpbmdFbmFibGVkLHQud2Via2l0SW1hZ2VTbW9vdGhpbmdFbmFibGVkPXRoaXMuaW1hZ2VTbW9vdGhpbmdFbmFibGVkLHQubW96SW1hZ2VTbW9vdGhpbmdFbmFibGVkPXRoaXMuaW1hZ2VTbW9vdGhpbmdFbmFibGVkLHQubXNJbWFnZVNtb290aGluZ0VuYWJsZWQ9dGhpcy5pbWFnZVNtb290aGluZ0VuYWJsZWQsdC5vSW1hZ2VTbW9vdGhpbmdFbmFibGVkPXRoaXMuaW1hZ2VTbW9vdGhpbmdFbmFibGVkfSxfX3NldEJnT3ZlcmxheUltYWdlOmZ1bmN0aW9uKHQsZSxpLHIpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBlP2ZhYnJpYy51dGlsLmxvYWRJbWFnZShlLGZ1bmN0aW9uKGUpe3RoaXNbdF09bmV3IGZhYnJpYy5JbWFnZShlLHIpLGkmJmkoKX0sdGhpcyxyJiZyLmNyb3NzT3JpZ2luKToociYmZS5zZXRPcHRpb25zKHIpLHRoaXNbdF09ZSxpJiZpKCkpLHRoaXN9LF9fc2V0QmdPdmVybGF5Q29sb3I6ZnVuY3Rpb24odCxlLGkpe2lmKGUmJmUuc291cmNlKXt2YXIgcj10aGlzO2ZhYnJpYy51dGlsLmxvYWRJbWFnZShlLnNvdXJjZSxmdW5jdGlvbihzKXtyW3RdPW5ldyBmYWJyaWMuUGF0dGVybih7c291cmNlOnMscmVwZWF0OmUucmVwZWF0LG9mZnNldFg6ZS5vZmZzZXRYLG9mZnNldFk6ZS5vZmZzZXRZfSksaSYmaSgpfSl9ZWxzZSB0aGlzW3RdPWUsaSYmaSgpO3JldHVybiB0aGlzfSxfY3JlYXRlQ2FudmFzRWxlbWVudDpmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO2lmKHQuc3R5bGV8fCh0LnN0eWxlPXt9KSwhdCl0aHJvdyByO3JldHVybiB0aGlzLl9pbml0Q2FudmFzRWxlbWVudCh0KSx0fSxfaW5pdENhbnZhc0VsZW1lbnQ6ZnVuY3Rpb24odCl7aWYoZmFicmljLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCh0KSxcInVuZGVmaW5lZFwiPT10eXBlb2YgdC5nZXRDb250ZXh0KXRocm93IHJ9LF9pbml0T3B0aW9uczpmdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdCl0aGlzW2VdPXRbZV07dGhpcy53aWR0aD10aGlzLndpZHRofHxwYXJzZUludCh0aGlzLmxvd2VyQ2FudmFzRWwud2lkdGgsMTApfHwwLHRoaXMuaGVpZ2h0PXRoaXMuaGVpZ2h0fHxwYXJzZUludCh0aGlzLmxvd2VyQ2FudmFzRWwuaGVpZ2h0LDEwKXx8MCx0aGlzLmxvd2VyQ2FudmFzRWwuc3R5bGUmJih0aGlzLmxvd2VyQ2FudmFzRWwud2lkdGg9dGhpcy53aWR0aCx0aGlzLmxvd2VyQ2FudmFzRWwuaGVpZ2h0PXRoaXMuaGVpZ2h0LHRoaXMubG93ZXJDYW52YXNFbC5zdHlsZS53aWR0aD10aGlzLndpZHRoK1wicHhcIix0aGlzLmxvd2VyQ2FudmFzRWwuc3R5bGUuaGVpZ2h0PXRoaXMuaGVpZ2h0K1wicHhcIix0aGlzLnZpZXdwb3J0VHJhbnNmb3JtPXRoaXMudmlld3BvcnRUcmFuc2Zvcm0uc2xpY2UoKSl9LF9jcmVhdGVMb3dlckNhbnZhczpmdW5jdGlvbih0KXt0aGlzLmxvd2VyQ2FudmFzRWw9ZmFicmljLnV0aWwuZ2V0QnlJZCh0KXx8dGhpcy5fY3JlYXRlQ2FudmFzRWxlbWVudCgpLHRoaXMuX2luaXRDYW52YXNFbGVtZW50KHRoaXMubG93ZXJDYW52YXNFbCksZmFicmljLnV0aWwuYWRkQ2xhc3ModGhpcy5sb3dlckNhbnZhc0VsLFwibG93ZXItY2FudmFzXCIpLHRoaXMuaW50ZXJhY3RpdmUmJnRoaXMuX2FwcGx5Q2FudmFzU3R5bGUodGhpcy5sb3dlckNhbnZhc0VsKSx0aGlzLmNvbnRleHRDb250YWluZXI9dGhpcy5sb3dlckNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKX0sZ2V0V2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53aWR0aH0sZ2V0SGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGVpZ2h0fSxzZXRXaWR0aDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNldERpbWVuc2lvbnMoe3dpZHRoOnR9LGUpfSxzZXRIZWlnaHQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zZXREaW1lbnNpb25zKHtoZWlnaHQ6dH0sZSl9LHNldERpbWVuc2lvbnM6ZnVuY3Rpb24odCxlKXt2YXIgaTtlPWV8fHt9O2Zvcih2YXIgciBpbiB0KWk9dFtyXSxlLmNzc09ubHl8fCh0aGlzLl9zZXRCYWNrc3RvcmVEaW1lbnNpb24ocix0W3JdKSxpKz1cInB4XCIpLGUuYmFja3N0b3JlT25seXx8dGhpcy5fc2V0Q3NzRGltZW5zaW9uKHIsaSk7cmV0dXJuIGUuY3NzT25seXx8dGhpcy5yZW5kZXJBbGwoKSx0aGlzLmNhbGNPZmZzZXQoKSx0aGlzfSxfc2V0QmFja3N0b3JlRGltZW5zaW9uOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMubG93ZXJDYW52YXNFbFt0XT1lLHRoaXMudXBwZXJDYW52YXNFbCYmKHRoaXMudXBwZXJDYW52YXNFbFt0XT1lKSx0aGlzLmNhY2hlQ2FudmFzRWwmJih0aGlzLmNhY2hlQ2FudmFzRWxbdF09ZSksdGhpc1t0XT1lLHRoaXN9LF9zZXRDc3NEaW1lbnNpb246ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5sb3dlckNhbnZhc0VsLnN0eWxlW3RdPWUsdGhpcy51cHBlckNhbnZhc0VsJiYodGhpcy51cHBlckNhbnZhc0VsLnN0eWxlW3RdPWUpLHRoaXMud3JhcHBlckVsJiYodGhpcy53cmFwcGVyRWwuc3R5bGVbdF09ZSksdGhpc30sZ2V0Wm9vbTpmdW5jdGlvbigpe3JldHVybiBNYXRoLnNxcnQodGhpcy52aWV3cG9ydFRyYW5zZm9ybVswXSp0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzNdKX0sc2V0Vmlld3BvcnRUcmFuc2Zvcm06ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpO3RoaXMudmlld3BvcnRUcmFuc2Zvcm09dCx0aGlzLnJlbmRlckFsbCgpO2Zvcih2YXIgaT0wLHI9dGhpcy5fb2JqZWN0cy5sZW5ndGg7cj5pO2krKyl0aGlzLl9vYmplY3RzW2ldLnNldENvb3JkcygpO3JldHVybiBlJiZlLnNldENvb3JkcygpLHRoaXN9LHpvb21Ub1BvaW50OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dDt0PWZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KHQsZmFicmljLnV0aWwuaW52ZXJ0VHJhbnNmb3JtKHRoaXMudmlld3BvcnRUcmFuc2Zvcm0pKSx0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzBdPWUsdGhpcy52aWV3cG9ydFRyYW5zZm9ybVszXT1lO3ZhciByPWZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KHQsdGhpcy52aWV3cG9ydFRyYW5zZm9ybSk7dGhpcy52aWV3cG9ydFRyYW5zZm9ybVs0XSs9aS54LXIueCx0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzVdKz1pLnktci55LHRoaXMucmVuZGVyQWxsKCk7Zm9yKHZhciBzPTAsbj10aGlzLl9vYmplY3RzLmxlbmd0aDtuPnM7cysrKXRoaXMuX29iamVjdHNbc10uc2V0Q29vcmRzKCk7cmV0dXJuIHRoaXN9LHNldFpvb206ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuem9vbVRvUG9pbnQobmV3IGZhYnJpYy5Qb2ludCgwLDApLHQpLHRoaXN9LGFic29sdXRlUGFuOmZ1bmN0aW9uKHQpe3RoaXMudmlld3BvcnRUcmFuc2Zvcm1bNF09LXQueCx0aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzVdPS10LnksdGhpcy5yZW5kZXJBbGwoKTtmb3IodmFyIGU9MCxpPXRoaXMuX29iamVjdHMubGVuZ3RoO2k+ZTtlKyspdGhpcy5fb2JqZWN0c1tlXS5zZXRDb29yZHMoKTtyZXR1cm4gdGhpc30scmVsYXRpdmVQYW46ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYWJzb2x1dGVQYW4obmV3IGZhYnJpYy5Qb2ludCgtdC54LXRoaXMudmlld3BvcnRUcmFuc2Zvcm1bNF0sLXQueS10aGlzLnZpZXdwb3J0VHJhbnNmb3JtWzVdKSl9LGdldEVsZW1lbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb3dlckNhbnZhc0VsfSxnZXRBY3RpdmVPYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sZ2V0QWN0aXZlR3JvdXA6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH0sX2RyYXc6ZnVuY3Rpb24odCxlKXtpZihlKXt0LnNhdmUoKTt2YXIgaT10aGlzLnZpZXdwb3J0VHJhbnNmb3JtO3QudHJhbnNmb3JtKGlbMF0saVsxXSxpWzJdLGlbM10saVs0XSxpWzVdKSx0aGlzLl9zaG91bGRSZW5kZXJPYmplY3QoZSkmJmUucmVuZGVyKHQpLHQucmVzdG9yZSgpLHRoaXMuY29udHJvbHNBYm92ZU92ZXJsYXl8fGUuX3JlbmRlckNvbnRyb2xzKHQpfX0sX3Nob3VsZFJlbmRlck9iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdD90IT09dGhpcy5nZXRBY3RpdmVHcm91cCgpfHwhdGhpcy5wcmVzZXJ2ZU9iamVjdFN0YWNraW5nOiExfSxfb25PYmplY3RBZGRlZDpmdW5jdGlvbih0KXt0aGlzLnN0YXRlZnVsJiZ0LnNldHVwU3RhdGUoKSx0Ll9zZXQoXCJjYW52YXNcIix0aGlzKSx0LnNldENvb3JkcygpLHRoaXMuZmlyZShcIm9iamVjdDphZGRlZFwiLHt0YXJnZXQ6dH0pLHQuZmlyZShcImFkZGVkXCIpfSxfb25PYmplY3RSZW1vdmVkOmZ1bmN0aW9uKHQpe3RoaXMuZ2V0QWN0aXZlT2JqZWN0KCk9PT10JiYodGhpcy5maXJlKFwiYmVmb3JlOnNlbGVjdGlvbjpjbGVhcmVkXCIse3RhcmdldDp0fSksdGhpcy5fZGlzY2FyZEFjdGl2ZU9iamVjdCgpLHRoaXMuZmlyZShcInNlbGVjdGlvbjpjbGVhcmVkXCIpKSx0aGlzLmZpcmUoXCJvYmplY3Q6cmVtb3ZlZFwiLHt0YXJnZXQ6dH0pLHQuZmlyZShcInJlbW92ZWRcIil9LGNsZWFyQ29udGV4dDpmdW5jdGlvbih0KXtyZXR1cm4gdC5jbGVhclJlY3QoMCwwLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLHRoaXN9LGdldENvbnRleHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250ZXh0Q29udGFpbmVyfSxjbGVhcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vYmplY3RzLmxlbmd0aD0wLHRoaXMuZGlzY2FyZEFjdGl2ZUdyb3VwJiZ0aGlzLmRpc2NhcmRBY3RpdmVHcm91cCgpLHRoaXMuZGlzY2FyZEFjdGl2ZU9iamVjdCYmdGhpcy5kaXNjYXJkQWN0aXZlT2JqZWN0KCksdGhpcy5jbGVhckNvbnRleHQodGhpcy5jb250ZXh0Q29udGFpbmVyKSx0aGlzLmNvbnRleHRUb3AmJnRoaXMuY2xlYXJDb250ZXh0KHRoaXMuY29udGV4dFRvcCksdGhpcy5maXJlKFwiY2FudmFzOmNsZWFyZWRcIiksdGhpcy5yZW5kZXJBbGwoKSx0aGlzfSxyZW5kZXJBbGw6ZnVuY3Rpb24odCl7dmFyIGU9dGhpc1t0PT09ITAmJnRoaXMuaW50ZXJhY3RpdmU/XCJjb250ZXh0VG9wXCI6XCJjb250ZXh0Q29udGFpbmVyXCJdLGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpO3JldHVybiB0aGlzLmNvbnRleHRUb3AmJnRoaXMuc2VsZWN0aW9uJiYhdGhpcy5fZ3JvdXBTZWxlY3RvciYmdGhpcy5jbGVhckNvbnRleHQodGhpcy5jb250ZXh0VG9wKSx0fHx0aGlzLmNsZWFyQ29udGV4dChlKSx0aGlzLmZpcmUoXCJiZWZvcmU6cmVuZGVyXCIpLHRoaXMuY2xpcFRvJiZmYWJyaWMudXRpbC5jbGlwQ29udGV4dCh0aGlzLGUpLHRoaXMuX3JlbmRlckJhY2tncm91bmQoZSksdGhpcy5fcmVuZGVyT2JqZWN0cyhlLGkpLHRoaXMuX3JlbmRlckFjdGl2ZUdyb3VwKGUsaSksdGhpcy5jbGlwVG8mJmUucmVzdG9yZSgpLHRoaXMuX3JlbmRlck92ZXJsYXkoZSksdGhpcy5jb250cm9sc0Fib3ZlT3ZlcmxheSYmdGhpcy5pbnRlcmFjdGl2ZSYmdGhpcy5kcmF3Q29udHJvbHMoZSksdGhpcy5maXJlKFwiYWZ0ZXI6cmVuZGVyXCIpLHRoaXN9LF9yZW5kZXJPYmplY3RzOmZ1bmN0aW9uKHQsZSl7dmFyIGkscjtpZighZXx8dGhpcy5wcmVzZXJ2ZU9iamVjdFN0YWNraW5nKWZvcihpPTAscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyPmk7KytpKXRoaXMuX2RyYXcodCx0aGlzLl9vYmplY3RzW2ldKTtlbHNlIGZvcihpPTAscj10aGlzLl9vYmplY3RzLmxlbmd0aDtyPmk7KytpKXRoaXMuX29iamVjdHNbaV0mJiFlLmNvbnRhaW5zKHRoaXMuX29iamVjdHNbaV0pJiZ0aGlzLl9kcmF3KHQsdGhpcy5fb2JqZWN0c1tpXSl9LF9yZW5kZXJBY3RpdmVHcm91cDpmdW5jdGlvbih0LGUpe2lmKGUpe3ZhciBpPVtdO3RoaXMuZm9yRWFjaE9iamVjdChmdW5jdGlvbih0KXtlLmNvbnRhaW5zKHQpJiZpLnB1c2godCl9KSxlLl9zZXQoXCJfb2JqZWN0c1wiLGkucmV2ZXJzZSgpKSx0aGlzLl9kcmF3KHQsZSl9fSxfcmVuZGVyQmFja2dyb3VuZDpmdW5jdGlvbih0KXt0aGlzLmJhY2tncm91bmRDb2xvciYmKHQuZmlsbFN0eWxlPXRoaXMuYmFja2dyb3VuZENvbG9yLnRvTGl2ZT90aGlzLmJhY2tncm91bmRDb2xvci50b0xpdmUodCk6dGhpcy5iYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLmJhY2tncm91bmRDb2xvci5vZmZzZXRYfHwwLHRoaXMuYmFja2dyb3VuZENvbG9yLm9mZnNldFl8fDAsdGhpcy53aWR0aCx0aGlzLmhlaWdodCkpLHRoaXMuYmFja2dyb3VuZEltYWdlJiZ0aGlzLl9kcmF3KHQsdGhpcy5iYWNrZ3JvdW5kSW1hZ2UpfSxfcmVuZGVyT3ZlcmxheTpmdW5jdGlvbih0KXt0aGlzLm92ZXJsYXlDb2xvciYmKHQuZmlsbFN0eWxlPXRoaXMub3ZlcmxheUNvbG9yLnRvTGl2ZT90aGlzLm92ZXJsYXlDb2xvci50b0xpdmUodCk6dGhpcy5vdmVybGF5Q29sb3IsdC5maWxsUmVjdCh0aGlzLm92ZXJsYXlDb2xvci5vZmZzZXRYfHwwLHRoaXMub3ZlcmxheUNvbG9yLm9mZnNldFl8fDAsdGhpcy53aWR0aCx0aGlzLmhlaWdodCkpLHRoaXMub3ZlcmxheUltYWdlJiZ0aGlzLl9kcmF3KHQsdGhpcy5vdmVybGF5SW1hZ2UpfSxyZW5kZXJUb3A6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNvbnRleHRUb3B8fHRoaXMuY29udGV4dENvbnRhaW5lcjt0aGlzLmNsZWFyQ29udGV4dCh0KSx0aGlzLnNlbGVjdGlvbiYmdGhpcy5fZ3JvdXBTZWxlY3RvciYmdGhpcy5fZHJhd1NlbGVjdGlvbigpO3ZhciBlPXRoaXMuZ2V0QWN0aXZlR3JvdXAoKTtyZXR1cm4gZSYmZS5yZW5kZXIodCksdGhpcy5fcmVuZGVyT3ZlcmxheSh0KSx0aGlzLmZpcmUoXCJhZnRlcjpyZW5kZXJcIiksdGhpc30sZ2V0Q2VudGVyOmZ1bmN0aW9uKCl7cmV0dXJue3RvcDp0aGlzLmdldEhlaWdodCgpLzIsbGVmdDp0aGlzLmdldFdpZHRoKCkvMn19LGNlbnRlck9iamVjdEg6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2NlbnRlck9iamVjdCh0LG5ldyBmYWJyaWMuUG9pbnQodGhpcy5nZXRDZW50ZXIoKS5sZWZ0LHQuZ2V0Q2VudGVyUG9pbnQoKS55KSksdGhpcy5yZW5kZXJBbGwoKSx0aGlzfSxjZW50ZXJPYmplY3RWOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9jZW50ZXJPYmplY3QodCxuZXcgZmFicmljLlBvaW50KHQuZ2V0Q2VudGVyUG9pbnQoKS54LHRoaXMuZ2V0Q2VudGVyKCkudG9wKSksdGhpcy5yZW5kZXJBbGwoKSx0aGlzfSxjZW50ZXJPYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRDZW50ZXIoKTtyZXR1cm4gdGhpcy5fY2VudGVyT2JqZWN0KHQsbmV3IGZhYnJpYy5Qb2ludChlLmxlZnQsZS50b3ApKSx0aGlzLnJlbmRlckFsbCgpLHRoaXN9LF9jZW50ZXJPYmplY3Q6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5zZXRQb3NpdGlvbkJ5T3JpZ2luKGUsXCJjZW50ZXJcIixcImNlbnRlclwiKSx0aGlzfSx0b0RhdGFsZXNzSlNPTjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50b0RhdGFsZXNzT2JqZWN0KHQpfSx0b09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fdG9PYmplY3RNZXRob2QoXCJ0b09iamVjdFwiLHQpfSx0b0RhdGFsZXNzT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl90b09iamVjdE1ldGhvZChcInRvRGF0YWxlc3NPYmplY3RcIix0KX0sX3RvT2JqZWN0TWV0aG9kOmZ1bmN0aW9uKGUsaSl7dmFyIHI9e29iamVjdHM6dGhpcy5fdG9PYmplY3RzKGUsaSl9O3JldHVybiB0KHIsdGhpcy5fX3NlcmlhbGl6ZUJnT3ZlcmxheSgpKSxmYWJyaWMudXRpbC5wb3B1bGF0ZVdpdGhQcm9wZXJ0aWVzKHRoaXMscixpKSxyfSxfdG9PYmplY3RzOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuZ2V0T2JqZWN0cygpLm1hcChmdW5jdGlvbihpKXtyZXR1cm4gdGhpcy5fdG9PYmplY3QoaSx0LGUpfSx0aGlzKX0sX3RvT2JqZWN0OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcjt0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzfHwocj10LmluY2x1ZGVEZWZhdWx0VmFsdWVzLHQuaW5jbHVkZURlZmF1bHRWYWx1ZXM9ITEpO3ZhciBzPXRoaXMuX3JlYWxpemVHcm91cFRyYW5zZm9ybU9uT2JqZWN0KHQpLG49dFtlXShpKTtyZXR1cm4gdGhpcy5pbmNsdWRlRGVmYXVsdFZhbHVlc3x8KHQuaW5jbHVkZURlZmF1bHRWYWx1ZXM9ciksdGhpcy5fdW53aW5kR3JvdXBUcmFuc2Zvcm1Pbk9iamVjdCh0LHMpLG59LF9yZWFsaXplR3JvdXBUcmFuc2Zvcm1Pbk9iamVjdDpmdW5jdGlvbih0KXt2YXIgZT1bXCJhbmdsZVwiLFwiZmxpcFhcIixcImZsaXBZXCIsXCJoZWlnaHRcIixcImxlZnRcIixcInNjYWxlWFwiLFwic2NhbGVZXCIsXCJ0b3BcIixcIndpZHRoXCJdO2lmKHQuZ3JvdXAmJnQuZ3JvdXA9PT10aGlzLmdldEFjdGl2ZUdyb3VwKCkpe3ZhciBpPXt9O3JldHVybiBlLmZvckVhY2goZnVuY3Rpb24oZSl7aVtlXT10W2VdfSksdGhpcy5nZXRBY3RpdmVHcm91cCgpLnJlYWxpemVUcmFuc2Zvcm0odCksaX1yZXR1cm4gbnVsbH0sX3Vud2luZEdyb3VwVHJhbnNmb3JtT25PYmplY3Q6ZnVuY3Rpb24odCxlKXtlJiZ0LnNldChlKX0sX19zZXJpYWxpemVCZ092ZXJsYXk6ZnVuY3Rpb24oKXt2YXIgdD17YmFja2dyb3VuZDp0aGlzLmJhY2tncm91bmRDb2xvciYmdGhpcy5iYWNrZ3JvdW5kQ29sb3IudG9PYmplY3Q/dGhpcy5iYWNrZ3JvdW5kQ29sb3IudG9PYmplY3QoKTp0aGlzLmJhY2tncm91bmRDb2xvcn07cmV0dXJuIHRoaXMub3ZlcmxheUNvbG9yJiYodC5vdmVybGF5PXRoaXMub3ZlcmxheUNvbG9yLnRvT2JqZWN0P3RoaXMub3ZlcmxheUNvbG9yLnRvT2JqZWN0KCk6dGhpcy5vdmVybGF5Q29sb3IpLHRoaXMuYmFja2dyb3VuZEltYWdlJiYodC5iYWNrZ3JvdW5kSW1hZ2U9dGhpcy5iYWNrZ3JvdW5kSW1hZ2UudG9PYmplY3QoKSksdGhpcy5vdmVybGF5SW1hZ2UmJih0Lm92ZXJsYXlJbWFnZT10aGlzLm92ZXJsYXlJbWFnZS50b09iamVjdCgpKSx0fSxzdmdWaWV3cG9ydFRyYW5zZm9ybWF0aW9uOiEwLHRvU1ZHOmZ1bmN0aW9uKHQsZSl7dHx8KHQ9e30pO3ZhciBpPVtdO3JldHVybiB0aGlzLl9zZXRTVkdQcmVhbWJsZShpLHQpLHRoaXMuX3NldFNWR0hlYWRlcihpLHQpLHRoaXMuX3NldFNWR0JnT3ZlcmxheUNvbG9yKGksXCJiYWNrZ3JvdW5kQ29sb3JcIiksdGhpcy5fc2V0U1ZHQmdPdmVybGF5SW1hZ2UoaSxcImJhY2tncm91bmRJbWFnZVwiKSx0aGlzLl9zZXRTVkdPYmplY3RzKGksZSksdGhpcy5fc2V0U1ZHQmdPdmVybGF5Q29sb3IoaSxcIm92ZXJsYXlDb2xvclwiKSx0aGlzLl9zZXRTVkdCZ092ZXJsYXlJbWFnZShpLFwib3ZlcmxheUltYWdlXCIpLGkucHVzaChcIjwvc3ZnPlwiKSxpLmpvaW4oXCJcIil9LF9zZXRTVkdQcmVhbWJsZTpmdW5jdGlvbih0LGUpe2Uuc3VwcHJlc3NQcmVhbWJsZXx8dC5wdXNoKCc8P3htbCB2ZXJzaW9uPVwiMS4wXCIgZW5jb2Rpbmc9XCInLGUuZW5jb2Rpbmd8fFwiVVRGLThcIiwnXCIgc3RhbmRhbG9uZT1cIm5vXCIgPz4nLCc8IURPQ1RZUEUgc3ZnIFBVQkxJQyBcIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOXCIgJywnXCJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGRcIj5cXG4nKX0sX3NldFNWR0hlYWRlcjpmdW5jdGlvbih0LGUpe3ZhciBpLHIscztlLnZpZXdCb3g/KGk9ZS52aWV3Qm94LndpZHRoLHI9ZS52aWV3Qm94LmhlaWdodCk6KGk9dGhpcy53aWR0aCxyPXRoaXMuaGVpZ2h0LHRoaXMuc3ZnVmlld3BvcnRUcmFuc2Zvcm1hdGlvbnx8KHM9dGhpcy52aWV3cG9ydFRyYW5zZm9ybSxpLz1zWzBdLHIvPXNbM10pKSx0LnB1c2goXCI8c3ZnIFwiLCd4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgJywneG1sbnM6eGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCIgJywndmVyc2lvbj1cIjEuMVwiICcsJ3dpZHRoPVwiJyxpLCdcIiAnLCdoZWlnaHQ9XCInLHIsJ1wiICcsdGhpcy5iYWNrZ3JvdW5kQ29sb3ImJiF0aGlzLmJhY2tncm91bmRDb2xvci50b0xpdmU/J3N0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogJyt0aGlzLmJhY2tncm91bmRDb2xvcisnXCIgJzpudWxsLGUudmlld0JveD8ndmlld0JveD1cIicrZS52aWV3Qm94LngrXCIgXCIrZS52aWV3Qm94LnkrXCIgXCIrZS52aWV3Qm94LndpZHRoK1wiIFwiK2Uudmlld0JveC5oZWlnaHQrJ1wiICc6bnVsbCwneG1sOnNwYWNlPVwicHJlc2VydmVcIj4nLFwiPGRlc2M+Q3JlYXRlZCB3aXRoIEZhYnJpYy5qcyBcIixmYWJyaWMudmVyc2lvbixcIjwvZGVzYz5cIixcIjxkZWZzPlwiLGZhYnJpYy5jcmVhdGVTVkdGb250RmFjZXNNYXJrdXAodGhpcy5nZXRPYmplY3RzKCkpLGZhYnJpYy5jcmVhdGVTVkdSZWZFbGVtZW50c01hcmt1cCh0aGlzKSxcIjwvZGVmcz5cIik7XHJcblxyXG59LF9zZXRTVkdPYmplY3RzOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPTAscj10aGlzLmdldE9iamVjdHMoKSxzPXIubGVuZ3RoO3M+aTtpKyspe3ZhciBuPXJbaV0sbz10aGlzLl9yZWFsaXplR3JvdXBUcmFuc2Zvcm1Pbk9iamVjdChuKTt0LnB1c2gobi50b1NWRyhlKSksdGhpcy5fdW53aW5kR3JvdXBUcmFuc2Zvcm1Pbk9iamVjdChuLG8pfX0sX3NldFNWR0JnT3ZlcmxheUltYWdlOmZ1bmN0aW9uKHQsZSl7dGhpc1tlXSYmdGhpc1tlXS50b1NWRyYmdC5wdXNoKHRoaXNbZV0udG9TVkcoKSl9LF9zZXRTVkdCZ092ZXJsYXlDb2xvcjpmdW5jdGlvbih0LGUpe3RoaXNbZV0mJnRoaXNbZV0uc291cmNlP3QucHVzaCgnPHJlY3QgeD1cIicsdGhpc1tlXS5vZmZzZXRYLCdcIiB5PVwiJyx0aGlzW2VdLm9mZnNldFksJ1wiICcsJ3dpZHRoPVwiJyxcInJlcGVhdC15XCI9PT10aGlzW2VdLnJlcGVhdHx8XCJuby1yZXBlYXRcIj09PXRoaXNbZV0ucmVwZWF0P3RoaXNbZV0uc291cmNlLndpZHRoOnRoaXMud2lkdGgsJ1wiIGhlaWdodD1cIicsXCJyZXBlYXQteFwiPT09dGhpc1tlXS5yZXBlYXR8fFwibm8tcmVwZWF0XCI9PT10aGlzW2VdLnJlcGVhdD90aGlzW2VdLnNvdXJjZS5oZWlnaHQ6dGhpcy5oZWlnaHQsJ1wiIGZpbGw9XCJ1cmwoIycrZSsnUGF0dGVybilcIicsXCI+PC9yZWN0PlwiKTp0aGlzW2VdJiZcIm92ZXJsYXlDb2xvclwiPT09ZSYmdC5wdXNoKCc8cmVjdCB4PVwiMFwiIHk9XCIwXCIgJywnd2lkdGg9XCInLHRoaXMud2lkdGgsJ1wiIGhlaWdodD1cIicsdGhpcy5oZWlnaHQsJ1wiIGZpbGw9XCInLHRoaXNbZV0sJ1wiJyxcIj48L3JlY3Q+XCIpfSxzZW5kVG9CYWNrOmZ1bmN0aW9uKHQpe3JldHVybiBpKHRoaXMuX29iamVjdHMsdCksdGhpcy5fb2JqZWN0cy51bnNoaWZ0KHQpLHRoaXMucmVuZGVyQWxsJiZ0aGlzLnJlbmRlckFsbCgpfSxicmluZ1RvRnJvbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGkodGhpcy5fb2JqZWN0cyx0KSx0aGlzLl9vYmplY3RzLnB1c2godCksdGhpcy5yZW5kZXJBbGwmJnRoaXMucmVuZGVyQWxsKCl9LHNlbmRCYWNrd2FyZHM6ZnVuY3Rpb24odCxlKXt2YXIgcj10aGlzLl9vYmplY3RzLmluZGV4T2YodCk7aWYoMCE9PXIpe3ZhciBzPXRoaXMuX2ZpbmROZXdMb3dlckluZGV4KHQscixlKTtpKHRoaXMuX29iamVjdHMsdCksdGhpcy5fb2JqZWN0cy5zcGxpY2UocywwLHQpLHRoaXMucmVuZGVyQWxsJiZ0aGlzLnJlbmRlckFsbCgpfXJldHVybiB0aGlzfSxfZmluZE5ld0xvd2VySW5kZXg6ZnVuY3Rpb24odCxlLGkpe3ZhciByO2lmKGkpe3I9ZTtmb3IodmFyIHM9ZS0xO3M+PTA7LS1zKXt2YXIgbj10LmludGVyc2VjdHNXaXRoT2JqZWN0KHRoaXMuX29iamVjdHNbc10pfHx0LmlzQ29udGFpbmVkV2l0aGluT2JqZWN0KHRoaXMuX29iamVjdHNbc10pfHx0aGlzLl9vYmplY3RzW3NdLmlzQ29udGFpbmVkV2l0aGluT2JqZWN0KHQpO2lmKG4pe3I9czticmVha319fWVsc2Ugcj1lLTE7cmV0dXJuIHJ9LGJyaW5nRm9yd2FyZDpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX29iamVjdHMuaW5kZXhPZih0KTtpZihyIT09dGhpcy5fb2JqZWN0cy5sZW5ndGgtMSl7dmFyIHM9dGhpcy5fZmluZE5ld1VwcGVySW5kZXgodCxyLGUpO2kodGhpcy5fb2JqZWN0cyx0KSx0aGlzLl9vYmplY3RzLnNwbGljZShzLDAsdCksdGhpcy5yZW5kZXJBbGwmJnRoaXMucmVuZGVyQWxsKCl9cmV0dXJuIHRoaXN9LF9maW5kTmV3VXBwZXJJbmRleDpmdW5jdGlvbih0LGUsaSl7dmFyIHI7aWYoaSl7cj1lO2Zvcih2YXIgcz1lKzE7czx0aGlzLl9vYmplY3RzLmxlbmd0aDsrK3Mpe3ZhciBuPXQuaW50ZXJzZWN0c1dpdGhPYmplY3QodGhpcy5fb2JqZWN0c1tzXSl8fHQuaXNDb250YWluZWRXaXRoaW5PYmplY3QodGhpcy5fb2JqZWN0c1tzXSl8fHRoaXMuX29iamVjdHNbc10uaXNDb250YWluZWRXaXRoaW5PYmplY3QodCk7aWYobil7cj1zO2JyZWFrfX19ZWxzZSByPWUrMTtyZXR1cm4gcn0sbW92ZVRvOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGkodGhpcy5fb2JqZWN0cyx0KSx0aGlzLl9vYmplY3RzLnNwbGljZShlLDAsdCksdGhpcy5yZW5kZXJBbGwmJnRoaXMucmVuZGVyQWxsKCl9LGRpc3Bvc2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbGVhcigpLHRoaXMuaW50ZXJhY3RpdmUmJnRoaXMucmVtb3ZlTGlzdGVuZXJzKCksdGhpc30sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLkNhbnZhcyAoXCIrdGhpcy5jb21wbGV4aXR5KCkrXCIpOiB7IG9iamVjdHM6IFwiK3RoaXMuZ2V0T2JqZWN0cygpLmxlbmd0aCtcIiB9PlwifX0pLHQoZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUsZmFicmljLk9ic2VydmFibGUpLHQoZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUsZmFicmljLkNvbGxlY3Rpb24pLHQoZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUsZmFicmljLkRhdGFVUkxFeHBvcnRlciksdChmYWJyaWMuU3RhdGljQ2FudmFzLHtFTVBUWV9KU09OOid7XCJvYmplY3RzXCI6IFtdLCBcImJhY2tncm91bmRcIjogXCJ3aGl0ZVwifScsc3VwcG9ydHM6ZnVuY3Rpb24odCl7dmFyIGU9ZmFicmljLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpO2lmKCFlfHwhZS5nZXRDb250ZXh0KXJldHVybiBudWxsO3ZhciBpPWUuZ2V0Q29udGV4dChcIjJkXCIpO2lmKCFpKXJldHVybiBudWxsO3N3aXRjaCh0KXtjYXNlXCJnZXRJbWFnZURhdGFcIjpyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgaS5nZXRJbWFnZURhdGE7Y2FzZVwic2V0TGluZURhc2hcIjpyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgaS5zZXRMaW5lRGFzaDtjYXNlXCJ0b0RhdGFVUkxcIjpyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2YgZS50b0RhdGFVUkw7Y2FzZVwidG9EYXRhVVJMV2l0aFF1YWxpdHlcIjp0cnl7cmV0dXJuIGUudG9EYXRhVVJMKFwiaW1hZ2UvanBlZ1wiLDApLCEwfWNhdGNoKHIpe31yZXR1cm4hMTtkZWZhdWx0OnJldHVybiBudWxsfX19KSxmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS50b0pTT049ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUudG9PYmplY3R9KCksZmFicmljLkJhc2VCcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyh7Y29sb3I6XCJyZ2IoMCwgMCwgMClcIix3aWR0aDoxLHNoYWRvdzpudWxsLHN0cm9rZUxpbmVDYXA6XCJyb3VuZFwiLHN0cm9rZUxpbmVKb2luOlwicm91bmRcIixzdHJva2VEYXNoQXJyYXk6bnVsbCxzZXRTaGFkb3c6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2hhZG93PW5ldyBmYWJyaWMuU2hhZG93KHQpLHRoaXN9LF9zZXRCcnVzaFN0eWxlczpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY2FudmFzLmNvbnRleHRUb3A7dC5zdHJva2VTdHlsZT10aGlzLmNvbG9yLHQubGluZVdpZHRoPXRoaXMud2lkdGgsdC5saW5lQ2FwPXRoaXMuc3Ryb2tlTGluZUNhcCx0LmxpbmVKb2luPXRoaXMuc3Ryb2tlTGluZUpvaW4sdGhpcy5zdHJva2VEYXNoQXJyYXkmJmZhYnJpYy5TdGF0aWNDYW52YXMuc3VwcG9ydHMoXCJzZXRMaW5lRGFzaFwiKSYmdC5zZXRMaW5lRGFzaCh0aGlzLnN0cm9rZURhc2hBcnJheSl9LF9zZXRTaGFkb3c6ZnVuY3Rpb24oKXtpZih0aGlzLnNoYWRvdyl7dmFyIHQ9dGhpcy5jYW52YXMuY29udGV4dFRvcDt0LnNoYWRvd0NvbG9yPXRoaXMuc2hhZG93LmNvbG9yLHQuc2hhZG93Qmx1cj10aGlzLnNoYWRvdy5ibHVyLHQuc2hhZG93T2Zmc2V0WD10aGlzLnNoYWRvdy5vZmZzZXRYLHQuc2hhZG93T2Zmc2V0WT10aGlzLnNoYWRvdy5vZmZzZXRZfX0sX3Jlc2V0U2hhZG93OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jYW52YXMuY29udGV4dFRvcDt0LnNoYWRvd0NvbG9yPVwiXCIsdC5zaGFkb3dCbHVyPXQuc2hhZG93T2Zmc2V0WD10LnNoYWRvd09mZnNldFk9MH19KSxmdW5jdGlvbigpe2ZhYnJpYy5QZW5jaWxCcnVzaD1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuQmFzZUJydXNoLHtpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3RoaXMuY2FudmFzPXQsdGhpcy5fcG9pbnRzPVtdfSxvbk1vdXNlRG93bjpmdW5jdGlvbih0KXt0aGlzLl9wcmVwYXJlRm9yRHJhd2luZyh0KSx0aGlzLl9jYXB0dXJlRHJhd2luZ1BhdGgodCksdGhpcy5fcmVuZGVyKCl9LG9uTW91c2VNb3ZlOmZ1bmN0aW9uKHQpe3RoaXMuX2NhcHR1cmVEcmF3aW5nUGF0aCh0KSx0aGlzLmNhbnZhcy5jbGVhckNvbnRleHQodGhpcy5jYW52YXMuY29udGV4dFRvcCksdGhpcy5fcmVuZGVyKCl9LG9uTW91c2VVcDpmdW5jdGlvbigpe3RoaXMuX2ZpbmFsaXplQW5kQWRkUGF0aCgpfSxfcHJlcGFyZUZvckRyYXdpbmc6ZnVuY3Rpb24odCl7dmFyIGU9bmV3IGZhYnJpYy5Qb2ludCh0LngsdC55KTt0aGlzLl9yZXNldCgpLHRoaXMuX2FkZFBvaW50KGUpLHRoaXMuY2FudmFzLmNvbnRleHRUb3AubW92ZVRvKGUueCxlLnkpfSxfYWRkUG9pbnQ6ZnVuY3Rpb24odCl7dGhpcy5fcG9pbnRzLnB1c2godCl9LF9yZXNldDpmdW5jdGlvbigpe3RoaXMuX3BvaW50cy5sZW5ndGg9MCx0aGlzLl9zZXRCcnVzaFN0eWxlcygpLHRoaXMuX3NldFNoYWRvdygpfSxfY2FwdHVyZURyYXdpbmdQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPW5ldyBmYWJyaWMuUG9pbnQodC54LHQueSk7dGhpcy5fYWRkUG9pbnQoZSl9LF9yZW5kZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wLGU9dGhpcy5jYW52YXMudmlld3BvcnRUcmFuc2Zvcm0saT10aGlzLl9wb2ludHNbMF0scj10aGlzLl9wb2ludHNbMV07dC5zYXZlKCksdC50cmFuc2Zvcm0oZVswXSxlWzFdLGVbMl0sZVszXSxlWzRdLGVbNV0pLHQuYmVnaW5QYXRoKCksMj09PXRoaXMuX3BvaW50cy5sZW5ndGgmJmkueD09PXIueCYmaS55PT09ci55JiYoaS54LT0uNSxyLngrPS41KSx0Lm1vdmVUbyhpLngsaS55KTtmb3IodmFyIHM9MSxuPXRoaXMuX3BvaW50cy5sZW5ndGg7bj5zO3MrKyl7dmFyIG89aS5taWRQb2ludEZyb20ocik7dC5xdWFkcmF0aWNDdXJ2ZVRvKGkueCxpLnksby54LG8ueSksaT10aGlzLl9wb2ludHNbc10scj10aGlzLl9wb2ludHNbcysxXX10LmxpbmVUbyhpLngsaS55KSx0LnN0cm9rZSgpLHQucmVzdG9yZSgpfSxjb252ZXJ0UG9pbnRzVG9TVkdQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPVtdLGk9bmV3IGZhYnJpYy5Qb2ludCh0WzBdLngsdFswXS55KSxyPW5ldyBmYWJyaWMuUG9pbnQodFsxXS54LHRbMV0ueSk7ZS5wdXNoKFwiTSBcIix0WzBdLngsXCIgXCIsdFswXS55LFwiIFwiKTtmb3IodmFyIHM9MSxuPXQubGVuZ3RoO24+cztzKyspe3ZhciBvPWkubWlkUG9pbnRGcm9tKHIpO2UucHVzaChcIlEgXCIsaS54LFwiIFwiLGkueSxcIiBcIixvLngsXCIgXCIsby55LFwiIFwiKSxpPW5ldyBmYWJyaWMuUG9pbnQodFtzXS54LHRbc10ueSkscysxPHQubGVuZ3RoJiYocj1uZXcgZmFicmljLlBvaW50KHRbcysxXS54LHRbcysxXS55KSl9cmV0dXJuIGUucHVzaChcIkwgXCIsaS54LFwiIFwiLGkueSxcIiBcIiksZX0sY3JlYXRlUGF0aDpmdW5jdGlvbih0KXt2YXIgZT1uZXcgZmFicmljLlBhdGgodCx7ZmlsbDpudWxsLHN0cm9rZTp0aGlzLmNvbG9yLHN0cm9rZVdpZHRoOnRoaXMud2lkdGgsc3Ryb2tlTGluZUNhcDp0aGlzLnN0cm9rZUxpbmVDYXAsc3Ryb2tlTGluZUpvaW46dGhpcy5zdHJva2VMaW5lSm9pbixzdHJva2VEYXNoQXJyYXk6dGhpcy5zdHJva2VEYXNoQXJyYXksb3JpZ2luWDpcImNlbnRlclwiLG9yaWdpblk6XCJjZW50ZXJcIn0pO3JldHVybiB0aGlzLnNoYWRvdyYmKHRoaXMuc2hhZG93LmFmZmVjdFN0cm9rZT0hMCxlLnNldFNoYWRvdyh0aGlzLnNoYWRvdykpLGV9LF9maW5hbGl6ZUFuZEFkZFBhdGg6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNhbnZhcy5jb250ZXh0VG9wO3QuY2xvc2VQYXRoKCk7dmFyIGU9dGhpcy5jb252ZXJ0UG9pbnRzVG9TVkdQYXRoKHRoaXMuX3BvaW50cykuam9pbihcIlwiKTtpZihcIk0gMCAwIFEgMCAwIDAgMCBMIDAgMFwiPT09ZSlyZXR1cm4gdm9pZCB0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKTt2YXIgaT10aGlzLmNyZWF0ZVBhdGgoZSk7dGhpcy5jYW52YXMuYWRkKGkpLGkuc2V0Q29vcmRzKCksdGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3ApLHRoaXMuX3Jlc2V0U2hhZG93KCksdGhpcy5jYW52YXMucmVuZGVyQWxsKCksdGhpcy5jYW52YXMuZmlyZShcInBhdGg6Y3JlYXRlZFwiLHtwYXRoOml9KX19KX0oKSxmYWJyaWMuQ2lyY2xlQnJ1c2g9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3MoZmFicmljLkJhc2VCcnVzaCx7d2lkdGg6MTAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLmNhbnZhcz10LHRoaXMucG9pbnRzPVtdfSxkcmF3RG90OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuYWRkUG9pbnQodCksaT10aGlzLmNhbnZhcy5jb250ZXh0VG9wLHI9dGhpcy5jYW52YXMudmlld3BvcnRUcmFuc2Zvcm07aS5zYXZlKCksaS50cmFuc2Zvcm0oclswXSxyWzFdLHJbMl0sclszXSxyWzRdLHJbNV0pLGkuZmlsbFN0eWxlPWUuZmlsbCxpLmJlZ2luUGF0aCgpLGkuYXJjKGUueCxlLnksZS5yYWRpdXMsMCwyKk1hdGguUEksITEpLGkuY2xvc2VQYXRoKCksaS5maWxsKCksaS5yZXN0b3JlKCl9LG9uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3RoaXMucG9pbnRzLmxlbmd0aD0wLHRoaXMuY2FudmFzLmNsZWFyQ29udGV4dCh0aGlzLmNhbnZhcy5jb250ZXh0VG9wKSx0aGlzLl9zZXRTaGFkb3coKSx0aGlzLmRyYXdEb3QodCl9LG9uTW91c2VNb3ZlOmZ1bmN0aW9uKHQpe3RoaXMuZHJhd0RvdCh0KX0sb25Nb3VzZVVwOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jYW52YXMucmVuZGVyT25BZGRSZW1vdmU7dGhpcy5jYW52YXMucmVuZGVyT25BZGRSZW1vdmU9ITE7Zm9yKHZhciBlPVtdLGk9MCxyPXRoaXMucG9pbnRzLmxlbmd0aDtyPmk7aSsrKXt2YXIgcz10aGlzLnBvaW50c1tpXSxuPW5ldyBmYWJyaWMuQ2lyY2xlKHtyYWRpdXM6cy5yYWRpdXMsbGVmdDpzLngsdG9wOnMueSxvcmlnaW5YOlwiY2VudGVyXCIsb3JpZ2luWTpcImNlbnRlclwiLGZpbGw6cy5maWxsfSk7dGhpcy5zaGFkb3cmJm4uc2V0U2hhZG93KHRoaXMuc2hhZG93KSxlLnB1c2gobil9dmFyIG89bmV3IGZhYnJpYy5Hcm91cChlLHtvcmlnaW5YOlwiY2VudGVyXCIsb3JpZ2luWTpcImNlbnRlclwifSk7by5jYW52YXM9dGhpcy5jYW52YXMsdGhpcy5jYW52YXMuYWRkKG8pLHRoaXMuY2FudmFzLmZpcmUoXCJwYXRoOmNyZWF0ZWRcIix7cGF0aDpvfSksdGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3ApLHRoaXMuX3Jlc2V0U2hhZG93KCksdGhpcy5jYW52YXMucmVuZGVyT25BZGRSZW1vdmU9dCx0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKX0sYWRkUG9pbnQ6ZnVuY3Rpb24odCl7dmFyIGU9bmV3IGZhYnJpYy5Qb2ludCh0LngsdC55KSxpPWZhYnJpYy51dGlsLmdldFJhbmRvbUludChNYXRoLm1heCgwLHRoaXMud2lkdGgtMjApLHRoaXMud2lkdGgrMjApLzIscj1uZXcgZmFicmljLkNvbG9yKHRoaXMuY29sb3IpLnNldEFscGhhKGZhYnJpYy51dGlsLmdldFJhbmRvbUludCgwLDEwMCkvMTAwKS50b1JnYmEoKTtyZXR1cm4gZS5yYWRpdXM9aSxlLmZpbGw9cix0aGlzLnBvaW50cy5wdXNoKGUpLGV9fSksZmFicmljLlNwcmF5QnJ1c2g9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3MoZmFicmljLkJhc2VCcnVzaCx7d2lkdGg6MTAsZGVuc2l0eToyMCxkb3RXaWR0aDoxLGRvdFdpZHRoVmFyaWFuY2U6MSxyYW5kb21PcGFjaXR5OiExLG9wdGltaXplT3ZlcmxhcHBpbmc6ITAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLmNhbnZhcz10LHRoaXMuc3ByYXlDaHVua3M9W119LG9uTW91c2VEb3duOmZ1bmN0aW9uKHQpe3RoaXMuc3ByYXlDaHVua3MubGVuZ3RoPTAsdGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3ApLHRoaXMuX3NldFNoYWRvdygpLHRoaXMuYWRkU3ByYXlDaHVuayh0KSx0aGlzLnJlbmRlcigpfSxvbk1vdXNlTW92ZTpmdW5jdGlvbih0KXt0aGlzLmFkZFNwcmF5Q2h1bmsodCksdGhpcy5yZW5kZXIoKX0sb25Nb3VzZVVwOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jYW52YXMucmVuZGVyT25BZGRSZW1vdmU7dGhpcy5jYW52YXMucmVuZGVyT25BZGRSZW1vdmU9ITE7Zm9yKHZhciBlPVtdLGk9MCxyPXRoaXMuc3ByYXlDaHVua3MubGVuZ3RoO3I+aTtpKyspZm9yKHZhciBzPXRoaXMuc3ByYXlDaHVua3NbaV0sbj0wLG89cy5sZW5ndGg7bz5uO24rKyl7dmFyIGE9bmV3IGZhYnJpYy5SZWN0KHt3aWR0aDpzW25dLndpZHRoLGhlaWdodDpzW25dLndpZHRoLGxlZnQ6c1tuXS54KzEsdG9wOnNbbl0ueSsxLG9yaWdpblg6XCJjZW50ZXJcIixvcmlnaW5ZOlwiY2VudGVyXCIsZmlsbDp0aGlzLmNvbG9yfSk7dGhpcy5zaGFkb3cmJmEuc2V0U2hhZG93KHRoaXMuc2hhZG93KSxlLnB1c2goYSl9dGhpcy5vcHRpbWl6ZU92ZXJsYXBwaW5nJiYoZT10aGlzLl9nZXRPcHRpbWl6ZWRSZWN0cyhlKSk7dmFyIGg9bmV3IGZhYnJpYy5Hcm91cChlLHtvcmlnaW5YOlwiY2VudGVyXCIsb3JpZ2luWTpcImNlbnRlclwifSk7aC5jYW52YXM9dGhpcy5jYW52YXMsdGhpcy5jYW52YXMuYWRkKGgpLHRoaXMuY2FudmFzLmZpcmUoXCJwYXRoOmNyZWF0ZWRcIix7cGF0aDpofSksdGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3ApLHRoaXMuX3Jlc2V0U2hhZG93KCksdGhpcy5jYW52YXMucmVuZGVyT25BZGRSZW1vdmU9dCx0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKX0sX2dldE9wdGltaXplZFJlY3RzOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxpPXt9LHI9MCxzPXQubGVuZ3RoO3M+cjtyKyspZT10W3JdLmxlZnQrXCJcIit0W3JdLnRvcCxpW2VdfHwoaVtlXT10W3JdKTt2YXIgbj1bXTtmb3IoZSBpbiBpKW4ucHVzaChpW2VdKTtyZXR1cm4gbn0scmVuZGVyOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jYW52YXMuY29udGV4dFRvcDt0LmZpbGxTdHlsZT10aGlzLmNvbG9yO3ZhciBlPXRoaXMuY2FudmFzLnZpZXdwb3J0VHJhbnNmb3JtO3Quc2F2ZSgpLHQudHJhbnNmb3JtKGVbMF0sZVsxXSxlWzJdLGVbM10sZVs0XSxlWzVdKTtmb3IodmFyIGk9MCxyPXRoaXMuc3ByYXlDaHVua1BvaW50cy5sZW5ndGg7cj5pO2krKyl7dmFyIHM9dGhpcy5zcHJheUNodW5rUG9pbnRzW2ldO1widW5kZWZpbmVkXCIhPXR5cGVvZiBzLm9wYWNpdHkmJih0Lmdsb2JhbEFscGhhPXMub3BhY2l0eSksdC5maWxsUmVjdChzLngscy55LHMud2lkdGgscy53aWR0aCl9dC5yZXN0b3JlKCl9LGFkZFNwcmF5Q2h1bms6ZnVuY3Rpb24odCl7dGhpcy5zcHJheUNodW5rUG9pbnRzPVtdO2Zvcih2YXIgZSxpLHIscz10aGlzLndpZHRoLzIsbj0wO248dGhpcy5kZW5zaXR5O24rKyl7ZT1mYWJyaWMudXRpbC5nZXRSYW5kb21JbnQodC54LXMsdC54K3MpLGk9ZmFicmljLnV0aWwuZ2V0UmFuZG9tSW50KHQueS1zLHQueStzKSxyPXRoaXMuZG90V2lkdGhWYXJpYW5jZT9mYWJyaWMudXRpbC5nZXRSYW5kb21JbnQoTWF0aC5tYXgoMSx0aGlzLmRvdFdpZHRoLXRoaXMuZG90V2lkdGhWYXJpYW5jZSksdGhpcy5kb3RXaWR0aCt0aGlzLmRvdFdpZHRoVmFyaWFuY2UpOnRoaXMuZG90V2lkdGg7dmFyIG89bmV3IGZhYnJpYy5Qb2ludChlLGkpO28ud2lkdGg9cix0aGlzLnJhbmRvbU9wYWNpdHkmJihvLm9wYWNpdHk9ZmFicmljLnV0aWwuZ2V0UmFuZG9tSW50KDAsMTAwKS8xMDApLHRoaXMuc3ByYXlDaHVua1BvaW50cy5wdXNoKG8pfXRoaXMuc3ByYXlDaHVua3MucHVzaCh0aGlzLnNwcmF5Q2h1bmtQb2ludHMpfX0pLGZhYnJpYy5QYXR0ZXJuQnJ1c2g9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3MoZmFicmljLlBlbmNpbEJydXNoLHtnZXRQYXR0ZXJuU3JjOmZ1bmN0aW9uKCl7dmFyIHQ9MjAsZT01LGk9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikscj1pLmdldENvbnRleHQoXCIyZFwiKTtyZXR1cm4gaS53aWR0aD1pLmhlaWdodD10K2Usci5maWxsU3R5bGU9dGhpcy5jb2xvcixyLmJlZ2luUGF0aCgpLHIuYXJjKHQvMix0LzIsdC8yLDAsMipNYXRoLlBJLCExKSxyLmNsb3NlUGF0aCgpLHIuZmlsbCgpLGl9LGdldFBhdHRlcm5TcmNGdW5jdGlvbjpmdW5jdGlvbigpe3JldHVybiBTdHJpbmcodGhpcy5nZXRQYXR0ZXJuU3JjKS5yZXBsYWNlKFwidGhpcy5jb2xvclwiLCdcIicrdGhpcy5jb2xvcisnXCInKX0sZ2V0UGF0dGVybjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbnZhcy5jb250ZXh0VG9wLmNyZWF0ZVBhdHRlcm4odGhpcy5zb3VyY2V8fHRoaXMuZ2V0UGF0dGVyblNyYygpLFwicmVwZWF0XCIpfSxfc2V0QnJ1c2hTdHlsZXM6ZnVuY3Rpb24oKXt0aGlzLmNhbGxTdXBlcihcIl9zZXRCcnVzaFN0eWxlc1wiKSx0aGlzLmNhbnZhcy5jb250ZXh0VG9wLnN0cm9rZVN0eWxlPXRoaXMuZ2V0UGF0dGVybigpfSxjcmVhdGVQYXRoOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2FsbFN1cGVyKFwiY3JlYXRlUGF0aFwiLHQpO3JldHVybiBlLnN0cm9rZT1uZXcgZmFicmljLlBhdHRlcm4oe3NvdXJjZTp0aGlzLnNvdXJjZXx8dGhpcy5nZXRQYXR0ZXJuU3JjRnVuY3Rpb24oKX0pLGV9fSksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC5nZXRQb2ludGVyLGU9ZmFicmljLnV0aWwuZGVncmVlc1RvUmFkaWFucyxpPWZhYnJpYy51dGlsLnJhZGlhbnNUb0RlZ3JlZXMscj1NYXRoLmF0YW4yLHM9TWF0aC5hYnMsbj0uNTtmYWJyaWMuQ2FudmFzPWZhYnJpYy51dGlsLmNyZWF0ZUNsYXNzKGZhYnJpYy5TdGF0aWNDYW52YXMse2luaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlfHwoZT17fSksdGhpcy5faW5pdFN0YXRpYyh0LGUpLHRoaXMuX2luaXRJbnRlcmFjdGl2ZSgpLHRoaXMuX2NyZWF0ZUNhY2hlQ2FudmFzKCksZmFicmljLkNhbnZhcy5hY3RpdmVJbnN0YW5jZT10aGlzfSx1bmlTY2FsZVRyYW5zZm9ybTohMSxjZW50ZXJlZFNjYWxpbmc6ITEsY2VudGVyZWRSb3RhdGlvbjohMSxpbnRlcmFjdGl2ZTohMCxzZWxlY3Rpb246ITAsc2VsZWN0aW9uQ29sb3I6XCJyZ2JhKDEwMCwgMTAwLCAyNTUsIDAuMylcIixzZWxlY3Rpb25EYXNoQXJyYXk6W10sc2VsZWN0aW9uQm9yZGVyQ29sb3I6XCJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMylcIixzZWxlY3Rpb25MaW5lV2lkdGg6MSxob3ZlckN1cnNvcjpcIm1vdmVcIixtb3ZlQ3Vyc29yOlwibW92ZVwiLGRlZmF1bHRDdXJzb3I6XCJkZWZhdWx0XCIsZnJlZURyYXdpbmdDdXJzb3I6XCJjcm9zc2hhaXJcIixyb3RhdGlvbkN1cnNvcjpcImNyb3NzaGFpclwiLGNvbnRhaW5lckNsYXNzOlwiY2FudmFzLWNvbnRhaW5lclwiLHBlclBpeGVsVGFyZ2V0RmluZDohMSx0YXJnZXRGaW5kVG9sZXJhbmNlOjAsc2tpcFRhcmdldEZpbmQ6ITEsaXNEcmF3aW5nTW9kZTohMSxfaW5pdEludGVyYWN0aXZlOmZ1bmN0aW9uKCl7dGhpcy5fY3VycmVudFRyYW5zZm9ybT1udWxsLHRoaXMuX2dyb3VwU2VsZWN0b3I9bnVsbCx0aGlzLl9pbml0V3JhcHBlckVsZW1lbnQoKSx0aGlzLl9jcmVhdGVVcHBlckNhbnZhcygpLHRoaXMuX2luaXRFdmVudExpc3RlbmVycygpLHRoaXMuZnJlZURyYXdpbmdCcnVzaD1mYWJyaWMuUGVuY2lsQnJ1c2gmJm5ldyBmYWJyaWMuUGVuY2lsQnJ1c2godGhpcyksdGhpcy5jYWxjT2Zmc2V0KCl9LF9yZXNldEN1cnJlbnRUcmFuc2Zvcm06ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY3VycmVudFRyYW5zZm9ybTtlLnRhcmdldC5zZXQoe3NjYWxlWDplLm9yaWdpbmFsLnNjYWxlWCxzY2FsZVk6ZS5vcmlnaW5hbC5zY2FsZVksbGVmdDplLm9yaWdpbmFsLmxlZnQsdG9wOmUub3JpZ2luYWwudG9wfSksdGhpcy5fc2hvdWxkQ2VudGVyVHJhbnNmb3JtKHQsZS50YXJnZXQpP1wicm90YXRlXCI9PT1lLmFjdGlvbj90aGlzLl9zZXRPcmlnaW5Ub0NlbnRlcihlLnRhcmdldCk6KFwiY2VudGVyXCIhPT1lLm9yaWdpblgmJihcInJpZ2h0XCI9PT1lLm9yaWdpblg/ZS5tb3VzZVhTaWduPS0xOmUubW91c2VYU2lnbj0xKSxcImNlbnRlclwiIT09ZS5vcmlnaW5ZJiYoXCJib3R0b21cIj09PWUub3JpZ2luWT9lLm1vdXNlWVNpZ249LTE6ZS5tb3VzZVlTaWduPTEpLGUub3JpZ2luWD1cImNlbnRlclwiLGUub3JpZ2luWT1cImNlbnRlclwiKTooZS5vcmlnaW5YPWUub3JpZ2luYWwub3JpZ2luWCxlLm9yaWdpblk9ZS5vcmlnaW5hbC5vcmlnaW5ZKX0sY29udGFpbnNQb2ludDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuZ2V0UG9pbnRlcih0LCEwKSxyPXRoaXMuX25vcm1hbGl6ZVBvaW50ZXIoZSxpKTtyZXR1cm4gZS5jb250YWluc1BvaW50KHIpfHxlLl9maW5kVGFyZ2V0Q29ybmVyKGkpfSxfbm9ybWFsaXplUG9pbnRlcjpmdW5jdGlvbih0LGUpe3ZhciBpLHI9dGhpcy5nZXRBY3RpdmVHcm91cCgpLHM9ZS54LG49ZS55LG89ciYmXCJncm91cFwiIT09dC50eXBlJiZyLmNvbnRhaW5zKHQpO3JldHVybiBvJiYoaT1uZXcgZmFicmljLlBvaW50KHIubGVmdCxyLnRvcCksaT1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludChpLHRoaXMudmlld3BvcnRUcmFuc2Zvcm0sITApLHMtPWkueCxuLT1pLnkpLHt4OnMseTpufX0saXNUYXJnZXRUcmFuc3BhcmVudDpmdW5jdGlvbih0LGUsaSl7dmFyIHI9dC5oYXNCb3JkZXJzLHM9dC50cmFuc3BhcmVudENvcm5lcnM7dC5oYXNCb3JkZXJzPXQudHJhbnNwYXJlbnRDb3JuZXJzPSExLHRoaXMuX2RyYXcodGhpcy5jb250ZXh0Q2FjaGUsdCksdC5oYXNCb3JkZXJzPXIsdC50cmFuc3BhcmVudENvcm5lcnM9czt2YXIgbj1mYWJyaWMudXRpbC5pc1RyYW5zcGFyZW50KHRoaXMuY29udGV4dENhY2hlLGUsaSx0aGlzLnRhcmdldEZpbmRUb2xlcmFuY2UpO3JldHVybiB0aGlzLmNsZWFyQ29udGV4dCh0aGlzLmNvbnRleHRDYWNoZSksbn0sX3Nob3VsZENsZWFyU2VsZWN0aW9uOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpLHI9dGhpcy5nZXRBY3RpdmVPYmplY3QoKTtyZXR1cm4hZXx8ZSYmaSYmIWkuY29udGFpbnMoZSkmJmkhPT1lJiYhdC5zaGlmdEtleXx8ZSYmIWUuZXZlbnRlZHx8ZSYmIWUuc2VsZWN0YWJsZSYmciYmciE9PWV9LF9zaG91bGRDZW50ZXJUcmFuc2Zvcm06ZnVuY3Rpb24odCxlKXtpZihlKXt2YXIgaSxyPXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm07cmV0dXJuXCJzY2FsZVwiPT09ci5hY3Rpb258fFwic2NhbGVYXCI9PT1yLmFjdGlvbnx8XCJzY2FsZVlcIj09PXIuYWN0aW9uP2k9dGhpcy5jZW50ZXJlZFNjYWxpbmd8fGUuY2VudGVyZWRTY2FsaW5nOlwicm90YXRlXCI9PT1yLmFjdGlvbiYmKGk9dGhpcy5jZW50ZXJlZFJvdGF0aW9ufHxlLmNlbnRlcmVkUm90YXRpb24pLGk/IXQuYWx0S2V5OnQuYWx0S2V5fX0sX2dldE9yaWdpbkZyb21Db3JuZXI6ZnVuY3Rpb24odCxlKXt2YXIgaT17eDp0Lm9yaWdpblgseTp0Lm9yaWdpbll9O3JldHVyblwibWxcIj09PWV8fFwidGxcIj09PWV8fFwiYmxcIj09PWU/aS54PVwicmlnaHRcIjooXCJtclwiPT09ZXx8XCJ0clwiPT09ZXx8XCJiclwiPT09ZSkmJihpLng9XCJsZWZ0XCIpLFwidGxcIj09PWV8fFwibXRcIj09PWV8fFwidHJcIj09PWU/aS55PVwiYm90dG9tXCI6KFwiYmxcIj09PWV8fFwibWJcIj09PWV8fFwiYnJcIj09PWUpJiYoaS55PVwidG9wXCIpLGl9LF9nZXRBY3Rpb25Gcm9tQ29ybmVyOmZ1bmN0aW9uKHQsZSl7dmFyIGk9XCJkcmFnXCI7cmV0dXJuIGUmJihpPVwibWxcIj09PWV8fFwibXJcIj09PWU/XCJzY2FsZVhcIjpcIm10XCI9PT1lfHxcIm1iXCI9PT1lP1wic2NhbGVZXCI6XCJtdHJcIj09PWU/XCJyb3RhdGVcIjpcInNjYWxlXCIpLGl9LF9zZXR1cEN1cnJlbnRUcmFuc2Zvcm06ZnVuY3Rpb24odCxpKXtpZihpKXt2YXIgcj10aGlzLmdldFBvaW50ZXIodCkscz1pLl9maW5kVGFyZ2V0Q29ybmVyKHRoaXMuZ2V0UG9pbnRlcih0LCEwKSksbj10aGlzLl9nZXRBY3Rpb25Gcm9tQ29ybmVyKGkscyksbz10aGlzLl9nZXRPcmlnaW5Gcm9tQ29ybmVyKGkscyk7dGhpcy5fY3VycmVudFRyYW5zZm9ybT17dGFyZ2V0OmksYWN0aW9uOm4sc2NhbGVYOmkuc2NhbGVYLHNjYWxlWTppLnNjYWxlWSxvZmZzZXRYOnIueC1pLmxlZnQsb2Zmc2V0WTpyLnktaS50b3Asb3JpZ2luWDpvLngsb3JpZ2luWTpvLnksZXg6ci54LGV5OnIueSxsZWZ0OmkubGVmdCx0b3A6aS50b3AsdGhldGE6ZShpLmFuZ2xlKSx3aWR0aDppLndpZHRoKmkuc2NhbGVYLG1vdXNlWFNpZ246MSxtb3VzZVlTaWduOjF9LHRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0ub3JpZ2luYWw9e2xlZnQ6aS5sZWZ0LHRvcDppLnRvcCxzY2FsZVg6aS5zY2FsZVgsc2NhbGVZOmkuc2NhbGVZLG9yaWdpblg6by54LG9yaWdpblk6by55fSx0aGlzLl9yZXNldEN1cnJlbnRUcmFuc2Zvcm0odCl9fSxfdHJhbnNsYXRlT2JqZWN0OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fY3VycmVudFRyYW5zZm9ybS50YXJnZXQ7aS5nZXQoXCJsb2NrTW92ZW1lbnRYXCIpfHxpLnNldChcImxlZnRcIix0LXRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0ub2Zmc2V0WCksaS5nZXQoXCJsb2NrTW92ZW1lbnRZXCIpfHxpLnNldChcInRvcFwiLGUtdGhpcy5fY3VycmVudFRyYW5zZm9ybS5vZmZzZXRZKX0sX3NjYWxlT2JqZWN0OmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj10aGlzLl9jdXJyZW50VHJhbnNmb3JtLHM9ci50YXJnZXQsbj1zLmdldChcImxvY2tTY2FsaW5nWFwiKSxvPXMuZ2V0KFwibG9ja1NjYWxpbmdZXCIpLGE9cy5nZXQoXCJsb2NrU2NhbGluZ0ZsaXBcIik7aWYoIW58fCFvKXt2YXIgaD1zLnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQocy5nZXRDZW50ZXJQb2ludCgpLHIub3JpZ2luWCxyLm9yaWdpblkpLGM9cy50b0xvY2FsUG9pbnQobmV3IGZhYnJpYy5Qb2ludCh0LGUpLHIub3JpZ2luWCxyLm9yaWdpblkpO3RoaXMuX3NldExvY2FsTW91c2UoYyxyKSx0aGlzLl9zZXRPYmplY3RTY2FsZShjLHIsbixvLGksYSkscy5zZXRQb3NpdGlvbkJ5T3JpZ2luKGgsci5vcmlnaW5YLHIub3JpZ2luWSl9fSxfc2V0T2JqZWN0U2NhbGU6ZnVuY3Rpb24odCxlLGkscixzLG4pe3ZhciBvPWUudGFyZ2V0LGE9ITEsaD0hMSxjPVwibGluZVwiPT09by50eXBlJiYwPT09by53aWR0aCxsPVwibGluZVwiPT09by50eXBlJiYwPT09by5oZWlnaHQsdT1sPzA6by5zdHJva2VXaWR0aCxmPWM/MDpvLnN0cm9rZVdpZHRoO2UubmV3U2NhbGVYPXQueC8oby53aWR0aCt1KSxlLm5ld1NjYWxlWT10LnkvKG8uaGVpZ2h0K2YpLG4mJmUubmV3U2NhbGVYPD0wJiZlLm5ld1NjYWxlWDxvLnNjYWxlWCYmKGE9ITApLG4mJmUubmV3U2NhbGVZPD0wJiZlLm5ld1NjYWxlWTxvLnNjYWxlWSYmKGg9ITApLFwiZXF1YWxseVwiIT09c3x8aXx8cj9zP1wieFwiIT09c3x8by5nZXQoXCJsb2NrVW5pU2NhbGluZ1wiKT9cInlcIiE9PXN8fG8uZ2V0KFwibG9ja1VuaVNjYWxpbmdcIil8fGh8fHJ8fG8uc2V0KFwic2NhbGVZXCIsZS5uZXdTY2FsZVkpOmF8fGl8fG8uc2V0KFwic2NhbGVYXCIsZS5uZXdTY2FsZVgpOihhfHxpfHxvLnNldChcInNjYWxlWFwiLGUubmV3U2NhbGVYKSxofHxyfHxvLnNldChcInNjYWxlWVwiLGUubmV3U2NhbGVZKSk6YXx8aHx8dGhpcy5fc2NhbGVPYmplY3RFcXVhbGx5KHQsbyxlKSxhfHxofHx0aGlzLl9mbGlwT2JqZWN0KGUscyl9LF9zY2FsZU9iamVjdEVxdWFsbHk6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXQueSt0Lngscz1cImxpbmVcIj09PWUudHlwZSYmMD09PWUud2lkdGgsbj1cImxpbmVcIj09PWUudHlwZSYmMD09PWUuaGVpZ2h0LG89bj8wOmUuc3Ryb2tlV2lkdGgsYT1zPzA6ZS5zdHJva2VXaWR0aCxoPShlLmhlaWdodCthKSppLm9yaWdpbmFsLnNjYWxlWSsoZS53aWR0aCtvKSppLm9yaWdpbmFsLnNjYWxlWDtpLm5ld1NjYWxlWD1pLm9yaWdpbmFsLnNjYWxlWCpyL2gsaS5uZXdTY2FsZVk9aS5vcmlnaW5hbC5zY2FsZVkqci9oLGUuc2V0KFwic2NhbGVYXCIsaS5uZXdTY2FsZVgpLGUuc2V0KFwic2NhbGVZXCIsaS5uZXdTY2FsZVkpfSxfZmxpcE9iamVjdDpmdW5jdGlvbih0LGUpe3QubmV3U2NhbGVYPDAmJlwieVwiIT09ZSYmKFwibGVmdFwiPT09dC5vcmlnaW5YP3Qub3JpZ2luWD1cInJpZ2h0XCI6XCJyaWdodFwiPT09dC5vcmlnaW5YJiYodC5vcmlnaW5YPVwibGVmdFwiKSksdC5uZXdTY2FsZVk8MCYmXCJ4XCIhPT1lJiYoXCJ0b3BcIj09PXQub3JpZ2luWT90Lm9yaWdpblk9XCJib3R0b21cIjpcImJvdHRvbVwiPT09dC5vcmlnaW5ZJiYodC5vcmlnaW5ZPVwidG9wXCIpKX0sX3NldExvY2FsTW91c2U6ZnVuY3Rpb24odCxlKXt2YXIgaT1lLnRhcmdldDtcInJpZ2h0XCI9PT1lLm9yaWdpblg/dC54Kj0tMTpcImNlbnRlclwiPT09ZS5vcmlnaW5YJiYodC54Kj0yKmUubW91c2VYU2lnbix0Lng8MCYmKGUubW91c2VYU2lnbj0tZS5tb3VzZVhTaWduKSksXCJib3R0b21cIj09PWUub3JpZ2luWT90LnkqPS0xOlwiY2VudGVyXCI9PT1lLm9yaWdpblkmJih0LnkqPTIqZS5tb3VzZVlTaWduLHQueTwwJiYoZS5tb3VzZVlTaWduPS1lLm1vdXNlWVNpZ24pKSxzKHQueCk+aS5wYWRkaW5nP3QueDwwP3QueCs9aS5wYWRkaW5nOnQueC09aS5wYWRkaW5nOnQueD0wLHModC55KT5pLnBhZGRpbmc/dC55PDA/dC55Kz1pLnBhZGRpbmc6dC55LT1pLnBhZGRpbmc6dC55PTB9LF9yb3RhdGVPYmplY3Q6ZnVuY3Rpb24odCxlKXt2YXIgcz10aGlzLl9jdXJyZW50VHJhbnNmb3JtO2lmKCFzLnRhcmdldC5nZXQoXCJsb2NrUm90YXRpb25cIikpe3ZhciBuPXIocy5leS1zLnRvcCxzLmV4LXMubGVmdCksbz1yKGUtcy50b3AsdC1zLmxlZnQpLGE9aShvLW4rcy50aGV0YSk7MD5hJiYoYT0zNjArYSkscy50YXJnZXQuYW5nbGU9YSUzNjB9fSxzZXRDdXJzb3I6ZnVuY3Rpb24odCl7dGhpcy51cHBlckNhbnZhc0VsLnN0eWxlLmN1cnNvcj10fSxfcmVzZXRPYmplY3RUcmFuc2Zvcm06ZnVuY3Rpb24odCl7dC5zY2FsZVg9MSx0LnNjYWxlWT0xLHQuc2V0QW5nbGUoMCl9LF9kcmF3U2VsZWN0aW9uOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jb250ZXh0VG9wLGU9dGhpcy5fZ3JvdXBTZWxlY3RvcixpPWUubGVmdCxyPWUudG9wLG89cyhpKSxhPXMocik7aWYodC5maWxsU3R5bGU9dGhpcy5zZWxlY3Rpb25Db2xvcix0LmZpbGxSZWN0KGUuZXgtKGk+MD8wOi1pKSxlLmV5LShyPjA/MDotciksbyxhKSx0LmxpbmVXaWR0aD10aGlzLnNlbGVjdGlvbkxpbmVXaWR0aCx0LnN0cm9rZVN0eWxlPXRoaXMuc2VsZWN0aW9uQm9yZGVyQ29sb3IsdGhpcy5zZWxlY3Rpb25EYXNoQXJyYXkubGVuZ3RoPjEpe3ZhciBoPWUuZXgrbi0oaT4wPzA6byksYz1lLmV5K24tKHI+MD8wOmEpO3QuYmVnaW5QYXRoKCksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxoLGMsaCtvLGMsdGhpcy5zZWxlY3Rpb25EYXNoQXJyYXkpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaCxjK2EtMSxoK28sYythLTEsdGhpcy5zZWxlY3Rpb25EYXNoQXJyYXkpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaCxjLGgsYythLHRoaXMuc2VsZWN0aW9uRGFzaEFycmF5KSxmYWJyaWMudXRpbC5kcmF3RGFzaGVkTGluZSh0LGgrby0xLGMsaCtvLTEsYythLHRoaXMuc2VsZWN0aW9uRGFzaEFycmF5KSx0LmNsb3NlUGF0aCgpLHQuc3Ryb2tlKCl9ZWxzZSB0LnN0cm9rZVJlY3QoZS5leCtuLShpPjA/MDpvKSxlLmV5K24tKHI+MD8wOmEpLG8sYSl9LF9pc0xhc3RSZW5kZXJlZE9iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb250cm9sc0Fib3ZlT3ZlcmxheSYmdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXkmJnRoaXMubGFzdFJlbmRlcmVkT2JqZWN0V2l0aENvbnRyb2xzQWJvdmVPdmVybGF5LnZpc2libGUmJnRoaXMuY29udGFpbnNQb2ludCh0LHRoaXMubGFzdFJlbmRlcmVkT2JqZWN0V2l0aENvbnRyb2xzQWJvdmVPdmVybGF5KSYmdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXkuX2ZpbmRUYXJnZXRDb3JuZXIodGhpcy5nZXRQb2ludGVyKHQsITApKX0sZmluZFRhcmdldDpmdW5jdGlvbih0LGUpe2lmKCF0aGlzLnNraXBUYXJnZXRGaW5kKXtpZih0aGlzLl9pc0xhc3RSZW5kZXJlZE9iamVjdCh0KSlyZXR1cm4gdGhpcy5sYXN0UmVuZGVyZWRPYmplY3RXaXRoQ29udHJvbHNBYm92ZU92ZXJsYXk7dmFyIGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpO2lmKGkmJiFlJiZ0aGlzLmNvbnRhaW5zUG9pbnQodCxpKSlyZXR1cm4gaTt2YXIgcj10aGlzLl9zZWFyY2hQb3NzaWJsZVRhcmdldHModCk7cmV0dXJuIHRoaXMuX2ZpcmVPdmVyT3V0RXZlbnRzKHIsdCkscn19LF9maXJlT3Zlck91dEV2ZW50czpmdW5jdGlvbih0LGUpe3Q/dGhpcy5faG92ZXJlZFRhcmdldCE9PXQmJih0aGlzLl9ob3ZlcmVkVGFyZ2V0JiYodGhpcy5maXJlKFwibW91c2U6b3V0XCIse3RhcmdldDp0aGlzLl9ob3ZlcmVkVGFyZ2V0LGU6ZX0pLHRoaXMuX2hvdmVyZWRUYXJnZXQuZmlyZShcIm1vdXNlb3V0XCIpKSx0aGlzLmZpcmUoXCJtb3VzZTpvdmVyXCIse3RhcmdldDp0LGU6ZX0pLHQuZmlyZShcIm1vdXNlb3ZlclwiKSx0aGlzLl9ob3ZlcmVkVGFyZ2V0PXQpOnRoaXMuX2hvdmVyZWRUYXJnZXQmJih0aGlzLmZpcmUoXCJtb3VzZTpvdXRcIix7dGFyZ2V0OnRoaXMuX2hvdmVyZWRUYXJnZXQsZTplfSksdGhpcy5faG92ZXJlZFRhcmdldC5maXJlKFwibW91c2VvdXRcIiksdGhpcy5faG92ZXJlZFRhcmdldD1udWxsKX0sX2NoZWNrVGFyZ2V0OmZ1bmN0aW9uKHQsZSxpKXtpZihlJiZlLnZpc2libGUmJmUuZXZlbnRlZCYmdGhpcy5jb250YWluc1BvaW50KHQsZSkpe2lmKCF0aGlzLnBlclBpeGVsVGFyZ2V0RmluZCYmIWUucGVyUGl4ZWxUYXJnZXRGaW5kfHxlLmlzRWRpdGluZylyZXR1cm4hMDt2YXIgcj10aGlzLmlzVGFyZ2V0VHJhbnNwYXJlbnQoZSxpLngsaS55KTtpZighcilyZXR1cm4hMH19LF9zZWFyY2hQb3NzaWJsZVRhcmdldHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9dGhpcy5nZXRQb2ludGVyKHQsITApLHI9dGhpcy5fb2JqZWN0cy5sZW5ndGg7ci0tOylpZighdGhpcy5fb2JqZWN0c1tyXS5ncm91cCYmdGhpcy5fY2hlY2tUYXJnZXQodCx0aGlzLl9vYmplY3RzW3JdLGkpKXt0aGlzLnJlbGF0ZWRUYXJnZXQ9dGhpcy5fb2JqZWN0c1tyXSxlPXRoaXMuX29iamVjdHNbcl07YnJlYWt9cmV0dXJuIGV9LGdldFBvaW50ZXI6ZnVuY3Rpb24oZSxpLHIpe3J8fChyPXRoaXMudXBwZXJDYW52YXNFbCk7dmFyIHMsbj10KGUsciksbz1yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGE9by53aWR0aHx8MCxoPW8uaGVpZ2h0fHwwO3JldHVybiBhJiZofHwoXCJ0b3BcImluIG8mJlwiYm90dG9tXCJpbiBvJiYoaD1NYXRoLmFicyhvLnRvcC1vLmJvdHRvbSkpLFwicmlnaHRcImluIG8mJlwibGVmdFwiaW4gbyYmKGE9TWF0aC5hYnMoby5yaWdodC1vLmxlZnQpKSksdGhpcy5jYWxjT2Zmc2V0KCksbi54PW4ueC10aGlzLl9vZmZzZXQubGVmdCxuLnk9bi55LXRoaXMuX29mZnNldC50b3AsaXx8KG49ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQobixmYWJyaWMudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy52aWV3cG9ydFRyYW5zZm9ybSkpKSxzPTA9PT1hfHwwPT09aD97d2lkdGg6MSxoZWlnaHQ6MX06e3dpZHRoOnIud2lkdGgvYSxoZWlnaHQ6ci5oZWlnaHQvaH0se3g6bi54KnMud2lkdGgseTpuLnkqcy5oZWlnaHR9fSxfY3JlYXRlVXBwZXJDYW52YXM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmxvd2VyQ2FudmFzRWwuY2xhc3NOYW1lLnJlcGxhY2UoL1xccypsb3dlci1jYW52YXNcXHMqLyxcIlwiKTt0aGlzLnVwcGVyQ2FudmFzRWw9dGhpcy5fY3JlYXRlQ2FudmFzRWxlbWVudCgpLGZhYnJpYy51dGlsLmFkZENsYXNzKHRoaXMudXBwZXJDYW52YXNFbCxcInVwcGVyLWNhbnZhcyBcIit0KSx0aGlzLndyYXBwZXJFbC5hcHBlbmRDaGlsZCh0aGlzLnVwcGVyQ2FudmFzRWwpLHRoaXMuX2NvcHlDYW52YXNTdHlsZSh0aGlzLmxvd2VyQ2FudmFzRWwsdGhpcy51cHBlckNhbnZhc0VsKSx0aGlzLl9hcHBseUNhbnZhc1N0eWxlKHRoaXMudXBwZXJDYW52YXNFbCksdGhpcy5jb250ZXh0VG9wPXRoaXMudXBwZXJDYW52YXNFbC5nZXRDb250ZXh0KFwiMmRcIil9LF9jcmVhdGVDYWNoZUNhbnZhczpmdW5jdGlvbigpe3RoaXMuY2FjaGVDYW52YXNFbD10aGlzLl9jcmVhdGVDYW52YXNFbGVtZW50KCksdGhpcy5jYWNoZUNhbnZhc0VsLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsdGhpcy53aWR0aCksdGhpcy5jYWNoZUNhbnZhc0VsLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLHRoaXMuaGVpZ2h0KSx0aGlzLmNvbnRleHRDYWNoZT10aGlzLmNhY2hlQ2FudmFzRWwuZ2V0Q29udGV4dChcIjJkXCIpfSxfaW5pdFdyYXBwZXJFbGVtZW50OmZ1bmN0aW9uKCl7dGhpcy53cmFwcGVyRWw9ZmFicmljLnV0aWwud3JhcEVsZW1lbnQodGhpcy5sb3dlckNhbnZhc0VsLFwiZGl2XCIse1wiY2xhc3NcIjp0aGlzLmNvbnRhaW5lckNsYXNzfSksZmFicmljLnV0aWwuc2V0U3R5bGUodGhpcy53cmFwcGVyRWwse3dpZHRoOnRoaXMuZ2V0V2lkdGgoKStcInB4XCIsaGVpZ2h0OnRoaXMuZ2V0SGVpZ2h0KCkrXCJweFwiLHBvc2l0aW9uOlwicmVsYXRpdmVcIn0pLGZhYnJpYy51dGlsLm1ha2VFbGVtZW50VW5zZWxlY3RhYmxlKHRoaXMud3JhcHBlckVsKX0sX2FwcGx5Q2FudmFzU3R5bGU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRXaWR0aCgpfHx0LndpZHRoLGk9dGhpcy5nZXRIZWlnaHQoKXx8dC5oZWlnaHQ7ZmFicmljLnV0aWwuc2V0U3R5bGUodCx7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHdpZHRoOmUrXCJweFwiLGhlaWdodDppK1wicHhcIixsZWZ0OjAsdG9wOjB9KSx0LndpZHRoPWUsdC5oZWlnaHQ9aSxmYWJyaWMudXRpbC5tYWtlRWxlbWVudFVuc2VsZWN0YWJsZSh0KX0sX2NvcHlDYW52YXNTdHlsZTpmdW5jdGlvbih0LGUpe2Uuc3R5bGUuY3NzVGV4dD10LnN0eWxlLmNzc1RleHR9LGdldFNlbGVjdGlvbkNvbnRleHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250ZXh0VG9wfSxnZXRTZWxlY3Rpb25FbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudXBwZXJDYW52YXNFbH0sX3NldEFjdGl2ZU9iamVjdDpmdW5jdGlvbih0KXt0aGlzLl9hY3RpdmVPYmplY3QmJnRoaXMuX2FjdGl2ZU9iamVjdC5zZXQoXCJhY3RpdmVcIiwhMSksdGhpcy5fYWN0aXZlT2JqZWN0PXQsdC5zZXQoXCJhY3RpdmVcIiwhMCl9LHNldEFjdGl2ZU9iamVjdDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9zZXRBY3RpdmVPYmplY3QodCksdGhpcy5yZW5kZXJBbGwoKSx0aGlzLmZpcmUoXCJvYmplY3Q6c2VsZWN0ZWRcIix7dGFyZ2V0OnQsZTplfSksdC5maXJlKFwic2VsZWN0ZWRcIix7ZTplfSksdGhpc30sZ2V0QWN0aXZlT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZU9iamVjdH0sX2Rpc2NhcmRBY3RpdmVPYmplY3Q6ZnVuY3Rpb24oKXt0aGlzLl9hY3RpdmVPYmplY3QmJnRoaXMuX2FjdGl2ZU9iamVjdC5zZXQoXCJhY3RpdmVcIiwhMSksdGhpcy5fYWN0aXZlT2JqZWN0PW51bGx9LGRpc2NhcmRBY3RpdmVPYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2Rpc2NhcmRBY3RpdmVPYmplY3QoKSx0aGlzLnJlbmRlckFsbCgpLHRoaXMuZmlyZShcInNlbGVjdGlvbjpjbGVhcmVkXCIse2U6dH0pLHRoaXN9LF9zZXRBY3RpdmVHcm91cDpmdW5jdGlvbih0KXt0aGlzLl9hY3RpdmVHcm91cD10LHQmJnQuc2V0KFwiYWN0aXZlXCIsITApfSxzZXRBY3RpdmVHcm91cDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9zZXRBY3RpdmVHcm91cCh0KSx0JiYodGhpcy5maXJlKFwib2JqZWN0OnNlbGVjdGVkXCIse3RhcmdldDp0LGU6ZX0pLHQuZmlyZShcInNlbGVjdGVkXCIse2U6ZX0pKSx0aGlzfSxnZXRBY3RpdmVHcm91cDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hY3RpdmVHcm91cH0sX2Rpc2NhcmRBY3RpdmVHcm91cDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0QWN0aXZlR3JvdXAoKTt0JiZ0LmRlc3Ryb3koKSx0aGlzLnNldEFjdGl2ZUdyb3VwKG51bGwpfSxkaXNjYXJkQWN0aXZlR3JvdXA6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2Rpc2NhcmRBY3RpdmVHcm91cCgpLHRoaXMuZmlyZShcInNlbGVjdGlvbjpjbGVhcmVkXCIse2U6dH0pLHRoaXN9LGRlYWN0aXZhdGVBbGw6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy5nZXRPYmplY3RzKCksZT0wLGk9dC5sZW5ndGg7aT5lO2UrKyl0W2VdLnNldChcImFjdGl2ZVwiLCExKTtyZXR1cm4gdGhpcy5fZGlzY2FyZEFjdGl2ZUdyb3VwKCksdGhpcy5fZGlzY2FyZEFjdGl2ZU9iamVjdCgpLHRoaXN9LGRlYWN0aXZhdGVBbGxXaXRoRGlzcGF0Y2g6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRBY3RpdmVHcm91cCgpfHx0aGlzLmdldEFjdGl2ZU9iamVjdCgpO3JldHVybiBlJiZ0aGlzLmZpcmUoXCJiZWZvcmU6c2VsZWN0aW9uOmNsZWFyZWRcIix7dGFyZ2V0OmUsZTp0fSksdGhpcy5kZWFjdGl2YXRlQWxsKCksZSYmdGhpcy5maXJlKFwic2VsZWN0aW9uOmNsZWFyZWRcIix7ZTp0fSksdGhpc30sZHJhd0NvbnRyb2xzOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0QWN0aXZlR3JvdXAoKTtlP3RoaXMuX2RyYXdHcm91cENvbnRyb2xzKHQsZSk6dGhpcy5fZHJhd09iamVjdHNDb250cm9scyh0KX0sX2RyYXdHcm91cENvbnRyb2xzOmZ1bmN0aW9uKHQsZSl7ZS5fcmVuZGVyQ29udHJvbHModCl9LF9kcmF3T2JqZWN0c0NvbnRyb2xzOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9dGhpcy5fb2JqZWN0cy5sZW5ndGg7aT5lOysrZSl0aGlzLl9vYmplY3RzW2VdJiZ0aGlzLl9vYmplY3RzW2VdLmFjdGl2ZSYmKHRoaXMuX29iamVjdHNbZV0uX3JlbmRlckNvbnRyb2xzKHQpLHRoaXMubGFzdFJlbmRlcmVkT2JqZWN0V2l0aENvbnRyb2xzQWJvdmVPdmVybGF5PXRoaXMuX29iamVjdHNbZV0pfX0pO2Zvcih2YXIgbyBpbiBmYWJyaWMuU3RhdGljQ2FudmFzKVwicHJvdG90eXBlXCIhPT1vJiYoZmFicmljLkNhbnZhc1tvXT1mYWJyaWMuU3RhdGljQ2FudmFzW29dKTtmYWJyaWMuaXNUb3VjaFN1cHBvcnRlZCYmKGZhYnJpYy5DYW52YXMucHJvdG90eXBlLl9zZXRDdXJzb3JGcm9tRXZlbnQ9ZnVuY3Rpb24oKXt9KSxmYWJyaWMuRWxlbWVudD1mYWJyaWMuQ2FudmFzfSgpLGZ1bmN0aW9uKCl7dmFyIHQ9e210OjAsdHI6MSxtcjoyLGJyOjMsbWI6NCxibDo1LG1sOjYsdGw6N30sZT1mYWJyaWMudXRpbC5hZGRMaXN0ZW5lcixpPWZhYnJpYy51dGlsLnJlbW92ZUxpc3RlbmVyO2ZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLkNhbnZhcy5wcm90b3R5cGUse2N1cnNvck1hcDpbXCJuLXJlc2l6ZVwiLFwibmUtcmVzaXplXCIsXCJlLXJlc2l6ZVwiLFwic2UtcmVzaXplXCIsXCJzLXJlc2l6ZVwiLFwic3ctcmVzaXplXCIsXCJ3LXJlc2l6ZVwiLFwibnctcmVzaXplXCJdLF9pbml0RXZlbnRMaXN0ZW5lcnM6ZnVuY3Rpb24oKXt0aGlzLl9iaW5kRXZlbnRzKCksZShmYWJyaWMud2luZG93LFwicmVzaXplXCIsdGhpcy5fb25SZXNpemUpLGUodGhpcy51cHBlckNhbnZhc0VsLFwibW91c2Vkb3duXCIsdGhpcy5fb25Nb3VzZURvd24pLGUodGhpcy51cHBlckNhbnZhc0VsLFwibW91c2Vtb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLGUodGhpcy51cHBlckNhbnZhc0VsLFwibW91c2V3aGVlbFwiLHRoaXMuX29uTW91c2VXaGVlbCksZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJ0b3VjaHN0YXJ0XCIsdGhpcy5fb25Nb3VzZURvd24pLGUodGhpcy51cHBlckNhbnZhc0VsLFwidG91Y2htb3ZlXCIsdGhpcy5fb25Nb3VzZU1vdmUpLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBldmVudGpzJiZcImFkZFwiaW4gZXZlbnRqcyYmKGV2ZW50anMuYWRkKHRoaXMudXBwZXJDYW52YXNFbCxcImdlc3R1cmVcIix0aGlzLl9vbkdlc3R1cmUpLGV2ZW50anMuYWRkKHRoaXMudXBwZXJDYW52YXNFbCxcImRyYWdcIix0aGlzLl9vbkRyYWcpLGV2ZW50anMuYWRkKHRoaXMudXBwZXJDYW52YXNFbCxcIm9yaWVudGF0aW9uXCIsdGhpcy5fb25PcmllbnRhdGlvbkNoYW5nZSksZXZlbnRqcy5hZGQodGhpcy51cHBlckNhbnZhc0VsLFwic2hha2VcIix0aGlzLl9vblNoYWtlKSxldmVudGpzLmFkZCh0aGlzLnVwcGVyQ2FudmFzRWwsXCJsb25ncHJlc3NcIix0aGlzLl9vbkxvbmdQcmVzcykpfSxfYmluZEV2ZW50czpmdW5jdGlvbigpe3RoaXMuX29uTW91c2VEb3duPXRoaXMuX29uTW91c2VEb3duLmJpbmQodGhpcyksdGhpcy5fb25Nb3VzZU1vdmU9dGhpcy5fb25Nb3VzZU1vdmUuYmluZCh0aGlzKSx0aGlzLl9vbk1vdXNlVXA9dGhpcy5fb25Nb3VzZVVwLmJpbmQodGhpcyksdGhpcy5fb25SZXNpemU9dGhpcy5fb25SZXNpemUuYmluZCh0aGlzKSx0aGlzLl9vbkdlc3R1cmU9dGhpcy5fb25HZXN0dXJlLmJpbmQodGhpcyksdGhpcy5fb25EcmFnPXRoaXMuX29uRHJhZy5iaW5kKHRoaXMpLHRoaXMuX29uU2hha2U9dGhpcy5fb25TaGFrZS5iaW5kKHRoaXMpLHRoaXMuX29uTG9uZ1ByZXNzPXRoaXMuX29uTG9uZ1ByZXNzLmJpbmQodGhpcyksdGhpcy5fb25PcmllbnRhdGlvbkNoYW5nZT10aGlzLl9vbk9yaWVudGF0aW9uQ2hhbmdlLmJpbmQodGhpcyksdGhpcy5fb25Nb3VzZVdoZWVsPXRoaXMuX29uTW91c2VXaGVlbC5iaW5kKHRoaXMpfSxyZW1vdmVMaXN0ZW5lcnM6ZnVuY3Rpb24oKXtpKGZhYnJpYy53aW5kb3csXCJyZXNpemVcIix0aGlzLl9vblJlc2l6ZSksaSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZWRvd25cIix0aGlzLl9vbk1vdXNlRG93biksaSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZW1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksaSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZXdoZWVsXCIsdGhpcy5fb25Nb3VzZVdoZWVsKSxpKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNoc3RhcnRcIix0aGlzLl9vbk1vdXNlRG93biksaSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJ0b3VjaG1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV2ZW50anMmJlwicmVtb3ZlXCJpbiBldmVudGpzJiYoZXZlbnRqcy5yZW1vdmUodGhpcy51cHBlckNhbnZhc0VsLFwiZ2VzdHVyZVwiLHRoaXMuX29uR2VzdHVyZSksZXZlbnRqcy5yZW1vdmUodGhpcy51cHBlckNhbnZhc0VsLFwiZHJhZ1wiLHRoaXMuX29uRHJhZyksZXZlbnRqcy5yZW1vdmUodGhpcy51cHBlckNhbnZhc0VsLFwib3JpZW50YXRpb25cIix0aGlzLl9vbk9yaWVudGF0aW9uQ2hhbmdlKSxldmVudGpzLnJlbW92ZSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJzaGFrZVwiLHRoaXMuX29uU2hha2UpLGV2ZW50anMucmVtb3ZlKHRoaXMudXBwZXJDYW52YXNFbCxcImxvbmdwcmVzc1wiLHRoaXMuX29uTG9uZ1ByZXNzKSl9LF9vbkdlc3R1cmU6ZnVuY3Rpb24odCxlKXt0aGlzLl9fb25UcmFuc2Zvcm1HZXN0dXJlJiZ0aGlzLl9fb25UcmFuc2Zvcm1HZXN0dXJlKHQsZSl9LF9vbkRyYWc6ZnVuY3Rpb24odCxlKXt0aGlzLl9fb25EcmFnJiZ0aGlzLl9fb25EcmFnKHQsZSl9LF9vbk1vdXNlV2hlZWw6ZnVuY3Rpb24odCxlKXt0aGlzLl9fb25Nb3VzZVdoZWVsJiZ0aGlzLl9fb25Nb3VzZVdoZWVsKHQsZSl9LF9vbk9yaWVudGF0aW9uQ2hhbmdlOmZ1bmN0aW9uKHQsZSl7dGhpcy5fX29uT3JpZW50YXRpb25DaGFuZ2UmJnRoaXMuX19vbk9yaWVudGF0aW9uQ2hhbmdlKHQsZSl9LF9vblNoYWtlOmZ1bmN0aW9uKHQsZSl7dGhpcy5fX29uU2hha2UmJnRoaXMuX19vblNoYWtlKHQsZSl9LF9vbkxvbmdQcmVzczpmdW5jdGlvbih0LGUpe3RoaXMuX19vbkxvbmdQcmVzcyYmdGhpcy5fX29uTG9uZ1ByZXNzKHQsZSl9LF9vbk1vdXNlRG93bjpmdW5jdGlvbih0KXt0aGlzLl9fb25Nb3VzZURvd24odCksZShmYWJyaWMuZG9jdW1lbnQsXCJ0b3VjaGVuZFwiLHRoaXMuX29uTW91c2VVcCksZShmYWJyaWMuZG9jdW1lbnQsXCJ0b3VjaG1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksaSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZW1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksaSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJ0b3VjaG1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSksXCJ0b3VjaHN0YXJ0XCI9PT10LnR5cGU/aSh0aGlzLnVwcGVyQ2FudmFzRWwsXCJtb3VzZWRvd25cIix0aGlzLl9vbk1vdXNlRG93bik6KGUoZmFicmljLmRvY3VtZW50LFwibW91c2V1cFwiLHRoaXMuX29uTW91c2VVcCksZShmYWJyaWMuZG9jdW1lbnQsXCJtb3VzZW1vdmVcIix0aGlzLl9vbk1vdXNlTW92ZSkpfSxfb25Nb3VzZVVwOmZ1bmN0aW9uKHQpe2lmKHRoaXMuX19vbk1vdXNlVXAodCksaShmYWJyaWMuZG9jdW1lbnQsXCJtb3VzZXVwXCIsdGhpcy5fb25Nb3VzZVVwKSxpKGZhYnJpYy5kb2N1bWVudCxcInRvdWNoZW5kXCIsdGhpcy5fb25Nb3VzZVVwKSxpKGZhYnJpYy5kb2N1bWVudCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxpKGZhYnJpYy5kb2N1bWVudCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxlKHRoaXMudXBwZXJDYW52YXNFbCxcIm1vdXNlbW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxlKHRoaXMudXBwZXJDYW52YXNFbCxcInRvdWNobW92ZVwiLHRoaXMuX29uTW91c2VNb3ZlKSxcInRvdWNoZW5kXCI9PT10LnR5cGUpe3ZhciByPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2Uoci51cHBlckNhbnZhc0VsLFwibW91c2Vkb3duXCIsci5fb25Nb3VzZURvd24pfSw0MDApfX0sX29uTW91c2VNb3ZlOmZ1bmN0aW9uKHQpeyF0aGlzLmFsbG93VG91Y2hTY3JvbGxpbmcmJnQucHJldmVudERlZmF1bHQmJnQucHJldmVudERlZmF1bHQoKSx0aGlzLl9fb25Nb3VzZU1vdmUodCl9LF9vblJlc2l6ZTpmdW5jdGlvbigpe3RoaXMuY2FsY09mZnNldCgpfSxfc2hvdWxkUmVuZGVyOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRBY3RpdmVHcm91cCgpfHx0aGlzLmdldEFjdGl2ZU9iamVjdCgpO3JldHVybiEhKHQmJih0LmlzTW92aW5nfHx0IT09aSl8fCF0JiZpfHwhdCYmIWkmJiF0aGlzLl9ncm91cFNlbGVjdG9yfHxlJiZ0aGlzLl9wcmV2aW91c1BvaW50ZXImJnRoaXMuc2VsZWN0aW9uJiYoZS54IT09dGhpcy5fcHJldmlvdXNQb2ludGVyLnh8fGUueSE9PXRoaXMuX3ByZXZpb3VzUG9pbnRlci55KSl9LF9fb25Nb3VzZVVwOmZ1bmN0aW9uKHQpe3ZhciBlO2lmKHRoaXMuaXNEcmF3aW5nTW9kZSYmdGhpcy5faXNDdXJyZW50bHlEcmF3aW5nKXJldHVybiB2b2lkIHRoaXMuX29uTW91c2VVcEluRHJhd2luZ01vZGUodCk7dGhpcy5fY3VycmVudFRyYW5zZm9ybT8odGhpcy5fZmluYWxpemVDdXJyZW50VHJhbnNmb3JtKCksZT10aGlzLl9jdXJyZW50VHJhbnNmb3JtLnRhcmdldCk6ZT10aGlzLmZpbmRUYXJnZXQodCwhMCk7dmFyIGk9dGhpcy5fc2hvdWxkUmVuZGVyKGUsdGhpcy5nZXRQb2ludGVyKHQpKTt0aGlzLl9tYXliZUdyb3VwT2JqZWN0cyh0KSxlJiYoZS5pc01vdmluZz0hMSksaSYmdGhpcy5yZW5kZXJBbGwoKSx0aGlzLl9oYW5kbGVDdXJzb3JBbmRFdmVudCh0LGUpfSxfaGFuZGxlQ3Vyc29yQW5kRXZlbnQ6ZnVuY3Rpb24odCxlKXt0aGlzLl9zZXRDdXJzb3JGcm9tRXZlbnQodCxlKTt2YXIgaT10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXtpLl9zZXRDdXJzb3JGcm9tRXZlbnQodCxlKX0sNTApLHRoaXMuZmlyZShcIm1vdXNlOnVwXCIse3RhcmdldDplLGU6dH0pLGUmJmUuZmlyZShcIm1vdXNldXBcIix7ZTp0fSl9LF9maW5hbGl6ZUN1cnJlbnRUcmFuc2Zvcm06ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9jdXJyZW50VHJhbnNmb3JtLGU9dC50YXJnZXQ7ZS5fc2NhbGluZyYmKGUuX3NjYWxpbmc9ITEpLGUuc2V0Q29vcmRzKCksdGhpcy5zdGF0ZWZ1bCYmZS5oYXNTdGF0ZUNoYW5nZWQoKSYmKHRoaXMuZmlyZShcIm9iamVjdDptb2RpZmllZFwiLHt0YXJnZXQ6ZX0pLGUuZmlyZShcIm1vZGlmaWVkXCIpKSx0aGlzLl9yZXN0b3JlT3JpZ2luWFkoZSl9LF9yZXN0b3JlT3JpZ2luWFk6ZnVuY3Rpb24odCl7aWYodGhpcy5fcHJldmlvdXNPcmlnaW5YJiZ0aGlzLl9wcmV2aW91c09yaWdpblkpe3ZhciBlPXQudHJhbnNsYXRlVG9PcmlnaW5Qb2ludCh0LmdldENlbnRlclBvaW50KCksdGhpcy5fcHJldmlvdXNPcmlnaW5YLHRoaXMuX3ByZXZpb3VzT3JpZ2luWSk7dC5vcmlnaW5YPXRoaXMuX3ByZXZpb3VzT3JpZ2luWCx0Lm9yaWdpblk9dGhpcy5fcHJldmlvdXNPcmlnaW5ZLHQubGVmdD1lLngsdC50b3A9ZS55LHRoaXMuX3ByZXZpb3VzT3JpZ2luWD1udWxsLHRoaXMuX3ByZXZpb3VzT3JpZ2luWT1udWxsfX0sX29uTW91c2VEb3duSW5EcmF3aW5nTW9kZTpmdW5jdGlvbih0KXt0aGlzLl9pc0N1cnJlbnRseURyYXdpbmc9ITAsdGhpcy5kaXNjYXJkQWN0aXZlT2JqZWN0KHQpLnJlbmRlckFsbCgpLHRoaXMuY2xpcFRvJiZmYWJyaWMudXRpbC5jbGlwQ29udGV4dCh0aGlzLHRoaXMuY29udGV4dFRvcCk7dmFyIGU9ZmFicmljLnV0aWwuaW52ZXJ0VHJhbnNmb3JtKHRoaXMudmlld3BvcnRUcmFuc2Zvcm0pLGk9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQodGhpcy5nZXRQb2ludGVyKHQsITApLGUpO3RoaXMuZnJlZURyYXdpbmdCcnVzaC5vbk1vdXNlRG93bihpKSx0aGlzLmZpcmUoXCJtb3VzZTpkb3duXCIse2U6dH0pO3ZhciByPXRoaXMuZmluZFRhcmdldCh0KTtcInVuZGVmaW5lZFwiIT10eXBlb2YgciYmci5maXJlKFwibW91c2Vkb3duXCIse2U6dCx0YXJnZXQ6cn0pfSxfb25Nb3VzZU1vdmVJbkRyYXdpbmdNb2RlOmZ1bmN0aW9uKHQpe2lmKHRoaXMuX2lzQ3VycmVudGx5RHJhd2luZyl7dmFyIGU9ZmFicmljLnV0aWwuaW52ZXJ0VHJhbnNmb3JtKHRoaXMudmlld3BvcnRUcmFuc2Zvcm0pLGk9ZmFicmljLnV0aWwudHJhbnNmb3JtUG9pbnQodGhpcy5nZXRQb2ludGVyKHQsITApLGUpO3RoaXMuZnJlZURyYXdpbmdCcnVzaC5vbk1vdXNlTW92ZShpKX10aGlzLnNldEN1cnNvcih0aGlzLmZyZWVEcmF3aW5nQ3Vyc29yKSx0aGlzLmZpcmUoXCJtb3VzZTptb3ZlXCIse2U6dH0pO3ZhciByPXRoaXMuZmluZFRhcmdldCh0KTtcInVuZGVmaW5lZFwiIT10eXBlb2YgciYmci5maXJlKFwibW91c2Vtb3ZlXCIse2U6dCx0YXJnZXQ6cn0pfSxfb25Nb3VzZVVwSW5EcmF3aW5nTW9kZTpmdW5jdGlvbih0KXt0aGlzLl9pc0N1cnJlbnRseURyYXdpbmc9ITEsdGhpcy5jbGlwVG8mJnRoaXMuY29udGV4dFRvcC5yZXN0b3JlKCksdGhpcy5mcmVlRHJhd2luZ0JydXNoLm9uTW91c2VVcCgpLHRoaXMuZmlyZShcIm1vdXNlOnVwXCIse2U6dH0pO3ZhciBlPXRoaXMuZmluZFRhcmdldCh0KTtcInVuZGVmaW5lZFwiIT10eXBlb2YgZSYmZS5maXJlKFwibW91c2V1cFwiLHtlOnQsdGFyZ2V0OmV9KX0sX19vbk1vdXNlRG93bjpmdW5jdGlvbih0KXt2YXIgZT1cIndoaWNoXCJpbiB0PzE9PT10LndoaWNoOjE9PT10LmJ1dHRvbjtpZihlfHxmYWJyaWMuaXNUb3VjaFN1cHBvcnRlZCl7aWYodGhpcy5pc0RyYXdpbmdNb2RlKXJldHVybiB2b2lkIHRoaXMuX29uTW91c2VEb3duSW5EcmF3aW5nTW9kZSh0KTtpZighdGhpcy5fY3VycmVudFRyYW5zZm9ybSl7dmFyIGk9dGhpcy5maW5kVGFyZ2V0KHQpLHI9dGhpcy5nZXRQb2ludGVyKHQsITApO3RoaXMuX3ByZXZpb3VzUG9pbnRlcj1yO3ZhciBzPXRoaXMuX3Nob3VsZFJlbmRlcihpLHIpLG49dGhpcy5fc2hvdWxkR3JvdXAodCxpKTt0aGlzLl9zaG91bGRDbGVhclNlbGVjdGlvbih0LGkpP3RoaXMuX2NsZWFyU2VsZWN0aW9uKHQsaSxyKTpuJiYodGhpcy5faGFuZGxlR3JvdXBpbmcodCxpKSxpPXRoaXMuZ2V0QWN0aXZlR3JvdXAoKSksaSYmaS5zZWxlY3RhYmxlJiYhbiYmKHRoaXMuX2JlZm9yZVRyYW5zZm9ybSh0LGkpLHRoaXMuX3NldHVwQ3VycmVudFRyYW5zZm9ybSh0LGkpKSxzJiZ0aGlzLnJlbmRlckFsbCgpLHRoaXMuZmlyZShcIm1vdXNlOmRvd25cIix7dGFyZ2V0OmksZTp0fSksaSYmaS5maXJlKFwibW91c2Vkb3duXCIse2U6dH0pfX19LF9iZWZvcmVUcmFuc2Zvcm06ZnVuY3Rpb24odCxlKXt0aGlzLnN0YXRlZnVsJiZlLnNhdmVTdGF0ZSgpLGUuX2ZpbmRUYXJnZXRDb3JuZXIodGhpcy5nZXRQb2ludGVyKHQpKSYmdGhpcy5vbkJlZm9yZVNjYWxlUm90YXRlKGUpLGUhPT10aGlzLmdldEFjdGl2ZUdyb3VwKCkmJmUhPT10aGlzLmdldEFjdGl2ZU9iamVjdCgpJiYodGhpcy5kZWFjdGl2YXRlQWxsKCksdGhpcy5zZXRBY3RpdmVPYmplY3QoZSx0KSl9LF9jbGVhclNlbGVjdGlvbjpmdW5jdGlvbih0LGUsaSl7dGhpcy5kZWFjdGl2YXRlQWxsV2l0aERpc3BhdGNoKHQpLGUmJmUuc2VsZWN0YWJsZT90aGlzLnNldEFjdGl2ZU9iamVjdChlLHQpOnRoaXMuc2VsZWN0aW9uJiYodGhpcy5fZ3JvdXBTZWxlY3Rvcj17ZXg6aS54LGV5OmkueSx0b3A6MCxsZWZ0OjB9KX0sX3NldE9yaWdpblRvQ2VudGVyOmZ1bmN0aW9uKHQpe3RoaXMuX3ByZXZpb3VzT3JpZ2luWD10aGlzLl9jdXJyZW50VHJhbnNmb3JtLnRhcmdldC5vcmlnaW5YLHRoaXMuX3ByZXZpb3VzT3JpZ2luWT10aGlzLl9jdXJyZW50VHJhbnNmb3JtLnRhcmdldC5vcmlnaW5ZO3ZhciBlPXQuZ2V0Q2VudGVyUG9pbnQoKTt0Lm9yaWdpblg9XCJjZW50ZXJcIix0Lm9yaWdpblk9XCJjZW50ZXJcIix0LmxlZnQ9ZS54LHQudG9wPWUueSx0aGlzLl9jdXJyZW50VHJhbnNmb3JtLmxlZnQ9dC5sZWZ0LHRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0udG9wPXQudG9wfSxfc2V0Q2VudGVyVG9PcmlnaW46ZnVuY3Rpb24odCl7dmFyIGU9dC50cmFuc2xhdGVUb09yaWdpblBvaW50KHQuZ2V0Q2VudGVyUG9pbnQoKSx0aGlzLl9wcmV2aW91c09yaWdpblgsdGhpcy5fcHJldmlvdXNPcmlnaW5ZKTt0Lm9yaWdpblg9dGhpcy5fcHJldmlvdXNPcmlnaW5YLHQub3JpZ2luWT10aGlzLl9wcmV2aW91c09yaWdpblksdC5sZWZ0PWUueCx0LnRvcD1lLnksdGhpcy5fcHJldmlvdXNPcmlnaW5YPW51bGwsdGhpcy5fcHJldmlvdXNPcmlnaW5ZPW51bGx9LF9fb25Nb3VzZU1vdmU6ZnVuY3Rpb24odCl7dmFyIGUsaTtpZih0aGlzLmlzRHJhd2luZ01vZGUpcmV0dXJuIHZvaWQgdGhpcy5fb25Nb3VzZU1vdmVJbkRyYXdpbmdNb2RlKHQpO2lmKCEoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHQudG91Y2hlcyYmdC50b3VjaGVzLmxlbmd0aD4xKSl7dmFyIHI9dGhpcy5fZ3JvdXBTZWxlY3RvcjtyPyhpPXRoaXMuZ2V0UG9pbnRlcih0LCEwKSxyLmxlZnQ9aS54LXIuZXgsci50b3A9aS55LXIuZXksdGhpcy5yZW5kZXJUb3AoKSk6dGhpcy5fY3VycmVudFRyYW5zZm9ybT90aGlzLl90cmFuc2Zvcm1PYmplY3QodCk6KGU9dGhpcy5maW5kVGFyZ2V0KHQpLCFlfHxlJiYhZS5zZWxlY3RhYmxlP3RoaXMuc2V0Q3Vyc29yKHRoaXMuZGVmYXVsdEN1cnNvcik6dGhpcy5fc2V0Q3Vyc29yRnJvbUV2ZW50KHQsZSkpLHRoaXMuZmlyZShcIm1vdXNlOm1vdmVcIix7dGFyZ2V0OmUsZTp0fSksZSYmZS5maXJlKFwibW91c2Vtb3ZlXCIse2U6dH0pfX0sX3RyYW5zZm9ybU9iamVjdDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFBvaW50ZXIodCksaT10aGlzLl9jdXJyZW50VHJhbnNmb3JtO2kucmVzZXQ9ITEsaS50YXJnZXQuaXNNb3Zpbmc9ITAsdGhpcy5fYmVmb3JlU2NhbGVUcmFuc2Zvcm0odCxpKSx0aGlzLl9wZXJmb3JtVHJhbnNmb3JtQWN0aW9uKHQsaSxlKSx0aGlzLnJlbmRlckFsbCgpfSxfcGVyZm9ybVRyYW5zZm9ybUFjdGlvbjpmdW5jdGlvbih0LGUsaSl7dmFyIHI9aS54LHM9aS55LG49ZS50YXJnZXQsbz1lLmFjdGlvbjtcInJvdGF0ZVwiPT09bz8odGhpcy5fcm90YXRlT2JqZWN0KHIscyksdGhpcy5fZmlyZShcInJvdGF0aW5nXCIsbix0KSk6XCJzY2FsZVwiPT09bz8odGhpcy5fb25TY2FsZSh0LGUscixzKSx0aGlzLl9maXJlKFwic2NhbGluZ1wiLG4sdCkpOlwic2NhbGVYXCI9PT1vPyh0aGlzLl9zY2FsZU9iamVjdChyLHMsXCJ4XCIpLHRoaXMuX2ZpcmUoXCJzY2FsaW5nXCIsbix0KSk6XCJzY2FsZVlcIj09PW8/KHRoaXMuX3NjYWxlT2JqZWN0KHIscyxcInlcIiksdGhpcy5fZmlyZShcInNjYWxpbmdcIixuLHQpKToodGhpcy5fdHJhbnNsYXRlT2JqZWN0KHIscyksdGhpcy5fZmlyZShcIm1vdmluZ1wiLG4sdCksdGhpcy5zZXRDdXJzb3IodGhpcy5tb3ZlQ3Vyc29yKSl9LF9maXJlOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLmZpcmUoXCJvYmplY3Q6XCIrdCx7dGFyZ2V0OmUsZTppfSksZS5maXJlKHQse2U6aX0pfSxfYmVmb3JlU2NhbGVUcmFuc2Zvcm06ZnVuY3Rpb24odCxlKXtpZihcInNjYWxlXCI9PT1lLmFjdGlvbnx8XCJzY2FsZVhcIj09PWUuYWN0aW9ufHxcInNjYWxlWVwiPT09ZS5hY3Rpb24pe3ZhciBpPXRoaXMuX3Nob3VsZENlbnRlclRyYW5zZm9ybSh0LGUudGFyZ2V0KTsoaSYmKFwiY2VudGVyXCIhPT1lLm9yaWdpblh8fFwiY2VudGVyXCIhPT1lLm9yaWdpblkpfHwhaSYmXCJjZW50ZXJcIj09PWUub3JpZ2luWCYmXCJjZW50ZXJcIj09PWUub3JpZ2luWSkmJih0aGlzLl9yZXNldEN1cnJlbnRUcmFuc2Zvcm0odCksZS5yZXNldD0hMCl9fSxfb25TY2FsZTpmdW5jdGlvbih0LGUsaSxyKXshdC5zaGlmdEtleSYmIXRoaXMudW5pU2NhbGVUcmFuc2Zvcm18fGUudGFyZ2V0LmdldChcImxvY2tVbmlTY2FsaW5nXCIpPyhlLnJlc2V0fHxcInNjYWxlXCIhPT1lLmN1cnJlbnRBY3Rpb258fHRoaXMuX3Jlc2V0Q3VycmVudFRyYW5zZm9ybSh0LGUudGFyZ2V0KSxlLmN1cnJlbnRBY3Rpb249XCJzY2FsZUVxdWFsbHlcIix0aGlzLl9zY2FsZU9iamVjdChpLHIsXCJlcXVhbGx5XCIpKTooZS5jdXJyZW50QWN0aW9uPVwic2NhbGVcIix0aGlzLl9zY2FsZU9iamVjdChpLHIpKTtcclxuXHJcbn0sX3NldEN1cnNvckZyb21FdmVudDpmdW5jdGlvbih0LGUpe2lmKCFlfHwhZS5zZWxlY3RhYmxlKXJldHVybiB0aGlzLnNldEN1cnNvcih0aGlzLmRlZmF1bHRDdXJzb3IpLCExO3ZhciBpPXRoaXMuZ2V0QWN0aXZlR3JvdXAoKSxyPWUuX2ZpbmRUYXJnZXRDb3JuZXImJighaXx8IWkuY29udGFpbnMoZSkpJiZlLl9maW5kVGFyZ2V0Q29ybmVyKHRoaXMuZ2V0UG9pbnRlcih0LCEwKSk7cmV0dXJuIHI/dGhpcy5fc2V0Q29ybmVyQ3Vyc29yKHIsZSk6dGhpcy5zZXRDdXJzb3IoZS5ob3ZlckN1cnNvcnx8dGhpcy5ob3ZlckN1cnNvciksITB9LF9zZXRDb3JuZXJDdXJzb3I6ZnVuY3Rpb24oZSxpKXtpZihlIGluIHQpdGhpcy5zZXRDdXJzb3IodGhpcy5fZ2V0Um90YXRlZENvcm5lckN1cnNvcihlLGkpKTtlbHNle2lmKFwibXRyXCIhPT1lfHwhaS5oYXNSb3RhdGluZ1BvaW50KXJldHVybiB0aGlzLnNldEN1cnNvcih0aGlzLmRlZmF1bHRDdXJzb3IpLCExO3RoaXMuc2V0Q3Vyc29yKHRoaXMucm90YXRpb25DdXJzb3IpfX0sX2dldFJvdGF0ZWRDb3JuZXJDdXJzb3I6ZnVuY3Rpb24oZSxpKXt2YXIgcj1NYXRoLnJvdW5kKGkuZ2V0QW5nbGUoKSUzNjAvNDUpO3JldHVybiAwPnImJihyKz04KSxyKz10W2VdLHIlPTgsdGhpcy5jdXJzb3JNYXBbcl19fSl9KCksZnVuY3Rpb24oKXt2YXIgdD1NYXRoLm1pbixlPU1hdGgubWF4O2ZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLkNhbnZhcy5wcm90b3R5cGUse19zaG91bGRHcm91cDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuZ2V0QWN0aXZlT2JqZWN0KCk7cmV0dXJuIHQuc2hpZnRLZXkmJih0aGlzLmdldEFjdGl2ZUdyb3VwKCl8fGkmJmkhPT1lKSYmdGhpcy5zZWxlY3Rpb259LF9oYW5kbGVHcm91cGluZzpmdW5jdGlvbih0LGUpeyhlIT09dGhpcy5nZXRBY3RpdmVHcm91cCgpfHwoZT10aGlzLmZpbmRUYXJnZXQodCwhMCksZSYmIWUuaXNUeXBlKFwiZ3JvdXBcIikpKSYmKHRoaXMuZ2V0QWN0aXZlR3JvdXAoKT90aGlzLl91cGRhdGVBY3RpdmVHcm91cChlLHQpOnRoaXMuX2NyZWF0ZUFjdGl2ZUdyb3VwKGUsdCksdGhpcy5fYWN0aXZlR3JvdXAmJnRoaXMuX2FjdGl2ZUdyb3VwLnNhdmVDb29yZHMoKSl9LF91cGRhdGVBY3RpdmVHcm91cDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuZ2V0QWN0aXZlR3JvdXAoKTtpZihpLmNvbnRhaW5zKHQpKXtpZihpLnJlbW92ZVdpdGhVcGRhdGUodCksdGhpcy5fcmVzZXRPYmplY3RUcmFuc2Zvcm0oaSksdC5zZXQoXCJhY3RpdmVcIiwhMSksMT09PWkuc2l6ZSgpKXJldHVybiB0aGlzLmRpc2NhcmRBY3RpdmVHcm91cChlKSx2b2lkIHRoaXMuc2V0QWN0aXZlT2JqZWN0KGkuaXRlbSgwKSl9ZWxzZSBpLmFkZFdpdGhVcGRhdGUodCksdGhpcy5fcmVzZXRPYmplY3RUcmFuc2Zvcm0oaSk7dGhpcy5maXJlKFwic2VsZWN0aW9uOmNyZWF0ZWRcIix7dGFyZ2V0OmksZTplfSksaS5zZXQoXCJhY3RpdmVcIiwhMCl9LF9jcmVhdGVBY3RpdmVHcm91cDpmdW5jdGlvbih0LGUpe2lmKHRoaXMuX2FjdGl2ZU9iamVjdCYmdCE9PXRoaXMuX2FjdGl2ZU9iamVjdCl7dmFyIGk9dGhpcy5fY3JlYXRlR3JvdXAodCk7aS5hZGRXaXRoVXBkYXRlKCksdGhpcy5zZXRBY3RpdmVHcm91cChpKSx0aGlzLl9hY3RpdmVPYmplY3Q9bnVsbCx0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y3JlYXRlZFwiLHt0YXJnZXQ6aSxlOmV9KX10LnNldChcImFjdGl2ZVwiLCEwKX0sX2NyZWF0ZUdyb3VwOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0T2JqZWN0cygpLGk9ZS5pbmRleE9mKHRoaXMuX2FjdGl2ZU9iamVjdCk8ZS5pbmRleE9mKHQpLHI9aT9bdGhpcy5fYWN0aXZlT2JqZWN0LHRdOlt0LHRoaXMuX2FjdGl2ZU9iamVjdF07cmV0dXJuIG5ldyBmYWJyaWMuR3JvdXAocix7Y2FudmFzOnRoaXN9KX0sX2dyb3VwU2VsZWN0ZWRPYmplY3RzOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2NvbGxlY3RPYmplY3RzKCk7MT09PWUubGVuZ3RoP3RoaXMuc2V0QWN0aXZlT2JqZWN0KGVbMF0sdCk6ZS5sZW5ndGg+MSYmKGU9bmV3IGZhYnJpYy5Hcm91cChlLnJldmVyc2UoKSx7Y2FudmFzOnRoaXN9KSxlLmFkZFdpdGhVcGRhdGUoKSx0aGlzLnNldEFjdGl2ZUdyb3VwKGUsdCksZS5zYXZlQ29vcmRzKCksdGhpcy5maXJlKFwic2VsZWN0aW9uOmNyZWF0ZWRcIix7dGFyZ2V0OmV9KSx0aGlzLnJlbmRlckFsbCgpKX0sX2NvbGxlY3RPYmplY3RzOmZ1bmN0aW9uKCl7Zm9yKHZhciBpLHI9W10scz10aGlzLl9ncm91cFNlbGVjdG9yLmV4LG49dGhpcy5fZ3JvdXBTZWxlY3Rvci5leSxvPXMrdGhpcy5fZ3JvdXBTZWxlY3Rvci5sZWZ0LGE9bit0aGlzLl9ncm91cFNlbGVjdG9yLnRvcCxoPW5ldyBmYWJyaWMuUG9pbnQodChzLG8pLHQobixhKSksYz1uZXcgZmFicmljLlBvaW50KGUocyxvKSxlKG4sYSkpLGw9cz09PW8mJm49PT1hLHU9dGhpcy5fb2JqZWN0cy5sZW5ndGg7dS0tJiYoaT10aGlzLl9vYmplY3RzW3VdLCEoaSYmaS5zZWxlY3RhYmxlJiZpLnZpc2libGUmJihpLmludGVyc2VjdHNXaXRoUmVjdChoLGMpfHxpLmlzQ29udGFpbmVkV2l0aGluUmVjdChoLGMpfHxpLmNvbnRhaW5zUG9pbnQoaCl8fGkuY29udGFpbnNQb2ludChjKSkmJihpLnNldChcImFjdGl2ZVwiLCEwKSxyLnB1c2goaSksbCkpKTspO3JldHVybiByfSxfbWF5YmVHcm91cE9iamVjdHM6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb24mJnRoaXMuX2dyb3VwU2VsZWN0b3ImJnRoaXMuX2dyb3VwU2VsZWN0ZWRPYmplY3RzKHQpO3ZhciBlPXRoaXMuZ2V0QWN0aXZlR3JvdXAoKTtlJiYoZS5zZXRPYmplY3RzQ29vcmRzKCkuc2V0Q29vcmRzKCksZS5pc01vdmluZz0hMSx0aGlzLnNldEN1cnNvcih0aGlzLmRlZmF1bHRDdXJzb3IpKSx0aGlzLl9ncm91cFNlbGVjdG9yPW51bGwsdGhpcy5fY3VycmVudFRyYW5zZm9ybT1udWxsfX0pfSgpLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUse3RvRGF0YVVSTDpmdW5jdGlvbih0KXt0fHwodD17fSk7dmFyIGU9dC5mb3JtYXR8fFwicG5nXCIsaT10LnF1YWxpdHl8fDEscj10Lm11bHRpcGxpZXJ8fDEscz17bGVmdDp0LmxlZnQsdG9wOnQudG9wLHdpZHRoOnQud2lkdGgsaGVpZ2h0OnQuaGVpZ2h0fTtyZXR1cm4gMSE9PXI/dGhpcy5fX3RvRGF0YVVSTFdpdGhNdWx0aXBsaWVyKGUsaSxzLHIpOnRoaXMuX190b0RhdGFVUkwoZSxpLHMpfSxfX3RvRGF0YVVSTDpmdW5jdGlvbih0LGUsaSl7dGhpcy5yZW5kZXJBbGwoITApO3ZhciByPXRoaXMudXBwZXJDYW52YXNFbHx8dGhpcy5sb3dlckNhbnZhc0VsLHM9dGhpcy5fX2dldENyb3BwZWRDYW52YXMocixpKTtcImpwZ1wiPT09dCYmKHQ9XCJqcGVnXCIpO3ZhciBuPWZhYnJpYy5TdGF0aWNDYW52YXMuc3VwcG9ydHMoXCJ0b0RhdGFVUkxXaXRoUXVhbGl0eVwiKT8oc3x8cikudG9EYXRhVVJMKFwiaW1hZ2UvXCIrdCxlKTooc3x8cikudG9EYXRhVVJMKFwiaW1hZ2UvXCIrdCk7cmV0dXJuIHRoaXMuY29udGV4dFRvcCYmdGhpcy5jbGVhckNvbnRleHQodGhpcy5jb250ZXh0VG9wKSx0aGlzLnJlbmRlckFsbCgpLHMmJihzPW51bGwpLG59LF9fZ2V0Q3JvcHBlZENhbnZhczpmdW5jdGlvbih0LGUpe3ZhciBpLHIscz1cImxlZnRcImluIGV8fFwidG9wXCJpbiBlfHxcIndpZHRoXCJpbiBlfHxcImhlaWdodFwiaW4gZTtyZXR1cm4gcyYmKGk9ZmFicmljLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpLHI9aS5nZXRDb250ZXh0KFwiMmRcIiksaS53aWR0aD1lLndpZHRofHx0aGlzLndpZHRoLGkuaGVpZ2h0PWUuaGVpZ2h0fHx0aGlzLmhlaWdodCxyLmRyYXdJbWFnZSh0LC1lLmxlZnR8fDAsLWUudG9wfHwwKSksaX0sX190b0RhdGFVUkxXaXRoTXVsdGlwbGllcjpmdW5jdGlvbih0LGUsaSxyKXt2YXIgcz10aGlzLmdldFdpZHRoKCksbj10aGlzLmdldEhlaWdodCgpLG89cypyLGE9bipyLGg9dGhpcy5nZXRBY3RpdmVPYmplY3QoKSxjPXRoaXMuZ2V0QWN0aXZlR3JvdXAoKSxsPXRoaXMuY29udGV4dFRvcHx8dGhpcy5jb250ZXh0Q29udGFpbmVyO3I+MSYmdGhpcy5zZXRXaWR0aChvKS5zZXRIZWlnaHQoYSksbC5zY2FsZShyLHIpLGkubGVmdCYmKGkubGVmdCo9ciksaS50b3AmJihpLnRvcCo9ciksaS53aWR0aD9pLndpZHRoKj1yOjE+ciYmKGkud2lkdGg9byksaS5oZWlnaHQ/aS5oZWlnaHQqPXI6MT5yJiYoaS5oZWlnaHQ9YSksYz90aGlzLl90ZW1wUmVtb3ZlQm9yZGVyc0NvbnRyb2xzRnJvbUdyb3VwKGMpOmgmJnRoaXMuZGVhY3RpdmF0ZUFsbCYmdGhpcy5kZWFjdGl2YXRlQWxsKCksdGhpcy5yZW5kZXJBbGwoITApO3ZhciB1PXRoaXMuX190b0RhdGFVUkwodCxlLGkpO3JldHVybiB0aGlzLndpZHRoPXMsdGhpcy5oZWlnaHQ9bixsLnNjYWxlKDEvciwxL3IpLHRoaXMuc2V0V2lkdGgocykuc2V0SGVpZ2h0KG4pLGM/dGhpcy5fcmVzdG9yZUJvcmRlcnNDb250cm9sc09uR3JvdXAoYyk6aCYmdGhpcy5zZXRBY3RpdmVPYmplY3QmJnRoaXMuc2V0QWN0aXZlT2JqZWN0KGgpLHRoaXMuY29udGV4dFRvcCYmdGhpcy5jbGVhckNvbnRleHQodGhpcy5jb250ZXh0VG9wKSx0aGlzLnJlbmRlckFsbCgpLHV9LHRvRGF0YVVSTFdpdGhNdWx0aXBsaWVyOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy50b0RhdGFVUkwoe2Zvcm1hdDp0LG11bHRpcGxpZXI6ZSxxdWFsaXR5Oml9KX0sX3RlbXBSZW1vdmVCb3JkZXJzQ29udHJvbHNGcm9tR3JvdXA6ZnVuY3Rpb24odCl7dC5vcmlnSGFzQ29udHJvbHM9dC5oYXNDb250cm9scyx0Lm9yaWdCb3JkZXJDb2xvcj10LmJvcmRlckNvbG9yLHQuaGFzQ29udHJvbHM9ITAsdC5ib3JkZXJDb2xvcj1cInJnYmEoMCwwLDAsMClcIix0LmZvckVhY2hPYmplY3QoZnVuY3Rpb24odCl7dC5vcmlnQm9yZGVyQ29sb3I9dC5ib3JkZXJDb2xvcix0LmJvcmRlckNvbG9yPVwicmdiYSgwLDAsMCwwKVwifSl9LF9yZXN0b3JlQm9yZGVyc0NvbnRyb2xzT25Hcm91cDpmdW5jdGlvbih0KXt0LmhpZGVDb250cm9scz10Lm9yaWdIaWRlQ29udHJvbHMsdC5ib3JkZXJDb2xvcj10Lm9yaWdCb3JkZXJDb2xvcix0LmZvckVhY2hPYmplY3QoZnVuY3Rpb24odCl7dC5ib3JkZXJDb2xvcj10Lm9yaWdCb3JkZXJDb2xvcixkZWxldGUgdC5vcmlnQm9yZGVyQ29sb3J9KX19KSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLHtsb2FkRnJvbURhdGFsZXNzSlNPTjpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMubG9hZEZyb21KU09OKHQsZSxpKX0sbG9hZEZyb21KU09OOmZ1bmN0aW9uKHQsZSxpKXtpZih0KXt2YXIgcj1cInN0cmluZ1wiPT10eXBlb2YgdD9KU09OLnBhcnNlKHQpOnQ7dGhpcy5jbGVhcigpO3ZhciBzPXRoaXM7cmV0dXJuIHRoaXMuX2VubGl2ZW5PYmplY3RzKHIub2JqZWN0cyxmdW5jdGlvbigpe3MuX3NldEJnT3ZlcmxheShyLGUpfSxpKSx0aGlzfX0sX3NldEJnT3ZlcmxheTpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMscj17YmFja2dyb3VuZENvbG9yOiExLG92ZXJsYXlDb2xvcjohMSxiYWNrZ3JvdW5kSW1hZ2U6ITEsb3ZlcmxheUltYWdlOiExfTtpZighKHQuYmFja2dyb3VuZEltYWdlfHx0Lm92ZXJsYXlJbWFnZXx8dC5iYWNrZ3JvdW5kfHx0Lm92ZXJsYXkpKXJldHVybiB2b2lkKGUmJmUoKSk7dmFyIHM9ZnVuY3Rpb24oKXtyLmJhY2tncm91bmRJbWFnZSYmci5vdmVybGF5SW1hZ2UmJnIuYmFja2dyb3VuZENvbG9yJiZyLm92ZXJsYXlDb2xvciYmKGkucmVuZGVyQWxsKCksZSYmZSgpKX07dGhpcy5fX3NldEJnT3ZlcmxheShcImJhY2tncm91bmRJbWFnZVwiLHQuYmFja2dyb3VuZEltYWdlLHIscyksdGhpcy5fX3NldEJnT3ZlcmxheShcIm92ZXJsYXlJbWFnZVwiLHQub3ZlcmxheUltYWdlLHIscyksdGhpcy5fX3NldEJnT3ZlcmxheShcImJhY2tncm91bmRDb2xvclwiLHQuYmFja2dyb3VuZCxyLHMpLHRoaXMuX19zZXRCZ092ZXJsYXkoXCJvdmVybGF5Q29sb3JcIix0Lm92ZXJsYXkscixzKSxzKCl9LF9fc2V0QmdPdmVybGF5OmZ1bmN0aW9uKHQsZSxpLHIpe3ZhciBzPXRoaXM7cmV0dXJuIGU/dm9pZChcImJhY2tncm91bmRJbWFnZVwiPT09dHx8XCJvdmVybGF5SW1hZ2VcIj09PXQ/ZmFicmljLkltYWdlLmZyb21PYmplY3QoZSxmdW5jdGlvbihlKXtzW3RdPWUsaVt0XT0hMCxyJiZyKCl9KTp0aGlzW1wic2V0XCIrZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUodCwhMCldKGUsZnVuY3Rpb24oKXtpW3RdPSEwLHImJnIoKX0pKTp2b2lkKGlbdF09ITApfSxfZW5saXZlbk9iamVjdHM6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXM7aWYoIXR8fDA9PT10Lmxlbmd0aClyZXR1cm4gdm9pZChlJiZlKCkpO3ZhciBzPXRoaXMucmVuZGVyT25BZGRSZW1vdmU7dGhpcy5yZW5kZXJPbkFkZFJlbW92ZT0hMSxmYWJyaWMudXRpbC5lbmxpdmVuT2JqZWN0cyh0LGZ1bmN0aW9uKHQpe3QuZm9yRWFjaChmdW5jdGlvbih0LGUpe3IuaW5zZXJ0QXQodCxlLCEwKX0pLHIucmVuZGVyT25BZGRSZW1vdmU9cyxlJiZlKCl9LG51bGwsaSl9LF90b0RhdGFVUkw6ZnVuY3Rpb24odCxlKXt0aGlzLmNsb25lKGZ1bmN0aW9uKGkpe2UoaS50b0RhdGFVUkwodCkpfSl9LF90b0RhdGFVUkxXaXRoTXVsdGlwbGllcjpmdW5jdGlvbih0LGUsaSl7dGhpcy5jbG9uZShmdW5jdGlvbihyKXtpKHIudG9EYXRhVVJMV2l0aE11bHRpcGxpZXIodCxlKSl9KX0sY2xvbmU6ZnVuY3Rpb24odCxlKXt2YXIgaT1KU09OLnN0cmluZ2lmeSh0aGlzLnRvSlNPTihlKSk7dGhpcy5jbG9uZVdpdGhvdXREYXRhKGZ1bmN0aW9uKGUpe2UubG9hZEZyb21KU09OKGksZnVuY3Rpb24oKXt0JiZ0KGUpfSl9KX0sY2xvbmVXaXRob3V0RGF0YTpmdW5jdGlvbih0KXt2YXIgZT1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtlLndpZHRoPXRoaXMuZ2V0V2lkdGgoKSxlLmhlaWdodD10aGlzLmdldEhlaWdodCgpO3ZhciBpPW5ldyBmYWJyaWMuQ2FudmFzKGUpO2kuY2xpcFRvPXRoaXMuY2xpcFRvLHRoaXMuYmFja2dyb3VuZEltYWdlPyhpLnNldEJhY2tncm91bmRJbWFnZSh0aGlzLmJhY2tncm91bmRJbWFnZS5zcmMsZnVuY3Rpb24oKXtpLnJlbmRlckFsbCgpLHQmJnQoaSl9KSxpLmJhY2tncm91bmRJbWFnZU9wYWNpdHk9dGhpcy5iYWNrZ3JvdW5kSW1hZ2VPcGFjaXR5LGkuYmFja2dyb3VuZEltYWdlU3RyZXRjaD10aGlzLmJhY2tncm91bmRJbWFnZVN0cmV0Y2gpOnQmJnQoaSl9fSksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZCxyPWUudXRpbC50b0ZpeGVkLHM9ZS51dGlsLnN0cmluZy5jYXBpdGFsaXplLG49ZS51dGlsLmRlZ3JlZXNUb1JhZGlhbnMsbz1lLlN0YXRpY0NhbnZhcy5zdXBwb3J0cyhcInNldExpbmVEYXNoXCIpO2UuT2JqZWN0fHwoZS5PYmplY3Q9ZS51dGlsLmNyZWF0ZUNsYXNzKHt0eXBlOlwib2JqZWN0XCIsb3JpZ2luWDpcImxlZnRcIixvcmlnaW5ZOlwidG9wXCIsdG9wOjAsbGVmdDowLHdpZHRoOjAsaGVpZ2h0OjAsc2NhbGVYOjEsc2NhbGVZOjEsZmxpcFg6ITEsZmxpcFk6ITEsb3BhY2l0eToxLGFuZ2xlOjAsY29ybmVyU2l6ZToxMix0cmFuc3BhcmVudENvcm5lcnM6ITAsaG92ZXJDdXJzb3I6bnVsbCxwYWRkaW5nOjAsYm9yZGVyQ29sb3I6XCJyZ2JhKDEwMiwxNTMsMjU1LDAuNzUpXCIsY29ybmVyQ29sb3I6XCJyZ2JhKDEwMiwxNTMsMjU1LDAuNSlcIixjZW50ZXJlZFNjYWxpbmc6ITEsY2VudGVyZWRSb3RhdGlvbjohMCxmaWxsOlwicmdiKDAsMCwwKVwiLGZpbGxSdWxlOlwibm9uemVyb1wiLGdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbjpcInNvdXJjZS1vdmVyXCIsYmFja2dyb3VuZENvbG9yOlwiXCIsc3Ryb2tlOm51bGwsc3Ryb2tlV2lkdGg6MSxzdHJva2VEYXNoQXJyYXk6bnVsbCxzdHJva2VMaW5lQ2FwOlwiYnV0dFwiLHN0cm9rZUxpbmVKb2luOlwibWl0ZXJcIixzdHJva2VNaXRlckxpbWl0OjEwLHNoYWRvdzpudWxsLGJvcmRlck9wYWNpdHlXaGVuTW92aW5nOi40LGJvcmRlclNjYWxlRmFjdG9yOjEsdHJhbnNmb3JtTWF0cml4Om51bGwsbWluU2NhbGVMaW1pdDouMDEsc2VsZWN0YWJsZTohMCxldmVudGVkOiEwLHZpc2libGU6ITAsaGFzQ29udHJvbHM6ITAsaGFzQm9yZGVyczohMCxoYXNSb3RhdGluZ1BvaW50OiEwLHJvdGF0aW5nUG9pbnRPZmZzZXQ6NDAscGVyUGl4ZWxUYXJnZXRGaW5kOiExLGluY2x1ZGVEZWZhdWx0VmFsdWVzOiEwLGNsaXBUbzpudWxsLGxvY2tNb3ZlbWVudFg6ITEsbG9ja01vdmVtZW50WTohMSxsb2NrUm90YXRpb246ITEsbG9ja1NjYWxpbmdYOiExLGxvY2tTY2FsaW5nWTohMSxsb2NrVW5pU2NhbGluZzohMSxsb2NrU2NhbGluZ0ZsaXA6ITEsc3RhdGVQcm9wZXJ0aWVzOlwidG9wIGxlZnQgd2lkdGggaGVpZ2h0IHNjYWxlWCBzY2FsZVkgZmxpcFggZmxpcFkgb3JpZ2luWCBvcmlnaW5ZIHRyYW5zZm9ybU1hdHJpeCBzdHJva2Ugc3Ryb2tlV2lkdGggc3Ryb2tlRGFzaEFycmF5IHN0cm9rZUxpbmVDYXAgc3Ryb2tlTGluZUpvaW4gc3Ryb2tlTWl0ZXJMaW1pdCBhbmdsZSBvcGFjaXR5IGZpbGwgZmlsbFJ1bGUgZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uIHNoYWRvdyBjbGlwVG8gdmlzaWJsZSBiYWNrZ3JvdW5kQ29sb3JcIi5zcGxpdChcIiBcIiksaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0JiZ0aGlzLnNldE9wdGlvbnModCl9LF9pbml0R3JhZGllbnQ6ZnVuY3Rpb24odCl7IXQuZmlsbHx8IXQuZmlsbC5jb2xvclN0b3BzfHx0LmZpbGwgaW5zdGFuY2VvZiBlLkdyYWRpZW50fHx0aGlzLnNldChcImZpbGxcIixuZXcgZS5HcmFkaWVudCh0LmZpbGwpKSwhdC5zdHJva2V8fCF0LnN0cm9rZS5jb2xvclN0b3BzfHx0LnN0cm9rZSBpbnN0YW5jZW9mIGUuR3JhZGllbnR8fHRoaXMuc2V0KFwic3Ryb2tlXCIsbmV3IGUuR3JhZGllbnQodC5zdHJva2UpKX0sX2luaXRQYXR0ZXJuOmZ1bmN0aW9uKHQpeyF0LmZpbGx8fCF0LmZpbGwuc291cmNlfHx0LmZpbGwgaW5zdGFuY2VvZiBlLlBhdHRlcm58fHRoaXMuc2V0KFwiZmlsbFwiLG5ldyBlLlBhdHRlcm4odC5maWxsKSksIXQuc3Ryb2tlfHwhdC5zdHJva2Uuc291cmNlfHx0LnN0cm9rZSBpbnN0YW5jZW9mIGUuUGF0dGVybnx8dGhpcy5zZXQoXCJzdHJva2VcIixuZXcgZS5QYXR0ZXJuKHQuc3Ryb2tlKSl9LF9pbml0Q2xpcHBpbmc6ZnVuY3Rpb24odCl7aWYodC5jbGlwVG8mJlwic3RyaW5nXCI9PXR5cGVvZiB0LmNsaXBUbyl7dmFyIGk9ZS51dGlsLmdldEZ1bmN0aW9uQm9keSh0LmNsaXBUbyk7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGkmJih0aGlzLmNsaXBUbz1uZXcgRnVuY3Rpb24oXCJjdHhcIixpKSl9fSxzZXRPcHRpb25zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRoaXMuc2V0KGUsdFtlXSk7dGhpcy5faW5pdEdyYWRpZW50KHQpLHRoaXMuX2luaXRQYXR0ZXJuKHQpLHRoaXMuX2luaXRDbGlwcGluZyh0KX0sdHJhbnNmb3JtOmZ1bmN0aW9uKHQsZSl7dGhpcy5ncm91cCYmdGhpcy5jYW52YXMucHJlc2VydmVPYmplY3RTdGFja2luZyYmdGhpcy5ncm91cD09PXRoaXMuY2FudmFzLl9hY3RpdmVHcm91cCYmdGhpcy5ncm91cC50cmFuc2Zvcm0odCk7dmFyIGk9ZT90aGlzLl9nZXRMZWZ0VG9wQ29vcmRzKCk6dGhpcy5nZXRDZW50ZXJQb2ludCgpO3QudHJhbnNsYXRlKGkueCxpLnkpLHQucm90YXRlKG4odGhpcy5hbmdsZSkpLHQuc2NhbGUodGhpcy5zY2FsZVgqKHRoaXMuZmxpcFg/LTE6MSksdGhpcy5zY2FsZVkqKHRoaXMuZmxpcFk/LTE6MSkpfSx0b09iamVjdDpmdW5jdGlvbih0KXt2YXIgaT1lLk9iamVjdC5OVU1fRlJBQ1RJT05fRElHSVRTLHM9e3R5cGU6dGhpcy50eXBlLG9yaWdpblg6dGhpcy5vcmlnaW5YLG9yaWdpblk6dGhpcy5vcmlnaW5ZLGxlZnQ6cih0aGlzLmxlZnQsaSksdG9wOnIodGhpcy50b3AsaSksd2lkdGg6cih0aGlzLndpZHRoLGkpLGhlaWdodDpyKHRoaXMuaGVpZ2h0LGkpLGZpbGw6dGhpcy5maWxsJiZ0aGlzLmZpbGwudG9PYmplY3Q/dGhpcy5maWxsLnRvT2JqZWN0KCk6dGhpcy5maWxsLHN0cm9rZTp0aGlzLnN0cm9rZSYmdGhpcy5zdHJva2UudG9PYmplY3Q/dGhpcy5zdHJva2UudG9PYmplY3QoKTp0aGlzLnN0cm9rZSxzdHJva2VXaWR0aDpyKHRoaXMuc3Ryb2tlV2lkdGgsaSksc3Ryb2tlRGFzaEFycmF5OnRoaXMuc3Ryb2tlRGFzaEFycmF5LHN0cm9rZUxpbmVDYXA6dGhpcy5zdHJva2VMaW5lQ2FwLHN0cm9rZUxpbmVKb2luOnRoaXMuc3Ryb2tlTGluZUpvaW4sc3Ryb2tlTWl0ZXJMaW1pdDpyKHRoaXMuc3Ryb2tlTWl0ZXJMaW1pdCxpKSxzY2FsZVg6cih0aGlzLnNjYWxlWCxpKSxzY2FsZVk6cih0aGlzLnNjYWxlWSxpKSxhbmdsZTpyKHRoaXMuZ2V0QW5nbGUoKSxpKSxmbGlwWDp0aGlzLmZsaXBYLGZsaXBZOnRoaXMuZmxpcFksb3BhY2l0eTpyKHRoaXMub3BhY2l0eSxpKSxzaGFkb3c6dGhpcy5zaGFkb3cmJnRoaXMuc2hhZG93LnRvT2JqZWN0P3RoaXMuc2hhZG93LnRvT2JqZWN0KCk6dGhpcy5zaGFkb3csdmlzaWJsZTp0aGlzLnZpc2libGUsY2xpcFRvOnRoaXMuY2xpcFRvJiZTdHJpbmcodGhpcy5jbGlwVG8pLGJhY2tncm91bmRDb2xvcjp0aGlzLmJhY2tncm91bmRDb2xvcixmaWxsUnVsZTp0aGlzLmZpbGxSdWxlLGdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbjp0aGlzLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbn07cmV0dXJuIHRoaXMuaW5jbHVkZURlZmF1bHRWYWx1ZXN8fChzPXRoaXMuX3JlbW92ZURlZmF1bHRWYWx1ZXMocykpLGUudXRpbC5wb3B1bGF0ZVdpdGhQcm9wZXJ0aWVzKHRoaXMscyx0KSxzfSx0b0RhdGFsZXNzT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRvT2JqZWN0KHQpfSxfcmVtb3ZlRGVmYXVsdFZhbHVlczpmdW5jdGlvbih0KXt2YXIgaT1lLnV0aWwuZ2V0S2xhc3ModC50eXBlKS5wcm90b3R5cGUscj1pLnN0YXRlUHJvcGVydGllcztyZXR1cm4gci5mb3JFYWNoKGZ1bmN0aW9uKGUpe3RbZV09PT1pW2VdJiZkZWxldGUgdFtlXX0pLHR9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuXCIjPGZhYnJpYy5cIitzKHRoaXMudHlwZSkrXCI+XCJ9LGdldDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpc1t0XX0sX3NldE9iamVjdDpmdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdCl0aGlzLl9zZXQoZSx0W2VdKX0sc2V0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIHQ/dGhpcy5fc2V0T2JqZWN0KHQpOlwiZnVuY3Rpb25cIj09dHlwZW9mIGUmJlwiY2xpcFRvXCIhPT10P3RoaXMuX3NldCh0LGUodGhpcy5nZXQodCkpKTp0aGlzLl9zZXQodCxlKSx0aGlzfSxfc2V0OmZ1bmN0aW9uKHQsaSl7dmFyIHM9XCJzY2FsZVhcIj09PXR8fFwic2NhbGVZXCI9PT10O3JldHVybiBzJiYoaT10aGlzLl9jb25zdHJhaW5TY2FsZShpKSksXCJzY2FsZVhcIj09PXQmJjA+aT8odGhpcy5mbGlwWD0hdGhpcy5mbGlwWCxpKj0tMSk6XCJzY2FsZVlcIj09PXQmJjA+aT8odGhpcy5mbGlwWT0hdGhpcy5mbGlwWSxpKj0tMSk6XCJ3aWR0aFwiPT09dHx8XCJoZWlnaHRcIj09PXQ/dGhpcy5taW5TY2FsZUxpbWl0PXIoTWF0aC5taW4oLjEsMS9NYXRoLm1heCh0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSksMik6XCJzaGFkb3dcIiE9PXR8fCFpfHxpIGluc3RhbmNlb2YgZS5TaGFkb3d8fChpPW5ldyBlLlNoYWRvdyhpKSksdGhpc1t0XT1pLHRoaXN9LHRvZ2dsZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldCh0KTtyZXR1cm5cImJvb2xlYW5cIj09dHlwZW9mIGUmJnRoaXMuc2V0KHQsIWUpLHRoaXN9LHNldFNvdXJjZVBhdGg6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc291cmNlUGF0aD10LHRoaXN9LGdldFZpZXdwb3J0VHJhbnNmb3JtOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybT90aGlzLmNhbnZhcy52aWV3cG9ydFRyYW5zZm9ybTpbMSwwLDAsMSwwLDBdfSxyZW5kZXI6ZnVuY3Rpb24odCxpKXswPT09dGhpcy53aWR0aCYmMD09PXRoaXMuaGVpZ2h0fHwhdGhpcy52aXNpYmxlfHwodC5zYXZlKCksdGhpcy5fc2V0dXBDb21wb3NpdGVPcGVyYXRpb24odCksaXx8dGhpcy50cmFuc2Zvcm0odCksdGhpcy5fc2V0U3Ryb2tlU3R5bGVzKHQpLHRoaXMuX3NldEZpbGxTdHlsZXModCksdGhpcy50cmFuc2Zvcm1NYXRyaXgmJnQudHJhbnNmb3JtLmFwcGx5KHQsdGhpcy50cmFuc2Zvcm1NYXRyaXgpLHRoaXMuX3NldE9wYWNpdHkodCksdGhpcy5fc2V0U2hhZG93KHQpLHRoaXMuY2xpcFRvJiZlLnV0aWwuY2xpcENvbnRleHQodGhpcyx0KSx0aGlzLl9yZW5kZXIodCxpKSx0aGlzLmNsaXBUbyYmdC5yZXN0b3JlKCksdC5yZXN0b3JlKCkpfSxfc2V0T3BhY2l0eTpmdW5jdGlvbih0KXt0aGlzLmdyb3VwJiZ0aGlzLmdyb3VwLl9zZXRPcGFjaXR5KHQpLHQuZ2xvYmFsQWxwaGEqPXRoaXMub3BhY2l0eX0sX3NldFN0cm9rZVN0eWxlczpmdW5jdGlvbih0KXt0aGlzLnN0cm9rZSYmKHQubGluZVdpZHRoPXRoaXMuc3Ryb2tlV2lkdGgsdC5saW5lQ2FwPXRoaXMuc3Ryb2tlTGluZUNhcCx0LmxpbmVKb2luPXRoaXMuc3Ryb2tlTGluZUpvaW4sdC5taXRlckxpbWl0PXRoaXMuc3Ryb2tlTWl0ZXJMaW1pdCx0LnN0cm9rZVN0eWxlPXRoaXMuc3Ryb2tlLnRvTGl2ZT90aGlzLnN0cm9rZS50b0xpdmUodCx0aGlzKTp0aGlzLnN0cm9rZSl9LF9zZXRGaWxsU3R5bGVzOmZ1bmN0aW9uKHQpe3RoaXMuZmlsbCYmKHQuZmlsbFN0eWxlPXRoaXMuZmlsbC50b0xpdmU/dGhpcy5maWxsLnRvTGl2ZSh0LHRoaXMpOnRoaXMuZmlsbCl9LF9yZW5kZXJDb250cm9sczpmdW5jdGlvbih0LGkpe2lmKHRoaXMuYWN0aXZlJiYhaSl7dmFyIHI9dGhpcy5nZXRWaWV3cG9ydFRyYW5zZm9ybSgpO3Quc2F2ZSgpO3ZhciBzO3RoaXMuZ3JvdXAmJihzPWUudXRpbC50cmFuc2Zvcm1Qb2ludCh0aGlzLmdyb3VwLmdldENlbnRlclBvaW50KCksciksdC50cmFuc2xhdGUocy54LHMueSksdC5yb3RhdGUobih0aGlzLmdyb3VwLmFuZ2xlKSkpLHM9ZS51dGlsLnRyYW5zZm9ybVBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSxyLG51bGwhPXRoaXMuZ3JvdXApLHRoaXMuZ3JvdXAmJihzLngqPXRoaXMuZ3JvdXAuc2NhbGVYLHMueSo9dGhpcy5ncm91cC5zY2FsZVkpLHQudHJhbnNsYXRlKHMueCxzLnkpLHQucm90YXRlKG4odGhpcy5hbmdsZSkpLHRoaXMuZHJhd0JvcmRlcnModCksdGhpcy5kcmF3Q29udHJvbHModCksdC5yZXN0b3JlKCl9fSxfc2V0U2hhZG93OmZ1bmN0aW9uKHQpe2lmKHRoaXMuc2hhZG93KXt2YXIgZT10aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMudmlld3BvcnRUcmFuc2Zvcm1bMF18fDEsaT10aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMudmlld3BvcnRUcmFuc2Zvcm1bM118fDE7dC5zaGFkb3dDb2xvcj10aGlzLnNoYWRvdy5jb2xvcix0LnNoYWRvd0JsdXI9dGhpcy5zaGFkb3cuYmx1ciooZStpKSoodGhpcy5zY2FsZVgrdGhpcy5zY2FsZVkpLzQsdC5zaGFkb3dPZmZzZXRYPXRoaXMuc2hhZG93Lm9mZnNldFgqZSp0aGlzLnNjYWxlWCx0LnNoYWRvd09mZnNldFk9dGhpcy5zaGFkb3cub2Zmc2V0WSppKnRoaXMuc2NhbGVZfX0sX3JlbW92ZVNoYWRvdzpmdW5jdGlvbih0KXt0aGlzLnNoYWRvdyYmKHQuc2hhZG93Q29sb3I9XCJcIix0LnNoYWRvd0JsdXI9dC5zaGFkb3dPZmZzZXRYPXQuc2hhZG93T2Zmc2V0WT0wKX0sX3JlbmRlckZpbGw6ZnVuY3Rpb24odCl7aWYodGhpcy5maWxsKXtpZih0LnNhdmUoKSx0aGlzLmZpbGwuZ3JhZGllbnRUcmFuc2Zvcm0pe3ZhciBlPXRoaXMuZmlsbC5ncmFkaWVudFRyYW5zZm9ybTt0LnRyYW5zZm9ybS5hcHBseSh0LGUpfXRoaXMuZmlsbC50b0xpdmUmJnQudHJhbnNsYXRlKC10aGlzLndpZHRoLzIrdGhpcy5maWxsLm9mZnNldFh8fDAsLXRoaXMuaGVpZ2h0LzIrdGhpcy5maWxsLm9mZnNldFl8fDApLFwiZXZlbm9kZFwiPT09dGhpcy5maWxsUnVsZT90LmZpbGwoXCJldmVub2RkXCIpOnQuZmlsbCgpLHQucmVzdG9yZSgpfX0sX3JlbmRlclN0cm9rZTpmdW5jdGlvbih0KXtpZih0aGlzLnN0cm9rZSYmMCE9PXRoaXMuc3Ryb2tlV2lkdGgpe2lmKHRoaXMuc2hhZG93JiYhdGhpcy5zaGFkb3cuYWZmZWN0U3Ryb2tlJiZ0aGlzLl9yZW1vdmVTaGFkb3codCksdC5zYXZlKCksdGhpcy5zdHJva2VEYXNoQXJyYXkpMSZ0aGlzLnN0cm9rZURhc2hBcnJheS5sZW5ndGgmJnRoaXMuc3Ryb2tlRGFzaEFycmF5LnB1c2guYXBwbHkodGhpcy5zdHJva2VEYXNoQXJyYXksdGhpcy5zdHJva2VEYXNoQXJyYXkpLG8/KHQuc2V0TGluZURhc2godGhpcy5zdHJva2VEYXNoQXJyYXkpLHRoaXMuX3N0cm9rZSYmdGhpcy5fc3Ryb2tlKHQpKTp0aGlzLl9yZW5kZXJEYXNoZWRTdHJva2UmJnRoaXMuX3JlbmRlckRhc2hlZFN0cm9rZSh0KSx0LnN0cm9rZSgpO2Vsc2V7aWYodGhpcy5zdHJva2UuZ3JhZGllbnRUcmFuc2Zvcm0pe3ZhciBlPXRoaXMuc3Ryb2tlLmdyYWRpZW50VHJhbnNmb3JtO3QudHJhbnNmb3JtLmFwcGx5KHQsZSl9dGhpcy5fc3Ryb2tlP3RoaXMuX3N0cm9rZSh0KTp0LnN0cm9rZSgpfXQucmVzdG9yZSgpfX0sY2xvbmU6ZnVuY3Rpb24odCxpKXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5mcm9tT2JqZWN0P3RoaXMuY29uc3RydWN0b3IuZnJvbU9iamVjdCh0aGlzLnRvT2JqZWN0KGkpLHQpOm5ldyBlLk9iamVjdCh0aGlzLnRvT2JqZWN0KGkpKX0sY2xvbmVBc0ltYWdlOmZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMudG9EYXRhVVJMKCk7cmV0dXJuIGUudXRpbC5sb2FkSW1hZ2UoaSxmdW5jdGlvbihpKXt0JiZ0KG5ldyBlLkltYWdlKGkpKX0pLHRoaXN9LHRvRGF0YVVSTDpmdW5jdGlvbih0KXt0fHwodD17fSk7dmFyIGk9ZS51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKSxyPXRoaXMuZ2V0Qm91bmRpbmdSZWN0KCk7aS53aWR0aD1yLndpZHRoLGkuaGVpZ2h0PXIuaGVpZ2h0LGUudXRpbC53cmFwRWxlbWVudChpLFwiZGl2XCIpO3ZhciBzPW5ldyBlLlN0YXRpY0NhbnZhcyhpKTtcImpwZ1wiPT09dC5mb3JtYXQmJih0LmZvcm1hdD1cImpwZWdcIiksXCJqcGVnXCI9PT10LmZvcm1hdCYmKHMuYmFja2dyb3VuZENvbG9yPVwiI2ZmZlwiKTt2YXIgbj17YWN0aXZlOnRoaXMuZ2V0KFwiYWN0aXZlXCIpLGxlZnQ6dGhpcy5nZXRMZWZ0KCksdG9wOnRoaXMuZ2V0VG9wKCl9O3RoaXMuc2V0KFwiYWN0aXZlXCIsITEpLHRoaXMuc2V0UG9zaXRpb25CeU9yaWdpbihuZXcgZS5Qb2ludChpLndpZHRoLzIsaS5oZWlnaHQvMiksXCJjZW50ZXJcIixcImNlbnRlclwiKTt2YXIgbz10aGlzLmNhbnZhcztzLmFkZCh0aGlzKTt2YXIgYT1zLnRvRGF0YVVSTCh0KTtyZXR1cm4gdGhpcy5zZXQobikuc2V0Q29vcmRzKCksdGhpcy5jYW52YXM9byxzLmRpc3Bvc2UoKSxzPW51bGwsYX0saXNUeXBlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnR5cGU9PT10fSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDB9LHRvSlNPTjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50b09iamVjdCh0KX0sc2V0R3JhZGllbnQ6ZnVuY3Rpb24odCxpKXtpfHwoaT17fSk7dmFyIHI9e2NvbG9yU3RvcHM6W119O3IudHlwZT1pLnR5cGV8fChpLnIxfHxpLnIyP1wicmFkaWFsXCI6XCJsaW5lYXJcIiksci5jb29yZHM9e3gxOmkueDEseTE6aS55MSx4MjppLngyLHkyOmkueTJ9LChpLnIxfHxpLnIyKSYmKHIuY29vcmRzLnIxPWkucjEsci5jb29yZHMucjI9aS5yMik7Zm9yKHZhciBzIGluIGkuY29sb3JTdG9wcyl7dmFyIG49bmV3IGUuQ29sb3IoaS5jb2xvclN0b3BzW3NdKTtyLmNvbG9yU3RvcHMucHVzaCh7b2Zmc2V0OnMsY29sb3I6bi50b1JnYigpLG9wYWNpdHk6bi5nZXRBbHBoYSgpfSl9cmV0dXJuIHRoaXMuc2V0KHQsZS5HcmFkaWVudC5mb3JPYmplY3QodGhpcyxyKSl9LHNldFBhdHRlcm5GaWxsOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldChcImZpbGxcIixuZXcgZS5QYXR0ZXJuKHQpKX0sc2V0U2hhZG93OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldChcInNoYWRvd1wiLHQ/bmV3IGUuU2hhZG93KHQpOm51bGwpfSxzZXRDb2xvcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXQoXCJmaWxsXCIsdCksdGhpc30sc2V0QW5nbGU6ZnVuY3Rpb24odCl7dmFyIGU9KFwiY2VudGVyXCIhPT10aGlzLm9yaWdpblh8fFwiY2VudGVyXCIhPT10aGlzLm9yaWdpblkpJiZ0aGlzLmNlbnRlcmVkUm90YXRpb247cmV0dXJuIGUmJnRoaXMuX3NldE9yaWdpblRvQ2VudGVyKCksdGhpcy5zZXQoXCJhbmdsZVwiLHQpLGUmJnRoaXMuX3Jlc2V0T3JpZ2luKCksdGhpc30sY2VudGVySDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbnZhcy5jZW50ZXJPYmplY3RIKHRoaXMpLHRoaXN9LGNlbnRlclY6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW52YXMuY2VudGVyT2JqZWN0Vih0aGlzKSx0aGlzfSxjZW50ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jYW52YXMuY2VudGVyT2JqZWN0KHRoaXMpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNhbnZhcy5yZW1vdmUodGhpcyksdGhpc30sZ2V0TG9jYWxQb2ludGVyOmZ1bmN0aW9uKHQsZSl7ZT1lfHx0aGlzLmNhbnZhcy5nZXRQb2ludGVyKHQpO3ZhciBpPXRoaXMudHJhbnNsYXRlVG9PcmlnaW5Qb2ludCh0aGlzLmdldENlbnRlclBvaW50KCksXCJsZWZ0XCIsXCJ0b3BcIik7cmV0dXJue3g6ZS54LWkueCx5OmUueS1pLnl9fSxfc2V0dXBDb21wb3NpdGVPcGVyYXRpb246ZnVuY3Rpb24odCl7dGhpcy5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24mJih0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbj10aGlzLmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbil9fSksZS51dGlsLmNyZWF0ZUFjY2Vzc29ycyhlLk9iamVjdCksZS5PYmplY3QucHJvdG90eXBlLnJvdGF0ZT1lLk9iamVjdC5wcm90b3R5cGUuc2V0QW5nbGUsaShlLk9iamVjdC5wcm90b3R5cGUsZS5PYnNlcnZhYmxlKSxlLk9iamVjdC5OVU1fRlJBQ1RJT05fRElHSVRTPTIsZS5PYmplY3QuX191aWQ9MCl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC5kZWdyZWVzVG9SYWRpYW5zO2ZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLk9iamVjdC5wcm90b3R5cGUse3RyYW5zbGF0ZVRvQ2VudGVyUG9pbnQ6ZnVuY3Rpb24oZSxpLHIpe3ZhciBzPWUueCxuPWUueTtyZXR1cm5cImxlZnRcIj09PWk/cz1lLngrKHRoaXMuZ2V0V2lkdGgoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVYKS8yOlwicmlnaHRcIj09PWkmJihzPWUueC0odGhpcy5nZXRXaWR0aCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVgpLzIpLFwidG9wXCI9PT1yP249ZS55Kyh0aGlzLmdldEhlaWdodCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVkpLzI6XCJib3R0b21cIj09PXImJihuPWUueS0odGhpcy5nZXRIZWlnaHQoKSt0aGlzLnN0cm9rZVdpZHRoKnRoaXMuc2NhbGVZKS8yKSxmYWJyaWMudXRpbC5yb3RhdGVQb2ludChuZXcgZmFicmljLlBvaW50KHMsbiksZSx0KHRoaXMuYW5nbGUpKX0sdHJhbnNsYXRlVG9PcmlnaW5Qb2ludDpmdW5jdGlvbihlLGkscil7dmFyIHM9ZS54LG49ZS55O3JldHVyblwibGVmdFwiPT09aT9zPWUueC0odGhpcy5nZXRXaWR0aCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVgpLzI6XCJyaWdodFwiPT09aSYmKHM9ZS54Kyh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMiksXCJ0b3BcIj09PXI/bj1lLnktKHRoaXMuZ2V0SGVpZ2h0KCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWSkvMjpcImJvdHRvbVwiPT09ciYmKG49ZS55Kyh0aGlzLmdldEhlaWdodCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVkpLzIpLGZhYnJpYy51dGlsLnJvdGF0ZVBvaW50KG5ldyBmYWJyaWMuUG9pbnQocyxuKSxlLHQodGhpcy5hbmdsZSkpfSxnZXRDZW50ZXJQb2ludDpmdW5jdGlvbigpe3ZhciB0PW5ldyBmYWJyaWMuUG9pbnQodGhpcy5sZWZ0LHRoaXMudG9wKTtyZXR1cm4gdGhpcy50cmFuc2xhdGVUb0NlbnRlclBvaW50KHQsdGhpcy5vcmlnaW5YLHRoaXMub3JpZ2luWSl9LGdldFBvaW50QnlPcmlnaW46ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldENlbnRlclBvaW50KCk7cmV0dXJuIHRoaXMudHJhbnNsYXRlVG9PcmlnaW5Qb2ludChpLHQsZSl9LHRvTG9jYWxQb2ludDpmdW5jdGlvbihlLGkscil7dmFyIHMsbixvPXRoaXMuZ2V0Q2VudGVyUG9pbnQoKTtyZXR1cm4gaSYmcj8ocz1cImxlZnRcIj09PWk/by54LSh0aGlzLmdldFdpZHRoKCkrdGhpcy5zdHJva2VXaWR0aCp0aGlzLnNjYWxlWCkvMjpcInJpZ2h0XCI9PT1pP28ueCsodGhpcy5nZXRXaWR0aCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVgpLzI6by54LG49XCJ0b3BcIj09PXI/by55LSh0aGlzLmdldEhlaWdodCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVkpLzI6XCJib3R0b21cIj09PXI/by55Kyh0aGlzLmdldEhlaWdodCgpK3RoaXMuc3Ryb2tlV2lkdGgqdGhpcy5zY2FsZVkpLzI6by55KToocz10aGlzLmxlZnQsbj10aGlzLnRvcCksZmFicmljLnV0aWwucm90YXRlUG9pbnQobmV3IGZhYnJpYy5Qb2ludChlLngsZS55KSxvLC10KHRoaXMuYW5nbGUpKS5zdWJ0cmFjdEVxdWFscyhuZXcgZmFicmljLlBvaW50KHMsbikpfSxzZXRQb3NpdGlvbkJ5T3JpZ2luOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj10aGlzLnRyYW5zbGF0ZVRvQ2VudGVyUG9pbnQodCxlLGkpLHM9dGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KHIsdGhpcy5vcmlnaW5YLHRoaXMub3JpZ2luWSk7dGhpcy5zZXQoXCJsZWZ0XCIscy54KSx0aGlzLnNldChcInRvcFwiLHMueSl9LGFkanVzdFBvc2l0aW9uOmZ1bmN0aW9uKGUpe3ZhciBpPXQodGhpcy5hbmdsZSkscj10aGlzLmdldFdpZHRoKCkvMixzPU1hdGguY29zKGkpKnIsbj1NYXRoLnNpbihpKSpyLG89dGhpcy5nZXRXaWR0aCgpLGE9TWF0aC5jb3MoaSkqbyxoPU1hdGguc2luKGkpKm87XCJjZW50ZXJcIj09PXRoaXMub3JpZ2luWCYmXCJsZWZ0XCI9PT1lfHxcInJpZ2h0XCI9PT10aGlzLm9yaWdpblgmJlwiY2VudGVyXCI9PT1lPyh0aGlzLmxlZnQtPXMsdGhpcy50b3AtPW4pOlwibGVmdFwiPT09dGhpcy5vcmlnaW5YJiZcImNlbnRlclwiPT09ZXx8XCJjZW50ZXJcIj09PXRoaXMub3JpZ2luWCYmXCJyaWdodFwiPT09ZT8odGhpcy5sZWZ0Kz1zLHRoaXMudG9wKz1uKTpcImxlZnRcIj09PXRoaXMub3JpZ2luWCYmXCJyaWdodFwiPT09ZT8odGhpcy5sZWZ0Kz1hLHRoaXMudG9wKz1oKTpcInJpZ2h0XCI9PT10aGlzLm9yaWdpblgmJlwibGVmdFwiPT09ZSYmKHRoaXMubGVmdC09YSx0aGlzLnRvcC09aCksdGhpcy5zZXRDb29yZHMoKSx0aGlzLm9yaWdpblg9ZX0sX3NldE9yaWdpblRvQ2VudGVyOmZ1bmN0aW9uKCl7dGhpcy5fb3JpZ2luYWxPcmlnaW5YPXRoaXMub3JpZ2luWCx0aGlzLl9vcmlnaW5hbE9yaWdpblk9dGhpcy5vcmlnaW5ZO3ZhciB0PXRoaXMuZ2V0Q2VudGVyUG9pbnQoKTt0aGlzLm9yaWdpblg9XCJjZW50ZXJcIix0aGlzLm9yaWdpblk9XCJjZW50ZXJcIix0aGlzLmxlZnQ9dC54LHRoaXMudG9wPXQueX0sX3Jlc2V0T3JpZ2luOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy50cmFuc2xhdGVUb09yaWdpblBvaW50KHRoaXMuZ2V0Q2VudGVyUG9pbnQoKSx0aGlzLl9vcmlnaW5hbE9yaWdpblgsdGhpcy5fb3JpZ2luYWxPcmlnaW5ZKTt0aGlzLm9yaWdpblg9dGhpcy5fb3JpZ2luYWxPcmlnaW5YLHRoaXMub3JpZ2luWT10aGlzLl9vcmlnaW5hbE9yaWdpblksdGhpcy5sZWZ0PXQueCx0aGlzLnRvcD10LnksdGhpcy5fb3JpZ2luYWxPcmlnaW5YPW51bGwsdGhpcy5fb3JpZ2luYWxPcmlnaW5ZPW51bGx9LF9nZXRMZWZ0VG9wQ29vcmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJhbnNsYXRlVG9PcmlnaW5Qb2ludCh0aGlzLmdldENlbnRlclBvaW50KCksXCJsZWZ0XCIsXCJ0b3BcIil9fSl9KCksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC5kZWdyZWVzVG9SYWRpYW5zO2ZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLk9iamVjdC5wcm90b3R5cGUse29Db29yZHM6bnVsbCxpbnRlcnNlY3RzV2l0aFJlY3Q6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLm9Db29yZHMscj1uZXcgZmFicmljLlBvaW50KGkudGwueCxpLnRsLnkpLHM9bmV3IGZhYnJpYy5Qb2ludChpLnRyLngsaS50ci55KSxuPW5ldyBmYWJyaWMuUG9pbnQoaS5ibC54LGkuYmwueSksbz1uZXcgZmFicmljLlBvaW50KGkuYnIueCxpLmJyLnkpLGE9ZmFicmljLkludGVyc2VjdGlvbi5pbnRlcnNlY3RQb2x5Z29uUmVjdGFuZ2xlKFtyLHMsbyxuXSx0LGUpO3JldHVyblwiSW50ZXJzZWN0aW9uXCI9PT1hLnN0YXR1c30saW50ZXJzZWN0c1dpdGhPYmplY3Q6ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSh0KXtyZXR1cm57dGw6bmV3IGZhYnJpYy5Qb2ludCh0LnRsLngsdC50bC55KSx0cjpuZXcgZmFicmljLlBvaW50KHQudHIueCx0LnRyLnkpLGJsOm5ldyBmYWJyaWMuUG9pbnQodC5ibC54LHQuYmwueSksYnI6bmV3IGZhYnJpYy5Qb2ludCh0LmJyLngsdC5ici55KX19dmFyIGk9ZSh0aGlzLm9Db29yZHMpLHI9ZSh0Lm9Db29yZHMpLHM9ZmFicmljLkludGVyc2VjdGlvbi5pbnRlcnNlY3RQb2x5Z29uUG9seWdvbihbaS50bCxpLnRyLGkuYnIsaS5ibF0sW3IudGwsci50cixyLmJyLHIuYmxdKTtyZXR1cm5cIkludGVyc2VjdGlvblwiPT09cy5zdGF0dXN9LGlzQ29udGFpbmVkV2l0aGluT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPXQuZ2V0Qm91bmRpbmdSZWN0KCksaT1uZXcgZmFicmljLlBvaW50KGUubGVmdCxlLnRvcCkscj1uZXcgZmFicmljLlBvaW50KGUubGVmdCtlLndpZHRoLGUudG9wK2UuaGVpZ2h0KTtyZXR1cm4gdGhpcy5pc0NvbnRhaW5lZFdpdGhpblJlY3QoaSxyKX0saXNDb250YWluZWRXaXRoaW5SZWN0OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRCb3VuZGluZ1JlY3QoKTtyZXR1cm4gaS5sZWZ0Pj10LngmJmkubGVmdCtpLndpZHRoPD1lLngmJmkudG9wPj10LnkmJmkudG9wK2kuaGVpZ2h0PD1lLnl9LGNvbnRhaW5zUG9pbnQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZ2V0SW1hZ2VMaW5lcyh0aGlzLm9Db29yZHMpLGk9dGhpcy5fZmluZENyb3NzUG9pbnRzKHQsZSk7cmV0dXJuIDAhPT1pJiZpJTI9PT0xfSxfZ2V0SW1hZ2VMaW5lczpmdW5jdGlvbih0KXtyZXR1cm57dG9wbGluZTp7bzp0LnRsLGQ6dC50cn0scmlnaHRsaW5lOntvOnQudHIsZDp0LmJyfSxib3R0b21saW5lOntvOnQuYnIsZDp0LmJsfSxsZWZ0bGluZTp7bzp0LmJsLGQ6dC50bH19fSxfZmluZENyb3NzUG9pbnRzOmZ1bmN0aW9uKHQsZSl7dmFyIGkscixzLG4sbyxhLGgsYz0wO2Zvcih2YXIgbCBpbiBlKWlmKGg9ZVtsXSwhKGguby55PHQueSYmaC5kLnk8dC55fHxoLm8ueT49dC55JiZoLmQueT49dC55fHwoaC5vLng9PT1oLmQueCYmaC5vLng+PXQueD8obz1oLm8ueCxhPXQueSk6KGk9MCxyPShoLmQueS1oLm8ueSkvKGguZC54LWguby54KSxzPXQueS1pKnQueCxuPWguby55LXIqaC5vLngsbz0tKHMtbikvKGktciksYT1zK2kqbyksbz49dC54JiYoYys9MSksMiE9PWMpKSlicmVhaztyZXR1cm4gY30sZ2V0Qm91bmRpbmdSZWN0V2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRCb3VuZGluZ1JlY3QoKS53aWR0aH0sZ2V0Qm91bmRpbmdSZWN0SGVpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdSZWN0KCkuaGVpZ2h0fSxnZXRCb3VuZGluZ1JlY3Q6ZnVuY3Rpb24oKXt0aGlzLm9Db29yZHN8fHRoaXMuc2V0Q29vcmRzKCk7dmFyIHQ9W3RoaXMub0Nvb3Jkcy50bC54LHRoaXMub0Nvb3Jkcy50ci54LHRoaXMub0Nvb3Jkcy5ici54LHRoaXMub0Nvb3Jkcy5ibC54XSxlPWZhYnJpYy51dGlsLmFycmF5Lm1pbih0KSxpPWZhYnJpYy51dGlsLmFycmF5Lm1heCh0KSxyPU1hdGguYWJzKGUtaSkscz1bdGhpcy5vQ29vcmRzLnRsLnksdGhpcy5vQ29vcmRzLnRyLnksdGhpcy5vQ29vcmRzLmJyLnksdGhpcy5vQ29vcmRzLmJsLnldLG49ZmFicmljLnV0aWwuYXJyYXkubWluKHMpLG89ZmFicmljLnV0aWwuYXJyYXkubWF4KHMpLGE9TWF0aC5hYnMobi1vKTtyZXR1cm57bGVmdDplLHRvcDpuLHdpZHRoOnIsaGVpZ2h0OmF9fSxnZXRXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLndpZHRoKnRoaXMuc2NhbGVYfSxnZXRIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5oZWlnaHQqdGhpcy5zY2FsZVl9LF9jb25zdHJhaW5TY2FsZTpmdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5hYnModCk8dGhpcy5taW5TY2FsZUxpbWl0PzA+dD8tdGhpcy5taW5TY2FsZUxpbWl0OnRoaXMubWluU2NhbGVMaW1pdDp0fSxzY2FsZTpmdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLl9jb25zdHJhaW5TY2FsZSh0KSwwPnQmJih0aGlzLmZsaXBYPSF0aGlzLmZsaXBYLHRoaXMuZmxpcFk9IXRoaXMuZmxpcFksdCo9LTEpLHRoaXMuc2NhbGVYPXQsdGhpcy5zY2FsZVk9dCx0aGlzLnNldENvb3JkcygpLHRoaXN9LHNjYWxlVG9XaWR0aDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldEJvdW5kaW5nUmVjdFdpZHRoKCkvdGhpcy5nZXRXaWR0aCgpO3JldHVybiB0aGlzLnNjYWxlKHQvdGhpcy53aWR0aC9lKX0sc2NhbGVUb0hlaWdodDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldEJvdW5kaW5nUmVjdEhlaWdodCgpL3RoaXMuZ2V0SGVpZ2h0KCk7cmV0dXJuIHRoaXMuc2NhbGUodC90aGlzLmhlaWdodC9lKX0sc2V0Q29vcmRzOmZ1bmN0aW9uKCl7dmFyIGU9dCh0aGlzLmFuZ2xlKSxpPXRoaXMuZ2V0Vmlld3BvcnRUcmFuc2Zvcm0oKSxyPWZ1bmN0aW9uKHQpe3JldHVybiBmYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludCh0LGkpfSxzPXRoaXMuX2NhbGN1bGF0ZUN1cnJlbnREaW1lbnNpb25zKCExKSxuPXMueCxvPXMueTswPm4mJihuPU1hdGguYWJzKG4pKTt2YXIgYT1NYXRoLnNxcnQoTWF0aC5wb3cobi8yLDIpK01hdGgucG93KG8vMiwyKSksaD1NYXRoLmF0YW4oaXNGaW5pdGUoby9uKT9vL246MCksYz1NYXRoLmNvcyhoK2UpKmEsbD1NYXRoLnNpbihoK2UpKmEsdT1NYXRoLnNpbihlKSxmPU1hdGguY29zKGUpLGQ9dGhpcy5nZXRDZW50ZXJQb2ludCgpLGc9bmV3IGZhYnJpYy5Qb2ludChuLG8pLHA9bmV3IGZhYnJpYy5Qb2ludChkLngtYyxkLnktbCksdj1uZXcgZmFicmljLlBvaW50KHAueCtnLngqZixwLnkrZy54KnUpLGI9cihuZXcgZmFicmljLlBvaW50KHAueC1nLnkqdSxwLnkrZy55KmYpKSxtPXIobmV3IGZhYnJpYy5Qb2ludCh2LngtZy55KnUsdi55K2cueSpmKSkseT1yKHApLF89cih2KSx4PW5ldyBmYWJyaWMuUG9pbnQoKHkueCtiLngpLzIsKHkueStiLnkpLzIpLEM9bmV3IGZhYnJpYy5Qb2ludCgoXy54K3kueCkvMiwoXy55K3kueSkvMiksUz1uZXcgZmFicmljLlBvaW50KChtLngrXy54KS8yLChtLnkrXy55KS8yKSx3PW5ldyBmYWJyaWMuUG9pbnQoKG0ueCtiLngpLzIsKG0ueStiLnkpLzIpLE89bmV3IGZhYnJpYy5Qb2ludChDLngrdSp0aGlzLnJvdGF0aW5nUG9pbnRPZmZzZXQsQy55LWYqdGhpcy5yb3RhdGluZ1BvaW50T2Zmc2V0KTtyZXR1cm4gdGhpcy5vQ29vcmRzPXt0bDp5LHRyOl8sYnI6bSxibDpiLG1sOngsbXQ6QyxtcjpTLG1iOncsbXRyOk99LHRoaXMuX3NldENvcm5lckNvb3JkcyYmdGhpcy5fc2V0Q29ybmVyQ29vcmRzKCksdGhpc319KX0oKSxmYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kKGZhYnJpYy5PYmplY3QucHJvdG90eXBlLHtzZW5kVG9CYWNrOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ3JvdXA/ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2VuZFRvQmFjay5jYWxsKHRoaXMuZ3JvdXAsdGhpcyk6dGhpcy5jYW52YXMuc2VuZFRvQmFjayh0aGlzKSx0aGlzfSxicmluZ1RvRnJvbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncm91cD9mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5icmluZ1RvRnJvbnQuY2FsbCh0aGlzLmdyb3VwLHRoaXMpOnRoaXMuY2FudmFzLmJyaW5nVG9Gcm9udCh0aGlzKSx0aGlzfSxzZW5kQmFja3dhcmRzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdyb3VwP2ZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLnNlbmRCYWNrd2FyZHMuY2FsbCh0aGlzLmdyb3VwLHRoaXMsdCk6dGhpcy5jYW52YXMuc2VuZEJhY2t3YXJkcyh0aGlzLHQpLHRoaXN9LGJyaW5nRm9yd2FyZDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5ncm91cD9mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5icmluZ0ZvcndhcmQuY2FsbCh0aGlzLmdyb3VwLHRoaXMsdCk6dGhpcy5jYW52YXMuYnJpbmdGb3J3YXJkKHRoaXMsdCksdGhpc30sbW92ZVRvOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdyb3VwP2ZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLm1vdmVUby5jYWxsKHRoaXMuZ3JvdXAsdGhpcyx0KTp0aGlzLmNhbnZhcy5tb3ZlVG8odGhpcyx0KSx0aGlzfX0pLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLk9iamVjdC5wcm90b3R5cGUse2dldFN2Z1N0eWxlczpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZmlsbD90aGlzLmZpbGwudG9MaXZlP1widXJsKCNTVkdJRF9cIit0aGlzLmZpbGwuaWQrXCIpXCI6dGhpcy5maWxsOlwibm9uZVwiLGU9dGhpcy5maWxsUnVsZSxpPXRoaXMuc3Ryb2tlP3RoaXMuc3Ryb2tlLnRvTGl2ZT9cInVybCgjU1ZHSURfXCIrdGhpcy5zdHJva2UuaWQrXCIpXCI6dGhpcy5zdHJva2U6XCJub25lXCIscj10aGlzLnN0cm9rZVdpZHRoP3RoaXMuc3Ryb2tlV2lkdGg6XCIwXCIscz10aGlzLnN0cm9rZURhc2hBcnJheT90aGlzLnN0cm9rZURhc2hBcnJheS5qb2luKFwiIFwiKTpcIlwiLG49dGhpcy5zdHJva2VMaW5lQ2FwP3RoaXMuc3Ryb2tlTGluZUNhcDpcImJ1dHRcIixvPXRoaXMuc3Ryb2tlTGluZUpvaW4/dGhpcy5zdHJva2VMaW5lSm9pbjpcIm1pdGVyXCIsYT10aGlzLnN0cm9rZU1pdGVyTGltaXQ/dGhpcy5zdHJva2VNaXRlckxpbWl0OlwiNFwiLGg9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRoaXMub3BhY2l0eT90aGlzLm9wYWNpdHk6XCIxXCIsYz10aGlzLnZpc2libGU/XCJcIjpcIiB2aXNpYmlsaXR5OiBoaWRkZW47XCIsbD10aGlzLnNoYWRvdz9cImZpbHRlcjogdXJsKCNTVkdJRF9cIit0aGlzLnNoYWRvdy5pZCtcIik7XCI6XCJcIjtyZXR1cm5bXCJzdHJva2U6IFwiLGksXCI7IFwiLFwic3Ryb2tlLXdpZHRoOiBcIixyLFwiOyBcIixcInN0cm9rZS1kYXNoYXJyYXk6IFwiLHMsXCI7IFwiLFwic3Ryb2tlLWxpbmVjYXA6IFwiLG4sXCI7IFwiLFwic3Ryb2tlLWxpbmVqb2luOiBcIixvLFwiOyBcIixcInN0cm9rZS1taXRlcmxpbWl0OiBcIixhLFwiOyBcIixcImZpbGw6IFwiLHQsXCI7IFwiLFwiZmlsbC1ydWxlOiBcIixlLFwiOyBcIixcIm9wYWNpdHk6IFwiLGgsXCI7XCIsbCxjXS5qb2luKFwiXCIpfSxnZXRTdmdUcmFuc2Zvcm06ZnVuY3Rpb24oKXtpZih0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZSlyZXR1cm5cIlwiO3ZhciB0PWZhYnJpYy51dGlsLnRvRml4ZWQsZT10aGlzLmdldEFuZ2xlKCksaT0hdGhpcy5jYW52YXN8fHRoaXMuY2FudmFzLnN2Z1ZpZXdwb3J0VHJhbnNmb3JtYXRpb24/dGhpcy5nZXRWaWV3cG9ydFRyYW5zZm9ybSgpOlsxLDAsMCwxLDAsMF0scj1mYWJyaWMudXRpbC50cmFuc2Zvcm1Qb2ludCh0aGlzLmdldENlbnRlclBvaW50KCksaSkscz1mYWJyaWMuT2JqZWN0Lk5VTV9GUkFDVElPTl9ESUdJVFMsbj1cInBhdGgtZ3JvdXBcIj09PXRoaXMudHlwZT9cIlwiOlwidHJhbnNsYXRlKFwiK3Qoci54LHMpK1wiIFwiK3Qoci55LHMpK1wiKVwiLG89MCE9PWU/XCIgcm90YXRlKFwiK3QoZSxzKStcIilcIjpcIlwiLGE9MT09PXRoaXMuc2NhbGVYJiYxPT09dGhpcy5zY2FsZVkmJjE9PT1pWzBdJiYxPT09aVszXT9cIlwiOlwiIHNjYWxlKFwiK3QodGhpcy5zY2FsZVgqaVswXSxzKStcIiBcIit0KHRoaXMuc2NhbGVZKmlbM10scykrXCIpXCIsaD1cInBhdGgtZ3JvdXBcIj09PXRoaXMudHlwZT90aGlzLndpZHRoKmlbMF06MCxjPXRoaXMuZmxpcFg/XCIgbWF0cml4KC0xIDAgMCAxIFwiK2grXCIgMCkgXCI6XCJcIixsPVwicGF0aC1ncm91cFwiPT09dGhpcy50eXBlP3RoaXMuaGVpZ2h0KmlbM106MCx1PXRoaXMuZmxpcFk/XCIgbWF0cml4KDEgMCAwIC0xIDAgXCIrbCtcIilcIjpcIlwiO3JldHVybltuLG8sYSxjLHVdLmpvaW4oXCJcIil9LGdldFN2Z1RyYW5zZm9ybU1hdHJpeDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRyYW5zZm9ybU1hdHJpeD9cIiBtYXRyaXgoXCIrdGhpcy50cmFuc2Zvcm1NYXRyaXguam9pbihcIiBcIikrXCIpIFwiOlwiXCJ9LF9jcmVhdGVCYXNlU1ZHTWFya3VwOmZ1bmN0aW9uKCl7dmFyIHQ9W107cmV0dXJuIHRoaXMuZmlsbCYmdGhpcy5maWxsLnRvTGl2ZSYmdC5wdXNoKHRoaXMuZmlsbC50b1NWRyh0aGlzLCExKSksdGhpcy5zdHJva2UmJnRoaXMuc3Ryb2tlLnRvTGl2ZSYmdC5wdXNoKHRoaXMuc3Ryb2tlLnRvU1ZHKHRoaXMsITEpKSx0aGlzLnNoYWRvdyYmdC5wdXNoKHRoaXMuc2hhZG93LnRvU1ZHKHRoaXMpKSx0fX0pLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLk9iamVjdC5wcm90b3R5cGUse2hhc1N0YXRlQ2hhbmdlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN0YXRlUHJvcGVydGllcy5zb21lKGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldCh0KSE9PXRoaXMub3JpZ2luYWxTdGF0ZVt0XX0sdGhpcyl9LHNhdmVTdGF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zdGF0ZVByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbih0KXt0aGlzLm9yaWdpbmFsU3RhdGVbdF09dGhpcy5nZXQodCl9LHRoaXMpLHQmJnQuc3RhdGVQcm9wZXJ0aWVzJiZ0LnN0YXRlUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3RoaXMub3JpZ2luYWxTdGF0ZVt0XT10aGlzLmdldCh0KX0sdGhpcyksdGhpc30sc2V0dXBTdGF0ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9yaWdpbmFsU3RhdGU9e30sdGhpcy5zYXZlU3RhdGUoKSx0aGlzfX0pLGZ1bmN0aW9uKCl7dmFyIHQ9ZmFicmljLnV0aWwuZGVncmVlc1RvUmFkaWFucyxlPWZ1bmN0aW9uKCl7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIEdfdm1sQ2FudmFzTWFuYWdlcn07ZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7X2NvbnRyb2xzVmlzaWJpbGl0eTpudWxsLF9maW5kVGFyZ2V0Q29ybmVyOmZ1bmN0aW9uKHQpe2lmKCF0aGlzLmhhc0NvbnRyb2xzfHwhdGhpcy5hY3RpdmUpcmV0dXJuITE7dmFyIGUsaSxyPXQueCxzPXQueTtmb3IodmFyIG4gaW4gdGhpcy5vQ29vcmRzKWlmKHRoaXMuaXNDb250cm9sVmlzaWJsZShuKSYmKFwibXRyXCIhPT1ufHx0aGlzLmhhc1JvdGF0aW5nUG9pbnQpJiYoIXRoaXMuZ2V0KFwibG9ja1VuaVNjYWxpbmdcIil8fFwibXRcIiE9PW4mJlwibXJcIiE9PW4mJlwibWJcIiE9PW4mJlwibWxcIiE9PW4pJiYoaT10aGlzLl9nZXRJbWFnZUxpbmVzKHRoaXMub0Nvb3Jkc1tuXS5jb3JuZXIpLGU9dGhpcy5fZmluZENyb3NzUG9pbnRzKHt4OnIseTpzfSxpKSwwIT09ZSYmZSUyPT09MSkpcmV0dXJuIHRoaXMuX19jb3JuZXI9bixuO3JldHVybiExfSxfc2V0Q29ybmVyQ29vcmRzOmZ1bmN0aW9uKCl7dmFyIGUsaSxyPXRoaXMub0Nvb3JkcyxzPXQoNDUtdGhpcy5hbmdsZSksbj1NYXRoLnNxcnQoMipNYXRoLnBvdyh0aGlzLmNvcm5lclNpemUsMikpLzIsbz1uKk1hdGguY29zKHMpLGE9bipNYXRoLnNpbihzKTtmb3IodmFyIGggaW4gcillPXJbaF0ueCxpPXJbaF0ueSxyW2hdLmNvcm5lcj17dGw6e3g6ZS1hLHk6aS1vfSx0cjp7eDplK28seTppLWF9LGJsOnt4OmUtbyx5OmkrYX0sYnI6e3g6ZSthLHk6aStvfX19LF9jYWxjdWxhdGVDdXJyZW50RGltZW5zaW9uczpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFZpZXdwb3J0VHJhbnNmb3JtKCksaT10aGlzLnN0cm9rZVdpZHRoLHI9dGhpcy53aWR0aCxzPXRoaXMuaGVpZ2h0LG49XCJyb3VuZFwiPT09dGhpcy5zdHJva2VMaW5lQ2FwfHxcInNxdWFyZVwiPT09dGhpcy5zdHJva2VMaW5lQ2FwLG89XCJsaW5lXCI9PT10aGlzLnR5cGUmJjA9PT10aGlzLndpZHRoLGE9XCJsaW5lXCI9PT10aGlzLnR5cGUmJjA9PT10aGlzLmhlaWdodCxoPW98fGEsYz1uJiZhfHwhaCxsPW4mJm98fCFoO3JldHVybiBvP3I9aTphJiYocz1pKSxjJiYocis9MD5yPy1pOmkpLGwmJihzKz0wPnM/LWk6aSkscj1yKnRoaXMuc2NhbGVYKzIqdGhpcy5wYWRkaW5nLHM9cyp0aGlzLnNjYWxlWSsyKnRoaXMucGFkZGluZyx0P2ZhYnJpYy51dGlsLnRyYW5zZm9ybVBvaW50KG5ldyBmYWJyaWMuUG9pbnQocixzKSxlLCEwKTp7eDpyLHk6c319LGRyYXdCb3JkZXJzOmZ1bmN0aW9uKHQpe2lmKCF0aGlzLmhhc0JvcmRlcnMpcmV0dXJuIHRoaXM7dC5zYXZlKCksdC5nbG9iYWxBbHBoYT10aGlzLmlzTW92aW5nP3RoaXMuYm9yZGVyT3BhY2l0eVdoZW5Nb3Zpbmc6MSx0LnN0cm9rZVN0eWxlPXRoaXMuYm9yZGVyQ29sb3IsdC5saW5lV2lkdGg9MS90aGlzLmJvcmRlclNjYWxlRmFjdG9yO3ZhciBlPXRoaXMuX2NhbGN1bGF0ZUN1cnJlbnREaW1lbnNpb25zKCEwKSxpPWUueCxyPWUueTtpZih0aGlzLmdyb3VwJiYoaSo9dGhpcy5ncm91cC5zY2FsZVgscio9dGhpcy5ncm91cC5zY2FsZVkpLHQuc3Ryb2tlUmVjdCh+fi0oaS8yKS0uNSx+fi0oci8yKS0uNSx+fmkrMSx+fnIrMSksdGhpcy5oYXNSb3RhdGluZ1BvaW50JiZ0aGlzLmlzQ29udHJvbFZpc2libGUoXCJtdHJcIikmJiF0aGlzLmdldChcImxvY2tSb3RhdGlvblwiKSYmdGhpcy5oYXNDb250cm9scyl7dmFyIHM9LXIvMjt0LmJlZ2luUGF0aCgpLHQubW92ZVRvKDAscyksdC5saW5lVG8oMCxzLXRoaXMucm90YXRpbmdQb2ludE9mZnNldCksdC5jbG9zZVBhdGgoKSx0LnN0cm9rZSgpfXJldHVybiB0LnJlc3RvcmUoKSx0aGlzfSxkcmF3Q29udHJvbHM6ZnVuY3Rpb24odCl7aWYoIXRoaXMuaGFzQ29udHJvbHMpcmV0dXJuIHRoaXM7dmFyIGU9dGhpcy5fY2FsY3VsYXRlQ3VycmVudERpbWVuc2lvbnMoITApLGk9ZS54LHI9ZS55LHM9LShpLzIpLG49LShyLzIpLG89dGhpcy5jb3JuZXJTaXplLzIsYT10aGlzLnRyYW5zcGFyZW50Q29ybmVycz9cInN0cm9rZVJlY3RcIjpcImZpbGxSZWN0XCI7cmV0dXJuIHQuc2F2ZSgpLHQubGluZVdpZHRoPTEsdC5nbG9iYWxBbHBoYT10aGlzLmlzTW92aW5nP3RoaXMuYm9yZGVyT3BhY2l0eVdoZW5Nb3Zpbmc6MSx0LnN0cm9rZVN0eWxlPXQuZmlsbFN0eWxlPXRoaXMuY29ybmVyQ29sb3IsdGhpcy5fZHJhd0NvbnRyb2woXCJ0bFwiLHQsYSxzLW8sbi1vKSx0aGlzLl9kcmF3Q29udHJvbChcInRyXCIsdCxhLHMraS1vLG4tbyksdGhpcy5fZHJhd0NvbnRyb2woXCJibFwiLHQsYSxzLW8sbityLW8pLHRoaXMuX2RyYXdDb250cm9sKFwiYnJcIix0LGEscytpLW8sbityLW8pLHRoaXMuZ2V0KFwibG9ja1VuaVNjYWxpbmdcIil8fCh0aGlzLl9kcmF3Q29udHJvbChcIm10XCIsdCxhLHMraS8yLW8sbi1vKSx0aGlzLl9kcmF3Q29udHJvbChcIm1iXCIsdCxhLHMraS8yLW8sbityLW8pLHRoaXMuX2RyYXdDb250cm9sKFwibXJcIix0LGEscytpLW8sbityLzItbyksdGhpcy5fZHJhd0NvbnRyb2woXCJtbFwiLHQsYSxzLW8sbityLzItbykpLHRoaXMuaGFzUm90YXRpbmdQb2ludCYmdGhpcy5fZHJhd0NvbnRyb2woXCJtdHJcIix0LGEscytpLzItbyxuLXRoaXMucm90YXRpbmdQb2ludE9mZnNldC1vKSx0LnJlc3RvcmUoKSx0aGlzfSxfZHJhd0NvbnRyb2w6ZnVuY3Rpb24odCxpLHIscyxuKXtpZih0aGlzLmlzQ29udHJvbFZpc2libGUodCkpe3ZhciBvPXRoaXMuY29ybmVyU2l6ZTtlKCl8fHRoaXMudHJhbnNwYXJlbnRDb3JuZXJzfHxpLmNsZWFyUmVjdChzLG4sbyxvKSxpW3JdKHMsbixvLG8pfX0saXNDb250cm9sVmlzaWJsZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZ2V0Q29udHJvbHNWaXNpYmlsaXR5KClbdF19LHNldENvbnRyb2xWaXNpYmxlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX2dldENvbnRyb2xzVmlzaWJpbGl0eSgpW3RdPWUsdGhpc30sc2V0Q29udHJvbHNWaXNpYmlsaXR5OmZ1bmN0aW9uKHQpe3R8fCh0PXt9KTtmb3IodmFyIGUgaW4gdCl0aGlzLnNldENvbnRyb2xWaXNpYmxlKGUsdFtlXSk7cmV0dXJuIHRoaXN9LF9nZXRDb250cm9sc1Zpc2liaWxpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29udHJvbHNWaXNpYmlsaXR5fHwodGhpcy5fY29udHJvbHNWaXNpYmlsaXR5PXt0bDohMCx0cjohMCxicjohMCxibDohMCxtbDohMCxtdDohMCxtcjohMCxtYjohMCxtdHI6ITB9KSx0aGlzLl9jb250cm9sc1Zpc2liaWxpdHl9fSl9KCksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSx7RlhfRFVSQVRJT046NTAwLGZ4Q2VudGVyT2JqZWN0SDpmdW5jdGlvbih0LGUpe2U9ZXx8e307dmFyIGk9ZnVuY3Rpb24oKXt9LHI9ZS5vbkNvbXBsZXRlfHxpLHM9ZS5vbkNoYW5nZXx8aSxuPXRoaXM7cmV0dXJuIGZhYnJpYy51dGlsLmFuaW1hdGUoe3N0YXJ0VmFsdWU6dC5nZXQoXCJsZWZ0XCIpLGVuZFZhbHVlOnRoaXMuZ2V0Q2VudGVyKCkubGVmdCxkdXJhdGlvbjp0aGlzLkZYX0RVUkFUSU9OLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3Quc2V0KFwibGVmdFwiLGUpLG4ucmVuZGVyQWxsKCkscygpfSxvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7dC5zZXRDb29yZHMoKSxyKCl9fSksdGhpc30sZnhDZW50ZXJPYmplY3RWOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fTt2YXIgaT1mdW5jdGlvbigpe30scj1lLm9uQ29tcGxldGV8fGkscz1lLm9uQ2hhbmdlfHxpLG49dGhpcztyZXR1cm4gZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTp0LmdldChcInRvcFwiKSxlbmRWYWx1ZTp0aGlzLmdldENlbnRlcigpLnRvcCxkdXJhdGlvbjp0aGlzLkZYX0RVUkFUSU9OLG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3Quc2V0KFwidG9wXCIsZSksbi5yZW5kZXJBbGwoKSxzKCl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXt0LnNldENvb3JkcygpLHIoKX19KSx0aGlzfSxmeFJlbW92ZTpmdW5jdGlvbih0LGUpe2U9ZXx8e307dmFyIGk9ZnVuY3Rpb24oKXt9LHI9ZS5vbkNvbXBsZXRlfHxpLHM9ZS5vbkNoYW5nZXx8aSxuPXRoaXM7cmV0dXJuIGZhYnJpYy51dGlsLmFuaW1hdGUoe3N0YXJ0VmFsdWU6dC5nZXQoXCJvcGFjaXR5XCIpLGVuZFZhbHVlOjAsZHVyYXRpb246dGhpcy5GWF9EVVJBVElPTixvblN0YXJ0OmZ1bmN0aW9uKCl7dC5zZXQoXCJhY3RpdmVcIiwhMSl9LG9uQ2hhbmdlOmZ1bmN0aW9uKGUpe3Quc2V0KFwib3BhY2l0eVwiLGUpLG4ucmVuZGVyQWxsKCkscygpfSxvbkNvbXBsZXRlOmZ1bmN0aW9uKCl7bi5yZW1vdmUodCkscigpfX0pLHRoaXN9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuT2JqZWN0LnByb3RvdHlwZSx7YW5pbWF0ZTpmdW5jdGlvbigpe2lmKGFyZ3VtZW50c1swXSYmXCJvYmplY3RcIj09dHlwZW9mIGFyZ3VtZW50c1swXSl7dmFyIHQsZSxpPVtdO2Zvcih0IGluIGFyZ3VtZW50c1swXSlpLnB1c2godCk7Zm9yKHZhciByPTAscz1pLmxlbmd0aDtzPnI7cisrKXQ9aVtyXSxlPXIhPT1zLTEsdGhpcy5fYW5pbWF0ZSh0LGFyZ3VtZW50c1swXVt0XSxhcmd1bWVudHNbMV0sZSl9ZWxzZSB0aGlzLl9hbmltYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdGhpc30sX2FuaW1hdGU6ZnVuY3Rpb24odCxlLGkscil7dmFyIHMsbj10aGlzO2U9ZS50b1N0cmluZygpLGk9aT9mYWJyaWMudXRpbC5vYmplY3QuY2xvbmUoaSk6e30sfnQuaW5kZXhPZihcIi5cIikmJihzPXQuc3BsaXQoXCIuXCIpKTt2YXIgbz1zP3RoaXMuZ2V0KHNbMF0pW3NbMV1dOnRoaXMuZ2V0KHQpO1wiZnJvbVwiaW4gaXx8KGkuZnJvbT1vKSxlPX5lLmluZGV4T2YoXCI9XCIpP28rcGFyc2VGbG9hdChlLnJlcGxhY2UoXCI9XCIsXCJcIikpOnBhcnNlRmxvYXQoZSksZmFicmljLnV0aWwuYW5pbWF0ZSh7c3RhcnRWYWx1ZTppLmZyb20sZW5kVmFsdWU6ZSxieVZhbHVlOmkuYnksZWFzaW5nOmkuZWFzaW5nLGR1cmF0aW9uOmkuZHVyYXRpb24sYWJvcnQ6aS5hYm9ydCYmZnVuY3Rpb24oKXtyZXR1cm4gaS5hYm9ydC5jYWxsKG4pfSxvbkNoYW5nZTpmdW5jdGlvbihlKXtzP25bc1swXV1bc1sxXV09ZTpuLnNldCh0LGUpLHJ8fGkub25DaGFuZ2UmJmkub25DaGFuZ2UoKX0sb25Db21wbGV0ZTpmdW5jdGlvbigpe3J8fChuLnNldENvb3JkcygpLGkub25Db21wbGV0ZSYmaS5vbkNvbXBsZXRlKCkpfX0pfX0pLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUodCxlKXt2YXIgaT10Lm9yaWdpbixyPXQuYXhpczEscz10LmF4aXMyLG49dC5kaW1lbnNpb24sbz1lLm5lYXJlc3QsYT1lLmNlbnRlcixoPWUuZmFydGhlc3Q7cmV0dXJuIGZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMuZ2V0KGkpKXtjYXNlIG86cmV0dXJuIE1hdGgubWluKHRoaXMuZ2V0KHIpLHRoaXMuZ2V0KHMpKTtjYXNlIGE6cmV0dXJuIE1hdGgubWluKHRoaXMuZ2V0KHIpLHRoaXMuZ2V0KHMpKSsuNSp0aGlzLmdldChuKTtjYXNlIGg6cmV0dXJuIE1hdGgubWF4KHRoaXMuZ2V0KHIpLHRoaXMuZ2V0KHMpKTtcclxuXHJcbn19fXZhciBpPXQuZmFicmljfHwodC5mYWJyaWM9e30pLHI9aS51dGlsLm9iamVjdC5leHRlbmQscz17eDE6MSx4MjoxLHkxOjEseTI6MX0sbj1pLlN0YXRpY0NhbnZhcy5zdXBwb3J0cyhcInNldExpbmVEYXNoXCIpO3JldHVybiBpLkxpbmU/dm9pZCBpLndhcm4oXCJmYWJyaWMuTGluZSBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGkuTGluZT1pLnV0aWwuY3JlYXRlQ2xhc3MoaS5PYmplY3Qse3R5cGU6XCJsaW5lXCIseDE6MCx5MTowLHgyOjAseTI6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0fHwodD1bMCwwLDAsMF0pLHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLGUpLHRoaXMuc2V0KFwieDFcIix0WzBdKSx0aGlzLnNldChcInkxXCIsdFsxXSksdGhpcy5zZXQoXCJ4MlwiLHRbMl0pLHRoaXMuc2V0KFwieTJcIix0WzNdKSx0aGlzLl9zZXRXaWR0aEhlaWdodChlKX0sX3NldFdpZHRoSGVpZ2h0OmZ1bmN0aW9uKHQpe3R8fCh0PXt9KSx0aGlzLndpZHRoPU1hdGguYWJzKHRoaXMueDItdGhpcy54MSksdGhpcy5oZWlnaHQ9TWF0aC5hYnModGhpcy55Mi10aGlzLnkxKSx0aGlzLmxlZnQ9XCJsZWZ0XCJpbiB0P3QubGVmdDp0aGlzLl9nZXRMZWZ0VG9PcmlnaW5YKCksdGhpcy50b3A9XCJ0b3BcImluIHQ/dC50b3A6dGhpcy5fZ2V0VG9wVG9PcmlnaW5ZKCl9LF9zZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jYWxsU3VwZXIoXCJfc2V0XCIsdCxlKSxcInVuZGVmaW5lZFwiIT10eXBlb2Ygc1t0XSYmdGhpcy5fc2V0V2lkdGhIZWlnaHQoKSx0aGlzfSxfZ2V0TGVmdFRvT3JpZ2luWDplKHtvcmlnaW46XCJvcmlnaW5YXCIsYXhpczE6XCJ4MVwiLGF4aXMyOlwieDJcIixkaW1lbnNpb246XCJ3aWR0aFwifSx7bmVhcmVzdDpcImxlZnRcIixjZW50ZXI6XCJjZW50ZXJcIixmYXJ0aGVzdDpcInJpZ2h0XCJ9KSxfZ2V0VG9wVG9PcmlnaW5ZOmUoe29yaWdpbjpcIm9yaWdpbllcIixheGlzMTpcInkxXCIsYXhpczI6XCJ5MlwiLGRpbWVuc2lvbjpcImhlaWdodFwifSx7bmVhcmVzdDpcInRvcFwiLGNlbnRlcjpcImNlbnRlclwiLGZhcnRoZXN0OlwiYm90dG9tXCJ9KSxfcmVuZGVyOmZ1bmN0aW9uKHQsZSl7aWYodC5iZWdpblBhdGgoKSxlKXt2YXIgaT10aGlzLmdldENlbnRlclBvaW50KCk7dC50cmFuc2xhdGUoaS54LXRoaXMuc3Ryb2tlV2lkdGgvMixpLnktdGhpcy5zdHJva2VXaWR0aC8yKX1pZighdGhpcy5zdHJva2VEYXNoQXJyYXl8fHRoaXMuc3Ryb2tlRGFzaEFycmF5JiZuKXt2YXIgcj10aGlzLmNhbGNMaW5lUG9pbnRzKCk7dC5tb3ZlVG8oci54MSxyLnkxKSx0LmxpbmVUbyhyLngyLHIueTIpfXQubGluZVdpZHRoPXRoaXMuc3Ryb2tlV2lkdGg7dmFyIHM9dC5zdHJva2VTdHlsZTt0LnN0cm9rZVN0eWxlPXRoaXMuc3Ryb2tlfHx0LmZpbGxTdHlsZSx0aGlzLnN0cm9rZSYmdGhpcy5fcmVuZGVyU3Ryb2tlKHQpLHQuc3Ryb2tlU3R5bGU9c30sX3JlbmRlckRhc2hlZFN0cm9rZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNhbGNMaW5lUG9pbnRzKCk7dC5iZWdpblBhdGgoKSxpLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxlLngxLGUueTEsZS54MixlLnkyLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSx0LmNsb3NlUGF0aCgpfSx0b09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gcih0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIsdCksdGhpcy5jYWxjTGluZVBvaW50cygpKX0sY2FsY0xpbmVQb2ludHM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLngxPD10aGlzLngyPy0xOjEsZT10aGlzLnkxPD10aGlzLnkyPy0xOjEsaT10KnRoaXMud2lkdGgqLjUscj1lKnRoaXMuaGVpZ2h0Ki41LHM9dCp0aGlzLndpZHRoKi0uNSxuPWUqdGhpcy5oZWlnaHQqLS41O3JldHVybnt4MTppLHgyOnMseTE6cix5MjpufX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLGk9e3gxOnRoaXMueDEseDI6dGhpcy54Mix5MTp0aGlzLnkxLHkyOnRoaXMueTJ9O3JldHVybiB0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZXx8KGk9dGhpcy5jYWxjTGluZVBvaW50cygpKSxlLnB1c2goXCI8bGluZSBcIiwneDE9XCInLGkueDEsJ1wiIHkxPVwiJyxpLnkxLCdcIiB4Mj1cIicsaS54MiwnXCIgeTI9XCInLGkueTIsJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCIvPlxcbicpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiAxfX0pLGkuTGluZS5BVFRSSUJVVEVfTkFNRVM9aS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoXCJ4MSB5MSB4MiB5MlwiLnNwbGl0KFwiIFwiKSksaS5MaW5lLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsZSl7dmFyIHM9aS5wYXJzZUF0dHJpYnV0ZXModCxpLkxpbmUuQVRUUklCVVRFX05BTUVTKSxuPVtzLngxfHwwLHMueTF8fDAscy54Mnx8MCxzLnkyfHwwXTtyZXR1cm4gbmV3IGkuTGluZShuLHIocyxlKSl9LHZvaWQoaS5MaW5lLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7dmFyIGU9W3QueDEsdC55MSx0LngyLHQueTJdO3JldHVybiBuZXcgaS5MaW5lKGUsdCl9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZSh0KXtyZXR1cm5cInJhZGl1c1wiaW4gdCYmdC5yYWRpdXM+PTB9dmFyIGk9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSkscj1NYXRoLlBJLHM9aS51dGlsLm9iamVjdC5leHRlbmQ7cmV0dXJuIGkuQ2lyY2xlP3ZvaWQgaS53YXJuKFwiZmFicmljLkNpcmNsZSBpcyBhbHJlYWR5IGRlZmluZWQuXCIpOihpLkNpcmNsZT1pLnV0aWwuY3JlYXRlQ2xhc3MoaS5PYmplY3Qse3R5cGU6XCJjaXJjbGVcIixyYWRpdXM6MCxzdGFydEFuZ2xlOjAsZW5kQW5nbGU6MipyLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLmNhbGxTdXBlcihcImluaXRpYWxpemVcIix0KSx0aGlzLnNldChcInJhZGl1c1wiLHQucmFkaXVzfHwwKSx0aGlzLnN0YXJ0QW5nbGU9dC5zdGFydEFuZ2xlfHx0aGlzLnN0YXJ0QW5nbGUsdGhpcy5lbmRBbmdsZT10LmVuZEFuZ2xlfHx0aGlzLmVuZEFuZ2xlfSxfc2V0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuY2FsbFN1cGVyKFwiX3NldFwiLHQsZSksXCJyYWRpdXNcIj09PXQmJnRoaXMuc2V0UmFkaXVzKGUpLHRoaXN9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiBzKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIix0KSx7cmFkaXVzOnRoaXMuZ2V0KFwicmFkaXVzXCIpLHN0YXJ0QW5nbGU6dGhpcy5zdGFydEFuZ2xlLGVuZEFuZ2xlOnRoaXMuZW5kQW5nbGV9KX0sdG9TVkc6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fY3JlYXRlQmFzZVNWR01hcmt1cCgpLGk9MCxzPTAsbj0odGhpcy5lbmRBbmdsZS10aGlzLnN0YXJ0QW5nbGUpJSgyKnIpO2lmKDA9PT1uKXRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlJiYoaT10aGlzLmxlZnQrdGhpcy5yYWRpdXMscz10aGlzLnRvcCt0aGlzLnJhZGl1cyksZS5wdXNoKFwiPGNpcmNsZSBcIiwnY3g9XCInK2krJ1wiIGN5PVwiJytzKydcIiAnLCdyPVwiJyx0aGlzLnJhZGl1cywnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSxcIiBcIix0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyk7ZWxzZXt2YXIgbz1NYXRoLmNvcyh0aGlzLnN0YXJ0QW5nbGUpKnRoaXMucmFkaXVzLGE9TWF0aC5zaW4odGhpcy5zdGFydEFuZ2xlKSp0aGlzLnJhZGl1cyxoPU1hdGguY29zKHRoaXMuZW5kQW5nbGUpKnRoaXMucmFkaXVzLGM9TWF0aC5zaW4odGhpcy5lbmRBbmdsZSkqdGhpcy5yYWRpdXMsbD1uPnI/XCIxXCI6XCIwXCI7ZS5wdXNoKCc8cGF0aCBkPVwiTSAnK28rXCIgXCIrYSxcIiBBIFwiK3RoaXMucmFkaXVzK1wiIFwiK3RoaXMucmFkaXVzLFwiIDAgXCIsK2wrXCIgMVwiLFwiIFwiK2grXCIgXCIrYywnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiIHRyYW5zZm9ybT1cIicsdGhpcy5nZXRTdmdUcmFuc2Zvcm0oKSxcIiBcIix0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIi8+XFxuJyl9cmV0dXJuIHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sX3JlbmRlcjpmdW5jdGlvbih0LGUpe3QuYmVnaW5QYXRoKCksdC5hcmMoZT90aGlzLmxlZnQrdGhpcy5yYWRpdXM6MCxlP3RoaXMudG9wK3RoaXMucmFkaXVzOjAsdGhpcy5yYWRpdXMsdGhpcy5zdGFydEFuZ2xlLHRoaXMuZW5kQW5nbGUsITEpLHRoaXMuX3JlbmRlckZpbGwodCksdGhpcy5fcmVuZGVyU3Ryb2tlKHQpfSxnZXRSYWRpdXNYOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0KFwicmFkaXVzXCIpKnRoaXMuZ2V0KFwic2NhbGVYXCIpfSxnZXRSYWRpdXNZOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0KFwicmFkaXVzXCIpKnRoaXMuZ2V0KFwic2NhbGVZXCIpfSxzZXRSYWRpdXM6ZnVuY3Rpb24odCl7dGhpcy5yYWRpdXM9dCx0aGlzLnNldChcIndpZHRoXCIsMip0KS5zZXQoXCJoZWlnaHRcIiwyKnQpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksaS5DaXJjbGUuQVRUUklCVVRFX05BTUVTPWkuU0hBUkVEX0FUVFJJQlVURVMuY29uY2F0KFwiY3ggY3kgclwiLnNwbGl0KFwiIFwiKSksaS5DaXJjbGUuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxyKXtyfHwocj17fSk7dmFyIG49aS5wYXJzZUF0dHJpYnV0ZXModCxpLkNpcmNsZS5BVFRSSUJVVEVfTkFNRVMpO2lmKCFlKG4pKXRocm93IG5ldyBFcnJvcihcInZhbHVlIG9mIGByYCBhdHRyaWJ1dGUgaXMgcmVxdWlyZWQgYW5kIGNhbiBub3QgYmUgbmVnYXRpdmVcIik7bi5sZWZ0PW4ubGVmdHx8MCxuLnRvcD1uLnRvcHx8MDt2YXIgbz1uZXcgaS5DaXJjbGUocyhuLHIpKTtyZXR1cm4gby5sZWZ0LT1vLnJhZGl1cyxvLnRvcC09by5yYWRpdXMsb30sdm9pZChpLkNpcmNsZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgaS5DaXJjbGUodCl9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7cmV0dXJuIGUuVHJpYW5nbGU/dm9pZCBlLndhcm4oXCJmYWJyaWMuVHJpYW5nbGUgaXMgYWxyZWFkeSBkZWZpbmVkXCIpOihlLlRyaWFuZ2xlPWUudXRpbC5jcmVhdGVDbGFzcyhlLk9iamVjdCx7dHlwZTpcInRyaWFuZ2xlXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLHQpLHRoaXMuc2V0KFwid2lkdGhcIix0LndpZHRofHwxMDApLnNldChcImhlaWdodFwiLHQuaGVpZ2h0fHwxMDApfSxfcmVuZGVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMud2lkdGgvMixpPXRoaXMuaGVpZ2h0LzI7dC5iZWdpblBhdGgoKSx0Lm1vdmVUbygtZSxpKSx0LmxpbmVUbygwLC1pKSx0LmxpbmVUbyhlLGkpLHQuY2xvc2VQYXRoKCksdGhpcy5fcmVuZGVyRmlsbCh0KSx0aGlzLl9yZW5kZXJTdHJva2UodCl9LF9yZW5kZXJEYXNoZWRTdHJva2U6ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy53aWR0aC8yLHI9dGhpcy5oZWlnaHQvMjt0LmJlZ2luUGF0aCgpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LC1pLHIsMCwtcix0aGlzLnN0cm9rZURhc2hBcnJheSksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsMCwtcixpLHIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGksciwtaSxyLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSx0LmNsb3NlUGF0aCgpfSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jcmVhdGVCYXNlU1ZHTWFya3VwKCksaT10aGlzLndpZHRoLzIscj10aGlzLmhlaWdodC8yLHM9Wy1pK1wiIFwiK3IsXCIwIFwiKy1yLGkrXCIgXCIrcl0uam9pbihcIixcIik7cmV0dXJuIGUucHVzaChcIjxwb2x5Z29uIFwiLCdwb2ludHM9XCInLHMsJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksJ1wiLz4nKSx0P3QoZS5qb2luKFwiXCIpKTplLmpvaW4oXCJcIil9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gMX19KSx2b2lkKGUuVHJpYW5nbGUuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuVHJpYW5nbGUodCl9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT0yKk1hdGguUEkscj1lLnV0aWwub2JqZWN0LmV4dGVuZDtyZXR1cm4gZS5FbGxpcHNlP3ZvaWQgZS53YXJuKFwiZmFicmljLkVsbGlwc2UgaXMgYWxyZWFkeSBkZWZpbmVkLlwiKTooZS5FbGxpcHNlPWUudXRpbC5jcmVhdGVDbGFzcyhlLk9iamVjdCx7dHlwZTpcImVsbGlwc2VcIixyeDowLHJ5OjAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLHQpLHRoaXMuc2V0KFwicnhcIix0LnJ4fHwwKSx0aGlzLnNldChcInJ5XCIsdC5yeXx8MCl9LF9zZXQ6ZnVuY3Rpb24odCxlKXtzd2l0Y2godGhpcy5jYWxsU3VwZXIoXCJfc2V0XCIsdCxlKSx0KXtjYXNlXCJyeFwiOnRoaXMucng9ZSx0aGlzLnNldChcIndpZHRoXCIsMiplKTticmVhaztjYXNlXCJyeVwiOnRoaXMucnk9ZSx0aGlzLnNldChcImhlaWdodFwiLDIqZSl9cmV0dXJuIHRoaXN9LGdldFJ4OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0KFwicnhcIikqdGhpcy5nZXQoXCJzY2FsZVhcIil9LGdldFJ5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0KFwicnlcIikqdGhpcy5nZXQoXCJzY2FsZVlcIil9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiByKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIix0KSx7cng6dGhpcy5nZXQoXCJyeFwiKSxyeTp0aGlzLmdldChcInJ5XCIpfSl9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxpPTAscj0wO3JldHVybiB0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZSYmKGk9dGhpcy5sZWZ0K3RoaXMucngscj10aGlzLnRvcCt0aGlzLnJ5KSxlLnB1c2goXCI8ZWxsaXBzZSBcIiwnY3g9XCInLGksJ1wiIGN5PVwiJyxyLCdcIiAnLCdyeD1cIicsdGhpcy5yeCwnXCIgcnk9XCInLHRoaXMucnksJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCIvPlxcbicpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sX3JlbmRlcjpmdW5jdGlvbih0LGUpe3QuYmVnaW5QYXRoKCksdC5zYXZlKCksdC50cmFuc2Zvcm0oMSwwLDAsdGhpcy5yeS90aGlzLnJ4LDAsMCksdC5hcmMoZT90aGlzLmxlZnQrdGhpcy5yeDowLGU/KHRoaXMudG9wK3RoaXMucnkpKnRoaXMucngvdGhpcy5yeTowLHRoaXMucngsMCxpLCExKSx0LnJlc3RvcmUoKSx0aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiAxfX0pLGUuRWxsaXBzZS5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoXCJjeCBjeSByeCByeVwiLnNwbGl0KFwiIFwiKSksZS5FbGxpcHNlLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSl7aXx8KGk9e30pO3ZhciBzPWUucGFyc2VBdHRyaWJ1dGVzKHQsZS5FbGxpcHNlLkFUVFJJQlVURV9OQU1FUyk7cy5sZWZ0PXMubGVmdHx8MCxzLnRvcD1zLnRvcHx8MDt2YXIgbj1uZXcgZS5FbGxpcHNlKHIocyxpKSk7cmV0dXJuIG4udG9wLT1uLnJ5LG4ubGVmdC09bi5yeCxufSx2b2lkKGUuRWxsaXBzZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5FbGxpcHNlKHQpfSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQ7aWYoZS5SZWN0KXJldHVybiB2b2lkIGNvbnNvbGUud2FybihcImZhYnJpYy5SZWN0IGlzIGFscmVhZHkgZGVmaW5lZFwiKTt2YXIgcj1lLk9iamVjdC5wcm90b3R5cGUuc3RhdGVQcm9wZXJ0aWVzLmNvbmNhdCgpO3IucHVzaChcInJ4XCIsXCJyeVwiLFwieFwiLFwieVwiKSxlLlJlY3Q9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHtzdGF0ZVByb3BlcnRpZXM6cix0eXBlOlwicmVjdFwiLHJ4OjAscnk6MCxzdHJva2VEYXNoQXJyYXk6bnVsbCxpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsdCksdGhpcy5faW5pdFJ4UnkoKX0sX2luaXRSeFJ5OmZ1bmN0aW9uKCl7dGhpcy5yeCYmIXRoaXMucnk/dGhpcy5yeT10aGlzLnJ4OnRoaXMucnkmJiF0aGlzLnJ4JiYodGhpcy5yeD10aGlzLnJ5KX0sX3JlbmRlcjpmdW5jdGlvbih0LGUpe2lmKDE9PT10aGlzLndpZHRoJiYxPT09dGhpcy5oZWlnaHQpcmV0dXJuIHZvaWQgdC5maWxsUmVjdCgwLDAsMSwxKTt2YXIgaT10aGlzLnJ4P01hdGgubWluKHRoaXMucngsdGhpcy53aWR0aC8yKTowLHI9dGhpcy5yeT9NYXRoLm1pbih0aGlzLnJ5LHRoaXMuaGVpZ2h0LzIpOjAscz10aGlzLndpZHRoLG49dGhpcy5oZWlnaHQsbz1lP3RoaXMubGVmdDotdGhpcy53aWR0aC8yLGE9ZT90aGlzLnRvcDotdGhpcy5oZWlnaHQvMixoPTAhPT1pfHwwIT09cixjPS40NDc3MTUyNTAyO3QuYmVnaW5QYXRoKCksdC5tb3ZlVG8obytpLGEpLHQubGluZVRvKG8rcy1pLGEpLGgmJnQuYmV6aWVyQ3VydmVUbyhvK3MtYyppLGEsbytzLGErYypyLG8rcyxhK3IpLHQubGluZVRvKG8rcyxhK24tciksaCYmdC5iZXppZXJDdXJ2ZVRvKG8rcyxhK24tYypyLG8rcy1jKmksYStuLG8rcy1pLGErbiksdC5saW5lVG8obytpLGErbiksaCYmdC5iZXppZXJDdXJ2ZVRvKG8rYyppLGErbixvLGErbi1jKnIsbyxhK24tciksdC5saW5lVG8obyxhK3IpLGgmJnQuYmV6aWVyQ3VydmVUbyhvLGErYypyLG8rYyppLGEsbytpLGEpLHQuY2xvc2VQYXRoKCksdGhpcy5fcmVuZGVyRmlsbCh0KSx0aGlzLl9yZW5kZXJTdHJva2UodCl9LF9yZW5kZXJEYXNoZWRTdHJva2U6ZnVuY3Rpb24odCl7dmFyIGk9LXRoaXMud2lkdGgvMixyPS10aGlzLmhlaWdodC8yLHM9dGhpcy53aWR0aCxuPXRoaXMuaGVpZ2h0O3QuYmVnaW5QYXRoKCksZS51dGlsLmRyYXdEYXNoZWRMaW5lKHQsaSxyLGkrcyxyLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxlLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxpK3MscixpK3MscituLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxlLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxpK3MscituLGkscituLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxlLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxpLHIrbixpLHIsdGhpcy5zdHJva2VEYXNoQXJyYXkpLHQuY2xvc2VQYXRoKCl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPWkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtyeDp0aGlzLmdldChcInJ4XCIpfHwwLHJ5OnRoaXMuZ2V0KFwicnlcIil8fDB9KTtyZXR1cm4gdGhpcy5pbmNsdWRlRGVmYXVsdFZhbHVlc3x8dGhpcy5fcmVtb3ZlRGVmYXVsdFZhbHVlcyhlKSxlfSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9jcmVhdGVCYXNlU1ZHTWFya3VwKCksaT10aGlzLmxlZnQscj10aGlzLnRvcDtyZXR1cm4gdGhpcy5ncm91cCYmXCJwYXRoLWdyb3VwXCI9PT10aGlzLmdyb3VwLnR5cGV8fChpPS10aGlzLndpZHRoLzIscj0tdGhpcy5oZWlnaHQvMiksZS5wdXNoKFwiPHJlY3QgXCIsJ3g9XCInLGksJ1wiIHk9XCInLHIsJ1wiIHJ4PVwiJyx0aGlzLmdldChcInJ4XCIpLCdcIiByeT1cIicsdGhpcy5nZXQoXCJyeVwiKSwnXCIgd2lkdGg9XCInLHRoaXMud2lkdGgsJ1wiIGhlaWdodD1cIicsdGhpcy5oZWlnaHQsJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCIvPlxcbicpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiAxfX0pLGUuUmVjdC5BVFRSSUJVVEVfTkFNRVM9ZS5TSEFSRURfQVRUUklCVVRFUy5jb25jYXQoXCJ4IHkgcnggcnkgd2lkdGggaGVpZ2h0XCIuc3BsaXQoXCIgXCIpKSxlLlJlY3QuZnJvbUVsZW1lbnQ9ZnVuY3Rpb24odCxyKXtpZighdClyZXR1cm4gbnVsbDtyPXJ8fHt9O3ZhciBzPWUucGFyc2VBdHRyaWJ1dGVzKHQsZS5SZWN0LkFUVFJJQlVURV9OQU1FUyk7cy5sZWZ0PXMubGVmdHx8MCxzLnRvcD1zLnRvcHx8MDt2YXIgbj1uZXcgZS5SZWN0KGkocj9lLnV0aWwub2JqZWN0LmNsb25lKHIpOnt9LHMpKTtyZXR1cm4gbi52aXNpYmxlPW4ud2lkdGg+MCYmbi5oZWlnaHQ+MCxufSxlLlJlY3QuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuUmVjdCh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7cmV0dXJuIGUuUG9seWxpbmU/dm9pZCBlLndhcm4oXCJmYWJyaWMuUG9seWxpbmUgaXMgYWxyZWFkeSBkZWZpbmVkXCIpOihlLlBvbHlsaW5lPWUudXRpbC5jcmVhdGVDbGFzcyhlLk9iamVjdCx7dHlwZTpcInBvbHlsaW5lXCIscG9pbnRzOm51bGwsbWluWDowLG1pblk6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIGUuUG9seWdvbi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsdCxpKX0sX2NhbGNEaW1lbnNpb25zOmZ1bmN0aW9uKCl7cmV0dXJuIGUuUG9seWdvbi5wcm90b3R5cGUuX2NhbGNEaW1lbnNpb25zLmNhbGwodGhpcyl9LF9hcHBseVBvaW50T2Zmc2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuUG9seWdvbi5wcm90b3R5cGUuX2FwcGx5UG9pbnRPZmZzZXQuY2FsbCh0aGlzKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIGUuUG9seWdvbi5wcm90b3R5cGUudG9PYmplY3QuY2FsbCh0aGlzLHQpfSx0b1NWRzpmdW5jdGlvbih0KXtyZXR1cm4gZS5Qb2x5Z29uLnByb3RvdHlwZS50b1NWRy5jYWxsKHRoaXMsdCl9LF9yZW5kZXI6ZnVuY3Rpb24odCl7ZS5Qb2x5Z29uLnByb3RvdHlwZS5jb21tb25SZW5kZXIuY2FsbCh0aGlzLHQpJiYodGhpcy5fcmVuZGVyRmlsbCh0KSx0aGlzLl9yZW5kZXJTdHJva2UodCkpfSxfcmVuZGVyRGFzaGVkU3Ryb2tlOmZ1bmN0aW9uKHQpe3ZhciBpLHI7dC5iZWdpblBhdGgoKTtmb3IodmFyIHM9MCxuPXRoaXMucG9pbnRzLmxlbmd0aDtuPnM7cysrKWk9dGhpcy5wb2ludHNbc10scj10aGlzLnBvaW50c1tzKzFdfHxpLGUudXRpbC5kcmF3RGFzaGVkTGluZSh0LGkueCxpLnksci54LHIueSx0aGlzLnN0cm9rZURhc2hBcnJheSl9LGNvbXBsZXhpdHk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXQoXCJwb2ludHNcIikubGVuZ3RofX0pLGUuUG9seWxpbmUuQVRUUklCVVRFX05BTUVTPWUuU0hBUkVEX0FUVFJJQlVURVMuY29uY2F0KCksZS5Qb2x5bGluZS5mcm9tRWxlbWVudD1mdW5jdGlvbih0LGkpe2lmKCF0KXJldHVybiBudWxsO2l8fChpPXt9KTt2YXIgcj1lLnBhcnNlUG9pbnRzQXR0cmlidXRlKHQuZ2V0QXR0cmlidXRlKFwicG9pbnRzXCIpKSxzPWUucGFyc2VBdHRyaWJ1dGVzKHQsZS5Qb2x5bGluZS5BVFRSSUJVVEVfTkFNRVMpO3JldHVybiBuZXcgZS5Qb2x5bGluZShyLGUudXRpbC5vYmplY3QuZXh0ZW5kKHMsaSkpfSx2b2lkKGUuUG9seWxpbmUuZnJvbU9iamVjdD1mdW5jdGlvbih0KXt2YXIgaT10LnBvaW50cztyZXR1cm4gbmV3IGUuUG9seWxpbmUoaSx0LCEwKX0pKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kLHI9ZS51dGlsLmFycmF5Lm1pbixzPWUudXRpbC5hcnJheS5tYXgsbj1lLnV0aWwudG9GaXhlZDtyZXR1cm4gZS5Qb2x5Z29uP3ZvaWQgZS53YXJuKFwiZmFicmljLlBvbHlnb24gaXMgYWxyZWFkeSBkZWZpbmVkXCIpOihlLlBvbHlnb249ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHt0eXBlOlwicG9seWdvblwiLHBvaW50czpudWxsLG1pblg6MCxtaW5ZOjAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2U9ZXx8e30sdGhpcy5wb2ludHM9dHx8W10sdGhpcy5jYWxsU3VwZXIoXCJpbml0aWFsaXplXCIsZSksdGhpcy5fY2FsY0RpbWVuc2lvbnMoKSxcInRvcFwiaW4gZXx8KHRoaXMudG9wPXRoaXMubWluWSksXCJsZWZ0XCJpbiBlfHwodGhpcy5sZWZ0PXRoaXMubWluWCl9LF9jYWxjRGltZW5zaW9uczpmdW5jdGlvbigpe3ZhciB0PXRoaXMucG9pbnRzLGU9cih0LFwieFwiKSxpPXIodCxcInlcIiksbj1zKHQsXCJ4XCIpLG89cyh0LFwieVwiKTt0aGlzLndpZHRoPW4tZXx8MCx0aGlzLmhlaWdodD1vLWl8fDAsdGhpcy5taW5YPWV8fDAsdGhpcy5taW5ZPWl8fDB9LF9hcHBseVBvaW50T2Zmc2V0OmZ1bmN0aW9uKCl7dGhpcy5wb2ludHMuZm9yRWFjaChmdW5jdGlvbih0KXt0LngtPXRoaXMubWluWCt0aGlzLndpZHRoLzIsdC55LT10aGlzLm1pblkrdGhpcy5oZWlnaHQvMn0sdGhpcyl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIix0KSx7cG9pbnRzOnRoaXMucG9pbnRzLmNvbmNhdCgpfSl9LHRvU1ZHOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxpPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxyPTAscz10aGlzLnBvaW50cy5sZW5ndGg7cz5yO3IrKyllLnB1c2gobih0aGlzLnBvaW50c1tyXS54LDIpLFwiLFwiLG4odGhpcy5wb2ludHNbcl0ueSwyKSxcIiBcIik7cmV0dXJuIGkucHVzaChcIjxcIix0aGlzLnR5cGUsXCIgXCIsJ3BvaW50cz1cIicsZS5qb2luKFwiXCIpLCdcIiBzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIgdHJhbnNmb3JtPVwiJyx0aGlzLmdldFN2Z1RyYW5zZm9ybSgpLFwiIFwiLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiLz5cXG4nKSx0P3QoaS5qb2luKFwiXCIpKTppLmpvaW4oXCJcIil9LF9yZW5kZXI6ZnVuY3Rpb24odCl7dGhpcy5jb21tb25SZW5kZXIodCkmJih0aGlzLl9yZW5kZXJGaWxsKHQpLCh0aGlzLnN0cm9rZXx8dGhpcy5zdHJva2VEYXNoQXJyYXkpJiYodC5jbG9zZVBhdGgoKSx0aGlzLl9yZW5kZXJTdHJva2UodCkpKX0sY29tbW9uUmVuZGVyOmZ1bmN0aW9uKHQpe3ZhciBlLGk9dGhpcy5wb2ludHMubGVuZ3RoO2lmKCFpfHxpc05hTih0aGlzLnBvaW50c1tpLTFdLnkpKXJldHVybiExO3QuYmVnaW5QYXRoKCksdGhpcy5fYXBwbHlQb2ludE9mZnNldCYmKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlfHx0aGlzLl9hcHBseVBvaW50T2Zmc2V0KCksdGhpcy5fYXBwbHlQb2ludE9mZnNldD1udWxsKSx0Lm1vdmVUbyh0aGlzLnBvaW50c1swXS54LHRoaXMucG9pbnRzWzBdLnkpO2Zvcih2YXIgcj0wO2k+cjtyKyspZT10aGlzLnBvaW50c1tyXSx0LmxpbmVUbyhlLngsZS55KTtyZXR1cm4hMH0sX3JlbmRlckRhc2hlZFN0cm9rZTpmdW5jdGlvbih0KXtlLlBvbHlsaW5lLnByb3RvdHlwZS5fcmVuZGVyRGFzaGVkU3Ryb2tlLmNhbGwodGhpcyx0KSx0LmNsb3NlUGF0aCgpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucG9pbnRzLmxlbmd0aH19KSxlLlBvbHlnb24uQVRUUklCVVRFX05BTUVTPWUuU0hBUkVEX0FUVFJJQlVURVMuY29uY2F0KCksZS5Qb2x5Z29uLmZyb21FbGVtZW50PWZ1bmN0aW9uKHQscil7aWYoIXQpcmV0dXJuIG51bGw7cnx8KHI9e30pO3ZhciBzPWUucGFyc2VQb2ludHNBdHRyaWJ1dGUodC5nZXRBdHRyaWJ1dGUoXCJwb2ludHNcIikpLG49ZS5wYXJzZUF0dHJpYnV0ZXModCxlLlBvbHlnb24uQVRUUklCVVRFX05BTUVTKTtyZXR1cm4gbmV3IGUuUG9seWdvbihzLGkobixyKSl9LHZvaWQoZS5Qb2x5Z29uLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLlBvbHlnb24odC5wb2ludHMsdCwhMCl9KSl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwuYXJyYXkubWluLHI9ZS51dGlsLmFycmF5Lm1heCxzPWUudXRpbC5vYmplY3QuZXh0ZW5kLG49T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxvPWUudXRpbC5kcmF3QXJjLGE9e206MixsOjIsaDoxLHY6MSxjOjYsczo0LHE6NCx0OjIsYTo3fSxoPXttOlwibFwiLE06XCJMXCJ9O3JldHVybiBlLlBhdGg/dm9pZCBlLndhcm4oXCJmYWJyaWMuUGF0aCBpcyBhbHJlYWR5IGRlZmluZWRcIik6KGUuUGF0aD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5PYmplY3Qse3R5cGU6XCJwYXRoXCIscGF0aDpudWxsLG1pblg6MCxtaW5ZOjAsaW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2lmKGU9ZXx8e30sdGhpcy5zZXRPcHRpb25zKGUpLCF0KXRocm93IG5ldyBFcnJvcihcImBwYXRoYCBhcmd1bWVudCBpcyByZXF1aXJlZFwiKTt2YXIgaT1cIltvYmplY3QgQXJyYXldXCI9PT1uLmNhbGwodCk7dGhpcy5wYXRoPWk/dDp0Lm1hdGNoJiZ0Lm1hdGNoKC9bbXpsaHZjc3F0YV1bXm16bGh2Y3NxdGFdKi9naSksdGhpcy5wYXRoJiYoaXx8KHRoaXMucGF0aD10aGlzLl9wYXJzZVBhdGgoKSksdGhpcy5fc2V0UG9zaXRpb25EaW1lbnNpb25zKGUpLGUuc291cmNlUGF0aCYmdGhpcy5zZXRTb3VyY2VQYXRoKGUuc291cmNlUGF0aCkpfSxfc2V0UG9zaXRpb25EaW1lbnNpb25zOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX3BhcnNlRGltZW5zaW9ucygpO3RoaXMubWluWD1lLmxlZnQsdGhpcy5taW5ZPWUudG9wLHRoaXMud2lkdGg9ZS53aWR0aCx0aGlzLmhlaWdodD1lLmhlaWdodCxcInVuZGVmaW5lZFwiPT10eXBlb2YgdC5sZWZ0JiYodGhpcy5sZWZ0PWUubGVmdCsoXCJjZW50ZXJcIj09PXRoaXMub3JpZ2luWD90aGlzLndpZHRoLzI6XCJyaWdodFwiPT09dGhpcy5vcmlnaW5YP3RoaXMud2lkdGg6MCkpLFwidW5kZWZpbmVkXCI9PXR5cGVvZiB0LnRvcCYmKHRoaXMudG9wPWUudG9wKyhcImNlbnRlclwiPT09dGhpcy5vcmlnaW5ZP3RoaXMuaGVpZ2h0LzI6XCJib3R0b21cIj09PXRoaXMub3JpZ2luWT90aGlzLmhlaWdodDowKSksdGhpcy5wYXRoT2Zmc2V0PXRoaXMucGF0aE9mZnNldHx8e3g6dGhpcy5taW5YK3RoaXMud2lkdGgvMix5OnRoaXMubWluWSt0aGlzLmhlaWdodC8yfX0sX3JlbmRlcjpmdW5jdGlvbih0KXt2YXIgZSxpLHIscz1udWxsLG49MCxhPTAsaD0wLGM9MCxsPTAsdT0wLGY9LXRoaXMucGF0aE9mZnNldC54LGQ9LXRoaXMucGF0aE9mZnNldC55O3RoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlJiYoZj0wLGQ9MCksdC5iZWdpblBhdGgoKTtmb3IodmFyIGc9MCxwPXRoaXMucGF0aC5sZW5ndGg7cD5nOysrZyl7c3dpdGNoKGU9dGhpcy5wYXRoW2ddLGVbMF0pe2Nhc2VcImxcIjpoKz1lWzFdLGMrPWVbMl0sdC5saW5lVG8oaCtmLGMrZCk7YnJlYWs7Y2FzZVwiTFwiOmg9ZVsxXSxjPWVbMl0sdC5saW5lVG8oaCtmLGMrZCk7YnJlYWs7Y2FzZVwiaFwiOmgrPWVbMV0sdC5saW5lVG8oaCtmLGMrZCk7YnJlYWs7Y2FzZVwiSFwiOmg9ZVsxXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJ2XCI6Yys9ZVsxXSx0LmxpbmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJWXCI6Yz1lWzFdLHQubGluZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcIm1cIjpoKz1lWzFdLGMrPWVbMl0sbj1oLGE9Yyx0Lm1vdmVUbyhoK2YsYytkKTticmVhaztjYXNlXCJNXCI6aD1lWzFdLGM9ZVsyXSxuPWgsYT1jLHQubW92ZVRvKGgrZixjK2QpO2JyZWFrO2Nhc2VcImNcIjppPWgrZVs1XSxyPWMrZVs2XSxsPWgrZVszXSx1PWMrZVs0XSx0LmJlemllckN1cnZlVG8oaCtlWzFdK2YsYytlWzJdK2QsbCtmLHUrZCxpK2YscitkKSxoPWksYz1yO2JyZWFrO2Nhc2VcIkNcIjpoPWVbNV0sYz1lWzZdLGw9ZVszXSx1PWVbNF0sdC5iZXppZXJDdXJ2ZVRvKGVbMV0rZixlWzJdK2QsbCtmLHUrZCxoK2YsYytkKTticmVhaztjYXNlXCJzXCI6aT1oK2VbM10scj1jK2VbNF0sbnVsbD09PXNbMF0ubWF0Y2goL1tDY1NzXS8pPyhsPWgsdT1jKToobD0yKmgtbCx1PTIqYy11KSx0LmJlemllckN1cnZlVG8obCtmLHUrZCxoK2VbMV0rZixjK2VbMl0rZCxpK2YscitkKSxsPWgrZVsxXSx1PWMrZVsyXSxoPWksYz1yO2JyZWFrO2Nhc2VcIlNcIjppPWVbM10scj1lWzRdLG51bGw9PT1zWzBdLm1hdGNoKC9bQ2NTc10vKT8obD1oLHU9Yyk6KGw9MipoLWwsdT0yKmMtdSksdC5iZXppZXJDdXJ2ZVRvKGwrZix1K2QsZVsxXStmLGVbMl0rZCxpK2YscitkKSxoPWksYz1yLGw9ZVsxXSx1PWVbMl07YnJlYWs7Y2FzZVwicVwiOmk9aCtlWzNdLHI9YytlWzRdLGw9aCtlWzFdLHU9YytlWzJdLHQucXVhZHJhdGljQ3VydmVUbyhsK2YsdStkLGkrZixyK2QpLGg9aSxjPXI7YnJlYWs7Y2FzZVwiUVwiOmk9ZVszXSxyPWVbNF0sdC5xdWFkcmF0aWNDdXJ2ZVRvKGVbMV0rZixlWzJdK2QsaStmLHIrZCksaD1pLGM9cixsPWVbMV0sdT1lWzJdO2JyZWFrO2Nhc2VcInRcIjppPWgrZVsxXSxyPWMrZVsyXSxudWxsPT09c1swXS5tYXRjaCgvW1FxVHRdLyk/KGw9aCx1PWMpOihsPTIqaC1sLHU9MipjLXUpLHQucXVhZHJhdGljQ3VydmVUbyhsK2YsdStkLGkrZixyK2QpLGg9aSxjPXI7YnJlYWs7Y2FzZVwiVFwiOmk9ZVsxXSxyPWVbMl0sbnVsbD09PXNbMF0ubWF0Y2goL1tRcVR0XS8pPyhsPWgsdT1jKToobD0yKmgtbCx1PTIqYy11KSx0LnF1YWRyYXRpY0N1cnZlVG8obCtmLHUrZCxpK2YscitkKSxoPWksYz1yO2JyZWFrO2Nhc2VcImFcIjpvKHQsaCtmLGMrZCxbZVsxXSxlWzJdLGVbM10sZVs0XSxlWzVdLGVbNl0raCtmLGVbN10rYytkXSksaCs9ZVs2XSxjKz1lWzddO2JyZWFrO2Nhc2VcIkFcIjpvKHQsaCtmLGMrZCxbZVsxXSxlWzJdLGVbM10sZVs0XSxlWzVdLGVbNl0rZixlWzddK2RdKSxoPWVbNl0sYz1lWzddO2JyZWFrO2Nhc2VcInpcIjpjYXNlXCJaXCI6aD1uLGM9YSx0LmNsb3NlUGF0aCgpfXM9ZX10aGlzLl9yZW5kZXJGaWxsKHQpLHRoaXMuX3JlbmRlclN0cm9rZSh0KX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLlBhdGggKFwiK3RoaXMuY29tcGxleGl0eSgpKycpOiB7IFwidG9wXCI6ICcrdGhpcy50b3ArJywgXCJsZWZ0XCI6ICcrdGhpcy5sZWZ0K1wiIH0+XCJ9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPXModGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtwYXRoOnRoaXMucGF0aC5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQuc2xpY2UoKX0pLHBhdGhPZmZzZXQ6dGhpcy5wYXRoT2Zmc2V0fSk7cmV0dXJuIHRoaXMuc291cmNlUGF0aCYmKGUuc291cmNlUGF0aD10aGlzLnNvdXJjZVBhdGgpLHRoaXMudHJhbnNmb3JtTWF0cml4JiYoZS50cmFuc2Zvcm1NYXRyaXg9dGhpcy50cmFuc2Zvcm1NYXRyaXgpLGV9LHRvRGF0YWxlc3NPYmplY3Q6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy50b09iamVjdCh0KTtyZXR1cm4gdGhpcy5zb3VyY2VQYXRoJiYoZS5wYXRoPXRoaXMuc291cmNlUGF0aCksZGVsZXRlIGUuc291cmNlUGF0aCxlfSx0b1NWRzpmdW5jdGlvbih0KXtmb3IodmFyIGU9W10saT10aGlzLl9jcmVhdGVCYXNlU1ZHTWFya3VwKCkscj1cIlwiLHM9MCxuPXRoaXMucGF0aC5sZW5ndGg7bj5zO3MrKyllLnB1c2godGhpcy5wYXRoW3NdLmpvaW4oXCIgXCIpKTt2YXIgbz1lLmpvaW4oXCIgXCIpO3JldHVybiB0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZXx8KHI9XCIgdHJhbnNsYXRlKFwiKy10aGlzLnBhdGhPZmZzZXQueCtcIiwgXCIrLXRoaXMucGF0aE9mZnNldC55K1wiKSBcIiksaS5wdXNoKFwiPHBhdGggXCIsJ2Q9XCInLG8sJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCkscix0aGlzLmdldFN2Z1RyYW5zZm9ybU1hdHJpeCgpLCdcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgJyxcIi8+XFxuXCIpLHQ/dChpLmpvaW4oXCJcIikpOmkuam9pbihcIlwiKX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhdGgubGVuZ3RofSxfcGFyc2VQYXRoOmZ1bmN0aW9uKCl7Zm9yKHZhciB0LGUsaSxyLHMsbj1bXSxvPVtdLGM9LyhbLStdPygoXFxkK1xcLlxcZCspfCgoXFxkKyl8KFxcLlxcZCspKSkoPzplWy0rXT9cXGQrKT8pL2dpLGw9MCx1PXRoaXMucGF0aC5sZW5ndGg7dT5sO2wrKyl7Zm9yKHQ9dGhpcy5wYXRoW2xdLHI9dC5zbGljZSgxKS50cmltKCksby5sZW5ndGg9MDtpPWMuZXhlYyhyKTspby5wdXNoKGlbMF0pO3M9W3QuY2hhckF0KDApXTtmb3IodmFyIGY9MCxkPW8ubGVuZ3RoO2Q+ZjtmKyspZT1wYXJzZUZsb2F0KG9bZl0pLGlzTmFOKGUpfHxzLnB1c2goZSk7dmFyIGc9c1swXSxwPWFbZy50b0xvd2VyQ2FzZSgpXSx2PWhbZ118fGc7aWYocy5sZW5ndGgtMT5wKWZvcih2YXIgYj0xLG09cy5sZW5ndGg7bT5iO2IrPXApbi5wdXNoKFtnXS5jb25jYXQocy5zbGljZShiLGIrcCkpKSxnPXY7ZWxzZSBuLnB1c2gocyl9cmV0dXJuIG59LF9wYXJzZURpbWVuc2lvbnM6ZnVuY3Rpb24oKXtmb3IodmFyIHQscyxuLG8sYT1bXSxoPVtdLGM9bnVsbCxsPTAsdT0wLGY9MCxkPTAsZz0wLHA9MCx2PTAsYj10aGlzLnBhdGgubGVuZ3RoO2I+djsrK3Ype3N3aXRjaCh0PXRoaXMucGF0aFt2XSx0WzBdKXtjYXNlXCJsXCI6Zis9dFsxXSxkKz10WzJdLG89W107YnJlYWs7Y2FzZVwiTFwiOmY9dFsxXSxkPXRbMl0sbz1bXTticmVhaztjYXNlXCJoXCI6Zis9dFsxXSxvPVtdO2JyZWFrO2Nhc2VcIkhcIjpmPXRbMV0sbz1bXTticmVhaztjYXNlXCJ2XCI6ZCs9dFsxXSxvPVtdO2JyZWFrO2Nhc2VcIlZcIjpkPXRbMV0sbz1bXTticmVhaztjYXNlXCJtXCI6Zis9dFsxXSxkKz10WzJdLGw9Zix1PWQsbz1bXTticmVhaztjYXNlXCJNXCI6Zj10WzFdLGQ9dFsyXSxsPWYsdT1kLG89W107YnJlYWs7Y2FzZVwiY1wiOnM9Zit0WzVdLG49ZCt0WzZdLGc9Zit0WzNdLHA9ZCt0WzRdLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGYrdFsxXSxkK3RbMl0sZyxwLHMsbiksZj1zLGQ9bjticmVhaztjYXNlXCJDXCI6Zj10WzVdLGQ9dFs2XSxnPXRbM10scD10WzRdLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLHRbMV0sdFsyXSxnLHAsZixkKTticmVhaztjYXNlXCJzXCI6cz1mK3RbM10sbj1kK3RbNF0sbnVsbD09PWNbMF0ubWF0Y2goL1tDY1NzXS8pPyhnPWYscD1kKTooZz0yKmYtZyxwPTIqZC1wKSxvPWUudXRpbC5nZXRCb3VuZHNPZkN1cnZlKGYsZCxnLHAsZit0WzFdLGQrdFsyXSxzLG4pLGc9Zit0WzFdLHA9ZCt0WzJdLGY9cyxkPW47YnJlYWs7Y2FzZVwiU1wiOnM9dFszXSxuPXRbNF0sbnVsbD09PWNbMF0ubWF0Y2goL1tDY1NzXS8pPyhnPWYscD1kKTooZz0yKmYtZyxwPTIqZC1wKSxvPWUudXRpbC5nZXRCb3VuZHNPZkN1cnZlKGYsZCxnLHAsdFsxXSx0WzJdLHMsbiksZj1zLGQ9bixnPXRbMV0scD10WzJdO2JyZWFrO2Nhc2VcInFcIjpzPWYrdFszXSxuPWQrdFs0XSxnPWYrdFsxXSxwPWQrdFsyXSxvPWUudXRpbC5nZXRCb3VuZHNPZkN1cnZlKGYsZCxnLHAsZyxwLHMsbiksZj1zLGQ9bjticmVhaztjYXNlXCJRXCI6Zz10WzFdLHA9dFsyXSxvPWUudXRpbC5nZXRCb3VuZHNPZkN1cnZlKGYsZCxnLHAsZyxwLHRbM10sdFs0XSksZj10WzNdLGQ9dFs0XTticmVhaztjYXNlXCJ0XCI6cz1mK3RbMV0sbj1kK3RbMl0sbnVsbD09PWNbMF0ubWF0Y2goL1tRcVR0XS8pPyhnPWYscD1kKTooZz0yKmYtZyxwPTIqZC1wKSxvPWUudXRpbC5nZXRCb3VuZHNPZkN1cnZlKGYsZCxnLHAsZyxwLHMsbiksZj1zLGQ9bjticmVhaztjYXNlXCJUXCI6cz10WzFdLG49dFsyXSxudWxsPT09Y1swXS5tYXRjaCgvW1FxVHRdLyk/KGc9ZixwPWQpOihnPTIqZi1nLHA9MipkLXApLG89ZS51dGlsLmdldEJvdW5kc09mQ3VydmUoZixkLGcscCxnLHAscyxuKSxmPXMsZD1uO2JyZWFrO2Nhc2VcImFcIjpvPWUudXRpbC5nZXRCb3VuZHNPZkFyYyhmLGQsdFsxXSx0WzJdLHRbM10sdFs0XSx0WzVdLHRbNl0rZix0WzddK2QpLGYrPXRbNl0sZCs9dFs3XTticmVhaztjYXNlXCJBXCI6bz1lLnV0aWwuZ2V0Qm91bmRzT2ZBcmMoZixkLHRbMV0sdFsyXSx0WzNdLHRbNF0sdFs1XSx0WzZdLHRbN10pLGY9dFs2XSxkPXRbN107YnJlYWs7Y2FzZVwielwiOmNhc2VcIlpcIjpmPWwsZD11fWM9dCxvLmZvckVhY2goZnVuY3Rpb24odCl7YS5wdXNoKHQueCksaC5wdXNoKHQueSl9KSxhLnB1c2goZiksaC5wdXNoKGQpfXZhciBtPWkoYSkseT1pKGgpLF89cihhKSx4PXIoaCksQz1fLW0sUz14LXksdz17bGVmdDptLHRvcDp5LHdpZHRoOkMsaGVpZ2h0OlN9O3JldHVybiB3fX0pLGUuUGF0aC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQsaSl7XCJzdHJpbmdcIj09dHlwZW9mIHQucGF0aD9lLmxvYWRTVkdGcm9tVVJMKHQucGF0aCxmdW5jdGlvbihyKXt2YXIgcz1yWzBdLG49dC5wYXRoO2RlbGV0ZSB0LnBhdGgsZS51dGlsLm9iamVjdC5leHRlbmQocyx0KSxzLnNldFNvdXJjZVBhdGgobiksaShzKX0pOmkobmV3IGUuUGF0aCh0LnBhdGgsdCkpfSxlLlBhdGguQVRUUklCVVRFX05BTUVTPWUuU0hBUkVEX0FUVFJJQlVURVMuY29uY2F0KFtcImRcIl0pLGUuUGF0aC5mcm9tRWxlbWVudD1mdW5jdGlvbih0LGkscil7dmFyIG49ZS5wYXJzZUF0dHJpYnV0ZXModCxlLlBhdGguQVRUUklCVVRFX05BTUVTKTtpJiZpKG5ldyBlLlBhdGgobi5kLHMobixyKSkpfSx2b2lkKGUuUGF0aC5hc3luYz0hMCkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQscj1lLnV0aWwuYXJyYXkuaW52b2tlLHM9ZS5PYmplY3QucHJvdG90eXBlLnRvT2JqZWN0O3JldHVybiBlLlBhdGhHcm91cD92b2lkIGUud2FybihcImZhYnJpYy5QYXRoR3JvdXAgaXMgYWxyZWFkeSBkZWZpbmVkXCIpOihlLlBhdGhHcm91cD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5QYXRoLHt0eXBlOlwicGF0aC1ncm91cFwiLGZpbGw6XCJcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0aGlzLnBhdGhzPXR8fFtdO2Zvcih2YXIgaT10aGlzLnBhdGhzLmxlbmd0aDtpLS07KXRoaXMucGF0aHNbaV0uZ3JvdXA9dGhpcztlLnRvQmVQYXJzZWQmJih0aGlzLnBhcnNlRGltZW5zaW9uc0Zyb21QYXRocyhlKSxkZWxldGUgZS50b0JlUGFyc2VkKSx0aGlzLnNldE9wdGlvbnMoZSksdGhpcy5zZXRDb29yZHMoKSxlLnNvdXJjZVBhdGgmJnRoaXMuc2V0U291cmNlUGF0aChlLnNvdXJjZVBhdGgpfSxwYXJzZURpbWVuc2lvbnNGcm9tUGF0aHM6ZnVuY3Rpb24odCl7Zm9yKHZhciBpLHIscyxuLG8sYT1bXSxoPVtdLGM9dGhpcy50cmFuc2Zvcm1NYXRyaXgsbD10aGlzLnBhdGhzLmxlbmd0aDtsLS07KXtzPXRoaXMucGF0aHNbbF0sbj1zLmhlaWdodCtzLnN0cm9rZVdpZHRoLG89cy53aWR0aCtzLnN0cm9rZVdpZHRoLGk9W3t4OnMubGVmdCx5OnMudG9wfSx7eDpzLmxlZnQrbyx5OnMudG9wfSx7eDpzLmxlZnQseTpzLnRvcCtufSx7eDpzLmxlZnQrbyx5OnMudG9wK259XTtmb3IodmFyIHU9MDt1PGkubGVuZ3RoO3UrKylyPWlbdV0sYyYmKHI9ZS51dGlsLnRyYW5zZm9ybVBvaW50KHIsYywhMSkpLGEucHVzaChyLngpLGgucHVzaChyLnkpfXQud2lkdGg9TWF0aC5tYXguYXBwbHkobnVsbCxhKSx0LmhlaWdodD1NYXRoLm1heC5hcHBseShudWxsLGgpfSxyZW5kZXI6ZnVuY3Rpb24odCl7aWYodGhpcy52aXNpYmxlKXt0LnNhdmUoKSx0aGlzLnRyYW5zZm9ybU1hdHJpeCYmdC50cmFuc2Zvcm0uYXBwbHkodCx0aGlzLnRyYW5zZm9ybU1hdHJpeCksdGhpcy50cmFuc2Zvcm0odCksdGhpcy5fc2V0U2hhZG93KHQpLHRoaXMuY2xpcFRvJiZlLnV0aWwuY2xpcENvbnRleHQodGhpcyx0KSx0LnRyYW5zbGF0ZSgtdGhpcy53aWR0aC8yLC10aGlzLmhlaWdodC8yKTtmb3IodmFyIGk9MCxyPXRoaXMucGF0aHMubGVuZ3RoO3I+aTsrK2kpdGhpcy5wYXRoc1tpXS5yZW5kZXIodCwhMCk7dGhpcy5jbGlwVG8mJnQucmVzdG9yZSgpLHQucmVzdG9yZSgpfX0sX3NldDpmdW5jdGlvbih0LGUpe2lmKFwiZmlsbFwiPT09dCYmZSYmdGhpcy5pc1NhbWVDb2xvcigpKWZvcih2YXIgaT10aGlzLnBhdGhzLmxlbmd0aDtpLS07KXRoaXMucGF0aHNbaV0uX3NldCh0LGUpO3JldHVybiB0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpfSx0b09iamVjdDpmdW5jdGlvbih0KXt2YXIgZT1pKHMuY2FsbCh0aGlzLHQpLHtwYXRoczpyKHRoaXMuZ2V0T2JqZWN0cygpLFwidG9PYmplY3RcIix0KX0pO3JldHVybiB0aGlzLnNvdXJjZVBhdGgmJihlLnNvdXJjZVBhdGg9dGhpcy5zb3VyY2VQYXRoKSxlfSx0b0RhdGFsZXNzT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMudG9PYmplY3QodCk7cmV0dXJuIHRoaXMuc291cmNlUGF0aCYmKGUucGF0aHM9dGhpcy5zb3VyY2VQYXRoKSxlfSx0b1NWRzpmdW5jdGlvbih0KXtmb3IodmFyIGU9dGhpcy5nZXRPYmplY3RzKCksaT10aGlzLmdldFBvaW50QnlPcmlnaW4oXCJsZWZ0XCIsXCJ0b3BcIikscj1cInRyYW5zbGF0ZShcIitpLngrXCIgXCIraS55K1wiKVwiLHM9W1wiPGcgXCIsJ3N0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiAnLCd0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCkscix0aGlzLmdldFN2Z1RyYW5zZm9ybSgpLCdcIiAnLFwiPlxcblwiXSxuPTAsbz1lLmxlbmd0aDtvPm47bisrKXMucHVzaChlW25dLnRvU1ZHKHQpKTtyZXR1cm4gcy5wdXNoKFwiPC9nPlxcblwiKSx0P3Qocy5qb2luKFwiXCIpKTpzLmpvaW4oXCJcIil9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuXCIjPGZhYnJpYy5QYXRoR3JvdXAgKFwiK3RoaXMuY29tcGxleGl0eSgpK1wiKTogeyB0b3A6IFwiK3RoaXMudG9wK1wiLCBsZWZ0OiBcIit0aGlzLmxlZnQrXCIgfT5cIn0saXNTYW1lQ29sb3I6ZnVuY3Rpb24oKXt2YXIgdD0odGhpcy5nZXRPYmplY3RzKClbMF0uZ2V0KFwiZmlsbFwiKXx8XCJcIikudG9Mb3dlckNhc2UoKTtyZXR1cm4gdGhpcy5nZXRPYmplY3RzKCkuZXZlcnkoZnVuY3Rpb24oZSl7cmV0dXJuKGUuZ2V0KFwiZmlsbFwiKXx8XCJcIikudG9Mb3dlckNhc2UoKT09PXR9KX0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnBhdGhzLnJlZHVjZShmdW5jdGlvbih0LGUpe3JldHVybiB0KyhlJiZlLmNvbXBsZXhpdHk/ZS5jb21wbGV4aXR5KCk6MCl9LDApfSxnZXRPYmplY3RzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGF0aHN9fSksZS5QYXRoR3JvdXAuZnJvbU9iamVjdD1mdW5jdGlvbih0LGkpe1wic3RyaW5nXCI9PXR5cGVvZiB0LnBhdGhzP2UubG9hZFNWR0Zyb21VUkwodC5wYXRocyxmdW5jdGlvbihyKXt2YXIgcz10LnBhdGhzO2RlbGV0ZSB0LnBhdGhzO3ZhciBuPWUudXRpbC5ncm91cFNWR0VsZW1lbnRzKHIsdCxzKTtpKG4pfSk6ZS51dGlsLmVubGl2ZW5PYmplY3RzKHQucGF0aHMsZnVuY3Rpb24ocil7ZGVsZXRlIHQucGF0aHMsaShuZXcgZS5QYXRoR3JvdXAocix0KSl9KX0sdm9pZChlLlBhdGhHcm91cC5hc3luYz0hMCkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQscj1lLnV0aWwuYXJyYXkubWluLHM9ZS51dGlsLmFycmF5Lm1heCxuPWUudXRpbC5hcnJheS5pbnZva2U7aWYoIWUuR3JvdXApe3ZhciBvPXtsb2NrTW92ZW1lbnRYOiEwLGxvY2tNb3ZlbWVudFk6ITAsbG9ja1JvdGF0aW9uOiEwLGxvY2tTY2FsaW5nWDohMCxsb2NrU2NhbGluZ1k6ITAsbG9ja1VuaVNjYWxpbmc6ITB9O2UuR3JvdXA9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LGUuQ29sbGVjdGlvbix7dHlwZTpcImdyb3VwXCIsc3Ryb2tlV2lkdGg6MCxpbml0aWFsaXplOmZ1bmN0aW9uKHQsZSl7ZT1lfHx7fSx0aGlzLl9vYmplY3RzPXR8fFtdO2Zvcih2YXIgaT10aGlzLl9vYmplY3RzLmxlbmd0aDtpLS07KXRoaXMuX29iamVjdHNbaV0uZ3JvdXA9dGhpczt0aGlzLm9yaWdpbmFsU3RhdGU9e30sZS5vcmlnaW5YJiYodGhpcy5vcmlnaW5YPWUub3JpZ2luWCksZS5vcmlnaW5ZJiYodGhpcy5vcmlnaW5ZPWUub3JpZ2luWSksdGhpcy5fY2FsY0JvdW5kcygpLHRoaXMuX3VwZGF0ZU9iamVjdHNDb29yZHMoKSx0aGlzLmNhbGxTdXBlcihcImluaXRpYWxpemVcIixlKSx0aGlzLnNldENvb3JkcygpLHRoaXMuc2F2ZUNvb3JkcygpfSxfdXBkYXRlT2JqZWN0c0Nvb3JkczpmdW5jdGlvbigpe3RoaXMuZm9yRWFjaE9iamVjdCh0aGlzLl91cGRhdGVPYmplY3RDb29yZHMsdGhpcyl9LF91cGRhdGVPYmplY3RDb29yZHM6ZnVuY3Rpb24odCl7dmFyIGU9dC5nZXRMZWZ0KCksaT10LmdldFRvcCgpLHI9dGhpcy5nZXRDZW50ZXJQb2ludCgpO3Quc2V0KHtvcmlnaW5hbExlZnQ6ZSxvcmlnaW5hbFRvcDppLGxlZnQ6ZS1yLngsdG9wOmktci55fSksdC5zZXRDb29yZHMoKSx0Ll9fb3JpZ0hhc0NvbnRyb2xzPXQuaGFzQ29udHJvbHMsdC5oYXNDb250cm9scz0hMX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLkdyb3VwOiAoXCIrdGhpcy5jb21wbGV4aXR5KCkrXCIpPlwifSxhZGRXaXRoVXBkYXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9yZXN0b3JlT2JqZWN0c1N0YXRlKCksdCYmKHRoaXMuX29iamVjdHMucHVzaCh0KSx0Lmdyb3VwPXRoaXMsdC5fc2V0KFwiY2FudmFzXCIsdGhpcy5jYW52YXMpKSx0aGlzLmZvckVhY2hPYmplY3QodGhpcy5fc2V0T2JqZWN0QWN0aXZlLHRoaXMpLHRoaXMuX2NhbGNCb3VuZHMoKSx0aGlzLl91cGRhdGVPYmplY3RzQ29vcmRzKCksdGhpc30sX3NldE9iamVjdEFjdGl2ZTpmdW5jdGlvbih0KXt0LnNldChcImFjdGl2ZVwiLCEwKSx0Lmdyb3VwPXRoaXN9LHJlbW92ZVdpdGhVcGRhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX21vdmVGbGlwcGVkT2JqZWN0KHQpLHRoaXMuX3Jlc3RvcmVPYmplY3RzU3RhdGUoKSx0aGlzLmZvckVhY2hPYmplY3QodGhpcy5fc2V0T2JqZWN0QWN0aXZlLHRoaXMpLHRoaXMucmVtb3ZlKHQpLHRoaXMuX2NhbGNCb3VuZHMoKSx0aGlzLl91cGRhdGVPYmplY3RzQ29vcmRzKCksdGhpc30sX29uT2JqZWN0QWRkZWQ6ZnVuY3Rpb24odCl7dC5ncm91cD10aGlzLHQuX3NldChcImNhbnZhc1wiLHRoaXMuY2FudmFzKX0sX29uT2JqZWN0UmVtb3ZlZDpmdW5jdGlvbih0KXtkZWxldGUgdC5ncm91cCx0LnNldChcImFjdGl2ZVwiLCExKX0sZGVsZWdhdGVkUHJvcGVydGllczp7ZmlsbDohMCxvcGFjaXR5OiEwLGZvbnRGYW1pbHk6ITAsZm9udFdlaWdodDohMCxmb250U2l6ZTohMCxmb250U3R5bGU6ITAsbGluZUhlaWdodDohMCx0ZXh0RGVjb3JhdGlvbjohMCx0ZXh0QWxpZ246ITAsYmFja2dyb3VuZENvbG9yOiEwfSxfc2V0OmZ1bmN0aW9uKHQsZSl7aWYodCBpbiB0aGlzLmRlbGVnYXRlZFByb3BlcnRpZXN8fFwiY2FudmFzXCI9PT10KWZvcih2YXIgaT10aGlzLl9vYmplY3RzLmxlbmd0aDtpLS07KXRoaXMuX29iamVjdHNbaV0uc2V0KHQsZSk7dGhpcy5jYWxsU3VwZXIoXCJfc2V0XCIsdCxlKX0sdG9PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHtvYmplY3RzOm4odGhpcy5fb2JqZWN0cyxcInRvT2JqZWN0XCIsdCl9KX0scmVuZGVyOmZ1bmN0aW9uKHQpe2lmKHRoaXMudmlzaWJsZSl7dC5zYXZlKCksdGhpcy50cmFuc2Zvcm1NYXRyaXgmJnQudHJhbnNmb3JtLmFwcGx5KHQsdGhpcy50cmFuc2Zvcm1NYXRyaXgpLHRoaXMudHJhbnNmb3JtKHQpLHRoaXMuY2xpcFRvJiZlLnV0aWwuY2xpcENvbnRleHQodGhpcyx0KTtmb3IodmFyIGk9MCxyPXRoaXMuX29iamVjdHMubGVuZ3RoO3I+aTtpKyspdGhpcy5fcmVuZGVyT2JqZWN0KHRoaXMuX29iamVjdHNbaV0sdCk7dGhpcy5jbGlwVG8mJnQucmVzdG9yZSgpLHQucmVzdG9yZSgpfX0sX3JlbmRlckNvbnRyb2xzOmZ1bmN0aW9uKHQsZSl7dGhpcy5jYWxsU3VwZXIoXCJfcmVuZGVyQ29udHJvbHNcIix0LGUpO2Zvcih2YXIgaT0wLHI9dGhpcy5fb2JqZWN0cy5sZW5ndGg7cj5pO2krKyl0aGlzLl9vYmplY3RzW2ldLl9yZW5kZXJDb250cm9scyh0KX0sX3JlbmRlck9iamVjdDpmdW5jdGlvbih0LGUpe2lmKHQudmlzaWJsZSl7dmFyIGk9dC5oYXNSb3RhdGluZ1BvaW50O3QuaGFzUm90YXRpbmdQb2ludD0hMSx0LnJlbmRlcihlKSx0Lmhhc1JvdGF0aW5nUG9pbnQ9aX19LF9yZXN0b3JlT2JqZWN0c1N0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29iamVjdHMuZm9yRWFjaCh0aGlzLl9yZXN0b3JlT2JqZWN0U3RhdGUsdGhpcyksdGhpc30scmVhbGl6ZVRyYW5zZm9ybTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbW92ZUZsaXBwZWRPYmplY3QodCksdGhpcy5fc2V0T2JqZWN0UG9zaXRpb24odCksdH0sX21vdmVGbGlwcGVkT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPXQuZ2V0KFwib3JpZ2luWFwiKSxpPXQuZ2V0KFwib3JpZ2luWVwiKSxyPXQuZ2V0Q2VudGVyUG9pbnQoKTt0LnNldCh7b3JpZ2luWDpcImNlbnRlclwiLG9yaWdpblk6XCJjZW50ZXJcIixsZWZ0OnIueCx0b3A6ci55fSksdGhpcy5fdG9nZ2xlRmxpcHBpbmcodCk7dmFyIHM9dC5nZXRQb2ludEJ5T3JpZ2luKGUsaSk7cmV0dXJuIHQuc2V0KHtvcmlnaW5YOmUsb3JpZ2luWTppLGxlZnQ6cy54LHRvcDpzLnl9KSx0aGlzfSxfdG9nZ2xlRmxpcHBpbmc6ZnVuY3Rpb24odCl7dGhpcy5mbGlwWCYmKHQudG9nZ2xlKFwiZmxpcFhcIiksdC5zZXQoXCJsZWZ0XCIsLXQuZ2V0KFwibGVmdFwiKSksdC5zZXRBbmdsZSgtdC5nZXRBbmdsZSgpKSksdGhpcy5mbGlwWSYmKHQudG9nZ2xlKFwiZmxpcFlcIiksdC5zZXQoXCJ0b3BcIiwtdC5nZXQoXCJ0b3BcIikpLHQuc2V0QW5nbGUoLXQuZ2V0QW5nbGUoKSkpfSxfcmVzdG9yZU9iamVjdFN0YXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9zZXRPYmplY3RQb3NpdGlvbih0KSx0LnNldENvb3JkcygpLHQuaGFzQ29udHJvbHM9dC5fX29yaWdIYXNDb250cm9scyxkZWxldGUgdC5fX29yaWdIYXNDb250cm9scyx0LnNldChcImFjdGl2ZVwiLCExKSx0LnNldENvb3JkcygpLGRlbGV0ZSB0Lmdyb3VwLHRoaXN9LF9zZXRPYmplY3RQb3NpdGlvbjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldENlbnRlclBvaW50KCksaT10aGlzLl9nZXRSb3RhdGVkTGVmdFRvcCh0KTt0LnNldCh7YW5nbGU6dC5nZXRBbmdsZSgpK3RoaXMuZ2V0QW5nbGUoKSxsZWZ0OmUueCtpLmxlZnQsdG9wOmUueStpLnRvcCxzY2FsZVg6dC5nZXQoXCJzY2FsZVhcIikqdGhpcy5nZXQoXCJzY2FsZVhcIiksc2NhbGVZOnQuZ2V0KFwic2NhbGVZXCIpKnRoaXMuZ2V0KFwic2NhbGVZXCIpfSl9LF9nZXRSb3RhdGVkTGVmdFRvcDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldEFuZ2xlKCkqKE1hdGguUEkvMTgwKTtyZXR1cm57bGVmdDotTWF0aC5zaW4oZSkqdC5nZXRUb3AoKSp0aGlzLmdldChcInNjYWxlWVwiKStNYXRoLmNvcyhlKSp0LmdldExlZnQoKSp0aGlzLmdldChcInNjYWxlWFwiKSx0b3A6TWF0aC5jb3MoZSkqdC5nZXRUb3AoKSp0aGlzLmdldChcInNjYWxlWVwiKStNYXRoLnNpbihlKSp0LmdldExlZnQoKSp0aGlzLmdldChcInNjYWxlWFwiKX19LGRlc3Ryb3k6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb2JqZWN0cy5mb3JFYWNoKHRoaXMuX21vdmVGbGlwcGVkT2JqZWN0LHRoaXMpLHRoaXMuX3Jlc3RvcmVPYmplY3RzU3RhdGUoKX0sc2F2ZUNvb3JkczpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcmlnaW5hbExlZnQ9dGhpcy5nZXQoXCJsZWZ0XCIpLHRoaXMuX29yaWdpbmFsVG9wPXRoaXMuZ2V0KFwidG9wXCIpLHRoaXN9LGhhc01vdmVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29yaWdpbmFsTGVmdCE9PXRoaXMuZ2V0KFwibGVmdFwiKXx8dGhpcy5fb3JpZ2luYWxUb3AhPT10aGlzLmdldChcInRvcFwiKX0sc2V0T2JqZWN0c0Nvb3JkczpmdW5jdGlvbigpe3JldHVybiB0aGlzLmZvckVhY2hPYmplY3QoZnVuY3Rpb24odCl7dC5zZXRDb29yZHMoKX0pLHRoaXN9LF9jYWxjQm91bmRzOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxpLHI9W10scz1bXSxuPVtcInRyXCIsXCJiclwiLFwiYmxcIixcInRsXCJdLG89MCxhPXRoaXMuX29iamVjdHMubGVuZ3RoO2E+bzsrK28pe2U9dGhpcy5fb2JqZWN0c1tvXSxlLnNldENvb3JkcygpO2Zvcih2YXIgaD0wO2g8bi5sZW5ndGg7aCsrKWk9bltoXSxyLnB1c2goZS5vQ29vcmRzW2ldLngpLHMucHVzaChlLm9Db29yZHNbaV0ueSl9dGhpcy5zZXQodGhpcy5fZ2V0Qm91bmRzKHIscyx0KSl9LF9nZXRCb3VuZHM6ZnVuY3Rpb24odCxpLG4pe3ZhciBvPWUudXRpbC5pbnZlcnRUcmFuc2Zvcm0odGhpcy5nZXRWaWV3cG9ydFRyYW5zZm9ybSgpKSxhPWUudXRpbC50cmFuc2Zvcm1Qb2ludChuZXcgZS5Qb2ludChyKHQpLHIoaSkpLG8pLGg9ZS51dGlsLnRyYW5zZm9ybVBvaW50KG5ldyBlLlBvaW50KHModCkscyhpKSksbyksYz17d2lkdGg6aC54LWEueHx8MCxoZWlnaHQ6aC55LWEueXx8MH07cmV0dXJuIG58fChjLmxlZnQ9YS54fHwwLGMudG9wPWEueXx8MCxcImNlbnRlclwiPT09dGhpcy5vcmlnaW5YJiYoYy5sZWZ0Kz1jLndpZHRoLzIpLFwicmlnaHRcIj09PXRoaXMub3JpZ2luWCYmKGMubGVmdCs9Yy53aWR0aCksXCJjZW50ZXJcIj09PXRoaXMub3JpZ2luWSYmKGMudG9wKz1jLmhlaWdodC8yKSxcImJvdHRvbVwiPT09dGhpcy5vcmlnaW5ZJiYoYy50b3ArPWMuaGVpZ2h0KSksY30sdG9TVkc6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVtcIjxnIFwiLCd0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksJ1wiPlxcbiddLGk9MCxyPXRoaXMuX29iamVjdHMubGVuZ3RoO3I+aTtpKyspZS5wdXNoKHRoaXMuX29iamVjdHNbaV0udG9TVkcodCkpO3JldHVybiBlLnB1c2goXCI8L2c+XFxuXCIpLHQ/dChlLmpvaW4oXCJcIikpOmUuam9pbihcIlwiKX0sZ2V0OmZ1bmN0aW9uKHQpe2lmKHQgaW4gbyl7aWYodGhpc1t0XSlyZXR1cm4gdGhpc1t0XTtmb3IodmFyIGU9MCxpPXRoaXMuX29iamVjdHMubGVuZ3RoO2k+ZTtlKyspaWYodGhpcy5fb2JqZWN0c1tlXVt0XSlyZXR1cm4hMDtyZXR1cm4hMX1yZXR1cm4gdCBpbiB0aGlzLmRlbGVnYXRlZFByb3BlcnRpZXM/dGhpcy5fb2JqZWN0c1swXSYmdGhpcy5fb2JqZWN0c1swXS5nZXQodCk6dGhpc1t0XX19KSxlLkdyb3VwLmZyb21PYmplY3Q9ZnVuY3Rpb24odCxpKXtlLnV0aWwuZW5saXZlbk9iamVjdHModC5vYmplY3RzLGZ1bmN0aW9uKHIpe2RlbGV0ZSB0Lm9iamVjdHMsaSYmaShuZXcgZS5Hcm91cChyLHQpKX0pfSxlLkdyb3VwLmFzeW5jPSEwfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT1mYWJyaWMudXRpbC5vYmplY3QuZXh0ZW5kO3JldHVybiB0LmZhYnJpY3x8KHQuZmFicmljPXt9KSx0LmZhYnJpYy5JbWFnZT92b2lkIGZhYnJpYy53YXJuKFwiZmFicmljLkltYWdlIGlzIGFscmVhZHkgZGVmaW5lZC5cIik6KGZhYnJpYy5JbWFnZT1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyhmYWJyaWMuT2JqZWN0LHt0eXBlOlwiaW1hZ2VcIixjcm9zc09yaWdpbjpcIlwiLGFsaWduWDpcIm5vbmVcIixhbGlnblk6XCJub25lXCIsbWVldE9yU2xpY2U6XCJtZWV0XCIsX2xhc3RTY2FsZVg6MSxfbGFzdFNjYWxlWToxLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXtlfHwoZT17fSksdGhpcy5maWx0ZXJzPVtdLHRoaXMucmVzaXplRmlsdGVycz1bXSx0aGlzLmNhbGxTdXBlcihcImluaXRpYWxpemVcIixlKSx0aGlzLl9pbml0RWxlbWVudCh0LGUpfSxnZXRFbGVtZW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VsZW1lbnR9LHNldEVsZW1lbnQ6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0aGlzLl9lbGVtZW50PXQsdGhpcy5fb3JpZ2luYWxFbGVtZW50PXQsdGhpcy5faW5pdENvbmZpZyhpKSwwIT09dGhpcy5maWx0ZXJzLmxlbmd0aD90aGlzLmFwcGx5RmlsdGVycyhlKTplJiZlKCksdGhpc30sc2V0Q3Jvc3NPcmlnaW46ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY3Jvc3NPcmlnaW49dCx0aGlzLl9lbGVtZW50LmNyb3NzT3JpZ2luPXQsdGhpc30sZ2V0T3JpZ2luYWxTaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRFbGVtZW50KCk7cmV0dXJue3dpZHRoOnQud2lkdGgsaGVpZ2h0OnQuaGVpZ2h0fX0sX3N0cm9rZTpmdW5jdGlvbih0KXt0LnNhdmUoKSx0aGlzLl9zZXRTdHJva2VTdHlsZXModCksdC5iZWdpblBhdGgoKSx0LnN0cm9rZVJlY3QoLXRoaXMud2lkdGgvMiwtdGhpcy5oZWlnaHQvMix0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSx0LmNsb3NlUGF0aCgpLHQucmVzdG9yZSgpfSxfcmVuZGVyRGFzaGVkU3Ryb2tlOmZ1bmN0aW9uKHQpe3ZhciBlPS10aGlzLndpZHRoLzIsaT0tdGhpcy5oZWlnaHQvMixyPXRoaXMud2lkdGgscz10aGlzLmhlaWdodDt0LnNhdmUoKSx0aGlzLl9zZXRTdHJva2VTdHlsZXModCksdC5iZWdpblBhdGgoKSxmYWJyaWMudXRpbC5kcmF3RGFzaGVkTGluZSh0LGUsaSxlK3IsaSx0aGlzLnN0cm9rZURhc2hBcnJheSksZmFicmljLnV0aWwuZHJhd0Rhc2hlZExpbmUodCxlK3IsaSxlK3IsaStzLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSxmYWJyaWMudXRpbC5kcmF3RGFzaGVkTGluZSh0LGUrcixpK3MsZSxpK3MsdGhpcy5zdHJva2VEYXNoQXJyYXkpLGZhYnJpYy51dGlsLmRyYXdEYXNoZWRMaW5lKHQsZSxpK3MsZSxpLHRoaXMuc3Ryb2tlRGFzaEFycmF5KSx0LmNsb3NlUGF0aCgpLHQucmVzdG9yZSgpfSx0b09iamVjdDpmdW5jdGlvbih0KXt2YXIgaT1lKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIix0KSx7c3JjOnRoaXMuX29yaWdpbmFsRWxlbWVudC5zcmN8fHRoaXMuX29yaWdpbmFsRWxlbWVudC5fc3JjLGZpbHRlcnM6dGhpcy5maWx0ZXJzLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdCYmdC50b09iamVjdCgpfSksY3Jvc3NPcmlnaW46dGhpcy5jcm9zc09yaWdpbixhbGlnblg6dGhpcy5hbGlnblgsYWxpZ25ZOnRoaXMuYWxpZ25ZLG1lZXRPclNsaWNlOnRoaXMubWVldE9yU2xpY2V9KTtyZXR1cm4gdGhpcy5yZXNpemVGaWx0ZXJzLmxlbmd0aD4wJiYoaS5yZXNpemVGaWx0ZXJzPXRoaXMucmVzaXplRmlsdGVycy5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQmJnQudG9PYmplY3QoKX0pKSxpfSx0b1NWRzpmdW5jdGlvbih0KXt2YXIgZT1bXSxpPS10aGlzLndpZHRoLzIscj0tdGhpcy5oZWlnaHQvMixzPVwibm9uZVwiO2lmKHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlJiYoaT10aGlzLmxlZnQscj10aGlzLnRvcCksXCJub25lXCIhPT10aGlzLmFsaWduWCYmXCJub25lXCIhPT10aGlzLmFsaWduWSYmKHM9XCJ4XCIrdGhpcy5hbGlnblgrXCJZXCIrdGhpcy5hbGlnblkrXCIgXCIrdGhpcy5tZWV0T3JTbGljZSksZS5wdXNoKCc8ZyB0cmFuc2Zvcm09XCInLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtKCksdGhpcy5nZXRTdmdUcmFuc2Zvcm1NYXRyaXgoKSwnXCI+XFxuJywnPGltYWdlIHhsaW5rOmhyZWY9XCInLHRoaXMuZ2V0U3ZnU3JjKCksJ1wiIHg9XCInLGksJ1wiIHk9XCInLHIsJ1wiIHN0eWxlPVwiJyx0aGlzLmdldFN2Z1N0eWxlcygpLCdcIiB3aWR0aD1cIicsdGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyx0aGlzLmhlaWdodCwnXCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cIicscywnXCInLFwiPjwvaW1hZ2U+XFxuXCIpLHRoaXMuc3Ryb2tlfHx0aGlzLnN0cm9rZURhc2hBcnJheSl7dmFyIG49dGhpcy5maWxsO3RoaXMuZmlsbD1udWxsLGUucHVzaChcIjxyZWN0IFwiLCd4PVwiJyxpLCdcIiB5PVwiJyxyLCdcIiB3aWR0aD1cIicsdGhpcy53aWR0aCwnXCIgaGVpZ2h0PVwiJyx0aGlzLmhlaWdodCwnXCIgc3R5bGU9XCInLHRoaXMuZ2V0U3ZnU3R5bGVzKCksJ1wiLz5cXG4nKSx0aGlzLmZpbGw9bn1yZXR1cm4gZS5wdXNoKFwiPC9nPlxcblwiKSx0P3QoZS5qb2luKFwiXCIpKTplLmpvaW4oXCJcIil9LGdldFNyYzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldEVsZW1lbnQoKT90aGlzLmdldEVsZW1lbnQoKS5zcmN8fHRoaXMuZ2V0RWxlbWVudCgpLl9zcmM6dm9pZCAwfSxzZXRTcmM6ZnVuY3Rpb24odCxlLGkpe2ZhYnJpYy51dGlsLmxvYWRJbWFnZSh0LGZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldEVsZW1lbnQodCxlLGkpfSx0aGlzLGkmJmkuY3Jvc3NPcmlnaW4pfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybicjPGZhYnJpYy5JbWFnZTogeyBzcmM6IFwiJyt0aGlzLmdldFNyYygpKydcIiB9Pid9LGNsb25lOmZ1bmN0aW9uKHQsZSl7dGhpcy5jb25zdHJ1Y3Rvci5mcm9tT2JqZWN0KHRoaXMudG9PYmplY3QoZSksdCl9LGFwcGx5RmlsdGVyczpmdW5jdGlvbih0LGUsaSxyKXtpZihlPWV8fHRoaXMuZmlsdGVycyxcclxuaT1pfHx0aGlzLl9vcmlnaW5hbEVsZW1lbnQpe3ZhciBzPWksbj1mYWJyaWMudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCksbz1mYWJyaWMudXRpbC5jcmVhdGVJbWFnZSgpLGE9dGhpcztyZXR1cm4gbi53aWR0aD1zLndpZHRoLG4uaGVpZ2h0PXMuaGVpZ2h0LG4uZ2V0Q29udGV4dChcIjJkXCIpLmRyYXdJbWFnZShzLDAsMCxzLndpZHRoLHMuaGVpZ2h0KSwwPT09ZS5sZW5ndGg/KHRoaXMuX2VsZW1lbnQ9aSx0JiZ0KCksbik6KGUuZm9yRWFjaChmdW5jdGlvbih0KXt0JiZ0LmFwcGx5VG8obix0LnNjYWxlWHx8YS5zY2FsZVgsdC5zY2FsZVl8fGEuc2NhbGVZKSwhciYmdCYmXCJSZXNpemVcIj09PXQudHlwZSYmKGEud2lkdGgqPXQuc2NhbGVYLGEuaGVpZ2h0Kj10LnNjYWxlWSl9KSxvLndpZHRoPW4ud2lkdGgsby5oZWlnaHQ9bi5oZWlnaHQsZmFicmljLmlzTGlrZWx5Tm9kZT8oby5zcmM9bi50b0J1ZmZlcih2b2lkIDAsZmFicmljLkltYWdlLnBuZ0NvbXByZXNzaW9uKSxhLl9lbGVtZW50PW8sIXImJihhLl9maWx0ZXJlZEVsPW8pLHQmJnQoKSk6KG8ub25sb2FkPWZ1bmN0aW9uKCl7YS5fZWxlbWVudD1vLCFyJiYoYS5fZmlsdGVyZWRFbD1vKSx0JiZ0KCksby5vbmxvYWQ9bj1zPW51bGx9LG8uc3JjPW4udG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpKSxuKX19LF9yZW5kZXI6ZnVuY3Rpb24odCxlKXt2YXIgaSxyLHMsbj10aGlzLl9maW5kTWFyZ2lucygpO2k9ZT90aGlzLmxlZnQ6LXRoaXMud2lkdGgvMixyPWU/dGhpcy50b3A6LXRoaXMuaGVpZ2h0LzIsXCJzbGljZVwiPT09dGhpcy5tZWV0T3JTbGljZSYmKHQuYmVnaW5QYXRoKCksdC5yZWN0KGkscix0aGlzLndpZHRoLHRoaXMuaGVpZ2h0KSx0LmNsaXAoKSksdGhpcy5pc01vdmluZz09PSExJiZ0aGlzLnJlc2l6ZUZpbHRlcnMubGVuZ3RoJiZ0aGlzLl9uZWVkc1Jlc2l6ZSgpPyh0aGlzLl9sYXN0U2NhbGVYPXRoaXMuc2NhbGVYLHRoaXMuX2xhc3RTY2FsZVk9dGhpcy5zY2FsZVkscz10aGlzLmFwcGx5RmlsdGVycyhudWxsLHRoaXMucmVzaXplRmlsdGVycyx0aGlzLl9maWx0ZXJlZEVsfHx0aGlzLl9vcmlnaW5hbEVsZW1lbnQsITApKTpzPXRoaXMuX2VsZW1lbnQscyYmdC5kcmF3SW1hZ2UocyxpK24ubWFyZ2luWCxyK24ubWFyZ2luWSxuLndpZHRoLG4uaGVpZ2h0KSx0aGlzLl9yZW5kZXJTdHJva2UodCl9LF9uZWVkc1Jlc2l6ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNjYWxlWCE9PXRoaXMuX2xhc3RTY2FsZVh8fHRoaXMuc2NhbGVZIT09dGhpcy5fbGFzdFNjYWxlWX0sX2ZpbmRNYXJnaW5zOmZ1bmN0aW9uKCl7dmFyIHQsZSxpPXRoaXMud2lkdGgscj10aGlzLmhlaWdodCxzPTAsbj0wO3JldHVybihcIm5vbmVcIiE9PXRoaXMuYWxpZ25YfHxcIm5vbmVcIiE9PXRoaXMuYWxpZ25ZKSYmKHQ9W3RoaXMud2lkdGgvdGhpcy5fZWxlbWVudC53aWR0aCx0aGlzLmhlaWdodC90aGlzLl9lbGVtZW50LmhlaWdodF0sZT1cIm1lZXRcIj09PXRoaXMubWVldE9yU2xpY2U/TWF0aC5taW4uYXBwbHkobnVsbCx0KTpNYXRoLm1heC5hcHBseShudWxsLHQpLGk9dGhpcy5fZWxlbWVudC53aWR0aCplLHI9dGhpcy5fZWxlbWVudC5oZWlnaHQqZSxcIk1pZFwiPT09dGhpcy5hbGlnblgmJihzPSh0aGlzLndpZHRoLWkpLzIpLFwiTWF4XCI9PT10aGlzLmFsaWduWCYmKHM9dGhpcy53aWR0aC1pKSxcIk1pZFwiPT09dGhpcy5hbGlnblkmJihuPSh0aGlzLmhlaWdodC1yKS8yKSxcIk1heFwiPT09dGhpcy5hbGlnblkmJihuPXRoaXMuaGVpZ2h0LXIpKSx7d2lkdGg6aSxoZWlnaHQ6cixtYXJnaW5YOnMsbWFyZ2luWTpufX0sX3Jlc2V0V2lkdGhIZWlnaHQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldEVsZW1lbnQoKTt0aGlzLnNldChcIndpZHRoXCIsdC53aWR0aCksdGhpcy5zZXQoXCJoZWlnaHRcIix0LmhlaWdodCl9LF9pbml0RWxlbWVudDpmdW5jdGlvbih0KXt0aGlzLnNldEVsZW1lbnQoZmFicmljLnV0aWwuZ2V0QnlJZCh0KSksZmFicmljLnV0aWwuYWRkQ2xhc3ModGhpcy5nZXRFbGVtZW50KCksZmFicmljLkltYWdlLkNTU19DQU5WQVMpfSxfaW5pdENvbmZpZzpmdW5jdGlvbih0KXt0fHwodD17fSksdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX3NldFdpZHRoSGVpZ2h0KHQpLHRoaXMuX2VsZW1lbnQmJnRoaXMuY3Jvc3NPcmlnaW4mJih0aGlzLl9lbGVtZW50LmNyb3NzT3JpZ2luPXRoaXMuY3Jvc3NPcmlnaW4pfSxfaW5pdEZpbHRlcnM6ZnVuY3Rpb24odCxlKXt0JiZ0Lmxlbmd0aD9mYWJyaWMudXRpbC5lbmxpdmVuT2JqZWN0cyh0LGZ1bmN0aW9uKHQpe2UmJmUodCl9LFwiZmFicmljLkltYWdlLmZpbHRlcnNcIik6ZSYmZSgpfSxfc2V0V2lkdGhIZWlnaHQ6ZnVuY3Rpb24odCl7dGhpcy53aWR0aD1cIndpZHRoXCJpbiB0P3Qud2lkdGg6dGhpcy5nZXRFbGVtZW50KCk/dGhpcy5nZXRFbGVtZW50KCkud2lkdGh8fDA6MCx0aGlzLmhlaWdodD1cImhlaWdodFwiaW4gdD90LmhlaWdodDp0aGlzLmdldEVsZW1lbnQoKT90aGlzLmdldEVsZW1lbnQoKS5oZWlnaHR8fDA6MH0sY29tcGxleGl0eTpmdW5jdGlvbigpe3JldHVybiAxfX0pLGZhYnJpYy5JbWFnZS5DU1NfQ0FOVkFTPVwiY2FudmFzLWltZ1wiLGZhYnJpYy5JbWFnZS5wcm90b3R5cGUuZ2V0U3ZnU3JjPWZhYnJpYy5JbWFnZS5wcm90b3R5cGUuZ2V0U3JjLGZhYnJpYy5JbWFnZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQsZSl7ZmFicmljLnV0aWwubG9hZEltYWdlKHQuc3JjLGZ1bmN0aW9uKGkpe2ZhYnJpYy5JbWFnZS5wcm90b3R5cGUuX2luaXRGaWx0ZXJzLmNhbGwodCx0LmZpbHRlcnMsZnVuY3Rpb24ocil7dC5maWx0ZXJzPXJ8fFtdLGZhYnJpYy5JbWFnZS5wcm90b3R5cGUuX2luaXRGaWx0ZXJzLmNhbGwodCx0LnJlc2l6ZUZpbHRlcnMsZnVuY3Rpb24ocil7dC5yZXNpemVGaWx0ZXJzPXJ8fFtdO3ZhciBzPW5ldyBmYWJyaWMuSW1hZ2UoaSx0KTtlJiZlKHMpfSl9KX0sbnVsbCx0LmNyb3NzT3JpZ2luKX0sZmFicmljLkltYWdlLmZyb21VUkw9ZnVuY3Rpb24odCxlLGkpe2ZhYnJpYy51dGlsLmxvYWRJbWFnZSh0LGZ1bmN0aW9uKHQpe2UmJmUobmV3IGZhYnJpYy5JbWFnZSh0LGkpKX0sbnVsbCxpJiZpLmNyb3NzT3JpZ2luKX0sZmFicmljLkltYWdlLkFUVFJJQlVURV9OQU1FUz1mYWJyaWMuU0hBUkVEX0FUVFJJQlVURVMuY29uY2F0KFwieCB5IHdpZHRoIGhlaWdodCBwcmVzZXJ2ZUFzcGVjdFJhdGlvIHhsaW5rOmhyZWZcIi5zcGxpdChcIiBcIikpLGZhYnJpYy5JbWFnZS5mcm9tRWxlbWVudD1mdW5jdGlvbih0LGkscil7dmFyIHMsbixvLGE9ZmFicmljLnBhcnNlQXR0cmlidXRlcyh0LGZhYnJpYy5JbWFnZS5BVFRSSUJVVEVfTkFNRVMpLGg9XCJ4TWlkWU1pZFwiLGM9XCJtZWV0XCI7YS5wcmVzZXJ2ZUFzcGVjdFJhdGlvJiYobz1hLnByZXNlcnZlQXNwZWN0UmF0aW8uc3BsaXQoXCIgXCIpKSxvJiZvLmxlbmd0aCYmKGM9by5wb3AoKSxcIm1lZXRcIiE9PWMmJlwic2xpY2VcIiE9PWM/KGg9YyxjPVwibWVldFwiKTpvLmxlbmd0aCYmKGg9by5wb3AoKSkpLHM9XCJub25lXCIhPT1oP2guc2xpY2UoMSw0KTpcIm5vbmVcIixuPVwibm9uZVwiIT09aD9oLnNsaWNlKDUsOCk6XCJub25lXCIsYS5hbGlnblg9cyxhLmFsaWduWT1uLGEubWVldE9yU2xpY2U9YyxmYWJyaWMuSW1hZ2UuZnJvbVVSTChhW1wieGxpbms6aHJlZlwiXSxpLGUocj9mYWJyaWMudXRpbC5vYmplY3QuY2xvbmUocik6e30sYSkpfSxmYWJyaWMuSW1hZ2UuYXN5bmM9ITAsdm9pZChmYWJyaWMuSW1hZ2UucG5nQ29tcHJlc3Npb249MSkpfShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLk9iamVjdC5wcm90b3R5cGUse19nZXRBbmdsZVZhbHVlRm9yU3RyYWlnaHRlbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0QW5nbGUoKSUzNjA7cmV0dXJuIHQ+MD85MCpNYXRoLnJvdW5kKCh0LTEpLzkwKTo5MCpNYXRoLnJvdW5kKHQvOTApfSxzdHJhaWdodGVuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0QW5nbGUodGhpcy5fZ2V0QW5nbGVWYWx1ZUZvclN0cmFpZ2h0ZW4oKSksdGhpc30sZnhTdHJhaWdodGVuOmZ1bmN0aW9uKHQpe3Q9dHx8e307dmFyIGU9ZnVuY3Rpb24oKXt9LGk9dC5vbkNvbXBsZXRlfHxlLHI9dC5vbkNoYW5nZXx8ZSxzPXRoaXM7cmV0dXJuIGZhYnJpYy51dGlsLmFuaW1hdGUoe3N0YXJ0VmFsdWU6dGhpcy5nZXQoXCJhbmdsZVwiKSxlbmRWYWx1ZTp0aGlzLl9nZXRBbmdsZVZhbHVlRm9yU3RyYWlnaHRlbigpLGR1cmF0aW9uOnRoaXMuRlhfRFVSQVRJT04sb25DaGFuZ2U6ZnVuY3Rpb24odCl7cy5zZXRBbmdsZSh0KSxyKCl9LG9uQ29tcGxldGU6ZnVuY3Rpb24oKXtzLnNldENvb3JkcygpLGkoKX0sb25TdGFydDpmdW5jdGlvbigpe3Muc2V0KFwiYWN0aXZlXCIsITEpfX0pLHRoaXN9fSksZmFicmljLnV0aWwub2JqZWN0LmV4dGVuZChmYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZSx7c3RyYWlnaHRlbk9iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gdC5zdHJhaWdodGVuKCksdGhpcy5yZW5kZXJBbGwoKSx0aGlzfSxmeFN0cmFpZ2h0ZW5PYmplY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHQuZnhTdHJhaWdodGVuKHtvbkNoYW5nZTp0aGlzLnJlbmRlckFsbC5iaW5kKHRoaXMpfSksdGhpc319KSxmYWJyaWMuSW1hZ2UuZmlsdGVycz1mYWJyaWMuSW1hZ2UuZmlsdGVyc3x8e30sZmFicmljLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcj1mYWJyaWMudXRpbC5jcmVhdGVDbGFzcyh7dHlwZTpcIkJhc2VGaWx0ZXJcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3QmJnRoaXMuc2V0T3B0aW9ucyh0KX0sc2V0T3B0aW9uczpmdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdCl0aGlzW2VdPXRbZV19LHRvT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJue3R5cGU6dGhpcy50eXBlfX0sdG9KU09OOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9PYmplY3QoKX19KSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5CcmlnaHRuZXNzPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIkJyaWdodG5lc3NcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5icmlnaHRuZXNzPXQuYnJpZ2h0bmVzc3x8MH0sYXBwbHlUbzpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5nZXRDb250ZXh0KFwiMmRcIiksaT1lLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscj1pLmRhdGEscz10aGlzLmJyaWdodG5lc3Msbj0wLG89ci5sZW5ndGg7bz5uO24rPTQpcltuXSs9cyxyW24rMV0rPXMscltuKzJdKz1zO2UucHV0SW1hZ2VEYXRhKGksMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHticmlnaHRuZXNzOnRoaXMuYnJpZ2h0bmVzc30pfX0pLGUuSW1hZ2UuZmlsdGVycy5CcmlnaHRuZXNzLmZyb21PYmplY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuQnJpZ2h0bmVzcyh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZDtlLkltYWdlLmZpbHRlcnMuQ29udm9sdXRlPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIkNvbnZvbHV0ZVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLm9wYXF1ZT10Lm9wYXF1ZSx0aGlzLm1hdHJpeD10Lm1hdHJpeHx8WzAsMCwwLDAsMSwwLDAsMCwwXTt2YXIgaT1lLnV0aWwuY3JlYXRlQ2FudmFzRWxlbWVudCgpO3RoaXMudG1wQ3R4PWkuZ2V0Q29udGV4dChcIjJkXCIpfSxfY3JlYXRlSW1hZ2VEYXRhOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMudG1wQ3R4LmNyZWF0ZUltYWdlRGF0YSh0LGUpfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLm1hdHJpeCxpPXQuZ2V0Q29udGV4dChcIjJkXCIpLHI9aS5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLHM9TWF0aC5yb3VuZChNYXRoLnNxcnQoZS5sZW5ndGgpKSxuPU1hdGguZmxvb3Iocy8yKSxvPXIuZGF0YSxhPXIud2lkdGgsaD1yLmhlaWdodCxjPWEsbD1oLHU9dGhpcy5fY3JlYXRlSW1hZ2VEYXRhKGMsbCksZj11LmRhdGEsZD10aGlzLm9wYXF1ZT8xOjAsZz0wO2w+ZztnKyspZm9yKHZhciBwPTA7Yz5wO3ArKyl7Zm9yKHZhciB2PWcsYj1wLG09NCooZypjK3ApLHk9MCxfPTAseD0wLEM9MCxTPTA7cz5TO1MrKylmb3IodmFyIHc9MDtzPnc7dysrKXt2YXIgTz12K1MtbixUPWIrdy1uO2lmKCEoMD5PfHxPPmh8fDA+VHx8VD5hKSl7dmFyIGs9NCooTyphK1QpLGo9ZVtTKnMrd107eSs9b1trXSpqLF8rPW9baysxXSpqLHgrPW9baysyXSpqLEMrPW9bayszXSpqfX1mW21dPXksZlttKzFdPV8sZlttKzJdPXgsZlttKzNdPUMrZCooMjU1LUMpfWkucHV0SW1hZ2VEYXRhKHUsMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHtvcGFxdWU6dGhpcy5vcGFxdWUsbWF0cml4OnRoaXMubWF0cml4fSl9fSksZS5JbWFnZS5maWx0ZXJzLkNvbnZvbHV0ZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLkNvbnZvbHV0ZSh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZDtlLkltYWdlLmZpbHRlcnMuR3JhZGllbnRUcmFuc3BhcmVuY3k9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiR3JhZGllbnRUcmFuc3BhcmVuY3lcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy50aHJlc2hvbGQ9dC50aHJlc2hvbGR8fDEwMH0sYXBwbHlUbzpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5nZXRDb250ZXh0KFwiMmRcIiksaT1lLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCkscj1pLmRhdGEscz10aGlzLnRocmVzaG9sZCxuPXIubGVuZ3RoLG89MCxhPXIubGVuZ3RoO2E+bztvKz00KXJbbyszXT1zKzI1NSoobi1vKS9uO2UucHV0SW1hZ2VEYXRhKGksMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHt0aHJlc2hvbGQ6dGhpcy50aHJlc2hvbGR9KX19KSxlLkltYWdlLmZpbHRlcnMuR3JhZGllbnRUcmFuc3BhcmVuY3kuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5HcmFkaWVudFRyYW5zcGFyZW5jeSh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7ZS5JbWFnZS5maWx0ZXJzLkdyYXlzY2FsZT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJHcmF5c2NhbGVcIixhcHBseVRvOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxpPXQuZ2V0Q29udGV4dChcIjJkXCIpLHI9aS5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLHM9ci5kYXRhLG49ci53aWR0aCpyLmhlaWdodCo0LG89MDtuPm87KWU9KHNbb10rc1tvKzFdK3NbbysyXSkvMyxzW29dPWUsc1tvKzFdPWUsc1tvKzJdPWUsbys9NDtpLnB1dEltYWdlRGF0YShyLDAsMCl9fSksZS5JbWFnZS5maWx0ZXJzLkdyYXlzY2FsZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuR3JheXNjYWxlfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KTtlLkltYWdlLmZpbHRlcnMuSW52ZXJ0PWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIkludmVydFwiLGFwcGx5VG86ZnVuY3Rpb24odCl7dmFyIGUsaT10LmdldENvbnRleHQoXCIyZFwiKSxyPWkuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxzPXIuZGF0YSxuPXMubGVuZ3RoO2ZvcihlPTA7bj5lO2UrPTQpc1tlXT0yNTUtc1tlXSxzW2UrMV09MjU1LXNbZSsxXSxzW2UrMl09MjU1LXNbZSsyXTtpLnB1dEltYWdlRGF0YShyLDAsMCl9fSksZS5JbWFnZS5maWx0ZXJzLkludmVydC5mcm9tT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuSW52ZXJ0fX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5NYXNrPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIk1hc2tcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5tYXNrPXQubWFzayx0aGlzLmNoYW5uZWw9WzAsMSwyLDNdLmluZGV4T2YodC5jaGFubmVsKT4tMT90LmNoYW5uZWw6MH0sYXBwbHlUbzpmdW5jdGlvbih0KXtpZih0aGlzLm1hc2spe3ZhciBpLHI9dC5nZXRDb250ZXh0KFwiMmRcIikscz1yLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksbj1zLmRhdGEsbz10aGlzLm1hc2suZ2V0RWxlbWVudCgpLGE9ZS51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKSxoPXRoaXMuY2hhbm5lbCxjPXMud2lkdGgqcy5oZWlnaHQqNDthLndpZHRoPW8ud2lkdGgsYS5oZWlnaHQ9by5oZWlnaHQsYS5nZXRDb250ZXh0KFwiMmRcIikuZHJhd0ltYWdlKG8sMCwwLG8ud2lkdGgsby5oZWlnaHQpO3ZhciBsPWEuZ2V0Q29udGV4dChcIjJkXCIpLmdldEltYWdlRGF0YSgwLDAsby53aWR0aCxvLmhlaWdodCksdT1sLmRhdGE7Zm9yKGk9MDtjPmk7aSs9NCluW2krM109dVtpK2hdO3IucHV0SW1hZ2VEYXRhKHMsMCwwKX19LHRvT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiKSx7bWFzazp0aGlzLm1hc2sudG9PYmplY3QoKSxjaGFubmVsOnRoaXMuY2hhbm5lbH0pfX0pLGUuSW1hZ2UuZmlsdGVycy5NYXNrLmZyb21PYmplY3Q9ZnVuY3Rpb24odCxpKXtlLnV0aWwubG9hZEltYWdlKHQubWFzay5zcmMsZnVuY3Rpb24ocil7dC5tYXNrPW5ldyBlLkltYWdlKHIsdC5tYXNrKSxpJiZpKG5ldyBlLkltYWdlLmZpbHRlcnMuTWFzayh0KSl9KX0sZS5JbWFnZS5maWx0ZXJzLk1hc2suYXN5bmM9ITB9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZDtlLkltYWdlLmZpbHRlcnMuTm9pc2U9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiTm9pc2VcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy5ub2lzZT10Lm5vaXNlfHwwfSxhcHBseVRvOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSxpPXQuZ2V0Q29udGV4dChcIjJkXCIpLHI9aS5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLHM9ci5kYXRhLG49dGhpcy5ub2lzZSxvPTAsYT1zLmxlbmd0aDthPm87bys9NCllPSguNS1NYXRoLnJhbmRvbSgpKSpuLHNbb10rPWUsc1tvKzFdKz1lLHNbbysyXSs9ZTtpLnB1dEltYWdlRGF0YShyLDAsMCl9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiKSx7bm9pc2U6dGhpcy5ub2lzZX0pfX0pLGUuSW1hZ2UuZmlsdGVycy5Ob2lzZS5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLk5vaXNlKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5QaXhlbGF0ZT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJQaXhlbGF0ZVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLmJsb2Nrc2l6ZT10LmJsb2Nrc2l6ZXx8NH0sYXBwbHlUbzpmdW5jdGlvbih0KXt2YXIgZSxpLHIscyxuLG8sYSxoPXQuZ2V0Q29udGV4dChcIjJkXCIpLGM9aC5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLGw9Yy5kYXRhLHU9Yy5oZWlnaHQsZj1jLndpZHRoO2ZvcihpPTA7dT5pO2krPXRoaXMuYmxvY2tzaXplKWZvcihyPTA7Zj5yO3IrPXRoaXMuYmxvY2tzaXplKXtlPTQqaSpmKzQqcixzPWxbZV0sbj1sW2UrMV0sbz1sW2UrMl0sYT1sW2UrM107Zm9yKHZhciBkPWksZz1pK3RoaXMuYmxvY2tzaXplO2c+ZDtkKyspZm9yKHZhciBwPXIsdj1yK3RoaXMuYmxvY2tzaXplO3Y+cDtwKyspZT00KmQqZis0KnAsbFtlXT1zLGxbZSsxXT1uLGxbZSsyXT1vLGxbZSszXT1hfWgucHV0SW1hZ2VEYXRhKGMsMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHtibG9ja3NpemU6dGhpcy5ibG9ja3NpemV9KX19KSxlLkltYWdlLmZpbHRlcnMuUGl4ZWxhdGUuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5QaXhlbGF0ZSh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZDtlLkltYWdlLmZpbHRlcnMuUmVtb3ZlV2hpdGU9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiUmVtb3ZlV2hpdGVcIixpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3Q9dHx8e30sdGhpcy50aHJlc2hvbGQ9dC50aHJlc2hvbGR8fDMwLHRoaXMuZGlzdGFuY2U9dC5kaXN0YW5jZXx8MjB9LGFwcGx5VG86ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGkscixzPXQuZ2V0Q29udGV4dChcIjJkXCIpLG49cy5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLG89bi5kYXRhLGE9dGhpcy50aHJlc2hvbGQsaD10aGlzLmRpc3RhbmNlLGM9MjU1LWEsbD1NYXRoLmFicyx1PTAsZj1vLmxlbmd0aDtmPnU7dSs9NCllPW9bdV0saT1vW3UrMV0scj1vW3UrMl0sZT5jJiZpPmMmJnI+YyYmbChlLWkpPGgmJmwoZS1yKTxoJiZsKGktcik8aCYmKG9bdSszXT0xKTtzLnB1dEltYWdlRGF0YShuLDAsMCl9LHRvT2JqZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIGkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiKSx7dGhyZXNob2xkOnRoaXMudGhyZXNob2xkLGRpc3RhbmNlOnRoaXMuZGlzdGFuY2V9KX19KSxlLkltYWdlLmZpbHRlcnMuUmVtb3ZlV2hpdGUuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5SZW1vdmVXaGl0ZSh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSk7ZS5JbWFnZS5maWx0ZXJzLlNlcGlhPWUudXRpbC5jcmVhdGVDbGFzcyhlLkltYWdlLmZpbHRlcnMuQmFzZUZpbHRlcix7dHlwZTpcIlNlcGlhXCIsYXBwbHlUbzpmdW5jdGlvbih0KXt2YXIgZSxpLHI9dC5nZXRDb250ZXh0KFwiMmRcIikscz1yLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksbj1zLmRhdGEsbz1uLmxlbmd0aDtmb3IoZT0wO28+ZTtlKz00KWk9LjMqbltlXSsuNTkqbltlKzFdKy4xMSpuW2UrMl0sbltlXT1pKzEwMCxuW2UrMV09aSs1MCxuW2UrMl09aSsyNTU7ci5wdXRJbWFnZURhdGEocywwLDApfX0pLGUuSW1hZ2UuZmlsdGVycy5TZXBpYS5mcm9tT2JqZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlLkltYWdlLmZpbHRlcnMuU2VwaWF9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pO2UuSW1hZ2UuZmlsdGVycy5TZXBpYTI9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuSW1hZ2UuZmlsdGVycy5CYXNlRmlsdGVyLHt0eXBlOlwiU2VwaWEyXCIsYXBwbHlUbzpmdW5jdGlvbih0KXt2YXIgZSxpLHIscyxuPXQuZ2V0Q29udGV4dChcIjJkXCIpLG89bi5nZXRJbWFnZURhdGEoMCwwLHQud2lkdGgsdC5oZWlnaHQpLGE9by5kYXRhLGg9YS5sZW5ndGg7Zm9yKGU9MDtoPmU7ZSs9NClpPWFbZV0scj1hW2UrMV0scz1hW2UrMl0sYVtlXT0oLjM5MyppKy43NjkqcisuMTg5KnMpLzEuMzUxLGFbZSsxXT0oLjM0OSppKy42ODYqcisuMTY4KnMpLzEuMjAzLGFbZSsyXT0oLjI3MippKy41MzQqcisuMTMxKnMpLzIuMTQ7bi5wdXRJbWFnZURhdGEobywwLDApfX0pLGUuSW1hZ2UuZmlsdGVycy5TZXBpYTIuZnJvbU9iamVjdD1mdW5jdGlvbigpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLlNlcGlhMn19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWN8fCh0LmZhYnJpYz17fSksaT1lLnV0aWwub2JqZWN0LmV4dGVuZDtlLkltYWdlLmZpbHRlcnMuVGludD1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJUaW50XCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY29sb3I9dC5jb2xvcnx8XCIjMDAwMDAwXCIsdGhpcy5vcGFjaXR5PVwidW5kZWZpbmVkXCIhPXR5cGVvZiB0Lm9wYWNpdHk/dC5vcGFjaXR5Om5ldyBlLkNvbG9yKHRoaXMuY29sb3IpLmdldEFscGhhKCl9LGFwcGx5VG86ZnVuY3Rpb24odCl7dmFyIGkscixzLG4sbyxhLGgsYyxsLHU9dC5nZXRDb250ZXh0KFwiMmRcIiksZj11LmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksZD1mLmRhdGEsZz1kLmxlbmd0aDtmb3IobD1uZXcgZS5Db2xvcih0aGlzLmNvbG9yKS5nZXRTb3VyY2UoKSxyPWxbMF0qdGhpcy5vcGFjaXR5LHM9bFsxXSp0aGlzLm9wYWNpdHksbj1sWzJdKnRoaXMub3BhY2l0eSxjPTEtdGhpcy5vcGFjaXR5LGk9MDtnPmk7aSs9NClvPWRbaV0sYT1kW2krMV0saD1kW2krMl0sZFtpXT1yK28qYyxkW2krMV09cythKmMsZFtpKzJdPW4raCpjO3UucHV0SW1hZ2VEYXRhKGYsMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm4gaSh0aGlzLmNhbGxTdXBlcihcInRvT2JqZWN0XCIpLHtjb2xvcjp0aGlzLmNvbG9yLG9wYWNpdHk6dGhpcy5vcGFjaXR5fSl9fSksZS5JbWFnZS5maWx0ZXJzLlRpbnQuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5UaW50KHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPWUudXRpbC5vYmplY3QuZXh0ZW5kO2UuSW1hZ2UuZmlsdGVycy5NdWx0aXBseT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJNdWx0aXBseVwiLGluaXRpYWxpemU6ZnVuY3Rpb24odCl7dD10fHx7fSx0aGlzLmNvbG9yPXQuY29sb3J8fFwiIzAwMDAwMFwifSxhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBpLHIscz10LmdldENvbnRleHQoXCIyZFwiKSxuPXMuZ2V0SW1hZ2VEYXRhKDAsMCx0LndpZHRoLHQuaGVpZ2h0KSxvPW4uZGF0YSxhPW8ubGVuZ3RoO2ZvcihyPW5ldyBlLkNvbG9yKHRoaXMuY29sb3IpLmdldFNvdXJjZSgpLGk9MDthPmk7aSs9NClvW2ldKj1yWzBdLzI1NSxvW2krMV0qPXJbMV0vMjU1LG9baSsyXSo9clsyXS8yNTU7cy5wdXRJbWFnZURhdGEobiwwLDApfSx0b09iamVjdDpmdW5jdGlvbigpe3JldHVybiBpKHRoaXMuY2FsbFN1cGVyKFwidG9PYmplY3RcIikse2NvbG9yOnRoaXMuY29sb3J9KX19KSxlLkltYWdlLmZpbHRlcnMuTXVsdGlwbHkuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5NdWx0aXBseSh0KX19KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBleHBvcnRzP2V4cG9ydHM6dGhpcyksZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5mYWJyaWM7ZS5JbWFnZS5maWx0ZXJzLkJsZW5kPWUudXRpbC5jcmVhdGVDbGFzcyh7dHlwZTpcIkJsZW5kXCIsaW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0PXR8fHt9LHRoaXMuY29sb3I9dC5jb2xvcnx8XCIjMDAwXCIsdGhpcy5pbWFnZT10LmltYWdlfHwhMSx0aGlzLm1vZGU9dC5tb2RlfHxcIm11bHRpcGx5XCIsdGhpcy5hbHBoYT10LmFscGhhfHwxfSxhcHBseVRvOmZ1bmN0aW9uKHQpe3ZhciBpLHIscyxuLG8sYSxoLGMsbCx1LGY9dC5nZXRDb250ZXh0KFwiMmRcIiksZD1mLmdldEltYWdlRGF0YSgwLDAsdC53aWR0aCx0LmhlaWdodCksZz1kLmRhdGEscD0hMTtpZih0aGlzLmltYWdlKXtwPSEwO3ZhciB2PWUudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCk7di53aWR0aD10aGlzLmltYWdlLndpZHRoLHYuaGVpZ2h0PXRoaXMuaW1hZ2UuaGVpZ2h0O3ZhciBiPW5ldyBlLlN0YXRpY0NhbnZhcyh2KTtiLmFkZCh0aGlzLmltYWdlKTt2YXIgbT1iLmdldENvbnRleHQoXCIyZFwiKTt1PW0uZ2V0SW1hZ2VEYXRhKDAsMCxiLndpZHRoLGIuaGVpZ2h0KS5kYXRhfWVsc2UgdT1uZXcgZS5Db2xvcih0aGlzLmNvbG9yKS5nZXRTb3VyY2UoKSxpPXVbMF0qdGhpcy5hbHBoYSxyPXVbMV0qdGhpcy5hbHBoYSxzPXVbMl0qdGhpcy5hbHBoYTtmb3IodmFyIHk9MCxfPWcubGVuZ3RoO18+eTt5Kz00KXN3aXRjaChuPWdbeV0sbz1nW3krMV0sYT1nW3krMl0scCYmKGk9dVt5XSp0aGlzLmFscGhhLHI9dVt5KzFdKnRoaXMuYWxwaGEscz11W3krMl0qdGhpcy5hbHBoYSksdGhpcy5tb2RlKXtjYXNlXCJtdWx0aXBseVwiOmdbeV09bippLzI1NSxnW3krMV09bypyLzI1NSxnW3krMl09YSpzLzI1NTticmVhaztjYXNlXCJzY3JlZW5cIjpnW3ldPTEtKDEtbikqKDEtaSksZ1t5KzFdPTEtKDEtbykqKDEtciksZ1t5KzJdPTEtKDEtYSkqKDEtcyk7YnJlYWs7Y2FzZVwiYWRkXCI6Z1t5XT1NYXRoLm1pbigyNTUsbitpKSxnW3krMV09TWF0aC5taW4oMjU1LG8rciksZ1t5KzJdPU1hdGgubWluKDI1NSxhK3MpO2JyZWFrO2Nhc2VcImRpZmZcIjpjYXNlXCJkaWZmZXJlbmNlXCI6Z1t5XT1NYXRoLmFicyhuLWkpLGdbeSsxXT1NYXRoLmFicyhvLXIpLGdbeSsyXT1NYXRoLmFicyhhLXMpO2JyZWFrO2Nhc2VcInN1YnRyYWN0XCI6aD1uLWksYz1vLXIsbD1hLXMsZ1t5XT0wPmg/MDpoLGdbeSsxXT0wPmM/MDpjLGdbeSsyXT0wPmw/MDpsO2JyZWFrO2Nhc2VcImRhcmtlblwiOmdbeV09TWF0aC5taW4obixpKSxnW3krMV09TWF0aC5taW4obyxyKSxnW3krMl09TWF0aC5taW4oYSxzKTticmVhaztjYXNlXCJsaWdodGVuXCI6Z1t5XT1NYXRoLm1heChuLGkpLGdbeSsxXT1NYXRoLm1heChvLHIpLGdbeSsyXT1NYXRoLm1heChhLHMpfWYucHV0SW1hZ2VEYXRhKGQsMCwwKX0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm57Y29sb3I6dGhpcy5jb2xvcixpbWFnZTp0aGlzLmltYWdlLG1vZGU6dGhpcy5tb2RlLGFscGhhOnRoaXMuYWxwaGF9fX0pLGUuSW1hZ2UuZmlsdGVycy5CbGVuZC5mcm9tT2JqZWN0PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZS5JbWFnZS5maWx0ZXJzLkJsZW5kKHQpfX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjt2YXIgZT10LmZhYnJpY3x8KHQuZmFicmljPXt9KSxpPU1hdGgucG93LHI9TWF0aC5mbG9vcixzPU1hdGguc3FydCxuPU1hdGguYWJzLG89TWF0aC5tYXgsYT1NYXRoLnJvdW5kLGg9TWF0aC5zaW4sYz1NYXRoLmNlaWw7ZS5JbWFnZS5maWx0ZXJzLlJlc2l6ZT1lLnV0aWwuY3JlYXRlQ2xhc3MoZS5JbWFnZS5maWx0ZXJzLkJhc2VGaWx0ZXIse3R5cGU6XCJSZXNpemVcIixyZXNpemVUeXBlOlwiaGVybWl0ZVwiLHNjYWxlWDowLHNjYWxlWTowLGxhbmN6b3NMb2JlczozLGFwcGx5VG86ZnVuY3Rpb24odCxlLGkpe3RoaXMucmNwU2NhbGVYPTEvZSx0aGlzLnJjcFNjYWxlWT0xL2k7dmFyIHIscz10LndpZHRoLG49dC5oZWlnaHQsbz1hKHMqZSksaD1hKG4qaSk7XCJzbGljZUhhY2tcIj09PXRoaXMucmVzaXplVHlwZSYmKHI9dGhpcy5zbGljZUJ5VHdvKHQscyxuLG8saCkpLFwiaGVybWl0ZVwiPT09dGhpcy5yZXNpemVUeXBlJiYocj10aGlzLmhlcm1pdGVGYXN0UmVzaXplKHQscyxuLG8saCkpLFwiYmlsaW5lYXJcIj09PXRoaXMucmVzaXplVHlwZSYmKHI9dGhpcy5iaWxpbmVhckZpbHRlcmluZyh0LHMsbixvLGgpKSxcImxhbmN6b3NcIj09PXRoaXMucmVzaXplVHlwZSYmKHI9dGhpcy5sYW5jem9zUmVzaXplKHQscyxuLG8saCkpLHQud2lkdGg9byx0LmhlaWdodD1oLHQuZ2V0Q29udGV4dChcIjJkXCIpLnB1dEltYWdlRGF0YShyLDAsMCl9LHNsaWNlQnlUd286ZnVuY3Rpb24odCxpLHMsbixhKXt2YXIgaCxjPXQuZ2V0Q29udGV4dChcIjJkXCIpLGw9LjUsdT0uNSxmPTEsZD0xLGc9ITEscD0hMSx2PWksYj1zLG09ZS51dGlsLmNyZWF0ZUNhbnZhc0VsZW1lbnQoKSx5PW0uZ2V0Q29udGV4dChcIjJkXCIpO2ZvcihuPXIobiksYT1yKGEpLG0ud2lkdGg9byhuLGkpLG0uaGVpZ2h0PW8oYSxzKSxuPmkmJihsPTIsZj0tMSksYT5zJiYodT0yLGQ9LTEpLGg9Yy5nZXRJbWFnZURhdGEoMCwwLGkscyksdC53aWR0aD1vKG4saSksdC5oZWlnaHQ9byhhLHMpLGMucHV0SW1hZ2VEYXRhKGgsMCwwKTshZ3x8IXA7KWk9dixzPWIsbipmPHIodipsKmYpP3Y9cih2KmwpOih2PW4sZz0hMCksYSpkPHIoYip1KmQpP2I9cihiKnUpOihiPWEscD0hMCksaD1jLmdldEltYWdlRGF0YSgwLDAsaSxzKSx5LnB1dEltYWdlRGF0YShoLDAsMCksYy5jbGVhclJlY3QoMCwwLHYsYiksYy5kcmF3SW1hZ2UobSwwLDAsaSxzLDAsMCx2LGIpO3JldHVybiBjLmdldEltYWdlRGF0YSgwLDAsbixhKX0sbGFuY3pvc1Jlc2l6ZTpmdW5jdGlvbih0LGUsbyxhLGwpe2Z1bmN0aW9uIHUodCl7cmV0dXJuIGZ1bmN0aW9uKGUpe2lmKGU+dClyZXR1cm4gMDtpZihlKj1NYXRoLlBJLG4oZSk8MWUtMTYpcmV0dXJuIDE7dmFyIGk9ZS90O3JldHVybiBoKGUpKmgoaSkvZS9pfX1mdW5jdGlvbiBmKHQpe3ZhciBoLGMsdSxkLGcsaixBLFAsRSxNLEk7Zm9yKFQueD0odCsuNSkqeSxrLng9cihULngpLGg9MDtsPmg7aCsrKXtmb3IoVC55PShoKy41KSpfLGsueT1yKFQueSksZz0wLGo9MCxBPTAsUD0wLEU9MCxjPWsueC1TO2M8PWsueCtTO2MrKylpZighKDA+Y3x8Yz49ZSkpe009cigxZTMqbihjLVQueCkpLE9bTV18fChPW01dPXt9KTtmb3IodmFyIEQ9ay55LXc7RDw9ay55K3c7RCsrKTA+RHx8RD49b3x8KEk9cigxZTMqbihELVQueSkpLE9bTV1bSV18fChPW01dW0ldPW0ocyhpKE0qeCwyKStpKEkqQywyKSkvMWUzKSksdT1PW01dW0ldLHU+MCYmKGQ9NCooRCplK2MpLGcrPXUsais9dSp2W2RdLEErPXUqdltkKzFdLFArPXUqdltkKzJdLEUrPXUqdltkKzNdKSl9ZD00KihoKmErdCksYltkXT1qL2csYltkKzFdPUEvZyxiW2QrMl09UC9nLGJbZCszXT1FL2d9cmV0dXJuKyt0PGE/Zih0KTpwfXZhciBkPXQuZ2V0Q29udGV4dChcIjJkXCIpLGc9ZC5nZXRJbWFnZURhdGEoMCwwLGUsbykscD1kLmdldEltYWdlRGF0YSgwLDAsYSxsKSx2PWcuZGF0YSxiPXAuZGF0YSxtPXUodGhpcy5sYW5jem9zTG9iZXMpLHk9dGhpcy5yY3BTY2FsZVgsXz10aGlzLnJjcFNjYWxlWSx4PTIvdGhpcy5yY3BTY2FsZVgsQz0yL3RoaXMucmNwU2NhbGVZLFM9Yyh5KnRoaXMubGFuY3pvc0xvYmVzLzIpLHc9YyhfKnRoaXMubGFuY3pvc0xvYmVzLzIpLE89e30sVD17fSxrPXt9O3JldHVybiBmKDApfSxiaWxpbmVhckZpbHRlcmluZzpmdW5jdGlvbih0LGUsaSxzLG4pe3ZhciBvLGEsaCxjLGwsdSxmLGQsZyxwLHYsYixtLHk9MCxfPXRoaXMucmNwU2NhbGVYLHg9dGhpcy5yY3BTY2FsZVksQz10LmdldENvbnRleHQoXCIyZFwiKSxTPTQqKGUtMSksdz1DLmdldEltYWdlRGF0YSgwLDAsZSxpKSxPPXcuZGF0YSxUPUMuZ2V0SW1hZ2VEYXRhKDAsMCxzLG4pLGs9VC5kYXRhO2ZvcihmPTA7bj5mO2YrKylmb3IoZD0wO3M+ZDtkKyspZm9yKGw9cihfKmQpLHU9cih4KmYpLGc9XypkLWwscD14KmYtdSxtPTQqKHUqZStsKSx2PTA7ND52O3YrKylvPU9bbSt2XSxhPU9bbSs0K3ZdLGg9T1ttK1Mrdl0sYz1PW20rUys0K3ZdLGI9byooMS1nKSooMS1wKSthKmcqKDEtcCkraCpwKigxLWcpK2MqZypwLGtbeSsrXT1iO3JldHVybiBUfSxoZXJtaXRlRmFzdFJlc2l6ZTpmdW5jdGlvbih0LGUsaSxvLGEpe2Zvcih2YXIgaD10aGlzLnJjcFNjYWxlWCxsPXRoaXMucmNwU2NhbGVZLHU9YyhoLzIpLGY9YyhsLzIpLGQ9dC5nZXRDb250ZXh0KFwiMmRcIiksZz1kLmdldEltYWdlRGF0YSgwLDAsZSxpKSxwPWcuZGF0YSx2PWQuZ2V0SW1hZ2VEYXRhKDAsMCxvLGEpLGI9di5kYXRhLG09MDthPm07bSsrKWZvcih2YXIgeT0wO28+eTt5Kyspe2Zvcih2YXIgXz00Kih5K20qbykseD0wLEM9MCxTPTAsdz0wLE89MCxUPTAsaz0wLGo9KG0rLjUpKmwsQT1yKG0qbCk7KG0rMSkqbD5BO0ErKylmb3IodmFyIFA9bihqLShBKy41KSkvZixFPSh5Ky41KSpoLE09UCpQLEk9cih5KmgpOyh5KzEpKmg+STtJKyspe3ZhciBEPW4oRS0oSSsuNSkpL3UsTD1zKE0rRCpEKTtMPjEmJi0xPkx8fCh4PTIqTCpMKkwtMypMKkwrMSx4PjAmJihEPTQqKEkrQSplKSxrKz14KnBbRCszXSxTKz14LHBbRCszXTwyNTUmJih4PXgqcFtEKzNdLzI1MCksdys9eCpwW0RdLE8rPXgqcFtEKzFdLFQrPXgqcFtEKzJdLEMrPXgpKX1iW19dPXcvQyxiW18rMV09Ty9DLGJbXysyXT1UL0MsYltfKzNdPWsvU31yZXR1cm4gdn0sdG9PYmplY3Q6ZnVuY3Rpb24oKXtyZXR1cm57dHlwZTp0aGlzLnR5cGUsc2NhbGVYOnRoaXMuc2NhbGVYLHNjYWxlWTp0aGlzLnNjYWxlWSxyZXNpemVUeXBlOnRoaXMucmVzaXplVHlwZSxsYW5jem9zTG9iZXM6dGhpcy5sYW5jem9zTG9iZXN9fX0pLGUuSW1hZ2UuZmlsdGVycy5SZXNpemUuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuSW1hZ2UuZmlsdGVycy5SZXNpemUodCl9fShcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cz9leHBvcnRzOnRoaXMpLGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuZmFicmljfHwodC5mYWJyaWM9e30pLGk9ZS51dGlsLm9iamVjdC5leHRlbmQscj1lLnV0aWwub2JqZWN0LmNsb25lLHM9ZS51dGlsLnRvRml4ZWQsbj1lLlN0YXRpY0NhbnZhcy5zdXBwb3J0cyhcInNldExpbmVEYXNoXCIpLG89ZS5PYmplY3QuTlVNX0ZSQUNUSU9OX0RJR0lUUztpZihlLlRleHQpcmV0dXJuIHZvaWQgZS53YXJuKFwiZmFicmljLlRleHQgaXMgYWxyZWFkeSBkZWZpbmVkXCIpO3ZhciBhPWUuT2JqZWN0LnByb3RvdHlwZS5zdGF0ZVByb3BlcnRpZXMuY29uY2F0KCk7YS5wdXNoKFwiZm9udEZhbWlseVwiLFwiZm9udFdlaWdodFwiLFwiZm9udFNpemVcIixcInRleHRcIixcInRleHREZWNvcmF0aW9uXCIsXCJ0ZXh0QWxpZ25cIixcImZvbnRTdHlsZVwiLFwibGluZUhlaWdodFwiLFwidGV4dEJhY2tncm91bmRDb2xvclwiKSxlLlRleHQ9ZS51dGlsLmNyZWF0ZUNsYXNzKGUuT2JqZWN0LHtfZGltZW5zaW9uQWZmZWN0aW5nUHJvcHM6e2ZvbnRTaXplOiEwLGZvbnRXZWlnaHQ6ITAsZm9udEZhbWlseTohMCxmb250U3R5bGU6ITAsbGluZUhlaWdodDohMCxzdHJva2U6ITAsc3Ryb2tlV2lkdGg6ITAsdGV4dDohMCx0ZXh0QWxpZ246ITB9LF9yZU5ld2xpbmU6L1xccj9cXG4vLHR5cGU6XCJ0ZXh0XCIsZm9udFNpemU6NDAsZm9udFdlaWdodDpcIm5vcm1hbFwiLGZvbnRGYW1pbHk6XCJUaW1lcyBOZXcgUm9tYW5cIix0ZXh0RGVjb3JhdGlvbjpcIlwiLHRleHRBbGlnbjpcImxlZnRcIixmb250U3R5bGU6XCJcIixsaW5lSGVpZ2h0OjEuMTYsdGV4dEJhY2tncm91bmRDb2xvcjpcIlwiLHN0YXRlUHJvcGVydGllczphLHN0cm9rZTpudWxsLHNoYWRvdzpudWxsLF9mb250U2l6ZUZyYWN0aW9uOi4yNSxfZm9udFNpemVNdWx0OjEuMTMsaW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe2U9ZXx8e30sdGhpcy50ZXh0PXQsdGhpcy5fX3NraXBEaW1lbnNpb249ITAsdGhpcy5zZXRPcHRpb25zKGUpLHRoaXMuX19za2lwRGltZW5zaW9uPSExLHRoaXMuX2luaXREaW1lbnNpb25zKCl9LF9pbml0RGltZW5zaW9uczpmdW5jdGlvbih0KXtpZighdGhpcy5fX3NraXBEaW1lbnNpb24pe3R8fCh0PWUudXRpbC5jcmVhdGVDYW52YXNFbGVtZW50KCkuZ2V0Q29udGV4dChcIjJkXCIpLHRoaXMuX3NldFRleHRTdHlsZXModCkpLHRoaXMuX3RleHRMaW5lcz10aGlzLnRleHQuc3BsaXQodGhpcy5fcmVOZXdsaW5lKSx0aGlzLl9jbGVhckNhY2hlKCk7dmFyIGk9dGhpcy50ZXh0QWxpZ247dGhpcy50ZXh0QWxpZ249XCJsZWZ0XCIsdGhpcy53aWR0aD10aGlzLl9nZXRUZXh0V2lkdGgodCksdGhpcy50ZXh0QWxpZ249aSx0aGlzLmhlaWdodD10aGlzLl9nZXRUZXh0SGVpZ2h0KHQpfX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIiM8ZmFicmljLlRleHQgKFwiK3RoaXMuY29tcGxleGl0eSgpKycpOiB7IFwidGV4dFwiOiBcIicrdGhpcy50ZXh0KydcIiwgXCJmb250RmFtaWx5XCI6IFwiJyt0aGlzLmZvbnRGYW1pbHkrJ1wiIH0+J30sX3JlbmRlcjpmdW5jdGlvbih0KXt0aGlzLmNsaXBUbyYmZS51dGlsLmNsaXBDb250ZXh0KHRoaXMsdCksdGhpcy5fcmVuZGVyVGV4dEJhY2tncm91bmQodCksdGhpcy5fcmVuZGVyVGV4dCh0KSx0aGlzLl9yZW5kZXJUZXh0RGVjb3JhdGlvbih0KSx0aGlzLmNsaXBUbyYmdC5yZXN0b3JlKCl9LF9yZW5kZXJUZXh0OmZ1bmN0aW9uKHQpe3Quc2F2ZSgpLHRoaXMuX3RyYW5zbGF0ZUZvclRleHRBbGlnbih0KSx0aGlzLl9zZXRPcGFjaXR5KHQpLHRoaXMuX3NldFNoYWRvdyh0KSx0aGlzLl9zZXR1cENvbXBvc2l0ZU9wZXJhdGlvbih0KSx0aGlzLl9yZW5kZXJUZXh0RmlsbCh0KSx0aGlzLl9yZW5kZXJUZXh0U3Ryb2tlKHQpLHQucmVzdG9yZSgpfSxfdHJhbnNsYXRlRm9yVGV4dEFsaWduOmZ1bmN0aW9uKHQpe1wibGVmdFwiIT09dGhpcy50ZXh0QWxpZ24mJlwianVzdGlmeVwiIT09dGhpcy50ZXh0QWxpZ24mJnQudHJhbnNsYXRlKFwiY2VudGVyXCI9PT10aGlzLnRleHRBbGlnbj90aGlzLndpZHRoLzI6dGhpcy53aWR0aCwwKX0sX3NldFRleHRTdHlsZXM6ZnVuY3Rpb24odCl7dC50ZXh0QmFzZWxpbmU9XCJhbHBoYWJldGljXCIsdGhpcy5za2lwVGV4dEFsaWdufHwodC50ZXh0QWxpZ249dGhpcy50ZXh0QWxpZ24pLHQuZm9udD10aGlzLl9nZXRGb250RGVjbGFyYXRpb24oKX0sX2dldFRleHRIZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGV4dExpbmVzLmxlbmd0aCp0aGlzLl9nZXRIZWlnaHRPZkxpbmUoKX0sX2dldFRleHRXaWR0aDpmdW5jdGlvbih0KXtmb3IodmFyIGU9dGhpcy5fZ2V0TGluZVdpZHRoKHQsMCksaT0xLHI9dGhpcy5fdGV4dExpbmVzLmxlbmd0aDtyPmk7aSsrKXt2YXIgcz10aGlzLl9nZXRMaW5lV2lkdGgodCxpKTtzPmUmJihlPXMpfXJldHVybiBlfSxfcmVuZGVyQ2hhcnM6ZnVuY3Rpb24odCxlLGkscixzKXt2YXIgbj10LnNsaWNlKDAsLTQpO2lmKHRoaXNbbl0udG9MaXZlKXt2YXIgbz0tdGhpcy53aWR0aC8yK3RoaXNbbl0ub2Zmc2V0WHx8MCxhPS10aGlzLmhlaWdodC8yK3RoaXNbbl0ub2Zmc2V0WXx8MDtlLnNhdmUoKSxlLnRyYW5zbGF0ZShvLGEpLHItPW8scy09YX1jb25zb2xlLmxvZyhlLnN0cm9rZVN0eWxlKSxlW3RdKGkscixzKSx0aGlzW25dLnRvTGl2ZSYmZS5yZXN0b3JlKCl9LF9yZW5kZXJUZXh0TGluZTpmdW5jdGlvbih0LGUsaSxyLHMsbil7aWYocy09dGhpcy5mb250U2l6ZSp0aGlzLl9mb250U2l6ZUZyYWN0aW9uLFwianVzdGlmeVwiIT09dGhpcy50ZXh0QWxpZ24pcmV0dXJuIHZvaWQgdGhpcy5fcmVuZGVyQ2hhcnModCxlLGkscixzLG4pO3ZhciBvPXRoaXMuX2dldExpbmVXaWR0aChlLG4pLGE9dGhpcy53aWR0aDtpZihhPj1vKWZvcih2YXIgaD1pLnNwbGl0KC9cXHMrLyksYz10aGlzLl9nZXRXaWR0aE9mV29yZHMoZSxpLG4pLGw9YS1jLHU9aC5sZW5ndGgtMSxmPWwvdSxkPTAsZz0wLHA9aC5sZW5ndGg7cD5nO2crKyl0aGlzLl9yZW5kZXJDaGFycyh0LGUsaFtnXSxyK2QscyxuKSxkKz1lLm1lYXN1cmVUZXh0KGhbZ10pLndpZHRoK2Y7ZWxzZSB0aGlzLl9yZW5kZXJDaGFycyh0LGUsaSxyLHMsbil9LF9nZXRXaWR0aE9mV29yZHM6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5tZWFzdXJlVGV4dChlLnJlcGxhY2UoL1xccysvZyxcIlwiKSkud2lkdGh9LF9nZXRMZWZ0T2Zmc2V0OmZ1bmN0aW9uKCl7cmV0dXJuLXRoaXMud2lkdGgvMn0sX2dldFRvcE9mZnNldDpmdW5jdGlvbigpe3JldHVybi10aGlzLmhlaWdodC8yfSxfcmVuZGVyVGV4dEZpbGw6ZnVuY3Rpb24odCl7aWYodGhpcy5maWxsfHx0aGlzLl9za2lwRmlsbFN0cm9rZUNoZWNrKWZvcih2YXIgZT0wLGk9MCxyPXRoaXMuX3RleHRMaW5lcy5sZW5ndGg7cj5pO2krKyl7dmFyIHM9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHQsaSksbj1zL3RoaXMubGluZUhlaWdodDt0aGlzLl9yZW5kZXJUZXh0TGluZShcImZpbGxUZXh0XCIsdCx0aGlzLl90ZXh0TGluZXNbaV0sdGhpcy5fZ2V0TGVmdE9mZnNldCgpLHRoaXMuX2dldFRvcE9mZnNldCgpK2UrbixpKSxlKz1zfX0sX3JlbmRlclRleHRTdHJva2U6ZnVuY3Rpb24odCl7aWYodGhpcy5zdHJva2UmJjAhPT10aGlzLnN0cm9rZVdpZHRofHx0aGlzLl9za2lwRmlsbFN0cm9rZUNoZWNrKXt2YXIgZT0wO3RoaXMuc2hhZG93JiYhdGhpcy5zaGFkb3cuYWZmZWN0U3Ryb2tlJiZ0aGlzLl9yZW1vdmVTaGFkb3codCksdC5zYXZlKCksdGhpcy5zdHJva2VEYXNoQXJyYXkmJigxJnRoaXMuc3Ryb2tlRGFzaEFycmF5Lmxlbmd0aCYmdGhpcy5zdHJva2VEYXNoQXJyYXkucHVzaC5hcHBseSh0aGlzLnN0cm9rZURhc2hBcnJheSx0aGlzLnN0cm9rZURhc2hBcnJheSksbiYmdC5zZXRMaW5lRGFzaCh0aGlzLnN0cm9rZURhc2hBcnJheSkpLHQuYmVnaW5QYXRoKCk7Zm9yKHZhciBpPTAscj10aGlzLl90ZXh0TGluZXMubGVuZ3RoO3I+aTtpKyspe3ZhciBzPXRoaXMuX2dldEhlaWdodE9mTGluZSh0LGkpLG89cy90aGlzLmxpbmVIZWlnaHQ7dGhpcy5fcmVuZGVyVGV4dExpbmUoXCJzdHJva2VUZXh0XCIsdCx0aGlzLl90ZXh0TGluZXNbaV0sdGhpcy5fZ2V0TGVmdE9mZnNldCgpLHRoaXMuX2dldFRvcE9mZnNldCgpK2UrbyxpKSxlKz1zfXQuY2xvc2VQYXRoKCksdC5yZXN0b3JlKCl9fSxfZ2V0SGVpZ2h0T2ZMaW5lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZm9udFNpemUqdGhpcy5fZm9udFNpemVNdWx0KnRoaXMubGluZUhlaWdodH0sX3JlbmRlclRleHRCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQpe3RoaXMuX3JlbmRlclRleHRCb3hCYWNrZ3JvdW5kKHQpLHRoaXMuX3JlbmRlclRleHRMaW5lc0JhY2tncm91bmQodCl9LF9yZW5kZXJUZXh0Qm94QmFja2dyb3VuZDpmdW5jdGlvbih0KXt0aGlzLmJhY2tncm91bmRDb2xvciYmKHQuc2F2ZSgpLHQuZmlsbFN0eWxlPXRoaXMuYmFja2dyb3VuZENvbG9yLHQuZmlsbFJlY3QodGhpcy5fZ2V0TGVmdE9mZnNldCgpLHRoaXMuX2dldFRvcE9mZnNldCgpLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLHQucmVzdG9yZSgpKX0sX3JlbmRlclRleHRMaW5lc0JhY2tncm91bmQ6ZnVuY3Rpb24odCl7dmFyIGU9MCxpPXRoaXMuX2dldEhlaWdodE9mTGluZSgpO2lmKHRoaXMudGV4dEJhY2tncm91bmRDb2xvcil7dC5zYXZlKCksdC5maWxsU3R5bGU9dGhpcy50ZXh0QmFja2dyb3VuZENvbG9yO2Zvcih2YXIgcj0wLHM9dGhpcy5fdGV4dExpbmVzLmxlbmd0aDtzPnI7cisrKXtpZihcIlwiIT09dGhpcy5fdGV4dExpbmVzW3JdKXt2YXIgbj10aGlzLl9nZXRMaW5lV2lkdGgodCxyKSxvPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KG4pO3QuZmlsbFJlY3QodGhpcy5fZ2V0TGVmdE9mZnNldCgpK28sdGhpcy5fZ2V0VG9wT2Zmc2V0KCkrZSxuLHRoaXMuZm9udFNpemUqdGhpcy5fZm9udFNpemVNdWx0KX1lKz1pfXQucmVzdG9yZSgpfX0sX2dldExpbmVMZWZ0T2Zmc2V0OmZ1bmN0aW9uKHQpe3JldHVyblwiY2VudGVyXCI9PT10aGlzLnRleHRBbGlnbj8odGhpcy53aWR0aC10KS8yOlwicmlnaHRcIj09PXRoaXMudGV4dEFsaWduP3RoaXMud2lkdGgtdDowfSxfY2xlYXJDYWNoZTpmdW5jdGlvbigpe3RoaXMuX19saW5lV2lkdGhzPVtdLHRoaXMuX19saW5lSGVpZ2h0cz1bXSx0aGlzLl9fbGluZU9mZnNldHM9W119LF9zaG91bGRDbGVhckNhY2hlOmZ1bmN0aW9uKCl7dmFyIHQ9ITE7Zm9yKHZhciBlIGluIHRoaXMuX2RpbWVuc2lvbkFmZmVjdGluZ1Byb3BzKXRoaXNbXCJfX1wiK2VdIT09dGhpc1tlXSYmKHRoaXNbXCJfX1wiK2VdPXRoaXNbZV0sdD0hMCk7cmV0dXJuIHR9LF9nZXRMaW5lV2lkdGg6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fX2xpbmVXaWR0aHNbZV0/dGhpcy5fX2xpbmVXaWR0aHNbZV06KHRoaXMuX19saW5lV2lkdGhzW2VdPXQubWVhc3VyZVRleHQodGhpcy5fdGV4dExpbmVzW2VdKS53aWR0aCx0aGlzLl9fbGluZVdpZHRoc1tlXSl9LF9yZW5kZXJUZXh0RGVjb3JhdGlvbjpmdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUpe3ZhciBzLG4sbyxhLGg9MDtmb3Iocz0wLG49ci5fdGV4dExpbmVzLmxlbmd0aDtuPnM7cysrKXt2YXIgYz1yLl9nZXRMaW5lV2lkdGgodCxzKSxsPXIuX2dldExpbmVMZWZ0T2Zmc2V0KGMpLHU9ci5fZ2V0SGVpZ2h0T2ZMaW5lKHQscyk7Zm9yKG89MCxhPWUubGVuZ3RoO2E+bztvKyspdC5maWxsUmVjdChyLl9nZXRMZWZ0T2Zmc2V0KCkrbCxoKyhyLl9mb250U2l6ZU11bHQtMStlW29dKSpyLmZvbnRTaXplLWksYyxyLmZvbnRTaXplLzE1KTtoKz11fX1pZih0aGlzLnRleHREZWNvcmF0aW9uKXt2YXIgaT10aGlzLmhlaWdodC8yLHI9dGhpcyxzPVtdO3RoaXMudGV4dERlY29yYXRpb24uaW5kZXhPZihcInVuZGVybGluZVwiKT4tMSYmcy5wdXNoKC44NSksdGhpcy50ZXh0RGVjb3JhdGlvbi5pbmRleE9mKFwibGluZS10aHJvdWdoXCIpPi0xJiZzLnB1c2goLjQzKSx0aGlzLnRleHREZWNvcmF0aW9uLmluZGV4T2YoXCJvdmVybGluZVwiKT4tMSYmcy5wdXNoKC0uMTIpLHMubGVuZ3RoPjAmJmUocyl9fSxfZ2V0Rm9udERlY2xhcmF0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuW2UuaXNMaWtlbHlOb2RlP3RoaXMuZm9udFdlaWdodDp0aGlzLmZvbnRTdHlsZSxlLmlzTGlrZWx5Tm9kZT90aGlzLmZvbnRTdHlsZTp0aGlzLmZvbnRXZWlnaHQsdGhpcy5mb250U2l6ZStcInB4XCIsZS5pc0xpa2VseU5vZGU/J1wiJyt0aGlzLmZvbnRGYW1pbHkrJ1wiJzp0aGlzLmZvbnRGYW1pbHldLmpvaW4oXCIgXCIpfSxyZW5kZXI6ZnVuY3Rpb24odCxlKXt0aGlzLnZpc2libGUmJih0LnNhdmUoKSx0aGlzLl9zZXRUZXh0U3R5bGVzKHQpLHRoaXMuX3Nob3VsZENsZWFyQ2FjaGUoKSYmdGhpcy5faW5pdERpbWVuc2lvbnModCksZXx8dGhpcy50cmFuc2Zvcm0odCksdGhpcy5fc2V0U3Ryb2tlU3R5bGVzKHQpLHRoaXMuX3NldEZpbGxTdHlsZXModCksdGhpcy50cmFuc2Zvcm1NYXRyaXgmJnQudHJhbnNmb3JtLmFwcGx5KHQsdGhpcy50cmFuc2Zvcm1NYXRyaXgpLHRoaXMuZ3JvdXAmJlwicGF0aC1ncm91cFwiPT09dGhpcy5ncm91cC50eXBlJiZ0LnRyYW5zbGF0ZSh0aGlzLmxlZnQsdGhpcy50b3ApLHRoaXMuX3JlbmRlcih0KSx0LnJlc3RvcmUoKSl9LHRvT2JqZWN0OmZ1bmN0aW9uKHQpe3ZhciBlPWkodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLHQpLHt0ZXh0OnRoaXMudGV4dCxmb250U2l6ZTp0aGlzLmZvbnRTaXplLGZvbnRXZWlnaHQ6dGhpcy5mb250V2VpZ2h0LGZvbnRGYW1pbHk6dGhpcy5mb250RmFtaWx5LGZvbnRTdHlsZTp0aGlzLmZvbnRTdHlsZSxsaW5lSGVpZ2h0OnRoaXMubGluZUhlaWdodCx0ZXh0RGVjb3JhdGlvbjp0aGlzLnRleHREZWNvcmF0aW9uLHRleHRBbGlnbjp0aGlzLnRleHRBbGlnbix0ZXh0QmFja2dyb3VuZENvbG9yOnRoaXMudGV4dEJhY2tncm91bmRDb2xvcn0pO3JldHVybiB0aGlzLmluY2x1ZGVEZWZhdWx0VmFsdWVzfHx0aGlzLl9yZW1vdmVEZWZhdWx0VmFsdWVzKGUpLGV9LHRvU1ZHOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2NyZWF0ZUJhc2VTVkdNYXJrdXAoKSxpPXRoaXMuX2dldFNWR0xlZnRUb3BPZmZzZXRzKHRoaXMuY3R4KSxyPXRoaXMuX2dldFNWR1RleHRBbmRCZyhpLnRleHRUb3AsaS50ZXh0TGVmdCk7cmV0dXJuIHRoaXMuX3dyYXBTVkdUZXh0QW5kQmcoZSxyKSx0P3QoZS5qb2luKFwiXCIpKTplLmpvaW4oXCJcIil9LF9nZXRTVkdMZWZ0VG9wT2Zmc2V0czpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9nZXRIZWlnaHRPZkxpbmUodCwwKSxpPS10aGlzLndpZHRoLzIscj0wO3JldHVybnt0ZXh0TGVmdDppKyh0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZT90aGlzLmxlZnQ6MCksdGV4dFRvcDpyKyh0aGlzLmdyb3VwJiZcInBhdGgtZ3JvdXBcIj09PXRoaXMuZ3JvdXAudHlwZT8tdGhpcy50b3A6MCksbGluZVRvcDplfX0sX3dyYXBTVkdUZXh0QW5kQmc6ZnVuY3Rpb24odCxlKXt0LnB1c2goJ1x0PGcgdHJhbnNmb3JtPVwiJyx0aGlzLmdldFN2Z1RyYW5zZm9ybSgpLHRoaXMuZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KCksJ1wiPlxcbicsZS50ZXh0QmdSZWN0cy5qb2luKFwiXCIpLFwiXHRcdDx0ZXh0IFwiLHRoaXMuZm9udEZhbWlseT8nZm9udC1mYW1pbHk9XCInK3RoaXMuZm9udEZhbWlseS5yZXBsYWNlKC9cIi9nLFwiJ1wiKSsnXCIgJzpcIlwiLHRoaXMuZm9udFNpemU/J2ZvbnQtc2l6ZT1cIicrdGhpcy5mb250U2l6ZSsnXCIgJzpcIlwiLHRoaXMuZm9udFN0eWxlPydmb250LXN0eWxlPVwiJyt0aGlzLmZvbnRTdHlsZSsnXCIgJzpcIlwiLHRoaXMuZm9udFdlaWdodD8nZm9udC13ZWlnaHQ9XCInK3RoaXMuZm9udFdlaWdodCsnXCIgJzpcIlwiLHRoaXMudGV4dERlY29yYXRpb24/J3RleHQtZGVjb3JhdGlvbj1cIicrdGhpcy50ZXh0RGVjb3JhdGlvbisnXCIgJzpcIlwiLCdzdHlsZT1cIicsdGhpcy5nZXRTdmdTdHlsZXMoKSwnXCIgPicsZS50ZXh0U3BhbnMuam9pbihcIlwiKSxcIjwvdGV4dD5cXG5cIixcIlx0PC9nPlxcblwiKX0sX2dldFNWR1RleHRBbmRCZzpmdW5jdGlvbih0LGUpe3ZhciBpPVtdLHI9W10scz0wO3RoaXMuX3NldFNWR0JnKHIpO2Zvcih2YXIgbj0wLG89dGhpcy5fdGV4dExpbmVzLmxlbmd0aDtvPm47bisrKXRoaXMudGV4dEJhY2tncm91bmRDb2xvciYmdGhpcy5fc2V0U1ZHVGV4dExpbmVCZyhyLG4sZSx0LHMpLHRoaXMuX3NldFNWR1RleHRMaW5lVGV4dChuLGkscyxlLHQscikscys9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LG4pO3JldHVybnt0ZXh0U3BhbnM6aSx0ZXh0QmdSZWN0czpyfX0sX3NldFNWR1RleHRMaW5lVGV4dDpmdW5jdGlvbih0LGkscixuLGEpe3ZhciBoPXRoaXMuZm9udFNpemUqKHRoaXMuX2ZvbnRTaXplTXVsdC10aGlzLl9mb250U2l6ZUZyYWN0aW9uKS1hK3ItdGhpcy5oZWlnaHQvMjtpLnB1c2goJzx0c3BhbiB4PVwiJyxzKG4rdGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQodGhpcy5fX2xpbmVXaWR0aHNbdF0pLG8pLCdcIiAnLCd5PVwiJyxzKGgsbyksJ1wiICcsdGhpcy5fZ2V0RmlsbEF0dHJpYnV0ZXModGhpcy5maWxsKSxcIj5cIixlLnV0aWwuc3RyaW5nLmVzY2FwZVhtbCh0aGlzLl90ZXh0TGluZXNbdF0pLFwiPC90c3Bhbj5cIil9LF9zZXRTVkdUZXh0TGluZUJnOmZ1bmN0aW9uKHQsZSxpLHIsbil7dC5wdXNoKFwiXHRcdDxyZWN0IFwiLHRoaXMuX2dldEZpbGxBdHRyaWJ1dGVzKHRoaXMudGV4dEJhY2tncm91bmRDb2xvciksJyB4PVwiJyxzKGkrdGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQodGhpcy5fX2xpbmVXaWR0aHNbZV0pLG8pLCdcIiB5PVwiJyxzKG4tdGhpcy5oZWlnaHQvMixvKSwnXCIgd2lkdGg9XCInLHModGhpcy5fX2xpbmVXaWR0aHNbZV0sbyksJ1wiIGhlaWdodD1cIicscyh0aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgsZSkvdGhpcy5saW5lSGVpZ2h0LG8pLCdcIj48L3JlY3Q+XFxuJyl9LF9zZXRTVkdCZzpmdW5jdGlvbih0KXt0aGlzLmJhY2tncm91bmRDb2xvciYmdC5wdXNoKFwiXHRcdDxyZWN0IFwiLHRoaXMuX2dldEZpbGxBdHRyaWJ1dGVzKHRoaXMuYmFja2dyb3VuZENvbG9yKSwnIHg9XCInLHMoLXRoaXMud2lkdGgvMixvKSwnXCIgeT1cIicscygtdGhpcy5oZWlnaHQvMixvKSwnXCIgd2lkdGg9XCInLHModGhpcy53aWR0aCxvKSwnXCIgaGVpZ2h0PVwiJyxzKHRoaXMuaGVpZ2h0LG8pLCdcIj48L3JlY3Q+XFxuJyl9LF9nZXRGaWxsQXR0cmlidXRlczpmdW5jdGlvbih0KXt2YXIgaT10JiZcInN0cmluZ1wiPT10eXBlb2YgdD9uZXcgZS5Db2xvcih0KTpcIlwiO3JldHVybiBpJiZpLmdldFNvdXJjZSgpJiYxIT09aS5nZXRBbHBoYSgpPydvcGFjaXR5PVwiJytpLmdldEFscGhhKCkrJ1wiIGZpbGw9XCInK2kuc2V0QWxwaGEoMSkudG9SZ2IoKSsnXCInOidmaWxsPVwiJyt0KydcIid9LF9zZXQ6ZnVuY3Rpb24odCxlKXt0aGlzLmNhbGxTdXBlcihcIl9zZXRcIix0LGUpLHQgaW4gdGhpcy5fZGltZW5zaW9uQWZmZWN0aW5nUHJvcHMmJih0aGlzLl9pbml0RGltZW5zaW9ucygpLHRoaXMuc2V0Q29vcmRzKCkpfSxjb21wbGV4aXR5OmZ1bmN0aW9uKCl7cmV0dXJuIDF9fSksZS5UZXh0LkFUVFJJQlVURV9OQU1FUz1lLlNIQVJFRF9BVFRSSUJVVEVTLmNvbmNhdChcInggeSBkeCBkeSBmb250LWZhbWlseSBmb250LXN0eWxlIGZvbnQtd2VpZ2h0IGZvbnQtc2l6ZSB0ZXh0LWRlY29yYXRpb24gdGV4dC1hbmNob3JcIi5zcGxpdChcIiBcIikpLGUuVGV4dC5ERUZBVUxUX1NWR19GT05UX1NJWkU9MTYsZS5UZXh0LmZyb21FbGVtZW50PWZ1bmN0aW9uKHQsaSl7aWYoIXQpcmV0dXJuIG51bGw7dmFyIHI9ZS5wYXJzZUF0dHJpYnV0ZXModCxlLlRleHQuQVRUUklCVVRFX05BTUVTKTtpPWUudXRpbC5vYmplY3QuZXh0ZW5kKGk/ZS51dGlsLm9iamVjdC5jbG9uZShpKTp7fSxyKSxpLnRvcD1pLnRvcHx8MCxpLmxlZnQ9aS5sZWZ0fHwwLFwiZHhcImluIHImJihpLmxlZnQrPXIuZHgpLFwiZHlcImluIHImJihpLnRvcCs9ci5keSksXCJmb250U2l6ZVwiaW4gaXx8KGkuZm9udFNpemU9ZS5UZXh0LkRFRkFVTFRfU1ZHX0ZPTlRfU0laRSksaS5vcmlnaW5YfHwoaS5vcmlnaW5YPVwibGVmdFwiKTt2YXIgcz10LnRleHRDb250ZW50LnJlcGxhY2UoL15cXHMrfFxccyskfFxcbisvZyxcIlwiKS5yZXBsYWNlKC9cXHMrL2csXCIgXCIpLG49bmV3IGUuVGV4dChzLGkpLG89MDtyZXR1cm5cImxlZnRcIj09PW4ub3JpZ2luWCYmKG89bi5nZXRXaWR0aCgpLzIpLFwicmlnaHRcIj09PW4ub3JpZ2luWCYmKG89LW4uZ2V0V2lkdGgoKS8yKSxuLnNldCh7bGVmdDpuLmdldExlZnQoKStvLHRvcDpuLmdldFRvcCgpLW4uZ2V0SGVpZ2h0KCkvMituLmZvbnRTaXplKiguMTgrbi5fZm9udFNpemVGcmFjdGlvbil9KSxufSxlLlRleHQuZnJvbU9iamVjdD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUuVGV4dCh0LnRleHQscih0KSl9LGUudXRpbC5jcmVhdGVBY2Nlc3NvcnMoZS5UZXh0KX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHM/ZXhwb3J0czp0aGlzKSxmdW5jdGlvbigpe3ZhciB0PWZhYnJpYy51dGlsLm9iamVjdC5jbG9uZTtmYWJyaWMuSVRleHQ9ZmFicmljLnV0aWwuY3JlYXRlQ2xhc3MoZmFicmljLlRleHQsZmFicmljLk9ic2VydmFibGUse3R5cGU6XCJpLXRleHRcIixzZWxlY3Rpb25TdGFydDowLHNlbGVjdGlvbkVuZDowLHNlbGVjdGlvbkNvbG9yOlwicmdiYSgxNywxMTksMjU1LDAuMylcIixpc0VkaXRpbmc6ITEsZWRpdGFibGU6ITAsZWRpdGluZ0JvcmRlckNvbG9yOlwicmdiYSgxMDIsMTUzLDI1NSwwLjI1KVwiLGN1cnNvcldpZHRoOjIsY3Vyc29yQ29sb3I6XCIjMzMzXCIsY3Vyc29yRGVsYXk6MWUzLGN1cnNvckR1cmF0aW9uOjYwMCxzdHlsZXM6bnVsbCxjYWNoaW5nOiEwLF9za2lwRmlsbFN0cm9rZUNoZWNrOiExLF9yZVNwYWNlOi9cXHN8XFxuLyxfY3VycmVudEN1cnNvck9wYWNpdHk6MCxfc2VsZWN0aW9uRGlyZWN0aW9uOm51bGwsX2Fib3J0Q3Vyc29yQW5pbWF0aW9uOiExLF9jaGFyV2lkdGhzQ2FjaGU6e30saW5pdGlhbGl6ZTpmdW5jdGlvbih0LGUpe3RoaXMuc3R5bGVzPWU/ZS5zdHlsZXN8fHt9Ont9LHRoaXMuY2FsbFN1cGVyKFwiaW5pdGlhbGl6ZVwiLHQsZSksdGhpcy5pbml0QmVoYXZpb3IoKX0sX2NsZWFyQ2FjaGU6ZnVuY3Rpb24oKXt0aGlzLmNhbGxTdXBlcihcIl9jbGVhckNhY2hlXCIpLHRoaXMuX19tYXhGb250SGVpZ2h0cz1bXSx0aGlzLl9fd2lkdGhPZlNwYWNlPVtdfSxpc0VtcHR5U3R5bGVzOmZ1bmN0aW9uKCl7aWYoIXRoaXMuc3R5bGVzKXJldHVybiEwO3ZhciB0PXRoaXMuc3R5bGVzO2Zvcih2YXIgZSBpbiB0KWZvcih2YXIgaSBpbiB0W2VdKWZvcih2YXIgciBpbiB0W2VdW2ldKXJldHVybiExO3JldHVybiEwfSxzZXRTZWxlY3Rpb25TdGFydDpmdW5jdGlvbih0KXt0PU1hdGgubWF4KHQsMCksdGhpcy5zZWxlY3Rpb25TdGFydCE9PXQmJih0aGlzLmZpcmUoXCJzZWxlY3Rpb246Y2hhbmdlZFwiKSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMuZmlyZShcInRleHQ6c2VsZWN0aW9uOmNoYW5nZWRcIix7dGFyZ2V0OnRoaXN9KSx0aGlzLnNlbGVjdGlvblN0YXJ0PXQpLHRoaXMuX3VwZGF0ZVRleHRhcmVhKCl9LHNldFNlbGVjdGlvbkVuZDpmdW5jdGlvbih0KXt0PU1hdGgubWluKHQsdGhpcy50ZXh0Lmxlbmd0aCksdGhpcy5zZWxlY3Rpb25FbmQhPT10JiYodGhpcy5maXJlKFwic2VsZWN0aW9uOmNoYW5nZWRcIiksdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLmZpcmUoXCJ0ZXh0OnNlbGVjdGlvbjpjaGFuZ2VkXCIse3RhcmdldDp0aGlzfSksdGhpcy5zZWxlY3Rpb25FbmQ9dCksdGhpcy5fdXBkYXRlVGV4dGFyZWEoKX0sZ2V0U2VsZWN0aW9uU3R5bGVzOmZ1bmN0aW9uKHQsZSl7aWYoMj09PWFyZ3VtZW50cy5sZW5ndGgpe2Zvcih2YXIgaT1bXSxyPXQ7ZT5yO3IrKylpLnB1c2godGhpcy5nZXRTZWxlY3Rpb25TdHlsZXMocikpO3JldHVybiBpfXZhciBzPXRoaXMuZ2V0MkRDdXJzb3JMb2NhdGlvbih0KTtyZXR1cm4gdGhpcy5zdHlsZXNbcy5saW5lSW5kZXhdP3RoaXMuc3R5bGVzW3MubGluZUluZGV4XVtzLmNoYXJJbmRleF18fHt9Ont9fSxzZXRTZWxlY3Rpb25TdHlsZXM6ZnVuY3Rpb24odCl7aWYodGhpcy5zZWxlY3Rpb25TdGFydD09PXRoaXMuc2VsZWN0aW9uRW5kKXRoaXMuX2V4dGVuZFN0eWxlcyh0aGlzLnNlbGVjdGlvblN0YXJ0LHQpO2Vsc2UgZm9yKHZhciBlPXRoaXMuc2VsZWN0aW9uU3RhcnQ7ZTx0aGlzLnNlbGVjdGlvbkVuZDtlKyspdGhpcy5fZXh0ZW5kU3R5bGVzKGUsdCk7cmV0dXJuIHRoaXMuX2NsZWFyQ2FjaGUoKSx0aGlzfSxfZXh0ZW5kU3R5bGVzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKHQpO3RoaXMuc3R5bGVzW2kubGluZUluZGV4XXx8KHRoaXMuc3R5bGVzW2kubGluZUluZGV4XT17fSksdGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdW2kuY2hhckluZGV4XXx8KHRoaXMuc3R5bGVzW2kubGluZUluZGV4XVtpLmNoYXJJbmRleF09e30pLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQodGhpcy5zdHlsZXNbaS5saW5lSW5kZXhdW2kuY2hhckluZGV4XSxlKX0sX3JlbmRlcjpmdW5jdGlvbih0KXt0aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJcIix0KSx0aGlzLmN0eD10LHRoaXMuaXNFZGl0aW5nJiZ0aGlzLnJlbmRlckN1cnNvck9yU2VsZWN0aW9uKCl9LHJlbmRlckN1cnNvck9yU2VsZWN0aW9uOmZ1bmN0aW9uKCl7aWYodGhpcy5hY3RpdmUpe3ZhciB0LGUsaT10aGlzLnRleHQuc3BsaXQoXCJcIik7dGhpcy5jYW52YXMuY29udGV4dFRvcD8oZT10aGlzLmNhbnZhcy5jb250ZXh0VG9wLGUuc2F2ZSgpLGUudHJhbnNmb3JtLmFwcGx5KGUsdGhpcy5jYW52YXMudmlld3BvcnRUcmFuc2Zvcm0pLHRoaXMudHJhbnNmb3JtKGUpLHRoaXMudHJhbnNmb3JtTWF0cml4JiZlLnRyYW5zZm9ybS5hcHBseShlLHRoaXMudHJhbnNmb3JtTWF0cml4KSk6KGU9dGhpcy5jdHgsZS5zYXZlKCkpLHRoaXMuc2VsZWN0aW9uU3RhcnQ9PT10aGlzLnNlbGVjdGlvbkVuZD8odD10aGlzLl9nZXRDdXJzb3JCb3VuZGFyaWVzKGksXCJjdXJzb3JcIiksdGhpcy5yZW5kZXJDdXJzb3IodCxlKSk6KHQ9dGhpcy5fZ2V0Q3Vyc29yQm91bmRhcmllcyhpLFwic2VsZWN0aW9uXCIpLHRoaXMucmVuZGVyU2VsZWN0aW9uKGksdCxlKSksXHJcbmUucmVzdG9yZSgpfX0sZ2V0MkRDdXJzb3JMb2NhdGlvbjpmdW5jdGlvbih0KXtcInVuZGVmaW5lZFwiPT10eXBlb2YgdCYmKHQ9dGhpcy5zZWxlY3Rpb25TdGFydCk7Zm9yKHZhciBlPXRoaXMuX3RleHRMaW5lcy5sZW5ndGgsaT0wO2U+aTtpKyspe2lmKHQ8PXRoaXMuX3RleHRMaW5lc1tpXS5sZW5ndGgpcmV0dXJue2xpbmVJbmRleDppLGNoYXJJbmRleDp0fTt0LT10aGlzLl90ZXh0TGluZXNbaV0ubGVuZ3RoKzF9cmV0dXJue2xpbmVJbmRleDppLTEsY2hhckluZGV4OnRoaXMuX3RleHRMaW5lc1tpLTFdLmxlbmd0aDx0P3RoaXMuX3RleHRMaW5lc1tpLTFdLmxlbmd0aDp0fX0sZ2V0Q3VycmVudENoYXJTdHlsZTpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuc3R5bGVzW3RdJiZ0aGlzLnN0eWxlc1t0XVswPT09ZT8wOmUtMV07cmV0dXJue2ZvbnRTaXplOmkmJmkuZm9udFNpemV8fHRoaXMuZm9udFNpemUsZmlsbDppJiZpLmZpbGx8fHRoaXMuZmlsbCx0ZXh0QmFja2dyb3VuZENvbG9yOmkmJmkudGV4dEJhY2tncm91bmRDb2xvcnx8dGhpcy50ZXh0QmFja2dyb3VuZENvbG9yLHRleHREZWNvcmF0aW9uOmkmJmkudGV4dERlY29yYXRpb258fHRoaXMudGV4dERlY29yYXRpb24sZm9udEZhbWlseTppJiZpLmZvbnRGYW1pbHl8fHRoaXMuZm9udEZhbWlseSxmb250V2VpZ2h0OmkmJmkuZm9udFdlaWdodHx8dGhpcy5mb250V2VpZ2h0LGZvbnRTdHlsZTppJiZpLmZvbnRTdHlsZXx8dGhpcy5mb250U3R5bGUsc3Ryb2tlOmkmJmkuc3Ryb2tlfHx0aGlzLnN0cm9rZSxzdHJva2VXaWR0aDppJiZpLnN0cm9rZVdpZHRofHx0aGlzLnN0cm9rZVdpZHRofX0sZ2V0Q3VycmVudENoYXJGb250U2l6ZTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnN0eWxlc1t0XSYmdGhpcy5zdHlsZXNbdF1bMD09PWU/MDplLTFdJiZ0aGlzLnN0eWxlc1t0XVswPT09ZT8wOmUtMV0uZm9udFNpemV8fHRoaXMuZm9udFNpemV9LGdldEN1cnJlbnRDaGFyQ29sb3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5zdHlsZXNbdF0mJnRoaXMuc3R5bGVzW3RdWzA9PT1lPzA6ZS0xXSYmdGhpcy5zdHlsZXNbdF1bMD09PWU/MDplLTFdLmZpbGx8fHRoaXMuY3Vyc29yQ29sb3J9LF9nZXRDdXJzb3JCb3VuZGFyaWVzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9TWF0aC5yb3VuZCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCkpLHI9dGhpcy5fZ2V0VG9wT2Zmc2V0KCkscz10aGlzLl9nZXRDdXJzb3JCb3VuZGFyaWVzT2Zmc2V0cyh0LGUpO3JldHVybntsZWZ0OmksdG9wOnIsbGVmdE9mZnNldDpzLmxlZnQrcy5saW5lTGVmdCx0b3BPZmZzZXQ6cy50b3B9fSxfZ2V0Q3Vyc29yQm91bmRhcmllc09mZnNldHM6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9MCxyPTAscz0wLG49MCxvPTAsYT0wO2E8dGhpcy5zZWxlY3Rpb25TdGFydDthKyspXCJcXG5cIj09PXRbYV0/KG89MCxuKz10aGlzLl9nZXRIZWlnaHRPZkxpbmUodGhpcy5jdHgscikscisrLHM9MCk6KG8rPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LHRbYV0scixzKSxzKyspLGk9dGhpcy5fZ2V0Q2FjaGVkTGluZU9mZnNldChyKTtyZXR1cm5cImN1cnNvclwiPT09ZSYmKG4rPSgxLXRoaXMuX2ZvbnRTaXplRnJhY3Rpb24pKnRoaXMuX2dldEhlaWdodE9mTGluZSh0aGlzLmN0eCxyKS90aGlzLmxpbmVIZWlnaHQtdGhpcy5nZXRDdXJyZW50Q2hhckZvbnRTaXplKHIscykqKDEtdGhpcy5fZm9udFNpemVGcmFjdGlvbikpLHt0b3A6bixsZWZ0Om8sbGluZUxlZnQ6aX19LF9nZXRDYWNoZWRMaW5lT2Zmc2V0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCx0KTtyZXR1cm4gdGhpcy5fX2xpbmVPZmZzZXRzW3RdfHwodGhpcy5fX2xpbmVPZmZzZXRzW3RdPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KGUpKX0scmVuZGVyQ3Vyc29yOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKCkscj1pLmxpbmVJbmRleCxzPWkuY2hhckluZGV4LG49dGhpcy5nZXRDdXJyZW50Q2hhckZvbnRTaXplKHIscyksbz0wPT09ciYmMD09PXM/dGhpcy5fZ2V0Q2FjaGVkTGluZU9mZnNldChyKTp0LmxlZnRPZmZzZXQ7ZS5maWxsU3R5bGU9dGhpcy5nZXRDdXJyZW50Q2hhckNvbG9yKHIscyksZS5nbG9iYWxBbHBoYT10aGlzLl9faXNNb3VzZWRvd24/MTp0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eSxlLmZpbGxSZWN0KHQubGVmdCtvLHQudG9wK3QudG9wT2Zmc2V0LHRoaXMuY3Vyc29yV2lkdGgvdGhpcy5zY2FsZVgsbil9LHJlbmRlclNlbGVjdGlvbjpmdW5jdGlvbih0LGUsaSl7aS5maWxsU3R5bGU9dGhpcy5zZWxlY3Rpb25Db2xvcjtmb3IodmFyIHI9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKHRoaXMuc2VsZWN0aW9uU3RhcnQpLHM9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKHRoaXMuc2VsZWN0aW9uRW5kKSxuPXIubGluZUluZGV4LG89cy5saW5lSW5kZXgsYT1uO28+PWE7YSsrKXt2YXIgaD10aGlzLl9nZXRDYWNoZWRMaW5lT2Zmc2V0KGEpfHwwLGM9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LGEpLGw9MCx1PXRoaXMuX3RleHRMaW5lc1thXTtpZihhPT09bilmb3IodmFyIGY9MCxkPXUubGVuZ3RoO2Q+ZjtmKyspZj49ci5jaGFySW5kZXgmJihhIT09b3x8ZjxzLmNoYXJJbmRleCkmJihsKz10aGlzLl9nZXRXaWR0aE9mQ2hhcihpLHVbZl0sYSxmKSksZjxyLmNoYXJJbmRleCYmKGgrPXRoaXMuX2dldFdpZHRoT2ZDaGFyKGksdVtmXSxhLGYpKTtlbHNlIGlmKGE+biYmbz5hKWwrPXRoaXMuX2dldExpbmVXaWR0aChpLGEpfHw1O2Vsc2UgaWYoYT09PW8pZm9yKHZhciBnPTAscD1zLmNoYXJJbmRleDtwPmc7ZysrKWwrPXRoaXMuX2dldFdpZHRoT2ZDaGFyKGksdVtnXSxhLGcpO2kuZmlsbFJlY3QoZS5sZWZ0K2gsZS50b3ArZS50b3BPZmZzZXQsbCxjKSxlLnRvcE9mZnNldCs9Y319LF9yZW5kZXJDaGFyczpmdW5jdGlvbih0LGUsaSxyLHMsbil7aWYodGhpcy5pc0VtcHR5U3R5bGVzKCkpcmV0dXJuIHRoaXMuX3JlbmRlckNoYXJzRmFzdCh0LGUsaSxyLHMpO3RoaXMuc2tpcFRleHRBbGlnbj0hMCxyLT1cImNlbnRlclwiPT09dGhpcy50ZXh0QWxpZ24/dGhpcy53aWR0aC8yOlwicmlnaHRcIj09PXRoaXMudGV4dEFsaWduP3RoaXMud2lkdGg6MDt2YXIgbyxhPXRoaXMuX2dldEhlaWdodE9mTGluZShlLG4pLGg9dGhpcy5fZ2V0Q2FjaGVkTGluZU9mZnNldChuKSxjPVwiXCI7cis9aHx8MCxlLnNhdmUoKSxzLT1hL3RoaXMubGluZUhlaWdodCp0aGlzLl9mb250U2l6ZUZyYWN0aW9uO2Zvcih2YXIgbD0wLHU9aS5sZW5ndGg7dT49bDtsKyspe289b3x8dGhpcy5nZXRDdXJyZW50Q2hhclN0eWxlKG4sbCk7dmFyIGY9dGhpcy5nZXRDdXJyZW50Q2hhclN0eWxlKG4sbCsxKTsodGhpcy5faGFzU3R5bGVDaGFuZ2VkKG8sZil8fGw9PT11KSYmKHRoaXMuX3JlbmRlckNoYXIodCxlLG4sbC0xLGMscixzLGEpLGM9XCJcIixvPWYpLGMrPWlbbF19ZS5yZXN0b3JlKCl9LF9yZW5kZXJDaGFyc0Zhc3Q6ZnVuY3Rpb24odCxlLGkscixzKXt0aGlzLnNraXBUZXh0QWxpZ249ITEsXCJmaWxsVGV4dFwiPT09dCYmdGhpcy5maWxsJiZ0aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJDaGFyc1wiLHQsZSxpLHIscyksXCJzdHJva2VUZXh0XCI9PT10JiYodGhpcy5zdHJva2UmJnRoaXMuc3Ryb2tlV2lkdGg+MHx8dGhpcy5za2lwRmlsbFN0cm9rZUNoZWNrKSYmdGhpcy5jYWxsU3VwZXIoXCJfcmVuZGVyQ2hhcnNcIix0LGUsaSxyLHMpfSxfcmVuZGVyQ2hhcjpmdW5jdGlvbih0LGUsaSxyLHMsbixvLGEpe3ZhciBoLGMsbCx1PXRoaXMuX2ZvbnRTaXplRnJhY3Rpb24qYS90aGlzLmxpbmVIZWlnaHQ7aWYodGhpcy5zdHlsZXMmJnRoaXMuc3R5bGVzW2ldJiYoaD10aGlzLnN0eWxlc1tpXVtyXSkpe3ZhciBmPWguc3Ryb2tlfHx0aGlzLnN0cm9rZSxkPWguZmlsbHx8dGhpcy5maWxsO2Uuc2F2ZSgpLGM9dGhpcy5fYXBwbHlDaGFyU3R5bGVzR2V0V2lkdGgoZSxzLGkscixoKSxsPXRoaXMuX2dldEhlaWdodE9mQ2hhcihlLHMsaSxyKSxkJiZlLmZpbGxUZXh0KHMsbixvKSxmJiZlLnN0cm9rZVRleHQocyxuLG8pLHRoaXMuX3JlbmRlckNoYXJEZWNvcmF0aW9uKGUsaCxuLG8sdSxjLGwpLGUucmVzdG9yZSgpLGUudHJhbnNsYXRlKGMsMCl9ZWxzZVwic3Ryb2tlVGV4dFwiPT09dCYmdGhpcy5zdHJva2UmJmVbdF0ocyxuLG8pLFwiZmlsbFRleHRcIj09PXQmJnRoaXMuZmlsbCYmZVt0XShzLG4sbyksYz10aGlzLl9hcHBseUNoYXJTdHlsZXNHZXRXaWR0aChlLHMsaSxyKSx0aGlzLl9yZW5kZXJDaGFyRGVjb3JhdGlvbihlLG51bGwsbixvLHUsYyx0aGlzLmZvbnRTaXplKSxlLnRyYW5zbGF0ZShlLm1lYXN1cmVUZXh0KHMpLndpZHRoLDApfSxfaGFzU3R5bGVDaGFuZ2VkOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuZmlsbCE9PWUuZmlsbHx8dC5mb250U2l6ZSE9PWUuZm9udFNpemV8fHQudGV4dEJhY2tncm91bmRDb2xvciE9PWUudGV4dEJhY2tncm91bmRDb2xvcnx8dC50ZXh0RGVjb3JhdGlvbiE9PWUudGV4dERlY29yYXRpb258fHQuZm9udEZhbWlseSE9PWUuZm9udEZhbWlseXx8dC5mb250V2VpZ2h0IT09ZS5mb250V2VpZ2h0fHx0LmZvbnRTdHlsZSE9PWUuZm9udFN0eWxlfHx0LnN0cm9rZSE9PWUuc3Ryb2tlfHx0LnN0cm9rZVdpZHRoIT09ZS5zdHJva2VXaWR0aH0sX3JlbmRlckNoYXJEZWNvcmF0aW9uOmZ1bmN0aW9uKHQsZSxpLHIscyxuLG8pe3ZhciBhPWU/ZS50ZXh0RGVjb3JhdGlvbnx8dGhpcy50ZXh0RGVjb3JhdGlvbjp0aGlzLnRleHREZWNvcmF0aW9uO2EmJihhLmluZGV4T2YoXCJ1bmRlcmxpbmVcIik+LTEmJnQuZmlsbFJlY3QoaSxyK28vMTAsbixvLzE1KSxhLmluZGV4T2YoXCJsaW5lLXRocm91Z2hcIik+LTEmJnQuZmlsbFJlY3QoaSxyLW8qKHRoaXMuX2ZvbnRTaXplRnJhY3Rpb24rdGhpcy5fZm9udFNpemVNdWx0LTEpK28vMTUsbixvLzE1KSxhLmluZGV4T2YoXCJvdmVybGluZVwiKT4tMSYmdC5maWxsUmVjdChpLHItKHRoaXMuX2ZvbnRTaXplTXVsdC10aGlzLl9mb250U2l6ZUZyYWN0aW9uKSpvLG4sby8xNSkpfSxfcmVuZGVyVGV4dExpbmU6ZnVuY3Rpb24odCxlLGkscixzLG4pe3RoaXMuaXNFbXB0eVN0eWxlcygpfHwocys9dGhpcy5mb250U2l6ZSoodGhpcy5fZm9udFNpemVGcmFjdGlvbisuMDMpKSx0aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJUZXh0TGluZVwiLHQsZSxpLHIscyxuKX0sX3JlbmRlclRleHREZWNvcmF0aW9uOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmlzRW1wdHlTdHlsZXMoKT90aGlzLmNhbGxTdXBlcihcIl9yZW5kZXJUZXh0RGVjb3JhdGlvblwiLHQpOnZvaWQgMH0sX3JlbmRlclRleHRMaW5lc0JhY2tncm91bmQ6ZnVuY3Rpb24odCl7aWYodGhpcy50ZXh0QmFja2dyb3VuZENvbG9yfHx0aGlzLnN0eWxlcyl7dC5zYXZlKCksdGhpcy50ZXh0QmFja2dyb3VuZENvbG9yJiYodC5maWxsU3R5bGU9dGhpcy50ZXh0QmFja2dyb3VuZENvbG9yKTtmb3IodmFyIGU9MCxpPTAscj10aGlzLl90ZXh0TGluZXMubGVuZ3RoO3I+aTtpKyspe3ZhciBzPXRoaXMuX2dldEhlaWdodE9mTGluZSh0LGkpO2lmKFwiXCIhPT10aGlzLl90ZXh0TGluZXNbaV0pe3ZhciBuPXRoaXMuX2dldExpbmVXaWR0aCh0LGkpLG89dGhpcy5fZ2V0Q2FjaGVkTGluZU9mZnNldChpKTtpZih0aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3ImJih0LmZpbGxTdHlsZT10aGlzLnRleHRCYWNrZ3JvdW5kQ29sb3IsdC5maWxsUmVjdCh0aGlzLl9nZXRMZWZ0T2Zmc2V0KCkrbyx0aGlzLl9nZXRUb3BPZmZzZXQoKStlLG4scy90aGlzLmxpbmVIZWlnaHQpKSx0aGlzLnN0eWxlc1tpXSlmb3IodmFyIGE9MCxoPXRoaXMuX3RleHRMaW5lc1tpXS5sZW5ndGg7aD5hO2ErKylpZih0aGlzLnN0eWxlc1tpXSYmdGhpcy5zdHlsZXNbaV1bYV0mJnRoaXMuc3R5bGVzW2ldW2FdLnRleHRCYWNrZ3JvdW5kQ29sb3Ipe3ZhciBjPXRoaXMuX3RleHRMaW5lc1tpXVthXTt0LmZpbGxTdHlsZT10aGlzLnN0eWxlc1tpXVthXS50ZXh0QmFja2dyb3VuZENvbG9yLHQuZmlsbFJlY3QodGhpcy5fZ2V0TGVmdE9mZnNldCgpK28rdGhpcy5fZ2V0V2lkdGhPZkNoYXJzQXQodCxpLGEpLHRoaXMuX2dldFRvcE9mZnNldCgpK2UsdGhpcy5fZ2V0V2lkdGhPZkNoYXIodCxjLGksYSkrMSxzL3RoaXMubGluZUhlaWdodCl9ZSs9c31lbHNlIGUrPXN9dC5yZXN0b3JlKCl9fSxfZ2V0Q2FjaGVQcm9wOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrZS5mb250RmFtaWx5K2UuZm9udFNpemUrZS5mb250V2VpZ2h0K2UuZm9udFN0eWxlK2Uuc2hhZG93fSxfYXBwbHlDaGFyU3R5bGVzR2V0V2lkdGg6ZnVuY3Rpb24oZSxpLHIscyxuKXt2YXIgbz1ufHx0aGlzLnN0eWxlc1tyXSYmdGhpcy5zdHlsZXNbcl1bc107bz1vP3Qobyk6e30sdGhpcy5fYXBwbHlGb250U3R5bGVzKG8pO3ZhciBhPXRoaXMuX2dldENhY2hlUHJvcChpLG8pO2lmKHRoaXMuaXNFbXB0eVN0eWxlcygpJiZ0aGlzLl9jaGFyV2lkdGhzQ2FjaGVbYV0mJnRoaXMuY2FjaGluZylyZXR1cm4gdGhpcy5fY2hhcldpZHRoc0NhY2hlW2FdO1wic3RyaW5nXCI9PXR5cGVvZiBvLnNoYWRvdyYmKG8uc2hhZG93PW5ldyBmYWJyaWMuU2hhZG93KG8uc2hhZG93KSk7dmFyIGg9by5maWxsfHx0aGlzLmZpbGw7cmV0dXJuIGUuZmlsbFN0eWxlPWgudG9MaXZlP2gudG9MaXZlKGUsdGhpcyk6aCxvLnN0cm9rZSYmKGUuc3Ryb2tlU3R5bGU9by5zdHJva2UmJm8uc3Ryb2tlLnRvTGl2ZT9vLnN0cm9rZS50b0xpdmUoZSx0aGlzKTpvLnN0cm9rZSksZS5saW5lV2lkdGg9by5zdHJva2VXaWR0aHx8dGhpcy5zdHJva2VXaWR0aCxlLmZvbnQ9dGhpcy5fZ2V0Rm9udERlY2xhcmF0aW9uLmNhbGwobyksdGhpcy5fc2V0U2hhZG93LmNhbGwobyxlKSx0aGlzLmNhY2hpbmc/KHRoaXMuX2NoYXJXaWR0aHNDYWNoZVthXXx8KHRoaXMuX2NoYXJXaWR0aHNDYWNoZVthXT1lLm1lYXN1cmVUZXh0KGkpLndpZHRoKSx0aGlzLl9jaGFyV2lkdGhzQ2FjaGVbYV0pOmUubWVhc3VyZVRleHQoaSkud2lkdGh9LF9hcHBseUZvbnRTdHlsZXM6ZnVuY3Rpb24odCl7dC5mb250RmFtaWx5fHwodC5mb250RmFtaWx5PXRoaXMuZm9udEZhbWlseSksdC5mb250U2l6ZXx8KHQuZm9udFNpemU9dGhpcy5mb250U2l6ZSksdC5mb250V2VpZ2h0fHwodC5mb250V2VpZ2h0PXRoaXMuZm9udFdlaWdodCksdC5mb250U3R5bGV8fCh0LmZvbnRTdHlsZT10aGlzLmZvbnRTdHlsZSl9LF9nZXRTdHlsZURlY2xhcmF0aW9uOmZ1bmN0aW9uKGUsaSl7cmV0dXJuIHRoaXMuc3R5bGVzW2VdJiZ0aGlzLnN0eWxlc1tlXVtpXT90KHRoaXMuc3R5bGVzW2VdW2ldKTp7fX0sX2dldFdpZHRoT2ZDaGFyOmZ1bmN0aW9uKHQsZSxpLHIpe2lmKFwianVzdGlmeVwiPT09dGhpcy50ZXh0QWxpZ24mJi9cXHMvLnRlc3QoZSkpcmV0dXJuIHRoaXMuX2dldFdpZHRoT2ZTcGFjZSh0LGkpO3ZhciBzPXRoaXMuX2dldFN0eWxlRGVjbGFyYXRpb24oaSxyKTt0aGlzLl9hcHBseUZvbnRTdHlsZXMocyk7dmFyIG49dGhpcy5fZ2V0Q2FjaGVQcm9wKGUscyk7aWYodGhpcy5fY2hhcldpZHRoc0NhY2hlW25dJiZ0aGlzLmNhY2hpbmcpcmV0dXJuIHRoaXMuX2NoYXJXaWR0aHNDYWNoZVtuXTtpZih0KXt0LnNhdmUoKTt2YXIgbz10aGlzLl9hcHBseUNoYXJTdHlsZXNHZXRXaWR0aCh0LGUsaSxyKTtyZXR1cm4gdC5yZXN0b3JlKCksb319LF9nZXRIZWlnaHRPZkNoYXI6ZnVuY3Rpb24odCxlLGkscil7cmV0dXJuIHRoaXMuc3R5bGVzW2ldJiZ0aGlzLnN0eWxlc1tpXVtyXT90aGlzLnN0eWxlc1tpXVtyXS5mb250U2l6ZXx8dGhpcy5mb250U2l6ZTp0aGlzLmZvbnRTaXplfSxfZ2V0SGVpZ2h0T2ZDaGFyQXQ6ZnVuY3Rpb24odCxlLGkpe3ZhciByPXRoaXMuX3RleHRMaW5lc1tlXVtpXTtyZXR1cm4gdGhpcy5fZ2V0SGVpZ2h0T2ZDaGFyKHQscixlLGkpfSxfZ2V0V2lkdGhPZkNoYXJzQXQ6ZnVuY3Rpb24odCxlLGkpe3ZhciByLHMsbj0wO2ZvcihyPTA7aT5yO3IrKylzPXRoaXMuX3RleHRMaW5lc1tlXVtyXSxuKz10aGlzLl9nZXRXaWR0aE9mQ2hhcih0LHMsZSxyKTtyZXR1cm4gbn0sX2dldExpbmVXaWR0aDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9fbGluZVdpZHRoc1tlXT90aGlzLl9fbGluZVdpZHRoc1tlXToodGhpcy5fX2xpbmVXaWR0aHNbZV09dGhpcy5fZ2V0V2lkdGhPZkNoYXJzQXQodCxlLHRoaXMuX3RleHRMaW5lc1tlXS5sZW5ndGgpLHRoaXMuX19saW5lV2lkdGhzW2VdKX0sX2dldFdpZHRoT2ZTcGFjZTpmdW5jdGlvbih0LGUpe2lmKHRoaXMuX193aWR0aE9mU3BhY2VbZV0pcmV0dXJuIHRoaXMuX193aWR0aE9mU3BhY2VbZV07dmFyIGk9dGhpcy5fdGV4dExpbmVzW2VdLHI9dGhpcy5fZ2V0V2lkdGhPZldvcmRzKHQsaSxlKSxzPXRoaXMud2lkdGgtcixuPWkubGVuZ3RoLWkucmVwbGFjZSgvXFxzKy9nLFwiXCIpLmxlbmd0aCxvPXMvbjtyZXR1cm4gdGhpcy5fX3dpZHRoT2ZTcGFjZVtlXT1vLG99LF9nZXRXaWR0aE9mV29yZHM6ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgcj0wLHM9MDtzPGUubGVuZ3RoO3MrKyl7dmFyIG49ZVtzXTtuLm1hdGNoKC9cXHMvKXx8KHIrPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHQsbixpLHMpKX1yZXR1cm4gcn0sX2dldEhlaWdodE9mTGluZTpmdW5jdGlvbih0LGUpe2lmKHRoaXMuX19saW5lSGVpZ2h0c1tlXSlyZXR1cm4gdGhpcy5fX2xpbmVIZWlnaHRzW2VdO2Zvcih2YXIgaT10aGlzLl90ZXh0TGluZXNbZV0scj10aGlzLl9nZXRIZWlnaHRPZkNoYXIodCxpWzBdLGUsMCkscz0xLG49aS5sZW5ndGg7bj5zO3MrKyl7dmFyIG89dGhpcy5fZ2V0SGVpZ2h0T2ZDaGFyKHQsaVtzXSxlLHMpO28+ciYmKHI9byl9cmV0dXJuIHRoaXMuX19tYXhGb250SGVpZ2h0c1tlXT1yLHRoaXMuX19saW5lSGVpZ2h0c1tlXT1yKnRoaXMubGluZUhlaWdodCp0aGlzLl9mb250U2l6ZU11bHQsdGhpcy5fX2xpbmVIZWlnaHRzW2VdfSxfZ2V0VGV4dEhlaWdodDpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPTAscj10aGlzLl90ZXh0TGluZXMubGVuZ3RoO3I+aTtpKyspZSs9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHQsaSk7cmV0dXJuIGV9LF9yZW5kZXJUZXh0Qm94QmFja2dyb3VuZDpmdW5jdGlvbih0KXt0aGlzLmJhY2tncm91bmRDb2xvciYmKHQuc2F2ZSgpLHQuZmlsbFN0eWxlPXRoaXMuYmFja2dyb3VuZENvbG9yLHQuZmlsbFJlY3QodGhpcy5fZ2V0TGVmdE9mZnNldCgpLHRoaXMuX2dldFRvcE9mZnNldCgpLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLHQucmVzdG9yZSgpKX0sdG9PYmplY3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQodGhpcy5jYWxsU3VwZXIoXCJ0b09iamVjdFwiLGUpLHtzdHlsZXM6dCh0aGlzLnN0eWxlcyl9KX19KSxmYWJyaWMuSVRleHQuZnJvbU9iamVjdD1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IGZhYnJpYy5JVGV4dChlLnRleHQsdChlKSl9fSgpLGZ1bmN0aW9uKCl7dmFyIHQ9ZmFicmljLnV0aWwub2JqZWN0LmNsb25lO2ZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLklUZXh0LnByb3RvdHlwZSx7aW5pdEJlaGF2aW9yOmZ1bmN0aW9uKCl7dGhpcy5pbml0QWRkZWRIYW5kbGVyKCksdGhpcy5pbml0UmVtb3ZlZEhhbmRsZXIoKSx0aGlzLmluaXRDdXJzb3JTZWxlY3Rpb25IYW5kbGVycygpLHRoaXMuaW5pdERvdWJsZUNsaWNrU2ltdWxhdGlvbigpfSxpbml0U2VsZWN0ZWRIYW5kbGVyOmZ1bmN0aW9uKCl7dGhpcy5vbihcInNlbGVjdGVkXCIsZnVuY3Rpb24oKXt2YXIgdD10aGlzO3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0LnNlbGVjdGVkPSEwfSwxMDApfSl9LGluaXRBZGRlZEhhbmRsZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3RoaXMub24oXCJhZGRlZFwiLGZ1bmN0aW9uKCl7dGhpcy5jYW52YXMmJiF0aGlzLmNhbnZhcy5faGFzSVRleHRIYW5kbGVycyYmKHRoaXMuY2FudmFzLl9oYXNJVGV4dEhhbmRsZXJzPSEwLHRoaXMuX2luaXRDYW52YXNIYW5kbGVycygpKSx0LmNhbnZhcyYmKHQuY2FudmFzLl9pVGV4dEluc3RhbmNlcz10LmNhbnZhcy5faVRleHRJbnN0YW5jZXN8fFtdLHQuY2FudmFzLl9pVGV4dEluc3RhbmNlcy5wdXNoKHQpKX0pfSxpbml0UmVtb3ZlZEhhbmRsZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3RoaXMub24oXCJyZW1vdmVkXCIsZnVuY3Rpb24oKXt0LmNhbnZhcyYmKHQuY2FudmFzLl9pVGV4dEluc3RhbmNlcz10LmNhbnZhcy5faVRleHRJbnN0YW5jZXN8fFtdLGZhYnJpYy51dGlsLnJlbW92ZUZyb21BcnJheSh0LmNhbnZhcy5faVRleHRJbnN0YW5jZXMsdCkpfSl9LF9pbml0Q2FudmFzSGFuZGxlcnM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3RoaXMuY2FudmFzLm9uKFwic2VsZWN0aW9uOmNsZWFyZWRcIixmdW5jdGlvbigpe2ZhYnJpYy5JVGV4dC5wcm90b3R5cGUuZXhpdEVkaXRpbmdPbk90aGVycyh0LmNhbnZhcyl9KSx0aGlzLmNhbnZhcy5vbihcIm1vdXNlOnVwXCIsZnVuY3Rpb24oKXt0LmNhbnZhcy5faVRleHRJbnN0YW5jZXMmJnQuY2FudmFzLl9pVGV4dEluc3RhbmNlcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuX19pc01vdXNlZG93bj0hMX0pfSksdGhpcy5jYW52YXMub24oXCJvYmplY3Q6c2VsZWN0ZWRcIixmdW5jdGlvbigpe2ZhYnJpYy5JVGV4dC5wcm90b3R5cGUuZXhpdEVkaXRpbmdPbk90aGVycyh0LmNhbnZhcyl9KX0sX3RpY2s6ZnVuY3Rpb24oKXt0aGlzLl9jdXJyZW50VGlja1N0YXRlPXRoaXMuX2FuaW1hdGVDdXJzb3IodGhpcywxLHRoaXMuY3Vyc29yRHVyYXRpb24sXCJfb25UaWNrQ29tcGxldGVcIil9LF9hbmltYXRlQ3Vyc29yOmZ1bmN0aW9uKHQsZSxpLHIpe3ZhciBzO3JldHVybiBzPXtpc0Fib3J0ZWQ6ITEsYWJvcnQ6ZnVuY3Rpb24oKXt0aGlzLmlzQWJvcnRlZD0hMH19LHQuYW5pbWF0ZShcIl9jdXJyZW50Q3Vyc29yT3BhY2l0eVwiLGUse2R1cmF0aW9uOmksb25Db21wbGV0ZTpmdW5jdGlvbigpe3MuaXNBYm9ydGVkfHx0W3JdKCl9LG9uQ2hhbmdlOmZ1bmN0aW9uKCl7dC5jYW52YXMmJih0LmNhbnZhcy5jbGVhckNvbnRleHQodC5jYW52YXMuY29udGV4dFRvcHx8dC5jdHgpLHQucmVuZGVyQ3Vyc29yT3JTZWxlY3Rpb24oKSl9LGFib3J0OmZ1bmN0aW9uKCl7cmV0dXJuIHMuaXNBYm9ydGVkfX0pLHN9LF9vblRpY2tDb21wbGV0ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5fY3Vyc29yVGltZW91dDEmJmNsZWFyVGltZW91dCh0aGlzLl9jdXJzb3JUaW1lb3V0MSksdGhpcy5fY3Vyc29yVGltZW91dDE9c2V0VGltZW91dChmdW5jdGlvbigpe3QuX2N1cnJlbnRUaWNrQ29tcGxldGVTdGF0ZT10Ll9hbmltYXRlQ3Vyc29yKHQsMCx0aGlzLmN1cnNvckR1cmF0aW9uLzIsXCJfdGlja1wiKX0sMTAwKX0saW5pdERlbGF5ZWRDdXJzb3I6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxpPXQ/MDp0aGlzLmN1cnNvckRlbGF5O3RoaXMuX2N1cnJlbnRUaWNrU3RhdGUmJnRoaXMuX2N1cnJlbnRUaWNrU3RhdGUuYWJvcnQoKSx0aGlzLl9jdXJyZW50VGlja0NvbXBsZXRlU3RhdGUmJnRoaXMuX2N1cnJlbnRUaWNrQ29tcGxldGVTdGF0ZS5hYm9ydCgpLGNsZWFyVGltZW91dCh0aGlzLl9jdXJzb3JUaW1lb3V0MSksdGhpcy5fY3VycmVudEN1cnNvck9wYWNpdHk9MSx0aGlzLmNhbnZhcyYmKHRoaXMuY2FudmFzLmNsZWFyQ29udGV4dCh0aGlzLmNhbnZhcy5jb250ZXh0VG9wfHx0aGlzLmN0eCksdGhpcy5yZW5kZXJDdXJzb3JPclNlbGVjdGlvbigpKSx0aGlzLl9jdXJzb3JUaW1lb3V0MiYmY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvclRpbWVvdXQyKSx0aGlzLl9jdXJzb3JUaW1lb3V0Mj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZS5fdGljaygpfSxpKX0sYWJvcnRDdXJzb3JBbmltYXRpb246ZnVuY3Rpb24oKXt0aGlzLl9jdXJyZW50VGlja1N0YXRlJiZ0aGlzLl9jdXJyZW50VGlja1N0YXRlLmFib3J0KCksdGhpcy5fY3VycmVudFRpY2tDb21wbGV0ZVN0YXRlJiZ0aGlzLl9jdXJyZW50VGlja0NvbXBsZXRlU3RhdGUuYWJvcnQoKSxjbGVhclRpbWVvdXQodGhpcy5fY3Vyc29yVGltZW91dDEpLGNsZWFyVGltZW91dCh0aGlzLl9jdXJzb3JUaW1lb3V0MiksdGhpcy5fY3VycmVudEN1cnNvck9wYWNpdHk9MCx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMuY2xlYXJDb250ZXh0KHRoaXMuY2FudmFzLmNvbnRleHRUb3B8fHRoaXMuY3R4KX0sc2VsZWN0QWxsOmZ1bmN0aW9uKCl7dGhpcy5zZXRTZWxlY3Rpb25TdGFydCgwKSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnRleHQubGVuZ3RoKX0sZ2V0U2VsZWN0ZWRUZXh0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGV4dC5zbGljZSh0aGlzLnNlbGVjdGlvblN0YXJ0LHRoaXMuc2VsZWN0aW9uRW5kKX0sZmluZFdvcmRCb3VuZGFyeUxlZnQ6ZnVuY3Rpb24odCl7dmFyIGU9MCxpPXQtMTtpZih0aGlzLl9yZVNwYWNlLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSkpZm9yKDt0aGlzLl9yZVNwYWNlLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSk7KWUrKyxpLS07Zm9yKDsvXFxTLy50ZXN0KHRoaXMudGV4dC5jaGFyQXQoaSkpJiZpPi0xOyllKyssaS0tO3JldHVybiB0LWV9LGZpbmRXb3JkQm91bmRhcnlSaWdodDpmdW5jdGlvbih0KXt2YXIgZT0wLGk9dDtpZih0aGlzLl9yZVNwYWNlLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSkpZm9yKDt0aGlzLl9yZVNwYWNlLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSk7KWUrKyxpKys7Zm9yKDsvXFxTLy50ZXN0KHRoaXMudGV4dC5jaGFyQXQoaSkpJiZpPHRoaXMudGV4dC5sZW5ndGg7KWUrKyxpKys7cmV0dXJuIHQrZX0sZmluZExpbmVCb3VuZGFyeUxlZnQ6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT10LTE7IS9cXG4vLnRlc3QodGhpcy50ZXh0LmNoYXJBdChpKSkmJmk+LTE7KWUrKyxpLS07cmV0dXJuIHQtZX0sZmluZExpbmVCb3VuZGFyeVJpZ2h0OmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9dDshL1xcbi8udGVzdCh0aGlzLnRleHQuY2hhckF0KGkpKSYmaTx0aGlzLnRleHQubGVuZ3RoOyllKyssaSsrO3JldHVybiB0K2V9LGdldE51bU5ld0xpbmVzSW5TZWxlY3RlZFRleHQ6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy5nZXRTZWxlY3RlZFRleHQoKSxlPTAsaT0wLHI9dC5sZW5ndGg7cj5pO2krKylcIlxcblwiPT09dFtpXSYmZSsrO3JldHVybiBlfSxzZWFyY2hXb3JkQm91bmRhcnk6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9dGhpcy5fcmVTcGFjZS50ZXN0KHRoaXMudGV4dC5jaGFyQXQodCkpP3QtMTp0LHI9dGhpcy50ZXh0LmNoYXJBdChpKSxzPS9bIFxcblxcLiw7IVxcP1xcLV0vOyFzLnRlc3QocikmJmk+MCYmaTx0aGlzLnRleHQubGVuZ3RoOylpKz1lLHI9dGhpcy50ZXh0LmNoYXJBdChpKTtyZXR1cm4gcy50ZXN0KHIpJiZcIlxcblwiIT09ciYmKGkrPTE9PT1lPzA6MSksaX0sc2VsZWN0V29yZDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnNlYXJjaFdvcmRCb3VuZGFyeSh0LC0xKSxpPXRoaXMuc2VhcmNoV29yZEJvdW5kYXJ5KHQsMSk7dGhpcy5zZXRTZWxlY3Rpb25TdGFydChlKSx0aGlzLnNldFNlbGVjdGlvbkVuZChpKX0sc2VsZWN0TGluZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmZpbmRMaW5lQm91bmRhcnlMZWZ0KHQpLGk9dGhpcy5maW5kTGluZUJvdW5kYXJ5UmlnaHQodCk7dGhpcy5zZXRTZWxlY3Rpb25TdGFydChlKSx0aGlzLnNldFNlbGVjdGlvbkVuZChpKX0sZW50ZXJFZGl0aW5nOmZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuaXNFZGl0aW5nJiZ0aGlzLmVkaXRhYmxlPyh0aGlzLmNhbnZhcyYmdGhpcy5leGl0RWRpdGluZ09uT3RoZXJzKHRoaXMuY2FudmFzKSx0aGlzLmlzRWRpdGluZz0hMCx0aGlzLmluaXRIaWRkZW5UZXh0YXJlYSgpLHRoaXMuaGlkZGVuVGV4dGFyZWEuZm9jdXMoKSx0aGlzLl91cGRhdGVUZXh0YXJlYSgpLHRoaXMuX3NhdmVFZGl0aW5nUHJvcHMoKSx0aGlzLl9zZXRFZGl0aW5nUHJvcHMoKSx0aGlzLl90aWNrKCksdGhpcy5maXJlKFwiZWRpdGluZzplbnRlcmVkXCIpLHRoaXMuY2FudmFzPyh0aGlzLmNhbnZhcy5yZW5kZXJBbGwoKSx0aGlzLmNhbnZhcy5maXJlKFwidGV4dDplZGl0aW5nOmVudGVyZWRcIix7dGFyZ2V0OnRoaXN9KSx0aGlzLmluaXRNb3VzZU1vdmVIYW5kbGVyKCksdGhpcyk6dGhpcyk6dm9pZCAwfSxleGl0RWRpdGluZ09uT3RoZXJzOmZ1bmN0aW9uKHQpe3QuX2lUZXh0SW5zdGFuY2VzJiZ0Ll9pVGV4dEluc3RhbmNlcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3Quc2VsZWN0ZWQ9ITEsdC5pc0VkaXRpbmcmJnQuZXhpdEVkaXRpbmcoKX0pfSxpbml0TW91c2VNb3ZlSGFuZGxlcjpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dGhpcy5jYW52YXMub24oXCJtb3VzZTptb3ZlXCIsZnVuY3Rpb24oZSl7aWYodC5fX2lzTW91c2Vkb3duJiZ0LmlzRWRpdGluZyl7dmFyIGk9dC5nZXRTZWxlY3Rpb25TdGFydEZyb21Qb2ludGVyKGUuZSk7aT49dC5fX3NlbGVjdGlvblN0YXJ0T25Nb3VzZURvd24/KHQuc2V0U2VsZWN0aW9uU3RhcnQodC5fX3NlbGVjdGlvblN0YXJ0T25Nb3VzZURvd24pLHQuc2V0U2VsZWN0aW9uRW5kKGkpKToodC5zZXRTZWxlY3Rpb25TdGFydChpKSx0LnNldFNlbGVjdGlvbkVuZCh0Ll9fc2VsZWN0aW9uU3RhcnRPbk1vdXNlRG93bikpfX0pfSxfc2V0RWRpdGluZ1Byb3BzOmZ1bmN0aW9uKCl7dGhpcy5ob3ZlckN1cnNvcj1cInRleHRcIix0aGlzLmNhbnZhcyYmKHRoaXMuY2FudmFzLmRlZmF1bHRDdXJzb3I9dGhpcy5jYW52YXMubW92ZUN1cnNvcj1cInRleHRcIiksdGhpcy5ib3JkZXJDb2xvcj10aGlzLmVkaXRpbmdCb3JkZXJDb2xvcix0aGlzLmhhc0NvbnRyb2xzPXRoaXMuc2VsZWN0YWJsZT0hMSx0aGlzLmxvY2tNb3ZlbWVudFg9dGhpcy5sb2NrTW92ZW1lbnRZPSEwfSxfdXBkYXRlVGV4dGFyZWE6ZnVuY3Rpb24oKXt0aGlzLmhpZGRlblRleHRhcmVhJiYodGhpcy5oaWRkZW5UZXh0YXJlYS52YWx1ZT10aGlzLnRleHQsdGhpcy5oaWRkZW5UZXh0YXJlYS5zZWxlY3Rpb25TdGFydD10aGlzLnNlbGVjdGlvblN0YXJ0LHRoaXMuaGlkZGVuVGV4dGFyZWEuc2VsZWN0aW9uRW5kPXRoaXMuc2VsZWN0aW9uRW5kKX0sX3NhdmVFZGl0aW5nUHJvcHM6ZnVuY3Rpb24oKXt0aGlzLl9zYXZlZFByb3BzPXtoYXNDb250cm9sczp0aGlzLmhhc0NvbnRyb2xzLGJvcmRlckNvbG9yOnRoaXMuYm9yZGVyQ29sb3IsbG9ja01vdmVtZW50WDp0aGlzLmxvY2tNb3ZlbWVudFgsbG9ja01vdmVtZW50WTp0aGlzLmxvY2tNb3ZlbWVudFksaG92ZXJDdXJzb3I6dGhpcy5ob3ZlckN1cnNvcixkZWZhdWx0Q3Vyc29yOnRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5kZWZhdWx0Q3Vyc29yLG1vdmVDdXJzb3I6dGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLm1vdmVDdXJzb3J9fSxfcmVzdG9yZUVkaXRpbmdQcm9wczpmdW5jdGlvbigpe3RoaXMuX3NhdmVkUHJvcHMmJih0aGlzLmhvdmVyQ3Vyc29yPXRoaXMuX3NhdmVkUHJvcHMub3ZlckN1cnNvcix0aGlzLmhhc0NvbnRyb2xzPXRoaXMuX3NhdmVkUHJvcHMuaGFzQ29udHJvbHMsdGhpcy5ib3JkZXJDb2xvcj10aGlzLl9zYXZlZFByb3BzLmJvcmRlckNvbG9yLHRoaXMubG9ja01vdmVtZW50WD10aGlzLl9zYXZlZFByb3BzLmxvY2tNb3ZlbWVudFgsdGhpcy5sb2NrTW92ZW1lbnRZPXRoaXMuX3NhdmVkUHJvcHMubG9ja01vdmVtZW50WSx0aGlzLmNhbnZhcyYmKHRoaXMuY2FudmFzLmRlZmF1bHRDdXJzb3I9dGhpcy5fc2F2ZWRQcm9wcy5kZWZhdWx0Q3Vyc29yLHRoaXMuY2FudmFzLm1vdmVDdXJzb3I9dGhpcy5fc2F2ZWRQcm9wcy5tb3ZlQ3Vyc29yKSl9LGV4aXRFZGl0aW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2VsZWN0ZWQ9ITEsdGhpcy5pc0VkaXRpbmc9ITEsdGhpcy5zZWxlY3RhYmxlPSEwLHRoaXMuc2VsZWN0aW9uRW5kPXRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5oaWRkZW5UZXh0YXJlYSYmdGhpcy5jYW52YXMmJnRoaXMuaGlkZGVuVGV4dGFyZWEucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmhpZGRlblRleHRhcmVhKSx0aGlzLmhpZGRlblRleHRhcmVhPW51bGwsdGhpcy5hYm9ydEN1cnNvckFuaW1hdGlvbigpLHRoaXMuX3Jlc3RvcmVFZGl0aW5nUHJvcHMoKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0wLHRoaXMuZmlyZShcImVkaXRpbmc6ZXhpdGVkXCIpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5maXJlKFwidGV4dDplZGl0aW5nOmV4aXRlZFwiLHt0YXJnZXQ6dGhpc30pLHRoaXN9LF9yZW1vdmVFeHRyYW5lb3VzU3R5bGVzOmZ1bmN0aW9uKCl7Zm9yKHZhciB0IGluIHRoaXMuc3R5bGVzKXRoaXMuX3RleHRMaW5lc1t0XXx8ZGVsZXRlIHRoaXMuc3R5bGVzW3RdfSxfcmVtb3ZlQ2hhcnNGcm9tVG86ZnVuY3Rpb24odCxlKXtmb3IoO2UhPT10Oyl0aGlzLl9yZW1vdmVTaW5nbGVDaGFyQW5kU3R5bGUodCsxKSxlLS07dGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0KX0sX3JlbW92ZVNpbmdsZUNoYXJBbmRTdHlsZTpmdW5jdGlvbih0KXt2YXIgZT1cIlxcblwiPT09dGhpcy50ZXh0W3QtMV0saT1lP3Q6dC0xO3RoaXMucmVtb3ZlU3R5bGVPYmplY3QoZSxpKSx0aGlzLnRleHQ9dGhpcy50ZXh0LnNsaWNlKDAsdC0xKSt0aGlzLnRleHQuc2xpY2UodCksdGhpcy5fdGV4dExpbmVzPXRoaXMudGV4dC5zcGxpdCh0aGlzLl9yZU5ld2xpbmUpfSxpbnNlcnRDaGFyczpmdW5jdGlvbih0LGUpe3RoaXMuc2VsZWN0aW9uRW5kLXRoaXMuc2VsZWN0aW9uU3RhcnQ+MSYmKHRoaXMuX3JlbW92ZUNoYXJzRnJvbVRvKHRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5zZWxlY3Rpb25FbmQpLHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpKTt2YXIgaT1cIlxcblwiPT09dGhpcy50ZXh0W3RoaXMuc2VsZWN0aW9uU3RhcnRdO3RoaXMudGV4dD10aGlzLnRleHQuc2xpY2UoMCx0aGlzLnNlbGVjdGlvblN0YXJ0KSt0K3RoaXMudGV4dC5zbGljZSh0aGlzLnNlbGVjdGlvbkVuZCksdGhpcy5pbnNlcnRTdHlsZU9iamVjdHModCxpLGUpLHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25TdGFydCt0Lmxlbmd0aCksdGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25TdGFydCksdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLnJlbmRlckFsbCgpLHRoaXMuc2V0Q29vcmRzKCksdGhpcy5maXJlKFwiY2hhbmdlZFwiKSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMuZmlyZShcInRleHQ6Y2hhbmdlZFwiLHt0YXJnZXQ6dGhpc30pfSxpbnNlcnROZXdsaW5lU3R5bGVPYmplY3Q6ZnVuY3Rpb24oZSxpLHIpe3RoaXMuc2hpZnRMaW5lU3R5bGVzKGUsMSksdGhpcy5zdHlsZXNbZSsxXXx8KHRoaXMuc3R5bGVzW2UrMV09e30pO3ZhciBzPXt9LG49e307aWYodGhpcy5zdHlsZXNbZV0mJnRoaXMuc3R5bGVzW2VdW2ktMV0mJihzPXRoaXMuc3R5bGVzW2VdW2ktMV0pLHIpblswXT10KHMpLHRoaXMuc3R5bGVzW2UrMV09bjtlbHNle2Zvcih2YXIgbyBpbiB0aGlzLnN0eWxlc1tlXSlwYXJzZUludChvLDEwKT49aSYmKG5bcGFyc2VJbnQobywxMCktaV09dGhpcy5zdHlsZXNbZV1bb10sZGVsZXRlIHRoaXMuc3R5bGVzW2VdW29dKTt0aGlzLnN0eWxlc1tlKzFdPW59dGhpcy5fY2xlYXJDYWNoZSgpfSxpbnNlcnRDaGFyU3R5bGVPYmplY3Q6ZnVuY3Rpb24oZSxpLHIpe3ZhciBzPXRoaXMuc3R5bGVzW2VdLG49dChzKTswIT09aXx8cnx8KGk9MSk7Zm9yKHZhciBvIGluIG4pe3ZhciBhPXBhcnNlSW50KG8sMTApO2E+PWkmJihzW2ErMV09blthXSl9dGhpcy5zdHlsZXNbZV1baV09cnx8dChzW2ktMV0pLHRoaXMuX2NsZWFyQ2FjaGUoKX0saW5zZXJ0U3R5bGVPYmplY3RzOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24oKSxzPXIubGluZUluZGV4LG49ci5jaGFySW5kZXg7dGhpcy5zdHlsZXNbc118fCh0aGlzLnN0eWxlc1tzXT17fSksXCJcXG5cIj09PXQ/dGhpcy5pbnNlcnROZXdsaW5lU3R5bGVPYmplY3QocyxuLGUpOmk/dGhpcy5faW5zZXJ0U3R5bGVzKHRoaXMuY29waWVkU3R5bGVzKTp0aGlzLmluc2VydENoYXJTdHlsZU9iamVjdChzLG4pfSxfaW5zZXJ0U3R5bGVzOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9dC5sZW5ndGg7aT5lO2UrKyl7dmFyIHI9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKHRoaXMuc2VsZWN0aW9uU3RhcnQrZSkscz1yLmxpbmVJbmRleCxuPXIuY2hhckluZGV4O3RoaXMuaW5zZXJ0Q2hhclN0eWxlT2JqZWN0KHMsbix0W2VdKX19LHNoaWZ0TGluZVN0eWxlczpmdW5jdGlvbihlLGkpe3ZhciByPXQodGhpcy5zdHlsZXMpO2Zvcih2YXIgcyBpbiB0aGlzLnN0eWxlcyl7dmFyIG49cGFyc2VJbnQocywxMCk7bj5lJiYodGhpcy5zdHlsZXNbbitpXT1yW25dLHJbbi1pXXx8ZGVsZXRlIHRoaXMuc3R5bGVzW25dKX19LHJlbW92ZVN0eWxlT2JqZWN0OmZ1bmN0aW9uKGUsaSl7dmFyIHI9dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKGkpLHM9ci5saW5lSW5kZXgsbj1yLmNoYXJJbmRleDtpZihlKXt2YXIgbz10aGlzLl90ZXh0TGluZXNbcy0xXSxhPW8/by5sZW5ndGg6MDt0aGlzLnN0eWxlc1tzLTFdfHwodGhpcy5zdHlsZXNbcy0xXT17fSk7Zm9yKG4gaW4gdGhpcy5zdHlsZXNbc10pdGhpcy5zdHlsZXNbcy0xXVtwYXJzZUludChuLDEwKSthXT10aGlzLnN0eWxlc1tzXVtuXTt0aGlzLnNoaWZ0TGluZVN0eWxlcyhzLC0xKX1lbHNle3ZhciBoPXRoaXMuc3R5bGVzW3NdO2gmJmRlbGV0ZSBoW25dO3ZhciBjPXQoaCk7Zm9yKHZhciBsIGluIGMpe3ZhciB1PXBhcnNlSW50KGwsMTApO3U+PW4mJjAhPT11JiYoaFt1LTFdPWNbdV0sZGVsZXRlIGhbdV0pfX19LGluc2VydE5ld2xpbmU6ZnVuY3Rpb24oKXt0aGlzLmluc2VydENoYXJzKFwiXFxuXCIpfX0pfSgpLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLklUZXh0LnByb3RvdHlwZSx7aW5pdERvdWJsZUNsaWNrU2ltdWxhdGlvbjpmdW5jdGlvbigpe3RoaXMuX19sYXN0Q2xpY2tUaW1lPStuZXcgRGF0ZSx0aGlzLl9fbGFzdExhc3RDbGlja1RpbWU9K25ldyBEYXRlLHRoaXMuX19sYXN0UG9pbnRlcj17fSx0aGlzLm9uKFwibW91c2Vkb3duXCIsdGhpcy5vbk1vdXNlRG93bi5iaW5kKHRoaXMpKX0sb25Nb3VzZURvd246ZnVuY3Rpb24odCl7dGhpcy5fX25ld0NsaWNrVGltZT0rbmV3IERhdGU7dmFyIGU9dGhpcy5jYW52YXMuZ2V0UG9pbnRlcih0LmUpO3RoaXMuaXNUcmlwbGVDbGljayhlKT8odGhpcy5maXJlKFwidHJpcGxlY2xpY2tcIix0KSx0aGlzLl9zdG9wRXZlbnQodC5lKSk6dGhpcy5pc0RvdWJsZUNsaWNrKGUpJiYodGhpcy5maXJlKFwiZGJsY2xpY2tcIix0KSx0aGlzLl9zdG9wRXZlbnQodC5lKSksdGhpcy5fX2xhc3RMYXN0Q2xpY2tUaW1lPXRoaXMuX19sYXN0Q2xpY2tUaW1lLHRoaXMuX19sYXN0Q2xpY2tUaW1lPXRoaXMuX19uZXdDbGlja1RpbWUsdGhpcy5fX2xhc3RQb2ludGVyPWUsdGhpcy5fX2xhc3RJc0VkaXRpbmc9dGhpcy5pc0VkaXRpbmcsdGhpcy5fX2xhc3RTZWxlY3RlZD10aGlzLnNlbGVjdGVkfSxpc0RvdWJsZUNsaWNrOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9fbmV3Q2xpY2tUaW1lLXRoaXMuX19sYXN0Q2xpY2tUaW1lPDUwMCYmdGhpcy5fX2xhc3RQb2ludGVyLng9PT10LngmJnRoaXMuX19sYXN0UG9pbnRlci55PT09dC55JiZ0aGlzLl9fbGFzdElzRWRpdGluZ30saXNUcmlwbGVDbGljazpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fX25ld0NsaWNrVGltZS10aGlzLl9fbGFzdENsaWNrVGltZTw1MDAmJnRoaXMuX19sYXN0Q2xpY2tUaW1lLXRoaXMuX19sYXN0TGFzdENsaWNrVGltZTw1MDAmJnRoaXMuX19sYXN0UG9pbnRlci54PT09dC54JiZ0aGlzLl9fbGFzdFBvaW50ZXIueT09PXQueX0sX3N0b3BFdmVudDpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0JiZ0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24mJnQuc3RvcFByb3BhZ2F0aW9uKCl9LGluaXRDdXJzb3JTZWxlY3Rpb25IYW5kbGVyczpmdW5jdGlvbigpe3RoaXMuaW5pdFNlbGVjdGVkSGFuZGxlcigpLHRoaXMuaW5pdE1vdXNlZG93bkhhbmRsZXIoKSx0aGlzLmluaXRNb3VzZXVwSGFuZGxlcigpLHRoaXMuaW5pdENsaWNrcygpfSxpbml0Q2xpY2tzOmZ1bmN0aW9uKCl7dGhpcy5vbihcImRibGNsaWNrXCIsZnVuY3Rpb24odCl7dGhpcy5zZWxlY3RXb3JkKHRoaXMuZ2V0U2VsZWN0aW9uU3RhcnRGcm9tUG9pbnRlcih0LmUpKX0pLHRoaXMub24oXCJ0cmlwbGVjbGlja1wiLGZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0TGluZSh0aGlzLmdldFNlbGVjdGlvblN0YXJ0RnJvbVBvaW50ZXIodC5lKSl9KX0saW5pdE1vdXNlZG93bkhhbmRsZXI6ZnVuY3Rpb24oKXt0aGlzLm9uKFwibW91c2Vkb3duXCIsZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5jYW52YXMuZ2V0UG9pbnRlcih0LmUpO3RoaXMuX19tb3VzZWRvd25YPWUueCx0aGlzLl9fbW91c2Vkb3duWT1lLnksdGhpcy5fX2lzTW91c2Vkb3duPSEwLHRoaXMuaGlkZGVuVGV4dGFyZWEmJnRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy53cmFwcGVyRWwuYXBwZW5kQ2hpbGQodGhpcy5oaWRkZW5UZXh0YXJlYSksdGhpcy5zZWxlY3RlZCYmdGhpcy5zZXRDdXJzb3JCeUNsaWNrKHQuZSksdGhpcy5pc0VkaXRpbmcmJih0aGlzLl9fc2VsZWN0aW9uU3RhcnRPbk1vdXNlRG93bj10aGlzLnNlbGVjdGlvblN0YXJ0LHRoaXMuaW5pdERlbGF5ZWRDdXJzb3IoITApKX0pfSxfaXNPYmplY3RNb3ZlZDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNhbnZhcy5nZXRQb2ludGVyKHQpO3JldHVybiB0aGlzLl9fbW91c2Vkb3duWCE9PWUueHx8dGhpcy5fX21vdXNlZG93blkhPT1lLnl9LGluaXRNb3VzZXVwSGFuZGxlcjpmdW5jdGlvbigpe3RoaXMub24oXCJtb3VzZXVwXCIsZnVuY3Rpb24odCl7dGhpcy5fX2lzTW91c2Vkb3duPSExLHRoaXMuX2lzT2JqZWN0TW92ZWQodC5lKXx8KHRoaXMuX19sYXN0U2VsZWN0ZWQmJih0aGlzLmVudGVyRWRpdGluZygpLHRoaXMuaW5pdERlbGF5ZWRDdXJzb3IoITApKSx0aGlzLnNlbGVjdGVkPSEwKX0pfSxzZXRDdXJzb3JCeUNsaWNrOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0U2VsZWN0aW9uU3RhcnRGcm9tUG9pbnRlcih0KTt0LnNoaWZ0S2V5P2U8dGhpcy5zZWxlY3Rpb25TdGFydD8odGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25TdGFydCksdGhpcy5zZXRTZWxlY3Rpb25TdGFydChlKSk6dGhpcy5zZXRTZWxlY3Rpb25FbmQoZSk6KHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQoZSksdGhpcy5zZXRTZWxlY3Rpb25FbmQoZSkpfSxfZ2V0TG9jYWxSb3RhdGVkUG9pbnRlcjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNhbnZhcy5nZXRQb2ludGVyKHQpLGk9bmV3IGZhYnJpYy5Qb2ludChlLngsZS55KSxyPW5ldyBmYWJyaWMuUG9pbnQodGhpcy5sZWZ0LHRoaXMudG9wKSxzPWZhYnJpYy51dGlsLnJvdGF0ZVBvaW50KGkscixmYWJyaWMudXRpbC5kZWdyZWVzVG9SYWRpYW5zKC10aGlzLmFuZ2xlKSk7cmV0dXJuIHRoaXMuZ2V0TG9jYWxQb2ludGVyKHQscyl9LGdldFNlbGVjdGlvblN0YXJ0RnJvbVBvaW50ZXI6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGkscj10aGlzLl9nZXRMb2NhbFJvdGF0ZWRQb2ludGVyKHQpLHM9MCxuPTAsbz0wLGE9MCxoPTAsYz10aGlzLl90ZXh0TGluZXMubGVuZ3RoO2M+aDtoKyspe2k9dGhpcy5fdGV4dExpbmVzW2hdLG8rPXRoaXMuX2dldEhlaWdodE9mTGluZSh0aGlzLmN0eCxoKSp0aGlzLnNjYWxlWTt2YXIgbD10aGlzLl9nZXRMaW5lV2lkdGgodGhpcy5jdHgsaCksdT10aGlzLl9nZXRMaW5lTGVmdE9mZnNldChsKTtuPXUqdGhpcy5zY2FsZVgsdGhpcy5mbGlwWCYmKHRoaXMuX3RleHRMaW5lc1toXT1pLnJldmVyc2UoKS5qb2luKFwiXCIpKTtmb3IodmFyIGY9MCxkPWkubGVuZ3RoO2Q+ZjtmKyspe2lmKHM9bixuKz10aGlzLl9nZXRXaWR0aE9mQ2hhcih0aGlzLmN0eCxpW2ZdLGgsdGhpcy5mbGlwWD9kLWY6ZikqdGhpcy5zY2FsZVgsIShvPD1yLnl8fG48PXIueCkpcmV0dXJuIHRoaXMuX2dldE5ld1NlbGVjdGlvblN0YXJ0RnJvbU9mZnNldChyLHMsbixhK2gsZCk7YSsrfWlmKHIueTxvKXJldHVybiB0aGlzLl9nZXROZXdTZWxlY3Rpb25TdGFydEZyb21PZmZzZXQocixzLG4sYStoLGQpfXJldHVyblwidW5kZWZpbmVkXCI9PXR5cGVvZiBlP3RoaXMudGV4dC5sZW5ndGg6dm9pZCAwfSxfZ2V0TmV3U2VsZWN0aW9uU3RhcnRGcm9tT2Zmc2V0OmZ1bmN0aW9uKHQsZSxpLHIscyl7dmFyIG49dC54LWUsbz1pLXQueCxhPW8+bj8wOjEsaD1yK2E7cmV0dXJuIHRoaXMuZmxpcFgmJihoPXMtaCksaD50aGlzLnRleHQubGVuZ3RoJiYoaD10aGlzLnRleHQubGVuZ3RoKSxofX0pLGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLklUZXh0LnByb3RvdHlwZSx7aW5pdEhpZGRlblRleHRhcmVhOmZ1bmN0aW9uKCl7dGhpcy5oaWRkZW5UZXh0YXJlYT1mYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpLHRoaXMuaGlkZGVuVGV4dGFyZWEuc2V0QXR0cmlidXRlKFwiYXV0b2NhcGl0YWxpemVcIixcIm9mZlwiKSx0aGlzLmhpZGRlblRleHRhcmVhLnN0eWxlLmNzc1RleHQ9XCJwb3NpdGlvbjogZml4ZWQ7IGJvdHRvbTogMjBweDsgbGVmdDogMHB4OyBvcGFjaXR5OiAwOyB3aWR0aDogMHB4OyBoZWlnaHQ6IDBweDsgei1pbmRleDogLTk5OTtcIixmYWJyaWMuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmhpZGRlblRleHRhcmVhKSxmYWJyaWMudXRpbC5hZGRMaXN0ZW5lcih0aGlzLmhpZGRlblRleHRhcmVhLFwia2V5ZG93blwiLHRoaXMub25LZXlEb3duLmJpbmQodGhpcykpLGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHRoaXMuaGlkZGVuVGV4dGFyZWEsXCJrZXlwcmVzc1wiLHRoaXMub25LZXlQcmVzcy5iaW5kKHRoaXMpKSxmYWJyaWMudXRpbC5hZGRMaXN0ZW5lcih0aGlzLmhpZGRlblRleHRhcmVhLFwiY29weVwiLHRoaXMuY29weS5iaW5kKHRoaXMpKSxmYWJyaWMudXRpbC5hZGRMaXN0ZW5lcih0aGlzLmhpZGRlblRleHRhcmVhLFwicGFzdGVcIix0aGlzLnBhc3RlLmJpbmQodGhpcykpLCF0aGlzLl9jbGlja0hhbmRsZXJJbml0aWFsaXplZCYmdGhpcy5jYW52YXMmJihmYWJyaWMudXRpbC5hZGRMaXN0ZW5lcih0aGlzLmNhbnZhcy51cHBlckNhbnZhc0VsLFwiY2xpY2tcIix0aGlzLm9uQ2xpY2suYmluZCh0aGlzKSksdGhpcy5fY2xpY2tIYW5kbGVySW5pdGlhbGl6ZWQ9ITApfSxfa2V5c01hcDp7ODpcInJlbW92ZUNoYXJzXCIsOTpcImV4aXRFZGl0aW5nXCIsMjc6XCJleGl0RWRpdGluZ1wiLDEzOlwiaW5zZXJ0TmV3bGluZVwiLDMzOlwibW92ZUN1cnNvclVwXCIsMzQ6XCJtb3ZlQ3Vyc29yRG93blwiLDM1OlwibW92ZUN1cnNvclJpZ2h0XCIsMzY6XCJtb3ZlQ3Vyc29yTGVmdFwiLDM3OlwibW92ZUN1cnNvckxlZnRcIiwzODpcIm1vdmVDdXJzb3JVcFwiLDM5OlwibW92ZUN1cnNvclJpZ2h0XCIsNDA6XCJtb3ZlQ3Vyc29yRG93blwiLDQ2OlwiZm9yd2FyZERlbGV0ZVwifSxfY3RybEtleXNNYXA6ezY1Olwic2VsZWN0QWxsXCIsODg6XCJjdXRcIn0sb25DbGljazpmdW5jdGlvbigpe3RoaXMuaGlkZGVuVGV4dGFyZWEmJnRoaXMuaGlkZGVuVGV4dGFyZWEuZm9jdXMoKX0sb25LZXlEb3duOmZ1bmN0aW9uKHQpe2lmKHRoaXMuaXNFZGl0aW5nKXtpZih0LmtleUNvZGUgaW4gdGhpcy5fa2V5c01hcCl0aGlzW3RoaXMuX2tleXNNYXBbdC5rZXlDb2RlXV0odCk7ZWxzZXtpZighKHQua2V5Q29kZSBpbiB0aGlzLl9jdHJsS2V5c01hcCYmKHQuY3RybEtleXx8dC5tZXRhS2V5KSkpcmV0dXJuO3RoaXNbdGhpcy5fY3RybEtleXNNYXBbdC5rZXlDb2RlXV0odCl9dC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0LnByZXZlbnREZWZhdWx0KCksdGhpcy5jYW52YXMmJnRoaXMuY2FudmFzLnJlbmRlckFsbCgpfX0sZm9yd2FyZERlbGV0ZTpmdW5jdGlvbih0KXt0aGlzLnNlbGVjdGlvblN0YXJ0PT09dGhpcy5zZWxlY3Rpb25FbmQmJnRoaXMubW92ZUN1cnNvclJpZ2h0KHQpLHRoaXMucmVtb3ZlQ2hhcnModCl9LGNvcHk6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRTZWxlY3RlZFRleHQoKSxpPXRoaXMuX2dldENsaXBib2FyZERhdGEodCk7aSYmaS5zZXREYXRhKFwidGV4dFwiLGUpLHRoaXMuY29waWVkVGV4dD1lLHRoaXMuY29waWVkU3R5bGVzPXRoaXMuZ2V0U2VsZWN0aW9uU3R5bGVzKHRoaXMuc2VsZWN0aW9uU3RhcnQsdGhpcy5zZWxlY3Rpb25FbmQpfSxwYXN0ZTpmdW5jdGlvbih0KXt2YXIgZT1udWxsLGk9dGhpcy5fZ2V0Q2xpcGJvYXJkRGF0YSh0KTtlPWk/aS5nZXREYXRhKFwidGV4dFwiKTp0aGlzLmNvcGllZFRleHQsZSYmdGhpcy5pbnNlcnRDaGFycyhlLCEwKX0sY3V0OmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQhPT10aGlzLnNlbGVjdGlvbkVuZCYmKHRoaXMuY29weSgpLHRoaXMucmVtb3ZlQ2hhcnModCkpfSxfZ2V0Q2xpcGJvYXJkRGF0YTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmKHQuY2xpcGJvYXJkRGF0YXx8ZmFicmljLndpbmRvdy5jbGlwYm9hcmREYXRhKX0sb25LZXlQcmVzczpmdW5jdGlvbih0KXshdGhpcy5pc0VkaXRpbmd8fHQubWV0YUtleXx8dC5jdHJsS2V5fHwoMCE9PXQud2hpY2gmJnRoaXMuaW5zZXJ0Q2hhcnMoU3RyaW5nLmZyb21DaGFyQ29kZSh0LndoaWNoKSksdC5zdG9wUHJvcGFnYXRpb24oKSl9LGdldERvd25DdXJzb3JPZmZzZXQ6ZnVuY3Rpb24odCxlKXt2YXIgaSxyLHM9ZT90aGlzLnNlbGVjdGlvbkVuZDp0aGlzLnNlbGVjdGlvblN0YXJ0LG49dGhpcy5nZXQyREN1cnNvckxvY2F0aW9uKHMpLG89bi5saW5lSW5kZXgsYT10aGlzLl90ZXh0TGluZXNbb10uc2xpY2UoMCxuLmNoYXJJbmRleCksaD10aGlzLl90ZXh0TGluZXNbb10uc2xpY2Uobi5jaGFySW5kZXgpLGM9dGhpcy5fdGV4dExpbmVzW28rMV18fFwiXCI7aWYobz09PXRoaXMuX3RleHRMaW5lcy5sZW5ndGgtMXx8dC5tZXRhS2V5fHwzND09PXQua2V5Q29kZSlyZXR1cm4gdGhpcy50ZXh0Lmxlbmd0aC1zO3ZhciBsPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxvKTtyPXRoaXMuX2dldExpbmVMZWZ0T2Zmc2V0KGwpO2Zvcih2YXIgdT1yLGY9MCxkPWEubGVuZ3RoO2Q+ZjtmKyspaT1hW2ZdLHUrPXRoaXMuX2dldFdpZHRoT2ZDaGFyKHRoaXMuY3R4LGksbyxmKTt2YXIgZz10aGlzLl9nZXRJbmRleE9uTmV4dExpbmUobixjLHUpO3JldHVybiBoLmxlbmd0aCsxK2d9LF9nZXRJbmRleE9uTmV4dExpbmU6ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgcixzPXQubGluZUluZGV4KzEsbj10aGlzLl9nZXRMaW5lV2lkdGgodGhpcy5jdHgscyksbz10aGlzLl9nZXRMaW5lTGVmdE9mZnNldChuKSxhPW8saD0wLGM9MCxsPWUubGVuZ3RoO2w+YztjKyspe3ZhciB1PWVbY10sZj10aGlzLl9nZXRXaWR0aE9mQ2hhcih0aGlzLmN0eCx1LHMsYyk7aWYoYSs9ZixhPmkpe3I9ITA7dmFyIGQ9YS1mLGc9YSxwPU1hdGguYWJzKGQtaSksdj1NYXRoLmFicyhnLWkpO2g9cD52P2MrMTpjO2JyZWFrfX1yZXR1cm4gcnx8KGg9ZS5sZW5ndGgpLGh9LG1vdmVDdXJzb3JEb3duOmZ1bmN0aW9uKHQpe3RoaXMuYWJvcnRDdXJzb3JBbmltYXRpb24oKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0xO3ZhciBlPXRoaXMuZ2V0RG93bkN1cnNvck9mZnNldCh0LFwicmlnaHRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbik7dC5zaGlmdEtleT90aGlzLm1vdmVDdXJzb3JEb3duV2l0aFNoaWZ0KGUpOnRoaXMubW92ZUN1cnNvckRvd25XaXRob3V0U2hpZnQoZSksdGhpcy5pbml0RGVsYXllZEN1cnNvcigpfSxtb3ZlQ3Vyc29yRG93bldpdGhvdXRTaGlmdDpmdW5jdGlvbih0KXt0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJyaWdodFwiLHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25TdGFydCt0KSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KX0sc3dhcFNlbGVjdGlvblBvaW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuc2VsZWN0aW9uRW5kO3RoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uU3RhcnQpLHRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodCl9LG1vdmVDdXJzb3JEb3duV2l0aFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uRW5kPT09dGhpcy5zZWxlY3Rpb25TdGFydCYmKHRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cInJpZ2h0XCIpLFwicmlnaHRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj90aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvbkVuZCt0KTp0aGlzLnNldFNlbGVjdGlvblN0YXJ0KHRoaXMuc2VsZWN0aW9uU3RhcnQrdCksdGhpcy5zZWxlY3Rpb25FbmQ8dGhpcy5zZWxlY3Rpb25TdGFydCYmXCJsZWZ0XCI9PT10aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb24mJih0aGlzLnN3YXBTZWxlY3Rpb25Qb2ludHMoKSx0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJyaWdodFwiKSx0aGlzLnNlbGVjdGlvbkVuZD50aGlzLnRleHQubGVuZ3RoJiZ0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnRleHQubGVuZ3RoKX0sZ2V0VXBDdXJzb3JPZmZzZXQ6ZnVuY3Rpb24odCxlKXt2YXIgaT1lP3RoaXMuc2VsZWN0aW9uRW5kOnRoaXMuc2VsZWN0aW9uU3RhcnQscj10aGlzLmdldDJEQ3Vyc29yTG9jYXRpb24oaSkscz1yLmxpbmVJbmRleDtpZigwPT09c3x8dC5tZXRhS2V5fHwzMz09PXQua2V5Q29kZSlyZXR1cm4gaTtmb3IodmFyIG4sbz10aGlzLl90ZXh0TGluZXNbc10uc2xpY2UoMCxyLmNoYXJJbmRleCksYT10aGlzLl90ZXh0TGluZXNbcy0xXXx8XCJcIixoPXRoaXMuX2dldExpbmVXaWR0aCh0aGlzLmN0eCxyLmxpbmVJbmRleCksYz10aGlzLl9nZXRMaW5lTGVmdE9mZnNldChoKSxsPWMsdT0wLGY9by5sZW5ndGg7Zj51O3UrKyluPW9bdV0sbCs9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodGhpcy5jdHgsbixzLHUpO3ZhciBkPXRoaXMuX2dldEluZGV4T25QcmV2TGluZShyLGEsbCk7cmV0dXJuIGEubGVuZ3RoLWQrby5sZW5ndGh9LF9nZXRJbmRleE9uUHJldkxpbmU6ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgcixzPXQubGluZUluZGV4LTEsbj10aGlzLl9nZXRMaW5lV2lkdGgodGhpcy5jdHgscyksbz10aGlzLl9nZXRMaW5lTGVmdE9mZnNldChuKSxhPW8saD0wLGM9MCxsPWUubGVuZ3RoO2w+YztjKyspe3ZhciB1PWVbY10sZj10aGlzLl9nZXRXaWR0aE9mQ2hhcih0aGlzLmN0eCx1LHMsYyk7aWYoYSs9ZixhPmkpe3I9ITA7dmFyIGQ9YS1mLGc9YSxwPU1hdGguYWJzKGQtaSksdj1NYXRoLmFicyhnLWkpO2g9cD52P2M6Yy0xO2JyZWFrfX1yZXR1cm4gcnx8KGg9ZS5sZW5ndGgtMSksaH0sbW92ZUN1cnNvclVwOmZ1bmN0aW9uKHQpe3RoaXMuYWJvcnRDdXJzb3JBbmltYXRpb24oKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0xO3ZhciBlPXRoaXMuZ2V0VXBDdXJzb3JPZmZzZXQodCxcInJpZ2h0XCI9PT10aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb24pO3Quc2hpZnRLZXk/dGhpcy5tb3ZlQ3Vyc29yVXBXaXRoU2hpZnQoZSk6dGhpcy5tb3ZlQ3Vyc29yVXBXaXRob3V0U2hpZnQoZSksdGhpcy5pbml0RGVsYXllZEN1cnNvcigpfSxtb3ZlQ3Vyc29yVXBXaXRoU2hpZnQ6ZnVuY3Rpb24odCl7dGhpcy5zZWxlY3Rpb25FbmQ9PT10aGlzLnNlbGVjdGlvblN0YXJ0JiYodGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwibGVmdFwiKSxcInJpZ2h0XCI9PT10aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb24/dGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25FbmQtdCk6dGhpcy5zZXRTZWxlY3Rpb25TdGFydCh0aGlzLnNlbGVjdGlvblN0YXJ0LXQpLHRoaXMuc2VsZWN0aW9uRW5kPHRoaXMuc2VsZWN0aW9uU3RhcnQmJlwicmlnaHRcIj09PXRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbiYmKHRoaXMuc3dhcFNlbGVjdGlvblBvaW50cygpLHRoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cImxlZnRcIil9LG1vdmVDdXJzb3JVcFdpdGhvdXRTaGlmdDpmdW5jdGlvbih0KXt0aGlzLnNlbGVjdGlvblN0YXJ0PT09dGhpcy5zZWxlY3Rpb25FbmQmJnRoaXMuc2V0U2VsZWN0aW9uU3RhcnQodGhpcy5zZWxlY3Rpb25TdGFydC10KSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJsZWZ0XCJ9LG1vdmVDdXJzb3JMZWZ0OmZ1bmN0aW9uKHQpeygwIT09dGhpcy5zZWxlY3Rpb25TdGFydHx8MCE9PXRoaXMuc2VsZWN0aW9uRW5kKSYmKHRoaXMuYWJvcnRDdXJzb3JBbmltYXRpb24oKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0xLHQuc2hpZnRLZXk/dGhpcy5tb3ZlQ3Vyc29yTGVmdFdpdGhTaGlmdCh0KTp0aGlzLm1vdmVDdXJzb3JMZWZ0V2l0aG91dFNoaWZ0KHQpLHRoaXMuaW5pdERlbGF5ZWRDdXJzb3IoKSl9LF9tb3ZlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcj1cInNlbGVjdGlvblN0YXJ0XCI9PT1lP1wic2V0U2VsZWN0aW9uU3RhcnRcIjpcInNldFNlbGVjdGlvbkVuZFwiO3RoaXNbcl0odC5hbHRLZXk/dGhpc1tcImZpbmRXb3JkQm91bmRhcnlcIitpXSh0aGlzW2VdKTp0Lm1ldGFLZXl8fDM1PT09dC5rZXlDb2RlfHwzNj09PXQua2V5Q29kZT90aGlzW1wiZmluZExpbmVCb3VuZGFyeVwiK2ldKHRoaXNbZV0pOnRoaXNbZV0rKFwiTGVmdFwiPT09aT8tMToxKSl9LF9tb3ZlTGVmdDpmdW5jdGlvbih0LGUpe3RoaXMuX21vdmUodCxlLFwiTGVmdFwiKX0sX21vdmVSaWdodDpmdW5jdGlvbih0LGUpe3RoaXMuX21vdmUodCxlLFwiUmlnaHRcIil9LG1vdmVDdXJzb3JMZWZ0V2l0aG91dFNoaWZ0OmZ1bmN0aW9uKHQpe3RoaXMuX3NlbGVjdGlvbkRpcmVjdGlvbj1cImxlZnRcIix0aGlzLnNlbGVjdGlvbkVuZD09PXRoaXMuc2VsZWN0aW9uU3RhcnQmJnRoaXMuX21vdmVMZWZ0KHQsXCJzZWxlY3Rpb25TdGFydFwiKSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KX0sbW92ZUN1cnNvckxlZnRXaXRoU2hpZnQ6ZnVuY3Rpb24odCl7XCJyaWdodFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uJiZ0aGlzLnNlbGVjdGlvblN0YXJ0IT09dGhpcy5zZWxlY3Rpb25FbmQ/dGhpcy5fbW92ZUxlZnQodCxcInNlbGVjdGlvbkVuZFwiKToodGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwibGVmdFwiLHRoaXMuX21vdmVMZWZ0KHQsXCJzZWxlY3Rpb25TdGFydFwiKSl9LG1vdmVDdXJzb3JSaWdodDpmdW5jdGlvbih0KXt0aGlzLnNlbGVjdGlvblN0YXJ0Pj10aGlzLnRleHQubGVuZ3RoJiZ0aGlzLnNlbGVjdGlvbkVuZD49dGhpcy50ZXh0Lmxlbmd0aHx8KHRoaXMuYWJvcnRDdXJzb3JBbmltYXRpb24oKSx0aGlzLl9jdXJyZW50Q3Vyc29yT3BhY2l0eT0xLHQuc2hpZnRLZXk/dGhpcy5tb3ZlQ3Vyc29yUmlnaHRXaXRoU2hpZnQodCk6dGhpcy5tb3ZlQ3Vyc29yUmlnaHRXaXRob3V0U2hpZnQodCksdGhpcy5pbml0RGVsYXllZEN1cnNvcigpKX0sbW92ZUN1cnNvclJpZ2h0V2l0aFNoaWZ0OmZ1bmN0aW9uKHQpe1wibGVmdFwiPT09dGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uJiZ0aGlzLnNlbGVjdGlvblN0YXJ0IT09dGhpcy5zZWxlY3Rpb25FbmQ/dGhpcy5fbW92ZVJpZ2h0KHQsXCJzZWxlY3Rpb25TdGFydFwiKToodGhpcy5fc2VsZWN0aW9uRGlyZWN0aW9uPVwicmlnaHRcIix0aGlzLl9tb3ZlUmlnaHQodCxcInNlbGVjdGlvbkVuZFwiKSl9LG1vdmVDdXJzb3JSaWdodFdpdGhvdXRTaGlmdDpmdW5jdGlvbih0KXt0aGlzLl9zZWxlY3Rpb25EaXJlY3Rpb249XCJyaWdodFwiLHRoaXMuc2VsZWN0aW9uU3RhcnQ9PT10aGlzLnNlbGVjdGlvbkVuZD8odGhpcy5fbW92ZVJpZ2h0KHQsXCJzZWxlY3Rpb25TdGFydFwiKSx0aGlzLnNldFNlbGVjdGlvbkVuZCh0aGlzLnNlbGVjdGlvblN0YXJ0KSk6KHRoaXMuc2V0U2VsZWN0aW9uRW5kKHRoaXMuc2VsZWN0aW9uRW5kK3RoaXMuZ2V0TnVtTmV3TGluZXNJblNlbGVjdGVkVGV4dCgpKSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KHRoaXMuc2VsZWN0aW9uRW5kKSl9LHJlbW92ZUNoYXJzOmZ1bmN0aW9uKHQpe3RoaXMuc2VsZWN0aW9uU3RhcnQ9PT10aGlzLnNlbGVjdGlvbkVuZD90aGlzLl9yZW1vdmVDaGFyc05lYXJDdXJzb3IodCk6dGhpcy5fcmVtb3ZlQ2hhcnNGcm9tVG8odGhpcy5zZWxlY3Rpb25TdGFydCx0aGlzLnNlbGVjdGlvbkVuZCksdGhpcy5zZXRTZWxlY3Rpb25FbmQodGhpcy5zZWxlY3Rpb25TdGFydCksdGhpcy5fcmVtb3ZlRXh0cmFuZW91c1N0eWxlcygpLHRoaXMuX2NsZWFyQ2FjaGUoKSx0aGlzLmNhbnZhcyYmdGhpcy5jYW52YXMucmVuZGVyQWxsKCksdGhpcy5zZXRDb29yZHMoKSx0aGlzLmZpcmUoXCJjaGFuZ2VkXCIpLHRoaXMuY2FudmFzJiZ0aGlzLmNhbnZhcy5maXJlKFwidGV4dDpjaGFuZ2VkXCIse3RhcmdldDp0aGlzfSl9LF9yZW1vdmVDaGFyc05lYXJDdXJzb3I6ZnVuY3Rpb24odCl7aWYoMCE9PXRoaXMuc2VsZWN0aW9uU3RhcnQpaWYodC5tZXRhS2V5KXt2YXIgZT10aGlzLmZpbmRMaW5lQm91bmRhcnlMZWZ0KHRoaXMuc2VsZWN0aW9uU3RhcnQpO3RoaXMuX3JlbW92ZUNoYXJzRnJvbVRvKGUsdGhpcy5zZWxlY3Rpb25TdGFydCksdGhpcy5zZXRTZWxlY3Rpb25TdGFydChlKX1lbHNlIGlmKHQuYWx0S2V5KXt2YXIgaT10aGlzLmZpbmRXb3JkQm91bmRhcnlMZWZ0KHRoaXMuc2VsZWN0aW9uU3RhcnQpO3RoaXMuX3JlbW92ZUNoYXJzRnJvbVRvKGksdGhpcy5zZWxlY3Rpb25TdGFydCksdGhpcy5zZXRTZWxlY3Rpb25TdGFydChpKX1lbHNlIHRoaXMuX3JlbW92ZVNpbmdsZUNoYXJBbmRTdHlsZSh0aGlzLnNlbGVjdGlvblN0YXJ0KSx0aGlzLnNldFNlbGVjdGlvblN0YXJ0KHRoaXMuc2VsZWN0aW9uU3RhcnQtMSl9fSksZnVuY3Rpb24oKXt2YXIgdD1mYWJyaWMudXRpbC50b0ZpeGVkLGU9ZmFicmljLk9iamVjdC5OVU1fRlJBQ1RJT05fRElHSVRTO2ZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoZmFicmljLklUZXh0LnByb3RvdHlwZSx7X3NldFNWR1RleHRMaW5lVGV4dDpmdW5jdGlvbih0LGUsaSxyLHMsbil7dGhpcy5zdHlsZXNbdF0/dGhpcy5fc2V0U1ZHVGV4dExpbmVDaGFycyh0LGUsaSxyLG4pOnRoaXMuY2FsbFN1cGVyKFwiX3NldFNWR1RleHRMaW5lVGV4dFwiLHQsZSxpLHIscyl9LF9zZXRTVkdUZXh0TGluZUNoYXJzOmZ1bmN0aW9uKHQsZSxpLHIscyl7Zm9yKHZhciBuPXRoaXMuX3RleHRMaW5lc1t0XSxvPTAsYT10aGlzLl9nZXRTVkdMaW5lTGVmdE9mZnNldCh0KS10aGlzLndpZHRoLzIsaD10aGlzLl9nZXRTVkdMaW5lVG9wT2Zmc2V0KHQpLGM9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LHQpLGw9MCx1PW4ubGVuZ3RoO3U+bDtsKyspe3ZhciBmPXRoaXMuc3R5bGVzW3RdW2xdfHx7fTtlLnB1c2godGhpcy5fY3JlYXRlVGV4dENoYXJTcGFuKG5bbF0sZixhLGgubGluZVRvcCtoLm9mZnNldCxvKSk7dmFyIGQ9dGhpcy5fZ2V0V2lkdGhPZkNoYXIodGhpcy5jdHgsbltsXSx0LGwpO2YudGV4dEJhY2tncm91bmRDb2xvciYmcy5wdXNoKHRoaXMuX2NyZWF0ZVRleHRDaGFyQmcoZixhLGgubGluZVRvcCxjLGQsbykpLG8rPWR9fSxfZ2V0U1ZHTGluZUxlZnRPZmZzZXQ6ZnVuY3Rpb24odCl7cmV0dXJuIGZhYnJpYy51dGlsLnRvRml4ZWQodGhpcy5fZ2V0TGluZUxlZnRPZmZzZXQodGhpcy5fX2xpbmVXaWR0aHNbdF0pLDIpfSxfZ2V0U1ZHTGluZVRvcE9mZnNldDpmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxpPTAscj0wO3Q+cjtyKyspZSs9dGhpcy5fZ2V0SGVpZ2h0T2ZMaW5lKHRoaXMuY3R4LHIpO3JldHVybiBpPXRoaXMuX2dldEhlaWdodE9mTGluZSh0aGlzLmN0eCxyKSx7bGluZVRvcDplLG9mZnNldDoodGhpcy5fZm9udFNpemVNdWx0LXRoaXMuX2ZvbnRTaXplRnJhY3Rpb24pKmkvKHRoaXMubGluZUhlaWdodCp0aGlzLl9mb250U2l6ZU11bHQpfX0sX2NyZWF0ZVRleHRDaGFyQmc6ZnVuY3Rpb24oaSxyLHMsbixvLGEpe3JldHVyblsnPHJlY3QgZmlsbD1cIicsaS50ZXh0QmFja2dyb3VuZENvbG9yLCdcIiB4PVwiJyx0KHIrYSxlKSwnXCIgeT1cIicsdChzLXRoaXMuaGVpZ2h0LzIsZSksJ1wiIHdpZHRoPVwiJyx0KG8sZSksJ1wiIGhlaWdodD1cIicsdChuL3RoaXMubGluZUhlaWdodCxlKSwnXCI+PC9yZWN0PiddLmpvaW4oXCJcIil9LF9jcmVhdGVUZXh0Q2hhclNwYW46ZnVuY3Rpb24odCxlLGkscixzKXt2YXIgbj10aGlzLmdldFN2Z1N0eWxlcy5jYWxsKGZhYnJpYy51dGlsLm9iamVjdC5leHRlbmQoe3Zpc2libGU6ITAsZmlsbDp0aGlzLmZpbGwsc3Ryb2tlOnRoaXMuc3Ryb2tlLHR5cGU6XCJ0ZXh0XCJ9LGUpKTtyZXR1cm5bJzx0c3BhbiB4PVwiJyxpK3MsJ1wiIHk9XCInLHItdGhpcy5oZWlnaHQvMiwnXCIgJyxlLmZvbnRGYW1pbHk/J2ZvbnQtZmFtaWx5PVwiJytlLmZvbnRGYW1pbHkucmVwbGFjZSgvXCIvZyxcIidcIikrJ1wiICc6XCJcIixlLmZvbnRTaXplPydmb250LXNpemU9XCInK2UuZm9udFNpemUrJ1wiICc6XCJcIixlLmZvbnRTdHlsZT8nZm9udC1zdHlsZT1cIicrZS5mb250U3R5bGUrJ1wiICc6XCJcIixlLmZvbnRXZWlnaHQ/J2ZvbnQtd2VpZ2h0PVwiJytlLmZvbnRXZWlnaHQrJ1wiICc6XCJcIixlLnRleHREZWNvcmF0aW9uPyd0ZXh0LWRlY29yYXRpb249XCInK2UudGV4dERlY29yYXRpb24rJ1wiICc6XCJcIiwnc3R5bGU9XCInLG4sJ1wiPicsZmFicmljLnV0aWwuc3RyaW5nLmVzY2FwZVhtbCh0KSxcIjwvdHNwYW4+XCJdLmpvaW4oXCJcIik7XHJcblxyXG59fSl9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiByZXF1ZXN0KHQsZSxpKXt2YXIgcj1VUkwucGFyc2UodCk7ci5wb3J0fHwoci5wb3J0PTA9PT1yLnByb3RvY29sLmluZGV4T2YoXCJodHRwczpcIik/NDQzOjgwKTt2YXIgcz0wPT09ci5wcm90b2NvbC5pbmRleE9mKFwiaHR0cHM6XCIpP0hUVFBTOkhUVFAsbj1zLnJlcXVlc3Qoe2hvc3RuYW1lOnIuaG9zdG5hbWUscG9ydDpyLnBvcnQscGF0aDpyLnBhdGgsbWV0aG9kOlwiR0VUXCJ9LGZ1bmN0aW9uKHQpe3ZhciByPVwiXCI7ZSYmdC5zZXRFbmNvZGluZyhlKSx0Lm9uKFwiZW5kXCIsZnVuY3Rpb24oKXtpKHIpfSksdC5vbihcImRhdGFcIixmdW5jdGlvbihlKXsyMDA9PT10LnN0YXR1c0NvZGUmJihyKz1lKX0pfSk7bi5vbihcImVycm9yXCIsZnVuY3Rpb24odCl7ZmFicmljLmxvZyh0LmVycm5vPT09cHJvY2Vzcy5FQ09OTlJFRlVTRUQ/XCJFQ09OTlJFRlVTRUQ6IGNvbm5lY3Rpb24gcmVmdXNlZCB0byBcIityLmhvc3RuYW1lK1wiOlwiK3IucG9ydDp0Lm1lc3NhZ2UpLGkobnVsbCl9KSxuLmVuZCgpfWZ1bmN0aW9uIHJlcXVlc3RGcyh0LGUpe3ZhciBpPXJlcXVpcmUoXCJmc1wiKTtpLnJlYWRGaWxlKHQsZnVuY3Rpb24odCxpKXtpZih0KXRocm93IGZhYnJpYy5sb2codCksdDtlKGkpfSl9aWYoXCJ1bmRlZmluZWRcIj09dHlwZW9mIGRvY3VtZW50fHxcInVuZGVmaW5lZFwiPT10eXBlb2Ygd2luZG93KXt2YXIgRE9NUGFyc2VyPXJlcXVpcmUoXCJ4bWxkb21cIikuRE9NUGFyc2VyLFVSTD1yZXF1aXJlKFwidXJsXCIpLEhUVFA9cmVxdWlyZShcImh0dHBcIiksSFRUUFM9cmVxdWlyZShcImh0dHBzXCIpLENhbnZhcz1yZXF1aXJlKFwiY2FudmFzXCIpLEltYWdlPXJlcXVpcmUoXCJjYW52YXNcIikuSW1hZ2U7ZmFicmljLnV0aWwubG9hZEltYWdlPWZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiByKHIpe3I/KHMuc3JjPW5ldyBCdWZmZXIocixcImJpbmFyeVwiKSxzLl9zcmM9dCxlJiZlLmNhbGwoaSxzKSk6KHM9bnVsbCxlJiZlLmNhbGwoaSxudWxsLCEwKSl9dmFyIHM9bmV3IEltYWdlO3QmJih0IGluc3RhbmNlb2YgQnVmZmVyfHwwPT09dC5pbmRleE9mKFwiZGF0YVwiKSk/KHMuc3JjPXMuX3NyYz10LGUmJmUuY2FsbChpLHMpKTp0JiYwIT09dC5pbmRleE9mKFwiaHR0cFwiKT9yZXF1ZXN0RnModCxyKTp0P3JlcXVlc3QodCxcImJpbmFyeVwiLHIpOmUmJmUuY2FsbChpLHQpfSxmYWJyaWMubG9hZFNWR0Zyb21VUkw9ZnVuY3Rpb24odCxlLGkpe3Q9dC5yZXBsYWNlKC9eXFxuXFxzKi8sXCJcIikucmVwbGFjZSgvXFw/LiokLyxcIlwiKS50cmltKCksMCE9PXQuaW5kZXhPZihcImh0dHBcIik/cmVxdWVzdEZzKHQsZnVuY3Rpb24odCl7ZmFicmljLmxvYWRTVkdGcm9tU3RyaW5nKHQudG9TdHJpbmcoKSxlLGkpfSk6cmVxdWVzdCh0LFwiXCIsZnVuY3Rpb24odCl7ZmFicmljLmxvYWRTVkdGcm9tU3RyaW5nKHQsZSxpKX0pfSxmYWJyaWMubG9hZFNWR0Zyb21TdHJpbmc9ZnVuY3Rpb24odCxlLGkpe3ZhciByPShuZXcgRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcodCk7ZmFicmljLnBhcnNlU1ZHRG9jdW1lbnQoci5kb2N1bWVudEVsZW1lbnQsZnVuY3Rpb24odCxpKXtlJiZlKHQsaSl9LGkpfSxmYWJyaWMudXRpbC5nZXRTY3JpcHQ9ZnVuY3Rpb24odXJsLGNhbGxiYWNrKXtyZXF1ZXN0KHVybCxcIlwiLGZ1bmN0aW9uKGJvZHkpe2V2YWwoYm9keSksY2FsbGJhY2smJmNhbGxiYWNrKCl9KX0sZmFicmljLkltYWdlLmZyb21PYmplY3Q9ZnVuY3Rpb24odCxlKXtmYWJyaWMudXRpbC5sb2FkSW1hZ2UodC5zcmMsZnVuY3Rpb24oaSl7dmFyIHI9bmV3IGZhYnJpYy5JbWFnZShpKTtyLl9pbml0Q29uZmlnKHQpLHIuX2luaXRGaWx0ZXJzKHQuZmlsdGVycyxmdW5jdGlvbihpKXtyLmZpbHRlcnM9aXx8W10sci5faW5pdEZpbHRlcnModC5yZXNpemVGaWx0ZXJzLGZ1bmN0aW9uKHQpe3IucmVzaXplRmlsdGVycz10fHxbXSxlJiZlKHIpfSl9KX0pfSxmYWJyaWMuY3JlYXRlQ2FudmFzRm9yTm9kZT1mdW5jdGlvbih0LGUsaSxyKXtyPXJ8fGk7dmFyIHM9ZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksbj1uZXcgQ2FudmFzKHR8fDYwMCxlfHw2MDAscik7cy5zdHlsZT17fSxzLndpZHRoPW4ud2lkdGgscy5oZWlnaHQ9bi5oZWlnaHQ7dmFyIG89ZmFicmljLkNhbnZhc3x8ZmFicmljLlN0YXRpY0NhbnZhcyxhPW5ldyBvKHMsaSk7cmV0dXJuIGEuY29udGV4dENvbnRhaW5lcj1uLmdldENvbnRleHQoXCIyZFwiKSxhLm5vZGVDYW52YXM9bixhLkZvbnQ9Q2FudmFzLkZvbnQsYX0sZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuY3JlYXRlUE5HU3RyZWFtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZUNhbnZhcy5jcmVhdGVQTkdTdHJlYW0oKX0sZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuY3JlYXRlSlBFR1N0cmVhbT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5ub2RlQ2FudmFzLmNyZWF0ZUpQRUdTdHJlYW0odCl9O3ZhciBvcmlnU2V0V2lkdGg9ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2V0V2lkdGg7ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2V0V2lkdGg9ZnVuY3Rpb24odCxlKXtyZXR1cm4gb3JpZ1NldFdpZHRoLmNhbGwodGhpcyx0LGUpLHRoaXMubm9kZUNhbnZhcy53aWR0aD10LHRoaXN9LGZhYnJpYy5DYW52YXMmJihmYWJyaWMuQ2FudmFzLnByb3RvdHlwZS5zZXRXaWR0aD1mYWJyaWMuU3RhdGljQ2FudmFzLnByb3RvdHlwZS5zZXRXaWR0aCk7dmFyIG9yaWdTZXRIZWlnaHQ9ZmFicmljLlN0YXRpY0NhbnZhcy5wcm90b3R5cGUuc2V0SGVpZ2h0O2ZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLnNldEhlaWdodD1mdW5jdGlvbih0LGUpe3JldHVybiBvcmlnU2V0SGVpZ2h0LmNhbGwodGhpcyx0LGUpLHRoaXMubm9kZUNhbnZhcy5oZWlnaHQ9dCx0aGlzfSxmYWJyaWMuQ2FudmFzJiYoZmFicmljLkNhbnZhcy5wcm90b3R5cGUuc2V0SGVpZ2h0PWZhYnJpYy5TdGF0aWNDYW52YXMucHJvdG90eXBlLnNldEhlaWdodCl9fSgpOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicsIFsnbmdNYXRlcmlhbCcsICduZ0FuaW1hdGUnLCAndWkuc29ydGFibGUnLCAnaW1hZ2UuY3JvcCcsICdpbWFnZS50ZXh0JywgJ2ltYWdlLmRyYXdpbmcnLCAnaW1hZ2UuZmlsdGVycycsICdpbWFnZS5zaGFwZXMnLCAnaW1hZ2UuZGlyZWN0aXZlcycsICdpbWFnZS5iYXNpY3MnXSlcclxuXHJcbi5jb25maWcoWyckbWRUaGVtaW5nUHJvdmlkZXInLCBmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIpIHtcclxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXHJcbiAgICAgICAgLnByaW1hcnlQYWxldHRlKCdkZWVwLW9yYW5nZScpXHJcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2Jyb3duJyk7IFxyXG59XSlcclxuXHJcbi5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIFsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJHRpbWVvdXQnLCAnJCRyQUYnLCAnJG1kQm90dG9tU2hlZXQnLCAnY2FudmFzJywgJ2hpc3RvcnknLCAnc2ltcGxlU2hhcGVzJywgJ2ZpbHRlcnMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR0aW1lb3V0LCAkJHJBRiwgJG1kQm90dG9tU2hlZXQsIGNhbnZhcywgaGlzdG9yeSwgc2ltcGxlU2hhcGVzLCBmaWx0ZXJzKSB7XHJcblxyXG4gICAgLy90cnVlIGFmdGVyIHVzZXIgdXBsb2FkcyBhbiBpbWFnZSBvciBjcmVhdGUgYSBuZXcgY2FudmFzXHJcbiAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAvL2NoZWNrIGlmIHdlJ3JlIG9uIGEgZGVtbyBzaXRlXHJcbiAgICAkcm9vdFNjb3BlLmlzRGVtbyA9IGRvY3VtZW50LlVSTC5pbmRleE9mKCdwaXhpZS52ZWJ0by5jb20nKSA+IC0xO1xyXG5cclxuICAgICRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUgPSBmYWxzZTsgXHJcblxyXG4gICAgLy9jaGVjayBpZiB3ZSdyZSBydW5uaW5nIGluIGludGVncmF0aW9uIG1vZGVcclxuICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKHdpbmRvdy5zZWxmICE9PSB3aW5kb3cudG9wKSB7IFxyXG4gICAgICAgICAgICAkKCdzY3JpcHQnLCB3aW5kb3cucGFyZW50LmRvY3VtZW50KS5lYWNoKGZ1bmN0aW9uKGksIG5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChub2RlLnNyYy5pbmRleE9mKCdwaXhpZS1pbnRlZ3JhdGUnKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc0ludGVncmF0aW9uTW9kZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5pc0ludGVncmF0aW9uTW9kZSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vZ2V0IGEgcmVmZXJlbmNlIHRvIHRvcCB3aW5kb3cgaWYgd2UncmUgaW5zaWRlIGlmcmFtZVxyXG4gICAgaWYgKCRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUpIHtcclxuICAgICAgICAkcm9vdFNjb3BlLnBpeGllID0gd2luZG93LnBhcmVudC5QaXhpZTtcclxuICAgIH1cclxuXHJcbiAgICAkcm9vdFNjb3BlLmdldFBhcmFtID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIGlmICgkcm9vdFNjb3BlLnBpeGllKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkcm9vdFNjb3BlLnBpeGllLmdldFBhcmFtcygpW25hbWVdO1xyXG4gICAgICAgIH0gZWxzZSBpZiAod2luZG93LlBpeGllUGFyYW1zKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuUGl4aWVQYXJhbXNbbmFtZV07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBjYW52YXMuc3RhcnQoKTtcclxuXHJcbiAgICAvL21ha2UgYWN0aW9ucyBwYW5lbHMgZHJhZ2dhYmxlXHJcbiAgICAkKCcuYWN0aW9ucy1tZW51JykuZHJhZ2dhYmxlKHtcclxuICAgICAgICBoYW5kbGU6ICcubWVudS1oZWFkZXInLFxyXG4gICAgICAgIGNvbnRhaW5tZW50OiAnYm9keSdcclxuICAgIH0pO1xyXG5cclxuXHQkcm9vdFNjb3BlLmNhbnZhcyA9IGNhbnZhcztcclxuXHQkcm9vdFNjb3BlLmhpc3RvcnkgPSBoaXN0b3J5O1xyXG4gICAgJHJvb3RTY29wZS5zaGFwZXMgPSBzaW1wbGVTaGFwZXM7XHJcblx0JHJvb3RTY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAkcm9vdFNjb3BlLmFuaW1hdGlvbkVuZEV2ZW50ID0gJ3dlYmtpdEFuaW1hdGlvbkVuZCBtb3pBbmltYXRpb25FbmQgTVNBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBhbmltYXRpb25lbmQnO1xyXG4gICAgJHJvb3RTY29wZS50cmFuc2l0aW9uRW5kRXZlbnQgPSAnd2Via2l0VHJhbnNpdGlvbkVuZCBtb3pUcmFuc2l0aW9uRW5kIE1TVHJhbnNpdGlvbkVuZCBvYXRyYW5zaXRpb25lbmQgYXRyYW5zaXRpb25lbmQgdHJhbnNpdGlvbmVuZCc7XHJcblxyXG4gICAgJHJvb3RTY29wZS5tYXhQYW5lbEhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKSAtIDEyMDtcclxuXHJcbiAgICAkcm9vdFNjb3BlLm9wZW5QYW5lbCA9IGZ1bmN0aW9uKG5hbWUsIGUpIHtcclxuICAgICAgICBpZiAoJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9PT0gbmFtZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gbmFtZTtcclxuXHJcbiAgICAgICAgdmFyIHBhbmVsID0gJCgnW2RhdGEtbmFtZT1cIicrbmFtZSsnXCJdJyk7XHJcblxyXG4gICAgICAgIHZhciBjbGlja1JlY3QgPSBlLnRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB2YXIgcGFuZWxSZWN0ID0gcGFuZWxbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgIHZhciBzY2FsZVggPSBNYXRoLm1pbigwLjUsIGNsaWNrUmVjdC53aWR0aCAvIHBhbmVsUmVjdC53aWR0aCk7XHJcbiAgICAgICAgdmFyIHNjYWxlWSA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LmhlaWdodCAvIHBhbmVsUmVjdC5oZWlnaHQpO1xyXG5cclxuICAgICAgICBwYW5lbC5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1pbicpLmNzcygndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZTNkKCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC5sZWZ0ICsgY2xpY2tSZWN0LmxlZnQgKyBjbGlja1JlY3Qud2lkdGgvMiAtIHBhbmVsUmVjdC53aWR0aC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgKC1wYW5lbFJlY3QudG9wICsgY2xpY2tSZWN0LnRvcCArIGNsaWNrUmVjdC5oZWlnaHQvMiAtIHBhbmVsUmVjdC5oZWlnaHQvMikgKyAncHgsJyArXHJcbiAgICAgICAgICAgICcwKSBzY2FsZSgnICsgc2NhbGVYICsgJywnICsgc2NhbGVZICsgJyknXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQocGFuZWwpLmFkZENsYXNzKCd0cmFuc2l0aW9uLWluJykuY3NzKCd0cmFuc2Zvcm0nLCAnJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuXHQkcm9vdFNjb3BlLmlzTG9hZGluZyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0JHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdCRyb290U2NvcGUubG9hZGluZyA9IHRydWU7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHQkcm9vdFNjb3BlLmlzTm90TG9hZGluZyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0JHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdCRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0JHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG4gICAgJHJvb3RTY29wZS5hY3RpdmVUYWIgICA9IGZhbHNlO1xyXG5cclxuXHQkcm9vdFNjb3BlLmtleXMgPSB7XHJcblx0XHRnb29nbGVfZm9udHM6ICdBSXphU3lEaGNfOE5LeFhqdHY2OWh0RmNVUGU2QTdvR1NRNG9tMm8nLFxyXG5cdH07XHJcblxyXG5cdCRyb290U2NvcGUuJHdhdGNoKCdhY3RpdmVQYW5lbCcsIGZ1bmN0aW9uKCkge1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcblx0XHRcdCQod2luZG93KS5yZXNpemUoKTsgXHJcblx0XHR9LCAxMDApO1xyXG5cdH0pO1xyXG4gICAgXHJcbiAgICAkcm9vdFNjb3BlLnJlc2V0VUkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IG51bGw7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiICAgPSAnYmFzaWNzJztcclxuICAgICAgICAgICAgc2ltcGxlU2hhcGVzLnNlbGVjdGVkICA9IG51bGw7XHJcbiAgICAgICAgICAgIGZpbHRlcnMuYXBwbGllZEZpbHRlcnMgPSBbXTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5oaXN0b3J5LmFsbCA9IFtdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAvL29wZW4gY29ycmVzcG9uZGluZyB0YWIgaW4gbGVmdCBwYW5lbCB3aGVuIHVzZXIgc2VsZWN0cyBhbiBvYmplY3RcclxuICAgIGNhbnZhcy5mYWJyaWMub24oJ29iamVjdDpzZWxlY3RlZCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBpZiAoZS50YXJnZXQubmFtZSA9PSAndGV4dCcpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVUYWIgPSAndGV4dCc7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlLnRhcmdldC5uYW1lID09ICdzdGlja2VyJyAmJiAkcm9vdFNjb3BlLmFjdGl2ZVRhYiAhPT0gJ3N0aWNrZXJzJykge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiA9ICdzdGlja2Vycyc7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlLnRhcmdldC5uYW1lICYmICRyb290U2NvcGUuYWN0aXZlVGFiICE9PSAnc2ltcGxlLXNoYXBlcycpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaW1wbGVTaGFwZXMuYXZhaWxhYmxlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2hhcGUgPSBzaW1wbGVTaGFwZXMuYXZhaWxhYmxlW2ldO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChzaGFwZS5uYW1lID09PSBlLnRhcmdldC5uYW1lICYmICRyb290U2NvcGUuYWN0aXZlVGFiICE9PSAnc2ltcGxlLXNoYXBlcycpIHtcclxuICAgICAgICAgICAgICAgICAgICBzaW1wbGVTaGFwZXMuc2VsZWN0ZWQgPSBzaGFwZTtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVRhYiA9ICdzaW1wbGUtc2hhcGVzJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHRpbWVvdXQoYW5ndWxhci5ub29wKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vQ2xvc2Ugb2JqZWN0IHBhbmVsIHdoZW4gb2JqZWN0IGlzIGRlLXNlbGVjdGVkXHJcbiAgICBjYW52YXMuZmFicmljLm9uKCdzZWxlY3Rpb246Y2xlYXJlZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICR0aW1lb3V0KGFuZ3VsYXIubm9vcCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL2Rlc2VsZWN0IGFsbCBvYmplY3RzIHdoZW4gY2xpY2tpbmcgb3V0c2lkZSBjYW52YXNcclxuICAgICQoJyN2aWV3cG9ydCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBpZiAoZS50YXJnZXQuaWQgPT09ICd2aWV3cG9ydCcpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmRlYWN0aXZhdGVBbGwoKS5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLm9wZW5Cb3R0b21TaGVldCA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAkbWRCb3R0b21TaGVldC5zaG93KHtcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICQoJyMnK25hbWUrJy1zaGVldC10ZW1wbGF0ZScpLmh0bWwoKSxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0JvdHRvbVNoZWV0Q29udHJvbGxlcidcclxuICAgICAgICB9KTtcclxuICAgIH07IFxyXG5cclxuICAgIC8vY2xlYW51cC4gcmVtb3ZlIGNvbG9yIHBpY2tlciBjb250YWluZXJzIG9uIHNjb3BlIGRlc3Ryb3kuXHJcbiAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQoJy5zcC1jb250YWluZXInKS5yZW1vdmUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICAkcm9vdFNjb3BlLnNwYWNpZnkgPSBmdW5jdGlvbih0ZXh0KSB7XHJcbiAgICAgICAgaWYgKHRleHQpIHtcclxuICAgICAgICAgICAgdmFyIHRlbXAgPSB0ZXh0LnJlcGxhY2UoIC8oW0EtWl0pL2csIFwiICQxXCIgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRlbXAuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0ZW1wLnNsaWNlKDEpO1xyXG4gICAgICAgIH1cclxuICAgICB9O1xyXG59XSlcclxuXHJcbi5jb250cm9sbGVyKCdCb3R0b21TaGVldENvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRtZEJvdHRvbVNoZWV0JywgJyRtZERpYWxvZycsICdzaW1wbGVTaGFwZXMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRtZEJvdHRvbVNoZWV0LCAkbWREaWFsb2csIHNpbXBsZVNoYXBlcykge1xyXG4gICAgJHNjb3BlLnNoYXBlcyA9IHNpbXBsZVNoYXBlcztcclxuXHJcbiAgICAkc2NvcGUuc2hvd0RpYWxvZyA9IGZ1bmN0aW9uKCRldmVudCkge1xyXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICQoJyN0ZXh0dXJlLXVwbG9hZC1kaWFsb2ctdGVtcGxhdGUnKS5odG1sKCksXHJcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiAkZXZlbnQsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdCb3R0b21TaGVldENvbnRyb2xsZXInXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmZhY3RvcnkoJ2xvY2FsU3RvcmFnZScsIGZ1bmN0aW9uKCkge1xyXG5cdHZhciBzdG9yYWdlID0ge1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogSG93IGxvbmcgKGRheXMpIGRhdGEgd2lsbCBiZSBjYWNoZWQgaW4gbG9jYWwgc3RvcmFnZS5cclxuXHRcdCAqIFxyXG5cdFx0ICogQHR5cGUge051bWJlcn1cclxuXHRcdCAqL1xyXG5cdFx0ZXhwaXJlQWZ0ZXI6IDIsXHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBSZXRyaWV2ZSB2YWx1ZSB1bmRlciBnaXZlbiBrZXkgZnJvbSBsb2NhbCBzdG9yYWdlLlxyXG5cdFx0ICogXHJcblx0XHQgKiBAcGFyYW0gIHN0cmluZyBrZXlcclxuXHRcdCAqIEByZXR1cm4gbWl4ZWRcclxuXHRcdCAqL1xyXG5cdFx0Z2V0OiBmdW5jdGlvbihrZXkpIHtcclxuXHRcdFx0dmFyIHZhbHVlID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKTtcclxuXHRcdFx0XHJcblx0XHRcdGlmICggISB2YWx1ZSB8fCAhIHN0b3JhZ2UuaXNWYWxpZCh2YWx1ZS50aW1lKSkge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIHZhbHVlLnZhbHVlO1xyXG5cdFx0fSxcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIFN0b3JlIHZhbHVlIGludG8gYnJvd3NlciBsb2NhbCBzdG9yYWdlLlxyXG5cdFx0ICogXHJcblx0XHQgKiBAcGFyYW0gc3RyaW5nIGtleVxyXG5cdFx0ICogQHBhcmFtIG1peGVkIHZhbHVlXHJcblx0XHQgKi9cclxuXHRcdHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG5cdFx0XHR2YXIgZGF0YSA9IHsgdmFsdWU6IHZhbHVlLCB0aW1lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSB9O1xyXG5cclxuXHRcdFx0cmV0dXJuIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG5cdFx0fSxcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIFdoZXRoZXIgb3Igbm90IGNhY2hlIHdpdGggZ2l2ZW4gdGltZSBpcyBjb25zaWRlcmVkIGV4cGlyZWQuXHJcblx0XHQgKiBcclxuXHRcdCAqIEBwYXJhbSAgc3RyaW5nICB0aW1lXHJcblx0XHQgKiBAcmV0dXJuIHtCb29sZWFufVxyXG5cdFx0ICovXHJcblx0XHRpc1ZhbGlkOiBmdW5jdGlvbih0aW1lKSB7XHJcblx0XHRcdHZhciBkYXlzID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbmV3IERhdGUodGltZSkuZ2V0VGltZSgpKS8oMTAwMCo2MCo2MCoyNCk7XHJcblxyXG5cdFx0XHRyZXR1cm4gZGF5cyA8IHN0b3JhZ2UuZXhwaXJlQWZ0ZXI7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHN0b3JhZ2U7XHJcbn0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpLmZhY3RvcnkoJ3NldHRpbmdzJywgWyckcm9vdFNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHApIHtcclxuXHJcblx0dmFyIHNldHRpbmdzID0ge1xyXG4gICAgICAgIGFsbDoge30sXHJcblxyXG4gICAgICAgIGdldDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hbGxbbmFtZV07XHJcbiAgICAgICAgfVxyXG5cdH1cclxuXHJcbiAgICAkaHR0cC5nZXQoJ2NvbmZpZy5qc29uJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgc2V0dGluZ3MuYWxsID0gZGF0YTtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnc2V0dGluZ3MucmVhZHknKTtcclxuICAgIH0pO1xyXG5cclxuXHRyZXR1cm4gc2V0dGluZ3M7XHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmZhY3RvcnkoJ2tleWJpbmRzJywgWyckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHJvb3RTY29wZSkge1xyXG5cclxuICAgIHZhciBrZXliaW5kcyA9IHtcclxuXHJcbiAgICAgICAgZmFicmljOiBmYWxzZSxcclxuXHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24oZmFicmljKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljID0gZmFicmljO1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQoJy5jYW52YXMtY29udGFpbmVyJykub2ZmKFwia2V5ZG93blwiLCBwcm9jZXNzS2V5cywgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcclxuICAgICAgICAkKGRvY3VtZW50KS5vbigna2V5ZG93bicsIGhhbmRsZUtleURvd24pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUtleURvd24oZSkge1xyXG4gICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcclxuXHJcbiAgICAgICAgaWYgKFszNywgMzgsIDM5LCA0MF0uaW5kZXhPZihlLmtleUNvZGUpID4gLTEpIG1vdmVPYmplY3QoZSk7XHJcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gNDYpIGRlbGV0ZU9iamVjdCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkZWxldGVPYmplY3QoKSB7XHJcbiAgICAgICAgdmFyIGFjdGl2ZU9iamVjdCA9IGtleWJpbmRzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHJcbiAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCkge1xyXG4gICAgICAgICAgICBrZXliaW5kcy5mYWJyaWMucmVtb3ZlKGFjdGl2ZU9iamVjdCk7XHJcbiAgICAgICAgICAgIGtleWJpbmRzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW92ZU9iamVjdChlKSB7XHJcbiAgICAgICAgdmFyIG1vdmVtZW50RGVsdGEgPSAyO1xyXG5cclxuICAgICAgICB2YXIgYWN0aXZlT2JqZWN0ID0ga2V5YmluZHMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG4gICAgICAgIHZhciBhY3RpdmVHcm91cCA9IGtleWJpbmRzLmZhYnJpYy5nZXRBY3RpdmVHcm91cCgpO1xyXG5cclxuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAzNykge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gYWN0aXZlT2JqZWN0LmdldCgnbGVmdCcpIC0gbW92ZW1lbnREZWx0YTtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZU9iamVjdC5zZXQoJ2xlZnQnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVHcm91cC5nZXQoJ2xlZnQnKSAtIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVHcm91cC5zZXQoJ2xlZnQnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMzkpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBpZiAoYWN0aXZlT2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IGFjdGl2ZU9iamVjdC5nZXQoJ2xlZnQnKSArIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0KCdsZWZ0JywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoYWN0aXZlR3JvdXApIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gYWN0aXZlR3JvdXAuZ2V0KCdsZWZ0JykgKyBtb3ZlbWVudERlbHRhO1xyXG4gICAgICAgICAgICAgICAgYWN0aXZlR3JvdXAuc2V0KCdsZWZ0JywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDM4KSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVPYmplY3QuZ2V0KCd0b3AnKSAtIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0KCd0b3AnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVHcm91cC5nZXQoJ3RvcCcpIC0gbW92ZW1lbnREZWx0YTtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUdyb3VwLnNldCgndG9wJywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDQwKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYgKGFjdGl2ZU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVPYmplY3QuZ2V0KCd0b3AnKSArIG1vdmVtZW50RGVsdGE7XHJcbiAgICAgICAgICAgICAgICBhY3RpdmVPYmplY3Quc2V0KCd0b3AnLCBhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGEgPSBhY3RpdmVHcm91cC5nZXQoJ3RvcCcpICsgbW92ZW1lbnREZWx0YTtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUdyb3VwLnNldCgndG9wJywgYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChhY3RpdmVPYmplY3QpIHtcclxuICAgICAgICAgICAgYWN0aXZlT2JqZWN0LnNldENvb3JkcygpO1xyXG4gICAgICAgICAgICBrZXliaW5kcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhY3RpdmVHcm91cCkge1xyXG4gICAgICAgICAgICBhY3RpdmVHcm91cC5zZXRDb29yZHMoKTtcclxuICAgICAgICAgICAga2V5YmluZHMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ga2V5YmluZHM7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLnNlcnZpY2UoJ2NhbnZhcycsIFsnJHJvb3RTY29wZScsICckbWREaWFsb2cnLCAna2V5YmluZHMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkbWREaWFsb2csIGtleWJpbmRzKSB7XHJcblxyXG5cdHZhciBjYW52YXMgPSB7XHJcblxyXG4gICAgICAgIG9yaWdpbmFsOiB7fSxcclxuXHJcbiAgICAgICAgLy9zdG9yZSB3aW5kb3cgd2lkdGggYW5kIGhlaWdodCBzbyB3ZSBkb24ndCBleGVjdXRlXHJcbiAgICAgICAgLy9mdW5jdGlvbnMgdW5uZWNlc3NhcmlseSBvbiByZXNpemUgZXZlbnQgaWYgdGhleSBkaWRuJ3QgY2hhbmdlXHJcbiAgICAgICAgb2xkV2luZG93RGltZW5zaW9uczoge1xyXG4gICAgICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0XHJcbiAgICAgICAgfSxcclxuXHJcblx0XHRtYWluSW1hZ2U6IGZhbHNlLFxyXG5cdFx0ZmFicmljOiBmYWxzZSxcclxuXHRcdGN0eDogZmFsc2UsXHJcblx0XHRjb250YWluZXI6IGZhbHNlLFxyXG5cdFx0dmlld3BvcnQ6IGZhbHNlLFxyXG5cdFx0b2Zmc2V0OiBmYWxzZSxcclxuXHRcdGVsZW1lbnQ6IGZhbHNlLFxyXG5cclxuICAgICAgICBtaW5XaWR0aDogNTAsXHJcbiAgICAgICAgbWluSGVpZ2h0OiA1MCxcclxuXHJcblx0XHRpbWFnZVN0YXRpYzoge1xyXG4gICAgICAgICAgICBsb2NrZWQ6IHRydWUsXHJcblx0XHRcdHNlbGVjdGFibGU6IGZhbHNlLFxyXG5cdCAgICAgIFx0ZXZlbnRlZDogZmFsc2UsXHJcblx0ICAgICAgXHRsb2NrTW92ZW1lbnRYOiB0cnVlLFxyXG5cdCAgICAgIFx0bG9ja01vdmVtZW50WTogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tSb3RhdGlvbjogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tTY2FsaW5nWDogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tTY2FsaW5nWTogdHJ1ZSxcclxuXHQgICAgICBcdGxvY2tVbmlTY2FsaW5nOiB0cnVlLFxyXG5cdCAgICAgIFx0aGFzQ29udHJvbHM6IGZhbHNlLFxyXG5cdCAgICAgIFx0aGFzQm9yZGVyczogZmFsc2VcclxuXHRcdH0sXHJcblxyXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMubWFpbkltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWwgPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Wm9vbSA9IDE7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuZWRpdG9yQ3VzdG9tQWN0aW9ucyA9IHt9O1xyXG4gICAgICAgICAgICAkKHdpbmRvdykub2ZmKCdyZXNpemUnKTtcclxuICAgICAgICAgICAga2V5YmluZHMuZGVzdHJveSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG5cdFx0c3RhcnQ6IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljID0gbmV3IGZhYnJpYy5DYW52YXMoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICB0aGlzLmN0eCA9IHRoaXMuZmFicmljLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gJCgnLmNhbnZhcy1jb250YWluZXInKTtcclxuICAgICAgICAgICAgdGhpcy52aWV3cG9ydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3cG9ydCcpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmVkaXRvckN1c3RvbUFjdGlvbnMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnNlbGVjdGlvbiA9IGZhbHNlOyBcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMucmVuZGVyT25BZGRSZW1vdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGZhYnJpYy5PYmplY3QucHJvdG90eXBlLmJvcmRlckNvbG9yID0gJyMyMTk2RjMnO1xyXG4gICAgICAgICAgICBmYWJyaWMuT2JqZWN0LnByb3RvdHlwZS5jb3JuZXJDb2xvciA9ICcjMjE5NkYzJztcclxuICAgICAgICAgICAgZmFicmljLk9iamVjdC5wcm90b3R5cGUudHJhbnNwYXJlbnRDb3JuZXJzID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAoICEgdXJsKSB1cmwgPSAkcm9vdFNjb3BlLmdldFBhcmFtKCd1cmwnKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh1cmwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZE1haW5JbWFnZSh1cmwpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICgkcm9vdFNjb3BlLmdldFBhcmFtKCdibGFua0NhbnZhc1NpemUnKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSAkcm9vdFNjb3BlLmdldFBhcmFtKCdibGFua0NhbnZhc1NpemUnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3Blbk5ldyhzaXplLndpZHRoLCBzaXplLmhlaWdodCwgJ25ld0NhbnZhcycpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCAhICRyb290U2NvcGUuc3RhcnRlZCAmJiAhICRyb290U2NvcGUuaXNJbnRlZ3JhdGlvbk1vZGUgJiYgISAkcm9vdFNjb3BlLmRlbGF5RWRpdG9yU3RhcnQpIHtcclxuICAgICAgICAgICAgICAgIC8qJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAkKCcjbWFpbi1pbWFnZS11cGxvYWQtZGlhbG9nLXRlbXBsYXRlJykuaHRtbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdUb3BQYW5lbENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9KTsqL1xyXG5cclxuICAgICAgICAgICAgICAgIC8vJHNjb3BlLmNyZWF0ZU5ld0NhbnZhcyg1MDAsIDUwMClcclxuICAgICAgICAgICAgICAgIC8vY2FudmFzLm9wZW5OZXcoNTAwLDUwMCxcIlVubmFtZWRcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FudmFzLm9wZW5OZXcoMTE3MiwgMTE4Mik7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkKHdpbmRvdykub2ZmKCdyZXNpemUnKS5vbigncmVzaXplJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhbnZhcy5vbGRXaW5kb3dEaW1lbnNpb25zLmhlaWdodCAhPT0gZS50YXJnZXQuaW5uZXJIZWlnaHQgfHxcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMub2xkV2luZG93RGltZW5zaW9ucy53aWR0aCAhPT0gZS50YXJnZXQuaW5uZXJXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbGRXaW5kb3dEaW1lbnNpb25zLndpZHRoID0gZS50YXJnZXQuaW5uZXJXaWR0aDtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vbGRXaW5kb3dEaW1lbnNpb25zLmhlaWdodCA9IGUudGFyZ2V0LmlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ2NhbnZhcy5pbml0Jyk7XHJcblxyXG4gICAgICAgICAgICBrZXliaW5kcy5pbml0KHRoaXMuZmFicmljKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmdldFBhcmFtKCdvbkxvYWQnKSkge1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nZXRQYXJhbSgnb25Mb2FkJykodGhpcy52aWV3cG9ydCwgJHJvb3RTY29wZSwgd2luZG93KTsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBoaWRlTW9kYWxzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBtZXJnZU9iamVjdHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMuZGVhY3RpdmF0ZUFsbCgpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuZmFicmljLnRvRGF0YVVSTCgpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRNYWluSW1hZ2UoZGF0YSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbG9hZEZyb21KU09OOiBmdW5jdGlvbihkZXNpZ24sIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMubG9hZEZyb21KU09OKGRlc2lnbi5zZXJpYWxpemVkX2VkaXRvcl9zdGF0ZSB8fCBkZXNpZ24uc3RhdGUsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL3JlYXBwbHkgYW55IGZpbHRlcnMgb2JqZWN0IHVzZWQgdG8gaGF2ZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouYXBwbHlGaWx0ZXJzICYmIG9iai5maWx0ZXJzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouYXBwbHlGaWx0ZXJzKGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsLmJpbmQoY2FudmFzLmZhYnJpYykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9hc3NpZ24gbmV3IHJlZmVyZW5jZSB0byBtYWluSW1hZ2UgcHJvcGVydHlcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLm5hbWUgPT0gJ21haW5JbWFnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLm1haW5JbWFnZSA9IG9iajtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZGVzaWduLndpZHRoICYmIGRlc2lnbi5oZWlnaHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnNldFdpZHRoKGRlc2lnbi53aWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoZGVzaWduLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IGRlc2lnbi5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoID0gZGVzaWduLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmNhbGNPZmZzZXQoKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kZW1pdCgnaGlzdG9yeS5sb2FkZWQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhkZXNpZ24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDcmVhdGUgYSBuZXcgaW1hZ2Ugd2l0aCBnaXZlbiBkaW1lbnNpb25zLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtpbnR8c3RyaW5nfSB3aWR0aFxyXG4gICAgICAgICAqIEBwYXJhbSB7aW50fHN0cmluZ30gaGVpZ2h0XHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd8dW5kZWZpbmVkfSBuYW1lXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgb3Blbk5ldzogZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgbmFtZSkge1xyXG4gICAgICAgICAgICB3aWR0aCA9IHdpZHRoIDwgdGhpcy5taW5XaWR0aCA/IHRoaXMubWluV2lkdGggOiB3aWR0aDtcclxuICAgICAgICAgICAgaGVpZ2h0ID0gaGVpZ2h0IDwgdGhpcy5taW5IZWlnaHQgPyB0aGlzLm1pbkhlaWdodCA6IGhlaWdodDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnNldFdpZHRoKHdpZHRoKTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMuc2V0SGVpZ2h0KGhlaWdodCk7XHJcbiAgICAgICAgICAgIHRoaXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICBjYW52YXMuZml0VG9TY3JlZW4oKTtcclxuXHJcbiAgICAgICAgICAgIC8vc2F2ZSB0aGUgZGltZW5zaW9ucyBzbyB3ZSBjYW4gc2NhbGUgaW1hZ2VzIG9wZW5lZCBsYXRlciB0byB0aGVtXHJcbiAgICAgICAgICAgICRyb290U2NvcGUudXNlclByZXNldCA9IHtcclxuICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoID0gd2lkdGg7XHJcblxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCdjYW52YXMub3BlbmVkTmV3Jyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgY2VudGVyOiBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgb2JqLmNlbnRlcigpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNhbnZhcy56b29tID4gMTAwKSB7XHJcbiAgICAgICAgICAgICAgICBvYmouc2V0TGVmdCgxMCk7XHJcbiAgICAgICAgICAgICAgICBvYmouc2V0VG9wKDM1KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb2JqLnNldENvb3JkcygpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZhYnJpYy50b0pTT04oWydzZWxlY3RhYmxlJywgJ25hbWUnXSk7XHJcbiAgICAgICAgfSxcclxuXHJcblx0XHRsb2FkTWFpbkltYWdlOiBmdW5jdGlvbih1cmwsIGhlaWdodCwgd2lkdGgsIGRvbnRGaXQsIGNhbGxiYWNrKSB7XHJcblx0XHRcdHZhciBvYmplY3Q7XHJcblxyXG5cdFx0XHRmYWJyaWMudXRpbC5sb2FkSW1hZ2UodXJsLCBmdW5jdGlvbiAoaW1nKSB7XHJcbiAgICAgICAgICAgICAgICAvL2ltZy5jcm9zc09yaWdpbiA9ICdhbm9ueW1vdXMnO1xyXG5cclxuXHRcdFx0ICAgIG9iamVjdCA9IG5ldyBmYWJyaWMuSW1hZ2UoaW1nLCBjYW52YXMuaW1hZ2VTdGF0aWMpO1xyXG5cdFx0XHQgICAgb2JqZWN0Lm5hbWUgPSAnbWFpbkltYWdlJztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAod2lkdGggJiYgaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0LndpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdCAgICBjYW52YXMubWFpbkltYWdlID0gb2JqZWN0O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLm5hbWUgPT0gJ21haW5JbWFnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW1vdmUob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0ICAgIGNhbnZhcy5mYWJyaWMuYWRkKG9iamVjdCk7XHJcblx0XHRcdCAgIFx0b2JqZWN0LnRvcCA9IC0wLjU7XHJcblx0XHRcdCAgIFx0b2JqZWN0LmxlZnQgPSAtMC41O1xyXG5cdFx0XHQgICAgb2JqZWN0Lm1vdmVUbygwKTtcclxuXHJcblx0XHRcdCAgICBjYW52YXMuZmFicmljLnNldEhlaWdodChvYmplY3QuaGVpZ2h0KTtcclxuXHRcdFx0ICAgIGNhbnZhcy5mYWJyaWMuc2V0V2lkdGgob2JqZWN0LndpZHRoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYW52YXMub3JpZ2luYWwuaGVpZ2h0ID0gb2JqZWN0LmhlaWdodDtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC53aWR0aCA9IG9iamVjdC53aWR0aDtcclxuXHJcblx0XHRcdFx0aWYgKCAhIGRvbnRGaXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZml0VG9TY3JlZW4oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdFx0JHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkcm9vdFNjb3BlLiRlbWl0KCdlZGl0b3IubWFpbkltYWdlLmxvYWRlZCcpO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogT3BlbiBpbWFnZSBhdCBnaXZlbiB1cmwgaW4gY2FudmFzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIG9wZW5JbWFnZTogZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDEpO1xyXG4gICAgICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UodXJsLCBmdW5jdGlvbihpbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCAhIGltYWdlKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IG5ldyBmYWJyaWMuSW1hZ2UoaW1hZ2UpO1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0Lm5hbWUgPSAnaW1hZ2UnO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vdXNlIGVpdGhlciBtYWluIGltYWdlIG9yIGNhbnZhcyBkaW1lbnNpb25zIGFzIG91dHRlciBib3VuZGFyaWVzIGZvciBzY2FsaW5nIG5ldyBpbWFnZVxyXG4gICAgICAgICAgICAgICAgdmFyIG1heFdpZHRoICA9IGNhbnZhcy5tYWluSW1hZ2UgPyBjYW52YXMubWFpbkltYWdlLmdldFdpZHRoKCkgOiBjYW52YXMuZmFicmljLmdldFdpZHRoKCksXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gY2FudmFzLm1haW5JbWFnZSA/IGNhbnZhcy5tYWluSW1hZ2UuZ2V0SGVpZ2h0KCkgOiBjYW52YXMuZmFicmljLmdldEhlaWdodCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vaWYgaW1hZ2UgaXMgd2lkZXIgb3IgaGVpZ2hlciB0aGVuIHRoZSBjdXJyZW50IGNhbnZhcywgd2UnbGwgc2NhbGUgaWQgZG93blxyXG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdC53aWR0aCA+PSBtYXhXaWR0aCB8fCBvYmplY3QuaGVpZ2h0ID49IG1heEhlaWdodCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2NhbGMgbmV3IGltYWdlIGRpbWVuc2lvbnMgKG1haW4gaW1hZ2UgaGVpZ2h0IC0gMTAlIGFuZCB3aWR0aCAtIDEwJSlcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3V2lkdGggID0gbWF4V2lkdGggLSAoMC4xICogbWF4V2lkdGgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdIZWlnaHQgPSBtYXhIZWlnaHQgLSAoMC4xICogbWF4SGVpZ2h0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGUgICAgID0gMSAvIChNYXRoLm1pbihuZXdIZWlnaHQgLyBvYmplY3QuZ2V0SGVpZ2h0KCksIG5ld1dpZHRoIC8gb2JqZWN0LmdldFdpZHRoKCkpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9zY2FsZSBuZXdseSB1cGxvYWRlZCBpbWFnZSB0byB0aGUgYWJvdmUgZGltZXNuc2lvbnNcclxuICAgICAgICAgICAgICAgICAgICBvYmplY3Quc2NhbGVYID0gb2JqZWN0LnNjYWxlWCAqICgxIC8gc2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5zY2FsZVkgPSBvYmplY3Quc2NhbGVZICogKDEgLyBzY2FsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy9jZW50ZXIgYW5kIHJlbmRlciBuZXdseSB1cGxvYWRlZCBpbWFnZSBvbiB0aGUgY2FudmFzXHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmFkZChvYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0LmxlZnQgPSAoY2FudmFzLmZhYnJpYy5nZXRXaWR0aCgpIC0gb2JqZWN0LmdldFdpZHRoKCkpIC8gMjtcclxuICAgICAgICAgICAgICAgIG9iamVjdC50b3AgPSAoY2FudmFzLmZhYnJpYy5nZXRIZWlnaHQoKSAtIG9iamVjdC5nZXRIZWlnaHQoKSkgLyAyO1xyXG4gICAgICAgICAgICAgICAgb2JqZWN0LnNldENvb3JkcygpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqZWN0KTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldERhdGFVUkw6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgaWYgKCAhIG9wdGlvbnMpIG9wdGlvbnMgPSB7fTtcclxuXHJcbiAgICAgICAgICAgIC8vaWdub3JlIHpvb20gd2hlbiBnZXR0aW5nIGRhdGEgdXJsXHJcbiAgICAgICAgICAgIG9wdGlvbnMubXVsdGlwbGllciA9IDEgLyBjYW52YXMuY3VycmVudFpvb207XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mYWJyaWMudG9EYXRhVVJMKG9wdGlvbnMpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGN1cnJlbnRab29tOiAxLFxyXG5cclxuICAgICAgICB6b29tOiBmdW5jdGlvbihzY2FsZUZhY3Rvcikge1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRab29tKHNjYWxlRmFjdG9yKTtcclxuICAgICAgICAgICAgdGhpcy5mYWJyaWMuc2V0SGVpZ2h0KHRoaXMub3JpZ2luYWwuaGVpZ2h0ICogc2NhbGVGYWN0b3IpO1xyXG4gICAgICAgICAgICB0aGlzLmZhYnJpYy5zZXRXaWR0aCh0aGlzLm9yaWdpbmFsLndpZHRoICogc2NhbGVGYWN0b3IpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Wm9vbSA9IHNjYWxlRmFjdG9yO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGZpdFRvU2NyZWVuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXhXaWR0aCAgPSBjYW52YXMudmlld3BvcnQub2Zmc2V0V2lkdGggLSA0MCxcclxuICAgICAgICAgICAgICAgIG1heEhlaWdodCA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgLSAxMjAsXHJcbiAgICAgICAgICAgICAgICBvdXR0ZXIgICAgPSBjYW52YXMubWFpbkltYWdlIHx8IGNhbnZhcy5mYWJyaWMsXHJcbiAgICAgICAgICAgIFx0c2NhbGUgICAgID0gTWF0aC5taW4obWF4SGVpZ2h0IC8gb3V0dGVyLmdldEhlaWdodCgpLCBtYXhXaWR0aCAvIG91dHRlci5nZXRXaWR0aCgpKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChvdXR0ZXIuZ2V0SGVpZ2h0KCkgPiBtYXhIZWlnaHQgfHwgb3V0dGVyLmdldFdpZHRoKCkgPiBtYXhXaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLnpvb20oc2NhbGUpOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHR9O1xyXG5cclxuXHRyZXR1cm4gY2FudmFzO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJywgW10pXHJcblxyXG4uc2VydmljZSgnY3JvcHBlcicsIFsnJHJvb3RTY29wZScsICdjcm9wem9uZScsICdjYW52YXMnLCAnaGlzdG9yeScsIGZ1bmN0aW9uKCRyb290U2NvcGUsIGNyb3B6b25lLCBjYW52YXMsIGhpc3RvcnkpIHtcclxuXHRcclxuXHR2YXIgY3JvcHBlciA9IHtcclxuXHJcblx0XHRzdGFydDogZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRpZiAoY3JvcHpvbmUuaW5pdGlhdGVkKSByZXR1cm47XHJcblx0XHRcdFxyXG5cdFx0XHRjcm9wem9uZS5hZGQoKTtcclxuXHRcdFx0JHJvb3RTY29wZS5vcGVuUGFuZWwoJ2Nyb3AnLCBlKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0c3RvcDogZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRjcm9wem9uZS5yZW1vdmUoKTtcclxuXHRcdFx0JHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG5cdFx0fSxcclxuXHJcblx0XHRjcm9wOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYgKCAhIGNyb3B6b25lLmluaXRpYXRlZCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuXHRcdFx0Y3JvcHpvbmUuaGlkZSgpO1xyXG5cdFx0ICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG5cclxuXHRcdCAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHRcdCAgICAgICAgdmFyIGZhYnJpY0ltYWdlID0gbmV3IGZhYnJpYy5JbWFnZSh0aGlzLCBjYW52YXMuaW1hZ2VTdGF0aWMpO1xyXG4gICAgICAgICAgICAgICAgZmFicmljSW1hZ2UubmFtZSA9ICdtYWluSW1hZ2UnO1xyXG5cclxuXHRcdCAgICAgICAgY2FudmFzLm1haW5JbWFnZSAmJiBjYW52YXMubWFpbkltYWdlLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG5cdFx0ICAgICAgICBjYW52YXMuZmFicmljLnNldFdpZHRoKE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkpKTtcclxuXHRcdCAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0SGVpZ2h0KCkpKTtcclxuXHJcbiAgICAgICAgXHRcdGNhbnZhcy5mYWJyaWMuYWRkKGZhYnJpY0ltYWdlKTtcclxuICAgICAgICAgICAgICAgIGZhYnJpY0ltYWdlLm1vdmVUbygwKTtcclxuICAgICAgICAgICAgICAgIGZhYnJpY0ltYWdlLmNlbnRlcigpO1xyXG4gICAgICAgIFx0XHRjYW52YXMubWFpbkltYWdlID0gZmFicmljSW1hZ2U7XHJcbiAgICAgICAgXHRcdGNyb3B6b25lLnJlbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdjcm9wJywgJ2Nyb3AnKTtcclxuXHJcblx0XHRcdFx0JHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHQgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDEpO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5lZGl0b3JDdXN0b21BY3Rpb25zLmNyb3AgPSB7XHJcbiAgICAgICAgICAgICAgICBsZWZ0OiBjcm9wem9uZS5yZWN0LmdldExlZnQoKSxcclxuICAgICAgICAgICAgICAgIHRvcDogY3JvcHpvbmUucmVjdC5nZXRUb3AoKSxcclxuICAgICAgICAgICAgICAgIHdpZHRoOiBNYXRoLmNlaWwoY3JvcHpvbmUucmVjdC5nZXRXaWR0aCgpKSxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0SGVpZ2h0KCkpXHJcbiAgICAgICAgICAgIH07XHJcblxyXG5cdFx0ICAgIGltYWdlLnNyYyA9IGNhbnZhcy5mYWJyaWMudG9EYXRhVVJMKHtcclxuXHRcdCAgICAgICAgbGVmdDogY3JvcHpvbmUucmVjdC5nZXRMZWZ0KCksXHJcblx0XHQgICAgICAgIHRvcDogY3JvcHpvbmUucmVjdC5nZXRUb3AoKSxcclxuXHRcdCAgICAgICAgd2lkdGg6IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldFdpZHRoKCkpLFxyXG5cdFx0ICAgICAgICBoZWlnaHQ6IE1hdGguY2VpbChjcm9wem9uZS5yZWN0LmdldEhlaWdodCgpKVxyXG5cdFx0ICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoID0gTWF0aC5jZWlsKGNyb3B6b25lLnJlY3QuZ2V0V2lkdGgoKSk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBNYXRoLmNlaWwoY3JvcHpvbmUucmVjdC5nZXRIZWlnaHQoKSk7XHJcblx0XHR9XHJcblxyXG5cdH07XHJcblxyXG5cdHJldHVybiBjcm9wcGVyO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJylcclxuXHJcbi5zZXJ2aWNlKCdjcm9wem9uZScsIFsnJHJvb3RTY29wZScsICdjYW52YXMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCBjYW52YXMpIHtcclxuXHJcblx0dmFyIGNyb3B6b25lID0ge1xyXG5cclxuXHRcdHJlY3Q6IHt9LFxyXG5cclxuXHRcdGRyYWdnaW5nOiBmYWxzZSxcclxuXHJcblx0XHRpbml0aWF0ZWQ6IGZhbHNlLFxyXG5cclxuXHRcdG1pbkhlaWdodDogMjUsXHJcblxyXG5cdFx0bWluV2lkdGg6IDI1LFxyXG5cclxuXHRcdHNldFdpZHRoOiBmdW5jdGlvbih3aWR0aCkge1xyXG4gICAgICAgICAgICBpZiAoICEgd2lkdGgpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIHdpZHRoID0gcGFyc2VJbnQod2lkdGgpO1xyXG5cclxuXHRcdFx0aWYgKHdpZHRoIDwgdGhpcy5taW5XaWR0aCkge1xyXG5cdFx0XHRcdHdpZHRoID0gdGhpcy5taW5XaWR0aDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKHdpZHRoID4gY2FudmFzLm9yaWdpbmFsLndpZHRoKSB7XHJcblx0XHRcdFx0d2lkdGggPSBjYW52YXMub3JpZ2luYWwud2lkdGggLSAyNTtcclxuXHRcdFx0fVxyXG5cclxuICAgICAgICAgICAgdGhpcy5yZWN0LndpZHRoID0gd2lkdGg7XHJcblx0XHRcdHRoaXMucmVjdC5zZXRUb3AoKGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgLSB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkpIC8gMik7XHJcblx0XHRcdHRoaXMucmVjdC5zZXRMZWZ0KChjYW52YXMub3JpZ2luYWwud2lkdGggLSB0aGlzLnJlY3QuZ2V0V2lkdGgoKSkgLyAyKTtcclxuXHRcdFx0dGhpcy5yZWN0LnNldENvb3JkcygpO1xyXG5cdFx0XHR0aGlzLmRyYXdHcmlkKCk7XHJcblx0XHRcdHRoaXMuZHJhd092ZXJsYXkoKTtcclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0c2V0SGVpZ2h0OiBmdW5jdGlvbihoZWlnaHQpIHtcclxuICAgICAgICAgICAgaWYgKCAhIGhlaWdodCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaGVpZ2h0ID0gcGFyc2VJbnQoaGVpZ2h0KTtcclxuXHJcblx0XHRcdGlmIChoZWlnaHQgPCB0aGlzLm1pbkhlaWdodCkge1xyXG5cdFx0XHRcdGhlaWdodCA9IHRoaXMubWluSGVpZ2h0O1xyXG5cdFx0XHR9XHJcblxyXG4gICAgICAgICAgICBpZiAoaGVpZ2h0ID4gY2FudmFzLm9yaWdpbmFsLmhlaWdodCkge1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtIDI1O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlY3QuaGVpZ2h0ID0gaGVpZ2h0O1xyXG5cdFx0XHR0aGlzLnJlY3Quc2V0VG9wKChjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC0gdGhpcy5yZWN0LmdldEhlaWdodCgpKSAvIDIpO1xyXG5cdFx0XHR0aGlzLnJlY3Quc2V0TGVmdCgoY2FudmFzLm9yaWdpbmFsLndpZHRoIC0gdGhpcy5yZWN0LmdldFdpZHRoKCkpIC8gMik7XHJcblx0XHRcdHRoaXMucmVjdC5zZXRDb29yZHMoKTtcclxuXHRcdFx0dGhpcy5kcmF3R3JpZCgpO1xyXG5cdFx0XHR0aGlzLmRyYXdPdmVybGF5KCk7XHJcblx0XHRcdGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGFkZDogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRoaXMuZHJhd01haW5ab25lKCk7XHJcblx0XHRcdHRoaXMuZHJhd092ZXJsYXkoKTtcclxuXHRcdFx0dGhpcy5kcmF3R3JpZCgpO1xyXG5cdFx0XHR0aGlzLmF0dGFjaEV2ZW50cygpO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuXHJcblx0XHRcdHRoaXMuaW5pdGlhdGVkID0gdHJ1ZTtcclxuXHJcblx0XHRcdCRyb290U2NvcGUuJGVtaXQoJ2Nyb3B6b25lLmFkZGVkJyk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGNvbnN0cmFpbldpdGhpbkNhbnZhczogZnVuY3Rpb24ob2JqZWN0KSB7XHJcblx0XHQgICAgdmFyIHggPSBvYmplY3QuZ2V0TGVmdCgpLCB5ID0gb2JqZWN0LmdldFRvcCgpO1xyXG5cdFx0ICAgIHZhciB3ID0gb2JqZWN0LmdldFdpZHRoKCksIGggPSBvYmplY3QuZ2V0SGVpZ2h0KCk7XHJcblx0XHQgICAgdmFyIG1heFggPSBjYW52YXMub3JpZ2luYWwud2lkdGggLSB3O1xyXG5cdFx0ICAgIHZhciBtYXhZID0gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtIGg7XHJcblxyXG5cdFx0ICAgIGlmICh4IDwgMCkge1xyXG5cdFx0ICAgIFx0b2JqZWN0LnNldCgnbGVmdCcsIDApO1xyXG5cdFx0ICAgIH1cclxuXHRcdCAgICBpZiAoeSA8IDApIHtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldCgndG9wJywgMCk7XHJcblx0XHRcdH1cclxuXHRcdCAgICBpZiAoeCA+IG1heFgpIHtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldCgnbGVmdCcsIG1heFgpO1xyXG5cdFx0ICAgIH1cclxuXHRcdCAgICBpZiAoeSA+IG1heFkpIHtcclxuXHRcdCAgICBcdG9iamVjdC5zZXQoJ3RvcCcsIG1heFkpO1xyXG5cdFx0ICAgIH1cclxuXHRcdH0sXHJcblxyXG5cdFx0Y29uc3RyYWluV2l0aGluQ2FudmFzT25TY2FsaW5nOiBmdW5jdGlvbihvYmplY3QpIHtcclxuXHJcblx0XHQgICAgdmFyIG1pblggPSBvYmplY3QuZ2V0TGVmdCgpO1xyXG5cdFx0ICAgIHZhciBtaW5ZID0gb2JqZWN0LmdldFRvcCgpO1xyXG5cdFx0ICAgIHZhciBtYXhYID0gb2JqZWN0LmdldExlZnQoKSArIG9iamVjdC5nZXRXaWR0aCgpO1xyXG5cdFx0ICAgIHZhciBtYXhZID0gb2JqZWN0LmdldFRvcCgpICsgb2JqZWN0LmdldEhlaWdodCgpO1xyXG5cclxuXHRcdCAgICBpZiAobWluWCA8IDAgfHwgbWF4WCA+IGNhbnZhcy5vcmlnaW5hbC53aWR0aCkge1xyXG5cdFx0ICAgICAgICB2YXIgbGFzdFNjYWxlWCA9IHRoaXMubGFzdFNjYWxlWMKgfHwgMTtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldFNjYWxlWChsYXN0U2NhbGVYKTtcclxuXHRcdCAgICB9XHJcblxyXG5cdFx0ICAgIGlmIChtaW5YIDwgMCkge1xyXG5cdFx0ICAgICAgICBvYmplY3Quc2V0TGVmdCgwKTtcclxuXHRcdCAgICB9XHJcblxyXG5cdFx0ICAgIGlmIChtaW5ZIDwgMCB8fCBtYXhZID4gY2FudmFzLm9yaWdpbmFsLmhlaWdodCkge1xyXG5cdFx0ICAgICAgICB2YXIgbGFzdFNjYWxlWSA9IHRoaXMubGFzdFNjYWxlWcKgfHwgMTtcclxuXHRcdCAgICAgICAgb2JqZWN0LnNldFNjYWxlWShsYXN0U2NhbGVZKTtcclxuXHRcdCAgICB9XHJcblxyXG5cdFx0ICAgIGlmIChtaW5ZIDwgMCkge1xyXG5cdFx0ICAgICAgICBvYmplY3Quc2V0VG9wKDApO1xyXG5cdFx0ICAgIH1cclxuXHJcblx0XHQgICAgaWYgKG9iamVjdC5nZXRXaWR0aCgpIDwgdGhpcy5taW5XaWR0aCkge1xyXG5cdFx0ICAgICAgICBvYmplY3Qud2lkdGggPSB0aGlzLm1pbldpZHRoO1xyXG5cdFx0ICAgICAgICBvYmplY3Quc2V0U2NhbGVYKDEpO1xyXG5cdFx0ICAgIH1cclxuXHJcblx0XHQgICAgaWYgKG9iamVjdC5nZXRIZWlnaHQoKSA8IHRoaXMubWluSGVpZ2h0KSB7XHJcblx0XHQgICAgICAgb2JqZWN0LmhlaWdodCA9IHRoaXMubWluSGVpZ2h0O1xyXG5cdFx0ICAgICAgIG9iamVjdC5zZXRTY2FsZVkoMSk7XHJcblx0XHQgICAgfVxyXG5cclxuXHRcdCAgICB0aGlzLmxhc3RTY2FsZVggPSBvYmplY3QuZ2V0U2NhbGVYKCk7XHJcblx0XHQgICAgdGhpcy5sYXN0U2NhbGVZID0gb2JqZWN0LmdldFNjYWxlWSgpO1xyXG5cdFx0fSxcclxuXHJcblx0XHRvbk1vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdFx0aWYgKGV2ZW50LnRhcmdldCAmJiAoZXZlbnQudGFyZ2V0Lm5hbWUgPT09ICdjcm9wem9uZScgfHwgZXZlbnQudGFyZ2V0Lm5hbWUgPT09ICdjcm9wLmdyaWQnKSkgcmV0dXJuO1xyXG5cclxuXHRcdFx0Y3JvcHpvbmUuZHJhZ2dpbmcgPSB0cnVlO1xyXG5cclxuXHRcdFx0Ly9oaWRlIGNyb3B6b25lIG9uIHNpbmdsZSBjbGljayBvbiBvdmVybGF5XHJcblx0XHRcdGNyb3B6b25lLm92ZXJsYXkudmlzaWJsZSA9IGZhbHNlO1xyXG5cdFx0XHRjcm9wem9uZS5ncmlkLnZpc2libGUgPSBmYWxzZTtcclxuXHRcdFx0Y3JvcHpvbmUucmVjdC52aXNpYmxlID0gZmFsc2U7XHJcblxyXG5cdFx0XHQvL3N0YXJ0IHBvc2l0aW9uIGZvciBkcmF3aW5nIGEgY3JvcHpvbmVcclxuXHRcdCAgICBjcm9wem9uZS5yZWN0LmxlZnQgPSBldmVudC5lLnBhZ2VYIC0gY2FudmFzLmZhYnJpYy5fb2Zmc2V0LmxlZnQ7XHJcblx0XHQgICAgY3JvcHpvbmUucmVjdC50b3AgPSBldmVudC5lLnBhZ2VZIC0gY2FudmFzLmZhYnJpYy5fb2Zmc2V0LnRvcDtcclxuXHJcblx0XHQgICAgLy9tYWtlIHN1cmUgY3JvcHpvbmUgc2NhbGUgaXMgMSBmb3IgYWNjdXJhdGUgY29vcmRpbmF0ZXNcclxuXHRcdCAgICBjcm9wem9uZS5yZWN0LnNjYWxlKDEpO1xyXG4gICAgICAgICAgICBjcm9wem9uZS5vdmVybGF5LnNjYWxlKDEpO1xyXG4gICAgICAgICAgICBjcm9wem9uZS5ncmlkLnNjYWxlKDEpO1xyXG5cdFx0ICAgIGNyb3B6b25lLm1vdXNleCA9IGV2ZW50LmUucGFnZVg7XHJcblx0XHQgICAgY3JvcHpvbmUubW91c2V5ID0gZXZlbnQuZS5wYWdlWTtcclxuXHJcblx0XHQgICAgLy9wcmV2ZW50IHNlbGVjdGlvbiBvZiBvYmplY3RzIHdoaWxlIGRyYWdnaW5nXHJcblx0XHQgICAgY2FudmFzLmZhYnJpYy5zZWxlY3Rpb24gPSBmYWxzZTtcclxuXHJcblx0XHQgICAgY3JvcHpvbmUuZHJhd092ZXJsYXkoKTtcclxuXHRcdH0sXHJcblxyXG5cdFx0b25Nb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHRcdGlmICggISBjcm9wem9uZS5kcmFnZ2luZykgcmV0dXJuO1xyXG5cclxuXHRcdFx0dmFyIHdpZHRoICA9IGV2ZW50LmUucGFnZVggLSBjcm9wem9uZS5tb3VzZXgsXHJcblx0XHRcdFx0aGVpZ2h0ID0gZXZlbnQuZS5wYWdlWSAtIGNyb3B6b25lLm1vdXNleTtcclxuXHJcblx0XHRcdC8vcHJldmVudCBjcm9wem9uZSBnb2luZyBvdmVyIHRoZSByaWdodCBlZGdlXHJcblx0XHRcdGlmIChjYW52YXMub2Zmc2V0LmxlZnQgKyBjYW52YXMub3JpZ2luYWwud2lkdGggPCBldmVudC5lLnBhZ2VYKSB7XHJcblx0XHRcdFx0d2lkdGggPSAoY2FudmFzLm9mZnNldC5sZWZ0ICsgY2FudmFzLm9yaWdpbmFsLndpZHRoKSAtIGNyb3B6b25lLm1vdXNleDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly9sZWZ0IGVkZ2VcclxuXHRcdFx0aWYgKGNhbnZhcy5vZmZzZXQubGVmdCA+IGV2ZW50LmUucGFnZVgpIHtcclxuXHRcdFx0XHR3aWR0aCA9IGNhbnZhcy5vZmZzZXQubGVmdCAtIGNyb3B6b25lLm1vdXNleDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly9ib3R0b20gZWRnZVxyXG5cdFx0XHRpZiAoY2FudmFzLm9mZnNldC50b3AgKyBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IDwgZXZlbnQuZS5wYWdlWSkge1xyXG5cdFx0XHRcdGhlaWdodCA9IChjYW52YXMub2Zmc2V0LnRvcCArIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpIC0gY3JvcHpvbmUubW91c2V5O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvL3RvcCBlZGdlXHJcblx0XHRcdGlmIChjYW52YXMub2Zmc2V0LnRvcCA+IGV2ZW50LmUucGFnZVkpIHtcclxuXHRcdFx0XHRoZWlnaHQgPSBjYW52YXMub2Zmc2V0LnRvcCAtIGNyb3B6b25lLm1vdXNleTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Y3JvcHpvbmUucmVjdC53aWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIFx0Y3JvcHpvbmUucmVjdC5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgXHRjcm9wem9uZS5yZWN0Lm1vdmVUbygzKTtcclxuICAgICAgICAgICAgY3JvcHpvbmUucmVjdC5zZXRDb29yZHMoKTtcclxuICAgICAgICBcdGNyb3B6b25lLmRyYXdPdmVybGF5KCk7XHJcblx0ICAgICAgICBjcm9wem9uZS5kcmF3R3JpZCgpO1xyXG5cclxuXHRcdFx0aWYgKCAhIGNyb3B6b25lLnJlY3QudmlzaWJsZSkge1xyXG5cdFx0XHRcdGNyb3B6b25lLnJlY3QudmlzaWJsZSA9IHRydWU7XHJcblx0XHRcdFx0Y3JvcHpvbmUub3ZlcmxheS52aXNpYmxlID0gdHJ1ZTtcclxuXHRcdFx0XHRjcm9wem9uZS5ncmlkLnZpc2libGUgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cclxuXHRcdG9uTW91c2VVcDogZnVuY3Rpb24oKSB7XHJcblx0XHQgICBcdGNyb3B6b25lLmRyYWdnaW5nID0gZmFsc2U7XHJcblx0XHQgICAgY2FudmFzLmZhYnJpYy5zZWxlY3Rpb24gPSB0cnVlO1xyXG5cdFx0ICAgIGNyb3B6b25lLnJlY3Quc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgICAgIGNyb3B6b25lLmdyaWQuc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgICAgIGNyb3B6b25lLm92ZXJsYXkuc2V0Q29vcmRzKCk7XHJcblxyXG5cdFx0ICAgIGlmIChjcm9wem9uZS5yZWN0LnZpc2libGUpIHtcclxuXHRcdCAgICBcdGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KGNyb3B6b25lLnJlY3QpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cclxuXHRcdGF0dGFjaEV2ZW50czogZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0XHQvL3JlZHJhdyBjcm9wem9uZSBncmlkIGFuZCBvdmVybGF5IHdoZW4gY3JvcHpvbmUgaXMgcmVzaXplZFxyXG5cdFx0XHR0aGlzLnJlY3Qub24oJ21vdmluZycsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGNyb3B6b25lLmNvbnN0cmFpbldpdGhpbkNhbnZhcyhjcm9wem9uZS5yZWN0KTtcclxuXHRcdFx0XHRjcm9wem9uZS5kcmF3T3ZlcmxheSgpO1xyXG5cdFx0XHRcdGNyb3B6b25lLmRyYXdHcmlkKCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5yZWN0Lm9uKCdzY2FsaW5nJywgZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGNyb3B6b25lLmNvbnN0cmFpbldpdGhpbkNhbnZhc09uU2NhbGluZyhjcm9wem9uZS5yZWN0LCBlKTtcclxuXHRcdFx0XHRjcm9wem9uZS5kcmF3T3ZlcmxheSgpO1xyXG5cdFx0XHRcdGNyb3B6b25lLmRyYXdHcmlkKCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5vbihcIm1vdXNlOmRvd25cIiwgY3JvcHpvbmUub25Nb3VzZURvd24pO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9uKFwibW91c2U6bW92ZVwiLCBjcm9wem9uZS5vbk1vdXNlTW92ZSk7XHJcblx0XHRcdGNhbnZhcy5mYWJyaWMub24oXCJtb3VzZTp1cFwiLCBjcm9wem9uZS5vbk1vdXNlVXApO1xyXG5cdFx0fSxcclxuXHJcblx0XHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9mZihcIm1vdXNlOmRvd25cIiwgY3JvcHpvbmUub25Nb3VzZURvd24pO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9mZihcIm1vdXNlOm1vdmVcIiwgY3JvcHpvbmUub25Nb3VzZU1vdmUpO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLm9mZihcIm1vdXNlOnVwXCIsIGNyb3B6b25lLm9uTW91c2VVcCk7XHJcblxyXG5cdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZSh0aGlzLnJlY3QpO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZSh0aGlzLmdyaWQpO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZSh0aGlzLm92ZXJsYXkpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG5cdFx0XHR0aGlzLmluaXRpYXRlZCA9IGZhbHNlO1xyXG5cdFx0fSxcclxuXHJcblx0XHRoaWRlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dGhpcy5yZWN0LnZpc2libGUgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5yZWN0Lmhhc0NvbnRyb2xzID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuZ3JpZC52aXNpYmxlID0gZmFsc2U7XHJcblx0XHRcdHRoaXMub3ZlcmxheS52aXNpYmxlID0gZmFsc2U7XHJcblx0XHR9LFxyXG5cclxuXHRcdGdldE9wdGltYWxEaW1lbnNpb25zOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGNhbnZhcy5vcmlnaW5hbC53aWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC8gMixcclxuICAgICAgICAgICAgICAgIGxlZnQgPSBjYW52YXMub3JpZ2luYWwud2lkdGggLyA0LFxyXG4gICAgICAgICAgICAgICAgdG9wID0gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAvIDQ7XHJcblxyXG5cdFx0XHRpZiAoY2FudmFzLnZpZXdwb3J0Lm9mZnNldFdpZHRoIDwgY2FudmFzLm9yaWdpbmFsLndpZHRoKSB7XHJcblx0XHRcdFx0d2lkdGggPSBjYW52YXMudmlld3BvcnQub2Zmc2V0V2lkdGggLyAyO1xyXG5cdFx0XHRcdGxlZnQgPSBjYW52YXMudmlld3BvcnQub2Zmc2V0V2lkdGggLyA0O1xyXG5cclxuXHRcdFx0fVxyXG5cclxuICAgICAgICAgICAgaWYgKGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgPCBjYW52YXMub3JpZ2luYWwuaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBjYW52YXMudmlld3BvcnQub2Zmc2V0SGVpZ2h0IC8gMjtcclxuICAgICAgICAgICAgICAgIHRvcCA9IGNhbnZhcy52aWV3cG9ydC5vZmZzZXRIZWlnaHQgLyA0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cdFx0XHRyZXR1cm4ge3dpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHQsIGxlZnQ6IGxlZnQsIHRvcDogdG9wfTtcclxuXHRcdH0sXHJcblxyXG5cdFx0ZHJhd01haW5ab25lOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyIGRpbWVuc2lvbnMgPSB0aGlzLmdldE9wdGltYWxEaW1lbnNpb25zKCk7XHJcblxyXG5cdFx0XHR0aGlzLnJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe1xyXG5cdFx0XHQgICAgZmlsbDogJ3RyYW5zcGFyZW50JyxcclxuXHRcdFx0ICAgIHN0cm9rZTogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC42KScsXHJcblx0XHRcdCAgICBoYXNCb3JkZXJzOiBmYWxzZSxcclxuXHRcdFx0ICAgIHdpZHRoOiBkaW1lbnNpb25zLndpZHRoLFxyXG5cdFx0XHQgICAgaGVpZ2h0OiBkaW1lbnNpb25zLmhlaWdodCxcclxuXHRcdFx0ICAgIGxlZnQ6IGRpbWVuc2lvbnMubGVmdCxcclxuXHRcdFx0ICAgIHRvcDogZGltZW5zaW9ucy50b3AsXHJcblx0XHRcdCAgICBoYXNSb3RhdGluZ1BvaW50OiBmYWxzZSxcclxuXHRcdFx0ICAgIG5hbWU6ICdjcm9wem9uZScsXHJcblx0XHRcdCAgICBjb3JuZXJDb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC42KScsXHJcblx0XHRcdCAgICB0cmFuc3BhcmVudENvcm5lcnM6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaWdub3JlOiB0cnVlXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5hZGQodGhpcy5yZWN0KTtcclxuXHRcdFx0dGhpcy5yZWN0Lm1vdmVUbygzKTtcclxuXHRcdFx0Y2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3QoY3JvcHpvbmUucmVjdCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGRyYXdHcmlkOiBmdW5jdGlvbigpIHtcclxuXHJcblx0XHRcdGlmICggISB0aGlzLmluaXRpYXRlZCkge1xyXG5cdFx0XHRcdHRoaXMubGluZTEgPSBuZXcgZmFicmljLkxpbmUoW10sIHsgc3Ryb2tlOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpJywgc3Ryb2tlV2lkdGg6IDEsIHNlbGVjdGFibGU6IGZhbHNlLCBldmVudGVkOiBmYWxzZSB9KTtcclxuXHRcdFx0XHR0aGlzLmxpbmUyID0gbmV3IGZhYnJpYy5MaW5lKFtdLCB7IHN0cm9rZTogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC42KScsIHN0cm9rZVdpZHRoOiAxLCBzZWxlY3RhYmxlOiBmYWxzZSwgZXZlbnRlZDogZmFsc2UgfSk7XHJcblx0XHRcdFx0dGhpcy5saW5lMyA9IG5ldyBmYWJyaWMuTGluZShbXSwgeyBzdHJva2U6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNiknLCBzdHJva2VXaWR0aDogMSwgc2VsZWN0YWJsZTogZmFsc2UsIGV2ZW50ZWQ6IGZhbHNlIH0pO1xyXG5cdFx0XHRcdHRoaXMubGluZTQgPSBuZXcgZmFicmljLkxpbmUoW10sIHsgc3Ryb2tlOiAncmdiYSgyNTUsIDI1NSwgMjU1LCAwLjYpJywgc3Ryb2tlV2lkdGg6IDEsIHNlbGVjdGFibGU6IGZhbHNlLCBldmVudGVkOiBmYWxzZSB9KTtcclxuXHRcdFx0XHR0aGlzLmdyaWQgPSBuZXcgZmFicmljLkdyb3VwKFt0aGlzLmxpbmUxLCB0aGlzLmxpbmUyLCB0aGlzLmxpbmUzLCB0aGlzLmxpbmU0XSk7XHJcblx0XHRcdFx0dGhpcy5ncmlkLm9yaWdpblkgPSAnbGVmdCc7XHJcblx0XHRcdFx0dGhpcy5ncmlkLm9yaWdpblggPSAndG9wJztcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZC5pZ25vcmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmlkLnNlbGVjdGFibGUgPSBmYWxzZTtcclxuXHRcdFx0XHRjYW52YXMuZmFicmljLmFkZCh0aGlzLmdyaWQpO1xyXG5cdFx0ICAgIFx0dGhpcy5ncmlkLm1vdmVUbygxMCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuZ3JpZC53aWR0aCA9IHRoaXMucmVjdC5nZXRXaWR0aCgpO1xyXG5cdFx0XHR0aGlzLmdyaWQuaGVpZ2h0ID0gdGhpcy5yZWN0LmdldEhlaWdodCgpO1xyXG5cdFx0XHR0aGlzLmdyaWQubGVmdCA9IHRoaXMucmVjdC5nZXRMZWZ0KCk7XHJcblx0XHRcdHRoaXMuZ3JpZC50b3AgPSB0aGlzLnJlY3QuZ2V0VG9wKCk7XHJcblxyXG5cdFx0XHR2YXIgd2lkdGggID0gY3JvcHpvbmUucmVjdC5nZXRXaWR0aCgpIC8gMyxcclxuXHRcdFx0XHRoZWlnaHQgPSBjcm9wem9uZS5yZWN0LmdldEhlaWdodCgpIC8gMztcclxuXHJcblx0XHRcdHRoaXMubGluZTEuc2V0KHtcclxuXHRcdFx0XHR4MTogd2lkdGgsXHJcblx0XHRcdFx0eTE6IDAsXHJcblx0XHRcdFx0eDI6IHdpZHRoLFxyXG5cdFx0XHRcdHkyOiBjcm9wem9uZS5ncmlkLmdldEhlaWdodCgpLFxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHRoaXMubGluZTIuc2V0KHtcclxuXHRcdFx0XHR4MTogd2lkdGggKiAyLFxyXG5cdFx0XHRcdHkxOiAwLFxyXG5cdFx0XHRcdHgyOiB3aWR0aCAqIDIsXHJcblx0XHRcdFx0eTI6IGNyb3B6b25lLmdyaWQuZ2V0SGVpZ2h0KClcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHR0aGlzLmxpbmUzLnNldCh7XHJcblx0XHRcdFx0eDE6IDAsXHJcblx0XHRcdFx0eTE6IGhlaWdodCxcclxuXHRcdFx0XHR4MjogY3JvcHpvbmUuZ3JpZC5nZXRXaWR0aCgpLFxyXG5cdFx0XHRcdHkyOiBoZWlnaHRcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHR0aGlzLmxpbmU0LnNldCh7XHJcblx0XHRcdFx0eDE6IDAsXHJcblx0XHRcdFx0eTE6IGhlaWdodCAqIDIsXHJcblx0XHRcdFx0eDI6IGNyb3B6b25lLmdyaWQuZ2V0V2lkdGgoKSxcclxuXHRcdFx0XHR5MjogaGVpZ2h0ICogMlxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHRoaXMuY29uc3RyYWluV2l0aGluQ2FudmFzKHRoaXMuZ3JpZCk7XHJcblx0XHR9LFxyXG5cclxuXHRcdGRyYXdPdmVybGF5OiBmdW5jdGlvbigpIHtcclxuXHJcblx0ICAgIFx0aWYgKCAhIHRoaXMuaW5pdGlhdGVkKSB7XHJcblx0ICAgIFx0XHR0aGlzLnRvcFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xyXG5cdCAgICBcdFx0dGhpcy5yaWdodFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xyXG5cdCAgICBcdFx0dGhpcy5ib3R0b21SZWN0ID0gbmV3IGZhYnJpYy5SZWN0KHtmaWxsOiAncmdiYSgwLDAsMCwwLjcpJywgc2VsZWN0YWJsZTogdHJ1ZSwgZXZlbnRlZDogZmFsc2V9KTtcclxuXHQgICAgXHRcdHRoaXMubGVmdFJlY3QgPSBuZXcgZmFicmljLlJlY3Qoe2ZpbGw6ICdyZ2JhKDAsMCwwLDAuNyknLCBzZWxlY3RhYmxlOiB0cnVlLCBldmVudGVkOiBmYWxzZX0pO1xyXG5cdCAgICBcdFx0dGhpcy5vdmVybGF5ID0gbmV3IGZhYnJpYy5Hcm91cChbdGhpcy50b3BSZWN0LCB0aGlzLnJpZ2h0UmVjdCwgdGhpcy5ib3R0b21SZWN0LCB0aGlzLmxlZnRSZWN0XSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXkuaWdub3JlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheS5uYW1lID0gJ2dyaWQub3ZlcmxheSc7XHJcblx0XHRcdFx0Y2FudmFzLmZhYnJpYy5hZGQodGhpcy5vdmVybGF5KTtcclxuXHRcdFx0XHR0aGlzLm92ZXJsYXkubW92ZVRvKDEpO1xyXG5cdCAgICBcdH1cclxuXHJcbiAgICBcdFx0dGhpcy50b3BSZWN0LnNldCh7XHJcblx0ICAgIFx0XHRsZWZ0OiAwLFxyXG5cdFx0XHRcdHRvcDogMCxcclxuXHRcdFx0XHR3aWR0aDogY2FudmFzLm9yaWdpbmFsLndpZHRoLFxyXG5cdFx0XHRcdGhlaWdodDogdGhpcy5yZWN0LmdldEhlaWdodCgpIDwgMCA/IHRoaXMucmVjdC5nZXRUb3AoKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRIZWlnaHQoKSkgOiB0aGlzLnJlY3QuZ2V0VG9wKCksXHJcblx0ICAgIFx0fSk7XHJcblxyXG5cdCAgICBcdHRoaXMucmlnaHRSZWN0LnNldCh7XHJcblx0ICAgIFx0XHRsZWZ0OiB0aGlzLnJlY3QuZ2V0V2lkdGgoKSA8IDAgPyB0aGlzLnJlY3QuZ2V0TGVmdCgpIDogdGhpcy5yZWN0LmdldExlZnQoKSArIHRoaXMucmVjdC5nZXRXaWR0aCgpLFxyXG5cdFx0XHRcdHRvcDogdGhpcy5yZWN0LmdldFRvcCgpLFxyXG5cdFx0XHRcdHdpZHRoOiB0aGlzLnJlY3QuZ2V0V2lkdGgoKSA8IDAgPyBjYW52YXMub3JpZ2luYWwud2lkdGggLSAodGhpcy5yZWN0LmdldExlZnQoKSArIHRoaXMucmVjdC5nZXRXaWR0aCgpKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRXaWR0aCgpKSA6IGNhbnZhcy5vcmlnaW5hbC53aWR0aCAtICh0aGlzLnJlY3QuZ2V0TGVmdCgpICsgdGhpcy5yZWN0LmdldFdpZHRoKCkpLFxyXG5cdFx0XHRcdGhlaWdodDogdGhpcy5yZWN0LmdldEhlaWdodCgpLFxyXG5cdCAgICBcdH0pO1xyXG5cclxuXHQgICAgXHR0aGlzLmJvdHRvbVJlY3Quc2V0KHtcclxuXHQgICAgXHRcdGxlZnQ6IDAsXHJcblx0XHRcdFx0dG9wOiB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkgPCAwID8gdGhpcy5yZWN0LmdldFRvcCgpIDogdGhpcy5yZWN0LmdldFRvcCgpICsgdGhpcy5yZWN0LmdldEhlaWdodCgpLFxyXG5cdFx0XHRcdHdpZHRoOiBjYW52YXMub3JpZ2luYWwud2lkdGgsXHJcblx0XHRcdFx0aGVpZ2h0OiB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkgPCAwID8gY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtICh0aGlzLnJlY3QuZ2V0VG9wKCkpIDogY2FudmFzLm9yaWdpbmFsLmhlaWdodCAtICh0aGlzLnJlY3QuZ2V0VG9wKCkgKyB0aGlzLnJlY3QuZ2V0SGVpZ2h0KCkpLFxyXG5cdCAgICBcdH0pO1xyXG5cclxuXHQgICAgXHR0aGlzLmxlZnRSZWN0LnNldCh7XHJcblx0ICAgIFx0XHRsZWZ0OiAwLFxyXG5cdFx0XHRcdHRvcDogdGhpcy5yZWN0LmdldFRvcCgpLFxyXG5cdFx0XHRcdHdpZHRoOiB0aGlzLnJlY3QuZ2V0V2lkdGgoKSA+IDAgPyB0aGlzLnJlY3QuZ2V0TGVmdCgpIDogdGhpcy5yZWN0LmdldExlZnQoKSAtIE1hdGguYWJzKHRoaXMucmVjdC5nZXRXaWR0aCgpKSxcclxuXHRcdFx0XHRoZWlnaHQ6IHRoaXMucmVjdC5nZXRIZWlnaHQoKSxcclxuXHQgICAgXHR9KTtcclxuXHJcblxyXG5cdCAgICB9XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIGNyb3B6b25lO1xyXG5cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5jcm9wJylcclxuXHJcbi5jb250cm9sbGVyKCdDcm9wQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY3JvcHBlcicsICdjcm9wem9uZScsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY3JvcHBlciwgY3JvcHpvbmUpIHtcclxuXHJcblx0JHNjb3BlLmNyb3BwZXIgPSBjcm9wcGVyO1xyXG5cdCRzY29wZS5jcm9wem9uZSA9IGNyb3B6b25lO1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCd0YWIuY2hhbmdlZCcsIGZ1bmN0aW9uKGUsIG5ld1RhYiwgb2xkVGFiKSB7XHJcbiAgICAgICBpZiAob2xkVGFiID09PSAnYmFzaWNzJyAmJiBuZXdUYWIgIT09ICdiYXNpY3MnKSB7XHJcbiAgICAgICAgICAgY3JvcHBlci5zdG9wKCk7XHJcbiAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAkcm9vdFNjb3BlLiR3YXRjaCgnYWN0aXZlUGFuZWwnLCBmdW5jdGlvbihuZXdQYW5lbCwgb2xkUGFuZWwpIHtcclxuICAgICAgICBpZiAobmV3UGFuZWwgIT09ICdjcm9wJyAmJiBvbGRQYW5lbCA9PT0gJ2Nyb3AnKSB7XHJcbiAgICAgICAgICAgIGNyb3B6b25lLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHQkcm9vdFNjb3BlLiRvbignY3JvcHpvbmUuYWRkZWQnLCBmdW5jdGlvbigpIHtcclxuXHRcdCRzY29wZS53aWR0aCA9IE1hdGgucm91bmQoY3JvcHpvbmUucmVjdC53aWR0aCk7XHJcblx0XHQkc2NvcGUuaGVpZ2h0ID0gTWF0aC5yb3VuZChjcm9wem9uZS5yZWN0LmhlaWdodCk7XHJcblx0fSk7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuYmFzaWNzJywgW10pXHJcblxyXG4uY29udHJvbGxlcignUm90YXRlQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIGNhbnZhcywgaGlzdG9yeSkge1xyXG5cclxuICAgICAgICAkc2NvcGUuYW5nbGUgPSAwO1xyXG5cclxuICAgICAgICAkc2NvcGUuc3RhcnRSb3RhdG9yID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdyb3RhdGUtb3JpZ2luYWwtc3RhdGUnLCAnYmFja3VwJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICRzY29wZS5vcGVuUGFuZWwoJ3JvdGF0ZScsICRldmVudCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmFwcGx5Um90YXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBoaXN0b3J5LmFkZCgncm90YXRpb24nLCAncm90YXRlLXJpZ2h0Jyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBoaXN0b3J5LmxvYWQoJ3JvdGF0ZS1vcmlnaW5hbC1zdGF0ZScpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5hbmdsZSA9IDA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9yb3RhdGUgcHJvcGVybHkgYnkgc2NhbGluZyBjYW52YXMgdG8gbmV3IGhlaWdodCBhZnRlciByb3RhdGluZyBtYWluIGltYWdlIGJ5IDkwIGRlZ3JlZXNcclxuICAgICAgICAkc2NvcGUucm90YXRlUHJvcGVyID0gZnVuY3Rpb24ob3JpZ2luYWxBbmdsZSkge1xyXG4gICAgICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuICAgICAgICAgICAgdmFyIGFuZ2xlID0gKGNhbnZhcy5tYWluSW1hZ2UuZ2V0QW5nbGUoKSArIG9yaWdpbmFsQW5nbGUpICUgMzYwO1xyXG5cclxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IE1hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0V2lkdGgoKSooTWF0aC5zaW4oYW5nbGUqTWF0aC5QSS8xODApKSkrTWF0aC5hYnMoY2FudmFzLm1haW5JbWFnZS5nZXRIZWlnaHQoKSooTWF0aC5jb3MoYW5nbGUqTWF0aC5QSS8xODApKSksXHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IE1hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0SGVpZ2h0KCkqKE1hdGguc2luKGFuZ2xlKk1hdGguUEkvMTgwKSkpK01hdGguYWJzKGNhbnZhcy5tYWluSW1hZ2UuZ2V0V2lkdGgoKSooTWF0aC5jb3MoYW5nbGUqTWF0aC5QSS8xODApKSk7XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnNldFdpZHRoKHdpZHRoICogY2FudmFzLmN1cnJlbnRab29tKTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRIZWlnaHQoaGVpZ2h0ICogY2FudmFzLmN1cnJlbnRab29tKTtcclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoICA9IHdpZHRoO1xyXG4gICAgICAgICAgICBjYW52YXMubWFpbkltYWdlLmNlbnRlcigpO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgb2JqLnJvdGF0ZSgob2JqLmdldEFuZ2xlKCkgKyBvcmlnaW5hbEFuZ2xlKSAlIDM2MCk7XHJcbiAgICAgICAgICAgICAgICBvYmouc2V0Q29vcmRzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS5lZGl0b3JDdXN0b21BY3Rpb25zLnJvdGF0ZSA9IG9yaWdpbmFsQW5nbGU7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vb25seSByb3RhdGUgdGhlIG9iamVjdHMgb2YgY2FudmFzIHdoaWxlIGxlYXZpbmcgY2FudmFzIHdpZHRoL2hlaWdodCBpbnRhY3RcclxuICAgICAgICAkc2NvcGUucm90YXRlID0gZnVuY3Rpb24oYW5nbGUsIGRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoYW5nbGUgPiAzNjAgfHwgYW5nbGUgPCAwKSByZXR1cm47XHJcbiAgICAgICAgICAgIHZhciByZXNldE9yaWdpbiA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gJiYgZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbmdsZSA9IG9iai5nZXRBbmdsZSgpIC0gOTA7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiAmJiBkaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbmdsZSA9IG9iai5nZXRBbmdsZSgpICsgOTA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKChvYmoub3JpZ2luWCAhPT0gJ2NlbnRlcicgfHwgb2JqLm9yaWdpblkgIT09ICdjZW50ZXInKSAmJiBvYmouY2VudGVyZWRSb3RhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRPcmlnaW5Ub0NlbnRlciAmJiAkc2NvcGUuc2V0T3JpZ2luVG9DZW50ZXIob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNldE9yaWdpbiA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYW5nbGUgPSBhbmdsZSA+IDM2MCA/IDkwIDogYW5nbGUgPCAwID8gMjcwIDogYW5nbGU7XHJcblxyXG4gICAgICAgICAgICAgICAgb2JqLnNldEFuZ2xlKGFuZ2xlKS5zZXRDb29yZHMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmVzZXRPcmlnaW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0Q2VudGVyVG9PcmlnaW4gJiYgJHNjb3BlLnNldENlbnRlclRvT3JpZ2luKG9iaik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNldE9yaWdpblRvQ2VudGVyID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgICAgICBvYmouX29yaWdpbmFsT3JpZ2luWCA9IG9iai5vcmlnaW5YO1xyXG4gICAgICAgICAgICBvYmouX29yaWdpbmFsT3JpZ2luWSA9IG9iai5vcmlnaW5ZO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNlbnRlciA9IG9iai5nZXRDZW50ZXJQb2ludCgpO1xyXG5cclxuICAgICAgICAgICAgb2JqLnNldCh7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW5YOiAnY2VudGVyJyxcclxuICAgICAgICAgICAgICAgIG9yaWdpblk6ICdjZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogY2VudGVyLngsXHJcbiAgICAgICAgICAgICAgICB0b3A6IGNlbnRlci55XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5zZXRDZW50ZXJUb09yaWdpbiA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgICAgICAgICAgdmFyIG9yaWdpblBvaW50ID0gb2JqLnRyYW5zbGF0ZVRvT3JpZ2luUG9pbnQoXHJcbiAgICAgICAgICAgICAgICBvYmouZ2V0Q2VudGVyUG9pbnQoKSxcclxuICAgICAgICAgICAgICAgIG9iai5fb3JpZ2luYWxPcmlnaW5YLFxyXG4gICAgICAgICAgICAgICAgb2JqLl9vcmlnaW5hbE9yaWdpblkpO1xyXG5cclxuICAgICAgICAgICAgb2JqLnNldCh7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW5YOiBvYmouX29yaWdpbmFsT3JpZ2luWCxcclxuICAgICAgICAgICAgICAgIG9yaWdpblk6IG9iai5fb3JpZ2luYWxPcmlnaW5ZLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogb3JpZ2luUG9pbnQueCxcclxuICAgICAgICAgICAgICAgIHRvcDogb3JpZ2luUG9pbnQueVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmJhc2ljcycpXHJcblxyXG4uY29udHJvbGxlcignQ2FudmFzQmFja2dyb3VuZENvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdoaXN0b3J5JywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIGhpc3RvcnkpIHtcclxuXHJcbiAgICAkc2NvcGUuc2V0QmFja2dyb3VuZCA9IGZ1bmN0aW9uKGNvbG9yKSB7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoY29sb3IpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5hcHBseSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcclxuICAgICAgICBoaXN0b3J5LmFkZCgnQ2FudmFzIENvbG9yJywgJ2Zvcm1hdC1jb2xvci1maWxsJyk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRCYWNrZ3JvdW5kQ29sb3IoJycpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmJhc2ljcycpXHJcblxyXG4uY29udHJvbGxlcignUmVzaXplQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsIGNhbnZhcywgaGlzdG9yeSkge1xyXG5cclxuICAgICRzY29wZS5jb25zdHJhaW5Qcm9wb3J0aW9ucyA9IHRydWU7XHJcblxyXG4gICAgJHNjb3BlLnBlcmNlbnQgPSAxMDA7XHJcblxyXG4gICAgJHNjb3BlLnN0YXJ0UmVzaXplciA9IGZ1bmN0aW9uKCRldmVudCkge1xyXG4gICAgICAgICRzY29wZS53aWR0aCAgPSAkc2NvcGUudXNlUGVyY2VudGFnZXMgPyAxMDAgOiBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLndpZHRoKTtcclxuICAgICAgICAkc2NvcGUuaGVpZ2h0ID0gJHNjb3BlLnVzZVBlcmNlbnRhZ2VzID8gMTAwIDogTWF0aC5jZWlsKGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpO1xyXG4gICAgICAgIGhpc3RvcnkuYWRkKCdiZWZvcmVSZXNpemUnLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgY2FudmFzLnpvb20oMSk7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5QYW5lbCgncmVzaXplJywgJGV2ZW50KTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUb2dnbGUgcmVzaXppbmcgbW9kZSBiZXR3ZWVuIHBlcmNlbnRhZ2VzIGFuZCBwaXhsZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSB1c2VQZXJjZW50YWdlc1xyXG4gICAgICovXHJcbiAgICAkc2NvcGUudG9nZ2xlUGVyY2VudGFnZXMgPSBmdW5jdGlvbih1c2VQZXJjZW50YWdlcykge1xyXG4gICAgICAgIGlmICh1c2VQZXJjZW50YWdlcykge1xyXG4gICAgICAgICAgICAkc2NvcGUud2lkdGggPSAoJHNjb3BlLndpZHRoIC8gY2FudmFzLm9yaWdpbmFsLndpZHRoKSAqIDEwMDtcclxuICAgICAgICAgICAgJHNjb3BlLmhlaWdodCA9ICgkc2NvcGUuaGVpZ2h0IC8gY2FudmFzLm9yaWdpbmFsLmhlaWdodCkgKiAxMDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJHNjb3BlLndpZHRoID0gKCRzY29wZS53aWR0aCAqIGNhbnZhcy5vcmlnaW5hbC53aWR0aCkgLyAxMDA7XHJcbiAgICAgICAgICAgICRzY29wZS5oZWlnaHQgPSAoJHNjb3BlLmhlaWdodCAqIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpIC8gMTAwO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmFwcGx5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRXaWR0aCAgPSBNYXRoLmNlaWwoY2FudmFzLm9yaWdpbmFsLndpZHRoKSxcclxuICAgICAgICAgICAgY3VycmVudEhlaWdodCA9IE1hdGguY2VpbChjYW52YXMub3JpZ2luYWwuaGVpZ2h0KSxcclxuICAgICAgICAgICAgbmV3V2lkdGggICAgICA9IE1hdGguY2VpbCgkc2NvcGUud2lkdGgpLFxyXG4gICAgICAgICAgICBuZXdIZWlnaHQgICAgID0gTWF0aC5jZWlsKCRzY29wZS5oZWlnaHQpO1xyXG5cclxuICAgICAgICBpZiAoJHNjb3BlLnVzZVBlcmNlbnRhZ2VzKSB7XHJcbiAgICAgICAgICAgIHZhciB3aWR0aFNjYWxlICAgID0gJHNjb3BlLndpZHRoIC8gMTAwO1xyXG4gICAgICAgICAgICB2YXIgaGVpZ2h0U2NhbGUgICA9ICRzY29wZS5oZWlnaHQgLyAxMDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHdpZHRoU2NhbGUgICAgPSAkc2NvcGUud2lkdGggLyBjYW52YXMub3JpZ2luYWwud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBoZWlnaHRTY2FsZSAgID0gJHNjb3BlLmhlaWdodCAvIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY3VycmVudFdpZHRoID09PSBuZXdXaWR0aCAmJiBjdXJyZW50SGVpZ2h0ID09PSBuZXdIZWlnaHQpIHJldHVybjtcclxuXHJcbiAgICAgICAgcmVzaXplKHdpZHRoU2NhbGUsIGhlaWdodFNjYWxlKTtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIGhpc3RvcnkuYWRkKCdyZXNpemUnLCAnb3Blbi13aWR0aCcpO1xyXG4gICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcbiAgICAgICAgY2FudmFzLmZpdFRvU2NyZWVuKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5hc3BlY3RUb0hlaWdodCA9IGZ1bmN0aW9uKG5ld1dpZHRoKSB7XHJcbiAgICAgICAgaWYgKCAhICRzY29wZS5jb25zdHJhaW5Qcm9wb3J0aW9ucykgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoJHNjb3BlLnVzZVBlcmNlbnRhZ2VzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5oZWlnaHQgPSBuZXdXaWR0aDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgd1JhdGlvID0gcGFyc2VGbG9hdCgoY2FudmFzLm9yaWdpbmFsLndpZHRoIC8gbmV3V2lkdGgpLnRvUHJlY2lzaW9uKDMpKTtcclxuICAgICAgICAgICAgJHNjb3BlLmhlaWdodCA9IE1hdGguY2VpbChjYW52YXMub3JpZ2luYWwuaGVpZ2h0IC8gd1JhdGlvKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5hc3BlY3RUb1dpZHRoID0gZnVuY3Rpb24obmV3SGVpZ2h0KSB7XHJcbiAgICAgICAgaWYgKCAhICRzY29wZS5jb25zdHJhaW5Qcm9wb3J0aW9ucykgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoJHNjb3BlLnVzZVBlcmNlbnRhZ2VzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS53aWR0aCA9IG5ld0hlaWdodDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgaFJhdGlvID0gcGFyc2VGbG9hdCgoY2FudmFzLm9yaWdpbmFsLmhlaWdodCAvIG5ld0hlaWdodCkudG9QcmVjaXNpb24oMykpO1xyXG4gICAgICAgICAgICAkc2NvcGUud2lkdGggPSBNYXRoLmZsb29yKGNhbnZhcy5vcmlnaW5hbC53aWR0aCAvIGhSYXRpbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiByZXNpemUod2lkdGhTY2FsZSwgaGVpZ2h0U2NhbGUpIHtcclxuICAgICAgICB2YXIgbmV3SGVpZ2h0ID0gTWF0aC5yb3VuZChjYW52YXMub3JpZ2luYWwuaGVpZ2h0ICogaGVpZ2h0U2NhbGUpLFxyXG4gICAgICAgICAgICBuZXdXaWR0aCAgPSBNYXRoLnJvdW5kKGNhbnZhcy5vcmlnaW5hbC53aWR0aCAqIHdpZHRoU2NhbGUpO1xyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLnNldEhlaWdodChuZXdIZWlnaHQpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0V2lkdGgobmV3V2lkdGgpO1xyXG4gICAgICAgIGNhbnZhcy5vcmlnaW5hbC53aWR0aCA9IG5ld1dpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgPSBuZXdIZWlnaHQ7XHJcblxyXG4gICAgICAgIHZhciBvYmplY3RzID0gY2FudmFzLmZhYnJpYy5nZXRPYmplY3RzKCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBvYmplY3RzKSB7XHJcbiAgICAgICAgICAgIHZhciBzY2FsZVggPSBvYmplY3RzW2ldLnNjYWxlWDtcclxuICAgICAgICAgICAgdmFyIHNjYWxlWSA9IG9iamVjdHNbaV0uc2NhbGVZO1xyXG4gICAgICAgICAgICB2YXIgbGVmdCA9IG9iamVjdHNbaV0ubGVmdDtcclxuICAgICAgICAgICAgdmFyIHRvcCA9IG9iamVjdHNbaV0udG9wO1xyXG5cclxuICAgICAgICAgICAgdmFyIHRlbXBTY2FsZVggPSBzY2FsZVggKiB3aWR0aFNjYWxlO1xyXG4gICAgICAgICAgICB2YXIgdGVtcFNjYWxlWSA9IHNjYWxlWSAqIGhlaWdodFNjYWxlO1xyXG4gICAgICAgICAgICB2YXIgdGVtcExlZnQgPSBsZWZ0ICogd2lkdGhTY2FsZTtcclxuICAgICAgICAgICAgdmFyIHRlbXBUb3AgPSB0b3AgKiBoZWlnaHRTY2FsZTtcclxuXHJcbiAgICAgICAgICAgIG9iamVjdHNbaV0uc2NhbGVYID0gdGVtcFNjYWxlWDtcclxuICAgICAgICAgICAgb2JqZWN0c1tpXS5zY2FsZVkgPSB0ZW1wU2NhbGVZO1xyXG4gICAgICAgICAgICBvYmplY3RzW2ldLmxlZnQgPSB0ZW1wTGVmdDtcclxuICAgICAgICAgICAgb2JqZWN0c1tpXS50b3AgPSB0ZW1wVG9wO1xyXG5cclxuICAgICAgICAgICAgb2JqZWN0c1tpXS5zZXRDb29yZHMoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuYmFzaWNzJylcclxuXHJcbi5jb250cm9sbGVyKCdSb3VuZGVkQ29ybmVyc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJ2NhbnZhcycsICdoaXN0b3J5JywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIGhpc3RvcnkpIHtcclxuXHJcbiAgICAkc2NvcGUucmFkaXVzID0gNTA7XHJcblxyXG4gICAgJHNjb3BlLnN0YXJ0Um91bmRlZENvcm5lcnMgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPT09ICdyb3VuZCcpIHJldHVybjtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS5vcGVuUGFuZWwoJ3JvdW5kJywgZSk7XHJcblxyXG4gICAgICAgICRzY29wZS5yZWN0ID0gbmV3IGZhYnJpYy5SZWN0KHtcclxuICAgICAgICAgICAgd2lkdGg6IGNhbnZhcy5vcmlnaW5hbC53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0LFxyXG4gICAgICAgICAgICByeDogJHNjb3BlLnJhZGl1cyxcclxuICAgICAgICAgICAgcnk6ICRzY29wZS5yYWRpdXMsXHJcbiAgICAgICAgICAgIG9wYWNpdHk6IDEsXHJcbiAgICAgICAgICAgIGZpbGw6ICd0cmFuc3BhcmVudCcsXHJcbiAgICAgICAgICAgIG5hbWU6ICdyb3VuZGluZy1yZWN0JyxcclxuICAgICAgICAgICAgc3Ryb2tlOiAnI2ZmZicsXHJcbiAgICAgICAgICAgIHN0cm9rZURhc2hBcnJheTogWzUsIDVdLFxyXG4gICAgICAgICAgICBzZWxlY3RhYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgZXZlbnRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGlnbm9yZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLmFkZCgkc2NvcGUucmVjdCk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmFkanVzdFByZXZpZXcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoICEgJHNjb3BlLnJlY3QpIHJldHVybjtcclxuXHJcbiAgICAgICAgJHNjb3BlLnJlY3Quc2V0KHtcclxuICAgICAgICAgICAgcng6ICRzY29wZS5yYWRpdXMsIHJ5OiAkc2NvcGUucmFkaXVzXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKGxlYXZlUGFuZWwpIHtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbW92ZSgkc2NvcGUucmVjdCk7XHJcbiAgICAgICAgJHNjb3BlLnJlY3QgID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLnJhZGl1cyA9IDUwO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgIGlmICggIWxlYXZlUGFuZWwpIHtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmFwcGx5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHJvb3RTY29wZS5lZGl0b3JDdXN0b21BY3Rpb25zLnJvdW5kQ29ybmVycyA9IGFuZ3VsYXIuY29weSgkc2NvcGUucmFkaXVzKTtcclxuXHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW1vdmUoJHNjb3BlLnJlY3QpO1xyXG4gICAgICAgIGNhbnZhcy56b29tKDEpO1xyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLmNsaXBUbyA9IGZ1bmN0aW9uKGN0eCkge1xyXG4gICAgICAgICAgICAkc2NvcGUucmVjdC5yZW5kZXIoY3R4KTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGlwVG8gPSBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkYXRhID0gY2FudmFzLmZhYnJpYy50b0RhdGFVUkwoKTsgLy9jYW52YXMuZ2V0RGF0YVVSTCgpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsKCk7XHJcblxyXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKGRhdGEsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdSb3VuZCBDb3JuZXJzJywgJ3Bhbm9yYW1hLXdpZGUtYW5nbGUnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCd0YWIuY2hhbmdlZCcsIGZ1bmN0aW9uKGUsIG5ld1RhYiwgb2xkVGFiKSB7XHJcbiAgICAgICAgaWYgKG9sZFRhYiA9PT0gJ2Jhc2ljcycgJiYgJHNjb3BlLnJlY3QgJiYgbmV3VGFiICE9PSAnYmFzaWNzJykge1xyXG4gICAgICAgICAgICAkc2NvcGUuY2FuY2VsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJHJvb3RTY29wZS4kd2F0Y2goJ2FjdGl2ZVBhbmVsJywgZnVuY3Rpb24obmV3UGFuZWwsIG9sZFBhbmVsKSB7XHJcbiAgICAgICAgaWYgKG5ld1BhbmVsICE9PSAncm91bmQnICYmIG9sZFBhbmVsID09PSAncm91bmQnKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jYW5jZWwodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnSW1hZ2VFZGl0b3InKVxyXG5cclxuLmNvbnRyb2xsZXIoJ1pvb21Db250cm9sbGVyJywgWyckcm9vdFNjb3BlJywgJyRzY29wZScsICdjYW52YXMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIGNhbnZhcykge1xyXG5cclxuICAgICRzY29wZS5jYW52YXMgPSBjYW52YXM7XHJcbiAgICAkc2NvcGUuem9vbSA9IDE7XHJcbiAgICAkc2NvcGUubWF4U2NhbGUgPSAyMDA7XHJcbiAgICAkc2NvcGUubWluU2NhbGUgPSAzMDtcclxuXHJcbiAgICAkcm9vdFNjb3BlLiRvbignZWRpdG9yLm1haW5JbWFnZS5sb2FkZWQnLCBmdW5jdGlvbigpIHsgJHNjb3BlLmZpdFRvU2NyZWVuKCkgfSk7XHJcbiAgICAkcm9vdFNjb3BlLiRvbignY2FudmFzLm9wZW5lZE5ldycsIGZ1bmN0aW9uKCkgeyAkc2NvcGUuZml0VG9TY3JlZW4oKSB9KTtcclxuXHJcbiAgICAkc2NvcGUuJHdhdGNoKCdjYW52YXMuY3VycmVudFpvb20nLCBmdW5jdGlvbihuZXdWYWx1ZSkge1xyXG4gICAgICAgIHZhciBjYW52YXNab29tID0gbmV3VmFsdWUgKiAxMDA7XHJcblxyXG4gICAgICAgIGlmIChjYW52YXNab29tICE9PSAkc2NvcGUuem9vbSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuem9vbSA9IGNhbnZhc1pvb207XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLmZpdFRvU2NyZWVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRzY29wZS56b29tID0gY2FudmFzLmN1cnJlbnRab29tICogMTAwO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICBpZiAoY2FudmFzLm1haW5JbWFnZSkge1xyXG4gICAgICAgICAgICB2YXIgb1dpZHRoID0gY2FudmFzLm1haW5JbWFnZS5vcmlnaW5hbFN0YXRlLndpZHRoLFxyXG4gICAgICAgICAgICAgICAgb0hlaWdodCA9IGNhbnZhcy5tYWluSW1hZ2Uub3JpZ2luYWxTdGF0ZS5oZWlnaHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIG9XaWR0aCA9IGNhbnZhcy5vcmlnaW5hbC53aWR0aCxcclxuICAgICAgICAgICAgICAgIG9IZWlnaHQgPSBjYW52YXMub3JpZ2luYWwuaGVpZ2h0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG1heFNjYWxlID0gTWF0aC5taW4oMzU4MiAvIG9IZWlnaHQsIDU3MzEgLyBvV2lkdGgpICogMTAwLFxyXG4gICAgICAgICAgICBtaW5TY2FsZSA9IE1hdGgubWluKDE0MSAvIG9IZWlnaHQsIDIxMSAvIG9XaWR0aCkgKiAxMDA7XHJcblxyXG4gICAgICAgICRzY29wZS5tYXhTY2FsZSA9IE1hdGguY2VpbChtYXhTY2FsZSk7XHJcbiAgICAgICAgJHNjb3BlLm1pblNjYWxlID0gTWF0aC5jZWlsKG1pblNjYWxlKTtcclxuXHJcbiAgICAgICAgY2FudmFzLnpvb20oY2FudmFzLmN1cnJlbnRab29tKTtcclxuICAgIH07XHJcblxyXG4gICAgLy9tYWtlIHN1cmUgd2UgYWRqdXN0IHpvb20gc2xpZGVyIHByb3Blcmx5IG9uIGhpc3RvcnkgY2hhbmdlXHJcbiAgICAkcm9vdFNjb3BlLiRvbignaGlzdG9yeS5sb2FkZWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkc2NvcGUuem9vbSA9IGNhbnZhcy5jdXJyZW50U2NhbGUgKiAxMDA7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUuZG9ab29tID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNhbnZhcy56b29tKCRzY29wZS56b29tIC8gMTAwKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmdldEN1cnJlbnRab29tID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoY2FudmFzLmN1cnJlbnRab29tICogMTAwKTtcclxuICAgIH07XHJcbn1dKTtcclxuXHJcblxyXG5cclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5jb250cm9sbGVyKCdUb3BQYW5lbENvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRtZERpYWxvZycsICckbWRUb2FzdCcsICckJHJBRicsICckdGltZW91dCcsICckd2luZG93JywgJ2NhbnZhcycsICdoaXN0b3J5JywgJ3NhdmVyJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkbWREaWFsb2csICRtZFRvYXN0LCAkJHJBRiwgJHRpbWVvdXQsICR3aW5kb3csIGNhbnZhcywgaGlzdG9yeSwgc2F2ZXIpIHtcclxuXHJcbiAgICAkc2NvcGUuaGlzdG9yeSA9IGhpc3Rvcnk7XHJcblxyXG4gICAgJHNjb3BlLmlzRGVtbyA9ICRyb290U2NvcGUuaXNEZW1vO1xyXG4gICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgJHNjb3BlLmNhbnZhcyA9IGNhbnZhcztcclxuICAgICRzY29wZS5vcGVuSW1hZ2VNb2RlID0gJ29wZW4nO1xyXG5cclxuICAgICRzY29wZS5jYW52YXNXaWR0aCA9IDgwMDtcclxuICAgICRzY29wZS5jYW52YXNIZWlnaHQgPSA2MDA7XHJcblxyXG4gICAgJHNjb3BlLmltYWdlTmFtZSA9ICdpbWFnZSc7XHJcbiAgICAkc2NvcGUuaW1hZ2VUeXBlID0gJ2pwZWcnO1xyXG4gICAgJHNjb3BlLmltYWdlUXVhbGl0eSA9IDg7XHJcbiAgICB2YXIgcGFyYW1zID0gbG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKS5zcGxpdCgnJicpO1xyXG4gICAgdmFyIHZhbHVlcyA9IHt9O1xyXG4gICAgZm9yKHZhciBpZCBpbiBwYXJhbXMpe1xyXG4gICAgICAgIHZhciBrZXlfdmFsdWUgPSBwYXJhbXNbaWRdLnNwbGl0KCc9Jyk7XHJcbiAgICAgICAgdmFsdWVzW2tleV92YWx1ZVswXV0gPSBrZXlfdmFsdWVbMV07XHJcbiAgICB9XHJcbiAgICB2YXIgb3JkZXJfaWQgPXZhbHVlc1snb3JkZXJfaWQnXTtcclxuICAgIHZhciBwcm9kdWN0X2lkID0gdmFsdWVzWydwcm9kdWN0X2lkJ107XHJcbiAgICAkc2NvcGUuaW1hZ2VOYW1lID0gb3JkZXJfaWQgKyBcIi1cIiArIHByb2R1Y3RfaWQ7XHJcblxyXG4gICAgalF1ZXJ5LmdldEpTT04oXCIvd3AtY29udGVudC91cGxvYWRzL3dpbmVzaG9wLWxhYmVscy9cIiskc2NvcGUuaW1hZ2VOYW1lK1wiLmpzb25cIixmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAkc2NvcGUuaGlzdG9yeSA9IGRhdGE7XHJcbiAgICAgICAgJHJvb3RTY29wZS5oaXN0b3J5ID0gZGF0YTtcclxuICAgICAgICBoaXN0b3J5LmxvYWQoZGF0YSk7XHJcbiAgICB9KVxyXG5cclxuICAgICRzY29wZS5vYmplY3RzUGFuZWxPcGVuID0gdHJ1ZTtcclxuICAgICRzY29wZS5oaXN0b3J5UGFuZWxPcGVuID0gZmFsc2U7XHJcblxyXG4gICAgJHNjb3BlLm9wZW5VcGxvYWREaWFsb2cgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAkKCcjbWFpbi1pbWFnZS11cGxvYWQtZGlhbG9nLXRlbXBsYXRlJykuaHRtbCgpLFxyXG4gICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVG9wUGFuZWxDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRvZ2dsZVJpZ2h0UGFuZWwgPSBmdW5jdGlvbihuYW1lLCBlKSB7XHJcbiAgICAgICAgdmFyIHBhbmVsSXNPcGVuID0gJHNjb3BlW25hbWUrJ1BhbmVsT3BlbiddO1xyXG5cclxuICAgICAgICBpZiAocGFuZWxJc09wZW4pIHtcclxuICAgICAgICAgICAgJHNjb3BlW25hbWUrJ1BhbmVsT3BlbiddID0gZmFsc2U7XHJcbiAgICAgICAgICAgICQoJyMnK25hbWUpLmhpZGUoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkc2NvcGVbbmFtZSsnUGFuZWxPcGVuJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAkKCcjJytuYW1lKS5zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUudHJhbnNmb3JtT3BlbiA9IGZ1bmN0aW9uKG5hbWUsIGUpIHtcclxuICAgICAgICB2YXIgcGFuZWwgPSAkKCcjJytuYW1lKTtcclxuXHJcbiAgICAgICAgcGFuZWwucmVtb3ZlQ2xhc3MoJ3RyYW5zaXRpb24tb3V0IHRyYW5zaXRpb24taW4nKS5zaG93KCk7XHJcbiAgICAgICAgJHNjb3BlLnRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50KHBhbmVsLCBlKTtcclxuXHJcbiAgICAgICAgJCRyQUYoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHBhbmVsLmFkZENsYXNzKCd0cmFuc2l0aW9uLWluJykuY3NzKCd0cmFuc2Zvcm0nLCAnJyk7XHJcbiAgICAgICAgICAgIGUuY3VycmVudFRhcmdldC5ibHVyKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50cmFuc2Zvcm1DbG9zZSA9IGZ1bmN0aW9uKG5hbWUsIGUpIHtcclxuICAgICAgICB2YXIgcGFuZWwgPSAkKCcjJytuYW1lKTtcclxuXHJcbiAgICAgICAgcGFuZWwuYWRkQ2xhc3MoJ3RyYW5zaXRpb24tb3V0JykucmVtb3ZlQ2xhc3MoJ3RyYW5zaXRpb24taW4nKTtcclxuICAgICAgICAkc2NvcGUudHJhbnNmb3JtVG9DbGlja0VsZW1lbnQocGFuZWwsIGUpO1xyXG5cclxuICAgICAgICBwYW5lbC5vbmUoJHJvb3RTY29wZS50cmFuc2l0aW9uRW5kRXZlbnQsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBwYW5lbC5oaWRlKCkuY3NzKCd0cmFuc2Zvcm0nLCAnJykucmVtb3ZlQ2xhc3MoJ3RyYW5zaXRpb24tb3V0Jyk7XHJcbiAgICAgICAgICAgIGUuY3VycmVudFRhcmdldC5ibHVyKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudCA9IGZ1bmN0aW9uKHBhbmVsLCBlKSB7XHJcbiAgICAgICAgdmFyIGNsaWNrUmVjdCA9IGUudGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHZhciBwYW5lbFJlY3QgPSBwYW5lbFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcbiAgICAgICAgdmFyIHNjYWxlWCA9IE1hdGgubWluKDAuNSwgY2xpY2tSZWN0LndpZHRoIC8gcGFuZWxSZWN0LndpZHRoKTtcclxuICAgICAgICB2YXIgc2NhbGVZID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3QuaGVpZ2h0IC8gcGFuZWxSZWN0LmhlaWdodCk7XHJcblxyXG4gICAgICAgIHBhbmVsLmNzcygndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZTNkKCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC5sZWZ0ICsgY2xpY2tSZWN0LmxlZnQgKyBjbGlja1JlY3Qud2lkdGgvMiAtIHBhbmVsUmVjdC53aWR0aC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgKC1wYW5lbFJlY3QudG9wICsgY2xpY2tSZWN0LnRvcCArIGNsaWNrUmVjdC5oZWlnaHQvMiAtIHBhbmVsUmVjdC5oZWlnaHQvMikgKyAncHgsJyArXHJcbiAgICAgICAgICAgICcwKSBzY2FsZSgnICsgc2NhbGVYICsgJywnICsgc2NhbGVZICsgJyknXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLm9wZW5TYXZlRGlhbG9nID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCRyb290U2NvcGUuZ2V0UGFyYW0oJ29uU2F2ZUJ1dHRvbkNsaWNrJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUuZ2V0UGFyYW0oJ29uU2F2ZUJ1dHRvbkNsaWNrJykoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgkcm9vdFNjb3BlLmRlbGF5RWRpdG9yU3RhcnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNhdmVyLnNhdmVJbWFnZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnI3NhdmUtaW1hZ2UtZGlhbG9nJykuaHRtbCgpLFxyXG4gICAgICAgICAgICB0YXJnZXRFdmVudDogJGV2ZW50LFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVG9wUGFuZWxDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmNyZWF0ZU5ld0NhbnZhcyA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQpIHtcclxuICAgICAgICBjYW52YXMub3Blbk5ldyh3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAkc2NvcGUuY2xvc2VVcGxvYWREaWFsb2coKTtcclxuICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICRyb290U2NvcGUucmVzZXRVSSgpOyBcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLm9wZW5TYW1wbGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKCdhc3NldHMvaW1hZ2VzL2xvdHVzLmpwZycpO1xyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zYXZlSW1hZ2UgPSBmdW5jdGlvbigkZXZlbnQpIHtcclxuICAgICAgICBzYXZlci5zYXZlSW1hZ2UoJHNjb3BlLmltYWdlVHlwZSwgJHNjb3BlLmltYWdlUXVhbGl0eSwgJHNjb3BlLmltYWdlTmFtZSwgJGV2ZW50KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnNhdmVJbWFnZUNsb3NlID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgc2F2ZXIuc2F2ZUltYWdlKCRzY29wZS5pbWFnZVR5cGUsICRzY29wZS5pbWFnZVF1YWxpdHksICRzY29wZS5pbWFnZU5hbWUsICRldmVudCk7XHJcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKCcnLCdfc2VsZicpLmNsb3NlKCk7XHJcbiAgICAgICAgfSwgMTAwMCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zaG93SW1hZ2VQcmV2aWV3ID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgdmFyIGhpc3RvcnlPYmplY3QgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaGlzdG9yeU9iamVjdCA9IEpTT04ucGFyc2UodXJsKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGlzdG9yeU9iamVjdCAmJiBoaXN0b3J5T2JqZWN0LnN0YXRlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY2FuT3BlbkltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICBoaXN0b3J5LmxvYWQoaGlzdG9yeU9iamVjdCk7XHJcbiAgICAgICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UodXJsLCBmdW5jdGlvbihpbWFnZSkge1xyXG4gICAgICAgICAgICBpZiAoaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCgnLmltZy1wcmV2aWV3JykuaHRtbCgnJykuYXBwZW5kKGltYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuT3BlbkltYWdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2FuT3BlbkltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUub3BlbkltYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHVybCA9ICQoJy5pbWctcHJldmlldyBpbWcnKS5hdHRyKCdzcmMnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIHVybCB8fCAhICRzY29wZS5jYW5PcGVuSW1hZ2UpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYgKCghY2FudmFzLmZhYnJpYy5fb2JqZWN0cy5sZW5ndGggfHwgISBjYW52YXMubWFpbkltYWdlKSAmJiAhICRyb290U2NvcGUudXNlclByZXNldCkge1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmNsZWFyKCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKHVybCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2FudmFzLm9wZW5JbWFnZSh1cmwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLmNsb3NlVXBsb2FkRGlhbG9nKCk7XHJcbiAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmNsb3NlVXBsb2FkRGlhbG9nID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHNjb3BlLmNhblVwbG9hZEltYWdlID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5JbWFnZU1vZGUgPSAnb3Blbic7XHJcbiAgICAgICAgJCgnLmltZy1wcmV2aWV3JykuaHRtbCgpO1xyXG4gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICB9O1xyXG59XSk7XHJcblxyXG5cclxuXHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJywgW10pXHJcblxyXG4uZGlyZWN0aXZlKCdlZFRhYnMnLCBbJyRyb290U2NvcGUnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCBlbCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgdmFyIGJsb2NrQ2xpY2tzID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAkKCcjJythdHRycy5lZFRhYnMpLmFkZENsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgICQoJ1tkYXRhLWFjdGl2YXRlcz1cIicrYXR0cnMuZWRUYWJzKydcIl0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICBlbC5maW5kKCcjbmF2aWdhdGlvbi1iYXInKS5vbignY2xpY2snLCAnLm5hdi1pdGVtJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChibG9ja0NsaWNrcyA9PT0gdHJ1ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tDbGlja3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuYWN0aXZlVGFiID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuYWN0aXZhdGVzO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJvb3RTY29wZS4kd2F0Y2goJ2FjdGl2ZVRhYicsIGZ1bmN0aW9uKG5ld1RhYiwgb2xkVGFiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3VGFiICYmIG5ld1RhYiAhPT0gb2xkVGFiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFRhYk5vZGUgPSBvbGRUYWIgPyBlbC5maW5kKCcjJytvbGRUYWIpIDogZWwuZmluZCgnLnRhYi5vcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlVGFiKG5ld1RhYiwgb2xkVGFiTm9kZSwgZWwuZmluZCgnIycrbmV3VGFiKSwgJCgnW2RhdGEtYWN0aXZhdGVzPVwiJytuZXdUYWIrJ1wiXScpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgY2hhbmdlVGFiID0gZnVuY3Rpb24obmFtZSwgb2xkVGFiLCBuZXdUYWIsIHRhYkJ1dHRvbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluQW5pbWF0aW9uICA9ICdmYWRlSW5MZWZ0JyxcclxuICAgICAgICAgICAgICAgICAgICBvdXRBbmltYXRpb24gPSAnZmFkZU91dFJpZ2h0JztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGFiQnV0dG9uLmhhc0NsYXNzKCdhY3RpdmUnKSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vdGFiIG5hdmlnYXRpb25cclxuICAgICAgICAgICAgICAgICQoJy5uYXYtaXRlbS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB0YWJCdXR0b24uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vdGFic1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KG5ld1RhYi5kYXRhKCdpbmRleCcpKSA8IHBhcnNlSW50KG9sZFRhYi5kYXRhKCdpbmRleCcpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG91dEFuaW1hdGlvbiA9ICdmYWRlT3V0TGVmdCc7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5BbmltYXRpb24gID0gJ2ZhZGVJblJpZ2h0JztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBvbGRUYWIuYWRkQ2xhc3MoJ2FuaW1hdGVkICcrb3V0QW5pbWF0aW9uKS5vbmUoJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1RhYlswXS5pZCA9PT0gJHNjb3BlLmFjdGl2ZVRhYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdvcGVuICcrb3V0QW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG5ld1RhYi5hZGRDbGFzcygnb3BlbiBhbmltYXRlZCAnK2luQW5pbWF0aW9uKS5vbmUoJHJvb3RTY29wZS5hbmltYXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcyhpbkFuaW1hdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCd0YWIuY2hhbmdlZCcsIG5hbWUsIG9sZFRhYlswXS5pZCk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmFjdGl2ZVBhbmVsID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdUYWIucmVtb3ZlQ2xhc3MoJ2ZhZGVPdXRSaWdodCBmYWRlT3V0TGVmdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrQ2xpY2tzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9LCAyNzApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkUHJldHR5U2Nyb2xsYmFyJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5tQ3VzdG9tU2Nyb2xsYmFyKHtcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogYXR0cnMuZWRTY3JvbGxUaGVtZSB8fCAnaW5zZXQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbEluZXJ0aWE6IDMwMCxcclxuICAgICAgICAgICAgICAgICAgICBhdXRvRXhwYW5kU2Nyb2xsYmFyOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBheGlzOiBhdHRycy5lZFNjcm9sbEF4aXMgfHwgJ3gnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFkdmFuY2VkOiB7IGF1dG9FeHBhbmRIb3Jpem9udGFsU2Nyb2xsOnRydWUgfSxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCAxKVxyXG4gICAgICAgIH1cclxuICAgXHR9XHJcbn0pXHJcblxyXG4vL2ZpeCBzb21lIGJ1ZyBiZXR3ZWVuIGN1c3RvbSBzY3JvbGxiYXIgYW5kIG1hdGVyaWFsIHNsaWRlclxyXG4uZGlyZWN0aXZlKCdlZEllU2xpZGVyRml4JywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwic2xpZGVyLWZpeC1vdXR0ZXJcIiBzdHlsZT1cImhlaWdodDogMnB4OyBwb3NpdGlvbjogYWJzb2x1dGVcIj48ZGl2IGNsYXNzPVwic2xpZGVyLWZpeC1pbm5lclwiIHN0eWxlPVwiaGVpZ2h0OiAxcHg7IG92ZXJmbG93OiBhdXRvO1wiPklFIEZJWDwvZGl2PjwvZGl2PicsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwpIHtcclxuICAgICAgICAgICAgZWwuZmluZCgnLnNsaWRlci1maXgtaW5uZXInKS5tQ3VzdG9tU2Nyb2xsYmFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZGlyZWN0aXZlcycpXHJcblxyXG4uZGlyZWN0aXZlKCdlZENvbG9yUGlja2VyJywgWyckcm9vdFNjb3BlJywgJyRwYXJzZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkcGFyc2UpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciBmbGF0ID0gJ2VkRmxhdCcgaW4gYXR0cnM7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoKGF0dHJzLm5nRGlzYWJsZWQsIGZ1bmN0aW9uKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnNwZWN0cnVtKCdkaXNhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsLnNwZWN0cnVtKCdlbmFibGUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xyXG4gICAgICAgICAgICAgICAgY29sb3I6IGF0dHJzLnN0YXJ0Q29sb3IsXHJcbiAgICAgICAgICAgICAgICBjbGlja291dEZpcmVzQ2hhbmdlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgc2hvd1BhbGV0dGU6ICFmbGF0LFxyXG4gICAgICAgICAgICAgICAgcGFsZXR0ZTogY29sb3JzRm9yUGlja2VyLFxyXG4gICAgICAgICAgICAgICAgcHJlZmVycmVkRm9ybWF0OiAnaGV4JyxcclxuICAgICAgICAgICAgICAgIHNob3dBbHBoYTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHNob3dJbnB1dDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGZsYXQ6IGZsYXQsXHJcbiAgICAgICAgICAgICAgICBzaG93QnV0dG9uczogIWZsYXRcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0dGVyID0gZnVuY3Rpb24oc2VsZWN0ZWRDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgJHBhcnNlKGF0dHJzLmVkQ29sb3JQaWNrZXIpKCRzY29wZSwge2NvbG9yOiBzZWxlY3RlZENvbG9yLnRvU3RyaW5nKCl9KTtcclxuICAgICAgICAgICAgICAgIGVsLnZhbChzZWxlY3RlZENvbG9yLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGF0dHJzLmVkRGlzY3JldGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgZWwub24oJ2RyYWdzdG9wLnNwZWN0cnVtJywgZnVuY3Rpb24oZSwgc2VsZWN0ZWRDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlcihzZWxlY3RlZENvbG9yKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHBhcmFtcy5jaGFuZ2UgPSBmdW5jdGlvbihzZWxlY3RlZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGVyKHNlbGVjdGVkQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm1vdmUgPSBmdW5jdGlvbihzZWxlY3RlZENvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGVyKHNlbGVjdGVkQ29sb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlbC5zcGVjdHJ1bShwYXJhbXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1dKTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRpcmVjdGl2ZXMnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRGaWxlVXBsb2FkZXInLCBbJyRwYXJzZScsICckbWREaWFsb2cnLCAnJG1kQm90dG9tU2hlZXQnLCBmdW5jdGlvbigkcGFyc2UsICRtZERpYWxvZywgJG1kQm90dG9tU2hlZXQpIHtcclxuICAgIHZhciB2YWxpZFR5cGVzID0gWydwbmcnLCAnanBnJywgJ2pwZWcnLCAnZ2lmJ107XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciBzZXR0ZXIgPSAkcGFyc2UoYXR0cnMuZWRGaWxlVXBsb2FkZXIpKCRzY29wZSk7XHJcblxyXG4gICAgICAgICAgICAkKGVsWzBdKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbWUgPSBldmVudC50YXJnZXQucmVzdWx0LnNwbGl0KFwiLFwiKVswXS5zcGxpdChcIjpcIilbMV0uc3BsaXQoXCI7XCIpWzBdLnNwbGl0KCcvJylbMV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZFR5cGVzLmluZGV4T2YobWltZSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRlcihldmVudC50YXJnZXQucmVzdWx0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0cnMuZWRDbG9zZUFmdGVyICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZEJvdHRvbVNoZWV0LmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzWzBdLm5hbWUubWF0Y2goJy5qc29uJykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzVGV4dChlLnRhcmdldC5maWxlc1swXSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGUudGFyZ2V0LmZpbGVzWzBdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICBcdH1cclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kaXJlY3RpdmVzJylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkVG9nZ2xlUGFuZWxWaXNpYmlsaXR5JywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZWwuZmluZCgnLmljb24nKS50b2dnbGVDbGFzcygndG9nZ2xlZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICQoJyMnK2F0dHJzLmVkVG9nZ2xlUGFuZWxWaXNpYmlsaXR5KS5maW5kKCd1bCcpLm1DdXN0b21TY3JvbGxiYXIoJ2Rpc2FibGUnKS5zbGlkZVRvZ2dsZSgxNTAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQodGhpcykubUN1c3RvbVNjcm9sbGJhcigndXBkYXRlJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICBcdH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRpcmVjdGl2ZXMnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRUb2dnbGVTaWRlYmFyJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWwsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciBzaWRlYmFyID0gJCgnI2xlZnQtc2lkZWJhcicpO1xyXG5cclxuICAgICAgICAgICAgZWwub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBzaWRlYmFyLnRvZ2dsZUNsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgXHR9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS50ZXh0JywgW10pXHJcblxyXG4gICAgLnNlcnZpY2UoJ3RleHQnLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgZnVuY3Rpb24gKCRyb290U2NvcGUsIGNhbnZhcykge1xyXG5cclxuICAgICAgICB2YXIgdGV4dCA9IHtcclxuXHJcbiAgICAgICAgICAgIHJlbW92ZVRleHRGcm9tQ2FudmFzOiBmdW5jdGlvbih0ZXh0T2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgIGlmICggISB0ZXh0T2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0ZXh0T2JqZWN0ID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgLy9iYWlsIGlmIHdlIGRvbid0IGhhdmUgYSB0ZXh0IG9iamVjdFxyXG4gICAgICAgICAgICAgICAgICBpZiAoICEgdGV4dE9iamVjdC5zZXRGb250U2l6ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW1vdmUodGV4dE9iamVjdCk7XHJcbiAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBnZXRUZXh0T2JqZWN0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhY3RpdmUgPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChhY3RpdmUgJiYgYWN0aXZlLmZvbnRGYW1pbHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vaWYgdGhlcmUgaXMgbm8gYWN0aXZlIG9iamVjdCBvciBhY3RpdmUgb2JqZWN0XHJcbiAgICAgICAgICAgICAgICAvL2lzIG5vdCB0ZXh0LCByZXR1cm4gZmlyc3QgdGV4dCBvYmplY3QgYXZhaWxhYmxlXHJcbiAgICAgICAgICAgICAgICBpZiAoICEgYWN0aXZlIHx8ICEgYWN0aXZlLmZvbnRGYW1pbHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0cyA9IGNhbnZhcy5mYWJyaWMuZ2V0T2JqZWN0cygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iamVjdHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iamVjdHNbaV0uZm9udEZhbWlseSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICB0b2dnbGVUZXh0RGVjb3JhdGlvbjogZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy5nZXRUZXh0T2JqZWN0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHRleHQudGV4dERlY29yYXRpb24udHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vZm9udCBzdHlsZVxyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09ICdpdGFsaWMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRleHQuZm9udFN0eWxlLmluZGV4T2YoJ2l0YWxpYycpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5zZXRGb250U3R5bGUoJ25vcm1hbCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuc2V0Rm9udFN0eWxlKCdpdGFsaWMnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy90ZXh0IGRlY29yYXRpb25cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50LmluZGV4T2YodmFsdWUpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucmVwbGFjZSh2YWx1ZSwgJycpLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ICs9ICcgJyt2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0LnNldFRleHREZWNvcmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQuc2V0VGV4dERlY29yYXRpb24oY3VycmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRpb25zID0gdGV4dC5mb250U3R5bGUrJyAnK3RleHQudGV4dERlY29yYXRpb24udHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBkZWNvcmF0aW9ucy5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgc2V0UHJvcGVydHk6IGZ1bmN0aW9uKHByb3BlcnR5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgICA9IHRoaXMuZ2V0VGV4dE9iamVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlciA9IHRoaXMubWFrZVNldHRlck5hbWUocHJvcGVydHkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0W3NldHRlcl0pIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0W3NldHRlcl0odmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVG9nZ2xlIGdpdmVuIHByb3BlcnR5IG9uL29mZiBvbiB0ZXh0IG9iamVjdC5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9ICBwcm9wZXJ0eVxyXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuYWJsZWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRvZ2dsZVByb3BlcnR5OiBmdW5jdGlvbihwcm9wZXJ0eSwgZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgICA9IHRoaXMuZ2V0VGV4dE9iamVjdCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNldHRlciA9IHRoaXMubWFrZVNldHRlck5hbWUocHJvcGVydHkpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0W3NldHRlcl0pIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0W3NldHRlcl0oZW5hYmxlZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBDb21waWxlIGEgZmFicmljIHNldHRlciBmdW5jdGlvbiBuYW1lIGZyb20gZ2l2ZSBwcm9wZXJ0eS5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHBhcmFtIG5hbWUgKGJhY2tncm91bmRDb2xvcilcclxuICAgICAgICAgICAgICogQHJldHVybnMgc3RyaW5nIChzZXRCYWNrZ3JvdW5kQ29sb3IpXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBtYWtlU2V0dGVyTmFtZTogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gJ3NldCcrbmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStuYW1lLnNsaWNlKDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRleHQ7XHJcblxyXG4gICAgfV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS50ZXh0JylcclxuXHJcbi5jb250cm9sbGVyKCdUZXh0Q29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHRpbWVvdXQnLCAnY2FudmFzJywgJ3RleHQnLCAnZm9udHMnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICR0aW1lb3V0LCBjYW52YXMsIHRleHQsIGZvbnRzKSB7XHJcblx0JHNjb3BlLnRleHQgID0gdGV4dDtcclxuXHQkc2NvcGUuZm9udHMgPSBmb250cztcclxuXHJcblx0JHNjb3BlLm9wYWNpdHkgPSAxO1xyXG5cdCRzY29wZS5mb250U2l6ZSA9IDI1O1xyXG5cdCRzY29wZS5lbmFibGVPdXRsaW5lID0gdHJ1ZTtcclxuXHQkc2NvcGUuZmlsdGVycyA9IHtcclxuXHRcdGNhdGVnb3J5OiAnaGFuZHdyaXRpbmcnLFxyXG5cdFx0ZmFtaWx5OiAnJ1xyXG5cdH07XHJcblxyXG4gICAgJHNjb3BlLmlzUGFuZWxFbmFibGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG9iaiA9IGNhbnZhcy5mYWJyaWMuZ2V0QWN0aXZlT2JqZWN0KCk7XHJcbiAgICAgICAgcmV0dXJuIG9iaiAmJiBvYmoubmFtZSA9PT0gJ3RleHQnICYmICRyb290U2NvcGUuYWN0aXZlVGFiID09PSAndGV4dCc7XHJcbiAgICB9O1xyXG5cclxuXHQkc2NvcGUuY2hhbmdlRm9udCA9IGZ1bmN0aW9uKGZvbnQsIGUpIHtcclxuICAgICAgICB2YXIgYWN0aXZlID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHRcdCRyb290U2NvcGUub3BlblBhbmVsKCd0ZXh0JywgZSk7XHJcblxyXG5cdFx0aWYgKCAhIGFjdGl2ZSB8fCBhY3RpdmUubmFtZSAhPT0gJ3RleHQnKSB7XHJcblx0XHRcdHZhciBuZXdUZXh0ID0gbmV3IGZhYnJpYy5JVGV4dCgnRG91YmxlIGNsaWNrIG1lIHRvIGVkaXQgbXkgY29udGVudHMuJywge1xyXG5cdFx0XHRcdGZvbnRXZWlnaHQ6IDQwMCxcclxuXHRcdFx0XHRmb250U2l6ZTogMjggLyBjYW52YXMuY3VycmVudFpvb20sXHJcblx0XHRcdFx0ZmlsbDogJyNmZmYnLFxyXG5cdFx0XHRcdHJlbW92ZU9uQ2FuY2VsOiB0cnVlLFxyXG5cdFx0XHRcdG5hbWU6ICd0ZXh0J1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGNhbnZhcy5mYWJyaWMuYWRkKG5ld1RleHQpO1xyXG4gICAgICAgICAgICBuZXdUZXh0LnNldFRvcCgyNSk7XHJcbiAgICAgICAgICAgIG5ld1RleHQuc2V0TGVmdCgyNSk7XHJcblx0XHRcdGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KG5ld1RleHQpO1xyXG5cdFx0XHRjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG5cdFx0fVxyXG5cclxuICAgICAgICB0ZXh0LnNldFByb3BlcnR5KCdmb250RmFtaWx5JywgZm9udCk7XHJcblx0fTtcclxuXHJcblx0JHNjb3BlLmNhbmNlbEFkZGluZ1RleHRUb0NhbnZhcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHRleHRPYmplY3QgPSB0ZXh0LmdldFRleHRPYmplY3QoKTtcclxuXHJcblx0XHRpZiAodGV4dE9iamVjdC5yZW1vdmVPbkNhbmNlbCkge1xyXG5cdFx0XHR0ZXh0LnJlbW92ZVRleHRGcm9tQ2FudmFzKHRleHRPYmplY3QpO1xyXG5cdFx0fVxyXG5cclxuXHRcdCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcclxuXHR9O1xyXG5cclxuXHQkc2NvcGUuZmluaXNoQWRkaW5nVGV4dFRvQ2FudmFzID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgdGV4dE9iamVjdCA9IHRleHQuZ2V0VGV4dE9iamVjdCgpO1xyXG5cclxuXHRcdCRyb290U2NvcGUuYWN0aXZlUGFuZWwgPSBmYWxzZTtcclxuXHRcdCRyb290U2NvcGUuJGVtaXQoJ3RleHQuYWRkZWQnLCB0ZXh0T2JqZWN0KTtcclxuXHRcdGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KGNhbnZhcy5tYWluSW1hZ2UpO1xyXG5cdFx0Zm9udHMuY3JlYXRlTGlua1RvRm9udCh0ZXh0T2JqZWN0LmZvbnRGYW1pbHkpO1xyXG5cdH07XHJcblxyXG5cdCRyb290U2NvcGUuJG9uKCd0YWIuY2hhbmdlZCcsIGZ1bmN0aW9uKGUsIG5hbWUpIHtcclxuXHRcdGlmIChuYW1lID09ICd0ZXh0Jykge1xyXG5cdFx0XHR2YXIgdGV4dE9iamVjdCA9ICRzY29wZS50ZXh0LmdldFRleHRPYmplY3QoKTtcclxuXHJcblx0XHRcdC8vaWYgd2UgY2FuIGZpbmQgYW4gZXhpc3RpbmcgdGV4dCBvYmplY3Qgc2V0IGl0IGFzIGFjdGl2ZVxyXG5cdFx0XHRpZiAodGV4dE9iamVjdCkge1xyXG5cdFx0XHRcdHRleHRPYmplY3QucmVtb3ZlT25DYW5jZWwgPSBmYWxzZTtcclxuXHRcdFx0XHRjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdCh0ZXh0T2JqZWN0KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRmb250cy5nZXRBbGwoJHNjb3BlLmZpbHRlcnMpO1xyXG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnRleHQnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRUZXh0QWxpZ25CdXR0b25zJywgWyd0ZXh0JywgZnVuY3Rpb24gKHRleHQpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsICdpJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFsaWduID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuYWxpZ247XHJcblxyXG4gICAgICAgICAgICAgICAgdGV4dC5zZXRQcm9wZXJ0eSgndGV4dEFsaWduJywgYWxpZ24pO1xyXG4gICAgICAgICAgICAgICAgZWwuZmluZCgnaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XSlcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnRleHQnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRUZXh0RGVjb3JhdGlvbkJ1dHRvbnMnLCBbJ3RleHQnLCBmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjb21waWxlOiBmdW5jdGlvbiAoZWwpIHtcclxuICAgICAgICAgICAgZWwub24oJ2NsaWNrJywgJy50b29sYmFyLWJ0bicsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZGVjb3JhdGlvbjtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZGVjb3JhdGlvbnMgPSB0ZXh0LnRvZ2dsZVRleHREZWNvcmF0aW9uKG5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGVsLmZpbmQoJy50b29sYmFyLWJ0bicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRlY29yYXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWwuZmluZCgnW2RhdGEtZGVjb3JhdGlvbj1cIicrZGVjb3JhdGlvbnNbaV0udHJpbSgpKydcIl0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1dKVxyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UudGV4dCcpXHJcblxyXG4uZGlyZWN0aXZlKCdlZEZvbnRzUGFnaW5hdGlvbicsIFsnJHJvb3RTY29wZScsICdmb250cycsIGZ1bmN0aW9uKCRyb290U2NvcGUsIGZvbnRzKSB7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKCRzY29wZSwgZWwpIHtcclxuXHJcbiAgICAgICAgICAgIC8vaW5pdGlhdGUgcGFnaW5hdGlvbiBwbHVnaW5cclxuICAgICAgICAgICAgZWwucGFnaW5hdGlvbih7XHJcbiAgICAgICAgICAgICAgICBpdGVtczogMCxcclxuICAgICAgICAgICAgICAgIGl0ZW1zT25QYWdlOiBmb250cy5wYWdpbmF0b3IucGVyUGFnZSxcclxuICAgICAgICAgICAgICAgIG9uUGFnZUNsaWNrOiBmdW5jdGlvbihudW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250cy5wYWdpbmF0b3Iuc2VsZWN0UGFnZShudW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy9yZWRyYXcgcGFnaW5hdGlvbiBiYXIgb24gdG90YWwgaXRlbXMgY2hhbmdlXHJcbiAgICAgICAgICAgICRzY29wZS4kd2F0Y2goJ2ZvbnRzLnBhZ2luYXRvci50b3RhbEl0ZW1zJywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgeyBlbC5wYWdpbmF0aW9uKCd1cGRhdGVJdGVtcycsIHZhbHVlKSB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufV0pXHJcblxyXG4uZmFjdG9yeSgnZm9udHMnLCBbJyRyb290U2NvcGUnLCAnJGh0dHAnLCAnJHRpbWVvdXQnLCAnJGZpbHRlcicsICdsb2NhbFN0b3JhZ2UnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkaHR0cCwgJHRpbWVvdXQsICRmaWx0ZXIsIGxvY2FsU3RvcmFnZSkge1xyXG5cclxuICAgIHZhciBmb250cyA9IHtcclxuXHJcbiAgICAgICAgbG9hZGluZzogZmFsc2UsXHJcblxyXG4gICAgICAgIHBhZ2luYXRvcjoge1xyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEFsbCBhdmFpbGFibGUgZm9udHMuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEB0eXBlIGFycmF5XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBzb3VyY2VJdGVtczogW10sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQWxsIGF2YWlsYWJsZSBmb250cyB3aXRoIGZpbHRycyBhcHBsaWVkLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgZmlsdGVyZWRJdGVtczogW10sXHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogRm9udHMgY3VycmVudGx5IGJlaW5nIHNob3duLlxyXG4gICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgKiBAdHlwZSBhcnJheVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgY3VycmVudEl0ZW1zOiBbXSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBGb250cyB0byBzaG93IHBlciBwYWdlLlxyXG4gICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgKiBAdHlwZSBpbnRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHBlclBhZ2U6IDE3LFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIFRvdGFsIG51bWJlciBvZiBmb250cy5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHR5cGUgaW50XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB0b3RhbEl0ZW1zOiAwLFxyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIFNsaWNlIGl0ZW1zIGZvciB0aGUgZ2l2ZW4gcGFnZS5cclxuICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICogQHBhcmFtICB7aW50fSBwYWdlXHJcbiAgICAgICAgICAgICAqIEByZXR1cm4gdm9pZFxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgc2VsZWN0UGFnZTogZnVuY3Rpb24ocGFnZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50SXRlbXMgPSB0aGlzLmZpbHRlcmVkSXRlbXMuc2xpY2UoXHJcbiAgICAgICAgICAgICAgICAgICAgKHBhZ2UtMSkqdGhpcy5wZXJQYWdlLCAocGFnZS0xKSp0aGlzLnBlclBhZ2UrdGhpcy5wZXJQYWdlXHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvbnRzLmxvYWQoKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGZpbHRlcjogZnVuY3Rpb24oZmlsdGVycykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydCgkZmlsdGVyKCdmaWx0ZXInKShmb250cy5wYWdpbmF0b3Iuc291cmNlSXRlbXMsIGZpbHRlcnMpKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBTdGFydCB0aGUgcGFnaW5hdG9yIHdpdGggZ2l2ZW4gaXRlbXMuXHJcbiAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAqIEBwYXJhbSAge2FycmF5fSBpdGVtc1xyXG4gICAgICAgICAgICAgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbihpdGVtcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZEl0ZW1zICA9IGl0ZW1zO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbEl0ZW1zICAgPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRJdGVtcyA9IGl0ZW1zLnNsaWNlKDAsIHRoaXMucGVyUGFnZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9udHMubG9hZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRmV0Y2ggYWxsIGF2YWlsYWJsZSBmb250cyBmcm9tIEdvb2dsZUZvbnRzIEFQSS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZXR1cm4gdm9pZFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldEFsbDogZnVuY3Rpb24oZmlsdGVycykge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiAgID0gdGhpcyxcclxuICAgICAgICAgICAgICAgIGNhY2hlZCA9IGxvY2FsU3RvcmFnZS5nZXQoJ2dvb2dsZUZvbnRzJyksXHJcbiAgICAgICAgICAgICAgICBrZXkgICAgPSAkcm9vdFNjb3BlLmtleXNbJ2dvb2dsZV9mb250cyddO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5wYWdpbmF0b3Iuc291cmNlSXRlbXMgPSBjYWNoZWQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVycyA/IHNlbGYucGFnaW5hdG9yLmZpbHRlcihmaWx0ZXJzKSA6IHNlbGYucGFnaW5hdG9yLnN0YXJ0KGNhY2hlZCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRodHRwLmdldCgnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vd2ViZm9udHMvdjEvd2ViZm9udHM/c29ydD1wb3B1bGFyaXR5JmtleT0nK2tleSlcclxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0KCdnb29nbGVGb250cycsIGRhdGEuaXRlbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGFnaW5hdG9yLnNvdXJjZUl0ZW1zID0gZGF0YS5pdGVtcztcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJzID8gc2VsZi5wYWdpbmF0b3IuZmlsdGVyKGZpbHRlcnMpIDogc2VsZi5wYWdpbmF0b3Iuc3RhcnQoZGF0YS5pdGVtcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBMb2FkIGdpdmVuIGdvb2dsZSBmb250cyBpbnRvIHRoZSBET00uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gIHttaXhlZH0gbmFtZXNcclxuICAgICAgICAgKiBAcmV0dXJuIHZvaWRcclxuICAgICAgICAgKi9cclxuICAgICAgICBsb2FkOiBmdW5jdGlvbihuYW1lcykge1xyXG4gICAgICAgICAgICB2YXIgaGVhZCA9ICQoJ2hlYWQnKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5sb2FkaW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIC8vbWFrZSBhbiBhcnJheSBvZiBmb250IG5hbWVzIGZyb20gY3VycmVudCBmb250c1xyXG4gICAgICAgICAgICAvL2luIHRoZSBwYWdpbmF0b3IgaWYgbm9uZSBwYXNzZWRcclxuICAgICAgICAgICAgaWYgKCAhIG5hbWVzKSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lcyA9ICQubWFwKGZvbnRzLnBhZ2luYXRvci5jdXJyZW50SXRlbXMsIGZ1bmN0aW9uKGZvbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9udC5mYW1pbHk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvL25vcm1hbGl6ZSBuYW1lcyB0byBhcnJheSBpZiBzdHJpbmcgcGFzc2VkXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoICEgYW5ndWxhci5pc0FycmF5KG5hbWVzKSkge1xyXG4gICAgICAgICAgICAgICAgbmFtZXMgPSBbbmFtZXNdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL3JlbW92ZSBwcmV2aW91cyBwYWdlIGZvbnRzXHJcbiAgICAgICAgICAgICQoaGVhZCkuZmluZCgnI2R5bmFtaWMtZm9udHMnKS5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgICAgIC8vbG9hZCB0aGUgZ2l2ZW4gZm9udHNcclxuICAgICAgICAgICAgaGVhZC5hcHBlbmQoXHJcbiAgICAgICAgICAgICAgICAnPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGlkPVwiZHluYW1pYy1mb250c1wiIGhyZWY9XCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9JytcclxuICAgICAgICAgICAgICAgIG5hbWVzLmpvaW4oJ3wnKS5yZXBsYWNlKC8gL2csICcrJykrJ1wiPidcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGNyZWF0ZUxpbmtUb0ZvbnQ6IGZ1bmN0aW9uKGZvbnQpIHtcclxuICAgICAgICAgICAgdmFyIG5hbWUgPSBmb250LnJlcGxhY2UoLyAvZywgJysnKSxcclxuICAgICAgICAgICAgICAgIGxpbmsgPSAkKCcjJytuYW1lKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAobGlua1swXSkge1xyXG4gICAgICAgICAgICAgICAgbGluay5hdHRyKCdocmVmJywgJ2h0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT0nK25hbWUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJCgnaGVhZCcpLmFwcGVuZCgnPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGlkPVwiJytuYW1lKydcIiBocmVmPVwiaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3M/ZmFtaWx5PScrbmFtZSsnXCI+Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiBmb250cztcclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5kcmF3aW5nJywgW10pXHJcblxyXG4uc2VydmljZSgnZHJhd2luZycsIFsnJHJvb3RTY29wZScsICdjYW52YXMnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgY2FudmFzKSB7XHJcblxyXG4gICAgdmFyIGRyYXdpbmcgPSB7XHJcblxyXG4gICAgICAgIGF2YWlsYWJsZUJydXNoZXM6IFsncGVuY2lsJywgJ3ZMaW5lJywgJ2RpYW1vbmQnLCAnaExpbmUnLCAnY2lyY2xlJywgJ3NxdWFyZScsICdzcHJheSddLFxyXG5cclxuICAgICAgICBkZWZhdWx0QnJ1c2hOYW1lOiAncGVuY2lsJyxcclxuXHJcbiAgICAgICAgYWN0aXZlQnJ1c2hOYW1lOiBmYWxzZSxcclxuXHJcbiAgICAgICAgaXNFbmFibGVkOiBmYWxzZSxcclxuXHJcbiAgICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgICAgIHNoYWRvd0NvbG9yOiAnIzFFODlFNicsXHJcbiAgICAgICAgICAgIGJydXNoV2lkdGg6IDksXHJcbiAgICAgICAgICAgIGJydXNoQ29sb3I6ICcjMDAwJyxcclxuICAgICAgICAgICAgc2hhZG93Qmx1cjogMzAsXHJcbiAgICAgICAgICAgIHNoYWRvd09mZnNldFg6IDEwLFxyXG4gICAgICAgICAgICBzaGFkb3dPZmZzZXRZOiAxMCxcclxuICAgICAgICAgICAgZW5hYmxlU2hhZG93OiBmYWxzZVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGVuYWJsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuaXNEcmF3aW5nTW9kZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlQnJ1c2godGhpcy5kZWZhdWx0QnJ1c2hOYW1lKTtcclxuXHJcbiAgICAgICAgICAgIGlmICggISB0aGlzLnNoYWRvdykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFkb3cgPSBuZXcgZmFicmljLlNoYWRvdyh7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHRoaXMucGFyYW1zLnNoYWRvd0NvbG9yLFxyXG4gICAgICAgICAgICAgICAgICAgIGJsdXI6IHRoaXMucGFyYW1zLnNoYWRvd0JsdXIsXHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0WDogdGhpcy5wYXJhbXMuc2hhZG93T2Zmc2V0WCxcclxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRZOiB0aGlzLnBhcmFtcy5zaGFkb3dPZmZzZXRZXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmlzRHJhd2luZ01vZGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZXRTaGFkb3dQcm9wZXJ0eTogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC5zaGFkb3dbbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC5zaGFkb3dbbmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNldFByb3BlcnR5OiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAoY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2hbbmFtZV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHRvZ2dsZVNoYWRvdzogZnVuY3Rpb24ob24pIHtcclxuICAgICAgICAgICAgaWYgKG9uKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guc2hhZG93ID0gdGhpcy5zaGFkb3c7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWRvdyA9IGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC5zaGFkb3c7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2guc2hhZG93ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcclxuICAgICAgICBjaGFuZ2VCcnVzaDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUJydXNoTmFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgIG5hbWUgPSB0aGlzLm1ha2VCcnVzaE5hbWUobmFtZSk7XHJcblxyXG4gICAgICAgICAgICAvL2NoZWNrIGlmIGl0J3MgYSBiYXNlIGZhYnJpYyBicnVzaFxyXG4gICAgICAgICAgICBpZiAoZmFicmljW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2ggPSBuZXcgZmFicmljW25hbWVdKGNhbnZhcy5mYWJyaWMpO1xyXG5cclxuICAgICAgICAgICAgLy9jaGVjayBpZiBpdCdzIGEgY3VzdG9tIGJydXNoIHRoYXQgd2UgaGF2ZSBhbHJlYWR5IG1hZGVcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZyZWVEcmF3aW5nQnJ1c2ggPSB0aGlzW25hbWVdO1xyXG5cclxuICAgICAgICAgICAgLy9jaGVjayBpZiB3ZSBjYW4gbWFrZSBhIHJlcXVlc3QgYnJ1c2hcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzWydtYWtlJytuYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoID0gdGhpc1snbWFrZScrbmFtZV0oKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoLndpZHRoICA9IHRoaXMucGFyYW1zLmJydXNoV2lkdGg7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZnJlZURyYXdpbmdCcnVzaC5jb2xvciAgPSB0aGlzLnBhcmFtcy5icnVzaENvbG9yO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMucGFyYW1zLmVuYWJsZVNoYWRvdykge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mcmVlRHJhd2luZ0JydXNoLnNoYWRvdyA9IHRoaXMuc2hhZG93O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29tcGlsZSBhIGZhYnJpYyBicnVzaCBmdW5jdGlvbiBuYW1lIGZyb20gZ2l2ZW4gbmFtZS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBuYW1lIChwZW5jaWwpXHJcbiAgICAgICAgICogQHJldHVybnMgc3RyaW5nIChQZW5jaWxCcnVzaClcclxuICAgICAgICAgKi9cclxuICAgICAgICBtYWtlQnJ1c2hOYW1lOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK25hbWUuc2xpY2UoMSkgKyAnQnJ1c2gnO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1ha2VWTGluZUJydXNoOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5WTGluZUJydXNoID0gbmV3IGZhYnJpYy5QYXR0ZXJuQnJ1c2goY2FudmFzLmZhYnJpYyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLlZMaW5lQnJ1c2guZ2V0UGF0dGVyblNyYyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuQ2FudmFzID0gZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICAgICAgcGF0dGVybkNhbnZhcy53aWR0aCA9IHBhdHRlcm5DYW52YXMuaGVpZ2h0ID0gMTA7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gcGF0dGVybkNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuY29sb3I7XHJcbiAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gNTtcclxuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oMCwgNSk7XHJcbiAgICAgICAgICAgICAgICBjdHgubGluZVRvKDEwLCA1KTtcclxuICAgICAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0dGVybkNhbnZhcztcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlZMaW5lQnJ1c2g7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbWFrZURpYW1vbmRCcnVzaDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLkRpYW1vbmRCcnVzaCA9IG5ldyBmYWJyaWMuUGF0dGVybkJydXNoKGNhbnZhcy5mYWJyaWMpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5EaWFtb25kQnJ1c2guZ2V0UGF0dGVyblNyYyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzcXVhcmVXaWR0aCA9IDEwLCBzcXVhcmVEaXN0YW5jZSA9IDU7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0dGVybkNhbnZhcyA9IGZhYnJpYy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICAgICAgICAgIHZhciByZWN0ID0gbmV3IGZhYnJpYy5SZWN0KHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogc3F1YXJlV2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBzcXVhcmVXaWR0aCxcclxuICAgICAgICAgICAgICAgICAgICBhbmdsZTogNDUsXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogdGhpcy5jb2xvclxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhc1dpZHRoID0gcmVjdC5nZXRCb3VuZGluZ1JlY3RXaWR0aCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHBhdHRlcm5DYW52YXMud2lkdGggPSBwYXR0ZXJuQ2FudmFzLmhlaWdodCA9IGNhbnZhc1dpZHRoICsgc3F1YXJlRGlzdGFuY2U7XHJcbiAgICAgICAgICAgICAgICByZWN0LnNldCh7IGxlZnQ6IGNhbnZhc1dpZHRoIC8gMiwgdG9wOiBjYW52YXNXaWR0aCAvIDIgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHBhdHRlcm5DYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICAgICAgICAgIHJlY3QucmVuZGVyKGN0eCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdHRlcm5DYW52YXM7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5EaWFtb25kQnJ1c2g7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbWFrZUhMaW5lQnJ1c2g6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy5ITGluZUJydXNoID0gbmV3IGZhYnJpYy5QYXR0ZXJuQnJ1c2goY2FudmFzLmZhYnJpYyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLkhMaW5lQnJ1c2guZ2V0UGF0dGVyblNyYyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuQ2FudmFzID0gZmFicmljLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICAgICAgcGF0dGVybkNhbnZhcy53aWR0aCA9IHBhdHRlcm5DYW52YXMuaGVpZ2h0ID0gMTA7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3R4ID0gcGF0dGVybkNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuY29sb3I7XHJcbiAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gNTtcclxuICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN0eC5tb3ZlVG8oNSwgMCk7XHJcbiAgICAgICAgICAgICAgICBjdHgubGluZVRvKDUsIDEwKTtcclxuICAgICAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0dGVybkNhbnZhcztcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkhMaW5lQnJ1c2g7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbWFrZVNxdWFyZUJydXNoOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuU3F1YXJlQnJ1c2ggPSBuZXcgZmFicmljLlBhdHRlcm5CcnVzaChjYW52YXMuZmFicmljKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuU3F1YXJlQnJ1c2guZ2V0UGF0dGVyblNyYyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzcXVhcmVXaWR0aCA9IDEwLCBzcXVhcmVEaXN0YW5jZSA9IDI7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBhdHRlcm5DYW52YXMgPSBmYWJyaWMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICBwYXR0ZXJuQ2FudmFzLndpZHRoID0gcGF0dGVybkNhbnZhcy5oZWlnaHQgPSBzcXVhcmVXaWR0aCArIHNxdWFyZURpc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN0eCA9IHBhdHRlcm5DYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy5jb2xvcjtcclxuICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBzcXVhcmVXaWR0aCwgc3F1YXJlV2lkdGgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXR0ZXJuQ2FudmFzO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuU3F1YXJlQnJ1c2g7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGRyYXdpbmc7XHJcblxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLmRyYXdpbmcnKVxyXG5cclxuLmNvbnRyb2xsZXIoJ0RyYXdpbmdDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdjYW52YXMnLCAnZHJhd2luZycsICdoaXN0b3J5JywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIGRyYXdpbmcsIGhpc3RvcnkpIHtcclxuXHQkc2NvcGUuZHJhd2luZyA9IGRyYXdpbmc7XHJcbiAgICB3aW5kb3cuZmIgPSBjYW52YXMuZmFicmljO1xyXG5cclxuXHQkc2NvcGUuY2hhbmdlQnJ1c2ggPSBmdW5jdGlvbihicnVzaCwgJGV2ZW50KSB7XHJcblx0XHQkc2NvcGUub3BlblBhbmVsKCdkcmF3aW5nJywgJGV2ZW50KTtcclxuXHJcblx0XHRpZiAoICEgZHJhd2luZy5pc0VuYWJsZWQpIHtcclxuXHRcdFx0ZHJhd2luZy5lbmFibGUoKTtcclxuXHRcdH1cclxuXHJcblx0XHRkcmF3aW5nLmNoYW5nZUJydXNoKGJydXNoKTtcclxuXHR9O1xyXG5cclxuXHQkc2NvcGUuZmluaXNoQWRkaW5nRHJhd2luZ3NUb0NhbnZhcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0JHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAoY2FudmFzLm1haW5JbWFnZSkge1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChjYW52YXMubWFpbkltYWdlKTtcclxuICAgICAgICB9XHJcblxyXG5cdFx0Y2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG5cdFx0XHRpZiAob2JqLm5hbWUgPT09ICdmcmVlRHJhd2luZycpIHtcclxuXHRcdFx0XHRvYmoucmVtb3ZlT25DYW5jZWwgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG4gICAgICAgIGRyYXdpbmcuZGlzYWJsZSgpO1xyXG5cdFx0aGlzdG9yeS5hZGQoJ2FkZGVkIGRyYXdpbmcnLCAnYnJ1c2gnKTtcclxuXHR9O1xyXG5cclxuXHQkc2NvcGUuY2FuY2VsQWRkaW5nRHJhd2luZ3NUb0NhbnZhcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbiAob2JqKSB7XHJcblx0XHRcdGlmIChvYmoubmFtZSA9PT0gJ2ZyZWVEcmF3aW5nJyAmJiBvYmoucmVtb3ZlT25DYW5jZWwpIHtcclxuXHRcdFx0XHRjYW52YXMuZmFicmljLnJlbW92ZShvYmopO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRkcmF3aW5nLmRpc2FibGUoKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG5cdFx0JHJvb3RTY29wZS5hY3RpdmVQYW5lbCA9IGZhbHNlO1xyXG5cdH07XHJcblxyXG5cdCRyb290U2NvcGUuJG9uKCd0YWIuY2hhbmdlZCcsIGZ1bmN0aW9uKGUsIG5hbWUpIHtcclxuXHRcdGlmIChuYW1lICE9PSAnZHJhd2luZycpIHtcclxuXHRcdFx0ZHJhd2luZy5kaXNhYmxlKCk7XHJcblx0XHRcdCRzY29wZS5jYW5jZWxBZGRpbmdEcmF3aW5nc1RvQ2FudmFzKCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdGNhbnZhcy5mYWJyaWMub24oJ3BhdGg6Y3JlYXRlZCcsIGZ1bmN0aW9uKGUpIHtcclxuXHRcdGlmIChkcmF3aW5nLmlzRW5hYmxlZCkge1xyXG5cdFx0XHRlLnBhdGguc2V0T3B0aW9ucyhjYW52YXMuaW1hZ2VTdGF0aWMpO1xyXG5cdFx0XHRlLnBhdGgubmFtZSA9ICdmcmVlRHJhd2luZyc7XHJcblx0XHRcdGUucGF0aC5yZW1vdmVPbkNhbmNlbCA9IHRydWU7XHJcblx0XHR9XHJcblx0fSk7XHJcbn1dKTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZGlyZWN0aXZlcycpXHJcblxyXG4uZGlyZWN0aXZlKCdlZFJlbmRlckJydXNoZXMnLCBbJyRyb290U2NvcGUnLCAnJGNvbXBpbGUnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJGNvbXBpbGUpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgZWwpIHtcclxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gJzxkaXYgbmctcmVwZWF0PVwiYnJ1c2ggaW4gZHJhd2luZy5hdmFpbGFibGVCcnVzaGVzXCIgbmctY2xhc3M9XCJ7IGFjdGl2ZTogZHJhd2luZy5hY3RpdmVCcnVzaE5hbWUgPT0gYnJ1c2ggfVwiIGNsYXNzPVwiYnJ1c2ggYW5pbWF0ZWQtaW4tc2VxdWVuY2VcIiBuZy1jbGljaz1cImNoYW5nZUJydXNoKGJydXNoKVwiPicrXHJcbiAgICAgICAgICAgICAgICAnPGltZyBjbGFzcz1cImltZy1yZXNwb25zaXZlXCIgbmctc3JjPVwiYXNzZXRzL2ltYWdlcy9icnVzaGVzL3t7YnJ1c2h9fS5wbmdcIi8+JytcclxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYnJ1c2gtbmFtZVwiPnt7IGJydXNoIH19PC9kaXY+JytcclxuICAgICAgICAgICAgJzwvZGl2Pic7XHJcblxyXG4gICAgICAgICAgICB2YXIgdW5iaW5kID0gJHJvb3RTY29wZS4kb24oJ3RhYi5jaGFuZ2VkJywgZnVuY3Rpb24oZSwgbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdkcmF3aW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLmFwcGVuZCgkY29tcGlsZSh0ZW1wbGF0ZSkoJHNjb3BlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdW5iaW5kKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1dKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5mYWN0b3J5KCdoaXN0b3J5JywgWyckcm9vdFNjb3BlJywgJ2NhbnZhcycsIGZ1bmN0aW9uKCRyb290U2NvcGUsIGNhbnZhcykge1xyXG5cclxuXHR2YXIgaGlzdG9yeSA9IHtcclxuXHJcblx0XHRhbGw6IFtdLFxyXG5cclxuICAgICAgICAvL3VzZWQgZm9yIGJhY2tpbmcgdXAgY2FudmFzIGFuZCBvdGhlciBzZXJpYWxpemF0aW9uc1xyXG4gICAgICAgIC8vdGhhdCBhcmUgbm90IHZpc2libGUgdG8gdGhlIHVzZXJcclxuICAgICAgICBpZ25vcmVkOiBbXSwgXHJcblxyXG5cdFx0YWRkOiBmdW5jdGlvbihuYW1lLCBpY29uLCBpZ25vcmUpIHtcclxuICAgICAgICAgICAgdmFyIHByb3AgPSBpZ25vcmUgPyAnaWdub3JlZCcgOiAnYWxsJztcclxuXHJcbiAgICAgICAgICAgIC8vbWFrZSBzdXJlIGRvbid0IGhhdmUgZHVwbGljYXRlcyBpbiBpZ25vcmVkIGFycmF5XHJcbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnaWdub3JlZCcpIHsgXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaWdub3JlZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlnbm9yZWRbaV0ubmFtZSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlnbm9yZWQuc3BsaWNlKGksIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG5cdFx0XHR0aGlzW3Byb3BdLnVuc2hpZnQoe1xyXG5cdFx0XHRcdG5hbWU6IG5hbWUsXHJcblx0XHRcdFx0c3RhdGU6IGNhbnZhcy5mYWJyaWMudG9KU09OKFsnc2VsZWN0YWJsZScsICduYW1lJ10pLFxyXG5cdFx0XHRcdGluZGV4OiB0aGlzLmFsbC5sZW5ndGgrMSxcclxuXHRcdFx0XHRpY29uOiBpY29uLFxyXG4gICAgICAgICAgICAgICAgem9vbTogY2FudmFzLnpvb20sXHJcblx0XHRcdFx0Y2FudmFzV2lkdGg6IGNhbnZhcy5vcmlnaW5hbC53aWR0aCB8fCBjYW52YXMuZmFicmljLmdldFdpZHRoKCksXHJcblx0XHRcdFx0Y2FudmFzSGVpZ2h0OiBjYW52YXMub3JpZ2luYWwuaGVpZ2h0IHx8IGNhbnZhcy5mYWJyaWMuZ2V0SGVpZ2h0KClcclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKG5hbWUsIHByb3ApIHtcclxuICAgICAgICAgICAgaWYgKCAhcHJvcCkgcHJvcCA9ICdpZ25vcmVkJztcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGlzdG9yeVtwcm9wXS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGhpc3RvcnlbcHJvcF1baV0ubmFtZSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBoaXN0b3J5W3Byb3BdW2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZ2V0Q3VycmVudENhbnZhc1N0YXRlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlOiBjYW52YXMuZmFicmljLnRvSlNPTihbJ3NlbGVjdGFibGUnLCAnbmFtZSddKSxcclxuICAgICAgICAgICAgICAgIGluZGV4OiB0aGlzLmFsbC5sZW5ndGgrMSxcclxuICAgICAgICAgICAgICAgIHpvb206IGNhbnZhcy56b29tLFxyXG4gICAgICAgICAgICAgICAgY2FudmFzV2lkdGg6IGNhbnZhcy5vcmlnaW5hbC53aWR0aCB8fCBjYW52YXMuZmFicmljLmdldFdpZHRoKCksXHJcbiAgICAgICAgICAgICAgICBjYW52YXNIZWlnaHQ6IGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQgfHwgY2FudmFzLmZhYnJpYy5nZXRIZWlnaHQoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcblx0XHRsb2FkOiBmdW5jdGlvbihpdGVtKSB7XHJcblx0XHRcdCRyb290U2NvcGUuaXNMb2FkaW5nKCk7XHJcblxyXG4gICAgICAgICAgICAvL2lmIHdlIGdldCBwYXNzZWQgYSBuYW1lLCBmZXRjaCBhIG1hdGNoaW5nIGhpc3RvcnkgaXRlbVxyXG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc1N0cmluZyhpdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgaXRlbSA9IHRoaXMuZ2V0KGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoICEgaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUuaXNOb3RMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Y2FudmFzLmZhYnJpYy5sb2FkRnJvbUpTT04oaXRlbS5zdGF0ZSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcblxyXG5cdFx0XHRcdFx0XHQvL3JlYXBwbHkgYW55IGZpbHRlcnMgb2JqZWN0IHVzZWQgdG8gaGF2ZVxyXG5cdFx0XHRcdFx0XHRpZiAob2JqLmFwcGx5RmlsdGVycyAmJiBvYmouZmlsdGVycy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRvYmouYXBwbHlGaWx0ZXJzKGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsLmJpbmQoY2FudmFzLmZhYnJpYykpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHQvL2Fzc2lnbiBuZXcgcmVmZXJlbmNlIHRvIG1haW5JbWFnZSBwcm9wZXJ0eVxyXG5cdFx0XHRcdFx0XHRpZiAob2JqLm5hbWUgPT0gJ21haW5JbWFnZScpIHtcclxuXHRcdFx0XHRcdFx0XHRjYW52YXMubWFpbkltYWdlID0gb2JqO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLnpvb20oMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmNhbnZhc1dpZHRoICYmIGl0ZW0uY2FudmFzSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0V2lkdGgoaXRlbS5jYW52YXNXaWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0SGVpZ2h0KGl0ZW0uY2FudmFzSGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLndpZHRoID0gaXRlbS5jYW52YXNXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9yaWdpbmFsLmhlaWdodCA9IGl0ZW0uY2FudmFzSGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmNhbGNPZmZzZXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5maXRUb1NjcmVlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ2hpc3RvcnkubG9hZGVkJyk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0sIDMwKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRyZXR1cm4gaGlzdG9yeTtcclxufV0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdJbWFnZUVkaXRvcicpXHJcblxyXG4uZmFjdG9yeSgnc2F2ZXInLCBbJyRyb290U2NvcGUnLCAnJG1kRGlhbG9nJywgJyRodHRwJywgJyR0aW1lb3V0JywgJ2NhbnZhcycsICdjcm9wcGVyJywgJ2hpc3RvcnknLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkbWREaWFsb2csICRodHRwLCAkdGltZW91dCwgY2FudmFzLCBjcm9wcGVyLCBoaXN0b3J5KSB7XHJcblxyXG5cdHZhciBzYXZlciA9IHtcclxuXHJcbiAgICAgICAgc2F2ZUltYWdlOiBmdW5jdGlvbihmb3JtYXQsIHF1YWxpdHksIG5hbWUsIGUpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5kZWFjdGl2YXRlQWxsKCk7XHJcbiAgICAgICAgICAgIGNyb3BwZXIuc3RvcCgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaXNEZW1vKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVEZW1vU2l0ZVNhdmUoZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgkcm9vdFNjb3BlLmlzSW50ZWdyYXRpb25Nb2RlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVJbnRlZ3JhdGlvbk1vZGVTYXZlKGZvcm1hdCwgcXVhbGl0eSwgbmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vdGhpcy5zYXZlVG9Db21wdXRlcihmb3JtYXQsIHF1YWxpdHksIG5hbWUpO1xyXG4gICAgICAgICAgICB0aGlzLnNhdmVUb1NlcnZlcihuYW1lKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBoYW5kbGVJbnRlZ3JhdGlvbk1vZGVTYXZlOiBmdW5jdGlvbihmb3JtYXQsIHF1YWxpdHksIG5hbWUpIHtcclxuICAgICAgICAgICAgY2FudmFzLnpvb20oMTUwL2NhbnZhcy5vcmlnaW5hbC5oZWlnaHQpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuZ2V0RGF0YVVybChmb3JtYXQsIHF1YWxpdHkpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFja3MoZGF0YSwgbmFtZSk7XHJcblxyXG4gICAgICAgICAgICAvL2ZpcmVmb3ggaW50ZWdyYXRpb24gbW9kZSBmaXhcclxuICAgICAgICAgICAgJCgnLm1kLWRpYWxvZy1jb250YWluZXInKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUucGl4aWUuY2xvc2UoKTtcclxuICAgICAgICAgICAgY2FudmFzLnpvb20oMC41KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzYXZlVG9TZXJ2ZXI6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgY2FudmFzLnpvb20oMTUwL2NhbnZhcy5vcmlnaW5hbC5oZWlnaHQpO1xyXG4gICAgICAgICAgICB2YXIgZGF0YV9qcGVnID0gdGhpcy5nZXREYXRhVXJsKCdqcGVnJywgOCksXHJcbiAgICAgICAgICAgICAgICBkYXRhX3BuZyA9IHRoaXMuZ2V0RGF0YVVybCgncG5nJywgOCksXHJcbiAgICAgICAgICAgICAgICBkYXRhX2pzb24gPSB0aGlzLmdldERhdGFVcmwoJ2pzb24nLCA4KTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy56b29tKDAuNSk7XHJcbiAgICAgICAgICAgIGpRdWVyeS5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogXCIvd3AtYWRtaW4vYWRtaW4tYWpheC5waHBcIixcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICd3aW5lc2hvcF9sYWJlbF9zYXZlJyxcclxuICAgICAgICAgICAgICAgICAgICBmaWxlX25hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAganBlZyA6IGRhdGFfanBlZyxcclxuICAgICAgICAgICAgICAgICAgICBwbmcgOiBkYXRhX3BuZyxcclxuICAgICAgICAgICAgICAgICAgICBqc29uIDogZGF0YV9qc29uXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNhdmVUb0NvbXB1dGVyOiBmdW5jdGlvbihmb3JtYXQsIHF1YWxpdHksIG5hbWUpIHtcclxuICAgICAgICAgICAgY2FudmFzLnpvb20oMSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKSxcclxuICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFVcmwoZm9ybWF0LCBxdWFsaXR5KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2tzKGRhdGEsIG5hbWUpO1xyXG5cclxuICAgICAgICAgICAgLy9icm93c2VyIHN1cHBvcnRzIGh0bWw1IGRvd25sb2FkIGF0dHJpYnV0ZVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGxpbmsuZG93bmxvYWQgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgICAgICBsaW5rLmRvd25sb2FkID0gKG5hbWUgfHwgJ2ltYWdlJykrJy4nK2Zvcm1hdDtcclxuICAgICAgICAgICAgICAgIGxpbmsuaHJlZiA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspO1xyXG4gICAgICAgICAgICAgICAgbGluay5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy9jYW52YXMgYmxvYiBhbmQgZmlsZSBzYXZlciB3b3JrYXJvdW5kXHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5sb3dlckNhbnZhc0VsLnRvQmxvYihmdW5jdGlvbihibG9iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2F2ZUFzKGJsb2IsIG5hbWUrJy4nK2Zvcm1hdCk7XHJcbiAgICAgICAgICAgICAgICB9LCAnaW1hZ2UvJytmb3JtYXQsIHF1YWxpdHkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGhhbmRsZUNhbGxiYWNrczogZnVuY3Rpb24oZGF0YSwgbmFtZSkge1xyXG4gICAgICAgICAgICAvL3JlcGxhY2UgaW1hZ2Ugc3JjIHdpdGggbmV3IGRhdGEgdXJsIGluIG9yaWdpbmFsIHdpbmRvd1xyXG4gICAgICAgICAgICBpZiAoJHJvb3RTY29wZS5nZXRQYXJhbSgncmVwbGFjZU9yaWdpbmFsJykgJiYgJHJvb3RTY29wZS5nZXRQYXJhbSgnaW1hZ2UnKSkge1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nZXRQYXJhbSgnaW1hZ2UnKS5zcmMgPSBkYXRhO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvL3NlbmQgaW1hZ2UgZGF0YSB0byB1c2VyIHNwZWNpZmllZCB1cmxcclxuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuZ2V0UGFyYW0oJ3NhdmVVcmwnKSkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucG9zdCgkcm9vdFNjb3BlLmdldFBhcmFtKCdzYXZlVXJsJyksIHsgZGF0YTogZGF0YSwgbmFtZTogbmFtZSB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuZ2V0UGFyYW0oJ29uU2F2ZScpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW1nID0gJHJvb3RTY29wZS5nZXRQYXJhbSgnaW1hZ2UnKSB8fCBuZXcgSW1hZ2UoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdldFBhcmFtKCdvblNhdmUnKShkYXRhLCBpbWcsIG5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgaGFuZGxlRGVtb1NpdGVTYXZlOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICQoJy5kZW1vLWFsZXJ0Jykub25lKCRyb290U2NvcGUuYW5pbWF0aW9uRW5kRXZlbnQsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYW5pbWF0ZWQgc2hha2UnKTsgIGUudGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICAgICAgfSkuYWRkQ2xhc3MoJ2FuaW1hdGVkIHNoYWtlJyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZ2V0RGF0YVVybDogZnVuY3Rpb24oZm9ybWF0LCBxdWFsaXR5KSB7XHJcbiAgICAgICAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGF0YTp0ZXh0L2pzb247Y2hhcnNldD11dGYtOCxcIiArIGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShoaXN0b3J5LmdldEN1cnJlbnRDYW52YXNTdGF0ZSgpKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGNhbnZhcy5mYWJyaWMudG9EYXRhVVJMKHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0IHx8ICdwbmcnLFxyXG4gICAgICAgICAgICAgICAgcXVhbGl0eTogKHF1YWxpdHkgfHwgOCkgLyAxMFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXRUaHVtYkRhdGFVcmw6IGZ1bmN0aW9uKGRhdGFzLCB3YW50ZWRXaWR0aCwgd2FudGVkSGVpZ2h0KXtcclxuICAgICAgICAgICAgLy8gV2UgY3JlYXRlIGFuIGltYWdlIHRvIHJlY2VpdmUgdGhlIERhdGEgVVJJXHJcbiAgICAgICAgICAgIHZhciBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFdlIHB1dCB0aGUgRGF0YSBVUkkgaW4gdGhlIGltYWdlJ3Mgc3JjIGF0dHJpYnV0ZVxyXG4gICAgICAgICAgICBpbWcuc3JjID0gZGF0YXM7XHJcbiAgICAgICAgICAgIHZhciBkYXRhVVJJID0gJyc7XHJcbiAgICAgICAgICAgIC8vIFdoZW4gdGhlIGV2ZW50IFwib25sb2FkXCIgaXMgdHJpZ2dlcmVkIHdlIGNhbiByZXNpemUgdGhlIGltYWdlLlxyXG4gICAgICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKVxyXG4gICAgICAgICAgICAgICAgeyAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgY3JlYXRlIGEgY2FudmFzIGFuZCBnZXQgaXRzIGNvbnRleHQuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2Ugc2V0IHRoZSBkaW1lbnNpb25zIGF0IHRoZSB3YW50ZWQgc2l6ZS5cclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSB3YW50ZWRXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gd2FudGVkSGVpZ2h0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSByZXNpemUgdGhlIGltYWdlIHdpdGggdGhlIGNhbnZhcyBtZXRob2QgZHJhd0ltYWdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSh0aGlzLCAwLCAwLCB3YW50ZWRXaWR0aCwgd2FudGVkSGVpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVVSSSA9IGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBhbmQgdHJlYXQgeW91ciBEYXRhIFVSSSBoZXJlICEhIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHdoaWxlKGRhdGFVUkkgPT0gJycpe307XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhVVJJO1xyXG4gICAgICAgIH1cclxuXHR9O1xyXG5cclxuXHRyZXR1cm4gc2F2ZXI7XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZmlsdGVycycsIFtdKVxyXG5cclxuLmNvbnRyb2xsZXIoJ0ZpbHRlcnNDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdjYW52YXMnLCAnZmlsdGVycycsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgY2FudmFzLCBmaWx0ZXJzKSB7XHJcblxyXG4gICAgJHNjb3BlLmZpbHRlcnMgPSBmaWx0ZXJzO1xyXG5cclxuICAgICRyb290U2NvcGUuJG9uKCdoaXN0b3J5LmxvYWRlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoICEgY2FudmFzLm1haW5JbWFnZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICB2YXIgYXBwbGllZEZpbHRlcnMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYW52YXMubWFpbkltYWdlLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYXBwbGllZEZpbHRlcnMucHVzaChjYW52YXMubWFpbkltYWdlLmZpbHRlcnNbaV0ubmFtZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBmaWx0ZXJzLmFwcGxpZWRGaWx0ZXJzID0gYXBwbGllZEZpbHRlcnM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufV0pO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnaW1hZ2UuZmlsdGVycycpXHJcblxyXG4uc2VydmljZSgnZmlsdGVycycsIFsnJHJvb3RTY29wZScsICdjYW52YXMnLCAnaGlzdG9yeScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCBjYW52YXMsIGhpc3RvcnkpIHtcclxuXHJcbiAgICB2YXIgZmlsdGVycyA9IHtcclxuXHJcbiAgICAgICAgYWxsOiBbXHJcbiAgICAgICAgICAgIHsgbmFtZTogJ2dyYXlzY2FsZScgfSxcclxuICAgICAgICAgICAgeyBuYW1lOiAnaW52ZXJ0JyB9LFxyXG4gICAgICAgICAgICB7IG5hbWU6ICdzZXBpYScgfSxcclxuICAgICAgICAgICAgeyBuYW1lOiAnc2VwaWEyJyB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAncmVtb3ZlV2hpdGUnLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlOiB7IGN1cnJlbnQ6IDEwIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyZXNob2xkOiB7IGN1cnJlbnQ6IDUwIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2JyaWdodG5lc3MnLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyaWdodG5lc3M6IHsgY3VycmVudDogNTAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnbm9pc2UnLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG5vaXNlOiB7IGN1cnJlbnQ6IDQwLCBtYXg6IDYwMCB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdHcmFkaWVudFRyYW5zcGFyZW5jeScsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogJ0dyYWRpZW50JyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJlc2hvbGQ6IHsgY3VycmVudDogNDAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAncGl4ZWxhdGUnLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGJsb2Nrc2l6ZTogeyBtYXg6IDQwLCBjdXJyZW50OiAyIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ3NoYXJwZW4nLFxyXG4gICAgICAgICAgICAgICAgdXNlczogJ0NvbnZvbHV0ZScsXHJcbiAgICAgICAgICAgICAgICBtYXRyaXg6IFsgMCwgLTEsICAwLCAtMSwgIDUsIC0xLCAwLCAtMSwgIDAgXVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnYmx1cicsXHJcbiAgICAgICAgICAgICAgICB1c2VzOiAnQ29udm9sdXRlJyxcclxuICAgICAgICAgICAgICAgIG1hdHJpeDogWyAxLzksIDEvOSwgMS85LCAxLzksIDEvOSwgMS85LCAxLzksIDEvOSwgMS85IF1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2VtYm9zcycsXHJcbiAgICAgICAgICAgICAgICB1c2VzOiAnQ29udm9sdXRlJyxcclxuICAgICAgICAgICAgICAgIG1hdHJpeDogWyAxLCAgIDEsICAxLCAxLCAwLjcsIC0xLCAtMSwgIC0xLCAtMSBdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICd0aW50JyxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiB7IGN1cnJlbnQ6IDAuNSwgbWluOiAwLjEsIG1heDogMSwgc3RlcDogMC4xIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHsgY29sb3JwaWNrZXI6IHRydWUsIGN1cnJlbnQ6ICcjRkY0MDgxJyB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdtdWx0aXBseScsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHsgY29sb3JwaWNrZXI6IHRydWUsIGN1cnJlbnQ6ICcjRkY0MDgxJyB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdibGVuZCcsXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZTogeyBjdXJyZW50OiAnYWRkJywgc2VsZWN0OiB0cnVlLCBhdmFpbGFibGU6IFsnYWRkJywgJ211bHRpcGx5JywgJ3N1YnRyYWN0JywgJ2RpZmYnLCAnc2NyZWVuJywgJ2xpZ2h0ZW4nLCAnZGFya2VuJ10gfSxcclxuICAgICAgICAgICAgICAgICAgICBhbHBoYTogeyBjdXJyZW50OiAwLjUsIG1pbjogMC4xLCBtYXg6IDEsIHN0ZXA6IDAuMSB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB7IGNvbG9ycGlja2VyOiB0cnVlLCBjdXJyZW50OiAnI0ZGNDA4MScgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICBdLFxyXG5cclxuICAgICAgICBhcHBsaWVkRmlsdGVyczogW10sXHJcblxyXG4gICAgICAgIGFwcGx5RmlsdGVyOiBmdW5jdGlvbihmaWx0ZXIpIHtcclxuICAgICAgICAgICAgaWYgKCAhIHRoaXMuZmlsdGVyRXhpc3RzKGZpbHRlcikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmZpbHRlckFscmVhZHlBcHBsaWVkKGZpbHRlci5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlRmlsdGVyKGZpbHRlcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRyb290U2NvcGUuaXNMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIGZpbHRlcnMubWFya0FzQXBwbGllZChmaWx0ZXIubmFtZSk7XHJcblxyXG4gICAgICAgICAgICAvL25lZWQgdG8gdXNlIHRpbWVvdXQgdG8gZGlzcGxheSBsb2FkaW5nIHNwaW5uZXIgcHJvcGVybHlcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuZm9yRWFjaE9iamVjdChmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmFwcGx5RmlsdGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouZmlsdGVycy5wdXNoKGZpbHRlcnMuZ2V0RmlsdGVyKGZpbHRlcikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouYXBwbHlGaWx0ZXJzKGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsLmJpbmQoY2FudmFzLmZhYnJpYykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGhpc3RvcnkuYWRkKCdmaWx0ZXI6ICcrKGZpbHRlci5kaXNwbGF5TmFtZSB8fCBmaWx0ZXIubmFtZSksICdicmlnaHRuZXNzLTYnKTtcclxuICAgICAgICAgICAgICAgIGZpbHRlcnMubGFzdEFwcGxpZWRGaWx0ZXIgPSBmaWx0ZXI7XHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmlzTm90TG9hZGluZygpO1xyXG4gICAgICAgICAgICB9LCAzMCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcmVtb3ZlRmlsdGVyOiBmdW5jdGlvbihmaWx0ZXIpIHtcclxuICAgICAgICAgICAgaWYgKCAhIHRoaXMuZmlsdGVyRXhpc3RzKGZpbHRlcikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICRyb290U2NvcGUuaXNMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIGZpbHRlcnMudW5tYXJrQXNBcHBsaWVkKGZpbHRlci5uYW1lKTtcclxuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmZvckVhY2hPYmplY3QoZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5hcHBseUZpbHRlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYmouZmlsdGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5maWx0ZXJzW2ldLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gZmlsdGVyLm5hbWUudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iai5maWx0ZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouYXBwbHlGaWx0ZXJzKGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsLmJpbmQoY2FudmFzLmZhYnJpYykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZmlsdGVycy5sYXN0QXBwbGllZEZpbHRlciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pc05vdExvYWRpbmcoKTtcclxuICAgICAgICAgICAgfSwgMzApO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFwcGx5VmFsdWU6IGZ1bmN0aW9uKGZpbHRlck5hbWUsIG9wdGlvbk5hbWUsIG9wdGlvblZhbHVlKSB7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuaXNMb2FkaW5nKCk7XHJcblxyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmouYXBwbHlGaWx0ZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWx0ZXIgPSBvYmouZmlsdGVyc1tpXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsdGVyLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gZmlsdGVyTmFtZS50b0xvd2VyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyW29wdGlvbk5hbWVdID0gb3B0aW9uVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLmFwcGx5RmlsdGVycyhjYW52YXMuZmFicmljLnJlbmRlckFsbC5iaW5kKGNhbnZhcy5mYWJyaWMpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuaXNOb3RMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIH0sIDMwKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBmaWx0ZXJBbHJlYWR5QXBwbGllZDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBsaWVkRmlsdGVycy5pbmRleE9mKG5hbWUpICE9PSAtMVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1hcmtBc0FwcGxpZWQ6IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYXBwbGllZEZpbHRlcnMuaW5kZXhPZihuYW1lKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwbGllZEZpbHRlcnMucHVzaChuYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHVubWFya0FzQXBwbGllZDogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXBwbGllZEZpbHRlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFwcGxpZWRGaWx0ZXJzW2ldID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBsaWVkRmlsdGVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBmaWx0ZXJFeGlzdHM6IGZ1bmN0aW9uKGZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFicmljLkltYWdlLmZpbHRlcnNbZmFicmljLnV0aWwuc3RyaW5nLmNhcGl0YWxpemUoZmlsdGVyLnVzZXMgfHwgZmlsdGVyLm5hbWUsIHRydWUpXSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldEZpbHRlcjogZnVuY3Rpb24oZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXdGaWx0ZXI7XHJcblxyXG4gICAgICAgICAgICBpZiAoZmlsdGVyLnVzZXMpIHtcclxuICAgICAgICAgICAgICAgIG5ld0ZpbHRlciA9IG5ldyBmYWJyaWMuSW1hZ2UuZmlsdGVyc1tmYWJyaWMudXRpbC5zdHJpbmcuY2FwaXRhbGl6ZShmaWx0ZXIudXNlcywgdHJ1ZSldKHsgbWF0cml4OiBmaWx0ZXIubWF0cml4IH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0ge307XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGZpbHRlci5vcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1trZXldID0gZmlsdGVyLm9wdGlvbnNba2V5XS5jdXJyZW50O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG5ld0ZpbHRlciA9IG5ldyBmYWJyaWMuSW1hZ2UuZmlsdGVyc1tmYWJyaWMudXRpbC5zdHJpbmcuY2FwaXRhbGl6ZShmaWx0ZXIubmFtZSwgdHJ1ZSldKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBuZXdGaWx0ZXIubmFtZSA9IGZpbHRlci5uYW1lO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG5ld0ZpbHRlcjtcclxuICAgICAgICB9LFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gZmlsdGVycztcclxuXHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2Uuc2hhcGVzJywgW10pXHJcblxyXG4uY29udHJvbGxlcignU2ltcGxlU2hhcGVzQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHRpbWVvdXQnLCAnY2FudmFzJywgJ3NpbXBsZVNoYXBlcycsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHRpbWVvdXQsIGNhbnZhcywgc2ltcGxlU2hhcGVzKSB7XHJcblx0JHNjb3BlLnNoYXBlcyA9IHNpbXBsZVNoYXBlcztcclxuXHJcbiAgICAkc2NvcGUuYXZhaWxhYmxlID0gWydyZWN0JywgJ3RyaWFuZ2xlJywgJ2NpcmNsZScsICdlbGxpcHNlJywgJ3BvbHlnb24nXTtcclxuXHJcbiAgICAkc2NvcGUuaXNQYW5lbEVuYWJsZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgb2JqID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuICAgICAgICByZXR1cm4gb2JqICYmICRzY29wZS5hdmFpbGFibGUuaW5kZXhPZihvYmoubmFtZSkgPiAtMSAmJiBzaW1wbGVTaGFwZXMuc2VsZWN0ZWQub3B0aW9ucztcclxuICAgIH07XHJcblxyXG4gICAgY2FudmFzLmZhYnJpYy5vbignb2JqZWN0OnNlbGVjdGVkJywgZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAgICAgaWYgKCRyb290U2NvcGUuYWN0aXZlVGFiICE9PSAnc2ltcGxlLXNoYXBlcycpIHJldHVybjtcclxuICAgICAgICBzaW1wbGVTaGFwZXMuc2VsZWN0U2hhcGUob2JqZWN0LnRhcmdldC5uYW1lKTtcclxuICAgIH0pO1xyXG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5jb250cm9sbGVyKCdQaG90b0NvbnRyb2xsZXInLCBbJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRtZERpYWxvZycsICckbWRUb2FzdCcsICckJHJBRicsICdjYW52YXMnLCAnaGlzdG9yeScsICdzZXR0aW5ncycsICdzYXZlcicsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJG1kRGlhbG9nLCAkbWRUb2FzdCwgJCRyQUYsIGNhbnZhcywgaGlzdG9yeSwgc2V0dGluZ3MsIHNhdmVyKSB7XHJcblxyXG4gICAgJHNjb3BlLmhpc3RvcnkgPSBoaXN0b3J5O1xyXG5cclxuICAgICRzY29wZS5pc0RlbW8gPSAkcm9vdFNjb3BlLmlzRGVtbztcclxuICAgICRzY29wZS5jYW5PcGVuSW1hZ2UgPSBmYWxzZTtcclxuICAgICRzY29wZS5jYW52YXMgPSBjYW52YXM7XHJcbiAgICAkc2NvcGUub3BlbkltYWdlTW9kZSA9ICdvcGVuJztcclxuXHJcbiAgICAkc2NvcGUuY2FudmFzV2lkdGggPSA4MDA7XHJcbiAgICAkc2NvcGUuY2FudmFzSGVpZ2h0ID0gNjAwO1xyXG5cclxuICAgICRzY29wZS5pbWFnZU5hbWUgPSAnaW1hZ2UnO1xyXG4gICAgJHNjb3BlLmltYWdlVHlwZSA9ICdqcGVnJztcclxuICAgICRzY29wZS5pbWFnZVF1YWxpdHkgPSA4O1xyXG5cclxuICAgICRzY29wZS5vYmplY3RzUGFuZWxPcGVuID0gdHJ1ZTtcclxuICAgICRzY29wZS5oaXN0b3J5UGFuZWxPcGVuID0gZmFsc2U7XHJcblxyXG4gICAgJHJvb3RTY29wZS4kb24oJ3NldHRpbmdzLnJlYWR5JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHBob3RvcyA9IHNldHRpbmdzLmdldCgncGhvdG9zJyk7XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSBwaG90b3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgcGhvdG9zW2ldLml0ZW1zID0gbmV3IEFycmF5KHBob3Rvc1tpXS5pdGVtcyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnBob3RvcyA9IHBob3RvcztcclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS5hY3RpdmVQaG90b0NhdGVnb3J5ID0gJ3VzZXInO1xyXG5cclxuICAgICRzY29wZS5zZXRBY3RpdmVQaG90b0NhdGVnb3J5ID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIGlmICgkc2NvcGUuYWN0aXZlUGhvdG9DYXRlZ29yeSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuYWN0aXZlUGhvdG9DYXRlZ29yeSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVQaG90b0NhdGVnb3J5ID0gbmFtZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5vcGVuVXBsb2FkRGlhbG9nID0gZnVuY3Rpb24oJGV2ZW50KSB7XHJcbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJCgnI21haW4taW1hZ2UtdXBsb2FkLWRpYWxvZy10ZW1wbGF0ZScpLmh0bWwoKSxcclxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6ICRldmVudCxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bob3RvQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50cmFuc2Zvcm1PcGVuID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQgdHJhbnNpdGlvbi1pbicpLnNob3coKTtcclxuICAgICAgICAkc2NvcGUudHJhbnNmb3JtVG9DbGlja0VsZW1lbnQocGFuZWwsIGUpO1xyXG5cclxuICAgICAgICAkJHJBRihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcGFuZWwuYWRkQ2xhc3MoJ3RyYW5zaXRpb24taW4nKS5jc3MoJ3RyYW5zZm9ybScsICcnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybUNsb3NlID0gZnVuY3Rpb24obmFtZSwgZSkge1xyXG4gICAgICAgIHZhciBwYW5lbCA9ICQoJyMnK25hbWUpO1xyXG5cclxuICAgICAgICBwYW5lbC5hZGRDbGFzcygndHJhbnNpdGlvbi1vdXQnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1pbicpO1xyXG4gICAgICAgICRzY29wZS50cmFuc2Zvcm1Ub0NsaWNrRWxlbWVudChwYW5lbCwgZSk7XHJcblxyXG4gICAgICAgIHBhbmVsLm9uZSgkcm9vdFNjb3BlLnRyYW5zaXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHBhbmVsLmhpZGUoKS5jc3MoJ3RyYW5zZm9ybScsICcnKS5yZW1vdmVDbGFzcygndHJhbnNpdGlvbi1vdXQnKTtcclxuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLnRyYW5zZm9ybVRvQ2xpY2tFbGVtZW50ID0gZnVuY3Rpb24ocGFuZWwsIGUpIHtcclxuICAgICAgICB2YXIgY2xpY2tSZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgdmFyIHBhbmVsUmVjdCA9IHBhbmVsWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuICAgICAgICB2YXIgc2NhbGVYID0gTWF0aC5taW4oMC41LCBjbGlja1JlY3Qud2lkdGggLyBwYW5lbFJlY3Qud2lkdGgpO1xyXG4gICAgICAgIHZhciBzY2FsZVkgPSBNYXRoLm1pbigwLjUsIGNsaWNrUmVjdC5oZWlnaHQgLyBwYW5lbFJlY3QuaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgcGFuZWwuY3NzKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlM2QoJyArXHJcbiAgICAgICAgICAgICgtcGFuZWxSZWN0LmxlZnQgKyBjbGlja1JlY3QubGVmdCArIGNsaWNrUmVjdC53aWR0aC8yIC0gcGFuZWxSZWN0LndpZHRoLzIpICsgJ3B4LCcgK1xyXG4gICAgICAgICAgICAoLXBhbmVsUmVjdC50b3AgKyBjbGlja1JlY3QudG9wICsgY2xpY2tSZWN0LmhlaWdodC8yIC0gcGFuZWxSZWN0LmhlaWdodC8yKSArICdweCwnICtcclxuICAgICAgICAgICAgJzApIHNjYWxlKCcgKyBzY2FsZVggKyAnLCcgKyBzY2FsZVkgKyAnKSdcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgJHNjb3BlLm9wZW5TYW1wbGVJbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNhbnZhcy5sb2FkTWFpbkltYWdlKCdhc3NldHMvaW1hZ2VzL2xvdHVzLmpwZycpO1xyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAkc2NvcGUuc2hvd0ltYWdlUHJldmlldyA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGhpc3RvcnlPYmplY3QgPSBKU09OLnBhcnNlKHVybCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhpc3RvcnlPYmplY3QgJiYgaGlzdG9yeU9iamVjdC5zdGF0ZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuY2xlYXIoKTtcclxuICAgICAgICAgICAgaGlzdG9yeS5sb2FkKGhpc3RvcnlPYmplY3QpO1xyXG4gICAgICAgICAgICAkc2NvcGUuY2xvc2VVcGxvYWREaWFsb2coKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5zdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZmFicmljLnV0aWwubG9hZEltYWdlKHVybCwgZnVuY3Rpb24oaW1hZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoJycpLmFwcGVuZChpbWFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNhbk9wZW5JbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLm9wZW5JbWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciB1cmwgPSAkKCcuaW1nLXByZXZpZXcgaW1nJykuYXR0cignc3JjJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGlmICggISB1cmwgfHwgISAkc2NvcGUuY2FuT3BlbkltYWdlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICgoIWNhbnZhcy5mYWJyaWMuX29iamVjdHMubGVuZ3RoIHx8ICEgY2FudmFzLm1haW5JbWFnZSkgJiYgISAkcm9vdFNjb3BlLnVzZXJQcmVzZXQpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5jbGVhcigpO1xyXG4gICAgICAgICAgICBjYW52YXMubG9hZE1haW5JbWFnZSh1cmwpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5vcGVuSW1hZ2UodXJsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZygpO1xyXG4gICAgICAgICRyb290U2NvcGUuc3RhcnRlZCA9IHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5jbG9zZVVwbG9hZERpYWxvZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzY29wZS5jYW5VcGxvYWRJbWFnZSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5vcGVuSW1hZ2VNb2RlID0gJ29wZW4nO1xyXG4gICAgICAgICQoJy5pbWctcHJldmlldycpLmh0bWwoKTtcclxuICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xyXG4gICAgfTtcclxuXHJcblxyXG4gICAgJHNjb3BlLmFkZFRvQ2FudmFzID0gZnVuY3Rpb24oY2F0ZWdvcnksIGluZGV4LCBlKSB7XHJcbiAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nKSByZXR1cm47XHJcbiAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIC8vJHNjb3BlLm9wZW5QYW5lbCgncGhvdG9zJywgZSk7XHJcblxyXG4gICAgICAgIGZhYnJpYy51dGlsLmxvYWRJbWFnZSgnYXNzZXRzL2ltYWdlcy9waG90b3MvJytjYXRlZ29yeS5uYW1lKycvJytpbmRleCsnLicrY2F0ZWdvcnkudHlwZSwgZnVuY3Rpb24oaW1nKSB7XHJcbiAgICAgICAgICAgIHZhciBpbWFnZSA9IG5ldyBmYWJyaWMuSW1hZ2UoaW1nKTtcclxuICAgICAgICAgICAgYWZ0ZXJBZGRQaG90b1RvQ2FudmFzKGltYWdlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYW52YXMuem9vbSgxKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZnRlckFkZFBob3RvVG9DYW52YXMoaW1hZ2UpIHtcclxuICAgICAgICBpbWFnZS5uYW1lID0gJ3Bob3RvJztcclxuICAgICAgICBjYW52YXMuZmFicmljLmFkZChpbWFnZSk7XHJcbiAgICAgICAgaW1hZ2Uuc2NhbGVUb0hlaWdodCgoNTAgLyAxMDApICogY2FudmFzLm9yaWdpbmFsLmhlaWdodCk7XHJcblxyXG4gICAgICAgIGltYWdlLmNlbnRlcigpO1xyXG4gICAgICAgIGltYWdlLnNldENvb3JkcygpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KGltYWdlKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG5cclxuICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBoaXN0b3J5LmFkZCgnQWRkZWQ6IFBob3RvJywgJ2Zhdm9yaXRlJyk7XHJcbiAgICB9XHJcblxyXG59XSk7XHJcblxyXG5cclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5zaGFwZXMnKVxyXG5cclxuLmRpcmVjdGl2ZSgnZWRQaG90b3NDYXRlZ29yaWVzJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCBlbCkge1xyXG5cclxuICAgICAgICAgICAgLy9sb2FkIHBob3RvIGltYWdlcyBpbnRvIG9wZW4gY2F0ZWdvcnkgd2hlbiBwaG90b3MgdGFiIGlzIG9wZW5lZFxyXG4gICAgICAgICAgICB2YXIgdW5iaW5kID0gJHNjb3BlLiR3YXRjaCgnYWN0aXZlVGFiJywgZnVuY3Rpb24obmV3VGFiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3VGFiICE9PSAncGhvdG9zJykgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjYXQgPSAkKCcuY2F0ZWdvcnktcGhvdG9zLm9wZW4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXQuZmluZCgnaW1nJykuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YXNldC5zcmM7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXQucGFyZW50KCkuYWRkQ2xhc3MoJ2xvYWRlZCcpO1xyXG5cclxuICAgICAgICAgICAgICAgIHVuYmluZCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vbG9hZCBwaG90byBpbWFnZXMgZm9yIHRoZSBjYXRlZ29yeSB0aGF0IGp1c3QgYmVlbiBvcGVuZWRcclxuICAgICAgICAgICAgZWwub24oJ2NsaWNrJywgJy5jYXRlZ29yeS1oZWFkZXInLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZXRBY3RpdmVQaG90b0NhdGVnb3J5KGUudGFyZ2V0LmRhdGFzZXQubmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcnkgPSAkKGUuY3VycmVudFRhcmdldCkucGFyZW50KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCAhIGNhdGVnb3J5Lmhhc0NsYXNzKCdsb2FkZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5LmFkZENsYXNzKCdsb2FkZWQnKS5maW5kKCdpbWcnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNyYyA9IHRoaXMuZGF0YXNldC5zcmM7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgXHR9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdpbWFnZS5zaGFwZXMnKVxyXG5cclxuLmNvbnRyb2xsZXIoJ1N0aWNrZXJzQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ3NpbXBsZVNoYXBlcycsICdoaXN0b3J5JywgJ3NldHRpbmdzJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCBjYW52YXMsIHNpbXBsZVNoYXBlcywgaGlzdG9yeSwgc2V0dGluZ3MpIHtcclxuXHQkc2NvcGUuc2hhcGVzID0gc2ltcGxlU2hhcGVzO1xyXG4gICAgJHNjb3BlLm9wYWNpdHkgPSAwLjk7XHJcblxyXG4gICAgJHJvb3RTY29wZS4kb24oJ3NldHRpbmdzLnJlYWR5JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIHN0aWNrZXJzID0gc2V0dGluZ3MuZ2V0KCdzdGlja2VycycpO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gc3RpY2tlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgc3RpY2tlcnNbaV0uaXRlbXMgPSBuZXcgQXJyYXkoc3RpY2tlcnNbaV0uaXRlbXMpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5jYXRlZ29yaWVzID0gc3RpY2tlcnM7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUuYWN0aXZlQ2F0ZWdvcnkgPSAnZG9vZGxlcyc7XHJcblxyXG4gICAgJHNjb3BlLmFjdGl2ZVN0aWNrZXJJc1N2ZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBvYmogPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cclxuICAgICAgICByZXR1cm4gb2JqICYmIGFuZ3VsYXIuaXNEZWZpbmVkKG9iai5zdmdVaWQpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuaXNQYW5lbEVuYWJsZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgb2JqID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuICAgICAgICByZXR1cm4gb2JqICYmIG9iai5uYW1lID09PSAnc3RpY2tlcicgJiYgJHJvb3RTY29wZS5hY3RpdmVUYWIgPT09ICdzdGlja2Vycyc7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zZXRBY3RpdmVDYXRlZ29yeSA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICBpZiAoJHNjb3BlLmFjdGl2ZUNhdGVnb3J5ID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVDYXRlZ29yeSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICRzY29wZS5hY3RpdmVDYXRlZ29yeSA9IG5hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuc2V0T3BhY2l0eSA9IGZ1bmN0aW9uKG9wYWNpdHkpIHtcclxuICAgICAgICBzaW1wbGVTaGFwZXMuZ2V0U2hhcGUoJ3N0aWNrZXInKS5zZXRPcGFjaXR5KG9wYWNpdHkpO1xyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5zZXRDb2xvciA9IGZ1bmN0aW9uKGNvbG9yKSB7XHJcbiAgICAgICAgdmFyIG9iaiA9IHNpbXBsZVNoYXBlcy5nZXRTaGFwZSgnc3RpY2tlcicpO1xyXG5cclxuICAgICAgICBpZiAob2JqLmlzU2FtZUNvbG9yICYmIG9iai5pc1NhbWVDb2xvcigpIHx8ICEgb2JqLnBhdGhzKSB7XHJcbiAgICAgICAgICAgIG9iai5zZXRGaWxsKGNvbG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAob2JqLnBhdGhzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2JqLnBhdGhzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBvYmoucGF0aHNbaV0uc2V0RmlsbChjb2xvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5hZGRUb0NhbnZhcyA9IGZ1bmN0aW9uKGNhdGVnb3J5LCBpbmRleCwgZSkge1xyXG4gICAgICAgIGlmICgkc2NvcGUubG9hZGluZykgcmV0dXJuO1xyXG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAkc2NvcGUub3BlblBhbmVsKCdzdGlja2VycycsIGUpO1xyXG5cclxuICAgICAgICBpZiAoY2F0ZWdvcnkudHlwZSA9PT0gJ3N2ZycpIHtcclxuICAgICAgICAgICAgZmFicmljLmxvYWRTVkdGcm9tVVJMKCdhc3NldHMvaW1hZ2VzL3N0aWNrZXJzLycrY2F0ZWdvcnkubmFtZSsnLycraW5kZXgrJy4nK2NhdGVnb3J5LnR5cGUsIGZ1bmN0aW9uIChvYmplY3RzLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSBmYWJyaWMudXRpbC5ncm91cFNWR0VsZW1lbnRzKG9iamVjdHMsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgYWZ0ZXJBZGRTdGlja2VyVG9DYW52YXMoaW1hZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmYWJyaWMudXRpbC5sb2FkSW1hZ2UoJ2Fzc2V0cy9pbWFnZXMvc3RpY2tlcnMvJytjYXRlZ29yeS5uYW1lKycvJytpbmRleCsnLicrY2F0ZWdvcnkudHlwZSwgZnVuY3Rpb24oaW1nKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgZmFicmljLkltYWdlKGltZyk7XHJcbiAgICAgICAgICAgICAgICBhZnRlckFkZFN0aWNrZXJUb0NhbnZhcyhpbWFnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZnRlckFkZFN0aWNrZXJUb0NhbnZhcyhpbWFnZSkge1xyXG4gICAgICAgIGltYWdlLm5hbWUgPSAnc3RpY2tlcic7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5hZGQoaW1hZ2UpO1xyXG4gICAgICAgIGltYWdlLnNjYWxlVG9IZWlnaHQoKDQwIC8gMTAwKSAqIGNhbnZhcy5vcmlnaW5hbC5oZWlnaHQpO1xyXG5cclxuICAgICAgICBpbWFnZS5jZW50ZXIoKTtcclxuICAgICAgICBpbWFnZS5zZXRDb29yZHMoKTtcclxuICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChpbWFnZSk7XHJcbiAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaGlzdG9yeS5hZGQoJ0FkZGVkOiBTdGlja2VyJywgJ2Zhdm9yaXRlJyk7XHJcbiAgICB9XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnaW1hZ2Uuc2hhcGVzJylcclxuXHJcbi5kaXJlY3RpdmUoJ2VkU3RpY2tlcnNDYXRlZ29yaWVzJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24oJHNjb3BlLCBlbCkge1xyXG5cclxuICAgICAgICAgICAgLy9sb2FkIHN0aWNrZXIgaW1hZ2VzIGludG8gb3BlbiBjYXRlZ29yeSB3aGVuIHN0aWNrZXJzIHRhYiBpcyBvcGVuZWRcclxuICAgICAgICAgICAgdmFyIHVuYmluZCA9ICRzY29wZS4kd2F0Y2goJ2FjdGl2ZVRhYicsIGZ1bmN0aW9uKG5ld1RhYikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1RhYiAhPT0gJ3N0aWNrZXJzJykgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjYXQgPSAkKCcuY2F0ZWdvcnktc3RpY2tlcnMub3BlbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhdC5maW5kKCdpbWcnKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3JjID0gdGhpcy5kYXRhc2V0LnNyYztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhdC5wYXJlbnQoKS5hZGRDbGFzcygnbG9hZGVkJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgdW5iaW5kKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy9sb2FkIHN0aWNrZXIgaW1hZ2VzIGZvciB0aGUgY2F0ZWdvcnkgdGhhdCBqdXN0IGJlZW4gb3BlbmVkXHJcbiAgICAgICAgICAgIGVsLm9uKCdjbGljaycsICcuY2F0ZWdvcnktaGVhZGVyJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0QWN0aXZlQ2F0ZWdvcnkoZS50YXJnZXQuZGF0YXNldC5uYW1lKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjYXRlZ29yeSA9ICQoZS5jdXJyZW50VGFyZ2V0KS5wYXJlbnQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoICEgY2F0ZWdvcnkuaGFzQ2xhc3MoJ2xvYWRlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnkuYWRkQ2xhc3MoJ2xvYWRlZCcpLmZpbmQoJ2ltZycpLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3JjID0gdGhpcy5kYXRhc2V0LnNyYztcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICBcdH1cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnNoYXBlcycpXHJcblxyXG4uZmlsdGVyKCdvcmRlck9wdGlvbnMnLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihpdGVtcywgZmllbGQsIHJldmVyc2UpIHtcclxuICAgICAgICB2YXIgZmlsdGVyZWQgPSBbXTtcclxuICAgICAgICBhbmd1bGFyLmZvckVhY2goaXRlbXMsIGZ1bmN0aW9uKGl0ZW0sIGtleSkge1xyXG4gICAgICAgICAgICBpdGVtLm5hbWUgPSBrZXk7XHJcbiAgICAgICAgICAgIGZpbHRlcmVkLnB1c2goaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgZmlsdGVyZWQuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gKGFbZmllbGRdID4gYltmaWVsZF0gPyAxIDogLTEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmKHJldmVyc2UpIGZpbHRlcmVkLnJldmVyc2UoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkO1xyXG4gICAgfTtcclxufSlcclxuXHJcbi5zZXJ2aWNlKCdzaW1wbGVTaGFwZXMnLCBbJyRyb290U2NvcGUnLCAnY2FudmFzJywgJ3BvbHlnb24nLCAnaGlzdG9yeScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCBjYW52YXMsIHBvbHlnb24sIGhpc3RvcnkpIHtcclxuXHJcbiAgICB2YXIgc2hhcGVzID0ge1xyXG5cclxuICAgICAgICBncmFkaWVudHM6IGVkR3JhZGllbnRzLFxyXG5cclxuICAgICAgICB0ZXh0dXJlczogbmV3IEFycmF5KDI4KSxcclxuXHJcbiAgICAgICAgYmFzZU9wdGlvbnM6IHtcclxuICAgICAgICAgICAgbWFpbjoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDEsIG1pbjogMC4xLCBtYXg6IDEsIHN0ZXA6IDAuMSB9LFxyXG4gICAgICAgICAgICAgICAgZmlsbDogeyB0eXBlOiAnY29sb3JwaWNrZXInLCBjdXJyZW50OiAnIzI2MzIzOCcsIGhpZGRlbjogdHJ1ZSB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvcmRlcjoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBvblRvZ2dsZTogJ3RvZ2dsZUJvcmRlcicsXHJcbiAgICAgICAgICAgICAgICBzdHJva2U6IHsgdHlwZTogJ2NvbG9ycGlja2VyJywgY3VycmVudDogJyMyMTk2RjMnLCBkaXNwbGF5TmFtZTogJ0NvbG9yJyB9LFxyXG4gICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDUsIG1heDogNDAsIGRpc3BsYXlOYW1lOiAnV2lkdGgnIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2hhZG93OiB7XHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIG9uVG9nZ2xlOiAndG9nZ2xlU2hhZG93JyxcclxuICAgICAgICAgICAgICAgIGNvbG9yOiB7IHR5cGU6ICdjb2xvcnBpY2tlcicsIGN1cnJlbnQ6ICdyZ2JhKDAsMCwwLDAuNSknfSxcclxuICAgICAgICAgICAgICAgIGJsdXI6IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDUsIG1heDogODAgfSxcclxuICAgICAgICAgICAgICAgIG9mZnNldFg6IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDgsIG1heDogMzAgfSxcclxuICAgICAgICAgICAgICAgIG9mZnNldFk6IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDUsIG1heDogMzAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYXZhaWxhYmxlOiBbXSxcclxuXHJcbiAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlLFxyXG5cclxuICAgICAgICBmaWxsV2l0aEdyYWRpZW50OiBmdW5jdGlvbihpbmRleCwgdHlwZSkge1xyXG4gICAgICAgICAgICB2YXIgc2hhcGUgPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cclxuICAgICAgICAgICAgc2hhcGUuc2V0R3JhZGllbnQodHlwZXx8J2ZpbGwnLCB0aGlzLmdyYWRpZW50c1tpbmRleF0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBmaWxsV2l0aEltYWdlOiBmdW5jdGlvbih1cmwpIHtcclxuICAgICAgICAgICAgdmFyIHNoYXBlID0gY2FudmFzLmZhYnJpYy5nZXRBY3RpdmVPYmplY3QoKTtcclxuXHJcbiAgICAgICAgICAgIGZhYnJpYy51dGlsLmxvYWRJbWFnZSh1cmwsIGZ1bmN0aW9uKGltZykge1xyXG4gICAgICAgICAgICAgICAgc2hhcGUuc2V0UGF0dGVybkZpbGwoeyBzb3VyY2U6IGltZyB9KTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGFkZFRvQ2FudmFzOiBmdW5jdGlvbihzaGFwZSkge1xyXG4gICAgICAgICAgICBpZiAoICEgdGhpcy5zaGFwZUV4aXN0cyhzaGFwZSkpIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHNoYXBlO1xyXG5cclxuICAgICAgICAgICAgLy93ZSBtaWdodCBuZWVkIHRvIGVuYWJsZSBhIGRyYXdpbmcgbW9kZSBpbnN0ZWFkXHJcbiAgICAgICAgICAgIC8vb2YgYWRkZWQgYSBzaGFwZSB0byBjYW52YXMgaWYgd2UgZ2V0IHBhc3NlZCBwb2x5Z29uXHJcbiAgICAgICAgICAgIGlmIChzaGFwZS5zZXJ2aWNlICYmIHNoYXBlLnNlcnZpY2UuZW5hYmxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2hhcGUuc2VydmljZS5lbmFibGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGZhYnJpY1NoYXBlID0gdGhpcy5jcmVhdGVOZXdTaGFwZShzaGFwZSk7XHJcblxyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLmFkZChmYWJyaWNTaGFwZSk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5jZW50ZXIoZmFicmljU2hhcGUpO1xyXG4gICAgICAgICAgICBjYW52YXMuZmFicmljLnNldEFjdGl2ZU9iamVjdChmYWJyaWNTaGFwZSk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcblxyXG4gICAgICAgICAgICBoaXN0b3J5LmFkZCgnQWRkZWQ6ICcrc2hhcGUubmFtZSwgJ3Bhbm9yYW1hLXZlcnRpY2FsJyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYXBwbHlWYWx1ZTogZnVuY3Rpb24oZ3JvdXAsIG5hbWUsIG9wdGlvbiwgdmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIHNldHRlciA9ICdzZXQnK2ZhYnJpYy51dGlsLnN0cmluZy5jYXBpdGFsaXplKG9wdGlvbiwgdHJ1ZSksXHJcbiAgICAgICAgICAgICAgICBzaGFwZSAgPSB0aGlzLmdldFNoYXBlKG5hbWUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGdyb3VwID09PSAnc2hhZG93Jykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlTaGFkb3dWYWx1ZShzaGFwZSwgb3B0aW9uLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkICYmIHRoaXMuc2VsZWN0ZWQubmFtZSA9PT0gbmFtZSkge1xyXG5cclxuICAgICAgICAgICAgICAgIC8vdXNlIHNldHRlciBpZiBhdmFpbGFibGUsIG90aGVyIHNpbXBseSBhc3NpZ24gdGhlIHZhbHVlXHJcbiAgICAgICAgICAgICAgICBzaGFwZVtzZXR0ZXJdID8gc2hhcGVbc2V0dGVyXSh2YWx1ZSkgOiBzaGFwZVtvcHRpb25dID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBzaGFwZS5zZXRDb29yZHMoKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuc2V0QWN0aXZlT2JqZWN0KHNoYXBlKTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBhcHBseVNoYWRvd1ZhbHVlOiBmdW5jdGlvbihzaGFwZSwgb3B0aW9uLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAoICEgc2hhcGUpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgY29sb3I6IHRoaXMuc2VsZWN0ZWQub3B0aW9ucy5zaGFkb3cuY29sb3IuY3VycmVudCxcclxuICAgICAgICAgICAgICAgIGJsdXI6IHRoaXMuc2VsZWN0ZWQub3B0aW9ucy5zaGFkb3cuYmx1ci5jdXJyZW50LFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0WDogdGhpcy5zZWxlY3RlZC5vcHRpb25zLnNoYWRvdy5vZmZzZXRYLmN1cnJlbnQsXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRZOiB0aGlzLnNlbGVjdGVkLm9wdGlvbnMuc2hhZG93Lm9mZnNldFkuY3VycmVudFxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKG9wdGlvbiAmJiB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9uc1tvcHRpb25dID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNoYXBlLnNldFNoYWRvdyhvcHRpb25zKTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB0b2dnbGVTaGFkb3c6IGZ1bmN0aW9uKG5hbWUsIG9uKSB7XHJcbiAgICAgICAgICAgIGlmIChvbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseVNoYWRvd1ZhbHVlKHRoaXMuZ2V0U2hhcGUobmFtZSkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTaGFwZShuYW1lKS5zZXRTaGFkb3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRvZ2dsZSBib3JkZXIgb24vb2ZmIG9uIGFjdGl2ZSBvYmplY3QgaW4gdGhlIGNhbnZhcy5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBuYW1lXHJcbiAgICAgICAgICogQHBhcmFtIG9uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdG9nZ2xlQm9yZGVyOiBmdW5jdGlvbihuYW1lLCBvbikge1xyXG4gICAgICAgICAgICBpZiAob24pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2hhcGUobmFtZSkuc2V0U3Ryb2tlKHRoaXMuc2VsZWN0ZWQub3B0aW9ucy5ib3JkZXIuc3Ryb2tlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U2hhcGUobmFtZSkuc2V0U3Ryb2tlKGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5yZW5kZXJBbGwoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzaGFwZUV4aXN0czogZnVuY3Rpb24oc2hhcGUpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmF2YWlsYWJsZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXZhaWxhYmxlW2ldLm5hbWUgPT09IHNoYXBlLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybiBhIGZpcnN0IGF2YWlsYWJsZSBmYWJyaWMgb2JqZWN0IHRoYXQgbWF0Y2hlcyBnaXZlbiBuYW1lLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIG5hbWVcclxuICAgICAgICAgKiBAcmV0dXJucyB7ZmFicmljLk9iamVjdHwqfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldFNoYXBlOiBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBhY3RpdmUgPSBjYW52YXMuZmFicmljLmdldEFjdGl2ZU9iamVjdCgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGFjdGl2ZSAmJiBhY3RpdmUubmFtZSA9PT0gbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5mb3JFYWNoT2JqZWN0KGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9iai5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZlID0gb2JqO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBhY3RpdmU7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ3JlYXRlIG5ldyBmYWJyaWMgc2hhcGUgZnJvbSBnaXZlbiBjb25maWcgb2JqZWN0LlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHNoYXBlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY3JlYXRlTmV3U2hhcGU6IGZ1bmN0aW9uKHNoYXBlKSB7XHJcbiAgICAgICAgICAgIHZhciBzaGFwZU5hbWUgPSBmYWJyaWMudXRpbC5zdHJpbmcuY2FwaXRhbGl6ZShzaGFwZS5uYW1lLCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChmYWJyaWNbc2hhcGVOYW1lXSkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cm9rZVdpZHRoOiBzaGFwZS5vcHRpb25zLmJvcmRlci5zdHJva2VXaWR0aC5jdXJyZW50LFxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goc2hhcGUub3B0aW9ucy5tYWluLCBmdW5jdGlvbih2YWwsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zW2tleV0gPSB2YWwuY3VycmVudDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2hhcGUub3B0aW9ucy5wb2ludHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3U2hhcGUgPSBuZXcgZmFicmljW3NoYXBlTmFtZV0oc2hhcGUub3B0aW9ucy5wb2ludHMuY3VycmVudCwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdTaGFwZSA9IG5ldyBmYWJyaWNbc2hhcGVOYW1lXShvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBuZXdTaGFwZS5uYW1lID0gc2hhcGUubmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3U2hhcGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZWxlY3RTaGFwZTogZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICBpZiAoICEgbmFtZSB8fCB0aGlzLnNlbGVjdGVkLm5hbWUgPT09IG5hbWUpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5hdmFpbGFibGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmF2YWlsYWJsZVtpXS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWQgPSB0aGlzLmF2YWlsYWJsZVtpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNpcmNsZU9wdGlvbnMgPSBhbmd1bGFyLmNvcHkoc2hhcGVzLmJhc2VPcHRpb25zKTtcclxuICAgIGNpcmNsZU9wdGlvbnMubWFpbi5yYWRpdXMgPSB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA3MiwgbWluOiAyMCB9O1xyXG5cclxuICAgIHNoYXBlcy5hdmFpbGFibGUucHVzaCh7XHJcbiAgICAgICAgbmFtZTogJ2NpcmNsZScsXHJcbiAgICAgICAgb3B0aW9uczogY2lyY2xlT3B0aW9uc1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHJlY3RPcHRpb25zID0gYW5ndWxhci5jb3B5KHNoYXBlcy5iYXNlT3B0aW9ucyk7XHJcbiAgICByZWN0T3B0aW9ucy5tYWluLndpZHRoID0geyB0eXBlOiAnc2xpZGVyJywgY3VycmVudDogMTQwIH07XHJcbiAgICByZWN0T3B0aW9ucy5tYWluLmhlaWdodCA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDE0MCB9O1xyXG5cclxuICAgIHNoYXBlcy5hdmFpbGFibGUucHVzaCh7XHJcbiAgICAgICAgbmFtZTogJ3JlY3QnLFxyXG4gICAgICAgIGRpc3BsYXlOYW1lOiAncmVjdGFuZ2xlJyxcclxuICAgICAgICBvcHRpb25zOiByZWN0T3B0aW9uc1xyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIHRyaWFuZ2xlT3B0aW9ucyA9IGFuZ3VsYXIuY29weShzaGFwZXMuYmFzZU9wdGlvbnMpO1xyXG4gICAgdHJpYW5nbGVPcHRpb25zLm1haW4ud2lkdGggPSB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiAxNDAsIG1pbjogMjUgfTtcclxuICAgIHRyaWFuZ2xlT3B0aW9ucy5tYWluLmhlaWdodCA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDE0MCwgbWluOiAyNSB9O1xyXG5cclxuICAgIHNoYXBlcy5hdmFpbGFibGUucHVzaCh7XHJcbiAgICAgICAgbmFtZTogJ3RyaWFuZ2xlJyxcclxuICAgICAgICBvcHRpb25zOiB0cmlhbmdsZU9wdGlvbnNcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBlbGxpcHNlID0gYW5ndWxhci5jb3B5KHNoYXBlcy5iYXNlT3B0aW9ucyk7XHJcbiAgICBlbGxpcHNlLm1haW4ucnggPSB7IHR5cGU6ICdzbGlkZXInLCBjdXJyZW50OiA4MCwgZGlzcGxheU5hbWU6ICdob3Jpem9udGFsIHJhZGl1cycgfTtcclxuICAgIGVsbGlwc2UubWFpbi5yeSA9IHsgdHlwZTogJ3NsaWRlcicsIGN1cnJlbnQ6IDMwLCBkaXNwbGF5TmFtZTogJ3ZlcnRpY2FsIHJhZGl1cycgfTtcclxuXHJcbiAgICBzaGFwZXMuYXZhaWxhYmxlLnB1c2goe1xyXG4gICAgICAgIG5hbWU6ICdlbGxpcHNlJyxcclxuICAgICAgICBvcHRpb25zOiBlbGxpcHNlXHJcbiAgICB9KTtcclxuXHJcbiAgICBzaGFwZXMuYXZhaWxhYmxlLnB1c2goe1xyXG4gICAgICAgIG5hbWU6ICdwb2x5Z29uJywgIG9wdGlvbnM6IGFuZ3VsYXIuY29weShzaGFwZXMuYmFzZU9wdGlvbnMpLCBzZXJ2aWNlOiBwb2x5Z29uXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gc2hhcGVzO1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ2ltYWdlLnNoYXBlcycpXHJcblxyXG4uc2VydmljZSgncG9seWdvbicsIFsnJHJvb3RTY29wZScsICckbWREaWFsb2cnLCAnY2FudmFzJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRtZERpYWxvZywgY2FudmFzKSB7XHJcblxyXG4gICAgdmFyIHNlbGYgPSB7XHJcblxyXG4gICAgICAgIG1vZGU6ICdhZGQnLFxyXG4gICAgICAgIGN1cnJlbnRTaGFwZTogZmFsc2UsXHJcblxyXG4gICAgICAgIG9uTW91c2VNb3ZlOiBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICB2YXIgcG9zID0gY2FudmFzLmZhYnJpYy5nZXRQb2ludGVyKGV2ZW50LmUpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZi5tb2RlID09PSBcImVkaXRcIiAmJiBzZWxmLmN1cnJlbnRTaGFwZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBvaW50cyA9IHNlbGYuY3VycmVudFNoYXBlLmdldChcInBvaW50c1wiKTtcclxuICAgICAgICAgICAgICAgIHBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0ueCA9IHBvcy54IC0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwibGVmdFwiKTtcclxuICAgICAgICAgICAgICAgIHBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0ueSA9IHBvcy55IC0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwidG9wXCIpO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUuc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICBwb2ludHM6IHBvaW50c1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25Nb3VzZURvd246IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwb3MgPSBjYW52YXMuZmFicmljLmdldFBvaW50ZXIoZXZlbnQuZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2VsZi5tb2RlID09PSBcImFkZFwiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9seSA9IG5ldyBmYWJyaWMuUG9seWdvbihbe1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHBvcy54LFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IHBvcy55XHJcbiAgICAgICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogcG9zLnggKyAwLjUsXHJcbiAgICAgICAgICAgICAgICAgICAgeTogcG9zLnkgKyAwLjVcclxuICAgICAgICAgICAgICAgIH1dLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsbDogJ2JsYWNrJyxcclxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlID0gcG9seTtcclxuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlLm5hbWUgPSAncG9seWdvbic7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuZmFicmljLmFkZChzZWxmLmN1cnJlbnRTaGFwZSk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm1vZGUgPSBcImVkaXRcIjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLm1vZGUgPT09IFwiZWRpdFwiICYmIHNlbGYuY3VycmVudFNoYXBlICYmIHNlbGYuY3VycmVudFNoYXBlLnR5cGUgPT09IFwicG9seWdvblwiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9pbnRzID0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwicG9pbnRzXCIpO1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IHBvcy54IC0gc2VsZi5jdXJyZW50U2hhcGUuZ2V0KFwibGVmdFwiKSxcclxuICAgICAgICAgICAgICAgICAgICB5OiBwb3MueSAtIHNlbGYuY3VycmVudFNoYXBlLmdldChcInRvcFwiKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZS5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50czogcG9pbnRzXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvbkVzY2FwZTogZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBpZiAoKCFlICYmIHNlbGYuY3VycmVudFNoYXBlKSB8fCBlICYmIGUua2V5Q29kZSA9PT0gMjcpIHtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLm1vZGUgPT09ICdlZGl0JyB8fCBzZWxmLm1vZGUgPT09ICdhZGQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5tb2RlID0gJ25vcm1hbCc7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50U2hhcGUuc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZS5fY2FsY0RpbWVuc2lvbnMoKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRTaGFwZS5zZXRDb29yZHMoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qoc2VsZi5jdXJyZW50U2hhcGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubW9kZSA9ICdhZGQnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFNoYXBlID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgdmFyIGNsaWNrZWRJbk1vZGFsID0gJChlLnRhcmdldCkuY2xvc2VzdCgnLm1kLWRpYWxvZy1jb250YWluZXInKVswXTtcclxuXHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldC5ub2RlTmFtZSAhPT0gJ0NBTlZBUycgJiYgJChlLnRhcmdldCkuY2xvc2VzdCgnLnNoYXBlJykuZGF0YSgnbmFtZScpICE9PSAncG9seWdvbicgJiYgIWNsaWNrZWRJbk1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLmRpc2FibGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGVuYWJsZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMub24oJ21vdXNlOm1vdmUnLCBzZWxmLm9uTW91c2VNb3ZlKTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5vbignbW91c2U6ZG93bicsIHNlbGYub25Nb3VzZURvd24pO1xyXG4gICAgICAgICAgICBmYWJyaWMudXRpbC5hZGRMaXN0ZW5lcih3aW5kb3csICdrZXl1cCcsIHNlbGYub25Fc2NhcGUpO1xyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGZhYnJpYy51dGlsLmFkZExpc3RlbmVyKHdpbmRvdywgJ2NsaWNrJywgc2VsZi5vbkNsaWNrKTtcclxuICAgICAgICAgICAgfSwgMjApO1xyXG5cclxuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdtb2RhbHMvcG9seWdvbi5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckbWREaWFsb2cnLCBmdW5jdGlvbigkc2NvcGUsICRtZERpYWxvZykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jbG9zZU1vZGFsID0gJG1kRGlhbG9nLmhpZGU7XHJcbiAgICAgICAgICAgICAgICB9XVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBkaXNhYmxlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5lbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMub2ZmKCdtb3VzZTptb3ZlJywgc2VsZi5vbk1vdXNlTW92ZSk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMub2ZmKCdtb3VzZTpkb3duJywgc2VsZi5vbk1vdXNlRG93bik7XHJcbiAgICAgICAgICAgIGZhYnJpYy51dGlsLnJlbW92ZUxpc3RlbmVyKHdpbmRvdywgJ2tleXVwJywgc2VsZi5vbkVzY2FwZSk7XHJcbiAgICAgICAgICAgIGZhYnJpYy51dGlsLnJlbW92ZUxpc3RlbmVyKHdpbmRvdywgJ2NsaWNrJywgc2VsZi5vbkNsaWNrKTtcclxuICAgICAgICAgICAgc2VsZi5vbkVzY2FwZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHNlbGY7XHJcblxyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ0ltYWdlRWRpdG9yJylcclxuXHJcbi5jb250cm9sbGVyKCdPYmplY3RzUGFuZWxDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckdGltZW91dCcsICdjYW52YXMnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICR0aW1lb3V0LCBjYW52YXMpIHtcclxuXHQkc2NvcGUub2JqZWN0cyA9IGNhbnZhcy5mYWJyaWMuX29iamVjdHMgfHwgW107XHJcblxyXG4gICAgJHNjb3BlLnNvcnRhYmxlT3B0aW9ucyA9IHtcclxuICAgICAgICBpdGVtczogJy5vYmplY3Q6dmlzaWJsZScsXHJcbiAgICAgICAgc2Nyb2xsOiBmYWxzZSxcclxuICAgICAgICBjb250YWlubWVudDogJ3BhcmVudCcsXHJcbiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKGUsIHVpKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU3RhcnRcIik7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVpLml0ZW0uaW5kZXgoKSk7XHJcbiAgICAgICAgICAgIHVpLml0ZW0uZGF0YSgnc3RhcnQnLCB1aS5pdGVtLmluZGV4KCkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RvcDogZnVuY3Rpb24oZSwgdWkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdG9wXCIpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh1aS5pdGVtLmluZGV4KCkpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbihlLCB1aSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVwZGF0ZVwiKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2codWkuaXRlbS5pbmRleCgpKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzdGFydCA9IHVpLml0ZW0uZGF0YSgnc3RhcnQnKSxcclxuICAgICAgICAgICAgICAgIGVuZCAgID0gdWkuaXRlbS5pbmRleCgpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIG9iaiA9IGNhbnZhcy5mYWJyaWMuZ2V0T2JqZWN0cygpW3N0YXJ0XTtcclxuXHJcbiAgICAgICAgICAgIGlmICggISBvYmopIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGlmIChlbmQgPiBzdGFydCkge1xyXG4gICAgICAgICAgICAgICAgLy9zZW5kIG9iamVjdCBmb3J3YXJkcyBieSB0aGUgYW1vdW50IG9mIG9iamVjdHMgaXQgcGFzc2VkXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IChlbmQgLSBzdGFydCk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMuYnJpbmdGb3J3YXJkKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jYW52YXMuZmFicmljLnNlbmRCYWNrd2FyZHMob2JqKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vc2VuZCBvYmplY3QgYmFja3dhcmRzIGJ5IHRoZSBhbW91bnQgb2Ygb2JqZWN0cyBpdCBwYXNzZWRcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgKHN0YXJ0IC0gZW5kKTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZW5kQmFja3dhcmRzKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jYW52YXMuZmFicmljLmJyaW5nRm9yd2FyZChvYmopO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgICAgICAgICBzdGFydCA9IGZhbHNlOyBlbmQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgICRzY29wZS5zZXRBc0FjdGl2ZSA9IGZ1bmN0aW9uKG9iamVjdCkge1xyXG4gICAgICAgIGlmIChvYmplY3QpIHtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqZWN0KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS50b2dnbGVWaXNpYmlsaXR5ID0gZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAgICAgaWYgKCAhIG9iamVjdCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAob2JqZWN0LnZpc2libGUpIHtcclxuICAgICAgICAgICAgb2JqZWN0LnNldCh7IHZpc2libGU6IGZhbHNlLCBldmVudGVkOiBmYWxzZSwgc2VsZWN0YWJsZTogZmFsc2UsIGhhc0JvcmRlcnM6IGZhbHNlLCBoYXNDb3JuZXJzOiBmYWxzZSB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvYmplY3Quc2V0KHsgdmlzaWJsZTogdHJ1ZSwgZXZlbnRlZDogdHJ1ZSwgc2VsZWN0YWJsZTogdHJ1ZSwgaGFzQm9yZGVyczogdHJ1ZSwgaGFzQ29ybmVyczogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqZWN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICB9O1xyXG5cclxuICAgICRzY29wZS5kZWxldGVPYmplY3QgPSBmdW5jdGlvbihvYmplY3QpIHtcclxuICAgICAgICBpZiAob2JqZWN0KSB7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVtb3ZlKG9iamVjdCk7XHJcbiAgICAgICAgICAgIGNhbnZhcy5mYWJyaWMucmVuZGVyQWxsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUudG9nZ2xlTG9jayA9IGZ1bmN0aW9uKG9iamVjdCkge1xyXG4gICAgICAgIGlmICggISBvYmplY3QpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYgKG9iamVjdC5sb2NrZWQpIHtcclxuICAgICAgICAgICAgb2JqZWN0LnNldCh7XHJcbiAgICAgICAgICAgICAgICBsb2NrZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGV2ZW50ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBsb2NrTW92ZW1lbnRYOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGxvY2tNb3ZlbWVudFk6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1JvdGF0aW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGxvY2tTY2FsaW5nWDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBsb2NrU2NhbGluZ1k6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbG9ja1VuaVNjYWxpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaGFzQ29udHJvbHM6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBoYXNCb3JkZXJzOiB0cnVlXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FudmFzLmZhYnJpYy5zZXRBY3RpdmVPYmplY3Qob2JqZWN0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvYmplY3Quc2V0KHtcclxuICAgICAgICAgICAgICAgIGxvY2tlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBsb2NrTW92ZW1lbnRYOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbG9ja01vdmVtZW50WTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tSb3RhdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tTY2FsaW5nWDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tTY2FsaW5nWTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGxvY2tVbmlTY2FsaW5nOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgaGFzQ29udHJvbHM6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgaGFzQm9yZGVyczogZmFsc2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYW52YXMuZmFicmljLnJlbmRlckFsbCgpO1xyXG4gICAgfVxyXG59XSk7Il19
